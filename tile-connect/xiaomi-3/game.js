"use strict";(()=>{var YR=Object.create,ah=Object.defineProperty,Np=Object.getOwnPropertyDescriptor,HR=Object.getOwnPropertyNames,zR=Object.getPrototypeOf,WR=Object.prototype.hasOwnProperty,VR=(e,t)=>()=>(e&&(t=e(e=0)),t),Bp=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),XR=(e,t,i,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of HR(t))!WR.call(e,n)&&n!==i&&ah(e,n,{get:()=>t[n],enumerable:!(s=Np(t,n))||s.enumerable});return e},oh=(e,t,i)=>(i=e!=null?YR(zR(e)):{},XR(t||!e||!e.__esModule?ah(i,"default",{value:e,enumerable:!0}):i,e)),ae=(e,t,i,s)=>{for(var n=s>1?void 0:s?Np(t,i):t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(n=(s?o(t,i,n):o(n))||n);return s&&n&&ah(t,i,n),n},y,Ge,Br,Pe,ce,Qt,Ot,W,Up,Gp,Yp,Hp,zp,Wp,Vp,Xp,Kp,jp,Zp,vn,hh,lh,St,uh,Ur,Es,Ct,qp,Jp,Qp,$p,tg,eg,ig,sg,ng,rg,ag,og,hg,lg,ug,cg,$t,dt,Gt,ch,Gr,dh,ys,Yr,dg,En,ni,Ts,xs,ri,ph,ai,oi,gh,hi,li,fh,ui,mh,Ss,As,vh,ci,Eh,yh,Th,xh,Sh,Ah,wh,Ch,pg,Me,gg,fg,mg,vg,Ph,Rh,bh,Eg,Ih,_h,Oh,Mh,Lh,Dh,kh,Rt,Ni,xi,Mt,Hr,ws,Fh,Nh,Bh,zr,yn,yg,Tg,xg,Sg,Ag,Wr,wg,Cg,Pg,Uh,Tn,Rg,bg,Ig,Vr,Xr,_g,Og,Mg,Lg,Dg,Si,kg,xn,Fg,Gh,Kr,Yh,Hh,Ng,Bg,Ug,Gg,Yg,zh,Hg,zg,jr,Wh,Bi,Ye,Wg,Vg,Xg,Kg,jg,Zg,Cs,Sn,qg,xe,Zr,Jg,Qg,$g,tf,Vh,An,wn,ef,Cn,sf,nf,Wt,oe,rf,af,of,hf,lf,qr,uf,cf,df,pf,gf,ff,mf,vf,Ef,yf,Xh,Ui,Pn,Jr,Kh,jh,Ps,Qr,$r,ta,xt,Rn,ea,Ut,ia,Tf,he,xf,Sf,Af,wf,Cf,Pf,Rf,bf,If,_f,Of,Mf,Lf,Df,kf,Ff,Nf,Bf,Uf,Gf,Yf,Hf,Vt,jt,Zh,qh,zf,Wf,Gi,Rs,Yi,Vf,bn,Xf,Kf,jf,Zf,Hi,qf,Jf,Qf,sa,Re,na,Ai,Jh,Qh,$f,tm,be,em,im,sm,nm,rm,$h,In,am,om,hm,lm,um,cm,dm,pm,gm,fm,mm,vm,Em,ym,Tm,xm,Sm,Am,bs,He,_n,wm,Cm,Pm,Rm,bm,Im,_m,tl,Om,Mm,Lm,el,Dm,km,Fm,il,Nm,Bm,Um,sl,Gm,Ym,Hm,nl,zm,Wm,Vm,rl,Xm,Km,jm,al,Zm,ol,qm,Jm,Qm,hl,$m,t0,e0,ll,i0,s0,n0,ul,r0,a0,o0,cl,h0,dl,On,ra,wi,pl,l0,gl,u0,fl,c0,d0,Zt,p0,ml,g0,f0,m0,vl,v0,E0,aa,Mn,y0,T0,x0,S0,A0,w0,C0,P0,R0,b0,I0,_0,O0,M0,L0,D0,k0,F0,N0,B0,U0,G0,Y0,H0,oa,z0,ha,W0,V0,X0,K0,El,j0,Z0,yl,Tl,xl,q0,J0,Q0,$0,tv,ev,iv,sv,nv,rv,av,ov,hv,lv,uv,cv,dv,pv,gv,Ie,la,fv,mv,vv,di,Ev,Sl,yv,Tv,xv,Al,ua,Ln,Sv,Av,wv,Cv,Pv,Rv,wl,ca,Dn,bv,Iv,_v,Ov,Mv,Lv,Is,Dv,kv,Cl,Pl,Fv,Nv,Bv,Uv,Rl,_s,Gv,Yv,Hv,zv,Wv,Vv,Xv,Kv,jv,Zv,qv,Jv,Qv,$v,tE,eE,iE,sE,bl,Il,_l,da,Ol,Ml,Ll,Dl,kl,nE,rE,aE,Os,oE,hE,Fl,kn,Nl,lE,uE,cE,dE,pE,Ms,Ls,gE,fE,mE,vE,EE,yE,TE,xE,SE,AE,Bl,wE,CE,PE,RE,bE,IE,_E,OE,ME,LE,Ul,Gl,DE,pa,Fn,Yl,kE,Hl,FE,NE,BE,UE,GE,YE,Ds,HE,zE,WE,VE,XE,KE,jE,ZE,ks,qE,zi,zl,Wl,Fs,JE,QE,$E,ty,ey,iy,sy,Vl,Se,Xl,Le,Kl,jl,ga,fa,te,ny,Zl,ry,ql,Jl,Ql,ay,$l,oy,tu,hy,ly,eu,uy,iu,cy,su,dy,nu,py,ru,gy,au,fy,ou,my,hu,vy,ma,va,Ey,lu,uu,Ci,Nn,Bn,cu,du,pu,gu,fu,yy,Ty,xy,Sy,mu,vu,Ay,Eu,yu,Tu,xu,Su,Au,wu,Cu,Pu,Ru,bu,Ea,Iu,_u,Ou,Mu,Lu,Du,wy,ku,Fu,Cy,ya,Wi,Nu,Bu,Uu,Gu,Yu,Hu,Py,Ry,by,Iy,_y,Oy,My,Ly,Dy,ky,Ta,Fy,Ny,xa,By,Uy,Gy,Yy,Hy,zy,Wy,Vy,Xy,Ky,jy,Zy,qy,Jy,Qy,$y,tT,eT,iT,sT,nT,rT,aT,oT,hT,lT,uT,cT,dT,pT,gT,fT,mT,vT,ET,yT,TT,xT,ST,AT,wT,CT,PT,RT,bT,IT,pi,Un,zu,Wu,Vu,Xu,Ku,gi,de,_T,ju,Zu,qu,Ju,Sa,OT,MT,LT,Qu,$u,Gn,DT,kT,FT,NT,BT,UT,GT,YT,HT,zT,Vi,tc,ec,Xi,ic,WT,sc,Aa,nc,rc,ac,Yn,oc,hc,VT,XT,KT,jT,Hn,ZT,qT,JT,QT,$T,tx,ex,ix,sx,nx,lc,uc,rx,ax,ox,hx,lx,ux,cx,dx,px,gx,fx,mx,vx,Ex,yx,Tx,xx,Sx,Ax,wx,Cx,Px,Rx,bx,Pi,zn,Wn,cc,dc,pc,gc,fc,mc,vc,Ec,Ix,_x,Ox,Mx,Lx,Dx,kx,Fx,Nx,Bx,Ux,Ki,Gx,Yx,Hx,zx,Wx,Vx,Xx,Kx,jx,Zx,yc,qx,Jx,Qx,$x,tS,wa,eS,iS,sS,nS,rS,aS,oS,hS,lS,uS,cS,Tc,xc,dS,pS,Ca,gS,fS,mS,vS,ES,yS,TS,Sc,Pa,xS,SS,Ac,AS,wS,CS,PS,RS,bS,IS,_S,wc,OS,Ra,MS,LS,DS,kS,Cc,FS,le,Ri,Vn,ba,NS,BS,Xn,Ia,_a,Pc,Rc,US,GS,YS,bc,Oa,HS,zS,WS,VS,Ma,Kn,La,Ic,XS,KS,jS,ZS,qS,_c,Da,Oc,Mc,Lc,Dc,kc,Fc,jn,Nc,JS,QS,ka,$S,t1,e1,i1,s1,n1,r1,a1,Bc,Fa,o1,h1,Na,l1,u1,c1,Ba,d1,p1,g1,f1,m1,v1,E1,y1,T1,x1,S1,A1,w1,C1,P1,R1,b1,I1,_1,Uc,Gc,Yc,O1,M1,L1,D1,k1,F1,Ua,Hc,zc,Zn,N1,B1,U1,G1,Y1,H1,Wc,z1,W1,V1,X1,K1,j1,Z1,q1,J1,Q1,$1,qn,Vc,Xc,Kc,jc,Zc,tA,eA,iA,sA,nA,rA,aA,oA,hA,lA,ji,Jn,Qn,Ga,qc,Ns,uA,cA,Ya,Jc,Qc,dA,pA,gA,fA,mA,vA,EA,yA,TA,xA,SA,AA,wA,CA,$c,PA,RA,td,bA,IA,Ha,_A,ed,za,Wa,OA,MA,LA,DA,kA,FA,NA,BA,UA,GA,bi,Zi,id,sd,nd,rd,$n,ad,od,Va,YA,Xa,HA,zA,WA,VA,XA,KA,jA,ZA,qA,JA,QA,$A,tw,ew,iw,sw,nw,KR,U=VR(()=>{"use strict";y=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ge=y((e,t)=>{t.exports={SKIP_CHECK:-1,NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,ERASE:17,SOURCE_IN:18,SOURCE_OUT:19,SOURCE_ATOP:20,DESTINATION_OVER:21,DESTINATION_IN:22,DESTINATION_OUT:23,DESTINATION_ATOP:24,LIGHTER:25,COPY:26,XOR:27}}),Br=y((e,t)=>{var i={DEFAULT:0,LINEAR:0,NEAREST:1};t.exports=i}),Pe=y((e,t)=>{var i={VERSION:"3.88.2",LOG_VERSION:"v388",BlendModes:Ge(),ScaleModes:Br(),AUTO:0,CANVAS:1,WEBGL:2,HEADLESS:3,FOREVER:-1,NONE:4,UP:5,DOWN:6,LEFT:7,RIGHT:8};t.exports=i}),ce=y((e,t)=>{var i=function(s){if(!s||typeof s!="object"||s.nodeType||s===s.window)return!1;try{if(s.constructor&&!{}.hasOwnProperty.call(s.constructor.prototype,"isPrototypeOf"))return!1}catch{return!1}return!0};t.exports=i}),Qt=y((e,t)=>{var i=ce(),s=function(){var n,r,o,a,h,l,u=arguments[0]||{},d=1,p=arguments.length,g=!1;for(typeof u=="boolean"&&(g=u,u=arguments[1]||{},d=2),p===d&&(u=this,--d);d<p;d++)if((n=arguments[d])!=null)for(r in n)o=u[r],a=n[r],u!==a&&(g&&a&&(i(a)||(h=Array.isArray(a)))?(h?(h=!1,l=o&&Array.isArray(o)?o:[]):l=o&&i(o)?o:{},u[r]=s(g,l,a)):a!==void 0&&(u[r]=a));return u};t.exports=s}),Ot=y((e,t)=>{var i=function(s,n,r){return Math.max(n,Math.min(r,s))};t.exports=i}),W=y((e,t)=>{function i(h){return!!h.get&&typeof h.get=="function"||!!h.set&&typeof h.set=="function"}function s(h,l,u){var d=u?h[l]:Object.getOwnPropertyDescriptor(h,l);return!u&&d.value&&typeof d.value=="object"&&(d=d.value),d&&i(d)?(typeof d.enumerable>"u"&&(d.enumerable=!0),typeof d.configurable>"u"&&(d.configurable=!0),d):!1}function n(h,l){var u=Object.getOwnPropertyDescriptor(h,l);return u?(u.value&&typeof u.value=="object"&&(u=u.value),u.configurable===!1):!1}function r(h,l,u,d){for(var p in l)if(l.hasOwnProperty(p)){var g=s(l,p,u);if(g!==!1){var c=d||h;if(n(c.prototype,p)){if(a.ignoreFinals)continue;throw new Error("cannot override final property '"+p+"', set Class.ignoreFinals = true to skip")}Object.defineProperty(h.prototype,p,g)}else h.prototype[p]=l[p]}}function o(h,l){if(l){Array.isArray(l)||(l=[l]);for(var u=0;u<l.length;u++)r(h,l[u].prototype||l[u])}}function a(h){h||(h={});var l,u;if(h.initialize){if(typeof h.initialize!="function")throw new Error("initialize must be a function");l=h.initialize,delete h.initialize}else if(h.Extends){var d=h.Extends;l=function(){d.apply(this,arguments)}}else l=function(){};h.Extends?(l.prototype=Object.create(h.Extends.prototype),l.prototype.constructor=l,u=h.Extends,delete h.Extends):l.prototype.constructor=l;var p=null;return h.Mixins&&(p=h.Mixins,delete h.Mixins),o(l,p),r(l,h,!0,u),l}a.extend=r,a.mixin=o,a.ignoreFinals=!1,t.exports=a}),Up=y((e,t)=>{t.exports="add"}),Gp=y((e,t)=>{t.exports="animationcomplete"}),Yp=y((e,t)=>{t.exports="animationcomplete-"}),Hp=y((e,t)=>{t.exports="animationrepeat"}),zp=y((e,t)=>{t.exports="animationrestart"}),Wp=y((e,t)=>{t.exports="animationstart"}),Vp=y((e,t)=>{t.exports="animationstop"}),Xp=y((e,t)=>{t.exports="animationupdate"}),Kp=y((e,t)=>{t.exports="pauseall"}),jp=y((e,t)=>{t.exports="remove"}),Zp=y((e,t)=>{t.exports="resumeall"}),vn=y((e,t)=>{t.exports={ADD_ANIMATION:Up(),ANIMATION_COMPLETE:Gp(),ANIMATION_COMPLETE_KEY:Yp(),ANIMATION_REPEAT:Hp(),ANIMATION_RESTART:zp(),ANIMATION_START:Wp(),ANIMATION_STOP:Vp(),ANIMATION_UPDATE:Xp(),PAUSE_ALL:Kp(),REMOVE_ANIMATION:jp(),RESUME_ALL:Zp()}}),hh=y((e,t)=>{var i=function(s,n,r){if(n.length){if(n.length===1)return n[0]}else return NaN;var o=1,a,h;if(r){if(s<n[0][r])return n[0];for(;n[o][r]<s;)o++}else for(;n[o]<s;)o++;return o>n.length&&(o=n.length),r?(a=n[o-1][r],h=n[o][r],h-s<=s-a?n[o]:n[o-1]):(a=n[o-1],h=n[o],h-s<=s-a?h:a)};t.exports=i}),lh=y((e,t)=>{var i=W(),s=new i({initialize:function(n,r,o,a,h){h===void 0&&(h=!1),this.textureKey=n,this.textureFrame=r,this.index=o,this.frame=a,this.isFirst=!1,this.isLast=!1,this.prevFrame=null,this.nextFrame=null,this.duration=0,this.progress=0,this.isKeyFrame=h},toJSON:function(){return{key:this.textureKey,frame:this.textureFrame,duration:this.duration,keyframe:this.isKeyFrame}},destroy:function(){this.frame=void 0}});t.exports=s}),St=y((e,t)=>{var i=function(s,n,r,o){if(!s&&!o||typeof s=="number")return r;if(s&&s.hasOwnProperty(n))return s[n];if(o&&o.hasOwnProperty(n))return o[n];if(n.indexOf(".")!==-1){for(var a=n.split("."),h=s,l=o,u=r,d=r,p=!0,g=!0,c=0;c<a.length;c++)h&&h.hasOwnProperty(a[c])?(u=h[a[c]],h=h[a[c]]):p=!1,l&&l.hasOwnProperty(a[c])?(d=l[a[c]],l=l[a[c]]):g=!1;return p?u:g?d:r}else return r};t.exports=i}),uh=y((e,t)=>{var i=function(s){var n=/\D/g;return s.sort(function(r,o){return parseInt(r.replace(n,""),10)-parseInt(o.replace(n,""),10)}),s};t.exports=i}),Ur=y((e,t)=>{var i=Ot(),s=W(),n=vn(),r=hh(),o=lh(),a=St(),h=uh(),l=new s({initialize:function(u,d,p){this.manager=u,this.key=d,this.type="frame",this.frames=this.getFrames(u.textureManager,a(p,"frames",[]),a(p,"defaultTextureKey",null),a(p,"sortFrames",!0)),this.frameRate=a(p,"frameRate",null),this.duration=a(p,"duration",null),this.msPerFrame,this.skipMissedFrames=a(p,"skipMissedFrames",!0),this.delay=a(p,"delay",0),this.repeat=a(p,"repeat",0),this.repeatDelay=a(p,"repeatDelay",0),this.yoyo=a(p,"yoyo",!1),this.showBeforeDelay=a(p,"showBeforeDelay",!1),this.showOnStart=a(p,"showOnStart",!1),this.hideOnComplete=a(p,"hideOnComplete",!1),this.randomFrame=a(p,"randomFrame",!1),this.paused=!1,this.calculateDuration(this,this.getTotalFrames(),this.duration,this.frameRate),this.manager.on&&(this.manager.on(n.PAUSE_ALL,this.pause,this),this.manager.on(n.RESUME_ALL,this.resume,this))},getTotalFrames:function(){return this.frames.length},calculateDuration:function(u,d,p,g){p===null&&g===null?(u.frameRate=24,u.duration=24/d*1e3):p&&g===null?(u.duration=p,u.frameRate=d/(p/1e3)):(u.frameRate=g,u.duration=d/g*1e3),u.msPerFrame=1e3/u.frameRate},addFrame:function(u){return this.addFrameAt(this.frames.length,u)},addFrameAt:function(u,d){var p=this.getFrames(this.manager.textureManager,d);if(p.length>0){if(u===0)this.frames=p.concat(this.frames);else if(u===this.frames.length)this.frames=this.frames.concat(p);else{var g=this.frames.slice(0,u),c=this.frames.slice(u);this.frames=g.concat(p,c)}this.updateFrameSequence()}return this},checkFrame:function(u){return u>=0&&u<this.frames.length},getFirstTick:function(u){u.accumulator=0,u.nextTick=u.msPerFrame||u.currentFrame.duration},getFrameAt:function(u){return this.frames[u]},getFrames:function(u,d,p,g){g===void 0&&(g=!0);var c=[],f,m,v=1,E,x;if(typeof d=="string"){if(x=d,!u.exists(x))return c;var T=u.get(x),A=T.getFrameNames();g&&h(A),d=[],A.forEach(function(C){d.push({key:x,frame:C})})}if(!Array.isArray(d)||d.length===0)return c;for(E=0;E<d.length;E++){var P=d[E],R=a(P,"key",p);if(R){var S=a(P,"frame",0),I=u.getFrame(R,S);if(!I)continue;m=new o(R,S,v,I),m.duration=a(P,"duration",0),m.isFirst=!f,f&&(f.nextFrame=m,m.prevFrame=f),c.push(m),f=m,v++}}if(c.length>0){m.isLast=!0,m.nextFrame=c[0],c[0].prevFrame=m;var w=1/(c.length-1);for(E=0;E<c.length;E++)c[E].progress=E*w}return c},getNextTick:function(u){u.accumulator-=u.nextTick,u.nextTick=u.msPerFrame||u.currentFrame.duration},getFrameByProgress:function(u){return u=i(u,0,1),r(u,this.frames,"progress")},nextFrame:function(u){var d=u.currentFrame;d.isLast?u.yoyo?this.handleYoyoFrame(u,!1):u.repeatCounter>0?u.inReverse&&u.forward?u.forward=!1:this.repeatAnimation(u):u.complete():this.updateAndGetNextTick(u,d.nextFrame)},handleYoyoFrame:function(u,d){if(d||(d=!1),u.inReverse===!d&&u.repeatCounter>0){(u.repeatDelay===0||u.pendingRepeat)&&(u.forward=d),this.repeatAnimation(u);return}if(u.inReverse!==d&&u.repeatCounter===0){u.complete();return}u.forward=d;var p=d?u.currentFrame.nextFrame:u.currentFrame.prevFrame;this.updateAndGetNextTick(u,p)},getLastFrame:function(){return this.frames[this.frames.length-1]},previousFrame:function(u){var d=u.currentFrame;d.isFirst?u.yoyo?this.handleYoyoFrame(u,!0):u.repeatCounter>0?u.inReverse&&!u.forward?this.repeatAnimation(u):(u.forward=!0,this.repeatAnimation(u)):u.complete():this.updateAndGetNextTick(u,d.prevFrame)},updateAndGetNextTick:function(u,d){u.setCurrentFrame(d),this.getNextTick(u)},removeFrame:function(u){var d=this.frames.indexOf(u);return d!==-1&&this.removeFrameAt(d),this},removeFrameAt:function(u){return this.frames.splice(u,1),this.updateFrameSequence(),this},repeatAnimation:function(u){if(u._pendingStop===2){if(u._pendingStopValue===0)return u.stop();u._pendingStopValue--}u.repeatDelay>0&&!u.pendingRepeat?(u.pendingRepeat=!0,u.accumulator-=u.nextTick,u.nextTick+=u.repeatDelay):(u.repeatCounter--,u.forward?u.setCurrentFrame(u.currentFrame.nextFrame):u.setCurrentFrame(u.currentFrame.prevFrame),u.isPlaying&&(this.getNextTick(u),u.handleRepeat()))},toJSON:function(){var u={key:this.key,type:this.type,frames:[],frameRate:this.frameRate,duration:this.duration,skipMissedFrames:this.skipMissedFrames,delay:this.delay,repeat:this.repeat,repeatDelay:this.repeatDelay,yoyo:this.yoyo,showBeforeDelay:this.showBeforeDelay,showOnStart:this.showOnStart,randomFrame:this.randomFrame,hideOnComplete:this.hideOnComplete};return this.frames.forEach(function(d){u.frames.push(d.toJSON())}),u},updateFrameSequence:function(){for(var u=this.frames.length,d=1/(u-1),p,g=0;g<u;g++)p=this.frames[g],p.index=g+1,p.isFirst=!1,p.isLast=!1,p.progress=g*d,g===0?(p.isFirst=!0,u===1?(p.isLast=!0,p.nextFrame=p,p.prevFrame=p):(p.isLast=!1,p.prevFrame=this.frames[u-1],p.nextFrame=this.frames[g+1])):g===u-1&&u>1?(p.isLast=!0,p.prevFrame=this.frames[u-2],p.nextFrame=this.frames[0]):u>1&&(p.prevFrame=this.frames[g-1],p.nextFrame=this.frames[g+1]);return this},pause:function(){return this.paused=!0,this},resume:function(){return this.paused=!1,this},destroy:function(){this.manager.off&&(this.manager.off(n.PAUSE_ALL,this.pause,this),this.manager.off(n.RESUME_ALL,this.resume,this)),this.manager.remove(this.key);for(var u=0;u<this.frames.length;u++)this.frames[u].destroy();this.frames=[],this.manager=null}});t.exports=l}),Es=y((e,t)=>{var i=W(),s=new i({initialize:function(n){this.entries={},this.size=0,this.setAll(n)},setAll:function(n){if(Array.isArray(n))for(var r=0;r<n.length;r++)this.set(n[r][0],n[r][1]);return this},set:function(n,r){return this.has(n)||this.size++,this.entries[n]=r,this},get:function(n){if(this.has(n))return this.entries[n]},getArray:function(){var n=[],r=this.entries;for(var o in r)n.push(r[o]);return n},has:function(n){return this.entries.hasOwnProperty(n)},delete:function(n){return this.has(n)&&(delete this.entries[n],this.size--),this},clear:function(){return Object.keys(this.entries).forEach(function(n){delete this.entries[n]},this),this.size=0,this},keys:function(){return Object.keys(this.entries)},values:function(){var n=[],r=this.entries;for(var o in r)n.push(r[o]);return n},dump:function(){var n=this.entries;for(var r in n);},each:function(n){var r=this.entries;for(var o in r)if(n(o,r[o])===!1)break;return this},contains:function(n){var r=this.entries;for(var o in r)if(r[o]===n)return!0;return!1},merge:function(n,r){r===void 0&&(r=!1);var o=this.entries,a=n.entries;for(var h in a)o.hasOwnProperty(h)&&r?o[h]=a[h]:this.set(h,a[h]);return this}});t.exports=s}),Ct=y((e,t)=>{"use strict";var i=Object.prototype.hasOwnProperty,s="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(s=!1));function r(l,u,d){this.fn=l,this.context=u,this.once=d||!1}function o(l,u,d,p,g){if(typeof d!="function")throw new TypeError("The listener must be a function");var c=new r(d,p||l,g),f=s?s+u:u;return l._events[f]?l._events[f].fn?l._events[f]=[l._events[f],c]:l._events[f].push(c):(l._events[f]=c,l._eventsCount++),l}function a(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function h(){this._events=new n,this._eventsCount=0}h.prototype.eventNames=function(){var l=[],u,d;if(this._eventsCount===0)return l;for(d in u=this._events)i.call(u,d)&&l.push(s?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},h.prototype.listeners=function(l){var u=s?s+l:l,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var p=0,g=d.length,c=new Array(g);p<g;p++)c[p]=d[p].fn;return c},h.prototype.listenerCount=function(l){var u=s?s+l:l,d=this._events[u];return d?d.fn?1:d.length:0},h.prototype.emit=function(l,u,d,p,g,c){var f=s?s+l:l;if(!this._events[f])return!1;var m=this._events[f],v=arguments.length,E,x;if(m.fn){switch(m.once&&this.removeListener(l,m.fn,void 0,!0),v){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,u),!0;case 3:return m.fn.call(m.context,u,d),!0;case 4:return m.fn.call(m.context,u,d,p),!0;case 5:return m.fn.call(m.context,u,d,p,g),!0;case 6:return m.fn.call(m.context,u,d,p,g,c),!0}for(x=1,E=new Array(v-1);x<v;x++)E[x-1]=arguments[x];m.fn.apply(m.context,E)}else{var T=m.length,A;for(x=0;x<T;x++)switch(m[x].once&&this.removeListener(l,m[x].fn,void 0,!0),v){case 1:m[x].fn.call(m[x].context);break;case 2:m[x].fn.call(m[x].context,u);break;case 3:m[x].fn.call(m[x].context,u,d);break;case 4:m[x].fn.call(m[x].context,u,d,p);break;default:if(!E)for(A=1,E=new Array(v-1);A<v;A++)E[A-1]=arguments[A];m[x].fn.apply(m[x].context,E)}}return!0},h.prototype.on=function(l,u,d){return o(this,l,u,d,!1)},h.prototype.once=function(l,u,d){return o(this,l,u,d,!0)},h.prototype.removeListener=function(l,u,d,p){var g=s?s+l:l;if(!this._events[g])return this;if(!u)return a(this,g),this;var c=this._events[g];if(c.fn)c.fn===u&&(!p||c.once)&&(!d||c.context===d)&&a(this,g);else{for(var f=0,m=[],v=c.length;f<v;f++)(c[f].fn!==u||p&&!c[f].once||d&&c[f].context!==d)&&m.push(c[f]);m.length?this._events[g]=m.length===1?m[0]:m:a(this,g)}return this},h.prototype.removeAllListeners=function(l){var u;return l?(u=s?s+l:l,this._events[u]&&a(this,u)):(this._events=new n,this._eventsCount=0),this},h.prototype.off=h.prototype.removeListener,h.prototype.addListener=h.prototype.on,h.prefixed=s,h.EventEmitter=h,typeof t<"u"&&(t.exports=h)}),qp=y((e,t)=>{t.exports="blur"}),Jp=y((e,t)=>{t.exports="boot"}),Qp=y((e,t)=>{t.exports="contextlost"}),$p=y((e,t)=>{t.exports="destroy"}),tg=y((e,t)=>{t.exports="focus"}),eg=y((e,t)=>{t.exports="hidden"}),ig=y((e,t)=>{t.exports="pause"}),sg=y((e,t)=>{t.exports="postrender"}),ng=y((e,t)=>{t.exports="poststep"}),rg=y((e,t)=>{t.exports="prerender"}),ag=y((e,t)=>{t.exports="prestep"}),og=y((e,t)=>{t.exports="ready"}),hg=y((e,t)=>{t.exports="resume"}),lg=y((e,t)=>{t.exports="step"}),ug=y((e,t)=>{t.exports="systemready"}),cg=y((e,t)=>{t.exports="visible"}),$t=y((e,t)=>{t.exports={BLUR:qp(),BOOT:Jp(),CONTEXT_LOST:Qp(),DESTROY:$p(),FOCUS:tg(),HIDDEN:eg(),PAUSE:ig(),POST_RENDER:sg(),POST_STEP:ng(),PRE_RENDER:rg(),PRE_STEP:ag(),READY:og(),RESUME:hg(),STEP:lg(),SYSTEM_READY:ug(),VISIBLE:cg()}}),dt=y((e,t)=>{var i=function(s,n,r){var o=typeof s;return!s||o==="number"||o==="string"?r:s.hasOwnProperty(n)&&s[n]!==void 0?s[n]:r};t.exports=i}),Gt=y((e,t)=>{var i={PI2:Math.PI*2,TAU:Math.PI*.5,EPSILON:1e-6,DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,RND:null,MIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER||-9007199254740991,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991};t.exports=i}),ch=y((e,t)=>{var i=function(s,n,r,o){var a=[],h,l=!1;if((r||o)&&(l=!0,r||(r=""),o||(o="")),n<s)for(h=s;h>=n;h--)l?a.push(r+h.toString()+o):a.push(h);else for(h=s;h<=n;h++)l?a.push(r+h.toString()+o):a.push(h);return a};t.exports=i}),Gr=y((e,t)=>{var i=function(s,n,r,o){n===void 0&&(n=0),r===void 0&&(r=" "),o===void 0&&(o=3),s=s.toString();var a=0;if(n+1>=s.length)switch(o){case 1:s=new Array(n+1-s.length).join(r)+s;break;case 3:var h=Math.ceil((a=n-s.length)/2),l=a-h;s=new Array(l+1).join(r)+s+new Array(h+1).join(r);break;default:s=s+new Array(n+1-s.length).join(r);break}return s};t.exports=i}),dh=y((e,t)=>{var i=Ur(),s=W(),n=Es(),r=Ct(),o=vn(),a=$t(),h=dt(),l=St(),u=Gt(),d=ch(),p=Gr(),g=new s({Extends:r,initialize:function(c){r.call(this),this.game=c,this.textureManager=null,this.globalTimeScale=1,this.anims=new n,this.mixes=new n,this.paused=!1,this.name="AnimationManager",c.events.once(a.BOOT,this.boot,this)},boot:function(){this.textureManager=this.game.textures,this.game.events.once(a.DESTROY,this.destroy,this)},addMix:function(c,f,m){var v=this.anims,E=this.mixes,x=typeof c=="string"?c:c.key,T=typeof f=="string"?f:f.key;if(v.has(x)&&v.has(T)){var A=E.get(x);A||(A={}),A[T]=m,E.set(x,A)}return this},removeMix:function(c,f){var m=this.mixes,v=typeof c=="string"?c:c.key,E=m.get(v);if(E)if(f){var x=typeof f=="string"?f:f.key;E.hasOwnProperty(x)&&delete E[x]}else f||m.delete(v);return this},getMix:function(c,f){var m=this.mixes,v=typeof c=="string"?c:c.key,E=typeof f=="string"?f:f.key,x=m.get(v);return x&&x.hasOwnProperty(E)?x[E]:0},add:function(c,f){return this.anims.has(c)?this:(f.key=c,this.anims.set(c,f),this.emit(o.ADD_ANIMATION,c,f),this)},exists:function(c){return this.anims.has(c)},createFromAseprite:function(c,f,m){var v=[],E=this.game.cache.json.get(c);if(!E)return v;var x=this,T=l(E,"meta",null),A=l(E,"frames",null);if(T&&A){var P=l(T,"frameTags",[]);P.forEach(function(R){var S=[],I=h(R,"name",null),w=h(R,"from",0),C=h(R,"to",0),_=h(R,"direction","forward");if(I&&(!f||f&&f.indexOf(I)>-1)){for(var O=0,D=w;D<=C;D++){var F=D.toString(),N=A[F];if(N){var Y=h(N,"duration",u.MAX_SAFE_INTEGER);S.push({key:c,frame:F,duration:Y}),O+=Y}}_==="reverse"&&(S=S.reverse());var L={key:I,frames:S,duration:O,yoyo:_==="pingpong"},b;m?m.anims&&(b=m.anims.create(L)):b=x.create(L),b&&v.push(b)}})}return v},create:function(c){var f=c.key,m=!1;return f&&(m=this.get(f),m||(m=new i(this,f,c),this.anims.set(f,m),this.emit(o.ADD_ANIMATION,f,m))),m},fromJSON:function(c,f){f===void 0&&(f=!1),f&&this.anims.clear(),typeof c=="string"&&(c=JSON.parse(c));var m=[];if(c.hasOwnProperty("anims")&&Array.isArray(c.anims)){for(var v=0;v<c.anims.length;v++)m.push(this.create(c.anims[v]));c.hasOwnProperty("globalTimeScale")&&(this.globalTimeScale=c.globalTimeScale)}else c.hasOwnProperty("key")&&c.type==="frame"&&m.push(this.create(c));return m},generateFrameNames:function(c,f){var m=l(f,"prefix",""),v=l(f,"start",0),E=l(f,"end",0),x=l(f,"suffix",""),T=l(f,"zeroPad",0),A=l(f,"outputArray",[]),P=l(f,"frames",!1);if(!this.textureManager.exists(c))return A;var R=this.textureManager.get(c);if(!R)return A;var S;if(f)for(P||(P=d(v,E)),S=0;S<P.length;S++){var I=m+p(P[S],T,"0",1)+x;R.has(I)&&A.push({key:c,frame:I})}else for(P=R.getFrameNames(),S=0;S<P.length;S++)A.push({key:c,frame:P[S]});return A},generateFrameNumbers:function(c,f){var m=l(f,"start",0),v=l(f,"end",-1),E=l(f,"first",!1),x=l(f,"outputArray",[]),T=l(f,"frames",!1);if(!this.textureManager.exists(c))return x;var A=this.textureManager.get(c);if(!A)return x;E&&A.has(E)&&x.push({key:c,frame:E}),T||(v===-1&&(v=A.frameTotal-2),T=d(m,v));for(var P=0;P<T.length;P++){var R=T[P];A.has(R)&&x.push({key:c,frame:R})}return x},get:function(c){return this.anims.get(c)},getAnimsFromTexture:function(c){for(var f=this.textureManager.get(c),m=f.key,v=this.anims.getArray(),E=[],x=0;x<v.length;x++)for(var T=v[x],A=T.frames,P=0;P<A.length;P++)if(A[P].textureKey===m){E.push(T.key);break}return E},pauseAll:function(){return this.paused||(this.paused=!0,this.emit(o.PAUSE_ALL)),this},play:function(c,f){Array.isArray(f)||(f=[f]);for(var m=0;m<f.length;m++)f[m].anims.play(c);return this},staggerPlay:function(c,f,m,v){m===void 0&&(m=0),v===void 0&&(v=!0),Array.isArray(f)||(f=[f]);var E=f.length;v||E--;for(var x=0;x<f.length;x++){var T=m<0?Math.abs(m)*(E-x):m*x;f[x].anims.playAfterDelay(c,T)}return this},remove:function(c){var f=this.get(c);return f&&(this.emit(o.REMOVE_ANIMATION,c,f),this.anims.delete(c),this.removeMix(c)),f},resumeAll:function(){return this.paused&&(this.paused=!1,this.emit(o.RESUME_ALL)),this},toJSON:function(c){var f={anims:[],globalTimeScale:this.globalTimeScale};return c!==void 0&&c!==""?f.anims.push(this.anims.get(c).toJSON()):this.anims.each(function(m,v){f.anims.push(v.toJSON())}),f},destroy:function(){this.anims.clear(),this.mixes.clear(),this.textureManager=null,this.game=null}});t.exports=g}),ys=y((e,t)=>{var i=function(s,n){return Math.floor(Math.random()*(n-s+1)+s)};t.exports=i}),Yr=y((e,t)=>{var i=Ur(),s=ys(),n=W(),r=Es(),o=vn(),a=dt(),h=new n({initialize:function(l){this.parent=l,this.animationManager=l.scene.sys.anims,this.animationManager.on(o.REMOVE_ANIMATION,this.globalRemove,this),this.textureManager=this.animationManager.textureManager,this.anims=null,this.isPlaying=!1,this.hasStarted=!1,this.currentAnim=null,this.currentFrame=null,this.nextAnim=null,this.nextAnimsQueue=[],this.timeScale=1,this.frameRate=0,this.duration=0,this.msPerFrame=0,this.skipMissedFrames=!0,this.randomFrame=!1,this.delay=0,this.repeat=0,this.repeatDelay=0,this.yoyo=!1,this.showBeforeDelay=!1,this.showOnStart=!1,this.hideOnComplete=!1,this.forward=!0,this.inReverse=!1,this.accumulator=0,this.nextTick=0,this.delayCounter=0,this.repeatCounter=0,this.pendingRepeat=!1,this._paused=!1,this._wasPlaying=!1,this._pendingStop=0,this._pendingStopValue},chain:function(l){var u=this.parent;if(l===void 0)return this.nextAnimsQueue.length=0,this.nextAnim=null,u;Array.isArray(l)||(l=[l]);for(var d=0;d<l.length;d++){var p=l[d];this.nextAnim?this.nextAnimsQueue.push(p):this.nextAnim=p}return this.parent},getName:function(){return this.currentAnim?this.currentAnim.key:""},getFrameName:function(){return this.currentFrame?this.currentFrame.textureFrame:""},load:function(l){this.isPlaying&&this.stop();var u=this.animationManager,d=typeof l=="string"?l:a(l,"key",null),p=this.exists(d)?this.get(d):u.get(d);if(p){this.currentAnim=p;var g=p.getTotalFrames(),c=a(l,"frameRate",p.frameRate),f=a(l,"duration",p.duration);p.calculateDuration(this,g,f,c),this.delay=a(l,"delay",p.delay),this.repeat=a(l,"repeat",p.repeat),this.repeatDelay=a(l,"repeatDelay",p.repeatDelay),this.yoyo=a(l,"yoyo",p.yoyo),this.showBeforeDelay=a(l,"showBeforeDelay",p.showBeforeDelay),this.showOnStart=a(l,"showOnStart",p.showOnStart),this.hideOnComplete=a(l,"hideOnComplete",p.hideOnComplete),this.skipMissedFrames=a(l,"skipMissedFrames",p.skipMissedFrames),this.randomFrame=a(l,"randomFrame",p.randomFrame),this.timeScale=a(l,"timeScale",this.timeScale);var m=a(l,"startFrame",0);m>g&&(m=0),this.randomFrame&&(m=s(0,g-1));var v=p.frames[m];m===0&&!this.forward&&(v=p.getLastFrame()),this.currentFrame=v}return this.parent},pause:function(l){return this._paused||(this._paused=!0,this._wasPlaying=this.isPlaying,this.isPlaying=!1),l!==void 0&&this.setCurrentFrame(l),this.parent},resume:function(l){return this._paused&&(this._paused=!1,this.isPlaying=this._wasPlaying),l!==void 0&&this.setCurrentFrame(l),this.parent},playAfterDelay:function(l,u){if(!this.isPlaying)this.delayCounter=u,this.play(l,!0);else{var d=this.nextAnim,p=this.nextAnimsQueue;d&&p.unshift(d),this.nextAnim=l,this._pendingStop=1,this._pendingStopValue=u}return this.parent},playAfterRepeat:function(l,u){if(u===void 0&&(u=1),!this.isPlaying)this.play(l);else{var d=this.nextAnim,p=this.nextAnimsQueue;d&&p.unshift(d),this.repeatCounter!==-1&&u>this.repeatCounter&&(u=this.repeatCounter),this.nextAnim=l,this._pendingStop=2,this._pendingStopValue=u}return this.parent},play:function(l,u){u===void 0&&(u=!1);var d=this.currentAnim,p=this.parent,g=typeof l=="string"?l:l.key;if(u&&this.isPlaying&&d.key===g)return p;if(d&&this.isPlaying){var c=this.animationManager.getMix(d.key,l);if(c>0)return this.playAfterDelay(l,c)}return this.forward=!0,this.inReverse=!1,this._paused=!1,this._wasPlaying=!0,this.startAnimation(l)},playReverse:function(l,u){u===void 0&&(u=!1);var d=typeof l=="string"?l:l.key;return u&&this.isPlaying&&this.currentAnim.key===d?this.parent:(this.forward=!1,this.inReverse=!0,this._paused=!1,this._wasPlaying=!0,this.startAnimation(l))},startAnimation:function(l){this.load(l);var u=this.currentAnim,d=this.parent;return u&&(this.repeatCounter=this.repeat===-1?Number.MAX_VALUE:this.repeat,u.getFirstTick(this),this.isPlaying=!0,this.pendingRepeat=!1,this.hasStarted=!1,this._pendingStop=0,this._pendingStopValue=0,this._paused=!1,this.delayCounter+=this.delay,this.delayCounter===0?this.handleStart():this.showBeforeDelay&&this.setCurrentFrame(this.currentFrame)),d},handleStart:function(){this.showOnStart&&this.parent.setVisible(!0),this.setCurrentFrame(this.currentFrame),this.hasStarted=!0,this.emitEvents(o.ANIMATION_START)},handleRepeat:function(){this.pendingRepeat=!1,this.emitEvents(o.ANIMATION_REPEAT)},handleStop:function(){this._pendingStop=0,this.isPlaying=!1,this.emitEvents(o.ANIMATION_STOP)},handleComplete:function(){this._pendingStop=0,this.isPlaying=!1,this.hideOnComplete&&this.parent.setVisible(!1),this.emitEvents(o.ANIMATION_COMPLETE,o.ANIMATION_COMPLETE_KEY)},emitEvents:function(l,u){var d=this.currentAnim;if(d){var p=this.currentFrame,g=this.parent,c=p.textureFrame;g.emit(l,d,p,g,c),u&&g.emit(u+d.key,d,p,g,c)}},reverse:function(){return this.isPlaying&&(this.inReverse=!this.inReverse,this.forward=!this.forward),this.parent},getProgress:function(){var l=this.currentFrame;if(!l)return 0;var u=l.progress;return this.inReverse&&(u*=-1),u},setProgress:function(l){return this.forward||(l=1-l),this.setCurrentFrame(this.currentAnim.getFrameByProgress(l)),this.parent},setRepeat:function(l){return this.repeatCounter=l===-1?Number.MAX_VALUE:l,this.parent},globalRemove:function(l,u){u===void 0&&(u=this.currentAnim),this.isPlaying&&u.key===this.currentAnim.key&&(this.stop(),this.setCurrentFrame(this.currentAnim.frames[0]))},restart:function(l,u){l===void 0&&(l=!1),u===void 0&&(u=!1);var d=this.currentAnim,p=this.parent;return d?(u&&(this.repeatCounter=this.repeat===-1?Number.MAX_VALUE:this.repeat),d.getFirstTick(this),this.emitEvents(o.ANIMATION_RESTART),this.isPlaying=!0,this.pendingRepeat=!1,this.hasStarted=!l,this._pendingStop=0,this._pendingStopValue=0,this._paused=!1,this.setCurrentFrame(d.frames[0]),this.parent):p},complete:function(){if(this._pendingStop=0,this.isPlaying=!1,this.currentAnim&&this.handleComplete(),this.nextAnim){var l=this.nextAnim;this.nextAnim=this.nextAnimsQueue.length>0?this.nextAnimsQueue.shift():null,this.play(l)}return this.parent},stop:function(){if(this._pendingStop=0,this.isPlaying=!1,this.delayCounter=0,this.currentAnim&&this.handleStop(),this.nextAnim){var l=this.nextAnim;this.nextAnim=this.nextAnimsQueue.shift(),this.play(l)}return this.parent},stopAfterDelay:function(l){return this._pendingStop=1,this._pendingStopValue=l,this.parent},stopAfterRepeat:function(l){return l===void 0&&(l=1),this.repeatCounter!==-1&&l>this.repeatCounter&&(l=this.repeatCounter),this._pendingStop=2,this._pendingStopValue=l,this.parent},stopOnFrame:function(l){return this._pendingStop=3,this._pendingStopValue=l,this.parent},getTotalFrames:function(){return this.currentAnim?this.currentAnim.getTotalFrames():0},update:function(l,u){var d=this.currentAnim;if(!(!this.isPlaying||!d||d.paused)){if(this.accumulator+=u*this.timeScale*this.animationManager.globalTimeScale,this._pendingStop===1&&(this._pendingStopValue-=u,this._pendingStopValue<=0))return this.stop();if(!this.hasStarted)this.accumulator>=this.delayCounter&&(this.accumulator-=this.delayCounter,this.handleStart());else if(this.accumulator>=this.nextTick&&(this.forward?d.nextFrame(this):d.previousFrame(this),this.isPlaying&&this._pendingStop===0&&this.skipMissedFrames&&this.accumulator>this.nextTick)){var p=0;do this.forward?d.nextFrame(this):d.previousFrame(this),p++;while(this.isPlaying&&this.accumulator>this.nextTick&&p<60)}}},setCurrentFrame:function(l){var u=this.parent;return this.currentFrame=l,u.texture=l.frame.texture,u.frame=l.frame,u.isCropped&&u.frame.updateCropUVs(u._crop,u.flipX,u.flipY),l.setAlpha&&(u.alpha=l.alpha),u.setSizeToFrame(),u._originComponent&&(l.frame.customPivot?u.setOrigin(l.frame.pivotX,l.frame.pivotY):u.updateDisplayOrigin()),this.isPlaying&&this.hasStarted&&(this.emitEvents(o.ANIMATION_UPDATE),this._pendingStop===3&&this._pendingStopValue===l&&this.stop()),u},nextFrame:function(){return this.currentAnim&&this.currentAnim.nextFrame(this),this.parent},previousFrame:function(){return this.currentAnim&&this.currentAnim.previousFrame(this),this.parent},get:function(l){return this.anims?this.anims.get(l):null},exists:function(l){return this.anims?this.anims.has(l):!1},create:function(l){var u=l.key,d=!1;return u&&(d=this.get(u),d||(d=new i(this,u,l),this.anims||(this.anims=new r),this.anims.set(u,d))),d},createFromAseprite:function(l,u){return this.animationManager.createFromAseprite(l,u,this.parent)},generateFrameNames:function(l,u){return this.animationManager.generateFrameNames(l,u)},generateFrameNumbers:function(l,u){return this.animationManager.generateFrameNumbers(l,u)},remove:function(l){var u=this.get(l);return u&&(this.currentAnim===u&&this.stop(),this.anims.delete(l)),u},destroy:function(){this.animationManager.off(o.REMOVE_ANIMATION,this.globalRemove,this),this.anims&&this.anims.clear(),this.animationManager=null,this.parent=null,this.nextAnim=null,this.nextAnimsQueue.length=0,this.currentAnim=null,this.currentFrame=null},isPaused:{get:function(){return this._paused}}});t.exports=h}),dg=y((e,t)=>{t.exports={Animation:Ur(),AnimationFrame:lh(),AnimationManager:dh(),AnimationState:Yr(),Events:vn()}}),En=y((e,t)=>{var i={TOP_LEFT:0,TOP_CENTER:1,TOP_RIGHT:2,LEFT_TOP:3,LEFT_CENTER:4,LEFT_BOTTOM:5,CENTER:6,RIGHT_TOP:7,RIGHT_CENTER:8,RIGHT_BOTTOM:9,BOTTOM_LEFT:10,BOTTOM_CENTER:11,BOTTOM_RIGHT:12};t.exports=i}),ni=y((e,t)=>{var i=function(s){return s.y+s.height-s.height*s.originY};t.exports=i}),Ts=y((e,t)=>{var i=function(s){return s.x-s.width*s.originX+s.width*.5};t.exports=i}),xs=y((e,t)=>{var i=function(s,n){var r=s.width*s.originX;return s.x=n+r-s.width*.5,s};t.exports=i}),ri=y((e,t)=>{var i=function(s,n){return s.y=n+s.height*s.originY,s};t.exports=i}),ph=y((e,t)=>{var i=ni(),s=Ts(),n=xs(),r=ri(),o=function(a,h,l,u){return l===void 0&&(l=0),u===void 0&&(u=0),n(a,s(h)+l),r(a,i(h)+u),a};t.exports=o}),ai=y((e,t)=>{var i=function(s){return s.x-s.width*s.originX};t.exports=i}),oi=y((e,t)=>{var i=function(s,n){return s.x=n+s.width*s.originX,s};t.exports=i}),gh=y((e,t)=>{var i=ni(),s=ai(),n=oi(),r=ri(),o=function(a,h,l,u){return l===void 0&&(l=0),u===void 0&&(u=0),n(a,s(h)-l),r(a,i(h)+u),a};t.exports=o}),hi=y((e,t)=>{var i=function(s){return s.x+s.width-s.width*s.originX};t.exports=i}),li=y((e,t)=>{var i=function(s,n){return s.x=n-s.width+s.width*s.originX,s};t.exports=i}),fh=y((e,t)=>{var i=ni(),s=hi(),n=li(),r=ri(),o=function(a,h,l,u){return l===void 0&&(l=0),u===void 0&&(u=0),n(a,s(h)+l),r(a,i(h)+u),a};t.exports=o}),ui=y((e,t)=>{var i=function(s,n){return s.y=n-s.height+s.height*s.originY,s};t.exports=i}),mh=y((e,t)=>{var i=ni(),s=ai(),n=ui(),r=li(),o=function(a,h,l,u){return l===void 0&&(l=0),u===void 0&&(u=0),r(a,s(h)-l),n(a,i(h)+u),a};t.exports=o}),Ss=y((e,t)=>{var i=function(s){return s.y-s.height*s.originY+s.height*.5};t.exports=i}),As=y((e,t)=>{var i=function(s,n){var r=s.height*s.originY;return s.y=n+r-s.height*.5,s};t.exports=i}),vh=y((e,t)=>{var i=Ss(),s=ai(),n=As(),r=li(),o=function(a,h,l,u){return l===void 0&&(l=0),u===void 0&&(u=0),r(a,s(h)-l),n(a,i(h)+u),a};t.exports=o}),ci=y((e,t)=>{var i=function(s){return s.y-s.height*s.originY};t.exports=i}),Eh=y((e,t)=>{var i=ai(),s=ci(),n=li(),r=ri(),o=function(a,h,l,u){return l===void 0&&(l=0),u===void 0&&(u=0),n(a,i(h)-l),r(a,s(h)-u),a};t.exports=o}),yh=y((e,t)=>{var i=ni(),s=hi(),n=ui(),r=oi(),o=function(a,h,l,u){return l===void 0&&(l=0),u===void 0&&(u=0),r(a,s(h)+l),n(a,i(h)+u),a};t.exports=o}),Th=y((e,t)=>{var i=Ss(),s=hi(),n=As(),r=oi(),o=function(a,h,l,u){return l===void 0&&(l=0),u===void 0&&(u=0),r(a,s(h)+l),n(a,i(h)+u),a};t.exports=o}),xh=y((e,t)=>{var i=hi(),s=ci(),n=oi(),r=ri(),o=function(a,h,l,u){return l===void 0&&(l=0),u===void 0&&(u=0),n(a,i(h)+l),r(a,s(h)-u),a};t.exports=o}),Sh=y((e,t)=>{var i=Ts(),s=ci(),n=ui(),r=xs(),o=function(a,h,l,u){return l===void 0&&(l=0),u===void 0&&(u=0),r(a,i(h)+l),n(a,s(h)-u),a};t.exports=o}),Ah=y((e,t)=>{var i=ai(),s=ci(),n=ui(),r=oi(),o=function(a,h,l,u){return l===void 0&&(l=0),u===void 0&&(u=0),r(a,i(h)-l),n(a,s(h)-u),a};t.exports=o}),wh=y((e,t)=>{var i=hi(),s=ci(),n=ui(),r=li(),o=function(a,h,l,u){return l===void 0&&(l=0),u===void 0&&(u=0),r(a,i(h)+l),n(a,s(h)-u),a};t.exports=o}),Ch=y((e,t)=>{var i=En(),s=[];s[i.BOTTOM_CENTER]=ph(),s[i.BOTTOM_LEFT]=gh(),s[i.BOTTOM_RIGHT]=fh(),s[i.LEFT_BOTTOM]=mh(),s[i.LEFT_CENTER]=vh(),s[i.LEFT_TOP]=Eh(),s[i.RIGHT_BOTTOM]=yh(),s[i.RIGHT_CENTER]=Th(),s[i.RIGHT_TOP]=xh(),s[i.TOP_CENTER]=Sh(),s[i.TOP_LEFT]=Ah(),s[i.TOP_RIGHT]=wh();var n=function(r,o,a,h,l){return s[a](r,o,h,l)};t.exports=n}),pg=y((e,t)=>{var i=Ch(),s=function(n,r,o,a){for(var h=n[0],l=1;l<n.length;l++){var u=n[l];i(u,h,r,o,a),h=u}return n};t.exports=s}),Me=y((e,t)=>{var i=function(s,n,r,o,a,h){o===void 0&&(o=0),a===void 0&&(a=0),h===void 0&&(h=1);var l,u=0,d=s.length;if(h===1)for(l=a;l<d;l++)s[l][n]+=r+u*o,u++;else for(l=a;l>=0;l--)s[l][n]+=r+u*o,u++;return s};t.exports=i}),gg=y((e,t)=>{var i=Me(),s=function(n,r,o,a,h){return i(n,"angle",r,o,a,h)};t.exports=s}),fg=y((e,t)=>{var i=function(s,n,r){for(var o=0;o<s.length;o++){var a=s[o];n.call(r,a)}return s};t.exports=i}),mg=y((e,t)=>{var i=function(s,n,r){r===void 0&&(r=0);for(var o=r;o<s.length;o++){var a=s[o],h=!0;for(var l in n)a[l]!==n[l]&&(h=!1);if(h)return a}return null};t.exports=i}),vg=y((e,t)=>{var i=function(s,n,r){r===void 0&&(r=0);for(var o=s.length-1;o>=r;o--){var a=s[o],h=!0;for(var l in n)a[l]!==n[l]&&(h=!1);if(h)return a}return null};t.exports=i}),Ph=y((e,t)=>{var i=ni(),s=Ts(),n=ui(),r=xs(),o=function(a,h,l,u){return l===void 0&&(l=0),u===void 0&&(u=0),r(a,s(h)+l),n(a,i(h)+u),a};t.exports=o}),Rh=y((e,t)=>{var i=ni(),s=ai(),n=ui(),r=oi(),o=function(a,h,l,u){return l===void 0&&(l=0),u===void 0&&(u=0),r(a,s(h)-l),n(a,i(h)+u),a};t.exports=o}),bh=y((e,t)=>{var i=ni(),s=hi(),n=ui(),r=li(),o=function(a,h,l,u){return l===void 0&&(l=0),u===void 0&&(u=0),r(a,s(h)+l),n(a,i(h)+u),a};t.exports=o}),Eg=y((e,t)=>{var i=xs(),s=As(),n=function(r,o,a){return i(r,o),s(r,a)};t.exports=n}),Ih=y((e,t)=>{var i=Eg(),s=Ts(),n=Ss(),r=function(o,a,h,l){return h===void 0&&(h=0),l===void 0&&(l=0),i(o,s(a)+h,n(a)+l),o};t.exports=r}),_h=y((e,t)=>{var i=Ss(),s=ai(),n=As(),r=oi(),o=function(a,h,l,u){return l===void 0&&(l=0),u===void 0&&(u=0),r(a,s(h)-l),n(a,i(h)+u),a};t.exports=o}),Oh=y((e,t)=>{var i=Ss(),s=hi(),n=As(),r=li(),o=function(a,h,l,u){return l===void 0&&(l=0),u===void 0&&(u=0),r(a,s(h)+l),n(a,i(h)+u),a};t.exports=o}),Mh=y((e,t)=>{var i=Ts(),s=ci(),n=xs(),r=ri(),o=function(a,h,l,u){return l===void 0&&(l=0),u===void 0&&(u=0),n(a,i(h)+l),r(a,s(h)-u),a};t.exports=o}),Lh=y((e,t)=>{var i=ai(),s=ci(),n=oi(),r=ri(),o=function(a,h,l,u){return l===void 0&&(l=0),u===void 0&&(u=0),n(a,i(h)-l),r(a,s(h)-u),a};t.exports=o}),Dh=y((e,t)=>{var i=hi(),s=ci(),n=li(),r=ri(),o=function(a,h,l,u){return l===void 0&&(l=0),u===void 0&&(u=0),n(a,i(h)+l),r(a,s(h)-u),a};t.exports=o}),kh=y((e,t)=>{var i=En(),s=[];s[i.BOTTOM_CENTER]=Ph(),s[i.BOTTOM_LEFT]=Rh(),s[i.BOTTOM_RIGHT]=bh(),s[i.CENTER]=Ih(),s[i.LEFT_CENTER]=_h(),s[i.RIGHT_CENTER]=Oh(),s[i.TOP_CENTER]=Mh(),s[i.TOP_LEFT]=Lh(),s[i.TOP_RIGHT]=Dh(),s[i.LEFT_BOTTOM]=s[i.BOTTOM_LEFT],s[i.LEFT_TOP]=s[i.TOP_LEFT],s[i.RIGHT_BOTTOM]=s[i.BOTTOM_RIGHT],s[i.RIGHT_TOP]=s[i.TOP_RIGHT];var n=function(r,o,a,h,l){return s[a](r,o,h,l)};t.exports=n}),Rt=y((e,t)=>{var i=function(){};t.exports=i}),Ni=y((e,t)=>{var i=function(s,n,r){if(s.radius>0&&n>=s.left&&n<=s.right&&r>=s.top&&r<=s.bottom){var o=(s.x-n)*(s.x-n),a=(s.y-r)*(s.y-r);return o+a<=s.radius*s.radius}else return!1};t.exports=i}),xi=y((e,t)=>{var i={CIRCLE:0,ELLIPSE:1,LINE:2,POINT:3,POLYGON:4,RECTANGLE:5,TRIANGLE:6};t.exports=i}),Mt=y((e,t)=>{var i=W(),s=xi(),n=new i({initialize:function(r,o){r===void 0&&(r=0),o===void 0&&(o=r),this.type=s.POINT,this.x=r,this.y=o},setTo:function(r,o){return r===void 0&&(r=0),o===void 0&&(o=r),this.x=r,this.y=o,this}});t.exports=n}),Hr=y((e,t)=>{var i=Mt(),s=function(n,r,o){return o===void 0&&(o=new i),o.x=n.x+n.radius*Math.cos(r),o.y=n.y+n.radius*Math.sin(r),o};t.exports=s}),ws=y((e,t)=>{var i=Ot(),s=function(n,r,o){return n=i(n,0,1),(o-r)*n+r};t.exports=s}),Fh=y((e,t)=>{var i=Hr(),s=ws(),n=Gt(),r=Mt(),o=function(a,h,l){l===void 0&&(l=new r);var u=s(h,0,n.PI2);return i(a,u,l)};t.exports=o}),Nh=y((e,t)=>{var i=function(s){return 2*(Math.PI*s.radius)};t.exports=i}),Bh=y((e,t)=>{var i=Nh(),s=Hr(),n=ws(),r=Gt(),o=function(a,h,l,u){u===void 0&&(u=[]),!h&&l>0&&(h=i(a)/l);for(var d=0;d<h;d++){var p=n(d/h,0,r.PI2);u.push(s(a,p))}return u};t.exports=o}),zr=y((e,t)=>{var i=Mt(),s=function(n,r){r===void 0&&(r=new i);var o=2*Math.PI*Math.random(),a=Math.random()+Math.random(),h=a>1?2-a:a,l=h*Math.cos(o),u=h*Math.sin(o);return r.x=n.x+l*n.radius,r.y=n.y+u*n.radius,r};t.exports=s}),yn=y((e,t)=>{var i=W(),s=Ni(),n=Fh(),r=Bh(),o=xi(),a=zr(),h=new i({initialize:function(l,u,d){l===void 0&&(l=0),u===void 0&&(u=0),d===void 0&&(d=0),this.type=o.CIRCLE,this.x=l,this.y=u,this._radius=d,this._diameter=d*2},contains:function(l,u){return s(this,l,u)},getPoint:function(l,u){return n(this,l,u)},getPoints:function(l,u,d){return r(this,l,u,d)},getRandomPoint:function(l){return a(this,l)},setTo:function(l,u,d){return this.x=l,this.y=u,this._radius=d,this._diameter=d*2,this},setEmpty:function(){return this._radius=0,this._diameter=0,this},setPosition:function(l,u){return u===void 0&&(u=l),this.x=l,this.y=u,this},isEmpty:function(){return this._radius<=0},radius:{get:function(){return this._radius},set:function(l){this._radius=l,this._diameter=l*2}},diameter:{get:function(){return this._diameter},set:function(l){this._diameter=l,this._radius=l*.5}},left:{get:function(){return this.x-this._radius},set:function(l){this.x=l+this._radius}},right:{get:function(){return this.x+this._radius},set:function(l){this.x=l-this._radius}},top:{get:function(){return this.y-this._radius},set:function(l){this.y=l+this._radius}},bottom:{get:function(){return this.y+this._radius},set:function(l){this.y=l-this._radius}}});t.exports=h}),yg=y((e,t)=>{var i=Ot(),s=2,n={_alpha:1,_alphaTL:1,_alphaTR:1,_alphaBL:1,_alphaBR:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(r,o,a,h){return r===void 0&&(r=1),o===void 0?this.alpha=r:(this._alphaTL=i(r,0,1),this._alphaTR=i(o,0,1),this._alphaBL=i(a,0,1),this._alphaBR=i(h,0,1)),this},alpha:{get:function(){return this._alpha},set:function(r){var o=i(r,0,1);this._alpha=o,this._alphaTL=o,this._alphaTR=o,this._alphaBL=o,this._alphaBR=o,o===0?this.renderFlags&=~s:this.renderFlags|=s}},alphaTopLeft:{get:function(){return this._alphaTL},set:function(r){var o=i(r,0,1);this._alphaTL=o,o!==0&&(this.renderFlags|=s)}},alphaTopRight:{get:function(){return this._alphaTR},set:function(r){var o=i(r,0,1);this._alphaTR=o,o!==0&&(this.renderFlags|=s)}},alphaBottomLeft:{get:function(){return this._alphaBL},set:function(r){var o=i(r,0,1);this._alphaBL=o,o!==0&&(this.renderFlags|=s)}},alphaBottomRight:{get:function(){return this._alphaBR},set:function(r){var o=i(r,0,1);this._alphaBR=o,o!==0&&(this.renderFlags|=s)}}};t.exports=n}),Tg=y((e,t)=>{var i=Ot(),s=2,n={_alpha:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(r){return r===void 0&&(r=1),this.alpha=r,this},alpha:{get:function(){return this._alpha},set:function(r){var o=i(r,0,1);this._alpha=o,o===0?this.renderFlags&=~s:this.renderFlags|=s}}};t.exports=n}),xg=y((e,t)=>{var i=Ge(),s={_blendMode:i.NORMAL,blendMode:{get:function(){return this._blendMode},set:function(n){typeof n=="string"&&(n=i[n]),n|=0,n>=-1&&(this._blendMode=n)}},setBlendMode:function(n){return this.blendMode=n,this}};t.exports=s}),Sg=y((e,t)=>{var i={width:0,height:0,displayWidth:{get:function(){return this.scaleX*this.width},set:function(s){this.scaleX=s/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(s){this.scaleY=s/this.height}},setSize:function(s,n){return this.width=s,this.height=n,this},setDisplaySize:function(s,n){return this.displayWidth=s,this.displayHeight=n,this}};t.exports=i}),Ag=y((e,t)=>{var i={texture:null,frame:null,isCropped:!1,setCrop:function(s,n,r,o){if(s===void 0)this.isCropped=!1;else if(this.frame){if(typeof s=="number")this.frame.setCropUVs(this._crop,s,n,r,o,this.flipX,this.flipY);else{var a=s;this.frame.setCropUVs(this._crop,a.x,a.y,a.width,a.height,this.flipX,this.flipY)}this.isCropped=!0}return this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:!1,flipY:!1,cx:0,cy:0,cw:0,ch:0}}};t.exports=i}),Wr=y((e,t)=>{var i=function(s){if(!Array.isArray(s)||!Array.isArray(s[0]))return!1;for(var n=s[0].length,r=1;r<s.length;r++)if(s[r].length!==n)return!1;return!0};t.exports=i}),wg=y((e,t)=>{var i=Gr(),s=Wr(),n=function(r){var o="";if(!s(r))return o;for(var a=0;a<r.length;a++){for(var h=0;h<r[a].length;h++){var l=r[a][h].toString();l!=="undefined"?o+=i(l,2):o+="?",h<r[a].length-1&&(o+=" |")}if(a<r.length-1){o+=`
`;for(var u=0;u<r[a].length;u++)o+="---",u<r[a].length-1&&(o+="+");o+=`
`}}return o};t.exports=n}),Cg=y((e,t)=>{var i=function(s){return s.reverse()};t.exports=i}),Pg=y((e,t)=>{var i=function(s){for(var n=0;n<s.length;n++)s[n].reverse();return s};t.exports=i}),Uh=y((e,t)=>{var i=function(s){for(var n=s.length,r=s[0].length,o=new Array(r),a=0;a<r;a++){o[a]=new Array(n);for(var h=n-1;h>-1;h--)o[a][h]=s[h][a]}return o};t.exports=i}),Tn=y((e,t)=>{var i=Wr(),s=Uh(),n=function(r,o){if(o===void 0&&(o=90),!i(r))return null;if(typeof o!="string"&&(o=(o%360+360)%360),o===90||o===-270||o==="rotateLeft")r=s(r),r.reverse();else if(o===-90||o===270||o==="rotateRight")r.reverse(),r=s(r);else if(Math.abs(o)===180||o==="rotate180"){for(var a=0;a<r.length;a++)r[a].reverse();r.reverse()}return r};t.exports=n}),Rg=y((e,t)=>{var i=Tn(),s=function(n){return i(n,180)};t.exports=s}),bg=y((e,t)=>{var i=Tn(),s=function(n,r){r===void 0&&(r=1);for(var o=0;o<r;o++)n=i(n,90);return n};t.exports=s}),Ig=y((e,t)=>{var i=Tn(),s=function(n,r){r===void 0&&(r=1);for(var o=0;o<r;o++)n=i(n,-90);return n};t.exports=s}),Vr=y((e,t)=>{var i=function(s,n){n===void 0&&(n=1);for(var r=null,o=0;o<n;o++)r=s.shift(),s.push(r);return r};t.exports=i}),Xr=y((e,t)=>{var i=function(s,n){n===void 0&&(n=1);for(var r=null,o=0;o<n;o++)r=s.pop(),s.unshift(r);return r};t.exports=i}),_g=y((e,t)=>{var i=Vr(),s=Xr(),n=function(r,o,a){if(o===void 0&&(o=0),a===void 0&&(a=0),a!==0&&(a<0?i(r,Math.abs(a)):s(r,a)),o!==0)for(var h=0;h<r.length;h++){var l=r[h];o<0?i(l,Math.abs(o)):s(l,o)}return r};t.exports=n}),Og=y((e,t)=>{t.exports={CheckMatrix:Wr(),MatrixToString:wg(),ReverseColumns:Cg(),ReverseRows:Pg(),Rotate180:Rg(),RotateLeft:bg(),RotateMatrix:Tn(),RotateRight:Ig(),Translate:_g(),TransposeMatrix:Uh()}}),Mg=y((e,t)=>{var i=function(s,n,r,o,a){if(a===void 0&&(a=s),r>0){var h=r-s.length;if(h<=0)return null}if(!Array.isArray(n))return s.indexOf(n)===-1?(s.push(n),o&&o.call(a,n),n):null;for(var l=n.length-1;l>=0;)s.indexOf(n[l])!==-1&&n.splice(l,1),l--;if(l=n.length,l===0)return null;r>0&&l>h&&(n.splice(h),l=h);for(var u=0;u<l;u++){var d=n[u];s.push(d),o&&o.call(a,d)}return n};t.exports=i}),Lg=y((e,t)=>{var i=function(s,n,r,o,a,h){if(r===void 0&&(r=0),h===void 0&&(h=s),o>0){var l=o-s.length;if(l<=0)return null}if(!Array.isArray(n))return s.indexOf(n)===-1?(s.splice(r,0,n),a&&a.call(h,n),n):null;for(var u=n.length-1;u>=0;)s.indexOf(n[u])!==-1&&n.pop(),u--;if(u=n.length,u===0)return null;o>0&&u>l&&(n.splice(l),u=l);for(var d=u-1;d>=0;d--){var p=n[d];s.splice(r,0,p),a&&a.call(h,p)}return n};t.exports=i}),Dg=y((e,t)=>{var i=function(s,n){var r=s.indexOf(n);return r!==-1&&r<s.length&&(s.splice(r,1),s.push(n)),n};t.exports=i}),Si=y((e,t)=>{var i=function(s,n,r,o){var a=s.length;if(n<0||n>=a||n>=r||r>a){if(o)throw new Error("Range Error: Values outside acceptable range");return!1}else return!0};t.exports=i}),kg=y((e,t)=>{var i=Si(),s=function(n,r,o,a,h){a===void 0&&(a=0),h===void 0&&(h=n.length);var l=0;if(i(n,a,h))for(var u=a;u<h;u++){var d=n[u];d[r]===o&&l++}return l};t.exports=s}),xn=y((e,t)=>{var i=function(s,n,r){var o,a=[null];for(o=3;o<arguments.length;o++)a.push(arguments[o]);for(o=0;o<s.length;o++)a[0]=s[o],n.apply(r,a);return s};t.exports=i}),Fg=y((e,t)=>{var i=Si(),s=function(n,r,o,a,h){if(a===void 0&&(a=0),h===void 0&&(h=n.length),i(n,a,h)){var l,u=[null];for(l=5;l<arguments.length;l++)u.push(arguments[l]);for(l=a;l<h;l++)u[0]=n[l],r.apply(o,u)}return n};t.exports=s}),Gh=y((e,t)=>{var i=function(s,n){n===void 0&&(n=[]);for(var r=0;r<s.length;r++)Array.isArray(s[r])?i(s[r],n):n.push(s[r]);return n};t.exports=i}),Kr=y((e,t)=>{var i=Si(),s=function(n,r,o,a,h){a===void 0&&(a=0),h===void 0&&(h=n.length);var l=[];if(i(n,a,h))for(var u=a;u<h;u++){var d=n[u];(!r||r&&o===void 0&&d.hasOwnProperty(r)||r&&o!==void 0&&d[r]===o)&&l.push(d)}return l};t.exports=s}),Yh=y((e,t)=>{var i=Si(),s=function(n,r,o,a,h){if(a===void 0&&(a=0),h===void 0&&(h=n.length),a!==-1){if(i(n,a,h))for(var l=a;l<h;l++){var u=n[l];if(!r||r&&o===void 0&&u.hasOwnProperty(r)||r&&o!==void 0&&u[r]===o)return u}}else if(i(n,0,h))for(var l=h;l>=0;l--){var u=n[l];if(!r||r&&o===void 0&&u.hasOwnProperty(r)||r&&o!==void 0&&u[r]===o)return u}return null};t.exports=s}),Hh=y((e,t)=>{var i=function(s,n,r){n===void 0&&(n=0),r===void 0&&(r=s.length);var o=n+Math.floor(Math.random()*r);return s[o]===void 0?null:s[o]};t.exports=i}),Ng=y((e,t)=>{var i=function(s,n){var r=s.indexOf(n);if(r>0){var o=s[r-1],a=s.indexOf(o);s[r]=o,s[a]=n}return s};t.exports=i}),Bg=y((e,t)=>{var i=function(s,n,r){var o=s.indexOf(n);if(o===-1||r<0||r>=s.length)throw new Error("Supplied index out of bounds");return o!==r&&(s.splice(o,1),s.splice(r,0,n)),n};t.exports=i}),Ug=y((e,t)=>{var i=function(s,n){var r=s.indexOf(n);if(r!==-1&&r<s.length-1){var o=s[r+1],a=s.indexOf(o);s[r]=o,s[a]=n}return s};t.exports=i}),Gg=y((e,t)=>{var i=function(s,n,r){if(n===r)return s;var o=s.indexOf(n),a=s.indexOf(r);if(o<0||a<0)throw new Error("Supplied items must be elements of the same array");return o>a||(s.splice(o,1),a=s.indexOf(r),s.splice(a+1,0,n)),s};t.exports=i}),Yg=y((e,t)=>{var i=function(s,n,r){if(n===r)return s;var o=s.indexOf(n),a=s.indexOf(r);if(o<0||a<0)throw new Error("Supplied items must be elements of the same array");return o<a||(s.splice(o,1),a===0?s.unshift(n):s.splice(a,0,n)),s};t.exports=i}),zh=y((e,t)=>{var i=function(s){return s>0?Math.ceil(s):Math.floor(s)};t.exports=i}),Hg=y((e,t)=>{var i=zh(),s=function(n,r,o){n===void 0&&(n=0),r===void 0&&(r=null),o===void 0&&(o=1),r===null&&(r=n,n=0);for(var a=[],h=Math.max(i((r-n)/(o||1)),0),l=0;l<h;l++)a.push(n),n+=o;return a};t.exports=s}),zg=y((e,t)=>{function i(r,o,a){var h=r[o];r[o]=r[a],r[a]=h}function s(r,o){return r<o?-1:r>o?1:0}var n=function(r,o,a,h,l){for(a===void 0&&(a=0),h===void 0&&(h=r.length-1),l===void 0&&(l=s);h>a;){if(h-a>600){var u=h-a+1,d=o-a+1,p=Math.log(u),g=.5*Math.exp(2*p/3),c=.5*Math.sqrt(p*g*(u-g)/u)*(d-u/2<0?-1:1),f=Math.max(a,Math.floor(o-d*g/u+c)),m=Math.min(h,Math.floor(o+(u-d)*g/u+c));n(r,o,f,m,l)}var v=r[o],E=a,x=h;for(i(r,a,o),l(r[h],v)>0&&i(r,a,h);E<x;){for(i(r,E,x),E++,x--;l(r[E],v)<0;)E++;for(;l(r[x],v)>0;)x--}l(r[a],v)===0?i(r,a,x):(x++,i(r,x,h)),x<=o&&(a=x+1),o<=x&&(h=x-1)}};t.exports=n}),jr=y((e,t)=>{var i=function(s){for(var n=s.length-1;n>0;n--){var r=Math.floor(Math.random()*(n+1)),o=s[n];s[n]=s[r],s[r]=o}return s};t.exports=i}),Wh=y((e,t)=>{var i=St(),s=jr(),n=function(o,a,h){for(var l=[],u=0;u<o.length;u++)for(var d=0;d<a.length;d++)for(var p=0;p<h;p++)l.push({a:o[u],b:a[d]});return l},r=function(o,a,h){var l=i(h,"max",0),u=i(h,"qty",1),d=i(h,"random",!1),p=i(h,"randomB",!1),g=i(h,"repeat",0),c=i(h,"yoyo",!1),f=[];if(p&&s(a),g===-1)if(l===0)g=0;else{var m=o.length*a.length*u;c&&(m*=2),g=Math.ceil(l/m)}for(var v=0;v<=g;v++){var E=n(o,a,u);d&&s(E),f=f.concat(E),c&&(E.reverse(),f=f.concat(E))}return l&&f.splice(l),f};t.exports=r}),Bi=y((e,t)=>{var i=function(s,n){if(!(n>=s.length)){for(var r=s.length-1,o=s[n],a=n;a<r;a++)s[a]=s[a+1];return s.length=r,o}};t.exports=i}),Ye=y((e,t)=>{var i=Bi(),s=function(n,r,o,a){a===void 0&&(a=n);var h;if(!Array.isArray(r))return h=n.indexOf(r),h!==-1?(i(n,h),o&&o.call(a,r),r):null;for(var l=r.length-1,u=[];l>=0;){var d=r[l];h=n.indexOf(d),h!==-1&&(i(n,h),u.push(d),o&&o.call(a,d)),l--}return u};t.exports=s}),Wg=y((e,t)=>{var i=Bi(),s=function(n,r,o,a){if(a===void 0&&(a=n),r<0||r>n.length-1)throw new Error("Index out of bounds");var h=i(n,r);return o&&o.call(a,h),h};t.exports=s}),Vg=y((e,t)=>{var i=Si(),s=function(n,r,o,a,h){if(r===void 0&&(r=0),o===void 0&&(o=n.length),h===void 0&&(h=n),i(n,r,o)){var l=o-r,u=n.splice(r,l);if(a)for(var d=0;d<u.length;d++){var p=u[d];a.call(h,p)}return u}else return[]};t.exports=s}),Xg=y((e,t)=>{var i=Bi(),s=function(n,r,o){r===void 0&&(r=0),o===void 0&&(o=n.length);var a=r+Math.floor(Math.random()*o);return i(n,a)};t.exports=s}),Kg=y((e,t)=>{var i=function(s,n,r){var o=s.indexOf(n),a=s.indexOf(r);return o!==-1&&a===-1?(s[o]=r,!0):!1};t.exports=i}),jg=y((e,t)=>{var i=function(s,n){var r=s.indexOf(n);return r!==-1&&r>0&&(s.splice(r,1),s.unshift(n)),n};t.exports=i}),Zg=y((e,t)=>{var i=Si(),s=function(n,r,o,a,h){if(a===void 0&&(a=0),h===void 0&&(h=n.length),i(n,a,h))for(var l=a;l<h;l++){var u=n[l];u.hasOwnProperty(r)&&(u[r]=o)}return n};t.exports=s}),Cs=y((e,t)=>{var i={android:!1,chromeOS:!1,cordova:!1,crosswalk:!1,desktop:!1,ejecta:!1,electron:!1,iOS:!1,iOSVersion:0,iPad:!1,iPhone:!1,kindle:!1,linux:!1,macOS:!1,node:!1,nodeWebkit:!1,pixelRatio:1,webApp:!1,windows:!1,windowsPhone:!1};function s(){if(typeof importScripts=="function")return i;var n=navigator.userAgent;/Windows/.test(n)?i.windows=!0:/Mac OS/.test(n)&&!/like Mac OS/.test(n)?navigator.maxTouchPoints&&navigator.maxTouchPoints>2?(i.iOS=!0,i.iPad=!0,navigator.appVersion.match(/Version\/(\d+)/),i.iOSVersion=parseInt(RegExp.$1,10)):i.macOS=!0:/Android/.test(n)?i.android=!0:/Linux/.test(n)?i.linux=!0:/iP[ao]d|iPhone/i.test(n)?(i.iOS=!0,navigator.appVersion.match(/OS (\d+)/),i.iOSVersion=parseInt(RegExp.$1,10),i.iPhone=n.toLowerCase().indexOf("iphone")!==-1,i.iPad=n.toLowerCase().indexOf("ipad")!==-1):/Kindle/.test(n)||/\bKF[A-Z][A-Z]+/.test(n)||/Silk.*Mobile Safari/.test(n)?i.kindle=!0:/CrOS/.test(n)&&(i.chromeOS=!0),(/Windows Phone/i.test(n)||/IEMobile/i.test(n))&&(i.android=!1,i.iOS=!1,i.macOS=!1,i.windows=!0,i.windowsPhone=!0);var r=/Silk/.test(n);return(i.windows||i.macOS||i.linux&&!r||i.chromeOS)&&(i.desktop=!0),(i.windowsPhone||/Windows NT/i.test(n)&&/Touch/i.test(n))&&(i.desktop=!1),navigator.standalone&&(i.webApp=!0),typeof importScripts!="function"&&(window.cordova!==void 0&&(i.cordova=!0),window.ejecta!==void 0&&(i.ejecta=!0)),typeof process<"u"&&process.versions&&process.versions.node&&(i.node=!0),i.node&&typeof process.versions=="object"&&(i.nodeWebkit=!!process.versions["node-webkit"],i.electron=!!process.versions.electron),/Crosswalk/.test(n)&&(i.crosswalk=!0),i.pixelRatio=window.devicePixelRatio||1,i}t.exports=s()}),Sn=y((e,t)=>{var i=Cs(),s={chrome:!1,chromeVersion:0,edge:!1,firefox:!1,firefoxVersion:0,ie:!1,ieVersion:0,mobileSafari:!1,opera:!1,safari:!1,safariVersion:0,silk:!1,trident:!1,tridentVersion:0,es2019:!1};function n(){var r=navigator.userAgent;return/Edg\/\d+/.test(r)?(s.edge=!0,s.es2019=!0):/OPR/.test(r)?(s.opera=!0,s.es2019=!0):/Chrome\/(\d+)/.test(r)&&!i.windowsPhone?(s.chrome=!0,s.chromeVersion=parseInt(RegExp.$1,10),s.es2019=s.chromeVersion>69):/Firefox\D+(\d+)/.test(r)?(s.firefox=!0,s.firefoxVersion=parseInt(RegExp.$1,10),s.es2019=s.firefoxVersion>10):/AppleWebKit\/(?!.*CriOS)/.test(r)&&i.iOS?(s.mobileSafari=!0,s.es2019=!0):/MSIE (\d+\.\d+);/.test(r)?(s.ie=!0,s.ieVersion=parseInt(RegExp.$1,10)):/Version\/(\d+\.\d+(\.\d+)?) Safari/.test(r)&&!i.windowsPhone?(s.safari=!0,s.safariVersion=parseInt(RegExp.$1,10),s.es2019=s.safariVersion>10):/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(r)&&(s.ie=!0,s.trident=!0,s.tridentVersion=parseInt(RegExp.$1,10),s.ieVersion=parseInt(RegExp.$3,10)),/Silk/.test(r)&&(s.silk=!0),s}t.exports=n()}),qg=y((e,t)=>{var i="",s=function(){var n=function(h){for(var l=["i","webkitI","msI","mozI","oI"],u=0;u<l.length;u++){var d=l[u]+"mageSmoothingEnabled";if(d in h)return d}return null},r=function(h){return i===""&&(i=n(h)),i&&(h[i]=!0),h},o=function(h){return i===""&&(i=n(h)),i&&(h[i]=!1),h},a=function(h){return i!==null?h[i]:null};return{disable:o,enable:r,getPrefix:n,isEnabled:a}};t.exports=s()}),xe=y((e,t)=>{var i=Pe(),s=qg(),n=[],r=!1,o=function(){var a=function(m,v,E,x,T){v===void 0&&(v=1),E===void 0&&(E=1),x===void 0&&(x=i.CANVAS),T===void 0&&(T=!1);var A,P=u(x);return P===null?(P={parent:m,canvas:document.createElement("canvas"),type:x},x===i.CANVAS&&n.push(P),A=P.canvas):(P.parent=m,A=P.canvas),T&&(P.parent=A),A.width=v,A.height=E,r&&x===i.CANVAS&&s.disable(A.getContext("2d",{willReadFrequently:!1})),A},h=function(m,v,E){return a(m,v,E,i.CANVAS)},l=function(m,v,E){return a(m,v,E,i.WEBGL)},u=function(m){if(m===void 0&&(m=i.CANVAS),m===i.WEBGL)return null;for(var v=0;v<n.length;v++){var E=n[v];if(!E.parent&&E.type===m)return E}return null},d=function(m){var v=m instanceof HTMLCanvasElement;n.forEach(function(E){(v&&E.canvas===m||!v&&E.parent===m)&&(E.parent=null,E.canvas.width=1,E.canvas.height=1)})},p=function(){var m=0;return n.forEach(function(v){v.parent&&m++}),m},g=function(){return n.length-p()},c=function(){r=!0},f=function(){r=!1};return{create2D:h,create:a,createWebGL:l,disableSmoothing:c,enableSmoothing:f,first:u,free:g,pool:n,remove:d,total:p}};t.exports=o()}),Zr=y((e,t)=>{var i=Cs(),s=Sn(),n=xe(),r={canvas:!1,canvasBitBltShift:null,file:!1,fileSystem:!1,getUserMedia:!0,littleEndian:!1,localStorage:!1,pointerLock:!1,stableSort:!1,support32bit:!1,vibration:!1,webGL:!1,worker:!1};function o(){var h=new ArrayBuffer(4),l=new Uint8Array(h),u=new Uint32Array(h);return l[0]=161,l[1]=178,l[2]=195,l[3]=212,u[0]===3569595041?!0:u[0]===2712847316?!1:null}function a(){if(typeof importScripts=="function")return r;r.canvas=!!window.CanvasRenderingContext2D;try{r.localStorage=!!localStorage.getItem}catch{r.localStorage=!1}r.file=!!window.File&&!!window.FileReader&&!!window.FileList&&!!window.Blob,r.fileSystem=!!window.requestFileSystem;var h=!1,l=function(){if(window.WebGLRenderingContext)try{var u=n.createWebGL(this),d=u.getContext("webgl")||u.getContext("experimental-webgl"),p=n.create2D(this),g=p.getContext("2d",{willReadFrequently:!0}),c=g.createImageData(1,1);return h=c.data instanceof Uint8ClampedArray,n.remove(u),n.remove(p),!!d}catch{return!1}return!1};return r.webGL=l(),r.worker=!!window.Worker,r.pointerLock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,r.getUserMedia=r.getUserMedia&&!!navigator.getUserMedia&&!!window.URL,s.firefox&&s.firefoxVersion<21&&(r.getUserMedia=!1),!i.iOS&&(s.ie||s.firefox||s.chrome)&&(r.canvasBitBltShift=!0),(s.safari||s.mobileSafari)&&(r.canvasBitBltShift=!1),navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate,navigator.vibrate&&(r.vibration=!0),typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint32Array<"u"&&(r.littleEndian=o()),r.support32bit=typeof ArrayBuffer<"u"&&typeof Uint8ClampedArray<"u"&&typeof Int32Array<"u"&&r.littleEndian!==null&&h,r}t.exports=a()}),Jg=y((e,t)=>{var i=Sn(),s={gamepads:!1,mspointer:!1,touch:!1,wheelEvent:null};function n(){return typeof importScripts=="function"||(("ontouchstart"in document.documentElement||navigator.maxTouchPoints&&navigator.maxTouchPoints>=1)&&(s.touch=!0),(navigator.msPointerEnabled||navigator.pointerEnabled)&&(s.mspointer=!0),navigator.getGamepads&&(s.gamepads=!0),"onwheel"in window||i.ie&&"WheelEvent"in window?s.wheelEvent="wheel":"onmousewheel"in window?s.wheelEvent="mousewheel":i.firefox&&"MouseScrollEvent"in window&&(s.wheelEvent="DOMMouseScroll")),s}t.exports=n()}),Qg=y((e,t)=>{var i=Sn(),s={flac:!1,aac:!1,audioData:!1,dolby:!1,m4a:!1,mp3:!1,ogg:!1,opus:!1,wav:!1,webAudio:!1,webm:!1};function n(){if(typeof importScripts=="function")return s;s.audioData=!!window.Audio,s.webAudio=!!(window.AudioContext||window.webkitAudioContext);var r=document.createElement("audio"),o=!!r.canPlayType;try{if(o){var a=function(u,d){var p=r.canPlayType("audio/"+u).replace(/^no$/,"");return d?!!(p||r.canPlayType("audio/"+d).replace(/^no$/,"")):!!p};if(s.ogg=a('ogg; codecs="vorbis"'),s.opus=a('ogg; codecs="opus"',"opus"),s.mp3=a("mpeg"),s.wav=a("wav"),s.m4a=a("x-m4a"),s.aac=a("aac"),s.flac=a("flac","x-flac"),s.webm=a('webm; codecs="vorbis"'),r.canPlayType('audio/mp4; codecs="ec-3"')!==""){if(i.edge)s.dolby=!0;else if(i.safari&&i.safariVersion>=9&&/Mac OS X (\d+)_(\d+)/.test(navigator.userAgent)){var h=parseInt(RegExp.$1,10),l=parseInt(RegExp.$2,10);(h===10&&l>=11||h>10)&&(s.dolby=!0)}}}}catch{}return s}t.exports=n()}),$g=y((e,t)=>{var i=dt(),s={h264:!1,hls:!1,mp4:!1,m4v:!1,ogg:!1,vp9:!1,webm:!1,hasRequestVideoFrame:!1};function n(){if(typeof importScripts=="function")return s;var r=document.createElement("video"),o=!!r.canPlayType,a=/^no$/;try{o&&(r.canPlayType('video/ogg; codecs="theora"').replace(a,"")&&(s.ogg=!0),r.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(a,"")&&(s.h264=!0,s.mp4=!0),r.canPlayType("video/x-m4v").replace(a,"")&&(s.m4v=!0),r.canPlayType('video/webm; codecs="vp8, vorbis"').replace(a,"")&&(s.webm=!0),r.canPlayType('video/webm; codecs="vp9"').replace(a,"")&&(s.vp9=!0),r.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(a,"")&&(s.hls=!0))}catch{}return r.parentNode&&r.parentNode.removeChild(r),s.getVideoURL=function(h){Array.isArray(h)||(h=[h]);for(var l=0;l<h.length;l++){var u=i(h[l],"url",h[l]);if(u.indexOf("blob:")===0)return{url:u,type:""};var d;if(u.indexOf("data:")===0?d=u.split(",")[0].match(/\/(.*?);/):d=u.match(/\.([a-zA-Z0-9]+)($|\?)/),d=i(h[l],"type",d?d[1]:"").toLowerCase(),s[d])return{url:u,type:d}}return null},s}t.exports=n()}),tf=y((e,t)=>{var i={available:!1,cancel:"",keyboard:!1,request:""};function s(){if(typeof importScripts=="function")return i;var n,r="Fullscreen",o="FullScreen",a=["request"+r,"request"+o,"webkitRequest"+r,"webkitRequest"+o,"msRequest"+r,"msRequest"+o,"mozRequest"+o,"mozRequest"+r];for(n=0;n<a.length;n++)if(document.documentElement[a[n]]){i.available=!0,i.request=a[n];break}var h=["cancel"+o,"exit"+r,"webkitCancel"+o,"webkitExit"+r,"msCancel"+o,"msExit"+r,"mozCancel"+o,"mozExit"+r];if(i.available){for(n=0;n<h.length;n++)if(document[h[n]]){i.cancel=h[n];break}}return window.Element&&Element.ALLOW_KEYBOARD_INPUT&&!/ Version\/5\.1(?:\.\d+)? Safari\//.test(navigator.userAgent)&&(i.keyboard=!0),Object.defineProperty(i,"active",{get:function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}}),i}t.exports=s()}),Vh=y((e,t)=>{var i=xe(),s={supportInverseAlpha:!1,supportNewBlendModes:!1};function n(){var a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/",h="AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==",l=new Image;return l.onload=function(){var u=new Image;u.onload=function(){var d=i.create2D(u,6),p=d.getContext("2d",{willReadFrequently:!0});if(p.globalCompositeOperation="multiply",p.drawImage(l,0,0),p.drawImage(u,2,0),!p.getImageData(2,0,1,1))return!1;var g=p.getImageData(2,0,1,1).data;i.remove(u),s.supportNewBlendModes=g[0]===255&&g[1]===0&&g[2]===0},u.src=a+"/wCKxvRF"+h},l.src=a+"AP804Oa6"+h,!1}function r(){var a=i.create2D(this,2),h=a.getContext("2d",{willReadFrequently:!0});h.fillStyle="rgba(10, 20, 30, 0.5)",h.fillRect(0,0,1,1);var l=h.getImageData(0,0,1,1);if(l===null)return!1;h.putImageData(l,1,0);var u=h.getImageData(1,0,1,1),d=u.data[0]===l.data[0]&&u.data[1]===l.data[1]&&u.data[2]===l.data[2]&&u.data[3]===l.data[3];return i.remove(this),d}function o(){return typeof importScripts!="function"&&document!==void 0&&(s.supportNewBlendModes=n(),s.supportInverseAlpha=r()),s}t.exports=o()}),An=y((e,t)=>{t.exports={os:Cs(),browser:Sn(),features:Zr(),input:Jg(),audio:Qg(),video:$g(),fullscreen:tf(),canvasFeatures:Vh()}}),wn=y((e,t)=>{var i=An();function s(a,h){return String(a).localeCompare(h)}function n(a,h){var l=a.length;if(l<=1)return a;for(var u=new Array(l),d=1;d<l;d*=2){r(a,h,d,u);var p=a;a=u,u=p}return a}function r(a,h,l,u){var d=a.length,p=0,g=l*2,c,f,m,v,E;for(c=0;c<d;c+=g)for(f=c+l,m=f+l,f>d&&(f=d),m>d&&(m=d),v=c,E=f;;)if(v<f&&E<m)h(a[v],a[E])<=0?u[p++]=a[v++]:u[p++]=a[E++];else if(v<f)u[p++]=a[v++];else if(E<m)u[p++]=a[E++];else break}var o=function(a,h){if(h===void 0&&(h=s),!a||a.length<2)return a;if(i.features.stableSort)return a.sort(h);var l=n(a,h);return l!==a&&r(l,null,a.length,a),a};t.exports=o}),ef=y((e,t)=>{var i=function(s,n,r){if(n===r)return s;var o=s.indexOf(n),a=s.indexOf(r);if(o<0||a<0)throw new Error("Supplied items must be elements of the same array");return s[o]=r,s[a]=n,s};t.exports=i}),Cn=y((e,t)=>{t.exports={Matrix:Og(),Add:Mg(),AddAt:Lg(),BringToTop:Dg(),CountAllMatching:kg(),Each:xn(),EachInRange:Fg(),FindClosestInSorted:hh(),Flatten:Gh(),GetAll:Kr(),GetFirst:Yh(),GetRandom:Hh(),MoveDown:Ng(),MoveTo:Bg(),MoveUp:Ug(),MoveAbove:Gg(),MoveBelow:Yg(),NumberArray:ch(),NumberArrayStep:Hg(),QuickSelect:zg(),Range:Wh(),Remove:Ye(),RemoveAt:Wg(),RemoveBetween:Vg(),RemoveRandomElement:Xg(),Replace:Kg(),RotateLeft:Vr(),RotateRight:Xr(),SafeRange:Si(),SendToBack:jg(),SetAll:Zg(),Shuffle:jr(),SortByDigits:uh(),SpliceOne:Bi(),StableSort:wn(),Swap:ef()}}),sf=y((e,t)=>{var i=Cn(),s={_depth:0,depth:{get:function(){return this._depth},set:function(n){this.displayList&&this.displayList.queueDepthSort(),this._depth=n}},setDepth:function(n){return n===void 0&&(n=0),this.depth=n,this},setToTop:function(){var n=this.getDisplayList();return n&&i.BringToTop(n,this),this},setToBack:function(){var n=this.getDisplayList();return n&&i.SendToBack(n,this),this},setAbove:function(n){var r=this.getDisplayList();return r&&n&&i.MoveAbove(r,this,n),this},setBelow:function(n){var r=this.getDisplayList();return r&&n&&i.MoveBelow(r,this,n),this}};t.exports=s}),nf=y((e,t)=>{var i={flipX:!1,flipY:!1,toggleFlipX:function(){return this.flipX=!this.flipX,this},toggleFlipY:function(){return this.flipY=!this.flipY,this},setFlipX:function(s){return this.flipX=s,this},setFlipY:function(s){return this.flipY=s,this},setFlip:function(s,n){return this.flipX=s,this.flipY=n,this},resetFlip:function(){return this.flipX=!1,this.flipY=!1,this}};t.exports=i}),Wt=y((e,t)=>{var i={GLOW:4,SHADOW:5,PIXELATE:6,VIGNETTE:7,SHINE:8,BLUR:9,GRADIENT:12,BLOOM:13,COLOR_MATRIX:14,CIRCLE:15,BARREL:16,DISPLACEMENT:17,WIPE:18,BOKEH:19};t.exports=i}),oe=y((e,t)=>{var i=W(),s=new i({initialize:function(n,r){this.type=n,this.gameObject=r,this.active=!0},setActive:function(n){return this.active=n,this},destroy:function(){this.gameObject=null,this.active=!1}});t.exports=s}),rf=y((e,t)=>{var i=W(),s=oe(),n=Wt(),r=new i({Extends:s,initialize:function(o,a){a===void 0&&(a=1),s.call(this,n.BARREL,o),this.amount=a}});t.exports=r}),af=y((e,t)=>{var i=W(),s=oe(),n=Wt(),r=new i({Extends:s,initialize:function(o,a,h,l,u,d,p){h===void 0&&(h=1),l===void 0&&(l=1),u===void 0&&(u=1),d===void 0&&(d=1),p===void 0&&(p=4),s.call(this,n.BLOOM,o),this.steps=p,this.offsetX=h,this.offsetY=l,this.blurStrength=u,this.strength=d,this.glcolor=[1,1,1],a!=null&&(this.color=a)},color:{get:function(){var o=this.glcolor;return(o[0]*255<<16)+(o[1]*255<<8)+(o[2]*255|0)},set:function(o){var a=this.glcolor;a[0]=(o>>16&255)/255,a[1]=(o>>8&255)/255,a[2]=(o&255)/255}}});t.exports=r}),of=y((e,t)=>{var i=W(),s=oe(),n=Wt(),r=new i({Extends:s,initialize:function(o,a,h,l,u,d,p){a===void 0&&(a=0),h===void 0&&(h=2),l===void 0&&(l=2),u===void 0&&(u=1),p===void 0&&(p=4),s.call(this,n.BLUR,o),this.quality=a,this.x=h,this.y=l,this.steps=p,this.strength=u,this.glcolor=[1,1,1],d!=null&&(this.color=d)},color:{get:function(){var o=this.glcolor;return(o[0]*255<<16)+(o[1]*255<<8)+(o[2]*255|0)},set:function(o){var a=this.glcolor;a[0]=(o>>16&255)/255,a[1]=(o>>8&255)/255,a[2]=(o&255)/255}}});t.exports=r}),hf=y((e,t)=>{var i=W(),s=oe(),n=Wt(),r=new i({Extends:s,initialize:function(o,a,h,l,u,d,p,g){a===void 0&&(a=.5),h===void 0&&(h=1),l===void 0&&(l=.2),u===void 0&&(u=!1),d===void 0&&(d=1),p===void 0&&(p=1),g===void 0&&(g=1),s.call(this,n.BOKEH,o),this.radius=a,this.amount=h,this.contrast=l,this.isTiltShift=u,this.strength=g,this.blurX=d,this.blurY=p}});t.exports=r}),lf=y((e,t)=>{var i=W(),s=oe(),n=Wt(),r=new i({Extends:s,initialize:function(o,a,h,l,u,d){a===void 0&&(a=8),u===void 0&&(u=1),d===void 0&&(d=.005),s.call(this,n.CIRCLE,o),this.scale=u,this.feather=d,this.thickness=a,this.glcolor=[1,.2,.7],this.glcolor2=[1,0,0,.4],h!=null&&(this.color=h),l!=null&&(this.backgroundColor=l)},color:{get:function(){var o=this.glcolor;return(o[0]*255<<16)+(o[1]*255<<8)+(o[2]*255|0)},set:function(o){var a=this.glcolor;a[0]=(o>>16&255)/255,a[1]=(o>>8&255)/255,a[2]=(o&255)/255}},backgroundColor:{get:function(){var o=this.glcolor2;return(o[0]*255<<16)+(o[1]*255<<8)+(o[2]*255|0)},set:function(o){var a=this.glcolor2;a[0]=(o>>16&255)/255,a[1]=(o>>8&255)/255,a[2]=(o&255)/255}},backgroundAlpha:{get:function(){return this.glcolor2[3]},set:function(o){this.glcolor2[3]=o}}});t.exports=r}),qr=y((e,t)=>{var i=W(),s=new Float32Array(20),n=new i({initialize:function(){this._matrix=new Float32Array(20),this.alpha=1,this._dirty=!0,this._data=new Float32Array(20),this.reset()},set:function(r){return this._matrix.set(r),this._dirty=!0,this},reset:function(){var r=this._matrix;return r.fill(0),r[0]=1,r[6]=1,r[12]=1,r[18]=1,this.alpha=1,this._dirty=!0,this},getData:function(){var r=this._data;return this._dirty&&(r.set(this._matrix),r[4]/=255,r[9]/=255,r[14]/=255,r[19]/=255,this._dirty=!1),r},brightness:function(r,o){r===void 0&&(r=0),o===void 0&&(o=!1);var a=r;return this.multiply([a,0,0,0,0,0,a,0,0,0,0,0,a,0,0,0,0,0,1,0],o)},saturate:function(r,o){r===void 0&&(r=0),o===void 0&&(o=!1);var a=r*2/3+1,h=(a-1)*-.5;return this.multiply([a,h,h,0,0,h,a,h,0,0,h,h,a,0,0,0,0,0,1,0],o)},desaturate:function(r){return r===void 0&&(r=!1),this.saturate(-1,r)},hue:function(r,o){r===void 0&&(r=0),o===void 0&&(o=!1),r=r/180*Math.PI;var a=Math.cos(r),h=Math.sin(r),l=.213,u=.715,d=.072;return this.multiply([l+a*(1-l)+h*-l,u+a*-u+h*-u,d+a*-d+h*(1-d),0,0,l+a*-l+h*.143,u+a*(1-u)+h*.14,d+a*-d+h*-.283,0,0,l+a*-l+h*-(1-l),u+a*-u+h*u,d+a*(1-d)+h*d,0,0,0,0,0,1,0],o)},grayscale:function(r,o){return r===void 0&&(r=1),o===void 0&&(o=!1),this.saturate(-r,o)},blackWhite:function(r){return r===void 0&&(r=!1),this.multiply(n.BLACK_WHITE,r)},contrast:function(r,o){r===void 0&&(r=0),o===void 0&&(o=!1);var a=r+1,h=-.5*(a-1);return this.multiply([a,0,0,0,h,0,a,0,0,h,0,0,a,0,h,0,0,0,1,0],o)},negative:function(r){return r===void 0&&(r=!1),this.multiply(n.NEGATIVE,r)},desaturateLuminance:function(r){return r===void 0&&(r=!1),this.multiply(n.DESATURATE_LUMINANCE,r)},sepia:function(r){return r===void 0&&(r=!1),this.multiply(n.SEPIA,r)},night:function(r,o){return r===void 0&&(r=.1),o===void 0&&(o=!1),this.multiply([r*-2,-r,0,0,0,-r,0,r,0,0,0,r,r*2,0,0,0,0,0,1,0],o)},lsd:function(r){return r===void 0&&(r=!1),this.multiply(n.LSD,r)},brown:function(r){return r===void 0&&(r=!1),this.multiply(n.BROWN,r)},vintagePinhole:function(r){return r===void 0&&(r=!1),this.multiply(n.VINTAGE,r)},kodachrome:function(r){return r===void 0&&(r=!1),this.multiply(n.KODACHROME,r)},technicolor:function(r){return r===void 0&&(r=!1),this.multiply(n.TECHNICOLOR,r)},polaroid:function(r){return r===void 0&&(r=!1),this.multiply(n.POLAROID,r)},shiftToBGR:function(r){return r===void 0&&(r=!1),this.multiply(n.SHIFT_BGR,r)},multiply:function(r,o){o===void 0&&(o=!1),o||this.reset();var a=this._matrix,h=s;return h.set(a),a.set([h[0]*r[0]+h[1]*r[5]+h[2]*r[10]+h[3]*r[15],h[0]*r[1]+h[1]*r[6]+h[2]*r[11]+h[3]*r[16],h[0]*r[2]+h[1]*r[7]+h[2]*r[12]+h[3]*r[17],h[0]*r[3]+h[1]*r[8]+h[2]*r[13]+h[3]*r[18],h[0]*r[4]+h[1]*r[9]+h[2]*r[14]+h[3]*r[19]+h[4],h[5]*r[0]+h[6]*r[5]+h[7]*r[10]+h[8]*r[15],h[5]*r[1]+h[6]*r[6]+h[7]*r[11]+h[8]*r[16],h[5]*r[2]+h[6]*r[7]+h[7]*r[12]+h[8]*r[17],h[5]*r[3]+h[6]*r[8]+h[7]*r[13]+h[8]*r[18],h[5]*r[4]+h[6]*r[9]+h[7]*r[14]+h[8]*r[19]+h[9],h[10]*r[0]+h[11]*r[5]+h[12]*r[10]+h[13]*r[15],h[10]*r[1]+h[11]*r[6]+h[12]*r[11]+h[13]*r[16],h[10]*r[2]+h[11]*r[7]+h[12]*r[12]+h[13]*r[17],h[10]*r[3]+h[11]*r[8]+h[12]*r[13]+h[13]*r[18],h[10]*r[4]+h[11]*r[9]+h[12]*r[14]+h[13]*r[19]+h[14],h[15]*r[0]+h[16]*r[5]+h[17]*r[10]+h[18]*r[15],h[15]*r[1]+h[16]*r[6]+h[17]*r[11]+h[18]*r[16],h[15]*r[2]+h[16]*r[7]+h[17]*r[12]+h[18]*r[17],h[15]*r[3]+h[16]*r[8]+h[17]*r[13]+h[18]*r[18],h[15]*r[4]+h[16]*r[9]+h[17]*r[14]+h[18]*r[19]+h[19]]),this._dirty=!0,this}});n.BLACK_WHITE=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],n.NEGATIVE=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],n.DESATURATE_LUMINANCE=[.2764723,.929708,.0938197,0,-37.1,.2764723,.929708,.0938197,0,-37.1,.2764723,.929708,.0938197,0,-37.1,0,0,0,1,0],n.SEPIA=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],n.LSD=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],n.BROWN=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],n.VINTAGE=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],n.KODACHROME=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],n.TECHNICOLOR=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],n.POLAROID=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],n.SHIFT_BGR=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t.exports=n}),uf=y((e,t)=>{var i=W(),s=qr(),n=Wt(),r=new i({Extends:s,initialize:function(o){s.call(this),this.type=n.COLOR_MATRIX,this.gameObject=o,this.active=!0},destroy:function(){this.gameObject=null,this._matrix=null,this._data=null}});t.exports=r}),cf=y((e,t)=>{var i=W(),s=oe(),n=Wt(),r=new i({Extends:s,initialize:function(o,a,h,l){a===void 0&&(a="__WHITE"),h===void 0&&(h=.005),l===void 0&&(l=.005),s.call(this,n.DISPLACEMENT,o),this.x=h,this.y=l,this.glTexture,this.setTexture(a)},setTexture:function(o){var a=this.gameObject.scene.sys.textures.getFrame(o);return a&&(this.glTexture=a.glTexture),this}});t.exports=r}),df=y((e,t)=>{var i=W(),s=oe(),n=Wt(),r=new i({Extends:s,initialize:function(o,a,h,l,u){h===void 0&&(h=4),l===void 0&&(l=0),u===void 0&&(u=!1),s.call(this,n.GLOW,o),this.outerStrength=h,this.innerStrength=l,this.knockout=u,this.glcolor=[1,1,1,1],a!==void 0&&(this.color=a)},color:{get:function(){var o=this.glcolor;return(o[0]*255<<16)+(o[1]*255<<8)+(o[2]*255|0)},set:function(o){var a=this.glcolor;a[0]=(o>>16&255)/255,a[1]=(o>>8&255)/255,a[2]=(o&255)/255}}});t.exports=r}),pf=y((e,t)=>{var i=W(),s=oe(),n=Wt(),r=new i({Extends:s,initialize:function(o,a,h,l,u,d,p,g,c){l===void 0&&(l=.2),u===void 0&&(u=0),d===void 0&&(d=0),p===void 0&&(p=0),g===void 0&&(g=1),c===void 0&&(c=0),s.call(this,n.GRADIENT,o),this.alpha=l,this.size=c,this.fromX=u,this.fromY=d,this.toX=p,this.toY=g,this.glcolor1=[255,0,0],this.glcolor2=[0,255,0],a!=null&&(this.color1=a),h!=null&&(this.color2=h)},color1:{get:function(){var o=this.glcolor1;return(o[0]<<16)+(o[1]<<8)+(o[2]|0)},set:function(o){var a=this.glcolor1;a[0]=o>>16&255,a[1]=o>>8&255,a[2]=o&255}},color2:{get:function(){var o=this.glcolor2;return(o[0]<<16)+(o[1]<<8)+(o[2]|0)},set:function(o){var a=this.glcolor2;a[0]=o>>16&255,a[1]=o>>8&255,a[2]=o&255}}});t.exports=r}),gf=y((e,t)=>{var i=W(),s=oe(),n=Wt(),r=new i({Extends:s,initialize:function(o,a){a===void 0&&(a=1),s.call(this,n.PIXELATE,o),this.amount=a}});t.exports=r}),ff=y((e,t)=>{var i=W(),s=oe(),n=Wt(),r=new i({Extends:s,initialize:function(o,a,h,l,u,d,p,g){a===void 0&&(a=0),h===void 0&&(h=0),l===void 0&&(l=.1),u===void 0&&(u=1),p===void 0&&(p=6),g===void 0&&(g=1),s.call(this,n.SHADOW,o),this.x=a,this.y=h,this.decay=l,this.power=u,this.glcolor=[0,0,0,1],this.samples=p,this.intensity=g,d!==void 0&&(this.color=d)},color:{get:function(){var o=this.glcolor;return(o[0]*255<<16)+(o[1]*255<<8)+(o[2]*255|0)},set:function(o){var a=this.glcolor;a[0]=(o>>16&255)/255,a[1]=(o>>8&255)/255,a[2]=(o&255)/255}}});t.exports=r}),mf=y((e,t)=>{var i=W(),s=oe(),n=Wt(),r=new i({Extends:s,initialize:function(o,a,h,l,u){a===void 0&&(a=.5),h===void 0&&(h=.5),l===void 0&&(l=3),u===void 0&&(u=!1),s.call(this,n.SHINE,o),this.speed=a,this.lineWidth=h,this.gradient=l,this.reveal=u}});t.exports=r}),vf=y((e,t)=>{var i=W(),s=oe(),n=Wt(),r=new i({Extends:s,initialize:function(o,a,h,l,u){a===void 0&&(a=.5),h===void 0&&(h=.5),l===void 0&&(l=.5),u===void 0&&(u=.5),s.call(this,n.VIGNETTE,o),this.x=a,this.y=h,this.radius=l,this.strength=u}});t.exports=r}),Ef=y((e,t)=>{var i=W(),s=oe(),n=Wt(),r=new i({Extends:s,initialize:function(o,a,h,l,u){a===void 0&&(a=.1),h===void 0&&(h=0),l===void 0&&(l=0),u===void 0&&(u=!1),s.call(this,n.WIPE,o),this.progress=0,this.wipeWidth=a,this.direction=h,this.axis=l,this.reveal=u}});t.exports=r}),yf=y((e,t)=>{var i=Qt(),s=Wt(),n={Barrel:rf(),Controller:oe(),Bloom:af(),Blur:of(),Bokeh:hf(),Circle:lf(),ColorMatrix:uf(),Displacement:cf(),Glow:df(),Gradient:pf(),Pixelate:gf(),Shadow:ff(),Shine:mf(),Vignette:vf(),Wipe:Ef()};n=i(!1,n,s),t.exports=n}),Xh=y((e,t)=>{var i=W(),s=yf(),n=Bi(),r=new i({initialize:function(o,a){this.gameObject=o,this.isPost=a,this.enabled=!1,this.list=[],this.padding=0},setPadding:function(o){return o===void 0&&(o=0),this.padding=o,this.gameObject},onFXCopy:function(){},onFX:function(){},enable:function(o){if(!this.isPost){var a=this.gameObject.scene.sys.renderer;a&&a.pipelines?(this.gameObject.pipeline=a.pipelines.FX_PIPELINE,o!==void 0&&(this.padding=o),this.enabled=!0):this.enabled=!1}},clear:function(){if(this.isPost)this.gameObject.resetPostPipeline(!0);else{for(var o=this.list,a=0;a<o.length;a++)o[a].destroy();this.list=[]}return this.enabled=!1,this.gameObject},remove:function(o){var a;if(this.isPost){var h=this.gameObject.getPostPipeline(String(o.type));for(Array.isArray(h)||(h=[h]),a=0;a<h.length;a++){var l=h[a];if(l.controller===o){this.gameObject.removePostPipeline(l),o.destroy();break}}}else{var u=this.list;for(a=0;a<u.length;a++)u[a]===o&&(n(u,a),o.destroy())}return this.gameObject},disable:function(o){return o===void 0&&(o=!1),this.isPost||this.gameObject.resetPipeline(),this.enabled=!1,o&&this.clear(),this.gameObject},add:function(o,a){if(this.isPost){var h=String(o.type);this.gameObject.setPostPipeline(h,a);var l=this.gameObject.getPostPipeline(h);if(l)return Array.isArray(l)&&(l=l.pop()),l&&(l.controller=o),o}else return this.enabled||this.enable(),this.list.push(o),o},addGlow:function(o,a,h,l,u,d){return this.add(new s.Glow(this.gameObject,o,a,h,l),{quality:u,distance:d})},addShadow:function(o,a,h,l,u,d,p){return this.add(new s.Shadow(this.gameObject,o,a,h,l,u,d,p))},addPixelate:function(o){return this.add(new s.Pixelate(this.gameObject,o))},addVignette:function(o,a,h,l){return this.add(new s.Vignette(this.gameObject,o,a,h,l))},addShine:function(o,a,h,l){return this.add(new s.Shine(this.gameObject,o,a,h,l))},addBlur:function(o,a,h,l,u,d){return this.add(new s.Blur(this.gameObject,o,a,h,l,u,d))},addGradient:function(o,a,h,l,u,d,p,g){return this.add(new s.Gradient(this.gameObject,o,a,h,l,u,d,p,g))},addBloom:function(o,a,h,l,u,d){return this.add(new s.Bloom(this.gameObject,o,a,h,l,u,d))},addColorMatrix:function(){return this.add(new s.ColorMatrix(this.gameObject))},addCircle:function(o,a,h,l,u){return this.add(new s.Circle(this.gameObject,o,a,h,l,u))},addBarrel:function(o){return this.add(new s.Barrel(this.gameObject,o))},addDisplacement:function(o,a,h){return this.add(new s.Displacement(this.gameObject,o,a,h))},addWipe:function(o,a,h){return this.add(new s.Wipe(this.gameObject,o,a,h))},addReveal:function(o,a,h){return this.add(new s.Wipe(this.gameObject,o,a,h,!0))},addBokeh:function(o,a,h){return this.add(new s.Bokeh(this.gameObject,o,a,h))},addTiltShift:function(o,a,h,l,u,d){return this.add(new s.Bokeh(this.gameObject,o,a,h,!0,l,u,d))},destroy:function(){this.clear(),this.gameObject=null}});t.exports=r}),Ui=y((e,t)=>{var i=function(s,n,r){return s.width<=0||s.height<=0?!1:s.x<=n&&s.x+s.width>=n&&s.y<=r&&s.y+s.height>=r};t.exports=i}),Pn=y((e,t)=>{var i=function(s){return 2*(s.width+s.height)};t.exports=i}),Jr=y((e,t)=>{var i=Pn(),s=Mt(),n=function(r,o,a){if(a===void 0&&(a=new s),o<=0||o>=1)return a.x=r.x,a.y=r.y,a;var h=i(r)*o;return o>.5?(h-=r.width+r.height,h<=r.width?(a.x=r.right-h,a.y=r.bottom):(a.x=r.x,a.y=r.bottom-(h-r.width))):h<=r.width?(a.x=r.x+h,a.y=r.y):(a.x=r.right,a.y=r.y+(h-r.width)),a};t.exports=n}),Kh=y((e,t)=>{var i=Jr(),s=Pn(),n=function(r,o,a,h){h===void 0&&(h=[]),!o&&a>0&&(o=s(r)/a);for(var l=0;l<o;l++){var u=l/o;h.push(i(r,u))}return h};t.exports=n}),jh=y((e,t)=>{var i=Mt(),s=function(n,r,o){return o===void 0&&(o=new i),o.x=n.x1+(n.x2-n.x1)*r,o.y=n.y1+(n.y2-n.y1)*r,o};t.exports=s}),Ps=y((e,t)=>{var i=function(s){return Math.sqrt((s.x2-s.x1)*(s.x2-s.x1)+(s.y2-s.y1)*(s.y2-s.y1))};t.exports=i}),Qr=y((e,t)=>{var i=Ps(),s=Mt(),n=function(r,o,a,h){h===void 0&&(h=[]),!o&&a>0&&(o=i(r)/a);for(var l=r.x1,u=r.y1,d=r.x2,p=r.y2,g=0;g<o;g++){var c=g/o,f=l+(d-l)*c,m=u+(p-u)*c;h.push(new s(f,m))}return h};t.exports=n}),$r=y((e,t)=>{var i=Mt(),s=function(n,r){r===void 0&&(r=new i);var o=Math.random();return r.x=n.x1+o*(n.x2-n.x1),r.y=n.y1+o*(n.y2-n.y1),r};t.exports=s}),ta=y((e,t)=>{var i=function(s,n,r){return r===void 0&&(r=1e-4),Math.abs(s-n)<r};t.exports=i}),xt=y((e,t)=>{var i=W(),s=ta(),n=new i({initialize:function(r,o){this.x=0,this.y=0,typeof r=="object"?(this.x=r.x||0,this.y=r.y||0):(o===void 0&&(o=r),this.x=r||0,this.y=o||0)},clone:function(){return new n(this.x,this.y)},copy:function(r){return this.x=r.x||0,this.y=r.y||0,this},setFromObject:function(r){return this.x=r.x||0,this.y=r.y||0,this},set:function(r,o){return o===void 0&&(o=r),this.x=r,this.y=o,this},setTo:function(r,o){return this.set(r,o)},setToPolar:function(r,o){return o==null&&(o=1),this.x=Math.cos(r)*o,this.y=Math.sin(r)*o,this},equals:function(r){return this.x===r.x&&this.y===r.y},fuzzyEquals:function(r,o){return s(this.x,r.x,o)&&s(this.y,r.y,o)},angle:function(){var r=Math.atan2(this.y,this.x);return r<0&&(r+=2*Math.PI),r},setAngle:function(r){return this.setToPolar(r,this.length())},add:function(r){return this.x+=r.x,this.y+=r.y,this},subtract:function(r){return this.x-=r.x,this.y-=r.y,this},multiply:function(r){return this.x*=r.x,this.y*=r.y,this},scale:function(r){return isFinite(r)?(this.x*=r,this.y*=r):(this.x=0,this.y=0),this},divide:function(r){return this.x/=r.x,this.y/=r.y,this},negate:function(){return this.x=-this.x,this.y=-this.y,this},distance:function(r){var o=r.x-this.x,a=r.y-this.y;return Math.sqrt(o*o+a*a)},distanceSq:function(r){var o=r.x-this.x,a=r.y-this.y;return o*o+a*a},length:function(){var r=this.x,o=this.y;return Math.sqrt(r*r+o*o)},setLength:function(r){return this.normalize().scale(r)},lengthSq:function(){var r=this.x,o=this.y;return r*r+o*o},normalize:function(){var r=this.x,o=this.y,a=r*r+o*o;return a>0&&(a=1/Math.sqrt(a),this.x=r*a,this.y=o*a),this},normalizeRightHand:function(){var r=this.x;return this.x=this.y*-1,this.y=r,this},normalizeLeftHand:function(){var r=this.x;return this.x=this.y,this.y=r*-1,this},dot:function(r){return this.x*r.x+this.y*r.y},cross:function(r){return this.x*r.y-this.y*r.x},lerp:function(r,o){o===void 0&&(o=0);var a=this.x,h=this.y;return this.x=a+o*(r.x-a),this.y=h+o*(r.y-h),this},transformMat3:function(r){var o=this.x,a=this.y,h=r.val;return this.x=h[0]*o+h[3]*a+h[6],this.y=h[1]*o+h[4]*a+h[7],this},transformMat4:function(r){var o=this.x,a=this.y,h=r.val;return this.x=h[0]*o+h[4]*a+h[12],this.y=h[1]*o+h[5]*a+h[13],this},reset:function(){return this.x=0,this.y=0,this},limit:function(r){var o=this.length();return o&&o>r&&this.scale(r/o),this},reflect:function(r){return r=r.clone().normalize(),this.subtract(r.scale(2*this.dot(r)))},mirror:function(r){return this.reflect(r).negate()},rotate:function(r){var o=Math.cos(r),a=Math.sin(r);return this.set(o*this.x-a*this.y,a*this.x+o*this.y)},project:function(r){var o=this.dot(r)/r.dot(r);return this.copy(r).scale(o)}});n.ZERO=new n,n.RIGHT=new n(1,0),n.LEFT=new n(-1,0),n.UP=new n(0,-1),n.DOWN=new n(0,1),n.ONE=new n(1,1),t.exports=n}),Rn=y((e,t)=>{var i=W(),s=jh(),n=Qr(),r=xi(),o=$r(),a=xt(),h=new i({initialize:function(l,u,d,p){l===void 0&&(l=0),u===void 0&&(u=0),d===void 0&&(d=0),p===void 0&&(p=0),this.type=r.LINE,this.x1=l,this.y1=u,this.x2=d,this.y2=p},getPoint:function(l,u){return s(this,l,u)},getPoints:function(l,u,d){return n(this,l,u,d)},getRandomPoint:function(l){return o(this,l)},setTo:function(l,u,d,p){return l===void 0&&(l=0),u===void 0&&(u=0),d===void 0&&(d=0),p===void 0&&(p=0),this.x1=l,this.y1=u,this.x2=d,this.y2=p,this},setFromObjects:function(l,u){return this.x1=l.x,this.y1=l.y,this.x2=u.x,this.y2=u.y,this},getPointA:function(l){return l===void 0&&(l=new a),l.set(this.x1,this.y1),l},getPointB:function(l){return l===void 0&&(l=new a),l.set(this.x2,this.y2),l},left:{get:function(){return Math.min(this.x1,this.x2)},set:function(l){this.x1<=this.x2?this.x1=l:this.x2=l}},right:{get:function(){return Math.max(this.x1,this.x2)},set:function(l){this.x1>this.x2?this.x1=l:this.x2=l}},top:{get:function(){return Math.min(this.y1,this.y2)},set:function(l){this.y1<=this.y2?this.y1=l:this.y2=l}},bottom:{get:function(){return Math.max(this.y1,this.y2)},set:function(l){this.y1>this.y2?this.y1=l:this.y2=l}}});t.exports=h}),ea=y((e,t)=>{var i=Mt(),s=function(n,r){return r===void 0&&(r=new i),r.x=n.x+Math.random()*n.width,r.y=n.y+Math.random()*n.height,r};t.exports=s}),Ut=y((e,t)=>{var i=W(),s=Ui(),n=Jr(),r=Kh(),o=xi(),a=Rn(),h=ea(),l=new i({initialize:function(u,d,p,g){u===void 0&&(u=0),d===void 0&&(d=0),p===void 0&&(p=0),g===void 0&&(g=0),this.type=o.RECTANGLE,this.x=u,this.y=d,this.width=p,this.height=g},contains:function(u,d){return s(this,u,d)},getPoint:function(u,d){return n(this,u,d)},getPoints:function(u,d,p){return r(this,u,d,p)},getRandomPoint:function(u){return h(this,u)},setTo:function(u,d,p,g){return this.x=u,this.y=d,this.width=p,this.height=g,this},setEmpty:function(){return this.setTo(0,0,0,0)},setPosition:function(u,d){return d===void 0&&(d=u),this.x=u,this.y=d,this},setSize:function(u,d){return d===void 0&&(d=u),this.width=u,this.height=d,this},isEmpty:function(){return this.width<=0||this.height<=0},getLineA:function(u){return u===void 0&&(u=new a),u.setTo(this.x,this.y,this.right,this.y),u},getLineB:function(u){return u===void 0&&(u=new a),u.setTo(this.right,this.y,this.right,this.bottom),u},getLineC:function(u){return u===void 0&&(u=new a),u.setTo(this.right,this.bottom,this.x,this.bottom),u},getLineD:function(u){return u===void 0&&(u=new a),u.setTo(this.x,this.bottom,this.x,this.y),u},left:{get:function(){return this.x},set:function(u){u>=this.right?this.width=0:this.width=this.right-u,this.x=u}},right:{get:function(){return this.x+this.width},set:function(u){u<=this.x?this.width=0:this.width=u-this.x}},top:{get:function(){return this.y},set:function(u){u>=this.bottom?this.height=0:this.height=this.bottom-u,this.y=u}},bottom:{get:function(){return this.y+this.height},set:function(u){u<=this.y?this.height=0:this.height=u-this.y}},centerX:{get:function(){return this.x+this.width/2},set:function(u){this.x=u-this.width/2}},centerY:{get:function(){return this.y+this.height/2},set:function(u){this.y=u-this.height/2}}});t.exports=l}),ia=y((e,t)=>{var i=function(s,n,r,o){var a=Math.cos(o),h=Math.sin(o),l=s.x-n,u=s.y-r;return s.x=l*a-u*h+n,s.y=l*h+u*a+r,s};t.exports=i}),Tf=y((e,t)=>{var i=Ut(),s=ia(),n=xt(),r={prepareBoundsOutput:function(o,a){if(a===void 0&&(a=!1),this.rotation!==0&&s(o,this.x,this.y,this.rotation),a&&this.parentContainer){var h=this.parentContainer.getBoundsTransformMatrix();h.transformPoint(o.x,o.y,o)}return o},getCenter:function(o,a){return o===void 0&&(o=new n),o.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,o.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(o,a)},getTopLeft:function(o,a){return o||(o=new n),o.x=this.x-this.displayWidth*this.originX,o.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(o,a)},getTopCenter:function(o,a){return o||(o=new n),o.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,o.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(o,a)},getTopRight:function(o,a){return o||(o=new n),o.x=this.x-this.displayWidth*this.originX+this.displayWidth,o.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(o,a)},getLeftCenter:function(o,a){return o||(o=new n),o.x=this.x-this.displayWidth*this.originX,o.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(o,a)},getRightCenter:function(o,a){return o||(o=new n),o.x=this.x-this.displayWidth*this.originX+this.displayWidth,o.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(o,a)},getBottomLeft:function(o,a){return o||(o=new n),o.x=this.x-this.displayWidth*this.originX,o.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(o,a)},getBottomCenter:function(o,a){return o||(o=new n),o.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,o.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(o,a)},getBottomRight:function(o,a){return o||(o=new n),o.x=this.x-this.displayWidth*this.originX+this.displayWidth,o.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(o,a)},getBounds:function(o){o===void 0&&(o=new i);var a,h,l,u,d,p,g,c;if(this.parentContainer){var f=this.parentContainer.getBoundsTransformMatrix();this.getTopLeft(o),f.transformPoint(o.x,o.y,o),a=o.x,h=o.y,this.getTopRight(o),f.transformPoint(o.x,o.y,o),l=o.x,u=o.y,this.getBottomLeft(o),f.transformPoint(o.x,o.y,o),d=o.x,p=o.y,this.getBottomRight(o),f.transformPoint(o.x,o.y,o),g=o.x,c=o.y}else this.getTopLeft(o),a=o.x,h=o.y,this.getTopRight(o),l=o.x,u=o.y,this.getBottomLeft(o),d=o.x,p=o.y,this.getBottomRight(o),g=o.x,c=o.y;return o.x=Math.min(a,l,d,g),o.y=Math.min(h,u,p,c),o.width=Math.max(a,l,d,g)-o.x,o.height=Math.max(h,u,p,c)-o.y,o}};t.exports=r}),he=y((e,t)=>{var i={},s={},n={};n.register=function(r,o,a,h){h===void 0&&(h=!1),i[r]={plugin:o,mapping:a,custom:h}},n.registerCustom=function(r,o,a,h){s[r]={plugin:o,mapping:a,data:h}},n.hasCore=function(r){return i.hasOwnProperty(r)},n.hasCustom=function(r){return s.hasOwnProperty(r)},n.getCore=function(r){return i[r]},n.getCustom=function(r){return s[r]},n.getCustomClass=function(r){return s.hasOwnProperty(r)?s[r].plugin:null},n.remove=function(r){i.hasOwnProperty(r)&&delete i[r]},n.removeCustom=function(r){s.hasOwnProperty(r)&&delete s[r]},n.destroyCorePlugins=function(){for(var r in i)i.hasOwnProperty(r)&&delete i[r]},n.destroyCustomPlugins=function(){for(var r in s)s.hasOwnProperty(r)&&delete s[r]},t.exports=n}),xf=y((e,t)=>{t.exports="addedtoscene"}),Sf=y((e,t)=>{t.exports="boot"}),Af=y((e,t)=>{t.exports="create"}),wf=y((e,t)=>{t.exports="destroy"}),Cf=y((e,t)=>{t.exports="pause"}),Pf=y((e,t)=>{t.exports="postupdate"}),Rf=y((e,t)=>{t.exports="prerender"}),bf=y((e,t)=>{t.exports="preupdate"}),If=y((e,t)=>{t.exports="ready"}),_f=y((e,t)=>{t.exports="removedfromscene"}),Of=y((e,t)=>{t.exports="render"}),Mf=y((e,t)=>{t.exports="resume"}),Lf=y((e,t)=>{t.exports="shutdown"}),Df=y((e,t)=>{t.exports="sleep"}),kf=y((e,t)=>{t.exports="start"}),Ff=y((e,t)=>{t.exports="transitioncomplete"}),Nf=y((e,t)=>{t.exports="transitioninit"}),Bf=y((e,t)=>{t.exports="transitionout"}),Uf=y((e,t)=>{t.exports="transitionstart"}),Gf=y((e,t)=>{t.exports="transitionwake"}),Yf=y((e,t)=>{t.exports="update"}),Hf=y((e,t)=>{t.exports="wake"}),Vt=y((e,t)=>{t.exports={ADDED_TO_SCENE:xf(),BOOT:Sf(),CREATE:Af(),DESTROY:wf(),PAUSE:Cf(),POST_UPDATE:Pf(),PRE_RENDER:Rf(),PRE_UPDATE:bf(),READY:If(),REMOVED_FROM_SCENE:_f(),RENDER:Of(),RESUME:Mf(),SHUTDOWN:Lf(),SLEEP:Df(),START:kf(),TRANSITION_COMPLETE:Ff(),TRANSITION_INIT:Nf(),TRANSITION_OUT:Bf(),TRANSITION_START:Uf(),TRANSITION_WAKE:Gf(),UPDATE:Yf(),WAKE:Hf()}}),jt=y((e,t)=>{var i=W(),s=he(),n=Vt(),r=new i({initialize:function(o){this.scene=o,this.systems=o.sys,this.events=o.sys.events,this.displayList,this.updateList,this.events.once(n.BOOT,this.boot,this),this.events.on(n.START,this.start,this)},boot:function(){this.displayList=this.systems.displayList,this.updateList=this.systems.updateList,this.events.once(n.DESTROY,this.destroy,this)},start:function(){this.events.once(n.SHUTDOWN,this.shutdown,this)},existing:function(o){return(o.renderCanvas||o.renderWebGL)&&this.displayList.add(o),o.preUpdate&&this.updateList.add(o),o},shutdown:function(){this.events.off(n.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(n.START,this.start,this),this.scene=null,this.systems=null,this.events=null,this.displayList=null,this.updateList=null}});r.register=function(o,a){r.prototype.hasOwnProperty(o)||(r.prototype[o]=a)},r.remove=function(o){r.prototype.hasOwnProperty(o)&&delete r.prototype[o]},s.register("GameObjectFactory",r,"add"),t.exports=r}),Zh=y((e,t)=>{var i=W(),s=jt(),n=new i({initialize:function(r,o,a,h,l,u){o||(o=r.sys.make.image({x:a,y:h,key:l,frame:u,add:!1})),this.bitmapMask=o,this.invertAlpha=!1,this.isStencil=!1},setBitmap:function(r){this.bitmapMask=r},preRenderWebGL:function(r,o,a){r.pipelines.BITMAPMASK_PIPELINE.beginMask(this,o,a)},postRenderWebGL:function(r,o,a){r.pipelines.BITMAPMASK_PIPELINE.endMask(this,o,a)},preRenderCanvas:function(){},postRenderCanvas:function(){},destroy:function(){this.bitmapMask=null}});s.register("bitmapMask",function(r,o,a,h,l){return new n(this.scene,r,o,a,h,l)}),t.exports=n}),qh=y((e,t)=>{var i=W(),s=new i({initialize:function(n,r){this.geometryMask=r,this.invertAlpha=!1,this.isStencil=!0,this.level=0},setShape:function(n){return this.geometryMask=n,this},setInvertAlpha:function(n){return n===void 0&&(n=!0),this.invertAlpha=n,this},preRenderWebGL:function(n,r,o){var a=n.gl;n.flush(),n.maskStack.length===0&&(a.enable(a.STENCIL_TEST),a.clear(a.STENCIL_BUFFER_BIT),n.maskCount=0),n.currentCameraMask.mask!==this&&(n.currentMask.mask=this),n.maskStack.push({mask:this,camera:o}),this.applyStencil(n,o,!0),n.maskCount++},applyStencil:function(n,r,o){var a=n.gl,h=this.geometryMask,l=n.maskCount,u=255;a.colorMask(!1,!1,!1,!1),o?(a.stencilFunc(a.EQUAL,l,u),a.stencilOp(a.KEEP,a.KEEP,a.INCR),l++):(a.stencilFunc(a.EQUAL,l+1,u),a.stencilOp(a.KEEP,a.KEEP,a.DECR)),this.level=l,h.renderWebGL(n,h,r),n.flush(),a.colorMask(!0,!0,!0,!0),a.stencilOp(a.KEEP,a.KEEP,a.KEEP),this.invertAlpha?a.stencilFunc(a.NOTEQUAL,l,u):a.stencilFunc(a.EQUAL,l,u)},postRenderWebGL:function(n){var r=n.gl;n.maskStack.pop(),n.maskCount--,n.flush();var o=n.currentMask;if(n.maskStack.length===0)o.mask=null,r.disable(r.STENCIL_TEST);else{var a=n.maskStack[n.maskStack.length-1];a.mask.applyStencil(n,a.camera,!1),n.currentCameraMask.mask!==a.mask?(o.mask=a.mask,o.camera=a.camera):o.mask=null}},preRenderCanvas:function(n,r,o){var a=this.geometryMask;n.currentContext.save(),a.renderCanvas(n,a,o,null,null,!0),n.currentContext.clip()},postRenderCanvas:function(n){n.currentContext.restore()},destroy:function(){this.geometryMask=null}});t.exports=s}),zf=y((e,t)=>{var i=Zh(),s=qh(),n={mask:null,setMask:function(r){return this.mask=r,this},clearMask:function(r){return r===void 0&&(r=!1),r&&this.mask&&this.mask.destroy(),this.mask=null,this},createBitmapMask:function(r,o,a,h,l){return r===void 0&&(this.texture||this.shader||this.geom)&&(r=this),new i(this.scene,r,o,a,h,l)},createGeometryMask:function(r){return r===void 0&&(this.type==="Graphics"||this.geom)&&(r=this),new s(this.scene,r)}};t.exports=n}),Wf=y((e,t)=>{var i={_originComponent:!0,originX:.5,originY:.5,_displayOriginX:0,_displayOriginY:0,displayOriginX:{get:function(){return this._displayOriginX},set:function(s){this._displayOriginX=s,this.originX=s/this.width}},displayOriginY:{get:function(){return this._displayOriginY},set:function(s){this._displayOriginY=s,this.originY=s/this.height}},setOrigin:function(s,n){return s===void 0&&(s=.5),n===void 0&&(n=s),this.originX=s,this.originY=n,this.updateDisplayOrigin()},setOriginFromFrame:function(){return!this.frame||!this.frame.customPivot?this.setOrigin():(this.originX=this.frame.pivotX,this.originY=this.frame.pivotY,this.updateDisplayOrigin())},setDisplayOrigin:function(s,n){return s===void 0&&(s=0),n===void 0&&(n=s),this.displayOriginX=s,this.displayOriginY=n,this},updateDisplayOrigin:function(){return this._displayOriginX=this.originX*this.width,this._displayOriginY=this.originY*this.height,this}};t.exports=i}),Gi=y((e,t)=>{var i=Gt(),s=function(n){return n*i.DEG_TO_RAD};t.exports=s}),Rs=y((e,t)=>{var i=function(s,n,r){return s&&s.hasOwnProperty(n)?s[n]:r};t.exports=i}),Yi=y((e,t)=>{var i={CREATED:0,DELAY:2,PENDING_RENDER:4,PLAYING_FORWARD:5,PLAYING_BACKWARD:6,HOLD_DELAY:7,REPEAT_DELAY:8,COMPLETE:9,PENDING:20,ACTIVE:21,LOOP_DELAY:22,COMPLETE_DELAY:23,START_DELAY:24,PENDING_REMOVE:25,REMOVED:26,FINISHED:27,DESTROYED:28,MAX:999999999999};t.exports=i}),Vf=y((e,t)=>{var i=Gi(),s=Rs(),n=St(),r=Yi(),o=xt(),a={path:null,rotateToPath:!1,pathRotationOffset:0,pathOffset:null,pathVector:null,pathDelta:null,pathTween:null,pathConfig:null,_prevDirection:r.PLAYING_FORWARD,setPath:function(h,l){l===void 0&&(l=this.pathConfig);var u=this.pathTween;return u&&u.isPlaying()&&u.stop(),this.path=h,l&&this.startFollow(l),this},setRotateToPath:function(h,l){return l===void 0&&(l=0),this.rotateToPath=h,this.pathRotationOffset=l,this},isFollowing:function(){var h=this.pathTween;return h&&h.isPlaying()},startFollow:function(h,l){h===void 0&&(h={}),l===void 0&&(l=0);var u=this.pathTween;u&&u.isPlaying()&&u.stop(),typeof h=="number"&&(h={duration:h}),h.from=n(h,"from",0),h.to=n(h,"to",1);var d=s(h,"positionOnPath",!1);this.rotateToPath=s(h,"rotateToPath",!1),this.pathRotationOffset=n(h,"rotationOffset",0);var p=n(h,"startAt",l);if(p&&(h.onStart=function(c){var f=c.data[0];f.progress=p,f.elapsed=f.duration*p;var m=f.ease(f.progress);f.current=f.start+(f.end-f.start)*m,f.setTargetValue()}),this.pathOffset||(this.pathOffset=new o(this.x,this.y)),this.pathVector||(this.pathVector=new o),this.pathDelta||(this.pathDelta=new o),this.pathDelta.reset(),h.persist=!0,this.pathTween=this.scene.sys.tweens.addCounter(h),this.path.getStartPoint(this.pathOffset),d&&(this.x=this.pathOffset.x,this.y=this.pathOffset.y),this.pathOffset.x=this.x-this.pathOffset.x,this.pathOffset.y=this.y-this.pathOffset.y,this._prevDirection=r.PLAYING_FORWARD,this.rotateToPath){var g=this.path.getPoint(.1);this.rotation=Math.atan2(g.y-this.y,g.x-this.x)+i(this.pathRotationOffset)}return this.pathConfig=h,this},pauseFollow:function(){var h=this.pathTween;return h&&h.isPlaying()&&h.pause(),this},resumeFollow:function(){var h=this.pathTween;return h&&h.isPaused()&&h.resume(),this},stopFollow:function(){var h=this.pathTween;return h&&h.isPlaying()&&h.stop(),this},pathUpdate:function(){var h=this.pathTween;if(h&&h.data){var l=h.data[0],u=this.pathDelta,d=this.pathVector;if(u.copy(d).negate(),l.state===r.COMPLETE){this.path.getPoint(l.end,d),u.add(d),d.add(this.pathOffset),this.setPosition(d.x,d.y);return}else if(l.state!==r.PLAYING_FORWARD&&l.state!==r.PLAYING_BACKWARD)return;this.path.getPoint(h.getValue(),d),u.add(d),d.add(this.pathOffset);var p=this.x,g=this.y;this.setPosition(d.x,d.y);var c=this.x-p,f=this.y-g;if(c===0&&f===0)return;if(l.state!==this._prevDirection){this._prevDirection=l.state;return}this.rotateToPath&&(this.rotation=Math.atan2(f,c)+i(this.pathRotationOffset))}}};t.exports=a}),bn=y((e,t)=>{var i=function(s){var n,r,o;if(typeof s!="object"||s===null)return s;n=Array.isArray(s)?[]:{};for(o in s)r=s[o],n[o]=i(r);return n};t.exports=i}),Xf=y((e,t)=>{var i=bn(),s={defaultPipeline:null,pipeline:null,pipelineData:null,initPipeline:function(n){this.pipelineData={};var r=this.scene.sys.renderer;if(!r)return!1;var o=r.pipelines;if(o){n===void 0&&(n=o.default);var a=o.get(n);if(a)return this.defaultPipeline=a,this.pipeline=a,!0}return!1},setPipeline:function(n,r,o){var a=this.scene.sys.renderer;if(!a)return this;var h=a.pipelines;if(h){var l=h.get(n);l&&(this.pipeline=l),r&&(this.pipelineData=o?i(r):r)}return this},setPipelineData:function(n,r){var o=this.pipelineData;return r===void 0?delete o[n]:o[n]=r,this},resetPipeline:function(n){return n===void 0&&(n=!1),this.pipeline=this.defaultPipeline,n&&(this.pipelineData={}),this.pipeline!==null},getPipelineName:function(){return this.pipeline===null?null:this.pipeline.name}};t.exports=s}),Kf=y((e,t)=>{var i=bn(),s=Xh(),n=Bi(),r={hasPostPipeline:!1,postPipelines:null,postPipelineData:null,preFX:null,postFX:null,initPostPipeline:function(o){this.postPipelines=[],this.postPipelineData={},this.postFX=new s(this,!0),o&&(this.preFX=new s(this,!1))},setPostPipeline:function(o,a,h){var l=this.scene.sys.renderer;if(!l)return this;var u=l.pipelines;if(u){Array.isArray(o)||(o=[o]);for(var d=0;d<o.length;d++){var p=u.getPostPipeline(o[d],this,a);p&&this.postPipelines.push(p)}a&&(this.postPipelineData=h?i(a):a)}return this.hasPostPipeline=this.postPipelines.length>0,this},setPostPipelineData:function(o,a){var h=this.postPipelineData;return a===void 0?delete h[o]:h[o]=a,this},getPostPipeline:function(o){for(var a=typeof o=="string",h=this.postPipelines,l=[],u=0;u<h.length;u++){var d=h[u];(a&&d.name===o||!a&&d instanceof o)&&l.push(d)}return l.length===1?l[0]:l},resetPostPipeline:function(o){o===void 0&&(o=!1);for(var a=this.postPipelines,h=0;h<a.length;h++)a[h].destroy();this.postPipelines=[],this.hasPostPipeline=!1,o&&(this.postPipelineData={})},removePostPipeline:function(o){for(var a=typeof o=="string",h=this.postPipelines,l=h.length-1;l>=0;l--){var u=h[l];(a&&u.name===o||!a&&u===o)&&(u.destroy(),n(h,l))}return this.hasPostPipeline=this.postPipelines.length>0,this},clearFX:function(){return this.preFX&&this.preFX.clear(),this.postFX&&this.postFX.clear(),this}};t.exports=r}),jf=y((e,t)=>{var i={scrollFactorX:1,scrollFactorY:1,setScrollFactor:function(s,n){return n===void 0&&(n=s),this.scrollFactorX=s,this.scrollFactorY=n,this}};t.exports=i}),Zf=y((e,t)=>{var i={_sizeComponent:!0,width:0,height:0,displayWidth:{get:function(){return Math.abs(this.scaleX*this.frame.realWidth)},set:function(s){this.scaleX=s/this.frame.realWidth}},displayHeight:{get:function(){return Math.abs(this.scaleY*this.frame.realHeight)},set:function(s){this.scaleY=s/this.frame.realHeight}},setSizeToFrame:function(s){s||(s=this.frame),this.width=s.realWidth,this.height=s.realHeight;var n=this.input;return n&&!n.customHitArea&&(n.hitArea.width=this.width,n.hitArea.height=this.height),this},setSize:function(s,n){return this.width=s,this.height=n,this},setDisplaySize:function(s,n){return this.displayWidth=s,this.displayHeight=n,this}};t.exports=i}),Hi=y((e,t)=>{var i=W(),s=Ot(),n=Qt(),r=new i({initialize:function(o,a,h,l,u,d,p){this.texture=o,this.name=a,this.source=o.source[h],this.sourceIndex=h,this.cutX,this.cutY,this.cutWidth,this.cutHeight,this.x=0,this.y=0,this.width,this.height,this.halfWidth,this.halfHeight,this.centerX,this.centerY,this.pivotX=0,this.pivotY=0,this.customPivot=!1,this.rotated=!1,this.autoRound=-1,this.customData={},this.u0=0,this.v0=0,this.u1=0,this.v1=0,this.data={cut:{x:0,y:0,w:0,h:0,r:0,b:0},trim:!1,sourceSize:{w:0,h:0},spriteSourceSize:{x:0,y:0,w:0,h:0,r:0,b:0},radius:0,drawImage:{x:0,y:0,width:0,height:0},is3Slice:!1,scale9:!1,scale9Borders:{x:0,y:0,w:0,h:0}},this.setSize(d,p,l,u)},setCutPosition:function(o,a){return o===void 0&&(o=0),a===void 0&&(a=0),this.cutX=o,this.cutY=a,this.updateUVs()},setCutSize:function(o,a){return this.cutWidth=o,this.cutHeight=a,this.updateUVs()},setSize:function(o,a,h,l){h===void 0&&(h=0),l===void 0&&(l=0),this.setCutPosition(h,l),this.setCutSize(o,a),this.width=o,this.height=a,this.halfWidth=Math.floor(o*.5),this.halfHeight=Math.floor(a*.5),this.centerX=Math.floor(o/2),this.centerY=Math.floor(a/2);var u=this.data,d=u.cut;d.x=h,d.y=l,d.w=o,d.h=a,d.r=h+o,d.b=l+a,u.sourceSize.w=o,u.sourceSize.h=a,u.spriteSourceSize.w=o,u.spriteSourceSize.h=a,u.radius=.5*Math.sqrt(o*o+a*a);var p=u.drawImage;return p.x=h,p.y=l,p.width=o,p.height=a,this.updateUVs()},setTrim:function(o,a,h,l,u,d){var p=this.data,g=p.spriteSourceSize;return p.trim=!0,p.sourceSize.w=o,p.sourceSize.h=a,g.x=h,g.y=l,g.w=u,g.h=d,g.r=h+u,g.b=l+d,this.x=h,this.y=l,this.width=u,this.height=d,this.halfWidth=u*.5,this.halfHeight=d*.5,this.centerX=Math.floor(u/2),this.centerY=Math.floor(d/2),this.updateUVs()},setScale9:function(o,a,h,l){var u=this.data;return u.scale9=!0,u.is3Slice=a===0&&l===this.height,u.scale9Borders.x=o,u.scale9Borders.y=a,u.scale9Borders.w=h,u.scale9Borders.h=l,this},setCropUVs:function(o,a,h,l,u,d,p){var g=this.cutX,c=this.cutY,f=this.cutWidth,m=this.cutHeight,v=this.realWidth,E=this.realHeight;a=s(a,0,v),h=s(h,0,E),l=s(l,0,v-a),u=s(u,0,E-h);var x=g+a,T=c+h,A=l,P=u,R=this.data;if(R.trim){var S=R.spriteSourceSize;l=s(l,0,S.x+f-a),u=s(u,0,S.y+m-h);var I=a+l,w=h+u,C=!(S.r<a||S.b<h||S.x>I||S.y>w);if(C){var _=Math.max(S.x,a),O=Math.max(S.y,h),D=Math.min(S.r,I)-_,F=Math.min(S.b,w)-O;A=D,P=F,d?x=g+(f-(_-S.x)-D):x=g+(_-S.x),p?T=c+(m-(O-S.y)-F):T=c+(O-S.y),a=_,h=O,l=D,u=F}else x=0,T=0,A=0,P=0}else d&&(x=g+(f-a-l)),p&&(T=c+(m-h-u));var N=this.source.width,Y=this.source.height;return o.u0=Math.max(0,x/N),o.v0=Math.max(0,T/Y),o.u1=Math.min(1,(x+A)/N),o.v1=Math.min(1,(T+P)/Y),o.x=a,o.y=h,o.cx=x,o.cy=T,o.cw=A,o.ch=P,o.width=l,o.height=u,o.flipX=d,o.flipY=p,o},updateCropUVs:function(o,a,h){return this.setCropUVs(o,o.x,o.y,o.width,o.height,a,h)},setUVs:function(o,a,h,l,u,d){var p=this.data.drawImage;return p.width=o,p.height=a,this.u0=h,this.v0=l,this.u1=u,this.v1=d,this},updateUVs:function(){var o=this.cutX,a=this.cutY,h=this.cutWidth,l=this.cutHeight,u=this.data.drawImage;u.width=h,u.height=l;var d=this.source.width,p=this.source.height;return this.u0=o/d,this.v0=a/p,this.u1=(o+h)/d,this.v1=(a+l)/p,this},updateUVsInverted:function(){var o=this.source.width,a=this.source.height;return this.u0=(this.cutX+this.cutHeight)/o,this.v0=this.cutY/a,this.u1=this.cutX/o,this.v1=(this.cutY+this.cutWidth)/a,this},clone:function(){var o=new r(this.texture,this.name,this.sourceIndex);return o.cutX=this.cutX,o.cutY=this.cutY,o.cutWidth=this.cutWidth,o.cutHeight=this.cutHeight,o.x=this.x,o.y=this.y,o.width=this.width,o.height=this.height,o.halfWidth=this.halfWidth,o.halfHeight=this.halfHeight,o.centerX=this.centerX,o.centerY=this.centerY,o.rotated=this.rotated,o.data=n(!0,o.data,this.data),o.updateUVs(),o},destroy:function(){this.texture=null,this.source=null,this.customData=null,this.data=null},glTexture:{get:function(){return this.source.glTexture}},realWidth:{get:function(){return this.data.sourceSize.w}},realHeight:{get:function(){return this.data.sourceSize.h}},radius:{get:function(){return this.data.radius}},trimmed:{get:function(){return this.data.trim}},scale9:{get:function(){return this.data.scale9}},is3Slice:{get:function(){return this.data.is3Slice}},canvasData:{get:function(){return this.data.drawImage}}});t.exports=r}),qf=y((e,t)=>{var i=Hi(),s=8,n={texture:null,frame:null,isCropped:!1,setTexture:function(r,o,a,h){return this.texture=this.scene.sys.textures.get(r),this.setFrame(o,a,h)},setFrame:function(r,o,a){return o===void 0&&(o=!0),a===void 0&&(a=!0),r instanceof i?(this.texture=this.scene.sys.textures.get(r.texture.key),this.frame=r):this.frame=this.texture.get(r),!this.frame.cutWidth||!this.frame.cutHeight?this.renderFlags&=~s:this.renderFlags|=s,this._sizeComponent&&o&&this.setSizeToFrame(),this._originComponent&&a&&(this.frame.customPivot?this.setOrigin(this.frame.pivotX,this.frame.pivotY):this.updateDisplayOrigin()),this}};t.exports=n}),Jf=y((e,t)=>{var i=Hi(),s=8,n={texture:null,frame:null,isCropped:!1,setCrop:function(r,o,a,h){if(r===void 0)this.isCropped=!1;else if(this.frame){if(typeof r=="number")this.frame.setCropUVs(this._crop,r,o,a,h,this.flipX,this.flipY);else{var l=r;this.frame.setCropUVs(this._crop,l.x,l.y,l.width,l.height,this.flipX,this.flipY)}this.isCropped=!0}return this},setTexture:function(r,o){return this.texture=this.scene.sys.textures.get(r),this.setFrame(o)},setFrame:function(r,o,a){return o===void 0&&(o=!0),a===void 0&&(a=!0),r instanceof i?(this.texture=this.scene.sys.textures.get(r.texture.key),this.frame=r):this.frame=this.texture.get(r),!this.frame.cutWidth||!this.frame.cutHeight?this.renderFlags&=~s:this.renderFlags|=s,this._sizeComponent&&o&&this.setSizeToFrame(),this._originComponent&&a&&(this.frame.customPivot?this.setOrigin(this.frame.pivotX,this.frame.pivotY):this.updateDisplayOrigin()),this.isCropped&&this.frame.updateCropUVs(this._crop,this.flipX,this.flipY),this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:!1,flipY:!1,cx:0,cy:0,cw:0,ch:0}}};t.exports=n}),Qf=y((e,t)=>{var i={tintTopLeft:16777215,tintTopRight:16777215,tintBottomLeft:16777215,tintBottomRight:16777215,tintFill:!1,clearTint:function(){return this.setTint(16777215),this},setTint:function(s,n,r,o){return s===void 0&&(s=16777215),n===void 0&&(n=s,r=s,o=s),this.tintTopLeft=s,this.tintTopRight=n,this.tintBottomLeft=r,this.tintBottomRight=o,this.tintFill=!1,this},setTintFill:function(s,n,r,o){return this.setTint(s,n,r,o),this.tintFill=!0,this},tint:{get:function(){return this.tintTopLeft},set:function(s){this.setTint(s,s,s,s)}},isTinted:{get:function(){var s=16777215;return this.tintFill||this.tintTopLeft!==s||this.tintTopRight!==s||this.tintBottomLeft!==s||this.tintBottomRight!==s}}};t.exports=i}),sa=y((e,t)=>{var i=function(s){var n={name:s.name,type:s.type,x:s.x,y:s.y,depth:s.depth,scale:{x:s.scaleX,y:s.scaleY},origin:{x:s.originX,y:s.originY},flipX:s.flipX,flipY:s.flipY,rotation:s.rotation,alpha:s.alpha,visible:s.visible,blendMode:s.blendMode,textureKey:"",frameKey:"",data:{}};return s.texture&&(n.textureKey=s.texture.key,n.frameKey=s.frame.name),n};t.exports=i}),Re=y((e,t)=>{var i=W(),s=Gt(),n=xt(),r=new i({initialize:function(o,a,h,l,u,d){o===void 0&&(o=1),a===void 0&&(a=0),h===void 0&&(h=0),l===void 0&&(l=1),u===void 0&&(u=0),d===void 0&&(d=0),this.matrix=new Float32Array([o,a,h,l,u,d,0,0,1]),this.decomposedMatrix={translateX:0,translateY:0,scaleX:1,scaleY:1,rotation:0},this.quad=new Float32Array(8)},a:{get:function(){return this.matrix[0]},set:function(o){this.matrix[0]=o}},b:{get:function(){return this.matrix[1]},set:function(o){this.matrix[1]=o}},c:{get:function(){return this.matrix[2]},set:function(o){this.matrix[2]=o}},d:{get:function(){return this.matrix[3]},set:function(o){this.matrix[3]=o}},e:{get:function(){return this.matrix[4]},set:function(o){this.matrix[4]=o}},f:{get:function(){return this.matrix[5]},set:function(o){this.matrix[5]=o}},tx:{get:function(){return this.matrix[4]},set:function(o){this.matrix[4]=o}},ty:{get:function(){return this.matrix[5]},set:function(o){this.matrix[5]=o}},rotation:{get:function(){return Math.acos(this.a/this.scaleX)*(Math.atan(-this.c/this.a)<0?-1:1)}},rotationNormalized:{get:function(){var o=this.matrix,a=o[0],h=o[1],l=o[2],u=o[3];return a||h?h>0?Math.acos(a/this.scaleX):-Math.acos(a/this.scaleX):l||u?s.TAU-(u>0?Math.acos(-l/this.scaleY):-Math.acos(l/this.scaleY)):0}},scaleX:{get:function(){return Math.sqrt(this.a*this.a+this.b*this.b)}},scaleY:{get:function(){return Math.sqrt(this.c*this.c+this.d*this.d)}},loadIdentity:function(){var o=this.matrix;return o[0]=1,o[1]=0,o[2]=0,o[3]=1,o[4]=0,o[5]=0,this},translate:function(o,a){var h=this.matrix;return h[4]=h[0]*o+h[2]*a+h[4],h[5]=h[1]*o+h[3]*a+h[5],this},scale:function(o,a){var h=this.matrix;return h[0]*=o,h[1]*=o,h[2]*=a,h[3]*=a,this},rotate:function(o){var a=Math.sin(o),h=Math.cos(o),l=this.matrix,u=l[0],d=l[1],p=l[2],g=l[3];return l[0]=u*h+p*a,l[1]=d*h+g*a,l[2]=u*-a+p*h,l[3]=d*-a+g*h,this},multiply:function(o,a){var h=this.matrix,l=o.matrix,u=h[0],d=h[1],p=h[2],g=h[3],c=h[4],f=h[5],m=l[0],v=l[1],E=l[2],x=l[3],T=l[4],A=l[5],P=a===void 0?h:a.matrix;return P[0]=m*u+v*p,P[1]=m*d+v*g,P[2]=E*u+x*p,P[3]=E*d+x*g,P[4]=T*u+A*p+c,P[5]=T*d+A*g+f,P},multiplyWithOffset:function(o,a,h){var l=this.matrix,u=o.matrix,d=l[0],p=l[1],g=l[2],c=l[3],f=l[4],m=l[5],v=a*d+h*g+f,E=a*p+h*c+m,x=u[0],T=u[1],A=u[2],P=u[3],R=u[4],S=u[5];return l[0]=x*d+T*g,l[1]=x*p+T*c,l[2]=A*d+P*g,l[3]=A*p+P*c,l[4]=R*d+S*g+v,l[5]=R*p+S*c+E,this},transform:function(o,a,h,l,u,d){var p=this.matrix,g=p[0],c=p[1],f=p[2],m=p[3],v=p[4],E=p[5];return p[0]=o*g+a*f,p[1]=o*c+a*m,p[2]=h*g+l*f,p[3]=h*c+l*m,p[4]=u*g+d*f+v,p[5]=u*c+d*m+E,this},transformPoint:function(o,a,h){h===void 0&&(h={x:0,y:0});var l=this.matrix,u=l[0],d=l[1],p=l[2],g=l[3],c=l[4],f=l[5];return h.x=o*u+a*p+c,h.y=o*d+a*g+f,h},invert:function(){var o=this.matrix,a=o[0],h=o[1],l=o[2],u=o[3],d=o[4],p=o[5],g=a*u-h*l;return o[0]=u/g,o[1]=-h/g,o[2]=-l/g,o[3]=a/g,o[4]=(l*p-u*d)/g,o[5]=-(a*p-h*d)/g,this},copyFrom:function(o){var a=this.matrix;return a[0]=o.a,a[1]=o.b,a[2]=o.c,a[3]=o.d,a[4]=o.e,a[5]=o.f,this},copyFromArray:function(o){var a=this.matrix;return a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[3],a[4]=o[4],a[5]=o[5],this},copyToContext:function(o){var a=this.matrix;return o.transform(a[0],a[1],a[2],a[3],a[4],a[5]),o},setToContext:function(o){return o.setTransform(this.a,this.b,this.c,this.d,this.e,this.f),o},copyToArray:function(o){var a=this.matrix;return o===void 0?o=[a[0],a[1],a[2],a[3],a[4],a[5]]:(o[0]=a[0],o[1]=a[1],o[2]=a[2],o[3]=a[3],o[4]=a[4],o[5]=a[5]),o},setTransform:function(o,a,h,l,u,d){var p=this.matrix;return p[0]=o,p[1]=a,p[2]=h,p[3]=l,p[4]=u,p[5]=d,this},decomposeMatrix:function(){var o=this.decomposedMatrix,a=this.matrix,h=a[0],l=a[1],u=a[2],d=a[3],p=h*d-l*u;if(o.translateX=a[4],o.translateY=a[5],h||l){var g=Math.sqrt(h*h+l*l);o.rotation=l>0?Math.acos(h/g):-Math.acos(h/g),o.scaleX=g,o.scaleY=p/g}else if(u||d){var c=Math.sqrt(u*u+d*d);o.rotation=Math.PI*.5-(d>0?Math.acos(-u/c):-Math.acos(u/c)),o.scaleX=p/c,o.scaleY=c}else o.rotation=0,o.scaleX=0,o.scaleY=0;return o},applyITRS:function(o,a,h,l,u){var d=this.matrix,p=Math.sin(h),g=Math.cos(h);return d[4]=o,d[5]=a,d[0]=g*l,d[1]=p*l,d[2]=-p*u,d[3]=g*u,this},applyInverse:function(o,a,h){h===void 0&&(h=new n);var l=this.matrix,u=l[0],d=l[1],p=l[2],g=l[3],c=l[4],f=l[5],m=1/(u*g+p*-d);return h.x=g*m*o+-p*m*a+(f*p-c*g)*m,h.y=u*m*a+-d*m*o+(-f*u+c*d)*m,h},setQuad:function(o,a,h,l,u,d){u===void 0&&(u=!1),d===void 0&&(d=this.quad);var p=this.matrix,g=p[0],c=p[1],f=p[2],m=p[3],v=p[4],E=p[5],x=o*g+a*f+v,T=o*c+a*m+E,A=o*g+l*f+v,P=o*c+l*m+E,R=h*g+l*f+v,S=h*c+l*m+E,I=h*g+a*f+v,w=h*c+a*m+E;if(u){var C=Math.floor(x+.5),_=Math.floor(T+.5),O=C-x,D=_-T;d[0]=C,d[1]=_,d[2]=A+O,d[3]=P+D,d[4]=R+O,d[5]=S+D,d[6]=I+O,d[7]=w+D}else d[0]=x,d[1]=T,d[2]=A,d[3]=P,d[4]=R,d[5]=S,d[6]=I,d[7]=w;return d},getX:function(o,a){return o*this.a+a*this.c+this.e},getY:function(o,a){return o*this.b+a*this.d+this.f},getXRound:function(o,a,h){var l=this.getX(o,a);return h&&(l=Math.floor(l+.5)),l},getYRound:function(o,a,h){var l=this.getY(o,a);return h&&(l=Math.floor(l+.5)),l},getCSSMatrix:function(){var o=this.matrix;return"matrix("+o[0]+","+o[1]+","+o[2]+","+o[3]+","+o[4]+","+o[5]+")"},destroy:function(){this.matrix=null,this.quad=null,this.decomposedMatrix=null}});t.exports=r}),na=y((e,t)=>{var i=xt(),s=function(n,r,o,a,h,l,u,d){d===void 0&&(d=new i);var p=Math.sin(h),g=Math.cos(h),c=g*l,f=p*l,m=-p*u,v=g*u,E=1/(c*v+m*-f);return d.x=v*E*n+-m*E*r+(a*m-o*v)*E,d.y=c*E*r+-f*E*n+(-a*c+o*f)*E,d};t.exports=s}),Ai=y((e,t)=>{var i=function(s,n,r){var o=r-n;return n+((s-n)%o+o)%o};t.exports=i}),Jh=y((e,t)=>{var i=Ai(),s=function(n){return i(n,-Math.PI,Math.PI)};t.exports=s}),Qh=y((e,t)=>{var i=Ai(),s=function(n){return i(n,-180,180)};t.exports=s}),$f=y((e,t)=>{var i=Gt(),s=Re(),n=na(),r=Jh(),o=Qh(),a=xt(),h=4,l={hasTransformComponent:!0,_scaleX:1,_scaleY:1,_rotation:0,x:0,y:0,z:0,w:0,scale:{get:function(){return(this._scaleX+this._scaleY)/2},set:function(u){this._scaleX=u,this._scaleY=u,u===0?this.renderFlags&=~h:this.renderFlags|=h}},scaleX:{get:function(){return this._scaleX},set:function(u){this._scaleX=u,u===0?this.renderFlags&=~h:this._scaleY!==0&&(this.renderFlags|=h)}},scaleY:{get:function(){return this._scaleY},set:function(u){this._scaleY=u,u===0?this.renderFlags&=~h:this._scaleX!==0&&(this.renderFlags|=h)}},angle:{get:function(){return o(this._rotation*i.RAD_TO_DEG)},set:function(u){this.rotation=o(u)*i.DEG_TO_RAD}},rotation:{get:function(){return this._rotation},set:function(u){this._rotation=r(u)}},setPosition:function(u,d,p,g){return u===void 0&&(u=0),d===void 0&&(d=u),p===void 0&&(p=0),g===void 0&&(g=0),this.x=u,this.y=d,this.z=p,this.w=g,this},copyPosition:function(u){return u.x!==void 0&&(this.x=u.x),u.y!==void 0&&(this.y=u.y),u.z!==void 0&&(this.z=u.z),u.w!==void 0&&(this.w=u.w),this},setRandomPosition:function(u,d,p,g){return u===void 0&&(u=0),d===void 0&&(d=0),p===void 0&&(p=this.scene.sys.scale.width),g===void 0&&(g=this.scene.sys.scale.height),this.x=u+Math.random()*p,this.y=d+Math.random()*g,this},setRotation:function(u){return u===void 0&&(u=0),this.rotation=u,this},setAngle:function(u){return u===void 0&&(u=0),this.angle=u,this},setScale:function(u,d){return u===void 0&&(u=1),d===void 0&&(d=u),this.scaleX=u,this.scaleY=d,this},setX:function(u){return u===void 0&&(u=0),this.x=u,this},setY:function(u){return u===void 0&&(u=0),this.y=u,this},setZ:function(u){return u===void 0&&(u=0),this.z=u,this},setW:function(u){return u===void 0&&(u=0),this.w=u,this},getLocalTransformMatrix:function(u){return u===void 0&&(u=new s),u.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY)},getWorldTransformMatrix:function(u,d){u===void 0&&(u=new s);var p=this.parentContainer;if(!p)return this.getLocalTransformMatrix(u);var g=!1;for(d||(d=new s,g=!0),u.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY);p;)d.applyITRS(p.x,p.y,p._rotation,p._scaleX,p._scaleY),d.multiply(u,u),p=p.parentContainer;return g&&d.destroy(),u},getLocalPoint:function(u,d,p,g){p||(p=new a),g||(g=this.scene.sys.cameras.main);var c=g.scrollX,f=g.scrollY,m=u+c*this.scrollFactorX-c,v=d+f*this.scrollFactorY-f;return this.parentContainer?this.getWorldTransformMatrix().applyInverse(m,v,p):n(m,v,this.x,this.y,this.rotation,this.scaleX,this.scaleY,p),this._originComponent&&(p.x+=this._displayOriginX,p.y+=this._displayOriginY),p},getWorldPoint:function(u,d,p){u===void 0&&(u=new a);var g=this.parentContainer;if(!g)return u.x=this.x,u.y=this.y,u;var c=this.getWorldTransformMatrix(d,p);return u.x=c.tx,u.y=c.ty,u},getParentRotation:function(){for(var u=0,d=this.parentContainer;d;)u+=d.rotation,d=d.parentContainer;return u}};t.exports=l}),tm=y((e,t)=>{var i=1,s={_visible:!0,visible:{get:function(){return this._visible},set:function(n){n?(this._visible=!0,this.renderFlags|=i):(this._visible=!1,this.renderFlags&=~i)}},setVisible:function(n){return this.visible=n,this}};t.exports=s}),be=y((e,t)=>{t.exports={Alpha:yg(),AlphaSingle:Tg(),BlendMode:xg(),ComputedSize:Sg(),Crop:Ag(),Depth:sf(),Flip:nf(),FX:Xh(),GetBounds:Tf(),Mask:zf(),Origin:Wf(),PathFollower:Vf(),Pipeline:Xf(),PostPipeline:Kf(),ScrollFactor:jf(),Size:Zf(),Texture:qf(),TextureCrop:Jf(),Tint:Qf(),ToJSON:sa(),Transform:$f(),TransformMatrix:Re(),Visible:tm()}}),em=y((e,t)=>{t.exports="changedata"}),im=y((e,t)=>{t.exports="changedata-"}),sm=y((e,t)=>{t.exports="destroy"}),nm=y((e,t)=>{t.exports="removedata"}),rm=y((e,t)=>{t.exports="setdata"}),$h=y((e,t)=>{t.exports={CHANGE_DATA:em(),CHANGE_DATA_KEY:im(),DESTROY:sm(),REMOVE_DATA:nm(),SET_DATA:rm()}}),In=y((e,t)=>{var i=W(),s=$h(),n=new i({initialize:function(r,o){this.parent=r,this.events=o,o||(this.events=r.events?r.events:r),this.list={},this.values={},this._frozen=!1,!r.hasOwnProperty("sys")&&this.events&&this.events.once(s.DESTROY,this.destroy,this)},get:function(r){var o=this.list;if(Array.isArray(r)){for(var a=[],h=0;h<r.length;h++)a.push(o[r[h]]);return a}else return o[r]},getAll:function(){var r={};for(var o in this.list)this.list.hasOwnProperty(o)&&(r[o]=this.list[o]);return r},query:function(r){var o={};for(var a in this.list)this.list.hasOwnProperty(a)&&a.match(r)&&(o[a]=this.list[a]);return o},set:function(r,o){if(this._frozen)return this;if(typeof r=="string")return this.setValue(r,o);for(var a in r)this.setValue(a,r[a]);return this},inc:function(r,o){if(this._frozen)return this;o===void 0&&(o=1);var a=this.get(r);return a===void 0&&(a=0),this.set(r,a+o),this},toggle:function(r){return this._frozen?this:(this.set(r,!this.get(r)),this)},setValue:function(r,o){if(this._frozen)return this;if(this.has(r))this.values[r]=o;else{var a=this,h=this.list,l=this.events,u=this.parent;Object.defineProperty(this.values,r,{enumerable:!0,configurable:!0,get:function(){return h[r]},set:function(d){if(!a._frozen){var p=h[r];h[r]=d,l.emit(s.CHANGE_DATA,u,r,d,p),l.emit(s.CHANGE_DATA_KEY+r,u,d,p)}}}),h[r]=o,l.emit(s.SET_DATA,u,r,o)}return this},each:function(r,o){for(var a=[this.parent,null,void 0],h=1;h<arguments.length;h++)a.push(arguments[h]);for(var l in this.list)a[1]=l,a[2]=this.list[l],r.apply(o,a);return this},merge:function(r,o){o===void 0&&(o=!0);for(var a in r)r.hasOwnProperty(a)&&(o||!o&&!this.has(a))&&this.setValue(a,r[a]);return this},remove:function(r){if(this._frozen)return this;if(Array.isArray(r))for(var o=0;o<r.length;o++)this.removeValue(r[o]);else return this.removeValue(r);return this},removeValue:function(r){if(this.has(r)){var o=this.list[r];delete this.list[r],delete this.values[r],this.events.emit(s.REMOVE_DATA,this.parent,r,o)}return this},pop:function(r){var o=void 0;return!this._frozen&&this.has(r)&&(o=this.list[r],delete this.list[r],delete this.values[r],this.events.emit(s.REMOVE_DATA,this.parent,r,o)),o},has:function(r){return this.list.hasOwnProperty(r)},setFreeze:function(r){return this._frozen=r,this},reset:function(){for(var r in this.list)delete this.list[r],delete this.values[r];return this._frozen=!1,this},destroy:function(){this.reset(),this.events.off(s.CHANGE_DATA),this.events.off(s.SET_DATA),this.events.off(s.REMOVE_DATA),this.parent=null},freeze:{get:function(){return this._frozen},set:function(r){this._frozen=!!r}},count:{get:function(){var r=0;for(var o in this.list)this.list[o]!==void 0&&r++;return r}}});t.exports=n}),am=y((e,t)=>{t.exports="addedtoscene"}),om=y((e,t)=>{t.exports="destroy"}),hm=y((e,t)=>{t.exports="removedfromscene"}),lm=y((e,t)=>{t.exports="complete"}),um=y((e,t)=>{t.exports="created"}),cm=y((e,t)=>{t.exports="error"}),dm=y((e,t)=>{t.exports="locked"}),pm=y((e,t)=>{t.exports="loop"}),gm=y((e,t)=>{t.exports="metadata"}),fm=y((e,t)=>{t.exports="play"}),mm=y((e,t)=>{t.exports="playing"}),vm=y((e,t)=>{t.exports="seeked"}),Em=y((e,t)=>{t.exports="seeking"}),ym=y((e,t)=>{t.exports="stalled"}),Tm=y((e,t)=>{t.exports="stop"}),xm=y((e,t)=>{t.exports="textureready"}),Sm=y((e,t)=>{t.exports="unlocked"}),Am=y((e,t)=>{t.exports="unsupported"}),bs=y((e,t)=>{t.exports={ADDED_TO_SCENE:am(),DESTROY:om(),REMOVED_FROM_SCENE:hm(),VIDEO_COMPLETE:lm(),VIDEO_CREATED:um(),VIDEO_ERROR:cm(),VIDEO_LOCKED:dm(),VIDEO_LOOP:pm(),VIDEO_METADATA:gm(),VIDEO_PLAY:fm(),VIDEO_PLAYING:mm(),VIDEO_SEEKED:vm(),VIDEO_SEEKING:Em(),VIDEO_STALLED:ym(),VIDEO_STOP:Tm(),VIDEO_TEXTURE:xm(),VIDEO_UNLOCKED:Sm(),VIDEO_UNSUPPORTED:Am()}}),He=y((e,t)=>{var i=W(),s=sa(),n=In(),r=Ct(),o=bs(),a=Vt(),h=new i({Extends:r,initialize:function(l,u){r.call(this),this.scene=l,this.displayList=null,this.type=u,this.state=0,this.parentContainer=null,this.name="",this.active=!0,this.tabIndex=-1,this.data=null,this.renderFlags=15,this.cameraFilter=0,this.input=null,this.body=null,this.ignoreDestroy=!1,this.on(o.ADDED_TO_SCENE,this.addedToScene,this),this.on(o.REMOVED_FROM_SCENE,this.removedFromScene,this),l.sys.queueDepthSort()},setActive:function(l){return this.active=l,this},setName:function(l){return this.name=l,this},setState:function(l){return this.state=l,this},setDataEnabled:function(){return this.data||(this.data=new n(this)),this},setData:function(l,u){return this.data||(this.data=new n(this)),this.data.set(l,u),this},incData:function(l,u){return this.data||(this.data=new n(this)),this.data.inc(l,u),this},toggleData:function(l){return this.data||(this.data=new n(this)),this.data.toggle(l),this},getData:function(l){return this.data||(this.data=new n(this)),this.data.get(l)},setInteractive:function(l,u,d){return this.scene.sys.input.enable(this,l,u,d),this},disableInteractive:function(l){return l===void 0&&(l=!1),this.scene.sys.input.disable(this,l),this},removeInteractive:function(l){return l===void 0&&(l=!1),this.scene.sys.input.clear(this),l&&this.scene.sys.input.resetCursor(),this.input=void 0,this},addedToScene:function(){},removedFromScene:function(){},update:function(){},toJSON:function(){return s(this)},willRender:function(l){var u=this.displayList&&this.displayList.active?this.displayList.willRender(l):!0;return!(!u||h.RENDER_MASK!==this.renderFlags||this.cameraFilter!==0&&this.cameraFilter&l.id)},getIndexList:function(){for(var l=this,u=this.parentContainer,d=[];u&&(d.unshift(u.getIndex(l)),l=u,u.parentContainer);)u=u.parentContainer;return this.displayList?d.unshift(this.displayList.getIndex(l)):d.unshift(this.scene.sys.displayList.getIndex(l)),d},addToDisplayList:function(l){return l===void 0&&(l=this.scene.sys.displayList),this.displayList&&this.displayList!==l&&this.removeFromDisplayList(),l.exists(this)||(this.displayList=l,l.add(this,!0),l.queueDepthSort(),this.emit(o.ADDED_TO_SCENE,this,this.scene),l.events.emit(a.ADDED_TO_SCENE,this,this.scene)),this},addToUpdateList:function(){return this.scene&&this.preUpdate&&this.scene.sys.updateList.add(this),this},removeFromDisplayList:function(){var l=this.displayList||this.scene.sys.displayList;return l&&l.exists(this)&&(l.remove(this,!0),l.queueDepthSort(),this.displayList=null,this.emit(o.REMOVED_FROM_SCENE,this,this.scene),l.events.emit(a.REMOVED_FROM_SCENE,this,this.scene)),this},removeFromUpdateList:function(){return this.scene&&this.preUpdate&&this.scene.sys.updateList.remove(this),this},getDisplayList:function(){var l=null;return this.parentContainer?l=this.parentContainer.list:this.displayList&&(l=this.displayList.list),l},destroy:function(l){!this.scene||this.ignoreDestroy||(l===void 0&&(l=!1),this.preDestroy&&this.preDestroy.call(this),this.emit(o.DESTROY,this,l),this.removeAllListeners(),this.postPipelines&&this.resetPostPipeline(!0),this.removeFromDisplayList(),this.removeFromUpdateList(),this.input&&(this.scene.sys.input.clear(this),this.input=void 0),this.data&&(this.data.destroy(),this.data=void 0),this.body&&(this.body.destroy(),this.body=void 0),this.preFX&&(this.preFX.destroy(),this.preFX=void 0),this.postFX&&(this.postFX.destroy(),this.postFX=void 0),this.active=!1,this.visible=!1,this.scene=void 0,this.parentContainer=void 0)}});h.RENDER_MASK=15,t.exports=h}),_n=y((e,t)=>{var i=Ge(),s=yn(),n=Ni(),r=W(),o=be(),a=He(),h=Ut(),l=Ui(),u=new r({Extends:a,Mixins:[o.Depth,o.GetBounds,o.Origin,o.Transform,o.ScrollFactor,o.Visible],initialize:function(d,p,g,c,f){c===void 0&&(c=1),f===void 0&&(f=c),a.call(this,d,"Zone"),this.setPosition(p,g),this.width=c,this.height=f,this.blendMode=i.NORMAL,this.updateDisplayOrigin()},displayWidth:{get:function(){return this.scaleX*this.width},set:function(d){this.scaleX=d/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(d){this.scaleY=d/this.height}},setSize:function(d,p,g){g===void 0&&(g=!0),this.width=d,this.height=p,this.updateDisplayOrigin();var c=this.input;return g&&c&&!c.customHitArea&&(c.hitArea.width=d,c.hitArea.height=p),this},setDisplaySize:function(d,p){return this.displayWidth=d,this.displayHeight=p,this},setCircleDropZone:function(d){return this.setDropZone(new s(0,0,d),n)},setRectangleDropZone:function(d,p){return this.setDropZone(new h(0,0,d,p),l)},setDropZone:function(d,p){return this.input||this.setInteractive(d,p,!0),this},setAlpha:function(){},setBlendMode:function(){},renderCanvas:function(d,p,g){g.addToRenderList(p)},renderWebGL:function(d,p,g){g.addToRenderList(p)}});t.exports=u}),wm=y((e,t)=>{var i=kh(),s=En(),n=dt(),r=Rt(),o=_n(),a=new o({sys:{queueDepthSort:r,events:{once:r}}},0,0,1,1).setOrigin(0,0),h=function(l,u){u===void 0&&(u={});var d=u.hasOwnProperty("width"),p=u.hasOwnProperty("height"),g=n(u,"width",-1),c=n(u,"height",-1),f=n(u,"cellWidth",1),m=n(u,"cellHeight",f),v=n(u,"position",s.TOP_LEFT),E=n(u,"x",0),x=n(u,"y",0),T=0,A=0,P=g*f,R=c*m;a.setPosition(E,x),a.setSize(f,m);for(var S=0;S<l.length;S++)if(i(l[S],a,v),d&&g===-1)a.x+=f;else if(p&&c===-1)a.y+=m;else if(p&&!d){if(A+=m,a.y+=m,A===R&&(A=0,T+=f,a.y=x,a.x+=f,T===P))break}else if(T+=f,a.x+=f,T===P&&(T=0,A+=m,a.x=E,a.y+=m,A===R))break;return l};t.exports=h}),Cm=y((e,t)=>{var i=Me(),s=function(n,r,o,a,h){return i(n,"alpha",r,o,a,h)};t.exports=s}),Pm=y((e,t)=>{var i=Me(),s=function(n,r,o,a,h){return i(n,"x",r,o,a,h)};t.exports=s}),Rm=y((e,t)=>{var i=Me(),s=function(n,r,o,a,h,l,u){return o==null&&(o=r),i(n,"x",r,a,l,u),i(n,"y",o,h,l,u)};t.exports=s}),bm=y((e,t)=>{var i=Me(),s=function(n,r,o,a,h){return i(n,"y",r,o,a,h)};t.exports=s}),Im=y((e,t)=>{var i=function(s,n,r,o){r===void 0&&(r=0),o===void 0&&(o=6.28);for(var a=r,h=(o-r)/s.length,l=n.x,u=n.y,d=n.radius,p=0;p<s.length;p++)s[p].x=l+d*Math.cos(a),s[p].y=u+d*Math.sin(a),a+=h;return s};t.exports=i}),_m=y((e,t)=>{var i=function(s,n,r,o){r===void 0&&(r=0),o===void 0&&(o=6.28);for(var a=r,h=(o-r)/s.length,l=n.width/2,u=n.height/2,d=0;d<s.length;d++)s[d].x=n.x+l*Math.cos(a),s[d].y=n.y+u*Math.sin(a),a+=h;return s};t.exports=i}),tl=y((e,t)=>{var i=function(s,n){var r=s.x-n.x,o=s.y-n.y;return Math.sqrt(r*r+o*o)};t.exports=i}),Om=y((e,t)=>{var i=function(s,n){return n===void 0&&(n=1.70158),s*s*((n+1)*s-n)};t.exports=i}),Mm=y((e,t)=>{var i=function(s,n){return n===void 0&&(n=1.70158),--s*s*((n+1)*s+n)+1};t.exports=i}),Lm=y((e,t)=>{var i=function(s,n){n===void 0&&(n=1.70158);var r=n*1.525;return(s*=2)<1?.5*(s*s*((r+1)*s-r)):.5*((s-=2)*s*((r+1)*s+r)+2)};t.exports=i}),el=y((e,t)=>{t.exports={In:Om(),Out:Mm(),InOut:Lm()}}),Dm=y((e,t)=>{var i=function(s){return s=1-s,s<.36363636363636365?1-7.5625*s*s:s<.7272727272727273?1-(7.5625*(s-=.5454545454545454)*s+.75):s<.9090909090909091?1-(7.5625*(s-=.8181818181818182)*s+.9375):1-(7.5625*(s-=.9545454545454546)*s+.984375)};t.exports=i}),km=y((e,t)=>{var i=function(s){return s<.36363636363636365?7.5625*s*s:s<.7272727272727273?7.5625*(s-=.5454545454545454)*s+.75:s<.9090909090909091?7.5625*(s-=.8181818181818182)*s+.9375:7.5625*(s-=.9545454545454546)*s+.984375};t.exports=i}),Fm=y((e,t)=>{var i=function(s){var n=!1;return s<.5?(s=1-s*2,n=!0):s=s*2-1,s<.36363636363636365?s=7.5625*s*s:s<.7272727272727273?s=7.5625*(s-=.5454545454545454)*s+.75:s<.9090909090909091?s=7.5625*(s-=.8181818181818182)*s+.9375:s=7.5625*(s-=.9545454545454546)*s+.984375,n?(1-s)*.5:s*.5+.5};t.exports=i}),il=y((e,t)=>{t.exports={In:Dm(),Out:km(),InOut:Fm()}}),Nm=y((e,t)=>{var i=function(s){return 1-Math.sqrt(1-s*s)};t.exports=i}),Bm=y((e,t)=>{var i=function(s){return Math.sqrt(1- --s*s)};t.exports=i}),Um=y((e,t)=>{var i=function(s){return(s*=2)<1?-.5*(Math.sqrt(1-s*s)-1):.5*(Math.sqrt(1-(s-=2)*s)+1)};t.exports=i}),sl=y((e,t)=>{t.exports={In:Nm(),Out:Bm(),InOut:Um()}}),Gm=y((e,t)=>{var i=function(s){return s*s*s};t.exports=i}),Ym=y((e,t)=>{var i=function(s){return--s*s*s+1};t.exports=i}),Hm=y((e,t)=>{var i=function(s){return(s*=2)<1?.5*s*s*s:.5*((s-=2)*s*s+2)};t.exports=i}),nl=y((e,t)=>{t.exports={In:Gm(),Out:Ym(),InOut:Hm()}}),zm=y((e,t)=>{var i=function(s,n,r){if(n===void 0&&(n=.1),r===void 0&&(r=.1),s===0)return 0;if(s===1)return 1;var o=r/4;return n<1?n=1:o=r*Math.asin(1/n)/(2*Math.PI),-(n*Math.pow(2,10*(s-=1))*Math.sin((s-o)*(2*Math.PI)/r))};t.exports=i}),Wm=y((e,t)=>{var i=function(s,n,r){if(n===void 0&&(n=.1),r===void 0&&(r=.1),s===0)return 0;if(s===1)return 1;var o=r/4;return n<1?n=1:o=r*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*s)*Math.sin((s-o)*(2*Math.PI)/r)+1};t.exports=i}),Vm=y((e,t)=>{var i=function(s,n,r){if(n===void 0&&(n=.1),r===void 0&&(r=.1),s===0)return 0;if(s===1)return 1;var o=r/4;return n<1?n=1:o=r*Math.asin(1/n)/(2*Math.PI),(s*=2)<1?-.5*(n*Math.pow(2,10*(s-=1))*Math.sin((s-o)*(2*Math.PI)/r)):n*Math.pow(2,-10*(s-=1))*Math.sin((s-o)*(2*Math.PI)/r)*.5+1};t.exports=i}),rl=y((e,t)=>{t.exports={In:zm(),Out:Wm(),InOut:Vm()}}),Xm=y((e,t)=>{var i=function(s){return Math.pow(2,10*(s-1))-.001};t.exports=i}),Km=y((e,t)=>{var i=function(s){return 1-Math.pow(2,-10*s)};t.exports=i}),jm=y((e,t)=>{var i=function(s){return(s*=2)<1?.5*Math.pow(2,10*(s-1)):.5*(2-Math.pow(2,-10*(s-1)))};t.exports=i}),al=y((e,t)=>{t.exports={In:Xm(),Out:Km(),InOut:jm()}}),Zm=y((e,t)=>{var i=function(s){return s};t.exports=i}),ol=y((e,t)=>{t.exports=Zm()}),qm=y((e,t)=>{var i=function(s){return s*s};t.exports=i}),Jm=y((e,t)=>{var i=function(s){return s*(2-s)};t.exports=i}),Qm=y((e,t)=>{var i=function(s){return(s*=2)<1?.5*s*s:-.5*(--s*(s-2)-1)};t.exports=i}),hl=y((e,t)=>{t.exports={In:qm(),Out:Jm(),InOut:Qm()}}),$m=y((e,t)=>{var i=function(s){return s*s*s*s};t.exports=i}),t0=y((e,t)=>{var i=function(s){return 1- --s*s*s*s};t.exports=i}),e0=y((e,t)=>{var i=function(s){return(s*=2)<1?.5*s*s*s*s:-.5*((s-=2)*s*s*s-2)};t.exports=i}),ll=y((e,t)=>{t.exports={In:$m(),Out:t0(),InOut:e0()}}),i0=y((e,t)=>{var i=function(s){return s*s*s*s*s};t.exports=i}),s0=y((e,t)=>{var i=function(s){return--s*s*s*s*s+1};t.exports=i}),n0=y((e,t)=>{var i=function(s){return(s*=2)<1?.5*s*s*s*s*s:.5*((s-=2)*s*s*s*s+2)};t.exports=i}),ul=y((e,t)=>{t.exports={In:i0(),Out:s0(),InOut:n0()}}),r0=y((e,t)=>{var i=function(s){return s===0?0:s===1?1:1-Math.cos(s*Math.PI/2)};t.exports=i}),a0=y((e,t)=>{var i=function(s){return s===0?0:s===1?1:Math.sin(s*Math.PI/2)};t.exports=i}),o0=y((e,t)=>{var i=function(s){return s===0?0:s===1?1:.5*(1-Math.cos(Math.PI*s))};t.exports=i}),cl=y((e,t)=>{t.exports={In:r0(),Out:a0(),InOut:o0()}}),h0=y((e,t)=>{var i=function(s,n){return n===void 0&&(n=1),s<=0?0:s>=1?1:((n*s|0)+1)*(1/n)};t.exports=i}),dl=y((e,t)=>{t.exports=h0()}),On=y((e,t)=>{var i=el(),s=il(),n=sl(),r=nl(),o=rl(),a=al(),h=ol(),l=hl(),u=ll(),d=ul(),p=cl(),g=dl();t.exports={Power0:h,Power1:l.Out,Power2:r.Out,Power3:u.Out,Power4:d.Out,Linear:h,Quad:l.Out,Cubic:r.Out,Quart:u.Out,Quint:d.Out,Sine:p.Out,Expo:a.Out,Circ:n.Out,Elastic:o.Out,Back:i.Out,Bounce:s.Out,Stepped:g,"Quad.easeIn":l.In,"Cubic.easeIn":r.In,"Quart.easeIn":u.In,"Quint.easeIn":d.In,"Sine.easeIn":p.In,"Expo.easeIn":a.In,"Circ.easeIn":n.In,"Elastic.easeIn":o.In,"Back.easeIn":i.In,"Bounce.easeIn":s.In,"Quad.easeOut":l.Out,"Cubic.easeOut":r.Out,"Quart.easeOut":u.Out,"Quint.easeOut":d.Out,"Sine.easeOut":p.Out,"Expo.easeOut":a.Out,"Circ.easeOut":n.Out,"Elastic.easeOut":o.Out,"Back.easeOut":i.Out,"Bounce.easeOut":s.Out,"Quad.easeInOut":l.InOut,"Cubic.easeInOut":r.InOut,"Quart.easeInOut":u.InOut,"Quint.easeInOut":d.InOut,"Sine.easeInOut":p.InOut,"Expo.easeInOut":a.InOut,"Circ.easeInOut":n.InOut,"Elastic.easeInOut":o.InOut,"Back.easeInOut":i.InOut,"Bounce.easeInOut":s.InOut}}),ra=y((e,t)=>{var i=function(s){return s&&s[0].toUpperCase()+s.slice(1)};t.exports=i}),wi=y((e,t)=>{var i=On(),s=ra(),n=function(r,o){var a=i.Power0;if(typeof r=="string")if(i.hasOwnProperty(r))a=i[r];else{var h="";if(r.indexOf(".")){h=r.substring(r.indexOf(".")+1);var l=h.toLowerCase();l==="in"?h="easeIn":l==="out"?h="easeOut":l==="inout"&&(h="easeInOut")}r=s(r.substring(0,r.indexOf(".")+1)+h),i.hasOwnProperty(r)&&(a=i[r])}else typeof r=="function"&&(a=r);if(!o)return a;var u=o.slice(0);return u.unshift(0),function(d){return u[0]=d,a.apply(this,u)}};t.exports=n}),pl=y((e,t)=>{var i=tl(),s=wi(),n=Mt(),r=function(o,a,h,l,u){l===void 0&&(l=0),u===void 0&&(u=[]);var d=[],p=o.x1,g=o.y1,c=o.x2-p,f=o.y2-g,m=s(a,u),v,E,x=h-1;for(v=0;v<x;v++)E=m(v/x),d.push(new n(p+c*E,g+f*E));if(E=m(1),d.push(new n(p+c*E,g+f*E)),l>0){var T=d[0],A=[T];for(v=1;v<d.length-1;v++){var P=d[v];i(T,P)>=l&&(A.push(P),T=P)}var R=d[d.length-1];return i(T,R)<l&&A.pop(),A.push(R),A}else return d};t.exports=r}),l0=y((e,t)=>{var i=Qr(),s=pl(),n=function(r,o,a){var h;a?h=s(o,a,r.length):h=i(o,r.length);for(var l=0;l<r.length;l++){var u=r[l],d=h[l];u.x=d.x,u.y=d.y}return r};t.exports=n}),gl=y((e,t)=>{var i=Pn(),s=Mt(),n=function(r,o,a,h){if(h===void 0&&(h=[]),!o&&!a)return h;o?a=Math.round(i(r)/o):o=i(r)/a;for(var l=r.x,u=r.y,d=0,p=0;p<a;p++)switch(h.push(new s(l,u)),d){case 0:l+=o,l>=r.right&&(d=1,u+=l-r.right,l=r.right);break;case 1:u+=o,u>=r.bottom&&(d=2,l-=u-r.bottom,u=r.bottom);break;case 2:l-=o,l<=r.left&&(d=3,u-=r.left-l,l=r.left);break;case 3:u-=o,u<=r.top&&(d=0,u=r.top);break}return h};t.exports=n}),u0=y((e,t)=>{var i=gl(),s=Vr(),n=Xr(),r=function(o,a,h){h===void 0&&(h=0);var l=i(a,!1,o.length);h>0?s(l,h):h<0&&n(l,Math.abs(h));for(var u=0;u<o.length;u++)o[u].x=l[u].x,o[u].y=l[u].y;return o};t.exports=r}),fl=y((e,t)=>{var i=function(s,n,r){n===void 0&&(n=1),r===void 0&&(r=[]);var o=Math.round(s.x1),a=Math.round(s.y1),h=Math.round(s.x2),l=Math.round(s.y2),u=Math.abs(h-o),d=Math.abs(l-a),p=o<h?1:-1,g=a<l?1:-1,c=u-d;r.push({x:o,y:a});for(var f=1;!(o===h&&a===l);){var m=c<<1;m>-d&&(c-=d,o+=p),m<u&&(c+=u,a+=g),f%n===0&&r.push({x:o,y:a}),f++}return r};t.exports=i}),c0=y((e,t)=>{var i=fl(),s=function(n,r,o){var a=i({x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2},o),h=i({x1:r.x2,y1:r.y2,x2:r.x3,y2:r.y3},o),l=i({x1:r.x3,y1:r.y3,x2:r.x1,y2:r.y1},o);a.pop(),h.pop(),l.pop(),a=a.concat(h,l);for(var u=a.length/n.length,d=0,p=0;p<n.length;p++){var g=n[p],c=a[Math.floor(d)];g.x=c.x,g.y=c.y,d+=u}return n};t.exports=s}),d0=y((e,t)=>{var i=function(s,n,r){for(var o=0;o<s.length;o++){var a=s[o];a.anims&&a.anims.play(n,r)}return s};t.exports=i}),Zt=y((e,t)=>{var i=function(s,n,r,o,a,h){o===void 0&&(o=0),a===void 0&&(a=0),h===void 0&&(h=1);var l,u=0,d=s.length;if(h===1)for(l=a;l<d;l++)s[l][n]=r+u*o,u++;else for(l=a;l>=0;l--)s[l][n]=r+u*o,u++;return s};t.exports=i}),p0=y((e,t)=>{var i=zr(),s=function(n,r){for(var o=0;o<n.length;o++)i(r,n[o]);return n};t.exports=s}),ml=y((e,t)=>{var i=Mt(),s=function(n,r){r===void 0&&(r=new i);var o=Math.random()*Math.PI*2,a=Math.sqrt(Math.random());return r.x=n.x+a*Math.cos(o)*n.width/2,r.y=n.y+a*Math.sin(o)*n.height/2,r};t.exports=s}),g0=y((e,t)=>{var i=ml(),s=function(n,r){for(var o=0;o<n.length;o++)i(r,n[o]);return n};t.exports=s}),f0=y((e,t)=>{var i=$r(),s=function(n,r){for(var o=0;o<n.length;o++)i(r,n[o]);return n};t.exports=s}),m0=y((e,t)=>{var i=ea(),s=function(n,r){for(var o=0;o<n.length;o++)i(r,n[o]);return n};t.exports=s}),vl=y((e,t)=>{var i=Mt(),s=function(n,r){r===void 0&&(r=new i);var o=n.x2-n.x1,a=n.y2-n.y1,h=n.x3-n.x1,l=n.y3-n.y1,u=Math.random(),d=Math.random();return u+d>=1&&(u=1-u,d=1-d),r.x=n.x1+(o*u+h*d),r.y=n.y1+(a*u+l*d),r};t.exports=s}),v0=y((e,t)=>{var i=vl(),s=function(n,r){for(var o=0;o<n.length;o++)i(r,n[o]);return n};t.exports=s}),E0=y((e,t)=>{var i=Me(),s=function(n,r,o,a,h){return i(n,"rotation",r,o,a,h)};t.exports=s}),aa=y((e,t)=>{var i=function(s,n,r,o,a){var h=o+Math.atan2(s.y-r,s.x-n);return s.x=n+a*Math.cos(h),s.y=r+a*Math.sin(h),s};t.exports=i}),Mn=y((e,t)=>{var i=function(s,n,r,o){var a=s-r,h=n-o;return Math.sqrt(a*a+h*h)};t.exports=i}),y0=y((e,t)=>{var i=aa(),s=Mn(),n=function(r,o,a){for(var h=o.x,l=o.y,u=0;u<r.length;u++){var d=r[u];i(d,h,l,a,Math.max(1,s(d.x,d.y,h,l)))}return r};t.exports=n}),T0=y((e,t)=>{var i=aa(),s=function(n,r,o,a){var h=r.x,l=r.y;if(a===0)return n;for(var u=0;u<n.length;u++)i(n[u],h,l,o,a);return n};t.exports=s}),x0=y((e,t)=>{var i=Me(),s=function(n,r,o,a,h){return i(n,"scaleX",r,o,a,h)};t.exports=s}),S0=y((e,t)=>{var i=Me(),s=function(n,r,o,a,h,l,u){return o==null&&(o=r),i(n,"scaleX",r,a,l,u),i(n,"scaleY",o,h,l,u)};t.exports=s}),A0=y((e,t)=>{var i=Me(),s=function(n,r,o,a,h){return i(n,"scaleY",r,o,a,h)};t.exports=s}),w0=y((e,t)=>{var i=Zt(),s=function(n,r,o,a,h){return i(n,"alpha",r,o,a,h)};t.exports=s}),C0=y((e,t)=>{var i=Zt(),s=function(n,r,o,a){return i(n,"blendMode",r,0,o,a)};t.exports=s}),P0=y((e,t)=>{var i=Zt(),s=function(n,r,o,a,h){return i(n,"depth",r,o,a,h)};t.exports=s}),R0=y((e,t)=>{var i=function(s,n,r){for(var o=0;o<s.length;o++)s[o].setInteractive(n,r);return s};t.exports=i}),b0=y((e,t)=>{var i=Zt(),s=function(n,r,o,a,h,l,u){return o==null&&(o=r),i(n,"originX",r,a,l,u),i(n,"originY",o,h,l,u),n.forEach(function(d){d.updateDisplayOrigin()}),n};t.exports=s}),I0=y((e,t)=>{var i=Zt(),s=function(n,r,o,a,h){return i(n,"rotation",r,o,a,h)};t.exports=s}),_0=y((e,t)=>{var i=Zt(),s=function(n,r,o,a,h,l,u){return o==null&&(o=r),i(n,"scaleX",r,a,l,u),i(n,"scaleY",o,h,l,u)};t.exports=s}),O0=y((e,t)=>{var i=Zt(),s=function(n,r,o,a,h){return i(n,"scaleX",r,o,a,h)};t.exports=s}),M0=y((e,t)=>{var i=Zt(),s=function(n,r,o,a,h){return i(n,"scaleY",r,o,a,h)};t.exports=s}),L0=y((e,t)=>{var i=Zt(),s=function(n,r,o,a,h,l,u){return o==null&&(o=r),i(n,"scrollFactorX",r,a,l,u),i(n,"scrollFactorY",o,h,l,u)};t.exports=s}),D0=y((e,t)=>{var i=Zt(),s=function(n,r,o,a,h){return i(n,"scrollFactorX",r,o,a,h)};t.exports=s}),k0=y((e,t)=>{var i=Zt(),s=function(n,r,o,a,h){return i(n,"scrollFactorY",r,o,a,h)};t.exports=s}),F0=y((e,t)=>{var i=function(s,n,r,o,a){for(var h=0;h<s.length;h++)s[h].setTint(n,r,o,a);return s};t.exports=i}),N0=y((e,t)=>{var i=Zt(),s=function(n,r,o,a){return i(n,"visible",r,0,o,a)};t.exports=s}),B0=y((e,t)=>{var i=Zt(),s=function(n,r,o,a,h){return i(n,"x",r,o,a,h)};t.exports=s}),U0=y((e,t)=>{var i=Zt(),s=function(n,r,o,a,h,l,u){return o==null&&(o=r),i(n,"x",r,a,l,u),i(n,"y",o,h,l,u)};t.exports=s}),G0=y((e,t)=>{var i=Zt(),s=function(n,r,o,a,h){return i(n,"y",r,o,a,h)};t.exports=s}),Y0=y((e,t)=>{var i=xt(),s=function(n,r,o,a,h){a===void 0&&(a=0),h===void 0&&(h=new i);var l,u,d=n.length;if(d===1)l=n[0].x,u=n[0].y,n[0].x=r,n[0].y=o;else{var p=1,g=0;a===0&&(g=d-1,p=d-2),l=n[g].x,u=n[g].y,n[g].x=r,n[g].y=o;for(var c=0;c<d;c++)if(!(p>=d||p===-1)){var f=n[p],m=f.x,v=f.y;f.x=l,f.y=u,l=m,u=v,a===0?p--:p++}}return h.x=l,h.y=u,h};t.exports=s}),H0=y((e,t)=>{var i=jr(),s=function(n){return i(n)};t.exports=s}),oa=y((e,t)=>{var i=function(s,n,r){return s=Math.max(0,Math.min(1,(s-n)/(r-n))),s*s*s*(s*(s*6-15)+10)};t.exports=i}),z0=y((e,t)=>{var i=oa(),s=function(n,r,o,a,h){h===void 0&&(h=!1);var l=Math.abs(a-o)/n.length,u;if(h)for(u=0;u<n.length;u++)n[u][r]+=i(u*l,o,a);else for(u=0;u<n.length;u++)n[u][r]=i(u*l,o,a);return n};t.exports=s}),ha=y((e,t)=>{var i=function(s,n,r){return s<=n?0:s>=r?1:(s=(s-n)/(r-n),s*s*(3-2*s))};t.exports=i}),W0=y((e,t)=>{var i=ha(),s=function(n,r,o,a,h){h===void 0&&(h=!1);var l=Math.abs(a-o)/n.length,u;if(h)for(u=0;u<n.length;u++)n[u][r]+=i(u*l,o,a);else for(u=0;u<n.length;u++)n[u][r]=i(u*l,o,a);return n};t.exports=s}),V0=y((e,t)=>{var i=function(s,n,r,o,a){if(a===void 0&&(a=!1),s.length===0)return s;if(s.length===1)return a?s[0][n]+=(o+r)/2:s[0][n]=(o+r)/2,s;var h=Math.abs(o-r)/(s.length-1),l;if(a)for(l=0;l<s.length;l++)s[l][n]+=l*h+r;else for(l=0;l<s.length;l++)s[l][n]=l*h+r;return s};t.exports=i}),X0=y((e,t)=>{var i=function(s){for(var n=0;n<s.length;n++)s[n].visible=!s[n].visible;return s};t.exports=i}),K0=y((e,t)=>{var i=Ai(),s=function(n,r,o){o===void 0&&(o=0);for(var a=0;a<n.length;a++){var h=n[a];h.x=i(h.x,r.left-o,r.right+o),h.y=i(h.y,r.top-o,r.bottom+o)}return n};t.exports=s}),El=y((e,t)=>{t.exports={AlignTo:pg(),Angle:gg(),Call:fg(),GetFirst:mg(),GetLast:vg(),GridAlign:wm(),IncAlpha:Cm(),IncX:Pm(),IncXY:Rm(),IncY:bm(),PlaceOnCircle:Im(),PlaceOnEllipse:_m(),PlaceOnLine:l0(),PlaceOnRectangle:u0(),PlaceOnTriangle:c0(),PlayAnimation:d0(),PropertyValueInc:Me(),PropertyValueSet:Zt(),RandomCircle:p0(),RandomEllipse:g0(),RandomLine:f0(),RandomRectangle:m0(),RandomTriangle:v0(),Rotate:E0(),RotateAround:y0(),RotateAroundDistance:T0(),ScaleX:x0(),ScaleXY:S0(),ScaleY:A0(),SetAlpha:w0(),SetBlendMode:C0(),SetDepth:P0(),SetHitArea:R0(),SetOrigin:b0(),SetRotation:I0(),SetScale:_0(),SetScaleX:O0(),SetScaleY:M0(),SetScrollFactor:L0(),SetScrollFactorX:D0(),SetScrollFactorY:k0(),SetTint:F0(),SetVisible:N0(),SetX:B0(),SetXY:U0(),SetY:G0(),ShiftPosition:Y0(),Shuffle:H0(),SmootherStep:z0(),SmoothStep:W0(),Spread:V0(),ToggleVisible:X0(),WrapInRectangle:K0()}}),j0=y((e,t)=>{t.exports="add"}),Z0=y((e,t)=>{t.exports="remove"}),yl=y((e,t)=>{t.exports={ADD:j0(),REMOVE:Z0()}}),Tl=y((e,t)=>{var i=W(),s=Es(),n=Ct(),r=yl(),o=new i({initialize:function(){this.entries=new s,this.events=new n},add:function(a,h){return this.entries.set(a,h),this.events.emit(r.ADD,this,a,h),this},has:function(a){return this.entries.has(a)},exists:function(a){return this.entries.has(a)},get:function(a){return this.entries.get(a)},remove:function(a){var h=this.get(a);return h&&(this.entries.delete(a),this.events.emit(r.REMOVE,this,a,h.data)),this},getKeys:function(){return this.entries.keys()},destroy:function(){this.entries.clear(),this.events.removeAllListeners(),this.entries=null,this.events=null}});t.exports=o}),xl=y((e,t)=>{var i=Tl(),s=W(),n=$t(),r=new s({initialize:function(o){this.game=o,this.binary=new i,this.bitmapFont=new i,this.json=new i,this.physics=new i,this.shader=new i,this.audio=new i,this.video=new i,this.text=new i,this.html=new i,this.obj=new i,this.tilemap=new i,this.xml=new i,this.custom={},this.game.events.once(n.DESTROY,this.destroy,this)},addCustom:function(o){return this.custom.hasOwnProperty(o)||(this.custom[o]=new i),this.custom[o]},destroy:function(){for(var o=["binary","bitmapFont","json","physics","shader","audio","video","text","html","obj","tilemap","xml"],a=0;a<o.length;a++)this[o[a]].destroy(),this[o[a]]=null;for(var h in this.custom)this.custom[h].destroy();this.custom=null,this.game=null}});t.exports=r}),q0=y((e,t)=>{t.exports={BaseCache:Tl(),CacheManager:xl(),Events:yl()}}),J0=y((e,t)=>{t.exports="cameradestroy"}),Q0=y((e,t)=>{t.exports="camerafadeincomplete"}),$0=y((e,t)=>{t.exports="camerafadeinstart"}),tv=y((e,t)=>{t.exports="camerafadeoutcomplete"}),ev=y((e,t)=>{t.exports="camerafadeoutstart"}),iv=y((e,t)=>{t.exports="cameraflashcomplete"}),sv=y((e,t)=>{t.exports="cameraflashstart"}),nv=y((e,t)=>{t.exports="followupdate"}),rv=y((e,t)=>{t.exports="camerapancomplete"}),av=y((e,t)=>{t.exports="camerapanstart"}),ov=y((e,t)=>{t.exports="postrender"}),hv=y((e,t)=>{t.exports="prerender"}),lv=y((e,t)=>{t.exports="camerarotatecomplete"}),uv=y((e,t)=>{t.exports="camerarotatestart"}),cv=y((e,t)=>{t.exports="camerashakecomplete"}),dv=y((e,t)=>{t.exports="camerashakestart"}),pv=y((e,t)=>{t.exports="camerazoomcomplete"}),gv=y((e,t)=>{t.exports="camerazoomstart"}),Ie=y((e,t)=>{t.exports={DESTROY:J0(),FADE_IN_COMPLETE:Q0(),FADE_IN_START:$0(),FADE_OUT_COMPLETE:tv(),FADE_OUT_START:ev(),FLASH_COMPLETE:iv(),FLASH_START:sv(),FOLLOW_UPDATE:nv(),PAN_COMPLETE:rv(),PAN_START:av(),POST_RENDER:ov(),PRE_RENDER:hv(),ROTATE_COMPLETE:lv(),ROTATE_START:uv(),SHAKE_COMPLETE:cv(),SHAKE_START:dv(),ZOOM_COMPLETE:pv(),ZOOM_START:gv()}}),la=y((e,t)=>{var i=function(s,n,r){return s<<16|n<<8|r};t.exports=i}),fv=y((e,t)=>{var i=function(s,n,r,o){return o<<24|s<<16|n<<8|r};t.exports=i}),mv=y((e,t)=>{var i=la();function s(r,o,a,h){var l=(r+o*6)%6,u=Math.min(l,4-l,1);return Math.round(255*(h-h*a*Math.max(0,u)))}var n=function(r,o,a,h){o===void 0&&(o=1),a===void 0&&(a=1);var l=s(5,r,o,a),u=s(3,r,o,a),d=s(1,r,o,a);return h?h.setTo?h.setTo(l,u,d,h.alpha,!0):(h.r=l,h.g=u,h.b=d,h.color=i(l,u,d),h):{r:l,g:u,b:d,color:i(l,u,d)}};t.exports=n}),vv=y((e,t)=>{var i=function(s,n,r,o){o===void 0&&(o={h:0,s:0,v:0}),s/=255,n/=255,r/=255;var a=Math.min(s,n,r),h=Math.max(s,n,r),l=h-a,u=0,d=h===0?0:l/h,p=h;return h!==a&&(h===s?u=(n-r)/l+(n<r?6:0):h===n?u=(r-s)/l+2:h===r&&(u=(s-n)/l+4),u/=6),o.hasOwnProperty("_h")?(o._h=u,o._s=d,o._v=p):(o.h=u,o.s=d,o.v=p),o};t.exports=i}),di=y((e,t)=>{var i=W(),s=la(),n=fv(),r=mv(),o=vv(),a=new i({initialize:function(h,l,u,d){h===void 0&&(h=0),l===void 0&&(l=0),u===void 0&&(u=0),d===void 0&&(d=255),this.r=0,this.g=0,this.b=0,this.a=255,this._h=0,this._s=0,this._v=0,this._locked=!1,this.gl=[0,0,0,1],this._color=0,this._color32=0,this._rgba="",this.setTo(h,l,u,d)},transparent:function(){return this._locked=!0,this.red=0,this.green=0,this.blue=0,this.alpha=0,this._locked=!1,this.update(!0)},setTo:function(h,l,u,d,p){return d===void 0&&(d=255),p===void 0&&(p=!0),this._locked=!0,this.red=h,this.green=l,this.blue=u,this.alpha=d,this._locked=!1,this.update(p)},setGLTo:function(h,l,u,d){return d===void 0&&(d=1),this._locked=!0,this.redGL=h,this.greenGL=l,this.blueGL=u,this.alphaGL=d,this._locked=!1,this.update(!0)},setFromRGB:function(h){return this._locked=!0,this.red=h.r,this.green=h.g,this.blue=h.b,h.hasOwnProperty("a")&&(this.alpha=h.a),this._locked=!1,this.update(!0)},setFromHSV:function(h,l,u){return r(h,l,u,this)},update:function(h){if(h===void 0&&(h=!1),this._locked)return this;var l=this.r,u=this.g,d=this.b,p=this.a;return this._color=s(l,u,d),this._color32=n(l,u,d,p),this._rgba="rgba("+l+","+u+","+d+","+p/255+")",h&&o(l,u,d,this),this},updateHSV:function(){var h=this.r,l=this.g,u=this.b;return o(h,l,u,this),this},clone:function(){return new a(this.r,this.g,this.b,this.a)},gray:function(h){return this.setTo(h,h,h)},random:function(h,l){h===void 0&&(h=0),l===void 0&&(l=255);var u=Math.floor(h+Math.random()*(l-h)),d=Math.floor(h+Math.random()*(l-h)),p=Math.floor(h+Math.random()*(l-h));return this.setTo(u,d,p)},randomGray:function(h,l){h===void 0&&(h=0),l===void 0&&(l=255);var u=Math.floor(h+Math.random()*(l-h));return this.setTo(u,u,u)},saturate:function(h){return this.s+=h/100,this},desaturate:function(h){return this.s-=h/100,this},lighten:function(h){return this.v+=h/100,this},darken:function(h){return this.v-=h/100,this},brighten:function(h){var l=this.r,u=this.g,d=this.b;return l=Math.max(0,Math.min(255,l-Math.round(255*-(h/100)))),u=Math.max(0,Math.min(255,u-Math.round(255*-(h/100)))),d=Math.max(0,Math.min(255,d-Math.round(255*-(h/100)))),this.setTo(l,u,d)},color:{get:function(){return this._color}},color32:{get:function(){return this._color32}},rgba:{get:function(){return this._rgba}},redGL:{get:function(){return this.gl[0]},set:function(h){this.gl[0]=Math.min(Math.abs(h),1),this.r=Math.floor(this.gl[0]*255),this.update(!0)}},greenGL:{get:function(){return this.gl[1]},set:function(h){this.gl[1]=Math.min(Math.abs(h),1),this.g=Math.floor(this.gl[1]*255),this.update(!0)}},blueGL:{get:function(){return this.gl[2]},set:function(h){this.gl[2]=Math.min(Math.abs(h),1),this.b=Math.floor(this.gl[2]*255),this.update(!0)}},alphaGL:{get:function(){return this.gl[3]},set:function(h){this.gl[3]=Math.min(Math.abs(h),1),this.a=Math.floor(this.gl[3]*255),this.update()}},red:{get:function(){return this.r},set:function(h){h=Math.floor(Math.abs(h)),this.r=Math.min(h,255),this.gl[0]=h/255,this.update(!0)}},green:{get:function(){return this.g},set:function(h){h=Math.floor(Math.abs(h)),this.g=Math.min(h,255),this.gl[1]=h/255,this.update(!0)}},blue:{get:function(){return this.b},set:function(h){h=Math.floor(Math.abs(h)),this.b=Math.min(h,255),this.gl[2]=h/255,this.update(!0)}},alpha:{get:function(){return this.a},set:function(h){h=Math.floor(Math.abs(h)),this.a=Math.min(h,255),this.gl[3]=h/255,this.update()}},h:{get:function(){return this._h},set:function(h){this._h=h,r(h,this._s,this._v,this)}},s:{get:function(){return this._s},set:function(h){this._s=h,r(this._h,h,this._v,this)}},v:{get:function(){return this._v},set:function(h){this._v=h,r(this._h,this._s,h,this)}}});t.exports=a}),Ev=y((e,t)=>{var i=di(),s=function(n){var r=new i;n=n.replace(/^(?:#|0x)?([a-f\d])([a-f\d])([a-f\d])$/i,function(u,d,p,g){return d+d+p+p+g+g});var o=/^(?:#|0x)?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);if(o){var a=parseInt(o[1],16),h=parseInt(o[2],16),l=parseInt(o[3],16);r.setTo(a,h,l)}return r};t.exports=s}),Sl=y((e,t)=>{var i=function(s){return s>16777215?{a:s>>>24,r:s>>16&255,g:s>>8&255,b:s&255}:{a:255,r:s>>16&255,g:s>>8&255,b:s&255}};t.exports=i}),yv=y((e,t)=>{var i=di(),s=Sl(),n=function(r){var o=s(r);return new i(o.r,o.g,o.b,o.a)};t.exports=n}),Tv=y((e,t)=>{var i=di(),s=function(n){return new i(n.r,n.g,n.b,n.a)};t.exports=s}),xv=y((e,t)=>{var i=di(),s=function(n){var r=new i,o=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(n.toLowerCase());if(o){var a=parseInt(o[1],10),h=parseInt(o[2],10),l=parseInt(o[3],10),u=o[4]!==void 0?parseFloat(o[4]):1;r.setTo(a,h,l,u*255)}return r};t.exports=s}),Al=y((e,t)=>{var i=Ev(),s=yv(),n=Tv(),r=xv(),o=function(a){var h=typeof a;switch(h){case"string":return a.substr(0,3).toLowerCase()==="rgb"?r(a):i(a);case"number":return s(a);case"object":return n(a)}};t.exports=o}),ua=y((e,t)=>{var i=W(),s=be(),n=Gi(),r=Ct(),o=Ie(),a=Ut(),h=Re(),l=Al(),u=xt(),d=new i({Extends:r,Mixins:[s.AlphaSingle,s.Visible],initialize:function(p,g,c,f){p===void 0&&(p=0),g===void 0&&(g=0),c===void 0&&(c=0),f===void 0&&(f=0),r.call(this),this.scene,this.sceneManager,this.scaleManager,this.cameraManager,this.id=0,this.name="",this.roundPixels=!1,this.useBounds=!1,this.worldView=new a,this.dirty=!0,this._x=p,this._y=g,this._width=c,this._height=f,this._bounds=new a,this._scrollX=0,this._scrollY=0,this._zoomX=1,this._zoomY=1,this._rotation=0,this.matrix=new h,this.transparent=!0,this.backgroundColor=l("rgba(0,0,0,0)"),this.disableCull=!1,this.culledObjects=[],this.midPoint=new u(c/2,f/2),this.originX=.5,this.originY=.5,this._customViewport=!1,this.mask=null,this._maskCamera=null,this.renderList=[],this.isSceneCamera=!0,this.renderRoundPixels=!0},addToRenderList:function(p){this.renderList.push(p)},setOrigin:function(p,g){return p===void 0&&(p=.5),g===void 0&&(g=p),this.originX=p,this.originY=g,this},getScroll:function(p,g,c){c===void 0&&(c=new u);var f=this.width*.5,m=this.height*.5;return c.x=p-f,c.y=g-m,this.useBounds&&(c.x=this.clampX(c.x),c.y=this.clampY(c.y)),c},centerOnX:function(p){var g=this.width*.5;return this.midPoint.x=p,this.scrollX=p-g,this.useBounds&&(this.scrollX=this.clampX(this.scrollX)),this},centerOnY:function(p){var g=this.height*.5;return this.midPoint.y=p,this.scrollY=p-g,this.useBounds&&(this.scrollY=this.clampY(this.scrollY)),this},centerOn:function(p,g){return this.centerOnX(p),this.centerOnY(g),this},centerToBounds:function(){if(this.useBounds){var p=this._bounds,g=this.width*.5,c=this.height*.5;this.midPoint.set(p.centerX,p.centerY),this.scrollX=p.centerX-g,this.scrollY=p.centerY-c}return this},centerToSize:function(){return this.scrollX=this.width*.5,this.scrollY=this.height*.5,this},cull:function(p){if(this.disableCull)return p;var g=this.matrix.matrix,c=g[0],f=g[1],m=g[2],v=g[3],E=c*v-f*m;if(!E)return p;var x=g[4],T=g[5],A=this.scrollX,P=this.scrollY,R=this.width,S=this.height,I=this.y,w=I+S,C=this.x,_=C+R,O=this.culledObjects,D=p.length;E=1/E,O.length=0;for(var F=0;F<D;++F){var N=p[F];if(!N.hasOwnProperty("width")||N.parentContainer){O.push(N);continue}var Y=N.width,L=N.height,b=N.x-A*N.scrollFactorX-Y*N.originX,M=N.y-P*N.scrollFactorY-L*N.originY,k=b*c+M*m+x,B=b*f+M*v+T,H=(b+Y)*c+(M+L)*m+x,z=(b+Y)*f+(M+L)*v+T;H>C&&k<_&&z>I&&B<w&&O.push(N)}return O},getWorldPoint:function(p,g,c){c===void 0&&(c=new u);var f=this.matrix.matrix,m=f[0],v=f[1],E=f[2],x=f[3],T=f[4],A=f[5],P=m*x-v*E;if(!P)return c.x=p,c.y=g,c;P=1/P;var R=x*P,S=-v*P,I=-E*P,w=m*P,C=(E*A-x*T)*P,_=(v*T-m*A)*P,O=Math.cos(this.rotation),D=Math.sin(this.rotation),F=this.zoomX,N=this.zoomY,Y=this.scrollX,L=this.scrollY,b=p+(Y*O-L*D)*F,M=g+(Y*D+L*O)*N;return c.x=b*R+M*I+C,c.y=b*S+M*w+_,c},ignore:function(p){var g=this.id;Array.isArray(p)||(p=[p]);for(var c=0;c<p.length;c++){var f=p[c];Array.isArray(f)?this.ignore(f):f.isParent?this.ignore(f.getChildren()):f.cameraFilter|=g}return this},clampX:function(p){var g=this._bounds,c=this.displayWidth,f=g.x+(c-this.width)/2,m=Math.max(f,f+g.width-c);return p<f?p=f:p>m&&(p=m),p},clampY:function(p){var g=this._bounds,c=this.displayHeight,f=g.y+(c-this.height)/2,m=Math.max(f,f+g.height-c);return p<f?p=f:p>m&&(p=m),p},removeBounds:function(){return this.useBounds=!1,this.dirty=!0,this._bounds.setEmpty(),this},setAngle:function(p){return p===void 0&&(p=0),this.rotation=n(p),this},setBackgroundColor:function(p){return p===void 0&&(p="rgba(0,0,0,0)"),this.backgroundColor=l(p),this.transparent=this.backgroundColor.alpha===0,this},setBounds:function(p,g,c,f,m){return m===void 0&&(m=!1),this._bounds.setTo(p,g,c,f),this.dirty=!0,this.useBounds=!0,m?this.centerToBounds():(this.scrollX=this.clampX(this.scrollX),this.scrollY=this.clampY(this.scrollY)),this},getBounds:function(p){p===void 0&&(p=new a);var g=this._bounds;return p.setTo(g.x,g.y,g.width,g.height),p},setName:function(p){return p===void 0&&(p=""),this.name=p,this},setPosition:function(p,g){return g===void 0&&(g=p),this.x=p,this.y=g,this},setRotation:function(p){return p===void 0&&(p=0),this.rotation=p,this},setRoundPixels:function(p){return this.roundPixels=p,this},setScene:function(p,g){g===void 0&&(g=!0),this.scene&&this._customViewport&&this.sceneManager.customViewports--,this.scene=p,this.isSceneCamera=g;var c=p.sys;return this.sceneManager=c.game.scene,this.scaleManager=c.scale,this.cameraManager=c.cameras,this.updateSystem(),this},setScroll:function(p,g){return g===void 0&&(g=p),this.scrollX=p,this.scrollY=g,this},setSize:function(p,g){return g===void 0&&(g=p),this.width=p,this.height=g,this},setViewport:function(p,g,c,f){return this.x=p,this.y=g,this.width=c,this.height=f,this},setZoom:function(p,g){return p===void 0&&(p=1),g===void 0&&(g=p),p===0&&(p=.001),g===0&&(g=.001),this.zoomX=p,this.zoomY=g,this},setMask:function(p,g){return g===void 0&&(g=!0),this.mask=p,this._maskCamera=g?this.cameraManager.default:this,this},clearMask:function(p){return p===void 0&&(p=!1),p&&this.mask&&this.mask.destroy(),this.mask=null,this},toJSON:function(){var p={name:this.name,x:this.x,y:this.y,width:this.width,height:this.height,zoom:this.zoom,rotation:this.rotation,roundPixels:this.roundPixels,scrollX:this.scrollX,scrollY:this.scrollY,backgroundColor:this.backgroundColor.rgba};return this.useBounds&&(p.bounds={x:this._bounds.x,y:this._bounds.y,width:this._bounds.width,height:this._bounds.height}),p},update:function(){},setIsSceneCamera:function(p){return this.isSceneCamera=p,this},updateSystem:function(){if(!(!this.scaleManager||!this.isSceneCamera)){var p=this._x!==0||this._y!==0||this.scaleManager.width!==this._width||this.scaleManager.height!==this._height,g=this.sceneManager;p&&!this._customViewport?g.customViewports++:!p&&this._customViewport&&g.customViewports--,this.dirty=!0,this._customViewport=p}},destroy:function(){this.emit(o.DESTROY,this),this.removeAllListeners(),this.matrix.destroy(),this.culledObjects=[],this._customViewport&&this.sceneManager.customViewports--,this.renderList=[],this._bounds=null,this.scene=null,this.scaleManager=null,this.sceneManager=null,this.cameraManager=null},x:{get:function(){return this._x},set:function(p){this._x=p,this.updateSystem()}},y:{get:function(){return this._y},set:function(p){this._y=p,this.updateSystem()}},width:{get:function(){return this._width},set:function(p){this._width=p,this.updateSystem()}},height:{get:function(){return this._height},set:function(p){this._height=p,this.updateSystem()}},scrollX:{get:function(){return this._scrollX},set:function(p){p!==this._scrollX&&(this._scrollX=p,this.dirty=!0)}},scrollY:{get:function(){return this._scrollY},set:function(p){p!==this._scrollY&&(this._scrollY=p,this.dirty=!0)}},zoom:{get:function(){return(this._zoomX+this._zoomY)/2},set:function(p){this._zoomX=p,this._zoomY=p,this.dirty=!0}},zoomX:{get:function(){return this._zoomX},set:function(p){this._zoomX=p,this.dirty=!0}},zoomY:{get:function(){return this._zoomY},set:function(p){this._zoomY=p,this.dirty=!0}},rotation:{get:function(){return this._rotation},set:function(p){this._rotation=p,this.dirty=!0}},centerX:{get:function(){return this.x+.5*this.width}},centerY:{get:function(){return this.y+.5*this.height}},displayWidth:{get:function(){return this.width/this.zoomX}},displayHeight:{get:function(){return this.height/this.zoomY}}});t.exports=d}),Ln=y((e,t)=>{var i=function(s,n,r){return s.x=n-s.width/2,s.y=r-s.height/2,s};t.exports=i}),Sv=y((e,t)=>{var i=Ot(),s=W(),n=Ie(),r=new s({initialize:function(o){this.camera=o,this.isRunning=!1,this.isComplete=!1,this.direction=!0,this.duration=0,this.red=0,this.green=0,this.blue=0,this.alpha=0,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(o,a,h,l,u,d,p,g){if(o===void 0&&(o=!0),a===void 0&&(a=1e3),h===void 0&&(h=0),l===void 0&&(l=0),u===void 0&&(u=0),d===void 0&&(d=!1),p===void 0&&(p=null),g===void 0&&(g=this.camera.scene),!d&&this.isRunning)return this.camera;this.isRunning=!0,this.isComplete=!1,this.duration=a,this.direction=o,this.progress=0,this.red=h,this.green=l,this.blue=u,this.alpha=o?Number.MIN_VALUE:1,this._elapsed=0,this._onUpdate=p,this._onUpdateScope=g;var c=o?n.FADE_OUT_START:n.FADE_IN_START;return this.camera.emit(c,this.camera,this,a,h,l,u),this.camera},update:function(o,a){this.isRunning&&(this._elapsed+=a,this.progress=i(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration?this.alpha=this.direction?this.progress:1-this.progress:(this.alpha=this.direction?1:0,this.effectComplete()))},postRenderCanvas:function(o){if(!this.isRunning&&!this.isComplete)return!1;var a=this.camera;return o.fillStyle="rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")",o.fillRect(a.x,a.y,a.width,a.height),!0},postRenderWebGL:function(o,a){if(!this.isRunning&&!this.isComplete)return!1;var h=this.camera,l=this.red/255,u=this.green/255,d=this.blue/255;return o.drawFillRect(h.x,h.y,h.width,h.height,a(d,u,l,1),this.alpha),!0},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.isComplete=!0;var o=this.direction?n.FADE_OUT_COMPLETE:n.FADE_IN_COMPLETE;this.camera.emit(o,this.camera,this)},reset:function(){this.isRunning=!1,this.isComplete=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});t.exports=r}),Av=y((e,t)=>{var i=Ot(),s=W(),n=Ie(),r=new s({initialize:function(o){this.camera=o,this.isRunning=!1,this.duration=0,this.red=0,this.green=0,this.blue=0,this.alpha=1,this.progress=0,this._elapsed=0,this._alpha,this._onUpdate,this._onUpdateScope},start:function(o,a,h,l,u,d,p){return o===void 0&&(o=250),a===void 0&&(a=255),h===void 0&&(h=255),l===void 0&&(l=255),u===void 0&&(u=!1),d===void 0&&(d=null),p===void 0&&(p=this.camera.scene),!u&&this.isRunning?this.camera:(this.isRunning=!0,this.duration=o,this.progress=0,this.red=a,this.green=h,this.blue=l,this._alpha=this.alpha,this._elapsed=0,this._onUpdate=d,this._onUpdateScope=p,this.camera.emit(n.FLASH_START,this.camera,this,o,a,h,l),this.camera)},update:function(o,a){this.isRunning&&(this._elapsed+=a,this.progress=i(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration?this.alpha=this._alpha*(1-this.progress):this.effectComplete())},postRenderCanvas:function(o){if(!this.isRunning)return!1;var a=this.camera;return o.fillStyle="rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")",o.fillRect(a.x,a.y,a.width,a.height),!0},postRenderWebGL:function(o,a){if(!this.isRunning)return!1;var h=this.camera,l=this.red/255,u=this.green/255,d=this.blue/255;return o.drawFillRect(h.x,h.y,h.width,h.height,a(d,u,l,1),this.alpha),!0},effectComplete:function(){this.alpha=this._alpha,this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(n.FLASH_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});t.exports=r}),wv=y((e,t)=>{var i=Ot(),s=W(),n=On(),r=Ie(),o=xt(),a=new s({initialize:function(h){this.camera=h,this.isRunning=!1,this.duration=0,this.source=new o,this.current=new o,this.destination=new o,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(h,l,u,d,p,g,c){u===void 0&&(u=1e3),d===void 0&&(d=n.Linear),p===void 0&&(p=!1),g===void 0&&(g=null),c===void 0&&(c=this.camera.scene);var f=this.camera;return!p&&this.isRunning||(this.isRunning=!0,this.duration=u,this.progress=0,this.source.set(f.scrollX,f.scrollY),this.destination.set(h,l),f.getScroll(h,l,this.current),typeof d=="string"&&n.hasOwnProperty(d)?this.ease=n[d]:typeof d=="function"&&(this.ease=d),this._elapsed=0,this._onUpdate=g,this._onUpdateScope=c,this.camera.emit(r.PAN_START,this.camera,this,u,h,l)),f},update:function(h,l){if(this.isRunning){this._elapsed+=l;var u=i(this._elapsed/this.duration,0,1);this.progress=u;var d=this.camera;if(this._elapsed<this.duration){var p=this.ease(u);d.getScroll(this.destination.x,this.destination.y,this.current);var g=this.source.x+(this.current.x-this.source.x)*p,c=this.source.y+(this.current.y-this.source.y)*p;d.setScroll(g,c),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,d,u,g,c)}else d.centerOn(this.destination.x,this.destination.y),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,d,u,d.scrollX,d.scrollY),this.effectComplete()}},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(r.PAN_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.source=null,this.destination=null}});t.exports=a}),Cv=y((e,t)=>{var i=Ot(),s=W(),n=Ie(),r=xt(),o=new s({initialize:function(a){this.camera=a,this.isRunning=!1,this.duration=0,this.intensity=new r,this.progress=0,this._elapsed=0,this._offsetX=0,this._offsetY=0,this._onUpdate,this._onUpdateScope},start:function(a,h,l,u,d){return a===void 0&&(a=100),h===void 0&&(h=.05),l===void 0&&(l=!1),u===void 0&&(u=null),d===void 0&&(d=this.camera.scene),!l&&this.isRunning?this.camera:(this.isRunning=!0,this.duration=a,this.progress=0,typeof h=="number"?this.intensity.set(h):this.intensity.set(h.x,h.y),this._elapsed=0,this._offsetX=0,this._offsetY=0,this._onUpdate=u,this._onUpdateScope=d,this.camera.emit(n.SHAKE_START,this.camera,this,a,h),this.camera)},preRender:function(){this.isRunning&&this.camera.matrix.translate(this._offsetX,this._offsetY)},update:function(a,h){if(this.isRunning)if(this._elapsed+=h,this.progress=i(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration){var l=this.intensity,u=this.camera.width,d=this.camera.height,p=this.camera.zoom;this._offsetX=(Math.random()*l.x*u*2-l.x*u)*p,this._offsetY=(Math.random()*l.y*d*2-l.y*d)*p,this.camera.roundPixels&&(this._offsetX=Math.round(this._offsetX),this._offsetY=Math.round(this._offsetY))}else this.effectComplete()},effectComplete:function(){this._offsetX=0,this._offsetY=0,this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(n.SHAKE_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._offsetX=0,this._offsetY=0,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.intensity=null}});t.exports=o}),Pv=y((e,t)=>{var i=Ot(),s=W(),n=Ie(),r=On(),o=new s({initialize:function(a){this.camera=a,this.isRunning=!1,this.duration=0,this.source=0,this.current=0,this.destination=0,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope,this.clockwise=!0,this.shortestPath=!1},start:function(a,h,l,u,d,p,g){l===void 0&&(l=1e3),u===void 0&&(u=r.Linear),d===void 0&&(d=!1),p===void 0&&(p=null),g===void 0&&(g=this.camera.scene),h===void 0&&(h=!1),this.shortestPath=h;var c=a;a<0?(c=-1*a,this.clockwise=!1):this.clockwise=!0;var f=360*Math.PI/180;c=c-Math.floor(c/f)*f;var m=this.camera;if(!d&&this.isRunning)return m;if(this.isRunning=!0,this.duration=l,this.progress=0,this.source=m.rotation,this.destination=c,typeof u=="string"&&r.hasOwnProperty(u)?this.ease=r[u]:typeof u=="function"&&(this.ease=u),this._elapsed=0,this._onUpdate=p,this._onUpdateScope=g,this.shortestPath){var v=0,E=0;this.destination>this.source?v=Math.abs(this.destination-this.source):v=Math.abs(this.destination+f)-this.source,this.source>this.destination?E=Math.abs(this.source-this.destination):E=Math.abs(this.source+f)-this.destination,v<E?this.clockwise=!0:v>E&&(this.clockwise=!1)}return this.camera.emit(n.ROTATE_START,this.camera,this,l,c),m},update:function(a,h){if(this.isRunning){this._elapsed+=h;var l=i(this._elapsed/this.duration,0,1);this.progress=l;var u=this.camera;if(this._elapsed<this.duration){var d=this.ease(l);this.current=u.rotation;var p=0,g=360*Math.PI/180,c=this.destination,f=this.current;this.clockwise===!1&&(c=this.current,f=this.destination),c>=f?p=Math.abs(c-f):p=Math.abs(c+g)-f;var m=0;this.clockwise?m=u.rotation+p*d:m=u.rotation-p*d,u.rotation=m,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,u,l,m)}else u.rotation=this.destination,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,u,l,this.destination),this.effectComplete()}},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(n.ROTATE_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.source=null,this.destination=null}});t.exports=o}),Rv=y((e,t)=>{var i=Ot(),s=W(),n=On(),r=Ie(),o=new s({initialize:function(a){this.camera=a,this.isRunning=!1,this.duration=0,this.source=1,this.destination=1,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(a,h,l,u,d,p){h===void 0&&(h=1e3),l===void 0&&(l=n.Linear),u===void 0&&(u=!1),d===void 0&&(d=null),p===void 0&&(p=this.camera.scene);var g=this.camera;return!u&&this.isRunning||(this.isRunning=!0,this.duration=h,this.progress=0,this.source=g.zoom,this.destination=a,typeof l=="string"&&n.hasOwnProperty(l)?this.ease=n[l]:typeof l=="function"&&(this.ease=l),this._elapsed=0,this._onUpdate=d,this._onUpdateScope=p,this.camera.emit(r.ZOOM_START,this.camera,this,h,a)),g},update:function(a,h){this.isRunning&&(this._elapsed+=h,this.progress=i(this._elapsed/this.duration,0,1),this._elapsed<this.duration?(this.camera.zoom=this.source+(this.destination-this.source)*this.ease(this.progress),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress,this.camera.zoom)):(this.camera.zoom=this.destination,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress,this.destination),this.effectComplete()))},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(r.ZOOM_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});t.exports=o}),wl=y((e,t)=>{t.exports={Fade:Sv(),Flash:Av(),Pan:wv(),Shake:Cv(),RotateTo:Pv(),Zoom:Rv()}}),ca=y((e,t)=>{var i=function(s,n,r){return(n-s)*r+s};t.exports=i}),Dn=y((e,t)=>{var i=ua(),s=Ln(),n=Ot(),r=W(),o=be(),a=wl(),h=Ie(),l=ca(),u=Ut(),d=xt(),p=new r({Extends:i,Mixins:[o.PostPipeline],initialize:function(g,c,f,m){i.call(this,g,c,f,m),this.initPostPipeline(),this.inputEnabled=!0,this.fadeEffect=new a.Fade(this),this.flashEffect=new a.Flash(this),this.shakeEffect=new a.Shake(this),this.panEffect=new a.Pan(this),this.rotateToEffect=new a.RotateTo(this),this.zoomEffect=new a.Zoom(this),this.lerp=new d(1,1),this.followOffset=new d,this.deadzone=null,this._follow=null},setDeadzone:function(g,c){if(g===void 0)this.deadzone=null;else{if(this.deadzone?(this.deadzone.width=g,this.deadzone.height=c):this.deadzone=new u(0,0,g,c),this._follow){var f=this.width/2,m=this.height/2,v=this._follow.x-this.followOffset.x,E=this._follow.y-this.followOffset.y;this.midPoint.set(v,E),this.scrollX=v-f,this.scrollY=E-m}s(this.deadzone,this.midPoint.x,this.midPoint.y)}return this},fadeIn:function(g,c,f,m,v,E){return this.fadeEffect.start(!1,g,c,f,m,!0,v,E)},fadeOut:function(g,c,f,m,v,E){return this.fadeEffect.start(!0,g,c,f,m,!0,v,E)},fadeFrom:function(g,c,f,m,v,E,x){return this.fadeEffect.start(!1,g,c,f,m,v,E,x)},fade:function(g,c,f,m,v,E,x){return this.fadeEffect.start(!0,g,c,f,m,v,E,x)},flash:function(g,c,f,m,v,E,x){return this.flashEffect.start(g,c,f,m,v,E,x)},shake:function(g,c,f,m,v){return this.shakeEffect.start(g,c,f,m,v)},pan:function(g,c,f,m,v,E,x){return this.panEffect.start(g,c,f,m,v,E,x)},rotateTo:function(g,c,f,m,v,E,x){return this.rotateToEffect.start(g,c,f,m,v,E,x)},zoomTo:function(g,c,f,m,v,E){return this.zoomEffect.start(g,c,f,m,v,E)},preRender:function(){this.renderList.length=0;var g=this.width,c=this.height,f=g*.5,m=c*.5,v=this.zoomX,E=this.zoomY,x=this.matrix;this.renderRoundPixels=this.roundPixels&&Number.isInteger(v)&&Number.isInteger(E);var T=g*this.originX,A=c*this.originY,P=this._follow,R=this.deadzone,S=this.scrollX,I=this.scrollY;R&&s(R,this.midPoint.x,this.midPoint.y);var w=!1;if(P&&!this.panEffect.isRunning){var C=this.lerp,_=P.x-this.followOffset.x,O=P.y-this.followOffset.y;R?(_<R.x?S=l(S,S-(R.x-_),C.x):_>R.right&&(S=l(S,S+(_-R.right),C.x)),O<R.y?I=l(I,I-(R.y-O),C.y):O>R.bottom&&(I=l(I,I+(O-R.bottom),C.y))):(S=l(S,_-T,C.x),I=l(I,O-A,C.y)),w=!0}this.roundPixels&&(S=Math.floor(S),I=Math.floor(I)),this.useBounds&&(S=this.clampX(S),I=this.clampY(I)),this.scrollX=S,this.scrollY=I;var D=S+f,F=I+m;this.midPoint.set(D,F);var N=Math.floor(g/v+.5),Y=Math.floor(c/E+.5),L=Math.floor(D-N/2+.5),b=Math.floor(F-Y/2+.5);this.worldView.setTo(L,b,N,Y),x.applyITRS(Math.floor(this.x+T+.5),Math.floor(this.y+A+.5),this.rotation,v,E),x.translate(-T,-A),this.shakeEffect.preRender(),w&&this.emit(h.FOLLOW_UPDATE,this,P)},setLerp:function(g,c){return g===void 0&&(g=1),c===void 0&&(c=g),this.lerp.set(g,c),this},setFollowOffset:function(g,c){return g===void 0&&(g=0),c===void 0&&(c=0),this.followOffset.set(g,c),this},startFollow:function(g,c,f,m,v,E){c===void 0&&(c=!1),f===void 0&&(f=1),m===void 0&&(m=f),v===void 0&&(v=0),E===void 0&&(E=v),this._follow=g,this.roundPixels=c,f=n(f,0,1),m=n(m,0,1),this.lerp.set(f,m),this.followOffset.set(v,E);var x=this.width/2,T=this.height/2,A=g.x-v,P=g.y-E;return this.midPoint.set(A,P),this.scrollX=A-x,this.scrollY=P-T,this.useBounds&&(this.scrollX=this.clampX(this.scrollX),this.scrollY=this.clampY(this.scrollY)),this},stopFollow:function(){return this._follow=null,this},resetFX:function(){return this.rotateToEffect.reset(),this.panEffect.reset(),this.shakeEffect.reset(),this.flashEffect.reset(),this.fadeEffect.reset(),this},update:function(g,c){this.visible&&(this.rotateToEffect.update(g,c),this.panEffect.update(g,c),this.zoomEffect.update(g,c),this.shakeEffect.update(g,c),this.flashEffect.update(g,c),this.fadeEffect.update(g,c))},destroy:function(){this.resetFX(),i.prototype.destroy.call(this),this._follow=null,this.deadzone=null}});t.exports=p}),bv=y((e,t)=>{t.exports="enterfullscreen"}),Iv=y((e,t)=>{t.exports="fullscreenfailed"}),_v=y((e,t)=>{t.exports="fullscreenunsupported"}),Ov=y((e,t)=>{t.exports="leavefullscreen"}),Mv=y((e,t)=>{t.exports="orientationchange"}),Lv=y((e,t)=>{t.exports="resize"}),Is=y((e,t)=>{t.exports={ENTER_FULLSCREEN:bv(),FULLSCREEN_FAILED:Iv(),FULLSCREEN_UNSUPPORTED:_v(),LEAVE_FULLSCREEN:Ov(),ORIENTATION_CHANGE:Mv(),RESIZE:Lv()}}),Dv=y((e,t)=>{var i=Dn(),s=W(),n=dt(),r=he(),o=Ui(),a=Is(),h=Vt(),l=new s({initialize:function(u){this.scene=u,this.systems=u.sys,this.roundPixels=u.sys.game.config.roundPixels,this.cameras=[],this.main,this.default,u.sys.events.once(h.BOOT,this.boot,this),u.sys.events.on(h.START,this.start,this)},boot:function(){var u=this.systems;u.settings.cameras?this.fromJSON(u.settings.cameras):this.add(),this.main=this.cameras[0],this.default=new i(0,0,u.scale.width,u.scale.height).setScene(this.scene),u.game.scale.on(a.RESIZE,this.onResize,this),this.systems.events.once(h.DESTROY,this.destroy,this)},start:function(){if(!this.main){var u=this.systems;u.settings.cameras?this.fromJSON(u.settings.cameras):this.add(),this.main=this.cameras[0]}var d=this.systems.events;d.on(h.UPDATE,this.update,this),d.once(h.SHUTDOWN,this.shutdown,this)},add:function(u,d,p,g,c,f){u===void 0&&(u=0),d===void 0&&(d=0),p===void 0&&(p=this.scene.sys.scale.width),g===void 0&&(g=this.scene.sys.scale.height),c===void 0&&(c=!1),f===void 0&&(f="");var m=new i(u,d,p,g);return m.setName(f),m.setScene(this.scene),m.setRoundPixels(this.roundPixels),m.id=this.getNextID(),this.cameras.push(m),c&&(this.main=m),m},addExisting:function(u,d){d===void 0&&(d=!1);var p=this.cameras.indexOf(u);return p===-1?(u.id=this.getNextID(),u.setRoundPixels(this.roundPixels),this.cameras.push(u),d&&(this.main=u),u):null},getNextID:function(){for(var u=this.cameras,d=1,p=0;p<32;p++){for(var g=!1,c=0;c<u.length;c++){var f=u[c];if(f&&f.id===d){g=!0;continue}}if(g)d=d<<1;else return d}return 0},getTotal:function(u){u===void 0&&(u=!1);for(var d=0,p=this.cameras,g=0;g<p.length;g++){var c=p[g];(!u||u&&c.visible)&&d++}return d},fromJSON:function(u){Array.isArray(u)||(u=[u]);for(var d=this.scene.sys.scale.width,p=this.scene.sys.scale.height,g=0;g<u.length;g++){var c=u[g],f=n(c,"x",0),m=n(c,"y",0),v=n(c,"width",d),E=n(c,"height",p),x=this.add(f,m,v,E);x.name=n(c,"name",""),x.zoom=n(c,"zoom",1),x.rotation=n(c,"rotation",0),x.scrollX=n(c,"scrollX",0),x.scrollY=n(c,"scrollY",0),x.roundPixels=n(c,"roundPixels",!1),x.visible=n(c,"visible",!0);var T=n(c,"backgroundColor",!1);T&&x.setBackgroundColor(T);var A=n(c,"bounds",null);if(A){var P=n(A,"x",0),R=n(A,"y",0),S=n(A,"width",d),I=n(A,"height",p);x.setBounds(P,R,S,I)}}return this},getCamera:function(u){for(var d=this.cameras,p=0;p<d.length;p++)if(d[p].name===u)return d[p];return null},getCamerasBelowPointer:function(u){for(var d=this.cameras,p=u.x,g=u.y,c=[],f=0;f<d.length;f++){var m=d[f];m.visible&&m.inputEnabled&&o(m,p,g)&&c.unshift(m)}return c},remove:function(u,d){d===void 0&&(d=!0),Array.isArray(u)||(u=[u]);for(var p=0,g=this.cameras,c=0;c<u.length;c++){var f=g.indexOf(u[c]);f!==-1&&(d?g[f].destroy():g[f].renderList=[],g.splice(f,1),p++)}return!this.main&&g[0]&&(this.main=g[0]),p},render:function(u,d){for(var p=this.scene,g=this.cameras,c=0;c<g.length;c++){var f=g[c];if(f.visible&&f.alpha>0){f.preRender();var m=this.getVisibleChildren(d.getChildren(),f);u.render(p,m,f)}}},getVisibleChildren:function(u,d){return u.filter(function(p){return p.willRender(d)})},resetAll:function(){for(var u=0;u<this.cameras.length;u++)this.cameras[u].destroy();return this.cameras=[],this.main=this.add(),this.main},update:function(u,d){for(var p=0;p<this.cameras.length;p++)this.cameras[p].update(u,d)},onResize:function(u,d,p,g,c){for(var f=0;f<this.cameras.length;f++){var m=this.cameras[f];m._x===0&&m._y===0&&m._width===g&&m._height===c&&m.setSize(d.width,d.height)}},resize:function(u,d){for(var p=0;p<this.cameras.length;p++)this.cameras[p].setSize(u,d)},shutdown:function(){this.main=void 0;for(var u=0;u<this.cameras.length;u++)this.cameras[u].destroy();this.cameras=[];var d=this.systems.events;d.off(h.UPDATE,this.update,this),d.off(h.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.default.destroy(),this.systems.events.off(h.START,this.start,this),this.systems.events.off(h.DESTROY,this.destroy,this),this.systems.game.scale.off(a.RESIZE,this.onResize,this),this.scene=null,this.systems=null}});r.register("CameraManager",l,"cameras"),t.exports=l}),kv=y((e,t)=>{t.exports={Camera:Dn(),BaseCamera:ua(),CameraManager:Dv(),Effects:wl(),Events:Ie()}}),Cl=y((e,t)=>{var i={Global:["game","anims","cache","plugins","registry","scale","sound","textures","renderer"],CoreScene:["EventEmitter","CameraManager","GameObjectCreator","GameObjectFactory","ScenePlugin","DisplayList","UpdateList"],DefaultScene:["Clock","DataManagerPlugin","InputPlugin","Loader","TweenManager","LightsPlugin"]};i.DefaultScene.push("CameraManager3D"),t.exports=i}),Pl=y((e,t)=>{var i=function(s,n,r,o){return Math.atan2(o-n,r-s)};t.exports=i}),Fv=y((e,t)=>{var i=function(s,n){return Math.atan2(n.y-s.y,n.x-s.x)};t.exports=i}),Nv=y((e,t)=>{var i=function(s,n){return Math.atan2(n.x-s.x,n.y-s.y)};t.exports=i}),Bv=y((e,t)=>{var i=function(s,n,r,o){return Math.atan2(r-s,o-n)};t.exports=i}),Uv=y((e,t)=>{var i=Gt(),s=function(n){return n>Math.PI&&(n-=i.PI2),Math.abs(((n+i.TAU)%i.PI2-i.PI2)%i.PI2)};t.exports=s}),Rl=y((e,t)=>{var i=function(s){return s=s%(2*Math.PI),s>=0?s:s+2*Math.PI};t.exports=i}),_s=y((e,t)=>{var i=function(s,n){return Math.random()*(n-s)+s};t.exports=i}),Gv=y((e,t)=>{var i=_s(),s=function(){return i(-Math.PI,Math.PI)};t.exports=s}),Yv=y((e,t)=>{var i=_s(),s=function(){return i(-180,180)};t.exports=s}),Hv=y((e,t)=>{var i=Rl(),s=function(n){return i(n+Math.PI)};t.exports=s}),zv=y((e,t)=>{var i=Gt(),s=function(n,r,o){return o===void 0&&(o=.05),n===r||(Math.abs(r-n)<=o||Math.abs(r-n)>=i.PI2-o?n=r:(Math.abs(r-n)>Math.PI&&(r<n?r+=i.PI2:r-=i.PI2),r>n?n+=o:r<n&&(n-=o))),n};t.exports=s}),Wv=y((e,t)=>{var i=function(s,n){var r=n-s;if(r===0)return 0;var o=Math.floor((r- -180)/360);return r-o*360};t.exports=i}),Vv=y((e,t)=>{t.exports={Between:Pl(),BetweenPoints:Fv(),BetweenPointsY:Nv(),BetweenY:Bv(),CounterClockwise:Uv(),Normalize:Rl(),Random:Gv(),RandomDegrees:Yv(),Reverse:Hv(),RotateTo:zv(),ShortestBetween:Wv(),Wrap:Jh(),WrapDegrees:Qh()}}),Xv=y((e,t)=>{var i=function(s,n){var r=s.x-n.x,o=s.y-n.y;return r*r+o*o};t.exports=i}),Kv=y((e,t)=>{var i=function(s,n,r,o){return Math.max(Math.abs(s-r),Math.abs(n-o))};t.exports=i}),jv=y((e,t)=>{var i=function(s,n,r,o,a){return a===void 0&&(a=2),Math.sqrt(Math.pow(r-s,a)+Math.pow(o-n,a))};t.exports=i}),Zv=y((e,t)=>{var i=function(s,n,r,o){return Math.abs(s-r)+Math.abs(n-o)};t.exports=i}),qv=y((e,t)=>{var i=function(s,n,r,o){var a=s-r,h=n-o;return a*a+h*h};t.exports=i}),Jv=y((e,t)=>{t.exports={Between:Mn(),BetweenPoints:tl(),BetweenPointsSquared:Xv(),Chebyshev:Kv(),Power:jv(),Snake:Zv(),Squared:qv()}}),Qv=y((e,t)=>{t.exports={Back:el(),Bounce:il(),Circular:sl(),Cubic:nl(),Elastic:rl(),Expo:al(),Linear:ol(),Quadratic:hl(),Quartic:ll(),Quintic:ul(),Sine:cl(),Stepped:dl()}}),$v=y((e,t)=>{var i=function(s,n){return n===void 0&&(n=1e-4),Math.ceil(s-n)};t.exports=i}),tE=y((e,t)=>{var i=function(s,n){return n===void 0&&(n=1e-4),Math.floor(s+n)};t.exports=i}),eE=y((e,t)=>{var i=function(s,n,r){return r===void 0&&(r=1e-4),s>n-r};t.exports=i}),iE=y((e,t)=>{var i=function(s,n,r){return r===void 0&&(r=1e-4),s<n+r};t.exports=i}),sE=y((e,t)=>{t.exports={Ceil:$v(),Equal:ta(),Floor:tE(),GreaterThan:eE(),LessThan:iE()}}),bl=y((e,t)=>{var i=function(s){if(s===0)return 1;for(var n=s;--s;)n*=s;return n};t.exports=i}),Il=y((e,t)=>{var i=bl(),s=function(n,r){return i(n)/i(r)/i(n-r)};t.exports=s}),_l=y((e,t)=>{var i=Il(),s=function(n,r){for(var o=0,a=n.length-1,h=0;h<=a;h++)o+=Math.pow(1-r,a-h)*Math.pow(r,h)*n[h]*i(a,h);return o};t.exports=s}),da=y((e,t)=>{var i=function(s,n,r,o,a){var h=(o-n)*.5,l=(a-r)*.5,u=s*s,d=s*u;return(2*r-2*o+h+l)*d+(-3*r+3*o-2*h-l)*u+h*s+r};t.exports=i}),Ol=y((e,t)=>{var i=da(),s=function(n,r){var o=n.length-1,a=o*r,h=Math.floor(a);return n[0]===n[o]?(r<0&&(h=Math.floor(a=o*(1+r))),i(a-h,n[(h-1+o)%o],n[h],n[(h+1)%o],n[(h+2)%o])):r<0?n[0]-(i(-a,n[0],n[0],n[1],n[1])-n[0]):r>1?n[o]-(i(a-o,n[o],n[o],n[o-1],n[o-1])-n[o]):i(a-h,n[h?h-1:0],n[h],n[o<h+1?o:h+1],n[o<h+2?o:h+2])};t.exports=s}),Ml=y((e,t)=>{function i(a,h){var l=1-a;return l*l*l*h}function s(a,h){var l=1-a;return 3*l*l*a*h}function n(a,h){return 3*(1-a)*a*a*h}function r(a,h){return a*a*a*h}var o=function(a,h,l,u,d){return i(a,h)+s(a,l)+n(a,u)+r(a,d)};t.exports=o}),Ll=y((e,t)=>{var i=ca(),s=function(n,r){var o=n.length-1,a=o*r,h=Math.floor(a);return r<0?i(n[0],n[1],a):r>1?i(n[o],n[o-1],o-a):i(n[h],n[h+1>o?o:h+1],a-h)};t.exports=s}),Dl=y((e,t)=>{function i(o,a){var h=1-o;return h*h*a}function s(o,a){return 2*(1-o)*o*a}function n(o,a){return o*o*a}var r=function(o,a,h,l){return i(o,a)+s(o,h)+n(o,l)};t.exports=r}),kl=y((e,t)=>{var i=ha(),s=function(n,r,o){return r+(o-r)*i(n,0,1)};t.exports=s}),nE=y((e,t)=>{var i=oa(),s=function(n,r,o){return r+(o-r)*i(n,0,1)};t.exports=s}),rE=y((e,t)=>{t.exports={Bezier:_l(),CatmullRom:Ol(),CubicBezier:Ml(),Linear:Ll(),QuadraticBezier:Dl(),SmoothStep:kl(),SmootherStep:nE()}}),aE=y((e,t)=>{var i=function(s){var n=Math.log(s)/.6931471805599453;return 1<<Math.ceil(n)};t.exports=i}),Os=y((e,t)=>{var i=function(s,n){return s>0&&(s&s-1)===0&&n>0&&(n&n-1)===0};t.exports=i}),oE=y((e,t)=>{var i=function(s){return s>0&&(s&s-1)===0};t.exports=i}),hE=y((e,t)=>{t.exports={GetNext:aE(),IsSize:Os(),IsValue:oE()}}),Fl=y((e,t)=>{var i=function(s,n,r,o){return r===void 0&&(r=0),n===0?s:(s-=r,s=n*Math.ceil(s/n),o?(r+s)/n:r+s)};t.exports=i}),kn=y((e,t)=>{var i=function(s,n,r,o){return r===void 0&&(r=0),n===0?s:(s-=r,s=n*Math.floor(s/n),o?(r+s)/n:r+s)};t.exports=i}),Nl=y((e,t)=>{var i=function(s,n,r,o){return r===void 0&&(r=0),n===0?s:(s-=r,s=n*Math.round(s/n),o?(r+s)/n:r+s)};t.exports=i}),lE=y((e,t)=>{t.exports={Ceil:Fl(),Floor:kn(),To:Nl()}}),uE=y((e,t)=>{var i=W(),s=new i({initialize:function(n){n===void 0&&(n=[(Date.now()*Math.random()).toString()]),this.c=1,this.s0=0,this.s1=0,this.s2=0,this.n=0,this.signs=[-1,1],n&&this.init(n)},rnd:function(){var n=2091639*this.s0+this.c*23283064365386963e-26;return this.c=n|0,this.s0=this.s1,this.s1=this.s2,this.s2=n-this.c,this.s2},hash:function(n){var r,o=this.n;n=n.toString();for(var a=0;a<n.length;a++)o+=n.charCodeAt(a),r=.02519603282416938*o,o=r>>>0,r-=o,r*=o,o=r>>>0,r-=o,o+=r*4294967296;return this.n=o,(o>>>0)*23283064365386963e-26},init:function(n){typeof n=="string"?this.state(n):this.sow(n)},sow:function(n){if(this.n=4022871197,this.s0=this.hash(" "),this.s1=this.hash(" "),this.s2=this.hash(" "),this.c=1,!!n)for(var r=0;r<n.length&&n[r]!=null;r++){var o=n[r];this.s0-=this.hash(o),this.s0+=~~(this.s0<0),this.s1-=this.hash(o),this.s1+=~~(this.s1<0),this.s2-=this.hash(o),this.s2+=~~(this.s2<0)}},integer:function(){return this.rnd()*4294967296},frac:function(){return this.rnd()+(this.rnd()*2097152|0)*11102230246251565e-32},real:function(){return this.integer()+this.frac()},integerInRange:function(n,r){return Math.floor(this.realInRange(0,r-n+1)+n)},between:function(n,r){return Math.floor(this.realInRange(0,r-n+1)+n)},realInRange:function(n,r){return this.frac()*(r-n)+n},normal:function(){return 1-2*this.frac()},uuid:function(){var n="",r="";for(r=n="";n++<36;r+=~n%5|n*3&4?(n^15?8^this.frac()*(n^20?16:4):4).toString(16):"-");return r},pick:function(n){return n[this.integerInRange(0,n.length-1)]},sign:function(){return this.pick(this.signs)},weightedPick:function(n){return n[~~(Math.pow(this.frac(),2)*(n.length-.5)+.5)]},timestamp:function(n,r){return this.realInRange(n||9466848e5,r||1577862e6)},angle:function(){return this.integerInRange(-180,180)},rotation:function(){return this.realInRange(-3.1415926,3.1415926)},state:function(n){return typeof n=="string"&&n.match(/^!rnd/)&&(n=n.split(","),this.c=parseFloat(n[1]),this.s0=parseFloat(n[2]),this.s1=parseFloat(n[3]),this.s2=parseFloat(n[4])),["!rnd",this.c,this.s0,this.s1,this.s2].join(",")},shuffle:function(n){for(var r=n.length-1,o=r;o>0;o--){var a=Math.floor(this.frac()*(o+1)),h=n[a];n[a]=n[o],n[o]=h}return n}});t.exports=s}),cE=y((e,t)=>{var i=function(s){for(var n=0,r=0;r<s.length;r++)n+=+s[r];return n/s.length};t.exports=i}),dE=y((e,t)=>{var i=function(s,n,r){n===void 0&&(n=0),r===void 0&&(r=10);var o=Math.pow(r,-n);return Math.ceil(s*o)/o};t.exports=i}),pE=y((e,t)=>{var i=function(s,n){return Math.abs(s-n)};t.exports=i}),Ms=y((e,t)=>{var i=W(),s=new i({initialize:function(n,r,o){this.x=0,this.y=0,this.z=0,typeof n=="object"?(this.x=n.x||0,this.y=n.y||0,this.z=n.z||0):(this.x=n||0,this.y=r||0,this.z=o||0)},up:function(){return this.x=0,this.y=1,this.z=0,this},min:function(n){return this.x=Math.min(this.x,n.x),this.y=Math.min(this.y,n.y),this.z=Math.min(this.z,n.z),this},max:function(n){return this.x=Math.max(this.x,n.x),this.y=Math.max(this.y,n.y),this.z=Math.max(this.z,n.z),this},clone:function(){return new s(this.x,this.y,this.z)},addVectors:function(n,r){return this.x=n.x+r.x,this.y=n.y+r.y,this.z=n.z+r.z,this},subVectors:function(n,r){return this.x=n.x-r.x,this.y=n.y-r.y,this.z=n.z-r.z,this},crossVectors:function(n,r){var o=n.x,a=n.y,h=n.z,l=r.x,u=r.y,d=r.z;return this.x=a*d-h*u,this.y=h*l-o*d,this.z=o*u-a*l,this},equals:function(n){return this.x===n.x&&this.y===n.y&&this.z===n.z},copy:function(n){return this.x=n.x,this.y=n.y,this.z=n.z||0,this},set:function(n,r,o){return typeof n=="object"?(this.x=n.x||0,this.y=n.y||0,this.z=n.z||0):(this.x=n||0,this.y=r||0,this.z=o||0),this},setFromMatrixPosition:function(n){return this.fromArray(n.val,12)},setFromMatrixColumn:function(n,r){return this.fromArray(n.val,r*4)},fromArray:function(n,r){return r===void 0&&(r=0),this.x=n[r],this.y=n[r+1],this.z=n[r+2],this},add:function(n){return this.x+=n.x,this.y+=n.y,this.z+=n.z||0,this},addScalar:function(n){return this.x+=n,this.y+=n,this.z+=n,this},addScale:function(n,r){return this.x+=n.x*r,this.y+=n.y*r,this.z+=n.z*r||0,this},subtract:function(n){return this.x-=n.x,this.y-=n.y,this.z-=n.z||0,this},multiply:function(n){return this.x*=n.x,this.y*=n.y,this.z*=n.z||1,this},scale:function(n){return isFinite(n)?(this.x*=n,this.y*=n,this.z*=n):(this.x=0,this.y=0,this.z=0),this},divide:function(n){return this.x/=n.x,this.y/=n.y,this.z/=n.z||1,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},distance:function(n){var r=n.x-this.x,o=n.y-this.y,a=n.z-this.z||0;return Math.sqrt(r*r+o*o+a*a)},distanceSq:function(n){var r=n.x-this.x,o=n.y-this.y,a=n.z-this.z||0;return r*r+o*o+a*a},length:function(){var n=this.x,r=this.y,o=this.z;return Math.sqrt(n*n+r*r+o*o)},lengthSq:function(){var n=this.x,r=this.y,o=this.z;return n*n+r*r+o*o},normalize:function(){var n=this.x,r=this.y,o=this.z,a=n*n+r*r+o*o;return a>0&&(a=1/Math.sqrt(a),this.x=n*a,this.y=r*a,this.z=o*a),this},dot:function(n){return this.x*n.x+this.y*n.y+this.z*n.z},cross:function(n){var r=this.x,o=this.y,a=this.z,h=n.x,l=n.y,u=n.z;return this.x=o*u-a*l,this.y=a*h-r*u,this.z=r*l-o*h,this},lerp:function(n,r){r===void 0&&(r=0);var o=this.x,a=this.y,h=this.z;return this.x=o+r*(n.x-o),this.y=a+r*(n.y-a),this.z=h+r*(n.z-h),this},applyMatrix3:function(n){var r=this.x,o=this.y,a=this.z,h=n.val;return this.x=h[0]*r+h[3]*o+h[6]*a,this.y=h[1]*r+h[4]*o+h[7]*a,this.z=h[2]*r+h[5]*o+h[8]*a,this},applyMatrix4:function(n){var r=this.x,o=this.y,a=this.z,h=n.val,l=1/(h[3]*r+h[7]*o+h[11]*a+h[15]);return this.x=(h[0]*r+h[4]*o+h[8]*a+h[12])*l,this.y=(h[1]*r+h[5]*o+h[9]*a+h[13])*l,this.z=(h[2]*r+h[6]*o+h[10]*a+h[14])*l,this},transformMat3:function(n){var r=this.x,o=this.y,a=this.z,h=n.val;return this.x=r*h[0]+o*h[3]+a*h[6],this.y=r*h[1]+o*h[4]+a*h[7],this.z=r*h[2]+o*h[5]+a*h[8],this},transformMat4:function(n){var r=this.x,o=this.y,a=this.z,h=n.val;return this.x=h[0]*r+h[4]*o+h[8]*a+h[12],this.y=h[1]*r+h[5]*o+h[9]*a+h[13],this.z=h[2]*r+h[6]*o+h[10]*a+h[14],this},transformCoordinates:function(n){var r=this.x,o=this.y,a=this.z,h=n.val,l=r*h[0]+o*h[4]+a*h[8]+h[12],u=r*h[1]+o*h[5]+a*h[9]+h[13],d=r*h[2]+o*h[6]+a*h[10]+h[14],p=r*h[3]+o*h[7]+a*h[11]+h[15];return this.x=l/p,this.y=u/p,this.z=d/p,this},transformQuat:function(n){var r=this.x,o=this.y,a=this.z,h=n.x,l=n.y,u=n.z,d=n.w,p=d*r+l*a-u*o,g=d*o+u*r-h*a,c=d*a+h*o-l*r,f=-h*r-l*o-u*a;return this.x=p*d+f*-h+g*-u-c*-l,this.y=g*d+f*-l+c*-h-p*-u,this.z=c*d+f*-u+p*-l-g*-h,this},project:function(n){var r=this.x,o=this.y,a=this.z,h=n.val,l=h[0],u=h[1],d=h[2],p=h[3],g=h[4],c=h[5],f=h[6],m=h[7],v=h[8],E=h[9],x=h[10],T=h[11],A=h[12],P=h[13],R=h[14],S=h[15],I=1/(r*p+o*m+a*T+S);return this.x=(r*l+o*g+a*v+A)*I,this.y=(r*u+o*c+a*E+P)*I,this.z=(r*d+o*f+a*x+R)*I,this},projectViewMatrix:function(n,r){return this.applyMatrix4(n).applyMatrix4(r)},unprojectViewMatrix:function(n,r){return this.applyMatrix4(n).applyMatrix4(r)},unproject:function(n,r){var o=n.x,a=n.y,h=n.z,l=n.w,u=this.x-o,d=l-this.y-1-a,p=this.z;return this.x=2*u/h-1,this.y=2*d/l-1,this.z=2*p-1,this.project(r)},reset:function(){return this.x=0,this.y=0,this.z=0,this}});s.ZERO=new s,s.RIGHT=new s(1,0,0),s.LEFT=new s(-1,0,0),s.UP=new s(0,-1,0),s.DOWN=new s(0,1,0),s.FORWARD=new s(0,0,1),s.BACK=new s(0,0,-1),s.ONE=new s(1,1,1),t.exports=s}),Ls=y((e,t)=>{var i=W(),s=Ms(),n=1e-6,r=new i({initialize:function(d){this.val=new Float32Array(16),d?this.copy(d):this.identity()},clone:function(){return new r(this)},set:function(d){return this.copy(d)},setValues:function(d,p,g,c,f,m,v,E,x,T,A,P,R,S,I,w){var C=this.val;return C[0]=d,C[1]=p,C[2]=g,C[3]=c,C[4]=f,C[5]=m,C[6]=v,C[7]=E,C[8]=x,C[9]=T,C[10]=A,C[11]=P,C[12]=R,C[13]=S,C[14]=I,C[15]=w,this},copy:function(d){var p=d.val;return this.setValues(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7],p[8],p[9],p[10],p[11],p[12],p[13],p[14],p[15])},fromArray:function(d){return this.setValues(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8],d[9],d[10],d[11],d[12],d[13],d[14],d[15])},zero:function(){return this.setValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)},transform:function(d,p,g){var c=o.fromQuat(g),f=c.val,m=p.x,v=p.y,E=p.z;return this.setValues(f[0]*m,f[1]*m,f[2]*m,0,f[4]*v,f[5]*v,f[6]*v,0,f[8]*E,f[9]*E,f[10]*E,0,d.x,d.y,d.z,1)},xyz:function(d,p,g){this.identity();var c=this.val;return c[12]=d,c[13]=p,c[14]=g,this},scaling:function(d,p,g){this.zero();var c=this.val;return c[0]=d,c[5]=p,c[10]=g,c[15]=1,this},identity:function(){return this.setValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},transpose:function(){var d=this.val,p=d[1],g=d[2],c=d[3],f=d[6],m=d[7],v=d[11];return d[1]=d[4],d[2]=d[8],d[3]=d[12],d[4]=p,d[6]=d[9],d[7]=d[13],d[8]=g,d[9]=f,d[11]=d[14],d[12]=c,d[13]=m,d[14]=v,this},getInverse:function(d){return this.copy(d),this.invert()},invert:function(){var d=this.val,p=d[0],g=d[1],c=d[2],f=d[3],m=d[4],v=d[5],E=d[6],x=d[7],T=d[8],A=d[9],P=d[10],R=d[11],S=d[12],I=d[13],w=d[14],C=d[15],_=p*v-g*m,O=p*E-c*m,D=p*x-f*m,F=g*E-c*v,N=g*x-f*v,Y=c*x-f*E,L=T*I-A*S,b=T*w-P*S,M=T*C-R*S,k=A*w-P*I,B=A*C-R*I,H=P*C-R*w,z=_*H-O*B+D*k+F*M-N*b+Y*L;return z?(z=1/z,this.setValues((v*H-E*B+x*k)*z,(c*B-g*H-f*k)*z,(I*Y-w*N+C*F)*z,(P*N-A*Y-R*F)*z,(E*M-m*H-x*b)*z,(p*H-c*M+f*b)*z,(w*D-S*Y-C*O)*z,(T*Y-P*D+R*O)*z,(m*B-v*M+x*L)*z,(g*M-p*B-f*L)*z,(S*N-I*D+C*_)*z,(A*D-T*N-R*_)*z,(v*b-m*k-E*L)*z,(p*k-g*b+c*L)*z,(I*O-S*F-w*_)*z,(T*F-A*O+P*_)*z)):this},adjoint:function(){var d=this.val,p=d[0],g=d[1],c=d[2],f=d[3],m=d[4],v=d[5],E=d[6],x=d[7],T=d[8],A=d[9],P=d[10],R=d[11],S=d[12],I=d[13],w=d[14],C=d[15];return this.setValues(v*(P*C-R*w)-A*(E*C-x*w)+I*(E*R-x*P),-(g*(P*C-R*w)-A*(c*C-f*w)+I*(c*R-f*P)),g*(E*C-x*w)-v*(c*C-f*w)+I*(c*x-f*E),-(g*(E*R-x*P)-v*(c*R-f*P)+A*(c*x-f*E)),-(m*(P*C-R*w)-T*(E*C-x*w)+S*(E*R-x*P)),p*(P*C-R*w)-T*(c*C-f*w)+S*(c*R-f*P),-(p*(E*C-x*w)-m*(c*C-f*w)+S*(c*x-f*E)),p*(E*R-x*P)-m*(c*R-f*P)+T*(c*x-f*E),m*(A*C-R*I)-T*(v*C-x*I)+S*(v*R-x*A),-(p*(A*C-R*I)-T*(g*C-f*I)+S*(g*R-f*A)),p*(v*C-x*I)-m*(g*C-f*I)+S*(g*x-f*v),-(p*(v*R-x*A)-m*(g*R-f*A)+T*(g*x-f*v)),-(m*(A*w-P*I)-T*(v*w-E*I)+S*(v*P-E*A)),p*(A*w-P*I)-T*(g*w-c*I)+S*(g*P-c*A),-(p*(v*w-E*I)-m*(g*w-c*I)+S*(g*E-c*v)),p*(v*P-E*A)-m*(g*P-c*A)+T*(g*E-c*v))},determinant:function(){var d=this.val,p=d[0],g=d[1],c=d[2],f=d[3],m=d[4],v=d[5],E=d[6],x=d[7],T=d[8],A=d[9],P=d[10],R=d[11],S=d[12],I=d[13],w=d[14],C=d[15],_=p*v-g*m,O=p*E-c*m,D=p*x-f*m,F=g*E-c*v,N=g*x-f*v,Y=c*x-f*E,L=T*I-A*S,b=T*w-P*S,M=T*C-R*S,k=A*w-P*I,B=A*C-R*I,H=P*C-R*w;return _*H-O*B+D*k+F*M-N*b+Y*L},multiply:function(d){var p=this.val,g=p[0],c=p[1],f=p[2],m=p[3],v=p[4],E=p[5],x=p[6],T=p[7],A=p[8],P=p[9],R=p[10],S=p[11],I=p[12],w=p[13],C=p[14],_=p[15],O=d.val,D=O[0],F=O[1],N=O[2],Y=O[3];return p[0]=D*g+F*v+N*A+Y*I,p[1]=D*c+F*E+N*P+Y*w,p[2]=D*f+F*x+N*R+Y*C,p[3]=D*m+F*T+N*S+Y*_,D=O[4],F=O[5],N=O[6],Y=O[7],p[4]=D*g+F*v+N*A+Y*I,p[5]=D*c+F*E+N*P+Y*w,p[6]=D*f+F*x+N*R+Y*C,p[7]=D*m+F*T+N*S+Y*_,D=O[8],F=O[9],N=O[10],Y=O[11],p[8]=D*g+F*v+N*A+Y*I,p[9]=D*c+F*E+N*P+Y*w,p[10]=D*f+F*x+N*R+Y*C,p[11]=D*m+F*T+N*S+Y*_,D=O[12],F=O[13],N=O[14],Y=O[15],p[12]=D*g+F*v+N*A+Y*I,p[13]=D*c+F*E+N*P+Y*w,p[14]=D*f+F*x+N*R+Y*C,p[15]=D*m+F*T+N*S+Y*_,this},multiplyLocal:function(d){var p=this.val,g=d.val;return this.setValues(p[0]*g[0]+p[1]*g[4]+p[2]*g[8]+p[3]*g[12],p[0]*g[1]+p[1]*g[5]+p[2]*g[9]+p[3]*g[13],p[0]*g[2]+p[1]*g[6]+p[2]*g[10]+p[3]*g[14],p[0]*g[3]+p[1]*g[7]+p[2]*g[11]+p[3]*g[15],p[4]*g[0]+p[5]*g[4]+p[6]*g[8]+p[7]*g[12],p[4]*g[1]+p[5]*g[5]+p[6]*g[9]+p[7]*g[13],p[4]*g[2]+p[5]*g[6]+p[6]*g[10]+p[7]*g[14],p[4]*g[3]+p[5]*g[7]+p[6]*g[11]+p[7]*g[15],p[8]*g[0]+p[9]*g[4]+p[10]*g[8]+p[11]*g[12],p[8]*g[1]+p[9]*g[5]+p[10]*g[9]+p[11]*g[13],p[8]*g[2]+p[9]*g[6]+p[10]*g[10]+p[11]*g[14],p[8]*g[3]+p[9]*g[7]+p[10]*g[11]+p[11]*g[15],p[12]*g[0]+p[13]*g[4]+p[14]*g[8]+p[15]*g[12],p[12]*g[1]+p[13]*g[5]+p[14]*g[9]+p[15]*g[13],p[12]*g[2]+p[13]*g[6]+p[14]*g[10]+p[15]*g[14],p[12]*g[3]+p[13]*g[7]+p[14]*g[11]+p[15]*g[15])},premultiply:function(d){return this.multiplyMatrices(d,this)},multiplyMatrices:function(d,p){var g=d.val,c=p.val,f=g[0],m=g[4],v=g[8],E=g[12],x=g[1],T=g[5],A=g[9],P=g[13],R=g[2],S=g[6],I=g[10],w=g[14],C=g[3],_=g[7],O=g[11],D=g[15],F=c[0],N=c[4],Y=c[8],L=c[12],b=c[1],M=c[5],k=c[9],B=c[13],H=c[2],z=c[6],V=c[10],q=c[14],Z=c[3],at=c[7],et=c[11],st=c[15];return this.setValues(f*F+m*b+v*H+E*Z,x*F+T*b+A*H+P*Z,R*F+S*b+I*H+w*Z,C*F+_*b+O*H+D*Z,f*N+m*M+v*z+E*at,x*N+T*M+A*z+P*at,R*N+S*M+I*z+w*at,C*N+_*M+O*z+D*at,f*Y+m*k+v*V+E*et,x*Y+T*k+A*V+P*et,R*Y+S*k+I*V+w*et,C*Y+_*k+O*V+D*et,f*L+m*B+v*q+E*st,x*L+T*B+A*q+P*st,R*L+S*B+I*q+w*st,C*L+_*B+O*q+D*st)},translate:function(d){return this.translateXYZ(d.x,d.y,d.z)},translateXYZ:function(d,p,g){var c=this.val;return c[12]=c[0]*d+c[4]*p+c[8]*g+c[12],c[13]=c[1]*d+c[5]*p+c[9]*g+c[13],c[14]=c[2]*d+c[6]*p+c[10]*g+c[14],c[15]=c[3]*d+c[7]*p+c[11]*g+c[15],this},scale:function(d){return this.scaleXYZ(d.x,d.y,d.z)},scaleXYZ:function(d,p,g){var c=this.val;return c[0]=c[0]*d,c[1]=c[1]*d,c[2]=c[2]*d,c[3]=c[3]*d,c[4]=c[4]*p,c[5]=c[5]*p,c[6]=c[6]*p,c[7]=c[7]*p,c[8]=c[8]*g,c[9]=c[9]*g,c[10]=c[10]*g,c[11]=c[11]*g,this},makeRotationAxis:function(d,p){var g=Math.cos(p),c=Math.sin(p),f=1-g,m=d.x,v=d.y,E=d.z,x=f*m,T=f*v;return this.setValues(x*m+g,x*v-c*E,x*E+c*v,0,x*v+c*E,T*v+g,T*E-c*m,0,x*E-c*v,T*E+c*m,f*E*E+g,0,0,0,0,1)},rotate:function(d,p){var g=this.val,c=p.x,f=p.y,m=p.z,v=Math.sqrt(c*c+f*f+m*m);if(Math.abs(v)<n)return this;v=1/v,c*=v,f*=v,m*=v;var E=Math.sin(d),x=Math.cos(d),T=1-x,A=g[0],P=g[1],R=g[2],S=g[3],I=g[4],w=g[5],C=g[6],_=g[7],O=g[8],D=g[9],F=g[10],N=g[11],Y=g[12],L=g[13],b=g[14],M=g[15],k=c*c*T+x,B=f*c*T+m*E,H=m*c*T-f*E,z=c*f*T-m*E,V=f*f*T+x,q=m*f*T+c*E,Z=c*m*T+f*E,at=f*m*T-c*E,et=m*m*T+x;return this.setValues(A*k+I*B+O*H,P*k+w*B+D*H,R*k+C*B+F*H,S*k+_*B+N*H,A*z+I*V+O*q,P*z+w*V+D*q,R*z+C*V+F*q,S*z+_*V+N*q,A*Z+I*at+O*et,P*Z+w*at+D*et,R*Z+C*at+F*et,S*Z+_*at+N*et,Y,L,b,M)},rotateX:function(d){var p=this.val,g=Math.sin(d),c=Math.cos(d),f=p[4],m=p[5],v=p[6],E=p[7],x=p[8],T=p[9],A=p[10],P=p[11];return p[4]=f*c+x*g,p[5]=m*c+T*g,p[6]=v*c+A*g,p[7]=E*c+P*g,p[8]=x*c-f*g,p[9]=T*c-m*g,p[10]=A*c-v*g,p[11]=P*c-E*g,this},rotateY:function(d){var p=this.val,g=Math.sin(d),c=Math.cos(d),f=p[0],m=p[1],v=p[2],E=p[3],x=p[8],T=p[9],A=p[10],P=p[11];return p[0]=f*c-x*g,p[1]=m*c-T*g,p[2]=v*c-A*g,p[3]=E*c-P*g,p[8]=f*g+x*c,p[9]=m*g+T*c,p[10]=v*g+A*c,p[11]=E*g+P*c,this},rotateZ:function(d){var p=this.val,g=Math.sin(d),c=Math.cos(d),f=p[0],m=p[1],v=p[2],E=p[3],x=p[4],T=p[5],A=p[6],P=p[7];return p[0]=f*c+x*g,p[1]=m*c+T*g,p[2]=v*c+A*g,p[3]=E*c+P*g,p[4]=x*c-f*g,p[5]=T*c-m*g,p[6]=A*c-v*g,p[7]=P*c-E*g,this},fromRotationTranslation:function(d,p){var g=d.x,c=d.y,f=d.z,m=d.w,v=g+g,E=c+c,x=f+f,T=g*v,A=g*E,P=g*x,R=c*E,S=c*x,I=f*x,w=m*v,C=m*E,_=m*x;return this.setValues(1-(R+I),A+_,P-C,0,A-_,1-(T+I),S+w,0,P+C,S-w,1-(T+R),0,p.x,p.y,p.z,1)},fromQuat:function(d){var p=d.x,g=d.y,c=d.z,f=d.w,m=p+p,v=g+g,E=c+c,x=p*m,T=p*v,A=p*E,P=g*v,R=g*E,S=c*E,I=f*m,w=f*v,C=f*E;return this.setValues(1-(P+S),T+C,A-w,0,T-C,1-(x+S),R+I,0,A+w,R-I,1-(x+P),0,0,0,0,1)},frustum:function(d,p,g,c,f,m){var v=1/(p-d),E=1/(c-g),x=1/(f-m);return this.setValues(f*2*v,0,0,0,0,f*2*E,0,0,(p+d)*v,(c+g)*E,(m+f)*x,-1,0,0,m*f*2*x,0)},perspective:function(d,p,g,c){var f=1/Math.tan(d/2),m=1/(g-c);return this.setValues(f/p,0,0,0,0,f,0,0,0,0,(c+g)*m,-1,0,0,2*c*g*m,0)},perspectiveLH:function(d,p,g,c){return this.setValues(2*g/d,0,0,0,0,2*g/p,0,0,0,0,-c/(g-c),1,0,0,g*c/(g-c),0)},ortho:function(d,p,g,c,f,m){var v=d-p,E=g-c,x=f-m;return v=v===0?v:1/v,E=E===0?E:1/E,x=x===0?x:1/x,this.setValues(-2*v,0,0,0,0,-2*E,0,0,0,0,2*x,0,(d+p)*v,(c+g)*E,(m+f)*x,1)},lookAtRH:function(d,p,g){var c=this.val;return u.subVectors(d,p),u.lengthSq()===0&&(u.z=1),u.normalize(),h.crossVectors(g,u),h.lengthSq()===0&&(Math.abs(g.z)===1?u.x+=1e-4:u.z+=1e-4,u.normalize(),h.crossVectors(g,u)),h.normalize(),l.crossVectors(u,h),c[0]=h.x,c[1]=h.y,c[2]=h.z,c[4]=l.x,c[5]=l.y,c[6]=l.z,c[8]=u.x,c[9]=u.y,c[10]=u.z,this},lookAt:function(d,p,g){var c=d.x,f=d.y,m=d.z,v=g.x,E=g.y,x=g.z,T=p.x,A=p.y,P=p.z;if(Math.abs(c-T)<n&&Math.abs(f-A)<n&&Math.abs(m-P)<n)return this.identity();var R=c-T,S=f-A,I=m-P,w=1/Math.sqrt(R*R+S*S+I*I);R*=w,S*=w,I*=w;var C=E*I-x*S,_=x*R-v*I,O=v*S-E*R;w=Math.sqrt(C*C+_*_+O*O),w?(w=1/w,C*=w,_*=w,O*=w):(C=0,_=0,O=0);var D=S*O-I*_,F=I*C-R*O,N=R*_-S*C;return w=Math.sqrt(D*D+F*F+N*N),w?(w=1/w,D*=w,F*=w,N*=w):(D=0,F=0,N=0),this.setValues(C,D,R,0,_,F,S,0,O,N,I,0,-(C*c+_*f+O*m),-(D*c+F*f+N*m),-(R*c+S*f+I*m),1)},yawPitchRoll:function(d,p,g){this.zero(),o.zero(),a.zero();var c=this.val,f=o.val,m=a.val,v=Math.sin(g),E=Math.cos(g);return c[10]=1,c[15]=1,c[0]=E,c[1]=v,c[4]=-v,c[5]=E,v=Math.sin(p),E=Math.cos(p),f[0]=1,f[15]=1,f[5]=E,f[10]=E,f[9]=-v,f[6]=v,v=Math.sin(d),E=Math.cos(d),m[5]=1,m[15]=1,m[0]=E,m[2]=-v,m[8]=v,m[10]=E,this.multiplyLocal(o),this.multiplyLocal(a),this},setWorldMatrix:function(d,p,g,c,f){return this.yawPitchRoll(d.y,d.x,d.z),o.scaling(g.x,g.y,g.z),a.xyz(p.x,p.y,p.z),this.multiplyLocal(o),this.multiplyLocal(a),c&&this.multiplyLocal(c),f&&this.multiplyLocal(f),this},multiplyToMat4:function(d,p){var g=this.val,c=d.val,f=g[0],m=g[1],v=g[2],E=g[3],x=g[4],T=g[5],A=g[6],P=g[7],R=g[8],S=g[9],I=g[10],w=g[11],C=g[12],_=g[13],O=g[14],D=g[15],F=c[0],N=c[1],Y=c[2],L=c[3],b=c[4],M=c[5],k=c[6],B=c[7],H=c[8],z=c[9],V=c[10],q=c[11],Z=c[12],at=c[13],et=c[14],st=c[15];return p.setValues(F*f+N*x+Y*R+L*C,N*m+N*T+Y*S+L*_,Y*v+N*A+Y*I+L*O,L*E+N*P+Y*w+L*D,b*f+M*x+k*R+B*C,b*m+M*T+k*S+B*_,b*v+M*A+k*I+B*O,b*E+M*P+k*w+B*D,H*f+z*x+V*R+q*C,H*m+z*T+V*S+q*_,H*v+z*A+V*I+q*O,H*E+z*P+V*w+q*D,Z*f+at*x+et*R+st*C,Z*m+at*T+et*S+st*_,Z*v+at*A+et*I+st*O,Z*E+at*P+et*w+st*D)},fromRotationXYTranslation:function(d,p,g){var c=p.x,f=p.y,m=p.z,v=Math.sin(d.x),E=Math.cos(d.x),x=Math.sin(d.y),T=Math.cos(d.y),A=c,P=f,R=m,S=-v,I=0-S*x,w=0-E*x,C=S*T,_=E*T;return g||(A=T*c+x*m,P=I*c+E*f+C*m,R=w*c+v*f+_*m),this.setValues(T,I,w,0,0,E,v,0,x,C,_,0,A,P,R,1)},getMaxScaleOnAxis:function(){var d=this.val,p=d[0]*d[0]+d[1]*d[1]+d[2]*d[2],g=d[4]*d[4]+d[5]*d[5]+d[6]*d[6],c=d[8]*d[8]+d[9]*d[9]+d[10]*d[10];return Math.sqrt(Math.max(p,g,c))}}),o=new r,a=new r,h=new s,l=new s,u=new s;t.exports=r}),gE=y((e,t)=>{var i=Ot(),s=W(),n=Ls(),r=Rt(),o=new n,a=new s({initialize:function h(l,u,d,p){l===void 0&&(l=0),u===void 0&&(u=0),d===void 0&&(d=0),p===void 0&&(p=h.DefaultOrder),this._x=l,this._y=u,this._z=d,this._order=p,this.onChangeCallback=r},x:{get:function(){return this._x},set:function(h){this._x=h,this.onChangeCallback(this)}},y:{get:function(){return this._y},set:function(h){this._y=h,this.onChangeCallback(this)}},z:{get:function(){return this._z},set:function(h){this._z=h,this.onChangeCallback(this)}},order:{get:function(){return this._order},set:function(h){this._order=h,this.onChangeCallback(this)}},set:function(h,l,u,d){return d===void 0&&(d=this._order),this._x=h,this._y=l,this._z=u,this._order=d,this.onChangeCallback(this),this},copy:function(h){return this.set(h.x,h.y,h.z,h.order)},setFromQuaternion:function(h,l,u){return l===void 0&&(l=this._order),u===void 0&&(u=!1),o.fromQuat(h),this.setFromRotationMatrix(o,l,u)},setFromRotationMatrix:function(h,l,u){l===void 0&&(l=this._order),u===void 0&&(u=!1);var d=h.val,p=d[0],g=d[4],c=d[8],f=d[1],m=d[5],v=d[9],E=d[2],x=d[6],T=d[10],A=0,P=0,R=0,S=.99999;switch(l){case"XYZ":{P=Math.asin(i(c,-1,1)),Math.abs(c)<S?(A=Math.atan2(-v,T),R=Math.atan2(-g,p)):A=Math.atan2(x,m);break}case"YXZ":{A=Math.asin(-i(v,-1,1)),Math.abs(v)<S?(P=Math.atan2(c,T),R=Math.atan2(f,m)):P=Math.atan2(-E,p);break}case"ZXY":{A=Math.asin(i(x,-1,1)),Math.abs(x)<S?(P=Math.atan2(-E,T),R=Math.atan2(-g,m)):R=Math.atan2(f,p);break}case"ZYX":{P=Math.asin(-i(E,-1,1)),Math.abs(E)<S?(A=Math.atan2(x,T),R=Math.atan2(f,p)):R=Math.atan2(-g,m);break}case"YZX":{R=Math.asin(i(f,-1,1)),Math.abs(f)<S?(A=Math.atan2(-v,m),P=Math.atan2(-E,p)):P=Math.atan2(c,T);break}case"XZY":{R=Math.asin(-i(g,-1,1)),Math.abs(g)<S?(A=Math.atan2(x,m),P=Math.atan2(c,p)):A=Math.atan2(-v,T);break}}return this._x=A,this._y=P,this._z=R,this._order=l,u&&this.onChangeCallback(this),this}});a.RotationOrders=["XYZ","YXZ","ZXY","ZYX","YZX","XZY"],a.DefaultOrder="XYZ",t.exports=a}),fE=y((e,t)=>{var i=function(s,n,r){n===void 0&&(n=0),r===void 0&&(r=10);var o=Math.pow(r,-n);return Math.floor(s*o)/o};t.exports=i}),mE=y((e,t)=>{var i=function(s,n){return s/n/1e3};t.exports=i}),vE=y((e,t)=>{var i=function(s){return s==parseFloat(s)?!(s%2):void 0};t.exports=i}),EE=y((e,t)=>{var i=function(s){return s===parseFloat(s)?!(s%2):void 0};t.exports=i}),yE=y((e,t)=>{var i=function(s,n,r){return r===void 0&&(r=0),s.clone().lerp(n,r)};t.exports=i}),TE=y((e,t)=>{var i=function(s,n,r){return Math.min(s+n,r)};t.exports=i}),xE=y((e,t)=>{var i=function(s){var n=s.length;if(n===0)return 0;s.sort(function(o,a){return o-a});var r=Math.floor(n/2);return n%2===0?(s[r]+s[r-1])/2:s[r]};t.exports=i}),SE=y((e,t)=>{var i=function(s,n,r){return Math.max(s-n,r)};t.exports=i}),AE=y((e,t)=>{var i=function(s,n,r,o){r===void 0&&(r=n+1);var a=(s-n)/(r-n);return a>1?o!==void 0?(a=(o-s)/(o-r),a<0&&(a=0)):a=1:a<0&&(a=0),a};t.exports=i}),Bl=y((e,t)=>{var i=Gt(),s=function(n){return n*i.RAD_TO_DEG};t.exports=s}),wE=y((e,t)=>{var i=function(s,n){n===void 0&&(n=1);var r=Math.random()*2*Math.PI;return s.x=Math.cos(r)*n,s.y=Math.sin(r)*n,s};t.exports=i}),CE=y((e,t)=>{var i=function(s,n){n===void 0&&(n=1);var r=Math.random()*2*Math.PI,o=Math.random()*2-1,a=Math.sqrt(1-o*o)*n;return s.x=Math.cos(r)*a,s.y=Math.sin(r)*a,s.z=o*n,s};t.exports=i}),PE=y((e,t)=>{var i=function(s,n){return n===void 0&&(n=1),s.x=(Math.random()*2-1)*n,s.y=(Math.random()*2-1)*n,s.z=(Math.random()*2-1)*n,s.w=(Math.random()*2-1)*n,s};t.exports=i}),RE=y((e,t)=>{var i=function(s,n){var r=s.x,o=s.y;return s.x=r*Math.cos(n)-o*Math.sin(n),s.y=r*Math.sin(n)+o*Math.cos(n),s};t.exports=i}),bE=y((e,t)=>{var i=function(s,n,r,o,a){return s.x=n+a*Math.cos(o),s.y=r+a*Math.sin(o),s};t.exports=i}),IE=y((e,t)=>{var i=function(s,n,r){n===void 0&&(n=0),r===void 0&&(r=10);var o=Math.pow(r,-n);return Math.round(s*o)/o};t.exports=i}),_E=y((e,t)=>{var i=function(s,n,r,o){n===void 0&&(n=1),r===void 0&&(r=1),o===void 0&&(o=1),o*=Math.PI/s;for(var a=[],h=[],l=0;l<s;l++)r-=n*o,n+=r*o,a[l]=r,h[l]=n;return{sin:h,cos:a,length:s}};t.exports=i}),OE=y((e,t)=>{var i=xt(),s=function(n,r,o,a){a===void 0&&(a=new i);var h=0,l=0,u=r*o;return n>0&&n<=u&&(n>r-1?(l=Math.floor(n/r),h=n-l*r):h=n),a.set(h,l)};t.exports=s}),ME=y((e,t)=>{var i=function(s,n,r){return Math.abs(s-n)<=r};t.exports=i}),LE=y((e,t)=>{var i=W(),s=new i({initialize:function(n,r,o,a){this.x=0,this.y=0,this.z=0,this.w=0,typeof n=="object"?(this.x=n.x||0,this.y=n.y||0,this.z=n.z||0,this.w=n.w||0):(this.x=n||0,this.y=r||0,this.z=o||0,this.w=a||0)},clone:function(){return new s(this.x,this.y,this.z,this.w)},copy:function(n){return this.x=n.x,this.y=n.y,this.z=n.z||0,this.w=n.w||0,this},equals:function(n){return this.x===n.x&&this.y===n.y&&this.z===n.z&&this.w===n.w},set:function(n,r,o,a){return typeof n=="object"?(this.x=n.x||0,this.y=n.y||0,this.z=n.z||0,this.w=n.w||0):(this.x=n||0,this.y=r||0,this.z=o||0,this.w=a||0),this},add:function(n){return this.x+=n.x,this.y+=n.y,this.z+=n.z||0,this.w+=n.w||0,this},subtract:function(n){return this.x-=n.x,this.y-=n.y,this.z-=n.z||0,this.w-=n.w||0,this},scale:function(n){return this.x*=n,this.y*=n,this.z*=n,this.w*=n,this},length:function(){var n=this.x,r=this.y,o=this.z,a=this.w;return Math.sqrt(n*n+r*r+o*o+a*a)},lengthSq:function(){var n=this.x,r=this.y,o=this.z,a=this.w;return n*n+r*r+o*o+a*a},normalize:function(){var n=this.x,r=this.y,o=this.z,a=this.w,h=n*n+r*r+o*o+a*a;return h>0&&(h=1/Math.sqrt(h),this.x=n*h,this.y=r*h,this.z=o*h,this.w=a*h),this},dot:function(n){return this.x*n.x+this.y*n.y+this.z*n.z+this.w*n.w},lerp:function(n,r){r===void 0&&(r=0);var o=this.x,a=this.y,h=this.z,l=this.w;return this.x=o+r*(n.x-o),this.y=a+r*(n.y-a),this.z=h+r*(n.z-h),this.w=l+r*(n.w-l),this},multiply:function(n){return this.x*=n.x,this.y*=n.y,this.z*=n.z||1,this.w*=n.w||1,this},divide:function(n){return this.x/=n.x,this.y/=n.y,this.z/=n.z||1,this.w/=n.w||1,this},distance:function(n){var r=n.x-this.x,o=n.y-this.y,a=n.z-this.z||0,h=n.w-this.w||0;return Math.sqrt(r*r+o*o+a*a+h*h)},distanceSq:function(n){var r=n.x-this.x,o=n.y-this.y,a=n.z-this.z||0,h=n.w-this.w||0;return r*r+o*o+a*a+h*h},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},transformMat4:function(n){var r=this.x,o=this.y,a=this.z,h=this.w,l=n.val;return this.x=l[0]*r+l[4]*o+l[8]*a+l[12]*h,this.y=l[1]*r+l[5]*o+l[9]*a+l[13]*h,this.z=l[2]*r+l[6]*o+l[10]*a+l[14]*h,this.w=l[3]*r+l[7]*o+l[11]*a+l[15]*h,this},transformQuat:function(n){var r=this.x,o=this.y,a=this.z,h=n.x,l=n.y,u=n.z,d=n.w,p=d*r+l*a-u*o,g=d*o+u*r-h*a,c=d*a+h*o-l*r,f=-h*r-l*o-u*a;return this.x=p*d+f*-h+g*-u-c*-l,this.y=g*d+f*-l+c*-h-p*-u,this.z=c*d+f*-u+p*-l-g*-h,this},reset:function(){return this.x=0,this.y=0,this.z=0,this.w=0,this}});s.prototype.sub=s.prototype.subtract,s.prototype.mul=s.prototype.multiply,s.prototype.div=s.prototype.divide,s.prototype.dist=s.prototype.distance,s.prototype.distSq=s.prototype.distanceSq,s.prototype.len=s.prototype.length,s.prototype.lenSq=s.prototype.lengthSq,t.exports=s}),Ul=y((e,t)=>{var i=W(),s=new i({initialize:function(n){this.val=new Float32Array(9),n?this.copy(n):this.identity()},clone:function(){return new s(this)},set:function(n){return this.copy(n)},copy:function(n){var r=this.val,o=n.val;return r[0]=o[0],r[1]=o[1],r[2]=o[2],r[3]=o[3],r[4]=o[4],r[5]=o[5],r[6]=o[6],r[7]=o[7],r[8]=o[8],this},fromMat4:function(n){var r=n.val,o=this.val;return o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[4],o[4]=r[5],o[5]=r[6],o[6]=r[8],o[7]=r[9],o[8]=r[10],this},fromArray:function(n){var r=this.val;return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],this},identity:function(){var n=this.val;return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=1,n[5]=0,n[6]=0,n[7]=0,n[8]=1,this},transpose:function(){var n=this.val,r=n[1],o=n[2],a=n[5];return n[1]=n[3],n[2]=n[6],n[3]=r,n[5]=n[7],n[6]=o,n[7]=a,this},invert:function(){var n=this.val,r=n[0],o=n[1],a=n[2],h=n[3],l=n[4],u=n[5],d=n[6],p=n[7],g=n[8],c=g*l-u*p,f=-g*h+u*d,m=p*h-l*d,v=r*c+o*f+a*m;return v?(v=1/v,n[0]=c*v,n[1]=(-g*o+a*p)*v,n[2]=(u*o-a*l)*v,n[3]=f*v,n[4]=(g*r-a*d)*v,n[5]=(-u*r+a*h)*v,n[6]=m*v,n[7]=(-p*r+o*d)*v,n[8]=(l*r-o*h)*v,this):null},adjoint:function(){var n=this.val,r=n[0],o=n[1],a=n[2],h=n[3],l=n[4],u=n[5],d=n[6],p=n[7],g=n[8];return n[0]=l*g-u*p,n[1]=a*p-o*g,n[2]=o*u-a*l,n[3]=u*d-h*g,n[4]=r*g-a*d,n[5]=a*h-r*u,n[6]=h*p-l*d,n[7]=o*d-r*p,n[8]=r*l-o*h,this},determinant:function(){var n=this.val,r=n[0],o=n[1],a=n[2],h=n[3],l=n[4],u=n[5],d=n[6],p=n[7],g=n[8];return r*(g*l-u*p)+o*(-g*h+u*d)+a*(p*h-l*d)},multiply:function(n){var r=this.val,o=r[0],a=r[1],h=r[2],l=r[3],u=r[4],d=r[5],p=r[6],g=r[7],c=r[8],f=n.val,m=f[0],v=f[1],E=f[2],x=f[3],T=f[4],A=f[5],P=f[6],R=f[7],S=f[8];return r[0]=m*o+v*l+E*p,r[1]=m*a+v*u+E*g,r[2]=m*h+v*d+E*c,r[3]=x*o+T*l+A*p,r[4]=x*a+T*u+A*g,r[5]=x*h+T*d+A*c,r[6]=P*o+R*l+S*p,r[7]=P*a+R*u+S*g,r[8]=P*h+R*d+S*c,this},translate:function(n){var r=this.val,o=n.x,a=n.y;return r[6]=o*r[0]+a*r[3]+r[6],r[7]=o*r[1]+a*r[4]+r[7],r[8]=o*r[2]+a*r[5]+r[8],this},rotate:function(n){var r=this.val,o=r[0],a=r[1],h=r[2],l=r[3],u=r[4],d=r[5],p=Math.sin(n),g=Math.cos(n);return r[0]=g*o+p*l,r[1]=g*a+p*u,r[2]=g*h+p*d,r[3]=g*l-p*o,r[4]=g*u-p*a,r[5]=g*d-p*h,this},scale:function(n){var r=this.val,o=n.x,a=n.y;return r[0]=o*r[0],r[1]=o*r[1],r[2]=o*r[2],r[3]=a*r[3],r[4]=a*r[4],r[5]=a*r[5],this},fromQuat:function(n){var r=n.x,o=n.y,a=n.z,h=n.w,l=r+r,u=o+o,d=a+a,p=r*l,g=r*u,c=r*d,f=o*u,m=o*d,v=a*d,E=h*l,x=h*u,T=h*d,A=this.val;return A[0]=1-(f+v),A[3]=g+T,A[6]=c-x,A[1]=g-T,A[4]=1-(p+v),A[7]=m+E,A[2]=c+x,A[5]=m-E,A[8]=1-(p+f),this},normalFromMat4:function(n){var r=n.val,o=this.val,a=r[0],h=r[1],l=r[2],u=r[3],d=r[4],p=r[5],g=r[6],c=r[7],f=r[8],m=r[9],v=r[10],E=r[11],x=r[12],T=r[13],A=r[14],P=r[15],R=a*p-h*d,S=a*g-l*d,I=a*c-u*d,w=h*g-l*p,C=h*c-u*p,_=l*c-u*g,O=f*T-m*x,D=f*A-v*x,F=f*P-E*x,N=m*A-v*T,Y=m*P-E*T,L=v*P-E*A,b=R*L-S*Y+I*N+w*F-C*D+_*O;return b?(b=1/b,o[0]=(p*L-g*Y+c*N)*b,o[1]=(g*F-d*L-c*D)*b,o[2]=(d*Y-p*F+c*O)*b,o[3]=(l*Y-h*L-u*N)*b,o[4]=(a*L-l*F+u*D)*b,o[5]=(h*F-a*Y-u*O)*b,o[6]=(T*_-A*C+P*w)*b,o[7]=(A*I-x*_-P*S)*b,o[8]=(x*C-T*I+P*R)*b,this):null}});t.exports=s}),Gl=y((e,t)=>{var i=W(),s=Ul(),n=Rt(),r=Ms(),o=1e-6,a=new Int8Array([1,2,0]),h=new Float32Array([0,0,0]),l=new r(1,0,0),u=new r(0,1,0),d=new r,p=new s,g=new i({initialize:function(c,f,m,v){this.onChangeCallback=n,this.set(c,f,m,v)},x:{get:function(){return this._x},set:function(c){this._x=c,this.onChangeCallback(this)}},y:{get:function(){return this._y},set:function(c){this._y=c,this.onChangeCallback(this)}},z:{get:function(){return this._z},set:function(c){this._z=c,this.onChangeCallback(this)}},w:{get:function(){return this._w},set:function(c){this._w=c,this.onChangeCallback(this)}},copy:function(c){return this.set(c)},set:function(c,f,m,v,E){return E===void 0&&(E=!0),typeof c=="object"?(this._x=c.x||0,this._y=c.y||0,this._z=c.z||0,this._w=c.w||0):(this._x=c||0,this._y=f||0,this._z=m||0,this._w=v||0),E&&this.onChangeCallback(this),this},add:function(c){return this._x+=c.x,this._y+=c.y,this._z+=c.z,this._w+=c.w,this.onChangeCallback(this),this},subtract:function(c){return this._x-=c.x,this._y-=c.y,this._z-=c.z,this._w-=c.w,this.onChangeCallback(this),this},scale:function(c){return this._x*=c,this._y*=c,this._z*=c,this._w*=c,this.onChangeCallback(this),this},length:function(){var c=this.x,f=this.y,m=this.z,v=this.w;return Math.sqrt(c*c+f*f+m*m+v*v)},lengthSq:function(){var c=this.x,f=this.y,m=this.z,v=this.w;return c*c+f*f+m*m+v*v},normalize:function(){var c=this.x,f=this.y,m=this.z,v=this.w,E=c*c+f*f+m*m+v*v;return E>0&&(E=1/Math.sqrt(E),this._x=c*E,this._y=f*E,this._z=m*E,this._w=v*E),this.onChangeCallback(this),this},dot:function(c){return this.x*c.x+this.y*c.y+this.z*c.z+this.w*c.w},lerp:function(c,f){f===void 0&&(f=0);var m=this.x,v=this.y,E=this.z,x=this.w;return this.set(m+f*(c.x-m),v+f*(c.y-v),E+f*(c.z-E),x+f*(c.w-x))},rotationTo:function(c,f){var m=c.x*f.x+c.y*f.y+c.z*f.z;return m<-.999999?(d.copy(l).cross(c).length()<o&&d.copy(u).cross(c),d.normalize(),this.setAxisAngle(d,Math.PI)):m>.999999?this.set(0,0,0,1):(d.copy(c).cross(f),this._x=d.x,this._y=d.y,this._z=d.z,this._w=1+m,this.normalize())},setAxes:function(c,f,m){var v=p.val;return v[0]=f.x,v[3]=f.y,v[6]=f.z,v[1]=m.x,v[4]=m.y,v[7]=m.z,v[2]=-c.x,v[5]=-c.y,v[8]=-c.z,this.fromMat3(p).normalize()},identity:function(){return this.set(0,0,0,1)},setAxisAngle:function(c,f){f=f*.5;var m=Math.sin(f);return this.set(m*c.x,m*c.y,m*c.z,Math.cos(f))},multiply:function(c){var f=this.x,m=this.y,v=this.z,E=this.w,x=c.x,T=c.y,A=c.z,P=c.w;return this.set(f*P+E*x+m*A-v*T,m*P+E*T+v*x-f*A,v*P+E*A+f*T-m*x,E*P-f*x-m*T-v*A)},slerp:function(c,f){var m=this.x,v=this.y,E=this.z,x=this.w,T=c.x,A=c.y,P=c.z,R=c.w,S=m*T+v*A+E*P+x*R;S<0&&(S=-S,T=-T,A=-A,P=-P,R=-R);var I=1-f,w=f;if(1-S>o){var C=Math.acos(S),_=Math.sin(C);I=Math.sin((1-f)*C)/_,w=Math.sin(f*C)/_}return this.set(I*m+w*T,I*v+w*A,I*E+w*P,I*x+w*R)},invert:function(){var c=this.x,f=this.y,m=this.z,v=this.w,E=c*c+f*f+m*m+v*v,x=E?1/E:0;return this.set(-c*x,-f*x,-m*x,v*x)},conjugate:function(){return this._x=-this.x,this._y=-this.y,this._z=-this.z,this.onChangeCallback(this),this},rotateX:function(c){c*=.5;var f=this.x,m=this.y,v=this.z,E=this.w,x=Math.sin(c),T=Math.cos(c);return this.set(f*T+E*x,m*T+v*x,v*T-m*x,E*T-f*x)},rotateY:function(c){c*=.5;var f=this.x,m=this.y,v=this.z,E=this.w,x=Math.sin(c),T=Math.cos(c);return this.set(f*T-v*x,m*T+E*x,v*T+f*x,E*T-m*x)},rotateZ:function(c){c*=.5;var f=this.x,m=this.y,v=this.z,E=this.w,x=Math.sin(c),T=Math.cos(c);return this.set(f*T+m*x,m*T-f*x,v*T+E*x,E*T-v*x)},calculateW:function(){var c=this.x,f=this.y,m=this.z;return this.w=-Math.sqrt(1-c*c-f*f-m*m),this},setFromEuler:function(c,f){var m=c.x/2,v=c.y/2,E=c.z/2,x=Math.cos(m),T=Math.cos(v),A=Math.cos(E),P=Math.sin(m),R=Math.sin(v),S=Math.sin(E);switch(c.order){case"XYZ":{this.set(P*T*A+x*R*S,x*R*A-P*T*S,x*T*S+P*R*A,x*T*A-P*R*S,f);break}case"YXZ":{this.set(P*T*A+x*R*S,x*R*A-P*T*S,x*T*S-P*R*A,x*T*A+P*R*S,f);break}case"ZXY":{this.set(P*T*A-x*R*S,x*R*A+P*T*S,x*T*S+P*R*A,x*T*A-P*R*S,f);break}case"ZYX":{this.set(P*T*A-x*R*S,x*R*A+P*T*S,x*T*S-P*R*A,x*T*A+P*R*S,f);break}case"YZX":{this.set(P*T*A+x*R*S,x*R*A+P*T*S,x*T*S-P*R*A,x*T*A-P*R*S,f);break}case"XZY":{this.set(P*T*A-x*R*S,x*R*A-P*T*S,x*T*S+P*R*A,x*T*A+P*R*S,f);break}}return this},setFromRotationMatrix:function(c){var f=c.val,m=f[0],v=f[4],E=f[8],x=f[1],T=f[5],A=f[9],P=f[2],R=f[6],S=f[10],I=m+T+S,w;return I>0?(w=.5/Math.sqrt(I+1),this.set((R-A)*w,(E-P)*w,(x-v)*w,.25/w)):m>T&&m>S?(w=2*Math.sqrt(1+m-T-S),this.set(.25*w,(v+x)/w,(E+P)/w,(R-A)/w)):T>S?(w=2*Math.sqrt(1+T-m-S),this.set((v+x)/w,.25*w,(A+R)/w,(E-P)/w)):(w=2*Math.sqrt(1+S-m-T),this.set((E+P)/w,(A+R)/w,.25*w,(x-v)/w)),this},fromMat3:function(c){var f=c.val,m=f[0]+f[4]+f[8],v;if(m>0)v=Math.sqrt(m+1),this.w=.5*v,v=.5/v,this._x=(f[7]-f[5])*v,this._y=(f[2]-f[6])*v,this._z=(f[3]-f[1])*v;else{var E=0;f[4]>f[0]&&(E=1),f[8]>f[E*3+E]&&(E=2);var x=a[E],T=a[x];v=Math.sqrt(f[E*3+E]-f[x*3+x]-f[T*3+T]+1),h[E]=.5*v,v=.5/v,h[x]=(f[x*3+E]+f[E*3+x])*v,h[T]=(f[T*3+E]+f[E*3+T])*v,this._x=h[0],this._y=h[1],this._z=h[2],this._w=(f[T*3+x]-f[x*3+T])*v}return this.onChangeCallback(this),this}});t.exports=g}),DE=y((e,t)=>{var i=Ms(),s=Ls(),n=Gl(),r=new s,o=new n,a=new i,h=function(l,u,d){return o.setAxisAngle(u,d),r.fromRotationTranslation(o,a.set(0,0,0)),l.transformMat4(r)};t.exports=h}),pa=y((e,t)=>{var i=Gt(),s=Qt(),n={Angle:Vv(),Distance:Jv(),Easing:Qv(),Fuzzy:sE(),Interpolation:rE(),Pow2:hE(),Snap:lE(),RandomDataGenerator:uE(),Average:cE(),Bernstein:Il(),Between:ys(),CatmullRom:da(),CeilTo:dE(),Clamp:Ot(),DegToRad:Gi(),Difference:pE(),Euler:gE(),Factorial:bl(),FloatBetween:_s(),FloorTo:fE(),FromPercent:ws(),GetSpeed:mE(),IsEven:vE(),IsEvenStrict:EE(),Linear:ca(),LinearXY:yE(),MaxAdd:TE(),Median:xE(),MinSub:SE(),Percent:AE(),RadToDeg:Bl(),RandomXY:wE(),RandomXYZ:CE(),RandomXYZW:PE(),Rotate:RE(),RotateAround:ia(),RotateAroundDistance:aa(),RotateTo:bE(),RoundAwayFromZero:zh(),RoundTo:IE(),SinCosTableGenerator:_E(),SmootherStep:oa(),SmoothStep:ha(),ToXY:OE(),TransformXY:na(),Within:ME(),Wrap:Ai(),Vector2:xt(),Vector3:Ms(),Vector4:LE(),Matrix3:Ul(),Matrix4:Ls(),Quaternion:Gl(),RotateVec3:DE()};n=s(!1,n,i),t.exports=n}),Fn=y((e,t)=>{var i={BITMAPMASK_PIPELINE:"BitmapMaskPipeline",LIGHT_PIPELINE:"Light2D",POINTLIGHT_PIPELINE:"PointLightPipeline",SINGLE_PIPELINE:"SinglePipeline",MULTI_PIPELINE:"MultiPipeline",ROPE_PIPELINE:"RopePipeline",GRAPHICS_PIPELINE:"GraphicsPipeline",POSTFX_PIPELINE:"PostFXPipeline",UTILITY_PIPELINE:"UtilityPipeline",MOBILE_PIPELINE:"MobilePipeline",FX_PIPELINE:"FxPipeline"};t.exports=i}),Yl=y((e,t)=>{var i=W(),s=Pe(),n=Cl(),r=An(),o=dt(),a=St(),h=ce(),l=Rt(),u=pa(),d=Fn(),p=Al(),g=new i({initialize:function(c){c===void 0&&(c={});var f=["#ff0000","#ffff00","#00ff00","#00ffff","#000000"],m="#ffffff",v=a(c,"scale",null);this.width=a(v,"width",1024,c),this.height=a(v,"height",768,c),this.zoom=a(v,"zoom",1,c),this.parent=a(v,"parent",void 0,c),this.scaleMode=a(v,v?"mode":"scaleMode",0,c),this.expandParent=a(v,"expandParent",!0,c),this.autoRound=a(v,"autoRound",!1,c),this.autoCenter=a(v,"autoCenter",0,c),this.resizeInterval=a(v,"resizeInterval",500,c),this.fullscreenTarget=a(v,"fullscreenTarget",null,c),this.minWidth=a(v,"min.width",0,c),this.maxWidth=a(v,"max.width",0,c),this.minHeight=a(v,"min.height",0,c),this.maxHeight=a(v,"max.height",0,c),this.snapWidth=a(v,"snap.width",0,c),this.snapHeight=a(v,"snap.height",0,c),this.renderType=a(c,"type",s.AUTO),this.canvas=a(c,"canvas",null),this.context=a(c,"context",null),this.canvasStyle=a(c,"canvasStyle",null),this.customEnvironment=a(c,"customEnvironment",!1),this.sceneConfig=a(c,"scene",null),this.seed=a(c,"seed",[(Date.now()*Math.random()).toString()]),u.RND=new u.RandomDataGenerator(this.seed),this.gameTitle=a(c,"title",""),this.gameURL=a(c,"url","https://phaser.io/"+s.LOG_VERSION),this.gameVersion=a(c,"version",""),this.autoFocus=a(c,"autoFocus",!0),this.stableSort=a(c,"stableSort",-1),this.stableSort===-1&&(this.stableSort=r.browser.es2019?1:0),r.features.stableSort=this.stableSort,this.domCreateContainer=a(c,"dom.createContainer",!1),this.domPointerEvents=a(c,"dom.pointerEvents","none"),this.inputKeyboard=a(c,"input.keyboard",!0),this.inputKeyboardEventTarget=a(c,"input.keyboard.target",window),this.inputKeyboardCapture=a(c,"input.keyboard.capture",[]),this.inputMouse=a(c,"input.mouse",!0),this.inputMouseEventTarget=a(c,"input.mouse.target",null),this.inputMousePreventDefaultDown=a(c,"input.mouse.preventDefaultDown",!0),this.inputMousePreventDefaultUp=a(c,"input.mouse.preventDefaultUp",!0),this.inputMousePreventDefaultMove=a(c,"input.mouse.preventDefaultMove",!0),this.inputMousePreventDefaultWheel=a(c,"input.mouse.preventDefaultWheel",!0),this.inputTouch=a(c,"input.touch",r.input.touch),this.inputTouchEventTarget=a(c,"input.touch.target",null),this.inputTouchCapture=a(c,"input.touch.capture",!0),this.inputActivePointers=a(c,"input.activePointers",1),this.inputSmoothFactor=a(c,"input.smoothFactor",0),this.inputWindowEvents=a(c,"input.windowEvents",!0),this.inputGamepad=a(c,"input.gamepad",!1),this.inputGamepadEventTarget=a(c,"input.gamepad.target",window),this.disableContextMenu=a(c,"disableContextMenu",!1),this.audio=a(c,"audio",{}),this.hideBanner=a(c,"banner",null)===!1,this.hidePhaser=a(c,"banner.hidePhaser",!1),this.bannerTextColor=a(c,"banner.text",m),this.bannerBackgroundColor=a(c,"banner.background",f),this.gameTitle===""&&this.hidePhaser&&(this.hideBanner=!0),this.fps=a(c,"fps",null),this.disablePreFX=a(c,"disablePreFX",!1),this.disablePostFX=a(c,"disablePostFX",!1);var E=a(c,"render",null);this.pipeline=a(E,"pipeline",null,c),this.autoMobilePipeline=a(E,"autoMobilePipeline",!0,c),this.defaultPipeline=a(E,"defaultPipeline",d.MULTI_PIPELINE,c),this.antialias=a(E,"antialias",!0,c),this.antialiasGL=a(E,"antialiasGL",!0,c),this.mipmapFilter=a(E,"mipmapFilter","",c),this.desynchronized=a(E,"desynchronized",!1,c),this.roundPixels=a(E,"roundPixels",!1,c),this.pixelArt=a(E,"pixelArt",this.zoom!==1,c),this.pixelArt&&(this.antialias=!1,this.antialiasGL=!1,this.roundPixels=!0),this.transparent=a(E,"transparent",!1,c),this.clearBeforeRender=a(E,"clearBeforeRender",!0,c),this.preserveDrawingBuffer=a(E,"preserveDrawingBuffer",!1,c),this.premultipliedAlpha=a(E,"premultipliedAlpha",!0,c),this.failIfMajorPerformanceCaveat=a(E,"failIfMajorPerformanceCaveat",!1,c),this.powerPreference=a(E,"powerPreference","default",c),this.batchSize=a(E,"batchSize",4096,c),this.maxTextures=a(E,"maxTextures",-1,c),this.maxLights=a(E,"maxLights",10,c);var x=a(c,"backgroundColor",0);this.backgroundColor=p(x),this.transparent&&(this.backgroundColor=p(0),this.backgroundColor.alpha=0),this.preBoot=a(c,"callbacks.preBoot",l),this.postBoot=a(c,"callbacks.postBoot",l),this.physics=a(c,"physics",{}),this.defaultPhysicsSystem=a(this.physics,"default",!1),this.loaderBaseURL=a(c,"loader.baseURL",""),this.loaderPath=a(c,"loader.path",""),this.loaderMaxParallelDownloads=a(c,"loader.maxParallelDownloads",r.os.android?6:32),this.loaderCrossOrigin=a(c,"loader.crossOrigin",void 0),this.loaderResponseType=a(c,"loader.responseType",""),this.loaderAsync=a(c,"loader.async",!0),this.loaderUser=a(c,"loader.user",""),this.loaderPassword=a(c,"loader.password",""),this.loaderTimeout=a(c,"loader.timeout",0),this.loaderMaxRetries=a(c,"loader.maxRetries",2),this.loaderWithCredentials=a(c,"loader.withCredentials",!1),this.loaderImageLoadType=a(c,"loader.imageLoadType","XHR"),this.loaderLocalScheme=a(c,"loader.localScheme",["file://","capacitor://"]),this.glowFXQuality=a(c,"fx.glow.quality",.1),this.glowFXDistance=a(c,"fx.glow.distance",10),this.installGlobalPlugins=[],this.installScenePlugins=[];var T=a(c,"plugins",null),A=n.DefaultScene;T&&(Array.isArray(T)?this.defaultPlugins=T:h(T)&&(this.installGlobalPlugins=o(T,"global",[]),this.installScenePlugins=o(T,"scene",[]),Array.isArray(T.default)?A=T.default:Array.isArray(T.defaultMerge)&&(A=A.concat(T.defaultMerge)))),this.defaultPlugins=A;var P="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAg";this.defaultImage=a(c,"images.default",P+"AQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAABVJREFUeF7NwIEAAAAAgKD9qdeocAMAoAABm3DkcAAAAABJRU5ErkJggg=="),this.missingImage=a(c,"images.missing",P+"CAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg=="),this.whiteImage=a(c,"images.white","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAIAAAAmkwkpAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABdJREFUeNpi/P//PwMMMDEgAdwcgAADAJZuAwXJYZOzAAAAAElFTkSuQmCC"),window&&(window.FORCE_WEBGL?this.renderType=s.WEBGL:window.FORCE_CANVAS&&(this.renderType=s.CANVAS))}});t.exports=g}),kE=y((e,t)=>{var i={setCrisp:function(s){var n=["optimizeSpeed","-moz-crisp-edges","-o-crisp-edges","-webkit-optimize-contrast","optimize-contrast","crisp-edges","pixelated"];return n.forEach(function(r){s.style["image-rendering"]=r}),s.style.msInterpolationMode="nearest-neighbor",s},setBicubic:function(s){return s.style["image-rendering"]="auto",s.style.msInterpolationMode="bicubic",s}};t.exports=i}),Hl=y((e,t)=>{var i=xe(),s=di(),n=dt(),r=function(o,a){var h=n(a,"callback"),l=n(a,"type","image/png"),u=n(a,"encoder",.92),d=Math.abs(Math.round(n(a,"x",0))),p=Math.abs(Math.round(n(a,"y",0))),g=Math.floor(n(a,"width",o.width)),c=Math.floor(n(a,"height",o.height)),f=n(a,"getPixel",!1);if(f){var m=o.getContext("2d",{willReadFrequently:!1}),v=m.getImageData(d,p,1,1),E=v.data;h.call(null,new s(E[0],E[1],E[2],E[3]))}else if(d!==0||p!==0||g!==o.width||c!==o.height){var x=i.createWebGL(this,g,c),T=x.getContext("2d",{willReadFrequently:!0});g>0&&c>0&&T.drawImage(o,d,p,g,c,0,0,g,c);var A=new Image;A.onerror=function(){h.call(null),i.remove(x)},A.onload=function(){h.call(null,A),i.remove(x)},A.src=x.toDataURL(l,u)}else{var P=new Image;P.onerror=function(){h.call(null)},P.onload=function(){h.call(null,P)},P.src=o.toDataURL(l,u)}};t.exports=r}),FE=y((e,t)=>{t.exports="losewebgl"}),NE=y((e,t)=>{t.exports="postrender"}),BE=y((e,t)=>{t.exports="prerender"}),UE=y((e,t)=>{t.exports="render"}),GE=y((e,t)=>{t.exports="resize"}),YE=y((e,t)=>{t.exports="restorewebgl"}),Ds=y((e,t)=>{t.exports={LOSE_WEBGL:FE(),POST_RENDER:NE(),PRE_RENDER:BE(),RENDER:UE(),RESIZE:GE(),RESTORE_WEBGL:YE()}}),HE=y((e,t)=>{var i=Ge(),s=Vh(),n=function(){var r=[],o=s.supportNewBlendModes,a="source-over";return r[i.NORMAL]=a,r[i.ADD]="lighter",r[i.MULTIPLY]=o?"multiply":a,r[i.SCREEN]=o?"screen":a,r[i.OVERLAY]=o?"overlay":a,r[i.DARKEN]=o?"darken":a,r[i.LIGHTEN]=o?"lighten":a,r[i.COLOR_DODGE]=o?"color-dodge":a,r[i.COLOR_BURN]=o?"color-burn":a,r[i.HARD_LIGHT]=o?"hard-light":a,r[i.SOFT_LIGHT]=o?"soft-light":a,r[i.DIFFERENCE]=o?"difference":a,r[i.EXCLUSION]=o?"exclusion":a,r[i.HUE]=o?"hue":a,r[i.SATURATION]=o?"saturation":a,r[i.COLOR]=o?"color":a,r[i.LUMINOSITY]=o?"luminosity":a,r[i.ERASE]="destination-out",r[i.SOURCE_IN]="source-in",r[i.SOURCE_OUT]="source-out",r[i.SOURCE_ATOP]="source-atop",r[i.DESTINATION_OVER]="destination-over",r[i.DESTINATION_IN]="destination-in",r[i.DESTINATION_OUT]="destination-out",r[i.DESTINATION_ATOP]="destination-atop",r[i.LIGHTER]="lighter",r[i.COPY]="copy",r[i.XOR]="xor",r};t.exports=n}),zE=y((e,t)=>{t.exports="addtexture"}),WE=y((e,t)=>{t.exports="addtexture-"}),VE=y((e,t)=>{t.exports="onerror"}),XE=y((e,t)=>{t.exports="onload"}),KE=y((e,t)=>{t.exports="ready"}),jE=y((e,t)=>{t.exports="removetexture"}),ZE=y((e,t)=>{t.exports="removetexture-"}),ks=y((e,t)=>{t.exports={ADD:zE(),ADD_KEY:WE(),ERROR:VE(),LOAD:XE(),READY:KE(),REMOVE:jE(),REMOVE_KEY:ZE()}}),qE=y((e,t)=>{var i=Ie(),s=Hl(),n=W(),r=Pe(),o=Ct(),a=Ds(),h=HE(),l=Is(),u=ks(),d=$t(),p=Re(),g=new n({Extends:o,initialize:function(c){o.call(this);var f=c.config;this.config={clearBeforeRender:f.clearBeforeRender,backgroundColor:f.backgroundColor,antialias:f.antialias,roundPixels:f.roundPixels,transparent:f.transparent},this.game=c,this.type=r.CANVAS,this.drawCount=0,this.width=0,this.height=0,this.gameCanvas=c.canvas;var m={alpha:f.transparent,desynchronized:f.desynchronized,willReadFrequently:!1};this.gameContext=f.context?f.context:this.gameCanvas.getContext("2d",m),this.currentContext=this.gameContext,this.antialias=f.antialias,this.blendModes=h(),this.snapshotState={x:0,y:0,width:1,height:1,getPixel:!1,callback:null,type:"image/png",encoder:.92},this._tempMatrix1=new p,this._tempMatrix2=new p,this._tempMatrix3=new p,this.isBooted=!1,this.init()},init:function(){var c=this.game;c.events.once(d.BOOT,function(){var f=this.config;if(!f.transparent){var m=this.gameContext,v=this.gameCanvas;m.fillStyle=f.backgroundColor.rgba,m.fillRect(0,0,v.width,v.height)}},this),c.textures.once(u.READY,this.boot,this)},boot:function(){var c=this.game,f=c.scale.baseSize;this.width=f.width,this.height=f.height,this.isBooted=!0,c.scale.on(l.RESIZE,this.onResize,this),this.resize(f.width,f.height)},onResize:function(c,f){(f.width!==this.width||f.height!==this.height)&&this.resize(f.width,f.height)},resize:function(c,f){this.width=c,this.height=f,this.emit(a.RESIZE,c,f)},resetTransform:function(){this.currentContext.setTransform(1,0,0,1,0,0)},setBlendMode:function(c){return this.currentContext.globalCompositeOperation=c,this},setContext:function(c){return this.currentContext=c||this.gameContext,this},setAlpha:function(c){return this.currentContext.globalAlpha=c,this},preRender:function(){var c=this.gameContext,f=this.config,m=this.width,v=this.height;c.globalAlpha=1,c.globalCompositeOperation="source-over",c.setTransform(1,0,0,1,0,0),this.emit(a.PRE_RENDER_CLEAR),f.clearBeforeRender&&(c.clearRect(0,0,m,v),f.transparent||(c.fillStyle=f.backgroundColor.rgba,c.fillRect(0,0,m,v))),c.save(),this.drawCount=0,this.emit(a.PRE_RENDER)},render:function(c,f,m){var v=f.length;this.emit(a.RENDER,c,m);var E=m.x,x=m.y,T=m.width,A=m.height,P=m.renderToTexture?m.context:c.sys.context;P.save(),this.game.scene.customViewports&&(P.beginPath(),P.rect(E,x,T,A),P.clip()),m.emit(i.PRE_RENDER,m),this.currentContext=P;var R=m.mask;R&&R.preRenderCanvas(this,null,m._maskCamera),m.transparent||(P.fillStyle=m.backgroundColor.rgba,P.fillRect(E,x,T,A)),P.globalAlpha=m.alpha,P.globalCompositeOperation="source-over",this.drawCount+=v,m.renderToTexture&&m.emit(i.PRE_RENDER,m),m.matrix.copyToContext(P);for(var S=0;S<v;S++){var I=f[S];I.mask&&I.mask.preRenderCanvas(this,I,m),I.renderCanvas(this,I,m),I.mask&&I.mask.postRenderCanvas(this,I,m)}P.setTransform(1,0,0,1,0,0),P.globalCompositeOperation="source-over",P.globalAlpha=1,m.flashEffect.postRenderCanvas(P),m.fadeEffect.postRenderCanvas(P),m.dirty=!1,R&&R.postRenderCanvas(this),P.restore(),m.renderToTexture&&(m.emit(i.POST_RENDER,m),m.renderToGame&&c.sys.context.drawImage(m.canvas,E,x)),m.emit(i.POST_RENDER,m)},postRender:function(){var c=this.gameContext;c.restore(),this.emit(a.POST_RENDER);var f=this.snapshotState;f.callback&&(s(this.gameCanvas,f),f.callback=null)},snapshotCanvas:function(c,f,m,v,E,x,T,A,P){m===void 0&&(m=!1),this.snapshotArea(v,E,x,T,f,A,P);var R=this.snapshotState;return R.getPixel=m,s(c,R),R.callback=null,this},snapshot:function(c,f,m){return this.snapshotArea(0,0,this.gameCanvas.width,this.gameCanvas.height,c,f,m)},snapshotArea:function(c,f,m,v,E,x,T){var A=this.snapshotState;return A.callback=E,A.type=x,A.encoder=T,A.getPixel=!1,A.x=c,A.y=f,A.width=Math.min(m,this.gameCanvas.width),A.height=Math.min(v,this.gameCanvas.height),this},snapshotPixel:function(c,f,m){return this.snapshotArea(c,f,1,1,m),this.snapshotState.getPixel=!0,this},batchSprite:function(c,f,m,v){var E=m.alpha*c.alpha;if(E!==0){var x=this.currentContext,T=this._tempMatrix1,A=this._tempMatrix2,P=f.canvasData,R=P.x,S=P.y,I=f.cutWidth,w=f.cutHeight,C=f.customPivot,_=f.source.resolution,O=c.displayOriginX,D=c.displayOriginY,F=-O+f.x,N=-D+f.y;if(c.isCropped){var Y=c._crop;(Y.flipX!==c.flipX||Y.flipY!==c.flipY)&&f.updateCropUVs(Y,c.flipX,c.flipY),I=Y.cw,w=Y.ch,R=Y.cx,S=Y.cy,F=-O+Y.x,N=-D+Y.y,c.flipX&&(F>=0?F=-(F+I):F<0&&(F=Math.abs(F)-I)),c.flipY&&(N>=0?N=-(N+w):N<0&&(N=Math.abs(N)-w))}var L=1,b=1;c.flipX&&(C||(F+=-f.realWidth+O*2),L=-1),c.flipY&&(C||(N+=-f.realHeight+D*2),b=-1);var M=c.x,k=c.y;if(m.roundPixels&&(M=Math.floor(M),k=Math.floor(k)),A.applyITRS(M,k,c.rotation,c.scaleX*L,c.scaleY*b),T.copyFrom(m.matrix),v?(T.multiplyWithOffset(v,-m.scrollX*c.scrollFactorX,-m.scrollY*c.scrollFactorY),A.e=M,A.f=k):(A.e-=m.scrollX*c.scrollFactorX,A.f-=m.scrollY*c.scrollFactorY),T.multiply(A),m.renderRoundPixels&&(T.e=Math.floor(T.e+.5),T.f=Math.floor(T.f+.5)),x.save(),T.setToContext(x),x.globalCompositeOperation=this.blendModes[c.blendMode],x.globalAlpha=E,x.imageSmoothingEnabled=!f.source.scaleMode,c.mask&&c.mask.preRenderCanvas(this,c,m),I>0&&w>0){var B=I/_,H=w/_;m.roundPixels&&(F=Math.floor(F+.5),N=Math.floor(N+.5),B+=.5,H+=.5),x.drawImage(f.source.image,R,S,I,w,F,N,B,H)}c.mask&&c.mask.postRenderCanvas(this,c,m),x.restore()}},destroy:function(){this.removeAllListeners(),this.game=null,this.gameCanvas=null,this.gameContext=null}});t.exports=g}),zi=y((e,t)=>{var i=W(),s=Ds(),n=new i({initialize:function(r,o,a,h,l,u,d,p,g){h===void 0&&(h=1),l===void 0&&(l=0),u===void 0&&(u=!0),d===void 0&&(d=!1),p===void 0&&(p=!0),g===void 0&&(g=!0),this.renderer=r,this.framebuffer=null,this.texture=null,this.width=0,this.height=0,this.scale=h,this.minFilter=l,this.autoClear=u,this.autoResize=!0,this.hasDepthBuffer=p,this.forceClamp=g,this.init(o,a),d?this.renderer.on(s.RESIZE,this.resize,this):this.autoResize=!1},init:function(r,o){var a=this.renderer;this.texture=a.createTextureFromSource(null,r,o,this.minFilter,this.forceClamp),this.framebuffer=a.createFramebuffer(r,o,this.texture,this.hasDepthBuffer),this.width=r,this.height=o},setAutoResize:function(r){return r&&!this.autoResize?(this.renderer.on(s.RESIZE,this.resize,this),this.autoResize=!0):!r&&this.autoResize&&(this.renderer.off(s.RESIZE,this.resize,this),this.autoResize=!1),this},resize:function(r,o){if(this.autoResize&&this.willResize(r,o)){var a=this.renderer;a.deleteFramebuffer(this.framebuffer),a.deleteTexture(this.texture),this.texture=a.createTextureFromSource(null,r,o,this.minFilter,this.forceClamp),this.framebuffer=a.createFramebuffer(r,o,this.texture,this.hasDepthBuffer),this.width=r,this.height=o}return this},willResize:function(r,o){return typeof r!="number"||typeof o!="number"?!1:(r=Math.round(r*this.scale),o=Math.round(o*this.scale),r=Math.max(r,1),o=Math.max(o,1),r!==this.width||o!==this.height)},bind:function(r,o,a){r===void 0&&(r=!1);var h=this.renderer;if(r&&h.flush(),o&&a&&this.resize(o,a),h.pushFramebuffer(this.framebuffer,!1,!1),r&&this.adjustViewport(),this.autoClear){var l=this.renderer.gl;l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT)}h.clearStencilMask()},adjustViewport:function(){var r=this.renderer.gl;r.viewport(0,0,this.width,this.height),r.disable(r.SCISSOR_TEST)},clear:function(r,o,a,h){var l=this.renderer,u=l.gl;l.pushFramebuffer(this.framebuffer),r!==void 0&&o!==void 0&&a!==void 0&&h!==void 0?(u.enable(u.SCISSOR_TEST),u.scissor(r,o,a,h)):u.disable(u.SCISSOR_TEST),u.clearColor(0,0,0,0),u.clear(u.COLOR_BUFFER_BIT),l.popFramebuffer(),l.resetScissor()},unbind:function(r){r===void 0&&(r=!1);var o=this.renderer;return r&&o.flush(),o.popFramebuffer()},destroy:function(){var r=this.renderer;r.off(s.RESIZE,this.resize,this),r.deleteFramebuffer(this.framebuffer),r.deleteTexture(this.texture),this.renderer=null,this.framebuffer=null,this.texture=null}});t.exports=n}),zl=y((e,t)=>{t.exports=["#define SHADER_NAME PHASER_BITMAP_MASK_FS","precision mediump float;","uniform vec2 uResolution;","uniform sampler2D uMainSampler;","uniform sampler2D uMaskSampler;","uniform bool uInvertMaskAlpha;","void main ()","{","    vec2 uv = gl_FragCoord.xy / uResolution;","    vec4 mainColor = texture2D(uMainSampler, uv);","    vec4 maskColor = texture2D(uMaskSampler, uv);","    if (!uInvertMaskAlpha)","    {","        mainColor *= maskColor.a;","    }","    else","    {","        mainColor *= (1.0 - maskColor.a);","    }","    gl_FragColor = mainColor;","}"].join(`
`)}),Wl=y((e,t)=>{t.exports=["#define SHADER_NAME PHASER_BITMAP_MASK_VS","precision mediump float;","attribute vec2 inPosition;","void main ()","{","    gl_Position = vec4(inPosition, 0.0, 1.0);","}"].join(`
`)}),Fs=y((e,t)=>{var i={BYTE:{enum:5120,size:1},UNSIGNED_BYTE:{enum:5121,size:1},SHORT:{enum:5122,size:2},UNSIGNED_SHORT:{enum:5123,size:2},INT:{enum:5124,size:4},UNSIGNED_INT:{enum:5125,size:4},FLOAT:{enum:5126,size:4}};t.exports=i}),JE=y((e,t)=>{t.exports="pipelineafterflush"}),QE=y((e,t)=>{t.exports="pipelinebeforeflush"}),$E=y((e,t)=>{t.exports="pipelinebind"}),ty=y((e,t)=>{t.exports="pipelineboot"}),ey=y((e,t)=>{t.exports="pipelinedestroy"}),iy=y((e,t)=>{t.exports="pipelinerebind"}),sy=y((e,t)=>{t.exports="pipelineresize"}),Vl=y((e,t)=>{t.exports={AFTER_FLUSH:JE(),BEFORE_FLUSH:QE(),BIND:$E(),BOOT:ty(),DESTROY:ey(),REBIND:iy(),RESIZE:sy()}}),Se=y((e,t)=>{t.exports={getTintFromFloats:function(i,s,n,r){var o=(i*255|0)&255,a=(s*255|0)&255,h=(n*255|0)&255,l=(r*255|0)&255;return(l<<24|o<<16|a<<8|h)>>>0},getTintAppendFloatAlpha:function(i,s){var n=(s*255|0)&255;return(n<<24|i)>>>0},getTintAppendFloatAlphaAndSwap:function(i,s){var n=(i>>16|0)&255,r=(i>>8|0)&255,o=(i|0)&255,a=(s*255|0)&255;return(a<<24|o<<16|r<<8|n)>>>0},getFloatsFromUintRGB:function(i){var s=(i>>16|0)&255,n=(i>>8|0)&255,r=(i|0)&255;return[s/255,n/255,r/255]},checkShaderMax:function(i,s){var n=Math.min(16,i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS));return!s||s===-1?n:Math.min(n,s)},parseFragmentShaderMaxTextures:function(i,s){if(!i)return"";for(var n="",r=0;r<s;r++)r>0&&(n+=`
	else `),r<s-1&&(n+="if (outTexId < "+r+".5)"),n+=`
	{`,n+=`
		texture = texture2D(uMainSampler[`+r+"], outTexCoord);",n+=`
	}`;return i=i.replace(/%count%/gi,s.toString()),i.replace(/%forloop%/gi,n)},setGlowQuality:function(i,s,n,r){return n===void 0&&(n=s.config.glowFXQuality),r===void 0&&(r=s.config.glowFXDistance),i=i.replace(/__SIZE__/gi,(1/n/r).toFixed(7)),i=i.replace(/__DIST__/gi,r.toFixed(0)+".0"),i}}}),Xl=y((e,t)=>{var i=W(),s=xn(),n=dt(),r=Fs(),o=new i({initialize:function(a,h,l,u,d){this.pipeline=a,this.name=h,this.renderer=a.renderer,this.gl=this.renderer.gl,this.fragSrc=u,this.vertSrc=l,this.program=this.renderer.createProgram(l,u),this.attributes,this.vertexComponentCount=0,this.vertexSize=0,this.uniforms={},this.createAttributes(d),this.createUniforms()},createAttributes:function(a){var h=0,l=0,u=[];this.vertexComponentCount=0;for(var d=0;d<a.length;d++){var p=a[d],g=p.name,c=n(p,"size",1),f=n(p,"type",r.FLOAT),m=f.enum,v=f.size,E=!!p.normalized;u.push({name:g,size:c,type:m,normalized:E,offset:l,enabled:!1,location:-1}),v===4?h+=c:h++,l+=c*v}this.vertexSize=l,this.vertexComponentCount=h,this.attributes=u},bind:function(a,h){return a===void 0&&(a=!1),h===void 0&&(h=!1),h&&this.pipeline.flush(),this.renderer.setProgram(this.program),a&&this.setAttribPointers(),this},rebind:function(){return this.renderer.setProgram(this.program),this.setAttribPointers(!0),this},setAttribPointers:function(a){a===void 0&&(a=!1);for(var h=this.gl,l=this.renderer,u=this.vertexSize,d=this.attributes,p=this.program,g=0;g<d.length;g++){var c=d[g],f=c.size,m=c.type,v=c.offset,E=c.enabled,x=c.location,T=!!c.normalized;if(a){x!==-1&&l.deleteAttribLocation(x);var A=this.renderer.createAttribLocation(p,c.name);A.webGLAttribLocation>=0?(h.enableVertexAttribArray(A.webGLAttribLocation),h.vertexAttribPointer(A.webGLAttribLocation,f,m,T,u,v),c.enabled=!0,c.location=A):A.webGLAttribLocation!==-1&&h.disableVertexAttribArray(A.webGLAttribLocation)}else E?h.vertexAttribPointer(x.webGLAttribLocation,f,m,T,u,v):!E&&x!==-1&&x.webGLAttribLocation>-1&&(h.disableVertexAttribArray(x.webGLAttribLocation),c.location=-1)}return this},createUniforms:function(){var a=this.gl,h=this.program,l=this.uniforms,u,d,p,g=a.getProgramParameter(h.webGLProgram,a.ACTIVE_UNIFORMS);for(u=0;u<g;u++){var c=a.getActiveUniform(h.webGLProgram,u);if(c){d=c.name,p=this.renderer.createUniformLocation(h,d),p!==null&&(l[d]={name:d,location:p,setter:null,value1:null,value2:null,value3:null,value4:null});var f=d.indexOf("[");f>0&&(d=d.substr(0,f),l.hasOwnProperty(d)||(p=this.renderer.createUniformLocation(h,d),p!==null&&(l[d]={name:d,location:p,setter:null,value1:null,value2:null,value3:null,value4:null})))}}return this},syncUniforms:function(){var a=this.gl;this.renderer.setProgram(this.program);for(var h in this.uniforms){var l=this.uniforms[h];l.setter&&l.setter.call(a,l.location.webGLUniformLocation,l.value1,l.value2,l.value3,l.value4)}},hasUniform:function(a){return this.uniforms.hasOwnProperty(a)},resetUniform:function(a){var h=this.uniforms[a];return h&&(h.value1=null,h.value2=null,h.value3=null,h.value4=null),this},setUniform1:function(a,h,l,u){var d=this.uniforms[h];return d?((u||d.value1!==l)&&(d.setter||(d.setter=a),d.value1=l,this.renderer.setProgram(this.program),a.call(this.gl,d.location.webGLUniformLocation,l),this.pipeline.currentShader=this),this):this},setUniform2:function(a,h,l,u,d){var p=this.uniforms[h];return p?((d||p.value1!==l||p.value2!==u)&&(p.setter||(p.setter=a),p.value1=l,p.value2=u,this.renderer.setProgram(this.program),a.call(this.gl,p.location.webGLUniformLocation,l,u),this.pipeline.currentShader=this),this):this},setUniform3:function(a,h,l,u,d,p){var g=this.uniforms[h];return g?((p||g.value1!==l||g.value2!==u||g.value3!==d)&&(g.setter||(g.setter=a),g.value1=l,g.value2=u,g.value3=d,this.renderer.setProgram(this.program),a.call(this.gl,g.location.webGLUniformLocation,l,u,d),this.pipeline.currentShader=this),this):this},setUniform4:function(a,h,l,u,d,p,g){var c=this.uniforms[h];return c?((g||c.value1!==l||c.value2!==u||c.value3!==d||c.value4!==p)&&(c.setter||(c.setter=a),c.value1=l,c.value2=u,c.value3=d,c.value4=p,this.renderer.setProgram(this.program),a.call(this.gl,c.location.webGLUniformLocation,l,u,d,p),this.pipeline.currentShader=this),this):this},setBoolean:function(a,h){return this.setUniform1(this.gl.uniform1i,a,Number(h))},set1f:function(a,h){return this.setUniform1(this.gl.uniform1f,a,h)},set2f:function(a,h,l){return this.setUniform2(this.gl.uniform2f,a,h,l)},set3f:function(a,h,l,u){return this.setUniform3(this.gl.uniform3f,a,h,l,u)},set4f:function(a,h,l,u,d){return this.setUniform4(this.gl.uniform4f,a,h,l,u,d)},set1fv:function(a,h){return this.setUniform1(this.gl.uniform1fv,a,h,!0)},set2fv:function(a,h){return this.setUniform1(this.gl.uniform2fv,a,h,!0)},set3fv:function(a,h){return this.setUniform1(this.gl.uniform3fv,a,h,!0)},set4fv:function(a,h){return this.setUniform1(this.gl.uniform4fv,a,h,!0)},set1iv:function(a,h){return this.setUniform1(this.gl.uniform1iv,a,h,!0)},set2iv:function(a,h){return this.setUniform1(this.gl.uniform2iv,a,h,!0)},set3iv:function(a,h){return this.setUniform1(this.gl.uniform3iv,a,h,!0)},set4iv:function(a,h){return this.setUniform1(this.gl.uniform4iv,a,h,!0)},set1i:function(a,h){return this.setUniform1(this.gl.uniform1i,a,h)},set2i:function(a,h,l){return this.setUniform2(this.gl.uniform2i,a,h,l)},set3i:function(a,h,l,u){return this.setUniform3(this.gl.uniform3i,a,h,l,u)},set4i:function(a,h,l,u,d){return this.setUniform4(this.gl.uniform4i,a,h,l,u,d)},setMatrix2fv:function(a,h,l){return this.setUniform2(this.gl.uniformMatrix2fv,a,h,l,!0)},setMatrix3fv:function(a,h,l){return this.setUniform2(this.gl.uniformMatrix3fv,a,h,l,!0)},setMatrix4fv:function(a,h,l){return this.setUniform2(this.gl.uniformMatrix4fv,a,h,l,!0)},createProgram:function(a,h){return a===void 0&&(a=this.vertSrc),h===void 0&&(h=this.fragSrc),this.program&&this.renderer.deleteProgram(this.program),this.vertSrc=a,this.fragSrc=h,this.program=this.renderer.createProgram(a,h),this.createUniforms(),this.rebind()},destroy:function(){var a=this.renderer;s(this.uniforms,function(h){a.deleteUniformLocation(h.location)}),this.uniforms=null,s(this.attributes,function(h){a.deleteAttribLocation(h.location)}),this.attributes=null,a.deleteProgram(this.program),this.pipeline=null,this.renderer=null,this.gl=null,this.program=null}});t.exports=o}),Le=y((e,t)=>{var i=W(),s=bn(),n=Ct(),r=Vl(),o=dt(),a=Ls(),h=Ds(),l=zi(),u=Se(),d=Xl(),p=new i({Extends:n,initialize:function(g){n.call(this);var c=g.game,f=c.renderer,m=f.gl;this.name=o(g,"name","WebGLPipeline"),this.game=c,this.renderer=f,this.manager,this.gl=m,this.view=c.canvas,this.width=0,this.height=0,this.vertexCount=0,this.vertexCapacity=0,this.vertexData,this.vertexBuffer,this.activeBuffer,this.topology=o(g,"topology",m.TRIANGLES),this.bytes,this.vertexViewF32,this.vertexViewU32,this.active=!0,this.forceZero=o(g,"forceZero",!1),this.hasBooted=!1,this.isPostFX=!1,this.isPreFX=!1,this.renderTargets=[],this.currentRenderTarget,this.shaders=[],this.currentShader,this.projectionMatrix,this.projectionWidth=0,this.projectionHeight=0,this.config=g,this.glReset=!1,this.batch=[],this.currentBatch=null,this.currentTexture=null,this.currentUnit=0,this.activeTextures=[],this.resizeUniform=o(g,"resizeUniform","")},boot:function(){var g,c=this.gl,f=this.config,m=this.renderer;this.isPostFX||(this.projectionMatrix=new a().identity());var v=this.renderTargets,E=o(f,"renderTarget",!1);typeof E=="boolean"&&E&&(E=1);var x=m.width,T=m.height;if(typeof E=="number")for(g=0;g<E;g++)v.push(new l(m,x,T,1,0,!0));else if(Array.isArray(E))for(g=0;g<E.length;g++){var A=o(E[g],"scale",1),P=o(E[g],"minFilter",0),R=o(E[g],"autoClear",1),S=o(E[g],"autoResize",!1),I=o(E[g],"width",null),w=o(E[g],"height",I);I?v.push(new l(m,I,w,1,P,R,S)):v.push(new l(m,x,T,A,P,R,S))}v.length&&(this.currentRenderTarget=v[0]),this.setShadersFromConfig(f);var C=this.shaders,_=0;for(g=0;g<C.length;g++)C[g].vertexSize>_&&(_=C[g].vertexSize);var O=o(f,"batchSize",m.config.batchSize);this.vertexCapacity=O*6;var D=new ArrayBuffer(this.vertexCapacity*_);this.vertexData=D,this.bytes=new Uint8Array(D),this.vertexViewF32=new Float32Array(D),this.vertexViewU32=new Uint32Array(D);var F=o(f,"vertices",null);for(F?(this.vertexViewF32.set(F),this.vertexBuffer=m.createVertexBuffer(D,c.STATIC_DRAW)):this.vertexBuffer=m.createVertexBuffer(D.byteLength,c.DYNAMIC_DRAW),this.setVertexBuffer(),g=C.length-1;g>=0;g--)C[g].rebind();this.hasBooted=!0,m.on(h.RESIZE,this.resize,this),m.on(h.PRE_RENDER,this.onPreRender,this),m.on(h.RENDER,this.onRender,this),m.on(h.POST_RENDER,this.onPostRender,this),this.emit(r.BOOT,this),this.onBoot()},onBoot:function(){},onResize:function(){},setShader:function(g,c,f){var m=this.renderer;if(g!==this.currentShader||m.currentProgram!==this.currentShader.program){this.flush();var v=this.setVertexBuffer(f);v&&!c&&(c=!0),g.bind(c,!1),this.currentShader=g}return this},getShaderByName:function(g){for(var c=this.shaders,f=0;f<c.length;f++)if(c[f].name===g)return c[f]},setShadersFromConfig:function(g){var c,f=this.shaders,m=this.renderer;for(c=0;c<f.length;c++)f[c].destroy();var v="vertShader",E="fragShader",x="attributes",T=o(g,v,null),A=u.parseFragmentShaderMaxTextures(o(g,E,null),m.maxTextures),P=o(g,x,null),R=o(g,"shaders",[]),S=R.length;if(S===0)T&&A&&(this.shaders=[new d(this,"default",T,A,s(P))]);else{var I=[];for(c=0;c<S;c++){var w=R[c],C,_,O,D;if(typeof w=="string"?(C="default",_=T,O=u.parseFragmentShaderMaxTextures(w,m.maxTextures),D=P):(C=o(w,"name","default"),_=o(w,v,T),O=u.parseFragmentShaderMaxTextures(o(w,E,A),m.maxTextures),D=o(w,x,P)),C==="default"){var F=O.split(`
`),N=F[0].trim();N.indexOf("#define SHADER_NAME")>-1&&(C=N.substring(20))}_&&O&&I.push(new d(this,C,_,O,s(D)))}this.shaders=I}return this.shaders.length===0||(this.currentShader=this.shaders[0]),this},createBatch:function(g){return this.currentBatch={start:this.vertexCount,count:0,texture:[g],unit:0,maxUnit:0},this.currentUnit=0,this.currentTexture=g,this.batch.push(this.currentBatch),0},addTextureToBatch:function(g){var c=this.currentBatch;c&&(c.texture.push(g),c.unit++,c.maxUnit++)},pushBatch:function(g){if(!this.currentBatch||this.forceZero&&g!==this.currentTexture)return this.createBatch(g);if(g===this.currentTexture)return this.currentUnit;var c=this.currentBatch,f=c.texture.indexOf(g);return f===-1?c.texture.length===this.renderer.maxTextures?this.createBatch(g):(c.unit++,c.maxUnit++,c.texture.push(g),this.currentUnit=c.unit,this.currentTexture=g,c.unit):(this.currentUnit=f,this.currentTexture=g,f)},setGameObject:function(g,c){return c===void 0&&(c=g.frame),this.pushBatch(c.source.glTexture)},shouldFlush:function(g){return g===void 0&&(g=0),this.vertexCount+g>this.vertexCapacity},vertexAvailable:function(){return this.vertexCapacity-this.vertexCount},resize:function(g,c){(g!==this.width||c!==this.height)&&this.flush(),this.width=g,this.height=c;for(var f=this.renderTargets,m=0;m<f.length;m++)f[m].resize(g,c);return this.setProjectionMatrix(g,c),this.resizeUniform&&this.set2f(this.resizeUniform,g,c),this.emit(r.RESIZE,g,c,this),this.onResize(g,c),this},setProjectionMatrix:function(g,c){var f=this.projectionMatrix;if(!f)return this;this.projectionWidth=g,this.projectionHeight=c,f.ortho(0,g,c,0,-1e3,1e3);for(var m=this.shaders,v="uProjectionMatrix",E=0;E<m.length;E++){var x=m[E];x.hasUniform(v)&&(x.resetUniform(v),x.setMatrix4fv(v,!1,f.val,x))}return this},flipProjectionMatrix:function(g){g===void 0&&(g=!0);var c=this.projectionMatrix;if(!c)return this;var f=this.projectionWidth,m=this.projectionHeight;g?c.ortho(0,f,0,m,-1e3,1e3):c.ortho(0,f,m,0,-1e3,1e3),this.setMatrix4fv("uProjectionMatrix",!1,c.val)},updateProjectionMatrix:function(){if(this.projectionMatrix){var g=this.renderer.projectionWidth,c=this.renderer.projectionHeight;(this.projectionWidth!==g||this.projectionHeight!==c)&&this.setProjectionMatrix(g,c)}},bind:function(g){if(g===void 0&&(g=this.currentShader),this.glReset)return this.rebind(g);var c=!1,f=this.gl;return f.getParameter(f.ARRAY_BUFFER_BINDING)!==this.vertexBuffer&&(f.bindBuffer(f.ARRAY_BUFFER,this.vertexBuffer.webGLBuffer),this.activeBuffer=this.vertexBuffer,c=!0),g.bind(c),this.currentShader=g,this.activeTextures.length=0,this.emit(r.BIND,this,g),this.onActive(g),this},rebind:function(g){this.activeBuffer=null,this.setVertexBuffer();for(var c=this.shaders,f=c.length-1;f>=0;f--){var m=c[f].rebind();(!g||m===g)&&(this.currentShader=m)}return this.activeTextures.length=0,this.emit(r.REBIND,this.currentShader),this.onActive(this.currentShader),this.onRebind(),this.glReset=!1,this},restoreContext:function(){var g=this.shaders,c=!!this.vertexBuffer;this.activeBuffer=null,this.activeTextures.length=0,this.batch.length=0,this.currentBatch=null,this.currentTexture=null,this.currentUnit=0,c&&this.setVertexBuffer();for(var f=0;f<g.length;f++){var m=g[f];m.syncUniforms(),c&&m.rebind()}},setVertexBuffer:function(g){if(g===void 0&&(g=this.vertexBuffer),g!==this.activeBuffer){var c=this.gl;return this.gl.bindBuffer(c.ARRAY_BUFFER,g.webGLBuffer),this.activeBuffer=g,!0}return!1},preBatch:function(g){return this.currentRenderTarget&&this.currentRenderTarget.bind(),this.onPreBatch(g),this},postBatch:function(g){return this.onDraw(this.currentRenderTarget),this.onPostBatch(g),this},onDraw:function(){},unbind:function(){this.currentRenderTarget&&this.currentRenderTarget.unbind()},flush:function(g){if(g===void 0&&(g=!1),this.vertexCount>0){this.emit(r.BEFORE_FLUSH,this,g),this.onBeforeFlush(g);var c=this.gl,f=this.vertexCount,m=this.currentShader.vertexSize,v=this.topology;if(this.active){this.setVertexBuffer(),f===this.vertexCapacity?c.bufferData(c.ARRAY_BUFFER,this.vertexData,c.DYNAMIC_DRAW):c.bufferSubData(c.ARRAY_BUFFER,0,this.bytes.subarray(0,f*m));var E,x,T,A=this.batch,P=this.activeTextures;if(this.forceZero)for(P[0]||c.activeTexture(c.TEXTURE0),E=0;E<A.length;E++)x=A[E],T=x.texture[0],P[0]!==T&&(c.bindTexture(c.TEXTURE_2D,T.webGLTexture),P[0]=T),c.drawArrays(v,x.start,x.count);else for(E=0;E<A.length;E++){x=A[E];for(var R=0;R<=x.maxUnit;R++)T=x.texture[R],P[R]!==T&&(c.activeTexture(c.TEXTURE0+R),c.bindTexture(c.TEXTURE_2D,T.webGLTexture),P[R]=T);c.drawArrays(v,x.start,x.count)}}this.vertexCount=0,this.batch.length=0,this.currentBatch=null,this.currentTexture=null,this.currentUnit=0,this.emit(r.AFTER_FLUSH,this,g),this.onAfterFlush(g)}return this},onActive:function(){},onBind:function(){},onRebind:function(){},onBatch:function(){},onPreBatch:function(){},onPostBatch:function(){},onPreRender:function(){},onRender:function(){},onPostRender:function(){},onBeforeFlush:function(){},onAfterFlush:function(){},batchVert:function(g,c,f,m,v,E,x){var T=this.vertexViewF32,A=this.vertexViewU32,P=this.vertexCount*this.currentShader.vertexComponentCount-1;T[++P]=g,T[++P]=c,T[++P]=f,T[++P]=m,T[++P]=v,T[++P]=E,A[++P]=x,this.vertexCount++,this.currentBatch.count=this.vertexCount-this.currentBatch.start},batchQuad:function(g,c,f,m,v,E,x,T,A,P,R,S,I,w,C,_,O,D,F,N){N===void 0&&(N=this.currentUnit);var Y=!1;this.shouldFlush(6)&&(this.flush(),Y=!0),this.currentBatch||(N=this.setTexture2D(F));var L=this.vertexViewF32,b=this.vertexViewU32,M=this.vertexCount*this.currentShader.vertexComponentCount-1;return L[++M]=c,L[++M]=f,L[++M]=P,L[++M]=R,L[++M]=N,L[++M]=D,b[++M]=w,L[++M]=m,L[++M]=v,L[++M]=P,L[++M]=I,L[++M]=N,L[++M]=D,b[++M]=_,L[++M]=E,L[++M]=x,L[++M]=S,L[++M]=I,L[++M]=N,L[++M]=D,b[++M]=O,L[++M]=c,L[++M]=f,L[++M]=P,L[++M]=R,L[++M]=N,L[++M]=D,b[++M]=w,L[++M]=E,L[++M]=x,L[++M]=S,L[++M]=I,L[++M]=N,L[++M]=D,b[++M]=O,L[++M]=T,L[++M]=A,L[++M]=S,L[++M]=R,L[++M]=N,L[++M]=D,b[++M]=C,this.vertexCount+=6,this.currentBatch.count=this.vertexCount-this.currentBatch.start,this.onBatch(g),Y},batchTri:function(g,c,f,m,v,E,x,T,A,P,R,S,I,w,C,_,O){O===void 0&&(O=this.currentUnit);var D=!1;this.shouldFlush(3)&&(this.flush(),D=!0),this.currentBatch||(O=this.setTexture2D(_));var F=this.vertexViewF32,N=this.vertexViewU32,Y=this.vertexCount*this.currentShader.vertexComponentCount-1;return F[++Y]=c,F[++Y]=f,F[++Y]=T,F[++Y]=A,F[++Y]=O,F[++Y]=C,N[++Y]=S,F[++Y]=m,F[++Y]=v,F[++Y]=T,F[++Y]=R,F[++Y]=O,F[++Y]=C,N[++Y]=I,F[++Y]=E,F[++Y]=x,F[++Y]=P,F[++Y]=R,F[++Y]=O,F[++Y]=C,N[++Y]=w,this.vertexCount+=3,this.currentBatch.count=this.vertexCount-this.currentBatch.start,this.onBatch(g),D},drawFillRect:function(g,c,f,m,v,E,x,T){x===void 0&&(x=this.renderer.whiteTexture),T===void 0&&(T=!0),g=Math.floor(g),c=Math.floor(c);var A=Math.floor(g+f),P=Math.floor(c+m),R=this.setTexture2D(x),S=u.getTintAppendFloatAlphaAndSwap(v,E),I=0,w=0,C=1,_=1;T&&(w=1,_=0),this.batchQuad(null,g,c,g,P,A,P,A,c,I,w,C,_,S,S,S,S,0,x,R)},setTexture2D:function(g){return g===void 0&&(g=this.renderer.whiteTexture),this.pushBatch(g)},bindTexture:function(g,c){c===void 0&&(c=0);var f=this.gl;return f.activeTexture(f.TEXTURE0+c),f.bindTexture(f.TEXTURE_2D,g.webGLTexture),this},bindRenderTarget:function(g,c){return this.bindTexture(g.texture,c)},setTime:function(g,c){return this.set1f(g,this.game.loop.getDuration(),c),this},setBoolean:function(g,c,f){return f===void 0&&(f=this.currentShader),f.setBoolean(g,c),this},set1f:function(g,c,f){return f===void 0&&(f=this.currentShader),f.set1f(g,c),this},set2f:function(g,c,f,m){return m===void 0&&(m=this.currentShader),m.set2f(g,c,f),this},set3f:function(g,c,f,m,v){return v===void 0&&(v=this.currentShader),v.set3f(g,c,f,m),this},set4f:function(g,c,f,m,v,E){return E===void 0&&(E=this.currentShader),E.set4f(g,c,f,m,v),this},set1fv:function(g,c,f){return f===void 0&&(f=this.currentShader),f.set1fv(g,c),this},set2fv:function(g,c,f){return f===void 0&&(f=this.currentShader),f.set2fv(g,c),this},set3fv:function(g,c,f){return f===void 0&&(f=this.currentShader),f.set3fv(g,c),this},set4fv:function(g,c,f){return f===void 0&&(f=this.currentShader),f.set4fv(g,c),this},set1iv:function(g,c,f){return f===void 0&&(f=this.currentShader),f.set1iv(g,c),this},set2iv:function(g,c,f){return f===void 0&&(f=this.currentShader),f.set2iv(g,c),this},set3iv:function(g,c,f){return f===void 0&&(f=this.currentShader),f.set3iv(g,c),this},set4iv:function(g,c,f){return f===void 0&&(f=this.currentShader),f.set4iv(g,c),this},set1i:function(g,c,f){return f===void 0&&(f=this.currentShader),f.set1i(g,c),this},set2i:function(g,c,f,m){return m===void 0&&(m=this.currentShader),m.set2i(g,c,f),this},set3i:function(g,c,f,m,v){return v===void 0&&(v=this.currentShader),v.set3i(g,c,f,m),this},set4i:function(g,c,f,m,v,E){return E===void 0&&(E=this.currentShader),E.set4i(g,c,f,m,v),this},setMatrix2fv:function(g,c,f,m){return m===void 0&&(m=this.currentShader),m.setMatrix2fv(g,c,f),this},setMatrix3fv:function(g,c,f,m){return m===void 0&&(m=this.currentShader),m.setMatrix3fv(g,c,f),this},setMatrix4fv:function(g,c,f,m){return m===void 0&&(m=this.currentShader),m.setMatrix4fv(g,c,f),this},destroy:function(){this.emit(r.DESTROY,this);var g,c=this.shaders;for(g=0;g<c.length;g++)c[g].destroy();var f=this.renderTargets;for(g=0;g<f.length;g++)f[g].destroy();var m=this.renderer;return m.deleteBuffer(this.vertexBuffer),m.off(h.RESIZE,this.resize,this),m.off(h.PRE_RENDER,this.onPreRender,this),m.off(h.RENDER,this.onRender,this),m.off(h.POST_RENDER,this.onPostRender,this),this.removeAllListeners(),this.game=null,this.renderer=null,this.manager=null,this.gl=null,this.view=null,this.shaders=null,this.renderTargets=null,this.bytes=null,this.vertexViewF32=null,this.vertexViewU32=null,this.vertexData=null,this.vertexBuffer=null,this.currentShader=null,this.currentRenderTarget=null,this.activeTextures=null,this}});t.exports=p}),Kl=y((e,t)=>{var i=W(),s=dt(),n=zl(),r=Wl(),o=Fs(),a=Le(),h=new i({Extends:a,initialize:function(l){l.fragShader=s(l,"fragShader",n),l.vertShader=s(l,"vertShader",r),l.batchSize=s(l,"batchSize",1),l.vertices=s(l,"vertices",[-1,1,-1,-7,7,1]),l.attributes=s(l,"attributes",[{name:"inPosition",size:2,type:o.FLOAT}]),a.call(this,l)},boot:function(){a.prototype.boot.call(this),this.set1i("uMainSampler",0),this.set1i("uMaskSampler",1)},resize:function(l,u){a.prototype.resize.call(this,l,u),this.set2f("uResolution",l,u)},beginMask:function(l,u,d){this.renderer.beginBitmapMask(l,d)},endMask:function(l,u,d){var p=this.gl,g=this.renderer,c=l.bitmapMask;c&&p&&(g.drawBitmapMask(c,u,this),d&&this.set2f("uResolution",d.width,d.height),this.set1i("uInvertMaskAlpha",l.invertAlpha),p.drawArrays(this.topology,0,3),d&&this.set2f("uResolution",this.width,this.height),p.bindTexture(p.TEXTURE_2D,null))}});t.exports=h}),jl=y((e,t)=>{t.exports=["#define SHADER_NAME BARREL_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform float amount;","varying vec2 outTexCoord;","vec2 Distort(vec2 p)","{","    float theta  = atan(p.y, p.x);","    float radius = length(p);","    radius = pow(radius, amount);","    p.x = radius * cos(theta);","    p.y = radius * sin(theta);","    return 0.5 * (p + 1.0);","}","void main()","{","    vec2 xy = 2.0 * outTexCoord - 1.0;","    vec2 texCoord = outTexCoord;","    if (length(xy) < 1.0)","    {","        texCoord = Distort(xy);","    }","    gl_FragColor = texture2D(uMainSampler, texCoord);","}"].join(`
`)}),ga=y((e,t)=>{t.exports=["#define SHADER_NAME PHASER_POSTFX_FS","precision mediump float;","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","void main ()","{","    gl_FragColor = texture2D(uMainSampler, outTexCoord);","}"].join(`
`)}),fa=y((e,t)=>{t.exports=["#define SHADER_NAME PHASER_QUAD_VS","precision mediump float;","attribute vec2 inPosition;","attribute vec2 inTexCoord;","varying vec2 outFragCoord;","varying vec2 outTexCoord;","void main ()","{","    outFragCoord = inPosition.xy * 0.5 + 0.5;","    outTexCoord = inTexCoord;","    gl_Position = vec4(inPosition, 0, 1);","}"].join(`
`)}),te=y((e,t)=>{var i=W(),s=qr(),n=dt(),r=ga(),o=fa(),a=Le(),h=new i({Extends:a,initialize:function(l){l.renderTarget=n(l,"renderTarget",1),l.fragShader=n(l,"fragShader",r),l.vertShader=n(l,"vertShader",o),l.attributes=n(l,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2}]),l.batchSize=1,l.vertices=[-1,-1,0,0,-1,1,0,1,1,1,1,1,-1,-1,0,0,1,1,1,1,1,-1,1,0],a.call(this,l),this.isPostFX=!0,this.gameObject,this.controller,this.colorMatrix=new s,this.fullFrame1,this.fullFrame2,this.halfFrame1,this.halfFrame2,this.renderer.isBooted&&(this.manager=this.renderer.pipelines)},bootFX:function(){a.prototype.boot.call(this);var l=this.manager.UTILITY_PIPELINE;this.fullFrame1=l.fullFrame1,this.fullFrame2=l.fullFrame2,this.halfFrame1=l.halfFrame1,this.halfFrame2=l.halfFrame2;var u=this.renderer;this.set1i("uMainSampler",0),this.set2f("uResolution",u.width,u.height);for(var d=this.renderTargets,p=0;p<d.length;p++)d[p].autoResize=!0},postBatch:function(l){return this.hasBooted||(this.bootFX(),this.currentRenderTarget&&this.currentRenderTarget.bind()),this.onDraw(this.currentRenderTarget),this.onPostBatch(l),this},onDraw:function(l){this.bindAndDraw(l)},getController:function(l){return l!==void 0?l:this.controller?this.controller:this},copySprite:function(l,u,d){d===void 0&&(d=!1);var p=this.gl;p.activeTexture(p.TEXTURE0),p.bindTexture(p.TEXTURE_2D,l.texture.webGLTexture);var g=p.getParameter(p.FRAMEBUFFER_BINDING);p.bindFramebuffer(p.FRAMEBUFFER,u.framebuffer.webGLFramebuffer),p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,u.texture.webGLTexture,0),p.clearColor(0,0,0,0),p.clear(p.COLOR_BUFFER_BIT),p.bufferData(p.ARRAY_BUFFER,this.vertexData,p.STATIC_DRAW),p.drawArrays(p.TRIANGLES,0,6),d&&(p.bindTexture(p.TEXTURE_2D,null),p.bindFramebuffer(p.FRAMEBUFFER,g))},copyFrame:function(l,u,d,p,g){this.manager.copyFrame(l,u,d,p,g)},copyToGame:function(l){this.manager.copyToGame(l)},drawFrame:function(l,u,d){this.manager.drawFrame(l,u,d,this.colorMatrix)},blendFrames:function(l,u,d,p,g){this.manager.blendFrames(l,u,d,p,g)},blendFramesAdditive:function(l,u,d,p,g){this.manager.blendFramesAdditive(l,u,d,p,g)},clearFrame:function(l,u){this.manager.clearFrame(l,u)},blitFrame:function(l,u,d,p,g,c){this.manager.blitFrame(l,u,d,p,g,c)},copyFrameRect:function(l,u,d,p,g,c,f,m){this.manager.copyFrameRect(l,u,d,p,g,c,f,m)},bindAndDraw:function(l,u,d,p,g){d===void 0&&(d=!0),p===void 0&&(p=!0);var c=this.gl,f=this.renderer;this.bind(g),this.set1i("uMainSampler",0),u?(c.viewport(0,0,u.width,u.height),c.bindFramebuffer(c.FRAMEBUFFER,u.framebuffer.webGLFramebuffer),c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,u.texture.webGLTexture,0),d&&(p?c.clearColor(0,0,0,0):c.clearColor(0,0,0,1),c.clear(c.COLOR_BUFFER_BIT))):(f.popFramebuffer(!1,!1),f.currentFramebuffer||c.viewport(0,0,f.width,f.height)),f.restoreStencilMask(),c.activeTexture(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,l.texture.webGLTexture),c.bufferData(c.ARRAY_BUFFER,this.vertexData,c.STATIC_DRAW),c.drawArrays(c.TRIANGLES,0,6),u&&(c.bindTexture(c.TEXTURE_2D,null),c.bindFramebuffer(c.FRAMEBUFFER,f.currentFramebuffer.webGLFramebuffer))},destroy:function(){return this.controller&&this.controller.destroy(),this.gameObject=null,this.controller=null,this.colorMatrix=null,this.fullFrame1=null,this.fullFrame2=null,this.halfFrame1=null,this.halfFrame2=null,this.manager.removePostPipeline(this),a.prototype.destroy.call(this),this}});t.exports=h}),ny=y((e,t)=>{var i=W(),s=jl(),n=te(),r=new i({Extends:n,initialize:function(o){n.call(this,{game:o,fragShader:s}),this.amount=1},onPreRender:function(o,a){o=this.getController(o),this.set1f("amount",o.amount,a)}});t.exports=r}),Zl=y((e,t)=>{t.exports=["#define SHADER_NAME BLOOM_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 offset;","uniform float strength;","uniform vec3 color;","varying vec2 outTexCoord;","void main ()","{","    vec4 sum = texture2D(uMainSampler, outTexCoord) * 0.204164 * strength;","    sum = sum + texture2D(uMainSampler, outTexCoord + offset * 1.407333) * 0.304005;","    sum = sum + texture2D(uMainSampler, outTexCoord - offset * 1.407333) * 0.304005;","    sum = sum + texture2D(uMainSampler, outTexCoord + offset * 3.294215) * 0.093913;","    gl_FragColor = (sum + texture2D(uMainSampler, outTexCoord - offset * 3.294215) * 0.093913) * vec4(color, 1);","}"].join(`
`)}),ry=y((e,t)=>{var i=W(),s=Zl(),n=te(),r=new i({Extends:n,initialize:function(o){n.call(this,{game:o,fragShader:s}),this.steps=4,this.offsetX=1,this.offsetY=1,this.blurStrength=1,this.strength=1,this.glcolor=[1,1,1]},onPreRender:function(o){o=this.getController(o),this.set1f("strength",o.blurStrength),this.set3fv("color",o.glcolor)},onDraw:function(o){var a=this.getController(),h=this.fullFrame1,l=this.fullFrame2;this.copyFrame(o,l);for(var u=2/o.width*a.offsetX,d=2/o.height*a.offsetY,p=0;p<a.steps;p++)this.set2f("offset",u,0),this.copySprite(o,h),this.set2f("offset",0,d),this.copySprite(h,o);this.blendFrames(l,o,h,a.strength),this.copyToGame(h)}});t.exports=r}),ql=y((e,t)=>{t.exports=["#define SHADER_NAME BLUR_LOW_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform vec2 offset;","uniform float strength;","uniform vec3 color;","varying vec2 outTexCoord;","void main ()","{","    vec2 uv = outTexCoord;","    vec4 col = vec4(0.0);","    vec2 offset = vec2(1.333) * offset * strength;","    col += texture2D(uMainSampler, uv) * 0.29411764705882354;","    col += texture2D(uMainSampler, uv + (offset / resolution)) * 0.35294117647058826;","    col += texture2D(uMainSampler, uv - (offset / resolution)) * 0.35294117647058826;","    gl_FragColor = col * vec4(color, 1.0);","}"].join(`
`)}),Jl=y((e,t)=>{t.exports=["#define SHADER_NAME BLUR_MED_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform vec2 offset;","uniform float strength;","uniform vec3 color;","varying vec2 outTexCoord;","void main ()","{","    vec2 uv = outTexCoord;","    vec4 col = vec4(0.0);","    vec2 off1 = vec2(1.3846153846) * offset * strength;","    vec2 off2 = vec2(3.2307692308) * offset * strength;","    col += texture2D(uMainSampler, uv) * 0.2270270270;","    col += texture2D(uMainSampler, uv + (off1 / resolution)) * 0.3162162162;","    col += texture2D(uMainSampler, uv - (off1 / resolution)) * 0.3162162162;","    col += texture2D(uMainSampler, uv + (off2 / resolution)) * 0.0702702703;","    col += texture2D(uMainSampler, uv - (off2 / resolution)) * 0.0702702703;","    gl_FragColor = col * vec4(color, 1.0);","}"].join(`
`)}),Ql=y((e,t)=>{t.exports=["#define SHADER_NAME BLUR_HIGH_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform vec2 offset;","uniform float strength;","uniform vec3 color;","varying vec2 outTexCoord;","void main ()","{","    vec2 uv = outTexCoord;","    vec4 col = vec4(0.0);","    vec2 off1 = vec2(1.411764705882353) * offset * strength;","    vec2 off2 = vec2(3.2941176470588234) * offset * strength;","    vec2 off3 = vec2(5.176470588235294) * offset * strength;","    col += texture2D(uMainSampler, uv) * 0.1964825501511404;","    col += texture2D(uMainSampler, uv + (off1 / resolution)) * 0.2969069646728344;","    col += texture2D(uMainSampler, uv - (off1 / resolution)) * 0.2969069646728344;","    col += texture2D(uMainSampler, uv + (off2 / resolution)) * 0.09447039785044732;","    col += texture2D(uMainSampler, uv - (off2 / resolution)) * 0.09447039785044732;","    col += texture2D(uMainSampler, uv + (off3 / resolution)) * 0.010381362401148057;","    col += texture2D(uMainSampler, uv - (off3 / resolution)) * 0.010381362401148057;","    gl_FragColor = col * vec4(color, 1.0);","}"].join(`
`)}),ay=y((e,t)=>{var i=W(),s=ql(),n=Jl(),r=Ql(),o=te(),a=new i({Extends:o,initialize:function(h){o.call(this,{game:h,shaders:[{name:"Gaussian5",fragShader:s},{name:"Gaussian9",fragShader:n},{name:"Gaussian13",fragShader:r}]}),this.activeShader=this.shaders[0],this.x=2,this.y=2,this.steps=4,this.strength=1,this.glcolor=[1,1,1]},setQualityLow:function(){return this.activeShader=this.shaders[0],this},setQualityMedium:function(){return this.activeShader=this.shaders[1],this},setQualityHigh:function(){return this.activeShader=this.shaders[2],this},onDraw:function(h){var l=this.getController(),u=this.gl,d=this.fullFrame1,p=u.getParameter(u.FRAMEBUFFER_BINDING);this.bind(this.shaders[l.quality]),u.activeTexture(u.TEXTURE0),u.viewport(0,0,h.width,h.height),this.set1i("uMainSampler",0),this.set2f("resolution",h.width,h.height),this.set1f("strength",l.strength),this.set3fv("color",l.glcolor);for(var g=0;g<l.steps;g++)this.set2f("offset",l.x,0),this.copySprite(h,d),this.set2f("offset",0,l.y),this.copySprite(d,h);u.bindFramebuffer(u.FRAMEBUFFER,p),u.bindTexture(u.TEXTURE_2D,null),this.copyToGame(h)}});t.exports=a}),$l=y((e,t)=>{t.exports=["#define SHADER_NAME BOKEH_FS","precision mediump float;","#define ITERATIONS 100.0","#define ONEOVER_ITR 1.0 / ITERATIONS","#define PI 3.141596","#define GOLDEN_ANGLE 2.39996323","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform float radius;","uniform float amount;","uniform float contrast;","uniform bool isTiltShift;","uniform float strength;","uniform vec2 blur;","varying vec2 outTexCoord;","vec2 Sample (in float theta, inout float r)","{","    r += 1.0 / r;","    return (r - 1.0) * vec2(cos(theta), sin(theta)) * 0.06;","}","vec3 Bokeh (sampler2D tex, vec2 uv, float radius)","{","    vec3 acc = vec3(0.0);","    vec3 div = vec3(0.0);","    vec2 pixel = vec2(resolution.y / resolution.x, 1.0) * radius * .025;","    float r = 1.0;","    for (float j = 0.0; j < GOLDEN_ANGLE * ITERATIONS; j += GOLDEN_ANGLE)","    {","        vec3 col = texture2D(tex, uv + pixel * Sample(j, r)).xyz;","        col = contrast > 0.0 ? col * col * (1.0 + contrast) : col;","        vec3 bokeh = vec3(0.5) + pow(col, vec3(10.0)) * amount;","        acc += col * bokeh;","        div += bokeh;","    }","    return acc / div;","}","void main ()","{","    float shift = 1.0;","    if (isTiltShift)","    {","        vec2 uv = vec2(gl_FragCoord.xy / resolution + vec2(-0.5, -0.5)) * 2.0;","        float centerStrength = 1.0;","        shift = length(uv * blur * strength) * centerStrength;","    }","    gl_FragColor = vec4(Bokeh(uMainSampler, outTexCoord * vec2(1.0, 1.0), radius * shift), 0.0);","}"].join(`
`)}),oy=y((e,t)=>{var i=W(),s=$l(),n=te(),r=new i({Extends:n,initialize:function(o){n.call(this,{game:o,fragShader:s}),this.isTiltShift=!1,this.strength=1,this.blurX=1,this.blurY=1,this.radius=.5,this.amount=1,this.contrast=.2},onPreRender:function(o,a,h,l){o=this.getController(o),this.set1f("radius",o.radius,a),this.set1f("amount",o.amount,a),this.set1f("contrast",o.contrast,a),this.set1f("strength",o.strength,a),this.set2f("blur",o.blurX,o.blurY,a),this.setBoolean("isTiltShift",o.isTiltShift,a),h&&l&&this.set2f("resolution",h,l,a)},onDraw:function(o){this.set2f("resolution",o.width,o.height),this.bindAndDraw(o)}});t.exports=r}),tu=y((e,t)=>{t.exports=["#define SHADER_NAME CIRCLE_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform vec3 color;","uniform vec4 backgroundColor;","uniform float thickness;","uniform float scale;","uniform float feather;","varying vec2 outTexCoord;","void main ()","{","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec2 position = (gl_FragCoord.xy / resolution.xy) * 2.0 - 1.0;","    float aspectRatio = resolution.x / resolution.y;","    position.x *= aspectRatio;","    float grad = length(position);","    float outer = aspectRatio;","    float inner = outer - (thickness * 2.0 / resolution.y);","    if (aspectRatio >= 1.0)","    {","        float f = 2.0 + (resolution.y / resolution.x);","        outer = 1.0;","        inner = 1.0 - (thickness * f / resolution.x);","    }","    outer *= scale;","    inner *= scale;","    float circle = smoothstep(outer, outer - 0.01, grad);","    float ring = circle - smoothstep(inner, inner - feather, grad);","    texture = mix(backgroundColor * backgroundColor.a, texture, texture.a);","    texture = (texture * (circle - ring));","    gl_FragColor = vec4(texture.rgb + (ring * color), texture.a);","}"].join(`
`)}),hy=y((e,t)=>{var i=W(),s=tu(),n=te(),r=new i({Extends:n,initialize:function(o){n.call(this,{game:o,fragShader:s}),this.scale=1,this.feather=.005,this.thickness=8,this.glcolor=[1,.2,.7],this.glcolor2=[1,0,0,.4]},onPreRender:function(o,a,h,l){o=this.getController(o),this.set1f("scale",o.scale,a),this.set1f("feather",o.feather,a),this.set1f("thickness",o.thickness,a),this.set3fv("color",o.glcolor,a),this.set4fv("backgroundColor",o.glcolor2,a),h&&l&&this.set2f("resolution",h,l,a)},onDraw:function(o){this.set2f("resolution",o.width,o.height),this.bindAndDraw(o)}});t.exports=r}),ly=y((e,t)=>{var i=W(),s=te(),n=new i({Extends:s,initialize:function(r){s.call(this,{game:r})},onDraw:function(r){var o=this.fullFrame1;this.controller?this.manager.drawFrame(r,o,!0,this.controller):this.drawFrame(r,o),this.copyToGame(o)}});t.exports=n}),eu=y((e,t)=>{t.exports=["#define SHADER_NAME DISPLACEMENT_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform sampler2D uDisplacementSampler;","uniform vec2 amount;","varying vec2 outTexCoord;","void main ()","{","    vec2 disp = (-vec2(0.5, 0.5) + texture2D(uDisplacementSampler, outTexCoord).rr) * amount;","    gl_FragColor = texture2D(uMainSampler, outTexCoord + disp).rgba;","}"].join(`
`)}),uy=y((e,t)=>{var i=W(),s=eu(),n=te(),r=new i({Extends:n,initialize:function(o){n.call(this,{game:o,fragShader:s}),this.x=.005,this.y=.005,this.glTexture},onBoot:function(){this.setTexture("__WHITE")},setTexture:function(o){var a=this.game.textures.getFrame(o);a&&(this.glTexture=a.glTexture)},onDraw:function(o){var a=this.getController(),h=this.fullFrame1;this.bind(),this.set1i("uMainSampler",0),this.set1i("uDisplacementSampler",1),this.set2f("amount",a.x,a.y),this.bindTexture(a.glTexture,1),this.copySprite(o,h),this.copyToGame(h)}});t.exports=r}),iu=y((e,t)=>{t.exports=["#define SHADER_NAME GLOW_FS","precision mediump float;","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","uniform float outerStrength;","uniform float innerStrength;","uniform vec2 resolution;","uniform vec4 glowColor;","uniform bool knockout;","const float PI = 3.14159265358979323846264;","const float DIST = __DIST__;","const float SIZE = min(__SIZE__, PI * 2.0);","const float STEP = ceil(PI * 2.0 / SIZE);","const float MAX_ALPHA = STEP * DIST * (DIST + 1.0) / 2.0;","void main ()","{","    vec2 px = vec2(1.0 / resolution.x, 1.0 / resolution.y);","    float totalAlpha = 0.0;","    vec2 direction;","    vec2 displaced;","    vec4 color;","    for (float angle = 0.0; angle < PI * 2.0; angle += SIZE)","    {","        direction = vec2(cos(angle), sin(angle)) * px;","        for (float curDistance = 0.0; curDistance < DIST; curDistance++)","        {","            displaced = outTexCoord + direction * (curDistance + 1.0);","            color = texture2D(uMainSampler, displaced);","            totalAlpha += (DIST - curDistance) * color.a;","        }","    }","    color = texture2D(uMainSampler, outTexCoord);","    float alphaRatio = (totalAlpha / MAX_ALPHA);","    float innerGlowAlpha = (1.0 - alphaRatio) * innerStrength * color.a;","    float innerGlowStrength = min(1.0, innerGlowAlpha);","    vec4 innerColor = mix(color, glowColor, innerGlowStrength);","    float outerGlowAlpha = alphaRatio * outerStrength * (1.0 - color.a);","    float outerGlowStrength = min(1.0 - innerColor.a, outerGlowAlpha);","    vec4 outerGlowColor = outerGlowStrength * glowColor.rgba;","    if (knockout)","    {","        float resultAlpha = outerGlowAlpha + innerGlowAlpha;","        gl_FragColor = vec4(glowColor.rgb * resultAlpha, resultAlpha);","    }","    else","    {","        gl_FragColor = innerColor + outerGlowColor;","    }","}"].join(`
`)}),cy=y((e,t)=>{var i=W(),s=dt(),n=iu(),r=te(),o=Se(),a=new i({Extends:r,initialize:function(h,l){var u=s(l,"quality",.1),d=s(l,"distance",10);r.call(this,{game:h,fragShader:o.setGlowQuality(n,h,u,d)}),this.outerStrength=4,this.innerStrength=0,this.knockout=!1,this.glcolor=[1,1,1,1]},onPreRender:function(h,l,u,d){h=this.getController(h),this.set1f("outerStrength",h.outerStrength,l),this.set1f("innerStrength",h.innerStrength,l),this.set4fv("glowColor",h.glcolor,l),this.setBoolean("knockout",h.knockout,l),u&&d&&this.set2f("resolution",u,d,l)},onDraw:function(h){this.set2f("resolution",h.width,h.height),this.bindAndDraw(h)}});t.exports=a}),su=y((e,t)=>{t.exports=["#define SHADER_NAME GRADIENT_FS","#define SRGB_TO_LINEAR(c) pow((c), vec3(2.2))","#define LINEAR_TO_SRGB(c) pow((c), vec3(1.0 / 2.2))","#define SRGB(r, g, b) SRGB_TO_LINEAR(vec3(float(r), float(g), float(b)) / 255.0)","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 positionFrom;","uniform vec2 positionTo;","uniform vec3 color1;","uniform vec3 color2;","uniform float alpha;","uniform int size;","varying vec2 outTexCoord;","float gradientNoise(in vec2 uv)","{","    const vec3 magic = vec3(0.06711056, 0.00583715, 52.9829189);","    return fract(magic.z * fract(dot(uv, magic.xy)));","}","float stepped (in float s, in float scale, in int steps)","{","    return steps > 0 ? floor( s / ((1.0 * scale) / float(steps))) * 1.0 / float(steps - 1) : s;","}","void main ()","{","    vec2 a = positionFrom;","    vec2 b = positionTo;","    vec2 ba = b - a;","    float d = dot(outTexCoord - a, ba) / dot(ba, ba);","    float t = size > 0 ? stepped(d, 1.0, size) : d;","    t = smoothstep(0.0, 1.0, clamp(t, 0.0, 1.0));","    vec3 color = mix(SRGB(color1.r, color1.g, color1.b), SRGB(color2.r, color2.g, color2.b), t);","    color = LINEAR_TO_SRGB(color);","    color += (1.0 / 255.0) * gradientNoise(outTexCoord) - (0.5 / 255.0);","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    gl_FragColor = vec4(mix(color.rgb, texture.rgb, alpha), 1.0) * texture.a;","}"].join(`
`)}),dy=y((e,t)=>{var i=W(),s=su(),n=te(),r=new i({Extends:n,initialize:function(o){n.call(this,{game:o,fragShader:s}),this.alpha=.2,this.size=0,this.fromX=0,this.fromY=0,this.toX=0,this.toY=1,this.glcolor1=[255,0,0],this.glcolor2=[0,255,0]},onPreRender:function(o,a){o=this.getController(o),this.set1f("alpha",o.alpha,a),this.set1i("size",o.size,a),this.set3fv("color1",o.glcolor1,a),this.set3fv("color2",o.glcolor2,a),this.set2f("positionFrom",o.fromX,o.fromY,a),this.set2f("positionTo",o.toX,o.toY,a)}});t.exports=r}),nu=y((e,t)=>{t.exports=["#define SHADER_NAME PIXELATE_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform float amount;","varying vec2 outTexCoord;","void main ()","{","    float pixelSize = floor(2.0 + amount);","    vec2 center = pixelSize * floor(outTexCoord * resolution / pixelSize) + pixelSize * vec2(0.5, 0.5);","    vec2 corner1 = center + pixelSize * vec2(-0.5, -0.5);","    vec2 corner2 = center + pixelSize * vec2(+0.5, -0.5);","    vec2 corner3 = center + pixelSize * vec2(+0.5, +0.5);","    vec2 corner4 = center + pixelSize * vec2(-0.5, +0.5);","    vec4 pixel = 0.4 * texture2D(uMainSampler, center / resolution);","    pixel += 0.15 * texture2D(uMainSampler, corner1 / resolution);","    pixel += 0.15 * texture2D(uMainSampler, corner2 / resolution);","    pixel += 0.15 * texture2D(uMainSampler, corner3 / resolution);","    pixel += 0.15 * texture2D(uMainSampler, corner4 / resolution);","    gl_FragColor = pixel;","}"].join(`
`)}),py=y((e,t)=>{var i=W(),s=nu(),n=te(),r=new i({Extends:n,initialize:function(o){n.call(this,{game:o,fragShader:s}),this.amount=1},onPreRender:function(o,a,h,l){o=this.getController(o),this.set1f("amount",o.amount,a),h&&l&&this.set2f("resolution",h,l,a)},onDraw:function(o){this.set2f("resolution",o.width,o.height),this.bindAndDraw(o)}});t.exports=r}),ru=y((e,t)=>{t.exports=["#define SHADER_NAME SHADOW_FS","precision mediump float;","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","uniform vec2 lightPosition;","uniform vec4 color;","uniform float decay;","uniform float power;","uniform float intensity;","uniform int samples;","const int MAX = 12;","void main ()","{","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec2 pc = (lightPosition - outTexCoord) * intensity;","    float shadow = 0.0;","    float limit = max(float(MAX), float(samples));","    for (int i = 0; i < MAX; ++i)","    {","        if (i >= samples)","        {","            break;","        }","        shadow += texture2D(uMainSampler, outTexCoord + float(i) * decay / limit * pc).a * power;","    }","    float mask = 1.0 - texture.a;","    gl_FragColor = mix(texture, color, shadow * mask);","}"].join(`
`)}),gy=y((e,t)=>{var i=W(),s=ru(),n=te(),r=new i({Extends:n,initialize:function(o){n.call(this,{game:o,fragShader:s}),this.x=0,this.y=0,this.decay=.1,this.power=1,this.glcolor=[0,0,0,1],this.samples=6,this.intensity=1},onPreRender:function(o,a){o=this.getController(o);var h=o.samples;this.set1i("samples",h,a),this.set1f("intensity",o.intensity,a),this.set1f("decay",o.decay,a),this.set1f("power",o.power/h,a),this.set2f("lightPosition",o.x,o.y,a),this.set4fv("color",o.glcolor,a)}});t.exports=r}),au=y((e,t)=>{t.exports=["#define SHADER_NAME SHINE_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform bool reveal;","uniform float speed;","uniform float time;","uniform float lineWidth;","uniform float gradient;","varying vec2 outTexCoord;","void main ()","{","	vec2 uv = gl_FragCoord.xy / resolution.xy;","    vec4 tex = texture2D(uMainSampler, outTexCoord);","    vec4 col1 = vec4(0.3, 0.0, 0.0, 1.0);","    vec4 col2 = vec4(0.85, 0.85, 0.85, 1.0);","    uv.x = uv.x - mod(time * speed, 2.0) + 0.5;","    float y = uv.x * gradient;","    float s = smoothstep(y - lineWidth, y, uv.y) - smoothstep(y, y + lineWidth, uv.y);","    gl_FragColor = (((s * col1) + (s * col2)) * tex);","    if (!reveal)","    {","        gl_FragColor += tex;","    }","}"].join(`
`)}),fy=y((e,t)=>{var i=W(),s=au(),n=te(),r=new i({Extends:n,initialize:function(o){n.call(this,{game:o,fragShader:s}),this.speed=.5,this.lineWidth=.5,this.gradient=3,this.reveal=!1},onPreRender:function(o,a,h,l){o=this.getController(o),this.setTime("time",a),this.set1f("speed",o.speed,a),this.set1f("lineWidth",o.lineWidth,a),this.set1f("gradient",o.gradient,a),this.setBoolean("reveal",o.reveal,a),h&&l&&this.set2f("resolution",h,l,a)},onDraw:function(o){this.set2f("resolution",o.width,o.height),this.bindAndDraw(o)}});t.exports=r}),ou=y((e,t)=>{t.exports=["#define SHADER_NAME VIGNETTE_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform float radius;","uniform float strength;","uniform vec2 position;","varying vec2 outTexCoord;","void main ()","{","    vec4 col = vec4(1.0);","    float d = length(outTexCoord - position);","    if (d <= radius)","    {","        float g = d / radius;","        g = sin(g * 3.14 * strength);","    	col = vec4(g * g * g);","    }","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    gl_FragColor = texture * (1.0 - col);","}"].join(`
`)}),my=y((e,t)=>{var i=W(),s=ou(),n=te(),r=new i({Extends:n,initialize:function(o){n.call(this,{game:o,fragShader:s}),this.x=.5,this.y=.5,this.radius=.5,this.strength=.5},onPreRender:function(o,a){o=this.getController(o),this.set1f("radius",o.radius,a),this.set1f("strength",o.strength,a),this.set2f("position",o.x,o.y,a)}});t.exports=r}),hu=y((e,t)=>{t.exports=["#define SHADER_NAME WIPE_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec4 config;","uniform bool reveal;","varying vec2 outTexCoord;","void main ()","{","    vec2 uv = outTexCoord;","    vec4 color0;","    vec4 color1;","    if (reveal)","    {","        color0 = vec4(0);","        color1 = texture2D(uMainSampler, uv);","    }","    else","    {","        color0 = texture2D(uMainSampler, uv);","        color1 = vec4(0);","    }","    float distance = config.x;","    float width = config.y;","    float direction = config.z;","    float axis = uv.x;","    if (config.w == 1.0)","    {","        axis = uv.y;","    }","    float adjust = mix(width, -width, distance);","    float value = smoothstep(distance - width, distance + width, abs(direction - axis) + adjust);","    gl_FragColor = mix(color1, color0, value);","}"].join(`
`)}),vy=y((e,t)=>{var i=W(),s=hu(),n=te(),r=new i({Extends:n,initialize:function(o){n.call(this,{game:o,fragShader:s}),this.progress=0,this.wipeWidth=.1,this.direction=0,this.axis=0,this.reveal=!1},onPreRender:function(o,a){o=this.getController(o);var h=o.progress,l=o.wipeWidth,u=o.direction,d=o.axis;this.set4f("config",h,l,u,d,a),this.setBoolean("reveal",o.reveal,a)}});t.exports=r}),ma=y((e,t)=>{var i={Barrel:ny(),Bloom:ry(),Blur:ay(),Bokeh:oy(),Circle:hy(),ColorMatrix:ly(),Displacement:uy(),Glow:cy(),Gradient:dy(),Pixelate:py(),Shadow:gy(),Shine:fy(),Vignette:my(),Wipe:vy()};t.exports=i}),va=y((e,t)=>{t.exports=["#define SHADER_NAME PHASER_COLORMATRIX_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform float uColorMatrix[20];","uniform float uAlpha;","varying vec2 outTexCoord;","void main ()","{","    vec4 c = texture2D(uMainSampler, outTexCoord);","    if (uAlpha == 0.0)","    {","        gl_FragColor = c;","        return;","    }","    if (c.a > 0.0)","    {","        c.rgb /= c.a;","    }","    vec4 result;","    result.r = (uColorMatrix[0] * c.r) + (uColorMatrix[1] * c.g) + (uColorMatrix[2] * c.b) + (uColorMatrix[3] * c.a) + uColorMatrix[4];","    result.g = (uColorMatrix[5] * c.r) + (uColorMatrix[6] * c.g) + (uColorMatrix[7] * c.b) + (uColorMatrix[8] * c.a) + uColorMatrix[9];","    result.b = (uColorMatrix[10] * c.r) + (uColorMatrix[11] * c.g) + (uColorMatrix[12] * c.b) + (uColorMatrix[13] * c.a) + uColorMatrix[14];","    result.a = (uColorMatrix[15] * c.r) + (uColorMatrix[16] * c.g) + (uColorMatrix[17] * c.b) + (uColorMatrix[18] * c.a) + uColorMatrix[19];","    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);","    rgb *= result.a;","    gl_FragColor = vec4(rgb, result.a);","}"].join(`
`)}),Ey=y((e,t)=>{"use strict";function i(L,b,M){M=M||2;var k=b&&b.length,B=k?b[0]*M:L.length,H=s(L,0,B,M,!0),z=[];if(!H||H.next===H.prev)return z;var V,q,Z,at,et,st,Q;if(k&&(H=u(L,b,H,M)),L.length>80*M){V=Z=L[0],q=at=L[1];for(var ct=M;ct<B;ct+=M)et=L[ct],st=L[ct+1],et<V&&(V=et),st<q&&(q=st),et>Z&&(Z=et),st>at&&(at=st);Q=Math.max(Z-V,at-q),Q=Q!==0?32767/Q:0}return r(H,z,M,V,q,Q,0),z}function s(L,b,M,k,B){var H,z;if(B===Y(L,b,M,k)>0)for(H=b;H<M;H+=k)z=D(H,L[H],L[H+1],z);else for(H=M-k;H>=b;H-=k)z=D(H,L[H],L[H+1],z);return z&&P(z,z.next)&&(F(z),z=z.next),z}function n(L,b){if(!L)return L;b||(b=L);var M=L,k;do if(k=!1,!M.steiner&&(P(M,M.next)||A(M.prev,M,M.next)===0)){if(F(M),M=b=M.prev,M===M.next)break;k=!0}else M=M.next;while(k||M!==b);return b}function r(L,b,M,k,B,H,z){if(L){!z&&H&&f(L,k,B,H);for(var V=L,q,Z;L.prev!==L.next;){if(q=L.prev,Z=L.next,H?a(L,k,B,H):o(L)){b.push(q.i/M|0),b.push(L.i/M|0),b.push(Z.i/M|0),F(L),L=Z.next,V=Z.next;continue}if(L=Z,L===V){z?z===1?(L=h(n(L),b,M),r(L,b,M,k,B,H,2)):z===2&&l(L,b,M,k,B,H):r(n(L),b,M,k,B,H,1);break}}}}function o(L){var b=L.prev,M=L,k=L.next;if(A(b,M,k)>=0)return!1;for(var B=b.x,H=M.x,z=k.x,V=b.y,q=M.y,Z=k.y,at=B<H?B<z?B:z:H<z?H:z,et=V<q?V<Z?V:Z:q<Z?q:Z,st=B>H?B>z?B:z:H>z?H:z,Q=V>q?V>Z?V:Z:q>Z?q:Z,ct=k.next;ct!==b;){if(ct.x>=at&&ct.x<=st&&ct.y>=et&&ct.y<=Q&&x(B,V,H,q,z,Z,ct.x,ct.y)&&A(ct.prev,ct,ct.next)>=0)return!1;ct=ct.next}return!0}function a(L,b,M,k){var B=L.prev,H=L,z=L.next;if(A(B,H,z)>=0)return!1;for(var V=B.x,q=H.x,Z=z.x,at=B.y,et=H.y,st=z.y,Q=V<q?V<Z?V:Z:q<Z?q:Z,ct=at<et?at<st?at:st:et<st?et:st,wt=V>q?V>Z?V:Z:q>Z?q:Z,Bt=at>et?at>st?at:st:et>st?et:st,Pt=v(Q,ct,b,M,k),Ht=v(wt,Bt,b,M,k),gt=L.prevZ,Et=L.nextZ;gt&&gt.z>=Pt&&Et&&Et.z<=Ht;){if(gt.x>=Q&&gt.x<=wt&&gt.y>=ct&&gt.y<=Bt&&gt!==B&&gt!==z&&x(V,at,q,et,Z,st,gt.x,gt.y)&&A(gt.prev,gt,gt.next)>=0||(gt=gt.prevZ,Et.x>=Q&&Et.x<=wt&&Et.y>=ct&&Et.y<=Bt&&Et!==B&&Et!==z&&x(V,at,q,et,Z,st,Et.x,Et.y)&&A(Et.prev,Et,Et.next)>=0))return!1;Et=Et.nextZ}for(;gt&&gt.z>=Pt;){if(gt.x>=Q&&gt.x<=wt&&gt.y>=ct&&gt.y<=Bt&&gt!==B&&gt!==z&&x(V,at,q,et,Z,st,gt.x,gt.y)&&A(gt.prev,gt,gt.next)>=0)return!1;gt=gt.prevZ}for(;Et&&Et.z<=Ht;){if(Et.x>=Q&&Et.x<=wt&&Et.y>=ct&&Et.y<=Bt&&Et!==B&&Et!==z&&x(V,at,q,et,Z,st,Et.x,Et.y)&&A(Et.prev,Et,Et.next)>=0)return!1;Et=Et.nextZ}return!0}function h(L,b,M){var k=L;do{var B=k.prev,H=k.next.next;!P(B,H)&&R(B,k,k.next,H)&&C(B,H)&&C(H,B)&&(b.push(B.i/M|0),b.push(k.i/M|0),b.push(H.i/M|0),F(k),F(k.next),k=L=H),k=k.next}while(k!==L);return n(k)}function l(L,b,M,k,B,H){var z=L;do{for(var V=z.next.next;V!==z.prev;){if(z.i!==V.i&&T(z,V)){var q=O(z,V);z=n(z,z.next),q=n(q,q.next),r(z,b,M,k,B,H,0),r(q,b,M,k,B,H,0);return}V=V.next}z=z.next}while(z!==L)}function u(L,b,M,k){var B=[],H,z,V,q,Z;for(H=0,z=b.length;H<z;H++)V=b[H]*k,q=H<z-1?b[H+1]*k:L.length,Z=s(L,V,q,k,!1),Z===Z.next&&(Z.steiner=!0),B.push(E(Z));for(B.sort(d),H=0;H<B.length;H++)M=p(B[H],M);return M}function d(L,b){return L.x-b.x}function p(L,b){var M=g(L,b);if(!M)return b;var k=O(M,L);return n(k,k.next),n(M,M.next)}function g(L,b){var M=b,k=L.x,B=L.y,H=-1/0,z;do{if(B<=M.y&&B>=M.next.y&&M.next.y!==M.y){var V=M.x+(B-M.y)*(M.next.x-M.x)/(M.next.y-M.y);if(V<=k&&V>H&&(H=V,z=M.x<M.next.x?M:M.next,V===k))return z}M=M.next}while(M!==b);if(!z)return null;var q=z,Z=z.x,at=z.y,et=1/0,st;M=z;do k>=M.x&&M.x>=Z&&k!==M.x&&x(B<at?k:H,B,Z,at,B<at?H:k,B,M.x,M.y)&&(st=Math.abs(B-M.y)/(k-M.x),C(M,L)&&(st<et||st===et&&(M.x>z.x||M.x===z.x&&c(z,M)))&&(z=M,et=st)),M=M.next;while(M!==q);return z}function c(L,b){return A(L.prev,L,b.prev)<0&&A(b.next,L,L.next)<0}function f(L,b,M,k){var B=L;do B.z===0&&(B.z=v(B.x,B.y,b,M,k)),B.prevZ=B.prev,B.nextZ=B.next,B=B.next;while(B!==L);B.prevZ.nextZ=null,B.prevZ=null,m(B)}function m(L){var b,M,k,B,H,z,V,q,Z=1;do{for(M=L,L=null,H=null,z=0;M;){for(z++,k=M,V=0,b=0;b<Z&&(V++,k=k.nextZ,!!k);b++);for(q=Z;V>0||q>0&&k;)V!==0&&(q===0||!k||M.z<=k.z)?(B=M,M=M.nextZ,V--):(B=k,k=k.nextZ,q--),H?H.nextZ=B:L=B,B.prevZ=H,H=B;M=k}H.nextZ=null,Z*=2}while(z>1);return L}function v(L,b,M,k,B){return L=(L-M)*B|0,b=(b-k)*B|0,L=(L|L<<8)&16711935,L=(L|L<<4)&252645135,L=(L|L<<2)&858993459,L=(L|L<<1)&1431655765,b=(b|b<<8)&16711935,b=(b|b<<4)&252645135,b=(b|b<<2)&858993459,b=(b|b<<1)&1431655765,L|b<<1}function E(L){var b=L,M=L;do(b.x<M.x||b.x===M.x&&b.y<M.y)&&(M=b),b=b.next;while(b!==L);return M}function x(L,b,M,k,B,H,z,V){return(B-z)*(b-V)>=(L-z)*(H-V)&&(L-z)*(k-V)>=(M-z)*(b-V)&&(M-z)*(H-V)>=(B-z)*(k-V)}function T(L,b){return L.next.i!==b.i&&L.prev.i!==b.i&&!w(L,b)&&(C(L,b)&&C(b,L)&&_(L,b)&&(A(L.prev,L,b.prev)||A(L,b.prev,b))||P(L,b)&&A(L.prev,L,L.next)>0&&A(b.prev,b,b.next)>0)}function A(L,b,M){return(b.y-L.y)*(M.x-b.x)-(b.x-L.x)*(M.y-b.y)}function P(L,b){return L.x===b.x&&L.y===b.y}function R(L,b,M,k){var B=I(A(L,b,M)),H=I(A(L,b,k)),z=I(A(M,k,L)),V=I(A(M,k,b));return!!(B!==H&&z!==V||B===0&&S(L,M,b)||H===0&&S(L,k,b)||z===0&&S(M,L,k)||V===0&&S(M,b,k))}function S(L,b,M){return b.x<=Math.max(L.x,M.x)&&b.x>=Math.min(L.x,M.x)&&b.y<=Math.max(L.y,M.y)&&b.y>=Math.min(L.y,M.y)}function I(L){return L>0?1:L<0?-1:0}function w(L,b){var M=L;do{if(M.i!==L.i&&M.next.i!==L.i&&M.i!==b.i&&M.next.i!==b.i&&R(M,M.next,L,b))return!0;M=M.next}while(M!==L);return!1}function C(L,b){return A(L.prev,L,L.next)<0?A(L,b,L.next)>=0&&A(L,L.prev,b)>=0:A(L,b,L.prev)<0||A(L,L.next,b)<0}function _(L,b){var M=L,k=!1,B=(L.x+b.x)/2,H=(L.y+b.y)/2;do M.y>H!=M.next.y>H&&M.next.y!==M.y&&B<(M.next.x-M.x)*(H-M.y)/(M.next.y-M.y)+M.x&&(k=!k),M=M.next;while(M!==L);return k}function O(L,b){var M=new N(L.i,L.x,L.y),k=new N(b.i,b.x,b.y),B=L.next,H=b.prev;return L.next=b,b.prev=L,M.next=B,B.prev=M,k.next=M,M.prev=k,H.next=k,k.prev=H,k}function D(L,b,M,k){var B=new N(L,b,M);return k?(B.next=k.next,B.prev=k,k.next.prev=B,k.next=B):(B.prev=B,B.next=B),B}function F(L){L.next.prev=L.prev,L.prev.next=L.next,L.prevZ&&(L.prevZ.nextZ=L.nextZ),L.nextZ&&(L.nextZ.prevZ=L.prevZ)}function N(L,b,M){this.i=L,this.x=b,this.y=M,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}i.deviation=function(L,b,M,k){var B=b&&b.length,H=B?b[0]*M:L.length,z=Math.abs(Y(L,0,H,M));if(B)for(var V=0,q=b.length;V<q;V++){var Z=b[V]*M,at=V<q-1?b[V+1]*M:L.length;z-=Math.abs(Y(L,Z,at,M))}var et=0;for(V=0;V<k.length;V+=3){var st=k[V]*M,Q=k[V+1]*M,ct=k[V+2]*M;et+=Math.abs((L[st]-L[ct])*(L[Q+1]-L[st+1])-(L[st]-L[Q])*(L[ct+1]-L[st+1]))}return z===0&&et===0?0:Math.abs((et-z)/z)};function Y(L,b,M,k){for(var B=0,H=b,z=M-k;H<M;H+=k)B+=(L[z]-L[H])*(L[H+1]+L[z+1]),z=H;return B}i.flatten=function(L){for(var b=L[0][0].length,M={vertices:[],holes:[],dimensions:b},k=0,B=0;B<L.length;B++){for(var H=0;H<L[B].length;H++)for(var z=0;z<b;z++)M.vertices.push(L[B][H][z]);B>0&&(k+=L[B-1].length,M.holes.push(k))}return M},t.exports=i}),lu=y((e,t)=>{t.exports=["#define SHADER_NAME PHASER_MULTI_FS","#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","uniform sampler2D uMainSampler[%count%];","varying vec2 outTexCoord;","varying float outTexId;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    vec4 texture;","    %forloop%","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","    vec4 color = texture * texel;","    if (outTintEffect == 1.0)","    {","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        color = texel;","    }","    gl_FragColor = color;","}"].join(`
`)}),uu=y((e,t)=>{t.exports=["#define SHADER_NAME PHASER_MULTI_VS","precision mediump float;","uniform mat4 uProjectionMatrix;","uniform vec2 uResolution;","attribute vec2 inPosition;","attribute vec2 inTexCoord;","attribute float inTexId;","attribute float inTintEffect;","attribute vec4 inTint;","varying vec2 outTexCoord;","varying float outTexId;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","    outTexCoord = inTexCoord;","    outTexId = inTexId;","    outTint = inTint;","    outTintEffect = inTintEffect;","}"].join(`
`)}),Ci=y((e,t)=>{var i=W(),s=Ey(),n=dt(),r=lu(),o=uu(),a=Re(),h=Se(),l=Fs(),u=Le(),d=new i({Extends:u,initialize:function(p){var g=p.game.renderer,c=n(p,"fragShader",r);p.fragShader=h.parseFragmentShaderMaxTextures(c,g.maxTextures),p.vertShader=n(p,"vertShader",o),p.attributes=n(p,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2},{name:"inTexId"},{name:"inTintEffect"},{name:"inTint",size:4,type:l.UNSIGNED_BYTE,normalized:!0}]),p.resizeUniform="uResolution",u.call(this,p),this._tempMatrix1=new a,this._tempMatrix2=new a,this._tempMatrix3=new a,this.calcMatrix=new a,this.tempTriangle=[{x:0,y:0,width:0},{x:0,y:0,width:0},{x:0,y:0,width:0},{x:0,y:0,width:0}],this.strokeTint={TL:0,TR:0,BL:0,BR:0},this.fillTint={TL:0,TR:0,BL:0,BR:0},this.currentFrame={u0:0,v0:0,u1:1,v1:1},this.firstQuad=[0,0,0,0,0],this.prevQuad=[0,0,0,0,0],this.polygonCache=[]},boot:function(){u.prototype.boot.call(this);var p=this.renderer;this.set1iv("uMainSampler",p.textureIndexes),this.set2f("uResolution",p.width,p.height)},batchSprite:function(p,g,c){this.manager.set(this,p);var f=this._tempMatrix1,m=this._tempMatrix2,v=this._tempMatrix3,E=p.frame,x=E.glTexture,T=E.u0,A=E.v0,P=E.u1,R=E.v1,S=E.x,I=E.y,w=E.cutWidth,C=E.cutHeight,_=E.customPivot,O=p.displayOriginX,D=p.displayOriginY,F=-O+S,N=-D+I;if(p.isCropped){var Y=p._crop;(Y.flipX!==p.flipX||Y.flipY!==p.flipY)&&E.updateCropUVs(Y,p.flipX,p.flipY),T=Y.u0,A=Y.v0,P=Y.u1,R=Y.v1,w=Y.width,C=Y.height,S=Y.x,I=Y.y,F=-O+S,N=-D+I}var L=1,b=1;p.flipX&&(_||(F+=-E.realWidth+O*2),L=-1),p.flipY&&(_||(N+=-E.realHeight+D*2),b=-1);var M=p.x,k=p.y;g.roundPixels&&(M=Math.floor(M),k=Math.floor(k)),m.applyITRS(M,k,p.rotation,p.scaleX*L,p.scaleY*b),f.copyFrom(g.matrix),c?(f.multiplyWithOffset(c,-g.scrollX*p.scrollFactorX,-g.scrollY*p.scrollFactorY),m.e=M,m.f=k):(m.e-=g.scrollX*p.scrollFactorX,m.f-=g.scrollY*p.scrollFactorY),f.multiply(m,v);var B=v.setQuad(F,N,F+w,N+C,g.renderRoundPixels),H=h.getTintAppendFloatAlpha,z=g.alpha,V=H(p.tintTopLeft,z*p._alphaTL),q=H(p.tintTopRight,z*p._alphaTR),Z=H(p.tintBottomLeft,z*p._alphaBL),at=H(p.tintBottomRight,z*p._alphaBR);this.shouldFlush(6)&&this.flush();var et=this.setGameObject(p,E);this.manager.preBatch(p),this.batchQuad(p,B[0],B[1],B[2],B[3],B[4],B[5],B[6],B[7],T,A,P,R,V,q,Z,at,p.tintFill,x,et),this.manager.postBatch(p)},batchTexture:function(p,g,c,f,m,v,E,x,T,A,P,R,S,I,w,C,_,O,D,F,N,Y,L,b,M,k,B,H,z,V,q,Z,at){at===void 0&&(at=!1),this.manager.set(this,p);var et=this._tempMatrix1,st=this._tempMatrix2,Q=this._tempMatrix3,ct=O/c+B,wt=D/f+H,Bt=(O+F)/c+B,Pt=(D+N)/f+H,Ht=E,gt=x,Et=-C,vs=-_;if(p.isCropped){var gn=p._crop,nh=gn.width,rh=gn.height;Ht=nh,gt=rh,E=nh,x=rh,O=gn.x,D=gn.y;var Mp=O,Lp=D;R&&(Mp=F-gn.x-nh),S&&(Lp=N-gn.y-rh),ct=Mp/c+B,wt=Lp/f+H,Bt=(Mp+nh)/c+B,Pt=(Lp+rh)/f+H,Et=-C+O,vs=-_+D}S=S^(!q&&g.isRenderTexture?1:0),R&&(Ht*=-1,Et+=E),S&&(gt*=-1,vs+=x),z.roundPixels&&(m=Math.floor(m),v=Math.floor(v)),st.applyITRS(m,v,P,T,A),et.copyFrom(z.matrix),V?(et.multiplyWithOffset(V,-z.scrollX*I,-z.scrollY*w),st.e=m,st.f=v):(st.e-=z.scrollX*I,st.f-=z.scrollY*w),et.multiply(st,Q);var Fi=Q.setQuad(Et,vs,Et+Ht,vs+gt,z.renderRoundPixels);Z==null&&(Z=this.setTexture2D(g)),p&&!at&&this.manager.preBatch(p),this.batchQuad(p,Fi[0],Fi[1],Fi[2],Fi[3],Fi[4],Fi[5],Fi[6],Fi[7],ct,wt,Bt,Pt,Y,L,b,M,k,g,Z),p&&!at&&this.manager.postBatch(p)},batchTextureFrame:function(p,g,c,f,m,v,E){this.manager.set(this);var x=this._tempMatrix1.copyFrom(v),T=this._tempMatrix2;E?x.multiply(E,T):T=x;var A=T.setQuad(g,c,g+p.width,c+p.height),P=this.setTexture2D(p.source.glTexture);f=h.getTintAppendFloatAlpha(f,m),this.batchQuad(null,A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],p.u0,p.v0,p.u1,p.v1,f,f,f,f,0,p.glTexture,P)},batchFillRect:function(p,g,c,f,m,v){this.renderer.pipelines.set(this);var E=this.calcMatrix;v&&v.multiply(m,E);var x=E.setQuad(p,g,p+c,g+f),T=this.fillTint;this.batchQuad(null,x[0],x[1],x[2],x[3],x[4],x[5],x[6],x[7],0,0,1,1,T.TL,T.TR,T.BL,T.BR,2)},batchFillTriangle:function(p,g,c,f,m,v,E,x){this.renderer.pipelines.set(this);var T=this.calcMatrix;x&&x.multiply(E,T);var A=T.getX(p,g),P=T.getY(p,g),R=T.getX(c,f),S=T.getY(c,f),I=T.getX(m,v),w=T.getY(m,v),C=this.fillTint;this.batchTri(null,A,P,R,S,I,w,0,0,1,1,C.TL,C.TR,C.BL,2)},batchStrokeTriangle:function(p,g,c,f,m,v,E,x,T){var A=this.tempTriangle;A[0].x=p,A[0].y=g,A[0].width=E,A[1].x=c,A[1].y=f,A[1].width=E,A[2].x=m,A[2].y=v,A[2].width=E,A[3].x=p,A[3].y=g,A[3].width=E,this.batchStrokePath(A,E,!1,x,T)},batchFillPath:function(p,g,c){this.renderer.pipelines.set(this);var f=this.calcMatrix;c&&c.multiply(g,f);for(var m=p.length,v=this.polygonCache,E,x,T=this.fillTint.TL,A=this.fillTint.TR,P=this.fillTint.BL,R=0;R<m;++R)x=p[R],v.push(x.x,x.y);E=s(v),m=E.length;for(var S=0;S<m;S+=3){var I=E[S+0]*2,w=E[S+1]*2,C=E[S+2]*2,_=v[I+0],O=v[I+1],D=v[w+0],F=v[w+1],N=v[C+0],Y=v[C+1],L=f.getX(_,O),b=f.getY(_,O),M=f.getX(D,F),k=f.getY(D,F),B=f.getX(N,Y),H=f.getY(N,Y);this.batchTri(null,L,b,M,k,B,H,0,0,1,1,T,A,P,2)}v.length=0},batchStrokePath:function(p,g,c,f,m){this.renderer.pipelines.set(this),this.prevQuad[4]=0,this.firstQuad[4]=0;for(var v=p.length-1,E=0;E<v;E++){var x=p[E],T=p[E+1];this.batchLine(x.x,x.y,T.x,T.y,x.width/2,T.width/2,g,E,!c&&E===v-1,f,m)}},batchLine:function(p,g,c,f,m,v,E,x,T,A,P){this.renderer.pipelines.set(this);var R=this.calcMatrix;P&&P.multiply(A,R);var S=c-p,I=f-g,w=Math.sqrt(S*S+I*I);if(w!==0){var C=m*(f-g)/w,_=m*(p-c)/w,O=v*(f-g)/w,D=v*(p-c)/w,F=c-O,N=f-D,Y=p-C,L=g-_,b=c+O,M=f+D,k=p+C,B=g+_,H=R.getX(F,N),z=R.getY(F,N),V=R.getX(Y,L),q=R.getY(Y,L),Z=R.getX(b,M),at=R.getY(b,M),et=R.getX(k,B),st=R.getY(k,B),Q=this.strokeTint,ct=Q.TL,wt=Q.TR,Bt=Q.BL,Pt=Q.BR;if(this.batchQuad(null,et,st,V,q,H,z,Z,at,0,0,1,1,ct,wt,Bt,Pt,2),!(E<=2)){var Ht=this.prevQuad,gt=this.firstQuad;x>0&&Ht[4]?this.batchQuad(null,et,st,V,q,Ht[0],Ht[1],Ht[2],Ht[3],0,0,1,1,ct,wt,Bt,Pt,2):(gt[0]=et,gt[1]=st,gt[2]=V,gt[3]=q,gt[4]=1),T&&gt[4]?this.batchQuad(null,H,z,Z,at,gt[0],gt[1],gt[2],gt[3],0,0,1,1,ct,wt,Bt,Pt,2):(Ht[0]=H,Ht[1]=z,Ht[2]=Z,Ht[3]=at,Ht[4]=1)}}},destroy:function(){return this._tempMatrix1.destroy(),this._tempMatrix2.destroy(),this._tempMatrix3.destroy(),this._tempMatrix1=null,this._tempMatrix1=null,this._tempMatrix1=null,u.prototype.destroy.call(this),this}});t.exports=d}),Nn=y((e,t)=>{t.exports=["#define SHADER_NAME PHASER_SINGLE_FS","#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","    vec4 color = texture * texel;","    if (outTintEffect == 1.0)","    {","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        color = texel;","    }","    gl_FragColor = color;","}"].join(`
`)}),Bn=y((e,t)=>{t.exports=["#define SHADER_NAME PHASER_SINGLE_VS","precision mediump float;","uniform mat4 uProjectionMatrix;","uniform vec2 uResolution;","attribute vec2 inPosition;","attribute vec2 inTexCoord;","attribute float inTexId;","attribute float inTintEffect;","attribute vec4 inTint;","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","    outTexCoord = inTexCoord;","    outTint = inTint;","    outTintEffect = inTintEffect;","}"].join(`
`)}),cu=y((e,t)=>{var i=Ge(),s=Ln(),n=W(),r=va(),o=dt(),a=Ci(),h=ga(),l=Ut(),u=zi(),d=Nn(),p=Bn(),g=Le(),c=new n({Extends:a,initialize:function(f){var m=o(f,"fragShader",h),v=o(f,"vertShader",p),E=o(f,"drawShader",h),x=[{name:"DrawSprite",fragShader:d,vertShader:p},{name:"CopySprite",fragShader:m,vertShader:v},{name:"DrawGame",fragShader:E,vertShader:p},{name:"ColorMatrix",fragShader:r}],T=o(f,"shaders",[]);f.shaders=x.concat(T),f.vertShader||(f.vertShader=v),f.batchSize=1,a.call(this,f),this.isPreFX=!0,this.customMainSampler=null,this.drawSpriteShader,this.copyShader,this.gameShader,this.colorMatrixShader,this.quadVertexData,this.quadVertexBuffer,this.quadVertexViewF32,this.spriteBounds=new l,this.targetBounds=new l,this.fsTarget,this.tempSprite,this.renderer.isBooted&&(this.manager=this.renderer.pipelines,this.boot())},boot:function(){g.prototype.boot.call(this);var f=this.shaders,m=this.renderer;this.drawSpriteShader=f[0],this.copyShader=f[1],this.gameShader=f[2],this.colorMatrixShader=f[3],this.fsTarget=new u(m,m.width,m.height,1,0,!0,!0),this.renderTargets=this.manager.renderTargets.concat(this.fsTarget);var v=new ArrayBuffer(168);this.quadVertexData=v,this.quadVertexViewF32=new Float32Array(v),this.quadVertexBuffer=m.createVertexBuffer(v,this.gl.STATIC_DRAW),this.onResize(m.width,m.height),this.currentShader=this.copyShader,this.set2f("uResolution",m.width,m.height)},onResize:function(f,m){var v=this.quadVertexViewF32;v[1]=m,v[22]=m,v[14]=f,v[28]=f,v[35]=f,v[36]=m},batchQuad:function(f,m,v,E,x,T,A,P,R,S,I,w,C,_,O,D,F,N,Y){var L=Math.min(m,E,T,P),b=Math.min(v,x,A,R),M=Math.max(m,E,T,P),k=Math.max(v,x,A,R),B=M-L,H=k-b,z=this.spriteBounds.setTo(L,b,B,H),V=f?f.preFX.padding:0,q=B+V*2,Z=H+V*2,at=Math.abs(Math.max(q,Z)),et=this.manager.getRenderTarget(at),st=this.targetBounds.setTo(0,0,et.width,et.height);s(st,Math.round(z.centerX),Math.round(z.centerY)),this.tempSprite=f;var Q=this.gl,ct=this.renderer;ct.clearStencilMask(),this.setShader(this.drawSpriteShader),this.set1i("uMainSampler",0),this.set2f("uResolution",ct.width,ct.height),this.flipProjectionMatrix(!0),f&&(this.onDrawSprite(f,et),f.preFX.onFX(this));var wt=this.fsTarget;return this.flush(),Q.viewport(0,0,ct.width,ct.height),Q.bindFramebuffer(Q.FRAMEBUFFER,wt.framebuffer.webGLFramebuffer),Q.framebufferTexture2D(Q.FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Q.TEXTURE_2D,wt.texture.webGLTexture,0),Q.clearColor(0,0,0,0),Q.clear(Q.COLOR_BUFFER_BIT),this.setTexture2D(Y),this.batchVert(m,v,S,I,0,N,_),this.batchVert(E,x,S,C,0,N,D),this.batchVert(T,A,w,C,0,N,F),this.batchVert(m,v,S,I,0,N,_),this.batchVert(T,A,w,C,0,N,F),this.batchVert(P,R,w,I,0,N,O),this.flush(),this.flipProjectionMatrix(!1),Q.activeTexture(Q.TEXTURE0),Q.bindTexture(Q.TEXTURE_2D,et.texture.webGLTexture),Q.copyTexSubImage2D(Q.TEXTURE_2D,0,0,0,st.x,st.y,st.width,st.height),Q.bindFramebuffer(Q.FRAMEBUFFER,null),Q.bindTexture(Q.TEXTURE_2D,null),this.onBatch(f),this.currentShader=this.copyShader,this.onDraw(et,this.manager.getSwapRenderTarget(),this.manager.getAltSwapRenderTarget()),!0},onDrawSprite:function(){},onCopySprite:function(){},copySprite:function(f,m,v,E,x,T,A){v===void 0&&(v=!0),E===void 0&&(E=!0),x===void 0&&(x=!1),A===void 0&&(A=this.copyShader);var P=this.gl,R=this.tempSprite;T&&(A=this.colorMatrixShader),this.currentShader=A;var S=this.setVertexBuffer(this.quadVertexBuffer);A.bind(S,!1);var I=this.renderer;if(this.set1i("uMainSampler",0),this.set2f("uResolution",I.width,I.height),R.preFX.onFXCopy(this),this.onCopySprite(f,m,R),T&&(this.set1fv("uColorMatrix",T.getData()),this.set1f("uAlpha",T.alpha)),P.activeTexture(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,f.texture.webGLTexture),f.height>m.height)P.viewport(0,0,f.width,f.height),this.setTargetUVs(f,m);else{var w=m.height-f.height;P.viewport(0,w,f.width,f.height),this.resetUVs()}if(P.bindFramebuffer(P.FRAMEBUFFER,m.framebuffer.webGLFramebuffer),P.framebufferTexture2D(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,P.TEXTURE_2D,m.texture.webGLTexture,0),v&&(P.clearColor(0,0,0,+!E),P.clear(P.COLOR_BUFFER_BIT)),x){var C=this.renderer.currentBlendMode;this.renderer.setBlendMode(i.ERASE)}P.bufferData(P.ARRAY_BUFFER,this.quadVertexData,P.STATIC_DRAW),P.drawArrays(P.TRIANGLES,0,6),x&&this.renderer.setBlendMode(C),P.bindFramebuffer(P.FRAMEBUFFER,null)},copy:function(f,m){var v=this.gl;this.set1i("uMainSampler",0),v.activeTexture(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,f.texture.webGLTexture),v.viewport(0,0,f.width,f.height),this.setUVs(0,0,0,1,1,1,1,0),v.bindFramebuffer(v.FRAMEBUFFER,m.framebuffer.webGLFramebuffer),v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,v.TEXTURE_2D,m.texture.webGLTexture,0),v.clearColor(0,0,0,0),v.clear(v.COLOR_BUFFER_BIT),v.bufferData(v.ARRAY_BUFFER,this.quadVertexData,v.STATIC_DRAW),v.drawArrays(v.TRIANGLES,0,6),v.bindFramebuffer(v.FRAMEBUFFER,null)},blendFrames:function(f,m,v,E,x){this.manager.blendFrames(f,m,v,E,x)},blendFramesAdditive:function(f,m,v,E,x){this.manager.blendFramesAdditive(f,m,v,E,x)},drawToGame:function(f){this.currentShader=null,this.setShader(this.copyShader),this.bindAndDraw(f)},copyToGame:function(f){this.currentShader=null,this.setShader(this.gameShader),this.bindAndDraw(f)},bindAndDraw:function(f){var m=this.gl,v=this.renderer;this.set1i("uMainSampler",0),this.customMainSampler?this.setTexture2D(this.customMainSampler):this.setTexture2D(f.texture);var E=this._tempMatrix1.loadIdentity(),x=this.targetBounds.x,T=this.targetBounds.y,A=x+f.width,P=T+f.height,R=E.getX(x,T),S=E.getX(x,P),I=E.getX(A,P),w=E.getX(A,T),C=E.getY(x,T),_=E.getY(x,P),O=E.getY(A,P),D=E.getY(A,T),F=16777215;this.batchVert(R,C,0,0,0,0,F),this.batchVert(S,_,0,1,0,0,F),this.batchVert(I,O,1,1,0,0,F),this.batchVert(R,C,0,0,0,0,F),this.batchVert(I,O,1,1,0,0,F),this.batchVert(w,D,1,0,0,0,F),v.restoreFramebuffer(!1,!0),v.currentFramebuffer||m.viewport(0,0,v.width,v.height),v.restoreStencilMask(),this.flush(),this.tempSprite=null},onDraw:function(f){this.drawToGame(f)},setUVs:function(f,m,v,E,x,T,A,P){var R=this.quadVertexViewF32;R[2]=f,R[3]=m,R[9]=v,R[10]=E,R[16]=x,R[17]=T,R[23]=f,R[24]=m,R[30]=x,R[31]=T,R[37]=A,R[38]=P},setTargetUVs:function(f,m){var v=m.height/f.height;v>.5?v=.5-(v-.5):v=.5+(.5-v),this.setUVs(0,v,0,1+v,1,1+v,1,v)},resetUVs:function(){this.setUVs(0,0,0,1,1,1,1,0)},destroy:function(){return this.renderer.deleteBuffer(this.quadVertexBuffer),this.drawSpriteShader=null,this.copyShader=null,this.gameShader=null,this.colorMatrixShader=null,this.quadVertexData=null,this.quadVertexBuffer=null,this.quadVertexViewF32=null,this.fsTarget=null,this.tempSprite=null,a.prototype.destroy.call(this),this}});t.exports=c}),du=y((e,t)=>{t.exports=["#define SHADER_NAME PHASER_ADD_BLEND_FS","precision mediump float;","uniform sampler2D uMainSampler1;","uniform sampler2D uMainSampler2;","uniform float uStrength;","varying vec2 outTexCoord;","void main ()","{","    vec4 frame1 = texture2D(uMainSampler1, outTexCoord);","    vec4 frame2 = texture2D(uMainSampler2, outTexCoord);","    gl_FragColor = frame1 + frame2 * uStrength;","}"].join(`
`)}),pu=y((e,t)=>{t.exports=["#define SHADER_NAME PHASER_COPY_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform float uBrightness;","varying vec2 outTexCoord;","void main ()","{","    gl_FragColor = texture2D(uMainSampler, outTexCoord) * uBrightness;","}"].join(`
`)}),gu=y((e,t)=>{t.exports=["#define SHADER_NAME PHASER_LIGHT_FS","precision mediump float;","struct Light","{","    vec2 position;","    vec3 color;","    float intensity;","    float radius;","};","const int kMaxLights = %LIGHT_COUNT%;","uniform vec4 uCamera; /* x, y, rotation, zoom */","uniform vec2 uResolution;","uniform sampler2D uMainSampler;","uniform sampler2D uNormSampler;","uniform vec3 uAmbientLightColor;","uniform Light uLights[kMaxLights];","uniform mat3 uInverseRotationMatrix;","uniform int uLightCount;","varying vec2 outTexCoord;","varying float outTexId;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    vec3 finalColor = vec3(0.0, 0.0, 0.0);","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec4 color = texture * texel;","    if (outTintEffect == 1.0)","    {","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        color = texel;","    }","    vec3 normalMap = texture2D(uNormSampler, outTexCoord).rgb;","    vec3 normal = normalize(uInverseRotationMatrix * vec3(normalMap * 2.0 - 1.0));","    vec2 res = vec2(min(uResolution.x, uResolution.y)) * uCamera.w;","    for (int index = 0; index < kMaxLights; ++index)","    {","        if (index < uLightCount)","        {","            Light light = uLights[index];","            vec3 lightDir = vec3((light.position.xy / res) - (gl_FragCoord.xy / res), 0.1);","            vec3 lightNormal = normalize(lightDir);","            float distToSurf = length(lightDir) * uCamera.w;","            float diffuseFactor = max(dot(normal, lightNormal), 0.0);","            float radius = (light.radius / res.x * uCamera.w) * uCamera.w;","            float attenuation = clamp(1.0 - distToSurf * distToSurf / (radius * radius), 0.0, 1.0);","            vec3 diffuse = light.color * diffuseFactor;","            finalColor += (attenuation * diffuse) * light.intensity;","        }","    }","    vec4 colorOutput = vec4(uAmbientLightColor + finalColor, 1.0);","    gl_FragColor = color * vec4(colorOutput.rgb * colorOutput.a, colorOutput.a);","}"].join(`
`)}),fu=y((e,t)=>{t.exports=["#define SHADER_NAME PHASER_LINEAR_BLEND_FS","precision mediump float;","uniform sampler2D uMainSampler1;","uniform sampler2D uMainSampler2;","uniform float uStrength;","varying vec2 outTexCoord;","void main ()","{","    vec4 frame1 = texture2D(uMainSampler1, outTexCoord);","    vec4 frame2 = texture2D(uMainSampler2, outTexCoord);","    gl_FragColor = mix(frame1, frame2 * uStrength, 0.5);","}"].join(`
`)}),yy=y((e,t)=>{t.exports=["#define SHADER_NAME PHASER_MESH_FS","precision mediump float;","uniform vec3 uLightPosition;","uniform vec3 uLightAmbient;","uniform vec3 uLightDiffuse;","uniform vec3 uLightSpecular;","uniform vec3 uFogColor;","uniform float uFogNear;","uniform float uFogFar;","uniform vec3 uMaterialAmbient;","uniform vec3 uMaterialDiffuse;","uniform vec3 uMaterialSpecular;","uniform float uMaterialShine;","uniform vec3 uCameraPosition;","uniform sampler2D uTexture;","varying vec2 vTextureCoord;","varying vec3 vNormal;","varying vec3 vPosition;","void main (void)","{","    vec4 color = texture2D(uTexture, vTextureCoord);","    vec3 ambient = uLightAmbient * uMaterialAmbient;","    vec3 norm = normalize(vNormal);","    vec3 lightDir = normalize(uLightPosition - vPosition);","    float diff = max(dot(norm, lightDir), 0.0);","    vec3 diffuse = uLightDiffuse * (diff * uMaterialDiffuse);","    vec3 viewDir = normalize(uCameraPosition - vPosition);","    vec3 reflectDir = reflect(-lightDir, norm);","    float spec = pow(max(dot(viewDir, reflectDir), 0.0), uMaterialShine);","    vec3 specular = uLightSpecular * (spec * uMaterialSpecular);","    vec3 result = (ambient + diffuse + specular) * color.rgb;","    float depth = gl_FragCoord.z / gl_FragCoord.w;","    float fogFactor = smoothstep(uFogNear, uFogFar, depth);","    gl_FragColor.rgb = mix(result.rgb, uFogColor, fogFactor);","    gl_FragColor.a = color.a;","}"].join(`
`)}),Ty=y((e,t)=>{t.exports=["#define SHADER_NAME PHASER_MESH_VS","precision mediump float;","attribute vec3 aVertexPosition;","attribute vec3 aVertexNormal;","attribute vec2 aTextureCoord;","uniform mat4 uViewProjectionMatrix;","uniform mat4 uModelMatrix;","uniform mat4 uNormalMatrix;","varying vec2 vTextureCoord;","varying vec3 vNormal;","varying vec3 vPosition;","void main ()","{","    vTextureCoord = aTextureCoord;","    vPosition = vec3(uModelMatrix * vec4(aVertexPosition, 1.0));","    vNormal = vec3(uNormalMatrix * vec4(aVertexNormal, 1.0));","    gl_Position = uViewProjectionMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);","}"].join(`
`)}),xy=y((e,t)=>{t.exports=["#define SHADER_NAME PHASER_MOBILE_FS","#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec4 color = texture * texel;","    if (outTintEffect == 1.0)","    {","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        color = texel;","    }","    gl_FragColor = color;","}"].join(`
`)}),Sy=y((e,t)=>{t.exports=["#define SHADER_NAME PHASER_MOBILE_VS","precision mediump float;","uniform mat4 uProjectionMatrix;","uniform vec2 uResolution;","attribute vec2 inPosition;","attribute vec2 inTexCoord;","attribute float inTexId;","attribute float inTintEffect;","attribute vec4 inTint;","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","    outTexCoord = inTexCoord;","    outTint = inTint;","    outTintEffect = inTintEffect;","}"].join(`
`)}),mu=y((e,t)=>{t.exports=["#define SHADER_NAME PHASER_POINTLIGHT_FS","precision mediump float;","uniform vec2 uResolution;","uniform float uCameraZoom;","varying vec4 lightPosition;","varying vec4 lightColor;","varying float lightRadius;","varying float lightAttenuation;","void main ()","{","    vec2 center = (lightPosition.xy + 1.0) * (uResolution.xy * 0.5);","    float distToSurf = length(center - gl_FragCoord.xy);","    float radius = 1.0 - distToSurf / (lightRadius * uCameraZoom);","    float intensity = smoothstep(0.0, 1.0, radius * lightAttenuation);","    vec4 color = vec4(intensity, intensity, intensity, 0.0) * lightColor;","    gl_FragColor = vec4(color.rgb * lightColor.a, color.a);","}"].join(`
`)}),vu=y((e,t)=>{t.exports=["#define SHADER_NAME PHASER_POINTLIGHT_VS","precision mediump float;","uniform mat4 uProjectionMatrix;","attribute vec2 inPosition;","attribute vec2 inLightPosition;","attribute vec4 inLightColor;","attribute float inLightRadius;","attribute float inLightAttenuation;","varying vec4 lightPosition;","varying vec4 lightColor;","varying float lightRadius;","varying float lightAttenuation;","void main ()","{","    lightColor = inLightColor;","    lightRadius = inLightRadius;","    lightAttenuation = inLightAttenuation;","    lightPosition = uProjectionMatrix * vec4(inLightPosition, 1.0, 1.0);","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","}"].join(`
`)}),Ay=y((e,t)=>{t.exports={AddBlendFrag:du(),BitmapMaskFrag:zl(),BitmapMaskVert:Wl(),ColorMatrixFrag:va(),CopyFrag:pu(),FXBarrelFrag:jl(),FXBloomFrag:Zl(),FXBlurHighFrag:Ql(),FXBlurLowFrag:ql(),FXBlurMedFrag:Jl(),FXBokehFrag:$l(),FXCircleFrag:tu(),FXDisplacementFrag:eu(),FXGlowFrag:iu(),FXGradientFrag:su(),FXPixelateFrag:nu(),FXShadowFrag:ru(),FXShineFrag:au(),FXVignetteFrag:ou(),FXWipeFrag:hu(),LightFrag:gu(),LinearBlendFrag:fu(),MeshFrag:yy(),MeshVert:Ty(),MobileFrag:xy(),MobileVert:Sy(),MultiFrag:lu(),MultiVert:uu(),PointLightFrag:mu(),PointLightVert:vu(),PostFXFrag:ga(),QuadVert:fa(),SingleFrag:Nn(),SingleVert:Bn()}}),Eu=y((e,t)=>{var i=W(),s=ma(),n=Wt(),r=dt(),o=cu(),a=Ay(),h=Se(),l=new i({Extends:o,initialize:function(u){u.shaders=[h.setGlowQuality(a.FXGlowFrag,u.game),a.FXShadowFrag,a.FXPixelateFrag,a.FXVignetteFrag,a.FXShineFrag,a.FXBlurLowFrag,a.FXBlurMedFrag,a.FXBlurHighFrag,a.FXGradientFrag,a.FXBloomFrag,a.ColorMatrixFrag,a.FXCircleFrag,a.FXBarrelFrag,a.FXDisplacementFrag,a.FXWipeFrag,a.FXBokehFrag],o.call(this,u);var d=this.game;this.glow=new s.Glow(d),this.shadow=new s.Shadow(d),this.pixelate=new s.Pixelate(d),this.vignette=new s.Vignette(d),this.shine=new s.Shine(d),this.gradient=new s.Gradient(d),this.circle=new s.Circle(d),this.barrel=new s.Barrel(d),this.wipe=new s.Wipe(d),this.bokeh=new s.Bokeh(d);var p=[];p[n.GLOW]=this.onGlow,p[n.SHADOW]=this.onShadow,p[n.PIXELATE]=this.onPixelate,p[n.VIGNETTE]=this.onVignette,p[n.SHINE]=this.onShine,p[n.BLUR]=this.onBlur,p[n.GRADIENT]=this.onGradient,p[n.BLOOM]=this.onBloom,p[n.COLOR_MATRIX]=this.onColorMatrix,p[n.CIRCLE]=this.onCircle,p[n.BARREL]=this.onBarrel,p[n.DISPLACEMENT]=this.onDisplacement,p[n.WIPE]=this.onWipe,p[n.BOKEH]=this.onBokeh,this.fxHandlers=p,this.source,this.target,this.swap},onDraw:function(u,d,p){this.source=u,this.target=d,this.swap=p;var g=u.width,c=u.height,f=this.tempSprite,m=this.fxHandlers;if(f&&f.preFX)for(var v=f.preFX.list,E=0;E<v.length;E++){var x=v[E];x.active&&m[x.type].call(this,x,g,c)}this.drawToGame(this.source)},runDraw:function(){var u=this.source,d=this.target;this.copy(u,d),this.source=d,this.target=u},onGlow:function(u,d,p){var g=this.shaders[n.GLOW];this.setShader(g),this.glow.onPreRender(u,g,d,p),this.runDraw()},onShadow:function(u){var d=this.shaders[n.SHADOW];this.setShader(d),this.shadow.onPreRender(u,d),this.runDraw()},onPixelate:function(u,d,p){var g=this.shaders[n.PIXELATE];this.setShader(g),this.pixelate.onPreRender(u,g,d,p),this.runDraw()},onVignette:function(u){var d=this.shaders[n.VIGNETTE];this.setShader(d),this.vignette.onPreRender(u,d),this.runDraw()},onShine:function(u,d,p){var g=this.shaders[n.SHINE];this.setShader(g),this.shine.onPreRender(u,g,d,p),this.runDraw()},onBlur:function(u,d,p){var g=r(u,"quality"),c=this.shaders[n.BLUR+g];this.setShader(c),this.set1i("uMainSampler",0),this.set2f("resolution",d,p),this.set1f("strength",r(u,"strength")),this.set3fv("color",r(u,"glcolor"));for(var f=r(u,"x"),m=r(u,"y"),v=r(u,"steps"),E=0;E<v;E++)this.set2f("offset",f,0),this.runDraw(),this.set2f("offset",0,m),this.runDraw()},onGradient:function(u){var d=this.shaders[n.GRADIENT];this.setShader(d),this.gradient.onPreRender(u,d),this.runDraw()},onBloom:function(u,d,p){var g=this.shaders[n.BLOOM];this.copySprite(this.source,this.swap),this.setShader(g),this.set1i("uMainSampler",0),this.set1f("strength",r(u,"blurStrength")),this.set3fv("color",r(u,"glcolor"));for(var c=2/d*r(u,"offsetX"),f=2/p*r(u,"offsetY"),m=r(u,"steps"),v=0;v<m;v++)this.set2f("offset",c,0),this.runDraw(),this.set2f("offset",0,f),this.runDraw();this.blendFrames(this.swap,this.source,this.target,r(u,"strength")),this.copySprite(this.target,this.source)},onColorMatrix:function(u){this.setShader(this.colorMatrixShader),this.set1fv("uColorMatrix",u.getData()),this.set1f("uAlpha",u.alpha),this.runDraw()},onCircle:function(u,d,p){var g=this.shaders[n.CIRCLE];this.setShader(g),this.circle.onPreRender(u,g,d,p),this.runDraw()},onBarrel:function(u){var d=this.shaders[n.BARREL];this.setShader(d),this.barrel.onPreRender(u,d),this.runDraw()},onDisplacement:function(u){this.setShader(this.shaders[n.DISPLACEMENT]),this.set1i("uDisplacementSampler",1),this.set2f("amount",u.x,u.y),this.bindTexture(u.glTexture,1),this.runDraw()},onWipe:function(u){var d=this.shaders[n.WIPE];this.setShader(d),this.wipe.onPreRender(u,d),this.runDraw()},onBokeh:function(u,d,p){var g=this.shaders[n.BOKEH];this.setShader(g),this.bokeh.onPreRender(u,g,d,p),this.runDraw()},destroy:function(){return this.glow.destroy(),this.shadow.destroy(),this.pixelate.destroy(),this.vignette.destroy(),this.shine.destroy(),this.gradient.destroy(),this.circle.destroy(),this.barrel.destroy(),this.wipe.destroy(),this.bokeh.destroy(),this.fxHandlers=null,this.source=null,this.target=null,this.swap=null,o.prototype.destroy.call(this),this}});t.exports=l}),yu=y((e,t)=>{var i=W(),s=dt(),n=gu(),r=Ci(),o=Re(),a=xt(),h=Le(),l=new i({Extends:r,initialize:function(u){var d=s(u,"fragShader",n);u.fragShader=d.replace("%LIGHT_COUNT%",u.game.renderer.config.maxLights),r.call(this,u),this.inverseRotationMatrix=new Float32Array([1,0,0,0,1,0,0,0,1]),this.currentNormalMap,this.lightsActive=!0,this.tempVec2=new a,this._tempMatrix=new o,this._tempMatrix2=new o},boot:function(){h.prototype.boot.call(this)},onRender:function(u,d){var p=u.sys.lights;if(this.lightsActive=!1,!(!p||!p.active)){var g=p.getLights(d),c=g.length;this.lightsActive=!0;var f,m=this.renderer,v=m.height,E=d.matrix,x=this.tempVec2;for(this.set1i("uMainSampler",0),this.set1i("uNormSampler",1),this.set2f("uResolution",this.width/2,this.height/2),this.set4f("uCamera",d.x,d.y,d.rotation,d.zoom),this.set3f("uAmbientLightColor",p.ambientColor.r,p.ambientColor.g,p.ambientColor.b),this.set1i("uLightCount",c),f=0;f<c;f++){var T=g[f].light,A=T.color,P="uLights["+f+"].";E.transformPoint(T.x,T.y,x),this.set2f(P+"position",x.x-d.scrollX*T.scrollFactorX*d.zoom,v-(x.y-d.scrollY*T.scrollFactorY*d.zoom)),this.set3f(P+"color",A.r,A.g,A.b),this.set1f(P+"intensity",T.intensity),this.set1f(P+"radius",T.radius)}this.currentNormalMapRotation=null}},setNormalMapRotation:function(u){if(u!==this.currentNormalMapRotation||this.vertexCount===0){this.vertexCount>0&&this.flush();var d=this.inverseRotationMatrix;if(u){var p=-u,g=Math.cos(p),c=Math.sin(p);d[1]=c,d[3]=-c,d[0]=d[4]=g}else d[0]=d[4]=1,d[1]=d[3]=0;this.setMatrix3fv("uInverseRotationMatrix",!1,d),this.currentNormalMapRotation=u}},setTexture2D:function(u,d){var p=this.renderer;u===void 0&&(u=p.whiteTexture);var g=this.getNormalMap(d);this.isNewNormalMap(u,g)&&(this.flush(),this.createBatch(u),this.addTextureToBatch(g),this.currentNormalMap=g);var c=0;if(d&&d.parentContainer){var f=d.getWorldTransformMatrix(this._tempMatrix,this._tempMatrix2);c=f.rotationNormalized}else d&&(c=d.rotation);return this.currentBatch===null&&(this.createBatch(u),this.addTextureToBatch(g)),this.setNormalMapRotation(c),0},setGameObject:function(u,d){d===void 0&&(d=u.frame);var p=d.glTexture,g=this.getNormalMap(u);if(this.isNewNormalMap(p,g)&&(this.flush(),this.createBatch(p),this.addTextureToBatch(g),this.currentNormalMap=g),u.parentContainer){var c=u.getWorldTransformMatrix(this._tempMatrix,this._tempMatrix2);this.setNormalMapRotation(c.rotationNormalized)}else this.setNormalMapRotation(u.rotation);return this.currentBatch===null&&(this.createBatch(p),this.addTextureToBatch(g)),0},isNewNormalMap:function(u,d){return this.currentTexture!==u||this.currentNormalMap!==d},getNormalMap:function(u){var d;if(u)u.displayTexture?d=u.displayTexture.dataSource[u.displayFrame.sourceIndex]:u.texture?d=u.texture.dataSource[u.frame.sourceIndex]:u.tileset&&(Array.isArray(u.tileset)?d=u.tileset[0].image.dataSource[0]:d=u.tileset.image.dataSource[0]);else return this.renderer.normalTexture;return d?d.glTexture:this.renderer.normalTexture},batchSprite:function(u,d,p){this.lightsActive&&r.prototype.batchSprite.call(this,u,d,p)},batchTexture:function(u,d,p,g,c,f,m,v,E,x,T,A,P,R,S,I,w,C,_,O,D,F,N,Y,L,b,M,k,B,H,z,V){this.lightsActive&&r.prototype.batchTexture.call(this,u,d,p,g,c,f,m,v,E,x,T,A,P,R,S,I,w,C,_,O,D,F,N,Y,L,b,M,k,B,H,z,V)},batchTextureFrame:function(u,d,p,g,c,f,m){this.lightsActive&&r.prototype.batchTextureFrame.call(this,u,d,p,g,c,f,m)}});t.exports=l}),Tu=y((e,t)=>{var i=W(),s=dt(),n=Ci(),r=Nn(),o=Bn(),a=Fs(),h=Le(),l=new i({Extends:n,initialize:function(u){u.fragShader=s(u,"fragShader",r),u.vertShader=s(u,"vertShader",o),u.attributes=s(u,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2},{name:"inTexId"},{name:"inTintEffect"},{name:"inTint",size:4,type:a.UNSIGNED_BYTE,normalized:!0}]),u.forceZero=!0,u.resizeUniform="uResolution",n.call(this,u)},boot:function(){h.prototype.boot.call(this);var u=this.renderer;this.set1i("uMainSampler",0),this.set2f("uResolution",u.width,u.height)}});t.exports=l}),xu=y((e,t)=>{var i=W(),s=dt(),n=mu(),r=vu(),o=Le(),a=new i({Extends:o,initialize:function(h){h.vertShader=s(h,"vertShader",r),h.fragShader=s(h,"fragShader",n),h.attributes=s(h,"attributes",[{name:"inPosition",size:2},{name:"inLightPosition",size:2},{name:"inLightRadius"},{name:"inLightAttenuation"},{name:"inLightColor",size:4}]),o.call(this,h)},onRender:function(h,l){this.set2f("uResolution",this.width,this.height),this.set1f("uCameraZoom",l.zoom)},batchPointLight:function(h,l,u,d,p,g,c,f,m,v,E,x){var T=h.color,A=h.intensity,P=h.radius,R=h.attenuation,S=T.r*A,I=T.g*A,w=T.b*A,C=l.alpha*h.alpha;this.shouldFlush(6)&&this.flush(),this.currentBatch||this.setTexture2D(),this.batchLightVert(u,d,E,x,P,R,S,I,w,C),this.batchLightVert(p,g,E,x,P,R,S,I,w,C),this.batchLightVert(c,f,E,x,P,R,S,I,w,C),this.batchLightVert(u,d,E,x,P,R,S,I,w,C),this.batchLightVert(c,f,E,x,P,R,S,I,w,C),this.batchLightVert(m,v,E,x,P,R,S,I,w,C),this.currentBatch.count=this.vertexCount-this.currentBatch.start},batchLightVert:function(h,l,u,d,p,g,c,f,m,v){var E=this.vertexViewF32,x=this.vertexCount*this.currentShader.vertexComponentCount-1;E[++x]=h,E[++x]=l,E[++x]=u,E[++x]=d,E[++x]=p,E[++x]=g,E[++x]=c,E[++x]=f,E[++x]=m,E[++x]=v,this.vertexCount++}});t.exports=a}),Su=y((e,t)=>{var i=W(),s=dt(),n=Ci(),r=new i({Extends:n,initialize:function(o){o.topology=5,o.batchSize=s(o,"batchSize",256),n.call(this,o)}});t.exports=r}),Au=y((e,t)=>{var i=W(),s=dt(),n=Ci(),r=Nn(),o=Bn(),a=Le(),h=new i({Extends:n,initialize:function(l){l.fragShader=s(l,"fragShader",r),l.vertShader=s(l,"vertShader",o),l.forceZero=!0,n.call(this,l)},boot:function(){a.prototype.boot.call(this);var l=this.renderer;this.set1i("uMainSampler",0),this.set2f("uResolution",l.width,l.height)}});t.exports=h}),wu=y((e,t)=>{var i=du(),s=Ge(),n=W(),r=qr(),o=va(),a=pu(),h=dt(),l=fu(),u=fa(),d=Le(),p=new n({Extends:d,initialize:function(g){g.renderTarget=h(g,"renderTarget",[{scale:1,autoResize:!0},{scale:1,autoResize:!0},{scale:.5,autoResize:!0},{scale:.5,autoResize:!0}]),g.vertShader=h(g,"vertShader",u),g.shaders=h(g,"shaders",[{name:"Copy",fragShader:a},{name:"AddBlend",fragShader:i},{name:"LinearBlend",fragShader:l},{name:"ColorMatrix",fragShader:o}]),g.attributes=h(g,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2}]),g.vertices=[-1,-1,0,0,-1,1,0,1,1,1,1,1,-1,-1,0,0,1,1,1,1,1,-1,1,0],g.batchSize=1,d.call(this,g),this.colorMatrix=new r,this.copyShader,this.addShader,this.linearShader,this.colorMatrixShader,this.fullFrame1,this.fullFrame2,this.halfFrame1,this.halfFrame2},boot:function(){d.prototype.boot.call(this);var g=this.shaders,c=this.renderTargets;this.copyShader=g[0],this.addShader=g[1],this.linearShader=g[2],this.colorMatrixShader=g[3],this.fullFrame1=c[0],this.fullFrame2=c[1],this.halfFrame1=c[2],this.halfFrame2=c[3]},copyFrame:function(g,c,f,m,v){f===void 0&&(f=1),m===void 0&&(m=!0),v===void 0&&(v=!0);var E=this.gl;this.setShader(this.copyShader),this.set1i("uMainSampler",0),this.set1f("uBrightness",f),E.activeTexture(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,g.texture.webGLTexture),c?(E.viewport(0,0,c.width,c.height),E.bindFramebuffer(E.FRAMEBUFFER,c.framebuffer.webGLFramebuffer),E.framebufferTexture2D(E.FRAMEBUFFER,E.COLOR_ATTACHMENT0,E.TEXTURE_2D,c.texture.webGLTexture,0)):E.viewport(0,0,g.width,g.height),m&&(v?E.clearColor(0,0,0,0):E.clearColor(0,0,0,1),E.clear(E.COLOR_BUFFER_BIT)),E.bufferData(E.ARRAY_BUFFER,this.vertexData,E.STATIC_DRAW),E.drawArrays(E.TRIANGLES,0,6),E.bindFramebuffer(E.FRAMEBUFFER,null),E.bindTexture(E.TEXTURE_2D,null)},blitFrame:function(g,c,f,m,v,E,x){f===void 0&&(f=1),m===void 0&&(m=!0),v===void 0&&(v=!0),E===void 0&&(E=!1),x===void 0&&(x=!1);var T=this.gl;if(this.setShader(this.copyShader),this.set1i("uMainSampler",0),this.set1f("uBrightness",f),T.activeTexture(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,g.texture.webGLTexture),g.height>c.height)T.viewport(0,0,g.width,g.height),this.setTargetUVs(g,c);else{var A=c.height-g.height;T.viewport(0,A,g.width,g.height)}if(T.bindFramebuffer(T.FRAMEBUFFER,c.framebuffer.webGLFramebuffer),T.framebufferTexture2D(T.FRAMEBUFFER,T.COLOR_ATTACHMENT0,T.TEXTURE_2D,c.texture.webGLTexture,0),m&&(v?T.clearColor(0,0,0,0):T.clearColor(0,0,0,1),T.clear(T.COLOR_BUFFER_BIT)),E){var P=this.renderer.currentBlendMode;this.renderer.setBlendMode(s.ERASE)}x&&this.flipY(),T.bufferData(T.ARRAY_BUFFER,this.vertexData,T.STATIC_DRAW),T.drawArrays(T.TRIANGLES,0,6),E&&this.renderer.setBlendMode(P),T.bindFramebuffer(T.FRAMEBUFFER,null),T.bindTexture(T.TEXTURE_2D,null),this.resetUVs()},copyFrameRect:function(g,c,f,m,v,E,x,T){x===void 0&&(x=!0),T===void 0&&(T=!0);var A=this.gl;A.bindFramebuffer(A.FRAMEBUFFER,g.framebuffer.webGLFramebuffer),A.framebufferTexture2D(A.FRAMEBUFFER,A.COLOR_ATTACHMENT0,A.TEXTURE_2D,g.texture.webGLTexture,0),x&&(T?A.clearColor(0,0,0,0):A.clearColor(0,0,0,1),A.clear(A.COLOR_BUFFER_BIT)),A.activeTexture(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,c.texture.webGLTexture),A.copyTexSubImage2D(A.TEXTURE_2D,0,0,0,f,m,v,E),A.bindFramebuffer(A.FRAMEBUFFER,null),A.bindTexture(A.TEXTURE_2D,null)},copyToGame:function(g){var c=this.gl;this.setShader(this.copyShader),this.set1i("uMainSampler",0),this.set1f("uBrightness",1),this.renderer.popFramebuffer(),c.activeTexture(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,g.texture.webGLTexture),c.bufferData(c.ARRAY_BUFFER,this.vertexData,c.STATIC_DRAW),c.drawArrays(c.TRIANGLES,0,6)},drawFrame:function(g,c,f,m){f===void 0&&(f=!0),m===void 0&&(m=this.colorMatrix);var v=this.gl;this.setShader(this.colorMatrixShader),this.set1i("uMainSampler",0),this.set1fv("uColorMatrix",m.getData()),this.set1f("uAlpha",m.alpha),v.activeTexture(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,g.texture.webGLTexture),c?(v.viewport(0,0,c.width,c.height),v.bindFramebuffer(v.FRAMEBUFFER,c.framebuffer.webGLFramebuffer),v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,v.TEXTURE_2D,c.texture.webGLTexture,0)):v.viewport(0,0,g.width,g.height),f?v.clearColor(0,0,0,0):v.clearColor(0,0,0,1),v.clear(v.COLOR_BUFFER_BIT),v.bufferData(v.ARRAY_BUFFER,this.vertexData,v.STATIC_DRAW),v.drawArrays(v.TRIANGLES,0,6),v.bindFramebuffer(v.FRAMEBUFFER,null),v.bindTexture(v.TEXTURE_2D,null)},blendFrames:function(g,c,f,m,v,E){m===void 0&&(m=1),v===void 0&&(v=!0),E===void 0&&(E=this.linearShader);var x=this.gl;this.setShader(E),this.set1i("uMainSampler1",0),this.set1i("uMainSampler2",1),this.set1f("uStrength",m),x.activeTexture(x.TEXTURE0),x.bindTexture(x.TEXTURE_2D,g.texture.webGLTexture),x.activeTexture(x.TEXTURE1),x.bindTexture(x.TEXTURE_2D,c.texture.webGLTexture),f?(x.bindFramebuffer(x.FRAMEBUFFER,f.framebuffer.webGLFramebuffer),x.framebufferTexture2D(x.FRAMEBUFFER,x.COLOR_ATTACHMENT0,x.TEXTURE_2D,f.texture.webGLTexture,0),x.viewport(0,0,f.width,f.height)):x.viewport(0,0,g.width,g.height),v?x.clearColor(0,0,0,0):x.clearColor(0,0,0,1),x.clear(x.COLOR_BUFFER_BIT),x.bufferData(x.ARRAY_BUFFER,this.vertexData,x.STATIC_DRAW),x.drawArrays(x.TRIANGLES,0,6),x.bindFramebuffer(x.FRAMEBUFFER,null),x.bindTexture(x.TEXTURE_2D,null)},blendFramesAdditive:function(g,c,f,m,v){this.blendFrames(g,c,f,m,v,this.addShader)},clearFrame:function(g,c){c===void 0&&(c=!0);var f=this.gl;f.viewport(0,0,g.width,g.height),f.bindFramebuffer(f.FRAMEBUFFER,g.framebuffer.webGLFramebuffer),c?f.clearColor(0,0,0,0):f.clearColor(0,0,0,1),f.clear(f.COLOR_BUFFER_BIT);var m=this.renderer.currentFramebuffer;f.bindFramebuffer(f.FRAMEBUFFER,m.webGLFramebuffer)},setUVs:function(g,c,f,m,v,E,x,T){var A=this.vertexViewF32;A[2]=g,A[3]=c,A[6]=f,A[7]=m,A[10]=v,A[11]=E,A[14]=g,A[15]=c,A[18]=v,A[19]=E,A[22]=x,A[23]=T},setTargetUVs:function(g,c){var f=c.height/g.height;f>.5?f=.5-(f-.5):f=.5+(.5-f),this.setUVs(0,f,0,1+f,1,1+f,1,f)},flipX:function(){this.setUVs(1,0,1,1,0,1,0,0)},flipY:function(){this.setUVs(0,1,0,0,1,0,1,1)},resetUVs:function(){this.setUVs(0,0,0,1,1,1,1,0)}});t.exports=p}),Cu=y((e,t)=>{var i=W(),s=Fn(),n=Es(),r=An(),o=dt(),a=zi(),h=Fl(),l=Kl(),u=ma(),d=Wt(),p=Eu(),g=yu(),c=Tu(),f=Ci(),m=xu(),v=Su(),E=Au(),x=wu(),T=xn(),A=Ye(),P=new i({initialize:function(R){this.game=R.game,this.renderer=R,this.classes=new n([[s.UTILITY_PIPELINE,x],[s.MULTI_PIPELINE,f],[s.BITMAPMASK_PIPELINE,l],[s.SINGLE_PIPELINE,E],[s.ROPE_PIPELINE,v],[s.LIGHT_PIPELINE,g],[s.POINTLIGHT_PIPELINE,m],[s.MOBILE_PIPELINE,c]]),this.postPipelineClasses=new n,this.pipelines=new n,this.postPipelineInstances=[],this.default=null,this.current=null,this.previous=null,this.MULTI_PIPELINE=null,this.BITMAPMASK_PIPELINE=null,this.UTILITY_PIPELINE=null,this.MOBILE_PIPELINE=null,this.FX_PIPELINE=null,this.fullFrame1,this.fullFrame2,this.halfFrame1,this.halfFrame2,this.renderTargets=[],this.maxDimension=0,this.frameInc=32,this.targetIndex=0},boot:function(R,S,I){var w=this.renderer,C=this.renderTargets;this.frameInc=Math.floor(o(R,"frameInc",32));var _=w.width,O=w.height,D=this.game.config.disablePreFX,F=this.game.config.disablePostFX;if(F||this.postPipelineClasses.setAll([[String(d.BARREL),u.Barrel],[String(d.BLOOM),u.Bloom],[String(d.BLUR),u.Blur],[String(d.BOKEH),u.Bokeh],[String(d.CIRCLE),u.Circle],[String(d.COLOR_MATRIX),u.ColorMatrix],[String(d.DISPLACEMENT),u.Displacement],[String(d.GLOW),u.Glow],[String(d.GRADIENT),u.Gradient],[String(d.PIXELATE),u.Pixelate],[String(d.SHADOW),u.Shadow],[String(d.SHINE),u.Shine],[String(d.VIGNETTE),u.Vignette],[String(d.WIPE),u.Wipe]]),!D){this.classes.set(s.FX_PIPELINE,p);for(var N=Math.min(_,O),Y=Math.ceil(N/this.frameInc),L=1;L<Y;L++){var b=L*this.frameInc;C.push(new a(w,b,b)),C.push(new a(w,b,b)),C.push(new a(w,b,b)),this.maxDimension=b}C.push(new a(w,_,O,1,0,!0,!0)),C.push(new a(w,_,O,1,0,!0,!0)),C.push(new a(w,_,O,1,0,!0,!0))}var M,k,B=this,H=this.game;if(this.classes.each(function(V,q){M=B.add(V,new q({game:H})),V===s.UTILITY_PIPELINE&&(B.UTILITY_PIPELINE=M,B.fullFrame1=M.fullFrame1,B.fullFrame2=M.fullFrame2,B.halfFrame1=M.halfFrame1,B.halfFrame2=M.halfFrame2)}),this.MULTI_PIPELINE=this.get(s.MULTI_PIPELINE),this.BITMAPMASK_PIPELINE=this.get(s.BITMAPMASK_PIPELINE),this.MOBILE_PIPELINE=this.get(s.MOBILE_PIPELINE),D||(this.FX_PIPELINE=this.get(s.FX_PIPELINE)),R)for(k in R){var z=R[k];M=new z(H),M.name=k,M.isPostFX?this.postPipelineClasses.set(k,z):this.has(k)||(this.classes.set(k,z),this.add(k,M))}this.default=this.get(S),I&&!r.os.desktop&&(this.default=this.MOBILE_PIPELINE)},setDefaultPipeline:function(R){var S=this.get(R);return S&&(this.default=S),S},add:function(R,S){if(!S.isPostFX){var I=this.pipelines,w=this.renderer;return I.has(R)||(S.name=R,S.manager=this,I.set(R,S)),S.hasBooted||S.boot(),w.width!==0&&w.height!==0&&!S.isPreFX&&S.resize(w.width,w.height),S}},addPostPipeline:function(R,S){this.postPipelineClasses.has(R)||this.postPipelineClasses.set(R,S)},flush:function(){this.current&&this.current.flush()},has:function(R){var S=this.pipelines;return typeof R=="string"?S.has(R):!!S.contains(R)},get:function(R){var S=this.pipelines;if(typeof R=="string")return S.get(R);if(S.contains(R))return R},getPostPipeline:function(R,S,I){var w=this.postPipelineClasses,C,_="",O=typeof R;if(O==="string"||O==="number"?(C=w.get(R),_=R):O==="function"?(w.contains(R)&&(C=R),_=R.name):O==="object"&&(C=w.get(R.name),_=R.name),C){var D=new C(this.game,I);return D.name=_,S&&(D.gameObject=S),this.postPipelineInstances.push(D),D}},removePostPipeline:function(R){A(this.postPipelineInstances,R)},remove:function(R,S,I){S===void 0&&(S=!0),I===void 0&&(I=!0),this.pipelines.delete(R),S&&this.classes.delete(R),I&&this.postPipelineClasses.delete(R)},set:function(R,S,I){if(!R.isPostFX)return this.isCurrent(R,I)||(this.flush(),this.current&&this.current.unbind(),this.current=R,R.bind(I)),R.updateProjectionMatrix(),R.onBind(S),R},preBatch:function(R){if(R.hasPostPipeline){this.flush();for(var S=R.postPipelines,I=S.length-1;I>=0;I--){var w=S[I];w.active&&w.preBatch(R)}}},postBatch:function(R){if(R.hasPostPipeline){this.flush();for(var S=R.postPipelines,I=0;I<S.length;I++){var w=S[I];w.active&&w.postBatch(R)}}},preBatchCamera:function(R){if(R.hasPostPipeline){this.flush();for(var S=R.postPipelines,I=S.length-1;I>=0;I--){var w=S[I];w.active&&w.preBatch(R)}}},postBatchCamera:function(R){if(R.hasPostPipeline){this.flush();for(var S=R.postPipelines,I=0;I<S.length;I++){var w=S[I];w.active&&w.postBatch(R)}}},isCurrent:function(R,S){var I=this.renderer,w=this.current;return w&&!S&&(S=w.currentShader),!(w!==R||S.program!==I.currentProgram)},copyFrame:function(R,S,I,w,C){return this.setUtility(this.UTILITY_PIPELINE.copyShader).copyFrame(R,S,I,w,C),this},copyToGame:function(R){return this.setUtility(this.UTILITY_PIPELINE.copyShader).copyToGame(R),this},drawFrame:function(R,S,I,w){return this.setUtility(this.UTILITY_PIPELINE.colorMatrixShader).drawFrame(R,S,I,w),this},blendFrames:function(R,S,I,w,C){return this.setUtility(this.UTILITY_PIPELINE.linearShader).blendFrames(R,S,I,w,C),this},blendFramesAdditive:function(R,S,I,w,C){return this.setUtility(this.UTILITY_PIPELINE.addShader).blendFramesAdditive(R,S,I,w,C),this},clearFrame:function(R,S){return this.UTILITY_PIPELINE.clearFrame(R,S),this},blitFrame:function(R,S,I,w,C,_){return this.setUtility(this.UTILITY_PIPELINE.copyShader).blitFrame(R,S,I,w,C,_),this},copyFrameRect:function(R,S,I,w,C,_,O,D){return this.UTILITY_PIPELINE.copyFrameRect(R,S,I,w,C,_,O,D),this},forceZero:function(){return this.current&&this.current.forceZero},setMulti:function(){return this.set(this.MULTI_PIPELINE)},setUtility:function(R){return this.UTILITY_PIPELINE.bind(R)},setFX:function(){return this.set(this.FX_PIPELINE)},restoreContext:function(){this.rebind(),this.pipelines.each(function(R,S){S.restoreContext()}),T(this.postPipelineInstances,function(R){R.restoreContext()})},rebind:function(R){R===void 0&&this.previous&&(R=this.previous);var S=this.renderer,I=S.gl;I.disable(I.DEPTH_TEST),I.disable(I.CULL_FACE),S.hasActiveStencilMask()?I.clear(I.DEPTH_BUFFER_BIT):(I.disable(I.STENCIL_TEST),I.clear(I.DEPTH_BUFFER_BIT|I.STENCIL_BUFFER_BIT)),I.viewport(0,0,S.width,S.height),S.currentProgram=null,S.setBlendMode(0,!0);var w=S.vaoExtension;w&&w.bindVertexArrayOES(null);var C=this.pipelines.entries;for(var _ in C)C[_].glReset=!0;R&&(this.current=R,R.rebind())},clear:function(){var R=this.renderer;this.flush(),this.current?(this.current.unbind(),this.previous=this.current,this.current=null):this.previous=null,R.currentProgram=null,R.setBlendMode(0,!0);var S=R.vaoExtension;S&&S.bindVertexArrayOES(null)},getRenderTarget:function(R){var S=this.renderTargets,I=3;if(R>this.maxDimension)return this.targetIndex=S.length-I,S[this.targetIndex];var w=(h(R,this.frameInc,0,!0)-1)*I;return this.targetIndex=w,S[w]},getSwapRenderTarget:function(){return this.renderTargets[this.targetIndex+1]},getAltSwapRenderTarget:function(){return this.renderTargets[this.targetIndex+2]},destroy:function(){this.flush(),this.classes.clear(),this.postPipelineClasses.clear(),this.pipelines.clear(),this.renderer=null,this.game=null,this.classes=null,this.postPipelineClasses=null,this.pipelines=null,this.default=null,this.current=null,this.previous=null}});t.exports=P}),Pu=y((e,t)=>{var i=xe(),s=di(),n=dt(),r=function(o,a){var h=o,l=n(a,"callback"),u=n(a,"type","image/png"),d=n(a,"encoder",.92),p=Math.abs(Math.round(n(a,"x",0))),g=Math.abs(Math.round(n(a,"y",0))),c=n(a,"getPixel",!1),f=n(a,"isFramebuffer",!1),m=f?n(a,"bufferWidth",1):h.drawingBufferWidth,v=f?n(a,"bufferHeight",1):h.drawingBufferHeight;if(c){var E=new Uint8Array(4),x=f?g:v-g;h.readPixels(p,x,1,1,h.RGBA,h.UNSIGNED_BYTE,E),l.call(null,new s(E[0],E[1],E[2],E[3]))}else{var T=Math.floor(n(a,"width",m)),A=Math.floor(n(a,"height",v)),P=T*A*4,R=new Uint8Array(P);h.readPixels(p,v-g-A,T,A,h.RGBA,h.UNSIGNED_BYTE,R);for(var S=i.createWebGL(this,T,A),I=S.getContext("2d",{willReadFrequently:!0}),w=I.getImageData(0,0,T,A),C=w.data,_=0;_<A;_++)for(var O=0;O<T;O++){var D=((A-_-1)*T+O)*4,F=f?P-(_*T+(T-O))*4:(_*T+O)*4;C[F+0]=R[D+0],C[F+1]=R[D+1],C[F+2]=R[D+2],C[F+3]=R[D+3]}I.putImageData(w,0,0);var N=new Image;N.onerror=function(){l.call(null),i.remove(S)},N.onload=function(){l.call(null,N),i.remove(S)},N.src=S.toDataURL(u,d)}};t.exports=r}),Ru=y((e,t)=>{var i=W(),s=new i({initialize:function(n,r,o,a){this.webGLBuffer=null,this.gl=n,this.initialDataOrSize=r,this.bufferType=o,this.bufferUsage=a,this.createResource()},createResource:function(){if(this.initialDataOrSize!==null){var n=this.gl;if(!n.isContextLost()){var r=this.bufferType,o=n.createBuffer();this.webGLBuffer=o,n.bindBuffer(r,this.webGLBuffer),n.bufferData(r,this.initialDataOrSize,this.bufferUsage),n.bindBuffer(r,null)}}},destroy:function(){var n=this.gl;n.isContextLost()||n.deleteBuffer(this.webGLBuffer),this.webGLBuffer=null,this.initialDataOrSize=null,this.gl=null}});t.exports=s}),bu=y((e,t)=>{var i=W(),s=new i({initialize:function(n,r,o){this.webGLProgram=null,this.gl=n,this.vertexSource=r,this.fragmentSource=o,this.createResource()},createResource:function(){var n=this.gl;if(!n.isContextLost()){var r=n.createProgram(),o=n.createShader(n.VERTEX_SHADER),a=n.createShader(n.FRAGMENT_SHADER);n.shaderSource(o,this.vertexSource),n.shaderSource(a,this.fragmentSource),n.compileShader(o),n.compileShader(a);var h=`Shader failed:
`;if(!n.getShaderParameter(o,n.COMPILE_STATUS))throw new Error("Vertex "+h+n.getShaderInfoLog(o));if(!n.getShaderParameter(a,n.COMPILE_STATUS))throw new Error("Fragment "+h+n.getShaderInfoLog(a));if(n.attachShader(r,o),n.attachShader(r,a),n.linkProgram(r),!n.getProgramParameter(r,n.LINK_STATUS))throw new Error("Link "+h+n.getProgramInfoLog(r));n.useProgram(r),this.webGLProgram=r}},destroy:function(){this.webGLProgram&&(this.gl.isContextLost()||this.gl.deleteProgram(this.webGLProgram),this.webGLProgram=null,this.gl=null)}});t.exports=s}),Ea=y((e,t)=>{var i=W(),s=Os(),n=new i({initialize:function(r,o,a,h,l,u,d,p,g,c,f,m,v){this.webGLTexture=null,this.isRenderTexture=!1,this.gl=r,this.mipLevel=o,this.minFilter=a,this.magFilter=h,this.wrapT=l,this.wrapS=u,this.format=d,this.pixels=p,this.width=g,this.height=c,this.pma=f??!0,this.forceSize=!!m,this.flipY=!!v,this.__SPECTOR_Metadata={},this.createResource()},createResource:function(){var r=this.gl;if(!r.isContextLost()){if(this.pixels instanceof n){this.webGLTexture=this.pixels.webGLTexture;return}var o=r.createTexture();o.__SPECTOR_Metadata=this.__SPECTOR_Metadata,this.webGLTexture=o,this._processTexture()}},update:function(r,o,a,h,l,u,d,p,g){if(!(o===0||a===0)){this.pixels=r,this.width=o,this.height=a,this.flipY=h,this.wrapS=l,this.wrapT=u,this.minFilter=d,this.magFilter=p,this.format=g;var c=this.gl;c.isContextLost()||this._processTexture()}},_processTexture:function(){var r=this.gl;r.activeTexture(r.TEXTURE0);var o=r.getParameter(r.TEXTURE_BINDING_2D);r.bindTexture(r.TEXTURE_2D,this.webGLTexture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,this.minFilter),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,this.magFilter),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,this.wrapS),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,this.wrapT),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.pma),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,this.flipY);var a=this.pixels,h=this.mipLevel,l=this.width,u=this.height,d=this.format,p=!1;if(a==null)r.texImage2D(r.TEXTURE_2D,h,d,l,u,0,d,r.UNSIGNED_BYTE,null),p=s(l,u);else if(a.compressed){l=a.width,u=a.height,p=a.generateMipmap;for(var g=0;g<a.mipmaps.length;g++)r.compressedTexImage2D(r.TEXTURE_2D,g,a.internalFormat,a.mipmaps[g].width,a.mipmaps[g].height,0,a.mipmaps[g].data)}else a instanceof Uint8Array?(r.texImage2D(r.TEXTURE_2D,h,d,l,u,0,d,r.UNSIGNED_BYTE,a),p=s(l,u)):(this.forceSize||(l=a.width,u=a.height),r.texImage2D(r.TEXTURE_2D,h,d,d,r.UNSIGNED_BYTE,a),p=s(l,u));p&&r.generateMipmap(r.TEXTURE_2D),o?r.bindTexture(r.TEXTURE_2D,o):r.bindTexture(r.TEXTURE_2D,null)},spectorMetadata:{get:function(){return this.__SPECTOR_Metadata},set:function(r){this.__SPECTOR_Metadata=r,this.gl.isContextLost()||(this.webGLTexture.__SPECTOR_Metadata=r)}},destroy:function(){this.webGLTexture!==null&&(this.gl.isContextLost()||this.pixels instanceof n||this.gl.deleteTexture(this.webGLTexture),this.pixels=null,this.webGLTexture=null,this.gl=null)}});t.exports=n}),Iu=y((e,t)=>{var i=W(),s={36054:"Incomplete Attachment",36055:"Missing Attachment",36057:"Incomplete Dimensions",36061:"Framebuffer Unsupported"},n=new i({initialize:function(r,o,a,h,l){this.webGLFramebuffer=null,this.gl=r,this.width=o,this.height=a,this.renderTexture=h,this.addDepthStencilBuffer=!!l,this.createResource()},createResource:function(){var r=this.gl;if(!r.isContextLost()){var o=this.renderTexture,a=0,h=r.createFramebuffer();if(this.webGLFramebuffer=h,r.bindFramebuffer(r.FRAMEBUFFER,h),o.isRenderTexture=!0,o.isAlphaPremultiplied=!1,r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,o.webGLTexture,0),a=r.checkFramebufferStatus(r.FRAMEBUFFER),a!==r.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer status: "+(s[a]||a));if(this.addDepthStencilBuffer){var l=r.createRenderbuffer();r.bindRenderbuffer(r.RENDERBUFFER,l),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,this.width,this.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,l)}r.bindFramebuffer(r.FRAMEBUFFER,null)}},destroy:function(){if(this.webGLFramebuffer!==null){var r=this.gl;if(!r.isContextLost()){r.bindFramebuffer(r.FRAMEBUFFER,this.webGLFramebuffer);var o=r.getFramebufferAttachmentParameter(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);o!==null&&(r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,null,0),r.deleteTexture(o));var a=r.getFramebufferAttachmentParameter(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);a!==null&&r.deleteRenderbuffer(a),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteFramebuffer(this.webGLFramebuffer)}this.renderTexture=null,this.webGLFramebuffer=null,this.gl=null}}});t.exports=n}),_u=y((e,t)=>{var i=W(),s=new i({initialize:function(n,r,o){this.webGLAttribLocation=-1,this.gl=n,this.program=r,this.name=o,this.createResource()},createResource:function(){if(this.program.webGLProgram===null){this.webGLAttribLocation=-1;return}var n=this.gl;n.isContextLost()||(this.webGLAttribLocation=n.getAttribLocation(this.program.webGLProgram,this.name))},destroy:function(){this.gl=null,this.program=null,this.name=null,this.webGLAttribLocation=-1}});t.exports=s}),Ou=y((e,t)=>{var i=W(),s=new i({initialize:function(n,r,o){this.webGLUniformLocation=null,this.gl=n,this.program=r,this.name=o,this.createResource()},createResource:function(){if(this.program.webGLProgram===null){this.webGLUniformLocation=null;return}var n=this.gl;n.isContextLost()||(this.webGLUniformLocation=n.getUniformLocation(this.program.webGLProgram,this.name))},destroy:function(){this.gl=null,this.program=null,this.name=null,this.webGLUniformLocation=null}});t.exports=s}),Mu=y((e,t)=>{var i=xn(),s=Ye(),n=Ie(),r=W(),o=Pe(),a=Ct(),h=Ds(),l=Os(),u=Ls(),d=Rt(),p=Cu(),g=zi(),c=Is(),f=ks(),m=Se(),v=Pu(),E=Ru(),x=bu(),T=Ea(),A=Iu(),P=_u(),R=Ou(),S=!1,I=new r({Extends:a,initialize:function(w){a.call(this);var C=w.config,_={alpha:C.transparent,desynchronized:C.desynchronized,depth:!0,antialias:C.antialiasGL,premultipliedAlpha:C.premultipliedAlpha,stencil:!0,failIfMajorPerformanceCaveat:C.failIfMajorPerformanceCaveat,powerPreference:C.powerPreference,preserveDrawingBuffer:C.preserveDrawingBuffer,willReadFrequently:!1};this.config={clearBeforeRender:C.clearBeforeRender,antialias:C.antialias,backgroundColor:C.backgroundColor,contextCreation:_,roundPixels:C.roundPixels,maxTextures:C.maxTextures,maxTextureSize:C.maxTextureSize,batchSize:C.batchSize,maxLights:C.maxLights,mipmapFilter:C.mipmapFilter},this.game=w,this.type=o.WEBGL,this.pipelines=null,this.width=0,this.height=0,this.canvas=w.canvas,this.blendModes=[],this.contextLost=!1,this.snapshotState={x:0,y:0,width:1,height:1,getPixel:!1,callback:null,type:"image/png",encoder:.92,isFramebuffer:!1,bufferWidth:0,bufferHeight:0},this.maxTextures=0,this.textureIndexes,this.glBufferWrappers=[],this.glProgramWrappers=[],this.glTextureWrappers=[],this.glFramebufferWrappers=[],this.glAttribLocationWrappers=[],this.glUniformLocationWrappers=[],this.currentFramebuffer=null,this.fboStack=[],this.currentProgram=null,this.currentBlendMode=1/0,this.currentScissorEnabled=!1,this.currentScissor=null,this.scissorStack=[],this.contextLostHandler=d,this.contextRestoredHandler=d,this.previousContextLostHandler=d,this.previousContextRestoredHandler=d,this.gl=null,this.supportedExtensions=null,this.instancedArraysExtension=null,this.vaoExtension=null,this.extensions={},this.glFormats,this.compression,this.drawingBufferHeight=0,this.blankTexture=null,this.normalTexture=null,this.whiteTexture=null,this.maskCount=0,this.maskStack=[],this.currentMask={mask:null,camera:null},this.currentCameraMask={mask:null,camera:null},this.glFuncMap=null,this.currentType="",this.newType=!1,this.nextTypeMatch=!1,this.finalType=!1,this.mipmapFilter=null,this.defaultScissor=[0,0,0,0],this.isBooted=!1,this.renderTarget=null,this.projectionMatrix,this.projectionWidth=0,this.projectionHeight=0,this.maskSource=null,this.maskTarget=null,this.spector=null,this._debugCapture=!1,this.init(this.config)},init:function(w){var C,_=this.game,O=this.canvas,D=w.backgroundColor;if(S&&(this.spector=new APe.Spector,this.spector.onCapture.add(this.onCapture.bind(this))),_.config.context?C=_.config.context:C=O.getContext("webgl",w.contextCreation)||O.getContext("experimental-webgl",w.contextCreation),!C||C.isContextLost())throw this.contextLost=!0,new Error("WebGL unsupported");this.gl=C,this.setExtensions(),this.setContextHandlers(),_.context=C;for(var F=0;F<=27;F++)this.blendModes.push({func:[C.ONE,C.ONE_MINUS_SRC_ALPHA],equation:C.FUNC_ADD});this.blendModes[1].func=[C.ONE,C.DST_ALPHA],this.blendModes[2].func=[C.DST_COLOR,C.ONE_MINUS_SRC_ALPHA],this.blendModes[3].func=[C.ONE,C.ONE_MINUS_SRC_COLOR],this.blendModes[17]={func:[C.ZERO,C.ONE_MINUS_SRC_ALPHA],equation:C.FUNC_REVERSE_SUBTRACT},this.glFormats=[C.BYTE,C.SHORT,C.UNSIGNED_BYTE,C.UNSIGNED_SHORT,C.FLOAT],this.glFuncMap={mat2:{func:C.uniformMatrix2fv,length:1,matrix:!0},mat3:{func:C.uniformMatrix3fv,length:1,matrix:!0},mat4:{func:C.uniformMatrix4fv,length:1,matrix:!0},"1f":{func:C.uniform1f,length:1},"1fv":{func:C.uniform1fv,length:1},"1i":{func:C.uniform1i,length:1},"1iv":{func:C.uniform1iv,length:1},"2f":{func:C.uniform2f,length:2},"2fv":{func:C.uniform2fv,length:1},"2i":{func:C.uniform2i,length:2},"2iv":{func:C.uniform2iv,length:1},"3f":{func:C.uniform3f,length:3},"3fv":{func:C.uniform3fv,length:1},"3i":{func:C.uniform3i,length:3},"3iv":{func:C.uniform3iv,length:1},"4f":{func:C.uniform4f,length:4},"4fv":{func:C.uniform4fv,length:1},"4i":{func:C.uniform4i,length:4},"4iv":{func:C.uniform4iv,length:1}},(!w.maxTextures||w.maxTextures===-1)&&(w.maxTextures=C.getParameter(C.MAX_TEXTURE_IMAGE_UNITS)),w.maxTextureSize||(w.maxTextureSize=C.getParameter(C.MAX_TEXTURE_SIZE)),this.compression=this.getCompressedTextures(),C.disable(C.DEPTH_TEST),C.disable(C.CULL_FACE),C.enable(C.BLEND),C.clearColor(D.redGL,D.greenGL,D.blueGL,D.alphaGL),C.clear(C.COLOR_BUFFER_BIT);var N=["NEAREST","LINEAR","NEAREST_MIPMAP_NEAREST","LINEAR_MIPMAP_NEAREST","NEAREST_MIPMAP_LINEAR","LINEAR_MIPMAP_LINEAR"];return N.indexOf(w.mipmapFilter)!==-1&&(this.mipmapFilter=C[w.mipmapFilter]),this.maxTextures=m.checkShaderMax(C,w.maxTextures),this.textureIndexes=[],this.createTemporaryTextures(),this.pipelines=new p(this),this.setBlendMode(o.BlendModes.NORMAL),this.projectionMatrix=new u().identity(),_.textures.once(f.READY,this.boot,this),this},boot:function(){var w=this.game,C=this.pipelines,_=w.scale.baseSize,O=_.width,D=_.height;this.width=O,this.height=D,this.isBooted=!0,this.renderTarget=new g(this,O,D,1,0,!0,!0),this.maskTarget=new g(this,O,D,1,0,!0,!0),this.maskSource=new g(this,O,D,1,0,!0,!0);var F=w.config;C.boot(F.pipeline,F.defaultPipeline,F.autoMobilePipeline),this.blankTexture=w.textures.getFrame("__DEFAULT").glTexture,this.normalTexture=w.textures.getFrame("__NORMAL").glTexture,this.whiteTexture=w.textures.getFrame("__WHITE").glTexture;var N=this.gl;N.bindFramebuffer(N.FRAMEBUFFER,null),N.enable(N.SCISSOR_TEST),w.scale.on(c.RESIZE,this.onResize,this),this.resize(O,D)},setExtensions:function(){var w=this.gl,C=w.getSupportedExtensions();this.supportedExtensions=C;var _="ANGLE_instanced_arrays";this.instancedArraysExtension=C.indexOf(_)>-1?w.getExtension(_):null;var O="OES_vertex_array_object";this.vaoExtension=C.indexOf(O)>-1?w.getExtension(O):null},setContextHandlers:function(w,C){this.previousContextLostHandler&&this.canvas.removeEventListener("webglcontextlost",this.previousContextLostHandler,!1),this.previousContextRestoredHandler&&this.canvas.removeEventListener("webglcontextlost",this.previousContextRestoredHandler,!1),typeof w=="function"?this.contextLostHandler=w.bind(this):this.contextLostHandler=this.dispatchContextLost.bind(this),typeof C=="function"?this.contextRestoredHandler=C.bind(this):this.contextRestoredHandler=this.dispatchContextRestored.bind(this),this.canvas.addEventListener("webglcontextlost",this.contextLostHandler,!1),this.canvas.addEventListener("webglcontextrestored",this.contextRestoredHandler,!1),this.previousContextLostHandler=this.contextLostHandler,this.previousContextRestoredHandler=this.contextRestoredHandler},dispatchContextLost:function(w){this.contextLost=!0,this.emit(h.LOSE_WEBGL,this),w.preventDefault()},dispatchContextRestored:function(w){var C=this.gl;if(!C.isContextLost()){this.currentProgram=null,this.currentFramebuffer=null,this.setBlendMode(o.BlendModes.NORMAL),C.disable(C.BLEND),C.disable(C.DEPTH_TEST),C.enable(C.CULL_FACE),this.compression=this.getCompressedTextures();var _=function(O){O.createResource()};i(this.glTextureWrappers,_),i(this.glBufferWrappers,_),i(this.glFramebufferWrappers,_),i(this.glProgramWrappers,_),i(this.glAttribLocationWrappers,_),i(this.glUniformLocationWrappers,_),this.createTemporaryTextures(),this.pipelines.restoreContext(),this.resize(this.game.scale.baseSize.width,this.game.scale.baseSize.height),this.setExtensions(),this.contextLost=!1,this.emit(h.RESTORE_WEBGL,this),w.preventDefault()}},createTemporaryTextures:function(){for(var w=this.gl,C=0;C<this.maxTextures;C++){var _=w.createTexture();w.activeTexture(w.TEXTURE0+C),w.bindTexture(w.TEXTURE_2D,_),w.texImage2D(w.TEXTURE_2D,0,w.RGBA,1,1,0,w.RGBA,w.UNSIGNED_BYTE,new Uint8Array([0,0,255,255])),this.textureIndexes.push(C)}},captureFrame:function(w,C){w===void 0&&(w=!1),C===void 0&&(C=!1),S&&this.spector&&!this._debugCapture&&(this.spector.captureCanvas(this.canvas,0,w,C),this._debugCapture=!0)},captureNextFrame:function(){S&&this.spector&&!this._debugCapture&&(this._debugCapture=!0,this.spector.captureNextFrame(this.canvas))},getFps:function(){if(S&&this.spector)return this.spector.getFps()},log:function(){if(S&&this.spector){var w=Array.prototype.slice.call(arguments).join(" ");return this.spector.log(w)}},startCapture:function(w,C,_){w===void 0&&(w=0),C===void 0&&(C=!1),_===void 0&&(_=!1),S&&this.spector&&!this._debugCapture&&(this.spector.startCapture(this.canvas,w,C,_),this._debugCapture=!0)},stopCapture:function(){if(S&&this.spector&&this._debugCapture)return this.spector.stopCapture()},onCapture:function(w){if(S){var C=this.spector.getResultUI();C.display(w),this._debugCapture=!1}},onResize:function(w,C){(C.width!==this.width||C.height!==this.height)&&this.resize(C.width,C.height)},beginCapture:function(w,C){w===void 0&&(w=this.width),C===void 0&&(C=this.height),this.renderTarget.bind(!0,w,C),this.setProjectionMatrix(w,C)},endCapture:function(){return this.renderTarget.unbind(!0),this.resetProjectionMatrix(),this.renderTarget},resize:function(w,C){var _=this.gl;return this.width=w,this.height=C,this.setProjectionMatrix(w,C),_.viewport(0,0,w,C),this.drawingBufferHeight=_.drawingBufferHeight,_.scissor(0,_.drawingBufferHeight-C,w,C),this.defaultScissor[2]=w,this.defaultScissor[3]=C,this.emit(h.RESIZE,w,C),this},getCompressedTextures:function(){var w="WEBGL_compressed_texture_",C="WEBKIT_"+w,_="EXT_texture_compression_",O=function(F,N){var Y=F.getExtension(w+N)||F.getExtension(C+N)||F.getExtension(_+N);if(Y){var L={};for(var b in Y)L[Y[b]]=b;return L}},D=this.gl;return{ETC:O(D,"etc"),ETC1:O(D,"etc1"),ATC:O(D,"atc"),ASTC:O(D,"astc"),BPTC:O(D,"bptc"),RGTC:O(D,"rgtc"),PVRTC:O(D,"pvrtc"),S3TC:O(D,"s3tc"),S3TCSRGB:O(D,"s3tc_srgb"),IMG:!0}},getCompressedTextureName:function(w,C){var _=this.compression[w.toUpperCase()];if(C in _)return _[C]},supportsCompressedTexture:function(w,C){var _=this.compression[w.toUpperCase()];return _?C?C in _:!0:!1},getAspectRatio:function(){return this.width/this.height},setProjectionMatrix:function(w,C){return(w!==this.projectionWidth||C!==this.projectionHeight)&&(this.projectionWidth=w,this.projectionHeight=C,this.projectionMatrix.ortho(0,w,C,0,-1e3,1e3)),this},resetProjectionMatrix:function(){return this.setProjectionMatrix(this.width,this.height)},hasExtension:function(w){return this.supportedExtensions?this.supportedExtensions.indexOf(w):!1},getExtension:function(w){return this.hasExtension(w)?(w in this.extensions||(this.extensions[w]=this.gl.getExtension(w)),this.extensions[w]):null},flush:function(){this.pipelines.flush()},pushScissor:function(w,C,_,O,D){D===void 0&&(D=this.drawingBufferHeight);var F=this.scissorStack,N=[w,C,_,O];return F.push(N),this.setScissor(w,C,_,O,D),this.currentScissor=N,N},setScissor:function(w,C,_,O,D){D===void 0&&(D=this.drawingBufferHeight);var F=this.gl,N=this.currentScissor,Y=_>0&&O>0;if(N&&Y){var L=N[0],b=N[1],M=N[2],k=N[3];Y=L!==w||b!==C||M!==_||k!==O}Y&&(this.flush(),F.scissor(w,D-C-O,_,O))},resetScissor:function(){var w=this.gl;w.enable(w.SCISSOR_TEST);var C=this.currentScissor;if(C){var _=C[0],O=C[1],D=C[2],F=C[3];D>0&&F>0&&w.scissor(_,this.drawingBufferHeight-O-F,D,F)}},popScissor:function(){var w=this.scissorStack;w.pop();var C=w[w.length-1];C&&this.setScissor(C[0],C[1],C[2],C[3]),this.currentScissor=C},hasActiveStencilMask:function(){var w=this.currentMask.mask,C=this.currentCameraMask.mask;return w&&w.isStencil||C&&C.isStencil},resetViewport:function(){var w=this.gl;w.viewport(0,0,this.width,this.height),this.drawingBufferHeight=w.drawingBufferHeight},setBlendMode:function(w,C){C===void 0&&(C=!1);var _=this.gl,O=this.blendModes[w];return C||w!==o.BlendModes.SKIP_CHECK&&this.currentBlendMode!==w?(this.flush(),_.enable(_.BLEND),_.blendEquation(O.equation),O.func.length>2?_.blendFuncSeparate(O.func[0],O.func[1],O.func[2],O.func[3]):_.blendFunc(O.func[0],O.func[1]),this.currentBlendMode=w,!0):!1},addBlendMode:function(w,C){var _=this.blendModes.push({func:w,equation:C});return _-1},updateBlendMode:function(w,C,_){return this.blendModes[w]&&(this.blendModes[w].func=C,_&&(this.blendModes[w].equation=_)),this},removeBlendMode:function(w){return w>17&&this.blendModes[w]&&this.blendModes.splice(w,1),this},pushFramebuffer:function(w,C,_,O,D){return w===this.currentFramebuffer?this:(this.fboStack.push(w),this.setFramebuffer(w,C,_,O,D))},setFramebuffer:function(w,C,_,O,D){if(C===void 0&&(C=!1),_===void 0&&(_=!0),O===void 0&&(O=null),D===void 0&&(D=!1),w===this.currentFramebuffer)return this;var F=this.gl,N=this.width,Y=this.height;return w&&w.renderTexture&&_?(N=w.renderTexture.width,Y=w.renderTexture.height):this.flush(),w?F.bindFramebuffer(F.FRAMEBUFFER,w.webGLFramebuffer):F.bindFramebuffer(F.FRAMEBUFFER,null),_&&F.viewport(0,0,N,Y),O&&F.framebufferTexture2D(F.FRAMEBUFFER,F.COLOR_ATTACHMENT0,F.TEXTURE_2D,O.webGLTexture,0),D&&(F.clearColor(0,0,0,0),F.clear(F.COLOR_BUFFER_BIT)),C&&(w?(this.drawingBufferHeight=Y,this.pushScissor(0,0,N,Y)):(this.drawingBufferHeight=this.height,this.popScissor())),this.currentFramebuffer=w,this},popFramebuffer:function(w,C){w===void 0&&(w=!1),C===void 0&&(C=!0);var _=this.fboStack;_.pop();var O=_[_.length-1];return O||(O=null),this.setFramebuffer(O,w,C),O},restoreFramebuffer:function(w,C){w===void 0&&(w=!1),C===void 0&&(C=!0);var _=this.fboStack,O=_[_.length-1];O||(O=null),this.currentFramebuffer=null,this.setFramebuffer(O,w,C)},setProgram:function(w){return w!==this.currentProgram?(this.flush(),this.gl.useProgram(w.webGLProgram),this.currentProgram=w,!0):!1},resetProgram:function(){return this.gl.useProgram(this.currentProgram.webGLProgramWrapper),this},createTextureFromSource:function(w,C,_,O,D){D===void 0&&(D=!1);var F=this.gl,N=F.NEAREST,Y=F.NEAREST,L=F.CLAMP_TO_EDGE,b=null;C=w?w.width:C,_=w?w.height:_;var M=l(C,_);if(M&&!D&&(L=F.REPEAT),O===o.ScaleModes.LINEAR&&this.config.antialias){var k=w&&w.compressed,B=!k&&M||k&&w.mipmaps.length>1;N=this.mipmapFilter&&B?this.mipmapFilter:F.LINEAR,Y=F.LINEAR}return!w&&typeof C=="number"&&typeof _=="number"?b=this.createTexture2D(0,N,Y,L,L,F.RGBA,null,C,_):b=this.createTexture2D(0,N,Y,L,L,F.RGBA,w),b},createTexture2D:function(w,C,_,O,D,F,N,Y,L,b,M,k){typeof Y!="number"&&(Y=N?N.width:1),typeof L!="number"&&(L=N?N.height:1);var B=new T(this.gl,w,C,_,O,D,F,N,Y,L,b,M,k);return this.glTextureWrappers.push(B),B},createFramebuffer:function(w,C,_,O){this.currentFramebuffer=null;var D=new A(this.gl,w,C,_,O);return this.glFramebufferWrappers.push(D),D},beginBitmapMask:function(w,C){var _=this.gl;_&&(this.flush(),this.maskTarget.bind(!0),this.currentCameraMask.mask!==w&&(this.currentMask.mask=w,this.currentMask.camera=C))},drawBitmapMask:function(w,C,_){this.flush(),this.maskSource.bind(),this.setBlendMode(0,!0),w.renderWebGL(this,w,C),this.maskSource.unbind(!0),this.maskTarget.unbind();var O=this.gl,D=this.getCurrentStencilMask();D?(O.enable(O.STENCIL_TEST),D.mask.applyStencil(this,D.camera,!0)):this.currentMask.mask=null,this.pipelines.set(_),O.activeTexture(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,this.maskTarget.texture.webGLTexture),O.activeTexture(O.TEXTURE1),O.bindTexture(O.TEXTURE_2D,this.maskSource.texture.webGLTexture)},createProgram:function(w,C){var _=new x(this.gl,w,C);return this.glProgramWrappers.push(_),_},createVertexBuffer:function(w,C){var _=this.gl,O=new E(_,w,_.ARRAY_BUFFER,C);return this.glBufferWrappers.push(O),O},createAttribLocation:function(w,C){var _=new P(this.gl,w,C);return this.glAttribLocationWrappers.push(_),_},createUniformLocation:function(w,C){var _=new R(this.gl,w,C);return this.glUniformLocationWrappers.push(_),_},createIndexBuffer:function(w,C){var _=this.gl,O=new E(_,w,_.ELEMENT_ARRAY_BUFFER,C);return this.glBufferWrappers.push(O),O},deleteTexture:function(w){if(w)return s(this.glTextureWrappers,w),w.destroy(),this},deleteFramebuffer:function(w){return w?(s(this.fboStack,w),s(this.glFramebufferWrappers,w),w.destroy(),this):this},deleteProgram:function(w){return w&&(s(this.glProgramWrappers,w),w.destroy()),this},deleteAttribLocation:function(w){return w&&(s(this.glAttribLocationWrappers,w),w.destroy()),this},deleteUniformLocation:function(w){return w&&(s(this.glUniformLocationWrappers,w),w.destroy()),this},deleteBuffer:function(w){return w?(s(this.glBufferWrappers,w),w.destroy(),this):this},preRenderCamera:function(w){var C=w.x,_=w.y,O=w.width,D=w.height,F=w.backgroundColor;if(w.emit(n.PRE_RENDER,w),this.pipelines.preBatchCamera(w),this.pushScissor(C,_,O,D),w.mask&&(this.currentCameraMask.mask=w.mask,this.currentCameraMask.camera=w._maskCamera,w.mask.preRenderWebGL(this,w,w._maskCamera)),F.alphaGL>0){var N=this.pipelines.setMulti();N.drawFillRect(C,_,O,D,m.getTintFromFloats(F.blueGL,F.greenGL,F.redGL,1),F.alphaGL)}},getCurrentStencilMask:function(){var w=null,C=this.maskStack,_=this.currentCameraMask;return C.length>0?w=C[C.length-1]:_.mask&&_.mask.isStencil&&(w=_),w},postRenderCamera:function(w){var C=w.flashEffect,_=w.fadeEffect;if(C.isRunning||_.isRunning||_.isComplete){var O=this.pipelines.setMulti();C.postRenderWebGL(O,m.getTintFromFloats),_.postRenderWebGL(O,m.getTintFromFloats)}w.dirty=!1,this.popScissor(),w.mask&&(this.currentCameraMask.mask=null,w.mask.postRenderWebGL(this,w._maskCamera)),this.pipelines.postBatchCamera(w),w.emit(n.POST_RENDER,w)},preRender:function(){if(!this.contextLost){var w=this.gl;if(w.bindFramebuffer(w.FRAMEBUFFER,null),this.emit(h.PRE_RENDER_CLEAR),this.config.clearBeforeRender){var C=this.config.backgroundColor;w.clearColor(C.redGL,C.greenGL,C.blueGL,C.alphaGL),w.clear(w.COLOR_BUFFER_BIT|w.DEPTH_BUFFER_BIT|w.STENCIL_BUFFER_BIT)}w.enable(w.SCISSOR_TEST),this.currentScissor=this.defaultScissor,this.scissorStack.length=0,this.scissorStack.push(this.currentScissor),this.game.scene.customViewports&&w.scissor(0,this.drawingBufferHeight-this.height,this.width,this.height),this.currentMask.mask=null,this.currentCameraMask.mask=null,this.maskStack.length=0,this.emit(h.PRE_RENDER)}},render:function(w,C,_){if(!this.contextLost){var O=C.length;if(this.emit(h.RENDER,w,_),this.preRenderCamera(_),O===0){this.setBlendMode(o.BlendModes.NORMAL),this.postRenderCamera(_);return}this.currentType="";for(var D=this.currentMask,F=0;F<O;F++){this.finalType=F===O-1;var N=C[F],Y=N.mask;D=this.currentMask,D.mask&&D.mask!==Y&&D.mask.postRenderWebGL(this,D.camera),Y&&D.mask!==Y&&Y.preRenderWebGL(this,N,_),N.blendMode!==this.currentBlendMode&&this.setBlendMode(N.blendMode);var L=N.type;L!==this.currentType&&(this.newType=!0,this.currentType=L),this.finalType?this.nextTypeMatch=!1:this.nextTypeMatch=C[F+1].type===this.currentType,N.renderWebGL(this,N,_),this.newType=!1}D=this.currentMask,D.mask&&D.mask.postRenderWebGL(this,D.camera),this.setBlendMode(o.BlendModes.NORMAL),this.postRenderCamera(_)}},postRender:function(){if(!this.contextLost){this.flush(),this.emit(h.POST_RENDER);var w=this.snapshotState;w.callback&&(v(this.gl,w),w.callback=null)}},clearStencilMask:function(){this.gl.disable(this.gl.STENCIL_TEST)},restoreStencilMask:function(){var w=this.gl,C=this.getCurrentStencilMask();if(C){var _=C.mask;w.enable(w.STENCIL_TEST),_.invertAlpha?w.stencilFunc(w.NOTEQUAL,_.level,255):w.stencilFunc(w.EQUAL,_.level,255)}},snapshot:function(w,C,_){return this.snapshotArea(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight,w,C,_)},snapshotArea:function(w,C,_,O,D,F,N){var Y=this.snapshotState;return Y.callback=D,Y.type=F,Y.encoder=N,Y.getPixel=!1,Y.x=w,Y.y=C,Y.width=_,Y.height=O,this},snapshotPixel:function(w,C,_){return this.snapshotArea(w,C,1,1,_),this.snapshotState.getPixel=!0,this},snapshotFramebuffer:function(w,C,_,O,D,F,N,Y,L,b,M){D===void 0&&(D=!1),F===void 0&&(F=0),N===void 0&&(N=0),Y===void 0&&(Y=C),L===void 0&&(L=_),b==="pixel"&&(D=!0,b="image/png");var k=this.currentFramebuffer;this.snapshotArea(F,N,Y,L,O,b,M);var B=this.snapshotState;return B.getPixel=D,B.isFramebuffer=!0,B.bufferWidth=C,B.bufferHeight=_,B.width=Math.min(B.width,C),B.height=Math.min(B.height,_),this.setFramebuffer(w),v(this.gl,B),this.setFramebuffer(k),B.callback=null,B.isFramebuffer=!1,this},canvasToTexture:function(w,C,_,O){_===void 0&&(_=!1),O===void 0&&(O=!1);var D=this.gl,F=D.NEAREST,N=D.NEAREST,Y=w.width,L=w.height,b=D.CLAMP_TO_EDGE,M=l(Y,L);return!_&&M&&(b=D.REPEAT),this.config.antialias&&(F=M&&this.mipmapFilter?this.mipmapFilter:D.LINEAR,N=D.LINEAR),C?(C.update(w,Y,L,O,b,b,F,N,C.format),C):this.createTexture2D(0,F,N,b,b,D.RGBA,w,Y,L,!0,!1,O)},createCanvasTexture:function(w,C,_){return C===void 0&&(C=!1),_===void 0&&(_=!1),this.canvasToTexture(w,null,C,_)},updateCanvasTexture:function(w,C,_,O){return _===void 0&&(_=!1),O===void 0&&(O=!1),this.canvasToTexture(w,C,O,_)},videoToTexture:function(w,C,_,O){_===void 0&&(_=!1),O===void 0&&(O=!1);var D=this.gl,F=D.NEAREST,N=D.NEAREST,Y=w.videoWidth,L=w.videoHeight,b=D.CLAMP_TO_EDGE,M=l(Y,L);return!_&&M&&(b=D.REPEAT),this.config.antialias&&(F=M&&this.mipmapFilter?this.mipmapFilter:D.LINEAR,N=D.LINEAR),C?(C.update(w,Y,L,O,b,b,F,N,C.format),C):this.createTexture2D(0,F,N,b,b,D.RGBA,w,Y,L,!0,!0,O)},createVideoTexture:function(w,C,_){return C===void 0&&(C=!1),_===void 0&&(_=!1),this.videoToTexture(w,null,C,_)},updateVideoTexture:function(w,C,_,O){return _===void 0&&(_=!1),O===void 0&&(O=!1),this.videoToTexture(w,C,O,_)},createUint8ArrayTexture:function(w,C,_){var O=this.gl,D=O.NEAREST,F=O.NEAREST,N=O.CLAMP_TO_EDGE,Y=l(C,_);return Y&&(N=O.REPEAT),this.createTexture2D(0,D,F,N,N,O.RGBA,w,C,_)},setTextureFilter:function(w,C){var _=this.gl,O=C===0?_.LINEAR:_.NEAREST;_.activeTexture(_.TEXTURE0);var D=_.getParameter(_.TEXTURE_BINDING_2D);return _.bindTexture(_.TEXTURE_2D,w.webGLTexture),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,O),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,O),w.minFilter=O,w.magFilter=O,D&&_.bindTexture(_.TEXTURE_2D,D),this},getMaxTextureSize:function(){return this.config.maxTextureSize},destroy:function(){this.canvas.removeEventListener("webglcontextlost",this.contextLostHandler,!1),this.canvas.removeEventListener("webglcontextrestored",this.contextRestoredHandler,!1);var w=function(C){C.destroy()};i(this.glAttribLocationWrappers,w),i(this.glBufferWrappers,w),i(this.glFramebufferWrappers,w),i(this.glProgramWrappers,w),i(this.glTextureWrappers,w),i(this.glUniformLocationWrappers,w),this.maskTarget.destroy(),this.maskSource.destroy(),this.pipelines.destroy(),this.removeAllListeners(),this.fboStack=[],this.maskStack=[],this.extensions={},this.textureIndexes=[],this.gl=null,this.game=null,this.canvas=null,this.contextLost=!0,this.currentMask=null,this.currentCameraMask=null,S&&(this.spector=null)}});t.exports=I}),Lu=y((e,t)=>{var i=kE(),s=xe(),n=Pe(),r=Zr(),o=function(a){var h=a.config;if((h.customEnvironment||h.canvas)&&h.renderType===n.AUTO)throw new Error("Must set explicit renderType in custom environment");if(!h.customEnvironment&&!h.canvas&&h.renderType!==n.HEADLESS)if(h.renderType===n.AUTO&&(h.renderType=r.webGL?n.WEBGL:n.CANVAS),h.renderType===n.WEBGL){if(!r.webGL)throw new Error("Cannot create WebGL context, aborting.")}else if(h.renderType===n.CANVAS){if(!r.canvas)throw new Error("Cannot create Canvas context, aborting.")}else throw new Error("Unknown value for renderer type: "+h.renderType);h.antialias||s.disableSmoothing();var l=a.scale.baseSize,u=l.width,d=l.height;if(h.canvas?(a.canvas=h.canvas,a.canvas.width=u,a.canvas.height=d):a.canvas=s.create(a,u,d,h.renderType),h.canvasStyle&&(a.canvas.style=h.canvasStyle),h.antialias||i.setCrisp(a.canvas),h.renderType!==n.HEADLESS){var p,g;p=qE(),g=Mu(),h.renderType===n.WEBGL?a.renderer=new g(a):(a.renderer=new p(a),a.context=a.renderer.gameContext)}};t.exports=o}),Du=y((e,t)=>{var i=Pe(),s=function(n){var r=n.config;if(!r.hideBanner){var o="WebGL";r.renderType===i.CANVAS?o="Canvas":r.renderType===i.HEADLESS&&(o="Headless");var a=r.audio,h=n.device.audio,l;if(h.webAudio&&!a.disableWebAudio?l="Web Audio":a.noAudio||!h.webAudio&&!h.audioData?l="No Audio":l="HTML5 Audio",n.device.browser.ie)window.console;else{var u="",d=[u];if(Array.isArray(r.bannerBackgroundColor)){var p;r.bannerBackgroundColor.forEach(function(c){u=u.concat("%c "),d.push("background: "+c),p=c}),d[d.length-1]="color: "+r.bannerTextColor+"; background: "+p}else u=u.concat("%c "),d.push("color: "+r.bannerTextColor+"; background: "+r.bannerBackgroundColor);d.push("background: transparent"),r.gameTitle&&(u=u.concat(r.gameTitle),r.gameVersion&&(u=u.concat(" v"+r.gameVersion)),r.hidePhaser||(u=u.concat(" / ")));var g="";r.hidePhaser||(u=u.concat("Phaser v"+i.VERSION+g+" ("+o+" | "+l+")")),u=u.concat(" %c "+r.gameURL),d[0]=u}}};t.exports=s}),wy=y((e,t)=>{var i=W(),s=Rt(),n=new i({initialize:function(){this.isRunning=!1,this.callback=s,this.isSetTimeOut=!1,this.timeOutID=null,this.delay=0;var r=this;this.step=function o(a){r.callback(a),r.isRunning&&(r.timeOutID=window.requestAnimationFrame(o))},this.stepTimeout=function o(){r.isRunning&&(r.timeOutID=window.setTimeout(o,r.delay)),r.callback(window.performance.now())}},start:function(r,o,a){this.isRunning||(this.callback=r,this.isSetTimeOut=o,this.delay=a,this.isRunning=!0,this.timeOutID=o?window.setTimeout(this.stepTimeout,0):window.requestAnimationFrame(this.step))},stop:function(){this.isRunning=!1,this.isSetTimeOut?clearTimeout(this.timeOutID):window.cancelAnimationFrame(this.timeOutID)},destroy:function(){this.stop(),this.callback=s}});t.exports=n}),ku=y((e,t)=>{var i=W(),s=St(),n=Rt(),r=wy(),o=new i({initialize:function(a,h){this.game=a,this.raf=new r,this.started=!1,this.running=!1,this.minFps=s(h,"min",5),this.targetFps=s(h,"target",60),this.fpsLimit=s(h,"limit",0),this.hasFpsLimit=this.fpsLimit>0,this._limitRate=this.hasFpsLimit?1e3/this.fpsLimit:0,this._min=1e3/this.minFps,this._target=1e3/this.targetFps,this.actualFps=this.targetFps,this.nextFpsUpdate=0,this.framesThisSecond=0,this.callback=n,this.forceSetTimeOut=s(h,"forceSetTimeOut",!1),this.time=0,this.startTime=0,this.lastTime=0,this.frame=0,this.inFocus=!0,this.pauseDuration=0,this._pauseTime=0,this._coolDown=0,this.delta=0,this.deltaIndex=0,this.deltaHistory=[],this.deltaSmoothingMax=s(h,"deltaHistory",10),this.panicMax=s(h,"panicMax",120),this.rawDelta=0,this.now=0,this.smoothStep=s(h,"smoothStep",!0)},blur:function(){this.inFocus=!1},focus:function(){this.inFocus=!0,this.resetDelta()},pause:function(){this._pauseTime=window.performance.now()},resume:function(){this.resetDelta(),this.pauseDuration=this.time-this._pauseTime,this.startTime+=this.pauseDuration},resetDelta:function(){var a=window.performance.now();this.time=a,this.lastTime=a,this.nextFpsUpdate=a+1e3,this.framesThisSecond=0;for(var h=0;h<this.deltaSmoothingMax;h++)this.deltaHistory[h]=Math.min(this._target,this.deltaHistory[h]);this.delta=0,this.deltaIndex=0,this._coolDown=this.panicMax},start:function(a){if(this.started)return this;this.started=!0,this.running=!0;for(var h=0;h<this.deltaSmoothingMax;h++)this.deltaHistory[h]=this._target;this.resetDelta(),this.startTime=window.performance.now(),this.callback=a;var l=this.hasFpsLimit?this.stepLimitFPS.bind(this):this.step.bind(this);this.raf.start(l,this.forceSetTimeOut,this._target)},smoothDelta:function(a){var h=this.deltaIndex,l=this.deltaHistory,u=this.deltaSmoothingMax;(this._coolDown>0||!this.inFocus)&&(this._coolDown--,a=Math.min(a,this._target)),a>this._min&&(a=l[h],a=Math.min(a,this._min)),l[h]=a,this.deltaIndex++,this.deltaIndex>=u&&(this.deltaIndex=0);for(var d=0,p=0;p<u;p++)d+=l[p];return d/=u,d},updateFPS:function(a){this.actualFps=.25*this.framesThisSecond+.75*this.actualFps,this.nextFpsUpdate=a+1e3,this.framesThisSecond=0},stepLimitFPS:function(a){this.now=a;var h=Math.max(0,a-this.lastTime);this.rawDelta=h,this.time+=this.rawDelta,this.smoothStep&&(h=this.smoothDelta(h)),this.delta+=h,a>=this.nextFpsUpdate&&this.updateFPS(a),this.framesThisSecond++,this.delta>=this._limitRate&&(this.callback(a,this.delta),this.delta=0),this.lastTime=a,this.frame++},step:function(a){this.now=a;var h=Math.max(0,a-this.lastTime);this.rawDelta=h,this.time+=this.rawDelta,this.smoothStep&&(h=this.smoothDelta(h)),this.delta=h,a>=this.nextFpsUpdate&&this.updateFPS(a),this.framesThisSecond++,this.callback(a,h),this.lastTime=a,this.frame++},tick:function(){var a=window.performance.now();this.hasFpsLimit?this.stepLimitFPS(a):this.step(a)},sleep:function(){this.running&&(this.raf.stop(),this.running=!1)},wake:function(a){a===void 0&&(a=!1);var h=window.performance.now();if(!this.running){a&&(this.startTime+=-this.lastTime+(this.lastTime+h));var l=this.hasFpsLimit?this.stepLimitFPS.bind(this):this.step.bind(this);this.raf.start(l,this.forceSetTimeOut,this._target),this.running=!0,this.nextFpsUpdate=h+1e3,this.framesThisSecond=0,this.fpsLimitTriggered=!1,this.tick()}},getDuration:function(){return Math.round(this.lastTime-this.startTime)/1e3},getDurationMS:function(){return Math.round(this.lastTime-this.startTime)},stop:function(){return this.running=!1,this.started=!1,this.raf.stop(),this},destroy:function(){this.stop(),this.raf.destroy(),this.raf=null,this.game=null,this.callback=null}});t.exports=o}),Fu=y((e,t)=>{var i=$t(),s=function(n){var r,o=n.events;if(document.hidden!==void 0)r="visibilitychange";else{var a=["webkit","moz","ms"];a.forEach(function(l){document[l+"Hidden"]!==void 0&&(document.hidden=function(){return document[l+"Hidden"]},r=l+"visibilitychange")})}var h=function(l){document.hidden||l.type==="pause"?o.emit(i.HIDDEN):o.emit(i.VISIBLE)};r&&document.addEventListener(r,h,!1),window.onblur=function(){o.emit(i.BLUR)},window.onfocus=function(){o.emit(i.FOCUS)},window.focus&&n.config.autoFocus&&window.focus()};t.exports=s}),Cy=y((e,t)=>{t.exports={Config:Yl(),CreateRenderer:Lu(),DebugHeader:Du(),Events:$t(),TimeStep:ku(),VisibilityHandler:Fu()}}),ya=y((e,t)=>{var i=Ut(),s=Gt(),n=function(r,o){if(o===void 0&&(o=new i),r.length===0)return o;for(var a=Number.MAX_VALUE,h=Number.MAX_VALUE,l=s.MIN_SAFE_INTEGER,u=s.MIN_SAFE_INTEGER,d,p,g,c=0;c<r.length;c++)d=r[c],Array.isArray(d)?(p=d[0],g=d[1]):(p=d.x,g=d.y),a=Math.min(a,p),h=Math.min(h,g),l=Math.max(l,p),u=Math.max(u,g);return o.x=a,o.y=h,o.width=l-a,o.height=u-h,o};t.exports=n}),Wi=y((e,t)=>{var i=W(),s=ya(),n=Ut(),r=xt(),o=new i({initialize:function(a){this.type=a,this.defaultDivisions=5,this.arcLengthDivisions=100,this.cacheArcLengths=[],this.needsUpdate=!0,this.active=!0,this._tmpVec2A=new r,this._tmpVec2B=new r},draw:function(a,h){return h===void 0&&(h=32),a.strokePoints(this.getPoints(h))},getBounds:function(a,h){a||(a=new n),h===void 0&&(h=16);var l=this.getLength();h>l&&(h=l/2);var u=Math.max(1,Math.round(l/h));return s(this.getSpacedPoints(u),a)},getDistancePoints:function(a){var h=this.getLength(),l=Math.max(1,h/a);return this.getSpacedPoints(l)},getEndPoint:function(a){return a===void 0&&(a=new r),this.getPointAt(1,a)},getLength:function(){var a=this.getLengths();return a[a.length-1]},getLengths:function(a){if(a===void 0&&(a=this.arcLengthDivisions),this.cacheArcLengths.length===a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var h=[],l,u=this.getPoint(0,this._tmpVec2A),d=0;h.push(0);for(var p=1;p<=a;p++)l=this.getPoint(p/a,this._tmpVec2B),d+=l.distance(u),h.push(d),u.copy(l);return this.cacheArcLengths=h,h},getPointAt:function(a,h){var l=this.getUtoTmapping(a);return this.getPoint(l,h)},getPoints:function(a,h,l){l===void 0&&(l=[]),a||(h?a=this.getLength()/h:a=this.defaultDivisions);for(var u=0;u<=a;u++)l.push(this.getPoint(u/a));return l},getRandomPoint:function(a){return a===void 0&&(a=new r),this.getPoint(Math.random(),a)},getSpacedPoints:function(a,h,l){l===void 0&&(l=[]),a||(h?a=this.getLength()/h:a=this.defaultDivisions);for(var u=0;u<=a;u++){var d=this.getUtoTmapping(u/a,null,a);l.push(this.getPoint(d))}return l},getStartPoint:function(a){return a===void 0&&(a=new r),this.getPointAt(0,a)},getTangent:function(a,h){h===void 0&&(h=new r);var l=1e-4,u=a-l,d=a+l;return u<0&&(u=0),d>1&&(d=1),this.getPoint(u,this._tmpVec2A),this.getPoint(d,h),h.subtract(this._tmpVec2A).normalize()},getTangentAt:function(a,h){var l=this.getUtoTmapping(a);return this.getTangent(l,h)},getTFromDistance:function(a,h){return a<=0?0:this.getUtoTmapping(0,a,h)},getUtoTmapping:function(a,h,l){var u=this.getLengths(l),d=0,p=u.length,g;h?g=Math.min(h,u[p-1]):g=a*u[p-1];for(var c=0,f=p-1,m;c<=f;)if(d=Math.floor(c+(f-c)/2),m=u[d]-g,m<0)c=d+1;else if(m>0)f=d-1;else{f=d;break}if(d=f,u[d]===g)return d/(p-1);var v=u[d],E=u[d+1],x=E-v,T=(g-v)/x;return(d+T)/(p-1)},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()}});t.exports=o}),Nu=y((e,t)=>{var i=W(),s=Ml(),n=Wi(),r=xt(),o=new i({Extends:n,initialize:function(a,h,l,u){n.call(this,"CubicBezierCurve"),Array.isArray(a)&&(u=new r(a[6],a[7]),l=new r(a[4],a[5]),h=new r(a[2],a[3]),a=new r(a[0],a[1])),this.p0=a,this.p1=h,this.p2=l,this.p3=u},getStartPoint:function(a){return a===void 0&&(a=new r),a.copy(this.p0)},getResolution:function(a){return a},getPoint:function(a,h){h===void 0&&(h=new r);var l=this.p0,u=this.p1,d=this.p2,p=this.p3;return h.set(s(a,l.x,u.x,d.x,p.x),s(a,l.y,u.y,d.y,p.y))},draw:function(a,h){h===void 0&&(h=32);var l=this.getPoints(h);a.beginPath(),a.moveTo(this.p0.x,this.p0.y);for(var u=1;u<l.length;u++)a.lineTo(l[u].x,l[u].y);return a.strokePath(),a},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y,this.p2.x,this.p2.y,this.p3.x,this.p3.y]}}});o.fromJSON=function(a){var h=a.points,l=new r(h[0],h[1]),u=new r(h[2],h[3]),d=new r(h[4],h[5]),p=new r(h[6],h[7]);return new o(l,u,d,p)},t.exports=o}),Bu=y((e,t)=>{var i=W(),s=Wi(),n=Gi(),r=St(),o=Bl(),a=xt(),h=new i({Extends:s,initialize:function(l,u,d,p,g,c,f,m){if(typeof l=="object"){var v=l;l=r(v,"x",0),u=r(v,"y",0),d=r(v,"xRadius",0),p=r(v,"yRadius",d),g=r(v,"startAngle",0),c=r(v,"endAngle",360),f=r(v,"clockwise",!1),m=r(v,"rotation",0)}else p===void 0&&(p=d),g===void 0&&(g=0),c===void 0&&(c=360),f===void 0&&(f=!1),m===void 0&&(m=0);s.call(this,"EllipseCurve"),this.p0=new a(l,u),this._xRadius=d,this._yRadius=p,this._startAngle=n(g),this._endAngle=n(c),this._clockwise=f,this._rotation=n(m)},getStartPoint:function(l){return l===void 0&&(l=new a),this.getPoint(0,l)},getResolution:function(l){return l*2},getPoint:function(l,u){u===void 0&&(u=new a);for(var d=Math.PI*2,p=this._endAngle-this._startAngle,g=Math.abs(p)<Number.EPSILON;p<0;)p+=d;for(;p>d;)p-=d;p<Number.EPSILON&&(g?p=0:p=d),this._clockwise&&!g&&(p===d?p=-d:p=p-d);var c=this._startAngle+l*p,f=this.p0.x+this._xRadius*Math.cos(c),m=this.p0.y+this._yRadius*Math.sin(c);if(this._rotation!==0){var v=Math.cos(this._rotation),E=Math.sin(this._rotation),x=f-this.p0.x,T=m-this.p0.y;f=x*v-T*E+this.p0.x,m=x*E+T*v+this.p0.y}return u.set(f,m)},setXRadius:function(l){return this.xRadius=l,this},setYRadius:function(l){return this.yRadius=l,this},setWidth:function(l){return this.xRadius=l/2,this},setHeight:function(l){return this.yRadius=l/2,this},setStartAngle:function(l){return this.startAngle=l,this},setEndAngle:function(l){return this.endAngle=l,this},setClockwise:function(l){return this.clockwise=l,this},setRotation:function(l){return this.rotation=l,this},x:{get:function(){return this.p0.x},set:function(l){this.p0.x=l}},y:{get:function(){return this.p0.y},set:function(l){this.p0.y=l}},xRadius:{get:function(){return this._xRadius},set:function(l){this._xRadius=l}},yRadius:{get:function(){return this._yRadius},set:function(l){this._yRadius=l}},startAngle:{get:function(){return o(this._startAngle)},set:function(l){this._startAngle=n(l)}},endAngle:{get:function(){return o(this._endAngle)},set:function(l){this._endAngle=n(l)}},clockwise:{get:function(){return this._clockwise},set:function(l){this._clockwise=l}},angle:{get:function(){return o(this._rotation)},set:function(l){this._rotation=n(l)}},rotation:{get:function(){return this._rotation},set:function(l){this._rotation=l}},toJSON:function(){return{type:this.type,x:this.p0.x,y:this.p0.y,xRadius:this._xRadius,yRadius:this._yRadius,startAngle:o(this._startAngle),endAngle:o(this._endAngle),clockwise:this._clockwise,rotation:o(this._rotation)}}});h.fromJSON=function(l){return new h(l)},t.exports=h}),Uu=y((e,t)=>{var i=W(),s=Wi(),n=ya(),r=Ut(),o=xt(),a=new i({Extends:s,initialize:function(h,l){s.call(this,"LineCurve"),Array.isArray(h)&&(l=new o(h[2],h[3]),h=new o(h[0],h[1])),this.p0=h,this.p1=l,this.arcLengthDivisions=1},getBounds:function(h){return h===void 0&&(h=new r),n([this.p0,this.p1],h)},getStartPoint:function(h){return h===void 0&&(h=new o),h.copy(this.p0)},getResolution:function(h){return h===void 0&&(h=1),h},getPoint:function(h,l){return l===void 0&&(l=new o),h===1?l.copy(this.p1):(l.copy(this.p1).subtract(this.p0).scale(h).add(this.p0),l)},getPointAt:function(h,l){return this.getPoint(h,l)},getTangent:function(h,l){return l===void 0&&(l=new o),l.copy(this.p1).subtract(this.p0).normalize(),l},getUtoTmapping:function(h,l,u){var d;if(l){var p=this.getLengths(u),g=p[p.length-1],c=Math.min(l,g);d=c/g}else d=h;return d},draw:function(h){return h.lineBetween(this.p0.x,this.p0.y,this.p1.x,this.p1.y),h},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y]}}});a.fromJSON=function(h){var l=h.points,u=new o(l[0],l[1]),d=new o(l[2],l[3]);return new a(u,d)},t.exports=a}),Gu=y((e,t)=>{var i=W(),s=xt(),n=new i({initialize:function(r,o){this.active=!1,this.p0=new s(r,o)},getPoint:function(r,o){return o===void 0&&(o=new s),o.copy(this.p0)},getPointAt:function(r,o){return this.getPoint(r,o)},getResolution:function(){return 1},getLength:function(){return 0},toJSON:function(){return{type:"MoveTo",points:[this.p0.x,this.p0.y]}}});t.exports=n}),Yu=y((e,t)=>{var i=W(),s=Wi(),n=Dl(),r=xt(),o=new i({Extends:s,initialize:function(a,h,l){s.call(this,"QuadraticBezierCurve"),Array.isArray(a)&&(l=new r(a[4],a[5]),h=new r(a[2],a[3]),a=new r(a[0],a[1])),this.p0=a,this.p1=h,this.p2=l},getStartPoint:function(a){return a===void 0&&(a=new r),a.copy(this.p0)},getResolution:function(a){return a},getPoint:function(a,h){h===void 0&&(h=new r);var l=this.p0,u=this.p1,d=this.p2;return h.set(n(a,l.x,u.x,d.x),n(a,l.y,u.y,d.y))},draw:function(a,h){h===void 0&&(h=32);var l=this.getPoints(h);a.beginPath(),a.moveTo(this.p0.x,this.p0.y);for(var u=1;u<l.length;u++)a.lineTo(l[u].x,l[u].y);return a.strokePath(),a},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y,this.p2.x,this.p2.y]}}});o.fromJSON=function(a){var h=a.points,l=new r(h[0],h[1]),u=new r(h[2],h[3]),d=new r(h[4],h[5]);return new o(l,u,d)},t.exports=o}),Hu=y((e,t)=>{var i=da(),s=W(),n=Wi(),r=xt(),o=new s({Extends:n,initialize:function(a){a===void 0&&(a=[]),n.call(this,"SplineCurve"),this.points=[],this.addPoints(a)},addPoints:function(a){for(var h=0;h<a.length;h++){var l=new r;typeof a[h]=="number"?(l.x=a[h],l.y=a[h+1],h++):Array.isArray(a[h])?(l.x=a[h][0],l.y=a[h][1]):(l.x=a[h].x,l.y=a[h].y),this.points.push(l)}return this},addPoint:function(a,h){var l=new r(a,h);return this.points.push(l),l},getStartPoint:function(a){return a===void 0&&(a=new r),a.copy(this.points[0])},getResolution:function(a){return a*this.points.length},getPoint:function(a,h){h===void 0&&(h=new r);var l=this.points,u=(l.length-1)*a,d=Math.floor(u),p=u-d,g=l[d===0?d:d-1],c=l[d],f=l[d>l.length-2?l.length-1:d+1],m=l[d>l.length-3?l.length-1:d+2];return h.set(i(p,g.x,c.x,f.x,m.x),i(p,g.y,c.y,f.y,m.y))},toJSON:function(){for(var a=[],h=0;h<this.points.length;h++)a.push(this.points[h].x),a.push(this.points[h].y);return{type:this.type,points:a}}});o.fromJSON=function(a){return new o(a.points)},t.exports=o}),Py=y((e,t)=>{var i=W(),s=Nu(),n=Bu(),r=jt(),o=Uu(),a=Gu(),h=Yu(),l=Ut(),u=Hu(),d=xt(),p=Gt(),g=new i({initialize:function(c,f){c===void 0&&(c=0),f===void 0&&(f=0),this.name="",this.defaultDivisions=12,this.curves=[],this.cacheLengths=[],this.autoClose=!1,this.startPoint=new d,this._tmpVec2A=new d,this._tmpVec2B=new d,typeof c=="object"?this.fromJSON(c):this.startPoint.set(c,f)},add:function(c){return this.curves.push(c),this},circleTo:function(c,f,m){return f===void 0&&(f=!1),this.ellipseTo(c,c,0,360,f,m)},closePath:function(){var c=this.curves[0].getPoint(0),f=this.curves[this.curves.length-1].getPoint(1);return c.equals(f)||this.curves.push(new o(f,c)),this},cubicBezierTo:function(c,f,m,v,E,x){var T=this.getEndPoint(),A,P,R;return c instanceof d?(A=c,P=f,R=m):(A=new d(m,v),P=new d(E,x),R=new d(c,f)),this.add(new s(T,A,P,R))},quadraticBezierTo:function(c,f,m,v){var E=this.getEndPoint(),x,T;return c instanceof d?(x=c,T=f):(x=new d(m,v),T=new d(c,f)),this.add(new h(E,x,T))},draw:function(c,f){for(var m=0;m<this.curves.length;m++){var v=this.curves[m];v.active&&v.draw(c,f)}return c},ellipseTo:function(c,f,m,v,E,x){var T=new n(0,0,c,f,m,v,E,x),A=this.getEndPoint(this._tmpVec2A),P=T.getStartPoint(this._tmpVec2B);return A.subtract(P),T.x=A.x,T.y=A.y,this.add(T)},fromJSON:function(c){this.curves=[],this.cacheLengths=[],this.startPoint.set(c.x,c.y),this.autoClose=c.autoClose;for(var f=0;f<c.curves.length;f++){var m=c.curves[f];switch(m.type){case"LineCurve":this.add(o.fromJSON(m));break;case"EllipseCurve":this.add(n.fromJSON(m));break;case"SplineCurve":this.add(u.fromJSON(m));break;case"CubicBezierCurve":this.add(s.fromJSON(m));break;case"QuadraticBezierCurve":this.add(h.fromJSON(m));break}}return this},getBounds:function(c,f){c===void 0&&(c=new l),f===void 0&&(f=16),c.x=Number.MAX_VALUE,c.y=Number.MAX_VALUE;for(var m=new l,v=p.MIN_SAFE_INTEGER,E=p.MIN_SAFE_INTEGER,x=0;x<this.curves.length;x++){var T=this.curves[x];T.active&&(T.getBounds(m,f),c.x=Math.min(c.x,m.x),c.y=Math.min(c.y,m.y),v=Math.max(v,m.right),E=Math.max(E,m.bottom))}return c.right=v,c.bottom=E,c},getCurveLengths:function(){if(this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var c=[],f=0,m=0;m<this.curves.length;m++)f+=this.curves[m].getLength(),c.push(f);return this.cacheLengths=c,c},getCurveAt:function(c){for(var f=c*this.getLength(),m=this.getCurveLengths(),v=0;v<m.length;){if(m[v]>=f)return this.curves[v];v++}return null},getEndPoint:function(c){return c===void 0&&(c=new d),this.curves.length>0?this.curves[this.curves.length-1].getPoint(1,c):c.copy(this.startPoint),c},getLength:function(){var c=this.getCurveLengths();return c[c.length-1]},getPoint:function(c,f){f===void 0&&(f=new d);for(var m=c*this.getLength(),v=this.getCurveLengths(),E=0;E<v.length;){if(v[E]>=m){var x=v[E]-m,T=this.curves[E],A=T.getLength(),P=A===0?0:1-x/A;return T.getPointAt(P,f)}E++}return null},getPoints:function(c,f){!c&&!f&&(c=this.defaultDivisions);for(var m=[],v,E=0;E<this.curves.length;E++){var x=this.curves[E];if(x.active)for(var T=x.getResolution(c),A=x.getPoints(T,f),P=0;P<A.length;P++){var R=A[P];v&&v.equals(R)||(m.push(R),v=R)}}return this.autoClose&&m.length>1&&!m[m.length-1].equals(m[0])&&m.push(m[0]),m},getRandomPoint:function(c){return c===void 0&&(c=new d),this.getPoint(Math.random(),c)},getSpacedPoints:function(c){c===void 0&&(c=40);for(var f=[],m=0;m<=c;m++)f.push(this.getPoint(m/c));return this.autoClose&&f.push(f[0]),f},getStartPoint:function(c){return c===void 0&&(c=new d),c.copy(this.startPoint)},getTangent:function(c,f){f===void 0&&(f=new d);for(var m=c*this.getLength(),v=this.getCurveLengths(),E=0;E<v.length;){if(v[E]>=m){var x=v[E]-m,T=this.curves[E],A=T.getLength(),P=A===0?0:1-x/A;return T.getTangentAt(P,f)}E++}return null},lineTo:function(c,f){c instanceof d?this._tmpVec2B.copy(c):typeof c=="object"?this._tmpVec2B.setFromObject(c):this._tmpVec2B.set(c,f);var m=this.getEndPoint(this._tmpVec2A);return this.add(new o([m.x,m.y,this._tmpVec2B.x,this._tmpVec2B.y]))},splineTo:function(c){return c.unshift(this.getEndPoint()),this.add(new u(c))},moveTo:function(c,f){return c instanceof d?this.add(new a(c.x,c.y)):this.add(new a(c,f))},toJSON:function(){for(var c=[],f=0;f<this.curves.length;f++)c.push(this.curves[f].toJSON());return{type:"Path",x:this.startPoint.x,y:this.startPoint.y,autoClose:this.autoClose,curves:c}},updateArcLengths:function(){this.cacheLengths=[],this.getCurveLengths()},destroy:function(){this.curves.length=0,this.cacheLengths.length=0,this.startPoint=void 0}});r.register("path",function(c,f){return new g(c,f)}),t.exports=g}),Ry=y((e,t)=>{t.exports={Path:Py(),MoveTo:Gu(),CubicBezier:Nu(),Curve:Wi(),Ellipse:Bu(),Line:Uu(),QuadraticBezier:Yu(),Spline:Hu()}}),by=y((e,t)=>{var i=W(),s=In(),n=he(),r=Vt(),o=new i({Extends:s,initialize:function(a){s.call(this,a,a.sys.events),this.scene=a,this.systems=a.sys,a.sys.events.once(r.BOOT,this.boot,this),a.sys.events.on(r.START,this.start,this)},boot:function(){this.events=this.systems.events,this.events.once(r.DESTROY,this.destroy,this)},start:function(){this.events.once(r.SHUTDOWN,this.shutdown,this)},shutdown:function(){this.systems.events.off(r.SHUTDOWN,this.shutdown,this)},destroy:function(){s.prototype.destroy.call(this),this.events.off(r.START,this.start,this),this.scene=null,this.systems=null}});n.register("DataManagerPlugin",o,"data"),t.exports=o}),Iy=y((e,t)=>{t.exports={DataManager:In(),DataManagerPlugin:by(),Events:$h()}}),_y=y((e,t)=>{t.exports={BottomCenter:Ph(),BottomLeft:Rh(),BottomRight:bh(),Center:Ih(),LeftCenter:_h(),QuickSet:kh(),RightCenter:Oh(),TopCenter:Mh(),TopLeft:Lh(),TopRight:Dh()}}),Oy=y((e,t)=>{t.exports={BottomCenter:ph(),BottomLeft:gh(),BottomRight:fh(),LeftBottom:mh(),LeftCenter:vh(),LeftTop:Eh(),QuickSet:Ch(),RightBottom:yh(),RightCenter:Th(),RightTop:xh(),TopCenter:Sh(),TopLeft:Ah(),TopRight:wh()}}),My=y((e,t)=>{var i=En(),s=Qt(),n={In:_y(),To:Oy()};n=s(!1,n,i),t.exports=n}),Ly=y((e,t)=>{t.exports={BitmapMask:Zh(),GeometryMask:qh()}}),Dy=y((e,t)=>{var i=W(),s=Ct(),n=he(),r=new i({Extends:s,initialize:function(){s.call(this)},shutdown:function(){this.removeAllListeners()},destroy:function(){this.removeAllListeners()}});n.register("EventEmitter",r,"events"),t.exports=r}),ky=y((e,t)=>{t.exports={EventEmitter:Dy()}}),Ta=y((e,t)=>{var i=function(s,n){var r;if(n)typeof n=="string"?r=document.getElementById(n):typeof n=="object"&&n.nodeType===1&&(r=n);else if(s.parentElement||n===null)return s;return r||(r=document.body),r.appendChild(s),s};t.exports=i}),Fy=y((e,t)=>{var i=Ta(),s=function(n){var r=n.config;if(!(!r.parent||!r.domCreateContainer)){var o=document.createElement("div");o.style.cssText=["display: block;","width: "+n.scale.width+"px;","height: "+n.scale.height+"px;","padding: 0; margin: 0;","position: absolute;","overflow: hidden;","pointer-events: "+r.domPointerEvents+";","transform: scale(1);","transform-origin: left top;"].join(" "),n.domContainer=o,i(o,r.parent)}};t.exports=s}),Ny=y((e,t)=>{var i=Cs(),s=function(n){if(document.readyState==="complete"||document.readyState==="interactive"){n();return}var r=function(){document.removeEventListener("deviceready",r,!0),document.removeEventListener("DOMContentLoaded",r,!0),window.removeEventListener("load",r,!0),n()};document.body?i.cordova?document.addEventListener("deviceready",r,!1):(document.addEventListener("DOMContentLoaded",r,!0),window.addEventListener("load",r,!0)):window.setTimeout(r,20)};t.exports=s}),xa=y((e,t)=>{var i={MOUSE_DOWN:0,MOUSE_MOVE:1,MOUSE_UP:2,TOUCH_START:3,TOUCH_MOVE:4,TOUCH_END:5,POINTER_LOCK_CHANGE:6,TOUCH_CANCEL:7,MOUSE_WHEEL:8};t.exports=i}),By=y((e,t)=>{t.exports="boot"}),Uy=y((e,t)=>{t.exports="destroy"}),Gy=y((e,t)=>{t.exports="dragend"}),Yy=y((e,t)=>{t.exports="dragenter"}),Hy=y((e,t)=>{t.exports="drag"}),zy=y((e,t)=>{t.exports="dragleave"}),Wy=y((e,t)=>{t.exports="dragover"}),Vy=y((e,t)=>{t.exports="dragstart"}),Xy=y((e,t)=>{t.exports="drop"}),Ky=y((e,t)=>{t.exports="gameout"}),jy=y((e,t)=>{t.exports="gameover"}),Zy=y((e,t)=>{t.exports="gameobjectdown"}),qy=y((e,t)=>{t.exports="dragend"}),Jy=y((e,t)=>{t.exports="dragenter"}),Qy=y((e,t)=>{t.exports="drag"}),$y=y((e,t)=>{t.exports="dragleave"}),tT=y((e,t)=>{t.exports="dragover"}),eT=y((e,t)=>{t.exports="dragstart"}),iT=y((e,t)=>{t.exports="drop"}),sT=y((e,t)=>{t.exports="gameobjectmove"}),nT=y((e,t)=>{t.exports="gameobjectout"}),rT=y((e,t)=>{t.exports="gameobjectover"}),aT=y((e,t)=>{t.exports="pointerdown"}),oT=y((e,t)=>{t.exports="pointermove"}),hT=y((e,t)=>{t.exports="pointerout"}),lT=y((e,t)=>{t.exports="pointerover"}),uT=y((e,t)=>{t.exports="pointerup"}),cT=y((e,t)=>{t.exports="wheel"}),dT=y((e,t)=>{t.exports="gameobjectup"}),pT=y((e,t)=>{t.exports="gameobjectwheel"}),gT=y((e,t)=>{t.exports="boot"}),fT=y((e,t)=>{t.exports="process"}),mT=y((e,t)=>{t.exports="update"}),vT=y((e,t)=>{t.exports="pointerdown"}),ET=y((e,t)=>{t.exports="pointerdownoutside"}),yT=y((e,t)=>{t.exports="pointermove"}),TT=y((e,t)=>{t.exports="pointerout"}),xT=y((e,t)=>{t.exports="pointerover"}),ST=y((e,t)=>{t.exports="pointerup"}),AT=y((e,t)=>{t.exports="pointerupoutside"}),wT=y((e,t)=>{t.exports="wheel"}),CT=y((e,t)=>{t.exports="pointerlockchange"}),PT=y((e,t)=>{t.exports="preupdate"}),RT=y((e,t)=>{t.exports="shutdown"}),bT=y((e,t)=>{t.exports="start"}),IT=y((e,t)=>{t.exports="update"}),pi=y((e,t)=>{t.exports={BOOT:By(),DESTROY:Uy(),DRAG_END:Gy(),DRAG_ENTER:Yy(),DRAG:Hy(),DRAG_LEAVE:zy(),DRAG_OVER:Wy(),DRAG_START:Vy(),DROP:Xy(),GAME_OUT:Ky(),GAME_OVER:jy(),GAMEOBJECT_DOWN:Zy(),GAMEOBJECT_DRAG_END:qy(),GAMEOBJECT_DRAG_ENTER:Jy(),GAMEOBJECT_DRAG:Qy(),GAMEOBJECT_DRAG_LEAVE:$y(),GAMEOBJECT_DRAG_OVER:tT(),GAMEOBJECT_DRAG_START:eT(),GAMEOBJECT_DROP:iT(),GAMEOBJECT_MOVE:sT(),GAMEOBJECT_OUT:nT(),GAMEOBJECT_OVER:rT(),GAMEOBJECT_POINTER_DOWN:aT(),GAMEOBJECT_POINTER_MOVE:oT(),GAMEOBJECT_POINTER_OUT:hT(),GAMEOBJECT_POINTER_OVER:lT(),GAMEOBJECT_POINTER_UP:uT(),GAMEOBJECT_POINTER_WHEEL:cT(),GAMEOBJECT_UP:dT(),GAMEOBJECT_WHEEL:pT(),MANAGER_BOOT:gT(),MANAGER_PROCESS:fT(),MANAGER_UPDATE:mT(),POINTER_DOWN:vT(),POINTER_DOWN_OUTSIDE:ET(),POINTER_MOVE:yT(),POINTER_OUT:TT(),POINTER_OVER:xT(),POINTER_UP:ST(),POINTER_UP_OUTSIDE:AT(),POINTER_WHEEL:wT(),POINTERLOCK_CHANGE:CT(),PRE_UPDATE:PT(),SHUTDOWN:RT(),START:bT(),UPDATE:IT()}}),Un=y((e,t)=>{var i={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:42,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,NUMPAD_ZERO:96,NUMPAD_ONE:97,NUMPAD_TWO:98,NUMPAD_THREE:99,NUMPAD_FOUR:100,NUMPAD_FIVE:101,NUMPAD_SIX:102,NUMPAD_SEVEN:103,NUMPAD_EIGHT:104,NUMPAD_NINE:105,NUMPAD_ADD:107,NUMPAD_SUBTRACT:109,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SEMICOLON:186,PLUS:187,COMMA:188,MINUS:189,PERIOD:190,FORWARD_SLASH:191,BACK_SLASH:220,QUOTES:222,BACKTICK:192,OPEN_BRACKET:219,CLOSED_BRACKET:221,SEMICOLON_FIREFOX:59,COLON:58,COMMA_FIREFOX_WINDOWS:60,COMMA_FIREFOX:62,BRACKET_RIGHT_FIREFOX:174,BRACKET_LEFT_FIREFOX:175};t.exports=i}),zu=y((e,t)=>{var i=Ye(),s=W(),n=$t(),r=pi(),o=Un(),a=Rt(),h=new s({initialize:function(l){this.manager=l,this.queue=[],this.preventDefault=!0,this.captures=[],this.enabled=!1,this.target,this.onKeyDown=a,this.onKeyUp=a,l.events.once(r.MANAGER_BOOT,this.boot,this)},boot:function(){var l=this.manager.config;this.enabled=l.inputKeyboard,this.target=l.inputKeyboardEventTarget,this.addCapture(l.inputKeyboardCapture),!this.target&&window&&(this.target=window),this.enabled&&this.target&&this.startListeners(),this.manager.game.events.on(n.POST_STEP,this.postUpdate,this)},startListeners:function(){var l=this;this.onKeyDown=function(d){if(!(d.defaultPrevented||!l.enabled||!l.manager)){l.queue.push(d),l.manager.events.emit(r.MANAGER_PROCESS);var p=d.altKey||d.ctrlKey||d.shiftKey||d.metaKey;l.preventDefault&&!p&&l.captures.indexOf(d.keyCode)>-1&&d.preventDefault()}},this.onKeyUp=function(d){if(!(d.defaultPrevented||!l.enabled||!l.manager)){l.queue.push(d),l.manager.events.emit(r.MANAGER_PROCESS);var p=d.altKey||d.ctrlKey||d.shiftKey||d.metaKey;l.preventDefault&&!p&&l.captures.indexOf(d.keyCode)>-1&&d.preventDefault()}};var u=this.target;u&&(u.addEventListener("keydown",this.onKeyDown,!1),u.addEventListener("keyup",this.onKeyUp,!1),this.enabled=!0)},stopListeners:function(){var l=this.target;l.removeEventListener("keydown",this.onKeyDown,!1),l.removeEventListener("keyup",this.onKeyUp,!1),this.enabled=!1},postUpdate:function(){this.queue=[]},addCapture:function(l){typeof l=="string"&&(l=l.split(",")),Array.isArray(l)||(l=[l]);for(var u=this.captures,d=0;d<l.length;d++){var p=l[d];typeof p=="string"&&(p=o[p.trim().toUpperCase()]),u.indexOf(p)===-1&&u.push(p)}this.preventDefault=u.length>0},removeCapture:function(l){typeof l=="string"&&(l=l.split(",")),Array.isArray(l)||(l=[l]);for(var u=this.captures,d=0;d<l.length;d++){var p=l[d];typeof p=="string"&&(p=o[p.toUpperCase()]),i(u,p)}this.preventDefault=u.length>0},clearCaptures:function(){this.captures=[],this.preventDefault=!1},destroy:function(){this.stopListeners(),this.clearCaptures(),this.queue=[],this.manager.game.events.off(n.POST_RENDER,this.postUpdate,this),this.target=null,this.enabled=!1,this.manager=null}});t.exports=h}),Wu=y((e,t)=>{var i=W(),s=Zr(),n=pi(),r=Rt(),o=new i({initialize:function(a){this.manager=a,this.preventDefaultDown=!0,this.preventDefaultUp=!0,this.preventDefaultMove=!0,this.preventDefaultWheel=!1,this.enabled=!1,this.target,this.locked=!1,this.onMouseMove=r,this.onMouseDown=r,this.onMouseUp=r,this.onMouseDownWindow=r,this.onMouseUpWindow=r,this.onMouseOver=r,this.onMouseOut=r,this.onMouseWheel=r,this.pointerLockChange=r,this.isTop=!0,a.events.once(n.MANAGER_BOOT,this.boot,this)},boot:function(){var a=this.manager.config;this.enabled=a.inputMouse,this.target=a.inputMouseEventTarget,this.passive=a.inputMousePassive,this.preventDefaultDown=a.inputMousePreventDefaultDown,this.preventDefaultUp=a.inputMousePreventDefaultUp,this.preventDefaultMove=a.inputMousePreventDefaultMove,this.preventDefaultWheel=a.inputMousePreventDefaultWheel,this.target?typeof this.target=="string"&&(this.target=document.getElementById(this.target)):this.target=this.manager.game.canvas,a.disableContextMenu&&this.disableContextMenu(),this.enabled&&this.target&&this.startListeners()},disableContextMenu:function(){return this.target.addEventListener("contextmenu",function(a){return a.preventDefault(),!1}),this},requestPointerLock:function(){if(s.pointerLock){var a=this.target;a.requestPointerLock=a.requestPointerLock||a.mozRequestPointerLock||a.webkitRequestPointerLock,a.requestPointerLock()}},releasePointerLock:function(){s.pointerLock&&(document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,document.exitPointerLock())},startListeners:function(){var a=this.target;if(a){var h=this,l=this.manager,u=l.canvas,d=window&&window.focus&&l.game.config.autoFocus;this.onMouseMove=function(g){!g.defaultPrevented&&h.enabled&&l&&l.enabled&&(l.onMouseMove(g),h.preventDefaultMove&&g.preventDefault())},this.onMouseDown=function(g){d&&window.focus(),!g.defaultPrevented&&h.enabled&&l&&l.enabled&&(l.onMouseDown(g),h.preventDefaultDown&&g.target===u&&g.preventDefault())},this.onMouseDownWindow=function(g){g.sourceCapabilities&&g.sourceCapabilities.firesTouchEvents||!g.defaultPrevented&&h.enabled&&l&&l.enabled&&g.target!==u&&l.onMouseDown(g)},this.onMouseUp=function(g){!g.defaultPrevented&&h.enabled&&l&&l.enabled&&(l.onMouseUp(g),h.preventDefaultUp&&g.target===u&&g.preventDefault())},this.onMouseUpWindow=function(g){g.sourceCapabilities&&g.sourceCapabilities.firesTouchEvents||!g.defaultPrevented&&h.enabled&&l&&l.enabled&&g.target!==u&&l.onMouseUp(g)},this.onMouseOver=function(g){!g.defaultPrevented&&h.enabled&&l&&l.enabled&&l.setCanvasOver(g)},this.onMouseOut=function(g){!g.defaultPrevented&&h.enabled&&l&&l.enabled&&l.setCanvasOut(g)},this.onMouseWheel=function(g){!g.defaultPrevented&&h.enabled&&l&&l.enabled&&l.onMouseWheel(g),h.preventDefaultWheel&&g.target===u&&g.preventDefault()};var p={passive:!0};if(a.addEventListener("mousemove",this.onMouseMove),a.addEventListener("mousedown",this.onMouseDown),a.addEventListener("mouseup",this.onMouseUp),a.addEventListener("mouseover",this.onMouseOver,p),a.addEventListener("mouseout",this.onMouseOut,p),this.preventDefaultWheel?a.addEventListener("wheel",this.onMouseWheel,{passive:!1}):a.addEventListener("wheel",this.onMouseWheel,p),window&&l.game.config.inputWindowEvents)try{window.top.addEventListener("mousedown",this.onMouseDownWindow,p),window.top.addEventListener("mouseup",this.onMouseUpWindow,p)}catch{window.addEventListener("mousedown",this.onMouseDownWindow,p),window.addEventListener("mouseup",this.onMouseUpWindow,p),this.isTop=!1}s.pointerLock&&(this.pointerLockChange=function(g){var c=h.target;h.locked=document.pointerLockElement===c||document.mozPointerLockElement===c||document.webkitPointerLockElement===c,l.onPointerLockChange(g)},document.addEventListener("pointerlockchange",this.pointerLockChange,!0),document.addEventListener("mozpointerlockchange",this.pointerLockChange,!0),document.addEventListener("webkitpointerlockchange",this.pointerLockChange,!0)),this.enabled=!0}},stopListeners:function(){var a=this.target;a.removeEventListener("mousemove",this.onMouseMove),a.removeEventListener("mousedown",this.onMouseDown),a.removeEventListener("mouseup",this.onMouseUp),a.removeEventListener("mouseover",this.onMouseOver),a.removeEventListener("mouseout",this.onMouseOut),window&&(a=this.isTop?window.top:window,a.removeEventListener("mousedown",this.onMouseDownWindow),a.removeEventListener("mouseup",this.onMouseUpWindow)),s.pointerLock&&(document.removeEventListener("pointerlockchange",this.pointerLockChange,!0),document.removeEventListener("mozpointerlockchange",this.pointerLockChange,!0),document.removeEventListener("webkitpointerlockchange",this.pointerLockChange,!0))},destroy:function(){this.stopListeners(),this.target=null,this.enabled=!1,this.manager=null}});t.exports=o}),Vu=y((e,t)=>{var i=Pl(),s=W(),n=Mn(),r=ta(),o=kl(),a=xt(),h=Cs(),l=new s({initialize:function(u,d){this.manager=u,this.id=d,this.event,this.downElement,this.upElement,this.camera=null,this.button=0,this.buttons=0,this.position=new a,this.prevPosition=new a,this.midPoint=new a(-1,-1),this.velocity=new a,this.angle=0,this.distance=0,this.smoothFactor=0,this.motionFactor=.2,this.worldX=0,this.worldY=0,this.moveTime=0,this.downX=0,this.downY=0,this.downTime=0,this.upX=0,this.upY=0,this.upTime=0,this.primaryDown=!1,this.isDown=!1,this.wasTouch=!1,this.wasCanceled=!1,this.movementX=0,this.movementY=0,this.identifier=0,this.pointerId=null,this.active=d===0,this.locked=!1,this.deltaX=0,this.deltaY=0,this.deltaZ=0},updateWorldPoint:function(u){var d=u.getWorldPoint(this.x,this.y);return this.worldX=d.x,this.worldY=d.y,this},positionToCamera:function(u,d){return u.getWorldPoint(this.x,this.y,d)},updateMotion:function(){var u=this.position.x,d=this.position.y,p=this.midPoint.x,g=this.midPoint.y;if(!(u===p&&d===g)){var c=o(this.motionFactor,p,u),f=o(this.motionFactor,g,d);r(c,u,.1)&&(c=u),r(f,d,.1)&&(f=d),this.midPoint.set(c,f);var m=u-c,v=d-f;this.velocity.set(m,v),this.angle=i(c,f,u,d),this.distance=Math.sqrt(m*m+v*v)}},up:function(u){"buttons"in u&&(this.buttons=u.buttons),this.event=u,this.button=u.button,this.upElement=u.target,this.manager.transformPointer(this,u.pageX,u.pageY,!1),u.button===0&&(this.primaryDown=!1,this.upX=this.x,this.upY=this.y),this.buttons===0&&(this.isDown=!1,this.upTime=u.timeStamp,this.wasTouch=!1)},down:function(u){"buttons"in u&&(this.buttons=u.buttons),this.event=u,this.button=u.button,this.downElement=u.target,this.manager.transformPointer(this,u.pageX,u.pageY,!1),u.button===0&&(this.primaryDown=!0,this.downX=this.x,this.downY=this.y),h.macOS&&u.ctrlKey&&(this.buttons=2,this.primaryDown=!1),this.isDown||(this.isDown=!0,this.downTime=u.timeStamp),this.wasTouch=!1},move:function(u){"buttons"in u&&(this.buttons=u.buttons),this.event=u,this.manager.transformPointer(this,u.pageX,u.pageY,!0),this.locked&&(this.movementX=u.movementX||u.mozMovementX||u.webkitMovementX||0,this.movementY=u.movementY||u.mozMovementY||u.webkitMovementY||0),this.moveTime=u.timeStamp,this.wasTouch=!1},wheel:function(u){"buttons"in u&&(this.buttons=u.buttons),this.event=u,this.manager.transformPointer(this,u.pageX,u.pageY,!1),this.deltaX=u.deltaX,this.deltaY=u.deltaY,this.deltaZ=u.deltaZ,this.wasTouch=!1},touchstart:function(u,d){u.pointerId&&(this.pointerId=u.pointerId),this.identifier=u.identifier,this.target=u.target,this.active=!0,this.buttons=1,this.event=d,this.downElement=u.target,this.manager.transformPointer(this,u.pageX,u.pageY,!1),this.primaryDown=!0,this.downX=this.x,this.downY=this.y,this.downTime=d.timeStamp,this.isDown=!0,this.wasTouch=!0,this.wasCanceled=!1,this.updateMotion()},touchmove:function(u,d){this.event=d,this.manager.transformPointer(this,u.pageX,u.pageY,!0),this.moveTime=d.timeStamp,this.wasTouch=!0,this.updateMotion()},touchend:function(u,d){this.buttons=0,this.event=d,this.upElement=u.target,this.manager.transformPointer(this,u.pageX,u.pageY,!1),this.primaryDown=!1,this.upX=this.x,this.upY=this.y,this.upTime=d.timeStamp,this.isDown=!1,this.wasTouch=!0,this.wasCanceled=!1,this.active=!1,this.updateMotion()},touchcancel:function(u,d){this.buttons=0,this.event=d,this.upElement=u.target,this.manager.transformPointer(this,u.pageX,u.pageY,!1),this.primaryDown=!1,this.upX=this.x,this.upY=this.y,this.upTime=d.timeStamp,this.isDown=!1,this.wasTouch=!0,this.wasCanceled=!0,this.active=!1},noButtonDown:function(){return this.buttons===0},leftButtonDown:function(){return!!(this.buttons&1)},rightButtonDown:function(){return!!(this.buttons&2)},middleButtonDown:function(){return!!(this.buttons&4)},backButtonDown:function(){return!!(this.buttons&8)},forwardButtonDown:function(){return!!(this.buttons&16)},leftButtonReleased:function(){return this.buttons===0?this.button===0&&!this.isDown:this.button===0},rightButtonReleased:function(){return this.buttons===0?this.button===2&&!this.isDown:this.button===2},middleButtonReleased:function(){return this.buttons===0?this.button===1&&!this.isDown:this.button===1},backButtonReleased:function(){return this.buttons===0?this.button===3&&!this.isDown:this.button===3},forwardButtonReleased:function(){return this.buttons===0?this.button===4&&!this.isDown:this.button===4},getDistance:function(){return this.isDown?n(this.downX,this.downY,this.x,this.y):n(this.downX,this.downY,this.upX,this.upY)},getDistanceX:function(){return this.isDown?Math.abs(this.downX-this.x):Math.abs(this.downX-this.upX)},getDistanceY:function(){return this.isDown?Math.abs(this.downY-this.y):Math.abs(this.downY-this.upY)},getDuration:function(){return this.isDown?this.manager.time-this.downTime:this.upTime-this.downTime},getAngle:function(){return this.isDown?i(this.downX,this.downY,this.x,this.y):i(this.downX,this.downY,this.upX,this.upY)},getInterpolatedPosition:function(u,d){u===void 0&&(u=10),d===void 0&&(d=[]);for(var p=this.prevPosition.x,g=this.prevPosition.y,c=this.position.x,f=this.position.y,m=0;m<u;m++){var v=1/u*m;d[m]={x:o(v,p,c),y:o(v,g,f)}}return d},reset:function(){this.event=null,this.downElement=null,this.upElement=null,this.button=0,this.buttons=0,this.position.set(0,0),this.prevPosition.set(0,0),this.midPoint.set(-1,-1),this.velocity.set(0,0),this.angle=0,this.distance=0,this.worldX=0,this.worldY=0,this.downX=0,this.downY=0,this.upX=0,this.upY=0,this.moveTime=0,this.upTime=0,this.downTime=0,this.primaryDown=!1,this.isDown=!1,this.wasTouch=!1,this.wasCanceled=!1,this.movementX=0,this.movementY=0,this.identifier=0,this.pointerId=null,this.deltaX=0,this.deltaY=0,this.deltaZ=0,this.active=this.id===0},destroy:function(){this.camera=null,this.manager=null,this.position=null},x:{get:function(){return this.position.x},set:function(u){this.position.x=u}},y:{get:function(){return this.position.y},set:function(u){this.position.y=u}},time:{get:function(){return this.event?this.event.timeStamp:0}}});t.exports=l}),Xu=y((e,t)=>{var i=W(),s=pi(),n=Rt(),r=new i({initialize:function(o){this.manager=o,this.capture=!0,this.enabled=!1,this.target,this.onTouchStart=n,this.onTouchStartWindow=n,this.onTouchMove=n,this.onTouchEnd=n,this.onTouchEndWindow=n,this.onTouchCancel=n,this.onTouchCancelWindow=n,this.isTop=!0,o.events.once(s.MANAGER_BOOT,this.boot,this)},boot:function(){var o=this.manager.config;this.enabled=o.inputTouch,this.target=o.inputTouchEventTarget,this.capture=o.inputTouchCapture,this.target?typeof this.target=="string"&&(this.target=document.getElementById(this.target)):this.target=this.manager.game.canvas,o.disableContextMenu&&this.disableContextMenu(),this.enabled&&this.target&&this.startListeners()},disableContextMenu:function(){return this.target.addEventListener("contextmenu",function(o){return o.preventDefault(),!1}),this},startListeners:function(){var o=this.target;if(o){var a=this,h=this.manager,l=h.canvas,u=window&&window.focus&&h.game.config.autoFocus;this.onTouchMove=function(c){!c.defaultPrevented&&a.enabled&&h&&h.enabled&&(h.onTouchMove(c),a.capture&&c.cancelable&&c.preventDefault())},this.onTouchStart=function(c){u&&window.focus(),!c.defaultPrevented&&a.enabled&&h&&h.enabled&&(h.onTouchStart(c),a.capture&&c.cancelable&&c.target===l&&c.preventDefault())},this.onTouchStartWindow=function(c){!c.defaultPrevented&&a.enabled&&h&&h.enabled&&c.target!==l&&h.onTouchStart(c)},this.onTouchEnd=function(c){!c.defaultPrevented&&a.enabled&&h&&h.enabled&&(h.onTouchEnd(c),a.capture&&c.cancelable&&c.target===l&&c.preventDefault())},this.onTouchEndWindow=function(c){!c.defaultPrevented&&a.enabled&&h&&h.enabled&&c.target!==l&&h.onTouchEnd(c)},this.onTouchCancel=function(c){!c.defaultPrevented&&a.enabled&&h&&h.enabled&&(h.onTouchCancel(c),a.capture&&c.preventDefault())},this.onTouchCancelWindow=function(c){!c.defaultPrevented&&a.enabled&&h&&h.enabled&&h.onTouchCancel(c)};var d=this.capture,p={passive:!0},g={passive:!1};if(o.addEventListener("touchstart",this.onTouchStart,d?g:p),o.addEventListener("touchmove",this.onTouchMove,d?g:p),o.addEventListener("touchend",this.onTouchEnd,d?g:p),o.addEventListener("touchcancel",this.onTouchCancel,d?g:p),window&&h.game.config.inputWindowEvents)try{window.top.addEventListener("touchstart",this.onTouchStartWindow,g),window.top.addEventListener("touchend",this.onTouchEndWindow,g),window.top.addEventListener("touchcancel",this.onTouchCancelWindow,g)}catch{window.addEventListener("touchstart",this.onTouchStartWindow,g),window.addEventListener("touchend",this.onTouchEndWindow,g),window.addEventListener("touchcancel",this.onTouchCancelWindow,g),this.isTop=!1}this.enabled=!0}},stopListeners:function(){var o=this.target;o.removeEventListener("touchstart",this.onTouchStart),o.removeEventListener("touchmove",this.onTouchMove),o.removeEventListener("touchend",this.onTouchEnd),o.removeEventListener("touchcancel",this.onTouchCancel),window&&(o=this.isTop?window.top:window,o.removeEventListener("touchstart",this.onTouchStartWindow),o.removeEventListener("touchend",this.onTouchEndWindow),o.removeEventListener("touchcancel",this.onTouchCancelWindow))},destroy:function(){this.stopListeners(),this.target=null,this.enabled=!1,this.manager=null}});t.exports=r}),Ku=y((e,t)=>{var i=W(),s=xa(),n=Ct(),r=pi(),o=$t(),a=zu(),h=Wu(),l=Vu(),u=Xu(),d=Re(),p=na(),g=new i({initialize:function(c,f){this.game=c,this.scaleManager,this.canvas,this.config=f,this.enabled=!0,this.events=new n,this.isOver=!0,this.defaultCursor="",this.keyboard=f.inputKeyboard?new a(this):null,this.mouse=f.inputMouse?new h(this):null,this.touch=f.inputTouch?new u(this):null,this.pointers=[],this.pointersTotal=f.inputActivePointers;for(var m=0;m<=this.pointersTotal;m++){var v=new l(this,m);v.smoothFactor=f.inputSmoothFactor,this.pointers.push(v)}this.mousePointer=f.inputMouse?this.pointers[0]:null,this.activePointer=this.pointers[0],this.globalTopOnly=!0,this.time=0,this._tempPoint={x:0,y:0},this._tempHitTest=[],this._tempMatrix=new d,this._tempMatrix2=new d,this._tempSkip=!1,this.mousePointerContainer=[this.mousePointer],c.events.once(o.BOOT,this.boot,this)},boot:function(){var c=this.game,f=c.events;this.canvas=c.canvas,this.scaleManager=c.scale,this.events.emit(r.MANAGER_BOOT),f.on(o.PRE_RENDER,this.preRender,this),f.once(o.DESTROY,this.destroy,this)},setCanvasOver:function(c){this.isOver=!0,this.events.emit(r.GAME_OVER,c)},setCanvasOut:function(c){this.isOver=!1,this.events.emit(r.GAME_OUT,c)},preRender:function(){var c=this.game.loop.now,f=this.game.loop.delta,m=this.game.scene.getScenes(!0,!0);this.time=c,this.events.emit(r.MANAGER_UPDATE);for(var v=0;v<m.length;v++){var E=m[v];if(E.sys.input&&E.sys.input.updatePoll(c,f)&&this.globalTopOnly)return}},setDefaultCursor:function(c){this.defaultCursor=c,this.canvas.style.cursor!==c&&(this.canvas.style.cursor=c)},setCursor:function(c){c.cursor&&(this.canvas.style.cursor=c.cursor)},resetCursor:function(c,f){(f||c&&c.cursor)&&this.canvas&&(this.canvas.style.cursor=this.defaultCursor)},addPointer:function(c){c===void 0&&(c=1);var f=[];this.pointersTotal+c>10&&(c=10-this.pointersTotal);for(var m=0;m<c;m++){var v=this.pointers.length,E=new l(this,v);E.smoothFactor=this.config.inputSmoothFactor,this.pointers.push(E),this.pointersTotal++,f.push(E)}return f},updateInputPlugins:function(c,f){var m=this.game.scene.getScenes(!1,!0);this._tempSkip=!1;for(var v=0;v<m.length;v++){var E=m[v];if(E.sys.input){var x=E.sys.input.update(c,f);if(x&&this.globalTopOnly||this._tempSkip)return}}},onTouchStart:function(c){for(var f=this.pointers,m=[],v=0;v<c.changedTouches.length;v++)for(var E=c.changedTouches[v],x=1;x<f.length;x++){var T=f[x];if(!T.active){T.touchstart(E,c),this.activePointer=T,m.push(T);break}}this.updateInputPlugins(s.TOUCH_START,m)},onTouchMove:function(c){for(var f=this.pointers,m=[],v=0;v<c.changedTouches.length;v++)for(var E=c.changedTouches[v],x=1;x<f.length;x++){var T=f[x];if(T.active&&T.identifier===E.identifier){var A=document.elementFromPoint(E.clientX,E.clientY),P=A===this.canvas;!this.isOver&&P?this.setCanvasOver(c):this.isOver&&!P&&this.setCanvasOut(c),this.isOver&&(T.touchmove(E,c),this.activePointer=T,m.push(T));break}}this.updateInputPlugins(s.TOUCH_MOVE,m)},onTouchEnd:function(c){for(var f=this.pointers,m=[],v=0;v<c.changedTouches.length;v++)for(var E=c.changedTouches[v],x=1;x<f.length;x++){var T=f[x];if(T.active&&T.identifier===E.identifier){T.touchend(E,c),m.push(T);break}}this.updateInputPlugins(s.TOUCH_END,m)},onTouchCancel:function(c){for(var f=this.pointers,m=[],v=0;v<c.changedTouches.length;v++)for(var E=c.changedTouches[v],x=1;x<f.length;x++){var T=f[x];if(T.active&&T.identifier===E.identifier){T.touchcancel(E,c),m.push(T);break}}this.updateInputPlugins(s.TOUCH_CANCEL,m)},onMouseDown:function(c){var f=this.mousePointer;f.down(c),f.updateMotion(),this.activePointer=f,this.updateInputPlugins(s.MOUSE_DOWN,this.mousePointerContainer)},onMouseMove:function(c){var f=this.mousePointer;f.move(c),f.updateMotion(),this.activePointer=f,this.updateInputPlugins(s.MOUSE_MOVE,this.mousePointerContainer)},onMouseUp:function(c){var f=this.mousePointer;f.up(c),f.updateMotion(),this.activePointer=f,this.updateInputPlugins(s.MOUSE_UP,this.mousePointerContainer)},onMouseWheel:function(c){var f=this.mousePointer;f.wheel(c),this.activePointer=f,this.updateInputPlugins(s.MOUSE_WHEEL,this.mousePointerContainer)},onPointerLockChange:function(c){var f=this.mouse.locked;this.mousePointer.locked=f,this.events.emit(r.POINTERLOCK_CHANGE,c,f)},inputCandidate:function(c,f){var m=c.input;if(!m||!m.enabled||!c.willRender(f))return!1;var v=!0,E=c.parentContainer;if(E)do{if(!E.willRender(f)){v=!1;break}E=E.parentContainer}while(E);return v},hitTest:function(c,f,m,v){v===void 0&&(v=this._tempHitTest);var E=this._tempPoint,x=m.scrollX,T=m.scrollY;v.length=0;var A=c.x,P=c.y;m.getWorldPoint(A,P,E),c.worldX=E.x,c.worldY=E.y;for(var R={x:0,y:0},S=this._tempMatrix,I=this._tempMatrix2,w=0;w<f.length;w++){var C=f[w];if(this.inputCandidate(C,m)){var _=E.x+x*C.scrollFactorX-x,O=E.y+T*C.scrollFactorY-T;C.parentContainer?(C.getWorldTransformMatrix(S,I),S.applyInverse(_,O,R)):p(_,O,C.x,C.y,C.rotation,C.scaleX,C.scaleY,R),this.pointWithinHitArea(C,R.x,R.y)&&v.push(C)}}return v},pointWithinHitArea:function(c,f,m){f+=c.displayOriginX,m+=c.displayOriginY;var v=c.input;return v&&v.hitAreaCallback(v.hitArea,f,m,c)?(v.localX=f,v.localY=m,!0):!1},pointWithinInteractiveObject:function(c,f,m){return c.hitArea?(f+=c.gameObject.displayOriginX,m+=c.gameObject.displayOriginY,c.localX=f,c.localY=m,c.hitAreaCallback(c.hitArea,f,m,c)):!1},transformPointer:function(c,f,m,v){var E=c.position,x=c.prevPosition;x.x=E.x,x.y=E.y;var T=this.scaleManager.transformX(f),A=this.scaleManager.transformY(m),P=c.smoothFactor;!v||P===0?(E.x=T,E.y=A):(E.x=T*P+x.x*(1-P),E.y=A*P+x.y*(1-P))},destroy:function(){this.events.removeAllListeners(),this.game.events.off(o.PRE_RENDER),this.keyboard&&this.keyboard.destroy(),this.mouse&&this.mouse.destroy(),this.touch&&this.touch.destroy();for(var c=0;c<this.pointers.length;c++)this.pointers[c].destroy();this.pointers=[],this._tempHitTest=[],this._tempMatrix.destroy(),this.canvas=null,this.game=null}});t.exports=g}),gi=y((e,t)=>{var i={},s={install:function(n){for(var r in i)n[r]=i[r]},register:function(n,r){i[n]=r},destroy:function(){i={}}};t.exports=s}),de=y((e,t)=>{var i=W(),s=he(),n=Vt(),r=new i({initialize:function(o){this.scene=o,this.systems=o.sys,this.events=o.sys.events,this.displayList,this.updateList,this.events.once(n.BOOT,this.boot,this),this.events.on(n.START,this.start,this)},boot:function(){this.displayList=this.systems.displayList,this.updateList=this.systems.updateList,this.events.once(n.DESTROY,this.destroy,this)},start:function(){this.events.once(n.SHUTDOWN,this.shutdown,this)},shutdown:function(){this.events.off(n.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(n.START,this.start,this),this.scene=null,this.systems=null,this.events=null,this.displayList=null,this.updateList=null}});r.register=function(o,a){r.prototype.hasOwnProperty(o)||(r.prototype[o]=a)},r.remove=function(o){r.prototype.hasOwnProperty(o)&&delete r.prototype[o]},s.register("GameObjectCreator",r,"make"),t.exports=r}),_T=y((e,t)=>{var i=W(),s=$t(),n=Ct(),r=gi(),o=de(),a=jt(),h=dt(),l=he(),u=Ye(),d=Pe(),p=new i({Extends:n,initialize:function(g){n.call(this),this.game=g,this.plugins=[],this.scenePlugins=[],this._pendingGlobal=[],this._pendingScene=[],g.isBooted||g.config.renderType===d.HEADLESS?this.boot():g.events.once(s.BOOT,this.boot,this)},boot:function(){var g,c,f,m,v,E,x,T=this.game.config,A=T.installGlobalPlugins;for(A=A.concat(this._pendingGlobal),g=0;g<A.length;g++)c=A[g],f=h(c,"key",null),m=h(c,"plugin",null),v=h(c,"start",!1),E=h(c,"mapping",null),x=h(c,"data",null),f&&m&&this.install(f,m,v,E,x);for(A=T.installScenePlugins,A=A.concat(this._pendingScene),g=0;g<A.length;g++)c=A[g],f=h(c,"key",null),m=h(c,"plugin",null),E=h(c,"mapping",null),f&&m&&this.installScenePlugin(f,m,E);this._pendingGlobal=[],this._pendingScene=[],this.game.events.once(s.DESTROY,this.destroy,this)},addToScene:function(g,c,f){var m,v,E,x=this.game,T=g.scene,A=g.settings.map,P=g.settings.isBooted;for(m=0;m<c.length;m++)v=c[m],x[v]?(g[v]=x[v],A.hasOwnProperty(v)&&(T[A[v]]=g[v])):v==="game"&&A.hasOwnProperty(v)&&(T[A[v]]=x);for(var R=0;R<f.length;R++)for(E=f[R],m=0;m<E.length;m++)if(v=E[m],!!l.hasCore(v)){var S=l.getCore(v),I=S.mapping,w=new S.plugin(T,this,I);g[I]=w,S.custom?T[I]=w:A.hasOwnProperty(I)&&(T[A[I]]=w),P&&w.boot()}for(E=this.plugins,m=0;m<E.length;m++){var C=E[m];C.mapping&&(T[C.mapping]=C.plugin)}},getDefaultScenePlugins:function(){var g=this.game.config.defaultPlugins;return g=g.concat(this.scenePlugins),g},installScenePlugin:function(g,c,f,m,v){if(v===void 0&&(v=!1),typeof c=="function"){if(l.hasCore(g)||l.register(g,c,f,!0),this.scenePlugins.indexOf(g)===-1)this.scenePlugins.push(g);else if(!v&&l.hasCore(g))return;if(m){var E=new c(m,this,g);m.sys[g]=E,f&&f!==""&&(m[f]=E),E.boot()}}},install:function(g,c,f,m,v){if(f===void 0&&(f=!1),m===void 0&&(m=null),v===void 0&&(v=null),typeof c!="function"||l.hasCustom(g))return null;if(m!==null&&(f=!0),!this.game.isBooted)this._pendingGlobal.push({key:g,plugin:c,start:f,mapping:m,data:v});else if(l.registerCustom(g,c,m,v),f)return this.start(g);return null},getIndex:function(g){for(var c=this.plugins,f=0;f<c.length;f++){var m=c[f];if(m.key===g)return f}return-1},getEntry:function(g){var c=this.getIndex(g);if(c!==-1)return this.plugins[c]},isActive:function(g){var c=this.getEntry(g);return c&&c.active},start:function(g,c){c===void 0&&(c=g);var f=this.getEntry(c);return f&&!f.active?(f.active=!0,f.plugin.start()):f||(f=this.createEntry(g,c)),f?f.plugin:null},createEntry:function(g,c){var f=l.getCustom(g);if(f){var m=new f.plugin(this);f={key:c,plugin:m,active:!0,mapping:f.mapping,data:f.data},this.plugins.push(f),m.init(f.data),m.start()}return f},stop:function(g){var c=this.getEntry(g);return c&&c.active&&(c.active=!1,c.plugin.stop()),this},get:function(g,c){c===void 0&&(c=!0);var f=this.getEntry(g);if(f)return f.plugin;var m=this.getClass(g);return m&&c?(f=this.createEntry(g,g),f?f.plugin:null):m||null},getClass:function(g){return l.getCustomClass(g)},removeGlobalPlugin:function(g){var c=this.getEntry(g);c&&u(this.plugins,c),l.removeCustom(g)},removeScenePlugin:function(g){u(this.scenePlugins,g),l.remove(g)},registerGameObject:function(g,c,f){return c&&a.register(g,c),f&&o.register(g,f),this},removeGameObject:function(g,c,f){return c===void 0&&(c=!0),f===void 0&&(f=!0),c&&a.remove(g),f&&o.remove(g),this},registerFileType:function(g,c,f){r.register(g,c),f&&f.sys.load&&(f.sys.load[g]=c)},destroy:function(){for(var g=0;g<this.plugins.length;g++)this.plugins[g].plugin.destroy();l.destroyCustomPlugins(),this.game.noReturn&&l.destroyCorePlugins(),this.game=null,this.plugins=[],this.scenePlugins=[]}});t.exports=p}),ju=y((e,t)=>{t.exports={NO_CENTER:0,CENTER_BOTH:1,CENTER_HORIZONTALLY:2,CENTER_VERTICALLY:3}}),Zu=y((e,t)=>{t.exports={LANDSCAPE:"landscape-primary",LANDSCAPE_SECONDARY:"landscape-secondary",PORTRAIT:"portrait-primary",PORTRAIT_SECONDARY:"portrait-secondary"}}),qu=y((e,t)=>{t.exports={NONE:0,WIDTH_CONTROLS_HEIGHT:1,HEIGHT_CONTROLS_WIDTH:2,FIT:3,ENVELOP:4,RESIZE:5,EXPAND:6}}),Ju=y((e,t)=>{t.exports={NO_ZOOM:1,ZOOM_2X:2,ZOOM_4X:4,MAX_ZOOM:-1}}),Sa=y((e,t)=>{var i={CENTER:ju(),ORIENTATION:Zu(),SCALE_MODE:qu(),ZOOM:Ju()};t.exports=i}),OT=y((e,t)=>{var i=function(s){if(!s)return window.innerHeight;var n=Math.abs(window.orientation),r={w:0,h:0},o=document.createElement("div");return o.setAttribute("style","position: fixed; height: 100vh; width: 0; top: 0"),document.documentElement.appendChild(o),r.w=n===90?o.offsetHeight:window.innerWidth,r.h=n===90?window.innerWidth:o.offsetHeight,document.documentElement.removeChild(o),o=null,Math.abs(window.orientation)!==90?r.h:r.w};t.exports=i}),MT=y((e,t)=>{var i=function(s){var n;return s!==""&&(typeof s=="string"?n=document.getElementById(s):s&&s.nodeType===1&&(n=s)),n||(n=document.body),n};t.exports=i}),LT=y((e,t)=>{var i=Sa(),s=function(n,r){var o=window.screen,a=o?o.orientation||o.mozOrientation||o.msOrientation:!1;if(a&&typeof a.type=="string")return a.type;if(typeof a=="string")return a;if(typeof window.orientation=="number")return window.orientation===0||window.orientation===180?i.ORIENTATION.PORTRAIT:i.ORIENTATION.LANDSCAPE;if(window.matchMedia){if(window.matchMedia("(orientation: portrait)").matches)return i.ORIENTATION.PORTRAIT;if(window.matchMedia("(orientation: landscape)").matches)return i.ORIENTATION.LANDSCAPE}else return r>n?i.ORIENTATION.PORTRAIT:i.ORIENTATION.LANDSCAPE};t.exports=s}),Qu=y((e,t)=>{var i=Ot(),s=W(),n=kn(),r=xt(),o=new s({initialize:function(a,h,l,u){a===void 0&&(a=0),h===void 0&&(h=a),l===void 0&&(l=0),u===void 0&&(u=null),this._width=a,this._height=h,this._parent=u,this.aspectMode=l,this.aspectRatio=h===0?1:a/h,this.minWidth=0,this.minHeight=0,this.maxWidth=Number.MAX_VALUE,this.maxHeight=Number.MAX_VALUE,this.snapTo=new r},setAspectMode:function(a){return a===void 0&&(a=0),this.aspectMode=a,this.setSize(this._width,this._height)},setSnap:function(a,h){return a===void 0&&(a=0),h===void 0&&(h=a),this.snapTo.set(a,h),this.setSize(this._width,this._height)},setParent:function(a){return this._parent=a,this.setSize(this._width,this._height)},setMin:function(a,h){return a===void 0&&(a=0),h===void 0&&(h=a),this.minWidth=i(a,0,this.maxWidth),this.minHeight=i(h,0,this.maxHeight),this.setSize(this._width,this._height)},setMax:function(a,h){return a===void 0&&(a=Number.MAX_VALUE),h===void 0&&(h=a),this.maxWidth=i(a,this.minWidth,Number.MAX_VALUE),this.maxHeight=i(h,this.minHeight,Number.MAX_VALUE),this.setSize(this._width,this._height)},setSize:function(a,h){switch(a===void 0&&(a=0),h===void 0&&(h=a),this.aspectMode){case o.NONE:this._width=this.getNewWidth(n(a,this.snapTo.x)),this._height=this.getNewHeight(n(h,this.snapTo.y)),this.aspectRatio=this._height===0?1:this._width/this._height;break;case o.WIDTH_CONTROLS_HEIGHT:this._width=this.getNewWidth(n(a,this.snapTo.x)),this._height=this.getNewHeight(this._width*(1/this.aspectRatio),!1);break;case o.HEIGHT_CONTROLS_WIDTH:this._height=this.getNewHeight(n(h,this.snapTo.y)),this._width=this.getNewWidth(this._height*this.aspectRatio,!1);break;case o.FIT:this.constrain(a,h,!0);break;case o.ENVELOP:this.constrain(a,h,!1);break}return this},setAspectRatio:function(a){return this.aspectRatio=a,this.setSize(this._width,this._height)},resize:function(a,h){return this._width=this.getNewWidth(n(a,this.snapTo.x)),this._height=this.getNewHeight(n(h,this.snapTo.y)),this.aspectRatio=this._height===0?1:this._width/this._height,this},getNewWidth:function(a,h){return h===void 0&&(h=!0),a=i(a,this.minWidth,this.maxWidth),h&&this._parent&&a>this._parent.width&&(a=Math.max(this.minWidth,this._parent.width)),a},getNewHeight:function(a,h){return h===void 0&&(h=!0),a=i(a,this.minHeight,this.maxHeight),h&&this._parent&&a>this._parent.height&&(a=Math.max(this.minHeight,this._parent.height)),a},constrain:function(a,h,l){a===void 0&&(a=0),h===void 0&&(h=a),l===void 0&&(l=!0),a=this.getNewWidth(a),h=this.getNewHeight(h);var u=this.snapTo,d=h===0?1:a/h;return l&&this.aspectRatio>d||!l&&this.aspectRatio<d?(a=n(a,u.x),h=a/this.aspectRatio,u.y>0&&(h=n(h,u.y),a=h*this.aspectRatio)):(l&&this.aspectRatio<d||!l&&this.aspectRatio>d)&&(h=n(h,u.y),a=h*this.aspectRatio,u.x>0&&(a=n(a,u.x),h=a*(1/this.aspectRatio))),this._width=a,this._height=h,this},fitTo:function(a,h){return this.constrain(a,h,!0)},envelop:function(a,h){return this.constrain(a,h,!1)},setWidth:function(a){return this.setSize(a,this._height)},setHeight:function(a){return this.setSize(this._width,a)},toString:function(){return"[{ Size (width="+this._width+" height="+this._height+" aspectRatio="+this.aspectRatio+" aspectMode="+this.aspectMode+") }]"},setCSS:function(a){a&&a.style&&(a.style.width=this._width+"px",a.style.height=this._height+"px")},copy:function(a){return a.setAspectMode(this.aspectMode),a.aspectRatio=this.aspectRatio,a.setSize(this.width,this.height)},destroy:function(){this._parent=null,this.snapTo=null},width:{get:function(){return this._width},set:function(a){this.setSize(a,this._height)}},height:{get:function(){return this._height},set:function(a){this.setSize(this._width,a)}}});o.NONE=0,o.WIDTH_CONTROLS_HEIGHT=1,o.HEIGHT_CONTROLS_WIDTH=2,o.FIT=3,o.ENVELOP=4,t.exports=o}),$u=y((e,t)=>{var i=Sa(),s=W(),n=Ct(),r=Is(),o=$t(),a=OT(),h=MT(),l=LT(),u=Rt(),d=Ut(),p=Qu(),g=kn(),c=xt(),f=Dn(),m=new s({Extends:n,initialize:function(v){n.call(this),this.game=v,this.canvas,this.canvasBounds=new d,this.parent=null,this.parentIsWindow=!1,this.parentSize=new p,this.gameSize=new p,this.baseSize=new p,this.displaySize=new p,this.scaleMode=i.SCALE_MODE.NONE,this.zoom=1,this._resetZoom=!1,this.displayScale=new c(1,1),this.autoRound=!1,this.autoCenter=i.CENTER.NO_CENTER,this.orientation=i.ORIENTATION.LANDSCAPE,this.fullscreen,this.fullscreenTarget=null,this._createdFullscreenTarget=!1,this.dirty=!1,this.resizeInterval=500,this._lastCheck=0,this._checkOrientation=!1,this.domlisteners={orientationChange:u,windowResize:u,fullScreenChange:u,fullScreenError:u}},preBoot:function(){this.parseConfig(this.game.config),this.game.events.once(o.BOOT,this.boot,this)},boot:function(){var v=this.game;this.canvas=v.canvas,this.fullscreen=v.device.fullscreen;var E=this.scaleMode;E!==i.SCALE_MODE.RESIZE&&E!==i.SCALE_MODE.EXPAND&&this.displaySize.setAspectMode(E),E===i.SCALE_MODE.NONE?this.resize(this.width,this.height):(this.getParentBounds(),this.parentSize.width>0&&this.parentSize.height>0&&this.displaySize.setParent(this.parentSize),this.refresh()),v.events.on(o.PRE_STEP,this.step,this),v.events.once(o.READY,this.refresh,this),v.events.once(o.DESTROY,this.destroy,this),this.startListeners()},parseConfig:function(v){this.getParent(v),this.getParentBounds();var E=v.width,x=v.height,T=v.scaleMode,A=v.zoom,P=v.autoRound;if(typeof E=="string")if(E.substr(-1)!=="%")E=parseInt(E,10);else{var R=this.parentSize.width;R===0&&(R=window.innerWidth);var S=parseInt(E,10)/100;E=Math.floor(R*S)}if(typeof x=="string")if(x.substr(-1)!=="%")x=parseInt(x,10);else{var I=this.parentSize.height;I===0&&(I=window.innerHeight);var w=parseInt(x,10)/100;x=Math.floor(I*w)}this.scaleMode=T,this.autoRound=P,this.autoCenter=v.autoCenter,this.resizeInterval=v.resizeInterval,P&&(E=Math.floor(E),x=Math.floor(x)),this.gameSize.setSize(E,x),A===i.ZOOM.MAX_ZOOM&&(A=this.getMaxZoom()),this.zoom=A,A!==1&&(this._resetZoom=!0),this.baseSize.setSize(E,x),P&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),v.minWidth>0&&this.displaySize.setMin(v.minWidth*A,v.minHeight*A),v.maxWidth>0&&this.displaySize.setMax(v.maxWidth*A,v.maxHeight*A),this.displaySize.setSize(E,x),(v.snapWidth>0||v.snapHeight>0)&&this.displaySize.setSnap(v.snapWidth,v.snapHeight),this.orientation=l(E,x)},getParent:function(v){var E=v.parent;if(E!==null){if(this.parent=h(E),this.parentIsWindow=this.parent===document.body,v.expandParent&&v.scaleMode!==i.SCALE_MODE.NONE){var x=this.parent.getBoundingClientRect();(this.parentIsWindow||x.height===0)&&(document.documentElement.style.height="100%",document.body.style.height="100%",x=this.parent.getBoundingClientRect(),!this.parentIsWindow&&x.height===0&&(this.parent.style.overflow="hidden",this.parent.style.width="100%",this.parent.style.height="100%"))}v.fullscreenTarget&&!this.fullscreenTarget&&(this.fullscreenTarget=h(v.fullscreenTarget))}},getParentBounds:function(){if(!this.parent)return!1;var v=this.parentSize,E=this.parent.getBoundingClientRect();this.parentIsWindow&&this.game.device.os.iOS&&(E.height=a(!0));var x=E.width,T=E.height;if(v.width!==x||v.height!==T)return v.setSize(x,T),!0;if(this.canvas){var A=this.canvasBounds,P=this.canvas.getBoundingClientRect();if(P.x!==A.x||P.y!==A.y)return!0}return!1},lockOrientation:function(v){var E=screen.lockOrientation||screen.mozLockOrientation||screen.msLockOrientation;return E?E.call(screen,v):!1},setParentSize:function(v,E){return this.parentSize.setSize(v,E),this.refresh()},setGameSize:function(v,E){var x=this.autoRound;x&&(v=Math.floor(v),E=Math.floor(E));var T=this.width,A=this.height;return this.gameSize.resize(v,E),this.baseSize.resize(v,E),x&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),this.displaySize.setAspectRatio(v/E),this.canvas.width=this.baseSize.width,this.canvas.height=this.baseSize.height,this.refresh(T,A)},resize:function(v,E){var x=this.zoom,T=this.autoRound;T&&(v=Math.floor(v),E=Math.floor(E));var A=this.width,P=this.height;this.gameSize.resize(v,E),this.baseSize.resize(v,E),T&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),this.displaySize.setSize(v*x,E*x),this.canvas.width=this.baseSize.width,this.canvas.height=this.baseSize.height;var R=this.canvas.style,S=v*x,I=E*x;return T&&(S=Math.floor(S),I=Math.floor(I)),(S!==v||I!==E)&&(R.width=S+"px",R.height=I+"px"),this.refresh(A,P)},setZoom:function(v){return this.zoom=v,this._resetZoom=!0,this.refresh()},setMaxZoom:function(){return this.zoom=this.getMaxZoom(),this._resetZoom=!0,this.refresh()},setSnap:function(v,E){return v===void 0&&(v=0),E===void 0&&(E=v),this.displaySize.setSnap(v,E),this.refresh()},refresh:function(v,E){v===void 0&&(v=this.width),E===void 0&&(E=this.height),this.updateScale(),this.updateBounds(),this.updateOrientation(),this.displayScale.set(this.baseSize.width/this.canvasBounds.width,this.baseSize.height/this.canvasBounds.height);var x=this.game.domContainer;if(x){this.baseSize.setCSS(x);var T=this.canvas.style,A=x.style;A.transform="scale("+this.displaySize.width/this.baseSize.width+","+this.displaySize.height/this.baseSize.height+")",A.marginLeft=T.marginLeft,A.marginTop=T.marginTop}return this.emit(r.RESIZE,this.gameSize,this.baseSize,this.displaySize,v,E),this},updateOrientation:function(){if(this._checkOrientation){this._checkOrientation=!1;var v=l(this.width,this.height);v!==this.orientation&&(this.orientation=v,this.emit(r.ORIENTATION_CHANGE,v))}},updateScale:function(){var v=this.canvas.style,E=this.gameSize.width,x=this.gameSize.height,T,A,P=this.zoom,R=this.autoRound;if(this.scaleMode===i.SCALE_MODE.NONE)this.displaySize.setSize(E*P,x*P),T=this.displaySize.width,A=this.displaySize.height,R&&(T=Math.floor(T),A=Math.floor(A)),this._resetZoom&&(v.width=T+"px",v.height=A+"px",this._resetZoom=!1);else if(this.scaleMode===i.SCALE_MODE.RESIZE)this.displaySize.setSize(this.parentSize.width,this.parentSize.height),this.gameSize.setSize(this.displaySize.width,this.displaySize.height),this.baseSize.setSize(this.displaySize.width,this.displaySize.height),T=this.displaySize.width,A=this.displaySize.height,R&&(T=Math.floor(T),A=Math.floor(A)),this.canvas.width=T,this.canvas.height=A;else if(this.scaleMode===i.SCALE_MODE.EXPAND){var S=this.game.config.width,I=this.game.config.height;this.displaySize.setSize(this.parentSize.width,this.parentSize.height),T=this.displaySize.width,A=this.displaySize.height,R&&(T=Math.floor(T),A=Math.floor(A)),v.width=T+"px",v.height=A+"px";var w=this.parentSize.width/S,C=this.parentSize.height/I;w<C&&w!==0?this.baseSize.setSize(S,this.parentSize.height/w):C!==0&&this.baseSize.setSize(this.displaySize.width/C,I),this.gameSize.setSize(this.baseSize.width,this.baseSize.height),T=this.baseSize.width,A=this.baseSize.height,R&&(T=Math.floor(T),A=Math.floor(A)),this.canvas.width=T,this.canvas.height=A}else this.displaySize.setSize(this.parentSize.width,this.parentSize.height),T=this.displaySize.width,A=this.displaySize.height,R&&(T=Math.floor(T),A=Math.floor(A)),v.width=T+"px",v.height=A+"px";this.getParentBounds(),this.updateCenter()},getMaxZoom:function(){var v=g(this.parentSize.width,this.gameSize.width,0,!0),E=g(this.parentSize.height,this.gameSize.height,0,!0);return Math.max(Math.min(v,E),1)},updateCenter:function(){var v=this.autoCenter;if(v!==i.CENTER.NO_CENTER){var E=this.canvas,x=E.style,T=E.getBoundingClientRect(),A=T.width,P=T.height,R=Math.floor((this.parentSize.width-A)/2),S=Math.floor((this.parentSize.height-P)/2);v===i.CENTER.CENTER_HORIZONTALLY?S=0:v===i.CENTER.CENTER_VERTICALLY&&(R=0),x.marginLeft=R+"px",x.marginTop=S+"px"}},updateBounds:function(){var v=this.canvasBounds,E=this.canvas.getBoundingClientRect();v.x=E.left+(window.pageXOffset||0)-(document.documentElement.clientLeft||0),v.y=E.top+(window.pageYOffset||0)-(document.documentElement.clientTop||0),v.width=E.width,v.height=E.height},transformX:function(v){return(v-this.canvasBounds.left)*this.displayScale.x},transformY:function(v){return(v-this.canvasBounds.top)*this.displayScale.y},startFullscreen:function(v){v===void 0&&(v={navigationUI:"hide"});var E=this.fullscreen;if(!E.available){this.emit(r.FULLSCREEN_UNSUPPORTED);return}if(!E.active){var x=this.getFullscreenTarget();E.keyboard?x[E.request](Element.ALLOW_KEYBOARD_INPUT):x[E.request](v)}},fullscreenSuccessHandler:function(){this.getParentBounds(),this.refresh(),this.emit(r.ENTER_FULLSCREEN)},fullscreenErrorHandler:function(v){this.removeFullscreenTarget(),this.emit(r.FULLSCREEN_FAILED,v)},getFullscreenTarget:function(){if(!this.fullscreenTarget){var v=document.createElement("div");v.style.margin="0",v.style.padding="0",v.style.width="100%",v.style.height="100%",this.fullscreenTarget=v,this._createdFullscreenTarget=!0}if(this._createdFullscreenTarget){var E=this.canvas.parentNode;E.insertBefore(this.fullscreenTarget,this.canvas),this.fullscreenTarget.appendChild(this.canvas)}return this.fullscreenTarget},removeFullscreenTarget:function(){if(this._createdFullscreenTarget){var v=this.fullscreenTarget;if(v&&v.parentNode){var E=v.parentNode;E.insertBefore(this.canvas,v),E.removeChild(v)}}},stopFullscreen:function(){var v=this.fullscreen;if(!v.available)return this.emit(r.FULLSCREEN_UNSUPPORTED),!1;v.active&&document[v.cancel](),this.removeFullscreenTarget()},leaveFullScreenSuccessHandler:function(){this.getParentBounds(),this.emit(r.LEAVE_FULLSCREEN),this.refresh()},toggleFullscreen:function(v){this.fullscreen.active?this.stopFullscreen():this.startFullscreen(v)},startListeners:function(){var v=this,E=this.domlisteners;if(E.orientationChange=function(){v.updateBounds(),v._checkOrientation=!0,v.dirty=!0,v.refresh()},E.windowResize=function(){v.updateBounds(),v.dirty=!0},screen.orientation&&screen.orientation.addEventListener?screen.orientation.addEventListener("change",E.orientationChange,!1):window.addEventListener("orientationchange",E.orientationChange,!1),window.addEventListener("resize",E.windowResize,!1),this.fullscreen.available){E.fullScreenChange=function(T){return v.onFullScreenChange(T)},E.fullScreenError=function(T){return v.onFullScreenError(T)};var x=["webkit","moz",""];x.forEach(function(T){document.addEventListener(T+"fullscreenchange",E.fullScreenChange,!1),document.addEventListener(T+"fullscreenerror",E.fullScreenError,!1)}),document.addEventListener("MSFullscreenChange",E.fullScreenChange,!1),document.addEventListener("MSFullscreenError",E.fullScreenError,!1)}},onFullScreenChange:function(){document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement||document.mozFullScreenElement?this.fullscreenSuccessHandler():(this.stopFullscreen(),this.leaveFullScreenSuccessHandler())},onFullScreenError:function(){this.removeFullscreenTarget()},getViewPort:function(v,E){v instanceof f||(E=v,v=void 0),E===void 0&&(E=new d);var x=this.baseSize,T=this.parentSize,A=this.canvasBounds,P=this.displayScale,R=A.x>=0?0:-(A.x*P.x),S=A.y>=0?0:-(A.y*P.y),I;T.width>=A.width?I=x.width:I=x.width-(A.width-T.width)*P.x;var w;return T.height>=A.height?w=x.height:w=x.height-(A.height-T.height)*P.y,E.setTo(R,S,I,w),v&&(E.width/=v.zoomX,E.height/=v.zoomY,E.centerX=v.centerX+v.scrollX,E.centerY=v.centerY+v.scrollY),E},step:function(v,E){this.parent&&(this._lastCheck+=E,(this.dirty||this._lastCheck>this.resizeInterval)&&(this.getParentBounds()&&this.refresh(),this.dirty=!1,this._lastCheck=0))},stopListeners:function(){var v=this.domlisteners;screen.orientation&&screen.orientation.addEventListener?screen.orientation.removeEventListener("change",v.orientationChange,!1):window.removeEventListener("orientationchange",v.orientationChange,!1),window.removeEventListener("resize",v.windowResize,!1);var E=["webkit","moz",""];E.forEach(function(x){document.removeEventListener(x+"fullscreenchange",v.fullScreenChange,!1),document.removeEventListener(x+"fullscreenerror",v.fullScreenError,!1)}),document.removeEventListener("MSFullscreenChange",v.fullScreenChange,!1),document.removeEventListener("MSFullscreenError",v.fullScreenError,!1)},destroy:function(){this.removeAllListeners(),this.stopListeners(),this.game=null,this.canvas=null,this.canvasBounds=null,this.parent=null,this.fullscreenTarget=null,this.parentSize.destroy(),this.gameSize.destroy(),this.baseSize.destroy(),this.displaySize.destroy()},isFullscreen:{get:function(){return this.fullscreen.active}},width:{get:function(){return this.gameSize.width}},height:{get:function(){return this.gameSize.height}},isPortrait:{get:function(){return this.orientation===i.ORIENTATION.PORTRAIT}},isLandscape:{get:function(){return this.orientation===i.ORIENTATION.LANDSCAPE}},isGamePortrait:{get:function(){return this.height>this.width}},isGameLandscape:{get:function(){return this.width>this.height}}});t.exports=m}),Gn=y((e,t)=>{var i={PENDING:0,INIT:1,START:2,LOADING:3,CREATING:4,RUNNING:5,PAUSED:6,SLEEPING:7,SHUTDOWN:8,DESTROYED:9};t.exports=i}),DT=y((e,t)=>{t.exports="addfile"}),kT=y((e,t)=>{t.exports="complete"}),FT=y((e,t)=>{t.exports="filecomplete"}),NT=y((e,t)=>{t.exports="filecomplete-"}),BT=y((e,t)=>{t.exports="loaderror"}),UT=y((e,t)=>{t.exports="load"}),GT=y((e,t)=>{t.exports="fileprogress"}),YT=y((e,t)=>{t.exports="postprocess"}),HT=y((e,t)=>{t.exports="progress"}),zT=y((e,t)=>{t.exports="start"}),Vi=y((e,t)=>{t.exports={ADD:DT(),COMPLETE:kT(),FILE_COMPLETE:FT(),FILE_KEY_COMPLETE:NT(),FILE_LOAD_ERROR:BT(),FILE_LOAD:UT(),FILE_PROGRESS:GT(),POST_PROCESS:YT(),PROGRESS:HT(),START:zT()}}),tc=y((e,t)=>{var i=dt(),s=ra(),n=function(r){var o=r.game.config.defaultPhysicsSystem,a=i(r.settings,"physics",!1);if(!(!o&&!a)){var h=[];if(o&&h.push(s(o+"Physics")),a)for(var l in a)l=s(l.concat("Physics")),h.indexOf(l)===-1&&h.push(l);return h}};t.exports=n}),ec=y((e,t)=>{var i=dt(),s=function(n){var r=n.plugins.getDefaultScenePlugins(),o=i(n.settings,"plugins",!1);return Array.isArray(o)?o:r||[]};t.exports=s}),Xi=y((e,t)=>{var i=function(s){var n={};for(var r in s)Array.isArray(s[r])?n[r]=s[r].slice(0):n[r]=s[r];return n};t.exports=i}),ic=y((e,t)=>{var i=Xi(),s=function(n,r){var o=i(n);for(var a in r)o.hasOwnProperty(a)||(o[a]=r[a]);return o};t.exports=s}),WT=y((e,t)=>{var i={game:"game",renderer:"renderer",anims:"anims",cache:"cache",plugins:"plugins",registry:"registry",scale:"scale",sound:"sound",textures:"textures",events:"events",cameras:"cameras",add:"add",make:"make",scenePlugin:"scene",displayList:"children",lights:"lights",data:"data",input:"input",load:"load",time:"time",tweens:"tweens",arcadePhysics:"physics",impactPhysics:"impact",matterPhysics:"matter"};i.cameras3d="cameras3d",t.exports=i}),sc=y((e,t)=>{var i=Gn(),s=St(),n=ic(),r=WT(),o={create:function(a){return typeof a=="string"?a={key:a}:a===void 0&&(a={}),{status:i.PENDING,key:s(a,"key",""),active:s(a,"active",!1),visible:s(a,"visible",!0),isBooted:!1,isTransition:!1,transitionFrom:null,transitionDuration:0,transitionAllowInput:!0,data:{},pack:s(a,"pack",!1),cameras:s(a,"cameras",null),map:s(a,"map",n(r,s(a,"mapAdd",{}))),physics:s(a,"physics",{}),loader:s(a,"loader",{}),plugins:s(a,"plugins",!1),input:s(a,"input",{})}}};t.exports=o}),Aa=y((e,t)=>{var i=W(),s=Gn(),n=Cl(),r=Vt(),o=tc(),a=ec(),h=Rt(),l=sc(),u=new i({initialize:function(d,p){this.scene=d,this.game,this.renderer,this.config=p,this.settings=l.create(p),this.canvas,this.context,this.anims,this.cache,this.plugins,this.registry,this.scale,this.sound,this.textures,this.add,this.cameras,this.displayList,this.events,this.make,this.scenePlugin,this.updateList,this.sceneUpdate=h},init:function(d){this.settings.status=s.INIT,this.sceneUpdate=h,this.game=d,this.renderer=d.renderer,this.canvas=d.canvas,this.context=d.context;var p=d.plugins;this.plugins=p,p.addToScene(this,n.Global,[n.CoreScene,a(this),o(this)]),this.events.emit(r.BOOT,this),this.settings.isBooted=!0},step:function(d,p){var g=this.events;g.emit(r.PRE_UPDATE,d,p),g.emit(r.UPDATE,d,p),this.sceneUpdate.call(this.scene,d,p),g.emit(r.POST_UPDATE,d,p)},render:function(d){var p=this.displayList;p.depthSort(),this.events.emit(r.PRE_RENDER,d),this.cameras.render(d,p),this.events.emit(r.RENDER,d)},queueDepthSort:function(){this.displayList.queueDepthSort()},depthSort:function(){this.displayList.depthSort()},pause:function(d){var p=this.settings,g=this.getStatus();return g!==s.CREATING&&g!==s.RUNNING||this.settings.active&&(p.status=s.PAUSED,p.active=!1,this.events.emit(r.PAUSE,this,d)),this},resume:function(d){var p=this.events,g=this.settings;return this.settings.active||(g.status=s.RUNNING,g.active=!0,p.emit(r.RESUME,this,d)),this},sleep:function(d){var p=this.settings,g=this.getStatus();return g!==s.CREATING&&g!==s.RUNNING||(p.status=s.SLEEPING,p.active=!1,p.visible=!1,this.events.emit(r.SLEEP,this,d)),this},wake:function(d){var p=this.events,g=this.settings;return g.status=s.RUNNING,g.active=!0,g.visible=!0,p.emit(r.WAKE,this,d),g.isTransition&&p.emit(r.TRANSITION_WAKE,g.transitionFrom,g.transitionDuration),this},getData:function(){return this.settings.data},getStatus:function(){return this.settings.status},canInput:function(){var d=this.settings.status;return d>s.PENDING&&d<=s.RUNNING},isSleeping:function(){return this.settings.status===s.SLEEPING},isActive:function(){return this.settings.status===s.RUNNING},isPaused:function(){return this.settings.status===s.PAUSED},isTransitioning:function(){return this.settings.isTransition||this.scenePlugin._target!==null},isTransitionOut:function(){return this.scenePlugin._target!==null&&this.scenePlugin._duration>0},isTransitionIn:function(){return this.settings.isTransition},isVisible:function(){return this.settings.visible},setVisible:function(d){return this.settings.visible=d,this},setActive:function(d,p){return d?this.resume(p):this.pause(p)},start:function(d){var p=this.events,g=this.settings;d&&(g.data=d),g.status=s.START,g.active=!0,g.visible=!0,p.emit(r.START,this),p.emit(r.READY,this,d)},shutdown:function(d){var p=this.events,g=this.settings;p.off(r.TRANSITION_INIT),p.off(r.TRANSITION_START),p.off(r.TRANSITION_COMPLETE),p.off(r.TRANSITION_OUT),g.status=s.SHUTDOWN,g.active=!1,g.visible=!1,p.emit(r.SHUTDOWN,this,d)},destroy:function(){var d=this.events,p=this.settings;p.status=s.DESTROYED,p.active=!1,p.visible=!1,d.emit(r.DESTROY,this),d.removeAllListeners();for(var g=["scene","game","anims","cache","plugins","registry","sound","textures","add","camera","displayList","events","make","scenePlugin","updateList"],c=0;c<g.length;c++)this[g[c]]=null}});t.exports=u}),nc=y((e,t)=>{var i=W(),s=Aa(),n=new i({initialize:function(r){this.sys=new s(this,r),this.game,this.anims,this.cache,this.registry,this.sound,this.textures,this.events,this.cameras,this.add,this.make,this.scene,this.children,this.lights,this.data,this.input,this.load,this.time,this.tweens,this.physics,this.matter,this.scale,this.plugins,this.renderer},update:function(){}});t.exports=n}),rc=y((e,t)=>{var i=W(),s=Gn(),n=Vt(),r=$t(),o=St(),a=Vi(),h=Rt(),l=nc(),u=Aa(),d=new i({initialize:function(p,g){if(this.game=p,this.keys={},this.scenes=[],this._pending=[],this._start=[],this._queue=[],this._data={},this.isProcessing=!1,this.isBooted=!1,this.customViewports=0,this.systemScene,g){Array.isArray(g)||(g=[g]);for(var c=0;c<g.length;c++)this._pending.push({key:"default",scene:g[c],autoStart:c===0,data:{}})}p.events.once(r.READY,this.bootQueue,this)},bootQueue:function(){if(!this.isBooted){this.systemScene=this.createSceneFromInstance("__SYSTEM",new l),this.game.events.emit(r.SYSTEM_READY,this.systemScene,this);var p,g,c,f;for(p=0;p<this._pending.length;p++){g=this._pending[p],c=g.key,f=g.scene;var m;f instanceof l?m=this.createSceneFromInstance(c,f):typeof f=="object"?m=this.createSceneFromObject(c,f):typeof f=="function"&&(m=this.createSceneFromFunction(c,f)),c=m.sys.settings.key,this.keys[c]=m,this.scenes.push(m),this._data[c]&&(m.sys.settings.data=this._data[c].data,this._data[c].autoStart&&(g.autoStart=!0)),(g.autoStart||m.sys.settings.active)&&this._start.push(c)}for(this._pending.length=0,this._data={},this.isBooted=!0,p=0;p<this._start.length;p++)g=this._start[p],this.start(g);this._start.length=0}},processQueue:function(){var p=this._pending.length,g=this._queue.length;if(!(p===0&&g===0)){var c,f;if(p){for(c=0;c<p;c++)f=this._pending[c],this.add(f.key,f.scene,f.autoStart,f.data);for(c=0;c<this._start.length;c++)f=this._start[c],this.start(f);this._start.length=0,this._pending.length=0}for(c=0;c<this._queue.length;c++)f=this._queue[c],this[f.op](f.keyA,f.keyB,f.data);this._queue.length=0}},add:function(p,g,c,f){if(c===void 0&&(c=!1),f===void 0&&(f={}),this.isProcessing||!this.isBooted)return this._pending.push({key:p,scene:g,autoStart:c,data:f}),this.isBooted||(this._data[p]={data:f}),null;p=this.getKey(p,g);var m;return g instanceof l?m=this.createSceneFromInstance(p,g):typeof g=="object"?(g.key=p,m=this.createSceneFromObject(p,g)):typeof g=="function"&&(m=this.createSceneFromFunction(p,g)),m.sys.settings.data=f,p=m.sys.settings.key,this.keys[p]=m,this.scenes.push(m),(c||m.sys.settings.active)&&(this._pending.length?this._start.push(p):this.start(p)),m},remove:function(p){if(this.isProcessing)return this.queueOp("remove",p);var g=this.getScene(p);if(!g||g.sys.isTransitioning())return this;var c=this.scenes.indexOf(g),f=g.sys.settings.key;return c>-1&&(delete this.keys[f],this.scenes.splice(c,1),this._start.indexOf(f)>-1&&(c=this._start.indexOf(f),this._start.splice(c,1)),g.sys.destroy()),this},bootScene:function(p){var g=p.sys,c=g.settings;g.sceneUpdate=h,p.init&&(p.init.call(p,c.data),c.status=s.INIT,c.isTransition&&g.events.emit(n.TRANSITION_INIT,c.transitionFrom,c.transitionDuration));var f;g.load&&(f=g.load,f.reset()),f&&p.preload?(p.preload.call(p),c.status=s.LOADING,f.once(a.COMPLETE,this.loadComplete,this),f.start()):this.create(p)},loadComplete:function(p){this.create(p.scene)},payloadComplete:function(p){this.bootScene(p.scene)},update:function(p,g){this.processQueue(),this.isProcessing=!0;for(var c=this.scenes.length-1;c>=0;c--){var f=this.scenes[c].sys;f.settings.status>s.START&&f.settings.status<=s.RUNNING&&f.step(p,g),f.scenePlugin&&f.scenePlugin._target&&f.scenePlugin.step(p,g)}},render:function(p){for(var g=0;g<this.scenes.length;g++){var c=this.scenes[g].sys;c.settings.visible&&c.settings.status>=s.LOADING&&c.settings.status<s.SLEEPING&&c.render(p)}this.isProcessing=!1},create:function(p){var g=p.sys,c=g.settings;p.create&&(c.status=s.CREATING,p.create.call(p,c.data),c.status===s.DESTROYED)||(c.isTransition&&g.events.emit(n.TRANSITION_START,c.transitionFrom,c.transitionDuration),p.update&&(g.sceneUpdate=p.update),c.status=s.RUNNING,g.events.emit(n.CREATE,p))},createSceneFromFunction:function(p,g){var c=new g;if(c instanceof l){var f=c.sys.settings.key;if(f!==""&&(p=f),this.keys.hasOwnProperty(p))throw new Error("Cannot add Scene with duplicate key: "+p);return this.createSceneFromInstance(p,c)}else return c.sys=new u(c),c.sys.settings.key=p,c.sys.init(this.game),c},createSceneFromInstance:function(p,g){var c=g.sys.settings.key;return c===""&&(g.sys.settings.key=p),g.sys.init(this.game),g},createSceneFromObject:function(p,g){var c=new l(g),f=c.sys.settings.key;f!==""?p=f:c.sys.settings.key=p,c.sys.init(this.game);for(var m=["init","preload","create","update","render"],v=0;v<m.length;v++){var E=o(g,m[v],null);E&&(c[m[v]]=E)}if(g.hasOwnProperty("extend")){for(var x in g.extend)if(g.extend.hasOwnProperty(x)){var T=g.extend[x];x==="data"&&c.hasOwnProperty("data")&&typeof T=="object"?c.data.merge(T):x!=="sys"&&(c[x]=T)}}return c},getKey:function(p,g){if(p||(p="default"),typeof g=="function")return p;if(g instanceof l?p=g.sys.settings.key:typeof g=="object"&&g.hasOwnProperty("key")&&(p=g.key),this.keys.hasOwnProperty(p))throw new Error("Cannot add Scene with duplicate key: "+p);return p},getScenes:function(p,g){p===void 0&&(p=!0),g===void 0&&(g=!1);for(var c=[],f=this.scenes,m=0;m<f.length;m++){var v=f[m];v&&(!p||p&&v.sys.isActive())&&c.push(v)}return g?c.reverse():c},getScene:function(p){if(typeof p=="string"){if(this.keys[p])return this.keys[p]}else for(var g=0;g<this.scenes.length;g++)if(p===this.scenes[g])return p;return null},isActive:function(p){var g=this.getScene(p);return g?g.sys.isActive():null},isPaused:function(p){var g=this.getScene(p);return g?g.sys.isPaused():null},isVisible:function(p){var g=this.getScene(p);return g?g.sys.isVisible():null},isSleeping:function(p){var g=this.getScene(p);return g?g.sys.isSleeping():null},pause:function(p,g){var c=this.getScene(p);return c&&c.sys.pause(g),this},resume:function(p,g){var c=this.getScene(p);return c&&c.sys.resume(g),this},sleep:function(p,g){var c=this.getScene(p);return c&&!c.sys.isTransitioning()&&c.sys.sleep(g),this},wake:function(p,g){var c=this.getScene(p);return c&&c.sys.wake(g),this},run:function(p,g){var c=this.getScene(p);if(!c){for(var f=0;f<this._pending.length;f++)if(this._pending[f].key===p){this.queueOp("start",p,g);break}return this}c.sys.isSleeping()?c.sys.wake(g):c.sys.isPaused()?c.sys.resume(g):this.start(p,g)},start:function(p,g){if(!this.isBooted)return this._data[p]={autoStart:!0,data:g},this;var c=this.getScene(p);if(!c)return this;var f=c.sys,m=f.settings.status;if(m>=s.START&&m<=s.CREATING)return this;if(m>=s.RUNNING&&m<=s.SLEEPING)f.shutdown(),f.sceneUpdate=h,f.start(g);else{f.sceneUpdate=h,f.start(g);var v;if(f.load&&(v=f.load),v&&f.settings.hasOwnProperty("pack")&&(v.reset(),v.addPack({payload:f.settings.pack})))return f.settings.status=s.LOADING,v.once(a.COMPLETE,this.payloadComplete,this),v.start(),this}return this.bootScene(c),this},stop:function(p,g){var c=this.getScene(p);if(c&&!c.sys.isTransitioning()&&c.sys.settings.status!==s.SHUTDOWN){var f=c.sys.load;f&&(f.off(a.COMPLETE,this.loadComplete,this),f.off(a.COMPLETE,this.payloadComplete,this)),c.sys.shutdown(g)}return this},switch:function(p,g,c){var f=this.getScene(p),m=this.getScene(g);return f&&m&&f!==m&&(this.sleep(p),this.isSleeping(g)?this.wake(g,c):this.start(g,c)),this},getAt:function(p){return this.scenes[p]},getIndex:function(p){var g=this.getScene(p);return this.scenes.indexOf(g)},bringToTop:function(p){if(this.isProcessing)return this.queueOp("bringToTop",p);var g=this.getIndex(p),c=this.scenes;if(g!==-1&&g<c.length){var f=this.getScene(p);c.splice(g,1),c.push(f)}return this},sendToBack:function(p){if(this.isProcessing)return this.queueOp("sendToBack",p);var g=this.getIndex(p);if(g!==-1&&g>0){var c=this.getScene(p);this.scenes.splice(g,1),this.scenes.unshift(c)}return this},moveDown:function(p){if(this.isProcessing)return this.queueOp("moveDown",p);var g=this.getIndex(p);if(g>0){var c=g-1,f=this.getScene(p),m=this.getAt(c);this.scenes[g]=m,this.scenes[c]=f}return this},moveUp:function(p){if(this.isProcessing)return this.queueOp("moveUp",p);var g=this.getIndex(p);if(g<this.scenes.length-1){var c=g+1,f=this.getScene(p),m=this.getAt(c);this.scenes[g]=m,this.scenes[c]=f}return this},moveAbove:function(p,g){if(p===g)return this;if(this.isProcessing)return this.queueOp("moveAbove",p,g);var c=this.getIndex(p),f=this.getIndex(g);if(c!==-1&&f!==-1&&f<c){var m=this.getAt(f);this.scenes.splice(f,1),this.scenes.splice(c+(f>c),0,m)}return this},moveBelow:function(p,g){if(p===g)return this;if(this.isProcessing)return this.queueOp("moveBelow",p,g);var c=this.getIndex(p),f=this.getIndex(g);if(c!==-1&&f!==-1&&f>c){var m=this.getAt(f);this.scenes.splice(f,1),c===0?this.scenes.unshift(m):this.scenes.splice(c-(f<c),0,m)}return this},queueOp:function(p,g,c,f){return this._queue.push({op:p,keyA:g,keyB:c,data:f}),this},swapPosition:function(p,g){if(p===g)return this;if(this.isProcessing)return this.queueOp("swapPosition",p,g);var c=this.getIndex(p),f=this.getIndex(g);if(c!==f&&c!==-1&&f!==-1){var m=this.getAt(c);this.scenes[c]=this.scenes[f],this.scenes[f]=m}return this},dump:function(){for(var p=[],g=["pending","init","start","loading","creating","running","paused","sleeping","shutdown","destroyed"],c=0;c<this.scenes.length;c++){var f=this.scenes[c].sys,m=f.settings.visible&&(f.settings.status===s.RUNNING||f.settings.status===s.PAUSED)?"[*] ":"[-] ";m+=f.settings.key+" ("+g[f.settings.status]+")",p.push(m)}},destroy:function(){for(var p=0;p<this.scenes.length;p++){var g=this.scenes[p].sys;g.destroy()}this.systemScene.sys.destroy(),this.update=h,this.scenes=[],this._pending=[],this._start=[],this._queue=[],this.game=null,this.systemScene=null}});t.exports=d}),ac=y((e,t)=>{var i=xe(),s=W(),n=Os(),r=Br(),o=Ea(),a=new s({initialize:function(h,l,u,d,p){p===void 0&&(p=!1);var g=h.manager.game;this.renderer=g.renderer,this.texture=h,this.source=l,this.image=l.compressed?null:l,this.compressionAlgorithm=l.compressed?l.format:null,this.resolution=1,this.width=u||l.naturalWidth||l.videoWidth||l.width||0,this.height=d||l.naturalHeight||l.videoHeight||l.height||0,this.scaleMode=r.DEFAULT,this.isCanvas=l instanceof HTMLCanvasElement,this.isVideo=window.hasOwnProperty("HTMLVideoElement")&&l instanceof HTMLVideoElement,this.isRenderTexture=l.type==="RenderTexture"||l.type==="DynamicTexture",this.isGLTexture=l instanceof o,this.isPowerOf2=n(this.width,this.height),this.glTexture=null,this.flipY=p,this.init(g)},init:function(h){var l=this.renderer;if(l){var u=this.source;if(l.gl){var d=this.image,p=this.flipY,g=this.width,c=this.height,f=this.scaleMode;this.isCanvas?this.glTexture=l.createCanvasTexture(d,!1,p):this.isVideo?this.glTexture=l.createVideoTexture(d,!1,p):this.isRenderTexture?this.glTexture=l.createTextureFromSource(null,g,c,f):this.isGLTexture?this.glTexture=u:this.compressionAlgorithm?this.glTexture=l.createTextureFromSource(u,void 0,void 0,f):u instanceof Uint8Array?this.glTexture=l.createUint8ArrayTexture(u,g,c,f):this.glTexture=l.createTextureFromSource(d,g,c,f)}else this.isRenderTexture&&(this.image=u.canvas)}h.config.antialias||this.setFilter(1)},setFilter:function(h){this.renderer&&this.renderer.gl&&this.renderer.setTextureFilter(this.glTexture,h),this.scaleMode=h},setFlipY:function(h){return h===void 0&&(h=!0),h===this.flipY?this:(this.flipY=h,this.update(),this)},update:function(){var h=this.renderer,l=this.image,u=this.flipY,d=h.gl;d&&this.isCanvas?h.updateCanvasTexture(l,this.glTexture,u):d&&this.isVideo&&h.updateVideoTexture(l,this.glTexture,u)},destroy:function(){this.glTexture&&this.renderer.deleteTexture(this.glTexture),this.isCanvas&&i.remove(this.image),this.renderer=null,this.texture=null,this.source=null,this.image=null,this.glTexture=null}});t.exports=a}),Yn=y((e,t)=>{var i=W(),s=Hi(),n=ac(),r='Texture "%s" has no frame "%s"',o=new i({initialize:function(a,h,l,u,d){Array.isArray(l)||(l=[l]),this.manager=a,this.key=h,this.source=[],this.dataSource=[],this.frames={},this.customData={},this.firstFrame="__BASE",this.frameTotal=0;for(var p=0;p<l.length;p++)this.source.push(new n(this,l[p],u,d))},add:function(a,h,l,u,d,p){if(this.has(a))return null;var g=new s(this,a,h,l,u,d,p);return this.frames[a]=g,this.firstFrame==="__BASE"&&(this.firstFrame=a),this.frameTotal++,g},remove:function(a){if(this.has(a)){var h=this.get(a);return h.destroy(),delete this.frames[a],!0}return!1},has:function(a){return this.frames.hasOwnProperty(a)},get:function(a){a||(a=this.firstFrame);var h=this.frames[a];return h||(h=this.frames[this.firstFrame]),h},getTextureSourceIndex:function(a){for(var h=0;h<this.source.length;h++)if(this.source[h]===a)return h;return-1},getFramesFromTextureSource:function(a,h){h===void 0&&(h=!1);var l=[];for(var u in this.frames)if(!(u==="__BASE"&&!h)){var d=this.frames[u];d.sourceIndex===a&&l.push(d)}return l},getFrameBounds:function(a){a===void 0&&(a=0);for(var h=this.getFramesFromTextureSource(a,!0),l=h[0],u=l.cutX,d=l.cutY,p=l.cutX+l.cutWidth,g=l.cutY+l.cutHeight,c=1;c<h.length;c++){var f=h[c];f.cutX<u&&(u=f.cutX),f.cutY<d&&(d=f.cutY),f.cutX+f.cutWidth>p&&(p=f.cutX+f.cutWidth),f.cutY+f.cutHeight>g&&(g=f.cutY+f.cutHeight)}return{x:u,y:d,width:p-u,height:g-d}},getFrameNames:function(a){a===void 0&&(a=!1);var h=Object.keys(this.frames);if(!a){var l=h.indexOf("__BASE");l!==-1&&h.splice(l,1)}return h},getSourceImage:function(a){(a==null||this.frameTotal===1)&&(a="__BASE");var h=this.frames[a];return h?h.source.image:this.frames.__BASE.source.image},getDataSourceImage:function(a){(a==null||this.frameTotal===1)&&(a="__BASE");var h=this.frames[a],l;return h?l=h.sourceIndex:l=this.frames.__BASE.sourceIndex,this.dataSource[l].image},setDataSource:function(a){Array.isArray(a)||(a=[a]);for(var h=0;h<a.length;h++){var l=this.source[h];this.dataSource.push(new n(this,a[h],l.width,l.height))}},setFilter:function(a){var h;for(h=0;h<this.source.length;h++)this.source[h].setFilter(a);for(h=0;h<this.dataSource.length;h++)this.dataSource[h].setFilter(a)},destroy:function(){var a,h=this.source,l=this.dataSource;for(a=0;a<h.length;a++)h[a]&&h[a].destroy();for(a=0;a<l.length;a++)l[a]&&l[a].destroy();for(var u in this.frames){var d=this.frames[u];d&&d.destroy()}this.source=[],this.dataSource=[],this.frames={},this.manager.removeKey(this.key),this.manager=null}});t.exports=o}),oc=y((e,t)=>{var i=W(),s=Ot(),n=di(),r=Pe(),o=Os(),a=Yn(),h=new i({Extends:a,initialize:function(l,u,d,p,g){a.call(this,l,u,d,p,g),this.add("__BASE",0,0,0,p,g),this._source=this.frames.__BASE.source,this.canvas=this._source.image,this.context=this.canvas.getContext("2d",{willReadFrequently:!0}),this.width=p,this.height=g,this.imageData=this.context.getImageData(0,0,p,g),this.data=null,this.imageData&&(this.data=this.imageData.data),this.pixels=null,this.buffer,this.data&&(this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data)},update:function(){return this.imageData=this.context.getImageData(0,0,this.width,this.height),this.data=this.imageData.data,this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data,this.manager.game.config.renderType===r.WEBGL&&this.refresh(),this},draw:function(l,u,d,p){return p===void 0&&(p=!0),this.context.drawImage(d,l,u),p&&this.update(),this},drawFrame:function(l,u,d,p,g){d===void 0&&(d=0),p===void 0&&(p=0),g===void 0&&(g=!0);var c=this.manager.getFrame(l,u);if(c){var f=c.canvasData,m=c.cutWidth,v=c.cutHeight,E=c.source.resolution;this.context.drawImage(c.source.image,f.x,f.y,m,v,d,p,m/E,v/E),g&&this.update()}return this},setPixel:function(l,u,d,p,g,c){c===void 0&&(c=255),l=Math.abs(Math.floor(l)),u=Math.abs(Math.floor(u));var f=this.getIndex(l,u);if(f>-1){var m=this.context.getImageData(l,u,1,1);m.data[0]=d,m.data[1]=p,m.data[2]=g,m.data[3]=c,this.context.putImageData(m,l,u)}return this},putData:function(l,u,d,p,g,c,f){return p===void 0&&(p=0),g===void 0&&(g=0),c===void 0&&(c=l.width),f===void 0&&(f=l.height),this.context.putImageData(l,u,d,p,g,c,f),this},getData:function(l,u,d,p){l=s(Math.floor(l),0,this.width-1),u=s(Math.floor(u),0,this.height-1),d=s(d,1,this.width-l),p=s(p,1,this.height-u);var g=this.context.getImageData(l,u,d,p);return g},getPixel:function(l,u,d){d||(d=new n);var p=this.getIndex(l,u);if(p>-1){var g=this.data,c=g[p+0],f=g[p+1],m=g[p+2],v=g[p+3];d.setTo(c,f,m,v)}return d},getPixels:function(l,u,d,p){l===void 0&&(l=0),u===void 0&&(u=0),d===void 0&&(d=this.width),p===void 0&&(p=d),l=Math.abs(Math.round(l)),u=Math.abs(Math.round(u));for(var g=s(l,0,this.width),c=s(l+d,0,this.width),f=s(u,0,this.height),m=s(u+p,0,this.height),v=new n,E=[],x=f;x<m;x++){for(var T=[],A=g;A<c;A++)v=this.getPixel(A,x,v),T.push({x:A,y:x,color:v.color,alpha:v.alphaGL});E.push(T)}return E},getIndex:function(l,u){return l=Math.abs(Math.round(l)),u=Math.abs(Math.round(u)),l<this.width&&u<this.height?(l+u*this.width)*4:-1},refresh:function(){return this._source.update(),this},getCanvas:function(){return this.canvas},getContext:function(){return this.context},clear:function(l,u,d,p,g){return l===void 0&&(l=0),u===void 0&&(u=0),d===void 0&&(d=this.width),p===void 0&&(p=this.height),g===void 0&&(g=!0),this.context.clearRect(l,u,d,p),g&&this.update(),this},setSize:function(l,u){return u===void 0&&(u=l),(l!==this.width||u!==this.height)&&(this.canvas.width=l,this.canvas.height=u,this._source.width=l,this._source.height=u,this._source.isPowerOf2=o(l,u),this.frames.__BASE.setSize(l,u,0,0),this.width=l,this.height=u,this.refresh()),this},destroy:function(){a.prototype.destroy.call(this),this._source=null,this.canvas=null,this.context=null,this.imageData=null,this.data=null,this.pixels=null,this.buffer=null}});t.exports=h}),hc=y((e,t)=>{var i=Ge(),s=Dn(),n=xe(),r=W(),o=Pe(),a=Hi(),h=dt(),l=Fn(),u=zi(),d=Yn(),p=Se(),g=new r({Extends:d,initialize:function(c,f,m,v,E){m===void 0&&(m=256),v===void 0&&(v=256),E===void 0&&(E=!0),this.type="DynamicTexture";var x=c.game.renderer,T=x&&x.type===o.CANVAS,A=T?n.create2D(this,m,v):[this];d.call(this,c,f,A,m,v),this.add("__BASE",0,0,0,m,v),this.renderer=x,this.width=-1,this.height=-1,this.isDrawing=!1,this.canvas=T?A:null,this.context=T?A.getContext("2d",{willReadFrequently:!0}):null,this.dirty=!1,this.isSpriteTexture=!0,this._eraseMode=!1,this.camera=new s(0,0,m,v).setScene(c.game.scene.systemScene,!1),this.renderTarget=T?null:new u(x,m,v,1,0,!1,!1,!0,!1),this.pipeline=T?null:x.pipelines.get(l.SINGLE_PIPELINE),this.setSize(m,v,E)},setSize:function(c,f,m){f===void 0&&(f=c),m===void 0&&(m=!0),m&&(c=Math.floor(c),f=Math.floor(f),c%2!==0&&c++,f%2!==0&&f++);var v=this.get(),E=v.source;if(c!==this.width||f!==this.height){this.canvas&&(this.canvas.width=c,this.canvas.height=f);var x=this.renderTarget;x&&(x.willResize(c,f)&&x.resize(c,f),x.texture!==E.glTexture&&this.renderer.deleteTexture(E.glTexture),this.setFromRenderTarget()),this.camera.setSize(c,f),E.width=c,E.height=f,v.setSize(c,f),this.width=c,this.height=f}else{var T=this.getSourceImage();v.cutX+c>T.width&&(c=T.width-v.cutX),v.cutY+f>T.height&&(f=T.height-v.cutY),v.setSize(c,f,v.cutX,v.cutY)}return this},setFromRenderTarget:function(){var c=this.get(),f=c.source,m=this.renderTarget;return f.isRenderTexture=!0,f.isGLTexture=!0,f.glTexture=m.texture,this},setIsSpriteTexture:function(c){return this.isSpriteTexture=c,this},fill:function(c,f,m,v,E,x){var T=this.camera,A=this.renderer;f===void 0&&(f=1),m===void 0&&(m=0),v===void 0&&(v=0),E===void 0&&(E=this.width),x===void 0&&(x=this.height);var P=c>>16&255,R=c>>8&255,S=c&255,I=this.renderTarget;if(T.preRender(),I){I.bind(!0);var w=this.pipeline.manager.set(this.pipeline),C=A.width/I.width,_=A.height/I.height,O=I.height-(v+x);w.drawFillRect(m*C,O*_,E*C,x*_,p.getTintFromFloats(S/255,R/255,P/255,1),f),I.unbind(!0)}else{var D=this.context;A.setContext(D),D.globalCompositeOperation="source-over",D.fillStyle="rgba("+P+","+R+","+S+","+f+")",D.fillRect(m,v,E,x),A.setContext()}return this.dirty=!0,this},clear:function(c,f,m,v){if(this.dirty){var E=this.context,x=this.renderTarget;x?x.clear(c,f,m,v):E&&(c!==void 0&&f!==void 0&&m!==void 0&&v!==void 0?E.clearRect(c,f,m,v):(E.save(),E.setTransform(1,0,0,1,0,0),E.clearRect(0,0,this.width,this.height),E.restore())),this.dirty=!1}return this},stamp:function(c,f,m,v,E){m===void 0&&(m=0),v===void 0&&(v=0);var x=h(E,"alpha",1),T=h(E,"tint",16777215),A=h(E,"angle",0),P=h(E,"rotation",0),R=h(E,"scale",1),S=h(E,"scaleX",R),I=h(E,"scaleY",R),w=h(E,"originX",.5),C=h(E,"originY",.5),_=h(E,"blendMode",0),O=h(E,"erase",!1),D=h(E,"skipBatch",!1),F=this.manager.resetStamp(x,T);return F.setAngle(0),A!==0?F.setAngle(A):P!==0&&F.setRotation(P),F.setScale(S,I),F.setTexture(c,f),F.setOrigin(w,C),F.setBlendMode(_),O&&(this._eraseMode=!0),D?this.batchGameObject(F,m,v):this.draw(F,m,v),O&&(this._eraseMode=!1),this},erase:function(c,f,m){return this._eraseMode=!0,this.draw(c,f,m),this._eraseMode=!1,this},draw:function(c,f,m,v,E){return this.beginDraw(),this.batchDraw(c,f,m,v,E),this.endDraw(),this},drawFrame:function(c,f,m,v,E,x){return this.beginDraw(),this.batchDrawFrame(c,f,m,v,E,x),this.endDraw(),this},repeat:function(c,f,m,v,E,x,T,A,P){if(m===void 0&&(m=0),v===void 0&&(v=0),E===void 0&&(E=this.width),x===void 0&&(x=this.height),T===void 0&&(T=1),A===void 0&&(A=16777215),P===void 0&&(P=!1),c instanceof a?f=c:f=this.manager.getFrame(c,f),!f)return this;var R=this.manager.resetStamp(T,A);R.setFrame(f),R.setOrigin(0);var S=f.width,I=f.height;E=Math.floor(E),x=Math.floor(x);var w=Math.ceil(E/S),C=Math.ceil(x/I),_=w*S-E,O=C*I-x;_>0&&(_=S-_),O>0&&(O=I-O),m<0&&(w+=Math.ceil(Math.abs(m)/S)),v<0&&(C+=Math.ceil(Math.abs(v)/I));var D=m,F=v,N=!1,Y=this.manager.stampCrop.setTo(0,0,S,I);P||this.beginDraw();for(var L=0;L<C;L++){if(F+I<0){F+=I;continue}for(var b=0;b<w;b++){if(N=!1,D+S<0){D+=S;continue}else D<0&&(N=!0,Y.width=S+D,Y.x=S-Y.width);F<0&&(N=!0,Y.height=I+F,Y.y=I-Y.height),_>0&&b===w-1&&(N=!0,Y.width=_),O>0&&L===C-1&&(N=!0,Y.height=O),N&&R.setCrop(Y),this.batchGameObject(R,D,F),R.isCropped=!1,Y.setTo(0,0,S,I),D+=S}D=m,F+=I}return P||this.endDraw(),this},beginDraw:function(){if(!this.isDrawing){var c=this.camera,f=this.renderer,m=this.renderTarget;c.preRender(),m?f.beginCapture(m.width,m.height):f.setContext(this.context),this.isDrawing=!0}return this},batchDraw:function(c,f,m,v,E){return Array.isArray(c)||(c=[c]),this.batchList(c,f,m,v,E),this},batchDrawFrame:function(c,f,m,v,E,x){m===void 0&&(m=0),v===void 0&&(v=0),E===void 0&&(E=1),x===void 0&&(x=16777215);var T=this.manager.getFrame(c,f);return T&&(this.renderTarget?this.pipeline.batchTextureFrame(T,m,v,x,E,this.camera.matrix,null):this.batchTextureFrame(T,m,v,E,x)),this},endDraw:function(c){if(c===void 0&&(c=this._eraseMode),this.isDrawing){var f=this.renderer,m=this.renderTarget;if(m){var v=f.endCapture(),E=f.pipelines.setUtility();E.blitFrame(v,m,1,!1,!1,c,this.isSpriteTexture),f.resetScissor(),f.resetViewport()}else f.setContext();this.dirty=!0,this.isDrawing=!1}return this},batchList:function(c,f,m,v,E){var x=c.length;if(x!==0)for(var T=0;T<x;T++){var A=c[T];!A||A===this||(A.renderWebGL||A.renderCanvas?this.batchGameObject(A,f,m):A.isParent||A.list?this.batchGroup(A.getChildren(),f,m):typeof A=="string"?this.batchTextureFrameKey(A,null,f,m,v,E):A instanceof a?this.batchTextureFrame(A,f,m,v,E):Array.isArray(A)&&this.batchList(A,f,m,v,E))}},batchGroup:function(c,f,m){f===void 0&&(f=0),m===void 0&&(m=0);for(var v=0;v<c.length;v++){var E=c[v];E.willRender(this.camera)&&this.batchGameObject(E,E.x+f,E.y+m)}},batchGameObject:function(c,f,m){f===void 0&&(f=c.x),m===void 0&&(m=c.y);var v=c.x,E=c.y,x=this.camera,T=this.renderer,A=this._eraseMode,P=c.mask;if(c.setPosition(f,m),this.canvas){if(A){var R=c.blendMode;c.blendMode=i.ERASE}P&&P.preRenderCanvas(T,c,x),c.renderCanvas(T,c,x,null),P&&P.postRenderCanvas(T,c,x),A&&(c.blendMode=R)}else T&&(P&&P.preRenderWebGL(T,c,x),A||T.setBlendMode(c.blendMode),c.renderWebGL(T,c,x),P&&P.postRenderWebGL(T,x,this.renderTarget));c.setPosition(v,E)},batchTextureFrameKey:function(c,f,m,v,E,x){var T=this.manager.getFrame(c,f);T&&this.batchTextureFrame(T,m,v,E,x)},batchTextureFrame:function(c,f,m,v,E){f===void 0&&(f=0),m===void 0&&(m=0),v===void 0&&(v=1),E===void 0&&(E=16777215);var x=this.camera.matrix,T=this.renderTarget;if(T)this.pipeline.batchTextureFrame(c,f,m,E,v,x,null);else{var A=this.context,P=c.canvasData,R=c.source.image;A.save(),A.globalCompositeOperation=this._eraseMode?"destination-out":"source-over",A.globalAlpha=v,x.setToContext(A),P.width>0&&P.height>0&&A.drawImage(R,P.x,P.y,P.width,P.height,f,m,P.width,P.height),A.restore()}},snapshotArea:function(c,f,m,v,E,x,T){return this.renderTarget?this.renderer.snapshotFramebuffer(this.renderTarget.framebuffer,this.width,this.height,E,!1,c,f,m,v,x,T):this.renderer.snapshotCanvas(this.canvas,E,!1,c,f,m,v,x,T),this},snapshot:function(c,f,m){return this.snapshotArea(0,0,this.width,this.height,c,f,m)},snapshotPixel:function(c,f,m){return this.snapshotArea(c,f,1,1,m,"pixel")},getWebGLTexture:function(){if(this.renderTarget)return this.renderTarget.texture},renderWebGL:function(c,f,m,v){var E=this.manager.resetStamp();E.setTexture(this),E.setOrigin(0),E.renderWebGL(c,E,m,v)},renderCanvas:function(){},destroy:function(){var c=this.manager.stamp;c&&c.texture===this&&this.manager.resetStamp(),d.prototype.destroy.call(this),n.remove(this.canvas),this.renderTarget&&this.renderTarget.destroy(),this.camera.destroy(),this.canvas=null,this.context=null,this.renderer=null}});t.exports=g}),VT=y((e,t)=>{t.exports={0:"#000",1:"#9D9D9D",2:"#FFF",3:"#BE2633",4:"#E06F8B",5:"#493C2B",6:"#A46422",7:"#EB8931",8:"#F7E26B",9:"#2F484E",A:"#44891A",B:"#A3CE27",C:"#1B2632",D:"#005784",E:"#31A2F2",F:"#B2DCEF"}}),XT=y((e,t)=>{var i=VT(),s=xe(),n=St(),r=function(o){var a=n(o,"data",[]),h=n(o,"canvas",null),l=n(o,"palette",i),u=n(o,"pixelWidth",1),d=n(o,"pixelHeight",u),p=n(o,"resizeCanvas",!0),g=n(o,"clearCanvas",!0),c=n(o,"preRender",null),f=n(o,"postRender",null),m=Math.floor(Math.abs(a[0].length*u)),v=Math.floor(Math.abs(a.length*d));h||(h=s.create2D(this,m,v),p=!1,g=!1),p&&(h.width=m,h.height=v);var E=h.getContext("2d",{willReadFrequently:!0});g&&E.clearRect(0,0,m,v),c&&c(h,E);for(var x=0;x<a.length;x++)for(var T=a[x],A=0;A<T.length;A++){var P=T[A];P!=="."&&P!==" "&&(E.fillStyle=l[P],E.fillRect(A*u,x*d,u,d))}return f&&f(h,E),h};t.exports=r}),KT=y((e,t)=>{var i=function(s,n,r,o){r.addToRenderList(n),this.pipeline.batchSprite(n,r,o)};t.exports=i}),jT=y((e,t)=>{var i=Rt(),s=i,n=i;s=KT(),t.exports={renderWebGL:s,renderCanvas:n}}),Hn=y((e,t)=>{var i=W(),s=be(),n=He(),r=jT(),o=new i({Extends:n,Mixins:[s.Alpha,s.BlendMode,s.Depth,s.Flip,s.GetBounds,s.Mask,s.Origin,s.Pipeline,s.PostPipeline,s.ScrollFactor,s.Size,s.TextureCrop,s.Tint,s.Transform,s.Visible,r],initialize:function(a,h,l,u,d){n.call(this,a,"Image"),this._crop=this.resetCropObject(),this.setTexture(u,d),this.setPosition(h,l),this.setSizeToFrame(),this.setOriginFromFrame(),this.initPipeline(),this.initPostPipeline(!0)}});t.exports=o}),ZT=y((e,t)=>{var i=function(s,n,r){if(r.getElementsByTagName("TextureAtlas")){var o=s.source[n];s.add("__BASE",n,0,0,o.width,o.height);for(var a=r.getElementsByTagName("SubTexture"),h,l=0;l<a.length;l++){var u=a[l].attributes,d=u.name.value,p=parseInt(u.x.value,10),g=parseInt(u.y.value,10),c=parseInt(u.width.value,10),f=parseInt(u.height.value,10);if(h=s.add(d,n,p,g,c,f),u.frameX){var m=Math.abs(parseInt(u.frameX.value,10)),v=Math.abs(parseInt(u.frameY.value,10)),E=parseInt(u.frameWidth.value,10),x=parseInt(u.frameHeight.value,10);h.setTrim(c,f,m,v,E,x)}}return s}};t.exports=i}),qT=y((e,t)=>{var i=function(s,n){var r=s.source[n];return s.add("__BASE",n,0,0,r.width,r.height),s};t.exports=i}),JT=y((e,t)=>{var i=function(s,n){var r=s.source[n];return s.add("__BASE",n,0,0,r.width,r.height),s};t.exports=i}),QT=y((e,t)=>{var i=Xi(),s=function(n,r,o){if(!(!o.frames&&!o.textures)){var a=n.source[r];n.add("__BASE",r,0,0,a.width,a.height);for(var h=Array.isArray(o.textures)?o.textures[r].frames:o.frames,l,u=0;u<h.length;u++){var d=h[u];if(l=n.add(d.filename,r,d.frame.x,d.frame.y,d.frame.w,d.frame.h),!!l){d.trimmed&&l.setTrim(d.sourceSize.w,d.sourceSize.h,d.spriteSourceSize.x,d.spriteSourceSize.y,d.spriteSourceSize.w,d.spriteSourceSize.h),d.rotated&&(l.rotated=!0,l.updateUVsInverted());var p=d.anchor||d.pivot;p&&(l.customPivot=!0,l.pivotX=p.x,l.pivotY=p.y),d.scale9Borders&&l.setScale9(d.scale9Borders.x,d.scale9Borders.y,d.scale9Borders.w,d.scale9Borders.h),l.customData=i(d)}}for(var g in o)g!=="frames"&&(Array.isArray(o[g])?n.customData[g]=o[g].slice(0):n.customData[g]=o[g]);return n}};t.exports=s}),$T=y((e,t)=>{var i=Xi(),s=function(n,r,o){if(o.frames){var a=n.source[r];n.add("__BASE",r,0,0,a.width,a.height);var h=o.frames,l;for(var u in h)if(h.hasOwnProperty(u)){var d=h[u];if(l=n.add(u,r,d.frame.x,d.frame.y,d.frame.w,d.frame.h),!l)continue;d.trimmed&&l.setTrim(d.sourceSize.w,d.sourceSize.h,d.spriteSourceSize.x,d.spriteSourceSize.y,d.spriteSourceSize.w,d.spriteSourceSize.h),d.rotated&&(l.rotated=!0,l.updateUVsInverted());var p=d.anchor||d.pivot;p&&(l.customPivot=!0,l.pivotX=p.x,l.pivotY=p.y),d.scale9Borders&&l.setScale9(d.scale9Borders.x,d.scale9Borders.y,d.scale9Borders.w,d.scale9Borders.h),l.customData=i(d)}for(var g in o)g!=="frames"&&(Array.isArray(o[g])?n.customData[g]=o[g].slice(0):n.customData[g]=o[g]);return n}};t.exports=s}),tx=y((e,t)=>{var i=function(s){var n=[171,75,84,88,32,49,49,187,13,10,26,10],r,o=new Uint8Array(s,0,12);for(r=0;r<o.length;r++)if(o[r]!==n[r])return;var a=Uint32Array.BYTES_PER_ELEMENT,h=new DataView(s,12,13*a),l=h.getUint32(0,!0)===67305985,u=h.getUint32(1*a,l);if(u===0){var d=h.getUint32(4*a,l),p=h.getUint32(6*a,l),g=h.getUint32(7*a,l),c=Math.max(1,h.getUint32(11*a,l)),f=h.getUint32(12*a,l),m=new Array(c),v=12+13*4+f,E=p,x=g;for(r=0;r<c;r++){var T=new Int32Array(s,v,1)[0];v+=4,m[r]={data:new Uint8Array(s,v,T),width:E,height:x},E=Math.max(1,E>>1),x=Math.max(1,x>>1),v+=T}return{mipmaps:m,width:p,height:g,internalFormat:d,compressed:!0,generateMipmap:!1}}};t.exports=i}),ex=y((e,t)=>{function i(R,S,I,w,C,_,O){return O===void 0&&(O=16),Math.floor((R+I)/C)*Math.floor((S+w)/_)*O}function s(R,S){return R=Math.max(R,16),S=Math.max(S,8),R*S/4}function n(R,S){return R=Math.max(R,8),S=Math.max(S,8),R*S/2}function r(R,S){return Math.ceil(R/4)*Math.ceil(S/4)*16}function o(R,S){return i(R,S,3,3,4,4,8)}function a(R,S){return i(R,S,3,3,4,4)}function h(R,S){return i(R,S,4,3,5,4)}function l(R,S){return i(R,S,4,4,5,5)}function u(R,S){return i(R,S,5,4,6,5)}function d(R,S){return i(R,S,5,5,6,6)}function p(R,S){return i(R,S,7,4,8,5)}function g(R,S){return i(R,S,7,5,8,6)}function c(R,S){return i(R,S,7,7,8,8)}function f(R,S){return i(R,S,9,4,10,5)}function m(R,S){return i(R,S,9,5,10,6)}function v(R,S){return i(R,S,9,7,10,8)}function E(R,S){return i(R,S,9,9,10,10)}function x(R,S){return i(R,S,11,9,12,10)}function T(R,S){return i(R,S,11,11,12,12)}var A={0:{sizeFunc:s,glFormat:[35841]},1:{sizeFunc:s,glFormat:[35843]},2:{sizeFunc:n,glFormat:[35840]},3:{sizeFunc:n,glFormat:[35842]},6:{sizeFunc:o,glFormat:[36196]},7:{sizeFunc:o,glFormat:[33776,35916]},8:{sizeFunc:a,glFormat:[33777,35917]},9:{sizeFunc:a,glFormat:[33778,35918]},11:{sizeFunc:a,glFormat:[33779,35919]},14:{sizeFunc:r,glFormat:[36494,36495]},15:{sizeFunc:r,glFormat:[36492,36493]},22:{sizeFunc:o,glFormat:[37492,37493]},23:{sizeFunc:a,glFormat:[37496,37497]},24:{sizeFunc:o,glFormat:[37494,37495]},25:{sizeFunc:o,glFormat:[37488]},26:{sizeFunc:a,glFormat:[37490]},27:{sizeFunc:a,glFormat:[37808,37840]},28:{sizeFunc:h,glFormat:[37809,37841]},29:{sizeFunc:l,glFormat:[37810,37842]},30:{sizeFunc:u,glFormat:[37811,37843]},31:{sizeFunc:d,glFormat:[37812,37844]},32:{sizeFunc:p,glFormat:[37813,37845]},33:{sizeFunc:g,glFormat:[37814,37846]},34:{sizeFunc:c,glFormat:[37815,37847]},35:{sizeFunc:f,glFormat:[37816,37848]},36:{sizeFunc:m,glFormat:[37817,37849]},37:{sizeFunc:v,glFormat:[37818,37850]},38:{sizeFunc:E,glFormat:[37819,37851]},39:{sizeFunc:x,glFormat:[37820,37852]},40:{sizeFunc:T,glFormat:[37821,37853]}},P=function(R){for(var S=new Uint32Array(R,0,13),I=S[0],w=I===55727696,C=w?S[2]:S[3],_=S[4],O=A[C].glFormat[_],D=A[C].sizeFunc,F=S[11],N=S[7],Y=S[6],L=52+S[12],b=new Uint8Array(R,L),M=new Array(F),k=0,B=N,H=Y,z=0;z<F;z++){var V=D(B,H);M[z]={data:new Uint8Array(b.buffer,b.byteOffset+k,V),width:B,height:H},B=Math.max(1,B>>1),H=Math.max(1,H>>1),k+=V}return{mipmaps:M,width:N,height:Y,internalFormat:O,compressed:!0,generateMipmap:!1}};t.exports=P}),ix=y((e,t)=>{var i=dt(),s=function(n,r,o,a,h,l,u){var d=i(u,"frameWidth",null),p=i(u,"frameHeight",d);if(d===null)throw new Error("TextureManager.SpriteSheet: Invalid frameWidth given.");var g=n.source[r];n.add("__BASE",r,0,0,g.width,g.height);var c=i(u,"startFrame",0),f=i(u,"endFrame",-1),m=i(u,"margin",0),v=i(u,"spacing",0),E=Math.floor((h-m+v)/(d+v)),x=Math.floor((l-m+v)/(p+v)),T=E*x;(c>T||c<-T)&&(c=0),c<0&&(c=T+c),(f===-1||f>T||f<c)&&(f=T);for(var A=m,P=m,R=0,S=0,I=0,w=0;w<T;w++){R=0,S=0;var C=A+d,_=P+p;C>h&&(R=C-h),_>l&&(S=_-l),w>=c&&w<=f&&(n.add(I,r,o+A,a+P,d-R,p-S),I++),A+=d+v,A+d>h&&(A=m,P+=p+v)}return n};t.exports=s}),sx=y((e,t)=>{var i=dt(),s=function(n,r,o){var a=i(o,"frameWidth",null),h=i(o,"frameHeight",a);if(!a)throw new Error("TextureManager.SpriteSheetFromAtlas: Invalid frameWidth given.");var l=n.source[0];n.add("__BASE",0,0,0,l.width,l.height);var u=i(o,"startFrame",0),d=i(o,"endFrame",-1),p=i(o,"margin",0),g=i(o,"spacing",0),c=r.cutX,f=r.cutY,m=r.cutWidth,v=r.cutHeight,E=r.realWidth,x=r.realHeight,T=Math.floor((E-p+g)/(a+g)),A=Math.floor((x-p+g)/(h+g)),P=T*A,R=r.x,S=a-R,I=a-(E-m-R),w=r.y,C=h-w,_=h-(x-v-w);(u>P||u<-P)&&(u=0),u<0&&(u=P+u),d!==-1&&(P=u+(d+1));for(var O,D=p,F=p,N=0,Y=0,L=0;L<A;L++){for(var b=L===0,M=L===A-1,k=0;k<T;k++){var B=k===0,H=k===T-1;if(O=n.add(N,Y,c+D,f+F,a,h),B||b||H||M){var z=B?R:0,V=b?w:0,q=0,Z=0;B&&(q+=a-S),H&&(q+=a-I),b&&(Z+=h-C),M&&(Z+=h-_);var at=a-q,et=h-Z;O.cutWidth=at,O.cutHeight=et,O.setTrim(a,h,z,V,at,et)}D+=g,B?D+=S:H?D+=I:D+=a,N++}D=p,F+=g,b?F+=C:M?F+=_:F+=h}return n};t.exports=s}),nx=y((e,t)=>{var i=0,s=function(r,o,a,h){var l=i-h.y-h.height;r.add(a,o,h.x,l,h.width,h.height)},n=function(r,o,a){var h=r.source[o];r.add("__BASE",o,0,0,h.width,h.height),i=h.height;for(var l=a.split(`
`),u=/^[ ]*(- )*(\w+)+[: ]+(.*)/,d="",p="",g={x:0,y:0,width:0,height:0},c=0;c<l.length;c++){var f=l[c].match(u);if(f){var m=f[1]==="- ",v=f[2],E=f[3];if(m&&(p!==d&&(s(r,o,p,g),d=p),g={x:0,y:0,width:0,height:0}),v==="name"){p=E;continue}switch(v){case"x":case"y":case"width":case"height":g[v]=parseInt(E,10);break}}}return p!==d&&s(r,o,p,g),r};t.exports=n}),lc=y((e,t)=>{t.exports={AtlasXML:ZT(),Canvas:qT(),Image:JT(),JSONArray:QT(),JSONHash:$T(),KTXParser:tx(),PVRParser:ex(),SpriteSheet:ix(),SpriteSheetFromAtlas:sx(),UnityYAML:nx()}}),uc=y((e,t)=>{var i=xe(),s=oc(),n=W(),r=di(),o=Pe(),a=hc(),h=Ct(),l=ks(),u=Hi(),d=$t(),p=XT(),g=St(),c=Hn(),f=ce(),m=lc(),v=Ut(),E=Yn(),x=new n({Extends:h,initialize:function(T){h.call(this),this.game=T,this.name="TextureManager",this.list={},this._tempCanvas=i.create2D(this),this._tempContext=this._tempCanvas.getContext("2d",{willReadFrequently:!0}),this._pending=0,this.stamp,this.stampCrop=new v,this.silentWarnings=!1,T.events.once(d.BOOT,this.boot,this)},boot:function(){this._pending=3,this.on(l.LOAD,this.updatePending,this),this.on(l.ERROR,this.updatePending,this);var T=this.game.config;T.defaultImage!==null&&this.addBase64("__DEFAULT",T.defaultImage),T.missingImage!==null&&this.addBase64("__MISSING",T.missingImage),T.whiteImage!==null&&this.addBase64("__WHITE",T.whiteImage),this.game.renderer&&this.game.renderer.gl&&this.addUint8Array("__NORMAL",new Uint8Array([127,127,255,255]),1,1),this.game.events.once(d.DESTROY,this.destroy,this),this.game.events.once(d.SYSTEM_READY,function(A){this.stamp=new c(A).setOrigin(0)},this)},updatePending:function(){this._pending--,this._pending===0&&(this.off(l.LOAD),this.off(l.ERROR),this.emit(l.READY))},checkKey:function(T){return!T||typeof T!="string"||this.exists(T)?(this.silentWarnings,!1):!0},remove:function(T){if(typeof T=="string")if(this.exists(T))T=this.get(T);else return this.silentWarnings,this;var A=T.key;return this.list.hasOwnProperty(A)&&(T.destroy(),this.emit(l.REMOVE,A),this.emit(l.REMOVE_KEY+A)),this},removeKey:function(T){return this.list.hasOwnProperty(T)&&delete this.list[T],this},addBase64:function(T,A){if(this.checkKey(T)){var P=this,R=new Image;R.onerror=function(){P.emit(l.ERROR,T)},R.onload=function(){var S=P.create(T,R);S&&(m.Image(S,0),P.emit(l.ADD,T,S),P.emit(l.ADD_KEY+T,S),P.emit(l.LOAD,T,S))},R.src=A}return this},getBase64:function(T,A,P,R){P===void 0&&(P="image/png"),R===void 0&&(R=.92);var S="",I=this.getFrame(T,A);if(I&&(I.source.isRenderTexture||I.source.isGLTexture))this.silentWarnings;else if(I){var w=I.canvasData,C=i.create2D(this,w.width,w.height),_=C.getContext("2d",{willReadFrequently:!0});w.width>0&&w.height>0&&_.drawImage(I.source.image,w.x,w.y,w.width,w.height,0,0,w.width,w.height),S=C.toDataURL(P,R),i.remove(C)}return S},addImage:function(T,A,P){var R=null;return this.checkKey(T)&&(R=this.create(T,A),m.Image(R,0),P&&R.setDataSource(P),this.emit(l.ADD,T,R),this.emit(l.ADD_KEY+T,R)),R},addGLTexture:function(T,A){var P=null;if(this.checkKey(T)){var R=A.width,S=A.height;P=this.create(T,A,R,S),P.add("__BASE",0,0,0,R,S),this.emit(l.ADD,T,P),this.emit(l.ADD_KEY+T,P)}return P},addCompressedTexture:function(T,A,P){var R=null;if(this.checkKey(T)){if(R=this.create(T,A),R.add("__BASE",0,0,0,A.width,A.height),P){var S=function(w,C,_){Array.isArray(_.textures)||Array.isArray(_.frames)?m.JSONArray(w,C,_):m.JSONHash(w,C,_)};if(Array.isArray(P))for(var I=0;I<P.length;I++)S(R,I,P[I]);else S(R,0,P)}this.emit(l.ADD,T,R),this.emit(l.ADD_KEY+T,R)}return R},addRenderTexture:function(T,A){var P=null;return this.checkKey(T)&&(P=this.create(T,A),P.add("__BASE",0,0,0,A.width,A.height),this.emit(l.ADD,T,P),this.emit(l.ADD_KEY+T,P)),P},generate:function(T,A){if(this.checkKey(T)){var P=i.create(this,1,1);return A.canvas=P,p(A),this.addCanvas(T,P)}else return null},createCanvas:function(T,A,P){if(A===void 0&&(A=256),P===void 0&&(P=256),this.checkKey(T)){var R=i.create(this,A,P,o.CANVAS,!0);return this.addCanvas(T,R)}return null},addCanvas:function(T,A,P){P===void 0&&(P=!1);var R=null;return P?R=new s(this,T,A,A.width,A.height):this.checkKey(T)&&(R=new s(this,T,A,A.width,A.height),this.list[T]=R,this.emit(l.ADD,T,R),this.emit(l.ADD_KEY+T,R)),R},addDynamicTexture:function(T,A,P){var R=null;return typeof T=="string"&&!this.exists(T)?R=new a(this,T,A,P):(R=T,T=R.key),this.checkKey(T)?(this.list[T]=R,this.emit(l.ADD,T,R),this.emit(l.ADD_KEY+T,R)):R=null,R},addAtlas:function(T,A,P,R){return Array.isArray(P.textures)||Array.isArray(P.frames)?this.addAtlasJSONArray(T,A,P,R):this.addAtlasJSONHash(T,A,P,R)},addAtlasJSONArray:function(T,A,P,R){var S=null;if(A instanceof E?(T=A.key,S=A):this.checkKey(T)&&(S=this.create(T,A)),S){if(Array.isArray(P))for(var I=P.length===1,w=0;w<S.source.length;w++){var C=I?P[0]:P[w];m.JSONArray(S,w,C)}else m.JSONArray(S,0,P);R&&S.setDataSource(R),this.emit(l.ADD,T,S),this.emit(l.ADD_KEY+T,S)}return S},addAtlasJSONHash:function(T,A,P,R){var S=null;if(A instanceof E?(T=A.key,S=A):this.checkKey(T)&&(S=this.create(T,A)),S){if(Array.isArray(P))for(var I=0;I<P.length;I++)m.JSONHash(S,I,P[I]);else m.JSONHash(S,0,P);R&&S.setDataSource(R),this.emit(l.ADD,T,S),this.emit(l.ADD_KEY+T,S)}return S},addAtlasXML:function(T,A,P,R){var S=null;return A instanceof E?(T=A.key,S=A):this.checkKey(T)&&(S=this.create(T,A)),S&&(m.AtlasXML(S,0,P),R&&S.setDataSource(R),this.emit(l.ADD,T,S),this.emit(l.ADD_KEY+T,S)),S},addUnityAtlas:function(T,A,P,R){var S=null;return A instanceof E?(T=A.key,S=A):this.checkKey(T)&&(S=this.create(T,A)),S&&(m.UnityYAML(S,0,P),R&&S.setDataSource(R),this.emit(l.ADD,T,S),this.emit(l.ADD_KEY+T,S)),S},addSpriteSheet:function(T,A,P,R){var S=null;if(A instanceof E?(T=A.key,S=A):this.checkKey(T)&&(S=this.create(T,A)),S){var I=S.source[0].width,w=S.source[0].height;m.SpriteSheet(S,0,0,0,I,w,P),R&&S.setDataSource(R),this.emit(l.ADD,T,S),this.emit(l.ADD_KEY+T,S)}return S},addSpriteSheetFromAtlas:function(T,A){if(!this.checkKey(T))return null;var P=g(A,"atlas",null),R=g(A,"frame",null);if(!(!P||!R)){var S=this.get(P),I=S.get(R);if(I){var w=I.source.image;w||(w=I.source.glTexture);var C=this.create(T,w);return I.trimmed?m.SpriteSheetFromAtlas(C,I,A):m.SpriteSheet(C,0,I.cutX,I.cutY,I.cutWidth,I.cutHeight,A),this.emit(l.ADD,T,C),this.emit(l.ADD_KEY+T,C),C}}},addUint8Array:function(T,A,P,R){if(!this.checkKey(T)||A.length/4!==P*R)return null;var S=this.create(T,A,P,R);return S.add("__BASE",0,0,0,P,R),this.emit(l.ADD,T,S),this.emit(l.ADD_KEY+T,S),S},create:function(T,A,P,R){var S=null;return this.checkKey(T)&&(S=new E(this,T,A,P,R),this.list[T]=S),S},exists:function(T){return this.list.hasOwnProperty(T)},get:function(T){return T===void 0&&(T="__DEFAULT"),this.list[T]?this.list[T]:T instanceof E?T:T instanceof u?T.texture:this.list.__MISSING},cloneFrame:function(T,A){if(this.list[T])return this.list[T].get(A).clone()},getFrame:function(T,A){if(this.list[T])return this.list[T].get(A)},parseFrame:function(T){if(T){if(typeof T=="string")return this.getFrame(T);if(Array.isArray(T)&&T.length===2)return this.getFrame(T[0],T[1]);if(f(T))return this.getFrame(T.key,T.frame);if(T instanceof E)return T.get();if(T instanceof u)return T}else return},getTextureKeys:function(){var T=[];for(var A in this.list)A!=="__DEFAULT"&&A!=="__MISSING"&&A!=="__WHITE"&&A!=="__NORMAL"&&T.push(A);return T},getPixel:function(T,A,P,R){var S=this.getFrame(P,R);if(S){T-=S.x,A-=S.y;var I=S.data.cut;if(T+=I.x,A+=I.y,T>=I.x&&T<I.r&&A>=I.y&&A<I.b){var w=this._tempContext;w.clearRect(0,0,1,1),w.drawImage(S.source.image,T,A,1,1,0,0,1,1);var C=w.getImageData(0,0,1,1);return new r(C.data[0],C.data[1],C.data[2],C.data[3])}}return null},getPixelAlpha:function(T,A,P,R){var S=this.getFrame(P,R);if(S){T-=S.x,A-=S.y;var I=S.data.cut;if(T+=I.x,A+=I.y,T>=I.x&&T<I.r&&A>=I.y&&A<I.b){var w=this._tempContext;w.clearRect(0,0,1,1),w.drawImage(S.source.image,T,A,1,1,0,0,1,1);var C=w.getImageData(0,0,1,1);return C.data[3]}}return null},setTexture:function(T,A,P){return this.list[A]&&(T.texture=this.list[A],T.frame=T.texture.get(P)),T},renameTexture:function(T,A){var P=this.get(T);return P&&T!==A?(P.key=A,this.list[A]=P,delete this.list[T],!0):!1},each:function(T,A){for(var P=[null],R=1;R<arguments.length;R++)P.push(arguments[R]);for(var S in this.list)P[0]=this.list[S],T.apply(A,P)},resetStamp:function(T,A){T===void 0&&(T=1),A===void 0&&(A=16777215);var P=this.stamp;return P.setCrop(),P.setPosition(0),P.setAngle(0),P.setScale(1),P.setAlpha(T),P.setTint(A),P.setTexture("__WHITE"),P},destroy:function(){for(var T in this.list)this.list[T].destroy();this.list={},this.stamp.destroy(),this.game=null,this.stamp=null,i.remove(this._tempCanvas)}});t.exports=x}),rx=y((e,t)=>{t.exports="complete"}),ax=y((e,t)=>{t.exports="decoded"}),ox=y((e,t)=>{t.exports="decodedall"}),hx=y((e,t)=>{t.exports="destroy"}),lx=y((e,t)=>{t.exports="detune"}),ux=y((e,t)=>{t.exports="detune"}),cx=y((e,t)=>{t.exports="mute"}),dx=y((e,t)=>{t.exports="rate"}),px=y((e,t)=>{t.exports="volume"}),gx=y((e,t)=>{t.exports="loop"}),fx=y((e,t)=>{t.exports="looped"}),mx=y((e,t)=>{t.exports="mute"}),vx=y((e,t)=>{t.exports="pan"}),Ex=y((e,t)=>{t.exports="pauseall"}),yx=y((e,t)=>{t.exports="pause"}),Tx=y((e,t)=>{t.exports="play"}),xx=y((e,t)=>{t.exports="rate"}),Sx=y((e,t)=>{t.exports="resumeall"}),Ax=y((e,t)=>{t.exports="resume"}),wx=y((e,t)=>{t.exports="seek"}),Cx=y((e,t)=>{t.exports="stopall"}),Px=y((e,t)=>{t.exports="stop"}),Rx=y((e,t)=>{t.exports="unlocked"}),bx=y((e,t)=>{t.exports="volume"}),Pi=y((e,t)=>{t.exports={COMPLETE:rx(),DECODED:ax(),DECODED_ALL:ox(),DESTROY:hx(),DETUNE:lx(),GLOBAL_DETUNE:ux(),GLOBAL_MUTE:cx(),GLOBAL_RATE:dx(),GLOBAL_VOLUME:px(),LOOP:gx(),LOOPED:fx(),MUTE:mx(),PAN:vx(),PAUSE_ALL:Ex(),PAUSE:yx(),PLAY:Tx(),RATE:xx(),RESUME_ALL:Sx(),RESUME:Ax(),SEEK:wx(),STOP_ALL:Cx(),STOP:Px(),UNLOCKED:Rx(),VOLUME:bx()}}),zn=y((e,t)=>{var i=W(),s=Xi(),n=Ct(),r=Pi(),o=$t(),a=Kr(),h=Yh(),l=Rt(),u=xt(),d=new i({Extends:n,initialize:function(p){n.call(this),this.game=p,this.jsonCache=p.cache.json,this.sounds=[],this.mute=!1,this.volume=1,this.pauseOnBlur=!0,this._rate=1,this._detune=0,this.locked=this.locked||!1,this.unlocked=!1,this.gameLostFocus=!1,this.listenerPosition=new u;var g=p.events;g.on(o.BLUR,this.onGameBlur,this),g.on(o.FOCUS,this.onGameFocus,this),g.on(o.PRE_STEP,this.update,this),g.once(o.DESTROY,this.destroy,this)},add:l,addAudioSprite:function(p,g){g===void 0&&(g={});var c=this.add(p,g);c.spritemap=this.jsonCache.get(p).spritemap;for(var f in c.spritemap)if(c.spritemap.hasOwnProperty(f)){var m=s(g),v=c.spritemap[f];m.loop=v.hasOwnProperty("loop")?v.loop:!1,c.addMarker({name:f,start:v.start,duration:v.end-v.start,config:m})}return c},get:function(p){return h(this.sounds,"key",p)},getAll:function(p){return p?a(this.sounds,"key",p):a(this.sounds)},getAllPlaying:function(){return a(this.sounds,"isPlaying",!0)},play:function(p,g){var c=this.add(p);return c.once(r.COMPLETE,c.destroy,c),g?g.name?(c.addMarker(g),c.play(g.name)):c.play(g):c.play()},playAudioSprite:function(p,g,c){var f=this.addAudioSprite(p);return f.once(r.COMPLETE,f.destroy,f),f.play(g,c)},remove:function(p){var g=this.sounds.indexOf(p);return g!==-1?(p.destroy(),this.sounds.splice(g,1),!0):!1},removeAll:function(){this.sounds.forEach(function(p){p.destroy()}),this.sounds.length=0},removeByKey:function(p){for(var g=0,c=this.sounds.length-1;c>=0;c--){var f=this.sounds[c];f.key===p&&(f.destroy(),this.sounds.splice(c,1),g++)}return g},pauseAll:function(){this.forEachActiveSound(function(p){p.pause()}),this.emit(r.PAUSE_ALL,this)},resumeAll:function(){this.forEachActiveSound(function(p){p.resume()}),this.emit(r.RESUME_ALL,this)},setListenerPosition:l,stopAll:function(){this.forEachActiveSound(function(p){p.stop()}),this.emit(r.STOP_ALL,this)},stopByKey:function(p){var g=0;return this.getAll(p).forEach(function(c){c.stop()&&g++}),g},isPlaying:function(p){var g=this.sounds,c=g.length-1,f;if(p===void 0){for(;c>=0;c--)if(f=this.sounds[c],f.isPlaying)return!0}else for(;c>=0;c--)if(f=this.sounds[c],f.key===p&&f.isPlaying)return!0;return!1},unlock:l,onBlur:l,onFocus:l,onGameBlur:function(){this.gameLostFocus=!0,this.pauseOnBlur&&this.onBlur()},onGameFocus:function(){this.gameLostFocus=!1,this.pauseOnBlur&&this.onFocus()},update:function(p,g){this.unlocked&&(this.unlocked=!1,this.locked=!1,this.emit(r.UNLOCKED,this));for(var c=this.sounds.length-1;c>=0;c--)this.sounds[c].pendingRemove&&this.sounds.splice(c,1);this.sounds.forEach(function(f){f.update(p,g)})},destroy:function(){this.game.events.off(o.BLUR,this.onGameBlur,this),this.game.events.off(o.FOCUS,this.onGameFocus,this),this.game.events.off(o.PRE_STEP,this.update,this),this.removeAllListeners(),this.removeAll(),this.sounds.length=0,this.sounds=null,this.listenerPosition=null,this.game=null},forEachActiveSound:function(p,g){var c=this;this.sounds.forEach(function(f,m){f&&!f.pendingRemove&&p.call(g||c,f,m,c.sounds)})},setRate:function(p){return this.rate=p,this},rate:{get:function(){return this._rate},set:function(p){this._rate=p,this.forEachActiveSound(function(g){g.calculateRate()}),this.emit(r.GLOBAL_RATE,this,p)}},setDetune:function(p){return this.detune=p,this},detune:{get:function(){return this._detune},set:function(p){this._detune=p,this.forEachActiveSound(function(g){g.calculateRate()}),this.emit(r.GLOBAL_DETUNE,this,p)}}});t.exports=d}),Wn=y((e,t)=>{var i=W(),s=Ct(),n=Pi(),r=Qt(),o=Rt(),a=new i({Extends:s,initialize:function(h,l,u){s.call(this),this.manager=h,this.key=l,this.isPlaying=!1,this.isPaused=!1,this.totalRate=1,this.duration=this.duration||0,this.totalDuration=this.totalDuration||0,this.config={mute:!1,volume:1,rate:1,detune:0,seek:0,loop:!1,delay:0,pan:0},this.currentConfig=this.config,this.config=r(this.config,u),this.markers={},this.currentMarker=null,this.pendingRemove=!1},addMarker:function(h){return!h||!h.name||typeof h.name!="string"||this.markers[h.name]?!1:(h=r(!0,{name:"",start:0,duration:this.totalDuration-(h.start||0),config:{mute:!1,volume:1,rate:1,detune:0,seek:0,loop:!1,delay:0,pan:0}},h),this.markers[h.name]=h,!0)},updateMarker:function(h){return!h||!h.name||typeof h.name!="string"?!1:this.markers[h.name]?(this.markers[h.name]=r(!0,this.markers[h.name],h),!0):!1},removeMarker:function(h){var l=this.markers[h];return l?(this.markers[h]=null,l):null},play:function(h,l){if(h===void 0&&(h=""),typeof h=="object"&&(l=h,h=""),typeof h!="string")return!1;if(!h)this.currentMarker=null,this.currentConfig=this.config,this.duration=this.totalDuration;else{if(!this.markers[h])return!1;this.currentMarker=this.markers[h],this.currentConfig=this.currentMarker.config,this.duration=this.currentMarker.duration}return this.resetConfig(),this.currentConfig=r(this.currentConfig,l),this.isPlaying=!0,this.isPaused=!1,!0},pause:function(){return this.isPaused||!this.isPlaying?!1:(this.isPlaying=!1,this.isPaused=!0,!0)},resume:function(){return!this.isPaused||this.isPlaying?!1:(this.isPlaying=!0,this.isPaused=!1,!0)},stop:function(){return!this.isPaused&&!this.isPlaying?!1:(this.isPlaying=!1,this.isPaused=!1,this.resetConfig(),!0)},applyConfig:function(){this.mute=this.currentConfig.mute,this.volume=this.currentConfig.volume,this.rate=this.currentConfig.rate,this.detune=this.currentConfig.detune,this.loop=this.currentConfig.loop,this.pan=this.currentConfig.pan},resetConfig:function(){this.currentConfig.seek=0,this.currentConfig.delay=0},update:o,calculateRate:function(){var h=1.0005777895065548,l=this.currentConfig.detune+this.manager.detune,u=Math.pow(h,l);this.totalRate=this.currentConfig.rate*this.manager.rate*u},destroy:function(){this.pendingRemove||(this.stop(),this.emit(n.DESTROY,this),this.removeAllListeners(),this.pendingRemove=!0,this.manager=null,this.config=null,this.currentConfig=null,this.markers=null,this.currentMarker=null)}});t.exports=a}),cc=y((e,t)=>{var i=Wn(),s=W(),n=Pi(),r=Ot(),o=new s({Extends:i,initialize:function(a,h,l){if(l===void 0&&(l={}),this.tags=a.game.cache.audio.get(h),!this.tags)throw new Error('No cached audio asset with key "'+h);this.audio=null,this.startTime=0,this.previousTime=0,this.duration=this.tags[0].duration,this.totalDuration=this.tags[0].duration,i.call(this,a,h,l)},play:function(a,h){return this.manager.isLocked(this,"play",[a,h])||!i.prototype.play.call(this,a,h)||!this.pickAndPlayAudioTag()?!1:(this.emit(n.PLAY,this),!0)},pause:function(){return this.manager.isLocked(this,"pause")||this.startTime>0||!i.prototype.pause.call(this)?!1:(this.currentConfig.seek=this.audio.currentTime-(this.currentMarker?this.currentMarker.start:0),this.stopAndReleaseAudioTag(),this.emit(n.PAUSE,this),!0)},resume:function(){return this.manager.isLocked(this,"resume")||this.startTime>0||!i.prototype.resume.call(this)||!this.pickAndPlayAudioTag()?!1:(this.emit(n.RESUME,this),!0)},stop:function(){return this.manager.isLocked(this,"stop")||!i.prototype.stop.call(this)?!1:(this.stopAndReleaseAudioTag(),this.emit(n.STOP,this),!0)},pickAndPlayAudioTag:function(){if(!this.pickAudioTag())return this.reset(),!1;var a=this.currentConfig.seek,h=this.currentConfig.delay,l=(this.currentMarker?this.currentMarker.start:0)+a;return this.previousTime=l,this.audio.currentTime=l,this.applyConfig(),h===0?(this.startTime=0,this.audio.paused&&this.playCatchPromise()):(this.startTime=window.performance.now()+h*1e3,this.audio.paused||this.audio.pause()),this.resetConfig(),!0},pickAudioTag:function(){if(this.audio)return!0;for(var a=0;a<this.tags.length;a++){var h=this.tags[a];if(h.dataset.used==="false")return h.dataset.used="true",this.audio=h,!0}if(!this.manager.override)return!1;var l=[];this.manager.forEachActiveSound(function(d){d.key===this.key&&d.audio&&l.push(d)},this),l.sort(function(d,p){return d.loop===p.loop?p.seek/p.duration-d.seek/d.duration:d.loop?1:-1});var u=l[0];return this.audio=u.audio,u.reset(),u.audio=null,u.startTime=0,u.previousTime=0,!0},playCatchPromise:function(){var a=this.audio.play();a&&a.catch(function(h){})},stopAndReleaseAudioTag:function(){this.startTime=0,this.previousTime=0,this.audio&&(this.audio.pause(),this.audio.dataset.used="false",this.audio=null)},reset:function(){i.prototype.stop.call(this)},onBlur:function(){this.isPlaying=!1,this.isPaused=!0,this.currentConfig.seek=this.audio.currentTime-(this.currentMarker?this.currentMarker.start:0),this.currentConfig.delay=Math.max(0,(this.startTime-window.performance.now())/1e3),this.stopAndReleaseAudioTag()},onFocus:function(){this.isPlaying=!0,this.isPaused=!1,this.pickAndPlayAudioTag()},update:function(a){if(this.isPlaying){if(this.startTime>0){this.startTime<a-this.manager.audioPlayDelay&&(this.audio.currentTime+=Math.max(0,a-this.startTime)/1e3,this.startTime=0,this.previousTime=this.audio.currentTime,this.playCatchPromise());return}var h=this.currentMarker?this.currentMarker.start:0,l=h+this.duration,u=this.audio.currentTime;if(this.currentConfig.loop)u>=l-this.manager.loopEndOffset?(this.audio.currentTime=h+Math.max(0,u-l),u=this.audio.currentTime):u<h&&(this.audio.currentTime+=h,u=this.audio.currentTime),u<this.previousTime&&this.emit(n.LOOPED,this);else if(u>=l){this.reset(),this.stopAndReleaseAudioTag(),this.emit(n.COMPLETE,this);return}this.previousTime=u}},destroy:function(){i.prototype.destroy.call(this),this.tags=null,this.audio&&this.stopAndReleaseAudioTag()},updateMute:function(){this.audio&&(this.audio.muted=this.currentConfig.mute||this.manager.mute)},updateVolume:function(){this.audio&&(this.audio.volume=r(this.currentConfig.volume*this.manager.volume,0,1))},calculateRate:function(){i.prototype.calculateRate.call(this),this.audio&&(this.audio.playbackRate=this.totalRate)},mute:{get:function(){return this.currentConfig.mute},set:function(a){this.currentConfig.mute=a,!this.manager.isLocked(this,"mute",a)&&(this.updateMute(),this.emit(n.MUTE,this,a))}},setMute:function(a){return this.mute=a,this},volume:{get:function(){return this.currentConfig.volume},set:function(a){this.currentConfig.volume=a,!this.manager.isLocked(this,"volume",a)&&(this.updateVolume(),this.emit(n.VOLUME,this,a))}},setVolume:function(a){return this.volume=a,this},rate:{get:function(){return this.currentConfig.rate},set:function(a){this.currentConfig.rate=a,!this.manager.isLocked(this,n.RATE,a)&&(this.calculateRate(),this.emit(n.RATE,this,a))}},setRate:function(a){return this.rate=a,this},detune:{get:function(){return this.currentConfig.detune},set:function(a){this.currentConfig.detune=a,!this.manager.isLocked(this,n.DETUNE,a)&&(this.calculateRate(),this.emit(n.DETUNE,this,a))}},setDetune:function(a){return this.detune=a,this},seek:{get:function(){return this.isPlaying?this.audio.currentTime-(this.currentMarker?this.currentMarker.start:0):this.isPaused?this.currentConfig.seek:0},set:function(a){this.manager.isLocked(this,"seek",a)||this.startTime>0||(this.isPlaying||this.isPaused)&&(a=Math.min(Math.max(0,a),this.duration),this.isPlaying?(this.previousTime=a,this.audio.currentTime=a):this.isPaused&&(this.currentConfig.seek=a),this.emit(n.SEEK,this,a))}},setSeek:function(a){return this.seek=a,this},loop:{get:function(){return this.currentConfig.loop},set:function(a){this.currentConfig.loop=a,!this.manager.isLocked(this,"loop",a)&&(this.audio&&(this.audio.loop=a),this.emit(n.LOOP,this,a))}},setLoop:function(a){return this.loop=a,this},pan:{get:function(){return this.currentConfig.pan},set:function(a){this.currentConfig.pan=a,this.emit(n.PAN,this,a)}},setPan:function(a){return this.pan=a,this}});t.exports=o}),dc=y((e,t)=>{var i=zn(),s=W(),n=Pi(),r=cc(),o=new s({Extends:i,initialize:function(a){this.override=!0,this.audioPlayDelay=.1,this.loopEndOffset=.05,this.onBlurPausedSounds=[],this.locked="ontouchstart"in window,this.lockedActionsQueue=this.locked?[]:null,this._mute=!1,this._volume=1,i.call(this,a)},add:function(a,h){var l=new r(this,a,h);return this.sounds.push(l),l},unlock:function(){this.locked=!1;var a=this;if(this.game.cache.audio.entries.each(function(d,p){for(var g=0;g<p.length;g++)if(p[g].dataset.locked==="true")return a.locked=!0,!1;return!0}),!!this.locked){var h=!1,l=function(){h=!0},u=function(){if(h){h=!1;return}document.body.removeEventListener("touchmove",l),document.body.removeEventListener("touchend",u);var d=[];if(a.game.cache.audio.entries.each(function(g,c){for(var f=0;f<c.length;f++){var m=c[f];m.dataset.locked==="true"&&d.push(m)}return!0}),d.length!==0){var p=d[d.length-1];p.oncanplaythrough=function(){p.oncanplaythrough=null,d.forEach(function(g){g.dataset.locked="false"}),a.unlocked=!0},d.forEach(function(g){g.load()})}};this.once(n.UNLOCKED,function(){for(this.forEachActiveSound(function(p){p.currentMarker===null&&p.duration===0&&(p.duration=p.tags[0].duration),p.totalDuration=p.tags[0].duration});this.lockedActionsQueue.length;){var d=this.lockedActionsQueue.shift();d.sound[d.prop].apply?d.sound[d.prop].apply(d.sound,d.value||[]):d.sound[d.prop]=d.value}},this),document.body.addEventListener("touchmove",l,!1),document.body.addEventListener("touchend",u,!1)}},onBlur:function(){this.forEachActiveSound(function(a){a.isPlaying&&(this.onBlurPausedSounds.push(a),a.onBlur())})},onFocus:function(){this.onBlurPausedSounds.forEach(function(a){a.onFocus()}),this.onBlurPausedSounds.length=0},destroy:function(){i.prototype.destroy.call(this),this.onBlurPausedSounds.length=0,this.onBlurPausedSounds=null},isLocked:function(a,h,l){return a.tags[0].dataset.locked==="true"?(this.lockedActionsQueue.push({sound:a,prop:h,value:l}),!0):!1},setMute:function(a){return this.mute=a,this},mute:{get:function(){return this._mute},set:function(a){this._mute=a,this.forEachActiveSound(function(h){h.updateMute()}),this.emit(n.GLOBAL_MUTE,this,a)}},setVolume:function(a){return this.volume=a,this},volume:{get:function(){return this._volume},set:function(a){this._volume=a,this.forEachActiveSound(function(h){h.updateVolume()}),this.emit(n.GLOBAL_VOLUME,this,a)}}});t.exports=o}),pc=y((e,t)=>{var i=Wn(),s=W(),n=Ct(),r=Qt(),o=Rt(),a=function(){return!1},h=function(){return null},l=function(){return this},u=new s({Extends:n,initialize:function(d,p,g){g===void 0&&(g={}),n.call(this),this.manager=d,this.key=p,this.isPlaying=!1,this.isPaused=!1,this.totalRate=1,this.duration=0,this.totalDuration=0,this.config=r({mute:!1,volume:1,rate:1,detune:0,seek:0,loop:!1,delay:0,pan:0},g),this.currentConfig=this.config,this.mute=!1,this.volume=1,this.rate=1,this.detune=0,this.seek=0,this.loop=!1,this.pan=0,this.markers={},this.currentMarker=null,this.pendingRemove=!1},addMarker:a,updateMarker:a,removeMarker:h,play:a,pause:a,resume:a,stop:a,setMute:l,setVolume:l,setRate:l,setDetune:l,setSeek:l,setLoop:l,setPan:l,applyConfig:h,resetConfig:h,update:o,calculateRate:h,destroy:function(){i.prototype.destroy.call(this)}});t.exports=u}),gc=y((e,t)=>{var i=zn(),s=W(),n=Ct(),r=pc(),o=Rt(),a=new s({Extends:n,initialize:function(h){n.call(this),this.game=h,this.sounds=[],this.mute=!1,this.volume=1,this.rate=1,this.detune=0,this.pauseOnBlur=!0,this.locked=!1},add:function(h,l){var u=new r(this,h,l);return this.sounds.push(u),u},addAudioSprite:function(h,l){var u=this.add(h,l);return u.spritemap={},u},get:function(h){return i.prototype.get.call(this,h)},getAll:function(h){return i.prototype.getAll.call(this,h)},play:function(h,l){return!1},playAudioSprite:function(h,l,u){return!1},remove:function(h){return i.prototype.remove.call(this,h)},removeAll:function(){return i.prototype.removeAll.call(this)},removeByKey:function(h){return i.prototype.removeByKey.call(this,h)},stopByKey:function(h){return i.prototype.stopByKey.call(this,h)},onBlur:o,onFocus:o,onGameBlur:o,onGameFocus:o,pauseAll:o,resumeAll:o,stopAll:o,update:o,setRate:o,setDetune:o,setMute:o,setVolume:o,unlock:o,forEachActiveSound:function(h,l){i.prototype.forEachActiveSound.call(this,h,l)},destroy:function(){i.prototype.destroy.call(this)}});t.exports=a}),fc=y((e,t)=>{var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=new Uint8Array(256);for(n=0;n<i.length;n++)s[i.charCodeAt(n)]=n;var n,r=function(o){o=o.substr(o.indexOf(",")+1);var a=o.length,h=a*.75,l=0,u,d,p,g;o[a-1]==="="&&(h--,o[a-2]==="="&&h--);for(var c=new ArrayBuffer(h),f=new Uint8Array(c),m=0;m<a;m+=4)u=s[o.charCodeAt(m)],d=s[o.charCodeAt(m+1)],p=s[o.charCodeAt(m+2)],g=s[o.charCodeAt(m+3)],f[l++]=u<<2|d>>4,f[l++]=(d&15)<<4|p>>2,f[l++]=(p&3)<<6|g&63;return c};t.exports=r}),mc=y((e,t)=>{var i=Wn(),s=W(),n=Pi(),r=dt(),o=new s({Extends:i,initialize:function(a,h,l){if(l===void 0&&(l={}),this.audioBuffer=a.game.cache.audio.get(h),!this.audioBuffer)throw new Error('Audio key "'+h+'" not found in cache');this.source=null,this.loopSource=null,this.muteNode=a.context.createGain(),this.volumeNode=a.context.createGain(),this.pannerNode=null,this.spatialNode=null,this.spatialSource=null,this.playTime=0,this.startTime=0,this.loopTime=0,this.rateUpdates=[],this.hasEnded=!1,this.hasLooped=!1,this.muteNode.connect(this.volumeNode),a.context.createPanner&&(this.spatialNode=a.context.createPanner(),this.volumeNode.connect(this.spatialNode)),a.context.createStereoPanner?(this.pannerNode=a.context.createStereoPanner(),a.context.createPanner?this.spatialNode.connect(this.pannerNode):this.volumeNode.connect(this.pannerNode),this.pannerNode.connect(a.destination)):a.context.createPanner?this.spatialNode.connect(a.destination):this.volumeNode.connect(a.destination),this.duration=this.audioBuffer.duration,this.totalDuration=this.audioBuffer.duration,i.call(this,a,h,l)},play:function(a,h){return i.prototype.play.call(this,a,h)?(this.stopAndRemoveBufferSource(),this.createAndStartBufferSource(),this.emit(n.PLAY,this),!0):!1},pause:function(){return this.manager.context.currentTime<this.startTime||!i.prototype.pause.call(this)?!1:(this.currentConfig.seek=this.getCurrentTime(),this.stopAndRemoveBufferSource(),this.emit(n.PAUSE,this),!0)},resume:function(){return this.manager.context.currentTime<this.startTime||!i.prototype.resume.call(this)?!1:(this.createAndStartBufferSource(),this.emit(n.RESUME,this),!0)},stop:function(){return i.prototype.stop.call(this)?(this.stopAndRemoveBufferSource(),this.emit(n.STOP,this),!0):!1},createAndStartBufferSource:function(){var a=this.currentConfig.seek,h=this.currentConfig.delay,l=this.manager.context.currentTime+h,u=(this.currentMarker?this.currentMarker.start:0)+a,d=this.duration-a;this.playTime=l-a,this.startTime=l,this.source=this.createBufferSource(),this.applyConfig(),this.source.start(Math.max(0,l),Math.max(0,u),Math.max(0,d)),this.resetConfig()},createAndStartLoopBufferSource:function(){var a=this.getLoopTime(),h=this.currentMarker?this.currentMarker.start:0,l=this.duration;this.loopTime=a,this.loopSource=this.createBufferSource(),this.loopSource.playbackRate.setValueAtTime(this.totalRate,0),this.loopSource.start(Math.max(0,a),Math.max(0,h),Math.max(0,l))},createBufferSource:function(){var a=this,h=this.manager.context.createBufferSource();return h.buffer=this.audioBuffer,h.connect(this.muteNode),h.onended=function(l){var u=l.target;(u===a.source||u===a.loopSource)&&(a.currentConfig.loop?a.hasLooped=!0:a.hasEnded=!0)},h},stopAndRemoveBufferSource:function(){if(this.source){var a=this.source;this.source=null,a.stop(),a.disconnect()}this.playTime=0,this.startTime=0,this.hasEnded=!1,this.stopAndRemoveLoopBufferSource()},stopAndRemoveLoopBufferSource:function(){this.loopSource&&(this.loopSource.stop(),this.loopSource.disconnect(),this.loopSource=null),this.loopTime=0},applyConfig:function(){this.rateUpdates.length=0,this.rateUpdates.push({time:0,rate:1});var a=this.currentConfig.source;if(a&&this.manager.context.createPanner){var h=this.spatialNode;h.panningModel=r(a,"panningModel","equalpower"),h.distanceModel=r(a,"distanceModel","inverse"),h.orientationX.value=r(a,"orientationX",0),h.orientationY.value=r(a,"orientationY",0),h.orientationZ.value=r(a,"orientationZ",-1),h.refDistance=r(a,"refDistance",1),h.maxDistance=r(a,"maxDistance",1e4),h.rolloffFactor=r(a,"rolloffFactor",1),h.coneInnerAngle=r(a,"coneInnerAngle",360),h.coneOuterAngle=r(a,"coneOuterAngle",0),h.coneOuterGain=r(a,"coneOuterGain",0),this.spatialSource=r(a,"follow",null),this.spatialSource||(h.positionX.value=r(a,"x",0),h.positionY.value=r(a,"y",0),h.positionZ.value=r(a,"z",0))}i.prototype.applyConfig.call(this)},x:{get:function(){return this.spatialNode?this.spatialNode.positionX:0},set:function(a){this.spatialNode&&(this.spatialNode.positionX.value=a)}},y:{get:function(){return this.spatialNode?this.spatialNode.positionY:0},set:function(a){this.spatialNode&&(this.spatialNode.positionY.value=a)}},update:function(){if(this.isPlaying&&this.spatialSource){var a=r(this.spatialSource,"x",null),h=r(this.spatialSource,"y",null);a&&a!==this._spatialx&&(this._spatialx=this.spatialNode.positionX.value=a),h&&h!==this._spatialy&&(this._spatialy=this.spatialNode.positionY.value=h)}this.hasEnded?(i.prototype.stop.call(this),this.stopAndRemoveBufferSource(),this.emit(n.COMPLETE,this)):this.hasLooped&&(this.hasLooped=!1,this.source=this.loopSource,this.loopSource=null,this.playTime=this.startTime=this.loopTime,this.rateUpdates.length=0,this.rateUpdates.push({time:0,rate:this.totalRate}),this.createAndStartLoopBufferSource(),this.emit(n.LOOPED,this))},destroy:function(){this.pendingRemove||(i.prototype.destroy.call(this),this.audioBuffer=null,this.stopAndRemoveBufferSource(),this.muteNode.disconnect(),this.muteNode=null,this.volumeNode.disconnect(),this.volumeNode=null,this.pannerNode&&(this.pannerNode.disconnect(),this.pannerNode=null),this.spatialNode&&(this.spatialNode.disconnect(),this.spatialNode=null,this.spatialSource=null),this.rateUpdates.length=0,this.rateUpdates=null)},calculateRate:function(){i.prototype.calculateRate.call(this);var a=this.manager.context.currentTime;this.source&&typeof this.totalRate=="number"&&this.source.playbackRate.setValueAtTime(this.totalRate,a),this.isPlaying&&(this.rateUpdates.push({time:Math.max(this.startTime,a)-this.playTime,rate:this.totalRate}),this.loopSource&&(this.stopAndRemoveLoopBufferSource(),this.createAndStartLoopBufferSource()))},getCurrentTime:function(){for(var a=0,h=0;h<this.rateUpdates.length;h++){var l=0;h<this.rateUpdates.length-1?l=this.rateUpdates[h+1].time:l=this.manager.context.currentTime-this.playTime,a+=(l-this.rateUpdates[h].time)*this.rateUpdates[h].rate}return a},getLoopTime:function(){for(var a=0,h=0;h<this.rateUpdates.length-1;h++)a+=(this.rateUpdates[h+1].time-this.rateUpdates[h].time)*this.rateUpdates[h].rate;var l=this.rateUpdates[this.rateUpdates.length-1];return this.playTime+l.time+(this.duration-a)/l.rate},rate:{get:function(){return this.currentConfig.rate},set:function(a){this.currentConfig.rate=a,this.calculateRate(),this.emit(n.RATE,this,a)}},setRate:function(a){return this.rate=a,this},detune:{get:function(){return this.currentConfig.detune},set:function(a){this.currentConfig.detune=a,this.calculateRate(),this.emit(n.DETUNE,this,a)}},setDetune:function(a){return this.detune=a,this},mute:{get:function(){return this.muteNode.gain.value===0},set:function(a){this.currentConfig.mute=a,this.muteNode.gain.setValueAtTime(a?0:1,0),this.emit(n.MUTE,this,a)}},setMute:function(a){return this.mute=a,this},volume:{get:function(){return this.volumeNode.gain.value},set:function(a){this.currentConfig.volume=a,this.volumeNode.gain.setValueAtTime(a,0),this.emit(n.VOLUME,this,a)}},setVolume:function(a){return this.volume=a,this},seek:{get:function(){return this.isPlaying?this.manager.context.currentTime<this.startTime?this.startTime-this.playTime:this.getCurrentTime():this.isPaused?this.currentConfig.seek:0},set:function(a){this.manager.context.currentTime<this.startTime||(this.isPlaying||this.isPaused)&&(a=Math.min(Math.max(0,a),this.duration),this.currentConfig.seek=a,this.isPlaying&&(this.stopAndRemoveBufferSource(),this.createAndStartBufferSource()),this.emit(n.SEEK,this,a))}},setSeek:function(a){return this.seek=a,this},loop:{get:function(){return this.currentConfig.loop},set:function(a){this.currentConfig.loop=a,this.isPlaying&&(this.stopAndRemoveLoopBufferSource(),a&&this.createAndStartLoopBufferSource()),this.emit(n.LOOP,this,a)}},setLoop:function(a){return this.loop=a,this},pan:{get:function(){return this.pannerNode?this.pannerNode.pan.value:0},set:function(a){this.currentConfig.pan=a,this.pannerNode&&this.pannerNode.pan.setValueAtTime(a,this.manager.context.currentTime),this.emit(n.PAN,this,a)}},setPan:function(a){return this.pan=a,this}});t.exports=o}),vc=y((e,t)=>{var i=fc(),s=zn(),n=W(),r=Pi(),o=$t(),a=mc(),h=dt(),l=new n({Extends:s,initialize:function(u){this.context=this.createAudioContext(u),this.masterMuteNode=this.context.createGain(),this.masterVolumeNode=this.context.createGain(),this.masterMuteNode.connect(this.masterVolumeNode),this.masterVolumeNode.connect(this.context.destination),this.destination=this.masterMuteNode,this.locked=this.context.state==="suspended",s.call(this,u),this.locked&&(u.isBooted?this.unlock():u.events.once(o.BOOT,this.unlock,this)),u.events.on(o.VISIBLE,this.onGameVisible,this)},onGameVisible:function(){var u=this.context;window.setTimeout(function(){u&&(u.suspend(),u.resume())},100)},createAudioContext:function(u){var d=u.config.audio;if(d.context)return d.context.resume(),d.context;if(window.hasOwnProperty("AudioContext"))return new AudioContext;if(window.hasOwnProperty("webkitAudioContext"))return new window.webkitAudioContext},setAudioContext:function(u){return this.context&&this.context.close(),this.masterMuteNode&&this.masterMuteNode.disconnect(),this.masterVolumeNode&&this.masterVolumeNode.disconnect(),this.context=u,this.masterMuteNode=u.createGain(),this.masterVolumeNode=u.createGain(),this.masterMuteNode.connect(this.masterVolumeNode),this.masterVolumeNode.connect(u.destination),this.destination=this.masterMuteNode,this},add:function(u,d){var p=new a(this,u,d);return this.sounds.push(p),p},decodeAudio:function(u,d){var p;Array.isArray(u)?p=u:p=[{key:u,data:d}];for(var g=this.game.cache.audio,c=p.length,f=0;f<p.length;f++){var m=p[f],v=m.key,E=m.data;typeof E=="string"&&(E=i(E));var x=function(A,P){g.add(A,P),this.emit(r.DECODED,A),c--,c===0&&this.emit(r.DECODED_ALL)}.bind(this,v),T=function(A,P){c--,c===0&&this.emit(r.DECODED_ALL)}.bind(this,v);this.context.decodeAudioData(E,x,T)}},setListenerPosition:function(u,d){return u===void 0&&(u=this.game.scale.width/2),d===void 0&&(d=this.game.scale.height/2),this.listenerPosition.set(u,d),this},unlock:function(){var u=this,d=document.body,p=function g(){if(u.context&&d){var c=d.removeEventListener.bind(d);u.context.resume().then(function(){c("touchstart",g),c("touchend",g),c("mousedown",g),c("mouseup",g),c("keydown",g),u.unlocked=!0},function(){c("touchstart",g),c("touchend",g),c("mousedown",g),c("mouseup",g),c("keydown",g)})}};d&&(d.addEventListener("touchstart",p,!1),d.addEventListener("touchend",p,!1),d.addEventListener("mousedown",p,!1),d.addEventListener("mouseup",p,!1),d.addEventListener("keydown",p,!1))},onBlur:function(){this.locked||this.context.suspend()},onFocus:function(){var u=this.context;u&&!this.locked&&(u.state==="suspended"||u.state==="interrupted")&&u.resume()},update:function(u,d){var p=this.context.listener;if(p&&p.positionX!==void 0){var g=h(this.listenerPosition,"x",null),c=h(this.listenerPosition,"y",null);g&&g!==this._spatialx&&(this._spatialx=p.positionX.value=g),c&&c!==this._spatialy&&(this._spatialy=p.positionY.value=c)}s.prototype.update.call(this,u,d),this.gameLostFocus||this.onFocus()},destroy:function(){if(this.destination=null,this.masterVolumeNode.disconnect(),this.masterVolumeNode=null,this.masterMuteNode.disconnect(),this.masterMuteNode=null,this.game.config.audio.context)this.context.suspend();else{var u=this;this.context.close().then(function(){u.context=null})}this.game.events.off(o.VISIBLE,this.onGameVisible,this),s.prototype.destroy.call(this)},setMute:function(u){return this.mute=u,this},mute:{get:function(){return this.masterMuteNode.gain.value===0},set:function(u){this.masterMuteNode.gain.setValueAtTime(u?0:1,0),this.emit(r.GLOBAL_MUTE,this,u)}},setVolume:function(u){return this.volume=u,this},volume:{get:function(){return this.masterVolumeNode.gain.value},set:function(u){this.masterVolumeNode.gain.setValueAtTime(u,0),this.emit(r.GLOBAL_VOLUME,this,u)}}});t.exports=l}),Ec=y((e,t)=>{var i=dc(),s=gc(),n=vc(),r={create:function(o){var a=o.config.audio,h=o.device.audio;return a.noAudio||!h.webAudio&&!h.audioData?new s(o):h.webAudio&&!a.disableWebAudio?new n(o):new i(o)}};t.exports=r}),Ix=y((e,t)=>{var i=Ta(),s=dh(),n=xl(),r=xe(),o=W(),a=Yl(),h=Fy(),l=Lu(),u=In(),d=Du(),p=An(),g=Ny(),c=Ct(),f=$t(),m=Ku(),v=he(),E=_T(),x=$u(),T=rc(),A=ks(),P=uc(),R=ku(),S=Fu();I=Ec();var I,w=new o({initialize:function(C){this.config=new a(C),this.renderer=null,this.domContainer=null,this.canvas=null,this.context=null,this.isBooted=!1,this.isRunning=!1,this.events=new c,this.anims=new s(this),this.textures=new P(this),this.cache=new n(this),this.registry=new u(this,new c),this.input=new m(this,this.config),this.scene=new T(this,this.config.sceneConfig),this.device=p,this.scale=new x(this,this.config),this.sound=null,this.sound=I.create(this),this.loop=new R(this,this.config.fps),this.plugins=new E(this,this.config),this.pendingDestroy=!1,this.removeCanvas=!1,this.noReturn=!1,this.hasFocus=!1,this.isPaused=!1,g(this.boot.bind(this))},boot:function(){v.hasCore("EventEmitter")&&(this.isBooted=!0,this.config.preBoot(this),this.scale.preBoot(),l(this),h(this),d(this),i(this.canvas,this.config.parent),this.textures.once(A.READY,this.texturesReady,this),this.events.emit(f.BOOT),window&&(window.PHASER_GAME=this))},texturesReady:function(){this.events.emit(f.READY),this.start()},start:function(){this.isRunning=!0,this.config.postBoot(this),this.renderer?this.loop.start(this.step.bind(this)):this.loop.start(this.headlessStep.bind(this)),S(this);var C=this.events;C.on(f.HIDDEN,this.onHidden,this),C.on(f.VISIBLE,this.onVisible,this),C.on(f.BLUR,this.onBlur,this),C.on(f.FOCUS,this.onFocus,this)},step:function(C,_){if(this.pendingDestroy)return this.runDestroy();if(!this.isPaused){var O=this.events;O.emit(f.PRE_STEP,C,_),O.emit(f.STEP,C,_),this.scene.update(C,_),O.emit(f.POST_STEP,C,_);var D=this.renderer;D.preRender(),O.emit(f.PRE_RENDER,D,C,_),this.scene.render(D),D.postRender(),O.emit(f.POST_RENDER,D,C,_)}},headlessStep:function(C,_){if(this.pendingDestroy)return this.runDestroy();if(!this.isPaused){var O=this.events;O.emit(f.PRE_STEP,C,_),O.emit(f.STEP,C,_),this.scene.update(C,_),O.emit(f.POST_STEP,C,_),this.scene.isProcessing=!1,O.emit(f.PRE_RENDER,null,C,_),O.emit(f.POST_RENDER,null,C,_)}},onHidden:function(){this.loop.pause(),this.events.emit(f.PAUSE)},pause:function(){var C=this.isPaused;this.isPaused=!0,C||this.events.emit(f.PAUSE)},onVisible:function(){this.loop.resume(),this.events.emit(f.RESUME,this.loop.pauseDuration)},resume:function(){var C=this.isPaused;this.isPaused=!1,C&&this.events.emit(f.RESUME,0)},onBlur:function(){this.hasFocus=!1,this.loop.blur()},onFocus:function(){this.hasFocus=!0,this.loop.focus()},getFrame:function(){return this.loop.frame},getTime:function(){return this.loop.now},destroy:function(C,_){_===void 0&&(_=!1),this.pendingDestroy=!0,this.removeCanvas=C,this.noReturn=_},runDestroy:function(){this.scene.destroy(),this.events.emit(f.DESTROY),this.events.removeAllListeners(),this.renderer&&this.renderer.destroy(),this.removeCanvas&&this.canvas&&(r.remove(this.canvas),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)),this.domContainer&&this.domContainer.parentNode&&this.domContainer.parentNode.removeChild(this.domContainer),this.loop.destroy(),this.pendingDestroy=!1}});t.exports=w}),_x=y((e,t)=>{var i=function(s){return s.radius>0?Math.PI*s.radius*s.radius:0};t.exports=i}),Ox=y((e,t)=>{var i=yn(),s=function(n){return new i(n.x,n.y,n.radius)};t.exports=s}),Mx=y((e,t)=>{var i=Ni(),s=function(n,r){return i(n,r.x,r.y)};t.exports=s}),Lx=y((e,t)=>{var i=Ni(),s=function(n,r){return i(n,r.x,r.y)&&i(n,r.right,r.y)&&i(n,r.x,r.bottom)&&i(n,r.right,r.bottom)};t.exports=s}),Dx=y((e,t)=>{var i=function(s,n){return n.setTo(s.x,s.y,s.radius)};t.exports=i}),kx=y((e,t)=>{var i=function(s,n){return s.x===n.x&&s.y===n.y&&s.radius===n.radius};t.exports=i}),Fx=y((e,t)=>{var i=Ut(),s=function(n,r){return r===void 0&&(r=new i),r.x=n.left,r.y=n.top,r.width=n.diameter,r.height=n.diameter,r};t.exports=s}),Nx=y((e,t)=>{var i=function(s,n,r){return s.x+=n,s.y+=r,s};t.exports=i}),Bx=y((e,t)=>{var i=function(s,n){return s.x+=n.x,s.y+=n.y,s};t.exports=i}),Ux=y((e,t)=>{var i=yn();i.Area=_x(),i.Circumference=Nh(),i.CircumferencePoint=Hr(),i.Clone=Ox(),i.Contains=Ni(),i.ContainsPoint=Mx(),i.ContainsRect=Lx(),i.CopyFrom=Dx(),i.Equals=kx(),i.GetBounds=Fx(),i.GetPoint=Fh(),i.GetPoints=Bh(),i.Offset=Nx(),i.OffsetPoint=Bx(),i.Random=zr(),t.exports=i}),Ki=y((e,t)=>{var i=function(s){return Math.atan2(s.y2-s.y1,s.x2-s.x1)};t.exports=i}),Gx=y((e,t)=>{var i=function(s,n,r){var o=n-(s.x1+s.x2)/2,a=r-(s.y1+s.y2)/2;return s.x1+=o,s.y1+=a,s.x2+=o,s.y2+=a,s};t.exports=i}),Yx=y((e,t)=>{var i=Rn(),s=function(n){return new i(n.x1,n.y1,n.x2,n.y2)};t.exports=s}),Hx=y((e,t)=>{var i=function(s,n){return n.setTo(s.x1,s.y1,s.x2,s.y2)};t.exports=i}),zx=y((e,t)=>{var i=function(s,n){return s.x1===n.x1&&s.y1===n.y1&&s.x2===n.x2&&s.y2===n.y2};t.exports=i}),Wx=y((e,t)=>{var i=Ps(),s=function(n,r,o){o===void 0&&(o=r);var a=i(n),h=n.x2-n.x1,l=n.y2-n.y1;return r&&(n.x1=n.x1-h/a*r,n.y1=n.y1-l/a*r),o&&(n.x2=n.x2+h/a*o,n.y2=n.y2+l/a*o),n};t.exports=s}),Vx=y((e,t)=>{var i=Mt(),s=function(n,r){return r===void 0&&(r=new i),r.x=(n.x1+n.x2)/2,r.y=(n.y1+n.y2)/2,r};t.exports=s}),Xx=y((e,t)=>{var i=Mt(),s=function(n,r,o){o===void 0&&(o=new i);var a=n.x1,h=n.y1,l=n.x2,u=n.y2,d=(l-a)*(l-a)+(u-h)*(u-h);if(d===0)return o;var p=((r.x-a)*(l-a)+(r.y-h)*(u-h))/d;return o.x=a+p*(l-a),o.y=h+p*(u-h),o};t.exports=s}),Kx=y((e,t)=>{var i=Gt(),s=Ki(),n=Mt(),r=function(o,a){a===void 0&&(a=new n);var h=s(o)-i.TAU;return a.x=Math.cos(h),a.y=Math.sin(h),a};t.exports=r}),jx=y((e,t)=>{var i=function(s,n){var r=s.x1,o=s.y1,a=s.x2,h=s.y2,l=(a-r)*(a-r)+(h-o)*(h-o);if(l===0)return!1;var u=((o-n.y)*(a-r)-(r-n.x)*(h-o))/l;return Math.abs(u)*Math.sqrt(l)};t.exports=i}),Zx=y((e,t)=>{var i=function(s){return Math.abs(s.y1-s.y2)};t.exports=i}),yc=y((e,t)=>{var i=Gt(),s=Ai(),n=Ki(),r=function(o){var a=n(o)-i.TAU;return s(a,-Math.PI,Math.PI)};t.exports=r}),qx=y((e,t)=>{var i=Gt(),s=Ki(),n=function(r){return Math.cos(s(r)-i.TAU)};t.exports=n}),Jx=y((e,t)=>{var i=Gt(),s=Ki(),n=function(r){return Math.sin(s(r)-i.TAU)};t.exports=n}),Qx=y((e,t)=>{var i=function(s,n,r){return s.x1+=n,s.y1+=r,s.x2+=n,s.y2+=r,s};t.exports=i}),$x=y((e,t)=>{var i=function(s){return-((s.x2-s.x1)/(s.y2-s.y1))};t.exports=i}),tS=y((e,t)=>{var i=Ki(),s=yc(),n=function(r,o){return 2*s(o)-Math.PI-i(r)};t.exports=n}),wa=y((e,t)=>{var i=function(s,n,r,o){var a=Math.cos(o),h=Math.sin(o),l=s.x1-n,u=s.y1-r;return s.x1=l*a-u*h+n,s.y1=l*h+u*a+r,l=s.x2-n,u=s.y2-r,s.x2=l*a-u*h+n,s.y2=l*h+u*a+r,s};t.exports=i}),eS=y((e,t)=>{var i=wa(),s=function(n,r){var o=(n.x1+n.x2)/2,a=(n.y1+n.y2)/2;return i(n,o,a,r)};t.exports=s}),iS=y((e,t)=>{var i=wa(),s=function(n,r,o){return i(n,r.x,r.y,o)};t.exports=s}),sS=y((e,t)=>{var i=function(s,n,r,o,a){return s.x1=n,s.y1=r,s.x2=n+Math.cos(o)*a,s.y2=r+Math.sin(o)*a,s};t.exports=i}),nS=y((e,t)=>{var i=function(s){return(s.y2-s.y1)/(s.x2-s.x1)};t.exports=i}),rS=y((e,t)=>{var i=function(s){return Math.abs(s.x1-s.x2)};t.exports=i}),aS=y((e,t)=>{var i=Rn();i.Angle=Ki(),i.BresenhamPoints=fl(),i.CenterOn=Gx(),i.Clone=Yx(),i.CopyFrom=Hx(),i.Equals=zx(),i.Extend=Wx(),i.GetEasedPoints=pl(),i.GetMidPoint=Vx(),i.GetNearestPoint=Xx(),i.GetNormal=Kx(),i.GetPoint=jh(),i.GetPoints=Qr(),i.GetShortestDistance=jx(),i.Height=Zx(),i.Length=Ps(),i.NormalAngle=yc(),i.NormalX=qx(),i.NormalY=Jx(),i.Offset=Qx(),i.PerpSlope=$x(),i.Random=$r(),i.ReflectAngle=tS(),i.Rotate=eS(),i.RotateAroundPoint=iS(),i.RotateAroundXY=wa(),i.SetToAngle=sS(),i.Slope=nS(),i.Width=rS(),t.exports=i}),oS=y((e,t)=>{var i=function(s){return s.width*s.height};t.exports=i}),hS=y((e,t)=>{var i=function(s){return s.x=Math.ceil(s.x),s.y=Math.ceil(s.y),s};t.exports=i}),lS=y((e,t)=>{var i=function(s){return s.x=Math.ceil(s.x),s.y=Math.ceil(s.y),s.width=Math.ceil(s.width),s.height=Math.ceil(s.height),s};t.exports=i}),uS=y((e,t)=>{var i=Ut(),s=function(n){return new i(n.x,n.y,n.width,n.height)};t.exports=s}),cS=y((e,t)=>{var i=Ui(),s=function(n,r){return i(n,r.x,r.y)};t.exports=s}),Tc=y((e,t)=>{var i=function(s,n){return n.width*n.height>s.width*s.height?!1:n.x>s.x&&n.x<s.right&&n.right>s.x&&n.right<s.right&&n.y>s.y&&n.y<s.bottom&&n.bottom>s.y&&n.bottom<s.bottom};t.exports=i}),xc=y((e,t)=>{var i=function(s,n){return n.setTo(s.x,s.y,s.width,s.height)};t.exports=i}),dS=y((e,t)=>{var i=function(s,n){return n===void 0&&(n=[]),n.push({x:s.x,y:s.y}),n.push({x:s.right,y:s.y}),n.push({x:s.right,y:s.bottom}),n.push({x:s.x,y:s.bottom}),n};t.exports=i}),pS=y((e,t)=>{var i=function(s,n){return s.x===n.x&&s.y===n.y&&s.width===n.width&&s.height===n.height};t.exports=i}),Ca=y((e,t)=>{var i=function(s){return s.height===0?NaN:s.width/s.height};t.exports=i}),gS=y((e,t)=>{var i=Ca(),s=function(n,r){var o=i(n);return o<i(r)?n.setSize(r.height*o,r.height):n.setSize(r.width,r.width/o),n.setPosition(r.centerX-n.width/2,r.centerY-n.height/2)};t.exports=s}),fS=y((e,t)=>{var i=Ca(),s=function(n,r){var o=i(n);return o>i(r)?n.setSize(r.height*o,r.height):n.setSize(r.width,r.width/o),n.setPosition(r.centerX-n.width/2,r.centerY-n.height/2)};t.exports=s}),mS=y((e,t)=>{var i=function(s){return s.x=Math.floor(s.x),s.y=Math.floor(s.y),s};t.exports=i}),vS=y((e,t)=>{var i=function(s){return s.x=Math.floor(s.x),s.y=Math.floor(s.y),s.width=Math.floor(s.width),s.height=Math.floor(s.height),s};t.exports=i}),ES=y((e,t)=>{var i=Ut(),s=function(n,r,o,a,h){return h===void 0&&(h=new i),h.setTo(Math.min(n,o),Math.min(r,a),Math.abs(n-o),Math.abs(r-a))};t.exports=s}),yS=y((e,t)=>{var i=Mt(),s=function(n,r){return r===void 0&&(r=new i),r.x=n.centerX,r.y=n.centerY,r};t.exports=s}),TS=y((e,t)=>{var i=Mt(),s=function(n,r){return r===void 0&&(r=new i),r.x=n.width,r.y=n.height,r};t.exports=s}),Sc=y((e,t)=>{var i=Ln(),s=function(n,r,o){var a=n.centerX,h=n.centerY;return n.setSize(n.width+r*2,n.height+o*2),i(n,a,h)};t.exports=s}),Pa=y((e,t)=>{var i=function(s,n){return s.width<=0||s.height<=0||n.width<=0||n.height<=0?!1:!(s.right<n.x||s.bottom<n.y||s.x>n.right||s.y>n.bottom)};t.exports=i}),xS=y((e,t)=>{var i=Ut(),s=Pa(),n=function(r,o,a){return a===void 0&&(a=new i),s(r,o)?(a.x=Math.max(r.x,o.x),a.y=Math.max(r.y,o.y),a.width=Math.min(r.right,o.right)-a.x,a.height=Math.min(r.bottom,o.bottom)-a.y):a.setEmpty(),a};t.exports=n}),SS=y((e,t)=>{var i=function(s,n){for(var r=s.x,o=s.right,a=s.y,h=s.bottom,l=0;l<n.length;l++)r=Math.min(r,n[l].x),o=Math.max(o,n[l].x),a=Math.min(a,n[l].y),h=Math.max(h,n[l].y);return s.x=r,s.y=a,s.width=o-r,s.height=h-a,s};t.exports=i}),Ac=y((e,t)=>{var i=function(s,n){var r=Math.min(s.x,n.x),o=Math.max(s.right,n.right);s.x=r,s.width=o-r;var a=Math.min(s.y,n.y),h=Math.max(s.bottom,n.bottom);return s.y=a,s.height=h-a,s};t.exports=i}),AS=y((e,t)=>{var i=function(s,n,r){var o=Math.min(s.x,n),a=Math.max(s.right,n);s.x=o,s.width=a-o;var h=Math.min(s.y,r),l=Math.max(s.bottom,r);return s.y=h,s.height=l-h,s};t.exports=i}),wS=y((e,t)=>{var i=function(s,n,r){return s.x+=n,s.y+=r,s};t.exports=i}),CS=y((e,t)=>{var i=function(s,n){return s.x+=n.x,s.y+=n.y,s};t.exports=i}),PS=y((e,t)=>{var i=function(s,n){return s.x<n.right&&s.right>n.x&&s.y<n.bottom&&s.bottom>n.y};t.exports=i}),RS=y((e,t)=>{var i=Mt(),s=Gi(),n=function(r,o,a){a===void 0&&(a=new i),o=s(o);var h=Math.sin(o),l=Math.cos(o),u=l>0?r.width/2:r.width/-2,d=h>0?r.height/2:r.height/-2;return Math.abs(u*h)<Math.abs(d*l)?d=u*h/l:u=d*l/h,a.x=u+r.centerX,a.y=d+r.centerY,a};t.exports=n}),bS=y((e,t)=>{var i=ys(),s=Tc(),n=Mt(),r=function(o,a,h){if(h===void 0&&(h=new n),s(o,a))switch(i(0,3)){case 0:h.x=o.x+Math.random()*(a.right-o.x),h.y=o.y+Math.random()*(a.top-o.y);break;case 1:h.x=a.x+Math.random()*(o.right-a.x),h.y=a.bottom+Math.random()*(o.bottom-a.bottom);break;case 2:h.x=o.x+Math.random()*(a.x-o.x),h.y=a.y+Math.random()*(o.bottom-a.y);break;case 3:h.x=a.right+Math.random()*(o.right-a.right),h.y=o.y+Math.random()*(a.bottom-o.y);break}return h};t.exports=r}),IS=y((e,t)=>{var i=function(s,n){return s.width===n.width&&s.height===n.height};t.exports=i}),_S=y((e,t)=>{var i=function(s,n,r){return r===void 0&&(r=n),s.width*=n,s.height*=r,s};t.exports=i}),wc=y((e,t)=>{var i=Ut(),s=function(n,r,o){o===void 0&&(o=new i);var a=Math.min(n.x,r.x),h=Math.min(n.y,r.y),l=Math.max(n.right,r.right)-a,u=Math.max(n.bottom,r.bottom)-h;return o.setTo(a,h,l,u)};t.exports=s}),OS=y((e,t)=>{var i=Ut();i.Area=oS(),i.Ceil=hS(),i.CeilAll=lS(),i.CenterOn=Ln(),i.Clone=uS(),i.Contains=Ui(),i.ContainsPoint=cS(),i.ContainsRect=Tc(),i.CopyFrom=xc(),i.Decompose=dS(),i.Equals=pS(),i.FitInside=gS(),i.FitOutside=fS(),i.Floor=mS(),i.FloorAll=vS(),i.FromPoints=ya(),i.FromXY=ES(),i.GetAspectRatio=Ca(),i.GetCenter=yS(),i.GetPoint=Jr(),i.GetPoints=Kh(),i.GetSize=TS(),i.Inflate=Sc(),i.Intersection=xS(),i.MarchingAnts=gl(),i.MergePoints=SS(),i.MergeRect=Ac(),i.MergeXY=AS(),i.Offset=wS(),i.OffsetPoint=CS(),i.Overlaps=PS(),i.Perimeter=Pn(),i.PerimeterPoint=RS(),i.Random=ea(),i.RandomOutside=bS(),i.SameDimensions=IS(),i.Scale=_S(),i.Union=wc(),t.exports=i}),Ra=y((e,t)=>{var i=Cn(),s=W(),n=Rt(),r=wn(),o=new s({initialize:function(a){this.parent=a,this.list=[],this.position=0,this.addCallback=n,this.removeCallback=n,this._sortKey=""},add:function(a,h){return h?i.Add(this.list,a):i.Add(this.list,a,0,this.addCallback,this)},addAt:function(a,h,l){return l?i.AddAt(this.list,a,h):i.AddAt(this.list,a,h,0,this.addCallback,this)},getAt:function(a){return this.list[a]},getIndex:function(a){return this.list.indexOf(a)},sort:function(a,h){return a?(h===void 0&&(h=function(l,u){return l[a]-u[a]}),r(this.list,h),this):this},getByName:function(a){return i.GetFirst(this.list,"name",a)},getRandom:function(a,h){return i.GetRandom(this.list,a,h)},getFirst:function(a,h,l,u){return i.GetFirst(this.list,a,h,l,u)},getAll:function(a,h,l,u){return i.GetAll(this.list,a,h,l,u)},count:function(a,h){return i.CountAllMatching(this.list,a,h)},swap:function(a,h){i.Swap(this.list,a,h)},moveTo:function(a,h){return i.MoveTo(this.list,a,h)},moveAbove:function(a,h){return i.MoveAbove(this.list,a,h)},moveBelow:function(a,h){return i.MoveBelow(this.list,a,h)},remove:function(a,h){return h?i.Remove(this.list,a):i.Remove(this.list,a,this.removeCallback,this)},removeAt:function(a,h){return h?i.RemoveAt(this.list,a):i.RemoveAt(this.list,a,this.removeCallback,this)},removeBetween:function(a,h,l){return l?i.RemoveBetween(this.list,a,h):i.RemoveBetween(this.list,a,h,this.removeCallback,this)},removeAll:function(a){for(var h=this.list.length;h--;)this.remove(this.list[h],a);return this},bringToTop:function(a){return i.BringToTop(this.list,a)},sendToBack:function(a){return i.SendToBack(this.list,a)},moveUp:function(a){return i.MoveUp(this.list,a),a},moveDown:function(a){return i.MoveDown(this.list,a),a},reverse:function(){return this.list.reverse(),this},shuffle:function(){return i.Shuffle(this.list),this},replace:function(a,h){return i.Replace(this.list,a,h)},exists:function(a){return this.list.indexOf(a)>-1},setAll:function(a,h,l,u){return i.SetAll(this.list,a,h,l,u),this},each:function(a,h){for(var l=[null],u=2;u<arguments.length;u++)l.push(arguments[u]);for(u=0;u<this.list.length;u++)l[0]=this.list[u],a.apply(h,l)},shutdown:function(){this.removeAll(),this.list=[]},destroy:function(){this.removeAll(),this.parent=null,this.addCallback=null,this.removeCallback=null},length:{get:function(){return this.list.length}},first:{get:function(){return this.position=0,this.list.length>0?this.list[0]:null}},last:{get:function(){return this.list.length>0?(this.position=this.list.length-1,this.list[this.position]):null}},next:{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}},previous:{get:function(){return this.position>0?(this.position--,this.list[this.position]):null}}});t.exports=o}),MS=y((e,t)=>{var i=W(),s=Ra(),n=he(),r=bs(),o=Vt(),a=wn(),h=new i({Extends:s,initialize:function(l){s.call(this,l),this.sortChildrenFlag=!1,this.scene=l,this.systems=l.sys,this.events=l.sys.events,this.addCallback=this.addChildCallback,this.removeCallback=this.removeChildCallback,this.events.once(o.BOOT,this.boot,this),this.events.on(o.START,this.start,this)},boot:function(){this.events.once(o.DESTROY,this.destroy,this)},addChildCallback:function(l){l.displayList&&l.displayList!==this&&l.removeFromDisplayList(),l.parentContainer&&l.parentContainer.remove(l),l.displayList||(this.queueDepthSort(),l.displayList=this,l.emit(r.ADDED_TO_SCENE,l,this.scene),this.events.emit(o.ADDED_TO_SCENE,l,this.scene))},removeChildCallback:function(l){this.queueDepthSort(),l.displayList=null,l.emit(r.REMOVED_FROM_SCENE,l,this.scene),this.events.emit(o.REMOVED_FROM_SCENE,l,this.scene)},start:function(){this.events.once(o.SHUTDOWN,this.shutdown,this)},queueDepthSort:function(){this.sortChildrenFlag=!0},depthSort:function(){this.sortChildrenFlag&&(a(this.list,this.sortByDepth),this.sortChildrenFlag=!1)},sortByDepth:function(l,u){return l._depth-u._depth},getChildren:function(){return this.list},shutdown:function(){for(var l=this.list,u=l.length;u--;)l[u].destroy(!0);l.length=0,this.events.off(o.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(o.START,this.start,this),this.scene=null,this.systems=null,this.events=null}});n.register("DisplayList",h,"displayList"),t.exports=h}),LS=y((e,t)=>{t.exports="add"}),DS=y((e,t)=>{t.exports="remove"}),kS=y((e,t)=>{t.exports={PROCESS_QUEUE_ADD:LS(),PROCESS_QUEUE_REMOVE:DS()}}),Cc=y((e,t)=>{var i=W(),s=Ct(),n=kS(),r=new i({Extends:s,initialize:function(){s.call(this),this._pending=[],this._active=[],this._destroy=[],this._toProcess=0,this.checkQueue=!1},isActive:function(o){return this._active.indexOf(o)>-1},isPending:function(o){return this._toProcess>0&&this._pending.indexOf(o)>-1},isDestroying:function(o){return this._destroy.indexOf(o)>-1},add:function(o){return this.checkQueue&&this.isActive(o)&&!this.isDestroying(o)||this.isPending(o)||(this._pending.push(o),this._toProcess++),o},remove:function(o){if(this.isPending(o)){var a=this._pending,h=a.indexOf(o);h!==-1&&a.splice(h,1)}else this.isActive(o)&&(this._destroy.push(o),this._toProcess++);return o},removeAll:function(){for(var o=this._active,a=this._destroy,h=o.length;h--;)a.push(o[h]),this._toProcess++;return this},update:function(){if(this._toProcess===0)return this._active;var o=this._destroy,a=this._active,h,l;for(h=0;h<o.length;h++){l=o[h];var u=a.indexOf(l);u!==-1&&(a.splice(u,1),this.emit(n.PROCESS_QUEUE_REMOVE,l))}for(o.length=0,o=this._pending,h=0;h<o.length;h++)l=o[h],(!this.checkQueue||this.checkQueue&&a.indexOf(l)===-1)&&(a.push(l),this.emit(n.PROCESS_QUEUE_ADD,l));return o.length=0,this._toProcess=0,a},getActive:function(){return this._active},length:{get:function(){return this._active.length}},destroy:function(){this._toProcess=0,this._pending=[],this._active=[],this._destroy=[]}});t.exports=r}),FS=y((e,t)=>{var i=W(),s=Cc(),n=he(),r=Vt(),o=new i({Extends:s,initialize:function(a){s.call(this),this.checkQueue=!0,this.scene=a,this.systems=a.sys,a.sys.events.once(r.BOOT,this.boot,this),a.sys.events.on(r.START,this.start,this)},boot:function(){this.systems.events.once(r.DESTROY,this.destroy,this)},start:function(){var a=this.systems.events;a.on(r.PRE_UPDATE,this.update,this),a.on(r.UPDATE,this.sceneUpdate,this),a.once(r.SHUTDOWN,this.shutdown,this)},sceneUpdate:function(a,h){for(var l=this._active,u=l.length,d=0;d<u;d++){var p=l[d];p.active&&p.preUpdate.call(p,a,h)}},shutdown:function(){for(var a=this._active.length;a--;)this._active[a].destroy(!0);for(a=this._pending.length;a--;)this._pending[a].destroy(!0);for(a=this._destroy.length;a--;)this._destroy[a].destroy(!0);this._toProcess=0,this._pending=[],this._active=[],this._destroy=[],this.removeAllListeners();var h=this.systems.events;h.off(r.PRE_UPDATE,this.update,this),h.off(r.UPDATE,this.sceneUpdate,this),h.off(r.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.systems.events.off(r.START,this.start,this),this.scene=null,this.systems=null}});n.register("UpdateList",o,"updateList"),t.exports=o}),le=y((e,t)=>{var i=pa(),s=St(),n=function(r,o,a){var h=s(r,o,null);if(h===null)return a;if(Array.isArray(h))return i.RND.pick(h);if(typeof h=="object"){if(h.hasOwnProperty("randInt"))return i.RND.integerInRange(h.randInt[0],h.randInt[1]);if(h.hasOwnProperty("randFloat"))return i.RND.realInRange(h.randFloat[0],h.randFloat[1])}else if(typeof h=="function")return h(o);return h};t.exports=n}),Ri=y((e,t)=>{var i=Ge(),s=le(),n=function(r,o,a){o.x=s(a,"x",0),o.y=s(a,"y",0),o.depth=s(a,"depth",0),o.flipX=s(a,"flipX",!1),o.flipY=s(a,"flipY",!1);var h=s(a,"scale",null);typeof h=="number"?o.setScale(h):h!==null&&(o.scaleX=s(h,"x",1),o.scaleY=s(h,"y",1));var l=s(a,"scrollFactor",null);typeof l=="number"?o.setScrollFactor(l):l!==null&&(o.scrollFactorX=s(l,"x",1),o.scrollFactorY=s(l,"y",1)),o.rotation=s(a,"rotation",0);var u=s(a,"angle",null);u!==null&&(o.angle=u),o.alpha=s(a,"alpha",1);var d=s(a,"origin",null);if(typeof d=="number")o.setOrigin(d);else if(d!==null){var p=s(d,"x",.5),g=s(d,"y",.5);o.setOrigin(p,g)}o.blendMode=s(a,"blendMode",i.NORMAL),o.visible=s(a,"visible",!0);var c=s(a,"add",!0);return c&&r.sys.displayList.add(o),o.preUpdate&&r.sys.updateList.add(o),o};t.exports=n}),Vn=y((e,t)=>{var i=function(s,n){return s.hasOwnProperty(n)};t.exports=i}),ba=y((e,t)=>{var i=W(),s=new i({initialize:function(n){if(this.entries=[],Array.isArray(n))for(var r=0;r<n.length;r++)this.set(n[r])},set:function(n){return this.entries.indexOf(n)===-1&&this.entries.push(n),this},get:function(n,r){for(var o=0;o<this.entries.length;o++){var a=this.entries[o];if(a[n]===r)return a}},getArray:function(){return this.entries.slice(0)},delete:function(n){var r=this.entries.indexOf(n);return r>-1&&this.entries.splice(r,1),this},dump:function(){for(var n=0;n<this.entries.length;n++)var r=this.entries[n]},each:function(n,r){var o,a=this.entries.slice(),h=a.length;if(r)for(o=0;o<h&&n.call(r,a[o],o)!==!1;o++);else for(o=0;o<h&&n(a[o],o)!==!1;o++);return this},iterate:function(n,r){var o,a=this.entries.length;if(r)for(o=0;o<a&&n.call(r,this.entries[o],o)!==!1;o++);else for(o=0;o<a&&n(this.entries[o],o)!==!1;o++);return this},iterateLocal:function(n){var r,o=[];for(r=1;r<arguments.length;r++)o.push(arguments[r]);var a=this.entries.length;for(r=0;r<a;r++){var h=this.entries[r];h[n].apply(h,o)}return this},clear:function(){return this.entries.length=0,this},contains:function(n){return this.entries.indexOf(n)>-1},union:function(n){var r=new s;return n.entries.forEach(function(o){r.set(o)}),this.entries.forEach(function(o){r.set(o)}),r},intersect:function(n){var r=new s;return this.entries.forEach(function(o){n.contains(o)&&r.set(o)}),r},difference:function(n){var r=new s;return this.entries.forEach(function(o){n.contains(o)||r.set(o)}),r},size:{get:function(){return this.entries.length},set:function(n){return n<this.entries.length?this.entries.length=n:this.entries.length}}});t.exports=s}),NS=y((e,t)=>{var i=function(s,n,r,o){r.addToRenderList(n),n.pipeline.batchSprite(n,r,o)};t.exports=i}),BS=y((e,t)=>{var i=Rt(),s=i,n=i;s=NS(),t.exports={renderWebGL:s,renderCanvas:n}}),Xn=y((e,t)=>{var i=Yr(),s=W(),n=be(),r=He(),o=BS(),a=new s({Extends:r,Mixins:[n.Alpha,n.BlendMode,n.Depth,n.Flip,n.GetBounds,n.Mask,n.Origin,n.Pipeline,n.PostPipeline,n.ScrollFactor,n.Size,n.TextureCrop,n.Tint,n.Transform,n.Visible,o],initialize:function(h,l,u,d,p){r.call(this,h,"Sprite"),this._crop=this.resetCropObject(),this.anims=new i(this),this.setTexture(d,p),this.setPosition(l,u),this.setSizeToFrame(),this.setOriginFromFrame(),this.initPipeline(),this.initPostPipeline(!0)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},preUpdate:function(h,l){this.anims.update(h,l)},play:function(h,l){return this.anims.play(h,l)},playReverse:function(h,l){return this.anims.playReverse(h,l)},playAfterDelay:function(h,l){return this.anims.playAfterDelay(h,l)},playAfterRepeat:function(h,l){return this.anims.playAfterRepeat(h,l)},chain:function(h){return this.anims.chain(h)},stop:function(){return this.anims.stop()},stopAfterDelay:function(h){return this.anims.stopAfterDelay(h)},stopAfterRepeat:function(h){return this.anims.stopAfterRepeat(h)},stopOnFrame:function(h){return this.anims.stopOnFrame(h)},toJSON:function(){return n.ToJSON(this)},preDestroy:function(){this.anims.destroy(),this.anims=void 0}});t.exports=a}),Ia=y((e,t)=>{var i=El(),s=W(),n=bs(),r=Ct(),o=Kr(),a=dt(),h=St(),l=Vn(),u=ce(),d=Wh(),p=ba(),g=Xn(),c=new s({Extends:r,initialize:function(f,m,v){r.call(this),v?m&&!Array.isArray(m)&&(m=[m]):Array.isArray(m)?u(m[0])&&(v=m,m=null):u(m)&&(v=m,m=null),this.scene=f,this.children=new p,this.isParent=!0,this.type="Group",this.classType=a(v,"classType",g),this.name=a(v,"name",""),this.active=a(v,"active",!0),this.maxSize=a(v,"maxSize",-1),this.defaultKey=a(v,"defaultKey",null),this.defaultFrame=a(v,"defaultFrame",null),this.runChildUpdate=a(v,"runChildUpdate",!1),this.createCallback=a(v,"createCallback",null),this.removeCallback=a(v,"removeCallback",null),this.createMultipleCallback=a(v,"createMultipleCallback",null),this.internalCreateCallback=a(v,"internalCreateCallback",null),this.internalRemoveCallback=a(v,"internalRemoveCallback",null),m&&this.addMultiple(m),v&&this.createMultiple(v),this.on(n.ADDED_TO_SCENE,this.addedToScene,this),this.on(n.REMOVED_FROM_SCENE,this.removedFromScene,this)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},create:function(f,m,v,E,x,T){if(f===void 0&&(f=0),m===void 0&&(m=0),v===void 0&&(v=this.defaultKey),E===void 0&&(E=this.defaultFrame),x===void 0&&(x=!0),T===void 0&&(T=!0),this.isFull())return null;var A=new this.classType(this.scene,f,m,v,E);return A.addToDisplayList(this.scene.sys.displayList),A.addToUpdateList(),A.visible=x,A.setActive(T),this.add(A),A},createMultiple:function(f){if(this.isFull())return[];Array.isArray(f)||(f=[f]);var m=[];if(f[0].key)for(var v=0;v<f.length;v++){var E=this.createFromConfig(f[v]);m=m.concat(E)}return m},createFromConfig:function(f){if(this.isFull())return[];this.classType=a(f,"classType",this.classType);var m=a(f,"key",void 0),v=a(f,"frame",null),E=a(f,"visible",!0),x=a(f,"active",!0),T=[];if(m===void 0)return T;Array.isArray(m)||(m=[m]),Array.isArray(v)||(v=[v]);var A=a(f,"repeat",0),P=a(f,"randomKey",!1),R=a(f,"randomFrame",!1),S=a(f,"yoyo",!1),I=a(f,"quantity",!1),w=a(f,"frameQuantity",1),C=a(f,"max",0),_=d(m,v,{max:C,qty:I||w,random:P,randomB:R,repeat:A,yoyo:S});f.createCallback&&(this.createCallback=f.createCallback),f.removeCallback&&(this.removeCallback=f.removeCallback),f.internalCreateCallback&&(this.internalCreateCallback=f.internalCreateCallback),f.internalRemoveCallback&&(this.internalRemoveCallback=f.internalRemoveCallback);for(var O=0;O<_.length;O++){var D=this.create(0,0,_[O].a,_[O].b,E,x);if(!D)break;T.push(D)}if(l(f,"setXY")){var F=h(f,"setXY.x",0),N=h(f,"setXY.y",0),Y=h(f,"setXY.stepX",0),L=h(f,"setXY.stepY",0);i.SetXY(T,F,N,Y,L)}if(l(f,"setRotation")){var b=h(f,"setRotation.value",0),M=h(f,"setRotation.step",0);i.SetRotation(T,b,M)}if(l(f,"setScale")){var k=h(f,"setScale.x",1),B=h(f,"setScale.y",k),H=h(f,"setScale.stepX",0),z=h(f,"setScale.stepY",0);i.SetScale(T,k,B,H,z)}if(l(f,"setOrigin")){var V=h(f,"setOrigin.x",.5),q=h(f,"setOrigin.y",V),Z=h(f,"setOrigin.stepX",0),at=h(f,"setOrigin.stepY",0);i.SetOrigin(T,V,q,Z,at)}if(l(f,"setAlpha")){var et=h(f,"setAlpha.value",1),st=h(f,"setAlpha.step",0);i.SetAlpha(T,et,st)}if(l(f,"setDepth")){var Q=h(f,"setDepth.value",0),ct=h(f,"setDepth.step",0);i.SetDepth(T,Q,ct)}if(l(f,"setScrollFactor")){var wt=h(f,"setScrollFactor.x",1),Bt=h(f,"setScrollFactor.y",wt),Pt=h(f,"setScrollFactor.stepX",0),Ht=h(f,"setScrollFactor.stepY",0);i.SetScrollFactor(T,wt,Bt,Pt,Ht)}var gt=a(f,"hitArea",null),Et=a(f,"hitAreaCallback",null);gt&&i.SetHitArea(T,gt,Et);var vs=a(f,"gridAlign",!1);return vs&&i.GridAlign(T,vs),this.createMultipleCallback&&this.createMultipleCallback.call(this,T),T},preUpdate:function(f,m){if(!(!this.runChildUpdate||this.children.size===0))for(var v=this.children.entries.slice(),E=0;E<v.length;E++){var x=v[E];x.active&&x.update(f,m)}},add:function(f,m){return m===void 0&&(m=!1),this.isFull()?this:(this.children.set(f),this.internalCreateCallback&&this.internalCreateCallback.call(this,f),this.createCallback&&this.createCallback.call(this,f),m&&(f.addToDisplayList(this.scene.sys.displayList),f.addToUpdateList()),f.on(n.DESTROY,this.remove,this),this)},addMultiple:function(f,m){if(m===void 0&&(m=!1),Array.isArray(f))for(var v=0;v<f.length;v++)this.add(f[v],m);return this},remove:function(f,m,v){return m===void 0&&(m=!1),v===void 0&&(v=!1),this.children.contains(f)?(this.children.delete(f),this.internalRemoveCallback&&this.internalRemoveCallback.call(this,f),this.removeCallback&&this.removeCallback.call(this,f),f.off(n.DESTROY,this.remove,this),v?f.destroy():m&&(f.removeFromDisplayList(),f.removeFromUpdateList()),this):this},clear:function(f,m){f===void 0&&(f=!1),m===void 0&&(m=!1);for(var v=this.children,E=0;E<v.size;E++){var x=v.entries[E];x.off(n.DESTROY,this.remove,this),m?x.destroy():f&&(x.removeFromDisplayList(),x.removeFromUpdateList())}return this.children.clear(),this},contains:function(f){return this.children.contains(f)},getChildren:function(){return this.children.entries},getLength:function(){return this.children.size},getMatching:function(f,m,v,E){return o(this.children.entries,f,m,v,E)},getFirst:function(f,m,v,E,x,T,A){return this.getHandler(!0,1,f,m,v,E,x,T,A)},getFirstNth:function(f,m,v,E,x,T,A,P){return this.getHandler(!0,f,m,v,E,x,T,A,P)},getLast:function(f,m,v,E,x,T,A){return this.getHandler(!1,1,f,m,v,E,x,T,A)},getLastNth:function(f,m,v,E,x,T,A,P){return this.getHandler(!1,f,m,v,E,x,T,A,P)},getHandler:function(f,m,v,E,x,T,A,P,R){v===void 0&&(v=!1),E===void 0&&(E=!1);var S,I,w=0,C=this.children.entries;if(f)for(I=0;I<C.length;I++)if(S=C[I],S.active===v){if(w++,w===m)break}else S=null;else for(I=C.length-1;I>=0;I--)if(S=C[I],S.active===v){if(w++,w===m)break}else S=null;return S?(typeof x=="number"&&(S.x=x),typeof T=="number"&&(S.y=T),S):E?this.create(x,T,A,P,R):null},get:function(f,m,v,E,x){return this.getFirst(!1,!0,f,m,v,E,x)},getFirstAlive:function(f,m,v,E,x,T){return this.getFirst(!0,f,m,v,E,x,T)},getFirstDead:function(f,m,v,E,x,T){return this.getFirst(!1,f,m,v,E,x,T)},playAnimation:function(f,m){return i.PlayAnimation(this.children.entries,f,m),this},isFull:function(){return this.maxSize===-1?!1:this.children.size>=this.maxSize},countActive:function(f){f===void 0&&(f=!0);for(var m=0,v=0;v<this.children.size;v++)this.children.entries[v].active===f&&m++;return m},getTotalUsed:function(){return this.countActive()},getTotalFree:function(){var f=this.getTotalUsed(),m=this.maxSize===-1?999999999999:this.maxSize;return m-f},setActive:function(f){return this.active=f,this},setName:function(f){return this.name=f,this},propertyValueSet:function(f,m,v,E,x){return i.PropertyValueSet(this.children.entries,f,m,v,E,x),this},propertyValueInc:function(f,m,v,E,x){return i.PropertyValueInc(this.children.entries,f,m,v,E,x),this},setX:function(f,m){return i.SetX(this.children.entries,f,m),this},setY:function(f,m){return i.SetY(this.children.entries,f,m),this},setXY:function(f,m,v,E){return i.SetXY(this.children.entries,f,m,v,E),this},incX:function(f,m){return i.IncX(this.children.entries,f,m),this},incY:function(f,m){return i.IncY(this.children.entries,f,m),this},incXY:function(f,m,v,E){return i.IncXY(this.children.entries,f,m,v,E),this},shiftPosition:function(f,m,v){return i.ShiftPosition(this.children.entries,f,m,v),this},angle:function(f,m){return i.Angle(this.children.entries,f,m),this},rotate:function(f,m){return i.Rotate(this.children.entries,f,m),this},rotateAround:function(f,m){return i.RotateAround(this.children.entries,f,m),this},rotateAroundDistance:function(f,m,v){return i.RotateAroundDistance(this.children.entries,f,m,v),this},setAlpha:function(f,m){return i.SetAlpha(this.children.entries,f,m),this},setTint:function(f,m,v,E){return i.SetTint(this.children.entries,f,m,v,E),this},setOrigin:function(f,m,v,E){return i.SetOrigin(this.children.entries,f,m,v,E),this},scaleX:function(f,m){return i.ScaleX(this.children.entries,f,m),this},scaleY:function(f,m){return i.ScaleY(this.children.entries,f,m),this},scaleXY:function(f,m,v,E){return i.ScaleXY(this.children.entries,f,m,v,E),this},setDepth:function(f,m){return i.SetDepth(this.children.entries,f,m),this},setBlendMode:function(f){return i.SetBlendMode(this.children.entries,f),this},setHitArea:function(f,m){return i.SetHitArea(this.children.entries,f,m),this},shuffle:function(){return i.Shuffle(this.children.entries),this},kill:function(f){this.children.contains(f)&&f.setActive(!1)},killAndHide:function(f){this.children.contains(f)&&(f.setActive(!1),f.setVisible(!1))},setVisible:function(f,m,v){return i.SetVisible(this.children.entries,f,m,v),this},toggleVisible:function(){return i.ToggleVisible(this.children.entries),this},destroy:function(f,m){f===void 0&&(f=!1),m===void 0&&(m=!1),!(!this.scene||this.ignoreDestroy)&&(this.emit(n.DESTROY,this),this.removeAllListeners(),this.scene.sys.updateList.remove(this),this.clear(m,f),this.scene=void 0,this.children=void 0)}});t.exports=c}),_a=y((e,t)=>{t.exports={ARC:0,BEGIN_PATH:1,CLOSE_PATH:2,FILL_RECT:3,LINE_TO:4,MOVE_TO:5,LINE_STYLE:6,FILL_STYLE:7,FILL_PATH:8,STROKE_PATH:9,FILL_TRIANGLE:10,STROKE_TRIANGLE:11,SAVE:14,RESTORE:15,TRANSLATE:16,SCALE:17,ROTATE:18,GRADIENT_FILL_STYLE:21,GRADIENT_LINE_STYLE:22}}),Pc=y((e,t)=>{var i=function(s,n,r){if(s.width<=0||s.height<=0)return!1;var o=(n-s.x)/s.width,a=(r-s.y)/s.height;return o*=o,a*=a,o+a<.25};t.exports=i}),Rc=y((e,t)=>{var i=Mt(),s=function(n,r,o){o===void 0&&(o=new i);var a=n.width/2,h=n.height/2;return o.x=n.x+a*Math.cos(r),o.y=n.y+h*Math.sin(r),o};t.exports=s}),US=y((e,t)=>{var i=Rc(),s=ws(),n=Gt(),r=Mt(),o=function(a,h,l){l===void 0&&(l=new r);var u=s(h,0,n.PI2);return i(a,u,l)};t.exports=o}),GS=y((e,t)=>{var i=function(s){var n=s.width/2,r=s.height/2,o=Math.pow(n-r,2)/Math.pow(n+r,2);return Math.PI*(n+r)*(1+3*o/(10+Math.sqrt(4-3*o)))};t.exports=i}),YS=y((e,t)=>{var i=GS(),s=Rc(),n=ws(),r=Gt(),o=function(a,h,l,u){u===void 0&&(u=[]),!h&&l>0&&(h=i(a)/l);for(var d=0;d<h;d++){var p=n(d/h,0,r.PI2);u.push(s(a,p))}return u};t.exports=o}),bc=y((e,t)=>{var i=W(),s=Pc(),n=US(),r=YS(),o=xi(),a=ml(),h=new i({initialize:function(l,u,d,p){l===void 0&&(l=0),u===void 0&&(u=0),d===void 0&&(d=0),p===void 0&&(p=0),this.type=o.ELLIPSE,this.x=l,this.y=u,this.width=d,this.height=p},contains:function(l,u){return s(this,l,u)},getPoint:function(l,u){return n(this,l,u)},getPoints:function(l,u,d){return r(this,l,u,d)},getRandomPoint:function(l){return a(this,l)},setTo:function(l,u,d,p){return this.x=l,this.y=u,this.width=d,this.height=p,this},setEmpty:function(){return this.width=0,this.height=0,this},setPosition:function(l,u){return u===void 0&&(u=l),this.x=l,this.y=u,this},setSize:function(l,u){return u===void 0&&(u=l),this.width=l,this.height=u,this},isEmpty:function(){return this.width<=0||this.height<=0},getMinorRadius:function(){return Math.min(this.width,this.height)/2},getMajorRadius:function(){return Math.max(this.width,this.height)/2},left:{get:function(){return this.x-this.width/2},set:function(l){this.x=l+this.width/2}},right:{get:function(){return this.x+this.width/2},set:function(l){this.x=l-this.width/2}},top:{get:function(){return this.y-this.height/2},set:function(l){this.y=l+this.height/2}},bottom:{get:function(){return this.y+this.height/2},set:function(l){this.y=l-this.height/2}}});t.exports=h}),Oa=y((e,t)=>{var i=Re(),s=new i,n=new i,r=new i,o={camera:s,sprite:n,calc:r},a=function(h,l,u){var d=s,p=n,g=r;return p.applyITRS(h.x,h.y,h.rotation,h.scaleX,h.scaleY),d.copyFrom(l.matrix),u?(d.multiplyWithOffset(u,-l.scrollX*h.scrollFactorX,-l.scrollY*h.scrollFactorY),p.e=h.x,p.f=h.y):(p.e-=l.scrollX*h.scrollFactorX,p.f-=l.scrollY*h.scrollFactorY),d.multiply(p,g),o};t.exports=a}),HS=y((e,t)=>{var i=_a(),s=Oa(),n=Re(),r=Se(),o=function(d,p,g){this.x=d,this.y=p,this.width=g},a=function(d,p,g){this.points=[],this.pointsLength=1,this.points[0]=new o(d,p,g)},h=[],l=new n,u=function(d,p,g,c){if(p.commandBuffer.length!==0){g.addToRenderList(p);var f=d.pipelines.set(p.pipeline,p);d.pipelines.preBatch(p);for(var m=s(p,g,c).calc,v=l.loadIdentity(),E=p.commandBuffer,x=g.alpha*p.alpha,T=1,A=f.fillTint,P=f.strokeTint,R=0,S=0,I=0,w=.01,C=Math.PI*2,_,O=[],D=0,F=!0,N=null,Y=r.getTintAppendFloatAlpha,L=0;L<E.length;L++)switch(_=E[L],_){case i.BEGIN_PATH:{O.length=0,N=null,F=!0;break}case i.CLOSE_PATH:{F=!1,N&&N.points.length&&N.points.push(N.points[0]);break}case i.FILL_PATH:{for(D=0;D<O.length;D++)f.batchFillPath(O[D].points,v,m);break}case i.STROKE_PATH:{for(D=0;D<O.length;D++)f.batchStrokePath(O[D].points,T,F,v,m);break}case i.LINE_STYLE:{T=E[++L];var b=E[++L],M=E[++L]*x,k=Y(b,M);P.TL=k,P.TR=k,P.BL=k,P.BR=k;break}case i.FILL_STYLE:{var B=E[++L],H=E[++L]*x,z=Y(B,H);A.TL=z,A.TR=z,A.BL=z,A.BR=z;break}case i.GRADIENT_FILL_STYLE:{var V=E[++L]*x,q=E[++L]*x,Z=E[++L]*x,at=E[++L]*x;A.TL=Y(E[++L],V),A.TR=Y(E[++L],q),A.BL=Y(E[++L],Z),A.BR=Y(E[++L],at);break}case i.GRADIENT_LINE_STYLE:{T=E[++L];var et=E[++L]*x;P.TL=Y(E[++L],et),P.TR=Y(E[++L],et),P.BL=Y(E[++L],et),P.BR=Y(E[++L],et);break}case i.ARC:{var st=0,Q=E[++L],ct=E[++L],wt=E[++L],Bt=E[++L],Pt=E[++L],Ht=E[++L],gt=E[++L];for(Pt-=Bt,Ht?Pt<-C?Pt=-C:Pt>0&&(Pt=-C+Pt%C):Pt>C?Pt=C:Pt<0&&(Pt=C+Pt%C),N===null&&(N=new a(Q+Math.cos(Bt)*wt,ct+Math.sin(Bt)*wt,T),O.push(N),st+=w);st<1+gt;)I=Pt*st+Bt,R=Q+Math.cos(I)*wt,S=ct+Math.sin(I)*wt,N.points.push(new o(R,S,T)),st+=w;I=Pt+Bt,R=Q+Math.cos(I)*wt,S=ct+Math.sin(I)*wt,N.points.push(new o(R,S,T));break}case i.FILL_RECT:{f.batchFillRect(E[++L],E[++L],E[++L],E[++L],v,m);break}case i.FILL_TRIANGLE:{f.batchFillTriangle(E[++L],E[++L],E[++L],E[++L],E[++L],E[++L],v,m);break}case i.STROKE_TRIANGLE:{f.batchStrokeTriangle(E[++L],E[++L],E[++L],E[++L],E[++L],E[++L],T,v,m);break}case i.LINE_TO:{N!==null?N.points.push(new o(E[++L],E[++L],T)):(N=new a(E[++L],E[++L],T),O.push(N));break}case i.MOVE_TO:{N=new a(E[++L],E[++L],T),O.push(N);break}case i.SAVE:{h.push(v.copyToArray());break}case i.RESTORE:{v.copyFromArray(h.pop());break}case i.TRANSLATE:{Q=E[++L],ct=E[++L],v.translate(Q,ct);break}case i.SCALE:{Q=E[++L],ct=E[++L],v.scale(Q,ct);break}case i.ROTATE:{v.rotate(E[++L]);break}}d.pipelines.postBatch(p)}};t.exports=u}),zS=y((e,t)=>{var i=Oa(),s=function(n,r,o,a,h){var l=a.alpha*o.alpha;if(l<=0)return!1;var u=i(o,a,h).calc;return r.globalCompositeOperation=n.blendModes[o.blendMode],r.globalAlpha=l,r.save(),u.setToContext(r),r.imageSmoothingEnabled=o.frame?!o.frame.source.scaleMode:n.antialias,!0};t.exports=s}),WS=y((e,t)=>{var i=_a(),s=zS(),n=function(r,o,a,h,l,u){var d=o.commandBuffer,p=d.length,g=l||r.currentContext;if(!(p===0||!s(r,g,o,a,h))){a.addToRenderList(o);var c=1,f=1,m=0,v=0,E=1,x=0,T=0,A=0;g.beginPath();for(var P=0;P<p;++P){var R=d[P];switch(R){case i.ARC:g.arc(d[P+1],d[P+2],d[P+3],d[P+4],d[P+5],d[P+6]),P+=7;break;case i.LINE_STYLE:E=d[P+1],m=d[P+2],c=d[P+3],x=(m&16711680)>>>16,T=(m&65280)>>>8,A=m&255,g.strokeStyle="rgba("+x+","+T+","+A+","+c+")",g.lineWidth=E,P+=3;break;case i.FILL_STYLE:v=d[P+1],f=d[P+2],x=(v&16711680)>>>16,T=(v&65280)>>>8,A=v&255,g.fillStyle="rgba("+x+","+T+","+A+","+f+")",P+=2;break;case i.BEGIN_PATH:g.beginPath();break;case i.CLOSE_PATH:g.closePath();break;case i.FILL_PATH:u||g.fill();break;case i.STROKE_PATH:u||g.stroke();break;case i.FILL_RECT:u?g.rect(d[P+1],d[P+2],d[P+3],d[P+4]):g.fillRect(d[P+1],d[P+2],d[P+3],d[P+4]),P+=4;break;case i.FILL_TRIANGLE:g.beginPath(),g.moveTo(d[P+1],d[P+2]),g.lineTo(d[P+3],d[P+4]),g.lineTo(d[P+5],d[P+6]),g.closePath(),u||g.fill(),P+=6;break;case i.STROKE_TRIANGLE:g.beginPath(),g.moveTo(d[P+1],d[P+2]),g.lineTo(d[P+3],d[P+4]),g.lineTo(d[P+5],d[P+6]),g.closePath(),u||g.stroke(),P+=6;break;case i.LINE_TO:g.lineTo(d[P+1],d[P+2]),P+=2;break;case i.MOVE_TO:g.moveTo(d[P+1],d[P+2]),P+=2;break;case i.LINE_FX_TO:g.lineTo(d[P+1],d[P+2]),P+=5;break;case i.MOVE_FX_TO:g.moveTo(d[P+1],d[P+2]),P+=5;break;case i.SAVE:g.save();break;case i.RESTORE:g.restore();break;case i.TRANSLATE:g.translate(d[P+1],d[P+2]),P+=2;break;case i.SCALE:g.scale(d[P+1],d[P+2]),P+=2;break;case i.ROTATE:g.rotate(d[P+1]),P+=1;break;case i.GRADIENT_FILL_STYLE:P+=5;break;case i.GRADIENT_LINE_STYLE:P+=6;break}}g.restore()}};t.exports=n}),VS=y((e,t)=>{var i=Rt(),s=i,n=i;s=HS(),n=WS(),t.exports={renderWebGL:s,renderCanvas:n}}),Ma=y((e,t)=>{var i=ua(),s=W(),n=_a(),r=be(),o=bc(),a=He(),h=dt(),l=St(),u=Gt(),d=VS(),p=new s({Extends:a,Mixins:[r.AlphaSingle,r.BlendMode,r.Depth,r.Mask,r.Pipeline,r.PostPipeline,r.Transform,r.Visible,r.ScrollFactor,d],initialize:function(g,c){var f=l(c,"x",0),m=l(c,"y",0);a.call(this,g,"Graphics"),this.setPosition(f,m),this.initPipeline(),this.initPostPipeline(),this.displayOriginX=0,this.displayOriginY=0,this.commandBuffer=[],this.defaultFillColor=-1,this.defaultFillAlpha=1,this.defaultStrokeWidth=1,this.defaultStrokeColor=-1,this.defaultStrokeAlpha=1,this._lineWidth=1,this.lineStyle(1,0,0),this.fillStyle(0,0),this.setDefaultStyles(c)},setDefaultStyles:function(g){return l(g,"lineStyle",null)&&(this.defaultStrokeWidth=l(g,"lineStyle.width",1),this.defaultStrokeColor=l(g,"lineStyle.color",16777215),this.defaultStrokeAlpha=l(g,"lineStyle.alpha",1),this.lineStyle(this.defaultStrokeWidth,this.defaultStrokeColor,this.defaultStrokeAlpha)),l(g,"fillStyle",null)&&(this.defaultFillColor=l(g,"fillStyle.color",16777215),this.defaultFillAlpha=l(g,"fillStyle.alpha",1),this.fillStyle(this.defaultFillColor,this.defaultFillAlpha)),this},lineStyle:function(g,c,f){return f===void 0&&(f=1),this.commandBuffer.push(n.LINE_STYLE,g,c,f),this._lineWidth=g,this},fillStyle:function(g,c){return c===void 0&&(c=1),this.commandBuffer.push(n.FILL_STYLE,g,c),this},fillGradientStyle:function(g,c,f,m,v,E,x,T){return v===void 0&&(v=1),E===void 0&&(E=v),x===void 0&&(x=v),T===void 0&&(T=v),this.commandBuffer.push(n.GRADIENT_FILL_STYLE,v,E,x,T,g,c,f,m),this},lineGradientStyle:function(g,c,f,m,v,E){return E===void 0&&(E=1),this.commandBuffer.push(n.GRADIENT_LINE_STYLE,g,E,c,f,m,v),this},beginPath:function(){return this.commandBuffer.push(n.BEGIN_PATH),this},closePath:function(){return this.commandBuffer.push(n.CLOSE_PATH),this},fillPath:function(){return this.commandBuffer.push(n.FILL_PATH),this},fill:function(){return this.commandBuffer.push(n.FILL_PATH),this},strokePath:function(){return this.commandBuffer.push(n.STROKE_PATH),this},stroke:function(){return this.commandBuffer.push(n.STROKE_PATH),this},fillCircleShape:function(g){return this.fillCircle(g.x,g.y,g.radius)},strokeCircleShape:function(g){return this.strokeCircle(g.x,g.y,g.radius)},fillCircle:function(g,c,f){return this.beginPath(),this.arc(g,c,f,0,u.PI2),this.fillPath(),this},strokeCircle:function(g,c,f){return this.beginPath(),this.arc(g,c,f,0,u.PI2),this.strokePath(),this},fillRectShape:function(g){return this.fillRect(g.x,g.y,g.width,g.height)},strokeRectShape:function(g){return this.strokeRect(g.x,g.y,g.width,g.height)},fillRect:function(g,c,f,m){return this.commandBuffer.push(n.FILL_RECT,g,c,f,m),this},strokeRect:function(g,c,f,m){var v=this._lineWidth/2,E=g-v,x=g+v;return this.beginPath(),this.moveTo(g,c),this.lineTo(g,c+m),this.strokePath(),this.beginPath(),this.moveTo(g+f,c),this.lineTo(g+f,c+m),this.strokePath(),this.beginPath(),this.moveTo(E,c),this.lineTo(x+f,c),this.strokePath(),this.beginPath(),this.moveTo(E,c+m),this.lineTo(x+f,c+m),this.strokePath(),this},fillRoundedRect:function(g,c,f,m,v){v===void 0&&(v=20);var E=v,x=v,T=v,A=v;typeof v!="number"&&(E=h(v,"tl",20),x=h(v,"tr",20),T=h(v,"bl",20),A=h(v,"br",20));var P=E>=0,R=x>=0,S=T>=0,I=A>=0;return E=Math.abs(E),x=Math.abs(x),T=Math.abs(T),A=Math.abs(A),this.beginPath(),this.moveTo(g+E,c),this.lineTo(g+f-x,c),R?this.arc(g+f-x,c+x,x,-u.TAU,0):this.arc(g+f,c,x,Math.PI,u.TAU,!0),this.lineTo(g+f,c+m-A),I?this.arc(g+f-A,c+m-A,A,0,u.TAU):this.arc(g+f,c+m,A,-u.TAU,Math.PI,!0),this.lineTo(g+T,c+m),S?this.arc(g+T,c+m-T,T,u.TAU,Math.PI):this.arc(g,c+m,T,0,-u.TAU,!0),this.lineTo(g,c+E),P?this.arc(g+E,c+E,E,-Math.PI,-u.TAU):this.arc(g,c,E,u.TAU,0,!0),this.fillPath(),this},strokeRoundedRect:function(g,c,f,m,v){v===void 0&&(v=20);var E=v,x=v,T=v,A=v,P=Math.min(f,m)/2;typeof v!="number"&&(E=h(v,"tl",20),x=h(v,"tr",20),T=h(v,"bl",20),A=h(v,"br",20));var R=E>=0,S=x>=0,I=T>=0,w=A>=0;return E=Math.min(Math.abs(E),P),x=Math.min(Math.abs(x),P),T=Math.min(Math.abs(T),P),A=Math.min(Math.abs(A),P),this.beginPath(),this.moveTo(g+E,c),this.lineTo(g+f-x,c),this.moveTo(g+f-x,c),S?this.arc(g+f-x,c+x,x,-u.TAU,0):this.arc(g+f,c,x,Math.PI,u.TAU,!0),this.lineTo(g+f,c+m-A),this.moveTo(g+f,c+m-A),w?this.arc(g+f-A,c+m-A,A,0,u.TAU):this.arc(g+f,c+m,A,-u.TAU,Math.PI,!0),this.lineTo(g+T,c+m),this.moveTo(g+T,c+m),I?this.arc(g+T,c+m-T,T,u.TAU,Math.PI):this.arc(g,c+m,T,0,-u.TAU,!0),this.lineTo(g,c+E),this.moveTo(g,c+E),R?this.arc(g+E,c+E,E,-Math.PI,-u.TAU):this.arc(g,c,E,u.TAU,0,!0),this.strokePath(),this},fillPointShape:function(g,c){return this.fillPoint(g.x,g.y,c)},fillPoint:function(g,c,f){return!f||f<1?f=1:(g-=f/2,c-=f/2),this.commandBuffer.push(n.FILL_RECT,g,c,f,f),this},fillTriangleShape:function(g){return this.fillTriangle(g.x1,g.y1,g.x2,g.y2,g.x3,g.y3)},strokeTriangleShape:function(g){return this.strokeTriangle(g.x1,g.y1,g.x2,g.y2,g.x3,g.y3)},fillTriangle:function(g,c,f,m,v,E){return this.commandBuffer.push(n.FILL_TRIANGLE,g,c,f,m,v,E),this},strokeTriangle:function(g,c,f,m,v,E){return this.commandBuffer.push(n.STROKE_TRIANGLE,g,c,f,m,v,E),this},strokeLineShape:function(g){return this.lineBetween(g.x1,g.y1,g.x2,g.y2)},lineBetween:function(g,c,f,m){return this.beginPath(),this.moveTo(g,c),this.lineTo(f,m),this.strokePath(),this},lineTo:function(g,c){return this.commandBuffer.push(n.LINE_TO,g,c),this},moveTo:function(g,c){return this.commandBuffer.push(n.MOVE_TO,g,c),this},strokePoints:function(g,c,f,m){c===void 0&&(c=!1),f===void 0&&(f=!1),m===void 0&&(m=g.length),this.beginPath(),this.moveTo(g[0].x,g[0].y);for(var v=1;v<m;v++)this.lineTo(g[v].x,g[v].y);return c&&this.lineTo(g[0].x,g[0].y),f&&this.closePath(),this.strokePath(),this},fillPoints:function(g,c,f,m){c===void 0&&(c=!1),f===void 0&&(f=!1),m===void 0&&(m=g.length),this.beginPath(),this.moveTo(g[0].x,g[0].y);for(var v=1;v<m;v++)this.lineTo(g[v].x,g[v].y);return c&&this.lineTo(g[0].x,g[0].y),f&&this.closePath(),this.fillPath(),this},strokeEllipseShape:function(g,c){c===void 0&&(c=32);var f=g.getPoints(c);return this.strokePoints(f,!0)},strokeEllipse:function(g,c,f,m,v){v===void 0&&(v=32);var E=new o(g,c,f,m),x=E.getPoints(v);return this.strokePoints(x,!0)},fillEllipseShape:function(g,c){c===void 0&&(c=32);var f=g.getPoints(c);return this.fillPoints(f,!0)},fillEllipse:function(g,c,f,m,v){v===void 0&&(v=32);var E=new o(g,c,f,m),x=E.getPoints(v);return this.fillPoints(x,!0)},arc:function(g,c,f,m,v,E,x){return E===void 0&&(E=!1),x===void 0&&(x=0),this.commandBuffer.push(n.ARC,g,c,f,m,v,E,x),this},slice:function(g,c,f,m,v,E,x){return E===void 0&&(E=!1),x===void 0&&(x=0),this.commandBuffer.push(n.BEGIN_PATH),this.commandBuffer.push(n.MOVE_TO,g,c),this.commandBuffer.push(n.ARC,g,c,f,m,v,E,x),this.commandBuffer.push(n.CLOSE_PATH),this},save:function(){return this.commandBuffer.push(n.SAVE),this},restore:function(){return this.commandBuffer.push(n.RESTORE),this},translateCanvas:function(g,c){return this.commandBuffer.push(n.TRANSLATE,g,c),this},scaleCanvas:function(g,c){return this.commandBuffer.push(n.SCALE,g,c),this},rotateCanvas:function(g){return this.commandBuffer.push(n.ROTATE,g),this},clear:function(){return this.commandBuffer.length=0,this.defaultFillColor>-1&&this.fillStyle(this.defaultFillColor,this.defaultFillAlpha),this.defaultStrokeColor>-1&&this.lineStyle(this.defaultStrokeWidth,this.defaultStrokeColor,this.defaultStrokeAlpha),this},generateTexture:function(g,c,f){var m=this.scene.sys,v=m.game.renderer;c===void 0&&(c=m.scale.width),f===void 0&&(f=m.scale.height),p.TargetCamera.setScene(this.scene),p.TargetCamera.setViewport(0,0,c,f),p.TargetCamera.scrollX=this.x,p.TargetCamera.scrollY=this.y;var E,x,T={willReadFrequently:!0};if(typeof g=="string")if(m.textures.exists(g)){E=m.textures.get(g);var A=E.getSourceImage();A instanceof HTMLCanvasElement&&(x=A.getContext("2d",T))}else E=m.textures.createCanvas(g,c,f),x=E.getSourceImage().getContext("2d",T);else g instanceof HTMLCanvasElement&&(x=g.getContext("2d",T));return x&&(this.renderCanvas(v,this,p.TargetCamera,null,x,!1),E&&E.refresh()),this},preDestroy:function(){this.commandBuffer=[]}});p.TargetCamera=new i,t.exports=p}),Kn=y((e,t)=>{var i=_l(),s=Ol(),n=Ll(),r={bezier:i,catmull:s,catmullrom:s,linear:n},o=function(a){if(a===null)return null;var h=r.linear;return typeof a=="string"?r.hasOwnProperty(a)&&(h=r[a]):typeof a=="function"&&(h=a),h};t.exports=o}),La=y((e,t)=>{var i=ys(),s=Ot(),n=W(),r=_s(),o=wi(),a=dt(),h=Kn(),l=Nl(),u=Ai(),d=new n({initialize:function(p,g,c){c===void 0&&(c=!1),this.propertyKey=p,this.propertyValue=g,this.defaultValue=g,this.steps=0,this.counter=0,this.yoyo=!1,this.direction=0,this.start=0,this.current=0,this.end=0,this.ease=null,this.interpolation=null,this.emitOnly=c,this.onEmit=this.defaultEmit,this.onUpdate=this.defaultUpdate,this.active=!0,this.method=0,this._onEmit,this._onUpdate},loadConfig:function(p,g){p===void 0&&(p={}),g&&(this.propertyKey=g),this.propertyValue=a(p,this.propertyKey,this.defaultValue),this.method=this.getMethod(),this.setMethods(),this.emitOnly&&(this.onUpdate=this.defaultUpdate)},toJSON:function(){return JSON.stringify(this.propertyValue)},onChange:function(p){var g;switch(this.method){case 1:case 3:case 8:g=p;break;case 2:this.propertyValue.indexOf(p)>=0&&(g=p);break;case 4:var c=(this.end-this.start)/this.steps;g=l(p,c),this.counter=g;break;case 5:case 6:case 7:g=s(p,this.start,this.end);break;case 9:g=this.start[0];break}return this.current=g,this},getMethod:function(){var p=this.propertyValue;if(p===null)return 0;var g=typeof p;if(g==="number")return 1;if(Array.isArray(p))return 2;if(g==="function")return 3;if(g==="object"){if(this.hasBoth(p,"start","end"))return this.has(p,"steps")?4:5;if(this.hasBoth(p,"min","max"))return 6;if(this.has(p,"random"))return 7;if(this.hasEither(p,"onEmit","onUpdate"))return 8;if(this.hasEither(p,"values","interpolation"))return 9}return 0},setMethods:function(){var p=this.propertyValue,g=p,c=this.defaultEmit,f=this.defaultUpdate;switch(this.method){case 1:c=this.staticValueEmit;break;case 2:c=this.randomStaticValueEmit,g=p[0];break;case 3:this._onEmit=p,c=this.proxyEmit,g=this.defaultValue;break;case 4:this.start=p.start,this.end=p.end,this.steps=p.steps,this.counter=this.start,this.yoyo=this.has(p,"yoyo")?p.yoyo:!1,this.direction=0,c=this.steppedEmit,g=this.start;break;case 5:this.start=p.start,this.end=p.end;var m=this.has(p,"ease")?p.ease:"Linear";this.ease=o(m,p.easeParams),c=this.has(p,"random")&&p.random?this.randomRangedValueEmit:this.easedValueEmit,f=this.easeValueUpdate,g=this.start;break;case 6:this.start=p.min,this.end=p.max,c=this.has(p,"int")&&p.int?this.randomRangedIntEmit:this.randomRangedValueEmit,g=this.start;break;case 7:var v=p.random;Array.isArray(v)&&(this.start=v[0],this.end=v[1]),c=this.randomRangedIntEmit,g=this.start;break;case 8:this._onEmit=this.has(p,"onEmit")?p.onEmit:this.defaultEmit,this._onUpdate=this.has(p,"onUpdate")?p.onUpdate:this.defaultUpdate,c=this.proxyEmit,f=this.proxyUpdate,g=this.defaultValue;break;case 9:this.start=p.values;var E=this.has(p,"ease")?p.ease:"Linear";this.ease=o(E,p.easeParams),this.interpolation=h(p.interpolation),c=this.easedValueEmit,f=this.easeValueUpdate,g=this.start[0];break}return this.onEmit=c,this.onUpdate=f,this.current=g,this},has:function(p,g){return p.hasOwnProperty(g)},hasBoth:function(p,g,c){return p.hasOwnProperty(g)&&p.hasOwnProperty(c)},hasEither:function(p,g,c){return p.hasOwnProperty(g)||p.hasOwnProperty(c)},defaultEmit:function(){return this.defaultValue},defaultUpdate:function(p,g,c,f){return f},proxyEmit:function(p,g,c){var f=this._onEmit(p,g,c);return this.current=f,f},proxyUpdate:function(p,g,c,f){var m=this._onUpdate(p,g,c,f);return this.current=m,m},staticValueEmit:function(){return this.current},staticValueUpdate:function(){return this.current},randomStaticValueEmit:function(){var p=Math.floor(Math.random()*this.propertyValue.length);return this.current=this.propertyValue[p],this.current},randomRangedValueEmit:function(p,g){var c=r(this.start,this.end);return p&&p.data[g]&&(p.data[g].min=c,p.data[g].max=this.end),this.current=c,c},randomRangedIntEmit:function(p,g){var c=i(this.start,this.end);return p&&p.data[g]&&(p.data[g].min=c,p.data[g].max=this.end),this.current=c,c},steppedEmit:function(){var p=this.counter,g=p,c=(this.end-this.start)/this.steps;if(this.yoyo){var f;this.direction===0?(g+=c,g>=this.end&&(f=g-this.end,g=this.end-f,this.direction=1)):(g-=c,g<=this.start&&(f=this.start-g,g=this.start+f,this.direction=0)),this.counter=g}else this.counter=u(g+c,this.start,this.end);return this.current=p,p},easedValueEmit:function(p,g){if(p&&p.data[g]){var c=p.data[g];c.min=this.start,c.max=this.end}return this.current=this.start,this.start},easeValueUpdate:function(p,g,c){var f=p.data[g],m,v=this.ease(c);return this.interpolation?m=this.interpolation(this.start,v):m=(f.max-f.min)*v+f.min,this.current=m,m},destroy:function(){this.propertyValue=null,this.defaultValue=null,this.ease=null,this.interpolation=null,this._onEmit=null,this._onUpdate=null}});t.exports=d}),Ic=y((e,t)=>{var i=W(),s=La(),n=la(),r=wi(),o=Kn(),a=Sl(),h=new i({Extends:s,initialize:function(l){s.call(this,l,null,!1),this.active=!1,this.easeName="Linear",this.r=[],this.g=[],this.b=[]},getMethod:function(){return this.propertyValue===null?0:9},setMethods:function(){var l=this.propertyValue,u=l,d=this.defaultEmit,p=this.defaultUpdate;if(this.method===9){this.start=l[0],this.ease=r("Linear"),this.interpolation=o("linear"),d=this.easedValueEmit,p=this.easeValueUpdate,u=l[0],this.active=!0;for(var g=0;g<l.length;g++){var c=a(l[g]);this.r.push(c.r),this.g.push(c.g),this.b.push(c.b)}}return this.onEmit=d,this.onUpdate=p,this.current=u,this},setEase:function(l){this.easeName=l,this.ease=r(l)},easedValueEmit:function(){return this.current=this.start,this.start},easeValueUpdate:function(l,u,d){var p=this.ease(d),g=this.interpolation(this.r,p),c=this.interpolation(this.g,p),f=this.interpolation(this.b,p),m=n(g,c,f);return this.current=m,m}});t.exports=h}),XS=y((e,t)=>{t.exports="complete"}),KS=y((e,t)=>{t.exports="deathzone"}),jS=y((e,t)=>{t.exports="explode"}),ZS=y((e,t)=>{t.exports="start"}),qS=y((e,t)=>{t.exports="stop"}),_c=y((e,t)=>{t.exports={COMPLETE:XS(),DEATH_ZONE:KS(),EXPLODE:jS(),START:ZS(),STOP:qS()}}),Da=y((e,t)=>{var i=W(),s=new i({initialize:function(n,r,o){n===void 0&&(n=0),r===void 0&&(r=0),o===void 0&&(o=!0),this.emitter,this.x=n,this.y=r,this.active=o},update:function(){},destroy:function(){this.emitter=null}});t.exports=s}),Oc=y((e,t)=>{var i=W(),s=dt(),n=Da(),r=new i({Extends:n,initialize:function(o,a,h,l,u){if(typeof o=="object"){var d=o;o=s(d,"x",0),a=s(d,"y",0),h=s(d,"power",0),l=s(d,"epsilon",100),u=s(d,"gravity",50)}else o===void 0&&(o=0),a===void 0&&(a=0),h===void 0&&(h=0),l===void 0&&(l=100),u===void 0&&(u=50);n.call(this,o,a,!0),this._gravity=u,this._power=h*u,this._epsilon=l*l},update:function(o,a){var h=this.x-o.x,l=this.y-o.y,u=h*h+l*l;if(u!==0){var d=Math.sqrt(u);u<this._epsilon&&(u=this._epsilon);var p=this._power*a/(u*d)*100;o.velocityX+=h*p,o.velocityY+=l*p}},epsilon:{get:function(){return Math.sqrt(this._epsilon)},set:function(o){this._epsilon=o*o}},power:{get:function(){return this._power/this._gravity},set:function(o){this._power=o*this._gravity}},gravity:{get:function(){return this._gravity},set:function(o){var a=this.power;this._gravity=o,this.power=a}}});t.exports=r}),Mc=y((e,t)=>{var i=Yr(),s=Ot(),n=W(),r=Gi(),o=Ut(),a=ia(),h=xt(),l=new n({initialize:function(u){this.emitter=u,this.texture=null,this.frame=null,this.x=0,this.y=0,this.worldPosition=new h,this.velocityX=0,this.velocityY=0,this.accelerationX=0,this.accelerationY=0,this.maxVelocityX=1e4,this.maxVelocityY=1e4,this.bounce=0,this.scaleX=1,this.scaleY=1,this.alpha=1,this.angle=0,this.rotation=0,this.tint=16777215,this.life=1e3,this.lifeCurrent=1e3,this.delayCurrent=0,this.holdCurrent=0,this.lifeT=0,this.data={tint:{min:16777215,max:16777215},alpha:{min:1,max:1},rotate:{min:0,max:0},scaleX:{min:1,max:1},scaleY:{min:1,max:1},x:{min:0,max:0},y:{min:0,max:0},accelerationX:{min:0,max:0},accelerationY:{min:0,max:0},maxVelocityX:{min:0,max:0},maxVelocityY:{min:0,max:0},moveToX:{min:0,max:0},moveToY:{min:0,max:0},bounce:{min:0,max:0}},this.isCropped=!1,this.scene=u.scene,this.anims=null,this.emitter.anims.length>0&&(this.anims=new i(this)),this.bounds=new o},emit:function(u,d,p,g,c,f){return this.emitter.emit(u,d,p,g,c,f)},isAlive:function(){return this.lifeCurrent>0},kill:function(){this.lifeCurrent=0},setPosition:function(u,d){u===void 0&&(u=0),d===void 0&&(d=0),this.x=u,this.y=d},fire:function(u,d){var p=this.emitter,g=p.ops,c=p.getAnim();if(c?this.anims.play(c):(this.frame=p.getFrame(),this.texture=this.frame.texture),!this.frame)throw new Error("Particle has no texture frame");if(p.getEmitZone(this),u===void 0?this.x+=g.x.onEmit(this,"x"):g.x.steps>0?this.x+=u+g.x.onEmit(this,"x"):this.x+=u,d===void 0?this.y+=g.y.onEmit(this,"y"):g.y.steps>0?this.y+=d+g.y.onEmit(this,"y"):this.y+=d,this.life=g.lifespan.onEmit(this,"lifespan"),this.lifeCurrent=this.life,this.lifeT=0,this.delayCurrent=g.delay.onEmit(this,"delay"),this.holdCurrent=g.hold.onEmit(this,"hold"),this.scaleX=g.scaleX.onEmit(this,"scaleX"),this.scaleY=g.scaleY.active?g.scaleY.onEmit(this,"scaleY"):this.scaleX,this.angle=g.rotate.onEmit(this,"rotate"),this.rotation=r(this.angle),p.worldMatrix.transformPoint(this.x,this.y,this.worldPosition),this.delayCurrent===0&&p.getDeathZone(this))return this.lifeCurrent=0,!1;var f=g.speedX.onEmit(this,"speedX"),m=g.speedY.active?g.speedY.onEmit(this,"speedY"):f;if(p.radial){var v=r(g.angle.onEmit(this,"angle"));this.velocityX=Math.cos(v)*Math.abs(f),this.velocityY=Math.sin(v)*Math.abs(m)}else if(p.moveTo){var E=g.moveToX.onEmit(this,"moveToX"),x=g.moveToY.onEmit(this,"moveToY"),T=this.life/1e3;this.velocityX=(E-this.x)/T,this.velocityY=(x-this.y)/T}else this.velocityX=f,this.velocityY=m;return p.acceleration&&(this.accelerationX=g.accelerationX.onEmit(this,"accelerationX"),this.accelerationY=g.accelerationY.onEmit(this,"accelerationY")),this.maxVelocityX=g.maxVelocityX.onEmit(this,"maxVelocityX"),this.maxVelocityY=g.maxVelocityY.onEmit(this,"maxVelocityY"),this.bounce=g.bounce.onEmit(this,"bounce"),this.alpha=g.alpha.onEmit(this,"alpha"),g.color.active?this.tint=g.color.onEmit(this,"tint"):this.tint=g.tint.onEmit(this,"tint"),!0},update:function(u,d,p){if(this.lifeCurrent<=0)return this.holdCurrent>0?(this.holdCurrent-=u,this.holdCurrent<=0):!0;if(this.delayCurrent>0)return this.delayCurrent-=u,!1;this.anims&&this.anims.update(0,u);var g=this.emitter,c=g.ops,f=1-this.lifeCurrent/this.life;if(this.lifeT=f,this.x=c.x.onUpdate(this,"x",f,this.x),this.y=c.y.onUpdate(this,"y",f,this.y),g.moveTo){var m=c.moveToX.onUpdate(this,"moveToX",f,g.moveToX),v=c.moveToY.onUpdate(this,"moveToY",f,g.moveToY),E=this.lifeCurrent/1e3;this.velocityX=(m-this.x)/E,this.velocityY=(v-this.y)/E}return this.computeVelocity(g,u,d,p,f),this.scaleX=c.scaleX.onUpdate(this,"scaleX",f,this.scaleX),c.scaleY.active?this.scaleY=c.scaleY.onUpdate(this,"scaleY",f,this.scaleY):this.scaleY=this.scaleX,this.angle=c.rotate.onUpdate(this,"rotate",f,this.angle),this.rotation=r(this.angle),g.getDeathZone(this)?(this.lifeCurrent=0,!0):(this.alpha=s(c.alpha.onUpdate(this,"alpha",f,this.alpha),0,1),c.color.active?this.tint=c.color.onUpdate(this,"color",f,this.tint):this.tint=c.tint.onUpdate(this,"tint",f,this.tint),this.lifeCurrent-=u,this.lifeCurrent<=0&&this.holdCurrent<=0)},computeVelocity:function(u,d,p,g,c){var f=u.ops,m=this.velocityX,v=this.velocityY,E=f.accelerationX.onUpdate(this,"accelerationX",c,this.accelerationX),x=f.accelerationY.onUpdate(this,"accelerationY",c,this.accelerationY),T=f.maxVelocityX.onUpdate(this,"maxVelocityX",c,this.maxVelocityX),A=f.maxVelocityY.onUpdate(this,"maxVelocityY",c,this.maxVelocityY);this.bounce=f.bounce.onUpdate(this,"bounce",c,this.bounce),m+=u.gravityX*p+E*p,v+=u.gravityY*p+x*p,m=s(m,-T,T),v=s(v,-A,A),this.velocityX=m,this.velocityY=v,this.x+=m*p,this.y+=v*p,u.worldMatrix.transformPoint(this.x,this.y,this.worldPosition);for(var P=0;P<g.length;P++){var R=g[P];R.active&&R.update(this,d,p,c)}},setSizeToFrame:function(){},getBounds:function(u){u===void 0&&(u=this.emitter.getWorldTransformMatrix());var d=Math.abs(u.scaleX)*this.scaleX,p=Math.abs(u.scaleY)*this.scaleY,g=this.x,c=this.y,f=this.rotation,m=this.frame.width*d/2,v=this.frame.height*p/2,E=this.bounds,x=new h(g-m,c-v),T=new h(g+m,c-v),A=new h(g-m,c+v),P=new h(g+m,c+v);return f!==0&&(a(x,g,c,f),a(T,g,c,f),a(A,g,c,f),a(P,g,c,f)),u.transformPoint(x.x,x.y,x),u.transformPoint(T.x,T.y,T),u.transformPoint(A.x,A.y,A),u.transformPoint(P.x,P.y,P),E.x=Math.min(x.x,T.x,A.x,P.x),E.y=Math.min(x.y,T.y,A.y,P.y),E.width=Math.max(x.x,T.x,A.x,P.x)-E.x,E.height=Math.max(x.y,T.y,A.y,P.y)-E.y,E},destroy:function(){this.anims&&this.anims.destroy(),this.anims=null,this.emitter=null,this.texture=null,this.frame=null,this.scene=null}});t.exports=l}),Lc=y((e,t)=>{var i=W(),s=Da(),n=Ut(),r=new i({Extends:s,initialize:function(o,a,h,l,u,d,p,g){u===void 0&&(u=!0),d===void 0&&(d=!0),p===void 0&&(p=!0),g===void 0&&(g=!0),s.call(this,o,a,!0),this.bounds=new n(o,a,h,l),this.collideLeft=u,this.collideRight=d,this.collideTop=p,this.collideBottom=g},update:function(o){var a=this.bounds,h=-o.bounce,l=o.worldPosition;l.x<a.x&&this.collideLeft?(o.x+=a.x-l.x,o.velocityX*=h):l.x>a.right&&this.collideRight&&(o.x-=l.x-a.right,o.velocityX*=h),l.y<a.y&&this.collideTop?(o.y+=a.y-l.y,o.velocityY*=h):l.y>a.bottom&&this.collideBottom&&(o.y-=l.y-a.bottom,o.velocityY*=h)}});t.exports=r}),Dc=y((e,t)=>{var i=W(),s=new i({initialize:function(n,r){this.source=n,this.killOnEnter=r},willKill:function(n){var r=n.worldPosition,o=this.source.contains(r.x,r.y);return o&&this.killOnEnter||!o&&!this.killOnEnter}});t.exports=s}),kc=y((e,t)=>{var i=W(),s=new i({initialize:function(n,r,o,a,h,l){a===void 0&&(a=!1),h===void 0&&(h=!0),l===void 0&&(l=-1),this.source=n,this.points=[],this.quantity=r,this.stepRate=o,this.yoyo=a,this.counter=-1,this.seamless=h,this._length=0,this._direction=0,this.total=l,this.updateSource()},updateSource:function(){if(this.points=this.source.getPoints(this.quantity,this.stepRate),this.seamless){var n=this.points[0],r=this.points[this.points.length-1];n.x===r.x&&n.y===r.y&&this.points.pop()}var o=this._length;return this._length=this.points.length,this._length<o&&this.counter>this._length&&(this.counter=this._length-1),this},changeSource:function(n){return this.source=n,this.updateSource()},getPoint:function(n){this._direction===0?(this.counter++,this.counter>=this._length&&(this.yoyo?(this._direction=1,this.counter=this._length-1):this.counter=0)):(this.counter--,this.counter===-1&&(this.yoyo?(this._direction=0,this.counter=0):this.counter=this._length-1));var r=this.points[this.counter];r&&(n.x=r.x,n.y=r.y)}});t.exports=s}),Fc=y((e,t)=>{var i=function(s,n){for(var r=0;r<n.length;r++)if(s.hasOwnProperty(n[r]))return!0;return!1};t.exports=i}),jn=y((e,t)=>{var i=Xi(),s=function(n,r){var o=i(n);for(var a in r)o.hasOwnProperty(a)&&(o[a]=r[a]);return o};t.exports=s}),Nc=y((e,t)=>{var i=W(),s=xt(),n=new i({initialize:function(r){this.source=r,this._tempVec=new s,this.total=-1},getPoint:function(r){var o=this._tempVec;this.source.getRandomPoint(o),r.x=o.x,r.y=o.y}});t.exports=n}),JS=y((e,t)=>{var i=Pa(),s=Re(),n=Se(),r=new s,o=new s,a=new s,h=new s,l=function(u,d,p,g){var c=u.pipelines.set(d.pipeline),f=r,m=o,v=a,E=h;g?(E.loadIdentity(),E.multiply(g),E.translate(d.x,d.y),E.rotate(d.rotation),E.scale(d.scaleX,d.scaleY)):E.applyITRS(d.x,d.y,d.rotation,d.scaleX,d.scaleY);var x=n.getTintAppendFloatAlpha,T=p.alpha,A=d.alpha;u.pipelines.preBatch(d);var P=d.alive,R=P.length,S=d.viewBounds;if(!(R===0||S&&!i(S,p.worldView))){d.sortCallback&&d.depthSort(),p.addToRenderList(d),f.copyFrom(p.matrix),f.multiplyWithOffset(E,-p.scrollX*d.scrollFactorX,-p.scrollY*d.scrollFactorY),u.setBlendMode(d.blendMode),d.mask&&(d.mask.preRenderWebGL(u,d,p),u.pipelines.set(d.pipeline));for(var I=d.tintFill,w,C,_=0;_<R;_++){var O=P[_],D=O.alpha*A*T;if(!(D<=0||O.scaleX===0||O.scaleY===0)){v.applyITRS(O.x,O.y,O.rotation,O.scaleX,O.scaleY),v.e=O.x,v.f=O.y,f.multiply(v,m);var F=O.frame;F.glTexture!==C&&(C=F.glTexture,w=c.setGameObject(d,F));var N=-F.halfWidth,Y=-F.halfHeight,L=m.setQuad(N,Y,N+F.width,Y+F.height),b=x(O.tint,D);c.shouldFlush(6)&&(c.flush(),w=c.setGameObject(d,F)),c.batchQuad(d,L[0],L[1],L[2],L[3],L[4],L[5],L[6],L[7],F.u0,F.v0,F.u1,F.v1,b,b,b,b,I,C,w)}}d.mask&&d.mask.postRenderWebGL(u,p),u.pipelines.postBatch(d)}};t.exports=l}),QS=y((e,t)=>{var i=Rt(),s=i,n=i;s=JS(),t.exports={renderWebGL:s,renderCanvas:n}}),ka=y((e,t)=>{var i=W(),s=be(),n=sa(),r=xc(),o=Dc(),a=kc(),h=Ic(),l=La(),u=_c(),d=He(),p=dt(),g=Hh(),c=Oc(),f=Fc(),m=Vn(),v=Sc(),E=Ra(),x=Ac(),T=jn(),A=Mc(),P=Lc(),R=Nc(),S=Ut(),I=Pa(),w=Ye(),C=QS(),_=wn(),O=Re(),D=xt(),F=Ai(),N=["active","advance","blendMode","colorEase","deathCallback","deathCallbackScope","duration","emitCallback","emitCallbackScope","follow","frequency","gravityX","gravityY","maxAliveParticles","maxParticles","name","emitting","particleBringToTop","particleClass","radial","sortCallback","sortOrderAsc","sortProperty","stopAfter","tintFill","timeScale","trackVisible","visible"],Y=["accelerationX","accelerationY","alpha","angle","bounce","color","delay","hold","lifespan","maxVelocityX","maxVelocityY","moveToX","moveToY","quantity","rotate","scaleX","scaleY","speedX","speedY","tint","x","y"],L=new i({Extends:d,Mixins:[s.AlphaSingle,s.BlendMode,s.Depth,s.Mask,s.Pipeline,s.PostPipeline,s.ScrollFactor,s.Texture,s.Transform,s.Visible,C],initialize:function(b,M,k,B,H){d.call(this,b,"ParticleEmitter"),this.particleClass=A,this.config=null,this.ops={accelerationX:new l("accelerationX",0),accelerationY:new l("accelerationY",0),alpha:new l("alpha",1),angle:new l("angle",{min:0,max:360},!0),bounce:new l("bounce",0),color:new h("color"),delay:new l("delay",0,!0),hold:new l("hold",0,!0),lifespan:new l("lifespan",1e3,!0),maxVelocityX:new l("maxVelocityX",1e4),maxVelocityY:new l("maxVelocityY",1e4),moveToX:new l("moveToX",0),moveToY:new l("moveToY",0),quantity:new l("quantity",1,!0),rotate:new l("rotate",0),scaleX:new l("scaleX",1),scaleY:new l("scaleY",1),speedX:new l("speedX",0,!0),speedY:new l("speedY",0,!0),tint:new l("tint",16777215),x:new l("x",0),y:new l("y",0)},this.radial=!0,this.gravityX=0,this.gravityY=0,this.acceleration=!1,this.moveTo=!1,this.emitCallback=null,this.emitCallbackScope=null,this.deathCallback=null,this.deathCallbackScope=null,this.maxParticles=0,this.maxAliveParticles=0,this.stopAfter=0,this.duration=0,this.frequency=0,this.emitting=!0,this.particleBringToTop=!0,this.timeScale=1,this.emitZones=[],this.deathZones=[],this.viewBounds=null,this.follow=null,this.followOffset=new D,this.trackVisible=!1,this.frames=[],this.randomFrame=!0,this.frameQuantity=1,this.anims=[],this.randomAnim=!0,this.animQuantity=1,this.dead=[],this.alive=[],this.counters=new Float32Array(10),this.skipping=!1,this.worldMatrix=new O,this.sortProperty="",this.sortOrderAsc=!0,this.sortCallback=this.depthSortCallback,this.processors=new E(this),this.tintFill=!1,this.initPipeline(),this.initPostPipeline(),this.setPosition(M,k),this.setTexture(B),H&&this.setConfig(H)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},setConfig:function(b){if(!b)return this;this.config=b;var M=0,k="",B=this.ops;for(M=0;M<Y.length;M++)k=Y[M],B[k].loadConfig(b);for(M=0;M<N.length;M++)k=N[M],m(b,k)&&(this[k]=p(b,k));if(this.acceleration=this.accelerationX!==0||this.accelerationY!==0,this.moveTo=this.moveToX!==0&&this.moveToY!==0,m(b,"speed")&&(B.speedX.loadConfig(b,"speed"),B.speedY.active=!1),(f(b,["speedX","speedY"])||this.moveTo)&&(this.radial=!1),m(b,"scale")&&(B.scaleX.loadConfig(b,"scale"),B.scaleY.active=!1),m(b,"callbackScope")){var H=p(b,"callbackScope",null);this.emitCallbackScope=H,this.deathCallbackScope=H}if(m(b,"emitZone")&&this.addEmitZone(b.emitZone),m(b,"deathZone")&&this.addDeathZone(b.deathZone),m(b,"bounds")){var z=this.addParticleBounds(b.bounds);z.collideLeft=p(b,"collideLeft",!0),z.collideRight=p(b,"collideRight",!0),z.collideTop=p(b,"collideTop",!0),z.collideBottom=p(b,"collideBottom",!0)}return m(b,"followOffset")&&this.followOffset.setFromObject(p(b,"followOffset",0)),m(b,"texture")&&this.setTexture(b.texture),m(b,"frame")?this.setEmitterFrame(b.frame):m(b,"anim")&&this.setAnim(b.anim),m(b,"reserve")&&this.reserve(b.reserve),m(b,"advance")&&this.fastForward(b.advance),this.resetCounters(this.frequency,this.emitting),this.emitting&&this.emit(u.START,this),this},updateConfig:function(b){return b&&(this.config?this.setConfig(T(this.config,b)):this.setConfig(b)),this},toJSON:function(){var b=n(this),M=0,k="";for(M=0;M<N.length;M++)k=N[M],b[k]=this[k];var B=this.ops;for(M=0;M<Y.length;M++)k=Y[M],B[k]&&(b[k]=B[k].toJSON());return B.speedY.active||(delete b.speedX,b.speed=B.speedX.toJSON()),this.scaleX===this.scaleY&&(delete b.scaleX,delete b.scaleY,b.scale=B.scaleX.toJSON()),b},resetCounters:function(b,M){var k=this.counters;k.fill(0),k[0]=b,M&&(k[5]=1)},startFollow:function(b,M,k,B){return M===void 0&&(M=0),k===void 0&&(k=0),B===void 0&&(B=!1),this.follow=b,this.followOffset.set(M,k),this.trackVisible=B,this},stopFollow:function(){return this.follow=null,this.followOffset.set(0,0),this.trackVisible=!1,this},getFrame:function(){var b=this.frames,M=b.length,k;return M===1?k=b[0]:this.randomFrame?k=g(b):(k=b[this.currentFrame],this.frameCounter++,this.frameCounter===this.frameQuantity&&(this.frameCounter=0,this.currentFrame++,this.currentFrame===M&&(this.currentFrame=0))),this.texture.get(k)},setEmitterFrame:function(b,M,k){M===void 0&&(M=!0),k===void 0&&(k=1),this.randomFrame=M,this.frameQuantity=k,this.currentFrame=0;var B=typeof b;if(this.frames.length=0,Array.isArray(b))this.frames=this.frames.concat(b);else if(B==="string"||B==="number")this.frames.push(b);else if(B==="object"){var H=b;b=p(H,"frames",null),b&&(this.frames=this.frames.concat(b));var z=p(H,"cycle",!1);this.randomFrame=!z,this.frameQuantity=p(H,"quantity",k)}return this.frames.length===1&&(this.frameQuantity=1,this.randomFrame=!1),this},getAnim:function(){var b=this.anims,M=b.length;if(M===0)return null;if(M===1)return b[0];if(this.randomAnim)return g(b);var k=b[this.currentAnim];return this.animCounter++,this.animCounter>=this.animQuantity&&(this.animCounter=0,this.currentAnim=F(this.currentAnim+1,0,M)),k},setAnim:function(b,M,k){M===void 0&&(M=!0),k===void 0&&(k=1),this.randomAnim=M,this.animQuantity=k,this.currentAnim=0;var B=typeof b;if(this.anims.length=0,Array.isArray(b))this.anims=this.anims.concat(b);else if(B==="string")this.anims.push(b);else if(B==="object"){var H=b;b=p(H,"anims",null),b&&(this.anims=this.anims.concat(b));var z=p(H,"cycle",!1);this.randomAnim=!z,this.animQuantity=p(H,"quantity",k)}return this.anims.length===1&&(this.animQuantity=1,this.randomAnim=!1),this},setRadial:function(b){return b===void 0&&(b=!0),this.radial=b,this},addParticleBounds:function(b,M,k,B,H,z,V,q){if(typeof b=="object"){var Z=b;b=Z.x,M=Z.y,k=m(Z,"w")?Z.w:Z.width,B=m(Z,"h")?Z.h:Z.height}return this.addParticleProcessor(new P(b,M,k,B,H,z,V,q))},setParticleSpeed:function(b,M){return M===void 0&&(M=b),this.ops.speedX.onChange(b),b===M?this.ops.speedY.active=!1:this.ops.speedY.onChange(M),this.radial=!0,this},setParticleScale:function(b,M){return b===void 0&&(b=1),M===void 0&&(M=b),this.ops.scaleX.onChange(b),this.ops.scaleY.onChange(M),this},setParticleGravity:function(b,M){return this.gravityX=b,this.gravityY=M,this},setParticleAlpha:function(b){return this.ops.alpha.onChange(b),this},setParticleTint:function(b){return this.ops.tint.onChange(b),this},setEmitterAngle:function(b){return this.ops.angle.onChange(b),this},setParticleLifespan:function(b){return this.ops.lifespan.onChange(b),this},setQuantity:function(b){return this.quantity=b,this},setFrequency:function(b,M){return this.frequency=b,this.flowCounter=b>0?b:0,M&&(this.quantity=M),this},addDeathZone:function(b){Array.isArray(b)||(b=[b]);for(var M,k=[],B=0;B<b.length;B++)if(M=b[B],M instanceof o)k.push(M);else if(typeof M.contains=="function")M=new o(M,!0),k.push(M);else{var H=p(M,"type","onEnter"),z=p(M,"source",null);if(z&&typeof z.contains=="function"){var V=H==="onEnter";M=new o(z,V),k.push(M)}}return this.deathZones=this.deathZones.concat(k),k},removeDeathZone:function(b){return w(this.deathZones,b),this},clearDeathZones:function(){return this.deathZones.length=0,this},addEmitZone:function(b){Array.isArray(b)||(b=[b]);for(var M,k=[],B=0;B<b.length;B++)if(M=b[B],M instanceof R||M instanceof a)k.push(M);else{var H=p(M,"source",null);if(H){var z=p(M,"type","random");if(z==="random"&&typeof H.getRandomPoint=="function")M=new R(H),k.push(M);else if(z==="edge"&&typeof H.getPoints=="function"){var V=p(M,"quantity",1),q=p(M,"stepRate",0),Z=p(M,"yoyo",!1),at=p(M,"seamless",!0),et=p(M,"total",-1);M=new a(H,V,q,Z,at,et),k.push(M)}}}return this.emitZones=this.emitZones.concat(k),k},removeEmitZone:function(b){return w(this.emitZones,b),this.zoneIndex=0,this},clearEmitZones:function(){return this.emitZones.length=0,this.zoneIndex=0,this},getEmitZone:function(b){var M=this.emitZones,k=M.length;if(k!==0){var B=M[this.zoneIndex];B.getPoint(b),B.total>-1&&(this.zoneTotal++,this.zoneTotal===B.total&&(this.zoneTotal=0,this.zoneIndex++,this.zoneIndex===k&&(this.zoneIndex=0)))}},getDeathZone:function(b){for(var M=this.deathZones,k=0;k<M.length;k++){var B=M[k];if(B.willKill(b))return this.emit(u.DEATH_ZONE,this,b,B),!0}return!1},setEmitZone:function(b){var M;return isFinite(b)?M=b:M=this.emitZones.indexOf(b),M>=0&&(this.zoneIndex=M),this},addParticleProcessor:function(b){return this.processors.exists(b)||(b.emitter&&b.emitter.removeParticleProcessor(b),this.processors.add(b),b.emitter=this),b},removeParticleProcessor:function(b){return this.processors.exists(b)&&(this.processors.remove(b,!0),b.emitter=null),b},getProcessors:function(){return this.processors.getAll("active",!0)},createGravityWell:function(b){return this.addParticleProcessor(new c(b))},reserve:function(b){var M=this.dead;if(this.maxParticles>0){var k=this.getParticleCount();k+b>this.maxParticles&&(b=this.maxParticles-(k+b))}for(var B=0;B<b;B++)M.push(new this.particleClass(this));return this},getAliveParticleCount:function(){return this.alive.length},getDeadParticleCount:function(){return this.dead.length},getParticleCount:function(){return this.getAliveParticleCount()+this.getDeadParticleCount()},atLimit:function(){return this.maxParticles>0&&this.getParticleCount()>=this.maxParticles?!0:this.maxAliveParticles>0&&this.getAliveParticleCount()>=this.maxAliveParticles},onParticleEmit:function(b,M){return b===void 0?(this.emitCallback=null,this.emitCallbackScope=null):typeof b=="function"&&(this.emitCallback=b,M&&(this.emitCallbackScope=M)),this},onParticleDeath:function(b,M){return b===void 0?(this.deathCallback=null,this.deathCallbackScope=null):typeof b=="function"&&(this.deathCallback=b,M&&(this.deathCallbackScope=M)),this},killAll:function(){for(var b=this.dead,M=this.alive;M.length>0;)b.push(M.pop());return this},forEachAlive:function(b,M){for(var k=this.alive,B=k.length,H=0;H<B;H++)b.call(M,k[H],this);return this},forEachDead:function(b,M){for(var k=this.dead,B=k.length,H=0;H<B;H++)b.call(M,k[H],this);return this},start:function(b,M){return b===void 0&&(b=0),this.emitting||(b>0&&this.fastForward(b),this.emitting=!0,this.resetCounters(this.frequency,!0),M!==void 0&&(this.duration=Math.abs(M)),this.emit(u.START,this)),this},stop:function(b){return b===void 0&&(b=!1),this.emitting&&(this.emitting=!1,b&&this.killAll(),this.emit(u.STOP,this)),this},pause:function(){return this.active=!1,this},resume:function(){return this.active=!0,this},setSortProperty:function(b,M){return b===void 0&&(b=""),M===void 0&&(M=this.true),this.sortProperty=b,this.sortOrderAsc=M,this.sortCallback=this.depthSortCallback,this},setSortCallback:function(b){return this.sortProperty!==""?b=this.depthSortCallback:b=null,this.sortCallback=b,this},depthSort:function(){return _(this.alive,this.sortCallback.bind(this)),this},depthSortCallback:function(b,M){var k=this.sortProperty;return this.sortOrderAsc?b[k]-M[k]:M[k]-b[k]},flow:function(b,M,k){return M===void 0&&(M=1),this.emitting=!1,this.frequency=b,this.quantity=M,k!==void 0&&(this.stopAfter=k),this.start()},explode:function(b,M,k){this.frequency=-1,this.resetCounters(-1,!0);var B=this.emitParticle(b,M,k);return this.emit(u.EXPLODE,this,B),B},emitParticleAt:function(b,M,k){return this.emitParticle(k,b,M)},emitParticle:function(b,M,k){if(!this.atLimit()){b===void 0&&(b=this.ops.quantity.onEmit());for(var B=this.dead,H=this.stopAfter,z=this.follow?this.follow.x+this.followOffset.x:M,V=this.follow?this.follow.y+this.followOffset.y:k,q=0;q<b;q++){var Z=B.pop();if(Z||(Z=new this.particleClass(this)),Z.fire(z,V)?(this.particleBringToTop?this.alive.push(Z):this.alive.unshift(Z),this.emitCallback&&this.emitCallback.call(this.emitCallbackScope,Z,this)):this.dead.push(Z),H>0&&(this.stopCounter++,this.stopCounter>=H)||this.atLimit())break}return Z}},fastForward:function(b,M){M===void 0&&(M=1e3/60);var k=0;for(this.skipping=!0;k<Math.abs(b);)this.preUpdate(0,M),k+=M;return this.skipping=!1,this},preUpdate:function(b,M){M*=this.timeScale;var k=M/1e3;this.trackVisible&&(this.visible=this.follow.visible),this.getWorldTransformMatrix(this.worldMatrix);var B=this.getProcessors(),H=this.alive,z=this.dead,V=0,q=[],Z=H.length;for(V=0;V<Z;V++){var at=H[V];at.update(M,k,B)&&q.push({index:V,particle:at})}if(Z=q.length,Z>0){var et=this.deathCallback,st=this.deathCallbackScope;for(V=Z-1;V>=0;V--){var Q=q[V];H.splice(Q.index,1),z.push(Q.particle),et&&et.call(st,Q.particle),Q.particle.setPosition()}}if(!this.emitting&&!this.skipping){this.completeFlag===1&&H.length===0&&(this.completeFlag=0,this.emit(u.COMPLETE,this));return}if(this.frequency===0)this.emitParticle();else if(this.frequency>0)for(this.flowCounter-=M;this.flowCounter<=0;)this.emitParticle(),this.flowCounter+=this.frequency;this.skipping||(this.duration>0&&(this.elapsed+=M,this.elapsed>=this.duration&&this.stop()),this.stopAfter>0&&this.stopCounter>=this.stopAfter&&this.stop())},overlap:function(b){for(var M=this.getWorldTransformMatrix(),k=this.alive,B=k.length,H=[],z=0;z<B;z++){var V=k[z];I(b,V.getBounds(M))&&H.push(V)}return H},getBounds:function(b,M,k,B){b===void 0&&(b=0),M===void 0&&(M=0),k===void 0&&(k=1e3/60),B===void 0&&(B=new S);var H=this.getWorldTransformMatrix(),z,V,q=this.alive,Z=!1;if(B.setTo(0,0,0,0),M>0){var at=0;for(this.skipping=!0;at<Math.abs(M);){for(this.preUpdate(0,k),z=0;z<q.length;z++)V=q[z].getBounds(H),Z?x(B,V):(Z=!0,r(V,B));at+=k}this.skipping=!1}else for(z=0;z<q.length;z++)V=q[z].getBounds(H),Z?x(B,V):(Z=!0,r(V,B));return b>0&&v(B,b,b),B},createEmitter:function(){throw new Error("createEmitter removed. See ParticleEmitter docs for info")},particleX:{get:function(){return this.ops.x.current},set:function(b){this.ops.x.onChange(b)}},particleY:{get:function(){return this.ops.y.current},set:function(b){this.ops.y.onChange(b)}},accelerationX:{get:function(){return this.ops.accelerationX.current},set:function(b){this.ops.accelerationX.onChange(b)}},accelerationY:{get:function(){return this.ops.accelerationY.current},set:function(b){this.ops.accelerationY.onChange(b)}},maxVelocityX:{get:function(){return this.ops.maxVelocityX.current},set:function(b){this.ops.maxVelocityX.onChange(b)}},maxVelocityY:{get:function(){return this.ops.maxVelocityY.current},set:function(b){this.ops.maxVelocityY.onChange(b)}},speed:{get:function(){return this.ops.speedX.current},set:function(b){this.ops.speedX.onChange(b),this.ops.speedY.onChange(b)}},speedX:{get:function(){return this.ops.speedX.current},set:function(b){this.ops.speedX.onChange(b)}},speedY:{get:function(){return this.ops.speedY.current},set:function(b){this.ops.speedY.onChange(b)}},moveToX:{get:function(){return this.ops.moveToX.current},set:function(b){this.ops.moveToX.onChange(b)}},moveToY:{get:function(){return this.ops.moveToY.current},set:function(b){this.ops.moveToY.onChange(b)}},bounce:{get:function(){return this.ops.bounce.current},set:function(b){this.ops.bounce.onChange(b)}},particleScaleX:{get:function(){return this.ops.scaleX.current},set:function(b){this.ops.scaleX.onChange(b)}},particleScaleY:{get:function(){return this.ops.scaleY.current},set:function(b){this.ops.scaleY.onChange(b)}},particleColor:{get:function(){return this.ops.color.current},set:function(b){this.ops.color.onChange(b)}},colorEase:{get:function(){return this.ops.color.easeName},set:function(b){this.ops.color.setEase(b)}},particleTint:{get:function(){return this.ops.tint.current},set:function(b){this.ops.tint.onChange(b)}},particleAlpha:{get:function(){return this.ops.alpha.current},set:function(b){this.ops.alpha.onChange(b)}},lifespan:{get:function(){return this.ops.lifespan.current},set:function(b){this.ops.lifespan.onChange(b)}},particleAngle:{get:function(){return this.ops.angle.current},set:function(b){this.ops.angle.onChange(b)}},particleRotate:{get:function(){return this.ops.rotate.current},set:function(b){this.ops.rotate.onChange(b)}},quantity:{get:function(){return this.ops.quantity.current},set:function(b){this.ops.quantity.onChange(b)}},delay:{get:function(){return this.ops.delay.current},set:function(b){this.ops.delay.onChange(b)}},hold:{get:function(){return this.ops.hold.current},set:function(b){this.ops.hold.onChange(b)}},flowCounter:{get:function(){return this.counters[0]},set:function(b){this.counters[0]=b}},frameCounter:{get:function(){return this.counters[1]},set:function(b){this.counters[1]=b}},animCounter:{get:function(){return this.counters[2]},set:function(b){this.counters[2]=b}},elapsed:{get:function(){return this.counters[3]},set:function(b){this.counters[3]=b}},stopCounter:{get:function(){return this.counters[4]},set:function(b){this.counters[4]=b}},completeFlag:{get:function(){return this.counters[5]},set:function(b){this.counters[5]=b}},zoneIndex:{get:function(){return this.counters[6]},set:function(b){this.counters[6]=b}},zoneTotal:{get:function(){return this.counters[7]},set:function(b){this.counters[7]=b}},currentFrame:{get:function(){return this.counters[8]},set:function(b){this.counters[8]=b}},currentAnim:{get:function(){return this.counters[9]},set:function(b){this.counters[9]=b}},preDestroy:function(){this.texture=null,this.frames=null,this.anims=null,this.emitCallback=null,this.emitCallbackScope=null,this.deathCallback=null,this.deathCallbackScope=null,this.emitZones=null,this.deathZones=null,this.bounds=null,this.follow=null,this.counters=null;var b,M=this.ops;for(b=0;b<Y.length;b++){var k=Y[b];M[k].destroy()}for(b=0;b<this.alive.length;b++)this.alive[b].destroy();for(b=0;b<this.dead.length;b++)this.dead[b].destroy();this.ops=null,this.alive=[],this.dead=[],this.worldMatrix.destroy()}});t.exports=L}),$S=y((e,t)=>{t.exports={DeathZone:Dc(),EdgeZone:kc(),RandomZone:Nc()}}),t1=y((e,t)=>{t.exports={EmitterColorOp:Ic(),EmitterOp:La(),Events:_c(),GravityWell:Oc(),Particle:Mc(),ParticleBounds:Lc(),ParticleEmitter:ka(),ParticleProcessor:Da(),Zones:$S()}}),e1=y((e,t)=>{var i=function(s,n,r){var o=s.canvas,a=s.context,h=s.style,l=[],u=0,d=r.length;h.maxLines>0&&h.maxLines<r.length&&(d=h.maxLines),h.syncFont(o,a);for(var p=s.letterSpacing,g=0;g<d;g++){var c=h.strokeThickness;if(p===0)c+=a.measureText(r[g]).width;else{for(var f=r[g],m=0;m<f.length;m++)c+=a.measureText(f[m]).width;f.length>1&&(c+=p*(f.length-1))}h.wordWrap&&(c-=a.measureText(" ").width),l[g]=Math.ceil(c),u=Math.max(u,l[g])}var v=n.fontSize+h.strokeThickness,E=v*d,x=s.lineSpacing;return d>1&&(E+=x*(d-1)),{width:u,height:E,lines:d,lineWidths:l,lineSpacing:x,lineHeight:v}};t.exports=i}),i1=y((e,t)=>{var i=function(s){s.parentNode&&s.parentNode.removeChild(s)};t.exports=i}),s1=y((e,t)=>{var i=Se(),s=function(n,r,o,a){if(!(r.width===0||r.height===0)){o.addToRenderList(r);var h=r.frame,l=h.width,u=h.height,d=i.getTintAppendFloatAlpha,p=n.pipelines.set(r.pipeline,r),g=p.setTexture2D(h.glTexture,r);p.batchTexture(r,h.glTexture,l,u,r.x,r.y,l/r.style.resolution,u/r.style.resolution,r.scaleX,r.scaleY,r.rotation,r.flipX,r.flipY,r.scrollFactorX,r.scrollFactorY,r.displayOriginX,r.displayOriginY,0,0,l,u,d(r.tintTopLeft,o.alpha*r._alphaTL),d(r.tintTopRight,o.alpha*r._alphaTR),d(r.tintBottomLeft,o.alpha*r._alphaBL),d(r.tintBottomRight,o.alpha*r._alphaBR),r.tintFill,0,0,o,a,!1,g)}};t.exports=s}),n1=y((e,t)=>{var i=Rt(),s=i,n=i;s=s1(),t.exports={renderWebGL:s,renderCanvas:n}}),r1=y((e,t)=>{var i=xe(),s=function(n){var r=i.create(this),o=r.getContext("2d",{willReadFrequently:!0});n.syncFont(r,o);var a=o.measureText(n.testString);if("actualBoundingBoxAscent"in a){var h=a.actualBoundingBoxAscent,l=a.actualBoundingBoxDescent;return i.remove(r),{ascent:h,descent:l,fontSize:h+l}}var u=Math.ceil(a.width*n.baselineX),d=u,p=2*d;d=d*n.baselineY|0,r.width=u,r.height=p,o.fillStyle="#f00",o.fillRect(0,0,u,p),o.font=n._font,o.textBaseline="alphabetic",o.fillStyle="#000",o.fillText(n.testString,0,d);var g={ascent:0,descent:0,fontSize:0},c=o.getImageData(0,0,u,p);if(!c)return g.ascent=d,g.descent=d+6,g.fontSize=g.ascent+g.descent,i.remove(r),g;var f=c.data,m=f.length,v=u*4,E,x,T=0,A=!1;for(E=0;E<d;E++){for(x=0;x<v;x+=4)if(f[T+x]!==255){A=!0;break}if(!A)T+=v;else break}for(g.ascent=d-E,T=m-v,A=!1,E=p;E>d;E--){for(x=0;x<v;x+=4)if(f[T+x]!==255){A=!0;break}if(!A)T-=v;else break}return g.descent=E-d,g.fontSize=g.ascent+g.descent,i.remove(r),g};t.exports=s}),a1=y((e,t)=>{var i=W(),s=le(),n=St(),r=r1(),o={fontFamily:["fontFamily","Courier"],fontSize:["fontSize","16px"],fontStyle:["fontStyle",""],backgroundColor:["backgroundColor",null],color:["color","#fff"],stroke:["stroke","#fff"],strokeThickness:["strokeThickness",0],shadowOffsetX:["shadow.offsetX",0],shadowOffsetY:["shadow.offsetY",0],shadowColor:["shadow.color","#000"],shadowBlur:["shadow.blur",0],shadowStroke:["shadow.stroke",!1],shadowFill:["shadow.fill",!1],align:["align","left"],maxLines:["maxLines",0],fixedWidth:["fixedWidth",0],fixedHeight:["fixedHeight",0],resolution:["resolution",0],rtl:["rtl",!1],testString:["testString","|M\xC3\u2030qgy"],baselineX:["baselineX",1.2],baselineY:["baselineY",1.4],wordWrapWidth:["wordWrap.width",null],wordWrapCallback:["wordWrap.callback",null],wordWrapCallbackScope:["wordWrap.callbackScope",null],wordWrapUseAdvanced:["wordWrap.useAdvancedWrap",!1]},a=new i({initialize:function(h,l){this.parent=h,this.fontFamily,this.fontSize,this.fontStyle,this.backgroundColor,this.color,this.stroke,this.strokeThickness,this.shadowOffsetX,this.shadowOffsetY,this.shadowColor,this.shadowBlur,this.shadowStroke,this.shadowFill,this.align,this.maxLines,this.fixedWidth,this.fixedHeight,this.resolution,this.rtl,this.testString,this.baselineX,this.baselineY,this.wordWrapWidth,this.wordWrapCallback,this.wordWrapCallbackScope,this.wordWrapUseAdvanced,this._font,this.setStyle(l,!1,!0)},setStyle:function(h,l,u){l===void 0&&(l=!0),u===void 0&&(u=!1);for(var d in o){var p=u?o[d][1]:this[d];d==="wordWrapCallback"||d==="wordWrapCallbackScope"?this[d]=n(h,o[d][0],p):h&&d==="fontSize"&&typeof h.fontSize=="number"?this[d]=h.fontSize.toString()+"px":this[d]=s(h,o[d][0],p)}var g=n(h,"font",null);g!==null&&this.setFont(g,!1),this._font=[this.fontStyle,this.fontSize,this.fontFamily].join(" ").trim();var c=n(h,"fill",null);c!==null&&(this.color=c);var f=n(h,"metrics",!1);return f?this.metrics={ascent:n(f,"ascent",0),descent:n(f,"descent",0),fontSize:n(f,"fontSize",0)}:(l||!this.metrics)&&(this.metrics=r(this)),l?this.parent.updateText():this.parent},syncFont:function(h,l){l.font=this._font},syncStyle:function(h,l){l.textBaseline="alphabetic",l.fillStyle=this.color,l.strokeStyle=this.stroke,l.lineWidth=this.strokeThickness,l.lineCap="round",l.lineJoin="round"},syncShadow:function(h,l){l?(h.shadowOffsetX=this.shadowOffsetX,h.shadowOffsetY=this.shadowOffsetY,h.shadowColor=this.shadowColor,h.shadowBlur=this.shadowBlur):(h.shadowOffsetX=0,h.shadowOffsetY=0,h.shadowColor=0,h.shadowBlur=0)},update:function(h){return h&&(this._font=[this.fontStyle,this.fontSize,this.fontFamily].join(" ").trim(),this.metrics=r(this)),this.parent.updateText()},setFont:function(h,l){l===void 0&&(l=!0);var u=h,d="",p="";if(typeof h!="string")u=n(h,"fontFamily","Courier"),d=n(h,"fontSize","16px"),p=n(h,"fontStyle","");else{var g=h.split(" "),c=0;p=g.length>2?g[c++]:"",d=g[c++]||"16px",u=g[c++]||"Courier"}return(u!==this.fontFamily||d!==this.fontSize||p!==this.fontStyle)&&(this.fontFamily=u,this.fontSize=d,this.fontStyle=p,l&&this.update(!0)),this.parent},setFontFamily:function(h){return this.fontFamily!==h&&(this.fontFamily=h,this.update(!0)),this.parent},setFontStyle:function(h){return this.fontStyle!==h&&(this.fontStyle=h,this.update(!0)),this.parent},setFontSize:function(h){return typeof h=="number"&&(h=h.toString()+"px"),this.fontSize!==h&&(this.fontSize=h,this.update(!0)),this.parent},setTestString:function(h){return this.testString=h,this.update(!0)},setFixedSize:function(h,l){return this.fixedWidth=h,this.fixedHeight=l,h&&(this.parent.width=h),l&&(this.parent.height=l),this.update(!1)},setBackgroundColor:function(h){return this.backgroundColor=h,this.update(!1)},setFill:function(h){return this.color=h,this.update(!1)},setColor:function(h){return this.color=h,this.update(!1)},setResolution:function(h){return this.resolution=h,this.update(!1)},setStroke:function(h,l){return l===void 0&&(l=this.strokeThickness),h===void 0&&this.strokeThickness!==0?(this.strokeThickness=0,this.update(!0)):(this.stroke!==h||this.strokeThickness!==l)&&(this.stroke=h,this.strokeThickness=l,this.update(!0)),this.parent},setShadow:function(h,l,u,d,p,g){return h===void 0&&(h=0),l===void 0&&(l=0),u===void 0&&(u="#000"),d===void 0&&(d=0),p===void 0&&(p=!1),g===void 0&&(g=!0),this.shadowOffsetX=h,this.shadowOffsetY=l,this.shadowColor=u,this.shadowBlur=d,this.shadowStroke=p,this.shadowFill=g,this.update(!1)},setShadowOffset:function(h,l){return h===void 0&&(h=0),l===void 0&&(l=h),this.shadowOffsetX=h,this.shadowOffsetY=l,this.update(!1)},setShadowColor:function(h){return h===void 0&&(h="#000"),this.shadowColor=h,this.update(!1)},setShadowBlur:function(h){return h===void 0&&(h=0),this.shadowBlur=h,this.update(!1)},setShadowStroke:function(h){return this.shadowStroke=h,this.update(!1)},setShadowFill:function(h){return this.shadowFill=h,this.update(!1)},setWordWrapWidth:function(h,l){return l===void 0&&(l=!1),this.wordWrapWidth=h,this.wordWrapUseAdvanced=l,this.update(!1)},setWordWrapCallback:function(h,l){return l===void 0&&(l=null),this.wordWrapCallback=h,this.wordWrapCallbackScope=l,this.update(!1)},setAlign:function(h){return h===void 0&&(h="left"),this.align=h,this.update(!1)},setMaxLines:function(h){return h===void 0&&(h=0),this.maxLines=h,this.update(!1)},getTextMetrics:function(){var h=this.metrics;return{ascent:h.ascent,descent:h.descent,fontSize:h.fontSize}},toJSON:function(){var h={};for(var l in o)h[l]=this[l];return h.metrics=this.getTextMetrics(),h},destroy:function(){this.parent=void 0}});t.exports=a}),Bc=y((e,t)=>{var i=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){var n=Math.random()*16|0,r=s==="x"?n:n&3|8;return r.toString(16)})};t.exports=i}),Fa=y((e,t)=>{var i=Ta(),s=xe(),n=W(),r=be(),o=He(),a=e1(),h=St(),l=i1(),u=n1(),d=a1(),p=Bc(),g=new n({Extends:o,Mixins:[r.Alpha,r.BlendMode,r.ComputedSize,r.Crop,r.Depth,r.Flip,r.GetBounds,r.Mask,r.Origin,r.Pipeline,r.PostPipeline,r.ScrollFactor,r.Tint,r.Transform,r.Visible,u],initialize:function(c,f,m,v,E){f===void 0&&(f=0),m===void 0&&(m=0),o.call(this,c,"Text"),this.renderer=c.sys.renderer,this.setPosition(f,m),this.setOrigin(0,0),this.initPipeline(),this.initPostPipeline(!0),this.canvas=s.create(this),this.context,this.style=new d(this,E),this.autoRound=!0,this.splitRegExp=/(?:\r\n|\r|\n)/,this._text=void 0,this.padding={left:0,right:0,top:0,bottom:0},this.width=1,this.height=1,this.lineSpacing=0,this.letterSpacing=0,this.style.resolution===0&&(this.style.resolution=1),this._crop=this.resetCropObject(),this._textureKey=p(),this.texture=c.sys.textures.addCanvas(this._textureKey,this.canvas),this.context=this.texture.context,this.frame=this.texture.get(),this.frame.source.resolution=this.style.resolution,this.renderer&&this.renderer.gl&&(this.renderer.deleteTexture(this.frame.source.glTexture),this.frame.source.glTexture=null),this.initRTL(),this.setText(v),E&&E.padding&&this.setPadding(E.padding),E&&E.lineSpacing&&this.setLineSpacing(E.lineSpacing),E&&E.letterSpacing&&this.setLetterSpacing(E.letterSpacing)},initRTL:function(){this.style.rtl&&(this.canvas.dir="rtl",this.context.direction="rtl",this.canvas.style.display="none",i(this.canvas,this.scene.sys.canvas),this.originX=1)},runWordWrap:function(c){var f=this.style;if(f.wordWrapCallback){var m=f.wordWrapCallback.call(f.wordWrapCallbackScope,c,this);return Array.isArray(m)&&(m=m.join(`
`)),m}else return f.wordWrapWidth?f.wordWrapUseAdvanced?this.advancedWordWrap(c,this.context,this.style.wordWrapWidth):this.basicWordWrap(c,this.context,this.style.wordWrapWidth):c},advancedWordWrap:function(c,f,m){for(var v="",E=c.replace(/ +/gi," ").split(this.splitRegExp),x=E.length,T=0;T<x;T++){var A=E[T],P="";A=A.replace(/^ *|\s*$/gi,"");var R=A.length*this.letterSpacing,S=f.measureText(A).width+R;if(S<m){v+=A+`
`;continue}for(var I=m,w=A.split(" "),C=0;C<w.length;C++){var _=w[C],O=_+" ",D=O.length*this.letterSpacing,F=f.measureText(O).width+D;if(F>I){if(C===0){for(var N=O;N.length;){N=N.slice(0,-1);var Y=N.length*this.letterSpacing;if(F=f.measureText(N).width+Y,F<=I)break}if(!N.length)throw new Error("wordWrapWidth < a single character");var L=_.substr(N.length);w[C]=L,P+=N}var b=w[C].length?C:C+1,M=w.slice(b).join(" ").replace(/[ \n]*$/gi,"");E.splice(T+1,0,M),x=E.length;break}else P+=O,I-=F}v+=P.replace(/[ \n]*$/gi,"")+`
`}return v=v.replace(/[\s|\n]*$/gi,""),v},basicWordWrap:function(c,f,m){for(var v="",E=c.split(this.splitRegExp),x=E.length-1,T=f.measureText(" ").width,A=0;A<=x;A++){for(var P=m,R=E[A].split(" "),S=R.length-1,I=0;I<=S;I++){var w=R[I],C=w.length*this.letterSpacing,_=f.measureText(w).width+C,O=_;I<S&&(O+=T),O>P&&I>0&&(v+=`
`,P=m),v+=w,I<S?(v+=" ",P-=O):P-=_}A<x&&(v+=`
`)}return v},getWrappedText:function(c){c===void 0&&(c=this._text),this.style.syncFont(this.canvas,this.context);var f=this.runWordWrap(c);return f.split(this.splitRegExp)},setText:function(c){return!c&&c!==0&&(c=""),Array.isArray(c)&&(c=c.join(`
`)),c!==this._text&&(this._text=c.toString(),this.updateText()),this},appendText:function(c,f){f===void 0&&(f=!0),!c&&c!==0&&(c=""),Array.isArray(c)&&(c=c.join(`
`)),c=c.toString();var m=this._text.concat(f?`
`+c:c);return m!==this._text&&(this._text=m,this.updateText()),this},setStyle:function(c){return this.style.setStyle(c)},setFont:function(c){return this.style.setFont(c)},setFontFamily:function(c){return this.style.setFontFamily(c)},setFontSize:function(c){return this.style.setFontSize(c)},setFontStyle:function(c){return this.style.setFontStyle(c)},setFixedSize:function(c,f){return this.style.setFixedSize(c,f)},setBackgroundColor:function(c){return this.style.setBackgroundColor(c)},setFill:function(c){return this.style.setFill(c)},setColor:function(c){return this.style.setColor(c)},setStroke:function(c,f){return this.style.setStroke(c,f)},setShadow:function(c,f,m,v,E,x){return this.style.setShadow(c,f,m,v,E,x)},setShadowOffset:function(c,f){return this.style.setShadowOffset(c,f)},setShadowColor:function(c){return this.style.setShadowColor(c)},setShadowBlur:function(c){return this.style.setShadowBlur(c)},setShadowStroke:function(c){return this.style.setShadowStroke(c)},setShadowFill:function(c){return this.style.setShadowFill(c)},setWordWrapWidth:function(c,f){return this.style.setWordWrapWidth(c,f)},setWordWrapCallback:function(c,f){return this.style.setWordWrapCallback(c,f)},setAlign:function(c){return this.style.setAlign(c)},setResolution:function(c){return this.style.setResolution(c)},setLineSpacing:function(c){return this.lineSpacing=c,this.updateText()},setLetterSpacing:function(c){return this.letterSpacing=c,this.updateText()},setPadding:function(c,f,m,v){if(typeof c=="object"){var E=c,x=h(E,"x",null);x!==null?(c=x,m=x):(c=h(E,"left",0),m=h(E,"right",c));var T=h(E,"y",null);T!==null?(f=T,v=T):(f=h(E,"top",0),v=h(E,"bottom",f))}else c===void 0&&(c=0),f===void 0&&(f=c),m===void 0&&(m=c),v===void 0&&(v=f);return this.padding.left=c,this.padding.top=f,this.padding.right=m,this.padding.bottom=v,this.updateText()},setMaxLines:function(c){return this.style.setMaxLines(c)},setRTL:function(c){c===void 0&&(c=!0);var f=this.style;return f.rtl===c?this:(f.rtl=c,c?(this.canvas.dir="rtl",this.context.direction="rtl",this.canvas.style.display="none",i(this.canvas,this.scene.sys.canvas)):(this.canvas.dir="ltr",this.context.direction="ltr"),f.align==="left"?f.align="right":f.align==="right"&&(f.align="left"),this)},updateText:function(){var c=this.canvas,f=this.context,m=this.style,v=m.resolution,E=m.metrics;m.syncFont(c,f);var x=this._text;(m.wordWrapWidth||m.wordWrapCallback)&&(x=this.runWordWrap(this._text));var T=x.split(this.splitRegExp),A=a(this,E,T),P=this.padding,R;m.fixedWidth===0?(this.width=A.width+P.left+P.right,R=A.width):(this.width=m.fixedWidth,R=this.width-P.left-P.right,R<A.width&&(R=A.width)),m.fixedHeight===0?this.height=A.height+P.top+P.bottom:this.height=m.fixedHeight;var S=this.width,I=this.height;this.updateDisplayOrigin(),S*=v,I*=v,S=Math.max(S,1),I=Math.max(I,1),c.width!==S||c.height!==I?(c.width=S,c.height=I,this.frame.setSize(S,I),m.syncFont(c,f),m.rtl&&(f.direction="rtl")):f.clearRect(0,0,S,I),f.save(),f.scale(v,v),m.backgroundColor&&(f.fillStyle=m.backgroundColor,f.fillRect(0,0,S,I)),m.syncStyle(c,f),f.translate(P.left,P.top);for(var w,C,_=0;_<A.lines;_++){if(w=m.strokeThickness/2,C=m.strokeThickness/2+_*A.lineHeight+E.ascent,_>0&&(C+=A.lineSpacing*_),m.rtl)w=S-w-P.left-P.right;else if(m.align==="right")w+=R-A.lineWidths[_];else if(m.align==="center")w+=(R-A.lineWidths[_])/2;else if(m.align==="justify"){var O=.85;if(A.lineWidths[_]/A.width>=O){var D=A.width-A.lineWidths[_],F=f.measureText(" ").width,N=T[_].trim(),Y=N.split(" ");D+=(T[_].length-N.length)*F;for(var L=Math.floor(D/F),b=0;L>0;)Y[b]+=" ",b=(b+1)%(Y.length-1||1),--L;T[_]=Y.join(" ")}}this.autoRound&&(w=Math.round(w),C=Math.round(C));var M=this.letterSpacing;if(m.strokeThickness&&M===0&&(m.syncShadow(f,m.shadowStroke),f.strokeText(T[_],w,C)),m.color)if(m.syncShadow(f,m.shadowFill),M!==0)for(var k=0,B=T[_].split(""),H=0;H<B.length;H++)m.strokeThickness&&(m.syncShadow(f,m.shadowStroke),f.strokeText(B[H],w+k,C),m.syncShadow(f,m.shadowFill)),f.fillText(B[H],w+k,C),k+=f.measureText(B[H]).width+M;else f.fillText(T[_],w,C)}f.restore(),this.renderer&&this.renderer.gl&&(this.frame.source.glTexture=this.renderer.canvasToTexture(c,this.frame.source.glTexture,!0));var z=this.input;return z&&!z.customHitArea&&(z.hitArea.width=this.width,z.hitArea.height=this.height),this},getTextMetrics:function(){return this.style.getTextMetrics()},text:{get:function(){return this._text},set:function(c){this.setText(c)}},toJSON:function(){var c=r.ToJSON(this),f={autoRound:this.autoRound,text:this._text,style:this.style.toJSON(),padding:{left:this.padding.left,right:this.padding.right,top:this.padding.top,bottom:this.padding.bottom}};return c.data=f,c},preDestroy:function(){l(this.canvas),s.remove(this.canvas);var c=this.texture;c&&c.destroy()}});t.exports=g}),o1=y((e,t)=>{var i=function(s,n,r,o){r.addToRenderList(n);var a=n.list,h=a.length;if(h!==0){var l=n.localTransform;o?(l.loadIdentity(),l.multiply(o),l.translate(n.x,n.y),l.rotate(n.rotation),l.scale(n.scaleX,n.scaleY)):l.applyITRS(n.x,n.y,n.rotation,n.scaleX,n.scaleY),s.pipelines.preBatch(n);var u=n.blendMode!==-1;u||s.setBlendMode(0);for(var d=n.alpha,p=n.scrollFactorX,g=n.scrollFactorY,c=0;c<h;c++){var f=a[c];if(f.willRender(r)){var m,v,E,x;if(f.alphaTopLeft!==void 0)m=f.alphaTopLeft,v=f.alphaTopRight,E=f.alphaBottomLeft,x=f.alphaBottomRight;else{var T=f.alpha;m=T,v=T,E=T,x=T}var A=f.scrollFactorX,P=f.scrollFactorY;!u&&f.blendMode!==s.currentBlendMode&&s.setBlendMode(f.blendMode);var R=f.mask;R&&R.preRenderWebGL(s,f,r);var S=f.type;S!==s.currentType&&(s.newType=!0,s.currentType=S),s.nextTypeMatch=c<h-1?a[c+1].type===s.currentType:!1,f.setScrollFactor(A*p,P*g),f.setAlpha(m*d,v*d,E*d,x*d),f.renderWebGL(s,f,r,l,n),f.setAlpha(m,v,E,x),f.setScrollFactor(A,P),R&&R.postRenderWebGL(s,r),s.newType=!1}}s.pipelines.postBatch(n)}};t.exports=i}),h1=y((e,t)=>{var i=Rt(),s=i,n=i;s=o1(),t.exports={renderWebGL:s,renderCanvas:n}}),Na=y((e,t)=>{var i=Cn(),s=Ge(),n=W(),r=be(),o=bs(),a=He(),h=Ut(),l=h1(),u=wc(),d=xt(),p=new r.TransformMatrix,g=new n({Extends:a,Mixins:[r.AlphaSingle,r.BlendMode,r.ComputedSize,r.Depth,r.Mask,r.PostPipeline,r.Transform,r.Visible,l],initialize:function(c,f,m,v){a.call(this,c,"Container"),this.list=[],this.exclusive=!0,this.maxSize=-1,this.position=0,this.localTransform=new r.TransformMatrix,this._sortKey="",this._sysEvents=c.sys.events,this.scrollFactorX=1,this.scrollFactorY=1,this.initPostPipeline(),this.setPosition(f,m),this.setBlendMode(s.SKIP_CHECK),v&&this.add(v)},originX:{get:function(){return .5}},originY:{get:function(){return .5}},displayOriginX:{get:function(){return this.width*.5}},displayOriginY:{get:function(){return this.height*.5}},setExclusive:function(c){return c===void 0&&(c=!0),this.exclusive=c,this},getBounds:function(c){if(c===void 0&&(c=new h),c.setTo(this.x,this.y,0,0),this.parentContainer){var f=this.parentContainer.getBoundsTransformMatrix(),m=f.transformPoint(this.x,this.y);c.setTo(m.x,m.y,0,0)}if(this.list.length>0){var v=this.list,E=new h,x=!1;c.setEmpty();for(var T=0;T<v.length;T++){var A=v[T];A.getBounds&&(A.getBounds(E),x?u(E,c,c):(c.setTo(E.x,E.y,E.width,E.height),x=!0))}}return c},addHandler:function(c){c.once(o.DESTROY,this.onChildDestroyed,this),this.exclusive&&(c.parentContainer&&c.parentContainer.remove(c),c.parentContainer=this,c.removeFromDisplayList(),c.addedToScene())},removeHandler:function(c){c.off(o.DESTROY,this.remove,this),this.exclusive&&(c.parentContainer=null,c.removedFromScene(),c.addToDisplayList())},pointToContainer:function(c,f){f===void 0&&(f=new d),this.parentContainer?this.parentContainer.pointToContainer(c,f):(f.x=c.x,f.y=c.y);var m=p;return m.applyITRS(this.x,this.y,this.rotation,this.scaleX,this.scaleY),m.invert(),m.transformPoint(c.x,c.y,f),f},getBoundsTransformMatrix:function(){return this.getWorldTransformMatrix(p,this.localTransform)},add:function(c){return i.Add(this.list,c,this.maxSize,this.addHandler,this),this},addAt:function(c,f){return i.AddAt(this.list,c,f,this.maxSize,this.addHandler,this),this},getAt:function(c){return this.list[c]},getIndex:function(c){return this.list.indexOf(c)},sort:function(c,f){return c?(f===void 0&&(f=function(m,v){return m[c]-v[c]}),i.StableSort(this.list,f),this):this},getByName:function(c){return i.GetFirst(this.list,"name",c)},getRandom:function(c,f){return i.GetRandom(this.list,c,f)},getFirst:function(c,f,m,v){return i.GetFirst(this.list,c,f,m,v)},getAll:function(c,f,m,v){return i.GetAll(this.list,c,f,m,v)},count:function(c,f,m,v){return i.CountAllMatching(this.list,c,f,m,v)},swap:function(c,f){return i.Swap(this.list,c,f),this},moveTo:function(c,f){return i.MoveTo(this.list,c,f),this},moveAbove:function(c,f){return i.MoveAbove(this.list,c,f),this},moveBelow:function(c,f){return i.MoveBelow(this.list,c,f),this},remove:function(c,f){var m=i.Remove(this.list,c,this.removeHandler,this);if(f&&m){Array.isArray(m)||(m=[m]);for(var v=0;v<m.length;v++)m[v].destroy()}return this},removeAt:function(c,f){var m=i.RemoveAt(this.list,c,this.removeHandler,this);return f&&m&&m.destroy(),this},removeBetween:function(c,f,m){var v=i.RemoveBetween(this.list,c,f,this.removeHandler,this);if(m)for(var E=0;E<v.length;E++)v[E].destroy();return this},removeAll:function(c){var f=this.list;if(c){for(var m=0;m<f.length;m++)f[m]&&f[m].scene&&(f[m].off(o.DESTROY,this.onChildDestroyed,this),f[m].destroy());this.list=[]}else i.RemoveBetween(f,0,f.length,this.removeHandler,this);return this},bringToTop:function(c){return i.BringToTop(this.list,c),this},sendToBack:function(c){return i.SendToBack(this.list,c),this},moveUp:function(c){return i.MoveUp(this.list,c),this},moveDown:function(c){return i.MoveDown(this.list,c),this},reverse:function(){return this.list.reverse(),this},shuffle:function(){return i.Shuffle(this.list),this},replace:function(c,f,m){var v=i.Replace(this.list,c,f);return v&&(this.addHandler(f),this.removeHandler(c),m&&c.destroy()),this},exists:function(c){return this.list.indexOf(c)>-1},setAll:function(c,f,m,v){return i.SetAll(this.list,c,f,m,v),this},each:function(c,f){var m=[null],v,E=this.list.slice(),x=E.length;for(v=2;v<arguments.length;v++)m.push(arguments[v]);for(v=0;v<x;v++)m[0]=E[v],c.apply(f,m);return this},iterate:function(c,f){var m=[null],v;for(v=2;v<arguments.length;v++)m.push(arguments[v]);for(v=0;v<this.list.length;v++)m[0]=this.list[v],c.apply(f,m);return this},setScrollFactor:function(c,f,m){return f===void 0&&(f=c),m===void 0&&(m=!1),this.scrollFactorX=c,this.scrollFactorY=f,m&&(i.SetAll(this.list,"scrollFactorX",c),i.SetAll(this.list,"scrollFactorY",f)),this},length:{get:function(){return this.list.length}},first:{get:function(){return this.position=0,this.list.length>0?this.list[0]:null}},last:{get:function(){return this.list.length>0?(this.position=this.list.length-1,this.list[this.position]):null}},next:{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}},previous:{get:function(){return this.position>0?(this.position--,this.list[this.position]):null}},preDestroy:function(){this.removeAll(!!this.exclusive),this.localTransform.destroy(),this.list=[]},onChildDestroyed:function(c){i.Remove(this.list,c),this.exclusive&&(c.parentContainer=null,c.removedFromScene())}});t.exports=g}),l1=y((e,t)=>{var i=Oa(),s=Se(),n=function(r,o,a,h){var l=o.vertices,u=l.length;if(u!==0){a.addToRenderList(o);var d=r.pipelines.set(o.pipeline,o),p=i(o,a,h,!1).calc;r.pipelines.preBatch(o);var g=d.setGameObject(o),c=d.vertexViewF32,f=d.vertexViewU32,m=d.vertexCount*d.currentShader.vertexComponentCount-1,v=a.roundPixels,E=o.tintFill,x=a.alpha*o.alpha,T=s.getTintAppendFloatAlpha(o.tint,x),A=d.vertexAvailable(),P=-1;A<u&&(P=A);for(var R=0;R<u;R++){var S=l[R];R===P&&(d.flush(),g=d.setGameObject(o),m=0),c[++m]=p.getXRound(S.vx,S.vy,v),c[++m]=p.getYRound(S.vx,S.vy,v),c[++m]=S.u,c[++m]=S.v,c[++m]=g,c[++m]=E,f[++m]=T,d.vertexCount++,d.currentBatch.count=d.vertexCount-d.currentBatch.start}r.pipelines.postBatch(o)}};t.exports=n}),u1=y((e,t)=>{var i=Rt(),s=i,n=i;s=l1(),t.exports={renderWebGL:s,renderCanvas:n}}),c1=y((e,t)=>{var i=W(),s=Se(),n=Ms(),r=new i({Extends:n,initialize:function(o,a,h,l,u,d,p,g,c,f){d===void 0&&(d=16777215),p===void 0&&(p=1),g===void 0&&(g=0),c===void 0&&(c=0),f===void 0&&(f=0),n.call(this,o,a,h),this.vx=0,this.vy=0,this.vz=0,this.nx=g,this.ny=c,this.nz=f,this.u=l,this.v=u,this.color=d,this.alpha=p,this.tx=0,this.ty=0,this.ta=0,this.tu=l,this.tv=u},setUVs:function(o,a){return this.u=o,this.v=a,this.tu=o,this.tv=a,this},scrollUV:function(o,a){return this.tu+=o,this.tv+=a,this},scaleUV:function(o,a){return this.tu=this.u*o,this.tv=this.v*a,this},transformCoordinatesLocal:function(o,a,h,l){var u=this.x,d=this.y,p=this.z,g=o.val,c=u*g[0]+d*g[4]+p*g[8]+g[12],f=u*g[1]+d*g[5]+p*g[9]+g[13],m=u*g[2]+d*g[6]+p*g[10]+g[14],v=u*g[3]+d*g[7]+p*g[11]+g[15];this.vx=c/v*a,this.vy=-(f/v)*h,l<=0?this.vz=m/v:this.vz=-(m/v)},resize:function(o,a,h,l,u,d){return this.x=o,this.y=a,this.vx=this.x*h,this.vy=-this.y*l,this.vz=0,u<.5?this.vx+=h*(.5-u):u>.5&&(this.vx-=h*(u-.5)),d<.5?this.vy+=l*(.5-d):d>.5&&(this.vy-=l*(d-.5)),this},update:function(o,a,h,l,u,d,p,g){var c=this.vx*o+this.vy*h+u,f=this.vx*a+this.vy*l+d;return p&&(c=Math.round(c),f=Math.round(f)),this.tx=c,this.ty=f,this.ta=this.alpha*g,this},load:function(o,a,h,l,u){return o[++h]=this.tx,o[++h]=this.ty,o[++h]=this.tu,o[++h]=this.tv,o[++h]=l,o[++h]=u,a[++h]=s.getTintAppendFloatAlpha(this.color,this.ta),h}});t.exports=r}),Ba=y((e,t)=>{var i=W(),s=be(),n=He(),r=u1(),o=c1(),a=new i({Extends:n,Mixins:[s.AlphaSingle,s.BlendMode,s.Depth,s.GetBounds,s.Mask,s.Origin,s.Pipeline,s.PostPipeline,s.ScrollFactor,s.Texture,s.Transform,s.Visible,r],initialize:function(h,l,u,d,p,g,c,f,m,v,E){n.call(this,h,"NineSlice"),this._width,this._height,this._originX=.5,this._originY=.5,this._sizeComponent=!0,this.vertices=[],this.leftWidth,this.rightWidth,this.topHeight,this.bottomHeight,this.tint=16777215,this.tintFill=!1;var x=h.textures.getFrame(d,p);this.is3Slice=!v&&!E,x&&x.scale9&&(this.is3Slice=x.is3Slice);for(var T=this.is3Slice?18:54,A=0;A<T;A++)this.vertices.push(new o);this.setPosition(l,u),this.setTexture(d,p),this.setSlices(g,c,f,m,v,E,!1),this.updateDisplayOrigin(),this.initPipeline(),this.initPostPipeline()},setSlices:function(h,l,u,d,p,g,c){u===void 0&&(u=10),d===void 0&&(d=10),p===void 0&&(p=0),g===void 0&&(g=0),c===void 0&&(c=!1);var f=this.frame,m=!1;if(this.is3Slice&&c&&p!==0&&g!==0&&(m=!0),!m){if(f&&f.scale9&&!c){var v=f.data.scale9Borders,E=v.x,x=v.y;u=E,d=f.width-v.w-E,p=x,g=f.height-v.h-x,h===void 0&&(h=f.width),l===void 0&&(l=f.height)}else h===void 0&&(h=256),l===void 0&&(l=256);this._width=h,this._height=l,this.leftWidth=u,this.rightWidth=d,this.topHeight=p,this.bottomHeight=g,this.is3Slice&&(l=f.height,this._height=l,this.topHeight=l,this.bottomHeight=0),this.updateVertices(),this.updateUVs()}return this},updateUVs:function(){var h=this.leftWidth,l=this.rightWidth,u=this.topHeight,d=this.bottomHeight,p=this.frame.width,g=this.frame.height;this.updateQuadUVs(0,0,0,h/p,u/g),this.updateQuadUVs(6,h/p,0,1-l/p,u/g),this.updateQuadUVs(12,1-l/p,0,1,u/g),this.is3Slice||(this.updateQuadUVs(18,0,u/g,h/p,1-d/g),this.updateQuadUVs(24,h/p,u/g,1-l/p,1-d/g),this.updateQuadUVs(30,1-l/p,u/g,1,1-d/g),this.updateQuadUVs(36,0,1-d/g,h/p,1),this.updateQuadUVs(42,h/p,1-d/g,1-l/p,1),this.updateQuadUVs(48,1-l/p,1-d/g,1,1))},updateVertices:function(){var h=this.leftWidth,l=this.rightWidth,u=this.topHeight,d=this.bottomHeight,p=this.width,g=this.height;this.updateQuad(0,-.5,.5,-.5+h/p,.5-u/g),this.updateQuad(6,-.5+h/p,.5,.5-l/p,.5-u/g),this.updateQuad(12,.5-l/p,.5,.5,.5-u/g),this.is3Slice||(this.updateQuad(18,-.5,.5-u/g,-.5+h/p,-.5+d/g),this.updateQuad(24,-.5+h/p,.5-u/g,.5-l/p,-.5+d/g),this.updateQuad(30,.5-l/p,.5-u/g,.5,-.5+d/g),this.updateQuad(36,-.5,-.5+d/g,-.5+h/p,-.5),this.updateQuad(42,-.5+h/p,-.5+d/g,.5-l/p,-.5),this.updateQuad(48,.5-l/p,-.5+d/g,.5,-.5))},updateQuad:function(h,l,u,d,p){var g=this.width,c=this.height,f=this.originX,m=this.originY,v=this.vertices;v[h+0].resize(l,u,g,c,f,m),v[h+1].resize(l,p,g,c,f,m),v[h+2].resize(d,u,g,c,f,m),v[h+3].resize(l,p,g,c,f,m),v[h+4].resize(d,p,g,c,f,m),v[h+5].resize(d,u,g,c,f,m)},updateQuadUVs:function(h,l,u,d,p){var g=this.vertices,c=this.frame,f=c.u0,m=c.v0,v=c.u1,E=c.v1;if(f!==0||v!==1){var x=v-f;l=f+l*x,d=f+d*x}if(m!==0||E!==1){var T=E-m;u=m+u*T,p=m+p*T}g[h+0].setUVs(l,u),g[h+1].setUVs(l,p),g[h+2].setUVs(d,u),g[h+3].setUVs(l,p),g[h+4].setUVs(d,p),g[h+5].setUVs(d,u)},clearTint:function(){return this.setTint(16777215),this},setTint:function(h){return h===void 0&&(h=16777215),this.tint=h,this.tintFill=!1,this},setTintFill:function(h){return this.setTint(h),this.tintFill=!0,this},isTinted:{get:function(){return this.tint!==16777215}},width:{get:function(){return this._width},set:function(h){this._width=Math.max(h,this.leftWidth+this.rightWidth),this.updateVertices()}},height:{get:function(){return this._height},set:function(h){this.is3Slice||(this._height=Math.max(h,this.topHeight+this.bottomHeight),this.updateVertices())}},displayWidth:{get:function(){return this.scaleX*this.width},set:function(h){this.scaleX=h/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(h){this.scaleY=h/this.height}},setSize:function(h,l){this.width=h,this.height=l,this.updateDisplayOrigin();var u=this.input;return u&&!u.customHitArea&&(u.hitArea.width=this.width,u.hitArea.height=this.height),this},setDisplaySize:function(h,l){return this.displayWidth=h,this.displayHeight=l,this},originX:{get:function(){return this._originX},set:function(h){this._originX=h,this.updateVertices()}},originY:{get:function(){return this._originY},set:function(h){this._originY=h,this.updateVertices()}},setOrigin:function(h,l){return h===void 0&&(h=.5),l===void 0&&(l=h),this._originX=h,this._originY=l,this.updateVertices(),this.updateDisplayOrigin()},setSizeToFrame:function(){if(this.is3Slice){var h=this.frame.height;this._height=h,this.topHeight=h,this.bottomHeight=0}return this.updateUVs(),this},preDestroy:function(){this.vertices=[]}});t.exports=a}),d1=y(()=>{var e=Ia(),t=jt();t.register("group",function(i,s){return this.updateList.add(new e(this.scene,i,s))})}),p1=y(()=>{var e=Ma(),t=jt();t.register("graphics",function(i){return this.displayList.add(new e(this.scene,i))})}),g1=y(()=>{var e=Hn(),t=jt();t.register("image",function(i,s,n,r){return this.displayList.add(new e(this.scene,i,s,n,r))})}),f1=y(()=>{var e=jt(),t=Xn();e.register("sprite",function(i,s,n,r){return this.displayList.add(new t(this.scene,i,s,n,r))})}),m1=y(()=>{var e=jt(),t=ka();e.register("particles",function(i,s,n,r){return this.displayList.add(new t(this.scene,i,s,n,r))})}),v1=y(()=>{var e=Fa(),t=jt();t.register("text",function(i,s,n,r){return this.displayList.add(new e(this.scene,i,s,n,r))})}),E1=y(()=>{var e=Na(),t=jt();t.register("container",function(i,s,n){return this.displayList.add(new e(this.scene,i,s,n))})}),y1=y(()=>{var e=_n(),t=jt();t.register("zone",function(i,s,n,r){return this.displayList.add(new e(this.scene,i,s,n,r))})}),T1=y(()=>{var e=Ba(),t=jt();t.register("nineslice",function(i,s,n,r,o,a,h,l,u,d){return this.displayList.add(new e(this.scene,i,s,n,r,o,a,h,l,u,d))})}),x1=y(()=>{var e=de(),t=Ia();e.register("group",function(i){return new t(this.scene,null,i)})}),S1=y(()=>{var e=de(),t=Ma();e.register("graphics",function(i,s){i===void 0&&(i={}),s!==void 0&&(i.add=s);var n=new t(this.scene,i);return i.add&&this.scene.sys.displayList.add(n),n})}),A1=y(()=>{var e=Ri(),t=de(),i=le(),s=Hn();t.register("image",function(n,r){n===void 0&&(n={});var o=i(n,"key",null),a=i(n,"frame",null),h=new s(this.scene,0,0,o,a);return r!==void 0&&(n.add=r),e(this.scene,h,n),h})}),w1=y((e,t)=>{var i=le(),s=function(n,r){var o=i(r,"anims",null);if(o===null)return n;if(typeof o=="string")n.anims.play(o);else if(typeof o=="object"){var a=n.anims,h=i(o,"key",void 0);if(h){var l=i(o,"startFrame",void 0),u=i(o,"delay",0),d=i(o,"repeat",0),p=i(o,"repeatDelay",0),g=i(o,"yoyo",!1),c=i(o,"play",!1),f=i(o,"delayedPlay",0),m={key:h,delay:u,repeat:d,repeatDelay:p,yoyo:g,startFrame:l};c?a.play(m):f>0?a.playAfterDelay(m,f):a.load(m)}}return n};t.exports=s}),C1=y(()=>{var e=Ri(),t=w1(),i=de(),s=le(),n=Xn();i.register("sprite",function(r,o){r===void 0&&(r={});var a=s(r,"key",null),h=s(r,"frame",null),l=new n(this.scene,0,0,a,h);return o!==void 0&&(r.add=o),e(this.scene,l,r),t(l,r),l})}),P1=y(()=>{var e=Ri(),t=de(),i=le(),s=dt(),n=ka();t.register("particles",function(r,o){r===void 0&&(r={});var a=i(r,"key",null),h=s(r,"config",null),l=new n(this.scene,0,0,a);return o!==void 0&&(r.add=o),e(this.scene,l,r),h&&l.setConfig(h),l})}),R1=y(()=>{var e=Ri(),t=de(),i=le(),s=Fa();t.register("text",function(n,r){n===void 0&&(n={});var o=i(n,"text",""),a=i(n,"style",null),h=i(n,"padding",null);h!==null&&(a.padding=h);var l=new s(this.scene,0,0,o,a);return r!==void 0&&(n.add=r),e(this.scene,l,n),l.autoRound=i(n,"autoRound",!0),l.resolution=i(n,"resolution",1),l})}),b1=y(()=>{var e=Ri(),t=Na(),i=de(),s=le(),n=dt();i.register("container",function(r,o){r===void 0&&(r={});var a=s(r,"x",0),h=s(r,"y",0),l=n(r,"children",null),u=new t(this.scene,a,h,l);return o!==void 0&&(r.add=o),e(this.scene,u,r),u})}),I1=y(()=>{var e=de(),t=le(),i=_n();e.register("zone",function(s){var n=t(s,"x",0),r=t(s,"y",0),o=t(s,"width",1),a=t(s,"height",o);return new i(this.scene,n,r,o,a)})}),_1=y(()=>{var e=Ri(),t=de(),i=le(),s=St(),n=Ba();t.register("nineslice",function(r,o){r===void 0&&(r={});var a=i(r,"key",null),h=i(r,"frame",null),l=s(r,"width",256),u=s(r,"height",256),d=s(r,"leftWidth",10),p=s(r,"rightWidth",10),g=s(r,"topHeight",0),c=s(r,"bottomHeight",0),f=new n(this.scene,0,0,a,h,l,u,d,p,g,c);return o!==void 0&&(r.add=o),e(this.scene,f,r),f})}),Uc=y((e,t)=>{var i=function(s,n){return function(r,o,a,h){var l=s.getPixelAlpha(o,a,h.texture.key,h.frame.name);return l&&l>=n}};t.exports=i}),Gc=y((e,t)=>{var i=function(s,n,r){return{gameObject:s,enabled:!0,draggable:!1,dropZone:!1,cursor:!1,target:null,camera:null,hitArea:n,hitAreaCallback:r,hitAreaDebug:null,customHitArea:!1,localX:0,localY:0,dragState:0,dragStartX:0,dragStartY:0,dragStartXGlobal:0,dragStartYGlobal:0,dragStartCamera:null,dragX:0,dragY:0}};t.exports=i}),Yc=y((e,t)=>{var i=W(),s=new i({initialize:function(n,r){this.pad=n,this.events=n.events,this.index=r,this.value=0,this.threshold=.1},update:function(n){this.value=n},getValue:function(){return Math.abs(this.value)<this.threshold?0:this.value},destroy:function(){this.pad=null,this.events=null}});t.exports=s}),O1=y((e,t)=>{t.exports="down"}),M1=y((e,t)=>{t.exports="up"}),L1=y((e,t)=>{t.exports="connected"}),D1=y((e,t)=>{t.exports="disconnected"}),k1=y((e,t)=>{t.exports="down"}),F1=y((e,t)=>{t.exports="up"}),Ua=y((e,t)=>{t.exports={BUTTON_DOWN:O1(),BUTTON_UP:M1(),CONNECTED:L1(),DISCONNECTED:D1(),GAMEPAD_BUTTON_DOWN:k1(),GAMEPAD_BUTTON_UP:F1()}}),Hc=y((e,t)=>{var i=W(),s=Ua(),n=new i({initialize:function(r,o){this.pad=r,this.events=r.manager,this.index=o,this.value=0,this.threshold=1,this.pressed=!1},update:function(r){this.value=r;var o=this.pad,a=this.index;r>=this.threshold?this.pressed||(this.pressed=!0,this.events.emit(s.BUTTON_DOWN,o,this,r),this.pad.emit(s.GAMEPAD_BUTTON_DOWN,a,r,this)):this.pressed&&(this.pressed=!1,this.events.emit(s.BUTTON_UP,o,this,r),this.pad.emit(s.GAMEPAD_BUTTON_UP,a,r,this))},destroy:function(){this.pad=null,this.events=null}});t.exports=n}),zc=y((e,t)=>{var i=Yc(),s=Hc(),n=W(),r=Ct(),o=xt(),a=new n({Extends:r,initialize:function(h,l){r.call(this),this.manager=h,this.pad=l,this.id=l.id,this.index=l.index;for(var u=[],d=0;d<l.buttons.length;d++)u.push(new s(this,d));this.buttons=u;var p=[];for(d=0;d<l.axes.length;d++)p.push(new i(this,d));this.axes=p,this.vibration=l.vibrationActuator;var g={value:0,pressed:!1};this._LCLeft=u[14]?u[14]:g,this._LCRight=u[15]?u[15]:g,this._LCTop=u[12]?u[12]:g,this._LCBottom=u[13]?u[13]:g,this._RCLeft=u[2]?u[2]:g,this._RCRight=u[1]?u[1]:g,this._RCTop=u[3]?u[3]:g,this._RCBottom=u[0]?u[0]:g,this._FBLeftTop=u[4]?u[4]:g,this._FBLeftBottom=u[6]?u[6]:g,this._FBRightTop=u[5]?u[5]:g,this._FBRightBottom=u[7]?u[7]:g;var c={value:0};this._HAxisLeft=p[0]?p[0]:c,this._VAxisLeft=p[1]?p[1]:c,this._HAxisRight=p[2]?p[2]:c,this._VAxisRight=p[3]?p[3]:c,this.leftStick=new o,this.rightStick=new o,this._created=performance.now()},getAxisTotal:function(){return this.axes.length},getAxisValue:function(h){return this.axes[h].getValue()},setAxisThreshold:function(h){for(var l=0;l<this.axes.length;l++)this.axes[l].threshold=h},getButtonTotal:function(){return this.buttons.length},getButtonValue:function(h){return this.buttons[h].value},isButtonDown:function(h){return this.buttons[h].pressed},update:function(h){if(!(h.timestamp<this._created)){var l,u=this.buttons,d=h.buttons,p=u.length;for(l=0;l<p;l++)u[l].update(d[l].value);var g=this.axes,c=h.axes;for(p=g.length,l=0;l<p;l++)g[l].update(c[l]);p>=2&&(this.leftStick.set(g[0].getValue(),g[1].getValue()),p>=4&&this.rightStick.set(g[2].getValue(),g[3].getValue()))}},destroy:function(){this.removeAllListeners(),this.manager=null,this.pad=null;var h;for(h=0;h<this.buttons.length;h++)this.buttons[h].destroy();for(h=0;h<this.axes.length;h++)this.axes[h].destroy();this.buttons=[],this.axes=[]},connected:{get:function(){return this.pad.connected}},timestamp:{get:function(){return this.pad.timestamp}},left:{get:function(){return this._LCLeft.pressed}},right:{get:function(){return this._LCRight.pressed}},up:{get:function(){return this._LCTop.pressed}},down:{get:function(){return this._LCBottom.pressed}},A:{get:function(){return this._RCBottom.pressed}},Y:{get:function(){return this._RCTop.pressed}},X:{get:function(){return this._RCLeft.pressed}},B:{get:function(){return this._RCRight.pressed}},L1:{get:function(){return this._FBLeftTop.value}},L2:{get:function(){return this._FBLeftBottom.value}},R1:{get:function(){return this._FBRightTop.value}},R2:{get:function(){return this._FBRightBottom.value}}});t.exports=a}),Zn=y((e,t)=>{var i=St(),s={},n={};n.register=function(r,o,a,h,l){s[r]={plugin:o,mapping:a,settingsKey:h,configKey:l}},n.getPlugin=function(r){return s[r]},n.install=function(r){var o=r.scene.sys,a=o.settings.input,h=o.game.config;for(var l in s){var u=s[l].plugin,d=s[l].mapping,p=s[l].settingsKey,g=s[l].configKey;i(a,p,h[g])&&(r[d]=new u(r))}},n.remove=function(r){s.hasOwnProperty(r)&&delete s[r]},t.exports=n}),N1=y((e,t)=>{var i=W(),s=Ct(),n=Ua(),r=zc(),o=St(),a=Zn(),h=pi(),l=new i({Extends:s,initialize:function(u){s.call(this),this.scene=u.scene,this.settings=this.scene.sys.settings,this.sceneInputPlugin=u,this.enabled=!0,this.target,this.gamepads=[],this.queue=[],this.onGamepadHandler,this._pad1,this._pad2,this._pad3,this._pad4,u.pluginEvents.once(h.BOOT,this.boot,this),u.pluginEvents.on(h.START,this.start,this)},boot:function(){var u=this.scene.sys.game,d=this.settings.input,p=u.config;this.enabled=o(d,"gamepad",p.inputGamepad)&&u.device.input.gamepads,this.target=o(d,"gamepad.target",p.inputGamepadEventTarget),this.sceneInputPlugin.pluginEvents.once(h.DESTROY,this.destroy,this)},start:function(){this.enabled&&(this.startListeners(),this.refreshPads()),this.sceneInputPlugin.pluginEvents.once(h.SHUTDOWN,this.shutdown,this)},isActive:function(){return this.enabled&&this.scene.sys.isActive()},startListeners:function(){var u=this,d=this.target,p=function(g){g.defaultPrevented||!u.isActive()||(u.refreshPads(),u.queue.push(g))};this.onGamepadHandler=p,d.addEventListener("gamepadconnected",p,!1),d.addEventListener("gamepaddisconnected",p,!1),this.sceneInputPlugin.pluginEvents.on(h.UPDATE,this.update,this)},stopListeners:function(){this.target.removeEventListener("gamepadconnected",this.onGamepadHandler),this.target.removeEventListener("gamepaddisconnected",this.onGamepadHandler),this.sceneInputPlugin.pluginEvents.off(h.UPDATE,this.update);for(var u=0;u<this.gamepads.length;u++)this.gamepads[u].removeAllListeners()},disconnectAll:function(){for(var u=0;u<this.gamepads.length;u++)this.gamepads[u].pad.connected=!1},refreshPads:function(){var u=navigator.getGamepads();if(!u)this.disconnectAll();else for(var d=this.gamepads,p=0;p<u.length;p++){var g=u[p];if(g){var c=g.id,f=g.index,m=d[f];if(m)m.id!==c?(m.destroy(),d[f]=new r(this,g)):m.update(g);else{var v=new r(this,g);d[f]=v,this._pad1?this._pad2?this._pad3?this._pad4||(this._pad4=v):this._pad3=v:this._pad2=v:this._pad1=v}}}},getAll:function(){for(var u=[],d=this.gamepads,p=0;p<d.length;p++)d[p]&&u.push(d[p]);return u},getPad:function(u){for(var d=this.gamepads,p=0;p<d.length;p++)if(d[p]&&d[p].index===u)return d[p]},update:function(){if(this.enabled){this.refreshPads();var u=this.queue.length;if(u!==0)for(var d=this.queue.splice(0,u),p=0;p<u;p++){var g=d[p],c=this.getPad(g.gamepad.index);g.type==="gamepadconnected"?this.emit(n.CONNECTED,c,g):g.type==="gamepaddisconnected"&&this.emit(n.DISCONNECTED,c,g)}}},shutdown:function(){this.stopListeners(),this.removeAllListeners()},destroy:function(){this.shutdown();for(var u=0;u<this.gamepads.length;u++)this.gamepads[u]&&this.gamepads[u].destroy();this.gamepads=[],this.scene=null,this.settings=null,this.sceneInputPlugin=null,this.target=null},total:{get:function(){return this.gamepads.length}},pad1:{get:function(){return this._pad1}},pad2:{get:function(){return this._pad2}},pad3:{get:function(){return this._pad3}},pad4:{get:function(){return this._pad4}}});a.register("GamepadPlugin",l,"gamepad","gamepad","inputGamepad"),t.exports=l}),B1=y((e,t)=>{t.exports={UP:12,DOWN:13,LEFT:14,RIGHT:15,SHARE:8,OPTIONS:9,PS:16,TOUCHBAR:17,X:0,CIRCLE:1,SQUARE:2,TRIANGLE:3,L1:4,R1:5,L2:6,R2:7,L3:10,R3:11,LEFT_STICK_H:0,LEFT_STICK_V:1,RIGHT_STICK_H:2,RIGHT_STICK_V:3}}),U1=y((e,t)=>{t.exports={UP:12,DOWN:13,LEFT:14,RIGHT:15,SELECT:8,START:9,B:0,A:1,Y:2,X:3,LEFT_SHOULDER:4,RIGHT_SHOULDER:5}}),G1=y((e,t)=>{t.exports={UP:12,DOWN:13,LEFT:14,RIGHT:15,MENU:16,A:0,B:1,X:2,Y:3,LB:4,RB:5,LT:6,RT:7,BACK:8,START:9,LS:10,RS:11,LEFT_STICK_H:0,LEFT_STICK_V:1,RIGHT_STICK_H:2,RIGHT_STICK_V:3}}),Y1=y((e,t)=>{t.exports={DUALSHOCK_4:B1(),SNES_USB:U1(),XBOX_360:G1()}}),H1=y((e,t)=>{t.exports={Axis:Yc(),Button:Hc(),Events:Ua(),Gamepad:zc(),GamepadPlugin:N1(),Configs:Y1()}}),Wc=y((e,t)=>{var i=function(s,n,r){var o=s.x3-s.x1,a=s.y3-s.y1,h=s.x2-s.x1,l=s.y2-s.y1,u=n-s.x1,d=r-s.y1,p=o*o+a*a,g=o*h+a*l,c=o*u+a*d,f=h*h+l*l,m=h*u+l*d,v=p*f-g*g,E=v===0?0:1/v,x=(f*c-g*m)*E,T=(p*m-g*c)*E;return x>=0&&T>=0&&x+T<1};t.exports=i}),z1=y((e,t)=>{var i=Mt(),s=Ps(),n=function(r,o,a){a===void 0&&(a=new i);var h=r.getLineA(),l=r.getLineB(),u=r.getLineC();if(o<=0||o>=1)return a.x=h.x1,a.y=h.y1,a;var d=s(h),p=s(l),g=s(u),c=d+p+g,f=c*o,m=0;return f<d?(m=f/d,a.x=h.x1+(h.x2-h.x1)*m,a.y=h.y1+(h.y2-h.y1)*m):f>d+p?(f-=d+p,m=f/g,a.x=u.x1+(u.x2-u.x1)*m,a.y=u.y1+(u.y2-u.y1)*m):(f-=d,m=f/p,a.x=l.x1+(l.x2-l.x1)*m,a.y=l.y1+(l.y2-l.y1)*m),a};t.exports=n}),W1=y((e,t)=>{var i=Ps(),s=Mt(),n=function(r,o,a,h){h===void 0&&(h=[]);var l=r.getLineA(),u=r.getLineB(),d=r.getLineC(),p=i(l),g=i(u),c=i(d),f=p+g+c;!o&&a>0&&(o=f/a);for(var m=0;m<o;m++){var v=f*(m/o),E=0,x=new s;v<p?(E=v/p,x.x=l.x1+(l.x2-l.x1)*E,x.y=l.y1+(l.y2-l.y1)*E):v>p+g?(v-=p+g,E=v/c,x.x=d.x1+(d.x2-d.x1)*E,x.y=d.y1+(d.y2-d.y1)*E):(v-=p,E=v/g,x.x=u.x1+(u.x2-u.x1)*E,x.y=u.y1+(u.y2-u.y1)*E),h.push(x)}return h};t.exports=n}),V1=y((e,t)=>{var i=W(),s=Wc(),n=z1(),r=W1(),o=xi(),a=Rn(),h=vl(),l=new i({initialize:function(u,d,p,g,c,f){u===void 0&&(u=0),d===void 0&&(d=0),p===void 0&&(p=0),g===void 0&&(g=0),c===void 0&&(c=0),f===void 0&&(f=0),this.type=o.TRIANGLE,this.x1=u,this.y1=d,this.x2=p,this.y2=g,this.x3=c,this.y3=f},contains:function(u,d){return s(this,u,d)},getPoint:function(u,d){return n(this,u,d)},getPoints:function(u,d,p){return r(this,u,d,p)},getRandomPoint:function(u){return h(this,u)},setTo:function(u,d,p,g,c,f){return u===void 0&&(u=0),d===void 0&&(d=0),p===void 0&&(p=0),g===void 0&&(g=0),c===void 0&&(c=0),f===void 0&&(f=0),this.x1=u,this.y1=d,this.x2=p,this.y2=g,this.x3=c,this.y3=f,this},getLineA:function(u){return u===void 0&&(u=new a),u.setTo(this.x1,this.y1,this.x2,this.y2),u},getLineB:function(u){return u===void 0&&(u=new a),u.setTo(this.x2,this.y2,this.x3,this.y3),u},getLineC:function(u){return u===void 0&&(u=new a),u.setTo(this.x3,this.y3,this.x1,this.y1),u},left:{get:function(){return Math.min(this.x1,this.x2,this.x3)},set:function(u){var d=0;this.x1<=this.x2&&this.x1<=this.x3?d=this.x1-u:this.x2<=this.x1&&this.x2<=this.x3?d=this.x2-u:d=this.x3-u,this.x1-=d,this.x2-=d,this.x3-=d}},right:{get:function(){return Math.max(this.x1,this.x2,this.x3)},set:function(u){var d=0;this.x1>=this.x2&&this.x1>=this.x3?d=this.x1-u:this.x2>=this.x1&&this.x2>=this.x3?d=this.x2-u:d=this.x3-u,this.x1-=d,this.x2-=d,this.x3-=d}},top:{get:function(){return Math.min(this.y1,this.y2,this.y3)},set:function(u){var d=0;this.y1<=this.y2&&this.y1<=this.y3?d=this.y1-u:this.y2<=this.y1&&this.y2<=this.y3?d=this.y2-u:d=this.y3-u,this.y1-=d,this.y2-=d,this.y3-=d}},bottom:{get:function(){return Math.max(this.y1,this.y2,this.y3)},set:function(u){var d=0;this.y1>=this.y2&&this.y1>=this.y3?d=this.y1-u:this.y2>=this.y1&&this.y2>=this.y3?d=this.y2-u:d=this.y3-u,this.y1-=d,this.y2-=d,this.y3-=d}}});t.exports=l}),X1=y((e,t)=>{var i=yn(),s=Ni(),n=W(),r=xa(),o=Gc(),a=Uc(),h=Mn(),l=bc(),u=Pc(),d=pi(),p=Ct(),g=dt(),c=xi(),f=Zn(),m=ce(),v=he(),E=Ut(),x=Ui(),T=Vt(),A=V1(),P=Wc(),R=new n({Extends:p,initialize:function(S){p.call(this),this.scene=S,this.systems=S.sys,this.settings=S.sys.settings,this.manager=S.sys.game.input,this.pluginEvents=new p,this.enabled=!0,this.displayList,this.cameras,f.install(this),this.mouse=this.manager.mouse,this.topOnly=!0,this.pollRate=-1,this._pollTimer=0;var I={cancelled:!1};this._eventContainer={stopPropagation:function(){I.cancelled=!0}},this._eventData=I,this.dragDistanceThreshold=0,this.dragTimeThreshold=0,this._temp=[],this._tempZones=[],this._list=[],this._pendingInsertion=[],this._pendingRemoval=[],this._draggable=[],this._drag={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[],10:[]},this._dragState=[],this._over={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[],10:[]},this._validTypes=["onDown","onUp","onOver","onOut","onMove","onDragStart","onDrag","onDragEnd","onDragEnter","onDragLeave","onDragOver","onDrop"],this._updatedThisFrame=!1,S.sys.events.once(T.BOOT,this.boot,this),S.sys.events.on(T.START,this.start,this)},boot:function(){this.cameras=this.systems.cameras,this.displayList=this.systems.displayList,this.systems.events.once(T.DESTROY,this.destroy,this),this.pluginEvents.emit(d.BOOT)},start:function(){var S=this.systems.events;S.on(T.TRANSITION_START,this.transitionIn,this),S.on(T.TRANSITION_OUT,this.transitionOut,this),S.on(T.TRANSITION_COMPLETE,this.transitionComplete,this),S.on(T.PRE_UPDATE,this.preUpdate,this),S.once(T.SHUTDOWN,this.shutdown,this),this.manager.events.on(d.GAME_OUT,this.onGameOut,this),this.manager.events.on(d.GAME_OVER,this.onGameOver,this),this.enabled=!0,this._dragState=[0,0,0,0,0,0,0,0,0,0],this.pluginEvents.emit(d.START)},onGameOver:function(S){this.isActive()&&this.emit(d.GAME_OVER,S.timeStamp,S)},onGameOut:function(S){this.isActive()&&this.emit(d.GAME_OUT,S.timeStamp,S)},preUpdate:function(){this.pluginEvents.emit(d.PRE_UPDATE);var S=this._pendingRemoval,I=this._pendingInsertion,w=S.length,C=I.length;if(!(w===0&&C===0)){for(var _=this._list,O=0;O<w;O++){var D=S[O],F=_.indexOf(D);F>-1&&(_.splice(F,1),this.clear(D,!0))}this._pendingRemoval.length=0,this._list=_.concat(I.splice(0))}},isActive:function(){return this.manager&&this.manager.enabled&&this.enabled&&this.scene.sys.canInput()},setCursor:function(S){this.manager&&this.manager.setCursor(S)},resetCursor:function(){this.manager&&this.manager.resetCursor(null,!0)},updatePoll:function(S,I){if(!this.isActive())return!1;if(this.pluginEvents.emit(d.UPDATE,S,I),this._updatedThisFrame)return this._updatedThisFrame=!1,!1;var w,C=this.manager,_=C.pointers;for(w=0;w<_.length;w++)_[w].updateMotion();if(this._list.length===0)return!1;var O=this.pollRate;if(O===-1)return!1;if(O>0)if(this._pollTimer-=I,this._pollTimer<0)this._pollTimer=this.pollRate;else return!1;var D=!1;for(w=0;w<_.length;w++){var F=0,N=_[w];this._tempZones=[],this._temp=this.hitTestPointer(N),this.sortGameObjects(this._temp,N),this.sortDropZones(this._tempZones),this.topOnly&&(this._temp.length&&this._temp.splice(1),this._tempZones.length&&this._tempZones.splice(1)),F+=this.processOverOutEvents(N),this.getDragState(N)===2&&this.processDragThresholdEvent(N,S),F>0&&(D=!0)}return D},update:function(S,I){if(!this.isActive())return!1;for(var w=!1,C=0;C<I.length;C++){var _=0,O=I[C];switch(this._tempZones=[],this._temp=this.hitTestPointer(O),this.sortGameObjects(this._temp,O),this.sortDropZones(this._tempZones),this.topOnly&&(this._temp.length&&this._temp.splice(1),this._tempZones.length&&this._tempZones.splice(1)),S){case r.MOUSE_DOWN:_+=this.processDragDownEvent(O),_+=this.processDownEvents(O),_+=this.processOverOutEvents(O);break;case r.MOUSE_UP:_+=this.processDragUpEvent(O),_+=this.processUpEvents(O),_+=this.processOverOutEvents(O);break;case r.TOUCH_START:_+=this.processDragDownEvent(O),_+=this.processDownEvents(O),_+=this.processOverEvents(O);break;case r.TOUCH_END:case r.TOUCH_CANCEL:_+=this.processDragUpEvent(O),_+=this.processUpEvents(O),_+=this.processOutEvents(O);break;case r.MOUSE_MOVE:case r.TOUCH_MOVE:_+=this.processDragMoveEvent(O),_+=this.processMoveEvents(O),_+=this.processOverOutEvents(O);break;case r.MOUSE_WHEEL:_+=this.processWheelEvent(O);break}_>0&&(w=!0)}return this._updatedThisFrame=!0,w},clear:function(S,I){I===void 0&&(I=!1),this.disable(S);var w=S.input;w&&(this.removeDebug(S),this.manager.resetCursor(w),w.gameObject=void 0,w.target=void 0,w.hitArea=void 0,w.hitAreaCallback=void 0,w.callbackContext=void 0,S.input=null),I||this.queueForRemoval(S);var C=this._draggable.indexOf(S);return C>-1&&this._draggable.splice(C,1),S},disable:function(S,I){I===void 0&&(I=!1);var w=S.input;w&&(w.enabled=!1,w.dragState=0);for(var C=this._drag,_=this._over,O=this.manager,D=0,F;D<O.pointers.length;D++)F=C[D].indexOf(S),F>-1&&C[D].splice(F,1),F=_[D].indexOf(S),F>-1&&_[D].splice(F,1);return I&&this.resetCursor(),this},enable:function(S,I,w,C){return C===void 0&&(C=!1),S.input?S.input.enabled=!0:this.setHitArea(S,I,w),S.input&&C&&!S.input.dropZone&&(S.input.dropZone=C),this},hitTestPointer:function(S){for(var I=this.cameras.getCamerasBelowPointer(S),w=0;w<I.length;w++){for(var C=I[w],_=this.manager.hitTest(S,this._list,C),O=0;O<_.length;O++){var D=_[O];D.input.dropZone&&this._tempZones.push(D)}if(_.length>0)return S.camera=C,_}return S.camera=I[0],[]},processDownEvents:function(S){var I=0,w=this._temp,C=this._eventData,_=this._eventContainer;C.cancelled=!1;for(var O=0;O<w.length;O++){var D=w[O];if(!(!D.input||!D.input.enabled)&&(I++,D.emit(d.GAMEOBJECT_POINTER_DOWN,S,D.input.localX,D.input.localY,_),C.cancelled||!this.isActive()||D.input&&D.input.enabled&&(this.emit(d.GAMEOBJECT_DOWN,S,D,_),C.cancelled||!this.isActive())))break}return!C.cancelled&&this.isActive()&&(S.downElement===this.manager.game.canvas?this.emit(d.POINTER_DOWN,S,w):this.emit(d.POINTER_DOWN_OUTSIDE,S)),I},getDragState:function(S){return this._dragState[S.id]},setDragState:function(S,I){this._dragState[S.id]=I},processDragThresholdEvent:function(S,I){var w=!1,C=this.dragTimeThreshold,_=this.dragDistanceThreshold;if((_>0&&h(S.x,S.y,S.downX,S.downY)>=_||C>0&&I>=S.downTime+C)&&(w=!0),w)return this.setDragState(S,3),this.processDragStartList(S)},processDragStartList:function(S){if(this.getDragState(S)!==3)return 0;var I=this._drag[S.id];I.length>1&&(I=I.slice(0));for(var w=0;w<I.length;w++){var C=I[w],_=C.input;_.dragState=2,_.dragStartX=C.x,_.dragStartY=C.y,_.dragStartXGlobal=S.worldX,_.dragStartYGlobal=S.worldY,_.dragStartCamera=S.camera,_.dragX=_.dragStartXGlobal-_.dragStartX,_.dragY=_.dragStartYGlobal-_.dragStartY,C.emit(d.GAMEOBJECT_DRAG_START,S,_.dragX,_.dragY),this.emit(d.DRAG_START,S,C)}return this.setDragState(S,4),I.length},processDragDownEvent:function(S){var I=this._temp;if(this._draggable.length===0||I.length===0||!S.primaryDown||this.getDragState(S)!==0)return 0;this.setDragState(S,1);for(var w=[],C=0;C<I.length;C++){var _=I[C];_.input.draggable&&_.input.dragState===0&&w.push(_)}return w.length===0?(this.setDragState(S,0),0):(w.length>1&&(this.sortGameObjects(w,S),this.topOnly&&w.splice(1)),this._drag[S.id]=w,this.dragDistanceThreshold===0&&this.dragTimeThreshold===0?(this.setDragState(S,3),this.processDragStartList(S)):(this.setDragState(S,2),0))},processDragMoveEvent:function(S){if(this.getDragState(S)===2&&this.processDragThresholdEvent(S,this.manager.game.loop.now),this.getDragState(S)!==4)return 0;var I=this._tempZones,w=this._drag[S.id];w.length>1&&(w=w.slice(0));for(var C=0;C<w.length;C++){var _=w[C],O=_.input,D=O.target;if(D){var F=I.indexOf(D);F===0?(_.emit(d.GAMEOBJECT_DRAG_OVER,S,D),this.emit(d.DRAG_OVER,S,_,D)):F>0?(_.emit(d.GAMEOBJECT_DRAG_LEAVE,S,D),this.emit(d.DRAG_LEAVE,S,_,D),O.target=I[0],D=O.target,_.emit(d.GAMEOBJECT_DRAG_ENTER,S,D),this.emit(d.DRAG_ENTER,S,_,D)):(_.emit(d.GAMEOBJECT_DRAG_LEAVE,S,D),this.emit(d.DRAG_LEAVE,S,_,D),I[0]?(O.target=I[0],D=O.target,_.emit(d.GAMEOBJECT_DRAG_ENTER,S,D),this.emit(d.DRAG_ENTER,S,_,D)):O.target=null)}else!D&&I[0]&&(O.target=I[0],D=O.target,_.emit(d.GAMEOBJECT_DRAG_ENTER,S,D),this.emit(d.DRAG_ENTER,S,_,D));var N,Y,L=S.positionToCamera(O.dragStartCamera);if(!_.parentContainer)N=L.x-O.dragX,Y=L.y-O.dragY;else{var b=L.x-O.dragStartXGlobal,M=L.y-O.dragStartYGlobal,k=_.getParentRotation(),B=b*Math.cos(k)+M*Math.sin(k),H=M*Math.cos(k)-b*Math.sin(k);B*=1/_.parentContainer.scaleX,H*=1/_.parentContainer.scaleY,N=B+O.dragStartX,Y=H+O.dragStartY}_.emit(d.GAMEOBJECT_DRAG,S,N,Y),this.emit(d.DRAG,S,_,N,Y)}return w.length},processDragUpEvent:function(S){var I=this._drag[S.id];I.length>1&&(I=I.slice(0));for(var w=0;w<I.length;w++){var C=I[w],_=C.input;if(_&&_.dragState===2){_.dragState=0,_.dragX=_.localX-C.displayOriginX,_.dragY=_.localY-C.displayOriginY,_.dragStartCamera=null;var O=!1,D=_.target;D&&(C.emit(d.GAMEOBJECT_DROP,S,D),this.emit(d.DROP,S,C,D),_.target=null,O=!0),C.input&&C.input.enabled&&(C.emit(d.GAMEOBJECT_DRAG_END,S,_.dragX,_.dragY,O),this.emit(d.DRAG_END,S,C,O))}}return this.setDragState(S,0),I.splice(0),0},processMoveEvents:function(S){var I=0,w=this._temp,C=this._eventData,_=this._eventContainer;C.cancelled=!1;for(var O=0;O<w.length;O++){var D=w[O];if(!(!D.input||!D.input.enabled)&&(I++,D.emit(d.GAMEOBJECT_POINTER_MOVE,S,D.input.localX,D.input.localY,_),C.cancelled||!this.isActive()||D.input&&D.input.enabled&&(this.emit(d.GAMEOBJECT_MOVE,S,D,_),C.cancelled||!this.isActive()||this.topOnly)))break}return!C.cancelled&&this.isActive()&&this.emit(d.POINTER_MOVE,S,w),I},processWheelEvent:function(S){var I=0,w=this._temp,C=this._eventData,_=this._eventContainer;C.cancelled=!1;for(var O=S.deltaX,D=S.deltaY,F=S.deltaZ,N=0;N<w.length;N++){var Y=w[N];if(!(!Y.input||!Y.input.enabled)&&(I++,Y.emit(d.GAMEOBJECT_POINTER_WHEEL,S,O,D,F,_),C.cancelled||!this.isActive()||Y.input&&Y.input.enabled&&(this.emit(d.GAMEOBJECT_WHEEL,S,Y,O,D,F,_),C.cancelled||!this.isActive())))break}return!C.cancelled&&this.isActive()&&this.emit(d.POINTER_WHEEL,S,w,O,D,F),I},processOverEvents:function(S){var I=this._temp,w=0,C=I.length,_=[];if(C>0){var O=this.manager,D=this._eventData,F=this._eventContainer;D.cancelled=!1;for(var N=0;N<C;N++){var Y=I[N];if(!(!Y.input||!Y.input.enabled)&&(_.push(Y),O.setCursor(Y.input),Y.emit(d.GAMEOBJECT_POINTER_OVER,S,Y.input.localX,Y.input.localY,F),w++,D.cancelled||!this.isActive()||Y.input&&Y.input.enabled&&(this.emit(d.GAMEOBJECT_OVER,S,Y,F),D.cancelled||!this.isActive())))break}!D.cancelled&&this.isActive()&&this.emit(d.POINTER_OVER,S,_)}return this._over[S.id]=_,w},processOutEvents:function(S){var I=this._over[S.id],w=0,C=I.length;if(C>0){var _=this.manager,O=this._eventData,D=this._eventContainer;O.cancelled=!1,this.sortGameObjects(I,S);for(var F=0;F<C;F++){var N=I[F];if(N=I[F],!(!N.input||!N.input.enabled)&&(_.resetCursor(N.input),N.emit(d.GAMEOBJECT_POINTER_OUT,S,D),w++,O.cancelled||!this.isActive()||N.input&&N.input.enabled&&(this.emit(d.GAMEOBJECT_OUT,S,N,D),O.cancelled||!this.isActive())))break}!O.cancelled&&this.isActive()&&this.emit(d.POINTER_OUT,S,I),this._over[S.id]=[]}return w},processOverOutEvents:function(S){var I=this._temp,w,C,_=[],O=[],D=[],F=this._over[S.id],N=this._drag[S.id],Y=this.manager;for(w=0;w<F.length;w++)C=F[w],I.indexOf(C)===-1&&N.indexOf(C)===-1?_.push(C):D.push(C);for(w=0;w<I.length;w++)C=I[w],F.indexOf(C)===-1&&O.push(C);var L=_.length,b=0,M=this._eventData,k=this._eventContainer;if(M.cancelled=!1,L>0){for(this.sortGameObjects(_,S),w=0;w<L&&(C=_[w],!(!(!C.input||!C.input.enabled)&&(Y.resetCursor(C.input),C.emit(d.GAMEOBJECT_POINTER_OUT,S,k),b++,M.cancelled||!this.isActive()||C.input&&C.input.enabled&&(this.emit(d.GAMEOBJECT_OUT,S,C,k),M.cancelled||!this.isActive()))));w++);(!M.cancelled||this.isActive())&&this.emit(d.POINTER_OUT,S,_)}if(L=O.length,M.cancelled=!1,L>0){for(this.sortGameObjects(O,S),w=0;w<L&&(C=O[w],!(!(!C.input||!C.input.enabled)&&(Y.setCursor(C.input),C.emit(d.GAMEOBJECT_POINTER_OVER,S,C.input.localX,C.input.localY,k),b++,M.cancelled||!this.isActive()||C.input&&C.input.enabled&&(this.emit(d.GAMEOBJECT_OVER,S,C,k),M.cancelled||!this.isActive()))));w++);!M.cancelled&&this.isActive()&&this.emit(d.POINTER_OVER,S,O)}return F=D.concat(O),this._over[S.id]=this.sortGameObjects(F,S),b},processUpEvents:function(S){var I=this._temp,w=this._eventData,C=this._eventContainer;w.cancelled=!1;for(var _=0;_<I.length;_++){var O=I[_];if(!(!O.input||!O.input.enabled)&&(O.emit(d.GAMEOBJECT_POINTER_UP,S,O.input.localX,O.input.localY,C),w.cancelled||!this.isActive()||O.input&&O.input.enabled&&(this.emit(d.GAMEOBJECT_UP,S,O,C),w.cancelled||!this.isActive())))break}return!w.cancelled&&this.isActive()&&(S.upElement===this.manager.game.canvas?this.emit(d.POINTER_UP,S,I):this.emit(d.POINTER_UP_OUTSIDE,S)),I.length},forceDownState:function(S,I){this.forceState(S,I,d.GAMEOBJECT_POINTER_DOWN,d.GAMEOBJECT_DOWN,!1)},forceUpState:function(S,I){this.forceState(S,I,d.GAMEOBJECT_POINTER_UP,d.GAMEOBJECT_UP,!1)},forceOverState:function(S,I){this.forceState(S,I,d.GAMEOBJECT_POINTER_OVER,d.GAMEOBJECT_OVER,!0)},forceOutState:function(S,I){this.forceState(S,I,d.GAMEOBJECT_POINTER_OUT,d.GAMEOBJECT_OUT,!1)},forceState:function(S,I,w,C,_){var O=this._eventData,D=this._eventContainer;O.cancelled=!1,I.input&&I.input.enabled&&(I.emit(w,S,I.input.localX,I.input.localY,D),_&&this.setCursor(I.input),!O.cancelled&&this.isActive()&&I.input&&I.input.enabled&&this.emit(C,S,I,D))},queueForInsertion:function(S){return this._pendingInsertion.indexOf(S)===-1&&this._list.indexOf(S)===-1&&this._pendingInsertion.push(S),this},queueForRemoval:function(S){return this._pendingRemoval.push(S),this},setDraggable:function(S,I){I===void 0&&(I=!0),Array.isArray(S)||(S=[S]);for(var w=0;w<S.length;w++){var C=S[w];C.input.draggable=I;var _=this._draggable.indexOf(C);I&&_===-1?this._draggable.push(C):!I&&_>-1&&this._draggable.splice(_,1)}return this},makePixelPerfect:function(S){S===void 0&&(S=1);var I=this.systems.textures;return a(I,S)},setHitArea:function(S,I,w){if(I===void 0)return this.setHitAreaFromTexture(S);Array.isArray(S)||(S=[S]);var C=!1,_=!1,O=!1,D=!1,F=!1,N=!0;if(m(I)&&Object.keys(I).length){var Y=I,L=S.some(function(H){return H.hasOwnProperty("faces")});if(!L){I=g(Y,"hitArea",null),w=g(Y,"hitAreaCallback",null),F=g(Y,"pixelPerfect",!1);var b=g(Y,"alphaTolerance",1);F&&(I={},w=this.makePixelPerfect(b))}C=g(Y,"draggable",!1),_=g(Y,"dropZone",!1),O=g(Y,"cursor",!1),D=g(Y,"useHandCursor",!1),(!I||!w)&&(this.setHitAreaFromTexture(S),N=!1)}else typeof I=="function"&&!w&&(w=I,I={});for(var M=0;M<S.length;M++){var k=S[M];if(!(F&&k.type==="Container")){var B=k.input?k.input:o(k,I,w);B.customHitArea=N,B.dropZone=_,B.cursor=D?"pointer":O,k.input=B,C&&this.setDraggable(k),this.queueForInsertion(k)}}return this},setHitAreaCircle:function(S,I,w,C,_){_===void 0&&(_=s);var O=new i(I,w,C);return this.setHitArea(S,O,_)},setHitAreaEllipse:function(S,I,w,C,_,O){O===void 0&&(O=u);var D=new l(I,w,C,_);return this.setHitArea(S,D,O)},setHitAreaFromTexture:function(S,I){I===void 0&&(I=x),Array.isArray(S)||(S=[S]);for(var w=0;w<S.length;w++){var C=S[w],_=C.frame,O=0,D=0;C.width?(O=C.width,D=C.height):_&&(O=_.realWidth,D=_.realHeight),!(C.type==="Container"&&(O===0||D===0))&&O!==0&&D!==0&&(C.input=o(C,new E(0,0,O,D),I),this.queueForInsertion(C))}return this},setHitAreaRectangle:function(S,I,w,C,_,O){O===void 0&&(O=x);var D=new E(I,w,C,_);return this.setHitArea(S,D,O)},setHitAreaTriangle:function(S,I,w,C,_,O,D,F){F===void 0&&(F=P);var N=new A(I,w,C,_,O,D);return this.setHitArea(S,N,F)},enableDebug:function(S,I){I===void 0&&(I=65280);var w=S.input;if(!w||!w.hitArea)return this;var C=w.hitArea,_=C.type,O=w.hitAreaDebug,D=this.systems.add,F=this.systems.updateList;O&&(F.remove(O),O.destroy(),O=null);var N=0,Y=0;switch(_){case c.CIRCLE:O=D.arc(0,0,C.radius),N=C.x-C.radius,Y=C.y-C.radius;break;case c.ELLIPSE:O=D.ellipse(0,0,C.width,C.height),N=C.x-C.width/2,Y=C.y-C.height/2;break;case c.LINE:O=D.line(0,0,C.x1,C.y1,C.x2,C.y2);break;case c.POLYGON:O=D.polygon(0,0,C.points);break;case c.RECTANGLE:O=D.rectangle(0,0,C.width,C.height),N=C.x,Y=C.y;break;case c.TRIANGLE:O=D.triangle(0,0,C.x1,C.y1,C.x2,C.y2,C.x3,C.y3);break}return O&&(O.isFilled=!1,O.strokeColor=I,O.preUpdate=function(){O.setVisible(S.visible),O.setStrokeStyle(1/S.scale,O.strokeColor),O.setDisplayOrigin(S.displayOriginX,S.displayOriginY);var L=S.x,b=S.y,M=S.rotation,k=S.scaleX,B=S.scaleY;if(S.parentContainer){var H=S.getWorldTransformMatrix();L=H.tx,b=H.ty,M=H.rotation,k=H.scaleX,B=H.scaleY}O.setRotation(M),O.setScale(k,B),O.setPosition(L+N*k,b+Y*B),O.setScrollFactor(S.scrollFactorX,S.scrollFactorY),O.setDepth(S.depth)},F.add(O),w.hitAreaDebug=O),this},removeDebug:function(S){var I=S.input;if(I&&I.hitAreaDebug){var w=I.hitAreaDebug;w.destroy(),I.hitAreaDebug=null}return this},setPollAlways:function(){return this.setPollRate(0)},setPollOnMove:function(){return this.setPollRate(-1)},setPollRate:function(S){return this.pollRate=S,this._pollTimer=0,this},setGlobalTopOnly:function(S){return this.manager.globalTopOnly=S,this},setTopOnly:function(S){return this.topOnly=S,this},sortGameObjects:function(S,I){if(S.length<2||!I.camera)return S;var w=I.camera.renderList;return S.sort(function(C,_){var O=Math.max(w.indexOf(C),0),D=Math.max(w.indexOf(_),0);return D-O})},sortDropZones:function(S){return S.length<2?S:(this.scene.sys.depthSort(),S.sort(this.sortDropZoneHandler.bind(this)))},sortDropZoneHandler:function(S,I){if(!S.parentContainer&&!I.parentContainer)return this.displayList.getIndex(I)-this.displayList.getIndex(S);if(S.parentContainer===I.parentContainer)return I.parentContainer.getIndex(I)-S.parentContainer.getIndex(S);if(S.parentContainer===I)return-1;if(I.parentContainer===S)return 1;for(var w=S.getIndexList(),C=I.getIndexList(),_=Math.min(w.length,C.length),O=0;O<_;O++){var D=w[O],F=C[O];if(D!==F)return F-D}return C.length-w.length},stopPropagation:function(){return this.manager._tempSkip=!0,this},addPointer:function(S){return this.manager.addPointer(S)},setDefaultCursor:function(S){return this.manager.setDefaultCursor(S),this},transitionIn:function(){this.enabled=this.settings.transitionAllowInput},transitionComplete:function(){this.settings.transitionAllowInput||(this.enabled=!0)},transitionOut:function(){this.enabled=this.settings.transitionAllowInput},shutdown:function(){this.pluginEvents.emit(d.SHUTDOWN),this._temp.length=0,this._list.length=0,this._draggable.length=0,this._pendingRemoval.length=0,this._pendingInsertion.length=0,this._dragState.length=0;for(var S=0;S<10;S++)this._drag[S]=[],this._over[S]=[];this.removeAllListeners();var I=this.manager;I.canvas.style.cursor=I.defaultCursor;var w=this.systems.events;w.off(T.TRANSITION_START,this.transitionIn,this),w.off(T.TRANSITION_OUT,this.transitionOut,this),w.off(T.TRANSITION_COMPLETE,this.transitionComplete,this),w.off(T.PRE_UPDATE,this.preUpdate,this),I.events.off(d.GAME_OUT,this.onGameOut,this),I.events.off(d.GAME_OVER,this.onGameOver,this),w.off(T.SHUTDOWN,this.shutdown,this)},resetPointers:function(){for(var S=this.manager.pointers,I=0;I<S.length;I++)S[I].reset()},destroy:function(){this.shutdown(),this.pluginEvents.emit(d.DESTROY),this.pluginEvents.removeAllListeners(),this.scene.sys.events.off(T.START,this.start,this),this.scene=null,this.cameras=null,this.manager=null,this.events=null,this.mouse=null},x:{get:function(){return this.manager.activePointer.x}},y:{get:function(){return this.manager.activePointer.y}},isOver:{get:function(){return this.manager.isOver}},mousePointer:{get:function(){return this.manager.mousePointer}},activePointer:{get:function(){return this.manager.activePointer}},pointer1:{get:function(){return this.manager.pointers[1]}},pointer2:{get:function(){return this.manager.pointers[2]}},pointer3:{get:function(){return this.manager.pointers[3]}},pointer4:{get:function(){return this.manager.pointers[4]}},pointer5:{get:function(){return this.manager.pointers[5]}},pointer6:{get:function(){return this.manager.pointers[6]}},pointer7:{get:function(){return this.manager.pointers[7]}},pointer8:{get:function(){return this.manager.pointers[8]}},pointer9:{get:function(){return this.manager.pointers[9]}},pointer10:{get:function(){return this.manager.pointers[10]}}});v.register("InputPlugin",R,"input"),t.exports=R}),K1=y((e,t)=>{t.exports="keydown"}),j1=y((e,t)=>{t.exports="keyup"}),Z1=y((e,t)=>{t.exports="keycombomatch"}),q1=y((e,t)=>{t.exports="down"}),J1=y((e,t)=>{t.exports="keydown-"}),Q1=y((e,t)=>{t.exports="keyup-"}),$1=y((e,t)=>{t.exports="up"}),qn=y((e,t)=>{t.exports={ANY_KEY_DOWN:K1(),ANY_KEY_UP:j1(),COMBO_MATCH:Z1(),DOWN:q1(),KEY_DOWN:J1(),KEY_UP:Q1(),UP:$1()}}),Vc=y((e,t)=>{var i=W(),s=Ct(),n=qn(),r=new i({Extends:s,initialize:function(o,a){s.call(this),this.plugin=o,this.keyCode=a,this.originalEvent=void 0,this.enabled=!0,this.isDown=!1,this.isUp=!0,this.altKey=!1,this.ctrlKey=!1,this.shiftKey=!1,this.metaKey=!1,this.location=0,this.timeDown=0,this.duration=0,this.timeUp=0,this.emitOnRepeat=!1,this.repeats=0,this._justDown=!1,this._justUp=!1,this._tick=-1},setEmitOnRepeat:function(o){return this.emitOnRepeat=o,this},onDown:function(o){this.originalEvent=o,this.enabled&&(this.altKey=o.altKey,this.ctrlKey=o.ctrlKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.location=o.location,this.repeats++,this.isDown?this.emitOnRepeat&&this.emit(n.DOWN,this,o):(this.isDown=!0,this.isUp=!1,this.timeDown=o.timeStamp,this.duration=0,this._justDown=!0,this._justUp=!1,this.emit(n.DOWN,this,o)))},onUp:function(o){this.originalEvent=o,this.enabled&&(this.isDown=!1,this.isUp=!0,this.timeUp=o.timeStamp,this.duration=this.timeUp-this.timeDown,this.repeats=0,this._justDown=!1,this._justUp=!0,this._tick=-1,this.emit(n.UP,this,o))},reset:function(){return this.isDown=!1,this.isUp=!0,this.altKey=!1,this.ctrlKey=!1,this.shiftKey=!1,this.metaKey=!1,this.timeDown=0,this.duration=0,this.timeUp=0,this.repeats=0,this._justDown=!1,this._justUp=!1,this._tick=-1,this},getDuration:function(){return this.isDown?this.plugin.game.loop.time-this.timeDown:0},destroy:function(){this.removeAllListeners(),this.originalEvent=null,this.plugin=null}});t.exports=r}),Xc=y((e,t)=>{var i=function(s,n){return n.timeLastMatched=s.timeStamp,n.index++,n.index===n.size?!0:(n.current=n.keyCodes[n.index],!1)};t.exports=i}),Kc=y((e,t)=>{var i=Xc(),s=function(n,r){if(r.matched)return!0;var o=!1,a=!1;if(n.keyCode===r.current)if(r.index>0&&r.maxKeyDelay>0){var h=r.timeLastMatched+r.maxKeyDelay;n.timeStamp<=h&&(a=!0,o=i(n,r))}else a=!0,o=i(n,r);return!a&&r.resetOnWrongKey&&(r.index=0,r.current=r.keyCodes[0]),o&&(r.timeLastMatched=n.timeStamp,r.matched=!0,r.timeMatched=n.timeStamp),o};t.exports=s}),jc=y((e,t)=>{var i=function(s){return s.current=s.keyCodes[0],s.index=0,s.timeLastMatched=0,s.matched=!1,s.timeMatched=0,s};t.exports=i}),Zc=y((e,t)=>{var i=W(),s=qn(),n=dt(),r=Kc(),o=jc(),a=new i({initialize:function(h,l,u){if(u===void 0&&(u={}),l.length<2)return!1;this.manager=h,this.enabled=!0,this.keyCodes=[];for(var d=0;d<l.length;d++){var p=l[d];typeof p=="string"?this.keyCodes.push(p.toUpperCase().charCodeAt(0)):typeof p=="number"?this.keyCodes.push(p):p.hasOwnProperty("keyCode")&&this.keyCodes.push(p.keyCode)}this.current=this.keyCodes[0],this.index=0,this.size=this.keyCodes.length,this.timeLastMatched=0,this.matched=!1,this.timeMatched=0,this.resetOnWrongKey=n(u,"resetOnWrongKey",!0),this.maxKeyDelay=n(u,"maxKeyDelay",0),this.resetOnMatch=n(u,"resetOnMatch",!1),this.deleteOnMatch=n(u,"deleteOnMatch",!1);var g=this,c=function(f){if(!(g.matched||!g.enabled)){var m=r(f,g);m&&(g.manager.emit(s.COMBO_MATCH,g,f),g.resetOnMatch?o(g):g.deleteOnMatch&&g.destroy())}};this.onKeyDown=c,this.manager.on(s.ANY_KEY_DOWN,this.onKeyDown)},progress:{get:function(){return this.index/this.size}},destroy:function(){this.enabled=!1,this.keyCodes=[],this.manager.off(s.ANY_KEY_DOWN,this.onKeyDown),this.manager=null}});t.exports=a}),tA=y((e,t)=>{var i=Un(),s={};for(n in i)s[i[n]]=n;var n;t.exports=s}),eA=y((e,t)=>{var i=W(),s=Ct(),n=qn(),r=$t(),o=St(),a=pi(),h=Zn(),l=Vc(),u=Un(),d=Zc(),p=tA(),g=Vt(),c=kn(),f=new i({Extends:s,initialize:function(m){s.call(this),this.game=m.systems.game,this.scene=m.scene,this.settings=this.scene.sys.settings,this.sceneInputPlugin=m,this.manager=m.manager.keyboard,this.enabled=!0,this.keys=[],this.combos=[],this.prevCode=null,this.prevTime=0,this.prevType=null,m.pluginEvents.once(a.BOOT,this.boot,this),m.pluginEvents.on(a.START,this.start,this)},boot:function(){var m=this.settings.input;this.enabled=o(m,"keyboard",!0);var v=o(m,"keyboard.capture",null);v&&this.addCaptures(v),this.sceneInputPlugin.pluginEvents.once(a.DESTROY,this.destroy,this)},start:function(){this.sceneInputPlugin.manager.events.on(a.MANAGER_PROCESS,this.update,this),this.sceneInputPlugin.pluginEvents.once(a.SHUTDOWN,this.shutdown,this),this.game.events.on(r.BLUR,this.resetKeys,this),this.scene.sys.events.on(g.PAUSE,this.resetKeys,this),this.scene.sys.events.on(g.SLEEP,this.resetKeys,this)},isActive:function(){return this.enabled&&this.scene.sys.canInput()},addCapture:function(m){return this.manager.addCapture(m),this},removeCapture:function(m){return this.manager.removeCapture(m),this},getCaptures:function(){return this.manager.captures},enableGlobalCapture:function(){return this.manager.preventDefault=!0,this},disableGlobalCapture:function(){return this.manager.preventDefault=!1,this},clearCaptures:function(){return this.manager.clearCaptures(),this},createCursorKeys:function(){return this.addKeys({up:u.UP,down:u.DOWN,left:u.LEFT,right:u.RIGHT,space:u.SPACE,shift:u.SHIFT})},addKeys:function(m,v,E){v===void 0&&(v=!0),E===void 0&&(E=!1);var x={};if(typeof m=="string"){m=m.split(",");for(var T=0;T<m.length;T++){var A=m[T].trim();A&&(x[A]=this.addKey(A,v,E))}}else for(var P in m)x[P]=this.addKey(m[P],v,E);return x},addKey:function(m,v,E){v===void 0&&(v=!0),E===void 0&&(E=!1);var x=this.keys;if(m instanceof l){var T=x.indexOf(m);return T>-1?x[T]=m:x[m.keyCode]=m,v&&this.addCapture(m.keyCode),m.setEmitOnRepeat(E),m}return typeof m=="string"&&(m=u[m.toUpperCase()]),x[m]||(x[m]=new l(this,m),v&&this.addCapture(m),x[m].setEmitOnRepeat(E)),x[m]},removeKey:function(m,v,E){v===void 0&&(v=!1),E===void 0&&(E=!1);var x=this.keys,T;if(m instanceof l){var A=x.indexOf(m);A>-1&&(T=this.keys[A],this.keys[A]=void 0)}else typeof m=="string"&&(m=u[m.toUpperCase()]);return x[m]&&(T=x[m],x[m]=void 0),T&&(T.plugin=null,E&&this.removeCapture(T.keyCode),v&&T.destroy()),this},removeAllKeys:function(m,v){m===void 0&&(m=!1),v===void 0&&(v=!1);for(var E=this.keys,x=0;x<E.length;x++){var T=E[x];T&&(E[x]=void 0,v&&this.removeCapture(T.keyCode),m&&T.destroy())}return this},createCombo:function(m,v){return new d(this,m,v)},checkDown:function(m,v){if(v===void 0&&(v=0),this.enabled&&m.isDown){var E=c(this.time-m.timeDown,v);if(E>m._tick)return m._tick=E,!0}return!1},update:function(){var m=this.manager.queue,v=m.length;if(!(!this.isActive()||v===0))for(var E=this.keys,x=0;x<v;x++){var T=m[x],A=T.keyCode,P=E[A],R=!1;T.cancelled===void 0&&(T.cancelled=0,T.stopImmediatePropagation=function(){T.cancelled=1},T.stopPropagation=function(){T.cancelled=-1}),T.cancelled!==-1&&(A===this.prevCode&&T.timeStamp===this.prevTime&&T.type===this.prevType||(this.prevCode=A,this.prevTime=T.timeStamp,this.prevType=T.type,T.type==="keydown"?(P&&(R=P.isDown,P.onDown(T)),!T.cancelled&&(!P||!R)&&(p[A]&&this.emit(n.KEY_DOWN+p[A],T),T.cancelled||this.emit(n.ANY_KEY_DOWN,T))):(P&&P.onUp(T),T.cancelled||(p[A]&&this.emit(n.KEY_UP+p[A],T),T.cancelled||this.emit(n.ANY_KEY_UP,T))),T.cancelled===1&&(T.cancelled=0)))}},resetKeys:function(){for(var m=this.keys,v=0;v<m.length;v++)m[v]&&m[v].reset();return this},shutdown:function(){this.removeAllKeys(!0),this.removeAllListeners(),this.sceneInputPlugin.manager.events.off(a.MANAGER_PROCESS,this.update,this),this.game.events.off(r.BLUR,this.resetKeys),this.scene.sys.events.off(g.PAUSE,this.resetKeys,this),this.scene.sys.events.off(g.SLEEP,this.resetKeys,this),this.queue=[]},destroy:function(){this.shutdown();for(var m=this.keys,v=0;v<m.length;v++)m[v]&&m[v].destroy();this.keys=[],this.combos=[],this.queue=[],this.scene=null,this.settings=null,this.sceneInputPlugin=null,this.manager=null},time:{get:function(){return this.sceneInputPlugin.manager.time}}});h.register("KeyboardPlugin",f,"keyboard","keyboard","inputKeyboard"),t.exports=f}),iA=y((e,t)=>{var i=function(s){return s._justDown?(s._justDown=!1,!0):!1};t.exports=i}),sA=y((e,t)=>{var i=function(s){return s._justUp?(s._justUp=!1,!0):!1};t.exports=i}),nA=y((e,t)=>{var i=function(s,n){n===void 0&&(n=50);var r=s.plugin.game.loop.time-s.timeDown;return s.isDown&&r<n};t.exports=i}),rA=y((e,t)=>{var i=function(s,n){n===void 0&&(n=50);var r=s.plugin.game.loop.time-s.timeUp;return s.isUp&&r<n};t.exports=i}),aA=y((e,t)=>{t.exports={Events:qn(),KeyboardManager:zu(),KeyboardPlugin:eA(),Key:Vc(),KeyCodes:Un(),KeyCombo:Zc(),AdvanceKeyCombo:Xc(),ProcessKeyCombo:Kc(),ResetKeyCombo:jc(),JustDown:iA(),JustUp:sA(),DownDuration:nA(),UpDuration:rA()}}),oA=y((e,t)=>{t.exports={MouseManager:Wu()}}),hA=y((e,t)=>{t.exports={TouchManager:Xu()}}),lA=y((e,t)=>{var i=xa(),s=Qt(),n={CreatePixelPerfectHandler:Uc(),CreateInteractiveObject:Gc(),Events:pi(),Gamepad:H1(),InputManager:Ku(),InputPlugin:X1(),InputPluginCache:Zn(),Keyboard:aA(),Mouse:oA(),Pointer:Vu(),Touch:hA()};n=s(!1,n,i),t.exports=n}),ji=y((e,t)=>{var i={LOADER_IDLE:0,LOADER_LOADING:1,LOADER_PROCESSING:2,LOADER_COMPLETE:3,LOADER_SHUTDOWN:4,LOADER_DESTROYED:5,FILE_PENDING:10,FILE_LOADING:11,FILE_LOADED:12,FILE_FAILED:13,FILE_PROCESSING:14,FILE_ERRORED:16,FILE_COMPLETE:17,FILE_DESTROYED:18,FILE_POPULATED:19,FILE_PENDING_DESTROY:20};t.exports=i}),Jn=y((e,t)=>{var i=function(s,n){return s.url?s.url.match(/^(?:blob:|data:|capacitor:\/\/|http:\/\/|https:\/\/|\/\/)/)?s.url:n+s.url:!1};t.exports=i}),Qn=y((e,t)=>{var i=function(s,n,r,o,a,h){return s===void 0&&(s=""),n===void 0&&(n=!0),r===void 0&&(r=""),o===void 0&&(o=""),a===void 0&&(a=0),h===void 0&&(h=!1),{responseType:s,async:n,user:r,password:o,timeout:a,headers:void 0,header:void 0,headerValue:void 0,requestedWith:!1,overrideMimeType:void 0,withCredentials:h}};t.exports=i}),Ga=y((e,t)=>{var i=Qt(),s=Qn(),n=function(r,o){var a=r===void 0?s():i({},r);if(o)for(var h in o)o[h]!==void 0&&(a[h]=o[h]);return a};t.exports=n}),qc=y((e,t)=>{var i=Ga(),s=function(n,r){var o=i(r,n.xhrSettings);if(n.base64){var a=n.url.split(";base64,").pop()||n.url.split(",").pop(),h={responseText:atob(a)};n.onBase64Load(h);return}var l=new XMLHttpRequest;if(l.open("GET",n.src,o.async,o.user,o.password),l.responseType=n.xhrSettings.responseType,l.timeout=o.timeout,o.headers)for(var u in o.headers)l.setRequestHeader(u,o.headers[u]);return o.header&&o.headerValue&&l.setRequestHeader(o.header,o.headerValue),o.requestedWith&&l.setRequestHeader("X-Requested-With",o.requestedWith),o.overrideMimeType&&l.overrideMimeType(o.overrideMimeType),o.withCredentials&&(l.withCredentials=!0),l.onload=n.onLoad.bind(n,l),l.onerror=n.onError.bind(n,l),l.onprogress=n.onProgress.bind(n),l.ontimeout=n.onError.bind(n,l),l.send(),l};t.exports=s}),Ns=y((e,t)=>{var i=W(),s=ji(),n=Vi(),r=dt(),o=Jn(),a=Ga(),h=qc(),l=Qn(),u=new i({initialize:function(d,p){if(this.loader=d,this.cache=r(p,"cache",!1),this.type=r(p,"type",!1),!this.type)throw new Error("Invalid File type: "+this.type);this.key=r(p,"key",!1);var g=this.key;if(d.prefix&&d.prefix!==""&&(this.key=d.prefix+g),!this.key)throw new Error("Invalid File key: "+this.key);var c=r(p,"url");c===void 0?c=d.path+g+"."+r(p,"extension",""):typeof c=="string"&&!c.match(/^(?:blob:|data:|capacitor:\/\/|http:\/\/|https:\/\/|\/\/)/)&&(c=d.path+c),this.url=c,this.src="",this.xhrSettings=l(r(p,"responseType",void 0)),r(p,"xhrSettings",!1)&&(this.xhrSettings=a(this.xhrSettings,r(p,"xhrSettings",{}))),this.xhrLoader=null,this.state=typeof this.url=="function"?s.FILE_POPULATED:s.FILE_PENDING,this.bytesTotal=0,this.bytesLoaded=-1,this.percentComplete=-1,this.crossOrigin=void 0,this.data=void 0,this.config=r(p,"config",{}),this.multiFile,this.linkFile,this.base64=typeof c=="string"&&c.indexOf("data:")===0,this.retryAttempts=r(p,"maxRetries",d.maxRetries)},setLink:function(d){this.linkFile=d,d.linkFile=this},resetXHR:function(){this.xhrLoader&&(this.xhrLoader.onload=void 0,this.xhrLoader.onerror=void 0,this.xhrLoader.onprogress=void 0)},load:function(){if(this.state===s.FILE_POPULATED)this.loader.nextFile(this,!0);else{if(this.state=s.FILE_LOADING,this.src=o(this,this.loader.baseURL),!this.src)throw new Error("URL Error in File: "+this.key+" from: "+this.url);this.src.indexOf("data:")===0&&(this.base64=!0),this.xhrLoader=h(this,this.loader.xhr)}},onLoad:function(d,p){var g=d.responseURL&&this.loader.localSchemes.some(function(m){return d.responseURL.indexOf(m)===0}),c=g&&p.target.status===0,f=!(p.target&&p.target.status!==200)||c;d.readyState===4&&d.status>=400&&d.status<=599&&(f=!1),this.state=s.FILE_LOADED,this.resetXHR(),this.loader.nextFile(this,f)},onBase64Load:function(d){this.xhrLoader=d,this.state=s.FILE_LOADED,this.percentComplete=1,this.loader.emit(n.FILE_PROGRESS,this,this.percentComplete),this.loader.nextFile(this,!0)},onError:function(){this.resetXHR(),this.retryAttempts>0?(this.retryAttempts--,this.load()):this.loader.nextFile(this,!1)},onProgress:function(d){d.lengthComputable&&(this.bytesLoaded=d.loaded,this.bytesTotal=d.total,this.percentComplete=Math.min(this.bytesLoaded/this.bytesTotal,1),this.loader.emit(n.FILE_PROGRESS,this,this.percentComplete))},onProcess:function(){this.state=s.FILE_PROCESSING,this.onProcessComplete()},onProcessComplete:function(){this.state=s.FILE_COMPLETE,this.multiFile&&this.multiFile.onFileComplete(this),this.loader.fileProcessComplete(this)},onProcessError:function(){this.state=s.FILE_ERRORED,this.multiFile&&this.multiFile.onFileFailed(this),this.loader.fileProcessComplete(this)},hasCacheConflict:function(){return this.cache&&this.cache.exists(this.key)},addToCache:function(){this.cache&&this.data&&this.cache.add(this.key,this.data)},pendingDestroy:function(d){if(this.state!==s.FILE_PENDING_DESTROY){d===void 0&&(d=this.data);var p=this.key,g=this.type;this.loader.emit(n.FILE_COMPLETE,p,g,d),this.loader.emit(n.FILE_KEY_COMPLETE+g+"-"+p,p,g,d),this.loader.flagForRemoval(this),this.state=s.FILE_PENDING_DESTROY}},destroy:function(){this.loader=null,this.cache=null,this.xhrSettings=null,this.multiFile=null,this.linkFile=null,this.data=null}});u.createObjectURL=function(d,p,g){if(typeof URL=="function")d.src=URL.createObjectURL(p);else{var c=new FileReader;c.onload=function(){d.removeAttribute("crossOrigin"),d.src="data:"+(p.type||g)+";base64,"+c.result.split(",")[1]},c.onerror=d.onerror,c.readAsDataURL(p)}},u.revokeObjectURL=function(d){typeof URL=="function"&&URL.revokeObjectURL(d.src)},t.exports=u}),uA=y((e,t)=>{var i=W(),s=Vi(),n=Ns(),r=dt(),o=Jn(),a=ce(),h=new i({Extends:n,initialize:function(l,u,d,p){if(a(u)){var g=u;u=r(g,"key"),p=r(g,"config",p)}var c={type:"audio",cache:l.cacheManager.audio,extension:d.type,key:u,url:d.url,config:p};n.call(this,l,c),this.locked="ontouchstart"in window,this.loaded=!1,this.filesLoaded=0,this.filesTotal=0},onLoad:function(){this.loaded||(this.loaded=!0,this.loader.nextFile(this,!0))},onError:function(){for(var l=0;l<this.data.length;l++){var u=this.data[l];u.oncanplaythrough=null,u.onerror=null}this.loader.nextFile(this,!1)},onProgress:function(l){var u=l.target;u.oncanplaythrough=null,u.onerror=null,this.filesLoaded++,this.percentComplete=Math.min(this.filesLoaded/this.filesTotal,1),this.loader.emit(s.FILE_PROGRESS,this,this.percentComplete),this.filesLoaded===this.filesTotal&&this.onLoad()},load:function(){this.data=[];var l=this.config&&this.config.instances||1;this.filesTotal=l,this.filesLoaded=0,this.percentComplete=0;for(var u=0;u<l;u++){var d=new Audio;d.dataset||(d.dataset={}),d.dataset.name=this.key+("0"+u).slice(-2),d.dataset.used="false",this.locked?d.dataset.locked="true":(d.dataset.locked="false",d.preload="auto",d.oncanplaythrough=this.onProgress.bind(this),d.onerror=this.onError.bind(this)),this.data.push(d)}for(u=0;u<this.data.length;u++)d=this.data[u],d.src=o(this,this.loader.baseURL),this.locked||d.load();this.locked&&setTimeout(this.onLoad.bind(this))}});t.exports=h}),cA=y((e,t)=>{var i=W(),s=ji(),n=Ns(),r=gi(),o=dt(),a=uA(),h=ce(),l=new i({Extends:n,initialize:function(u,d,p,g,c){if(h(d)){var f=d;d=o(f,"key"),g=o(f,"xhrSettings"),c=o(f,"context",c)}var m={type:"audio",cache:u.cacheManager.audio,extension:p.type,responseType:"arraybuffer",key:d,url:p.url,xhrSettings:g,config:{context:c}};n.call(this,u,m)},onProcess:function(){this.state=s.FILE_PROCESSING;var u=this;this.config.context.decodeAudioData(this.xhrLoader.response,function(d){u.data=d,u.onProcessComplete()},function(d){u.onProcessError()}),this.config.context=null}});l.create=function(u,d,p,g,c){var f=u.systems.game,m=f.config.audio,v=f.device.audio;h(d)&&(p=o(d,"url",[]),g=o(d,"config",{}));var E=l.getAudioURL(f,p);return E?v.webAudio&&!m.disableWebAudio?new l(u,d,E,c,f.sound.context):new a(u,d,E,g):null},l.getAudioURL=function(u,d){Array.isArray(d)||(d=[d]);for(var p=0;p<d.length;p++){var g=o(d[p],"url",d[p]);if(g.indexOf("blob:")===0||g.indexOf("data:")===0)return{url:g,type:""};var c=g.match(/\.([a-zA-Z0-9]+)($|\?)/);if(c=o(d[p],"type",c?c[1]:"").toLowerCase(),u.device.audio[c])return{url:g,type:c}}return null},r.register("audio",function(u,d,p,g){var c=this.systems.game,f=c.config.audio,m=c.device.audio;if(f.noAudio||!m.webAudio&&!m.audioData)return this;var v;if(Array.isArray(u))for(var E=0;E<u.length;E++)v=l.create(this,u[E]),v&&this.addFile(v);else v=l.create(this,u,d,p,g),v&&this.addFile(v);return this}),t.exports=l}),Ya=y((e,t)=>{var i=W(),s=ji(),n=Ns(),r=gi(),o=dt(),a=ce(),h=Jn(),l=new i({Extends:n,initialize:function u(d,p,g,c,f){var m="png",v;if(a(p)){var E=p;p=o(E,"key"),g=o(E,"url"),v=o(E,"normalMap"),c=o(E,"xhrSettings"),m=o(E,"extension",m),f=o(E,"frameConfig")}Array.isArray(g)&&(v=g[1],g=g[0]);var x={type:"image",cache:d.textureManager,extension:m,responseType:"blob",key:p,url:g,xhrSettings:c,config:f};if(n.call(this,d,x),v){var T=new u(d,this.key,v,c,f);T.type="normalMap",this.setLink(T),d.addFile(T)}this.useImageElementLoad=d.imageLoadType==="HTMLImageElement"||this.base64,this.useImageElementLoad&&(this.load=this.loadImage,this.onProcess=this.onProcessImage)},onProcess:function(){this.state=s.FILE_PROCESSING,this.data=new Image,this.data.crossOrigin=this.crossOrigin;var u=this;this.data.onload=function(){n.revokeObjectURL(u.data),u.onProcessComplete()},this.data.onerror=function(){n.revokeObjectURL(u.data),u.onProcessError()},n.createObjectURL(this.data,this.xhrLoader.response,"image/png")},onProcessImage:function(){var u=this.state;this.state=s.FILE_PROCESSING,u===s.FILE_LOADED?this.onProcessComplete():this.onProcessError()},loadImage:function(){this.state=s.FILE_LOADING,this.src=h(this,this.loader.baseURL),this.data=new Image,this.data.crossOrigin=this.crossOrigin;var u=this;this.data.onload=function(){u.state=s.FILE_LOADED,u.loader.nextFile(u,!0)},this.data.onerror=function(){u.loader.nextFile(u,!1)},this.data.src=this.src},addToCache:function(){var u=this.linkFile;u?u.state>=s.FILE_COMPLETE&&(u.type==="spritesheet"?u.addToCache():this.type==="normalMap"?this.cache.addImage(this.key,u.data,this.data):this.cache.addImage(this.key,this.data,u.data)):this.cache.addImage(this.key,this.data)}});r.register("image",function(u,d,p){if(Array.isArray(u))for(var g=0;g<u.length;g++)this.addFile(new l(this,u[g]));else this.addFile(new l(this,u,d,p));return this}),t.exports=l}),Jc=y((e,t)=>{var i=W(),s=ji(),n=Ns(),r=gi(),o=dt(),a=St(),h=ce(),l=new i({Extends:n,initialize:function(u,d,p,g,c){var f="json";if(h(d)){var m=d;d=o(m,"key"),p=o(m,"url"),g=o(m,"xhrSettings"),f=o(m,"extension",f),c=o(m,"dataKey",c)}var v={type:"json",cache:u.cacheManager.json,extension:f,responseType:"text",key:d,url:p,xhrSettings:g,config:c};n.call(this,u,v),h(p)&&(c?this.data=a(p,c):this.data=p,this.state=s.FILE_POPULATED)},onProcess:function(){if(this.state!==s.FILE_POPULATED){this.state=s.FILE_PROCESSING;try{var u=JSON.parse(this.xhrLoader.responseText)}catch(p){throw this.onProcessError(),p}var d=this.config;typeof d=="string"?this.data=a(u,d,u):this.data=u}this.onProcessComplete()}});r.register("json",function(u,d,p,g){if(Array.isArray(u))for(var c=0;c<u.length;c++)this.addFile(new l(this,u[c]));else this.addFile(new l(this,u,d,g,p));return this}),t.exports=l}),Qc=y((e,t)=>{var i=W(),s=ji(),n=Vi(),r=new i({initialize:function(o,a,h,l){var u=[];l.forEach(function(g){g&&u.push(g)}),this.loader=o,this.type=a,this.key=h;var d=this.key;o.prefix&&o.prefix!==""&&(this.key=o.prefix+d),this.multiKeyIndex=o.multiKeyIndex++,this.files=u,this.state=s.FILE_PENDING,this.complete=!1,this.pending=u.length,this.failed=0,this.config={},this.baseURL=o.baseURL,this.path=o.path,this.prefix=o.prefix;for(var p=0;p<u.length;p++)u[p].multiFile=this},isReadyToProcess:function(){return this.pending===0&&this.failed===0&&!this.complete},addToMultiFile:function(o){return this.files.push(o),o.multiFile=this,this.pending++,this.complete=!1,this},onFileComplete:function(o){var a=this.files.indexOf(o);a!==-1&&this.pending--},onFileFailed:function(o){var a=this.files.indexOf(o);a!==-1&&this.failed++},pendingDestroy:function(){if(this.state!==s.FILE_PENDING_DESTROY){var o=this.key,a=this.type;this.loader.emit(n.FILE_COMPLETE,o,a),this.loader.emit(n.FILE_KEY_COMPLETE+a+"-"+o,o,a),this.loader.flagForRemoval(this);for(var h=0;h<this.files.length;h++)this.files[h].pendingDestroy();this.state=s.FILE_PENDING_DESTROY}},destroy:function(){this.loader=null,this.files=null,this.config=null}});t.exports=r}),dA=y((e,t)=>{var i=W(),s=gi(),n=dt(),r=Ya(),o=ce(),a=Jc(),h=Qc(),l=new i({Extends:h,initialize:function(u,d,p,g,c,f){var m,v;if(o(d)){var E=d;d=n(E,"key"),m=new r(u,{key:d,url:n(E,"textureURL"),extension:n(E,"textureExtension","png"),normalMap:n(E,"normalMap"),xhrSettings:n(E,"textureXhrSettings")}),v=new a(u,{key:d,url:n(E,"atlasURL"),extension:n(E,"atlasExtension","json"),xhrSettings:n(E,"atlasXhrSettings")})}else m=new r(u,d,p,c),v=new a(u,d,g,f);m.linkFile?h.call(this,u,"atlasjson",d,[m,v,m.linkFile]):h.call(this,u,"atlasjson",d,[m,v])},addToCache:function(){if(this.isReadyToProcess()){var u=this.files[0],d=this.files[1],p=this.files[2]?this.files[2].data:null;this.loader.textureManager.addAtlas(u.key,u.data,d.data,p),this.complete=!0}}});s.register("atlas",function(u,d,p,g,c){var f;if(Array.isArray(u))for(var m=0;m<u.length;m++)f=new l(this,u[m]),this.addFile(f.files);else f=new l(this,u,d,p,g,c),this.addFile(f.files);return this}),t.exports=l}),pA=y((e,t)=>{var i=W(),s=gi(),n=dt(),r=Ya(),o=ce(),a=Jc(),h=Qc(),l=new i({Extends:h,initialize:function(u,d,p,g,c,f,m){if(o(d)){var v=d;d=n(v,"key"),n(v,"url",!1)?p=n(v,"url"):p=n(v,"atlasURL"),f=n(v,"xhrSettings"),g=n(v,"path"),c=n(v,"baseURL"),m=n(v,"textureXhrSettings")}var E=new a(u,d,p,f);h.call(this,u,"multiatlas",d,[E]),this.config.path=g,this.config.baseURL=c,this.config.textureXhrSettings=m},onFileComplete:function(u){var d=this.files.indexOf(u);if(d!==-1&&(this.pending--,u.type==="json"&&u.data.hasOwnProperty("textures"))){var p=u.data.textures,g=this.config,c=this.loader,f=c.baseURL,m=c.path,v=c.prefix,E=n(g,"baseURL",this.baseURL),x=n(g,"path",this.path),T=n(g,"prefix",this.prefix),A=n(g,"textureXhrSettings");c.setBaseURL(E),c.setPath(x),c.setPrefix(T);for(var P=0;P<p.length;P++){var R=p[P].image,S="MA"+this.multiKeyIndex+"_"+R,I=new r(c,S,R,A);if(this.addToMultiFile(I),c.addFile(I),p[P].normalMap){var w=new r(c,S,p[P].normalMap,A);w.type="normalMap",I.setLink(w),this.addToMultiFile(w),c.addFile(w)}}c.setBaseURL(f),c.setPath(m),c.setPrefix(v)}},addToCache:function(){if(this.isReadyToProcess()){for(var u=this.files[0],d=[],p=[],g=[],c=1;c<this.files.length;c++){var f=this.files[c];if(f.type!=="normalMap")for(var m=f.key.indexOf("_"),v=f.key.substr(m+1),E=f.data,x=0;x<u.data.textures.length;x++){var T=u.data.textures[x];if(T.image===v){p.push(E),d.push(T),f.linkFile&&g.push(f.linkFile.data);break}}}g.length===0&&(g=void 0),this.loader.textureManager.addAtlasJSONArray(this.key,p,d,g),this.complete=!0}}});s.register("multiatlas",function(u,d,p,g,c){var f;if(Array.isArray(u))for(var m=0;m<u.length;m++)f=new l(this,u[m]),this.addFile(f.files);else f=new l(this,u,d,p,g,c),this.addFile(f.files);return this}),t.exports=l}),gA=y((e,t)=>{var i=W(),s=ji(),n=ba(),r=Ct(),o=Vi(),a=gi(),h=dt(),l=St(),u=ce(),d=he(),p=Vt(),g=Qn(),c=new i({Extends:r,initialize:function(f){r.call(this);var m=f.sys.game.config,v=f.sys.settings.loader;this.scene=f,this.systems=f.sys,this.cacheManager=f.sys.cache,this.textureManager=f.sys.textures,this.sceneManager=f.sys.game.scene,a.install(this),this.prefix="",this.path="",this.baseURL="",this.setBaseURL(h(v,"baseURL",m.loaderBaseURL)),this.setPath(h(v,"path",m.loaderPath)),this.setPrefix(h(v,"prefix",m.loaderPrefix)),this.maxParallelDownloads=h(v,"maxParallelDownloads",m.loaderMaxParallelDownloads),this.xhr=g(h(v,"responseType",m.loaderResponseType),h(v,"async",m.loaderAsync),h(v,"user",m.loaderUser),h(v,"password",m.loaderPassword),h(v,"timeout",m.loaderTimeout),h(v,"withCredentials",m.loaderWithCredentials)),this.crossOrigin=h(v,"crossOrigin",m.loaderCrossOrigin),this.imageLoadType=h(v,"imageLoadType",m.loaderImageLoadType),this.localSchemes=h(v,"localScheme",m.loaderLocalScheme),this.totalToLoad=0,this.progress=0,this.list=new n,this.inflight=new n,this.queue=new n,this._deleteQueue=new n,this.totalFailed=0,this.totalComplete=0,this.state=s.LOADER_IDLE,this.multiKeyIndex=0,this.maxRetries=h(v,"maxRetries",m.loaderMaxRetries),f.sys.events.once(p.BOOT,this.boot,this),f.sys.events.on(p.START,this.pluginStart,this)},boot:function(){this.systems.events.once(p.DESTROY,this.destroy,this)},pluginStart:function(){this.systems.events.once(p.SHUTDOWN,this.shutdown,this)},setBaseURL:function(f){return f===void 0&&(f=""),f!==""&&f.substr(-1)!=="/"&&(f=f.concat("/")),this.baseURL=f,this},setPath:function(f){return f===void 0&&(f=""),f!==""&&f.substr(-1)!=="/"&&(f=f.concat("/")),this.path=f,this},setPrefix:function(f){return f===void 0&&(f=""),this.prefix=f,this},setCORS:function(f){return this.crossOrigin=f,this},addFile:function(f){Array.isArray(f)||(f=[f]);for(var m=0;m<f.length;m++){var v=f[m];this.keyExists(v)||(this.list.set(v),this.emit(o.ADD,v.key,v.type,this,v),this.isLoading()&&(this.totalToLoad++,this.updateProgress()))}},keyExists:function(f){var m=f.hasCacheConflict();return m||this.list.iterate(function(v){if(v.type===f.type&&v.key===f.key)return m=!0,!1}),!m&&this.isLoading()&&(this.inflight.iterate(function(v){if(v.type===f.type&&v.key===f.key)return m=!0,!1}),this.queue.iterate(function(v){if(v.type===f.type&&v.key===f.key)return m=!0,!1})),m},addPack:function(f,m){if(typeof m=="string"){var v=l(f,m);v&&(f={packKey:v})}var E=0,x=this.baseURL,T=this.path,A=this.prefix;for(var P in f)if(Object.prototype.hasOwnProperty.call(f,P)){var R=f[P],S=h(R,"baseURL",x),I=h(R,"path",T),w=h(R,"prefix",A),C=h(R,"files",null),_=h(R,"defaultType","void");if(Array.isArray(C)){this.setBaseURL(S),this.setPath(I),this.setPrefix(w);for(var O=0;O<C.length;O++){var D=C[O],F=D.hasOwnProperty("type")?D.type:_;this[F]&&(this[F](D),E++)}}}return this.setBaseURL(x),this.setPath(T),this.setPrefix(A),E>0},removePack:function(f,m){var v=this.systems.anims,E=this.cacheManager,x=this.textureManager,T={animation:"json",aseprite:"json",audio:"audio",audioSprite:"audio",binary:"binary",bitmapFont:"bitmapFont",css:null,glsl:"shader",html:"html",json:"json",obj:"obj",plugin:null,scenePlugin:null,script:null,spine:"json",text:"text",tilemapCSV:"tilemap",tilemapImpact:"tilemap",tilemapTiledJSON:"tilemap",video:"video",xml:"xml"},A;if(u(f))A=f;else if(A=E.json.get(f),!A)return;m&&(A={_:A[m]});for(var P in A){var R=A[P],S=h(R,"prefix",""),I=h(R,"files"),w=h(R,"defaultType");if(Array.isArray(I))for(var C=0;C<I.length;C++){var _=I[C],O=_.hasOwnProperty("type")?_.type:w;if(O){var D=S+_.key;if(O==="animation"&&v.remove(D),!((O==="aseprite"||O==="atlas"||O==="atlasXML"||O==="htmlTexture"||O==="image"||O==="multiatlas"||O==="spritesheet"||O==="svg"||O==="texture"||O==="unityAtlas")&&(x.remove(D),!T[O]))){if(O==="pack"){this.removePack(D,_.dataKey);continue}if(O==="spine"){var F=E.custom.spine.get(D);if(!F)continue;var N=F.prefix===void 0?"":F.prefix;E.custom.spine.remove(D);var Y=E.custom.spineTextures.get(D);if(!Y)continue;E.custom.spineTextures.remove(D);for(var L=0;L<Y.pages.length;L++){var b=Y.pages[L],M=N+b.name,k=D+":"+M;x.exists(k)?x.remove(k):x.remove(M)}}var B=T[O];if(B!==null){if(!B)continue;var H=E[B];H.remove(D)}}}}}},isLoading:function(){return this.state===s.LOADER_LOADING||this.state===s.LOADER_PROCESSING},isReady:function(){return this.state===s.LOADER_IDLE||this.state===s.LOADER_COMPLETE},start:function(){this.isReady()&&(this.progress=0,this.totalFailed=0,this.totalComplete=0,this.totalToLoad=this.list.size,this.emit(o.START,this),this.list.size===0?this.loadComplete():(this.state=s.LOADER_LOADING,this.inflight.clear(),this.queue.clear(),this.updateProgress(),this.checkLoadQueue(),this.systems.events.on(p.UPDATE,this.update,this)))},updateProgress:function(){this.progress=1-(this.list.size+this.inflight.size)/this.totalToLoad,this.emit(o.PROGRESS,this.progress)},update:function(){this.state===s.LOADER_LOADING&&this.list.size>0&&this.inflight.size<this.maxParallelDownloads&&this.checkLoadQueue()},checkLoadQueue:function(){this.list.each(function(f){if((f.state===s.FILE_POPULATED||f.state===s.FILE_PENDING&&this.inflight.size<this.maxParallelDownloads)&&(this.inflight.set(f),this.list.delete(f),f.crossOrigin||(f.crossOrigin=this.crossOrigin),f.load()),this.inflight.size===this.maxParallelDownloads)return!1},this)},nextFile:function(f,m){this.inflight&&(this.inflight.delete(f),this.updateProgress(),m?(this.totalComplete++,this.queue.set(f),this.emit(o.FILE_LOAD,f),f.onProcess()):(this.totalFailed++,this._deleteQueue.set(f),this.emit(o.FILE_LOAD_ERROR,f),this.fileProcessComplete(f)))},fileProcessComplete:function(f){!this.scene||!this.systems||!this.systems.game||this.systems.game.pendingDestroy||(f.state===s.FILE_ERRORED?f.multiFile&&f.multiFile.onFileFailed(f):f.state===s.FILE_COMPLETE&&(f.multiFile?f.multiFile.isReadyToProcess()&&(f.multiFile.addToCache(),f.multiFile.pendingDestroy()):(f.addToCache(),f.pendingDestroy())),this.queue.delete(f),this.list.size===0&&this.inflight.size===0&&this.queue.size===0&&this.loadComplete())},loadComplete:function(){this.emit(o.POST_PROCESS,this),this.list.clear(),this.inflight.clear(),this.queue.clear(),this.progress=1,this.state=s.LOADER_COMPLETE,this.systems.events.off(p.UPDATE,this.update,this),this._deleteQueue.iterateLocal("destroy"),this._deleteQueue.clear(),this.emit(o.COMPLETE,this,this.totalComplete,this.totalFailed)},flagForRemoval:function(f){this._deleteQueue.set(f)},saveJSON:function(f,m){return this.save(JSON.stringify(f),m)},save:function(f,m,v){m===void 0&&(m="file.json"),v===void 0&&(v="application/json");var E=new Blob([f],{type:v}),x=URL.createObjectURL(E),T=document.createElement("a");return T.download=m,T.textContent="Download "+m,T.href=x,T.click(),this},reset:function(){this.list.clear(),this.inflight.clear(),this.queue.clear();var f=this.systems.game.config,m=this.systems.settings.loader;this.setBaseURL(h(m,"baseURL",f.loaderBaseURL)),this.setPath(h(m,"path",f.loaderPath)),this.setPrefix(h(m,"prefix",f.loaderPrefix)),this.state=s.LOADER_IDLE},shutdown:function(){this.reset(),this.state=s.LOADER_SHUTDOWN,this.removeAllListeners(),this.systems.events.off(p.UPDATE,this.update,this),this.systems.events.off(p.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.state=s.LOADER_DESTROYED,this.systems.events.off(p.UPDATE,this.update,this),this.systems.events.off(p.START,this.pluginStart,this),this.list=null,this.inflight=null,this.queue=null,this.scene=null,this.systems=null,this.textureManager=null,this.cacheManager=null,this.sceneManager=null}});d.register("Loader",c,"load"),t.exports=c}),fA=y((e,t)=>{t.exports={Canvas:Hl(),WebGL:Pu()}}),mA=y((e,t)=>{var i=Fn(),s=Qt(),n={FX:ma(),BitmapMaskPipeline:Kl(),Events:Vl(),FXPipeline:Eu(),LightPipeline:yu(),MobilePipeline:Tu(),MultiPipeline:Ci(),PointLightPipeline:xu(),PostFXPipeline:te(),PreFXPipeline:cu(),RopePipeline:Su(),SinglePipeline:Au(),UtilityPipeline:wu()};n=s(!1,n,i),t.exports=n}),vA=y((e,t)=>{var i={WebGLAttribLocationWrapper:_u(),WebGLBufferWrapper:Ru(),WebGLProgramWrapper:bu(),WebGLTextureWrapper:Ea(),WebGLFramebufferWrapper:Iu(),WebGLUniformLocationWrapper:Ou()};t.exports=i}),EA=y((e,t)=>{var i=Fs(),s=Qt(),n={PipelineManager:Cu(),Pipelines:mA(),RenderTarget:zi(),Utils:Se(),WebGLPipeline:Le(),WebGLRenderer:Mu(),WebGLShader:Xl(),Wrappers:vA()};n=s(!1,n,i),t.exports=n}),yA=y((e,t)=>{t.exports={Events:Ds(),Snapshot:fA()},t.exports.WebGL=EA()}),TA=y((e,t)=>{var i=Qt(),s=Sa(),n={Center:ju(),Events:Is(),Orientation:Zu(),ScaleManager:$u(),ScaleModes:qu(),Zoom:Ju()};n=i(!1,n,s.CENTER),n=i(!1,n,s.ORIENTATION),n=i(!1,n,s.SCALE_MODE),n=i(!1,n,s.ZOOM),t.exports=n}),xA=y((e,t)=>{var i=Ot(),s=W(),n=Vt(),r=dt(),o=he(),a=new s({initialize:function(h){this.scene=h,this.systems=h.sys,this.settings=h.sys.settings,this.key=h.sys.settings.key,this.manager=h.sys.game.scene,this.transitionProgress=0,this._elapsed=0,this._target=null,this._duration=0,this._onUpdate,this._onUpdateScope,this._willSleep=!1,this._willRemove=!1,h.sys.events.once(n.BOOT,this.boot,this),h.sys.events.on(n.START,this.pluginStart,this)},boot:function(){this.systems.events.once(n.DESTROY,this.destroy,this)},pluginStart:function(){this._target=null,this.systems.events.once(n.SHUTDOWN,this.shutdown,this)},start:function(h,l){return h===void 0&&(h=this.key),this.manager.queueOp("stop",this.key),this.manager.queueOp("start",h,l),this},restart:function(h){var l=this.key;return this.manager.queueOp("stop",l),this.manager.queueOp("start",l,h),this},transition:function(h){h===void 0&&(h={});var l=r(h,"target",!1),u=this.manager.getScene(l);if(!l||!this.checkValidTransition(u))return!1;var d=r(h,"duration",1e3);this._elapsed=0,this._target=u,this._duration=d,this._willSleep=r(h,"sleep",!1),this._willRemove=r(h,"remove",!1);var p=r(h,"onUpdate",null);p&&(this._onUpdate=p,this._onUpdateScope=r(h,"onUpdateScope",this.scene));var g=r(h,"allowInput",!1);this.settings.transitionAllowInput=g;var c=u.sys.settings;c.isTransition=!0,c.transitionFrom=this.scene,c.transitionDuration=d,c.transitionAllowInput=g,r(h,"moveAbove",!1)?this.manager.moveAbove(this.key,l):r(h,"moveBelow",!1)&&this.manager.moveBelow(this.key,l),u.sys.isSleeping()?u.sys.wake(r(h,"data")):this.manager.start(l,r(h,"data"));var f=r(h,"onStart",null),m=r(h,"onStartScope",this.scene);return f&&f.call(m,this.scene,u,d),this.systems.events.emit(n.TRANSITION_OUT,u,d),!0},checkValidTransition:function(h){return!(!h||h.sys.isActive()||h.sys.isTransitioning()||h===this.scene||this.systems.isTransitioning())},step:function(h,l){this._elapsed+=l,this.transitionProgress=i(this._elapsed/this._duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.transitionProgress),this._elapsed>=this._duration&&this.transitionComplete()},transitionComplete:function(){var h=this._target.sys,l=this._target.sys.settings;h.events.emit(n.TRANSITION_COMPLETE,this.scene),l.isTransition=!1,l.transitionFrom=null,this._duration=0,this._target=null,this._onUpdate=null,this._onUpdateScope=null,this._willRemove?this.manager.remove(this.key):this._willSleep?this.systems.sleep():this.manager.stop(this.key)},add:function(h,l,u,d){return this.manager.add(h,l,u,d)},launch:function(h,l){return h&&h!==this.key&&this.manager.queueOp("start",h,l),this},run:function(h,l){return h&&h!==this.key&&this.manager.queueOp("run",h,l),this},pause:function(h,l){return h===void 0&&(h=this.key),this.manager.queueOp("pause",h,l),this},resume:function(h,l){return h===void 0&&(h=this.key),this.manager.queueOp("resume",h,l),this},sleep:function(h,l){return h===void 0&&(h=this.key),this.manager.queueOp("sleep",h,l),this},wake:function(h,l){return h===void 0&&(h=this.key),this.manager.queueOp("wake",h,l),this},switch:function(h,l){return h!==this.key&&this.manager.queueOp("switch",this.key,h,l),this},stop:function(h,l){return h===void 0&&(h=this.key),this.manager.queueOp("stop",h,l),this},setActive:function(h,l,u){l===void 0&&(l=this.key);var d=this.manager.getScene(l);return d&&d.sys.setActive(h,u),this},setVisible:function(h,l){l===void 0&&(l=this.key);var u=this.manager.getScene(l);return u&&u.sys.setVisible(h),this},isSleeping:function(h){return h===void 0&&(h=this.key),this.manager.isSleeping(h)},isActive:function(h){return h===void 0&&(h=this.key),this.manager.isActive(h)},isPaused:function(h){return h===void 0&&(h=this.key),this.manager.isPaused(h)},isVisible:function(h){return h===void 0&&(h=this.key),this.manager.isVisible(h)},swapPosition:function(h,l){return l===void 0&&(l=this.key),h!==l&&this.manager.swapPosition(h,l),this},moveAbove:function(h,l){return l===void 0&&(l=this.key),h!==l&&this.manager.moveAbove(h,l),this},moveBelow:function(h,l){return l===void 0&&(l=this.key),h!==l&&this.manager.moveBelow(h,l),this},remove:function(h){return h===void 0&&(h=this.key),this.manager.remove(h),this},moveUp:function(h){return h===void 0&&(h=this.key),this.manager.moveUp(h),this},moveDown:function(h){return h===void 0&&(h=this.key),this.manager.moveDown(h),this},bringToTop:function(h){return h===void 0&&(h=this.key),this.manager.bringToTop(h),this},sendToBack:function(h){return h===void 0&&(h=this.key),this.manager.sendToBack(h),this},get:function(h){return this.manager.getScene(h)},getStatus:function(h){var l=this.manager.getScene(h);if(l)return l.sys.getStatus()},getIndex:function(h){return h===void 0&&(h=this.key),this.manager.getIndex(h)},shutdown:function(){var h=this.systems.events;h.off(n.SHUTDOWN,this.shutdown,this),h.off(n.TRANSITION_OUT)},destroy:function(){this.shutdown(),this.scene.sys.events.off(n.START,this.start,this),this.scene=null,this.systems=null,this.settings=null,this.manager=null}});o.register("ScenePlugin",a,"scenePlugin"),t.exports=a}),SA=y((e,t)=>{var i=Gn(),s=Qt(),n={Events:Vt(),GetPhysicsPlugins:tc(),GetScenePlugins:ec(),SceneManager:rc(),ScenePlugin:xA(),Settings:sc(),Systems:Aa()};n=s(!1,n,i),t.exports=n}),AA=y((e,t)=>{t.exports={SoundManagerCreator:Ec(),Events:Pi(),BaseSound:Wn(),BaseSoundManager:zn(),WebAudioSound:mc(),WebAudioSoundManager:vc(),HTML5AudioSound:cc(),HTML5AudioSoundManager:dc(),NoAudioSound:pc(),NoAudioSoundManager:gc()}}),wA=y((e,t)=>{var i={LINEAR:0,NEAREST:1};t.exports=i}),CA=y((e,t)=>{var i=Qt(),s=wA(),n={CanvasTexture:oc(),DynamicTexture:hc(),Events:ks(),FilterMode:s,Frame:Hi(),Parsers:lc(),Texture:Yn(),TextureManager:uc(),TextureSource:ac()};n=i(!1,n,s),t.exports=n}),$c=y((e,t)=>{var i=W(),s=dt(),n=new i({initialize:function(r){this.delay=0,this.repeat=0,this.repeatCount=0,this.loop=!1,this.callback,this.callbackScope,this.args,this.timeScale=1,this.startAt=0,this.elapsed=0,this.paused=!1,this.hasDispatched=!1,this.reset(r)},reset:function(r){if(this.delay=s(r,"delay",0),this.repeat=s(r,"repeat",0),this.loop=s(r,"loop",!1),this.callback=s(r,"callback",void 0),this.callbackScope=s(r,"callbackScope",this),this.args=s(r,"args",[]),this.timeScale=s(r,"timeScale",1),this.startAt=s(r,"startAt",0),this.paused=s(r,"paused",!1),this.elapsed=this.startAt,this.hasDispatched=!1,this.repeatCount=this.repeat===-1||this.loop?999999999999:this.repeat,this.delay<=0&&this.repeatCount>0)throw new Error("TimerEvent infinite loop created via zero delay");return this},getProgress:function(){return this.elapsed/this.delay},getOverallProgress:function(){if(this.repeat>0){var r=this.delay+this.delay*this.repeat,o=this.elapsed+this.delay*(this.repeat-this.repeatCount);return o/r}else return this.getProgress()},getRepeatCount:function(){return this.repeatCount},getElapsed:function(){return this.elapsed},getElapsedSeconds:function(){return this.elapsed*.001},getRemaining:function(){return this.delay-this.elapsed},getRemainingSeconds:function(){return this.getRemaining()*.001},getOverallRemaining:function(){return this.delay*(1+this.repeatCount)-this.elapsed},getOverallRemainingSeconds:function(){return this.getOverallRemaining()*.001},remove:function(r){r===void 0&&(r=!1),this.elapsed=this.delay,this.hasDispatched=!r,this.repeatCount=0},destroy:function(){this.callback=void 0,this.callbackScope=void 0,this.args=[]}});t.exports=n}),PA=y((e,t)=>{var i=W(),s=he(),n=Vt(),r=$c(),o=Ye(),a=new i({initialize:function(h){this.scene=h,this.systems=h.sys,this.now=0,this.startTime=0,this.timeScale=1,this.paused=!1,this._active=[],this._pendingInsertion=[],this._pendingRemoval=[],h.sys.events.once(n.BOOT,this.boot,this),h.sys.events.on(n.START,this.start,this)},boot:function(){this.now=this.systems.game.loop.time,this.systems.events.once(n.DESTROY,this.destroy,this)},start:function(){this.startTime=this.systems.game.loop.time;var h=this.systems.events;h.on(n.PRE_UPDATE,this.preUpdate,this),h.on(n.UPDATE,this.update,this),h.once(n.SHUTDOWN,this.shutdown,this)},addEvent:function(h){var l;if(h instanceof r){if(l=h,this.removeEvent(l),l.elapsed=l.startAt,l.hasDispatched=!1,l.repeatCount=l.repeat===-1||l.loop?999999999999:l.repeat,l.delay<=0&&l.repeatCount>0)throw new Error("TimerEvent infinite loop created via zero delay")}else l=new r(h);return this._pendingInsertion.push(l),l},delayedCall:function(h,l,u,d){return this.addEvent({delay:h,callback:l,args:u,callbackScope:d})},clearPendingEvents:function(){return this._pendingInsertion=[],this},removeEvent:function(h){Array.isArray(h)||(h=[h]);for(var l=0;l<h.length;l++){var u=h[l];o(this._pendingRemoval,u),o(this._pendingInsertion,u),o(this._active,u)}return this},removeAllEvents:function(){return this._pendingRemoval=this._pendingRemoval.concat(this._active),this},preUpdate:function(){var h=this._pendingRemoval.length,l=this._pendingInsertion.length;if(!(h===0&&l===0)){var u,d;for(u=0;u<h;u++){d=this._pendingRemoval[u];var p=this._active.indexOf(d);p>-1&&this._active.splice(p,1),d.destroy()}for(u=0;u<l;u++)d=this._pendingInsertion[u],this._active.push(d);this._pendingRemoval.length=0,this._pendingInsertion.length=0}},update:function(h,l){if(this.now=h,!this.paused){l*=this.timeScale;for(var u=0;u<this._active.length;u++){var d=this._active[u];if(!d.paused&&(d.elapsed+=l*d.timeScale,d.elapsed>=d.delay)){var p=d.elapsed-d.delay;if(d.elapsed=d.delay,!d.hasDispatched&&d.callback&&(d.hasDispatched=!0,d.callback.apply(d.callbackScope,d.args)),d.repeatCount>0){if(d.repeatCount--,p>=d.delay)for(;p>=d.delay&&d.repeatCount>0;)d.callback&&d.callback.apply(d.callbackScope,d.args),p-=d.delay,d.repeatCount--;d.elapsed=p,d.hasDispatched=!1}else d.hasDispatched&&this._pendingRemoval.push(d)}}}},shutdown:function(){var h;for(h=0;h<this._pendingInsertion.length;h++)this._pendingInsertion[h].destroy();for(h=0;h<this._active.length;h++)this._active[h].destroy();for(h=0;h<this._pendingRemoval.length;h++)this._pendingRemoval[h].destroy();this._active.length=0,this._pendingRemoval.length=0,this._pendingInsertion.length=0;var l=this.systems.events;l.off(n.PRE_UPDATE,this.preUpdate,this),l.off(n.UPDATE,this.update,this),l.off(n.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.scene.sys.events.off(n.START,this.start,this),this.scene=null,this.systems=null}});s.register("Clock",a,"time"),t.exports=a}),RA=y((e,t)=>{t.exports="complete"}),td=y((e,t)=>{t.exports={COMPLETE:RA()}}),bA=y((e,t)=>{var i=W(),s=Ct(),n=jt(),r=dt(),o=Vt(),a=td(),h=new i({Extends:s,initialize:function(l,u){s.call(this),this.scene=l,this.systems=l.sys,this.elapsed=0,this.timeScale=1,this.paused=!0,this.complete=!1,this.totalComplete=0,this.loop=0,this.iteration=0,this.events=[];var d=this.systems.events;d.on(o.PRE_UPDATE,this.preUpdate,this),d.on(o.UPDATE,this.update,this),d.once(o.SHUTDOWN,this.destroy,this),u&&this.add(u)},preUpdate:function(l,u){this.paused||(this.elapsed+=u*this.timeScale)},update:function(){if(!(this.paused||this.complete)){var l,u=this.events,d=!1,p=this.systems,g;for(l=0;l<u.length;l++){var c=u[l];if(!c.complete&&c.time<=this.elapsed){if(c.complete=!0,this.totalComplete++,g=c.target?c.target:this,c.if&&!c.if.call(g,c))continue;if(c.once&&(d=!0),c.set&&c.target)for(var f in c.set)c.target[f]=c.set[f];this.iteration&&c.repeat++,c.loop&&c.repeat&&c.loop.call(g),c.tween&&(c.tweenInstance=p.tweens.add(c.tween)),c.sound&&(typeof c.sound=="string"?p.sound.play(c.sound):p.sound.play(c.sound.key,c.sound.config)),c.event&&this.emit(c.event,g),c.run&&c.run.call(g),c.stop&&this.stop()}}if(d)for(l=0;l<u.length;l++)u[l].complete&&u[l].once&&(u.splice(l,1),l--);this.totalComplete>=u.length&&(this.loop!==0&&(this.loop===-1||this.loop>this.iteration)?(this.iteration++,this.reset(!0)):this.complete=!0),this.complete&&this.emit(a.COMPLETE,this)}},play:function(l){return l===void 0&&(l=!0),this.paused=!1,this.complete=!1,this.totalComplete=0,l&&this.reset(),this},pause:function(){this.paused=!0;for(var l=this.events,u=0;u<l.length;u++){var d=l[u];d.tweenInstance&&(d.tweenInstance.paused=!0)}return this},repeat:function(l){return(l===void 0||l===!0)&&(l=-1),l===!1&&(l=0),this.loop=l,this},resume:function(){this.paused=!1;for(var l=this.events,u=0;u<l.length;u++){var d=l[u];d.tweenInstance&&(d.tweenInstance.paused=!1)}return this},stop:function(){return this.paused=!0,this.complete=!0,this},reset:function(l){l===void 0&&(l=!1),this.elapsed=0,l||(this.iteration=0);for(var u=this.events,d=0;d<u.length;d++){var p=u[d];p.complete=!1,l||(p.repeat=0),p.tweenInstance&&p.tweenInstance.stop()}return this.play(!1)},add:function(l){Array.isArray(l)||(l=[l]);var u=this.events,d=0;u.length>0&&(d=u[u.length-1].time);for(var p=0;p<l.length;p++){var g=l[p],c=r(g,"at",0),f=r(g,"in",null);f!==null&&(c=this.elapsed+f);var m=r(g,"from",null);m!==null&&(c=d+m),u.push({complete:!1,time:c,repeat:0,if:r(g,"if",null),run:r(g,"run",null),loop:r(g,"loop",null),event:r(g,"event",null),target:r(g,"target",null),set:r(g,"set",null),tween:r(g,"tween",null),sound:r(g,"sound",null),once:r(g,"once",!1),stop:r(g,"stop",!1)}),d=c}return this.complete=!1,this},clear:function(){for(var l=this.events,u=0;u<l.length;u++){var d=l[u];d.tweenInstance&&d.tweenInstance.stop()}return l=[],this.elapsed=0,this.paused=!0,this},isPlaying:function(){return!this.paused&&!this.complete},getProgress:function(){var l=Math.min(this.totalComplete,this.events.length);return l/this.events.length},destroy:function(){var l=this.systems.events;l.off(o.PRE_UPDATE,this.preUpdate,this),l.off(o.UPDATE,this.update,this),l.off(o.SHUTDOWN,this.destroy,this),this.clear(),this.scene=null,this.systems=null}});n.register("timeline",function(l){return new h(this.scene,l)}),t.exports=h}),IA=y((e,t)=>{t.exports={Clock:PA(),Events:td(),Timeline:bA(),TimerEvent:$c()}}),Ha=y((e,t)=>{var i=function(s,n,r){var o;if(s.hasOwnProperty(n)){var a=typeof s[n];a==="function"?o=function(h,l,u,d,p,g){return s[n](h,l,u,d,p,g)}:o=function(){return s[n]}}else typeof r=="function"?o=r:o=function(){return r};return o};t.exports=i}),_A=y((e,t)=>{t.exports=["callbackScope","completeDelay","delay","duration","ease","easeParams","flipX","flipY","hold","interpolation","loop","loopDelay","onActive","onActiveParams","onComplete","onCompleteParams","onLoop","onLoopParams","onPause","onPauseParams","onRepeat","onRepeatParams","onResume","onResumeParams","onStart","onStartParams","onStop","onStopParams","onUpdate","onUpdateParams","onYoyo","onYoyoParams","paused","persist","props","repeat","repeatDelay","targets","yoyo"]}),ed=y((e,t)=>{var i=_A(),s=function(n){var r,o=[];if(n.hasOwnProperty("props"))for(r in n.props)r.substring(0,1)!=="_"&&o.push({key:r,value:n.props[r]});else for(r in n)i.indexOf(r)===-1&&r.substring(0,1)!=="_"&&o.push({key:r,value:n[r]});return o};t.exports=s}),za=y((e,t)=>{var i=St(),s=function(n){var r=i(n,"targets",null);return r===null||(typeof r=="function"&&(r=r.call()),Array.isArray(r)||(r=[r])),r};t.exports=s}),Wa=y((e,t)=>{var i=ys(),s=_s();function n(l){return!!l.getActive&&typeof l.getActive=="function"}function r(l){return!!l.getStart&&typeof l.getStart=="function"}function o(l){return!!l.getEnd&&typeof l.getEnd=="function"}function a(l){return r(l)||o(l)||n(l)}var h=function(l,u){var d,p=function(D,F,N){return N},g=function(D,F,N){return N},c=null,f=typeof u;if(f==="number")p=function(){return u};else if(Array.isArray(u))g=function(){return u[0]},p=function(){return u[u.length-1]};else if(f==="string"){var m=u.toLowerCase(),v=m.substring(0,6)==="random",E=m.substring(0,3)==="int";if(v||E){var x=m.indexOf("("),T=m.indexOf(")"),A=m.indexOf(",");if(x&&T&&A){var P=parseFloat(m.substring(x+1,A)),R=parseFloat(m.substring(A+1,T));v?p=function(){return s(P,R)}:p=function(){return i(P,R)}}else throw new Error("invalid random() format")}else{m=m[0];var S=parseFloat(u.substr(2));switch(m){case"+":p=function(D,F,N){return N+S};break;case"-":p=function(D,F,N){return N-S};break;case"*":p=function(D,F,N){return N*S};break;case"/":p=function(D,F,N){return N/S};break;default:p=function(){return parseFloat(u)}}}}else if(f==="function")p=u;else if(f==="object")if(a(u))n(u)&&(c=u.getActive),o(u)&&(p=u.getEnd),r(u)&&(g=u.getStart);else if(u.hasOwnProperty("value"))d=h(l,u.value);else{var I=u.hasOwnProperty("to"),w=u.hasOwnProperty("from"),C=u.hasOwnProperty("start");if(I&&(w||C)){if(d=h(l,u.to),C){var _=h(l,u.start);d.getActive=_.getEnd}if(w){var O=h(l,u.from);d.getStart=O.getEnd}}}return d||(d={getActive:c,getEnd:p,getStart:g}),d};t.exports=h}),OA=y((e,t)=>{t.exports="active"}),MA=y((e,t)=>{t.exports="complete"}),LA=y((e,t)=>{t.exports="loop"}),DA=y((e,t)=>{t.exports="pause"}),kA=y((e,t)=>{t.exports="resume"}),FA=y((e,t)=>{t.exports="repeat"}),NA=y((e,t)=>{t.exports="start"}),BA=y((e,t)=>{t.exports="stop"}),UA=y((e,t)=>{t.exports="update"}),GA=y((e,t)=>{t.exports="yoyo"}),bi=y((e,t)=>{t.exports={TWEEN_ACTIVE:OA(),TWEEN_COMPLETE:MA(),TWEEN_LOOP:LA(),TWEEN_PAUSE:DA(),TWEEN_RESUME:kA(),TWEEN_REPEAT:FA(),TWEEN_START:NA(),TWEEN_STOP:BA(),TWEEN_UPDATE:UA(),TWEEN_YOYO:GA()}}),Zi=y((e,t)=>{var i=W(),s=Ct(),n=bi(),r=Yi(),o=new i({Extends:s,initialize:function(a){s.call(this),this.parent=a,this.data=[],this.totalData=0,this.startDelay=0,this.hasStarted=!1,this.timeScale=1,this.loop=0,this.loopDelay=0,this.loopCounter=0,this.completeDelay=0,this.countdown=0,this.state=r.PENDING,this.paused=!1,this.callbacks={onActive:null,onComplete:null,onLoop:null,onPause:null,onRepeat:null,onResume:null,onStart:null,onStop:null,onUpdate:null,onYoyo:null},this.callbackScope,this.persist=!1},setTimeScale:function(a){return this.timeScale=a,this},getTimeScale:function(){return this.timeScale},isPlaying:function(){return!this.paused&&this.isActive()},isPaused:function(){return this.paused},pause:function(){return this.paused||(this.paused=!0,this.dispatchEvent(n.TWEEN_PAUSE,"onPause")),this},resume:function(){return this.paused&&(this.paused=!1,this.dispatchEvent(n.TWEEN_RESUME,"onResume")),this},makeActive:function(){this.parent.makeActive(this),this.dispatchEvent(n.TWEEN_ACTIVE,"onActive")},onCompleteHandler:function(){this.setPendingRemoveState(),this.dispatchEvent(n.TWEEN_COMPLETE,"onComplete")},complete:function(a){return a===void 0&&(a=0),a?(this.setCompleteDelayState(),this.countdown=a):this.onCompleteHandler(),this},completeAfterLoop:function(a){return a===void 0&&(a=0),this.loopCounter>a&&(this.loopCounter=a),this},remove:function(){return this.parent&&this.parent.remove(this),this},stop:function(){return this.parent&&!this.isRemoved()&&!this.isPendingRemove()&&!this.isDestroyed()&&(this.dispatchEvent(n.TWEEN_STOP,"onStop"),this.setPendingRemoveState()),this},updateLoopCountdown:function(a){this.countdown-=a,this.countdown<=0&&(this.setActiveState(),this.dispatchEvent(n.TWEEN_LOOP,"onLoop"))},updateStartCountdown:function(a){return this.countdown-=a,this.countdown<=0&&(this.hasStarted=!0,this.setActiveState(),this.dispatchEvent(n.TWEEN_START,"onStart"),a=0),a},updateCompleteDelay:function(a){this.countdown-=a,this.countdown<=0&&this.onCompleteHandler()},setCallback:function(a,h,l){return l===void 0&&(l=[]),this.callbacks.hasOwnProperty(a)&&(this.callbacks[a]={func:h,params:l}),this},setPendingState:function(){this.state=r.PENDING},setActiveState:function(){this.state=r.ACTIVE,this.hasStarted=!1},setLoopDelayState:function(){this.state=r.LOOP_DELAY},setCompleteDelayState:function(){this.state=r.COMPLETE_DELAY},setStartDelayState:function(){this.state=r.START_DELAY,this.countdown=this.startDelay,this.hasStarted=!1},setPendingRemoveState:function(){this.state=r.PENDING_REMOVE},setRemovedState:function(){this.state=r.REMOVED},setFinishedState:function(){this.state=r.FINISHED},setDestroyedState:function(){this.state=r.DESTROYED},isPending:function(){return this.state===r.PENDING},isActive:function(){return this.state===r.ACTIVE},isLoopDelayed:function(){return this.state===r.LOOP_DELAY},isCompleteDelayed:function(){return this.state===r.COMPLETE_DELAY},isStartDelayed:function(){return this.state===r.START_DELAY},isPendingRemove:function(){return this.state===r.PENDING_REMOVE},isRemoved:function(){return this.state===r.REMOVED},isFinished:function(){return this.state===r.FINISHED},isDestroyed:function(){return this.state===r.DESTROYED},destroy:function(){this.data&&this.data.forEach(function(a){a.destroy()}),this.removeAllListeners(),this.callbacks=null,this.data=null,this.parent=null,this.setDestroyedState()}});o.TYPES=["onActive","onComplete","onLoop","onPause","onRepeat","onResume","onStart","onStop","onUpdate","onYoyo"],t.exports=o}),id=y((e,t)=>{var i={targets:null,delay:0,duration:1e3,ease:"Power0",easeParams:null,hold:0,repeat:0,repeatDelay:0,yoyo:!1,flipX:!1,flipY:!1,persist:!1,interpolation:null};t.exports=i}),sd=y((e,t)=>{var i=W(),s=bi(),n=Yi(),r=new i({initialize:function(o,a,h,l,u,d,p,g,c,f){this.tween=o,this.targetIndex=a,this.duration=l<=0?.01:l,this.totalDuration=0,this.delay=0,this.getDelay=h,this.yoyo=u,this.hold=d,this.repeat=p,this.repeatDelay=g,this.repeatCounter=0,this.flipX=c,this.flipY=f,this.progress=0,this.elapsed=0,this.state=0,this.isCountdown=!1},getTarget:function(){return this.tween.targets[this.targetIndex]},setTargetValue:function(o){o===void 0&&(o=this.current),this.tween.targets[this.targetIndex][this.key]=o},setCreatedState:function(){this.state=n.CREATED,this.isCountdown=!1},setDelayState:function(){this.state=n.DELAY,this.isCountdown=!0},setPendingRenderState:function(){this.state=n.PENDING_RENDER,this.isCountdown=!1},setPlayingForwardState:function(){this.state=n.PLAYING_FORWARD,this.isCountdown=!1},setPlayingBackwardState:function(){this.state=n.PLAYING_BACKWARD,this.isCountdown=!1},setHoldState:function(){this.state=n.HOLD_DELAY,this.isCountdown=!0},setRepeatState:function(){this.state=n.REPEAT_DELAY,this.isCountdown=!0},setCompleteState:function(){this.state=n.COMPLETE,this.isCountdown=!1},isCreated:function(){return this.state===n.CREATED},isDelayed:function(){return this.state===n.DELAY},isPendingRender:function(){return this.state===n.PENDING_RENDER},isPlayingForward:function(){return this.state===n.PLAYING_FORWARD},isPlayingBackward:function(){return this.state===n.PLAYING_BACKWARD},isHolding:function(){return this.state===n.HOLD_DELAY},isRepeating:function(){return this.state===n.REPEAT_DELAY},isComplete:function(){return this.state===n.COMPLETE},setStateFromEnd:function(o){this.yoyo?this.onRepeat(o,!0,!0):this.repeatCounter>0?this.onRepeat(o,!0,!1):this.setCompleteState()},setStateFromStart:function(o){this.repeatCounter>0?this.onRepeat(o,!1):this.setCompleteState()},reset:function(){var o=this.tween,a=o.totalTargets,h=this.targetIndex,l=o.targets[h],u=this.key;this.progress=0,this.elapsed=0,this.delay=this.getDelay(l,u,0,h,a,o),this.repeatCounter=this.repeat===-1?n.MAX:this.repeat,this.setPendingRenderState();var d=this.duration+this.hold;this.yoyo&&(d+=this.duration);var p=d+this.repeatDelay;this.totalDuration=this.delay+d,this.repeat===-1?(this.totalDuration+=p*n.MAX,o.isInfinite=!0):this.repeat>0&&(this.totalDuration+=p*this.repeat),this.totalDuration>o.duration&&(o.duration=this.totalDuration),this.delay<o.startDelay&&(o.startDelay=this.delay),this.delay>0&&(this.elapsed=this.delay,this.setDelayState())},onRepeat:function(o,a,h){var l=this.tween,u=l.totalTargets,d=this.targetIndex,p=l.targets[d],g=this.key,c=g!=="texture";if(this.elapsed=o,this.progress=o/this.duration,this.flipX&&p.toggleFlipX(),this.flipY&&p.toggleFlipY(),c&&(a||h)&&(this.start=this.getStartValue(p,g,this.start,d,u,l)),h){this.setPlayingBackwardState(),this.dispatchEvent(s.TWEEN_YOYO,"onYoyo");return}this.repeatCounter--,c&&(this.end=this.getEndValue(p,g,this.start,d,u,l)),this.repeatDelay>0?(this.elapsed=this.repeatDelay-o,c&&(this.current=this.start,p[g]=this.current),this.setRepeatState()):(this.setPlayingForwardState(),this.dispatchEvent(s.TWEEN_REPEAT,"onRepeat"))},destroy:function(){this.tween=null,this.getDelay=null,this.setCompleteState()}});t.exports=r}),nd=y((e,t)=>{var i=sd(),s=Ot(),n=W(),r=bi(),o=new n({Extends:i,initialize:function(a,h,l,u,d,p,g,c,f,m,v,E,x,T,A,P,R){i.call(this,a,h,c,f,m,v,E,x,T,A),this.key=l,this.getActiveValue=p,this.getEndValue=u,this.getStartValue=d,this.ease=g,this.start=0,this.previous=0,this.current=0,this.end=0,this.interpolation=P,this.interpolationData=R},reset:function(a){i.prototype.reset.call(this);var h=this.tween.targets[this.targetIndex],l=this.key;a&&(h[l]=this.start),this.start=0,this.previous=0,this.current=0,this.end=0,this.getActiveValue&&(h[l]=this.getActiveValue(h,l,0))},update:function(a){var h=this.tween,l=h.totalTargets,u=this.targetIndex,d=h.targets[u],p=this.key;if(!d)return this.setCompleteState(),!1;if(this.isCountdown&&(this.elapsed-=a,this.elapsed<=0&&(this.elapsed=0,a=0,this.isDelayed()?this.setPendingRenderState():this.isRepeating()?(this.setPlayingForwardState(),this.dispatchEvent(r.TWEEN_REPEAT,"onRepeat")):this.isHolding()&&this.setStateFromEnd(0))),this.isPendingRender())return this.start=this.getStartValue(d,p,d[p],u,l,h),this.end=this.getEndValue(d,p,this.start,u,l,h),this.current=this.start,d[p]=this.start,this.setPlayingForwardState(),!0;var g=this.isPlayingForward(),c=this.isPlayingBackward();if(g||c){var f=this.elapsed,m=this.duration,v=0,E=!1;f+=a,f>=m?(v=f-m,f=m,E=!0):f<0&&(f=0);var x=s(f/m,0,1);this.elapsed=f,this.progress=x,this.previous=this.current,g||(x=1-x);var T=this.ease(x);this.interpolation?this.current=this.interpolation(this.interpolationData,T):this.current=this.start+(this.end-this.start)*T,d[p]=this.current,E&&(g?(h.isNumberTween&&(this.current=this.end,d[p]=this.current),this.hold>0?(this.elapsed=this.hold,this.setHoldState()):this.setStateFromEnd(v)):(h.isNumberTween&&(this.current=this.start,d[p]=this.current),this.setStateFromStart(v))),this.dispatchEvent(r.TWEEN_UPDATE,"onUpdate")}return!this.isComplete()},dispatchEvent:function(a,h){var l=this.tween;if(!l.isSeeking){var u=l.targets[this.targetIndex],d=this.key,p=this.current,g=this.previous;l.emit(a,l,d,u,p,g);var c=l.callbacks[h];c&&c.func.apply(l.callbackScope,[l,u,d,p,g].concat(c.params))}},destroy:function(){i.prototype.destroy.call(this),this.getActiveValue=null,this.getEndValue=null,this.getStartValue=null,this.ease=null}});t.exports=o}),rd=y((e,t)=>{var i=sd(),s=Ot(),n=W(),r=bi(),o=new n({Extends:i,initialize:function(a,h,l,u,d,p,g,c,f,m,v){i.call(this,a,h,d,p,!1,g,c,f,m,v),this.key="texture",this.startTexture=null,this.endTexture=l,this.startFrame=null,this.endFrame=u,this.yoyo=c!==0},reset:function(a){i.prototype.reset.call(this);var h=this.tween.targets[this.targetIndex];this.startTexture||(this.startTexture=h.texture.key,this.startFrame=h.frame.name),a&&h.setTexture(this.startTexture,this.startFrame)},update:function(a){var h=this.tween,l=this.targetIndex,u=h.targets[l];if(!u)return this.setCompleteState(),!1;if(this.isCountdown&&(this.elapsed-=a,this.elapsed<=0&&(this.elapsed=0,a=0,this.isDelayed()?this.setPendingRenderState():this.isRepeating()?(this.setPlayingForwardState(),this.dispatchEvent(r.TWEEN_REPEAT,"onRepeat")):this.isHolding()&&this.setStateFromEnd(0))),this.isPendingRender())return this.startTexture&&u.setTexture(this.startTexture,this.startFrame),this.setPlayingForwardState(),!0;var d=this.isPlayingForward(),p=this.isPlayingBackward();if(d||p){var g=this.elapsed,c=this.duration,f=0,m=!1;g+=a,g>=c?(f=g-c,g=c,m=!0):g<0&&(g=0);var v=s(g/c,0,1);this.elapsed=g,this.progress=v,m&&(d?(u.setTexture(this.endTexture,this.endFrame),this.hold>0?(this.elapsed=this.hold,this.setHoldState()):this.setStateFromEnd(f)):(u.setTexture(this.startTexture,this.startFrame),this.setStateFromStart(f))),this.dispatchEvent(r.TWEEN_UPDATE,"onUpdate")}return!this.isComplete()},dispatchEvent:function(a,h){var l=this.tween;if(!l.isSeeking){var u=l.targets[this.targetIndex],d=this.key;l.emit(a,l,d,u);var p=l.callbacks[h];p&&p.func.apply(l.callbackScope,[l,u,d].concat(p.params))}},destroy:function(){i.prototype.destroy.call(this),this.startTexture=null,this.endTexture=null,this.startFrame=null,this.endFrame=null}});t.exports=o}),$n=y((e,t)=>{var i=Zi(),s=W(),n=bi(),r=de(),o=jt(),a=Gt(),h=Yi(),l=nd(),u=rd(),d=new s({Extends:i,initialize:function(p,g){i.call(this,p),this.targets=g,this.totalTargets=g.length,this.isSeeking=!1,this.isInfinite=!1,this.elapsed=0,this.totalElapsed=0,this.duration=0,this.progress=0,this.totalDuration=0,this.totalProgress=0,this.isNumberTween=!1},add:function(p,g,c,f,m,v,E,x,T,A,P,R,S,I,w,C){var _=new l(this,p,g,c,f,m,v,E,x,T,A,P,R,S,I,w,C);return this.totalData=this.data.push(_),_},addFrame:function(p,g,c,f,m,v,E,x,T,A){var P=new u(this,p,g,c,f,m,v,E,x,T,A);return this.totalData=this.data.push(P),P},getValue:function(p){p===void 0&&(p=0);var g=null;return this.data&&(g=this.data[p].current),g},hasTarget:function(p){return this.targets&&this.targets.indexOf(p)!==-1},updateTo:function(p,g,c){if(c===void 0&&(c=!1),p!=="texture")for(var f=0;f<this.totalData;f++){var m=this.data[f];m.key===p&&(m.isPlayingForward()||m.isPlayingBackward())&&(m.end=g,c&&(m.start=m.current))}return this},restart:function(){switch(this.state){case h.REMOVED:case h.FINISHED:this.seek(),this.parent.makeActive(this);break;case h.PENDING:case h.PENDING_REMOVE:this.parent.reset(this);break;case h.DESTROYED:break;default:this.seek();break}return this.paused=!1,this.hasStarted=!1,this},nextState:function(){if(this.loopCounter>0)this.elapsed=0,this.progress=0,this.loopCounter--,this.initTweenData(!0),this.loopDelay>0?(this.countdown=this.loopDelay,this.setLoopDelayState()):(this.setActiveState(),this.dispatchEvent(n.TWEEN_LOOP,"onLoop"));else if(this.completeDelay>0)this.countdown=this.completeDelay,this.setCompleteDelayState();else return this.onCompleteHandler(),!0;return!1},onCompleteHandler:function(){this.progress=1,this.totalProgress=1,i.prototype.onCompleteHandler.call(this)},play:function(){return this.isDestroyed()?this:((this.isPendingRemove()||this.isFinished())&&this.seek(),this.paused=!1,this.setActiveState(),this)},seek:function(p,g,c){if(p===void 0&&(p=0),g===void 0&&(g=16.6),c===void 0&&(c=!1),this.isDestroyed())return this;c||(this.isSeeking=!0),this.reset(!0),this.initTweenData(!0),this.setActiveState(),this.dispatchEvent(n.TWEEN_ACTIVE,"onActive");var f=this.paused;if(this.paused=!1,p>0){for(var m=Math.floor(p/g),v=p-m*g,E=0;E<m;E++)this.update(g);v>0&&this.update(v)}return this.paused=f,this.isSeeking=!1,this},initTweenData:function(p){p===void 0&&(p=!1),this.duration=0,this.startDelay=a.MAX_SAFE_INTEGER;for(var g=this.data,c=0;c<this.totalData;c++)g[c].reset(p);this.duration=Math.max(this.duration,.01);var f=this.duration,m=this.completeDelay,v=this.loopCounter,E=this.loopDelay;v>0?this.totalDuration=f+m+(f+E)*v:this.totalDuration=f+m},reset:function(p){return p===void 0&&(p=!1),this.elapsed=0,this.totalElapsed=0,this.progress=0,this.totalProgress=0,this.loopCounter=this.loop,this.loop===-1&&(this.isInfinite=!0,this.loopCounter=h.MAX),p||(this.initTweenData(),this.setActiveState(),this.dispatchEvent(n.TWEEN_ACTIVE,"onActive")),this},update:function(p){if(this.isPendingRemove()||this.isDestroyed())return this.persist?(this.setFinishedState(),!1):!0;if(this.paused||this.isFinished())return!1;if(p*=this.timeScale*this.parent.timeScale,this.isLoopDelayed())return this.updateLoopCountdown(p),!1;if(this.isCompleteDelayed())return this.updateCompleteDelay(p),!1;this.hasStarted||(this.startDelay-=p,this.startDelay<=0&&(this.hasStarted=!0,this.dispatchEvent(n.TWEEN_START,"onStart"),p=0));var g=!1;if(this.isActive())for(var c=this.data,f=0;f<this.totalData;f++)c[f].update(p)&&(g=!0);this.elapsed+=p,this.progress=Math.min(this.elapsed/this.duration,1),this.totalElapsed+=p,this.totalProgress=Math.min(this.totalElapsed/this.totalDuration,1),g||this.nextState();var m=this.isPendingRemove();return m&&this.persist&&(this.setFinishedState(),m=!1),m},forward:function(p){return this.update(p),this},rewind:function(p){return this.update(-p),this},dispatchEvent:function(p,g){if(!this.isSeeking){if(this.emit(p,this,this.targets),!this.callbacks)return;var c=this.callbacks[g];c&&c.func.apply(this.callbackScope,[this,this.targets].concat(c.params))}},destroy:function(){i.prototype.destroy.call(this),this.targets=null}});o.register("tween",function(p){return this.scene.sys.tweens.add(p)}),r.register("tween",function(p){return this.scene.sys.tweens.create(p)}),t.exports=d}),ad=y((e,t)=>{var i=Zi(),s=id(),n=le(),r=Rs(),o=wi(),a=dt(),h=Ha(),l=St(),u=Wa(),d=jn(),p=$n(),g=function(c,f,m){if(f instanceof p)return f.parent=c,f;m===void 0?m=s:m=d(s,m);var v=a(f,"from",0),E=a(f,"to",1),x=[{value:v}],T=a(f,"delay",m.delay),A=a(f,"easeParams",m.easeParams),P=a(f,"ease",m.ease),R=u("value",E),S=new p(c,x),I=S.add(0,"value",R.getEnd,R.getStart,R.getActive,o(a(f,"ease",P),a(f,"easeParams",A)),h(f,"delay",T),a(f,"duration",m.duration),r(f,"yoyo",m.yoyo),a(f,"hold",m.hold),a(f,"repeat",m.repeat),a(f,"repeatDelay",m.repeatDelay),!1,!1);I.start=v,I.current=v,S.completeDelay=n(f,"completeDelay",0),S.loop=Math.round(n(f,"loop",0)),S.loopDelay=Math.round(n(f,"loopDelay",0)),S.paused=r(f,"paused",!1),S.persist=r(f,"persist",!1),S.isNumberTween=!0,S.callbackScope=l(f,"callbackScope",S);for(var w=i.TYPES,C=0;C<w.length;C++){var _=w[C],O=l(f,_,!1);if(O){var D=l(f,_+"Params",[]);S.setCallback(_,O,D)}}return S};t.exports=g}),od=y((e,t)=>{var i=wi(),s=St(),n=Gt(),r=function(o,a){a===void 0&&(a={});var h,l=s(a,"start",0),u=s(a,"ease",null),d=s(a,"grid",null),p=s(a,"from",0),g=p==="first",c=p==="center",f=p==="last",m=typeof p=="number",v=Array.isArray(o),E=parseFloat(v?o[0]:o),x=v?parseFloat(o[1]):0,T=Math.max(E,x);if(v&&(l+=E),d){var A=d[0],P=d[1],R=0,S=0,I=0,w=0,C=[];f?(R=A-1,S=P-1):m?(R=p%A,S=Math.floor(p/A)):c&&(R=(A-1)/2,S=(P-1)/2);for(var _=n.MIN_SAFE_INTEGER,O=0;O<P;O++){C[O]=[];for(var D=0;D<A;D++){I=R-D,w=S-O;var F=Math.sqrt(I*I+w*w);F>_&&(_=F),C[O][D]=F}}}var N=u?i(u):null;return d?h=function(Y,L,b,M){var k=0,B=M%A,H=Math.floor(M/A);B>=0&&B<A&&H>=0&&H<P&&(k=C[H][B]);var z;if(v){var V=x-E;N?z=k/_*V*N(k/_):z=k/_*V}else N?z=k*E*N(k/_):z=k*E;return z+l}:h=function(Y,L,b,M,k){k--;var B;g?B=M:c?B=Math.abs(k/2-M):f?B=k-M:m&&(B=Math.abs(p-M));var H;if(v){var z;c?z=(x-E)/k*(B*2):z=(x-E)/k*B,N?H=z*N(B/k):H=z}else N?H=k*T*N(B/k):H=B*E;return H+l},h};t.exports=r}),Va=y((e,t)=>{var i=Zi(),s=id(),n=le(),r=Rs(),o=wi(),a=dt(),h=Kn(),l=Ha(),u=ed(),d=za(),p=St(),g=Wa(),c=jn(),f=$n(),m=function(v,E,x){if(E instanceof f)return E.parent=v,E;x===void 0?x=s:x=c(s,x);var T=d(E);!T&&x.targets&&(T=x.targets);for(var A=u(E),P=a(E,"delay",x.delay),R=a(E,"duration",x.duration),S=a(E,"easeParams",x.easeParams),I=a(E,"ease",x.ease),w=a(E,"hold",x.hold),C=a(E,"repeat",x.repeat),_=a(E,"repeatDelay",x.repeatDelay),O=r(E,"yoyo",x.yoyo),D=r(E,"flipX",x.flipX),F=r(E,"flipY",x.flipY),N=a(E,"interpolation",x.interpolation),Y=function(at,et,st,Q){if(st==="texture"){var ct=Q,wt=void 0;Array.isArray(Q)?(ct=Q[0],wt=Q[1]):Q.hasOwnProperty("value")?(ct=Q.value,Array.isArray(Q.value)?(ct=Q.value[0],wt=Q.value[1]):typeof Q.value=="string"&&(ct=Q.value)):typeof Q=="string"&&(ct=Q),at.addFrame(et,ct,wt,l(Q,"delay",P),a(Q,"duration",R),a(Q,"hold",w),a(Q,"repeat",C),a(Q,"repeatDelay",_),r(Q,"flipX",D),r(Q,"flipY",F))}else{var Bt=g(st,Q),Pt=h(a(Q,"interpolation",N));at.add(et,st,Bt.getEnd,Bt.getStart,Bt.getActive,o(a(Q,"ease",I),a(Q,"easeParams",S)),l(Q,"delay",P),a(Q,"duration",R),r(Q,"yoyo",O),a(Q,"hold",w),a(Q,"repeat",C),a(Q,"repeatDelay",_),r(Q,"flipX",D),r(Q,"flipY",F),Pt,Pt?Q:null)}},L=new f(v,T),b=0;b<A.length;b++)for(var M=A[b].key,k=A[b].value,B=0;B<T.length;B++)M==="scale"&&!T[B].hasOwnProperty("scale")?(Y(L,B,"scaleX",k),Y(L,B,"scaleY",k)):Y(L,B,M,k);L.completeDelay=n(E,"completeDelay",0),L.loop=Math.round(n(E,"loop",0)),L.loopDelay=Math.round(n(E,"loopDelay",0)),L.paused=r(E,"paused",!1),L.persist=r(E,"persist",!1),L.callbackScope=a(E,"callbackScope",L);for(var H=i.TYPES,z=0;z<H.length;z++){var V=H[z],q=p(E,V,!1);if(q){var Z=p(E,V+"Params",[]);L.setCallback(V,q,Z)}}return L};t.exports=m}),YA=y((e,t)=>{t.exports={GetBoolean:Rs(),GetEaseFunction:wi(),GetInterpolationFunction:Kn(),GetNewValue:Ha(),GetProps:ed(),GetTargets:za(),GetValueOp:Wa(),NumberTweenBuilder:ad(),StaggerBuilder:od(),TweenBuilder:Va()}}),Xa=y((e,t)=>{var i=Ye(),s=Zi(),n=W(),r=bi(),o=de(),a=jt(),h=Yi(),l=new n({Extends:s,initialize:function(u){s.call(this,u),this.currentTween=null,this.currentIndex=0},init:function(){return this.loopCounter=this.loop===-1?h.MAX:this.loop,this.setCurrentTween(0),this.startDelay>0&&!this.isStartDelayed()?this.setStartDelayState():this.setActiveState(),this},add:function(u){var d=this.parent.create(u);Array.isArray(d)||(d=[d]);for(var p=this.data,g=0;g<d.length;g++){var c=d[g];c.parent=this,p.push(c.reset())}return this.totalData=p.length,this},remove:function(u){return i(this.data,u),u.setRemovedState(),u===this.currentTween&&this.nextTween(),this.totalData=this.data.length,this},hasTarget:function(u){for(var d=this.data,p=0;p<this.totalData;p++)if(d[p].hasTarget(u))return!0;return!1},restart:function(){return this.isDestroyed()?this:(this.isRemoved()&&this.parent.makeActive(this),this.resetTweens(),this.paused=!1,this.init())},reset:function(u){return u.seek(),u.setActiveState(),this},makeActive:function(u){return u.reset(),u.setActiveState(),this},nextState:function(){if(this.loopCounter>0)this.loopCounter--,this.resetTweens(),this.loopDelay>0?(this.countdown=this.loopDelay,this.setLoopDelayState()):(this.setActiveState(),this.dispatchEvent(r.TWEEN_LOOP,"onLoop"));else if(this.completeDelay>0)this.countdown=this.completeDelay,this.setCompleteDelayState();else return this.onCompleteHandler(),!0;return!1},play:function(){return this.isDestroyed()?this:((this.isPendingRemove()||this.isPending())&&this.resetTweens(),this.paused=!1,this.startDelay>0&&!this.isStartDelayed()?this.setStartDelayState():this.setActiveState(),this)},resetTweens:function(){for(var u=this.data,d=this.totalData,p=0;p<d;p++)u[p].reset(!1);this.setCurrentTween(0)},update:function(u){if(this.isPendingRemove()||this.isDestroyed())return!0;if(this.isFinished()||this.paused)return!1;if(u*=this.parent.timeScale,this.isLoopDelayed())return this.updateLoopCountdown(u),!1;if(this.isCompleteDelayed())return this.updateCompleteDelay(u),!1;this.hasStarted||(this.startDelay-=u,this.startDelay<=0&&(this.hasStarted=!0,this.dispatchEvent(r.TWEEN_START,"onStart"),u=0));var d=!1;return this.isActive()&&this.currentTween&&(this.currentTween.update(u)&&this.nextTween()&&this.nextState(),d=this.isPendingRemove(),d&&this.persist&&(this.setFinishedState(),d=!1)),d},nextTween:function(){return this.currentIndex++,this.currentIndex===this.totalData?!0:(this.setCurrentTween(this.currentIndex),!1)},setCurrentTween:function(u){this.currentIndex=u,this.currentTween=this.data[u],this.currentTween.setActiveState()},dispatchEvent:function(u,d){this.emit(u,this);var p=this.callbacks[d];p&&p.func.apply(this.callbackScope,[this].concat(p.params))},destroy:function(){s.prototype.destroy.call(this),this.currentTween=null}});a.register("tweenchain",function(u){return this.scene.sys.tweens.chain(u)}),o.register("tweenchain",function(u){return this.scene.sys.tweens.create(u)}),t.exports=l}),HA=y((e,t)=>{var i=Zi(),s=le(),n=Rs(),r=za(),o=St(),a=Va(),h=Xa(),l=function(u,d){if(d instanceof h)return d.parent=u,d;var p=new h(u);p.startDelay=o(d,"delay",0),p.completeDelay=s(d,"completeDelay",0),p.loop=Math.round(s(d,"loop",o(d,"repeat",0))),p.loopDelay=Math.round(s(d,"loopDelay",o(d,"repeatDelay",0))),p.paused=n(d,"paused",!1),p.persist=n(d,"persist",!1),p.callbackScope=o(d,"callbackScope",p);var g,c=i.TYPES;for(g=0;g<c.length;g++){var f=c[g],m=o(d,f,!1);if(m){var v=o(d,f+"Params",[]);p.setCallback(f,m,v)}}var E=o(d,"tweens",null);if(Array.isArray(E)){var x=[],T=r(d),A=void 0;for(T&&(A={targets:T}),g=0;g<E.length;g++)x.push(a(p,E[g],A));p.add(x)}return p};t.exports=l}),zA=y((e,t)=>{var i=Ye(),s=W(),n=Gh(),r=ad(),o=he(),a=Vt(),h=od(),l=$n(),u=Va(),d=Xa(),p=HA(),g=new s({initialize:function(c){this.scene=c,this.events=c.sys.events,this.timeScale=1,this.paused=!1,this.processing=!1,this.tweens=[],this.time=0,this.startTime=0,this.nextTime=0,this.prevTime=0,this.maxLag=500,this.lagSkip=33,this.gap=1e3/240,this.events.once(a.BOOT,this.boot,this),this.events.on(a.START,this.start,this)},boot:function(){this.events.once(a.DESTROY,this.destroy,this)},start:function(){this.timeScale=1,this.paused=!1,this.startTime=Date.now(),this.prevTime=this.startTime,this.nextTime=this.gap,this.events.on(a.UPDATE,this.update,this),this.events.once(a.SHUTDOWN,this.shutdown,this)},create:function(c){Array.isArray(c)||(c=[c]);for(var f=[],m=0;m<c.length;m++){var v=c[m];v instanceof l||v instanceof d?f.push(v):Array.isArray(v.tweens)?f.push(p(this,v)):f.push(u(this,v))}return f.length===1?f[0]:f},add:function(c){var f=c,m=this.tweens;return f instanceof l||f instanceof d||(Array.isArray(f.tweens)?f=p(this,f):f=u(this,f)),m.push(f.reset()),f},addMultiple:function(c){for(var f,m=[],v=this.tweens,E=0;E<c.length;E++)f=c[E],f instanceof l||f instanceof d||(Array.isArray(f.tweens)?f=p(this,f):f=u(this,f)),v.push(f.reset()),m.push(f);return m},chain:function(c){var f=p(this,c);return this.tweens.push(f.init()),f},getChainedTweens:function(c){return c.getChainedTweens()},has:function(c){return this.tweens.indexOf(c)>-1},existing:function(c){return this.has(c)||this.tweens.push(c.reset()),this},addCounter:function(c){var f=r(this,c);return this.tweens.push(f.reset()),f},stagger:function(c,f){return h(c,f)},setLagSmooth:function(c,f){return c===void 0&&(c=1/1e-8),f===void 0&&(f=0),this.maxLag=c,this.lagSkip=Math.min(f,this.maxLag),this},setFps:function(c){return c===void 0&&(c=240),this.gap=1e3/c,this.nextTime=this.time*1e3+this.gap,this},getDelta:function(c){var f=Date.now()-this.prevTime;f>this.maxLag&&(this.startTime+=f-this.lagSkip),this.prevTime+=f;var m=this.prevTime-this.startTime,v=m-this.nextTime,E=m-this.time*1e3;return v>0||c?(m/=1e3,this.time=m,this.nextTime+=v+(v>=this.gap?4:this.gap-v)):E=0,E},tick:function(){return this.step(!0),this},update:function(){this.paused||this.step(!1)},step:function(c){c===void 0&&(c=!1);var f=this.getDelta(c);if(!(f<=0)){this.processing=!0;var m,v,E=[],x=this.tweens;for(m=0;m<x.length;m++)v=x[m],v.update(f)&&E.push(v);var T=E.length;if(T&&x.length>0){for(m=0;m<T;m++){v=E[m];var A=x.indexOf(v);A>-1&&(v.isPendingRemove()||v.isDestroyed())&&(x.splice(A,1),v.destroy())}E.length=0}this.processing=!1}},remove:function(c){return this.processing?c.setPendingRemoveState():(i(this.tweens,c),c.setRemovedState()),this},reset:function(c){return this.existing(c),c.seek(),c.setActiveState(),this},makeActive:function(c){return this.existing(c),c.setActiveState(),this},each:function(c,f){var m,v=[null];for(m=1;m<arguments.length;m++)v.push(arguments[m]);return this.tweens.forEach(function(E){v[0]=E,c.apply(f,v)}),this},getTweens:function(){return this.tweens.slice()},getTweensOf:function(c){var f=[],m=this.tweens;Array.isArray(c)?c=n(c):c=[c];for(var v=c.length,E=0;E<m.length;E++)for(var x=m[E],T=0;T<v;T++)!x.isDestroyed()&&x.hasTarget(c[T])&&f.push(x);return f},getGlobalTimeScale:function(){return this.timeScale},setGlobalTimeScale:function(c){return this.timeScale=c,this},isTweening:function(c){for(var f=this.tweens,m,v=0;v<f.length;v++)if(m=f[v],m.isPlaying()&&m.hasTarget(c))return!0;return!1},killAll:function(){for(var c=this.processing?this.getTweens():this.tweens,f=0;f<c.length;f++)c[f].destroy();return this.processing||(c.length=0),this},killTweensOf:function(c){for(var f=this.getTweensOf(c),m=0;m<f.length;m++)f[m].destroy();return this},pauseAll:function(){return this.paused=!0,this},resumeAll:function(){return this.paused=!1,this},shutdown:function(){this.killAll(),this.tweens=[],this.events.off(a.UPDATE,this.update,this),this.events.off(a.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(a.START,this.start,this),this.scene=null,this.events=null}});o.register("TweenManager",g,"tweens"),t.exports=g}),WA=y((e,t)=>{var i={States:Yi(),Builders:YA(),Events:bi(),TweenManager:zA(),Tween:$n(),TweenData:nd(),TweenFrameData:rd(),BaseTween:Zi(),TweenChain:Xa()};t.exports=i}),VA=y((e,t)=>{var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=function(n,r){for(var o=new Uint8Array(n),a=o.length,h=r?"data:"+r+";base64,":"",l=0;l<a;l+=3)h+=i[o[l]>>2],h+=i[(o[l]&3)<<4|o[l+1]>>4],h+=i[(o[l+1]&15)<<2|o[l+2]>>6],h+=i[o[l+2]&63];return a%3===2?h=h.substring(0,h.length-1)+"=":a%3===1&&(h=h.substring(0,h.length-2)+"=="),h};t.exports=s}),XA=y((e,t)=>{t.exports={ArrayBufferToBase64:VA(),Base64ToArrayBuffer:fc()}}),KA=y((e,t)=>{var i=St(),s=Ot(),n=function(r,o,a,h,l){l===void 0&&(l=a);var u=i(r,o,l);return s(u,a,h)};t.exports=n}),jA=y((e,t)=>{var i=function(s,n){for(var r=0;r<n.length;r++)if(!s.hasOwnProperty(n[r]))return!1;return!0};t.exports=i}),ZA=y((e,t)=>{var i=Vn(),s=function(n,r){for(var o={},a=0;a<r.length;a++){var h=r[a];i(n,h)&&(o[h]=n[h])}return o};t.exports=s}),qA=y((e,t)=>{var i=function(s,n,r){if(!s||typeof s=="number")return!1;if(s.hasOwnProperty(n))return s[n]=r,!0;if(n.indexOf(".")!==-1){for(var o=n.split("."),a=s,h=s,l=0;l<o.length;l++)if(a.hasOwnProperty(o[l]))h=a,a=a[o[l]];else return!1;return h[o[o.length-1]]=r,!0}return!1};t.exports=i}),JA=y((e,t)=>{t.exports={Clone:Xi(),DeepCopy:bn(),Extend:Qt(),GetAdvancedValue:le(),GetFastValue:dt(),GetMinMaxValue:KA(),GetValue:St(),HasAll:jA(),HasAny:Fc(),HasValue:Vn(),IsPlainObject:ce(),Merge:ic(),MergeRight:jn(),Pick:ZA(),SetValue:qA()}}),QA=y((e,t)=>{var i=function(s,n){return s.replace(/%([0-9]+)/g,function(r,o){return n[Number(o)-1]})};t.exports=i}),$A=y((e,t)=>{var i=function(s,n){return n===0?s.slice(1):s.slice(0,n)+s.slice(n+1)};t.exports=i}),tw=y((e,t)=>{var i=function(s){return s.split("").reverse().join("")};t.exports=i}),ew=y((e,t)=>{t.exports={Format:QA(),Pad:Gr(),RemoveAt:$A(),Reverse:tw(),UppercaseFirst:ra(),UUID:Bc()}}),iw=y((e,t)=>{var i=function(){return null};t.exports=i}),sw=y((e,t)=>{t.exports={Array:Cn(),Base64:XA(),Objects:JA(),String:ew(),NOOP:Rt(),NULL:iw()}}),nw=y((e,t)=>{var i=Pe(),s=Qt(),n={Animations:dg(),Actions:El(),Cache:q0(),Cameras:{Scene2D:kv()},Core:Cy(),Class:W(),Curves:Ry(),Data:Iy(),Display:{Align:My(),Masks:Ly()},Events:ky(),Game:Ix(),Geom:{Circle:Ux(),Line:aS(),Rectangle:OS()},GameObjects:{Events:bs(),DisplayList:MS(),GameObjectCreator:de(),GameObjectFactory:jt(),UpdateList:FS(),Components:be(),BuildGameObject:Ri(),GameObject:He(),Group:Ia(),Graphics:Ma(),Image:Hn(),Sprite:Xn(),Particles:t1(),Text:Fa(),Container:Na(),Zone:_n(),NineSlice:Ba(),Factories:{Group:d1(),Graphics:p1(),Image:g1(),Sprite:f1(),Particles:m1(),Text:v1(),Container:E1(),Zone:y1(),NineSlice:T1()},Creators:{Group:x1(),Graphics:S1(),Image:A1(),Sprite:C1(),Particles:P1(),Text:R1(),Container:b1(),Zone:I1(),NineSlice:_1()}},Input:lA(),Loader:{Events:Vi(),FileTypes:{AudioFile:cA(),ImageFile:Ya(),AtlasJSONFile:dA(),MultiAtlasFile:pA()},File:Ns(),FileTypesManager:gi(),GetURL:Jn(),LoaderPlugin:gA(),MergeXHRSettings:Ga(),XHRLoader:qc(),XHRSettings:Qn()},Math:pa(),Renderer:yA(),Scale:TA(),ScaleModes:Br(),Scene:nc(),Scenes:SA(),Structs:{List:Ra(),Map:Es(),ProcessQueue:Cc(),Set:ba(),Size:Qu()},Sound:AA(),Textures:CA(),Time:IA(),Tweens:WA(),Utils:sw()};n=s(!1,n,i),t.exports=n,window.Phaser=n}),KR=nw()}),rw=Bp((e,t)=>{U();var i=4,s=.001,n=1e-7,r=10,o=11,a=1/(o-1),h=typeof Float32Array=="function";function l(v,E){return 1-3*E+3*v}function u(v,E){return 3*E-6*v}function d(v){return 3*v}function p(v,E,x){return((l(E,x)*v+u(E,x))*v+d(E))*v}function g(v,E,x){return 3*l(E,x)*v*v+2*u(E,x)*v+d(E)}function c(v,E,x,T,A){var P,R,S=0;do R=E+(x-E)/2,P=p(R,T,A)-v,P>0?x=R:E=R;while(Math.abs(P)>n&&++S<r);return R}function f(v,E,x,T){for(var A=0;A<i;++A){var P=g(E,x,T);if(P===0)return E;var R=p(E,x,T)-v;E-=R/P}return E}function m(v){return v}t.exports=function(v,E,x,T){if(!(0<=v&&v<=1&&0<=x&&x<=1))throw new Error("bezier x values must be in [0, 1] range");if(v===E&&x===T)return m;for(var A=h?new Float32Array(o):new Array(o),P=0;P<o;++P)A[P]=p(P*a,v,x);function R(S){for(var I=0,w=1,C=o-1;w!==C&&A[w]<=S;++w)I+=a;--w;var _=(S-A[w])/(A[w+1]-A[w]),O=I+_*a,D=g(O,v,x);return D>=s?f(S,O,v,x):D===0?O:c(S,I,I+a,v,x)}return function(S){return S===0?0:S===1?1:p(R(S),E,T)}}}),jR=Bp((e,t)=>{t.exports="./assets/levels.json"});U(),U(),U();var ZR={BOOT_SCENE:"BootScene",LOAD_SCENE:"LoadScene",GAME_SCENE:"GameScene",GLOBAL_SCENE:"GlobalScene",DASHBOARD_SCENE:"DashboardScene",RESULT_MATCH_SCENE:"ChallengeResultScene",TEST_LAYOUT_SCENE:"TestLayoutScene"},Yt=ZR;U(),U();var qR={VIEW_RESIZED:"view-resized",REQUEST_VIEW_RESIZE:"request-view-resize",LAYOUT_CHANGED:"layout-changed",PRELOAD_LANGUAGE:"preload-language",CHOOSE_LANGUAGE:"choose-language",LOCALIZE_APPLIED:"localize-applied",COINS_CHANGED:"coins-changed",DESTROY_SCREENS:"destroy-screens"},yt=qR;U();var JR={Layout:{Portrait:"portrait",Landscape:"landscape"},DesignSize:{Portrait:{WIDTH:750,HEIGHT:1334},Landscape:{WIDTH:1520,HEIGHT:1e3},Resolution:2,DesignScale:{Portrait:1,Landscape:1.3}},AcceptPortraitRatio:.72,PRIMARY_LAYOUT:"auto",FULL_PORTRAIT_SIZE:!0,FULL_LANDSCAPE_SIZE:!0},hd=JR;U(),U(),U();var QR={StartScore:0,DefuseItemGuideLevel:11,RocketItemGuideLevel:16,SuperRocketGuideLevel:17,FinalGuideLevel:17,BaseScore:10,DelayStart:500,DelayLevelUp:1500,DelayEndGame:1500,MaxRescueCount:1,RescueGamePopupTimeout:5,RewardItemResultPopupRatio:.16,BombCountDownTime:9e4,StartItems:{ItemHint:8,ItemRocket:3,ItemShuffle:5,ItemBombDefuse:2,ItemSuperRocket:0},DailyRewardItems:{ItemHint:2,ItemRocket:2,ItemShuffle:2,ItemBombDefuse:2},SuperRocketConfig:{DestroyPairCount:7,GameRechargeCount:2},DefaultTheme:"cake",Themes:["fruit","cake","bird","candy","flower","umbrella","food","butterfly"],EnableVibrate:!0,Sound:{Music:{DefaultVolume:.6,MinVolume:.1}},GameplayNotificationLevel:5},Lt=QR;U(),U(),U();var{Utils:{Device:$R}}=Ludex,vt=Math.min($R.pixelRatio(),2),tb={TUTORIAL:{KEY:"tutorial-resources",TEXTURE:`./assets/textures/${vt}x/tutorial-resources.png`,JSON:`./assets/textures/${vt}x/tutorial-resources.json`,TEXTURE_32_BIT:`./assets/textures/${vt}x/tutorial-resources-32bit.png`,FRAME:{HAND:"hand",BLANK:"blank",BOMB:"bomb",GUIDE_TILE1:"guide-tile1",GUIDE_TILE2:"guide-tile2",GUIDE_TILE3:"guide-tile3",GUIDE_TILE4:"guide-tile4",GUIDE_TILE5:"guide-tile5",LEAF_LEFT:"leaf-left",LEAF_RIGHT:"leaf-right",ROCKET:"rocket",TEXT_FAILED:"text-failed",TEXT_GOOD:"text-good",TILE_BG:"tile-bg",CROSS_WRONG:"cross-wrong",DOT_WRONG:"dot-wrong",LINE_WRONG:"line-wrong",BOTTOM_PANEL:"bottom-panel",TOP_PANEL:"top-panel",MIDDLE_PANEL:"middle-panel",CIRCLE_HIGHLIGHT:"circle-highlight"}},DEFAULT:{KEY:"default-resources",TEXTURE:`./assets/textures/${vt}x/default-resources.png`,JSON:`./assets/textures/${vt}x/default-resources.json`,TEXTURE_32_BIT:`./assets/textures/${vt}x/default-resources-32bit.png`,FRAME:{BLANK:"blank",PRELOADER:"preloader/loading",LOGO_GIFT:"logo/gift",LOGO_GIFT_ADS:"logo/gift-ad",LOGO_GIFT_WHITE:"logo/gift_white",POPUP:"popup/popup",PROGRESS_CIRCLE_BG:"progress/circle-background",PROGRESS_CIRCLE:"progress/progress-circle",ICON_ADS:"icons/ads",ICON_LOSE:"icons/lose",ICON_BOMB:"icons/bomb",ICON_CLOCK:"icons/clock",ICON_HOME:"icons/home",ICON_REPLAY:"icons/replay",ICON_INVITE:"icons/invite",ICON_CONTINUE:"icons/continue",ICON_MUSIC_ON:"icons/music-on",ICON_MUSIC_OFF:"icons/music-off",ICON_SOUND_ON:"icons/sound-on",ICON_SOUND_OFF:"icons/sound-off",ICON_VIBRATE_ON:"icons/vibrate-on",ICON_VIBRATE_OFF:"icons/vibrate-off",ICON_TIMEOUT_CLOCK:"icons/timeout-clock",ICON_X:"icons/x",ICON_SHARE:"icons/share",ICON_INFO_DOT:"icons/info-dot",BUTTON_CLOSE:"buttons/close",BUTTON_FRAME:"buttons/frame",BUTTON_BLUE:"buttons/blue",BUTTON_GREEN:"buttons/green",BUTTON_ORANGE:"buttons/orange",BUTTON_YELLOW:"buttons/yellow",BUTTON_GREEN_SMALL:"buttons/green-small",BUTTON_GREEN_SMALL_BG:"buttons/green-small-bg",BUTTON_RED_CIRCLE:"buttons/red-circle",BUTTON_YELLOW_CIRCLE:"buttons/yellow-circle",BOOM:"texts/boom",ROCKET:"texts/rocket",VICTORY:"texts/victory",X2:"texts/x2",FAILED_TEXT:"texts/text-failed",CONTINUE_TEXT:"texts/text-continue",PAUSE_TEXT:"texts/text-pause",SETTINGS_TEXT:"texts/text-settings",ART_BG_LIGHT:"art/bg-light",ART_WHITE_GLOW:"art/white-glow",ART_YELLOW_GLOW:"art/yellow-glow",RESULT_RIBBON:"result-screen/ribbon",RESULT_STAR:"result-screen/star",RESULT_VICTORY_TEXT:"result-screen/victory-text",LOADING_SCREEN_TILE_BG:"loading-screen/tile-bg",LOADING_SCREEN_TILE_ICON_1:"loading-screen/tile-1",LOADING_SCREEN_TILE_ICON_2:"loading-screen/tile-2",LOADING_SCREEN_TILE_ICON_3:"loading-screen/tile-3",LOADING_SCREEN_TILE_ICON_4:"loading-screen/tile-4",LOADING_SCREEN_TILE_ICON_5:"loading-screen/tile-5"}},EFFECTS:{KEY:"effects-resources",PATH:`./assets/textures/${vt}x/`,JSON:`./assets/textures/${vt}x/effects-resources.json`,TEXTURES_32BIT:`./assets/textures/${vt}x/effects-resources-32bit-0.png`,FRAME:{BLANK:"blank",CAPTURE_PATH_START:"capture-path/capture-path-start",CAPTURE_PATH_MIDDLE:"capture-path/capture-path-middle",CAPTURE_PATH_END:"capture-path/capture-path-end",POLISH_EFFECT:"polish-effect/polish-effect-",ROCKET_TAIL:"rocket-tail-effect/fire-explosive-",COMBO_EFFECT_PARTICLE:"combo-effect/combo-particle",WHITE_SMOKE:"big-rocket-tail-effect/white-smoke",YELLOW_SMOKE:"big-rocket-tail-effect/yellow-smoke",FX_COMET:"comet",FX_COMET_DARK:"comet-dark",FX_SPARK:"spark",FX_CIRCLE:"circle",FX_HINT_GLOW:"hint-glow",FX_STAR_WHITE:"star-white",FX_STAR_YELLOW:"star-yellow",FX_STAR_YELLOW_DARK:"star-yellow-dark",TEXT_GOOD:"texts/good",TEXT_GOOD_LIGHT:"texts/good-light",TEXT_GREAT:"texts/great",TEXT_GREAT_LIGHT:"texts/great-light",TEXT_EXCELLENT:"texts/excellent",TEXT_EXCELLENT_LIGHT:"texts/excellent-light",TEXT_UNBELIEVABLE:"texts/unbelievable",TEXT_UNBELIEVABLE_LIGHT:"texts/unbelievable-light",FX_CONFETTI_SMALL_1:"confetti/small-1",FX_CONFETTI_SMALL_2:"confetti/small-2",FX_CONFETTI_SMALL_3:"confetti/small-3",FX_CONFETTI_SMALL_4:"confetti/small-4",FX_CONFETTI_HEXAGON:"confetti/hexagon-",EFFECT_BOMB_DEFUSE:"bomb-defuse/bomb-defuse-",EFFECT_BOMB_EXPLOSION:"bomb-explosion/bomb-explosion-",EFFECT_ROCKET_EXPLOSION:"rocket-explosion/rocket-explosion-",FX_HIGHLIGHT:"fx-items/highlight",ANIMATION_STAR_X:"star-x/star-",ANIMATION_STAR_Y:"star-y/star-",PREFIX_ANIMATION_RIBBON_CONFETTI_A:"ribbon/falling-confetti/confetti-a/confetti-a-",PREFIX_ANIMATION_RIBBON_CONFETTI_B:"ribbon/falling-confetti/confetti-b/confetti-b-",PREFIX_ANIMATION_RIBBON_CONFETTI_C:"ribbon/falling-confetti/confetti-c/confetti-c-",PREFIX_ANIMATION_RIBBON_CONFETTI_D:"ribbon/falling-confetti/confetti-d/confetti-d-"}},GAMEPLAY:{KEY:"gameplay-resources",PATH:`./assets/textures/${vt}x/`,JSON:`./assets/textures/${vt}x/gameplay-resources.json`,FRAME:{BLANK:"blank",LAYOUT_HEADER:"layout/header",LAYOUT_FOOTER:"layout/footer",LAYOUT_FOOTER_TOP:"layout/block-footer-top",LAYOUT_FOOTER_BOTTOM:"layout/block-footer-bottom",LAYOUT_HEADER_LANDSCAPE:"layout/landscape-header",BUTTON_WOOD_SMALL:"buttons/wood-small",BUTTON_YELLOW_CIRCLE:"buttons/yellow-circle",TIMER_BG:"timer/bg",DEV_TOOL_ARROW:"dev-tool/arrow",DEV_TOOL_RESET:"dev-tool/reset",DEV_TOOL_BOMB:"dev-tool/bomb",DEV_TOOL_CLOCK:"dev-tool/clock",DEV_TOOL_HAND:"dev-tool/hand",DEV_TOOL_NEW_GAME:"dev-tool/new-game",PROGRESS_BAR_LEFT:"progress/bar-left",PROGRESS_BAR_MID:"progress/bar-mid",PROGRESS_BAR_RIGHT:"progress/bar-right",PROGRESS_STAR:"progress/bar-star",PROGRESS_BG_COMBO:"progress/bg-combo",PROGRESS_BAR_COMBO:"progress/bar-combo",ITEM_SHUFFLE:"items/shuffle",HINT_ITEM:"items/hint",ROCKET_ITEM:"items/rocket",SUPER_ROCKET_ITEM:"items/super-rocket",DEFUSE_ITEM:"items/defuse",ITEM_SHARE:"items/share",ITEM_BG_ITEM:"items/bg-item",ITEM_BG_AMOUNT:"items/bg-amount",ITEM_SHUFFLE_LOCK:"items/shuffle-lock",ITEM_HINT_LOCK:"items/hint-lock",ITEM_ROCKET_LOCK:"items/rocket-lock",ITEM_SUPER_ROCKET_LOCK:"items/super-rocket-lock",ITEM_DEFUSE_LOCK:"items/defuse-lock",ITEM_BG_LOCK:"items/bg-item-lock",NOTE_LOCK:"items/note-lock",NOTE_INVITE:"items/note-invite",NOTE_FREE:"items/note-free",SUPER_ROCKET_NOTIFICATION:"items/super-rocket-notification",BOTTOM_TILE_FRAGMENT:"effect/bottom-tile-fragment",LEF_TILE_FRAGMENT:"effect/left-tile-fragment",RIGHT_TILE_FRAGMENT:"effect/right-tile-fragment",TOP_TILE_FRAGMENT:"effect/top-tile-fragment",EFFECT_SPARK:"effect/spark",EFFECT_LONG_ROCKET:"effect/long-rocket",EFFECT_SHORT_ROCKET:"effect/short-rocket",EFFECT_LONG_YELLOW_ROCKET:"effect/long-yellow-rocket",EFFECT_SHORT_YELLOW_ROCKET:"effect/short-yellow-rocket",EFFECT_CIRCLE:"effect/circle",EFFECT_TRAIL_STAR:"effect/trail-star",EFFECT_TILE_ROCKET:"effect/tile-rocket",EFFECT_TILE_HIGHLIGHT:"effect/tile-highlight/highlight-",EFFECT_TILE_OUTLINE:"effect/tile-select-bg",HINT_LINE_DOT:"effect/hint-line-dot",ICON_CLOCK:"icons/clock",ICON_BOMB:"icons/bomb",ICON_STAR_BIG:"icons/star-big",ICON_PAUSE:"icons/pause",ICON_COIN:"icons/coin",TILE_BOMB:"blank",TILE_ROCKET:"tiles/rocket",TILE_BG:"tiles/tile-bg",TILE_BUTTERFLY_BODY:"tiles/butterfly-body"}},CHALLENGE:{KEY:"challenge-friends-resources",JSON:`./assets/textures/${vt}x/challenge-friends-resources.json`,TEXTURE:`./assets/textures/${vt}x/challenge-friends-resources.png`,TEXTURE_32_BIT:`./assets/textures/${vt}x/challenge-friends-resources-32bit.png`,FRAME:{BLANK:"blank",POPUP:"popup",SCORE_PANEL:"score-panel",CROWN:"crown",AVATAR:"avatar",AVATAR_FRAME:"avatar-frame",AVATAR_BIG:"big-avatar",AVATAR_BIG_FRAME:"big-avatar-frame",WIN:"texts/win",LOSE:"texts/lose",DRAW:"texts/draw",WAITING:"texts/waiting",VS:"texts/vs",ICON_HOME:"icons/home",ICON_INVITE:"icons/invite",ICON_CONTINUE:"icons/continue",ICON_REPLAY:"icons/replay"}},JOURNEY:{KEY:"journey-resources",TEXTURE:`./assets/textures/${vt}x/journey-resources.png`,JSON:`./assets/textures/${vt}x/journey-resources.json`,TEXTURE_32_BIT:`./assets/textures/${vt}x/journey-resources-32bit.png`,FRAME:{BLANK:"blank",GLOW:"glow",ICON_BACK:"icon-back",ICON_CHECK:"icon-check",THEME_FRAME:"frame",BORDER_LEFT:"border-left",BORDER_RIGHT:"border-right",BORDER_MIDDLE:"border-middle",ROAD_LEFT:"road-left",ROAD_RIGHT:"road-right",ROAD_MIDDLE:"road-middle",LEVEL_ACTIVE:"level-active",LEVEL_INACTIVE:"level-inactive",LEVEL_COMPLETED:"level-completed",THEME_BANGKOK:"themes/bangkok",THEME_BARCELONA:"themes/barcelona",THEME_DUBAI:"themes/dubai",THEME_LAS_VEGAS:"themes/las-vegas",THEME_LONDON:"themes/london",THEME_NEW_YORK:"themes/newyork",THEME_PARIS:"themes/paris",THEME_ROME:"themes/rome",THEME_SINGAPORE:"themes/singapore",THEME_TOKYO:"themes/tokyo",THEME_ARGENTINA:"themes/argentina",THEME_INDIA:"themes/india",THEME_AUSTRALIA:"themes/australia",THEME_BRAZIL:"themes/brazil",THEME_CANADA:"themes/canada",THEME_DENMARK:"themes/denmark",THEME_EGYPT:"themes/egypt"}},TOURNAMENTS:{KEY:"tournaments-resources",TEXTURE:`./assets/textures/${vt}x/tournaments-resources.png`,JSON:`./assets/textures/${vt}x/tournaments-resources.json`,TEXTURE_32_BIT:`./assets/textures/${vt}x/tournaments-resources-32bit.png`,FRAME:{BLANK:"blank",FRAME:"frame",ICON_PEOPLE:"icon-people",ICON_RANKING:"icon-ranking",ICON_TIME:"icon-time",PANEL_CLOCK:"panel-clock",PANEL:"panel",POPUP:"popup",LONG_POPUP_TOP:"long-popup-top",LONG_POPUP_BOTTOM:"long-popup-bottom",LONG_POPUP_MIDDLE:"long-popup-middle",RIBBON:"ribbon",ROLL_BAR:"roll-bar",RANKING_TEXT:"texts/ranking",TOURNAMENT_TEXT:"texts/tournament",CUP:"cup",X:"x",MEDAL_GOLD:"medal-gold",MEDAL_SILVER:"medal-silver",MEDAL_BRONZE:"medal-bronze",RANK_BACKGROUND:"panel-number",GLOW:"glow",AVATAR_BORDER:"avatar-border",CROWN:"crown"}},DAILY_MISSIONS:{KEY:"daily-missions-resources",TEXTURE:`./assets/textures/${vt}x/daily-missions-resources.png`,JSON:`./assets/textures/${vt}x/daily-missions-resources.json`,TEXTURE_32_BIT:`./assets/textures/${vt}x/daily-missions-resources-32bit.png`,FRAME:{BLANK:"blank",POPUP_BG:"popup",RIBBON:"ribbon",BLOCK:"block",CLOSE:"close",PROGRESS_LEFT:"progress-left",PROGRESS_RIGHT:"progress-right",PROGRESS_MIDDLE:"progress-middle",GREEN_BUTTON:"button-green",BLUE_BUTTON:"button-blue",PROGRESS_BAR:"progress-border",ICON_CHECK:"icon-check",COIN:"coin",MISSION_HINT:"mission-progress-icon/icon-magnify",MISSION_SHUFFLE:"mission-progress-icon/icon-shuffle",MISSION_ROCKET:"mission-progress-icon/icon-rocket",MISSION_BOMB_DEFUSE:"mission-progress-icon/icon-kiem",MISSION_COIN:"mission-progress-icon/icon-coin",MISSION_FINISH_LEVEL:"mission-progress-icon/icon-finish",MISSION_MATCH_PAIRS:"mission-progress-icon/icon-match-pair",MISSION_INVITE_FRIEND:"mission-progress-icon/icon-invite",MISSION_SHARE_SCORE:"mission-progress-icon/icon-share",MISSION_JOIN_TOURNAMENT:"mission-progress-icon/icon-tournament"}},DASHBOARD:{KEY:"dashboard-resources",TEXTURE:`./assets/textures/${vt}x/dashboard-resources.png`,JSON:`./assets/textures/${vt}x/dashboard-resources.json`,TEXTURE_32_BIT:`./assets/textures/${vt}x/dashboard-resources-32bit.png`,FRAME:{BLANK:"blank",TITLE:"title",PANEL_ICON:"panel-icon",PANEL_NAME:"panel-name",COIN_PANEL:"coin-panel",BUTTON_FRAME:"buttons/frame",BUTTON_GREEN:"buttons/green",BORDER_FULL:"progress/border-full",PROGRESS_LEFT:"progress/progress-left",PROGRESS_RIGHT:"progress/progress-right",PROGRESS_MIDDLE:"progress/progress-middle",THEME_FRAME:"journey/frame",THEME_BANGKOK:"journey/bangkok",THEME_BARCELONA:"journey/barcelona",THEME_DUBAI:"journey/dubai",THEME_LAS_VEGAS:"journey/las-vegas",THEME_LONDON:"journey/london",THEME_NEW_YORK:"journey/newyork",THEME_PARIS:"journey/paris",THEME_ROME:"journey/rome",THEME_SINGAPORE:"journey/singapore",THEME_TOKYO:"journey/tokyo",THEME_ARGENTINA:"journey/argentina",THEME_INDIA:"journey/india",THEME_AUSTRALIA:"journey/australia",THEME_BRAZIL:"journey/brazil",THEME_CANADA:"journey/canada",THEME_DENMARK:"journey/denmark",THEME_EGYPT:"journey/egypt",ICON_CUP:"icons/cup",ICON_COIN:"icons/coin",ICON_SHOP:"icons/shop",ICON_FRAME:"icons/frame",ICON_REWARDS:"icons/rewards",ICON_SETTINGS:"icons/settings",ICON_DAILY_SPIN:"icons/daily-spin",ICON_DAILY_MISSIONS:"icons/daily-missions",ICON_INVITE_FRIENDS:"icons/invite-friends",ICON_INFO_DOT:"icons/info-dot",LUCKY_WHEEL_ARROW:"lucky-wheel/arrow",LUCKY_WHEEL_RIBBON:"lucky-wheel/ribbon",LUCKY_WHEEL_BG:"lucky-wheel/wheel",LUCKY_WHEEL_KNOB:"lucky-wheel/wheel-middle",LUCKY_WHEEL_ICON_COIN:"lucky-wheel/icon-coin",LUCKY_WHEEL_ICON_HINT:"lucky-wheel/icon-hint",LUCKY_WHEEL_ICON_SHUFFLE:"lucky-wheel/icon-shuffle",LUCKY_WHEEL_ICON_ROCKET:"lucky-wheel/icon-rocket",LUCKY_WHEEL_ICON_DEFUSE:"lucky-wheel/icon-defuse",LUCKY_WHEEL_ICON_BULB_ON:"lucky-wheel/bulb",LUCKY_WHEEL_ICON_BULB_OFF:"lucky-wheel/bulb-off"}},TILES:{BIRD:{KEY:"bird-resources",TEXTURE:`./assets/textures/${vt}x/bird-resources.png`,JSON:`./assets/textures/${vt}x/bird-resources.json`,FRAME:{TILE_PREFIX:"tile-",START:1,END:28}},CAKE:{KEY:"cake-resources",TEXTURE:`./assets/textures/${vt}x/cake-resources.png`,JSON:`./assets/textures/${vt}x/cake-resources.json`,FRAME:{TILE_PREFIX:"tile-",START:1,END:28}},FRUIT:{KEY:"fruit-resources",TEXTURE:`./assets/textures/${vt}x/fruit-resources.png`,JSON:`./assets/textures/${vt}x/fruit-resources.json`,FRAME:{TILE_PREFIX:"tile-",START:1,END:28}},CANDY:{KEY:"candy-resources",TEXTURE:`./assets/textures/${vt}x/candy-resources.png`,JSON:`./assets/textures/${vt}x/candy-resources.json`,FRAME:{TILE_PREFIX:"tile-",START:1,END:28}},FLOWER:{KEY:"flower-resources",TEXTURE:`./assets/textures/${vt}x/flower-resources.png`,JSON:`./assets/textures/${vt}x/flower-resources.json`,FRAME:{TILE_PREFIX:"tile-",START:1,END:44}},UMBRELLA:{KEY:"umbrella-resources",TEXTURE:`./assets/textures/${vt}x/umbrella-resources.png`,JSON:`./assets/textures/${vt}x/umbrella-resources.json`,FRAME:{TILE_PREFIX:"tile-",START:1,END:30}},FOOD:{KEY:"food-resources",TEXTURE:`./assets/textures/${vt}x/food-resources.png`,JSON:`./assets/textures/${vt}x/food-resources.json`,FRAME:{TILE_PREFIX:"tile-",START:1,END:30}},BUTTERFLY:{KEY:"butterfly-resources",TEXTURE:`./assets/textures/${vt}x/butterfly-resources.png`,JSON:`./assets/textures/${vt}x/butterfly-resources.json`,FRAME:{TILE_PREFIX:"tile-",START:1,END:30}}}},G=tb;U(),U();var eb={PAUSE_SCREEN:"PauseScreen",NOTIFY_SCREEN:"NotifyScreen",RESCUE_SCREEN:"RescueScreen",RESULT_SCREEN:"ResultScreen",CONTINUE_SCREEN:"ContinueScreen",REWARD_ITEM_SCREEN:"RewardItemScreen",REWARD_COINS_SCREEN:"RewardCoinsScreen",LUCKY_WHEEL_SCREEN:"LuckyWheelScreen",TOURNAMENTS_SCREEN:"TournamentsScreen",TOURNAMENT_DETAIL_SCREEN:"TournamentDetailScreen",RESULT_CHALLENGE_FRIEND_SCREEN:"ResultChallengeFriendScreen",DAILY_MISSIONS_SCREEN:"DailyMissionsScreen",JOURNEY_SCREEN:"JourneyScreen",LOADING_SCREEN:"LoadingScreen"},mt=eb,{event:aw}=codex,{Events:ow}=Ludex,ib=class PR{static screens={};static _instance;static get inst(){return this._instance||(this._instance=new PR),this._instance}static addScreen(t,i){this.screens[t]=i}static getScreen(t){return this.screens[t]||null}static openScreen(t,i){aw.emit(ow.OPEN_SCREEN,{screenName:t,screenData:i})}static closeScreen(t){aw.emit(ow.CLOSE_SCREEN,{screenName:t})}static showLoadingScreen(t){this.openScreen(mt.LOADING_SCREEN,{duration:t,message:"Loading...",loading:!0})}static closeLoadingScreen(){this.closeScreen(mt.LOADING_SCREEN)}static showNotificationScreen(t,i){this.openScreen(mt.NOTIFY_SCREEN,{message:t,duration:i})}static closeNotificationScreen(){this.closeScreen(mt.NOTIFY_SCREEN)}static showLoadingNotificationScreen(){this.openScreen(mt.NOTIFY_SCREEN,{message:"Loading",enableCloseOnTouch:!1})}},ot=ib,{event:sb}=codex,{Events:nb}=Ludex,rb=class RR{currentScene=null;static _instance;static get inst(){return this._instance||(this._instance=new RR),this._instance}static setCurrentScene(t){let i=window.phaser.scene.getScene(t);this.inst.currentScene=i}static getCurrentScene(){let{currentScene:t}=this.inst;return t?.scene.isSleeping()?window.phaser.scene.getScenes(!0).find(i=>!i.scene.isSleeping())??null:t}static switchScene(t,i){sb.emit(nb.SWITCH_SCENE,{sceneName:t,sceneData:i})}static async switchToDashboardScene(t){try{ot.showLoadingScreen(),await this.waitForDashboardSceneAssetsLoading(),this.switchScene(Yt.DASHBOARD_SCENE,t)}catch{}finally{ot.closeLoadingScreen()}}static async switchToGameScene(t){let{score:i=0}=t??{};this.switchScene(Yt.GAME_SCENE,{score:i})}static switchToResultMatchScene(t){this.switchScene(Yt.RESULT_MATCH_SCENE,t)}static getMissingDashboardSceneTextures(){let{textures:t}=window.phaser,i=[],s=t.exists(G.DASHBOARD.KEY),n=t.exists(G.CHALLENGE.KEY),r=t.exists(G.DAILY_MISSIONS.KEY),o=t.exists(G.JOURNEY.KEY),a=t.exists(G.TOURNAMENTS.KEY);return s||i.push({key:G.DASHBOARD.KEY,textureURL:G.DASHBOARD.TEXTURE,atlasURL:G.DASHBOARD.JSON}),n||i.push({key:G.CHALLENGE.KEY,textureURL:G.CHALLENGE.TEXTURE,atlasURL:G.CHALLENGE.JSON}),r||i.push({key:G.DAILY_MISSIONS.KEY,textureURL:G.DAILY_MISSIONS.TEXTURE,atlasURL:G.DAILY_MISSIONS.JSON}),o||i.push({key:G.JOURNEY.KEY,textureURL:G.JOURNEY.TEXTURE,atlasURL:G.JOURNEY.JSON}),a||i.push({key:G.TOURNAMENTS.KEY,textureURL:G.TOURNAMENTS.TEXTURE,atlasURL:G.TOURNAMENTS.JSON}),i}static async waitForDashboardSceneAssetsLoading(){let t=this.getMissingDashboardSceneTextures(),i=[],s=this.getCurrentScene();if(!s)return Promise.all([]);let{FILE_KEY_COMPLETE:n}=Phaser.Loader.Events;for(let r of t)i.push(new Promise(o=>{s.load.once(`${n}atlasjson-${r.key}`,()=>{o()}),s.load.atlas({key:r.key,textureURL:r.textureURL,atlasURL:r.atlasURL})}));return s.load.start(),Promise.all(i)}static getGlobalScene(){return window.phaser.scene.getScene(Yt.GLOBAL_SCENE)}},It=rb;U(),U();var ab={BACKGROUND:{KEY:"background_music",PREFIX:"./assets/music/bg_music_"},DASHBOARD:{KEY:"dashboard_music",FILE:"./assets/music/dashboard_music.mp3"},NEW_EFFECTS:{bomb_explode_1:"./assets/sounds/bomb_explode_1.mp3",ticking_bomb_before_explode:"./assets/sounds/ticking_bomb_before_explode.mp3",bomb_defuse:"./assets/sounds/bomb_defuse.mp3",close_popup_click:"./assets/sounds/close_popup_click.mp3",use_item_click:"./assets/sounds/use_item_click.mp3",shuffle_item:"./assets/sounds/shuffle_item.mp3",hint_item:"./assets/sounds/hint_item.mp3",clicks:"./assets/sounds/clicks.mp3",combo_1:"./assets/sounds/combo_1.mp3",combo_2:"./assets/sounds/combo_2.mp3",combo_3:"./assets/sounds/combo_3.mp3",combo_4:"./assets/sounds/combo_4.mp3",combo_5:"./assets/sounds/combo_5.mp3",invalid_match:"./assets/sounds/invalid_match.mp3",level_start:"./assets/sounds/level_start.mp3",level_complete:"./assets/sounds/level_complete.mp3",level_fail:"./assets/sounds/level_fail.mp3",rescue_timer:"./assets/sounds/rescue_timer.mp3",extra_tile_spawn:"./assets/sounds/extra_tile_spawn.mp3",tile_select:"./assets/sounds/tile_select.mp3",rocket_fly:"./assets/sounds/rocket_fly.mp3",collect_stars:"./assets/sounds/collect_stars.mp3",three_stars:"./assets/sounds/three_stars.mp3",progress_star:"./assets/sounds/progress_star.mp3",gift_charge:"./assets/sounds/gift_charge.mp3",gift_explode:"./assets/sounds/gift_explode.mp3",gift_reveal:"./assets/sounds/gift_reveal.mp3",daily_reward:"./assets/sounds/daily_reward.mp3",wheel_click:"./assets/sounds/reward_click.mp3",wheel_get_common:"./assets/sounds/reward_get_common.mp3",wheel_get_special:"./assets/sounds/reward_get_special.mp3"}},ze=ab;U();var{Plugins:{Audio:{BaseAudioPlayer:ob}}}=Ludex,hb=class extends ob{audioSource;constructor(e,t){super(e),this.audioSource=t}play(e){if(e){let{volume:t=1,loop:i=!1}=e;this.audioSource.volume=t,this.audioSource.loop=i}this.audioSource.play()}pause(){this.audioSource.pause()}resume(){this.audioSource.isPaused&&this.audioSource.play()}stop(){this.audioSource.stop()}setVolume(e){this.audioSource.volume=e}getVolume(){return this.audioSource.volume}getAudioSource(){return this.audioSource}},lb=hb,{Plugins:{Audio:{BaseChannelManager:ub}},Utils:{Array:cb}}=Ludex,hw=class extends ub{game;players;constructor(e,t){super(t),this.game=e,this.players={}}playing(e){let t=this.players[e];if(!t)return!1;for(let i of t)if(i.getAudioSource().isPlaying)return!0;return!1}async onLoadAudio(e,t){try{return this.isCached(e)||await this.loadAudio(e),this.getPlayer(e,t?.allowMultiple)}catch{return null}}playWithRealConfig(e,t){if(t&&!this.isPlayable(t.checkList))return;let i=this.getVolume()*(t?.volume??1);e.play({...t,volume:i})}loadAudio(e){let t;if(e===ze.BACKGROUND.KEY&&(t=nt.getMusicPath()),t||(t=ze.NEW_EFFECTS[e]??void 0),!!t)return new Promise((i,s)=>{let n=It.getCurrentScene();if(!n){s(new Error("No scene found"));return}n.load.audio(e,t),n.load.on(`${Phaser.Loader.Events.FILE_KEY_COMPLETE}audio-${e}`,i),n.load.start()})}isPlayable(e=[]){if(e.length===0)return!0;let t=Object.keys(this.players);for(let i of t){if(!cb.has(e,i))continue;let s=this.players[i];for(let n of s)if(n.getAudioSource().isPlaying)return!1}return!0}isCached(e){let t=this.players[e];return t&&t.length>0||this.game.cache.audio.exists(e)}getPlayer(e,t=!1){let i=this.players[e];if(!i||i.length===0)return this.createPlayer(e);if(!t)return i[0];for(let n of i)if(!n.getAudioSource().isPlaying)return n;let s=`-${i.length}`;return this.createPlayer(e,s)}createPlayer(e,t=""){let i=this.game.sound.add(e),s=new lb(`${e}${t}`,i),n=this.players[e]??[];return n.push(s),this.players[e]=n,s}},{audio:We}=codex,db=class bR{static _instance;channels={};static get inst(){return this._instance||(this._instance=new bR),this._instance}static playing(t){try{return this.inst.playing(t)}catch{return!1}}static async play(t,i){try{return await this.inst.play(t,i)}catch{}}static pause(t){try{this.inst.pause(t)}catch{}}static resume(t){try{this.inst.resume(t)}catch{}}static stop(t){try{this.inst.stop(t)}catch{}}static stopAll(){try{this.inst.stopAll()}catch{}}static mute(){try{this.inst.mute()}catch{}}static unmute(){try{this.inst.unmute()}catch{}}static setVolume(t){try{this.inst.setVolume(t)}catch{}}static getVolume(){try{return this.inst.getVolume()}catch{return 0}}getCurrentChannel(){let t=It.getCurrentScene()?.scene.key??void 0;if(t===void 0)throw new Error("AudioManager.getCurrentChannelId: No scene found");if(this.channels[t])return this.channels[t];let i=new hw(window.phaser,t);return We.addChannel(i),this.channels[t]=i,i}playing(t){return this.getCurrentChannel().playing(t)}play(t,i){let s=this.getCurrentChannel().getId();return We.play(t,i,s)}pause(t){let i=this.getCurrentChannel().getId();We.pause(t,i)}resume(t){let i=this.getCurrentChannel().getId();We.resume(t,i)}stop(t){let i=this.getCurrentChannel().getId();We.stop(t,i)}stopAll(){let t=this.getCurrentChannel().getId();We.stopAll(t)}mute(){let t=this.getCurrentChannel().getId();We.mute(t)}unmute(){let t=this.getCurrentChannel().getId();We.unmute(t)}setVolume(t){let i=this.getCurrentChannel().getId();We.setVolume(t,i)}getVolume(){let t=this.getCurrentChannel().getId();return We.getVolume(t)}};U();var pb=class IR{musicChannel;static get inst(){return this._instance||(this._instance=new IR),this._instance}constructor(){this.musicChannel=new hw(window.phaser,"music");let{audio:t}=codex;t.addChannel(this.musicChannel)}static playing(t){try{return this.inst.playing(t)}catch{return!1}}static async play(t,i){try{return await this.inst.play(t,i)}catch{}}static pause(t){try{this.inst.pause(t)}catch{}}static resume(t){try{this.inst.resume(t)}catch{}}static stop(t){try{this.inst.stop(t)}catch{}}static stopAll(){try{this.inst.stopAll()}catch{}}static mute(){try{this.inst.mute()}catch{}}static unmute(){try{this.inst.unmute()}catch{}}static setVolume(t){try{this.inst.setVolume(t)}catch{}}static getVolume(){try{return this.inst.getVolume()}catch{return 0}}getCurrentChannel(){return this.musicChannel}playing(t){return this.musicChannel.playing(t)}play(t,i){let{audio:s}=codex;return s.play(t,i,"music")}pause(t){let{audio:i}=codex;i.pause(t,"music")}resume(t){let{audio:i}=codex;i.resume(t,"music")}stop(t){let{audio:i}=codex;i.stop(t,"music")}stopAll(){let{audio:t}=codex;t.stopAll("music")}mute(){let{audio:t}=codex;t.mute("music")}unmute(){let{audio:t}=codex;t.unmute("music")}setVolume(t){let{audio:i}=codex;i.setVolume(t,"music")}getVolume(){let{audio:t}=codex;return t.getVolume("music")}},gb=pb,{player:lw}=codex,{Music:uw}=Lt.Sound,fb=class _R{static _instance;static musicKey;static volumeTween;static get inst(){return this._instance||(this._instance=new _R,this.initializeRandomMusicKey(),this.setDefaultVolumeMusic()),this._instance}static initializeRandomMusicKey(){if(this.musicKey)return;let t=Phaser.Math.Between(1,3);this.musicKey=`${ze.BACKGROUND.PREFIX}${t}.mp3`}get sound(){return db}get music(){return gb}static muteAudio(t){this.muteMusic(t),this.muteSound(t)}static async playSound(t,i){if(!(!this.inst.sound||!(lw.getPlayerSetting("sound")??!0)))return this.inst.sound.play(t,i)}static pauseSound(t){this.inst.sound&&this.inst.sound.pause(t)}static resumeSound(t){this.inst.sound&&this.inst.sound.resume(t)}static stopSound(t){this.inst.sound&&this.inst.sound.stop(t)}static stopAllSounds(){this.inst.sound&&this.inst.sound.stopAll()}static muteSound(t){this.inst.sound&&(t?this.inst.sound.mute():this.inst.sound.unmute())}static getMusicKey(){return ze.BACKGROUND.KEY}static getMusicPath(){return this.musicKey||this.initializeRandomMusicKey(),this.musicKey}static getAllMusicKeys(){return[ze.BACKGROUND.KEY,ze.DASHBOARD.KEY]}static playMusic(t,i=!1){if(!this.inst.music||!(lw.getPlayerSetting("music")??!0))return;let s=t??this.getMusicKey();if(!s)return;let n=this.inst.music.playing(s);!i&&n||(this.stopOtherMusic(s),this.inst.music.play(s,{loop:!0}))}static stopOtherMusic(t){if(this.inst.music)for(let i of this.getAllMusicKeys())i!==t&&this.inst.music.stop(i)}static pauseMusic(){if(!this.inst.music)return;let t=this.getMusicKey();if(t)this.inst.music.pause(t);else for(let i of this.getAllMusicKeys())this.inst.music.pause(i)}static muteMusic(t){this.inst.music&&(t?this.inst.music.mute():this.inst.music.unmute())}static async turnOffMusic(){await this.setVolumeMusic(0)}static getVolumeMusic(){return this.inst.music?.getVolume()??0}static async setVolumeMusic(t,i=!1){if(!this.inst.music)return;this.volumeTween?.isPlaying()&&this.volumeTween?.stop();let s=this.inst.music.getVolume();if(s===t)return;if(!i){this.inst.music?.setVolume(t);return}let n=It.getGlobalScene();if(!n){this.inst.music.setVolume(t);return}let r=n.tweens.addCounter({from:1,to:1e3,duration:1e3,ease:Phaser.Math.Easing.Sine.Out,onUpdate:o=>{let a=(t-s)*o.getValue()/1e3;this.inst.music.setVolume(s+a)},onComplete:()=>{this.inst.music.setVolume(t)}});this.volumeTween=r,r.play()}static setDefaultVolumeMusic(){this.setVolumeMusic(uw.DefaultVolume,!0)}static setMinVolumeMusic(){this.setVolumeMusic(uw.MinVolume,!0)}},nt=fb;U();var{event:ld}=codex,{Utils:{Browser:cw,Function:mb,Device:vb}}=Ludex,{AcceptPortraitRatio:Eb,DesignSize:{Portrait:dw,Landscape:pw,Resolution:ud,DesignScale:gw},FULL_PORTRAIT_SIZE:yb,FULL_LANDSCAPE_SIZE:Tb}=hd,xb=class fn{game;static _instance;layoutMode;static get inst(){return this._instance||(this._instance=new fn),this._instance}static init(t){this.inst.game=t,t.canvas.id="GameCanvas",this.inst.listenEvents(),ld.emit(yt.REQUEST_VIEW_RESIZE)}listenEvents(){new ResizeObserver(this.handleBodyResize).observe(window.document.body),ld.on(yt.REQUEST_VIEW_RESIZE,this.resizeGame)}handleBodyResize=mb.debounce(()=>{this.resizeGame()},300);resizeGame=t=>{let{width:i,height:s}=fn.getWorldSize(),{width:n,height:r}=fn.getCanvasSize(),o=fn.getWorldScale();this.game.scale.resize(n,r),this.game.scale.setZoom(o);let a=fn.isLandscape()?"landscape":"portrait",h=!this.layoutMode||this.layoutMode===a?yt.VIEW_RESIZED:yt.LAYOUT_CHANGED;ld.emit(h,{width:i,height:s}),this.layoutMode=a};static dump(){let t=this.getPixelRatio(),i=this.getZoomRatio(),s=this.getWorldScale(),n=this.isFullPortrait(),r=this.isFullLandscape(),{width:o,height:a}=this.getWorldSize(),{width:h,height:l}=this.getDesignSize(),{width:u,height:d}=this.getScreenSize(),{width:p,height:g}=this.getCanvasSize()}static isLandscape(){return this.getScreenRatio()>Eb}static isFullPortrait(){return!this.isLandscape()&&yb}static isFullLandscape(){return this.isLandscape()&&Tb}static getZoomRatio(){let{width:t}=this.getCanvasSize(),{width:i}=this.getWorldSize();return t/i}static getWorldScale(){let{width:t,height:i}=this.getCanvasSize(),{width:s,height:n}=this.getScreenSize(),r=(s/t).toFixed(3),o=(n/i).toFixed(3);return Math.min(+r,+o)}static getDesignSize(){let t=dw.WIDTH,i=dw.HEIGHT;this.isLandscape()&&(t=pw.WIDTH,i=pw.HEIGHT);let s=this.isLandscape()?gw.Landscape:gw.Portrait,n=t/ud*s,r=i/ud*s;return{width:n,height:r}}static getWorldSize(){return this.isLandscape()?this.getWorldSizeLandscape():this.getWorldSizePortrait()}static getWorldSizePortrait(){let{width:t,height:i}=this.getDesignSize(),s=t,n=i,r=this.getDesignRatio(),o=this.getScreenRatio();return(o>r||this.isFullPortrait())&&(n=s/o),{width:s,height:n}}static getWorldSizeLandscape(){let{width:t,height:i}=this.getDesignSize(),{width:s,height:n}=this.getScreenSize(),r=t,o=i,a=this.getPixelRatio();if(!this.isFullLandscape())return{width:r,height:o};let{width:h}=this.calculateCanvasSizeForFullLandscape(),l=h/r;r=s*a/l,o=n*a/l;let u=r/o;return o<i&&(o=i,r=i*u),{width:r,height:o}}static calculateCanvasSizeForFullLandscape(){let{width:t,height:i}=this.getScreenSize(),s=this.getPixelRatio(),n=t*s,r=i*s,o=this.getDesignRatio(),a=this.getScreenRatio();return a>o?r=n/a:n=r*a,{width:n,height:r}}static getScreenSize(){let t=cw.getScreenWidth(),i=cw.getScreenHeight();return{width:t,height:i}}static getCanvasSize(){let{width:t,height:i}=this.getScreenSize(),s=this.getPixelRatio(),n=t*s,r=i*s;if(this.isFullLandscape()||this.isFullPortrait())return{width:n,height:r};let{width:o,height:a}=this.getWorldSize(),h=t/o,l=i/a,u=Math.min(h,l);return n=o*u*s,r=a*u*s,{width:n,height:r}}static getPixelRatio(){return Math.min(vb.pixelRatio(),ud)}static toPixelSize(t){let i=this.getPixelRatio();return Math.round(t*i)}static toDisplaySize(t){let i=this.getPixelRatio();return Math.round(t/i)}static getDesignRatio(){let{width:t,height:i}=this.getDesignSize();return t/i}static getScreenRatio(){let{width:t,height:i}=this.getScreenSize();return t/i}},lt=xb,{Configs:{Ads:{Enabled:tr,InterstitialAdOptions:Sb,RewardedVideoAdOptions:Ab,RewardedInterstitialAdOptions:wb,BannerDisplayAdOptions:cd},Gameplay:{StartAdAtLevel:Cb}},Plugins:{Ads:{Types:Ae,Status:Ka}},Utils:{Array:Bs,Function:Pb,Time:Rb}}=Ludex,{ads:pe}=codex,bb={MAX_BOTTOM_BANNER_RATIO:1/6},Ib=class Dp{static _instance;isAvoidBannerShowed=!1;static get inst(){return this._instance||(this._instance=new Dp),this._instance}static async preloadAds(){this.preloadAdsByType(Ae.INTERSTITIAL),this.preloadAdsByType(Ae.REWARDED_VIDEO),this.preloadAdsByType(Ae.REWARDED_INTERSTITIAL)}static isServiceDegraded(){return pe.isServiceDegraded()}static preloadAdsByType(t,i){if(!tr)return;let s=pe.getAdsByType(t);for(let n of s)i&&n.placementId!==i||n.instance.status===Ka.FILLED||pe.loadAdAsync(t,n.placementId).catch(()=>{})}static setAvoidBannerShowed(t){this.inst.isAvoidBannerShowed=t}static showBannerAds(){if(tr&&!this.inst.isAvoidBannerShowed)for(let{PlacementId:t,Position:i,BannerHeight:s}of cd){if(i==="bottom"){let{height:n}=lt.getWorldSize(),r=lt.toPixelSize(n*bb.MAX_BOTTOM_BANNER_RATIO);if(s>r){pe.hideBannerAdAsync(t).catch(o=>{});continue}}pe.showBannerAdAsync(t).catch(n=>{})}}static hideBannerAds(){tr&&pe.getAdsByType(Ae.BANNER).forEach(t=>{t.instance.status!==Ka.IDLE&&this.hideBannerAd(t.placementId)})}static showBannerAd(t){this.inst.isAvoidBannerShowed||pe.showBannerAdAsync(t).catch(i=>{})}static hideBannerAd(t){pe.hideBannerAdAsync(t).catch(i=>{})}static getBannerHeight(){if(!tr)return 0;let t=cd.find(({Position:i})=>i==="bottom");return pe.getBannerHeight(t?.PlacementId||"",1,!0)||0}getAdReady(t,i){if(!tr)return null;if(i){if(pe.getAdStatus(t,i)===Ka.FILLED)return i}else{let s=pe.getAdsByType(t);for(let n of s)if(n.instance.status===Ka.FILLED)return n.placementId}return null}getPlacementIdByService(t,i){if(!i)return!1;switch(t){case Ae.BANNER:return Bs.search(cd,s=>s.AdService===i)?.PlacementId||!1;case Ae.INTERSTITIAL:return Bs.search(Sb,s=>s.AdService===i)?.PlacementId||!1;case Ae.REWARDED_VIDEO:return Bs.search(Ab,s=>s.AdService===i)?.PlacementId||!1;case Ae.REWARDED_INTERSTITIAL:return Bs.search(wb,s=>s.AdService===i)?.PlacementId||!1;default:return!1}}getAdIdByPayload(t,i){let{adService:s,placementId:n}=i||{};return this.getPlacementIdByService(t,s)||n}static isReadyAdShowable(t,i){let s=this.inst.getAdReady(t,i);return s?pe.canShowAd(t,s):!1}getAdErrorMessage(t,i){switch(t){case Ae.REWARDED_VIDEO:case Ae.REWARDED_INTERSTITIAL:return this.isUserCancelledAdError(i)?`Sorry, no rewards!
 You have cancelled the ad.`:"No ads to display.";default:return null}}async showAdWithType(t,i){let{placementId:s,includeSDK:n,excludeSDK:r,forceLoad:o,adService:a}=i||{};if(!this.canbeShowInSDK(n,r))return!1;let h=this.getAdIdByPayload(t,i),l=!1,u=!1;try{if(nt.muteAudio(!0),o){ot.showLoadingScreen();let[d]=await Pb.allSettled([pe.loadAdAsync(t,h),Rb.sleepAsync(500)]);if(d?.status==="rejected")throw d.reason}for(;!l;)try{let d=this.getAdReady(t,h);if(!d)return!1;h=d,await pe.showAdAsync(t,h),l=!0}catch(d){if(a||this.isUserCancelledAdError(d)||this.isRequestAdTimeoutError(d))throw d;h=void 0,l=!1,u=!0}return!0}catch(d){u=!0;let p=this.getAdErrorMessage(t,d);return p&&ot.showNotificationScreen(p,2e3),!1}finally{nt.muteAudio(!1),o&&ot.closeLoadingScreen(),u&&(h=s),Dp.preloadAdsByType(t,h)}}static async showInterstitialAdAsync(t){let{forLevel:i,contextType:s,forceLoad:n}=t||{};if(i&&Cb>=i)return!1;s&&(window.GoogleAds?.setInterstitialType(s),window.TranssionH5Ads?.setInterstitialType(s));let r=n;return GameSDK.getSDKName()==="MsGames"&&(r=!0),this.inst.showAdWithType(Ae.INTERSTITIAL,{...t,forceLoad:r})}static async showRewardVideoAdAsync(t){let{contextType:i}=t||{};return i&&(window.GoogleAds?.setRewardType(i),window.TranssionH5Ads?.setRewardType(i)),this.inst.showAdWithType(Ae.REWARDED_VIDEO,{...t,forceLoad:!0})}static async showRewardedInterstitialAdAsync(t){let{contextType:i}=t||{};return i&&(window.GoogleAds?.setRewardType(i),window.TranssionH5Ads?.setRewardType(i)),this.inst.showAdWithType(Ae.REWARDED_INTERSTITIAL,{...t,forceLoad:!0})}canbeShowInSDK(t=[],i=[]){let s=GameSDK.getSDKName();return!(i?.length&&Bs.has(i,s)||t?.length&&!Bs.has(t,s))}isUserCancelledAdError(t){return t instanceof Object&&"code"in t&&t.code==="USER_INPUT"}isRequestAdTimeoutError(t){return t instanceof Object&&"code"in t&&t.code==="SHOW_ADS_TIMEOUT"}},pt=Ib;U();var{player:_b}=codex,Ob=class OR{static _instance;static get inst(){return this._instance||(this._instance=new OR),this._instance}static getLevelProgress(){return _b.getGameData()?.level??1}},Ii=Ob,{Events:dd,Configs:{Ads:{Enabled:Mb,PreloadAds:Lb,ShowAdOnLoad:Db,BannerDisplayAdOptions:kb},Gameplay:{StartAdAtLevel:Fb}},Utils:{Time:pd}}=Ludex,{phaser:fw}=window,{event:ja}=codex,Nb=class{currentLayout="";init(){this.listenEvents()}listenEvents(){ja.on(yt.LAYOUT_CHANGED,this.handleLayoutChanged),ja.catchUp(dd.GAME_READY,this.processPreloadAds),ja.catchUp(dd.GAME_READY,this.processShowBannerAds),ja.catchUp(dd.GAME_SDK_READY,this.processShowFirstInterstitialAd)}processShowBannerAds=async()=>{Ii.getLevelProgress()<Fb||(await pd.sleepAsync(1500),pt.showBannerAds())};processPreloadAds=async()=>{Lb&&(await pd.sleepAsync(3*1e3),pt.preloadAds())};processShowFirstInterstitialAd=async()=>{if(!Mb)return;let{Enabled:e,DelaySeconds:t}=Db;if(!e)return;t>0&&await pd.sleepAsync(t*1e3);let i=GameSDK.getSDKName()==="Yandex";i&&fw.loop.pause();try{await pt.showInterstitialAdAsync({forceLoad:!0,contextType:"preroll"})}catch{}i&&fw.loop.resume()};handleLayoutChanged=e=>{if(this.currentLayout!==e){if(this.currentLayout=e,e===hd.Layout.Landscape){this.processShowBannerAds();return}kb.forEach(({PlacementId:t,Position:i})=>{i==="bottom"||i==="top"?pt.showBannerAd(t):pt.hideBannerAd(t)})}}},Bb=Nb;U();var{Events:Za}=Ludex,{event:qa}=codex,Ub=class{init(){}requestStart(){qa.emit(Za.REQUEST_CORE_START)}onCoreBoot(e){qa.catchUp(Za.CORE_BOOTING,e)}onCoreStart(e){qa.catchUp(Za.CORE_STARTING,e)}onCoreReady(e){qa.catchUp(Za.CORE_READY,e)}},Gb=Ub;U(),U();var Yb={level:1},Hb=Yb,{player:zb,storage:Wb}=codex,Vb=class{init(){}setupDefaultMatchData(){this.setupMatchCustomData()}setupMatchCustomData(){let e=zb.getGameData()?.level??1;Wb.setStorageData("match","customData",{...Hb,level:e})}},Xb=Vb;U(),U(),U();var Kb={HINT:{ID:"ItemHint",REWARD_DESC:"Show one matchable pair on the board"},ROCKET:{ID:"ItemRocket",REWARD_DESC:"Destroy two pairs on the board"},INVITE:{ID:"ItemInvite"},SHUFFLE:{ID:"ItemShuffle",REWARD_DESC:"Shuffle all tiles on the board"},BOMB_DEFUSE:{ID:"ItemBombDefuse",REWARD_DESC:"Remove a bomb tile on the board"},GUIDE_BOMB_DEFUSE:{ID:"ItemGuideBombDefuse"},SUPER_ROCKET:{ID:"ItemSuperRocket",REWARD_DESC:"Destroy four pairs on the board"},WIN_GAME:{ID:"ItemWinGame"},NEW_GAME:{ID:"ItemNewGame"},CHANGE_COLOR:{ID:"ItemChangeColor"},NEXT_LEVEL:{ID:"ItemNextLevel"},OPEN_LUCKY_WHEEL:{ID:"ItemOpenLuckyWheel"},BACK_LEVEL:{ID:"ItemBackLevel"},BOMB_EXPLOSIVE:{ID:"ItemBombExplosive"},TIME_UP:{ID:"ItemTimeUp"},RESET_DATA:{ID:"ItemResetData"},AUTO_MATCH:{ID:"ItemAutoMatch"},EMBED_LOCAL:{ID:"ItemEmbedLocal"}},K=Kb;U();var Tt={NEWBIE:"Newbie",NO_TIMER:"NoTimer",TIMER:"Timer",MAGNIFIER_ITEM:"MagnifierItem",ROCKET_TILES:"RocketTiles",BOMB_ITEM:"BombItem",DIFFUSE_ITEM:"DiffuseItem",SHUFFLE_ITEM:"ShuffleItem",ROCKET_ITEM:"RocketItem",SUPER_ROCKET_ITEM:"SuperRocketItem"},{StartItems:er}=Lt,mw={[Tt.NO_TIMER]:!1,[Tt.TIMER]:!1,[Tt.MAGNIFIER_ITEM]:!1,[Tt.ROCKET_TILES]:!1,[Tt.BOMB_ITEM]:!1,[Tt.DIFFUSE_ITEM]:!1,[Tt.SHUFFLE_ITEM]:!1,[Tt.ROCKET_ITEM]:!1,[Tt.SUPER_ROCKET_ITEM]:!1},jb={level:1,coins:0,lastDailySpin:0,lastTimePlayed:0,lastReceiveGift:0,items:{[K.HINT.ID]:er.ItemHint,[K.ROCKET.ID]:er.ItemRocket,[K.SHUFFLE.ID]:er.ItemShuffle,[K.BOMB_DEFUSE.ID]:er.ItemBombDefuse,[K.SUPER_ROCKET.ID]:er.ItemSuperRocket},tournamentProgress:{},tutorialDisplayed:mw,levelProgress:1,xiaomiDataTransferFlag:!0},vw=jb;U();var Zb={gameData:vw,dailyRewardedData:{logDays:[],firstReward:0,lastReward:0}},qb=Zb,{Utils:{Valid:Dt,Browser:gd},Dtos:{Player:Ve}}=Ludex,{player:Ja}=codex,Jb=class{init(){}setupDefaultGameData(){Ve.Data.addDefaultData(qb),Ve.GameData.addDefaultData(vw),Ve.GameData.addValidateFunction("lastDailySpin",e=>{if(!Dt.isNumber(e)||e<0)throw new Error(`lastDailySpin ${e} is invalid`)}),Ve.GameData.addValidateFunction("lastTimePlayed",e=>{if(!Dt.isNumber(e)||e<0)throw new Error(`lastTimePlayed ${e} is invalid`)}),Ve.GameData.addValidateFunction("lastReceiveGift",e=>{if(!Dt.isNumber(e)||e<0)throw new Error(`lastReceiveGift ${e} is invalid`)}),Ve.GameData.addValidateFunction("items",e=>{if(!Dt.isObject(e))throw new Error(`items ${e} is invalid`)}),Ve.GameData.addValidateFunction("tournamentProgress",e=>{if(!Dt.isObject(e))throw new Error(`tournamentProgress ${e} is invalid`)}),Ve.GameData.addValidateFunction("tutorialDisplayed",e=>{if(!Dt.isObject(e))throw new Error(`tutorialDisplayed ${e} is invalid`)}),Ve.GameData.addValidateFunction("levelProgress",e=>{if(!Dt.isNumber(e)||e<0)throw new Error(`levelProgress ${e} is invalid`)}),Ve.GameData.addValidateFunction("xiaomiDataTransferFlag",e=>{if(!Dt.isBoolean(e))throw new Error(`xiaomiDataTransferFlag ${e} is invalid`)})}async syncPlayerData(){let e={},{userGuideDisplays:t,gameData:i}=await GameSDK.player.getDataAsync(["userGuideDisplays","gameData"]),{levelProgress:s,items:n}=i??{},{level:r=1}=Ja.getGameData()??{},o={userGuideDisplays:t,levelProgress:s,items:n};{let a=this.or();o.userGuideDisplays=a.userGuideDisplays,o.levelProgress=a.levelProgress,o.items=a.items,Ja.setGameData({xiaomiDataTransferFlag:!1})}t!==void 0&&t!==!0&&(e.isFirstLogin=!1),Dt.isEmpty(i)||(e.gameData={},Dt.isNumber(s)&&s>r&&(e.gameData.level=s),Dt.isEmpty(n)||(e.gameData.items=n)),!Dt.isEmpty(e)&&!Dt.isEmpty(e.gameData)&&(e.oldData=o,Ja.setPlayerData(e)),this.hr()}requestConnectedPlayers(){Ja.requestConnectedPlayers().catch(e=>{})}or(){let e=gd.getLocalStorage("Tile Connect Master_fbPlayerData");if(!e||!Dt.isObject(e))return{};if(!("gameData"in e)||!Dt.isObject(e.gameData))return{};let{gameData:t}=e,i=this.lr(t),s=this.ur(t),n=this.cr(t);return{levelProgress:i,items:s,userGuideDisplays:n}}lr(e){if("levelProgress"in e&&Dt.isNumber(e.levelProgress)){let{levelProgress:t}=e;return Math.max(t,1)}return null}cr(e){return"userGuideDisplays"in e&&Dt.isBoolean(e.userGuideDisplays)?e.userGuideDisplays:null}ur(e){if("items"in e&&Dt.isObject(e.items)){let{items:t}=e,i={ItemHint:2,ItemRocket:2,ItemShuffle:2,ItemBombDefuse:2,ItemSuperRocket:0};return"ItemHint"in t&&Dt.isNumber(t.ItemHint)&&(i.ItemHint=t.ItemHint),"ItemRocket"in t&&Dt.isNumber(t.ItemRocket)&&(i.ItemRocket=t.ItemRocket),"ItemShuffle"in t&&Dt.isNumber(t.ItemShuffle)&&(i.ItemShuffle=t.ItemShuffle),"ItemBombDefuse"in t&&Dt.isNumber(t.ItemBombDefuse)&&(i.ItemBombDefuse=t.ItemBombDefuse),"ItemSuperRocket"in t&&Dt.isNumber(t.ItemSuperRocket)&&(i.ItemSuperRocket=t.ItemSuperRocket),i}return null}hr(){let e=gd.getLocalStorage("Tile Connect Master_guestId");if(!e||!Dt.isString(e))return;let t=`${__GAME_NAME__.replace(/ /g,"-")}_fbPlayerId`;gd.writeLocalStorage(t,{playerId:e})}},Qb=Jb;U(),U();var{Events:Ew,Utils:{Valid:yw}}=Ludex,{ads:$b,event:fd,adaptivePerformance:ir}=codex,tI=class{init(){ir&&this.listenEvents()}listenEvents(){fd.on(Ew.REQUEST_RESIZE_GAME,this.handleRequestResizeGame),window.phaser.renderer.once(Phaser.Renderer.Events.RENDER,this.handleBeginFrame),fd.on(Ew.SCENE_LAUNCHED,this.handleAfterSceneLaunch)}handleBeginFrame=()=>{window.phaser.renderer.on(Phaser.Renderer.Events.POST_RENDER,this.lateUpdate),window.phaser.renderer.on(Phaser.Renderer.Events.PRE_RENDER,this.updateActualFPS)};handleAfterSceneLaunch=()=>{if(!ir)return;let e=It.getCurrentScene();e&&ir.trackingScene(e.scene.key)};handleRequestResizeGame=e=>{if($b.isAdFullSizeShowing())return;let{forcePixelRatio:t}=e;yw.isNumber(t)&&fd.emit(yt.REQUEST_VIEW_RESIZE,{forcePixelRatio:t})};lateUpdate=()=>{ir?.updatePostStepDeltaTime(window.phaser.loop.delta)};updateActualFPS=()=>{let e=window.phaser.loop.actualFps;yw.isNumber(e)&&ir?.updateActualFPS(e)}},eI=tI;U();var iI=class{init(){}};U(),U(),U(),U(),U();var sI=class extends Error{code;constructor(e,t){super(t),this.code=e}},nI=sI,rI=class extends nI{playerId;tournamentId;constructor(e,t){super("PLAYER_HAS_TOURNAMENT","Player has a tournament"),this.playerId=e,this.tournamentId=t}};U(),U();var aI=[{id:"hint-1",title:"Use Hint 1 time",require:{hint:1},reward:{coin:200},duration:864e5},{id:"hint-2",title:"Use Hint 3 times",require:{hint:3},reward:{coin:400},duration:864e5},{id:"hint-weekly",title:"Use Hint 25 times weekly",require:{hint:25},reward:{coin:2e3},duration:6048e5},{id:"shuffle-1",title:"Use Shuffle 1 time",require:{shuffle:1},reward:{coin:300},duration:864e5},{id:"shuffle-2",title:"Use Shuffle 3 times",require:{shuffle:3},reward:{coin:600},duration:864e5},{id:"shuffle-weekly",title:"Use Shuffle 25 times weekly",require:{shuffle:30},reward:{coin:3e3},duration:6048e5},{id:"bomb-defuse-1",title:`Use Bomb Defuse
1 time`,require:{defuse:1},reward:{coin:400},duration:864e5},{id:"bomb-defuse-2",title:`Use Bomb Defuse
3 times`,require:{defuse:3},reward:{coin:800},duration:864e5},{id:"bomb-defuse-weekly",title:`Use Bomb Defuse
25 times weekly`,require:{defuse:25},reward:{coin:3200},duration:6048e5},{id:"rocket-1",title:"Use Rocket 1 time",require:{rocket:1},reward:{coin:500},duration:864e5},{id:"rocket-2",title:"Use Rocket 3 times",require:{rocket:3},reward:{coin:1e3},duration:864e5},{id:"rocket-weekly",title:"Use Rocket 25 times weekly",require:{rocket:25},reward:{coin:4e3},duration:6048e5},{id:"finish-level-1",title:"Finish 1 levels",require:{level:1},reward:{coin:300},duration:864e5},{id:"finish-level-2",title:"Finish 3 levels",require:{level:3},reward:{coin:600},duration:864e5},{id:"finish-level-3",title:"Finish 6 levels",require:{level:6},reward:{coin:900},duration:864e5},{id:"finish-level-4",title:"Finish 10 levels",require:{level:10},reward:{coin:1200},duration:864e5},{id:"finish-level-5",title:"Finish 15 levels",require:{level:15},reward:{coin:1500},duration:864e5},{id:"finish-level-weekly",title:"Finish 120 levels weekly",require:{level:120},reward:{coin:6e3},duration:6048e5},{id:"match-pairs-1",title:"Match 50 pairs",require:{pairs:50},reward:{coin:300},duration:864e5},{id:"match-pairs-2",title:"Match 150 pairs",require:{pairs:150},reward:{coin:400},duration:864e5},{id:"match-pairs-3",title:"Match 300 pairs",require:{pairs:300},reward:{coin:500},duration:864e5},{id:"match-pairs-4",title:"Match 500 pairs",require:{pairs:500},reward:{coin:600},duration:864e5},{id:"match-pairs-5",title:"Match 750 pairs",require:{pairs:750},reward:{coin:700},duration:864e5},{id:"match-pairs-weekly",title:"Match 5000 pairs weekly",require:{pairs:5e3},reward:{coin:7e3},duration:6048e5},{id:"invite-friend-1",title:`Play with friends
1 time.`,require:{invite:1},reward:{coin:500},duration:864e5},{id:"invite-friend-weekly",title:`Play with friends
5 times weekly`,require:{invite:5},reward:{coin:2500},duration:6048e5},{id:"share-score-1",title:`Share your score
1 time.`,require:{share:1},reward:{coin:500},duration:864e5},{id:"join-tournament-1",title:`Join a tournament
1 time.`,require:{tournament:1},reward:{coin:500},duration:864e5},{id:"join-tournament-weekly",title:`Join a tournament
5 times weekly`,require:{tournament:5},reward:{coin:2500},duration:6048e5}],Tw=aI;U(),U();var oI={DIE:"die",REPLAY:"replay",RESCUE:"rescue",FINISH:"finish",CONTINUE:"continue",NEXT_LEVEL:"next-level",PAUSE:"pause",RESUME:"resume",RECEIVE_ITEM:"receive-item",TILE_SHOWED_UP:"tile-show-up",SHOW_RESULT_CHALLENGE_SCREEN:"show-result-challenge-screen",GAMEPLAY_PAUSE_NOTIFICATION:"gameplay-pause-notification-available",PAUSE_SCREEN_NOTIFICATION:"pause-screen-notification-available"},j=oI,{event:xw,player:hI}=codex,{GameplayNotificationLevel:lI}=Lt,uI=15e3,cI=class MR{static Ci;static Ve=!1;static Se=!1;static Ns=!1;static Pi=0;static get inst(){return this.Ci||(this.Ci=new MR),this.Ci}static setGameplayPauseNotificationFlag(t,i){if(this.Ve===t)return;let s=()=>{t===!0&&(this.Pi=Date.now()),!(!t&&!this.isLevelReadyForNotification())&&(this.Ve=t,xw.emit(j.GAMEPLAY_PAUSE_NOTIFICATION))};if(i===1){s();return}this.dr()||s()}static setPauseScreenNotificationFlag(t){if(this.Ns){this.Se=!1;return}this.Se!==t&&(!t&&!this.isLevelReadyForNotification()||(this.Se=t,xw.emit(j.PAUSE_SCREEN_NOTIFICATION)))}static setIsUserUsedPauseScreenNotification(t){this.Ns=t}static get isGameplayPauseNotificationAvailable(){return this.Ve}static get isPauseScreenNotificationAvailable(){return this.Se}static initializeFlags(){let t=kt.checkForClaimableMissions()>0;this.Ve=t,this.Se=t}static dr(){let t=Date.now(),i=this.Pi;return t-i<uI}static clearGameplayPauseGracePeriod(){this.Pi=0}static isLevelReadyForNotification(){let t=hI.getGameData();if(!t)return!1;let{level:i}=t;return i>=lI}},ge=cI,{missions:Us,storage:Gs,player:Sw}=codex,dI=class kr{static _instance;static finishedMissionCountTracker=null;static get inst(){return this._instance||(this._instance=new kr),this._instance}static addGameMissions(){this.removeDefaultMissions();let t=this.filterExistingMissions();for(let i of t)this.addMission(i)}static removeDefaultMissions(){Us.removeMission("finish-level")}static filterExistingMissions(){let t=Gs.getStorageData("missions","tasks")??[];return Tw.filter(i=>!t.some(s=>s.id===i.id))}static getAllMissions(){return(Gs.getStorageData("missions","tasks")??[]).filter(t=>t.id!=="finish-level")}static getAllProcessLogs(){let t=Gs.getStorageData("missions","process")??{};return delete t["finish-level"],t}static getGenericExpirationTime(){let t=this.getAllMissions();if(t.length===0)return-1;let i=t[0],{expirationTime:s,duration:n}=i;return s||Date.now()+n}static getMissionById(t){return this.getAllMissions().find(i=>i.id===t)}static getProcessLogById(t){return this.getAllProcessLogs()[t]}static addMission(t){Us.addMission(t)}static removeMission(t){Us.removeMission(t)}static addMissionProgress(t,i,s){Us.addMissionValue({id:t,type:i,value:s});let n=this.checkForFinishedMissions(),r={isMissionFinished:!1};return this.finishedMissionCountTracker!==null&&this.finishedMissionCountTracker!==n&&(ge.setPauseScreenNotificationFlag(!0),ge.setGameplayPauseNotificationFlag(!0,3),r.isMissionFinished=!0),this.finishedMissionCountTracker=n,r}static setMissionRewardClaimed(t){Us.setMissionRewardClaimed(t)}static addFinishLevelMissionProgress(t){return this.addMissionProgress("finish-level","level",t)}static addMatchPairsMissionProgress(t){return this.addMissionProgress("match-pairs","pairs",t)}static addUseBombDefuseMissionProgress(t){return this.addMissionProgress("bomb-defuse","defuse",t)}static addUseRocketMissionProgress(t){return this.addMissionProgress("rocket","rocket",t)}static addUseShuffleMissionProgress(t){return this.addMissionProgress("shuffle","shuffle",t)}static addUseHintMissionProgress(t){return this.addMissionProgress("hint","hint",t)}static addInviteFriendMissionProgress(t){return this.addMissionProgress("invite-friend","invite",t)}static addShareScoreMissionProgress(t){return this.addMissionProgress("share-score","share",t)}static addJoinTournamentMissionProgress(t){return this.addMissionProgress("join-tournament","tournament",t)}static resetMissions(){kr.resetProcessLog(),kr.resetPlayerMissionProcess(),Gs.setStorageData("missions","tasks",[]),Us.requestMissions(),this.addDefaultMissions()}static resetProcessLog(){let t=this.getAllProcessLogs(),i=Object.keys(t);for(let s of i){let n=t[s],{require:r}=n,o=Object.keys(r);for(let a of o)r[a]=0;n.rewarded=!1}}static resetPlayerMissionProcess(){let t=Sw.getPlayerDataByKey("missionsData");if(!t)return;let{process:i}=t,s=Object.keys(i);for(let n of s){let r=i[n],{require:o}=r,a=Object.keys(o);for(let h of a)o[h]=0;r.rewarded=!1}Sw.setPlayerDataByName("missionsData",{process:i})}static addDefaultMissions(){let t=[...Tw];for(let i of t)kr.addMission(i)}static getMissionProgressIcon(t){let{FRAME:i}=G.DAILY_MISSIONS;return t.includes("hint")?i.MISSION_HINT:t.includes("shuffle")?i.MISSION_SHUFFLE:t.includes("rocket")?i.MISSION_ROCKET:t.includes("bomb-defuse")?i.MISSION_BOMB_DEFUSE:t.includes("coin")?i.MISSION_COIN:t.includes("finish-level")?i.MISSION_FINISH_LEVEL:t.includes("match-pairs")?i.MISSION_MATCH_PAIRS:t.includes("invite-friend")?i.MISSION_INVITE_FRIEND:t.includes("share-score")?i.MISSION_SHARE_SCORE:t.includes("join-tournament")?i.MISSION_JOIN_TOURNAMENT:""}static checkForClaimableMissions(){let t=this.getAllMissions(),i=this.getAllProcessLogs(),s=0;for(let n of t){if(n.expirationTime&&n.expirationTime<Date.now())continue;let r=i[n.id];if(r.rewarded)continue;let o=r.require,a=Object.keys(o);for(let h of a){let l=o[h],u=n.require[h];!u||l<u||s++}}return s}static checkForFinishedMissions(){let t=this.getAllMissions(),i=this.getAllProcessLogs(),s=0;for(let n of t){if(n.expirationTime&&n.expirationTime<Date.now())continue;let r=i[n.id];if(r.rewarded){s++;continue}let o=r.require,a=Object.keys(o);for(let h of a){let l=o[h],u=n.require[h];!u||l<u||s++}}return s}static initializeFinishedMissionCount(){let t=this.checkForFinishedMissions();this.finishedMissionCountTracker=t}static reduceAllMissionExpirationTime(){let t=this.getAllMissions();for(let i of t)i.expirationTime&&(i.expirationTime=i.expirationTime-1e3*60*60*24*2);Gs.setStorageData("missions","tasks",t),Gs.updateToWebStorage("missions")}},kt=dI,{Match:{Modes:sr},Utils:{Object:pI,Valid:De,String:Aw,Decorator:Ft,Function:Ys,Time:gI},Plugins:{Analytics:{Events:fI}}}=Ludex,{match:ee,player:fe,leaderboard:mI,analytics:vI}=codex,fi=()=>{ot.showLoadingScreen()},EI=async()=>{await gI.sleepAsync(0),ot.closeLoadingScreen()},ke=e=>{if(EI(),e instanceof Error){let t="Something went wrong";De.isDebugger()&&(t=e.message),ot.showNotificationScreen(t,3e3)}},ie=class Fr{static _instance;static get inst(){return this._instance||(this._instance=new Fr),this._instance}static isMatchActive(){let t=this.getMatchState(),{status:i}=t;return i==="active"}static isMatchFinished(){let t=this.getMatchState(),{status:i}=t;return i==="finished"}static isSingleMode(){return this.getMatchMode()===sr.SINGLE}static isChallengeMode(){return this.getMatchMode()===sr.CHALLENGE_FRIEND}static isTournamentMode(){return this.getMatchMode()===sr.TOURNAMENT}static isPlayerFinished(){let t=this.getMatchState(),{profiles:i={}}=t,s=fe.getPlayerId(),n=i[s];return n?n.finished??!1:!1}static getMatchPlayerScore(){let t=this.getMatchState(),{profiles:i={}}=t,s=fe.getPlayerId();return i[s]?.score??0}static getMatchMode(){let t=this.getMatchState();return De.isString(t.mode)?t.mode:null}static getMatchState(){let t=ee.getMatchState();if(!t)throw new Error("Match state not found");return t}static getMatchCustomData(){let t=this.getMatchState();return De.isObject(t.customData)?t.customData:null}static async setProfileMatchDataAsync(t){await ee.handler.setProfileData(t)}static async setMatchCustomDataAsync(t){await ee.handler.setMatchCustomData(t)}static async fetchMatchCustomDataAsync(){await ee.handler.getMatchCustomData()}static async setLeaderboardScoreAsync(t){await ee.handler.setLeaderboardScore(t)}static getMatchLevel(){let{level:t=1}=this.getMatchCustomData()??{};return t}static async startSingleModeAsync(){let t=fe.getPlayerId(),i=Ii.getLevelProgress();return await ee.strategy.start.processAsync({matchId:"local",playerId:t,gameMode:sr.SINGLE,extraData:{level:i}}),!0}static async finishSingleModeAsync(){return await ee.strategy.finish.processAsync({setPlayerBestScore:!0,postGlobalLeaderboard:!0}),!0}static async autoChallengeModeAsync(){let t=await this.continueChallengeModeAsync();return!!(t||(ot.closeNotificationScreen(),t=await this.startChallengeRandomOpponentAsync(),t)||(ot.closeNotificationScreen(),t=await this.startChallengeChooseOpponentAsync(),t)||(ot.closeNotificationScreen(),t=await this.joinChallengeModeAsync(),t))}static async startChallengeRandomOpponentAsync(){let t=fe.getConnectedPlayerIds(10,0),i=Math.floor(Math.random()*t.length),s=t[i];return!De.isString(s)||De.isEmpty(s)?!1:(kt.addInviteFriendMissionProgress(1),this.startChallengeModeAsync(s))}static async startChallengeChooseOpponentAsync(){let t=fe.getPlayerId(),i=Ii.getLevelProgress(),s=Math.max(i,2),n=ee.context.choose.processAsync({playerId:t,fallbackSingleMode:!1,extraData:{level:s}}),[r,o]=await Ys.handleAsync(n);if(this.inst.isUserInputError(o))return!1;if(o)throw o;return kt.addInviteFriendMissionProgress(1),!0}static async startChallengeModeAsync(t){let i=fe.getPlayerId(),s=Ii.getLevelProgress(),n=Math.max(s,2),r=ee.challenge.friend.processAsync({playerId:i,opponentId:t,extraData:{level:n}}),[o,a]=await Ys.handleAsync(r);if(this.inst.isUserInputError(a))return!1;if(a)throw a;return!0}static async joinChallengeModeAsync(){let{id:t,customData:i}=Fr.getMatchState(),{playerId:s,opponentId:n}=i;if(!De.isString(t))throw new Error("Invalid match id");if(!De.isString(s))throw new Error("Invalid player id");if(!De.isString(n))throw new Error("Invalid opponent id");let r=ee.challenge.join.processAsync({matchId:t,playerId:s,opponentId:n}),[o,a]=await Ys.handleAsync(r);if(this.inst.isUserInputError(a))return!1;if(a)throw a;return kt.addInviteFriendMissionProgress(1),!0}static async continueChallengeModeAsync(){let{id:t,customData:i}=Fr.getMatchState(),{playerId:s,opponentId:n}=i;if(!De.isString(t))throw new Error("Invalid match id");if(!De.isString(s))throw new Error("Invalid player id");if(!De.isString(n))throw new Error("Invalid opponent id");let r=GameSDK.context.getID();if(!r)throw new Error("Cannot get contextId");let o=ee.challenge.continue.processAsync({matchId:t,contextId:r,playerId:s,opponentId:n}),[a,h]=await Ys.handleAsync(o);if(this.inst.isUserInputError(h))return!1;if(h)throw h;return kt.addInviteFriendMissionProgress(1),!0}static async finishChallengeModeAsync(){let t=this.getMatchLevel();return await ee.challenge.finish.processAsync({extraData:{level:t}}),!0}static async joinTournamentAsync(t,i){let s=fe.getPlayerId();await this.setMatchCustomDataAsync({playerId:s,level:i,contextId:"SOLO"});let n=ee.tournament.join.processAsync({tournamentId:t,playerId:s}),[r,o]=await Ys.handleAsync(n);if(!o)return!0;if(this.inst.isUserInputError(o))return!1;throw o}static async continueTournamentAsync(){let t=fe.getPlayerId(),i=GameSDK.context.getID();return await ee.tournament.continue.processAsync({playerId:t,contextId:i}),!0}static async finishTournamentAsync(){let t=fe.getPlayerId(),i=fe.getBestScore();return await ee.tournament.finish.processAsync({playerId:t,bestScore:i}),!0}static async createTournamentAsync(){let t=!1,i=(await this.inst.getTournamentsAsync()).find(n=>{let r=JSON.parse(n.getPayload());return n.getTournamentType()==="DEFAULT"&&r.playerId===fe.getPlayerId()});if(i)throw new rI(fe.getPlayerId(),i.getID());let s=this.inst.createTournamentPayload();try{await ee.tournament.create.processAsync(s);let{leaderboardId:n}=s;mI.addLeaderboard({name:n,type:"tournament",autoSortRank:!0,leaderboardId:n}),t=!0}catch{}return t}static async shareTournamentAsync(t){let[i,s]=await Ys.handleAsync(GameSDK.tournament.shareAsync({score:t})),n=!s;if(vI.event(fI.TOURNAMENT_SHARE,{success:n}),n)return!0;if(this.inst.isUserInputError(s))return!1;throw s}async getTournamentsAsync(){try{return await GameSDK.tournament.getTournamentsAsync()}catch{return[]}}createTournamentPayload(){let t=Aw.generateObjectId(),i=fe.getPlayerId(),s=Fr.getMatchState(),{profiles:n={}}=s;return{score:n[i]?.score??0,playerId:i,mode:sr.TOURNAMENT,name:this.createTournamentName(),leaderboardId:t,payload:{playerId:i,leaderboardId:t}}}createTournamentName(){let t=fe.getPlayer(),{name:i=null}=t;if(i){let s=i.substring(0,7),n=`${s.split(" ")[0]||s}'s Tournament`;return`${Aw.removeDiacritics(n)}`}return"Tournament"}isUserInputError(t){return t?!!(t instanceof Error&&(["dismissed","closed","refused"].some(i=>t.message.indexOf(i)!==-1)||pI.hasOwn(t,"code")&&t.code==="USER_INPUT")):!1}};ae([Ft.tryCatch()],ie,"setProfileMatchDataAsync",1),ae([Ft.tryCatch()],ie,"setMatchCustomDataAsync",1),ae([Ft.tryCatch()],ie,"fetchMatchCustomDataAsync",1),ae([Ft.tryCatch()],ie,"setLeaderboardScoreAsync",1),ae([Ft.tryCatch(ke),Ft.preStart(fi)],ie,"startSingleModeAsync",1),ae([Ft.tryCatch(ke)],ie,"finishSingleModeAsync",1),ae([Ft.tryCatch(ke)],ie,"autoChallengeModeAsync",1),ae([Ft.tryCatch(ke),Ft.preStart(fi)],ie,"startChallengeChooseOpponentAsync",1),ae([Ft.tryCatch(ke),Ft.preStart(fi)],ie,"startChallengeModeAsync",1),ae([Ft.tryCatch(ke),Ft.preStart(fi)],ie,"joinChallengeModeAsync",1),ae([Ft.tryCatch(ke),Ft.preStart(fi)],ie,"continueChallengeModeAsync",1),ae([Ft.tryCatch(ke),Ft.preStart(fi)],ie,"finishChallengeModeAsync",1),ae([Ft.tryCatch(ke),Ft.preStart(fi)],ie,"joinTournamentAsync",1),ae([Ft.tryCatch(ke),Ft.preStart(fi)],ie,"continueTournamentAsync",1),ae([Ft.tryCatch(ke),Ft.preStart(fi)],ie,"finishTournamentAsync",1);var yI=ie,ht=yI,{Configs:{FrameCapture:{Enabled:TI,WideframeConfigs:md}},Utils:{Object:vd}}=Ludex,xI=async e=>{if(!TI)return null;let t=AI(e);if(!t)return null;SI(t,md.ResultChallenge);let{frameCapture:i}=codex,{Width:s,Height:n}=md.ResultChallenge;return i.captureAsync({name:"ResultChallenge",width:s,height:n,renderOptions:t})},SI=(e,t)=>{let{Width:i,Height:s,Wideframe:n}=t;e.wideframe={name:"result-challenge",type:"image",depth:0,image:n,size:[i,s],position:[0,0]}},AI=e=>{try{let{playerId:t="10",playerPhoto:i="",playerScore:s=0,opponentId:n="20",opponentPhoto:r="",opponentScore:o=0,isPlayerFinished:a,isOpponentFinished:h}=e,{RenderOptions:l}=md.ResultChallenge,u=vd.clone(l);if(!u)return null;let d=vd.clear(u),p=vd.camelCaseKeys(d),{playerPhoto:g,opponentPhoto:c}=p,f=s===o,m=s>o,v=a&&h;return g.type==="image"&&(g.name=`${t}`,g.image=i),c.type==="image"&&(c.name=`${n}`,c.image=r),wI(p,{playerScore:s,opponentScore:o,isPlayerFinished:a,isOpponentFinished:h}),!v||f?(delete p.leftCrown,delete p.rightCrown,p):(m?delete p.rightCrown:delete p.leftCrown,p)}catch{return null}},wI=(e,t)=>{let{leftScore:i,rightScore:s}=e,{playerScore:n=0,opponentScore:r=0,isPlayerFinished:o,isOpponentFinished:a}=t;if(i?.type==="text"){let{level:h}=ht.getMatchCustomData()??{};i.text=o?`${n}`:`Level ${h}`}s?.type==="text"&&(s.text=a?`${r}`:"???")},CI=xI;U(),U();var{Utils:{Device:PI}}=Ludex,ww=Math.min(PI.pixelRatio(),2),RI={AVATAR_DEFAULT:{KEY:"avatar-default",FILE:"./assets/images/others/avatar-default.png",CONFIG:{}},BACKGROUND:{KEY:"background",FILE:`./assets/images/${ww}x/bg.jpg`,FILE_LANDSCAPE:`./assets/images/${ww}x/landscape-bg.jpg`,CONFIG:{}}},Xt=RI,{Configs:{FrameCapture:{Enabled:bI,WideframeConfigs:Ed}},Utils:{Object:yd}}=Ludex,II=async e=>{if(!bI)return null;let t=MI(e);if(!t)return null;_I(t,Ed.ResultChallenge);let{frameCapture:i}=codex,{Width:s,Height:n}=Ed.ResultChallenge;return i.captureAsync({name:"UpdateChallenge",width:s,height:n,renderOptions:t})},_I=(e,t)=>{let{Width:i,Height:s,Wideframe:n}=t;e.wideframe={name:"update-challenge",type:"image",depth:0,image:n,size:[i,s],position:[0,0]}},OI=()=>{let e={playerId:"10",playerPhoto:"",playerScore:0,opponentId:"20",opponentPhoto:"",opponentScore:0,isPlayerFinished:!1,isOpponentFinished:!1},t=ht.getMatchState(),{player:i}=codex;if(!t)return e;let{customData:s={},profiles:n={}}=t,r=s.opponentId??"0",o=i.getPlayerId(),a=i.getPlayer()?.photo??Xt.AVATAR_DEFAULT.FILE,h=n[o]?.score??0,l=n[r]?.photo??Xt.AVATAR_DEFAULT.FILE,u=n[r]?.score??0,d=n[o]?.finished??!1,p=n[r]?.finished??!1;return e.playerId=o,e.playerPhoto=a,e.playerScore=h,e.opponentId=r,e.opponentPhoto=l,e.opponentScore=u,e.isPlayerFinished=d,e.isOpponentFinished=p,e},MI=e=>{try{let{playerId:t,playerPhoto:i,playerScore:s,opponentId:n,opponentPhoto:r,opponentScore:o,isPlayerFinished:a,isOpponentFinished:h}=OI(),{RenderOptions:l}=Ed.ResultChallenge,u=yd.clone(l);if(!u)return null;let d=yd.clear(u),p=yd.camelCaseKeys(d),{playerPhoto:g,opponentPhoto:c}=p,f=s===o,m=s>o,v=a&&h;return g.type==="image"&&(g.name=`${t}`,g.image=i),c.type==="image"&&(c.name=`${n}`,c.image=r),LI(p,{playerScore:s,opponentScore:o,isPlayerFinished:a,isOpponentFinished:h}),!v||f?(delete p.leftCrown,delete p.rightCrown,p):(m?delete p.rightCrown:delete p.leftCrown,p)}catch{return null}},LI=(e,t)=>{let{leftScore:i,rightScore:s}=e,{playerScore:n=0,opponentScore:r=0,isPlayerFinished:o,isOpponentFinished:a}=t;i?.type==="text"&&(i.text=o?`${n}`:"???"),s?.type==="text"&&(s.text=a?`${r}`:"???")},DI=II;U();var{Configs:{FrameCapture:{Enabled:kI,WideframeConfigs:Cw}},Utils:{Object:Td}}=Ludex,FI=async e=>{if(!kI)return null;let{PostBestScore:t}=Cw;if(!t)return null;let i=BI(e);if(!i)return null;NI(i,t);let{frameCapture:s}=codex,{Width:n,Height:r}=t;return s.captureAsync({name:"PostBestScore",width:n,height:r,renderOptions:i})},NI=(e,t)=>{let{Width:i,Height:s,Wideframe:n}=t;e.wideframe={name:"post-best-score",type:"image",depth:0,image:n,size:[i,s],position:[0,0]}},BI=e=>{try{let{PostBestScore:t}=Cw;if(!t)return null;let{playerId:i,playerPhoto:s,playerScore:n}=e,{RenderOptions:r}=t,o=Td.clone(r);if(!o)return null;let a=Td.clear(o),h=Td.camelCaseKeys(a),{avatar:l,playerScore:u}=h;return l&&l.type==="image"&&(l.name=`${i}`,l.image=s),u&&u.type==="text"&&(u.text=`${n}`),h}catch{return null}},UI=FI,{frameCapture:Qa}=codex,GI=class{async init(){Qa&&(Qa.addWideframeRender("renderPostBestScore",UI),Qa.addWideframeRender("renderResultChallenge",CI),Qa.addWideframeRender("renderUpdateChallenge",DI))}},YI=GI;U(),U();var HI={GLOBAL:"global-leaderboard-key",FRIENDS:"friends-leaderboard-key"},zI={GLOBAL:"global-leaderboard-id",FRIENDS:"friends-leaderboard-id"},{Configs:{Mockup:{Leaderboards:Pw,GameSDK:{Player:WI}},Leaderboards:Rw},Utils:{Number:bw}}=Ludex,{leaderboard:Xe}=codex,VI=class{init(){this.handleWhenGameSDKStarted()}handleWhenGameSDKStarted=()=>{Pw.Enabled?this.setupLeaderboardsMockup():this.setupLeaderboards()};async setupLeaderboards(){this.setupLeaderboardByConfigs()}setupLeaderboardByConfigs(){let{LeaderboardList:e}=Rw;for(let t of e){let{Id:i,Name:s}=t;Xe.addLeaderboard({name:s,type:"global",autoSortRank:!0,leaderboardId:i})}}async setupLeaderboardsMockup(){this.setupMockGlobalLeaderboards(),this.setupMockFriendsLeaderboard()}async setupMockGlobalLeaderboards(){let{NumOfLeaders:e}=Pw,{LeaderboardList:t}=Rw;for(let i of t){let{Name:s,Id:n}=i;if(!s)continue;let r=await Xe.createLeaderboardAsync({_id:n,name:s,numberOfLeaders:bw.random(e.Max-e.Min)+e.Min});Xe.addLeaderboard({name:s,type:"global",autoSortRank:!0,leaderboardId:r}),await Xe.requestLeaderboardAsync(s,10);let o=Xe.getLeaderboard(s);o=Xe.getLeaderboard(s)}}async setupMockFriendsLeaderboard(){let e=HI.FRIENDS,t=zI.FRIENDS,i=0,{ConnectedPlayers:s}=WI;s.Enabled&&(i=bw.random(s.NumOfPlayers-1)+1);let n=await Xe.createLeaderboardAsync({_id:t,name:e,numberOfLeaders:i});Xe.addLeaderboard({name:e,type:"friends",autoSortRank:!0,leaderboardId:n}),await Xe.requestLeaderboardAsync(e,10);let r=Xe.getLeaderboard(e)}},XI=VI;U();var{missions:KI}=codex,jI=class{async init(){KI.requestMissions()}},ZI=class{init(){}initFrameCapture(){new YI().init()}initLeaderboards(){new XI().init()}initMissions(){new jI().init()}initDailyRewards(){new iI().init()}initAdaptivePerformance(){new eI().init()}},qI=ZI;U(),U();var{Utils:{Array:JI},Plugins:{Analytics:{Events:QI}}}=Ludex,{analytics:xd}=codex,$I=class LR{static _instance;static get inst(){return this._instance||(this._instance=new LR),this._instance}static trackingPages=[];static trackCurrentPage(t,i){if(!i&&!JI.has(this.trackingPages,t))return;this.trackingPages=this.trackingPages.filter(n=>n!==t),i&&this.trackingPages.push(t);let s=this.getCurrentPage();xd.pageview(s)}static switchSceneTracking(){this.trackingPages=[];let t=this.getCurrentPage();xd.pageview(t)}static getCurrentPage(){return this.trackingPages.length>0?this.trackingPages[this.trackingPages.length-1]||"Unknown Page":It.getCurrentScene()?.scene.key||"Unknown Page"}static trackButtonClick(t){let i=this.getCurrentPage();xd.event(QI.BUTTON_CLICK,{screen_name:i,button_name:t})}},qi=$I,{event:nr,monitorError:t_}=codex,{Events:$a}=Ludex,e_=class{sceneInfo;callbackSwitchScene=null;init(){this.listenEvents(),this.sceneInfo={sceneName:Yt.BOOT_SCENE,sceneData:{}}}listenEvents(){nr.on($a.SWITCH_SCENE,this.switchScene),nr.on($a.SCENE_LOADED,this.handleSceneLoaded),nr.on($a.SCENE_LAUNCHED,this.handleSceneLaunched)}correctSceneName(e){let{sceneName:t,sceneData:i}=e;if(t===this.sceneInfo.sceneName)return null;if(t==="ChallengeResultScene")return Yt.GAME_SCENE;let{isFromLoader:s}=i??{};return t===Yt.DASHBOARD_SCENE&&s?Yt.GAME_SCENE:t}switchScene=async e=>{let{sceneData:t}=e,i=this.correctSceneName(e);i&&this.startScene({sceneName:i,sceneData:t})};sleepOtherScenes=e=>{let{scenes:t}=window.phaser.scene;for(let i of t)i.scene.isActive()&&i.scene.key!==e&&i.scene.key!==Yt.GLOBAL_SCENE&&i.scene.sleep()};async startScene(e){let{sceneName:t,sceneData:i}=e,{sceneName:s}=this.sceneInfo,{scene:n}=window.phaser;n.dump(),this.sceneInfo={sceneName:t,sceneData:i},n.switch(s,t),nr.emit(yt.DESTROY_SCREENS,{sceneKey:s}),n.dump(),It.setCurrentScene(t)}handleSceneLoaded=e=>{let{sceneName:t,sceneData:i}=this.sceneInfo;e.sceneName===t&&this.setSceneData(t,i??{})};handleSceneLaunched=e=>{let{sceneName:t,sceneData:i}=this.sceneInfo;e.sceneName===t&&(qi.switchSceneTracking(),t_?.addMetadata({currentScene:t}),this.callbackSwitchScene?.({sceneName:t,sceneData:i}),this.sleepOtherScenes(t),nr.emit($a.SCENE_RENDERED,{sceneName:t}))};onSwitchScene(e){this.callbackSwitchScene=e}setSceneData(e,t){if(!t)return;let i=window.phaser.scene.getScene(e),s={...i.data.get("data"),...t};i.data.set("data",s)}},i_=e_;U(),U(),U(),U(),U(),U(),U();var s_=oh(rw()),n_=(0,s_.default)(.48,1.57,.6,.83),Sd=n_,r_={duration:400,ease:Sd,props:{scale:"-=0.1"}},Hs=r_;U();var a_={duration:400,ease:Sd,props:{scale:"+=0.1"}},rr=a_;U();var o_={BACKGROUND:1,FIREWORKS:5,ITEM:10,LOGO:15,BUTTON:20,TILE:25,TEXT:30,EFFECT:32,BOMB:34,ROCKET:35,ENCOURAGING:38,MESSAGE:40,POPUP:45,PRIORITY:80,DEBUG:90,ON_TOP:1e4},$=o_;U();var h_={TILE_SELECT:"tile_select",COMBO_1:"combo_1",COLLECT_STARS:"collect_stars",INVALID_MATCH:"invalid_match",COMBO_2:"combo_2",COMBO_3:"combo_3",COMBO_4:"combo_4",COMBO_5:"combo_5",SHUFFLE_ITEM:"shuffle_item",HINT_ITEM:"hint_item",THREE_STARS:"three_stars",PROGRESS_STAR:"progress_star",BOMB_DEFUSE:"bomb_defuse",ROCKET_FLY:"rocket_fly",BOMB_EXPLODE_1:"bomb_explode_1",TICKING_BOMB_BEFORE_EXPLODE:"ticking_bomb_before_explode",EXTRA_TILE_SPAWN:"extra_tile_spawn",CLOSE_POPUP_CLICK:"close_popup_click",GENERAL_BUTTON_CLICK:"use_item_click",CLICKS:"clicks",GIFT_CHARGE:"gift_charge",GIFT_EXPLODE:"gift_explode",GIFT_REVEAL:"gift_reveal",DAILY_REWARD:"daily_reward",LEVEL_START:"level_start",LEVEL_COMPLETE:"level_complete",LEVEL_FAIL:"level_fail",RESCUE_TIMER:"rescue_timer",WHEEL_CLICK:"wheel_click",WHEEL_GET_COMMON:"wheel_get_common",WHEEL_GET_SPECIAL:"wheel_get_special"},ut=h_;U();var J=class{static runTween(e,t){if(t===void 0){e.hasStarted?e.restart():e.play();return}if(t.aborted){e.stop();return}let i=()=>e.stop(),s=()=>t.off(i);t.once(i),e.once(Phaser.Tweens.Events.TWEEN_COMPLETE,s),e.once(Phaser.Tweens.Events.TWEEN_STOP,s),e.hasStarted?e.restart():e.play()}static runTweenAsync(e){return new Promise(t=>{e.off(Phaser.Tweens.Events.TWEEN_COMPLETE,t),e.once(Phaser.Tweens.Events.TWEEN_COMPLETE,t),e.hasStarted?e.restart():e.play()})}},l_=class extends Phaser.GameObjects.Container{useSound=!0;isClicked=!1;scaleUp=1;scaleDown=.985;button;upAnimation;downAnimation;isUsePixelPerfect=!1;hitArea;hitZone;hitSoundEffectKey=ut.GENERAL_BUTTON_CLICK;scaleDownPress;constructor(e,t,i,s,n,r=!1){super(e),this.isUsePixelPerfect=r,this.setDepth($.BUTTON),this.createButton(t,i,s,n),this.updateSize(),this.listenEvents(),this.scene.add.existing(this)}listenEvents(){this.scene.events.on(Phaser.Scenes.Events.SLEEP,this.handleSceneSleep),this.once(Phaser.GameObjects.Events.DESTROY,this.handelObjectDestroy)}handelObjectDestroy=()=>{this.scene&&this.scene.events.off(Phaser.Scenes.Events.SLEEP,this.handleSceneSleep)};handleSceneSleep=()=>{this.scene&&this.scene.tweens.killTweensOf(this)};set onClick(e){this.isUsePixelPerfect?(this.hitArea=this.button,this.hitArea.setInteractive({useHandCursor:!0,pixelPerfect:!0})):(this.hitArea=this.hitZone,this.updateSize(),this.hitArea.setInteractive({useHandCursor:!0})),this.hitArea.off(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN),this.hitArea.off(Phaser.Input.Events.GAMEOBJECT_POINTER_UP),this.hitArea.off(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handlePointerDown),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleOnClick(e)),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handlePointerOut)}get isUsePixelPerFect(){return this.isUsePixelPerfect}getTargetScaleUp(){return this.scaleUp}getTargetScaleDown(){return this.scaleDown}setTargetScaleUp(e){this.scaleUp=e}setTargetScaleDown(e){this.scaleDown=e}handlePointerDown=()=>{this.isClicked||this.upAnimation?.isPlaying()||(this.isClicked=!0,this.runDownAnimation())};handleOnClick=e=>()=>{this.isClicked&&(this.upAnimation?.isPlaying()||(this.isClicked=!1,this.runUpAnimation(),this.upAnimation?.once(Phaser.Tweens.Events.TWEEN_COMPLETE,()=>{qi.trackButtonClick(this.name),this.processCallback(e)})))};handlePointerOut=()=>{this.isClicked&&(this.upAnimation?.isPlaying()||(this.isClicked=!1,this.runUpAnimation()))};processCallback(e){this.upAnimation?.stop(),this.downAnimation?.stop(),this.scene?.tweens.killTweensOf(this),this.setScale(this.scaleUp),e()}setDisabled(e){e?(this.setAlpha(.5),this.hitArea?.disableInteractive()):(this.setAlpha(1),this.hitArea?.setInteractive())}createButton(e,t,i,s){this.button=this.scene.add.image(0,0,e,t),i&&s&&this.button.setWorldSize(i,s);let{displayWidth:n,displayHeight:r}=this.button;this.hitZone=this.scene.make.zone({width:n,height:r}),this.add([this.button,this.hitZone])}updateSize(){let{width:e,height:t}=this.button,i=10,s=e/100*10,n=t/100*10,r=s<i?s:i,o=n<i?n:i;this.setSize(e+r,t+o),this.hitZone.setSize(e+r,t+o)}runDownAnimation(){this.useSound&&nt.playSound(this.hitSoundEffectKey),this.downAnimation?.remove(),this.downAnimation=this.scene.tweens.add({...Hs,targets:[this],duration:150,props:{scale:this.scaleDown},onUpdate:()=>{this.hitZone.scale=1/this.scale}}),J.runTween(this.downAnimation)}runUpAnimation(){this.upAnimation?.remove(),this.upAnimation=this.scene.tweens.add({...rr,targets:[this],duration:150,props:{scale:this.scaleUp},onUpdate:()=>{this.hitZone.scale=1/this.scale}}),J.runTween(this.upAnimation)}setButtonHitSoundEffect(e){this.hitSoundEffectKey=e}},At=l_,{Utils:{Signal:u_}}=Ludex,to=class extends At{content;highlightAnimController=new u_.SignalController;useHighlight=!1;highlightScaleRange=[1,1.05];constructor(e,t,i){super(e,t,i),this.content=this.createContent(),this.content.add(this.button)}createContent(){let e=this.scene.add.container();return e.setSize(this.width,this.height),this.add(e),e}playHighlightAnimation(){this.useHighlight||(this.useHighlight=!0,this.runHighlightAnimation())}stopHighlightAnimation(){this.useHighlight&&(this.useHighlight=!1,this.runHighlightExitAnimation())}runHighlightAnimation(){let e=this.highlightAnimController.renew(),[t,i]=this.highlightScaleRange;J.runTween(this.scene.tweens.add({targets:this.content,props:{scale:{from:t,to:i}},paused:!0,duration:600,ease:Phaser.Math.Easing.Cubic.InOut,repeatDelay:200,yoyo:!0,repeat:-1}),e)}runHighlightExitAnimation(){let e=this.highlightAnimController.renew();J.runTween(this.scene.tweens.add({targets:this.content,props:{scale:1},paused:!0,duration:150,ease:Phaser.Math.Easing.Cubic.Out}),e)}runDownAnimation(){super.runDownAnimation(),this.runHighlightExitAnimation()}runUpAnimation(){super.runUpAnimation(),this.useHighlight&&this.runHighlightAnimation()}};U();var c_={duration:600,ease:Phaser.Math.Easing.Quadratic.Out,props:{alpha:0}},Nt=c_;U();var d_={duration:400,ease:Phaser.Math.Easing.Back.Out,props:{y:{from:250,to:0},scale:{from:.9,to:1},alpha:{start:0,from:0,to:1}}},se=d_;U(),U();var p_={duration:600,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:1}},ar=p_,{event:eo}=codex,{Utils:{Valid:g_}}=Ludex,f_=class extends Phaser.GameObjects.Container{zone;background;Ri;async animateBackgroundAlpha(e,t=400){this.scene&&(this.Ri?.remove(),this.Ri=this.scene.tweens.add({...ar,targets:[this.background],props:{alpha:e+.05},duration:t,paused:!0}),await J.runTweenAsync(this.Ri))}constructor(e,t){super(e),this.setName(t);let{width:i,height:s}=lt.getWorldSize();this.setWorldSize(i,s),this.pr(),this.gr(),this.registerEvents(),this.kill()}registerEvents(){eo.on(yt.VIEW_RESIZED,this.Ae),eo.on(yt.LAYOUT_CHANGED,this.Ae)}unregisterEvents(){eo.off(yt.VIEW_RESIZED,this.Ae),eo.off(yt.LAYOUT_CHANGED,this.Ae)}destroy(){this.unregisterEvents(),super.destroy()}open(e){this.revive(),g_.isObject(e)&&(this.setDataEnabled(),this.setData(e)),this.scene.children.bringToTop(this),this.Ae()}close(){this.kill()}incY(e){this.y+=e,this.background.y-=e}incX(e){this.x+=e,this.background.x-=e}incScale(e){this.scale+=e,this.background.scale-=e^e*(100/e)}pr(){this.zone=this.scene.add.zone(0,0,0,0),this.zone.setWorldSize(this.width,this.height),this.zone.setInteractive(),this.add(this.zone)}gr(){let e="screen-background";if(!this.scene.textures.exists(e)){let t=this.width+2,i=this.height+2,s=this.scene.add.graphics();s.fillStyle(0,1),s.fillRect(0,0,t,i),s.generateTexture(e,t,i),s.destroy()}this.background=this.scene.add.image(0,0,e),this.background.setWorldSize(this.width,this.height),this.add(this.background)}Ae=()=>{let{width:e,height:t}=lt.getWorldSize();this.setWorldSize(e,t),this.zone.setSize(this.width,this.height),this.background.setWorldSize(this.width,this.height)}},ue=f_;U();var m_={SCREEN:200,POPUP:300,PRIORITY:999},me=m_;U(),U();var v_={FONT_FAMILY:'"Noto Sans",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif'},E_=v_,y_=1,or=18,Ad={CLIP:"clip",ELLIPSIS:"ellipsis"},T_=class kp{static _instance;static get inst(){return this._instance||(this._instance=new kp),this._instance}static getModSize(t,i=y_){return t*i}static createText(t,i,s=or){return t.make.text({text:i,padding:{left:2,right:2,top:1,bottom:1},origin:{x:.5,y:.5},style:{fontSize:`${s}px`,fontStyle:"600",fontFamily:E_.FONT_FAMILY}})}static createShadowText(t,i,s=or){return this.createText(t,i,s).setShadow(0,1,"#2e2e2e",1).setPadding(2,1,2,4)}static createStrokeText(t,i,s=or){return this.createText(t,i,s).setStroke("#2e2e2e",2).setPadding(3,2,3,2)}static createUnderlineText(t,i,s=or){if(!i)return this.createText(t,"",s);let n=this.createText(t,"_",s),r=this.getUnderscoreWidth(n),o=this.getTextWidthForUnderscore(n,i),a=Math.ceil(o/r),h=-(s*.9);return n.setLineSpacing(h),n.setText(`${i}
${"_".repeat(a)}`),n}static getUnderscoreWidth(t){t.setText("_".repeat(5));let{left:i=0,right:s=0}=t.padding;return(t.getBounds().width-i-s)/5}static getTextWidthForUnderscore(t,i){t.setText(i);let{left:s=0,right:n=0}=t.padding;return t.getBounds().width-s-n}static applyShadow(t,i="#2e2e2e",s=0,n=3,r=.5){return t.setShadow(s,n,i,r)}static applyGreenStyle(t){this.applyShadow(t,"#3e770f");let i=this.calcStrokeWidth(t,.75);return t.setTint(16777215,16777215,13231515,13231515).setStroke("#3e770f",i)}static applyBlueStyle(t){this.applyShadow(t,"#1f778f");let i=this.calcStrokeWidth(t,.75);return t.setTint(16777215,16777215,9492713,9492713).setStroke("#1f778f",i)}static applyOrangeStyle(t){this.applyShadow(t,"#a66919");let i=this.calcStrokeWidth(t,.75);return t.setTint(16777215,16777215,16769946,16769946).setStroke("#a66919",i)}static applyBrownStyle(t){let i=this.calcStrokeWidth(t);return t.setTint(16777215,16777215,16380124,16380124).setStroke("#a46b21",i)}static applyYellowStyle(t){return this.applyShadow(t,"#4a260f",0,2),t.setTint(16374700)}static applyWoodStyle(t){return t.setTint(10243599)}static applyWarningStyle(t){let i=this.calcStrokeWidth(t);return t.setTint(16772490).setStroke("#784225",i)}static applyRedStyle(t){let i=this.calcStrokeWidth(t);return t.setTint(16509563,16509563,16307499,16307499).setStroke("#ff0000",i)}static calcStrokeWidth(t,i=1){let{fontSize:s}=t.style,n=or;return typeof s=="string"&&(n=+s.replace("px","")),n*.2*i}static setTruncateOverflow(t,i,s=Ad.ELLIPSIS){return t.setWordWrapWidth(i).setWordWrapCallback(kp.applyTruncate(s))}static applyTruncate=(t=Ad.ELLIPSIS)=>(i,s)=>{let{wordWrapWidth:n}=s.style,r=n??0,o=s.context,a=t===Ad.CLIP?"":"...";if(o.measureText(i).width<=r)return i;let h=i;for(;o.measureText(`${h}${a}`).width>r;)h=h.slice(0,-1);return`${h}${a}`}},X=T_;U();var x_=class DR{static _instance;static get inst(){return this._instance||(this._instance=new DR),this._instance}static alignChildTopLeft(t,i,s=0,n=0){let r=i.x,o=i.y;Phaser.Display.Align.In.TopLeft(t,i,s+r,n+o)}static alignChildTopRight(t,i,s=0,n=0){let r=i.x,o=i.y;Phaser.Display.Align.In.TopRight(t,i,s+r,n+o)}static alignChildBottomLeft(t,i,s=0,n=0){let r=i.x,o=i.y;Phaser.Display.Align.In.BottomLeft(t,i,s-r,n-o)}static alignChildBottomRight(t,i,s=0,n=0){let r=i.x,o=i.y;Phaser.Display.Align.In.BottomRight(t,i,s-r,n-o)}static alignChildCenter(t,i,s=0,n=0){let r=i.x,o=i.y;Phaser.Display.Align.In.Center(t,i,s-r,n-o)}static alignChildLeftCenter(t,i,s=0,n=0){let r=i.x,o=i.y;Phaser.Display.Align.In.LeftCenter(t,i,s-r,n-o)}static alignChildRightCenter(t,i,s=0,n=0){let r=i.x,o=i.y;Phaser.Display.Align.In.RightCenter(t,i,s-r,n-o)}static alignChildTopCenter(t,i,s=0,n=0){let r=i.x,o=i.y;Phaser.Display.Align.In.TopCenter(t,i,s+r,n+o)}static alignChildBottomCenter(t,i,s=0,n=0){let r=i.x,o=i.y;Phaser.Display.Align.In.BottomCenter(t,i,s-r,n-o)}static alignChildrenContainer(t,i){let{width:s=-1,height:n=-1,x:r=0,y:o=0}=i,a=s!==-1,h=n!==-1;if(a){let l=s/(t.length-1);Phaser.Actions.GridAlign(t,{height:1,cellWidth:l,cellHeight:0,x:r-s/2,y:o,position:Phaser.Display.Align.LEFT_CENTER})}else if(h){let l=n/(t.length-1);Phaser.Actions.GridAlign(t,{width:1,cellWidth:0,cellHeight:l,x:r,y:o-n/2})}}},it=x_,{KEY:Ji,FRAME:Qi}=G.DEFAULT,{MaxRescueCount:S_,RescueGamePopupTimeout:Iw}=Lt,{event:wd}=codex,A_=class extends ue{bi;we;Ce;t;Mt;ee;Pe;Nt;Xe;Ke;je;se;Bt;Bs;Ut;ut;Ii;gt;st;constructor(e,t){super(e,t),this.we="",this.Xe=1400,this.Nt=S_,this.setDepth(me.POPUP),this._i(),this.fr()}open=e=>{super.open(),this.se.clearMask(),this.Ce=!1,this.Nt=Iw,this.Oi(this.Nt),this.bi=e.level,this.we=e.reason,this.mr(e.reason),this.et(),wd.emit(j.PAUSE)};close(){this.je?.remove(),super.close()}Rt=async()=>{try{if(this.Ce)return;if(this.Ce=!0,this.Ke.pause(),this.je?.remove(),this.Pe?.remove(),!await pt.showRewardVideoAdAsync())throw new Error("Failed to show rewarded video ad");nt.playSound(ut.DAILY_REWARD),this.l(),wd.emit(j.RESUME),this.st?.once(Phaser.Tweens.Events.TWEEN_COMPLETE,()=>{wd.emit(j.CONTINUE,{reason:this.we})})}catch{this.Pe?.remove(),this.Ke.pause(),this.l(),ot.openScreen(mt.RESCUE_SCREEN,{level:this.bi,reason:this.we}),this.Ce=!1}};_i(){this.$(),this.vr(),this.Er(),this.Mi(),this.Li()}$(){this.t=this.scene.add.container(0,0),this.t.setSize(292,374);let e=this.scene.make.image({key:Ji,frame:Qi.POPUP}),t=this.scene.make.image({key:Ji,frame:Qi.CONTINUE_TEXT});Phaser.Display.Align.In.TopCenter(t,e,4,-23),this.t.add([e,t]),this.add(this.t);let i=pt.getBannerHeight()/2;Phaser.Display.Align.In.Center(this.t,this.zone,0,-i)}vr(){this.ee=X.createText(this.scene,"",53),X.applyWarningStyle(this.ee),this.Oi(this.Nt)}yr(){let e={loop:!0,delay:this.Xe,callback:this.Tr};this.Pe=this.scene.time.addEvent(e),this.xr()}Di(e){let{translateX:t,translateY:i}=this.se.getWorldTransformMatrix().decomposeMatrix();if(this.Bt.setPosition(t,i),this.Bt.clear(),e===0)return;this.Bt.fillStyle(16777215,0);let s=-Math.PI/2,n=3*Math.PI/2-Phaser.Math.DegToRad(360-e);this.Bt.slice(0,0,80,s,n,!1),this.Bt.fillPath()}Oi(e){this.ee.setText(`${e}`)}Er(){this.se=this.scene.make.image({key:Ji,frame:Qi.PROGRESS_CIRCLE});let e=this.scene.make.image({key:Ji,frame:Qi.PROGRESS_CIRCLE_BG});this.Bt=this.scene.make.graphics({}),this.Bs=this.Bt.createGeometryMask(),it.alignChildCenter(this.se,this.t,0,-40),it.alignChildCenter(e,this.t,0,-40),Phaser.Display.Align.In.Center(this.ee,e,0,0),this.t.add([e,this.se])}xr(){this.Di(360),this.se.setMask(this.Bs),this.Ke=this.scene.tweens.addCounter({from:360,to:0,duration:Iw*this.Xe,onUpdate:e=>{let t=+e.getValue().toFixed(2);this.Di(t)},onComplete:()=>{this.Di(0),this.je?.remove()}}),this.Us(),this.je=this.scene.time.addEvent({repeat:3,delay:this.Xe,callback:this.Us})}Us=()=>{nt.playSound(ut.RESCUE_TIMER,{volume:1.5})};Mi(){this.Ut=X.createText(this.scene,"",18),X.applyWarningStyle(this.Ut)}mr(e){switch(e){case"bombExplosive":this.Ut.setText("The bomb exploded!");break;case"timeUp":this.Ut.setText("Time is up!");break;default:this.Ut.setText("You have failed the level!")}it.alignChildCenter(this.Ut,this.t,0,57)}Li(){this.ut=new to(this.scene,Ji,Qi.BUTTON_GREEN),this.ut.setName("Continue"),this.Ii=this.scene.make.image({key:Ji,frame:Qi.BUTTON_FRAME}),this.ut.onClick=this.Rt;let e=this.scene.add.image(0,0,Ji,Qi.ICON_ADS);Phaser.Display.Align.In.Center(e,this.ut,-60),this.ut.content.add(e);let t=X.createText(this.scene,"Continue",20).setFontStyle("700");X.applyGreenStyle(t),t.setOrigin(.35,.75),this.ut.content.add(t),t.setPosition(1,6),it.alignChildBottomCenter(this.ut,this.t,0,-40),Phaser.Display.Align.In.Center(this.Ii,this.ut,0,-1)}Tr=()=>{if(this.Nt-=1,this.Oi(this.Nt),this.Nt<=0){this.Pe?.remove(),this.Ke.complete(),this.Sr();return}};Sr(){this.scene.time.delayedCall(800,()=>{this.l(),this.Ce||this.st?.once(Phaser.Tweens.Events.TWEEN_COMPLETE,()=>{ot.openScreen(mt.RESCUE_SCREEN,{level:this.bi,reason:this.we})})})}ki(){this.ut.playHighlightAnimation()}fr(){this.Mt=this.scene.add.group(),this.Mt.addMultiple([this.ee,this.Ut,this.Ii,this.ut]),this.t.add(this.Mt.getChildren())}et(){this.gt?.isPlaying()||(this.background.setAlpha(0),this.animateBackgroundAlpha(.8),this.ft(0,400))}l(){this.st?.isPlaying()||(this.animateBackgroundAlpha(0,200),this.ht(0,200))}ft(e,t){let i=pt.getBannerHeight()/2;this.gt=this.scene.tweens.add({...se,targets:[this.t],delay:e,duration:t,props:{...se.props,y:{from:350-i,to:-i},alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:1}},onComplete:()=>{this.yr(),this.ki()}}),J.runTween(this.gt)}ht(e,t){let i=pt.getBannerHeight()/2;this.st=this.scene.tweens.add({...Nt,targets:[this.t],delay:e,duration:t,props:{...Nt.props,y:250-i,scale:0},onComplete:()=>{this.t.setY(0),ot.closeScreen(this.name)}}),J.runTween(this.st)}},w_=A_;U(),U(),U();var{KEY:io,FRAME:so}=G.DAILY_MISSIONS,C_=class extends Phaser.GameObjects.Container{process;minProcess;maxProcess;progressBoxBg;progressBarLeft;progressBarBg;progressBarRight;progressAnimation;constructor(e){super(e),this.setWorldSize(90,14),this.process=0,this.minProcess=0,this.maxProcess=1,this.createProgressBox(),this.createProgressBar(),this.createContainer()}setProcess(e,t=!1){if(this.process=this.getCorrectValue(e),!this.scene||t){this.updateProcess();return}this.runProcessAnimation(e)}updateProcess(){let{displayHeight:e}=this.progressBarBg,t=this.getDisplayWidthByProcess(this.process);this.progressBarBg.setWorldSize(t,e);let{x:i}=this.progressBarBg;this.progressBarRight.setX(i+t)}getCorrectValue(e){let t=e;return isFinite(t)||(t=0),t<this.minProcess&&(t=this.minProcess),t>this.maxProcess&&(t=this.maxProcess),t}getDisplayWidthByProcess(e){let{width:t}=this;return(t-12)*e}runProcessAnimation(e){this.progressAnimation?.stop(),this.progressAnimation=this.scene.add.tween({targets:[this.progressBarBg],duration:300,ease:Phaser.Math.Easing.Quadratic.InOut,props:{displayWidth:()=>{let t=this.getCorrectValue(e);return this.getDisplayWidthByProcess(t)}},onStart:()=>{let{displayHeight:t}=this.progressBarBg,i=this.getDisplayWidthByProcess(this.process);this.progressBarBg.setWorldSize(i,t)},onUpdate:()=>{let{x:t,displayWidth:i}=this.progressBarBg;this.progressBarRight.setX(t+i)},onComplete:()=>{this.updateProcess()}})}createProgressBox(){this.progressBoxBg=this.scene.make.image({key:io,frame:so.PROGRESS_BAR,origin:{x:0,y:.5}}),Phaser.Display.Align.In.Center(this.progressBoxBg,this)}createProgressBar(){this.progressBarLeft=this.scene.make.image({key:io,frame:so.PROGRESS_LEFT,origin:{x:0,y:.5}}),this.progressBarRight=this.scene.make.image({key:io,frame:so.PROGRESS_RIGHT,origin:{x:0,y:.5}}),this.progressBarBg=this.scene.make.image({key:io,frame:so.PROGRESS_MIDDLE,origin:{x:0,y:.5}});let e=-1.5;Phaser.Display.Align.In.LeftCenter(this.progressBarBg,this,-5.8),Phaser.Display.Align.In.LeftCenter(this.progressBarLeft,this,e),Phaser.Display.Align.In.LeftCenter(this.progressBarRight,this,e),this.setProcess(0,!0)}createContainer(){this.add([this.progressBoxBg,this.progressBarBg,this.progressBarLeft,this.progressBarRight]),this.scene.add.existing(this)}},P_=C_;U();var{Plugins:{Analytics:{Events:{SHARE:_w}}}}=Ludex,R_=class kR{static _instance;static get inst(){return this._instance||(this._instance=new kR),this._instance}static async postBestScoreWideframe(){let{player:t,analytics:i,frameCapture:s}=codex;try{let{playerId:n,name:r,photo:o,data:a}=t.getPlayer(),{score:h}=a||{},{renderPostBestScore:l}=s.wideframe;if(!l)throw new Error("renderPostBestScore is not defined");let u=await l({playerId:n,playerPhoto:o,playerScore:h});this.validateImageRender(u),await FBInstant.shareAsync({text:"Great! I have a best score!",intent:"SHARE",image:u??"",data:{playerId:n,playerName:r,playerPhoto:o,type:"share_invite"}}),kt.addShareScoreMissionProgress(1),i.event(_w,{share_content_type:"BestScore",success:!0})}catch{i.event(_w,{share_content_type:"BestScore",success:!1})}}static validateImageRender(t){if(typeof t!="string"||!t)throw new Error("Invalid wideframe")}},Ow=R_,{KEY:zs,FRAME:mi}=G.DAILY_MISSIONS,{Utils:{Object:b_,Valid:Mw}}=Ludex,I_=class extends Phaser.GameObjects.Container{payload;process;isCompleted;background;titleText;processText;progressBar;claimButton;goButton;rewardedIcon;rewardValue;progressIcon;coinIcon;constructor(e,t){super(e),this.createBackground(),this.updateSize(),this.createTitle(),this.createProcessBar(),this.createProcessIcon(),this.createProcessStatus(),this.createClaimButton(),this.createGoButton(),this.createRewardIcon(),this.createRewardValue(),this.createRewardedIcon(),t&&this.updateInfo(t)}updateInfo(e){let{missionData:t,process:i,onClaim:s}=e;this.payload=t,this.process=i,this.onClaim=s,this.titleText.setText(t.title),this.rewardValue.setText(`${t.reward.coin}`);let n=`Claim:${Ludex.Utils.String.toUpperCamelCase(t.id)}`;this.claimButton.setName(n),this.assignGoButtonFunctionality(t.id),this.setName(`Task: ${t.id}`),this.updateData()}assignGoButtonFunctionality(e){if(e.includes("invite-friend")){this.goButton.onClick=this.handleInviteFriends;return}if(e.includes("join-tournament")){this.goButton.onClick=this.handleOpenTournamentScreen;return}if(e.includes("share-score")){this.goButton.onClick=this.handleShareScore;return}this.goButton.onClick=this.handlePlaySingle}setProcess(e){this.process=e,this.updateData()}getId(){return this.payload.id}set onClaim(e){this.claimButton.onClick=this.handleOnClaim(e),this.updateData()}handleOnClaim=e=>()=>{this.rewardedIcon.revive(),this.claimButton.kill();let{id:t,reward:i}=this.payload,{x:s,y:n}=this.rewardedIcon.getWorldPosition();nt.playSound(ut.GIFT_EXPLODE,{volume:.3}),kt.setMissionRewardClaimed(t);let r=Object.keys(i);for(let o of r){let a=i[o];e({type:o,value:a,claimButtonX:s,claimButtonY:n})}};getProcessValue(){let{require:e}=this.payload;if(!Mw.isObject(e))return{current:0,target:0};let t=Object.keys(e),i=0,s=0;for(let n of t){if(!b_.hasOwn(e,n))continue;let r=e[n];if(!Mw.isNumber(r))continue;i=r;let o=this.process.require[n];s=typeof o=="number"?o:0}return{current:s,target:i}}updateData=()=>{let{current:e,target:t}=this.getProcessValue(),i=e/t;this.progressBar.setProcess(i,!0);let s=kt.getMissionProgressIcon(this.payload.id);if(this.progressIcon.setFrame(s),this.alignProcessIcon(),this.setProcessText(e,t),this.isCompleted=e>=t&&!this.process?.rewarded,this.isCompleted){this.claimButton.revive(),this.goButton.kill(),this.rewardedIcon.kill(),this.coinIcon.revive(),this.rewardValue.revive();return}if(this.process?.rewarded){this.claimButton.kill(),this.goButton.kill(),this.rewardedIcon.revive(),this.coinIcon.kill(),this.rewardValue.kill();return}this.claimButton.kill(),this.goButton.revive(),this.rewardedIcon.kill(),this.coinIcon.revive(),this.rewardValue.revive()};setProcessText(e,t){this.processText.setText(`${e>t?t:e}/${t}`)}createRewardedIcon(){this.rewardedIcon=this.scene.make.image({key:zs,frame:mi.ICON_CHECK}),this.add(this.rewardedIcon),Phaser.Display.Align.In.RightCenter(this.rewardedIcon,this.background,-35,-1.5),this.rewardedIcon.kill()}createBackground(){this.background=this.scene.make.image({key:zs,frame:mi.BLOCK}),this.add(this.background)}updateSize(){let{width:e,height:t}=this.background;this.setSize(e,t)}createTitle(){this.titleText=X.createText(this.scene,"",9).setWordWrapWidth(90).setOrigin(0,.5).setLineSpacing(-2).setTint(8406559),this.add(this.titleText),Phaser.Display.Align.In.LeftCenter(this.titleText,this.background,-58,-10)}createProcessBar(){this.progressBar=new P_(this.scene),this.add(this.progressBar),Phaser.Display.Align.In.Center(this.progressBar,this.background,-22,10)}createProcessIcon(){this.progressIcon=this.scene.make.image({key:zs,frame:mi.MISSION_HINT,origin:{x:.5,y:.5}}),this.add(this.progressIcon),Phaser.Display.Align.In.LeftCenter(this.progressIcon,this.background,-15,-2)}createProcessStatus(){this.processText=X.createText(this.scene,"",9).setShadow(0,1,"#000000",1).setFontStyle("700"),this.add(this.processText),Phaser.Display.Align.In.Center(this.processText,this,-21,10)}createClaimButton(){this.claimButton=new At(this.scene,zs,mi.GREEN_BUTTON);let e=X.createText(this.scene,"Claim",12).setFontStyle("800");X.applyGreenStyle(e),this.claimButton.add(e),Phaser.Display.Align.In.Center(e,this.claimButton),this.add(this.claimButton),Phaser.Display.Align.In.RightCenter(this.claimButton,this,-6,-1.5)}createGoButton(){this.goButton=new At(this.scene,zs,mi.BLUE_BUTTON);let e=X.createText(this.scene,"Go",12).setFontStyle("800");X.applyBlueStyle(e),this.goButton.add(e),Phaser.Display.Align.In.Center(e,this.goButton),this.add(this.goButton),Phaser.Display.Align.In.RightCenter(this.goButton,this,-6,-1.5)}createRewardIcon(){this.coinIcon=this.scene.make.image({key:zs,frame:mi.COIN}),this.add(this.coinIcon),Phaser.Display.Align.In.Center(this.coinIcon,this.background,43,-3)}createRewardValue(){this.rewardValue=X.createText(this.scene,"",13).setOrigin(.5,0).setFontStyle("700"),X.applyOrangeStyle(this.rewardValue),this.add(this.rewardValue),Phaser.Display.Align.In.Center(this.rewardValue,this.coinIcon,0,10)}alignProcessIcon(){let{name:e}=this.progressIcon.frame;switch(e){case mi.MISSION_BOMB_DEFUSE:case mi.MISSION_SHARE_SCORE:this.progressIcon.setOrigin(.6,.5);break;case mi.MISSION_JOIN_TOURNAMENT:this.progressIcon.setOrigin(.52,.5);break;default:this.progressIcon.setOrigin(.5,.5);break}}handlePlaySingle=async()=>{await ht.startSingleModeAsync()&&It.switchToGameScene()};handleOpenTournamentScreen=async()=>{ot.closeScreen(mt.DAILY_MISSIONS_SCREEN),ot.openScreen(mt.TOURNAMENTS_SCREEN)};handleShareScore=async()=>{try{ot.showLoadingScreen(),await Ow.postBestScoreWideframe()}catch{}finally{ot.closeLoadingScreen()}};handleInviteFriends=async()=>{await ht.autoChallengeModeAsync()&&It.switchToGameScene()};async runShowItemAnimation(e,t){return this.scene.tweens.killTweensOf(this),this.setScale(1),this.setAlpha(0),new Promise(i=>{this.scene.tweens.add({targets:this,duration:t,delay:e,props:{alpha:{duration:500,value:{start:0,from:0,to:1},ease:Phaser.Math.Easing.Cubic.Out},scale:{duration:800,start:.8,end:1,value:{start:.8,from:.8,to:1},ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]}},onComplete:()=>{i()},onStop:()=>{i()}})})}},Lw=I_;U(),U(),U(),U();function __(e,t,i,s){return t+(e-t)*Math.exp(-i*s)}U();var no={SCROLL:"scroll",SCROLL_VALUE_CHANGED:"scroll-value-changed"},O_=class Fp extends Phaser.GameObjects.Container{config;content;currentResponse=0;targetY=0;lastVelocityY={value:0,timeStamp:0};isScrolling=!1;static parseMaxScrollOver(t){let{maxOverScroll:i}=t,s=.15*t.size.height;return i===void 0?{top:s,bottom:s}:typeof i=="number"?{top:i,bottom:i}:{top:i.top??s,bottom:i.bottom??s}}static parseConfig(t){return{contentSize:{...t.size},response:Phaser.Math.Clamp(t.response??25,1,25),flickResponse:Phaser.Math.Clamp(t.flickResponse??3,1,25),distancePerScrollWheel:.5,flickVelocityMultiplier:5,flickTimeOut:20,sticky:t.sticky??"top",...t,maxOverScroll:Fp.parseMaxScrollOver(t)}}constructor(t,i){super(t),this.config=Fp.parseConfig(i);let{size:{width:s,height:n},contentSize:{width:r,height:o},response:a}=this.config;this.currentResponse=a,this.setSize(s,n),this.content=this.scene.make.container({}),this.content.setSize(r,o),this.add(this.content),this.setScrollInteractive(),this.listenToEvents(),this.scene.add.existing(this)}setContentHeight(t){let i=this.content.y,s=(t-this.content.height)/2,n=i+s,r=this.targetY+s;this.content.setWorldSize(this.width,t),this.content.setY(n),this.targetY=r}scrollToTop(t=!1){this.internalScrollToTop(t),this.emitOnScrollValueChangedEvent()}internalScrollToTop(t=!1){this.targetY=this.getYAtTop(),t?(this.content.y=this.targetY,this.isScrolling=!1):this.isScrolling=!0}scrollToBottom(t=!1){this.internalScrollToBottom(t),this.emitOnScrollValueChangedEvent()}internalScrollToBottom(t=!1){this.targetY=this.getYAtBottom(),t?(this.content.y=this.targetY,this.isScrolling=!1):this.isScrolling=!0}scrollTo(t,i=!1){this.internalScrollTo(t,i),this.emitOnScrollValueChangedEvent()}internalScrollTo(t,i=!1){this.targetY=t,i?(this.content.y=t,this.isScrolling=!1):this.isScrolling=!0}reset(t=!1){this.targetY=0,t?(this.content.y=0,this.isScrolling=!1):this.isScrolling=!0}setEnabled(t=!0){this.setScrollInteractive(t)}internalUpdate(t,i){if(this.isScrolling)if(Math.abs(this.targetY-this.content.y)<.01)this.content.y=this.targetY,this.isScrolling=!1;else{let s=this.currentResponse,n=i/1e3,r=__(this.content.y,this.targetY,s,n);this.content.y=r}}update(t,i){this.internalUpdate(t,i),this.emitOnScrollValueChangedEvent()}preDestroy(){super.preDestroy(),this.unlistenToEvents()}getStickyY(){let{sticky:t}=this.config;return t==="top"?this.getYAtTop():t==="bottom"?this.getYAtBottom():0}setScrollInteractive(t=!0){t?this.setInteractive({draggable:!0,useHandCursor:!0}):this.disableInteractive()}listenToEvents(){this.on(Phaser.Input.Events.POINTER_WHEEL,this.onMouseScroll,this),this.on(Phaser.Input.Events.GAMEOBJECT_DRAG,this.onTouchScroll,this),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.onTouchDown,this),this.scene.input.on(Phaser.Input.Events.POINTER_UP,this.onTouchEnd,this),this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.update,this)}unlistenToEvents(){this.off(Phaser.Input.Events.POINTER_WHEEL,this.onMouseScroll,this),this.off(Phaser.Input.Events.GAMEOBJECT_DRAG,this.onTouchScroll,this),this.off(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.onTouchDown,this),this.scene.input.off(Phaser.Input.Events.POINTER_UP,this.onTouchEnd,this),this.scene.events.off(Phaser.Scenes.Events.UPDATE,this.update,this)}emitOnScrollEvents(t,i){this.emit(no.SCROLL,{scroller:this,value:t,delta:i})}emitOnScrollValueChangedEvent(){this.emit(no.SCROLL_VALUE_CHANGED,{scroller:this})}calcDistUnderTop(t){return(t??this.content.y)-this.content.height*.5- -this.height*.5}calcDistAboveBottom(t){let i=t??this.content.y;return this.height*.5-(i+this.content.height*.5)}getYAtTop(t=!1){let i=t?this.config.maxOverScroll.top:0;return this.content.height*.5-this.height*.5+i}getYAtBottom(t=!1){let i=t?this.config.maxOverScroll.bottom:0;return-this.content.height*.5- -this.height*.5-i}onMouseScroll(t,i,s){this.isScrolling=!0,this.currentResponse=this.config.response;let n=-s*this.config.distancePerScrollWheel*lt.getZoomRatio(),r=this.targetY+n;if(this.height>=this.content.height){r=this.getStickyY(),this.targetY=r,this.emitOnScrollEvents(this.targetY,n);return}let o=this.calcDistUnderTop(r),a=this.calcDistAboveBottom(r);o>0&&(r=this.getYAtTop()),a>0&&(r=this.getYAtBottom()),this.targetY=r,this.emitOnScrollEvents(this.targetY,n)}onTouchScroll(t){this.isScrolling=!0,this.currentResponse=this.config.response;let{position:i,prevPosition:s,velocity:n}=t,r=(i.y-s.y)/lt.getZoomRatio();this.lastVelocityY={value:Math.abs(n.y)>100?n.y*this.config.flickVelocityMultiplier:0,timeStamp:Date.now()};let o=this.targetY+r;if(this.height>=this.content.height){let l=Math.min((this.height-this.content.height)/2*.8,this.config.maxOverScroll.top,this.config.maxOverScroll.bottom),u=this.getStickyY();u-l<o&&o<u+l?o=this.targetY+r/2:o=Phaser.Math.Clamp(o,u-l,u+l),this.targetY=o,this.emitOnScrollEvents(this.targetY,r);return}let a=this.calcDistUnderTop(o),h=this.calcDistAboveBottom(o);a>0&&(a<this.config.maxOverScroll.top?o=this.targetY+r/2:o=this.getYAtTop(!0)),h>0&&(h<this.config.maxOverScroll.bottom?o=this.targetY+r/2:o=this.getYAtBottom(!0)),this.targetY=o,this.emitOnScrollEvents(this.targetY,r)}onTouchDown(){this.isScrolling&&(this.targetY=this.content.y),this.isScrolling=!0}onTouchEnd(){this.isScrolling=!0;let t=this.calcDistUnderTop(this.targetY),i=this.calcDistAboveBottom(this.targetY);if(Math.abs(this.lastVelocityY.value)>0&&Math.abs(Date.now()-this.lastVelocityY.timeStamp)<this.config.flickTimeOut&&i<=0&&t<=0){let s=this.targetY+this.lastVelocityY.value;this.targetY=s,this.lastVelocityY={value:0,timeStamp:0},this.currentResponse=this.config.flickResponse}if(this.height>=this.content.height){this.targetY=this.getStickyY();return}if(t=this.calcDistUnderTop(this.targetY),i=this.calcDistAboveBottom(this.targetY),t>0){this.targetY=this.getYAtTop();return}i>0&&(this.targetY=this.getYAtBottom())}},M_=O_,L_=class mn extends M_{visualConfig;boundTop;boundBottom;maskGraphics;objects;contentDebug;static parseMarginConfig(t){let{margin:i}=t.visual??{},s=0;return i===void 0?{top:s,bottom:s}:typeof i=="number"?{top:i,bottom:i}:{top:i.top??s,bottom:i.bottom??s}}static parseBoundsConfig(t){let{bounds:i=!1}=t.visual??{};return typeof i!="boolean"?{key:G.DEFAULT.KEY,frame:G.DEFAULT.FRAME.BLANK,height:20,tint:9917991,...i}:i?{key:G.DEFAULT.KEY,frame:G.DEFAULT.FRAME.BLANK,height:20,tint:9917991}:!1}static parseBoundDetectionPaddingConfig(t){let{boundDetectionPadding:i}=t.visual??{},s=0;return i===void 0?{top:s,bottom:s}:typeof i=="number"?{top:i,bottom:i}:{top:i.top??s,bottom:i.bottom??s}}static parseVisualConfig(t){return{mask:!1,spacing:0,onEnterViewport:()=>{},onExitViewport:()=>{},...t.visual,margin:mn.parseMarginConfig(t),bounds:mn.parseBoundsConfig(t),boundDetectionPadding:mn.parseBoundDetectionPaddingConfig(t)}}static parseBaseConfig(t){let i=mn.parseVisualConfig(t),{contentSize:s={...t.size}}=t,n=s.width,r=s.height+i.margin.top+i.margin.bottom;return{visualConfig:i,contentSize:{width:n,height:r}}}constructor(t,i){let{visualConfig:s,contentSize:n}=mn.parseBaseConfig(i);super(t,{...i,contentSize:n}),this.visualConfig=s,this.createGroup(),this.visualConfig.mask&&this.createMask(),this.visualConfig.bounds&&this.createBounds(this.visualConfig.bounds.key,this.visualConfig.bounds.frame,this.visualConfig.bounds.height,this.visualConfig.bounds.tint)}addItems(...t){this.content.addAt(t),this.objects.addMultiple(t);let i=this.calcContentHeight();this.setContentHeight(i),this.updateObjectPosition(),this.updateObjectVisibility()}clearItem(){this.objects.clear(!0,!0),this.reset(!0)}getChildren(){return this.objects.getChildren().filter(t=>t.active)}updateMaskScale(t){this.visualConfig.mask&&this.maskGraphics.setScale(t)}internalScrollToTop(t){super.internalScrollToTop(t),this.updateObjectVisibility()}internalScrollToBottom(t){super.internalScrollToBottom(t),this.updateObjectVisibility()}scrollTo(t,i,s=!0){this.internalScrollTo(t,i,s),this.updateObjectVisibility()}internalScrollTo(t,i,s=!0){if(!s){super.internalScrollTo(t,i),this.updateObjectVisibility();return}if(this.height>=this.content.height){super.internalScrollTo(this.getStickyY(),i),this.updateObjectVisibility();return}let n=this.calcDistUnderTop(t),r=this.calcDistAboveBottom(t);if(n>0){super.internalScrollTo(this.getYAtTop(),i),this.updateObjectVisibility();return}if(r>0){super.internalScrollTo(this.getYAtBottom(),i),this.updateObjectVisibility();return}super.internalScrollTo(t,i),this.updateObjectVisibility()}internalUpdate(t,i){super.internalUpdate(t,i),this.isScrolling&&this.updateObjectVisibility()}updateMask(){let{x:t,y:i}=this.getWorldPosition();this.maskGraphics.setPosition(t,i)}createGroup(){this.objects=this.scene.make.group({})}createMask(){this.maskGraphics?.destroy(),this.maskGraphics=this.scene.make.graphics({fillStyle:{color:255,alpha:1}}),this.maskGraphics.setName("MaskGraphics");let t=this.width,i=this.height;this.maskGraphics.fillRoundedRect(0-t/2,0-i/2,t,i,0),this.setMask(this.maskGraphics.createGeometryMask()),this.scene.events.off(Phaser.Scenes.Events.UPDATE,this.updateMask,this),this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.updateMask,this)}createBounds(t,i,s,n){if(!(this.scene.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer))return;this.boundTop=this.scene.make.image({key:t,frame:i}),this.boundBottom=this.scene.make.image({key:t,frame:i}),this.boundTop.setTint(n),this.boundBottom.setTint(n),this.boundTop.setAlpha(1,1,0,0),this.boundBottom.setAlpha(0,0,1,1),this.boundTop.setDepth($.PRIORITY),this.boundBottom.setDepth($.PRIORITY);let r=this.width,o=s,{x:a,y:h}=this.getWorldPosition();this.boundTop.setDisplaySize(r,o),this.boundBottom.setDisplaySize(r,o),this.boundTop.setY(-this.displayHeight/2+o/2+h-this.y-1),this.boundBottom.setY(this.displayHeight/2-o/2+h-this.y+1),this.boundTop.setX(a-this.x),this.boundBottom.setX(a-this.x),this.add([this.boundTop,this.boundBottom])}updateObjectPosition(){let t=this.objects.getChildren(),i=-this.content.height/2+this.visualConfig.margin.top;for(let s of t)s.setPosition(0,i+s.height/2),i+=s.height+this.visualConfig.spacing}updateObjectVisibility(){let t=this.objects.getChildren(),i=-this.content.y-this.height/2+this.visualConfig.boundDetectionPadding.top,s=-this.content.y+this.height/2-this.visualConfig.boundDetectionPadding.bottom;for(let n of t){let r=n.y-n.height/2,o=n.y+n.height/2,a=r<s&&o>i;this.setObjectInViewport(n,a)}}setObjectInViewport(t,i){if(i){if(t.visible)return;t.setVisible(!0),this.visualConfig.onEnterViewport?.call(this,t)}else{if(!t.visible)return;this.visualConfig.onExitViewport?.call(this,t),t.setVisible(!1)}}calcContentHeight(){let t=this.objects.getChildren(),i=t.reduce((n,r)=>n+r.height,0),s=this.visualConfig.spacing*(t.length-1);return i+this.visualConfig.margin.top+this.visualConfig.margin.bottom+s}},ro=class extends L_{depthStrategy;ContentClassType;configs;objectUpdater;contentGameObjects=[];constructor(e,t){super(e,t),this.depthStrategy=t.reuse.depthStrategy??"none",this.ContentClassType=t.reuse.ClassType,this.configs=[...t.reuse.configs],this.objectUpdater=t.reuse.update,this.objects.classType=this.ContentClassType,this.setConfigs(this.configs)}reset(e=!1){super.reset(e),this.killAndHideAll()}getChildren(){let e=[];for(let t of this.contentGameObjects)t.gameObject!==void 0&&e.push(t.gameObject);return e}setConfigs(e){this.killAndHideAll(),this.configs=[...e],this.contentGameObjects=[];for(let t of e)this.contentGameObjects.push({config:t,gameObject:void 0});this.updateObjectVisibility()}addItems(...e){super.addItems(...e)}scrollToConfig(e,t=!1,i=!0){if(e<0||e>=this.configs.length)return;let s=this.getMaxObjectHeight(),n=-this.content.height/2+this.visualConfig.margin.top,r=s+this.visualConfig.spacing,o=-(n+e*r+s/2);this.scrollTo(o,t,i)}scrollToConfigWithTween(e,t=!1,i){if(e<0||e>=this.configs.length)return;let s=this.getMaxObjectHeight(),n=-this.content.height/2+this.visualConfig.margin.top,r=s+this.visualConfig.spacing,o=-(n+e*r+s/2);if(this.height>=this.content.height)o=this.getStickyY();else{let a=o;this.calcDistUnderTop(a)>0?o=this.getYAtTop():this.calcDistAboveBottom(a)>0&&(o=this.getYAtBottom())}if(this.content.y===o){this.updateObjectVisibility(),i?.();return}if(t){this.targetY=o,this.content.y=o,this.updateObjectVisibility(),i?.();return}this.targetY=o,this.isScrolling=!1,this.scene.add.tween({targets:[this.content],duration:1e3,props:{y:{getEnd:()=>this.targetY}},ease:Phaser.Math.Easing.Quintic.Out,onUpdate:()=>{this.updateObjectVisibility()},onComplete:()=>{this.content.y=o,this.targetY=o,this.isScrolling=!0,this.updateObjectVisibility(),i?.()}})}getMaxObjectHeight(){if(this.configs.length===0)return 1/0;let e=this.objects.getChildren();if(e.length!==0)return Math.max(...e.map(i=>i.height));this.setObjectActive(0);let t=this.contentGameObjects[0].gameObject?.height;return t===void 0?1/0:(this.setObjectInactive(0),t)}killAndHideAll(){for(let e=0;e<this.contentGameObjects.length;e++){let t=this.contentGameObjects[e];t.gameObject!==void 0&&(this.contentGameObjects[e]={config:t.config,gameObject:void 0},this.objects.killAndHide(t.gameObject))}}updateObjectPosition(){let e=this.configs,t=this.getMaxObjectHeight(),i=-this.content.height/2+this.visualConfig.margin.top;for(let s=0;s<e.length;s++){let n=this.contentGameObjects[s].gameObject;n!==void 0&&n.setPosition(0,i+t/2),i+=t+this.visualConfig.spacing}}updateObjectVisibility(){let e=this.configs,t=-this.content.y-this.height/2+this.visualConfig.boundDetectionPadding.top,i=-this.content.y+this.height/2-this.visualConfig.boundDetectionPadding.bottom,s=this.getMaxObjectHeight(),n=-this.content.height/2+this.visualConfig.margin.top,r=s+this.visualConfig.spacing,o=[];for(let a=0;a<e.length;a++){let h=n+a*r+s/2,l=h-s/2,u=h+s/2,d=l<i&&u>t;this.setReusableObjectInViewport(a,d),d&&o.push(a)}for(let a of o){let h=this.contentGameObjects[a].gameObject;h!==void 0&&this.tryUpdateObjectDepths(h)}}setReusableObjectInViewport(e,t){let i=this.contentGameObjects[e]?.gameObject;if(!t){i&&this.visualConfig.onExitViewport?.call(this,i),this.setObjectInactive(e);return}this.setObjectActive(e);let s=this.contentGameObjects[e]?.gameObject;i===void 0&&s!==void 0&&this.visualConfig.onEnterViewport?.call(this,s)}calcContentHeight(){let e=this.getMaxObjectHeight()*this.configs.length,t=this.visualConfig.spacing*(this.configs.length-1);return e+this.visualConfig.margin.top+this.visualConfig.margin.bottom+t}setObjectActive(e){if(this.contentGameObjects[e]?.gameObject!==void 0)return;let t=this.objects.getFirstDead(!0);if(t==null)return;let i=this.configs[e];this.objectUpdater(t,i),t.setActive(!0),t.setVisible(!0),this.content.addAt(t),this.contentGameObjects[e]={config:i,gameObject:t};let s=this.calcContentHeight();this.setContentHeight(s),this.updateObjectPosition()}setObjectInactive(e){let t=this.contentGameObjects[e];t?.gameObject!==void 0&&(this.objects.killAndHide(t.gameObject),this.contentGameObjects[e]={config:t.config,gameObject:void 0})}tryUpdateObjectDepths(e){if(this.depthStrategy!=="none")switch(this.depthStrategy){case"top-to-bottom":this.content.sendToBack(e);break;case"bottom-to-top":this.content.bringToTop(e);break}}};U();var D_=class FR{static _instance;static coin=0;static get inst(){return this._instance||(this._instance=new FR),this._instance}static getCoin(){return this.coin}static setCoin(t){this.coin=t,this.saveCoin(),this.emitCoinChanged()}static addCoin(t){this.coin+=t,this.saveCoin(),this.emitCoinChanged()}static removeCoin(t){this.coin-=t,this.coin<0&&(this.coin=0),this.saveCoin(),this.emitCoinChanged()}static saveCoin(){let{player:t}=codex;t.setGameData({coins:this.coin})}static loadCoin(){let{player:t}=codex,i=t.getGameData();this.coin=i?.coins??0}static emitCoinChanged(){let{event:t}=codex;t.emit(yt.COINS_CHANGED)}},$i=D_;U();var{Utils:{Number:Dw}}=Ludex,{DASHBOARD:{KEY:kw,FRAME:Fw}}=G,k_=class extends Phaser.GameObjects.Container{background;icon;text;coinCount;constructor(e){super(e),this.setWorldSize(80,30),this.createBackground(),this.createIcon(),this.createText(),this.coinCount=0,this.setDepth($.BUTTON),this.scene.add.existing(this)}createBackground(){this.background=this.scene.add.image(0,0,kw,Fw.COIN_PANEL),this.add(this.background)}createIcon(){this.icon=this.scene.add.image(0,0,kw,Fw.ICON_COIN),this.add(this.icon),Phaser.Display.Align.In.LeftCenter(this.icon,this.background)}createText(){this.text=X.createText(this.scene,"0",14).setFontStyle("900"),X.applyYellowStyle(this.text),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this.background,10,1)}setCoins(e){this.coinCount=e;let t=Dw.getShortNumber(e,3);this.text.setText(t)}incCoins(e){this.coinCount+=e;let t=Dw.getShortNumber(this.coinCount,3);this.text.setText(t)}updatePlayerCoin(){let e=$i.getCoin();this.setCoins(e)}bringThisToTop(){this.scene.children.bringToTop(this),this.setDepth($.ON_TOP)}revertDepth(){this.setDepth($.BUTTON)}},ao=k_;U(),U();var{KEY:F_,FRAME:N_}=G.EFFECTS,B_=class extends Phaser.GameObjects.Container{emitter;constructor(e){super(e),this.scene=e,this.createEmitters(),this.setActive(!1),this.setVisible(!1),this.scene.add.existing(this)}createEmitters(){this.emitter=this.scene.add.particles(0,0,F_,{frame:N_.FX_STAR_YELLOW,alpha:{start:1,end:.8},speed:{min:50,max:150},scale:{start:.4,end:.7},lifespan:{min:600,max:1500},emitting:!0}),this.add(this.emitter)}explode(e,t,i){this.setActive(!0),this.setVisible(!0),this.emitter.explode(e,t,i)}},U_=B_;U();var{KEY:G_,FRAME:Y_}=G.EFFECTS,H_=class extends Phaser.GameObjects.Container{emitter;constructor(e){super(e),this.scene=e,this.createEmitters(),this.setActive(!1),this.setVisible(!1)}createEmitters(){this.emitter=this.scene.add.particles(0,0,G_,{frame:Y_.FX_COMET,alpha:{start:1,end:.8},speed:{min:40,max:80},scale:{start:.4,end:.7},lifespan:{min:400,max:600}}),this.add(this.emitter)}explode(e,t,i){this.revive(),this.setPosition(t,i),this.emitter.explode(e)}},z_=H_,{KEY:W_,FRAME:V_}=G.DASHBOARD,X_=class extends Phaser.GameObjects.Container{coinGroup;containerGroup;startsExplosive;startsExplosiveSmall;startsExplosiveSmallTimer;gravity=300;isActive=!1;constructor(e){super(e),this.setVisible(!0),this.coinGroup=this.scene.add.group({defaultKey:W_,defaultFrame:V_.ICON_COIN}),this.containerGroup=this.scene.add.group({classType:Phaser.GameObjects.Container}),this.startsExplosive=new U_(e),this.startsExplosive.setDepth($.ON_TOP+1),this.startsExplosiveSmall=new z_(e),this.startsExplosiveSmall.setDepth($.ON_TOP+1),this.add([this.startsExplosive,this.startsExplosiveSmall]),this.scene.add.existing(this),this.setDepth($.ON_TOP+1)}createConfigOne(e,t,i){let s=e/300,n=new Phaser.Math.Vector2(0,0),r=new Phaser.Math.Vector2(0,-e),o=i?-1:1,a=Phaser.Math.RND.between(-90,90),h=a<0?1:(300-Math.abs(a))/300,l=(a+90)/180*180*h*s,u=Phaser.Math.RND.between(20,l+20),d=new Phaser.Math.Vector2(1,0);d.setAngle(a*Math.PI/180);let p=Phaser.Math.RND.between(-Math.abs(a)-15,-Math.abs(a)+15),g=u*(100-Math.abs(a))/100*s,c=Phaser.Math.RND.between(g*.2,g),f=new Phaser.Math.Vector2(1,0);f.setAngle(p*Math.PI/180);let m=o*d.x*u,v=d.y*u,E=o*f.x*c,x=f.y*c-e,T=new Phaser.Math.Vector2(m,v),A=new Phaser.Math.Vector2(E,x),P=new Phaser.Curves.CubicBezier(n,T,A,r),R=Phaser.Math.RND.between(750+u*3,1e3+u*3),S=this.coinGroup.get(0,0);return S.revive(),S.setRotation(-t.rotation),S.setWorldSize(24,22),t.add(S),{from:0,to:1,duration:R,ease:"Sine.In",onUpdate:I=>{let w=P.getPointAt(I.getValue());S.setPosition(w.x,w.y)},onComplete:I=>{if(S.kill(),this.scene.children.remove(S),I.totalProgress<1||this.startsExplosiveSmallTimer&&!this.startsExplosiveSmallTimer.hasDispatched)return;this.startsExplosiveSmallTimer=this.scene.time.delayedCall(100,()=>null);let w=S.getWorldPosition();this.startsExplosiveSmall.explode(10,w.x,w.y)}}}explode(e,t,i,s,n){if(e<=0)return[];this.isActive=!0,this.startsExplosive.explode(10,t,i);let r=new Phaser.Math.Vector2(s-t,n-i),o=r.length(),a=this.containerGroup.get(t,i);a.setRotation(r.angle()+Math.PI/2),a.revive(),this.add(a),this.scene.children.bringToTop(this);let h,l=0,u=[];for(let p=0;p<e;p++){let g=this.createConfigOne(o,a,p%2===0),c=this.scene.tweens.addCounter(g);u.push(c),g.duration>l&&(l=g.duration,h=c)}let d=()=>{for(let p of u)p.complete();this.startsExplosive.emitter.killAll(),this.startsExplosiveSmall.emitter.killAll(),a.kill(),this.isActive=!1};return h?.once(Phaser.Tweens.Events.TWEEN_COMPLETE,()=>{a.kill(),this.isActive=!1,this.scene.events.off("sleep",d)}),this.scene.events.once("sleep",d),u}},Cd=X_,{KEY:oo,FRAME:ho}=G.DAILY_MISSIONS,{KEY:K_,FRAME:j_}=G.DEFAULT,Z_=class extends ue{onReward;Gs;Ze;Ar;t;Pe;ee;au;p;Ys;gt;Hs;Lt=[];Et;constructor(e,t){super(e,t),this.$(),this.wr(),this.Cr(),this.Pr(),this.setDepth(me.POPUP),this.background.setAlpha(.8)}open(e){super.open(e),this.setCoinBar(e?.coinBar),this.Et.setEnabled(!1),this.Et.setVisible(!1),this.zs(),this.Rr(),this.et()}ne=()=>{this.l()};br=e=>{this.Ir(e)};Ir(e){typeof this.onReward=="function"&&(this.onReward(e),this.zs(),this._r(),nt.playSound(ut.DAILY_REWARD))}Or=async()=>{kt.resetMissions()};Mr=async()=>{kt.reduceAllMissionExpirationTime()};zs=()=>{let e=kt.getAllMissions(),t=kt.getAllProcessLogs(),i=kt.getGenericExpirationTime();this.Gs=e,this.Ze=t,this.Ar=i};et(){this.setVisible(!0),this.Lr(0,300),this.ft(200,500)}l(){this.ht(0,200)}Lr(e,t){this.Ys=this.scene.tweens.add({...ar,targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:.8}}}),J.runTween(this.Ys),this.bringCoinBarToTop()}ft(e,t){let i=pt.getBannerHeight()/2;this.gt=this.scene.tweens.add({...se,targets:[this.t],delay:e,duration:t,props:{...se.props,y:{from:350-i,to:-i},scale:{start:0,from:0,to:1},alpha:{start:1,from:1,to:1}},onComplete:()=>{this.updateMissionData()},onStop:()=>{this.updateMissionData()}}),J.runTween(this.gt)}ht(e,t){let i=pt.getBannerHeight()/2;this.Hs=this.scene.tweens.add({...Nt,targets:[this.t],delay:e,duration:t,props:{...Nt.props,y:250-i,scale:0},onComplete:()=>{this.revertCoinBarDepth(),ot.closeScreen(this.name)}}),J.runTween(this.Hs)}Pr(){if(!Ludex.Utils.Valid.isDebugger())return;let e=new At(this.scene,oo,ho.COIN);e.setName("Reset"),e.onClick=this.Or,this.add(e),Phaser.Display.Align.In.TopLeft(e,this.zone,-10,-40);let t=new At(this.scene,oo,ho.CLOSE);t.setName("New Task"),t.onClick=this.Mr,this.add(t),Phaser.Display.Align.In.TopLeft(t,this.zone,-30,-40)}$(){this.t=this.scene.add.container(0,0),this.t.setWorldSize(292,390);let e=this.scene.make.image({key:oo,frame:ho.POPUP_BG});this.t.add(e),this.add(this.t);let t=pt.getBannerHeight()/2;Phaser.Display.Align.In.Center(this.t,this.zone,0,-t)}wr(){this.Gt(),this.Dr()}Cr(){this.onReward=e=>{this.re(e)}}re(e){if(!this.p)return;let{claimButtonX:t,claimButtonY:i,value:s}=e,{x:n,y:r}=this.p.getWorldPosition(),o=this.Re().explode(10,t,i,n,r);for(let a of o)a.on(Phaser.Tweens.Events.TWEEN_COMPLETE,()=>{let h=Math.floor(s/10);$i.addCoin(h)})}Re(){let e=this.Lt.find(i=>!i.isActive);if(e)return e;let t=new Cd(this.p?.scene??this.scene);return this.Lt.push(t),t}Dr(){this.Et=new ro(this.scene,{size:{width:245,height:335},visual:{mask:!0,bounds:!0},reuse:{ClassType:Lw,configs:[],update:(e,t)=>{e.updateInfo(t)}}}),this.Et.setPosition(0,1),this.t.add(this.Et)}Gt(){let e=this.scene.add.container(),t=this.scene.make.image({key:oo,frame:ho.RIBBON}),i=new At(this.scene,K_,j_.BUTTON_CLOSE);i.setName("Close"),i.useSound=!0,i.onClick=this.ne,Phaser.Display.Align.In.RightCenter(i,t,50,10),e.add([t,i]),this.t.add(e),it.alignChildTopCenter(e,this.t,0,25)}updateMissionData(){this.Et.setVisible(!0),this.Et.scrollToTop(!0);let e=[],t=this.Et.getChildren(),i=Math.min(t.length,7);for(let s=0;s<i;s++){let n=t[s];if(!n)continue;let r=n.runShowItemAnimation(s*75,150);e.push(r)}Promise.all(e).then(()=>{this.Et.setEnabled(!0)})}Rr(){let e=[];for(let t of this.Gs){let i={missionData:t,process:this.Ze[t.id],onClaim:this.br};e.push(i)}this.Et.setConfigs(e)}_r(){let e=this.Et.getChildren();for(let t of e)if(t instanceof Lw){let i=t.getId();if(!Ludex.Utils.Object.hasOwn(this.Ze,i))continue;let s=this.Ze[i];if(!Ludex.Utils.Valid.isObject(s))continue;t.setProcess(s)}}incScale(e){super.incScale(e),this.Et.updateMaskScale(this.scale)}setCoinBar(e){e instanceof ao?this.p=e:this.p=null}bringCoinBarToTop(){this.p&&this.p.bringThisToTop()}revertCoinBarDepth(){this.p&&this.p.revertDepth()}},q_=Z_;U();var{Utils:{Valid:J_}}=Ludex,{KEY:Nw,FRAME:ts}=G.DEFAULT,Bw=[ts.LOADING_SCREEN_TILE_ICON_1,ts.LOADING_SCREEN_TILE_ICON_2,ts.LOADING_SCREEN_TILE_ICON_3,ts.LOADING_SCREEN_TILE_ICON_4,ts.LOADING_SCREEN_TILE_ICON_5],Q_=class extends ue{Fi=0;ct;yt;be;Ws;qe;Vs;constructor(e,t){super(e,t),this.kr(),this.setDepth(me.PRIORITY)}open(e){super.open(e),this.Fr();let t=this.getData(["duration"]),i=J_.isNumber(t?.[0])?t[0]:0;this.be?.remove(),i>0&&(this.be=this.scene.time.addEvent({delay:i,callback:()=>{this.visible&&this.Nr()}})),this.Br()}Fr(){this.yt.setFrame(Bw[this.Fi]),this.Fi=(this.Fi+1)%Bw.length}kr(){this.ct=this.scene.add.container(),this.ct.setWorldSize(130,130);let e=this.scene.make.image({key:Nw,frame:ts.LOADING_SCREEN_TILE_BG});this.ct.add(e),this.yt=this.scene.make.image({key:Nw,frame:ts.LOADING_SCREEN_TILE_ICON_1}),this.ct.add(this.yt),this.add(this.ct);let t=pt.getBannerHeight()/2;it.alignChildCenter(e,this.ct),it.alignChildCenter(this.yt,this.ct),Phaser.Display.Align.In.Center(this.ct,this.zone,0,-t)}Nr(){this.ht(()=>{ot.closeScreen(this.name)})}close(){super.close(),this.qe?.stop()}Br(){this.background.setAlpha(0),this.animateBackgroundAlpha(.8),this.Ur(),this.Gr()}Ur(e){this.ct.setAlpha(0),this.ct.setScale(0),this.ct.setAngle(0),this.Ws=this.scene.tweens.add({targets:[this.ct],props:{alpha:1,scale:1},duration:300,ease:Phaser.Math.Easing.Cubic.Out,onStart:()=>{}}),J.runTweenAsync(this.Ws).then(e)}Gr(){this.qe?.stop(),this.qe=this.scene.tweens.add({targets:[this.ct],repeat:-1,props:{angle:{from:0,to:360}},duration:1500,ease:Phaser.Math.Easing.Cubic.InOut}),J.runTween(this.qe)}ht(e){this.animateBackgroundAlpha(0,200),this.Vs=this.scene.tweens.add({targets:[this.ct],props:{alpha:0},duration:200,ease:Phaser.Math.Easing.Cubic.Out}),J.runTweenAsync(this.Vs).then(e)}},$_=Q_;U(),U();var tO={duration:300,ease:Sd,props:{scale:{start:1.2,from:1.2,to:1}}},we=tO;U();var{KEY:eO,FRAME:iO}=G.DEFAULT,sO=class extends Phaser.GameObjects.Image{anim;constructor(e){super(e,0,0,eO,iO.PRELOADER),this.runAnimation(),this.scene.add.existing(this)}runAnimation(){this.anim=this.scene.tweens.add({targets:this,props:{angle:{from:0,to:360}},duration:1200,repeat:-1})}setVisible(e){return super.setVisible(e),e?this.runAnimation():(this.anim.stop(),this.scene.tweens.remove(this.anim)),this}},Uw=sO,nO=class extends ue{yt;Yt;Ie;_e;be;constructor(e,t){super(e,t),this.Yr(),this.Hr(),this.Ie=this.yt.scale,this._e=this.Yt.scale,this.setDepth(me.PRIORITY)}open(e){super.open(e);let[t="",i=0,s=!1]=this.getData(["message","duration","loading"]);this.zr(t),this.Wr(s),this.be?.remove(),i>0&&(this.be=this.scene.time.addEvent({delay:i,callback:()=>{this.visible&&this.l()}})),this.et()}Yr(){this.yt=new Uw(this.scene),this.add(this.yt);let e=pt.getBannerHeight()/2;Phaser.Display.Align.In.Center(this.yt,this.zone,0,-e)}Hr(){this.Yt=X.createText(this.scene,"",24).setTint(16770463).setShadow(0,3,"#ce5f0f",.5).setStroke("#ce5f0f",2).setOrigin(.5,.5).setAlign("center").setFontStyle("900").setWordWrapWidth(this.zone.width-50,!0),this.add(this.Yt)}zr(e){this.Yt.setText(e)}Wr(e){this.yt.setVisible(e);let t=pt.getBannerHeight()/2,i=e===!1?20:90;Phaser.Display.Align.In.Center(this.Yt,this.zone,0,i-t)}et(){this.background.setAlpha(0),this.animateBackgroundAlpha(.8);let e=this.scene.tweens.add({...we,targets:[this.yt],props:{...we.props,scale:{from:this.Ie-.3,to:this.Ie},alpha:1}}),t=this.scene.tweens.add({...we,targets:[this.Yt],props:{...we.props,scale:{from:this._e-.3,to:this._e},alpha:1}});J.runTweenAsync(e),J.runTweenAsync(t)}l(){this.animateBackgroundAlpha(0,200);let e=this.scene.tweens.add({...we,targets:[this.yt],ease:Phaser.Math.Easing.Cubic.Out,props:{...we.props,scale:{from:this.Ie,to:this.Ie-.3},alpha:0}}),t=this.scene.tweens.add({...we,targets:[this.Yt],ease:Phaser.Math.Easing.Cubic.Out,props:{...we.props,scale:{from:this._e,to:this._e-.3},alpha:0}});J.runTween(e),J.runTweenAsync(t).then(()=>{ot.closeScreen(this.name)})}},rO=nO;U(),U();var{KEY:aO}=G.DEFAULT,oO=class extends At{options;icon;constructor(e,t){super(e,aO,t.frameOn),this.options=t}processCallback(e){let{enable:t}=this.options;this.updateStatus(!t),e(!t)}updateStatus(e){this.options.enable=e;let t=this.getFrameByStatus();this.button.setFrame(t)}getFrameByStatus=()=>{let{enable:e,frameOn:t,frameOff:i}=this.options;return e?t:i}},Pd=oO;U(),U(),U();var hO={NORMAL:"normal",FALL_DOWN:"fall-down",FLY_UP:"fly-up",PUSH_LEFT:"push-left",PUSH_RIGHT:"push-right",PUT_ROWS_MIDDLE:"put-rows-middle",PUT_COLUMNS_MIDDLE:"put-columns-middle",FLY_UP_PUSH_LEFT:"fly-up-push-left",FLY_UP_PUSH_RIGHT:"fly-up-push-right",FALL_DOWN_PUSH_LEFT:"fall-down-push-left",FALL_DOWN_PUSH_RIGHT:"fall-down-push-right",FLY_UP_PUT_COLUMNS_MIDDLE:"fly-up-put-columns-middle",FALL_DOWN_PUT_COLUMNS_MIDDLE:"fall-down-put-columns-middle"},ve=hO;U();var lO={BOMB:"bomb",ROCKET:"rocket",EMPTY:"empty"},uO={SIZE:70,STATUS:{READY:"ready",MOVING:"moving",CAPTURING:"capturing",CAPTURED:"captured"},EVENTS:{NEXT_TURN:"next-turn",CAPTURING:"capturing",INTERACTION:"interaction",NO_PATH_FOUND:"no-path-found",ROCKET_EXPLODE:"rocket-explode",FIRST_INTERACTION:"first-interaction",PAUSE_BOMB_TIMER:"pause-bomb-timer",RESUME_BOMB_TIMER:"resume-bomb-timer",BOMB_TIMER_RESCUE:"bomb-timer-rescue"},SPECIALS:lO,HASH:{1:"t01",2:"t02",3:"t03",4:"t04",5:"t05",6:"t06",7:"t07",8:"t08",9:"t09",10:"t10",11:"t11",12:"t12",13:"t13",14:"t14",15:"t15",16:"t16",17:"t17",empty:"i01",rocket:"i02"}},tt=uO;U();var cO={MAX_SPACE_OF_PAIR:"maxSpaceOfPair",ADD_RANDOM_TILES_PER_MOVE:"addRandomTilesPerMove"},dO=cO;U();var pO={BIRD:"BIRD",CAKE:"CAKE",FRUIT:"FRUIT",CANDY:"CANDY"},_i=pO,{BOMB:gO,ROCKET:fO}=tt.SPECIALS,{ADD_RANDOM_TILES_PER_MOVE:mO,MAX_SPACE_OF_PAIR:vO}=dO,Gw=Object.values(ve),{Utils:{Function:EO}}=Ludex,yO={toString:()=>Gw[Math.floor(Math.random()*Gw.length)]},Yw=async()=>{let e=(await Promise.resolve().then(()=>oh(jR()))).default,t=await(await fetch(e)).json();if(!Array.isArray(t))throw new Error("Levels is not an array");if(t.length===0)throw new Error("No levels found");Hw.push(...t)},Hw=[{level:0,mode:yO,time:120,rows:12,columns:7,colors:28,specials:{[gO]:10,[fO]:5},rules:{[vO]:15,[mO]:35},theme:[_i.BIRD,_i.CAKE,_i.FRUIT,_i.CANDY]}];try{EO.retryAsync(Yw,Yw)}catch{}var Ws=Hw;U(),U(),U(),U();var TO=class extends Phaser.GameObjects.Zone{constructor(e,t,i){super(e,0,0,t,i),this.setWorldSize(t,i)}},xO=TO,{Events:lo,Utils:{Valid:uo}}=Ludex,{event:Vs}=codex,SO=class extends Phaser.Scene{unsubscribeList;gameZone;background;handleResize=e=>{if(!this.scene.isActive()||!this.background||!this.gameZone)return;let{width:t,height:i}=e;this.gameZone.setWorldSize(t,i),this.background.setWorldSize(t,i),this.scaleGame(),Phaser.Display.Align.In.Center(this.background,this.gameZone)};constructor(){super({visible:!1})}create(){Vs.emit(lo.SCENE_LOADED,{sceneName:this.scene.key}),this.createGameZone(),this.scaleGame(),Vs.on(yt.VIEW_RESIZED,this.handleResize),Vs.on(yt.LAYOUT_CHANGED,this.handleResize),this.events.once(Phaser.Scenes.Events.RENDER,()=>{Vs.emit(lo.SCENE_LAUNCHED,{sceneName:this.scene.key})}),this.events.on(Phaser.Scenes.Events.WAKE,this.handleSceneRendered),this.events.on(Phaser.Scenes.Events.RESUME,this.handleSceneRendered),this.events.on(Phaser.Scenes.Events.ADDED_TO_SCENE,e=>{"setWorldSize"in e&&uo.isFunction(e.setWorldSize)&&e.setWorldSize(),"setHighQuality"in e&&uo.isFunction(e.setHighQuality)&&e.setHighQuality()})}handleSceneRendered=()=>{Vs.emit(lo.SCENE_RENDERED,{sceneName:this.scene.key}),this.events.once(Phaser.Scenes.Events.RENDER,()=>{Vs.emit(lo.SCENE_LAUNCHED,{sceneName:this.scene.key})})};scaleGame(){let e=this.getCamera("main"),t=lt.getZoomRatio();e.setZoom(t),e.startFollow(this.gameZone)}createGameZone(){let{width:e,height:t}=lt.getWorldSize();this.gameZone=new xO(this,e,t)}getCamera(e){return e==="main"?this.cameras.main:this.cameras.getCamera(e)}createMask(e=1){this.getCamera("main").setBackgroundColor(`rgba(0, 0, 0, ${e})`)}createBackground(e,t,i,s){this.background?(this.background.setTexture(e),t&&this.background.setFrame(t)):this.background=this.make.image({key:e,frame:t}),this.background.setName(e);let{width:n,height:r}=this.gameZone;this.background.setWorldSize(n,r),uo.isNumber(i)&&this.background.setAlpha(i),uo.isNumber(s)&&this.background.setTint(s),Phaser.Display.Align.In.Center(this.background,this.gameZone)}},hr=SO;U();var{KEY:AO,FRAME:wO}=G.DEFAULT,CO=class extends Phaser.GameObjects.Container{fps=0;fpsString="FPS: %1";fpsText;background;zone;lastUpdate;constructor(e){super(e,0,0),this.createFps(),this.createInputZone(),this.setDepth($.DEBUG),this.scene.add.existing(this),this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.update)}update=e=>{if(e-this.lastUpdate<800)return;this.lastUpdate=e;let t=Math.floor(this.scene.game.loop.actualFps);this.setFps(t)};setFps(e){this.fps=e;let t=this.fpsString.replace("%1",e.toString());this.fpsText.setText(t)}createFps(){this.background=this.scene.make.image({key:AO,frame:wO.BLANK}),this.background.setTint(32768),this.background.setAlpha(.5),this.background.setWorldSize(50,20),this.fpsText=X.createText(this.scene,this.fpsString,10),this.fpsText.setName("FPS Meter"),Phaser.Display.Align.In.Center(this.fpsText,this.background,4),this.add([this.background,this.fpsText]),this.setFps(0)}createInputZone(){let{width:e,height:t}=this.background;this.zone=this.scene.make.zone({width:e,height:t}),this.add(this.zone),this.zone.setInteractive({useHandCursor:!0}),this.zone.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handleShowFps)}handleShowFps=()=>{let{fpsText:e,background:t}=this;e.setVisible(!e.visible),t.setVisible(!t.visible)}},PO=CO;U(),U();var RO=(e,t,i)=>{if(t&&i){let n=It.getCurrentScene();if(!n)return;let r=n.children.getAll(),o=!0;for(let a of r)!(a instanceof ue)||a===i||a.visible&&(o=!1);if(!o)return}let s=document.getElementById("background-mask");s&&(s.style.backgroundColor=`rgba(0, 0, 0, ${e})`)},zw=RO,bO=class{backgroundAlphaList;constructor(){this.backgroundAlphaList=[]}requestBackgroundMaskUpdate(e,t){let i=this.backgroundAlphaList.findIndex(s=>s.screenName===e);i===-1?this.backgroundAlphaList.push({alpha:t,screenName:e}):this.backgroundAlphaList[i].alpha=t,this.updateBackgroundMask()}updateBackgroundMask(){if(this.backgroundAlphaList.length===0){zw(0);return}let e=1;for(let t of this.backgroundAlphaList)e*=1-t.alpha;zw(1-e)}},IO=bO,{ads:_O,event:co}=codex,{Events:Ww,Utils:{Valid:OO}}=Ludex,MO=class extends hr{Je;Ni;init(){this.Xs(),this.Ni=new IO,this.bt()}bt(){co.on("hideFPS",this.Vr),co.on("showFPS",this.Xr),this.Kr()}Kr(){co.on(Ww.VISIBILITY_HIDDEN,this.muteAudio),co.on(Ww.VISIBILITY_VISIBLE,this.unmuteAudio)}muteAudio=()=>{nt.muteAudio(!0),this.input.once(Phaser.Input.Events.POINTER_DOWN,this.unmuteAudio)};unmuteAudio=async()=>{if(!_O.isAdFullSizeShowing()){nt.muteAudio(!1);try{await phaser.sound.context.suspend(),await phaser.sound.context.resume()}catch{}}};setup(){this.scene.isActive()&&(this.jr(),this.Xs())}jr(){OO.isDebugger()&&(this.Je=new PO(this),Phaser.Display.Align.In.TopLeft(this.Je,this.gameZone,-20,-10))}Vr=()=>{this.Je?.kill()};Xr=()=>{this.Je?.revive()};Xs(){this.scene.bringToTop(this)}requestBackgroundMaskUpdate(e,t){this.Ni.requestBackgroundMaskUpdate(e,t)}recalculateBackgroundMask(){this.Ni.updateBackgroundMask()}},LO=MO,Vw=LO,{player:es}=codex,{Utils:{Valid:DO,Object:kO}}=Ludex,FO=class extends hr{isMusicLoaded=!1;isLazyLoadRequesting=!1;preload(){this.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,e=>{}),this.load.image(Xt.AVATAR_DEFAULT.KEY,Xt.AVATAR_DEFAULT.FILE),lt.isLandscape()?this.load.image(Xt.BACKGROUND.KEY,Xt.BACKGROUND.FILE_LANDSCAPE):this.load.image(Xt.BACKGROUND.KEY,Xt.BACKGROUND.FILE),this.load.atlas({key:G.DEFAULT.KEY,textureURL:G.DEFAULT.TEXTURE,atlasURL:G.DEFAULT.JSON}),this.load.multiatlas({key:G.EFFECTS.KEY,path:G.EFFECTS.PATH,atlasURL:G.EFFECTS.JSON}),this.load.multiatlas({key:G.GAMEPLAY.KEY,path:G.GAMEPLAY.PATH,atlasURL:G.GAMEPLAY.JSON}),(es.getGameData()?.level??1)<=Lt.FinalGuideLevel&&this.load.atlas({key:G.TUTORIAL.KEY,textureURL:G.TUTORIAL.TEXTURE,atlasURL:G.TUTORIAL.JSON}),this.load.atlas({key:G.TILES.CAKE.KEY,textureURL:G.TILES.CAKE.TEXTURE,atlasURL:G.TILES.CAKE.JSON}),es.isFirstSession()?this.loadFlowForNewUser():this.loadFlowForReturningUser()}loadFlowForNewUser(){this.loadCurrentLevelTiles()}loadFlowForReturningUser(){this.load.atlas({key:G.JOURNEY.KEY,textureURL:G.JOURNEY.TEXTURE,atlasURL:G.JOURNEY.JSON}),this.load.atlas({key:G.TOURNAMENTS.KEY,textureURL:G.TOURNAMENTS.TEXTURE,atlasURL:G.TOURNAMENTS.JSON}),this.load.atlas({key:G.DAILY_MISSIONS.KEY,textureURL:G.DAILY_MISSIONS.TEXTURE,atlasURL:G.DAILY_MISSIONS.JSON}),this.load.atlas({key:G.DASHBOARD.KEY,textureURL:G.DASHBOARD.TEXTURE,atlasURL:G.DASHBOARD.JSON}),this.load.atlas({key:G.CHALLENGE.KEY,textureURL:G.CHALLENGE.TEXTURE,atlasURL:G.CHALLENGE.JSON})}create(){super.create(),this.setupGlobalScene(),this.lazyLoadResource(),kt.initializeFinishedMissionCount(),ge.initializeFlags()}setupGlobalScene(){let e=this.scene.get(Yt.GLOBAL_SCENE);e instanceof Vw&&e.setup()}lazyLoadResource(){setTimeout(()=>{this.scene.wake(),es.isFirstSession()?this.lazyLoadResourceForNewUser():this.lazyLoadResourceForReturningUser(),this.loadSounds(),this.lazyLoadTiles(),this.load.start(),this.load.once(Phaser.Loader.Events.COMPLETE,()=>{this.scene.sleep()})},1500)}lazyLoadResourceForReturningUser(){this.load.atlas({key:G.TILES.CAKE.KEY,textureURL:G.TILES.CAKE.TEXTURE,atlasURL:G.TILES.CAKE.JSON}),(es.getGameData()?.level??1)<=Lt.FinalGuideLevel&&this.loadTexture32Bit(G.TUTORIAL.KEY,[G.TUTORIAL.TEXTURE_32_BIT]),this.loadTexture32Bit(G.JOURNEY.KEY,[G.JOURNEY.TEXTURE_32_BIT]),this.loadTexture32Bit(G.TOURNAMENTS.KEY,[G.TOURNAMENTS.TEXTURE_32_BIT]),this.loadTexture32Bit(G.DAILY_MISSIONS.KEY,[G.DAILY_MISSIONS.TEXTURE_32_BIT]),this.loadTexture32Bit(G.DASHBOARD.KEY,[G.DASHBOARD.TEXTURE_32_BIT]),this.loadTexture32Bit(G.CHALLENGE.KEY,[G.CHALLENGE.TEXTURE_32_BIT])}lazyLoadResourceForNewUser(){(es.getGameData()?.level??1)<=Lt.FinalGuideLevel&&this.loadTexture32Bit(G.TUTORIAL.KEY,[G.TUTORIAL.TEXTURE_32_BIT]),this.lazyLoadAtlas(G.JOURNEY.KEY,G.JOURNEY.TEXTURE,G.JOURNEY.JSON,G.JOURNEY.TEXTURE_32_BIT),this.lazyLoadAtlas(G.TOURNAMENTS.KEY,G.TOURNAMENTS.TEXTURE,G.TOURNAMENTS.JSON,G.TOURNAMENTS.TEXTURE_32_BIT),this.lazyLoadAtlas(G.DAILY_MISSIONS.KEY,G.DAILY_MISSIONS.TEXTURE,G.DAILY_MISSIONS.JSON,G.DAILY_MISSIONS.TEXTURE_32_BIT),this.lazyLoadAtlas(G.DASHBOARD.KEY,G.DASHBOARD.TEXTURE,G.DASHBOARD.JSON,G.DASHBOARD.TEXTURE_32_BIT),this.lazyLoadAtlas(G.CHALLENGE.KEY,G.CHALLENGE.TEXTURE,G.CHALLENGE.JSON,G.CHALLENGE.TEXTURE_32_BIT)}lazyLoadAtlas(e,t,i,s){let{FILE_KEY_COMPLETE:n}=Phaser.Loader.Events;this.load.atlas({key:e,textureURL:t,atlasURL:i}),this.load.once(`${n}atlasjson-${e}`,()=>{this.loadTexture32Bit(e,[s])})}loadSounds(){let e=!!es.getPlayerSetting("music");this.loadSoundFX(),e&&this.loadMusic()}loadSoundFX(){let e=kO.vals(ut);for(let t of e){if(t===ze.BACKGROUND.KEY||t===ze.DASHBOARD.KEY)continue;let i=ze.NEW_EFFECTS[t]??void 0;i&&this.load.audio(t,i)}}loadMusic(){if(this.isMusicLoaded)return;this.isMusicLoaded=!0;let{FILE_KEY_COMPLETE:e}=Phaser.Loader.Events,t=nt.getMusicPath(),i=ze.BACKGROUND.KEY;this.load.once(`${e}audio-${i}`,this.handleLoadMusicCompleted),this.load.audio(i,t)}handleLoadMusicCompleted=()=>{nt.playMusic(),nt.setDefaultVolumeMusic()};loadCurrentLevelTiles(){let{level:e}=es.getGameData()??{},t=e;DO.isNumber(t)||(t=1);let i=Lt.Themes;t<Ws.length&&(i=Ws[t].theme);for(let s of i)switch(s){case"cake":{this.load.atlas({key:G.TILES.CAKE.KEY,textureURL:G.TILES.CAKE.TEXTURE,atlasURL:G.TILES.CAKE.JSON});break}case"bird":{this.load.atlas({key:G.TILES.BIRD.KEY,textureURL:G.TILES.BIRD.TEXTURE,atlasURL:G.TILES.BIRD.JSON});break}case"fruit":{this.load.atlas({key:G.TILES.FRUIT.KEY,textureURL:G.TILES.FRUIT.TEXTURE,atlasURL:G.TILES.FRUIT.JSON});break}case"flower":{this.load.atlas({key:G.TILES.FLOWER.KEY,textureURL:G.TILES.FLOWER.TEXTURE,atlasURL:G.TILES.FLOWER.JSON});break}case"umbrella":{this.load.atlas({key:G.TILES.UMBRELLA.KEY,textureURL:G.TILES.UMBRELLA.TEXTURE,atlasURL:G.TILES.UMBRELLA.JSON});break}case"food":{this.load.atlas({key:G.TILES.FOOD.KEY,textureURL:G.TILES.FOOD.TEXTURE,atlasURL:G.TILES.FOOD.JSON});break}case"candy":{this.load.atlas({key:G.TILES.CANDY.KEY,textureURL:G.TILES.CANDY.TEXTURE,atlasURL:G.TILES.CANDY.JSON});break}case"butterfly":this.load.atlas({key:G.TILES.BUTTERFLY.KEY,textureURL:G.TILES.BUTTERFLY.TEXTURE,atlasURL:G.TILES.BUTTERFLY.JSON})}}lazyLoadTiles(){this.textures.exists(G.TILES.CAKE.KEY)||(this.isLazyLoadRequesting=!0,this.load.atlas({key:G.TILES.CAKE.KEY,textureURL:G.TILES.CAKE.TEXTURE,atlasURL:G.TILES.CAKE.JSON})),this.textures.exists(G.TILES.BIRD.KEY)||(this.isLazyLoadRequesting=!0,this.load.atlas({key:G.TILES.BIRD.KEY,textureURL:G.TILES.BIRD.TEXTURE,atlasURL:G.TILES.BIRD.JSON})),this.textures.exists(G.TILES.FRUIT.KEY)||(this.isLazyLoadRequesting=!0,this.load.atlas({key:G.TILES.FRUIT.KEY,textureURL:G.TILES.FRUIT.TEXTURE,atlasURL:G.TILES.FRUIT.JSON})),this.textures.exists(G.TILES.FLOWER.KEY)||(this.isLazyLoadRequesting=!0,this.load.atlas({key:G.TILES.FLOWER.KEY,textureURL:G.TILES.FLOWER.TEXTURE,atlasURL:G.TILES.FLOWER.JSON})),this.textures.exists(G.TILES.FOOD.KEY)||(this.isLazyLoadRequesting=!0,this.load.atlas({key:G.TILES.FOOD.KEY,textureURL:G.TILES.FOOD.TEXTURE,atlasURL:G.TILES.FOOD.JSON})),this.textures.exists(G.TILES.UMBRELLA.KEY)||(this.isLazyLoadRequesting=!0,this.load.atlas({key:G.TILES.UMBRELLA.KEY,textureURL:G.TILES.UMBRELLA.TEXTURE,atlasURL:G.TILES.UMBRELLA.JSON})),this.textures.exists(G.TILES.CANDY.KEY)||(this.isLazyLoadRequesting=!0,this.load.atlas({key:G.TILES.CANDY.KEY,textureURL:G.TILES.CANDY.TEXTURE,atlasURL:G.TILES.CANDY.JSON})),this.textures.exists(G.TILES.BUTTERFLY.KEY)||(this.isLazyLoadRequesting=!0,this.load.atlas({key:G.TILES.BUTTERFLY.KEY,textureURL:G.TILES.BUTTERFLY.TEXTURE,atlasURL:G.TILES.BUTTERFLY.JSON}))}loadTexture32Bit(e,t){let i=[];for(let r of t){let o=Ludex.Utils.String.generateObjectId();this.load.image(o,r),i.push(o)}this.load.start();let s=0,n=r=>{let o=i.indexOf(r);if(o===-1)return;let a=this.textures.get(r),h=this.textures.get(e);h.source[o].glTexture=a.source[0].glTexture,h.source[o].glIndex=a.source[0].glIndex,h.source[o].glIndexCounter=a.source[0].glIndexCounter,s++,s===i.length&&this.textures.off(Phaser.Textures.Events.ADD,n)};this.textures.on(Phaser.Textures.Events.ADD,n)}},Xw=FO;U(),U();var{Events:po}=Ludex,{event:go,adaptivePerformance:NO}=codex,fo=class NR{static _instance;static get inst(){return this._instance||(this._instance=new NR),this._instance}currentQuality="high";constructor(){go.on(po.REQUEST_QUALITY_UPGRADED,()=>{this.currentQuality="high"}),go.on(po.REQUEST_QUALITY_DOWNGRADED,()=>{this.currentQuality="low"})}setBlendModeWithPerf(t,i){if(!NO){t.setBlendMode(i);return}let s=this.trackGameObjectDestruction(t),n=a=>{s.isDestroyed||a===t.blendMode||t.setBlendMode(a)},r=()=>{s.isDestroyed||(n(i),go.once(po.REQUEST_QUALITY_DOWNGRADED,o))},o=()=>{s.isDestroyed||(n(Phaser.BlendModes.NORMAL),go.once(po.REQUEST_QUALITY_UPGRADED,r))};this.currentQuality==="high"?r():o()}trackGameObjectDestruction(t){let i=!1,s=()=>{i=!0};return t.once(Phaser.GameObjects.Events.DESTROY,s),{get isDestroyed(){return i}}}},{Utils:{Signal:BO}}=Ludex,{KEY:Kw,FRAME:jw}=G.DEFAULT,UO=class extends Phaser.GameObjects.Container{lastUpdate=0;alertIcon;alertShine;alertShineOgScale;alertAnimController=new BO.SignalController;isAlerting=!1;isMinimized=!1;constructor(e,t){super(e);let{isMinimized:i=!1}=t||{};this.isMinimized=i,this.createAlertIcon(),this.createAlertShine(),this.setName("GameplayNotification")}createAlertIcon(){this.alertIcon=this.scene.add.image(0,0,Kw,jw.ICON_INFO_DOT),this.add(this.alertIcon),this.alertIcon.kill()}createAlertShine(){this.alertShine=this.scene.add.image(0,0,Kw,jw.ICON_INFO_DOT),this.alertShine.setAlpha(0),fo.inst.setBlendModeWithPerf(this.alertShine,Phaser.BlendModes.ADD),this.add(this.alertShine),this.alertShineOgScale=this.alertShine.scale,this.alertShine.kill()}playAlertAnimation(){if(this.isAlerting)return;this.isAlerting=!0;let e=this.alertAnimController.renew();this.alertIcon.revive(),this.alertShine.revive();let t=this.isMinimized?.75:1;J.runTween(this.scene.tweens.chain({paused:!0,tweens:[{targets:this,props:{scale:{from:0,to:t}},duration:200,ease:Phaser.Math.Easing.Sine.Out},{targets:this.alertShine,props:{alpha:{from:.4,to:0},scale:{from:this.alertShineOgScale,to:this.alertShineOgScale*1.7}},duration:1e3,ease:Phaser.Math.Easing.Cubic.Out,repeat:-1}]}),e)}stopAlertAnimation(){if(!this.isAlerting)return;this.isAlerting=!1;let e=this.alertAnimController.renew(),t=()=>{this.alertIcon.kill(),this.alertShine.kill()},i=this.isMinimized?.75:1;J.runTween(this.scene.tweens.add({targets:this,props:{scale:{from:i,to:0}},duration:200,ease:Phaser.Math.Easing.Sine.In,paused:!0,onComplete:t}),e)}},Zw=UO,{player:lr,event:mo}=codex,{Utils:{Device:qw}}=Ludex,{KEY:zt,FRAME:bt}=G.DEFAULT,Xs=class extends At{scaleDown=.98},GO=class extends ue{t;Oe;nt;Mt;ae;oe;Ht;Bi;Ui;ut;Qe;Gi;zt;gt;st;Yi;constructor(e,t){super(e,t),this.$(),this.Gt(),this.Hi(),this.Zr(),this.qr(),this.zi(),this.setDepth(me.POPUP)}open(){super.open(),mo.emit(j.PAUSE);let e=lr.getPlayerSettings(),{music:t,sound:i,vibrate:s}=e;this.ae.updateStatus(t),this.oe.updateStatus(i),qw.isDesktop()||this.Ht.updateStatus(s),this.Jr();let n=ge.isPauseScreenNotificationAvailable,r=ge.isLevelReadyForNotification(),o=this.Qe.visible;n&&r&&o&&this.playDashboardNotification(),this.et()}zi(){this.nt.setButtonHitSoundEffect(ut.CLOSE_POPUP_CLICK),this.nt.onClick=this.$e,this.ae.onClick=this.Qr,this.oe.onClick=this.$r,qw.isDesktop()?this.Ht.setDisabled(!0):this.Ht.onClick=this.ea}Me(){return this.scene.scene.key===Yt.DASHBOARD_SCENE}ia(){this.Me()?this.Oe.setFrame(bt.SETTINGS_TEXT):this.Oe.setFrame(bt.PAUSE_TEXT)}Jr(){let e=ht.isChallengeMode();this.ia(),this.Me()?(this.Ui.setVisible(!0),this.Bi.setVisible(!1),this.Qe.setVisible(!1),this.ut.setVisible(!1),this.Gi.setVisible(!0)):(this.Qe.setVisible(!0),this.Gi.setVisible(!1),this.ut.setVisible(!1),this.Ui.setVisible(e),this.Bi.setVisible(!e))}$e=()=>{mo.emit(j.RESUME),this.l(),this.stopDashboardNotification(),ge.setPauseScreenNotificationFlag(!1)};sa=async()=>{this.l(),ge.setPauseScreenNotificationFlag(!1),ge.setIsUserUsedPauseScreenNotification(!0),ht.isTournamentMode()&&await ht.finishTournamentAsync(),this.scene.time.delayedCall(200,()=>{It.switchToDashboardScene()})};na=()=>{this.l(),mo.emit(j.REPLAY)};ra=async()=>{await ht.startSingleModeAsync()&&(this.l(),this.Me()&&this.scene.time.delayedCall(200,()=>{It.switchToGameScene()}))};Qr=e=>{if(lr.setSetting("music",e),e){let t=this.scene.game.scene.getScene(Yt.LOAD_SCENE);t instanceof Xw&&t.loadMusic(),nt.playMusic()}else nt.pauseMusic()};aa=async()=>{(this.Me()?await ht.autoChallengeModeAsync():await ht.startChallengeChooseOpponentAsync())&&(this.Me()?this.scene.time.delayedCall(200,()=>{It.switchToGameScene()}):(this.l(),mo.emit(j.REPLAY)))};$r=e=>{lr.setSetting("sound",e)};ea=e=>{lr.setSetting("vibrate",e)};$(){this.t=this.scene.add.container(0,0),this.t.setSize(292,374);let e=this.scene.make.image({key:zt,frame:bt.POPUP});this.t.add(e),this.add(this.t);let t=pt.getBannerHeight()/2;Phaser.Display.Align.In.Center(this.t,this.zone,0,-t)}Gt(){this.Oe=this.scene.make.image({key:zt,frame:bt.PAUSE_TEXT}),this.t.add(this.Oe),it.alignChildTopCenter(this.Oe,this.t,2,-23)}Hi(){let{music:e,sound:t,vibrate:i}=lr.getPlayerSettings();this.It(),this.oa(),this.ha(),this.Li(),this.la(),this.ua(),this.ca(),this.da(),this.pa(e),this.ga(t),this.createVibrateButton(i)}It(){this.nt=new At(this.scene,zt,bt.BUTTON_CLOSE);let e=this.scene.make.image({key:zt,frame:bt.ICON_X});this.nt.add(e),this.nt.setName("Close"),this.t.add(this.nt),it.alignChildTopRight(this.nt,this.t,-15,-15)}oa(){let e=this.scene.make.image({key:zt,frame:bt.BUTTON_FRAME}),t=this.scene.make.image({key:zt,frame:bt.BUTTON_FRAME}),i=this.scene.make.image({key:zt,frame:bt.BUTTON_FRAME});this.t.add([e,t,i]),it.alignChildCenter(e,this.t,0,-10.5),it.alignChildCenter(t,this.t,0,49.5),it.alignChildCenter(i,this.t,0,109.5)}ha(){let e=new Xs(this.scene,zt,bt.BUTTON_BLUE),t=X.createText(this.scene,"Home",17).setFontStyle("900");X.applyBlueStyle(t);let i=this.scene.make.image({key:zt,frame:bt.ICON_HOME});e.add([i,t]),Phaser.Display.Align.In.Center(t,e,16),Phaser.Display.Align.In.LeftCenter(i,t,40),e.setName("Dashboard"),this.t.add(e),it.alignChildCenter(e,this.t,0,-10),e.onClick=this.sa,this.zt=new Zw(this.scene),this.t.add(this.zt),it.alignChildTopRight(this.zt,e,-7,4),this.Qe=e}Li(){let e=new Xs(this.scene,zt,bt.BUTTON_BLUE),t=X.createText(this.scene,"Continue",17).setFontStyle("900");X.applyBlueStyle(t);let i=this.scene.make.image({key:zt,frame:bt.ICON_CONTINUE});e.add([i,t]),Phaser.Display.Align.In.Center(t,e,16),Phaser.Display.Align.In.LeftCenter(i,t,40),e.setName("Continue"),this.t.add(e),it.alignChildCenter(e,this.t,0,-10),e.onClick=this.$e,this.ut=e}la(){let e=new Xs(this.scene,zt,bt.BUTTON_BLUE),t=X.createText(this.scene,"Share",17).setFontStyle("900");X.applyBlueStyle(t);let i=this.scene.make.image({key:zt,frame:bt.ICON_SHARE});e.add([i,t]),Phaser.Display.Align.In.Center(t,e,14),Phaser.Display.Align.In.LeftCenter(i,t,40),e.setName("Share"),this.t.add(e),it.alignChildCenter(e,this.t,0,-10),e.onClick=this.fa,this.Gi=e}ua(){let e=new Xs(this.scene,zt,bt.BUTTON_YELLOW),t=X.createText(this.scene,"Restart",17).setFontStyle("900");X.applyOrangeStyle(t);let i=this.scene.make.image({key:zt,frame:bt.ICON_REPLAY});e.add(i),e.add(t),Phaser.Display.Align.In.Center(t,e,16),Phaser.Display.Align.In.LeftCenter(i,t,40),e.setName("Restart"),this.t.add(e),it.alignChildCenter(e,this.t,0,50),e.onClick=this.na,this.Bi=e}ca(){let e=new Xs(this.scene,zt,bt.BUTTON_YELLOW),t=X.createText(this.scene,"New Game",17).setFontStyle("900");X.applyOrangeStyle(t);let i=this.scene.make.image({key:zt,frame:bt.ICON_REPLAY});e.add(i),e.add(t),Phaser.Display.Align.In.Center(t,e,16),Phaser.Display.Align.In.LeftCenter(i,t,35),e.setName("New Game"),this.t.add(e),it.alignChildCenter(e,this.t,0,50),e.onClick=this.ra,this.Ui=e}da(){let e=new Xs(this.scene,zt,bt.BUTTON_GREEN),t=X.createText(this.scene,"Invite Friends",17).setFontStyle("900");X.applyGreenStyle(t);let i=this.scene.make.image({key:zt,frame:bt.ICON_INVITE});e.add(i),e.add(t),Phaser.Display.Align.In.Center(t,e,16),Phaser.Display.Align.In.LeftCenter(i,t,30),e.setName("Invite"),this.t.add(e),it.alignChildCenter(e,this.t,0,110),e.onClick=this.aa}pa(e){this.ae=new Pd(this.scene,{enable:e,frameOn:bt.ICON_MUSIC_ON,frameOff:bt.ICON_MUSIC_OFF}),this.ae.setName("Music")}ga(e){this.oe=new Pd(this.scene,{enable:e,frameOn:bt.ICON_SOUND_ON,frameOff:bt.ICON_SOUND_OFF}),this.oe.setName("Sound")}createVibrateButton(e){this.Ht=new Pd(this.scene,{enable:e,frameOn:bt.ICON_VIBRATE_ON,frameOff:bt.ICON_VIBRATE_OFF}),this.Ht.setName("Vibrate")}Zr(){this.Mt=this.scene.add.group(),this.Mt.addMultiple([this.ae,this.oe,this.Ht]),this.t.add(this.Mt.getChildren())}qr(){this.oe.setPosition(-70,-this.t.height*.22),this.ae.setPosition(0,-this.t.height*.22),this.Ht.setPosition(70,-this.t.height*.22)}et(){this.gt?.isPlaying()||(this.background.setAlpha(0),this.animateBackgroundAlpha(.8),this.ft(0,400),this.Wt(200,300))}l(){this.st?.isPlaying()||(this.animateBackgroundAlpha(0,200),this.ht(0,200))}ft(e,t){let i=pt.getBannerHeight()/2;this.gt=this.scene.tweens.add({...se,targets:[this.t],delay:e,duration:t,props:{...se.props,y:{from:350-i,to:-i},alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:1}}}),J.runTween(this.gt)}Wt(e,t){let i=this.Mt.getChildren(),s=i.map(n=>n.alpha);for(let n of i)n.setAlpha(0);this.Yi?.remove(),this.Yi=this.scene.tweens.add({...we,targets:i,duration:t,delay:e,props:{...we.props,alpha:{getStart:()=>0,getEnd:(n,r,o,a)=>s[a]}}}),J.runTween(this.Yi)}ht(e,t){this.st?.remove();let i=pt.getBannerHeight()/2;this.st=this.scene.tweens.add({...Nt,targets:[this.t],delay:e,duration:t,props:{...Nt.props,y:250-i,scale:0},onComplete:()=>{this.t.setY(0)}}),J.runTweenAsync(this.st).then(()=>{ot.closeScreen(this.name)})}fa=async()=>{try{ot.showLoadingScreen(),await Ow.postBestScoreWideframe()}catch{}finally{ot.closeLoadingScreen()}};playDashboardNotification(){this.zt&&this.zt.playAlertAnimation()}stopDashboardNotification(){this.zt&&this.zt.stopAlertAnimation()}},YO=GO;U(),U(),U();var{EFFECTS:Fe,GAMEPLAY:Jw}=G,{KEY:Ks,FRAME:js}=Fe,HO={CONFETTI_STAR_X:{KEY:"confetti-star-x",TEXTURE:Ks,PREFIX:js.ANIMATION_STAR_X,FRAME_RATE:4,END:4,ZERO_PAD:0},CONFETTI_STAR_Y:{KEY:"confetti-star-y",TEXTURE:Ks,PREFIX:js.ANIMATION_STAR_Y,FRAME_RATE:4,END:4,ZERO_PAD:0},RIBBON_A:{KEY:"animation-ribbon-a",TEXTURE:Ks,PREFIX:js.PREFIX_ANIMATION_RIBBON_CONFETTI_A,FRAME_RATE:16,END:3,ZERO_PAD:0},RIBBON_B:{KEY:"animation-ribbon-b",TEXTURE:Ks,PREFIX:js.PREFIX_ANIMATION_RIBBON_CONFETTI_B,FRAME_RATE:16,END:4,ZERO_PAD:0},RIBBON_C:{KEY:"animation-ribbon-c",TEXTURE:Ks,PREFIX:js.PREFIX_ANIMATION_RIBBON_CONFETTI_C,FRAME_RATE:16,END:4,ZERO_PAD:0},RIBBON_D:{KEY:"animation-ribbon-d",TEXTURE:Ks,PREFIX:js.PREFIX_ANIMATION_RIBBON_CONFETTI_D,FRAME_RATE:16,END:4,ZERO_PAD:0},POLISH_EFFECT:{KEY:"polish-effect-animation",TEXTURE:Fe.KEY,PREFIX:Fe.FRAME.POLISH_EFFECT,FRAME_RATE:30,END:5,ZERO_PAD:1},BOMB_EXPLOSION:{KEY:"bomb-explosion-animation",TEXTURE:Fe.KEY,PREFIX:Fe.FRAME.EFFECT_BOMB_EXPLOSION,FRAME_RATE:16,END:8,ZERO_PAD:1},BOMB_DEFUSE:{KEY:"bomb-defuse-animation",TEXTURE:Fe.KEY,PREFIX:Fe.FRAME.EFFECT_BOMB_DEFUSE,FRAME_RATE:16,END:8,ZERO_PAD:1},ROCKET_EXPLOSION:{KEY:"rocket-explosion-animation",TEXTURE:Fe.KEY,PREFIX:Fe.FRAME.EFFECT_ROCKET_EXPLOSION,FRAME_RATE:16,END:8,ZERO_PAD:1},ROCKET_TAIL:{KEY:"rocket-tail-animation",TEXTURE:Fe.KEY,PREFIX:Fe.FRAME.ROCKET_TAIL,FRAME_RATE:60,END:70,ZERO_PAD:1},TILE_HIGHLIGHT:{KEY:"tile-highlight-animation",TEXTURE:Jw.KEY,PREFIX:Jw.FRAME.EFFECT_TILE_HIGHLIGHT,FRAME_RATE:31,END:31,ZERO_PAD:1}},ne=HO,{DEFAULT:vo,EFFECTS:Qw}=G,zO=class extends Phaser.GameObjects.Container{whiteGlow;bomb;explosion;bombShakeTween;glowSpinTween;constructor(e){super(e),this.createWhiteGlow(),this.createBomb(),this.createExplosion()}createWhiteGlow(){let e=this.scene.add.image(0,0,vo.KEY,vo.FRAME.ART_WHITE_GLOW);this.add(e),e.setPosition(0,0),this.whiteGlow=e}createBomb(){let e=this.scene.add.image(0,0,vo.KEY,vo.FRAME.ICON_BOMB);this.add(e),e.setPosition(0,0),this.bomb=e}createExplosion(){let e=this.scene.add.sprite(0,0,Qw.KEY,`${Qw.FRAME.EFFECT_BOMB_EXPLOSION}0`);this.add(e),e.setPosition(0,0),e.setWorldSize(45,45),e.kill(),this.explosion=e}runBombShakeAnimation(){this.bombShakeTween?.stop(),this.bomb.setPosition(0,0),this.bomb.revive(),this.whiteGlow.revive(),this.explosion.kill(),this.bombShakeTween=this.scene.tweens.add({targets:this.bomb,x:-2,delay:800,duration:50,ease:"Sine.easeInOut",yoyo:!0,repeat:6,onComplete:this.runBombExplodeAnimation})}runGlowSpinAnimation(){this.glowSpinTween?.stop(),this.whiteGlow.revive(),this.whiteGlow.angle=0,this.glowSpinTween=this.scene.tweens.add({targets:this.whiteGlow,angle:360,duration:5e3,repeat:-1})}runBombExplodeAnimation=()=>{this.bomb.kill(),this.whiteGlow.kill(),this.explosion.revive(),this.explosion.anims.play(ne.BOMB_EXPLOSION.KEY,!0),this.explosion.on(Phaser.Animations.Events.ANIMATION_COMPLETE,()=>{this.explosion.kill(),this.runBombShakeAnimation(),this.runGlowSpinAnimation()})};play(){this.runGlowSpinAnimation(),this.runBombShakeAnimation()}stop(){this.bombShakeTween?.stop(),this.glowSpinTween?.stop(),this.bomb.kill(),this.explosion.kill(),this.whiteGlow.kill()}revive(){super.revive(),this.whiteGlow.angle=0,this.whiteGlow.revive(),this.bomb.setPosition(0,0),this.bomb.revive()}},WO=zO;U();var{KEY:$w,FRAME:tC}=G.DEFAULT,VO=class extends Phaser.GameObjects.Container{clock;clockSpinTween;whiteGlow;glowSpinTween;constructor(e){super(e),this.createWhiteGlow(),this.createClock()}createClock(){let e=this.scene.add.image(0,0,$w,tC.ICON_TIMEOUT_CLOCK);this.add(e),e.setPosition(0,0),this.clock=e}createWhiteGlow(){let e=this.scene.add.image(0,0,$w,tC.ART_WHITE_GLOW);this.add(e),e.setPosition(0,0),this.whiteGlow=e}runClockSpinAnimation(){this.clockSpinTween?.stop(),this.clock.angle=0,this.clock.setFlipY(!1),this.clock.revive(),this.clockSpinTween=this.scene.tweens.add({targets:this.clock,angle:this.clock.angle+180,duration:800,delay:800,ease:Phaser.Math.Easing.Sine.InOut,repeat:-1,repeatDelay:800,onStart:()=>{this.clock.setFlipY(!1)}})}runGlowSpinAnimation(){this.glowSpinTween?.stop(),this.whiteGlow.angle=0,this.whiteGlow.revive(),this.glowSpinTween=this.scene.tweens.add({targets:this.whiteGlow,angle:360,duration:5e3,repeat:-1})}play(){this.runClockSpinAnimation(),this.runGlowSpinAnimation()}stop(){this.clockSpinTween?.stop(),this.glowSpinTween?.stop()}revive(){super.revive(),this.clock.angle=0,this.clock.setFlipY(!1),this.clock.revive(),this.whiteGlow.angle=0,this.whiteGlow.revive()}},XO=VO;U();var KO=class extends Phaser.GameObjects.Container{useSound=!0;isClicked=!1;text;scaleUp=1;scaleDown=.985;hitArea;hitZone;upAnimation;downAnimation;hitSoundEffectKey=ut.GENERAL_BUTTON_CLICK;padding=10;constructor(e,t="",i=16,s,n){super(e),this.setDepth($.BUTTON),this.createText(t,i),this.createHitZone(s,n),this.listenEvents(),this.scene.add.existing(this)}createText(e,t){this.text=X.createUnderlineText(this.scene,e,t),this.text.setDepth($.TEXT),this.text.setAlpha(.8),this.add(this.text)}createHitZone(e,t){let i=this.text.width+this.padding*2,s=this.text.height+this.padding*2,n=e||i,r=t||s;this.hitZone=this.scene.make.zone({width:n,height:r}),this.add(this.hitZone),this.updateSize()}set onClick(e){this.hitArea=this.hitZone,this.hitArea.setInteractive({useHandCursor:!0}),this.hitArea.off(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN),this.hitArea.off(Phaser.Input.Events.GAMEOBJECT_POINTER_UP),this.hitArea.off(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handlePointerDown),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleOnClick(e)),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handlePointerOut)}handlePointerDown=()=>{this.isClicked||this.upAnimation?.isPlaying()||(this.isClicked=!0,this.runDownAnimation())};handleOnClick=e=>()=>{this.isClicked&&(this.upAnimation?.isPlaying()||(this.isClicked=!1,this.runUpAnimation(),this.upAnimation?.once(Phaser.Tweens.Events.TWEEN_COMPLETE,()=>{qi.trackButtonClick(this.name),this.processCallback(e)})))};handlePointerOut=()=>{this.isClicked&&(this.upAnimation?.isPlaying()||(this.isClicked=!1,this.runUpAnimation()))};processCallback(e){this.upAnimation?.stop(),this.downAnimation?.stop(),this.scene?.tweens.killTweensOf(this),this.setScale(this.scaleUp),e()}setText(e){return this.text&&(this.text.setText(e),this.updateHitZoneSize()),this}updateHitZoneSize(){if(!this.text||!this.hitZone)return;let e=this.text.width+this.padding*2,t=this.text.height+this.padding*2;this.hitZone.setSize(e,t),this.updateSize()}setDisabled(e){e?(this.setAlpha(.5),this.hitArea?.disableInteractive()):(this.setAlpha(1),this.hitArea?.setInteractive())}updateSize(){if(!this.hitZone)return;let e=this.hitZone.width,t=this.hitZone.height;this.setSize(e,t)}runDownAnimation(){this.useSound&&nt.playSound(this.hitSoundEffectKey),this.downAnimation?.remove(),this.downAnimation=this.scene.tweens.add({...Hs,targets:[this],duration:150,props:{scale:this.scaleDown},onUpdate:()=>{this.hitZone&&(this.hitZone.scale=1/this.scale)}}),J.runTween(this.downAnimation)}runUpAnimation(){this.upAnimation?.remove(),this.upAnimation=this.scene.tweens.add({...rr,targets:[this],duration:150,props:{scale:this.scaleUp},onUpdate:()=>{this.hitZone&&(this.hitZone.scale=1/this.scale)}}),J.runTween(this.upAnimation)}setButtonHitSoundEffect(e){this.hitSoundEffectKey=e}setPadding(e){return this.padding=e,this.updateHitZoneSize(),this}listenEvents(){this.scene.events.on(Phaser.Scenes.Events.SLEEP,this.handleSceneSleep),this.once(Phaser.GameObjects.Events.DESTROY,this.handleObjectDestroy)}handleObjectDestroy=()=>{this.scene&&this.scene.events.off(Phaser.Scenes.Events.SLEEP,this.handleSceneSleep)};handleSceneSleep=()=>{this.scene&&this.scene.tweens.killTweensOf(this)}},Rd=KO,{event:bd}=codex,{KEY:is,FRAME:Oi}=G.DEFAULT,jO=class extends ue{level;reason;isUseRescue;popup;levelText;reasonText;reasonIcon;resultBombAnimation;resultTimeOutAnimation;rescueButton;replayButton;popupShowUpAnimation;popupFadeOutAnimation;constructor(e,t){super(e,t),this.setDepth(me.POPUP),this.$()}open=e=>{super.open(),this.isUseRescue=!1,this.level=e.level,this.reason=e.reason,this.Ks(),this.js(),this.et(),this.ki()};close(){this.resultBombAnimation.stop(),this.resultBombAnimation.kill(),this.resultTimeOutAnimation.stop(),this.resultTimeOutAnimation.kill(),bd.emit(j.RESUME),super.close()}Rt=async()=>{try{if(this.isUseRescue)return;if(this.isUseRescue=!0,!await pt.showRewardVideoAdAsync())throw new Error("Failed to show rewarded video ad");this.l(),this.popupFadeOutAnimation?.once(Phaser.Tweens.Events.TWEEN_COMPLETE,()=>{bd.emit(j.RESCUE,{reason:this.reason})}),nt.playSound(ut.DAILY_REWARD)}catch{this.isUseRescue=!1}};ma=async()=>{this.l(),await ht.finishSingleModeAsync(),await ht.startSingleModeAsync(),bd.emit(j.REPLAY)};_i(){this.Gt(),this.Wi(),this.Mi(),this.va(),this.Ea(),this.ya(),this.Ta(),this.xa()}$(){this.popup=this.scene.add.container(),this.popup.setSize(292,374);let e=this.scene.make.image({key:is,frame:Oi.POPUP}),t=this.scene.make.image({key:is,frame:Oi.ART_BG_LIGHT});this.popup.add([t,e]),this.add(this.popup),this._i();let i=pt.getBannerHeight()/2;Phaser.Display.Align.In.Center(this.popup,this.zone,0,-i)}Gt(){let e=this.scene.make.image({key:is,frame:Oi.FAILED_TEXT});this.popup.add(e),it.alignChildTopCenter(e,this.popup,0,-20)}Wi(){this.levelText=X.createText(this.scene,"Level X",18),X.applyWarningStyle(this.levelText),this.popup.add(this.levelText),it.alignChildTopCenter(this.levelText,this.popup,0,-80)}Mi(){this.reasonText=X.createText(this.scene,"",16),X.applyWarningStyle(this.reasonText),this.reasonText.kill(),this.popup.add(this.reasonText),it.alignChildCenter(this.reasonText,this.popup,0,55)}va(){this.reasonIcon=this.scene.make.image({key:is,frame:Oi.ICON_LOSE}),this.reasonIcon.kill(),this.popup.add(this.reasonIcon),it.alignChildCenter(this.reasonIcon,this.popup,-60,60)}Ea(){this.resultBombAnimation=new WO(this.scene),this.popup.add(this.resultBombAnimation),it.alignChildCenter(this.resultBombAnimation,this.popup,0,-15),this.resultBombAnimation.kill()}ya(){this.resultTimeOutAnimation=new XO(this.scene),this.popup.add(this.resultTimeOutAnimation),it.alignChildCenter(this.resultTimeOutAnimation,this.popup,0,-15),this.resultTimeOutAnimation.kill()}Ks(){this.levelText.setText(`Level ${this.level}`)}js(){switch(this.reasonText.revive(),this.reason){case"bombExplosive":this.resultBombAnimation.revive(),this.resultBombAnimation.play(),this.reasonText.setText("The bomb exploded!");break;case"timeUp":this.resultTimeOutAnimation.revive(),this.resultTimeOutAnimation.play(),this.reasonIcon.setFrame(Oi.ICON_CLOCK),this.reasonText.setText("Time is up!");break;default:this.reasonText.setText("You have failed the level!")}}Ta(){this.rescueButton=new to(this.scene,is,Oi.BUTTON_GREEN),this.rescueButton.setName("Continue");let e=this.scene.make.image({key:is,frame:Oi.BUTTON_FRAME});this.rescueButton.onClick=this.Rt;let t=this.scene.make.image({key:is,frame:Oi.ICON_ADS});Phaser.Display.Align.In.Center(t,this.rescueButton,-65),this.rescueButton.content.add(t);let i=X.createText(this.scene,"Resurrection",18).setFontStyle("700");X.applyGreenStyle(i),this.rescueButton.content.add(i),Phaser.Display.Align.In.Center(i,this.rescueButton,14),this.popup.add([e,this.rescueButton]),it.alignChildBottomCenter(this.rescueButton,this.popup,0,-40),Phaser.Display.Align.In.Center(e,this.rescueButton)}xa(){this.replayButton=new Rd(this.scene,"Replay",16),this.replayButton.setAlpha(.8),this.popup.add(this.replayButton),this.replayButton.onClick=this.ma,it.alignChildBottomCenter(this.replayButton,this.popup,0,40)}ki(){this.rescueButton.playHighlightAnimation()}et(){this.popupShowUpAnimation?.isPlaying()||(this.background.setAlpha(0),this.animateBackgroundAlpha(.8),this.ft(0,400))}l(){this.popupFadeOutAnimation?.isPlaying()||(this.animateBackgroundAlpha(0,200),this.ht(0,200))}ft(e,t){let i=pt.getBannerHeight()/2,{y:s}=this.popup;this.popupShowUpAnimation=this.scene.tweens.add({...se,targets:[this.popup],delay:e,duration:t,props:{...se.props,y:{from:350-i,to:-i},alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:1}},onComplete:()=>{this.Ks(),this.js()}}),J.runTween(this.popupShowUpAnimation)}ht(e,t){let i=pt.getBannerHeight()/2;this.popupFadeOutAnimation=this.scene.tweens.add({...Nt,targets:[this.popup],delay:e,duration:t,props:{...Nt.props,y:250-i,scale:0},onComplete:()=>{this.popup.setY(0),ot.closeScreen(this.name)}}),J.runTween(this.popupFadeOutAnimation)}},ZO=jO;U(),U(),U(),U();var qO=e=>{let{scene:t,key:i,newKey:s,radius:n}=e,{width:r,height:o}=e,a=t.textures.get(i).getSourceImage();if(!a)return!1;r||(r=a.width),o||(o=a.height),s||t.textures.removeKey(i);let h=t.textures.createCanvas(s||i,r,o),l=h.context,u=Math.min(r,o)/100*n/2,d=0,p=0;return l.beginPath(),l.moveTo(d+u,p),l.lineTo(d+r-u,p),l.quadraticCurveTo(d+r,p,d+r,p+u),l.lineTo(d+r,p+o-u),l.quadraticCurveTo(d+r,p+o,d+r-u,p+o),l.lineTo(d+u,p+o),l.quadraticCurveTo(d,p+o,d,p+o-u),l.lineTo(d,p+u),l.quadraticCurveTo(d,p,d+u,p),l.closePath(),l.clip(),h.draw(0,0,a),!0},JO=qO;U();var QO=e=>{let{scene:t,key:i,newKey:s}=e,n=t.textures.get(i).getSourceImage();if(!n)return!1;let r=Math.min(n.width,n.height);s||t.textures.removeKey(i);let o=t.textures.createCanvas(s||i,r,r),a=o.context;return a.beginPath(),a.arc(r/2,r/2,r/2,0,Math.PI*2,!1),a.clip(),o.draw((n.width-r)/2,(n.height-r)/2,n),!0},$O=QO,tM=class extends Phaser.GameObjects.Container{payload;loading;photo;avtFrame;background;loadPhotoTimer;constructor(e,t){super(e),this.scene.add.existing(this),this.payload=t,this.setWorldSize(t.width,t.height),this.createBackground(),this.createLoading(),this.createPhoto(),this.createFrame();let{id:i,url:s,radius:n}=this.payload;i&&s&&this.loadPhoto(i,s,n),this.addDefaultListeners()}setFrame(e){this.avtFrame.revive(),this.avtFrame.setFrame(e)}setBackground(e){this.background.setFrame(e)}loadPhoto(e,t,i=0){if(this.payload.id=e,this.payload.url=t,this.payload.radius=i,this.loadPhotoTimer?.remove(),!e||!t){this.setPhoto(Xt.AVATAR_DEFAULT.KEY);return}let s=this.scene.textures.get(e);if(s&&s.key===e){this.handleLoadComplete(e);return}this.showLoading(!0);let n=this.payload.loadDelay||0;this.loadPhotoTimer=this.scene.time.delayedCall(n,this.handleLoadPhotoAfterDelay(e,t))}handleLoadPhotoAfterDelay=(e,t)=>()=>{let i=this.scene.textures.get(e);if(i&&i.key===e){this.handleLoadComplete(e);return}this.scene.load.once(`filecomplete-image-${e}`,this.handleLoadComplete),this.scene.load.image(e,t),this.scene.load.start()};addDefaultListeners(){this.scene.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,this.handleLoadPhotoFailed),this.on(Phaser.GameObjects.Events.DESTROY,()=>{this.loadPhotoTimer?.remove(),this.scene.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR,this.handleLoadPhotoFailed)})}handleLoadComplete=e=>{if(!this.scene)return;let{id:t,radius:i=0}=this.payload;if(!t||t!==e)return;let s=`${t}_bordered_${i}`,n=i>0?s:t,r=this.scene.textures.get(n);if(r&&r.key===n){this.setPhoto(r.key);return}if(i!==0&&i<100){if(!JO({scene:this.scene,key:t,newKey:s,radius:i})){this.showLoading(!1);return}this.setPhoto(s)}else if(i===100){if(!$O({scene:this.scene,key:t,newKey:s})){this.showLoading(!1);return}this.setPhoto(s)}else this.setPhoto(t)};handleLoadPhotoFailed=e=>{e.key===this.payload.id&&this.setDefaultAvatar(e.key)};setDefaultAvatar(e){this.loadPhoto(e,Xt.AVATAR_DEFAULT.FILE,this.payload.radius)}createBackground(){let{key:e,background:t}=this.payload;this.background=this.scene.make.image({key:e,frame:t}),this.add(this.background)}createLoading(){this.loading=new Uw(this.scene);let{width:e,height:t}=this.payload;this.loading.setWorldSize(e,t),this.loading.kill(),this.add(this.loading)}createPhoto(){this.photo=this.scene.make.image({x:0,y:0,origin:{x:.5,y:.5},visible:!1}),this.add(this.photo)}createFrame(){let{key:e,frame:t}=this.payload;t?this.avtFrame=this.scene.make.image({key:e,frame:t}):this.avtFrame=this.scene.make.image({x:0,y:0,origin:{x:.5,y:.5},visible:!1}),this.add(this.avtFrame)}showLoading(e){e?(this.loading.revive(),this.photo.kill()):(this.loading.kill(),this.photo.revive())}setPhoto(e){this.showLoading(!1),this.photo.setTexture(e),this.photo.setFrame(0);let{width:t,height:i}=this.payload,s=Math.min(t,i);this.photo.setWorldSize(s,s),Phaser.Display.Align.In.Center(this.photo,this.background)}},ss=tM;U(),U();var eM=class extends Phaser.GameObjects.Particles.Particle{scale;update(e,t,i){let s=super.update(e,t,i);return this.updateScale(),this.updateVelocity(),s}setScale(e){this.scale=Phaser.Math.FloatBetween(e.min,e.max)}easeInCubic(e){return e*e*e}updateScale(){let e=this.easeInCubic(1-this.lifeT);this.scaleX=this.scale*Math.sin(e*Math.PI),this.scaleY=this.scale*Math.sin(e*Math.PI)}updateVelocity(){this.velocityX+=Phaser.Math.Between(-1,1)}},iM=eM,{KEY:sM,FRAME:nM}=G.EFFECTS,rM=class extends Phaser.GameObjects.Container{emitZone;emitter;constructor(e){super(e),this.scene=e,this.createEmitZone(),this.createEmitters()}createEmitZone(){this.emitZone=new Phaser.Geom.Rectangle}createEmitters(){this.emitter=this.scene.add.particles(0,0,sM,{frame:nM.FX_STAR_YELLOW,emitZone:{source:this.emitZone,type:"random"},deathZone:{source:this.emitZone,type:"onLeave"},frequency:200,speedX:{min:-1,max:1},speedY:{min:-9,max:-13},lifespan:{min:1e3,max:1500},scale:{min:.01,max:.015},emitCallback:e=>{e.setScale({min:.3,max:.7})},particleClass:iM}),this.add(this.emitter)}run(e,t,i,s,n){this.stop(),this.emitZone.setSize(s,n),this.emitZone.setPosition(t-s/2,i-n/2),this.emitter.setQuantity(e),this.emitter.start()}stop(){this.emitter?.killAll(),this.emitter?.stop()}},ur=rM,{KEY:Zs,FRAME:qs}=G.DEFAULT,{KEY:Ke,FRAME:Ee}=G.CHALLENGE,Eo=class extends At{scaleDown=.98},aM=class extends Phaser.GameObjects.Container{popup;winTitle;loseTitle;drawTitle;waitTitle;iconCrown;leftAvatar;rightAvatar;leftScore;rightScore;homeButton;restartButton;newMatchButton;challengeButton;starSparkle;set onHomeClick(e){this.homeButton&&typeof e=="function"&&(this.homeButton.onClick=e,this.homeButton.setDisabled(!1))}set onRestartClick(e){this.restartButton&&typeof e=="function"&&(this.restartButton.onClick=e,this.restartButton.setDisabled(!1))}set onNewMatchClick(e){this.newMatchButton&&typeof e=="function"&&(this.newMatchButton.onClick=e,this.newMatchButton.setDisabled(!1))}set onChallengeClick(e){this.challengeButton&&typeof e=="function"&&(this.challengeButton.onClick=e,this.challengeButton.setDisabled(!1))}constructor(e){super(e),this.createPopup(),this.updateSize(),this.createBackground(),this.createResultInfo(),this.createButtons(),this.createEffects(),this.setDepth($.POPUP),this.scene.add.existing(this)}createPopup(){this.popup=this.scene.add.container(0,0),this.popup.setWorldSize(375,667),this.add(this.popup)}createBackground(){let e=this.scene.make.image({key:Ke,frame:Ee.POPUP});this.popup.add(e)}createEffects(){this.createStarSparkle()}createStarSparkle(){this.starSparkle=new ur(this.scene),this.popup.add(this.starSparkle)}createResultInfo(){this.createCrown(),this.createAvatars(),this.createScorePanel(),this.createScoreText(),this.createResultTexts()}createCrown(){this.iconCrown=this.scene.make.image({x:0,y:-130,key:Ke,frame:Ee.CROWN,visible:!1,origin:{x:.5,y:.5}}),this.popup.add(this.iconCrown)}createAvatars(){let e={key:Ke,width:84,height:84,radius:12,frame:Ee.AVATAR_BIG_FRAME,background:Ee.AVATAR_BIG};this.leftAvatar=new ss(this.scene,e),this.leftAvatar.setPosition(-80,-73),this.leftAvatar.loading.setAlpha(0),this.rightAvatar=new ss(this.scene,e),this.rightAvatar.setPosition(80,-73),this.rightAvatar.loading.setAlpha(0),this.popup.add(this.leftAvatar),this.popup.add(this.rightAvatar)}createScorePanel(){let e=this.scene.make.image({key:Ke,frame:Ee.SCORE_PANEL,x:-80}),t=this.scene.make.image({key:Ke,frame:Ee.SCORE_PANEL,x:80});this.popup.add([e,t])}createScoreText(){this.leftScore=X.createText(this.scene,"",20).setFontStyle("700").setOrigin(.5,.5).setPosition(-80,0),X.applyYellowStyle(this.leftScore),this.rightScore=X.createText(this.scene,"",20).setFontStyle("700").setOrigin(.5,.5).setPosition(80,0),X.applyYellowStyle(this.rightScore),this.popup.add([this.leftScore,this.rightScore])}createResultTexts(){let e={key:Ke,x:0,y:-187,visible:!0};this.winTitle=this.scene.make.image({...e,frame:Ee.WIN}),this.loseTitle=this.scene.make.image({...e,frame:Ee.LOSE}),this.drawTitle=this.scene.make.image({...e,frame:Ee.DRAW}),this.waitTitle=this.scene.make.image({...e,frame:Ee.WAITING}),this.popup.add([this.winTitle,this.loseTitle,this.drawTitle,this.waitTitle])}createButtons(){this.createBGButtons(),this.createHomeButton(),this.createRestartButton(),this.createNewMatchButton(),this.createChallengeButton()}createBGButtons(){let e=this.scene.make.image({key:Zs,frame:qs.BUTTON_FRAME,y:80}),t=this.scene.make.image({key:Zs,frame:qs.BUTTON_FRAME,y:150});this.popup.add([e,t])}createHomeButton(){this.homeButton=new Eo(this.scene,Zs,qs.BUTTON_BLUE),this.homeButton.setDisabled(!0);let e=this.scene.make.image({key:Ke,frame:Ee.ICON_HOME,x:-50}),t=X.createText(this.scene,"Home",20).setFontStyle("900").setPosition(10,0);X.applyBlueStyle(t),this.homeButton.add([e,t]),this.popup.add(this.homeButton),Phaser.Display.Align.In.Center(this.homeButton,this.popup,0,150)}createRestartButton(){this.restartButton=new Eo(this.scene,Zs,qs.BUTTON_YELLOW),this.restartButton.setVisible(!1),this.restartButton.setDisabled(!0);let e=this.scene.make.image({key:Ke,frame:Ee.ICON_REPLAY,x:-50}),t=X.createText(this.scene,"Restart",20).setFontStyle("900").setPosition(10,0);X.applyOrangeStyle(t),this.restartButton.add([e,t]),this.popup.add(this.restartButton),Phaser.Display.Align.In.Center(this.restartButton,this.popup,0,80)}createNewMatchButton(){this.newMatchButton=new Eo(this.scene,Zs,qs.BUTTON_GREEN),this.newMatchButton.setVisible(!1),this.newMatchButton.setDisabled(!0);let e=this.scene.make.image({key:Ke,frame:Ee.ICON_CONTINUE,x:-55}),t=X.createText(this.scene,"New Game",20).setFontStyle("900").setPosition(15,0);X.applyGreenStyle(t),this.newMatchButton.add([e,t]),this.popup.add(this.newMatchButton),Phaser.Display.Align.In.Center(this.newMatchButton,this.popup,0,80)}createChallengeButton(){this.challengeButton=new Eo(this.scene,Zs,qs.BUTTON_GREEN),this.challengeButton.setVisible(!1),this.challengeButton.setDisabled(!0);let e=this.scene.make.image({key:Ke,frame:Ee.ICON_INVITE,x:-65}),t=X.createText(this.scene,"Invite Friends",18).setFontStyle("900").setPosition(16,0);X.applyGreenStyle(t),this.challengeButton.add([e,t]),this.popup.add(this.challengeButton),Phaser.Display.Align.In.Center(this.challengeButton,this.popup,0,80)}updateSize(){let{displayWidth:e,displayHeight:t}=this.popup;this.setSize(e,t)}setResult(e,t){let i=e==="win",s=e==="draw",n=e==="lose",r=e==="waiting";i&&this.starSparkle.run(3,0,-180,260,90);let o=i||n;if(this.iconCrown.setVisible(o),o){let a=t==="left"?-80:80;this.iconCrown.setX(a)}this.winTitle.setVisible(i),this.loseTitle.setVisible(n),this.drawTitle.setVisible(s),this.waitTitle.setVisible(r),this.restartButton.setVisible(n||s),this.newMatchButton.setVisible(i),this.challengeButton.setVisible(r)}setScores(e,t){let i=e>=0?e:"???",s=t>=0?t:"???";this.leftScore.setText(`${i}`),this.rightScore.setText(`${s}`)}setAvatars(e){let{playerId:t,opponentId:i,playerAvatar:s,opponentAvatar:n}=e;this.leftAvatar.loadPhoto(t,s,20),this.rightAvatar.loadPhoto(i,n,20)}},oM=aM,{event:eC}=codex,hM=class extends ue{t;gt;st;constructor(e,t){super(e,t),this.$(),this.setDepth(me.POPUP)}open=e=>{super.open(e),this.Vi(),nt.setVolumeMusic(0,!0),this.et()};Vi(){let[e,t]=this.getData(["playerScore","opponentScore"]),i=e>t,s=e===t,n=e<t,r=e>0&&t>0?s?"draw":i?"win":"lose":"waiting",o=i?"left":"right";i&&nt.playSound(ut.LEVEL_COMPLETE),n&&nt.playSound(ut.LEVEL_FAIL),this.t.setResult(r,o),this.t.setScores(e,t);let[a,h,l,u]=this.getData(["playerId","opponentId","playerAvatar","opponentAvatar"]);this.t.setAvatars({playerId:a,opponentId:h,playerAvatar:l,opponentAvatar:u})}$(){this.t=new oM(this.scene),this.add(this.t),this.t.onHomeClick=this.Sa,this.t.onRestartClick=this.Aa,this.t.onNewMatchClick=this.wa,this.t.onChallengeClick=this.Ca;let e=pt.getBannerHeight()/2;Phaser.Display.Align.In.Center(this.t,this.zone,0,-e)}Sa=()=>{this.l(),setTimeout(()=>{It.switchToDashboardScene()},250)};wa=async()=>{await this.Zs()};Ca=async()=>{await this.Zs()};Aa=async()=>{await this.Pa()};Pa=async()=>{let e=this.getData("opponentId");await ht.startChallengeModeAsync(e)&&(this.l(),eC.emit(j.REPLAY))};Zs=async()=>{await ht.startChallengeChooseOpponentAsync()&&(this.l(),eC.emit(j.REPLAY))};et(){this.background.setAlpha(0),this.animateBackgroundAlpha(.6),this.ft(0,300)}l(){this.animateBackgroundAlpha(0,200),this.ht(0,200)}ft(e,t){let i=pt.getBannerHeight()/2;this.gt=this.scene.tweens.add({...se,targets:[this.t],delay:e,duration:t,props:{...se.props,y:{from:350-i,to:-i},alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:1}}}),J.runTween(this.gt)}ht(e,t){let i=pt.getBannerHeight()/2;this.st=this.scene.tweens.add({...Nt,targets:[this.t],delay:e,duration:t,props:{...Nt.props,y:250-i,scale:0},onComplete:()=>{this.t.setY(0),ot.closeScreen(this.name)}}),J.runTweenAsync(this.st)}},lM=hM;U(),U(),U(),U(),U(),U();var uM={STATUS:{READY:"ready",RUNNING:"running",STOPPED:"stopped"}},iC=uM,{STATUS:Js}=iC,cM=class{it;scene;constructor(e){this.scene=e}init(){this.setState(Js.READY)}start(){this.isRunning()||this.setState(Js.RUNNING)}stop(){this.isRunning()&&this.setState(Js.STOPPED)}setState(e){this.it=e}isReady(){return this.it===Js.READY}isRunning(){return this.it===Js.RUNNING}isStopped(){return this.it===Js.STOPPED}},Ne=cM;U();var{KEY:dM,TEXTURE:pM,FRAME_RATE:gM,END:fM,PREFIX:mM,ZERO_PAD:vM}=ne.BOMB_DEFUSE,EM=class extends Phaser.Animations.Animation{constructor(e){let t={repeat:0,frameRate:gM,frames:e.generateFrameNames(pM,{prefix:mM,end:fM,zeroPad:vM}),showOnStart:!0,hideOnComplete:!0,skipMissedFrames:!0};super(e,dM,t)}},yM=EM;U();var{KEY:TM,TEXTURE:xM,FRAME_RATE:SM,END:AM,PREFIX:wM,ZERO_PAD:CM}=ne.BOMB_EXPLOSION,PM=class extends Phaser.Animations.Animation{constructor(e){let t={repeat:0,frameRate:SM,frames:e.generateFrameNames(xM,{prefix:wM,end:AM,zeroPad:CM}),showOnStart:!0,hideOnComplete:!0,skipMissedFrames:!0};super(e,TM,t)}},RM=PM;U();var{KEY:bM,TEXTURE:IM,FRAME_RATE:_M,END:OM,PREFIX:MM,ZERO_PAD:LM}=ne.POLISH_EFFECT,DM=class extends Phaser.Animations.Animation{constructor(e){let t={repeat:0,frameRate:_M,frames:e.generateFrameNames(IM,{prefix:MM,end:OM,zeroPad:LM}),showOnStart:!0,hideOnComplete:!0,skipMissedFrames:!0};super(e,bM,t)}},kM=DM;U();var{KEY:FM,TEXTURE:NM,FRAME_RATE:BM,END:UM,PREFIX:GM,ZERO_PAD:YM}=ne.ROCKET_EXPLOSION,HM=class extends Phaser.Animations.Animation{constructor(e){let t={repeat:0,frameRate:BM,frames:e.generateFrameNames(NM,{prefix:GM,end:UM,zeroPad:YM}),showOnStart:!0,hideOnComplete:!0,skipMissedFrames:!0};super(e,FM,t)}},zM=HM;U();var{KEY:WM,TEXTURE:VM,FRAME_RATE:XM,END:KM,PREFIX:jM,ZERO_PAD:ZM}=ne.ROCKET_TAIL,qM=class extends Phaser.Animations.Animation{constructor(e){let t={repeat:-1,frameRate:XM,frames:e.generateFrameNames(VM,{prefix:jM,end:KM,zeroPad:ZM}),showOnStart:!0,hideOnComplete:!0,skipMissedFrames:!0};super(e,WM,t)}},JM=qM;U();var{KEY:QM,TEXTURE:$M,FRAME_RATE:tL,END:eL,PREFIX:iL,ZERO_PAD:sL}=ne.TILE_HIGHLIGHT,nL=class extends Phaser.Animations.Animation{constructor(e){let t={repeat:-1,frameRate:tL,frames:e.generateFrameNames($M,{prefix:iL,end:eL,zeroPad:sL}),showOnStart:!0,hideOnComplete:!0,skipMissedFrames:!0};super(e,QM,t)}},rL=nL,aL=class extends Ne{scene;moveDuration=500;isMoveTilesCompleted;Xi;constructor(e){super(e),this.scene=e,this.isMoveTilesCompleted=!0,this.Ra()}start(){this.isMoveTilesCompleted=!0}Ra(){let{POLISH_EFFECT:e,BOMB_EXPLOSION:t,BOMB_DEFUSE:i,ROCKET_EXPLOSION:s,ROCKET_TAIL:n,TILE_HIGHLIGHT:r}=ne,o=new JM(this.scene.anims),a=new yM(this.scene.anims),h=new kM(this.scene.anims),l=new RM(this.scene.anims),u=new zM(this.scene.anims),d=new rL(this.scene.anims);this.scene.anims.add(i.KEY,a),this.scene.anims.add(n.KEY,o),this.scene.anims.add(e.KEY,h),this.scene.anims.add(t.KEY,l),this.scene.anims.add(s.KEY,u),this.scene.anims.add(r.KEY,d)}prepareStartBoardAnimation(e){let{boardManager:t,levelHandler:i}=this.scene,{rows:s,columns:n}=i.getConfigs(),r=t.getTileSizeWithSpacing(),o=t.boardMap[1][1],a=o.x+r*(n-1)/2,h=o.y+r*(s-1)/2,l=a,u=h,d=[];for(let p of e){let{x:g,y:c,scale:f}=p;d.push({x:g,y:c,scale:f}),p.setX(l),p.setY(u),p.setAlpha(0),p.setScale(0)}return d}runStartBoardAnimation(e,t){let i=600/e.length;return this.scene.tweens.add({targets:e,duration:600,props:{y:{value:{getEnd:(s,n,r,o)=>t[o].y},duration:600-600/12},x:{value:{getEnd:(s,n,r,o)=>t[o].x},duration:600-600/5},scale:{value:{getEnd:(s,n,r,o)=>t[o].scale},delay:0},alpha:{value:1,duration:500}},delay:(s,n,r,o)=>{let a=Phaser.Math.RND.between(0,i*o/2);return i*o-a}})}startBoard(e){let t=this.prepareStartBoardAnimation(e);return this.runStartBoardAnimation(e,t)}pairWrong(e,t=2){if(this.Xi?.remove(),t<1)return;let i=Math.random()*3-3,s={x:`+=${i}`,y:`-=${i}`},n={targets:e,duration:30,yoyo:!0,props:s,ease:Phaser.Math.Easing.Expo.Out};this.Xi=this.scene.add.tween({...n,onComplete:()=>{s.x=`-=${i}`,s.y=`+=${i}`,this.Xi=this.scene.add.tween({...n,onComplete:()=>{this.pairWrong(e,t-1)}})}})}capturing(e){e.forEach((t,i)=>{t.explosive(i)})}moveRows(e,t=0,i){let{tile:s,fromRow:n,toRow:r}=e;if(!n||!r)return;this.isMoveTilesCompleted=!1,this.Ki(s);let o=this.scene.boardManager.getTileSizeWithSpacing(),a=r*o-n*o,h=s.y+a;s.nextY=h,this.scene.tweens.add({targets:[s],delay:t,duration:i||this.moveDuration,completeDelay:300,ease:Phaser.Math.Easing.Quartic.InOut,props:{y:h},onUpdate:()=>{this.isMoveTilesCompleted=!1},onStop:()=>{s.setY(h),s.nextY=null},onComplete:()=>{s.nextY=null,this.isMoveTilesCompleted=!0}})}moveColumns(e,t=0,i){let{tile:s,fromColumn:n,toColumn:r}=e;if(!n||!r)return;this.isMoveTilesCompleted=!1,this.Ki(s);let o=this.scene.boardManager.getTileSizeWithSpacing(),a=r*o-n*o,h=s.x+a;s.nextX=h,this.scene.tweens.add({targets:[s],delay:t,duration:i||this.moveDuration,completeDelay:300,ease:Phaser.Math.Easing.Quartic.InOut,props:{x:h},onUpdate:()=>{this.isMoveTilesCompleted=!1},onStop:()=>{s.setX(h),s.nextX=null},onComplete:()=>{s.nextX=null,this.isMoveTilesCompleted=!0}})}moveRowsAndColumns(e,t=0,i){let{tile:s,fromRow:n,toRow:r,fromColumn:o,toColumn:a}=e;if(!n||!r||!o||!a)return;this.isMoveTilesCompleted=!1,this.Ki(s);let h=this.scene.boardManager.getTileSizeWithSpacing(),l=a*h-o*h,u=r*h-n*h,d=s.x+l,p=s.y+u;s.nextX=d,s.nextY=p,this.scene.tweens.add({targets:[s],delay:t,duration:i||this.moveDuration,completeDelay:300,ease:Phaser.Math.Easing.Quartic.InOut,props:{x:d,y:p},onUpdate:()=>{this.isMoveTilesCompleted=!1},onStop:()=>{s.setX(d),s.setY(p),s.nextX=null,s.nextY=null},onComplete:()=>{s.nextX=null,s.nextY=null,this.isMoveTilesCompleted=!0}})}Ki(e){let t=this.scene.tweens.getTweensOf(e);for(let i of t)i.stop(),e.nextX&&e.setX(e.nextX),e.nextY&&e.setX(e.nextY),e.nextX=null,e.nextY=null;this.scene.tweens.killTweensOf(e)}},oL=aL;U(),U();var hL=class{scene;tileSize;constructor(e){this.scene=e,this.tileSize=0}getTileSize(){return this.tileSize||tt.SIZE}calculateTileSize(){this.tileSize=0;let{rows:e,columns:t}=this.scene.levelHandler.getConfigs(),{width:i,height:s}=this.scene.gameZone,{height:n}=this.scene.layoutManager.objects.topFooterBG,r=pt.getBannerHeight(),{height:o}=this.scene.layoutManager.objects.headerBG,a=n+r,h=.5+e+.5,l=.5+t+.5,u=i,d=pt.getBannerHeight(),p=s-o;lt.isLandscape()?p-=d:p-=a;let g=Math.floor(u/l),c=Math.floor(p/h);this.tileSize=Math.min(g,c,tt.SIZE)}getBoardSize(){let{rows:e,columns:t}=this.scene.levelHandler.getConfigs(),i=this.getTileSize()*t,s=this.getTileSize()*e;return{width:i,height:s}}},lL=hL;U();var uL={STATUS:{READY:"ready",RUNNING:"running",STOPPED:"stopped"}},ns=uL;U(),U();var cL=35,dL=3,pL=class extends Phaser.GameObjects.Graphics{tileSize;rectRadius;topLeftCurve;topRightCurve;bottomRightCurve;bottomLeftCurve;constructor(e,t,i){super(e),this.tileSize=t||cL,this.rectRadius=i||dL,this.setDepth($.TILE+1),this.createCurves(),this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.update),this.scene.add.existing(this)}createCurves(){let e=this.rectRadius,t=this.tileSize,i=t-2*e;this.topRightCurve=new Phaser.Curves.QuadraticBezier(new Phaser.Math.Vector2(i/2,-t/2),new Phaser.Math.Vector2(t/2,-t/2),new Phaser.Math.Vector2(t/2,-i/2)),this.topLeftCurve=new Phaser.Curves.QuadraticBezier(new Phaser.Math.Vector2(-t/2,-i/2),new Phaser.Math.Vector2(-t/2,-t/2),new Phaser.Math.Vector2(-i/2,-t/2)),this.bottomLeftCurve=new Phaser.Curves.QuadraticBezier(new Phaser.Math.Vector2(-i/2,t/2),new Phaser.Math.Vector2(-t/2,t/2),new Phaser.Math.Vector2(-t/2,i/2)),this.bottomRightCurve=new Phaser.Curves.QuadraticBezier(new Phaser.Math.Vector2(t/2,i/2),new Phaser.Math.Vector2(t/2,t/2),new Phaser.Math.Vector2(i/2,t/2))}stop(){this.clear(),this.scene.events.off(Phaser.Scenes.Events.UPDATE,this.update)}drawCountdown(e,t){let i=this.tileSize,s=this.rectRadius,n=i-2*s,r=Math.atan(n/i),o=Math.PI/2-2*r,a=e/t*2*Math.PI;if(this.clear(),this.lineStyle(0,0,1),this.fillStyle(0,.25),a!==0){if(a===Math.PI*2){this.fillRoundedRect(-i/2,-i/2,i,i,s);return}if(this.beginPath(),this.moveTo(0,0),this.lineTo(0,-i/2),a>r)this.lineTo(n/2,-i/2),a-=r;else{this.lineTo(Math.tan(a)*i/2,-i/2),this.lineTo(0,0),this.closePath(),this.fillPath();return}if(this.lineTo(0,0),this.closePath(),this.fillPath(),a>o)this.slice(n/2,-n/2,s,-Math.PI/2,0,!1),a-=o,this.fillPath(),this.beginPath(),this.moveTo(0,0),this.lineTo(n/2,-i/2),this.lineTo(n/2,-n/2),this.lineTo(i/2,-n/2),this.lineTo(0,0),this.closePath(),this.fillPath();else{let h=a/o;this.beginPath(),this.arc(n/2,-n/2,s,-Math.PI/2,-Math.PI/2+h*Math.PI/2,!1),this.fillPath();let l=this.topRightCurve.getPoint(h);this.beginPath(),this.moveTo(0,0),this.lineTo(n/2,-i/2),this.lineTo(l.x,l.y),this.lineTo(0,0),this.closePath(),this.fillPath();return}if(this.beginPath(),this.moveTo(0,0),this.lineTo(i/2,-n/2),a>r)this.lineTo(i/2,0),a-=r;else{this.lineTo(i/2,-n/2- -Math.tan(a)*i/2),this.lineTo(0,0),this.closePath(),this.fillPath();return}if(this.lineTo(0,0),this.closePath(),this.fillPath(),this.beginPath(),this.moveTo(0,0),this.lineTo(i/2,0),a>r)this.lineTo(i/2,n/2),a-=r;else{this.lineTo(i/2,Math.tan(a)*i/2),this.lineTo(0,0),this.closePath(),this.fillPath();return}if(this.lineTo(0,0),this.closePath(),this.fillPath(),a>o)this.slice(n/2,n/2,s,0,Math.PI/2,!1),a-=o,this.fillPath(),this.beginPath(),this.moveTo(0,0),this.lineTo(i/2,n/2),this.lineTo(n/2,n/2),this.lineTo(n/2,i/2),this.lineTo(0,0),this.closePath(),this.fillPath();else{let h=a/o;this.beginPath(),this.arc(n/2,n/2,s,0,h*Math.PI/2,!1),this.fillPath();let l=this.bottomRightCurve.getPoint(h);this.beginPath(),this.moveTo(0,0),this.lineTo(i/2,n/2),this.lineTo(l.x,l.y),this.lineTo(0,0),this.closePath(),this.fillPath();return}if(this.beginPath(),this.moveTo(0,0),this.lineTo(n/2,i/2),a>r)this.lineTo(0,i/2),a-=r;else{this.lineTo(n/2-Math.tan(a)*i/2,i/2),this.lineTo(0,0),this.closePath(),this.fillPath();return}if(this.lineTo(0,0),this.closePath(),this.fillPath(),this.beginPath(),this.moveTo(0,0),this.lineTo(0,i/2),a>r)this.lineTo(-n/2,i/2),a-=r;else{this.lineTo(-Math.tan(a)*i/2,i/2),this.lineTo(0,0),this.closePath(),this.fillPath();return}if(this.lineTo(0,0),this.closePath(),this.fillPath(),a>o)this.slice(-n/2,n/2,s,Math.PI/2,Math.PI,!1),a-=o,this.fillPath(),this.beginPath(),this.moveTo(0,0),this.lineTo(-n/2,i/2),this.lineTo(-n/2,n/2),this.lineTo(-i/2,n/2),this.lineTo(0,0),this.closePath(),this.fillPath();else{let h=a/o;this.beginPath(),this.arc(-n/2,n/2,s,Math.PI/2,Math.PI/2+h*Math.PI/2,!1),this.fillPath();let l=this.bottomLeftCurve.getPoint(h);this.beginPath(),this.moveTo(0,0),this.lineTo(-n/2,i/2),this.lineTo(l.x,l.y),this.lineTo(0,0),this.closePath(),this.fillPath();return}if(this.beginPath(),this.moveTo(0,0),this.lineTo(-i/2,n/2),a>r)this.lineTo(-i/2,0),a-=r;else{this.lineTo(-i/2,n/2-Math.tan(a)*i/2),this.lineTo(0,0),this.closePath(),this.fillPath();return}if(this.lineTo(0,0),this.closePath(),this.fillPath(),this.beginPath(),this.moveTo(0,0),this.lineTo(-i/2,0),a>r)this.lineTo(-i/2,-n/2),a-=r;else{this.lineTo(-i/2,-Math.tan(a)*i/2),this.lineTo(0,0),this.closePath(),this.fillPath();return}if(this.lineTo(0,0),this.closePath(),this.fillPath(),a>o)this.slice(-n/2,-n/2,s,Math.PI,3*Math.PI/2,!1),a-=o,this.fillPath(),this.beginPath(),this.moveTo(0,0),this.lineTo(-i/2,-n/2),this.lineTo(-n/2,-n/2),this.lineTo(-n/2,-i/2),this.lineTo(0,0),this.closePath(),this.fillPath();else{let h=a/o;this.beginPath(),this.arc(-n/2,-n/2,s,Math.PI,Math.PI+h*Math.PI/2,!1),this.fillPath();let l=this.topLeftCurve.getPoint(h);this.beginPath(),this.moveTo(0,0),this.lineTo(-i/2,-n/2),this.lineTo(l.x,l.y),this.lineTo(0,0),this.closePath(),this.fillPath();return}if(this.beginPath(),this.moveTo(0,0),this.lineTo(-n/2,-i/2),a>r)this.lineTo(0,-i/2),a-=r;else{this.lineTo(-n/2- -Math.tan(a)*i/2,-i/2),this.lineTo(0,0),this.closePath(),this.fillPath();return}this.lineTo(0,0),this.closePath(),this.fillPath()}}},sC=pL;U(),U(),U();var{KEY:gL,FRAME:fL}=G.GAMEPLAY,mL=class extends Phaser.GameObjects.Container{deathZone;emitter;constructor(e){super(e),this.createDeathZone(),this.createEmitters(),this.kill(),this.scene.add.existing(this)}createDeathZone(){this.deathZone=new Phaser.Geom.Circle}createEmitters(){this.emitter=this.scene.add.particles(0,0,gL,{frame:fL.EFFECT_SPARK,speed:{min:100,max:250},scale:{min:.5,max:.9},alpha:{min:.8,max:1},deathZone:{source:this.deathZone,type:"onLeave"}})}explode(e,t,i,s){this.revive(),this.deathZone.radius=s,this.deathZone.setPosition(t,i),this.emitter.explode(e,t,i)}},nC=mL,vL=class extends nC{explode(e,t,i,s){super.explode(e,t,i,s),this.runParticleTween()}runParticleTween(){let e=0;this.emitter.forEachAlive(t=>{this.scene.tweens.killTweensOf(t),this.scene.tweens.add({targets:[t],duration:400,delay:5*e,ease:Phaser.Math.Easing.Circular.Out,props:{velocityX:t.velocityX/50,velocityY:t.velocityY/50},onComplete:()=>{e++,this.scene.add.tween({targets:[t],duration:800,delay:10*e,ease:Phaser.Math.Easing.Circular.Out,props:{alpha:0,scaleX:0,scaleY:0},onComplete:()=>{t.lifeCurrent=0},onStop:()=>{t.lifeCurrent=0}})}})},this)}},EL=vL,{Utils:{Object:yL}}=Ludex,{GAMEPLAY:rC,EFFECTS:aC,TILES:Id}=G,{STATUS:Qs}=tt,TL=class extends Phaser.GameObjects.Container{scene;nextX;nextY;row;column;color;frame;isBreakWhenExplosive;block;icon;polishEffect;explodeParticle;unselectAnimation;selectAnimation;extraSpawnEffect;constructor(e,t,i){super(e,0,0),this.scene=e,i&&(this.color=i),this.nextX=null,this.nextY=null,this.isBreakWhenExplosive=!1,this.setWorldSize(65,65),this.setDepth($.TILE),t&&(this.frame=t,this.drawBlock(t)),this.ba(),this.scene.add.existing(this),this.setState(Qs.READY)}show(){this.setVisible(!0),this.block.setVisible(!0)}setRow(e){this.row=e}setColumn(e){this.column=e}setIsBreakWhenExplosive(e){this.isBreakWhenExplosive=e}Ia(){this.off(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.qs,this),this.off(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.qs,this)}createInput(){this.off(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.Js,this),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.Js,this)}showHighlight(){this.scene.effectManager.playTileHighlightEffect(this),this.scene.boardManager.boardContainer.bringToTop(this)}hideHighlight(){let{effectManager:e}=this.scene;e.getCurrentlyHighlightedTile()===this&&e.stopTileHighlightEffect()}explosive(e){this.scene&&(this.nextX&&this.setX(this.nextX),this.nextY&&this.setY(this.nextY),this.explosiveAnimation())}Js(){let{tileManager:e}=this.scene;e.isSelectable&&(this.Ia(),this._a())}qs(){let{tileManager:e}=this.scene;e.isSelectable&&this.Oa()}getExplosiveAnimationKey=()=>null;explosiveAnimation(){if(!this.icon?.anims)return;if(this.isBreakWhenExplosive){let{effectManager:t}=this.scene;t.playTileBreakEffect(this),nt.playSound(ut.BOMB_EXPLODE_1),this.onExplosive();return}let e=this.getExplosiveAnimationKey();if(!e){let{x:t,y:i}=this.getWorldPosition();this.explodeParticle.explode(20,t,i,20),this.onExplosive();return}this.icon.once(Phaser.Animations.Events.ANIMATION_COMPLETE,()=>{this.onExplosive()}),this.icon.anims.play(e,!0)}onExplosive(){this.hideHighlight(),this.hidePolishEffect(),this.scene.boardManager.boardContainer.bringToTop(this),this.scene.tweens.killTweensOf(this),this.scene.tweens.add({targets:[this],duration:200,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:0},onComplete:()=>{this.removeTile()}})}enableTile(){let e=this.scene.boardManager.getTileSize();this.block.setWorldSize(e,e),this.revive(),this.setState(Qs.READY)}changeDeck(e){let t=e.toUpperCase();if(!t)return;let i=Id[t].KEY,s=`tile-${this.color}`,n=this.scene.boardManager.getTileSize();this.icon.setTexture(i),this.icon.setFrame(s);let r=this.icon.displayWidth/this.icon.scaleX,o=this.icon.displayHeight/this.icon.scaleY,a=n/r*.85,h=n/o*.85;this.icon.setScale(Math.min(a,h))}removeTile(){if(!this.scene)return;this.setScale(1);let{tileManager:e}=this.scene;e.removeTile(this)}drawBlock(e){let t=this.scene.boardManager.getTileSize();this.block=this.scene.add.image(0,0,rC.KEY,rC.FRAME.TILE_BG),this.block.setWorldSize(t,t),this.add(this.block);let{currentDeckPrefix:i}=this.scene.tileManager,s=i.toUpperCase();if(!yL.hasOwn(Id,s))return;let n=Id[s];if(!n)return;this.icon=this.scene.make.sprite({key:n.KEY,frame:e});let r=this.icon.displayWidth/this.icon.scaleX,o=this.icon.displayHeight/this.icon.scaleY,a=t/r*.85,h=t/o*.85;this.icon.setScale(Math.min(a,h)),this.add(this.icon)}ba(){this.explodeParticle=new EL(this.scene)}Ma(){this.polishEffect=this.scene.add.sprite(0,0,aC.KEY,`${aC.FRAME.POLISH_EFFECT}0`),this.polishEffect.setDisplaySize(40,40),this.polishEffect.setAlpha(.8),this.polishEffect.setVisible(!1),this.add(this.polishEffect)}_a(){this.scene&&(this.selectAnimation?.stop(),this.selectAnimation=this.scene.tweens.add({...Hs,targets:[this],duration:166,yoyo:!0,ease:Phaser.Math.Easing.Cubic.InOut,props:{scale:{start:1,to:.8}}}))}Oa(){this.scene&&(this.unselectAnimation?.stop(),this.unselectAnimation=this.scene.tweens.add({...rr,targets:[this],duration:100,props:{scale:1}}))}runExtraSpawnEffect(){this.extraSpawnEffect?.stop();let e=this.scaleX,t=this.scaleY;this.setScale(e*.3,t*.3),this.extraSpawnEffect=this.scene.tweens.add({targets:this,duration:200,props:{scaleX:{from:e*.3,to:e},scaleY:{from:t*.3,to:t}},onComplete:()=>{this.Qs()},onStop:()=>{this.Qs(),this.setScale(e,t)}})}Qs(){this.polishEffect||this.Ma();let e=this.scene.boardManager.getTileSize();this.polishEffect.setVisible(!0),this.polishEffect.setWorldSize(e,e),this.polishEffect.play(ne.POLISH_EFFECT.KEY,!0)}hidePolishEffect(){this.polishEffect?.setVisible(!1)}getIcon(){return this.icon}isReady(){return this.state===Qs.READY}isMoving(){return this.state===Qs.MOVING}isCapturing(){return this.state===Qs.CAPTURING}isCaptured(){return this.state===Qs.CAPTURED}},rs=TL,{KEY:xL,FRAME:oC}=G.GAMEPLAY,{SPECIALS:SL}=tt,{BOMB_EXPLOSION:AL,BOMB_DEFUSE:wL}=ne,{BombCountDownTime:_d,DelayEndGame:CL}=Lt,PL=class extends rs{bombCountdown;bombTimer;remainingTime;bombIcon;bombIconTween;reason="pair";isTickingSoundPlaying;tickingSoundEvent;isPaused;constructor(e,t,i){super(e,oC.TILE_BOMB,SL.BOMB),this.setName("BombTile"),this.isTickingSoundPlaying=!1,this.isPaused=!1,this.setRow(t),this.setColumn(i),this.createIconBomb(),this.createBombCountdownEffect(),this.runBombIconTween(),this.listenToBombEvents(),this.scene.events.on(tt.EVENTS.FIRST_INTERACTION,this.startCountdown)}listenToBombEvents(){this.removeBombListeners(),this.scene.events.on(tt.EVENTS.PAUSE_BOMB_TIMER,this.pauseBombTimer),this.scene.events.on(tt.EVENTS.RESUME_BOMB_TIMER,this.resumeBombTimer),this.scene.events.on(tt.EVENTS.BOMB_TIMER_RESCUE,this.increaseRemainingTimeOnRescue)}removeBombListeners(){this.scene.events.off(tt.EVENTS.PAUSE_BOMB_TIMER,this.pauseBombTimer),this.scene.events.off(tt.EVENTS.RESUME_BOMB_TIMER,this.resumeBombTimer),this.scene.events.off(tt.EVENTS.BOMB_TIMER_RESCUE,this.increaseRemainingTimeOnRescue)}handleInteractionEventAfterRescue(){this.scene.events.off(tt.EVENTS.INTERACTION,this.startTimer),this.scene.events.once(tt.EVENTS.INTERACTION,this.startTimer)}createIconBomb(){this.bombIcon=this.scene.add.image(0,0,xL,oC.ICON_BOMB);let e=this.scene.boardManager.getTileSize()/35;this.bombIcon.setWorldSize(16*e,17*e),this.bombIcon.setPosition(10*e,5*e),this.add(this.bombIcon)}createBombCountdownEffect(){this.bombCountdown=new sC(this.scene),this.bombCountdown.setPosition(0,0),this.add(this.bombCountdown)}enableTile(){super.enableTile(),this.listenToBombEvents(),this.isPaused=!1;let e=this.scene.boardManager.getTileSize()/35;this.bombIcon.setWorldSize(16*e,17*e),this.bombIcon.setPosition(10*e,5*e),this.reason="pair",this.bombIcon.revive(),this.isTickingSoundPlaying=!1}setState(e){return super.setState(e),e===tt.STATUS.CAPTURING&&this.removeBombListeners(),this}getExplosiveAnimationKey=()=>this.reason==="defuse"?wL.KEY:this.reason==="exploded"?AL.KEY:null;setColor(e,t){this.isCaptured()||(this.color=e,this.changeDeck(t))}startCountdown=()=>{if(this.active&&this.reason!=="defuse"){if(this.isPaused=!1,this.remainingTime=_d,this.isTickingSoundPlaying=!1,this.remainingTime<1){this.bombExplodeGrant();return}this.setUpCountdownEffect(),this.startTimer()}};setUpCountdownEffect(){let{boardContainer:e}=this.scene.boardManager;e.bringToTop(this)}setBombEffectWhenGameStarts(){let{boardContainer:e}=this.scene.boardManager;e.bringToTop(this);let t=this.scene.boardManager.getTileSize();this.bombCountdown.setScale(t*.95/35),this.bombCountdown.drawCountdown(1,1)}updateBombCountdownEffect(){this.bombCountdown.drawCountdown(this.remainingTime,_d)}runBombIconTween(){this.bringToTop(this.bombIcon),this.bombIconTween?.stop();let{scaleX:e,scaleY:t}=this.bombIcon;this.bombIconTween=this.scene.tweens.add({targets:this.bombIcon,scaleX:e*1.2,scaleY:t*1.2,ease:"Sine.easeInOut",duration:500,yoyo:!0,repeat:-1,onStop:()=>{this.bombIcon.setScale(e,t)}})}stopTimer(){this.bombTimer?.remove(),this.tickingSoundEvent?.remove(),this.bombCountdown.stop(),this.bombIcon.kill(),this.bombIconTween?.stop(),this.isTickingSoundPlaying=!1}isDefuse(){return this.reason==="defuse"}startTimer=()=>{this.bombTimer=this.scene.time.addEvent({delay:500,callback:()=>{if(this.scene.stateManager.isPlaying()&&!this.isPaused){if(this.remainingTime-=500,this.remainingTime<500){this.bombExplodeGrant();return}this.updateBombCountdownEffect(),this.remainingTime<=4500&&!this.isTickingSoundPlaying&&(nt.playSound(ut.TICKING_BOMB_BEFORE_EXPLODE),this.isTickingSoundPlaying=!0,this.fireTickingSound())}},loop:!0})};fireTickingSound(){this.tickingSoundEvent?.remove(),this.tickingSoundEvent=this.scene.time.addEvent({delay:1500,callback:()=>{this.isPaused||nt.playSound(ut.TICKING_BOMB_BEFORE_EXPLODE)},repeat:1})}bombExplodeGrant=()=>{this.stopTimer(),this.reason="exploded",this.explosive(0);let{boardContainer:e}=this.scene.boardManager;e.bringToTop(this),this.block.kill(),this.icon.scale*=5,nt.playSound(ut.BOMB_EXPLODE_1),this.scene.itemManager.setIsUseableItem(!1)};handleBombDefuse(){this.stopTimer(),this.reason="defuse",this.explosive(0);let{boardContainer:e}=this.scene.boardManager;e.bringToTop(this),this.icon.scale*=2.4,nt.playSound(ut.BOMB_DEFUSE),this.block?.off(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN),this.block?.disableInteractive(),this.setState(tt.STATUS.CAPTURING)}onExplosive(){super.onExplosive();let{tileManager:e}=this.scene;this.reason==="exploded"&&(this.scene.time.delayedCall(CL,()=>{e.tilesChangeColor(this.color,[this])}),this.scene.die("bombExplosive")),this.reason==="defuse"&&e.tilesChangeColor(this.color,[this])}removeTile(){if(super.removeTile(),!this.scene)return;this.stopTimer(),this.bombCountdown.clear();let{itemManager:e}=this.scene;e.updateBombDefuseItemState()}shortenRemainingTime(){this.remainingTime=2e3}pauseBombTimer=()=>{this.isPaused=!0};resumeBombTimer=()=>{this.isPaused=!1};increaseRemainingTimeOnRescue=()=>{this.remainingTime=_d,this.updateBombCountdownEffect(),this.isPaused=!1}},je=PL;U(),U();var RL=class{priorityQueue=[];grid=[[0,0,0,0,0,0,0,0,0,0],[0,1,0,0,0,1,0,0,1,0],[0,2,1,0,1,0,0,0,0,3],[0,0,0,0,0,0,1,0,0,0],[1,0,1,0,0,0,0,0,0,0],[0,0,0,1,0,1,1,1,0,0],[0,0,0,1,0,1,0,1,0,0],[0,1,0,0,0,0,1,1,0,0],[0,0,0,0,0,0,0,0,1,0],[0,0,0,0,1,0,0,0,0,0]];width=10;height=10;path=null;findPath(e,t,i){return this.grid=i,this.height=i.length,this.width=i[0].length,this.priorityQueue=[],this.path=null,this.traverse(e,t),this.sharpenPath(),this.path}findWrongPath(e,t,i){return this.grid=i,this.height=i.length,this.width=i[0].length,this.priorityQueue=[],this.path=null,this.traverseFull(e,t),this.path?(this.sharpenPath(),this.path):[]}getTurnsOfPath(e){if(e.length<=2)return 0;let t=0;for(let i=2;i<e.length;i++){let{x:s=0,y:n=0}=e[i-2],{x:r=0,y:o=0}=e[i-1],{x:a=0,y:h=0}=e[i],l=new Phaser.Math.Vector2(r-s,o-n),u=new Phaser.Math.Vector2(a-r,h-o);Phaser.Math.Angle.BetweenPoints(l,u)!==0&&t++}return t}traverse(e,t){let{x:i=0,y:s=0}=e,{x:n=0,y:r=0}=t;if(!this.isAllPathBlocked(e,t))for(this.priorityQueue.push({x:i,y:s,usedTurns:0,direction:"none",expectedCostToEnd:this.calculateExpectedCostToEndPoint({x:i,y:s},{x:n,y:r}),currentPath:[{x:i,y:s}]});this.priorityQueue.length>0;){let o=this.getFromPriorityQueue(),{x:a=0,y:h=0}=o;if(a===n&&h===r){this.path=o.currentPath;break}let l=this.getAdjacentSquares(o);for(let u of l){if(o.currentPath.includes(u))continue;let d=this.calculateExpectedCostToEndPoint(u,{x:n,y:r});this.addToPriorityQueue(u,o,d)}}}traverseFull(e,t){let{x:i=0,y:s=0}=e,{x:n=0,y:r=0}=t;if(this.isAllPathBlocked(e,t)){let o=this.getSpecialCasePath(e,t);o.length>0&&(this.path=o);return}for(this.priorityQueue.push({x:i,y:s,usedTurns:0,direction:"none",expectedCostToEnd:this.calculateExpectedCostToEndPoint({x:i,y:s},{x:n,y:r}),currentPath:[{x:i,y:s}]});this.priorityQueue.length>0;){let o=this.getFromPriorityQueue(),{x:a=0,y:h=0}=o;if(a===n&&h===r){this.path=o.currentPath;break}let l=this.getAdjacentSquares(o);for(let u of l){if(o.currentPath.includes(u))continue;let d=this.calculateExpectedCostToEndPoint(u,{x:n,y:r});this.addToGenerousPriorityQueue(u,o,d)}}if(!this.path){let o=this.getSpecialCasePath(e,t);o.length>0&&(this.path=o)}}getSpecialCasePath(e,t){let{x:i=0,y:s=0}=e,{x:n=0,y:r=0}=t;if(i===n)return this.getYLine(s,r,i);if(s===r)return this.getXLine(i,n,s);let o=[];return o.push(...this.getXLine(i,n,s)),o.pop(),o.push(...this.getYLine(s,r,n)),o}sharpenPath(){if(this.path)for(let e=0;e<this.path.length;e++){let{x:t=-1,y:i=-1}=this.path[e];t===0?this.path[e].x=.25:t===this.height-1&&(this.path[e].x=t-.25),i===0?this.path[e].y=.25:i===this.width-1&&(this.path[e].y=i-.25)}}getXLine(e,t,i){let s=[];if(e<t)for(let n=e;n<=t;n++)s.push({x:n,y:i});else for(let n=e;n>=t;n--)s.push({x:n,y:i});return s}getYLine(e,t,i){let s=[];if(e<t)for(let n=e;n<=t;n++)s.push({x:i,y:n});else for(let n=e;n>=t;n--)s.push({x:i,y:n});return s}addToGenerousPriorityQueue(e,t,i){let{x:s=0,y:n=0}=e,{x:r=0,y:o=0,direction:a,usedTurns:h}=t,l=this.getMovingDirectionString(s-r,n-o);if(l===a)this.priorityQueue.push({x:s,y:n,usedTurns:h,direction:l,expectedCostToEnd:i,currentPath:[...t.currentPath,{x:s,y:n}]});else{let u=h>=2&&i>t.expectedCostToEnd;h<7&&!u&&this.priorityQueue.push({x:s,y:n,usedTurns:h+1,direction:l,expectedCostToEnd:i,currentPath:[...t.currentPath,{x:s,y:n}]})}}getPath(){return this.path?this.path:[]}calculateExpectedCostToEndPoint(e,t){let{x:i=0,y:s=0}=e,{x:n=0,y:r=0}=t;return Math.abs(i-n)+Math.abs(s-r)}addToPriorityQueue(e,t,i){let{x:s=0,y:n=0}=e,{x:r=0,y:o=0,direction:a,usedTurns:h}=t,l=this.getMovingDirectionString(s-r,n-o);if(l===a)this.priorityQueue.push({x:s,y:n,usedTurns:h,direction:l,expectedCostToEnd:i,currentPath:[...t.currentPath,{x:s,y:n}]});else{let u=h>=2&&i>t.expectedCostToEnd;h<3&&!u&&this.priorityQueue.push({x:s,y:n,usedTurns:h+1,direction:l,expectedCostToEnd:i,currentPath:[...t.currentPath,{x:s,y:n}]})}}getFromPriorityQueue(){let e=Math.min(...this.priorityQueue.map(i=>i.expectedCostToEnd+i.currentPath.length)),t=this.priorityQueue.find(i=>e===i.expectedCostToEnd+i.currentPath.length);return t?this.priorityQueue.splice(this.priorityQueue.indexOf(t),1)[0]:this.priorityQueue.splice(0,1)[0]}getAdjacentSquares(e){let{x:t=0,y:i=0}=e,s=[];return t-1>=0&&(this.grid[t-1][i]===1||s.push({x:t-1,y:i})),t+1<this.height&&(this.grid[t+1][i]===1||s.push({x:t+1,y:i})),i-1>=0&&(this.grid[t][i-1]===1||s.push({x:t,y:i-1})),i+1<this.width&&(this.grid[t][i+1]===1||s.push({x:t,y:i+1})),s}isAllPathBlocked(e,t){let{x:i=0,y:s=0}=e,{x:n=0,y:r=0}=t,o=this.getAdjacentSquares({x:i,y:s}),a=this.getAdjacentSquares({x:n,y:r});return o.length===0||a.length===0}getMovingDirectionString(e,t){return e===1?"down":e===-1?"up":t===1?"right":t===-1?"left":"none"}},hC=RL,bL=class{scene;pathfinder;colorGrid=[];obstacleGrid=[];outerTiles=[];availableColors=[];pathForAutoplay=null;constructor(e){this.scene=e,this.pathfinder=new hC}updateGrids(){this.updateColorGrid(),this.updateObstacleGrid(),this.createOuterTiles(),this.pathForAutoplay=null}checkForAvailableMatches(){return this.updateGrids(),!!(this.checkForNearestMatch()||this.checkOuterTilesMatch())}updateColorGrid(){this.colorGrid=[];let{boardMap:e}=this.scene.boardManager,t=this.scene.levelHandler.getConfigs();if(!t)return;let{rows:i,columns:s}=t;for(let n=1;n<=i;n++){this.colorGrid[n-1]=[];for(let r=1;r<=s;r++){if(!e[n]||!e[n][r])continue;if(e[n][r].isCaptured()){this.colorGrid[n-1][r-1]="0";continue}let o=e[n][r].color;this.availableColors.includes(o)||this.availableColors.push(o),this.colorGrid[n-1][r-1]=o}}for(let n of this.colorGrid)n.unshift("0"),n.push("0");this.colorGrid.unshift(new Array(s+2).fill("0")),this.colorGrid.push(new Array(s+2).fill("0"))}updateObstacleGrid(){this.obstacleGrid=[],this.colorGrid.forEach((e,t)=>{this.obstacleGrid[t]=[],e.forEach((i,s)=>{let n=i!=="0";this.obstacleGrid[t][s]=n?1:0})})}createOuterTiles(){this.outerTiles=[];let e=this.availableColors.length;for(let t=0;t<e;t++)this.outerTiles.push([])}getAdjacentSquaresData(e,t){let i=[],{boardMap:s}=this.scene.boardManager;return e-1>=1&&i.push(s[e-1][t]),e+1<this.colorGrid.length-1&&i.push(s[e+1][t]),t-1>=1&&i.push(s[e][t-1]),t+1<this.colorGrid[0].length-1&&i.push(s[e][t+1]),i.filter(n=>n&&!n.isCaptured())}getMaximumSurroundingSlots(e,t){let i=4;return e-1<0&&i--,e+1>=this.colorGrid.length&&i--,t-1<0&&i--,t+1>=this.colorGrid[0].length&&i--,i}checkForNearestMatch(){let e=!1;for(let t=0;t<this.colorGrid.length;t++){for(let i=0;i<this.colorGrid[0].length;i++){let s=this.colorGrid[t][i];if(s==="0")continue;let n=this.getAdjacentSquaresData(t,i),r=this.getMaximumSurroundingSlots(t,i),o=n.map(a=>a.color);if(r>n.length){let a=this.availableColors.indexOf(s);this.outerTiles[a].push({x:t,y:i})}if(o.includes(s)){let a=o.indexOf(s),h=n[a];this.pathForAutoplay=[{x:t,y:i},{x:h.row,y:h.column}],e=!0;break}}if(e)break}return e}getAllPossiblePairs(e){let t=[];for(let i=0;i<e.length;i++)for(let s=i+1;s<e.length;s++)t.push({tile1:e[i],tile2:e[s]});return t.sort((i,s)=>{let n=Math.abs(i.tile1.x-i.tile2.x)+Math.abs(i.tile1.y-i.tile2.y),r=Math.abs(s.tile1.x-s.tile2.x)+Math.abs(s.tile1.y-s.tile2.y);return n-r}),t}checkOuterTilesMatch(){this.outerTiles.sort((t,i)=>i.length-t.length);let e=!1;for(let t=0;t<this.outerTiles.length;t++){let i=this.outerTiles[t];if(i.length<1)continue;let s=this.getAllPossiblePairs(i);for(let n=0;n<s.length;n++){let{tile1:r,tile2:o}=s[n];this.obstacleGrid[r.x][r.y]=0,this.obstacleGrid[o.x][o.y]=0;let a=this.pathfinder.findPath({x:r.x,y:r.y},{x:o.x,y:o.y},this.obstacleGrid);if(a){e=!0,this.pathForAutoplay=a;break}this.obstacleGrid[r.x][r.y]=1,this.obstacleGrid[o.x][o.y]=1}if(e)break}return e}},lC=bL;U();var{Utils:{Object:IL,Function:Od}}=Ludex,_L=Od.memoize((e,t)=>{if(typeof e=="string"){let i=t[e.toLowerCase()];if(typeof i=="string")return i}return e[0]==="b"?e:"?"}),OL=Od.memoize(e=>{let t=null,i=[],s=/:([(t|i|b)00-9?]+)/gm;for(;t=s.exec(e),t!==null;)i.push(t[1]);return i}),ML=Od.memoize(e=>{let t=null,i=[],s=/((t|i|b)[0-9]+)/gm;for(;t=s.exec(e),t!==null;){let n=t[0];i.push(n)}return i}),LL=(e,t)=>{let i=e,s=IL.invert(t),n={},r=0,o=0,a=OL(i);for(let h of a){r=0,o++,n[o]||(n[o]={});let l=ML(h);for(let u of l)r++,n[o][r]=_L(u,s)}return n},DL=LL,{STATUS:Md}=ns,{Utils:{Valid:kL,Array:uC}}=Ludex,FL=class extends Ne{scene;tileMap={};boardMap={};boardContainer;boardSizeHandler;matchFinder;constructor(e){super(e),this.scene=e,this.boardContainer=this.scene.make.container({}),this.boardContainer.setDepth($.TILE),this.matchFinder=new lC(this.scene),this.boardSizeHandler=new lL(this.scene)}init(){this.La(),this.setState(Md.READY)}start(){this.isRunning()||(this.boardSizeHandler.calculateTileSize(),this.Da(),this.setState(Md.RUNNING))}stop(){this.isRunning()&&this.setState(Md.STOPPED)}loadBoardByFen(e){let{tileManager:t}=this.scene;this.tileMap=DL(e,tt.HASH);for(let i in this.tileMap){let s=this.tileMap[i];if(kL.isObject(s))for(let n in s){let r=s[n],o;r[0]==="b"?(r=parseInt(r.substring(1)).toString(),this.tileMap[i][n]=tt.SPECIALS.BOMB,o=t.createTileByType(tt.SPECIALS.BOMB,+i,+n),o instanceof je&&o.setColor(r,t.getCurrentDeck())):o=t.createTileByType(r,+i,+n),this.setTileToMap(o,+i,+n)}}}La(){this.tileMap={},this.boardMap={},this.boardContainer.removeAll()}Da(){this.ka(),this.Fa(),this.Na(),this.Ba()}ka(){let{tileManager:e,levelHandler:t}=this.scene,i=t.getConfigs(),{rows:s,columns:n,specials:r={},customFen:o}=i,a=s*n;if(o&&this.loadBoardByFen(o.code),Object.keys(this.boardMap).length>0)return;let h=this.Ua(),l=r.bomb||0,u=this.Ga(l,h);for(let d=0;d<a;d++){let{row:p,column:g}=this.getPositionByIndex(d),c=h[d],f=!1;u.includes(d)&&(f=!0);let m=f?tt.SPECIALS.BOMB:c,v=e.createTileByType(m,p,g);f&&v instanceof je&&v.setColor(c,e.getCurrentDeck()),this.setTileToMap(v,p,g)}}Ua(){let{levelHandler:e}=this.scene,t=e.getConfigs(),{rows:i,columns:s,colors:n,specials:r={}}=t,o=i*s,a=r.rocket||0,h=Math.floor(o/2)-a,l=[],u=0;for(let g=0;g<h;g++){u=u>=n?1:u+1;let c=u.toString();l.push(c),l.push(c)}for(let g=0;g<a;g++)l.push("rocket"),l.push("rocket");l.sort(()=>Math.random()-.5);let d=this.$s(l),p=this.$s(d.reverse()).reverse();return this.Ya(p,i,s),l.length<o&&p.splice(Math.floor(p.length/2),0,tt.SPECIALS.EMPTY),p}$s(e){let{levelHandler:t}=this.scene,i=t.getConfigs(),{rows:s,columns:n,colors:r,rules:o}=i;if(!o.maxSpaceOfPair)return e;let a=this.Ha(e,s,n),h=[];for(let u=1;u<=r;u++)h.push(u.toString());let l=this.za(h,e);for(let u=0;u<l.length;u++){let d=null,p=null;for(let g=0;g<s;g++)for(let c=0;c<n;c++)if(a[g][c]===l[u]){if(!d||!p){d=g,p=c;continue}let f=o.maxSpaceOfPair+1;if(Math.abs(d-g)+Math.abs(p-c)<=f){p=c,d=g;continue}let m=this.Wa(d,p,g,c),v=a[m.row][m.column];a[m.row][m.column]=a[g][c],a[g][c]=v}}return this.Va(a)}Ya(e,t,i){let s=Phaser.Math.Between(0,e.length-1),n=s;for(let l=0;l<e.length;l++){let u=e[l];if(l!==s&&u===e[s]){n=l;break}}if(n===s)return;let r=this.Xa(s,t,i);if(r.length===0)return;let o=Phaser.Math.Between(0,r.length-1),a=r[o],h=e[a];e[a]=e[n],e[n]=h}Xa(e,t,i){let{row:s,column:n}=this.getPositionByIndex(e),r=[],o=s+1,a=n;return o<=t&&r.push(this.ti(o,a)),o=s-1,a=n,o>=1&&r.push(this.ti(o,a)),o=s,a=n+1,a<=i&&r.push(this.ti(o,a)),o=s,a=n-1,a>=1&&r.push(this.ti(o,a)),r}Wa(e,t,i,s){let n=e,r=t;return i>e&&(n=e+1),i<e&&(n=e-1),s>t&&(r=t+1),s<t&&(r=t-1),{row:n,column:r}}Ha(e,t,i){let s=[];for(let n=0;n<t;n++){s[n]=[];for(let r=0;r<i;r++)s[n][r]=e[n*i+r]}return s}Va(e){let t=[];for(let i=0;i<e.length;i++)for(let s=0;s<e[i].length;s++)t.push(e[i][s]);return t}za(e,t){let i=[],s=[tt.SPECIALS.BOMB,tt.SPECIALS.EMPTY,tt.SPECIALS.ROCKET];for(let n=0;n<t.length&&i.length!==e.length;n++){let r=t[n];i.includes(r)||s.includes(r)||i.push(r)}return i}Ga(e,t){let i=[];t.forEach((r,o)=>{r!==tt.SPECIALS.EMPTY&&r!==tt.SPECIALS.ROCKET&&i.push(o)});let s=i.length>e?e:i.length,n=[];i.sort(()=>Math.random()-.5);for(let r=0;r<s;r++)n.push(i[r]);return n}Ka(){let e=[];for(let t in this.boardMap){let i=this.boardMap[t];for(let s in i){let n=this.boardMap[t][s];e.push(n)}}return e}Fa(){let{levelHandler:e}=this.scene,t=e.getConfigs(),i=t.rows,s=t.columns,n=this.getTileSizeWithSpacing();this.boardContainer.setWorldSize(s*n,i*n)}Ba(){let{levelHandler:e}=this.scene,t=e.getConfigs(),i=t.rows,s=t.columns,n=this.getTileSizeWithSpacing(),r=this.Ka(),{x:o,y:a,width:h,height:l}=this.boardContainer,u=Math.round(n);Phaser.Actions.GridAlign(r,{width:s,height:i,position:Phaser.Display.Align.CENTER,cellWidth:u,cellHeight:u,x:-h/2,y:-l/2})}Na(){let{layoutManager:e}=this.scene,{objects:t}=e,i=pt.getBannerHeight(),s=t.headerBG.height,n=t.topFooterBG.height+i,r=(s-n)/2;lt.isLandscape()&&(r=(s-i)/2),Phaser.Display.Align.In.Center(this.boardContainer,this.scene.gameZone,0,r)}getPositionByIndex(e){let{columns:t}=this.scene.levelHandler.getConfigs(),i=Math.floor(e/t)+1,s=e%t+1;return{row:i,column:s}}ti(e,t){let{columns:i}=this.scene.levelHandler.getConfigs();return(e-1)*i+(t-1)}getTileByIndex(e){let{row:t,column:i}=this.getPositionByIndex(e);return this.getTileByPosition(t,i)}getTileByPosition(e,t){return!(e in this.boardMap)||!(t in this.boardMap[e])?null:this.boardMap[e][t]}setTileToMap(e,t,i){let{tileManager:s}=this.scene;this.tileMap[t]||(this.tileMap[t]={}),this.boardMap[t]||(this.boardMap[t]={}),e.setRow(t),e.setColumn(i),this.tileMap[t][i]=e.color;let n=this.boardMap[t][i];n&&s.removeTile(n),this.boardMap[t][i]=e,this.boardContainer.add(e),s.addTile(e)}tileSwap(e){let{fromRow:t,toRow:i,fromColumn:s,toColumn:n}=e,r=this.boardMap[i][n],o=this.boardMap[t][s];r.setRow(t),r.setColumn(s),o.setRow(i),o.setColumn(n),this.boardMap[i][n]=o,this.boardMap[t][s]=r,this.tileMap[i][n]=o.color,this.tileMap[t][s]=r.color}runShuffle=e=>{let t=this.tn(),i=this.ja();this.Za(t,i,e),this.qa(t,i),this.scene.time.delayedCall(300,()=>{nt.playSound(ut.SHUFFLE_ITEM)})};tn(){let{tileManager:e}=this.scene,t=e.getTiles(),i=[];for(let s of t)s.isCaptured()||s.isCapturing()||i.push(s);return i}ja(){let e=this.tn();uC.unique(e);let t=[];for(let{row:i,column:s}of e)t.push({row:i,column:s});return uC.shuffle(t),t}Za(e,t,i){let{animationManager:s}=this.scene;e.forEach((n,r)=>{let{row:o,column:a}=n,{row:h,column:l}=t[r];s.moveRowsAndColumns({tile:n,fromRow:o,toRow:h,fromColumn:a,toColumn:l},r*5,i)})}qa(e,t){e.forEach((i,s)=>{let{row:n,column:r}=i,{row:o,column:a}=t[s];n===o&&r===a||this.tileSwap({fromRow:n,toRow:o,fromColumn:r,toColumn:a})})}processNoAvailableMatches=()=>{if(this.checkIfAllTilesAreCaptured()){this.scene.events.emit(tt.EVENTS.NEXT_TURN);return}if(this.matchFinder.checkForAvailableMatches()){this.scene.events.emit(tt.EVENTS.NEXT_TURN);return}let{animationManager:e,itemManager:t,tileManager:i}=this.scene;i.isSelectable=!1,t.setIsUseableItem(!1),e.isMoveTilesCompleted=!1;let s=500;this.runShuffle(s),this.scene.time.delayedCall(s+50,this.processNoAvailableMatches)};checkIfAllTilesAreCaptured(){let{tileManager:e}=this.scene,t=e.getTiles();if(t.length<2)return!0;for(let i of t)if(!i.isCaptured())return!1;return!0}getTileSize(){return this.boardSizeHandler.getTileSize()}getTileSizeWithSpacing(){return this.getTileSize()}},NL=FL;U(),U(),U(),U(),U();var BL={repeat:-1,yoyo:!0,duration:33,ease:Phaser.Math.Easing.Sine.InOut},UL=class{posX;tween;constructor(e,t){let i={...BL,...t,props:{x:t.shakeX??5,...t.props}};this.posX=typeof i.props.x=="number"?i.props.x:5,this.tween=e.tweens.add(i),this.tween?.on(Phaser.Tweens.Events.TWEEN_REPEAT,this.handleSwitchPosition,this)}handleSwitchPosition(){this.posX=-this.posX,this.tween?.updateTo("x",-this.posX)}},cC=UL;U();var GL={props:{alpha:{duration:500,value:{start:0,from:0,to:1},ease:Phaser.Math.Easing.Cubic.Out},scale:{duration:1e3,value:{start:.8,from:.8,to:1},ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]}}},Ld=GL,{player:YL}=codex,{KEY:cr,FRAME:$s}=G.GAMEPLAY,HL=class extends Phaser.GameObjects.Container{scene;isActive=!0;isFree;isDisabled;amount;autoRunUpAnimation=!0;item;bg;amountItem;amountText;amountBg;itemLock;itemLockText;showItemAnimation;shakeAnimation;coinShakeAnimation;callback;itemCost;coinIcon;coinText;costContainer;constructor(e,t,i,s){super(e),this.scene=e,this.isFree=!1,this.isDisabled=!1,this.itemCost=100,this.createBg(),this.createItem(t,i,s),this.createAmountText(),this.createItemLock(),this.createAnimations(),this.setDepth($.ITEM),this.setWorldSize(50,50),this.scene.add.existing(this)}activeItem(){this.isActive=!0,this.showItemAnimation?.remove(),this.createShowItemAnimation(),J.runTween(this.showItemAnimation)}deactivateItem(){this.isActive=!1}enableItem(){this.isDisabled!==!1&&(this.item.setAlpha(1),this.amountBg.setVisible(!0),this.amountText.setVisible(!0),this.setAmount(this.amount),this.isDisabled=!1,this.setInteractive({useHandCursor:!0}))}disableItem(){this.isDisabled!==!0&&(this.deactivateItem(),this.item.setAlpha(.4),this.costContainer.setVisible(!1),this.amount<=0&&(this.amountBg.setVisible(!1),this.amountText.setVisible(!1)),this.isDisabled=!0,this.disableInteractive())}setFreeMode(e,t=!1){t||this.amountItem.setVisible(!e),this.isFree=e}getIsFree(){return this.isFree}set onClick(e){let{width:t,height:i}=this.bg;this.setSize(t,i+16),this.setInteractive({useHandCursor:!0}),this.callback=e,this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handlePointerUp)}handlePointerUp=()=>{this.logItemEvent(),this.callback&&(nt.playSound(ut.GENERAL_BUTTON_CLICK),this.callback())};logItemEvent(){this.isActive||qi.trackButtonClick(this.name)}createBg(){this.bg=this.scene.add.image(0,0,cr,$s.ITEM_BG_ITEM),this.add(this.bg)}createItem(e,t,i){this.item=this.scene.add.image(0,0,cr,e),this.item.setWorldSize(t,i),Phaser.Display.Align.In.Center(this.item,this.bg,0,-3),this.add(this.item)}createAmountText(){this.amountItem=this.scene.add.container(),this.amountText=X.createText(this.scene,"",12).setTint(8205077),this.amountBg=this.scene.make.image({key:cr,frame:$s.ITEM_BG_AMOUNT}),this.createCostContainer(),Phaser.Display.Align.In.Center(this.amountText,this.amountBg),this.amountItem.add([this.amountBg,this.amountText,this.costContainer]),Phaser.Display.Align.In.TopRight(this.amountItem,this.bg,-10,-3),it.alignChildCenter(this.amountText,this.amountItem,0,-1),this.costContainer.setPosition(1,0),this.add(this.amountItem)}createCostContainer(){this.costContainer=this.scene.add.container(),this.costContainer.setSize(100,14),this.coinText=X.createText(this.scene,`${this.itemCost}`,12).setTint(1731370).setAlign("center"),this.coinIcon=this.scene.make.image({key:cr,frame:$s.ICON_COIN}),this.coinIcon.setWorldSize(14,14);let e=this.coinText.getBounds().width,t=e+this.coinIcon.displayWidth+.5,i=e/2-t/2;this.coinText.setPosition(i+1.5,-.5),this.coinIcon.setPosition(t/2-this.coinIcon.displayWidth/2,0),this.costContainer.add([this.coinText,this.coinIcon]),this.costContainer.setVisible(!1)}createItemLock(){this.itemLock=this.scene.make.image({key:cr,frame:$s.NOTE_LOCK}),Phaser.Display.Align.In.TopRight(this.itemLock,this.bg,2,6),this.add(this.itemLock),this.itemLock.setVisible(!1),this.itemLockText=X.createText(this.scene,"",10).setStroke("#2e2e2e",2),Phaser.Display.Align.In.BottomCenter(this.itemLockText,this.bg,0,1),this.add(this.itemLockText),this.itemLockText.setVisible(!1)}switchToNormalMode(){this.costContainer.setVisible(!1),this.amountText.setVisible(!0)}switchToCostMode(){this.costContainer.setVisible(!0),this.amountText.setVisible(!1)}setAmount(e){this.amount=e;let t=this.amount<=0;if(this.amountBg){let i=t?$s.NOTE_FREE:$s.ITEM_BG_AMOUNT;this.amountBg.setFrame(i)}if(t){let{coins:i=0}=YL.getGameData()??{};if(i>=this.itemCost){this.itemCost=this.itemCost??100,this.switchToCostMode(),this.coinText.setText(`${this.itemCost}`);return}this.switchToNormalMode(),this.amountText.setTint(1731370),this.amountText.setText("Ads");return}this.switchToNormalMode(),this.amountText.setTint(8205077),this.amountText.setText(e.toString())}createAnimations(){this.createShowItemAnimation(),this.shakeAnimation=new cC(this.scene,{targets:[this.costContainer,this.amountText],repeat:3,shakeX:4,paused:!0})}createShowItemAnimation(){let{scale:e}=this.item;this.showItemAnimation=this.scene.tweens.add({...Ld,targets:[this.item],props:{...Ld.props,scale:{...Ld.props.scale,value:{start:e*.8,from:e*.8,to:e}}}})}},re=HL,{ID:yo}=K.BOMB_DEFUSE,{DefuseItemGuideLevel:zL}=Lt,{FRAME:dr}=G.GAMEPLAY,WL=class extends re{scene;isRunning=!1;constructor(e){super(e,dr.DEFUSE_ITEM,26,34.5),this.itemCost=400,this.scene=e,this.setName(yo),this.itemLockText.setText(`Level ${zL}`),this.onClick=this.handleUseItem}handleUseItem=()=>{if(this.isRunning)return;let{itemManager:e}=this.scene;if(this.isActive){e.deactivateItem(yo);return}if(!e.activeItem(yo)){J.runTween(this.shakeAnimation.tween);return}this.useItem()};useItem(){let{tileManager:e,itemManager:t}=this.scene;!this.isActive||this.isRunning||(this.isRunning=!0,this.defuseBomb(),e.emitInteraction(),t.updateBombDefuseItemState(),this.showItemAnimation?.once(Phaser.Tweens.Events.TWEEN_COMPLETE,()=>{this.isRunning=!1,t.deactivateItem(yo)}),kt.addUseBombDefuseMissionProgress(1))}defuseBomb(){let{tileManager:e}=this.scene,t=e.getAliveTiles();for(let i=0;i<t.length;i++){let s=t[i];if(s instanceof je&&!s.isDefuse()){s.handleBombDefuse();return}}}disableItem(){super.disableItem(),this.item.setAlpha(1),this.item.setFrame(dr.ITEM_DEFUSE_LOCK),this.bg.setFrame(dr.ITEM_BG_LOCK),this.itemLock.setVisible(!1),this.itemLockText.setVisible(!1),this.amountItem.setVisible(!0)}enableItem(){super.enableItem(),this.item.setAlpha(1),this.item.setFrame(dr.DEFUSE_ITEM),this.bg.setFrame(dr.ITEM_BG_ITEM),this.amountItem.setVisible(!0),this.itemLock.setVisible(!1),this.itemLockText.setVisible(!1)}},Dd=WL,{ID:To}=K.GUIDE_BOMB_DEFUSE,VL=class extends Dd{constructor(e){super(e),this.setName(To),this.callback=this.handleUseGuideItem}handleUseGuideItem=()=>{if(this.isRunning)return;let{itemManager:e}=this.scene;if(this.isActive){e.deactivateItem(To);return}if(!e.activeItem(To)){J.runTween(this.shakeAnimation.tween);return}this.useItem()};useItem(){let{tileManager:e,itemManager:t,tutorialManager:i}=this.scene;if(!this.isActive||this.isRunning)return;this.isRunning=!0;let s=e.getAliveTiles();for(let n=0;n<s.length;n++){let r=s[n];if(r instanceof je&&!r.isDefuse()){let{x:o,y:a}=r.getWorldPosition(),h=r.block.displayWidth,l=r.block.displayHeight;this.scene.time.delayedCall(0,()=>{this.scene.tweens.killTweensOf(i.background),i.background.clearMask(!0),i.createMask(o-h/2,a-l/2,h,l,3),this.scene.time.delayedCall(1e3,()=>{r.handleBombDefuse(),e.emitInteraction(),i.runHideMaskAnimation(),this.isRunning=!1,t.deactivateItem(To)})});return}}e.emitInteraction()}},dC=VL;U();var{Utils:{Function:XL}}=Ludex,{ID:pC}=K.CHANGE_COLOR,{KEY:KL,FRAME:kd}=G.GAMEPLAY,{SPECIALS:jL}=tt,{BOMB:gC,ROCKET:fC}=jL,ZL=class extends re{scene;index;colors;color;constructor(e){super(e,kd.ROCKET_ITEM,25,25),this.scene=e,this.index=0,this.colors=new Array(28).fill(null).map((t,i)=>`${i+1}`),this.colors.push(gC),this.colors.push(fC),this.setAmount(999),this.onClick=()=>{let{itemManager:t}=this.scene;this.isActive?t.deactivateItem(pC):t.activeItem(pC)},this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_WHEEL,this.handleWheel)}handleWheel=XL.debounce(e=>{this.isActive&&(this.isDisabled||(e.deltaY>0?this.nextColor():this.prevColor()))},250,!0);nextColor(){this.color=this.colors[this.index],this.index+=1,this.index>=this.colors.length&&(this.index=0),this.changeColor(this.color)}prevColor(){this.color=this.colors[this.index],this.index-=1,this.index<=0&&(this.index=this.colors.length-1),this.changeColor(this.color)}changeColor(e){if(this.item.setTexture(KL),e===gC)this.item.setFrame(kd.ICON_BOMB);else if(e===fC)this.item.setFrame(kd.TILE_ROCKET);else{let t=this.scene.tileManager.getCurrentDeck();this.item.setFrame(t+e)}}activeItem=()=>{this.isActive=!0,this.setAlpha(1)};deactivateItem=()=>{super.deactivateItem(),this.setAlpha(.7)};useItem(e){if(!this.isActive)return!1;let{tileManager:t}=this.scene;return t.tilesChangeColor(this.color,[e]),!0}},mC=ZL;U();var{ID:pr}=K.ROCKET,{FRAME:gr}=G.GAMEPLAY,{RocketItemGuideLevel:vC}=Lt,qL=class extends re{scene;isRunning=!1;usingTimer;constructor(e){super(e,gr.ROCKET_ITEM,23,36),this.itemCost=500,this.scene=e,this.setName(pr),this.itemLockText.setText(`Level ${vC}}`),this.onClick=this.handleUseItem}activeItem(){super.activeItem(),this.amountItem.kill()}deactivateItem(){super.deactivateItem(),this.amountItem.revive(),this.isRunning=!1,this.usingTimer?.remove(),this.isDisabled&&this.amountItem.setVisible(!1)}handleUseItem=()=>{if(this.isRunning)return;let{itemManager:e}=this.scene;if(this.isActive){e.deactivateItem(pr);return}if(!e.activeItem(pr)){J.runTween(this.shakeAnimation.tween);return}this.useItem()};useItem(){let{tileManager:e,uiManager:t}=this.scene;if(!this.isActive||this.isRunning)return;let i=e.getPairsOfTilesCanCapture(2);i.length===4&&(this.isRunning=!0,this.scene.events.emit(tt.EVENTS.PAUSE_BOMB_TIMER),e.isSelectable=!1,e.emitInteraction(),e.removeSuggestPairHint(),t.disablePause(),this.scene.time.delayedCall(300,()=>{this.runEffectAndCapture(i)}),kt.addUseRocketMissionProgress(1))}runEffectAndCapture(e){let{tileManager:t,effectManager:i,itemManager:s}=this.scene,n=[],r=[];for(let a of e){let{x:h,y:l}=a.getWorldPosition(),u=a.block.displayWidth,d=a.block.displayHeight;r.push({x:h,y:l}),n.push({x:h-u/2,y:l-d/2,width:u,height:d,radius:3})}let o=s.getItem(pr);o&&n.push({x:o.x-(o.displayWidth-4*o.scale)/2,y:o.y-o.displayHeight/2+7*o.scale,width:(o.width-4)*o.scale,height:(o.width-4)*o.scale,radius:(o.width-4)*o.scale/2}),s.createMultiMask(n);for(let a of e)a.setState(tt.STATUS.CAPTURING),a.setIsBreakWhenExplosive(!0);this.usingTimer?.remove(),this.usingTimer=this.scene.time.addEvent({delay:100,repeat:-1,callback:()=>{t.isSelectable=!1}}),i.playRocketEffect(r,()=>{t.tilesCapturing([e[0],e[1]])},()=>{t.tilesCapturing([e[2],e[3]]),this.isRunning=!1,this.usingTimer?.remove(),s.deactivateItem(pr),s.setIsUseableItem(!1),this.scene.events.emit(tt.EVENTS.RESUME_BOMB_TIMER)})}disableItem(){super.disableItem(),this.item.setAlpha(1),this.item.setFrame(gr.ITEM_ROCKET_LOCK),this.bg.setFrame(gr.ITEM_BG_LOCK),this.amountItem.setVisible(!0),this.itemLock.setVisible(!1),this.itemLockText.setVisible(!1)}enableItem(){super.enableItem();let{levelHandler:e}=this.scene,{level:t}=e.getConfigs();this.item.setAlpha(1),t>=vC&&this.setVisible(!0),this.item.setFrame(gr.ROCKET_ITEM),this.bg.setFrame(gr.ITEM_BG_ITEM),this.amountItem.setVisible(!0),this.itemLock.setVisible(!1),this.itemLockText.setVisible(!1)}},Fd=qL;U();var{ID:fr}=K.SUPER_ROCKET,{KEY:JL,FRAME:Ze}=G.GAMEPLAY,{SuperRocketGuideLevel:QL,SuperRocketConfig:$L}=Lt,tD=class extends re{scene;isRunning=!1;usingTimer;St;he;le;rechargeNotificationAnimation;constructor(e){super(e,Ze.SUPER_ROCKET_ITEM,42,50),this.scene=e,this.setName(fr),this.itemLockText.setText(""),this.onClick=this.handleUseItem,this.isFree=!0,this.createRechargeNotification(),this.amountItem.kill(),this.amountText.kill()}createRechargeNotification(){this.St=this.scene.add.container(0,0),this.he=this.scene.add.image(0,0,JL,Ze.SUPER_ROCKET_NOTIFICATION),this.St.add(this.he),this.le=X.createText(this.scene,"Rocket is recharging. Beat X more levels to use it again.",17).setAlign("center").setTint(8205077).setWordWrapWidth(180),this.St.add(this.le).setDepth($.PRIORITY).setVisible(!1)}setRechargeNotificationLayout(e){let t=this.getWorldPosition();this.St.setScale(.9),e==="portrait"?(this.he.flipY=!1,this.St.setPosition(t.x-45,t.y-80),Phaser.Display.Align.In.Center(this.le,this.he,2,-12)):(this.he.flipY=!0,this.St.setPosition(t.x-45,t.y+65),Phaser.Display.Align.In.Center(this.le,this.he,2,12))}setAmount(e){this.amount=e}handleUseItem=()=>{let e=this.St.visible;if(this.isRunning||e)return;let{itemManager:t}=this.scene;if(this.isActive){t.deactivateItem(fr);return}if(!t.activeItem(fr)){J.runTween(this.shakeAnimation.tween);return}this.useItem()};useItem(){let{tileManager:e,itemManager:t,uiManager:i}=this.scene,{DestroyPairCount:s}=$L;if(!this.isActive||this.isRunning)return;if(this.amount!==1){this.runRechargeNotificationAnimation();return}i.disablePause(),t.updateSuperRocketCountdown(),this.scene.isSuperRocketUsed=!0;let n=e.getPairsOfTilesCanCapture(s);this.isRunning=!0,e.isSelectable=!1,this.scene.events.emit(tt.EVENTS.PAUSE_BOMB_TIMER),e.emitInteraction(),e.removeSuggestPairHint(),this.scene.time.delayedCall(300,()=>{this.runEffectAndCapture(n)}),kt.addUseRocketMissionProgress(1)}runEffectAndCapture(e){let{tileManager:t,effectManager:i,itemManager:s}=this.scene,n=[],r=[];for(let a of e){let{x:h,y:l}=a.getWorldPosition(),u=a.block.displayWidth,d=a.block.displayHeight;r.push({x:h,y:l}),n.push({x:h-u/2,y:l-d/2,width:u,height:d,radius:3})}let o=s.getItem(fr);o&&n.push({x:o.x-(o.displayWidth-4*o.scale)/2,y:o.y-o.displayHeight/2+7*o.scale,width:(o.width-4)*o.scale,height:(o.width-4)*o.scale,radius:(o.width-4)*o.scale/2}),s.createMultiMask(n);for(let a of e)a.setState(tt.STATUS.CAPTURING),a.setIsBreakWhenExplosive(!0);this.usingTimer?.remove(),this.usingTimer=this.scene.time.addEvent({delay:100,repeat:-1,callback:()=>{t.isSelectable=!1}}),i.playSuperRocketEffect(e,r)}runRechargeNotificationAnimation(){if(this.St.visible)return;this.amount-1===1?this.le.setText("Rocket is recharging. Beat this level to use it again."):this.le.setText(`Rocket is recharging. Beat ${this.amount-1} more levels to use it again.`),this.St.setVisible(!0),this.rechargeNotificationAnimation=this.scene.time.delayedCall(2e3,()=>{this.St.setVisible(!1)}),this.isRunning=!1,this.usingTimer?.remove();let{itemManager:e}=this.scene;e.deactivateItem(fr)}stopRechargeNotificationAnimation(){this.St.setVisible(!1),this.rechargeNotificationAnimation?.remove()}disableItem(){super.disableItem(),this.item.setAlpha(1),this.stopRechargeNotificationAnimation(),this.item.setFrame(Ze.ITEM_SUPER_ROCKET_LOCK),this.bg.setFrame(Ze.ITEM_BG_LOCK)}enableItem(){super.enableItem();let{levelHandler:e}=this.scene,{level:t}=e.getConfigs();this.item.setAlpha(1),this.item.setFrame(Ze.SUPER_ROCKET_ITEM),this.bg.setFrame(Ze.ITEM_BG_ITEM),t>=QL&&this.setVisible(!0),this.setCountdownUI()}setRunningStatus(e){this.isRunning=e}clearTimerEvent(){this.usingTimer?.remove()}setCountdownUI(){this.visible&&(this.amount===1&&!this.isDisabled?(this.item.setFrame(Ze.SUPER_ROCKET_ITEM),this.bg.setFrame(Ze.ITEM_BG_ITEM)):(this.item.setFrame(Ze.ITEM_SUPER_ROCKET_LOCK),this.bg.setFrame(Ze.ITEM_BG_LOCK)))}deactivateItem(){super.deactivateItem(),this.isRunning=!1,this.usingTimer?.remove(),this.setCountdownUI()}},tn=tD,{event:eD,player:vi,analytics:iD}=codex,{Utils:{Valid:en},Plugins:{Analytics:{Events:sD}}}=Ludex,{STATUS:Nd}=ns,{BOMB_DEFUSE:Bd,ROCKET:EC,AUTO_MATCH:yC,SHUFFLE:nD,HINT:rD}=K,{KEY:aD,FRAME:oD}=G.GAMEPLAY,{SuperRocketGuideLevel:hD,SuperRocketConfig:lD}=Lt,{GameRechargeCount:uD,DestroyPairCount:cD}=lD,dD=class extends Ne{scene;ei=!1;o={};itemActive="";At;lt;rt;Ja=[K.INVITE.ID,K.GUIDE_BOMB_DEFUSE.ID];constructor(e){super(e),this.scene=e,this.ji(),this.Zi(),this.At=[],eD.on(j.TILE_SHOWED_UP,this.Qa),this.scene.events.on(tt.EVENTS.CAPTURING,this.$a)}init(){for(let e in this.o)this.enableItem(e),this.deactivateItem(e),this.updateItemAmount(e);this.setState(Nd.READY)}start(){this.isRunning()||(this.eo(),this.setIsUseableItem(!1),this.setState(Nd.RUNNING))}increaseItem(e,t){let i=vi.getGameData()?.items;if(!en.isObject(i))return;let s="";switch(e){case"ItemBombDefuse":s=Bd.ID;break;case"ItemHint":s=K.HINT.ID;break;case"ItemShuffle":s=K.SHUFFLE.ID;break;case"ItemRocket":s=EC.ID;break;default:break}let n=i[s];if(!en.isNumber(n))return;let r=this.o[s].amount+t;vi.setGameData({items:{[this.o[s].name]:r}})}stop(){if(this.isRunning()){this.setIsUseableItem(!1),this.en();for(let e in this.o)this.deactivateItem(e);this.setState(Nd.STOPPED)}}Qa=()=>{this.setIsUseableItem(!0)};$a=()=>{this.setIsUseableItem(!1),this.io(),this.so(),this.no(),this.updateBombDefuseItemState(),this.ro()};setIsUseableItem(e){this.ei!==e&&(this.ei=e)}getIsUseableItem(){return this.ei}updateItemAmount(e){let t=this.o[e];if(!t)return;let i=vi.getGameData()?.items;if(!en.isObject(i))return;let s=i[e];if(en.isNumber(s)){if(t instanceof tn){let{level:n}=this.scene.levelHandler.getConfigs();if(n===hD){t.setAmount(1),t.setCountdownUI();return}t.setAmount(s+1),t.setCountdownUI();return}t.setAmount(s)}}addItemAmount(e,t){let i=this.o[e];if(!i||!en.isNumber(t))return;let s=i.amount+t;i.setAmount(s),vi.setGameData({items:{[i.name]:s}})}updateSuperRocketCountdown(){let e=this.o[K.SUPER_ROCKET.ID]??{},{amount:t}=e;t===1&&e.setAmount(uD+1),vi.setGameData({items:{[e.name]:e.amount-1}})}reduceSuperRocketCountdown(){let e=this.o[K.SUPER_ROCKET.ID]??{},{amount:t}=e;t>1&&e.setAmount(t-1),vi.setGameData({items:{[e.name]:e.amount-1}})}resetSuperRocketUsage(){let e=this.o[K.SUPER_ROCKET.ID]??{};e.setAmount(1),vi.setGameData({items:{[e.name]:0}})}eo(){let{levelHandler:e}=this.scene;e.isLevelHaveBomb()||this.disableItem(K.BOMB_DEFUSE.ID)}activeItem(e){if(!this.isRunning())return!1;let{tutorialManager:t,tileManager:i}=this.scene,{tutorialId:s}=t,n=s===e,r=e===yC.ID;if(!this.ei&&!n&&!r||!this.o[e]||this.itemActive&&this.itemActive!==e||(this.en(),e===Bd.ID&&!i.isHavingBomb()))return!1;if(!this.o[e].getIsFree()&&this.o[e].amount<1&&e!==K.INVITE.ID){if(!this.ao(e))return ot.openScreen(mt.REWARD_ITEM_SCREEN,{itemId:e,rewardCount:1}),!1;this.o[e].setAmount(1)}for(let o in this.o)o!==yC.ID&&this.deactivateItem(o,!1);if(r||(this.itemActive=e),this.o[e].activeItem(),this.setIsUseableItem(!1),!this.o[e].getIsFree()&&!this.Ja.includes(e)){let o=this.o[e].amount-1;this.o[e].setAmount(o),vi.setGameData({items:{[this.o[e].name]:o}})}return iD.event(sD.USE_ITEM,{item_name:e===K.GUIDE_BOMB_DEFUSE.ID?K.BOMB_DEFUSE.ID:e}),!0}enableItem(e){this.o[e]&&this.o[e].enableItem()}disableItem(e){this.o[e]&&this.o[e].disableItem()}visibleItem(e){this.o[e]&&this.o[e].setVisible(!0)}invisibleItem(e){this.o[e]&&this.o[e].setVisible(!1)}setFreeItem(e){this.o[e]&&this.o[e].setFreeMode(!0)}setPaidItem(e,t=!1){this.o[e]&&this.o[e].setFreeMode(!1,t)}setDepthItemOnTop(e){this.o[e]&&this.o[e].setDepth($.ON_TOP)}setDepthItemNormal(e){this.o[e]&&this.o[e].setDepth($.ITEM)}deactivateItem(e,t=!0){this.o[e]&&(this.itemActive="",this.o[e].deactivateItem(),t&&this.oo(),this.setIsUseableItem(!0))}ho(){if(this.isRunning()&&this.o[this.itemActive])return this.o[this.itemActive]}createMultiMask(e){this.rt?.destroy(),this.rt=this.scene.make.graphics({fillStyle:{color:16711680,alpha:1}}),this.rt.setName("MaskGraphics");for(let t of e)this.rt.fillRoundedRect(t.x,t.y,t.width,t.height,t.radius);this.lt.revive(),this.lt.clearMask(!0),this.lt.setMask(this.rt.createGeometryMask()),this.lt.mask.invertAlpha=!0,this.lo()}lo(){if([K.ROCKET.ID,K.SUPER_ROCKET.ID].indexOf(this.itemActive)===-1)return;this.scene.tweens.killTweensOf(this.At),this.scene.tweens.killTweensOf([this.lt]);let{layoutManager:e,uiManager:t}=this.scene,{groups:i}=e;this.At=i.gameUI.getMatching("visible",!0),t.disablePause();let s=this.o[this.itemActive];(s instanceof Fd||s instanceof tn)&&(this.At=this.At.filter(n=>n.name!==this.itemActive)),this.scene.add.tween({targets:this.At,duration:400,ease:Phaser.Math.Easing.Quadratic.Out,props:{alpha:0}}),this.lt.setAlpha(0),this.scene.add.tween({targets:[this.lt],duration:400,ease:Phaser.Math.Easing.Quadratic.Out,props:{alpha:.6}})}oo(){if(!this.At.length)return;let e=[this.scene.background,...this.At];this.scene.tweens.killTweensOf(e),this.scene.add.tween({targets:this.At,duration:400,ease:Phaser.Math.Easing.Quadratic.In,props:{alpha:1},onComplete:()=>{let{uiManager:t}=this.scene;t.showUIByMatchMode(),this.At=[],this.scene.uiManager.enablePause()}}),this.scene.add.tween({targets:[this.lt],duration:400,ease:Phaser.Math.Easing.Quadratic.Out,props:{alpha:0},onComplete:()=>{this.lt.kill()}})}applyItem(e){if(!this.isRunning()||!this.ho())return!1;let t=!1;switch(this.itemActive){case K.CHANGE_COLOR.ID:{let i=this.o[K.CHANGE_COLOR.ID];i instanceof mC&&(t=i.useItem(e))}break;default:return!1}return t}getItems(){let e=[],t=Object.values(this.o);for(let i of t)i instanceof dC||e.push(i);return e}getItem(e){return this.o[e]||null}updateBombDefuseItemState(){let{tileManager:e,itemManager:t}=this.scene;e.isHavingBomb()||t.disableItem(Bd.ID)}io(){let{tileManager:e,itemManager:t}=this.scene;e.getAliveTiles().length<=0&&t.disableItem(rD.ID)}so(){let{tileManager:e,itemManager:t}=this.scene;e.getAliveTiles().length<4&&t.disableItem(EC.ID)}no(){let{tileManager:e,itemManager:t}=this.scene;e.getAliveTiles().length<4&&t.disableItem(nD.ID)}ro(){let{tileManager:e,itemManager:t}=this.scene,i=this.o[K.SUPER_ROCKET.ID];if(!i||!(i instanceof tn))return;let{amount:s}=i;if(s===1){if(e.getAliveTiles().length<cD*2){t.disableItem(K.SUPER_ROCKET.ID);return}i.setCountdownUI()}}en(){let e=this.o[K.SUPER_ROCKET.ID];!e||!(e instanceof tn)||e.stopRechargeNotificationAnimation()}ji(){this.lt=this.scene.make.image({key:aD,frame:oD.BLANK}),this.lt.setTint(0),this.lt.setDepth($.TILE+1);let{displayWidth:e,displayHeight:t}=this.scene.gameZone,i=e+100,s=t+100;this.lt.setDisplaySize(i,s),Phaser.Display.Align.In.Center(this.lt,this.scene.gameZone),this.lt.kill()}Zi(){this.uo(),this.co(),this.po(),this.go(),this.fo(),this.mo(),this.vo(),this.Eo(),this.yo(),this.xo(),this.So(),this.Ao(),this.wo(),this.Co(),this.Po(),this.Ro(),this.bo()}uo(){let{objects:e}=this.scene.layoutManager;this.o[K.HINT.ID]=e.hintItem}mo(){let{objects:e}=this.scene.layoutManager;this.o[K.SHUFFLE.ID]=e.shuffleItem}go(){let{objects:e}=this.scene.layoutManager;this.o[K.BOMB_DEFUSE.ID]=e.defuseItem}fo(){let{objects:e}=this.scene.layoutManager;this.o[K.GUIDE_BOMB_DEFUSE.ID]=e.guideDefuseItem}co(){let{objects:e}=this.scene.layoutManager;this.o[K.ROCKET.ID]=e.rocketItem}po(){let{objects:e}=this.scene.layoutManager;this.o[K.INVITE.ID]=e.inviteItem}vo(){let{objects:e}=this.scene.layoutManager;this.o[K.SUPER_ROCKET.ID]=e.superRocketItem}yo(){let{objects:e}=this.scene.layoutManager;e.winGame&&(this.o[K.WIN_GAME.ID]=e.winGame)}Eo(){let{objects:e}=this.scene.layoutManager;e.newGame&&(this.o[K.NEW_GAME.ID]=e.newGame)}Ro(){let{objects:e}=this.scene.layoutManager;e.changeColor&&(this.o[K.CHANGE_COLOR.ID]=e.changeColor)}Ao(){let{objects:e}=this.scene.layoutManager;e.resetData&&(this.o[K.RESET_DATA.ID]=e.resetData)}wo(){let{objects:e}=this.scene.layoutManager;e.backLevel&&(this.o[K.BACK_LEVEL.ID]=e.backLevel)}Co(){let{objects:e}=this.scene.layoutManager;e.nextLevel&&(this.o[K.NEXT_LEVEL.ID]=e.nextLevel)}Po(){let{objects:e}=this.scene.layoutManager;e.openLuckyWheel&&(this.o[K.OPEN_LUCKY_WHEEL.ID]=e.openLuckyWheel)}bo(){let{objects:e}=this.scene.layoutManager;e.bombExplosive&&(this.o[K.BOMB_EXPLOSIVE.ID]=e.bombExplosive)}xo(){let{objects:e}=this.scene.layoutManager;e.timeUp&&(this.o[K.TIME_UP.ID]=e.timeUp)}So(){let{objects:e}=this.scene.layoutManager;e.autoMatch&&(this.o[K.AUTO_MATCH.ID]=e.autoMatch)}ao(e){let t=this.o[e];if(!t)return!1;let{coins:i=0}=vi.getGameData()??{};if(!en.isNumber(i))return!1;let{itemCost:s}=t;if(i<s)return!1;$i.removeCoin(s);let n=t.x,r=t.y;return this.scene.effectManager.playBuyItemAnimation(n,r),!0}},pD=dD;U(),U();var gD={StartLevel:1,Items:{Free:0},DailyTasks:{Duration:86400},LevelDifficultRate:{FromUnder30:1,FromUnder35:1,FromUnder45:1,FromUnder200:1}},fD=gD,{Utils:{Json:mD}}=Ludex,{StartLevel:vD}=fD,ED=class{scene;level=0;targetScore=0;qi;m;constructor(e){this.scene=e,this.qi=Ws}init(e){this.level=e??vD,this.setConfig(this.level)}getConfigs(){return this.m}isLevelHaveBomb(){return!!(this.m.specials&&this.m.specials.bomb!==void 0&&this.m.specials.bomb>0||this.m.customFen?.code.includes("b"))}getConfigByLevel(e){let t=Ws.length-1;return e>t?this.sn(e):this.qi[e]}up(){let e=this.Io(this.level);this.level=e,this.setConfig(e)}Io(e){return e+1}setConfig(e){let t=Ws.length-1,i=e>t,s=i?t:e;i?this.m=this.sn(e):this.m=mD.clone(this.qi[s]);let n=this.m.rows,r=this.m.columns;if(!this.m)return;this.removeButterflyThemeAfterLevel30(),this.m.customFen&&(this.m.rows=this.m.customFen.rows,n=this.m.rows,this.m.columns=this.m.customFen.columns,r=this.m.columns,this.m.customFen.code=this.m.customFen.portraitCode),lt.isLandscape()&&(this.m.rows=r,this.m.columns=n,this.m.customFen&&(this.m.customFen.code=this.m.customFen?.desktopCode));let{rows:o,columns:a}=this.m,h=5,l=o*a,u=h*l;this.targetScore=i?u+400:u}removeButterflyThemeAfterLevel30(){let{theme:e,level:t}=this.m;t<30||e.includes("butterfly")&&(this.m.theme=this.m.theme.filter(i=>i!=="butterfly"))}sn(e){let t=Ws.length-1,i=(e-t)%5,s=8,n=5,r="normal",o=100,a=1,h=1,l=20,u=Phaser.Math.RND.between(2,4);switch(i){case 1:s=10,n=6,r="fly-up-push-right",o=130,l=Phaser.Math.RND.between(12,24);break;case 2:s=10,n=7,r="fly-up-push-left",o=160,h=Phaser.Math.RND.between(1,3),a=2,l=Phaser.Math.RND.between(12,24);break;case 3:s=12,n=7,r="fall-down-push-left",o=180,l=Phaser.Math.RND.between(12,24);break;case 4:s=12,n=7,r="fall-down-push-right",o=200,h=Phaser.Math.RND.between(1,2),a=2,l=Phaser.Math.RND.between(24,28);break}return{level:e,mode:r,time:o,colors:l,specials:{bomb:a,rocket:h},rules:{maxSpaceOfPair:8,addRandomTilesPerMove:u},columns:n,rows:s,theme:[_i.BIRD,_i.CAKE,_i.FRUIT,_i.CANDY]}}},yD=ED;U();var TD=class extends Ne{scene;nn;ii;constructor(e){super(e),this.scene=e,this.scene.events.on(tt.EVENTS.NEXT_TURN,this._o)}processGravityMode=()=>{let{modeManager:e,tileManager:t,animationManager:i}=this.scene;this.nn?.remove(),this.ii?.remove(),i.isMoveTilesCompleted=!1,this.nn=this.scene.time.addEvent({delay:300,callback:()=>{if(this.ii?.remove(),t.getAliveTiles().length<=14){this.rn();return}e.applyMode(),this.ii=this.scene.time.addEvent({delay:100,repeat:20,callback:()=>{i.isMoveTilesCompleted&&(this.ii.remove(),this.rn())}})}})};rn(){let{tileManager:e,boardManager:t}=this.scene;if(!e.isCanMove()){e.processOutOfMove();return}if(e.handleExtraSpawn()){this.processGravityMode();return}t.processNoAvailableMatches()}_o=()=>{let{animationManager:e,itemManager:t,tileManager:i}=this.scene;i.isSelectable=!0,t.setIsUseableItem(!0),e.isMoveTilesCompleted=!0};applyMode=()=>{let{animationManager:e,levelHandler:t}=this.scene,{mode:i}=t.getConfigs(),{moveDuration:s}=e,n=s+10;switch(i.toString()){case ve.NORMAL:e.isMoveTilesCompleted=!0;break;case ve.FALL_DOWN:this.si(0);break;case ve.FLY_UP:this.ni(0);break;case ve.PUSH_LEFT:this.Ji(0);break;case ve.PUSH_RIGHT:this.Qi(0);break;case ve.FALL_DOWN_PUSH_LEFT:this.si(0),this.Ji(n);break;case ve.FLY_UP_PUSH_RIGHT:this.ni(0),this.Qi(n);break;case ve.FALL_DOWN_PUSH_RIGHT:this.si(0),this.Qi(n);break;case ve.FLY_UP_PUSH_LEFT:this.ni(0),this.Ji(n);break;case ve.PUT_COLUMNS_MIDDLE:this.$i(0);break;case ve.PUT_ROWS_MIDDLE:this.Oo(0);break;case ve.FALL_DOWN_PUT_COLUMNS_MIDDLE:this.si(0),this.$i(n);break;case ve.FLY_UP_PUT_COLUMNS_MIDDLE:this.ni(0),this.$i(n);break;default:e.isMoveTilesCompleted=!0;break}};ue(){let{boardManager:e}=this.scene,{boardMap:t}=e,i=[];for(let s in t)for(let n in t[s]){let r=t[s][n];i.push(r)}return i}ni(e=0){let{boardManager:t,animationManager:i}=this.scene,s=this.ue(),n=0;for(let r of s){let{row:o,column:a}=r;if(r.isCaptured()||r.isCapturing())continue;let h=this.an(o,a);h<1||(n++,i.moveRows({tile:r,fromRow:o,toRow:o-h},e),t.tileSwap({fromRow:o,toRow:o-h,fromColumn:a,toColumn:a}))}n===0&&(i.isMoveTilesCompleted=!0)}si(e=0){let{boardManager:t,animationManager:i}=this.scene,s=this.ue();s.reverse();let n=0;for(let r of s){let{row:o,column:a}=r;if(r.isCaptured()||r.isCapturing())continue;let h=this.hn(o,a);h<1||(n++,i.moveRows({tile:r,fromRow:o,toRow:o+h},e),t.tileSwap({fromRow:o,toRow:o+h,fromColumn:a,toColumn:a}))}n===0&&(i.isMoveTilesCompleted=!0)}Ji(e=0){let{boardManager:t,animationManager:i}=this.scene,s=this.ue(),n=0;for(let r of s){let{row:o,column:a}=r;if(r.isCaptured()||r.isCapturing())continue;let h=this.ln(o,a);h<1||(n++,i.moveColumns({tile:r,fromColumn:a,toColumn:a-h},e),t.tileSwap({fromRow:o,toRow:o,fromColumn:a,toColumn:a-h}))}n===0&&(i.isMoveTilesCompleted=!0)}Qi(e=0){let{boardManager:t,animationManager:i}=this.scene,s=this.ue();s.reverse();let n=0;for(let r of s){let{row:o,column:a}=r;if(r.isCaptured()||r.isCapturing())continue;let h=this.un(o,a);h<1||(n++,i.moveColumns({tile:r,fromColumn:a,toColumn:a+h},e),t.tileSwap({fromRow:o,toRow:o,fromColumn:a,toColumn:a+h}))}n===0&&(i.isMoveTilesCompleted=!0)}$i(e=0){let{boardManager:t,animationManager:i}=this.scene,s=this.ue(),n=0;for(let r of s){let{row:o,column:a}=r;if(r.isCaptured()||r.isCapturing())continue;let h=this.cn(o,a);h<1||(n++,i.moveColumns({tile:r,fromColumn:a,toColumn:a-h},e),t.tileSwap({fromRow:o,toRow:o,fromColumn:a,toColumn:a-h}))}s.reverse();for(let r of s){let{row:o,column:a}=r;if(r.isCaptured()||r.isCapturing())continue;let h=this.dn(o,a);h<1||(n++,i.moveColumns({tile:r,fromColumn:a,toColumn:a+h},e),t.tileSwap({fromRow:o,toRow:o,fromColumn:a,toColumn:a+h}))}n===0&&(i.isMoveTilesCompleted=!0)}Oo(e=0){let{boardManager:t,animationManager:i}=this.scene,s=this.ue(),n=0;for(let r of s){let{row:o,column:a}=r;if(r.isCaptured()||r.isCapturing())continue;let h=this.pn(o,a);h<1||(n++,i.moveRows({tile:r,fromRow:o,toRow:o-h},e),t.tileSwap({fromRow:o,toRow:o-h,fromColumn:a,toColumn:a}))}s.reverse();for(let r of s){let{row:o,column:a}=r;if(r.isCaptured()||r.isCapturing())continue;let h=this.gn(o,a);h<1||(n++,i.moveRows({tile:r,fromRow:o,toRow:o+h},e),t.tileSwap({fromRow:o,toRow:o+h,fromColumn:a,toColumn:a}))}n===0&&(i.isMoveTilesCompleted=!0)}an(e,t,i=0){if(this.Mo(e,t)){let s=e-1;return this.an(s,t,i+1)}return i}hn(e,t,i=0){if(this.Lo(e,t)){let s=e+1;return this.hn(s,t,i+1)}return i}ln(e,t,i=0){if(this.Do(e,t)){let s=t-1;return this.ln(e,s,i+1)}return i}un(e,t,i=0){if(this.ko(e,t)){let s=t+1;return this.un(e,s,i+1)}return i}cn(e,t,i=0){if(this.Fo(e,t)){let s=t-1;return this.cn(e,s,i+1)}return i}dn(e,t,i=0){if(this.No(e,t)){let s=t+1;return this.dn(e,s,i+1)}return i}pn(e,t,i=0){if(this.Bo(e,t)){let s=e-1;return this.pn(s,t,i+1)}return i}gn(e,t,i=0){if(this.Uo(e,t)){let s=e+1;return this.gn(s,t,i+1)}return i}Mo(e,t){let i=e-1,{boardManager:s}=this.scene,{boardMap:n}=s;if(!n[i]||!n[i][t])return!1;let r=n[i][t];return r.isCaptured()||r.isCapturing()}Lo(e,t){let i=e+1,{boardManager:s}=this.scene,{boardMap:n}=s;if(!n[i]||!n[i][t])return!1;let r=n[i][t];return r.isCaptured()||r.isCapturing()}Do(e,t){let i=t-1,{boardManager:s}=this.scene,{boardMap:n}=s;if(!n[e]||!n[e][i])return!1;let r=n[e][i];return r.isCaptured()||r.isCapturing()}ko(e,t){let i=t+1,{boardManager:s}=this.scene,{boardMap:n}=s;if(!n[e]||!n[e][i])return!1;let r=n[e][i];return r.isCaptured()||r.isCapturing()}Fo(e,t){let{columns:i}=this.scene.levelHandler.getConfigs(),s=t-1;if(s<i/2)return!1;let{boardManager:n}=this.scene,{boardMap:r}=n;if(!r[e]||!r[e][s])return!1;let o=r[e][s];return o.isCaptured()||o.isCapturing()}No(e,t){let{columns:i}=this.scene.levelHandler.getConfigs(),s=t+1;if(s>i/2)return!1;let{boardManager:n}=this.scene,{boardMap:r}=n;if(!r[e]||!r[e][s])return!1;let o=r[e][s];return o.isCaptured()||o.isCapturing()}Bo(e,t){let{rows:i}=this.scene.levelHandler.getConfigs(),s=e-1;if(s<i/2)return!1;let{boardManager:n}=this.scene,{boardMap:r}=n;if(!r[s]||!r[s][t])return!1;let o=r[s][t];return o.isCaptured()||o.isCapturing()}Uo(e,t){let{rows:i}=this.scene.levelHandler.getConfigs(),s=e+1;if(s>i/2)return!1;let{boardManager:n}=this.scene,{boardMap:r}=n;if(!r[s]||!r[s][t])return!1;let o=r[s][t];return o.isCaptured()||o.isCapturing()}},xD=TD;U(),U(),U();var{KEY:Ud,FRAME:Gd}=G.EFFECTS,SD=class extends Phaser.GameObjects.Container{start;end;middle;constructor(e){super(e),this.scene=e,this.createGlowLine(),this.scene.add.existing(this)}createGlowLine(){this.start=this.scene.add.image(0,0,Ud,Gd.CAPTURE_PATH_START),this.end=this.scene.add.image(0,0,Ud,Gd.CAPTURE_PATH_END),this.middle=this.scene.add.image(0,0,Ud,Gd.CAPTURE_PATH_MIDDLE),this.add([this.start,this.end,this.middle])}setGlowLineLength(e,t){let i=e+6;this.middle.setWorldSize(i,18),this.start.x=-i/2,this.end.x=i/2,t==="horizontal"?this.angle=0:this.angle=90}},xo=SD,{KEY:AD,FRAME:wD}=G.GAMEPLAY,So=$.TILE+1,CD=class extends Phaser.GameObjects.GameObject{whiteCircles;lineList;firstTilePosition=null;fadeTween;constructor(e){super(e,"captureHintPath"),this.whiteCircles=e.add.group(),this.lineList=e.add.group(),this.scene.add.existing(this)}drawNewPath(e){let t=[],i=e[0],s=null;for(let n=1;n<e.length;n++){let r=e[n];if(!s){s=r;continue}if(i.x===s.x&&s.x===r.x){s=r;continue}if(i.y===s.y&&s.y===r.y){s=r;continue}t.push([i,s]),i=s,s=r}t.push([i,s]),t.forEach((n,r)=>{if(!n[0]||!n[1])return;let o=this.translateGridPositionToScreenPosition(n[0]),a=this.translateGridPositionToScreenPosition(n[1]);this.assignLine(o.x,o.y,a.x,a.y),this.assignWhiteCircle(o.x,o.y),r===t.length-1&&this.assignWhiteCircle(a.x,a.y)}),this.runFadeInTween()}updateFirstTilePosition(){let e=this.scene,{boardMap:t}=e.boardManager;if(!t||!t[1]||!t[1][1])return;let{x:i,y:s}=t[1][1].getWorldPosition();this.firstTilePosition=new Phaser.Math.Vector2(i,s)}clearFirstTilePosition(){this.firstTilePosition=null}setFirstTilePosition(e){this.firstTilePosition=e}clear(){this.runFadeOutTween()}hideHintEffect(){let e=this.whiteCircles.getChildren(),t=this.lineList.getChildren();for(let i of e)i.setVisible(!1);for(let i of t)i.setVisible(!1)}showHintEffect(){let e=this.whiteCircles.getChildren(),t=this.lineList.getChildren();for(let i of e)i.active&&i.setVisible(!0);for(let i of t)i.active&&i.setVisible(!0)}kill(){let e=this.whiteCircles.getChildren(),t=this.lineList.getChildren();for(let i of e)this.whiteCircles.killAndHide(i);for(let i of t)this.lineList.killAndHide(i)}translateGridPositionToScreenPosition(e){let{x:t=1,y:i=1}=e;this.firstTilePosition||this.updateFirstTilePosition();let s=this.scene.boardManager.getTileSize()+1,n=this.firstTilePosition?this.firstTilePosition.x:0,r=this.firstTilePosition?this.firstTilePosition.y:0;return{x:n+(i-1)*s,y:r+(t-1)*s}}assignWhiteCircle(e,t){let i=this.whiteCircles.getFirstDead();if(i)return i.setPosition(e,t),i.setActive(!0),i.setVisible(!0),i.setAlpha(0),i.setDepth(So+1),i;let s=this.scene.make.image({key:AD,frame:wD.HINT_LINE_DOT});return this.whiteCircles.add(s),s.setPosition(e,t),s.setDepth(So+1),s.setScale(s.scale*.5),s.setAlpha(0),this.scene.add.existing(s),s}assignLine(e,t,i,s){let n=this.lineList.getFirstDead(),r=(e+i)/2,o=(t+s)/2,a=e===i?"vertical":"horizontal",h=Phaser.Math.Distance.Between(e,t,i,s);if(n&&n instanceof xo)return n.setPosition(r,o),n.setGlowLineLength(h,a),n.revive(),n.setAlpha(0),n.setDepth(So),n;let l=new xo(this.scene);return this.lineList.add(l),l.setPosition(r,o),l.setGlowLineLength(h,a),l.setDepth(So),l.setAlpha(0),this.scene.add.existing(l),l}runFadeInTween(){this.fadeTween?.stop();let e=this.lineList.getChildren().filter(s=>s.active),t=this.whiteCircles.getChildren().filter(s=>s.active),i=this.scene.tweens.add({targets:[...e,...t],props:{alpha:{from:0,to:1}},duration:200,onStop:()=>{for(let s of e)s.setAlpha(1);for(let s of t)s.setAlpha(1)}});this.fadeTween=i}runFadeOutTween(){this.fadeTween?.stop();let e=this.lineList.getChildren().filter(s=>s.active),t=this.whiteCircles.getChildren().filter(s=>s.active),i=this.scene.tweens.add({targets:[...e,...t],props:{alpha:{from:1,to:0}},duration:200,onComplete:()=>{this.kill()},onStop:()=>{this.kill()}});this.fadeTween=i}},PD=CD;U(),U(),U();var{KEY:RD,FRAME:bD}=G.GAMEPLAY,{Utils:{Device:ID}}=Ludex,_D=class extends Phaser.GameObjects.Container{emitZone;isRunning;emitter;constructor(e){super(e),this.createEmitZone(),this.createEmitters(),this.scene.add.existing(this)}createEmitZone(){this.emitZone=new Phaser.Geom.Rectangle}createEmitters(){let e=1/ID.pixelRatio();this.emitter=this.scene.add.particles(0,0,RD,{frame:bD.EFFECT_TRAIL_STAR,emitZone:{source:this.emitZone,type:"random"},speed:20,timeScale:1,frequency:50,gravityY:100,alpha:{start:1,end:0,ease:Phaser.Math.Easing.Expo.Out},scale:{start:e*1.2,end:e*.1,ease:Phaser.Math.Easing.Expo.Out},lifespan:2666}),this.add(this.emitter)}run(e,t,i,s,n){this.stop(),this.reset(),this.emitZone.setSize(s,n),this.emitZone.setPosition(t-s/2,i-n/2),this.emitter.setQuantity(e),this.emitter.start(),this.isRunning=!0}explode(e,t,i){this.emitter||this.reset(),this.isRunning=!1,this.emitter.explode(e,t,i)}stop(){this.isRunning=!1,this.emitter?.killAll(),this.emitter?.stop()}reset(){this.createEmitters()}moveEmitZone(e,t){this.emitZone.setPosition(e,t)}},Yd=_D;U();var{KEY:OD,FRAME:MD}=G.GAMEPLAY,LD=class extends Phaser.GameObjects.Container{deathZone;emitter;constructor(e){super(e),this.createDeathZone(),this.createEmitters(),this.kill(),this.scene.add.existing(this)}createDeathZone(){this.deathZone=new Phaser.Geom.Circle}createEmitters(){this.emitter=this.scene.add.particles(0,0,OD,{frame:MD.EFFECT_TRAIL_STAR,speed:{min:10,max:80},scale:{start:1,end:0},alpha:{start:1,end:.2,ease:Phaser.Math.Easing.Expo.Out},deathZone:{source:this.deathZone,type:"onLeave"},lifespan:2e3}),this.add(this.emitter)}explode(e,t,i,s){this.revive(),this.deathZone.radius=s,this.deathZone.setPosition(t,i),this.emitter.explode(e,t,i)}},TC=LD,{KEY:xC,FRAME:SC}=G.GAMEPLAY,as=$.EFFECT+1,DD=class extends Phaser.GameObjects.GameObject{starList;lineList;whiteCircles;firstTilePosition=null;starTweenList=[];starExpandTween;lineTween;captureStarTrails;explodeParticle;score;pathLength;constructor(e){super(e,"capturePath"),this.starList=e.add.group(),this.lineList=e.add.group(),this.whiteCircles=e.add.group(),this.createEffects(),this.score=0}createEffects(){this.captureStarTrails=[],this.explodeParticle=new TC(this.scene),this.explodeParticle.setDepth($.EFFECT)}drawNewPath(e,t=!1){this.pathLength=e.length;let i=this.drawLines(e);t?this.drawDots(i):(this.drawStars(e),this.runStarExpandTween()),this.runLineTween("fadeIn")}drawDots(e){e.forEach((t,i)=>{if(!t[0]||!t[1])return;let s=this.translateGridPositionToScreenPosition(t[0]),n=this.translateGridPositionToScreenPosition(t[1]);this.assignLine(s.x,s.y,n.x,n.y),this.assignWhiteCircle(s.x,s.y),i===e.length-1&&this.assignWhiteCircle(n.x,n.y)})}drawLines(e){let t=[],i=e[0],s=null;for(let n=1;n<e.length;n++){let r=e[n];if(!s){s=r;continue}if(i.x===s.x&&s.x===r.x){s=r;continue}if(i.y===s.y&&s.y===r.y){s=r;continue}t.push([i,s]),i=s,s=r}t.push([i,s]);for(let n=0;n<t.length;n++){let r=t[n];if(!r[0]||!r[1])continue;let o=this.translateGridPositionToScreenPosition(r[0]),a=this.translateGridPositionToScreenPosition(r[1]);this.assignLine(o.x,o.y,a.x,a.y)}return t}drawStars(e){for(let t=0;t<e.length;t++){let i=e[t];if(!i)continue;let{x:s,y:n}=this.translateGridPositionToScreenPosition(i);this.assignStar(s,n)}}kill(){for(let n of this.starTweenList)n.stop();this.starTweenList=[];let e=this.starList.getChildren();for(let n=0;n<e.length;n++)this.starList.killAndHide(e[n]);this.score=0,this.pathLength=1;let t=this.captureStarTrails;for(let n of t)n.stop();let i=this.lineList.getChildren();for(let n=0;n<i.length;n++)this.lineList.killAndHide(i[n]);let s=this.whiteCircles.getChildren();for(let n=0;n<s.length;n++)this.whiteCircles.killAndHide(s[n]);this.lineTween?.stop(),this.setActive(!1)}updateFirstTilePosition(){let e=this.scene,{boardMap:t}=e.boardManager;if(!t||!t[1]||!t[1][1])return;let{x:i,y:s}=t[1][1].getWorldPosition();this.firstTilePosition=new Phaser.Math.Vector2(i,s)}clearFirstTilePosition(){this.firstTilePosition=null}setFirstTilePosition(e){this.firstTilePosition=e}setScore(e){this.score=e}handleCaptureEffectEnd(){let e=this.scene;if(this.starList.getFirstAlive()===null){e.eatScore(this.score),this.kill();return}this.runLineTween("fadeOut"),this.runStarTween()}runLineTween(e){this.lineTween?.stop();let t=this.lineList.getChildren().filter(n=>n.active),i=this.whiteCircles.getChildren().filter(n=>n.active),s=this.scene.tweens.add({targets:[...t,...i],duration:200,props:{alpha:{from:e==="fadeIn"?0:1,to:e==="fadeIn"?1:0}},onComplete:()=>{e==="fadeOut"&&this.cleanLineWhenFadeOut()},onStop:()=>{for(let n of t)n.setAlpha(e==="fadeIn"?1:0);for(let n of i)n.setAlpha(e==="fadeIn"?1:0);e==="fadeOut"&&this.cleanLineWhenFadeOut()}});this.lineTween=s}cleanLineWhenFadeOut(){let e=this.lineList.getChildren().filter(i=>i.active),t=this.whiteCircles.getChildren().filter(i=>i.active);for(let i=0;i<e.length;i++)this.lineList.killAndHide(e[i]);for(let i=0;i<t.length;i++)this.whiteCircles.killAndHide(t[i])}runStarTween(){this.starList.getChildren().forEach((e,t)=>{if(!e.active)return;let i=this.scene,{objects:s}=i.layoutManager,{x:n,y:r}=s.starProgressBar.getStarFlyInPosition();if(ht.isChallengeMode()){let{x:d,y:p}=s.challengeInfo.getWorldPosition();n=d-50,r=p}let o=25,a=Phaser.Math.Angle.Between(e.x,e.y,n,r),h=Phaser.Math.Distance.Between(e.x,e.y,n,r),l=this.requestCaptureStarTrail();l.run(1,e.x,e.y,0,0);let u=this.scene.tweens.chain({targets:e,tweens:[{targets:e,x:e.x-Math.cos(a)*o,y:e.y-Math.sin(a)*o,duration:250,delay:40*t,ease:Phaser.Math.Easing.Quadratic.In,onUpdate:()=>{l.moveEmitZone(e.x,e.y)}},{props:{x:{from:e.x,to:n,ease:Phaser.Math.Easing.Quadratic.Out},y:{from:e.y,to:r,ease:Phaser.Math.Easing.Quadratic.Out},scale:{from:e.scale,to:e.scale*Math.sqrt(2),ease:Phaser.Math.Easing.Quintic.Out}},duration:(h+o)/300*600,onComplete:()=>{i.eatScore(this.score/this.pathLength),nt.playSound(ut.COLLECT_STARS,{volume:.7}),l.stop(),this.explodeParticle.explode(15,n,r,30)},onUpdate:()=>{l.moveEmitZone(e.x,e.y)},onStop:()=>{i.eatScore(this.score/this.pathLength),l.stop()}},{alpha:0,duration:400,ease:Phaser.Math.Easing.Cubic.Out,onComplete:()=>{this.starList.killAndHide(e),this.starTweenList=this.starTweenList.filter(d=>d!==u),this.starTweenList.length},onStop:()=>{this.starList.killAndHide(e),this.starTweenList=this.starTweenList.filter(d=>d!==u),this.starTweenList.length}}]})})}runStarExpandTween(){this.starExpandTween?.stop();let e=this.starList.getChildren().filter(n=>n.active);if(e.length<1)return;let t=e[0].scaleX,i=e[0].scaleY,s=this.scene.tweens.add({targets:e,duration:200,props:{scaleX:{from:0,to:t},scaleY:{from:0,to:t}},onStart:()=>{for(let n of e)n.setVisible(!0)},onStop:()=>{for(let n of e)n.setScale(t,i)}});this.starExpandTween=s}translateGridPositionToScreenPosition(e){let{x:t=1,y:i=1}=e;this.firstTilePosition||this.updateFirstTilePosition();let s=this.scene.boardManager.getTileSizeWithSpacing(),n=this.firstTilePosition?this.firstTilePosition.x:0,r=this.firstTilePosition?this.firstTilePosition.y:0;return{x:n+(i-1)*s,y:r+(t-1)*s}}assignStar(e,t){let i=this.starList.getFirstDead(),s=22;if(i)return i.setWorldSize(s,s),i.setPosition(e,t),i.setActive(!0),i.setAlpha(1),i.setDepth(as+1),i;let n=this.scene.make.image({key:xC,frame:SC.ICON_STAR_BIG});return this.starList.add(n),n.setWorldSize(s,s),n.setPosition(e,t),n.setDepth(as+1),n.setVisible(!1),n.setAlpha(1),this.scene.add.existing(n),n}requestCaptureStarTrail(){let e=this.captureStarTrails.find(i=>!i.isRunning);if(e)return e;let t=new Yd(this.scene);return t.setDepth(as-1),this.captureStarTrails.push(t),t}assignLine(e,t,i,s){let n=this.lineList.getFirstDead(),r=(e+i)/2,o=(t+s)/2,a=e===i?"vertical":"horizontal",h=Phaser.Math.Distance.Between(e,t,i,s);if(n&&n instanceof xo)return n.setPosition(r,o),n.setGlowLineLength(h,a),n.revive(),n.setDepth(as),n;let l=new xo(this.scene);return this.lineList.add(l),l.setPosition(r,o),l.setGlowLineLength(h,a),l.setDepth(as),this.scene.add.existing(l),l}assignWhiteCircle(e,t){let i=this.whiteCircles.getFirstDead();if(i)return i.setPosition(e,t),i.setActive(!0),i.setVisible(!0),i.setAlpha(0),i.setDepth(as+1),i;let s=this.scene.make.image({key:xC,frame:SC.HINT_LINE_DOT});return this.whiteCircles.add(s),s.setPosition(e,t),s.setDepth(as+1),s.setAlpha(0),this.scene.add.existing(s),s}},AC=DD,kD=class extends Phaser.GameObjects.Group{firstTilePosition=null;constructor(e){super(e),this.scene.add.existing(this)}requestPath(){let e=this.getFirstDead();if(e)return e.setActive(!0),e.setFirstTilePosition(this.firstTilePosition),e;let t=this.scene,i=new AC(t);return i.setFirstTilePosition(this.firstTilePosition),this.add(i),i}updateFirstTilePosition(){let e=this.scene,{boardMap:t}=e.boardManager;if(!t||!t[1]||!t[1][1])return;let{x:i,y:s}=t[1][1].getWorldPosition();this.firstTilePosition=new Phaser.Math.Vector2(i,s)}clearFirstTilePosition(){this.firstTilePosition=null}killPath(e){e.handleCaptureEffectEnd()}killAndHideAll(){let e=this.getChildren();for(let t of e)t instanceof AC&&t.kill()}},FD=kD;U(),U();var{KEY:ND,FRAME:BD}=G.TUTORIAL,UD=class extends Phaser.GameObjects.Container{number;dot;constructor(e){super(e),this.dot=this.scene.make.image({key:ND,frame:BD.DOT_WRONG}),this.add(this.dot),this.number=X.createText(this.scene,"0",15),this.add(this.number);let{displayWidth:t,displayHeight:i}=this.dot;this.setSize(t,i),Phaser.Display.Align.In.Center(this.number,this.dot,0,-1),this.scene.add.existing(this)}setNumber(e){this.number.setText(e.toString())}},Hd=UD,{KEY:wC,FRAME:CC}=G.TUTORIAL,GD=class{scene;decorList;lineList;firstTilePosition=null;drawX=0;drawY=0;constructor(e){this.scene=e,this.decorList=e.add.group(),this.lineList=e.add.group()}drawNewPath(e){let t=this.getShortenPath(e);this.clear();let i=this.translateGridPositionToScreenPosition(t[0]);this.moveTo(i.x,i.y);let s=1,n=null;for(let r=1;r<t.length;r++){let o=t[r],{x:a,y:h}=this.translateGridPositionToScreenPosition(o);if(this.lineTo(a,h),r!==t.length-1)if(s<=2){let l=this.assignDot(a+1,h+1);l.setNumber(s++),n=l}else n=this.assignCross(a,h)}if(s===2&&n!==null){let{x:r=1,y:o=1}=n;n.setVisible(!1),n.setActive(!1),this.assignCross(r,o)}else if(s===1){let{x:r,y:o}=this.translateGridPositionToScreenPosition(t[0]),{x:a,y:h}=this.translateGridPositionToScreenPosition(t[t.length-1]);this.assignCross((a+r)/2,(h+o)/2)}}getShortenPath(e){if(e.length<0)return[];let t=[];t.push(e[0]);let i="none",s=e[0];return e.forEach((n,r)=>{if(r===0)return;let{x:o=1,y:a=1}=n,{x:h=1,y:l=1}=s,u=this.getMovingDirectionString(o-h,a-l);i!=="none"&&i!==u&&t.push(s),i=u,s=n}),t.push(e[e.length-1]),t}updateFirstTilePosition(){let e=this.scene,{boardMap:t}=e.boardManager;if(!t||!t[1]||!t[1][1])return;let{x:i,y:s}=t[1][1].getWorldPosition();this.firstTilePosition=new Phaser.Math.Vector2(i,s)}clearFirstTilePosition(){this.firstTilePosition=null}setFirstTilePosition(e){this.firstTilePosition=e}clear(){let e=this.decorList.getChildren(),t=this.lineList.getChildren();for(let i of e)i.setVisible(!1),i.setActive(!1);for(let i of t)i.setVisible(!1),i.setActive(!1);return this}translateGridPositionToScreenPosition(e){let{x:t=1,y:i=1}=e;this.firstTilePosition||this.updateFirstTilePosition();let s=this.scene.boardManager.getTileSizeWithSpacing(),n=this.firstTilePosition?this.firstTilePosition.x:0,r=this.firstTilePosition?this.firstTilePosition.y:0;return{x:n+(i-1)*s,y:r+(t-1)*s}}assignDot(e,t){let i=this.decorList.getChildren().find(n=>n instanceof Hd&&!n.active);if(i)return i.setPosition(e,t),i.setActive(!0),i.setVisible(!0),i.setDepth($.TILE+2),i;let s=new Hd(this.scene);return this.decorList.add(s),s.setPosition(e,t),s.setDepth($.TILE+2),this.scene.add.existing(s),s}assignCross(e,t){let i=this.decorList.getChildren().find(n=>!(n instanceof Hd)&&!n.active);if(i)return i.setPosition(e,t),i.setActive(!0),i.setVisible(!0),i;let s=this.scene.make.image({key:wC,frame:CC.CROSS_WRONG,origin:{x:.49,y:.38}});return s.setPosition(e,t),s.setWorldSize(27,27),s.setDepth($.TILE+2),this.decorList.add(s),this.scene.add.existing(s),s}moveTo(e,t){this.drawX=e,this.drawY=t}lineTo(e,t){let i=this.lineList.getChildren().find(l=>!l.active),s=8,n=this.getLineLength(e-this.drawX,t-this.drawY),r=this.getLineAngle(e-this.drawX,t-this.drawY),o=this.drawX,a=this.drawY;if(i&&i instanceof Phaser.GameObjects.Image){i.revive(),i.setAngle(r),i.setPosition(o,a),i.setWorldSize(n,s),this.drawX=e,this.drawY=t;return}let h=this.scene.make.image({key:wC,frame:CC.LINE_WRONG,origin:{x:0,y:.5}});h.setAngle(r),h.setWorldSize(n,s),h.setPosition(o,a),h.setDepth($.TILE+1),this.lineList.add(h),this.scene.add.existing(h),this.drawX=e,this.drawY=t}getLineAngle(e,t){switch(this.getMovingDirectionString(t,e)){case"down":return 90;case"up":return-90;case"right":return 0;case"left":return 180;default:return 0}}getLineLength(e,t){switch(this.getMovingDirectionString(t,e)){case"down":case"up":return Math.abs(t);case"right":case"left":return Math.abs(e);default:return 0}}getMovingDirectionString(e,t){return e>0?"down":e<0?"up":t>0?"right":t<0?"left":"none"}},YD=GD;U();var HD=class extends rs{constructor(e,t,i){super(e),this.setName("EmptyTile"),this.setRow(t),this.setColumn(i),this.setState(tt.STATUS.CAPTURED),this.hideHighlight(),this.removeTile()}},zD=HD;U();var{KEY:PC,FRAME:RC}=G.GAMEPLAY,{SPECIALS:WD}=tt,VD=class extends rs{rocketTailSprite;constructor(e,t,i){super(e,RC.TILE_ROCKET,WD.ROCKET),this.setName("RocketTile"),this.setRow(t),this.setColumn(i),this.createRocketSparkle(),this.icon.setScale(this.block.scale)}createRocketSparkle(){let{KEY:e,FRAME:t}=G.EFFECTS;this.rocketTailSprite=this.scene.make.sprite({key:e,frame:`${t.ROCKET_TAIL}0`,origin:{x:.5,y:.5}}),this.add(this.rocketTailSprite),this.updateRocketTailConfig(),this.rocketTailSprite.anims.play(ne.ROCKET_TAIL.KEY,!0)}onExplosive(){this.startExplosive(),super.onExplosive()}kill(){this.rocketTailSprite.anims.stop(),super.kill()}revive(){super.revive(),this.updateRocketTailConfig(),this.rocketTailSprite.anims.play(ne.ROCKET_TAIL.KEY,!0)}updateRocketTailConfig(){let e=this.scene.boardManager.boardSizeHandler.getTileSize();this.rocketTailSprite.setPosition(-e/5,e/5),this.rocketTailSprite.setScale(1.3*this.scene.boardManager.boardSizeHandler.getTileSize()/tt.SIZE)}enableTile(){super.enableTile(),this.icon.setScale(this.block.scale)}startExplosive=()=>{let{boardManager:e}=this.scene,{boardContainer:t}=e,i=t.count("visible",!0)-1;t.moveTo(this,i)};changeDeck(){}drawBlock(e){let t=this.scene.boardManager.getTileSize();this.block=this.scene.add.image(0,0,PC,RC.TILE_BG),this.block.setDisplaySize(t,t),this.add(this.block),this.icon=this.scene.make.sprite({key:PC,frame:e}),this.icon.setScale(this.block.scale/2),this.add(this.icon)}},Ao=VD;U();var XD={COMBO:"combo",RESET:"reset"},mr=XD;U();var KD={ADD:"add",RESET:"reset"},zd=KD;U();var jD=class extends rs{constructor(e,t,i,s,n){super(e,n,s),this.setName("NormalTile"),this.setRow(t),this.setColumn(i)}},ZD=jD;U();var{Utils:{Browser:qD}}=Ludex,{player:JD}=codex,QD=class BR{static _instance;static vibrationProfiles={default:[100]};static get inst(){return this._instance||(this._instance=new BR),this._instance}static addVibrationProfile(t,i){this.vibrationProfiles[t]=i}static vibrate(t){this.isVibrateEnable()&&this.handleVibrate(t)}static vibrateUsingProfile(t){if(!this.isVibrateEnable())return;let i=this.vibrationProfiles[t];i||(i=this.vibrationProfiles.default),this.handleVibrate(i)}static handleVibrate(t){if(!qD.vibrate(t)&&"performHapticFeedbackAsync"in GameSDK.extra){this.useFBInstantHapticFeedback(t);return}}static async useFBInstantHapticFeedback(t){if(!("performHapticFeedbackAsync"in GameSDK.extra))return;let{Time:i}=Ludex.Utils,s=async()=>{try{"performHapticFeedbackAsync"in GameSDK.extra&&await GameSDK.extra.performHapticFeedbackAsync()}catch{}};if(Array.isArray(t)){for(let n=0;n<t.length;n++){let r=t[n];n%2===0&&await s(),await i.sleepAsync(r)}return}await s()}static isVibrateEnable(){return!!JD.getPlayerSetting("vibrate")}},vr=QD,{event:$D,player:tk}=codex,{Utils:{Browser:xY,Valid:bC,Array:ek}}=Ludex,{STATUS:Wd}=ns,{TILES:ik}=G,{BOMB:sk,ROCKET:nk}=tt.SPECIALS,{BaseScore:rk,DefaultTheme:IC,EnableVibrate:ak}=Lt,ok=class extends Ne{scene;isSelectable=!1;Le=!1;currentDeckPrefix;hintTiles=[];Vt;pathFinder;Xt;capturePathGroup;ce;Dt;firstSelectedTile=null;isSuggestPairHintShowed;ri;ai;ts;oi;firstTilePosition;de;constructor(e){super(e),this.scene=e,this.pathFinder=new hC,this.Vt=new PD(this.scene),this.firstTilePosition=new Phaser.Math.Vector2(0,0),this.capturePathGroup=new FD(this.scene),this.Xt=new YD(this.scene),this.ce=null,this.Go(),this.bt()}init(){this.isSelectable=!1,this.firstSelectedTile=null,this.isSuggestPairHintShowed=!1,this.Le=!1,this.Yo();let{theme:e}=this.scene.levelHandler.getConfigs();if(!e||typeof e=="string")this.currentDeckPrefix=IC;else{let t=Phaser.Math.Between(0,e.length-1),i=e[t].toUpperCase(),s=ik[i].KEY;this.scene.textures.exists(s)?this.currentDeckPrefix=e[t]:this.currentDeckPrefix=IC}this.setState(Wd.READY)}start(){if(this.isRunning())return;this.isSelectable=!1,this.ri=0,this.ai=!1,this.ts=!0,this.Le=!1;let{rules:e}=this.scene.levelHandler.getConfigs();this.oi=e.addRandomTilesPerMove||0,this.Vt.clearFirstTilePosition(),this.capturePathGroup.clearFirstTilePosition(),this.Xt.clearFirstTilePosition(),ht.isChallengeMode()?this.Ho():this.zo(),this.setState(Wd.RUNNING)}stop(){this.isRunning()&&(this.isSelectable=!1,this.Le=!1,this.currentDeckPrefix="",this.removeSuggestPairHint(),this.clearWrongPath(),this.capturePathGroup.killAndHideAll(),this.setState(Wd.STOPPED))}getCurrentDeck(){return this.currentDeckPrefix}emitInteraction(){this.scene.events.emit(tt.EVENTS.INTERACTION),this.Le||(this.Le=!0,this.scene.events.emit(tt.EVENTS.FIRST_INTERACTION))}clearWrongPath(){this.Xt.clear()}drawWrongPath(e){this.Xt.drawNewPath(e)}Go(){this.Dt=this.scene.make.group({active:!1,runChildUpdate:!1})}bt(){this.scene.events.on(tt.EVENTS.ROCKET_EXPLODE,this.Wo)}getTiles(){return!this.scene||!this.Dt?.scene?[]:this.Dt.getChildren().filter(e=>e instanceof rs&&e.active)}getAliveTiles(){let e=this.getTiles(),t=[];for(let i of e)i.isCaptured()||i.isCapturing()||t.push(i);return t}hideAllTiles(){let e=this.getAliveTiles();this.de&&this.de.stop(),this.de=this.scene.tweens.add({targets:e,props:{alpha:0},duration:100})}showAllTiles(){let e=this.getAliveTiles();this.de&&this.de.stop(),this.de=this.scene.tweens.add({targets:e,props:{alpha:1},duration:100})}Yo(){if(!this.Dt)return;let e=this.Dt.children.getArray();for(let t of e)t instanceof rs&&t.removeTile()}Vo(e){let t=this.Dt.getChildren().filter(i=>i instanceof rs&&i.active&&i.type===e);return t.length<1?null:t.find(i=>i.visible===!1&&!(i instanceof je))||null}createTileByType(e,t,i){let s=this.Vo(e);if(s)return s.changeDeck(this.currentDeckPrefix),s.enableTile(),s.setRow(t),s.setColumn(i),s;if(e===nk)return new Ao(this.scene,t,i);if(e===sk)return new je(this.scene,t,i);let n=parseInt(e);if(n>28||n<1||!bC.isNumber(n)||e==="empty")return new zD(this.scene,t,i);let r=new ZD(this.scene,t,i,e,`tile-${e}`);return r.changeDeck(this.currentDeckPrefix),r}addTile(e){this.Dt.add(e),this.addEventsTile(e)}addEventsTile=e=>{e.block&&(e.setInteractive({useHandCursor:!0}),e.off(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN),e.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.tileSelect(e)),e.createInput())};removeEventsAllTiles(){let e=this.getTiles();for(let t of e)t?.off(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN),t?.disableInteractive()}addEventsAllAliveTiles(){let e=this.getAliveTiles();for(let t of e)t?.setInteractive({useHandCursor:!0}),t?.off(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN),t?.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.tileSelect(t)),t.createInput()}mn(e){this.hi()&&(this.firstSelectedTile===e&&(this.firstSelectedTile=null),e.setState(tt.STATUS.CAPTURED))}removeTile(e){if(!e)return;let{boardManager:t}=this.scene,{boardContainer:i,tileMap:s}=t,{row:n,column:r}=e;s?.[n]?.[r]&&(s[n][r]="?"),e.nextX=null,e.nextY=null,e.setVisible(!1),i.remove(e),this.Dt.killAndHide(e)}Ho(){let e=[...this.getTiles()];e.reverse();let{animationManager:t,effectManager:i}=this.scene;i.playChallengeFriendsStartAnimation();let s=t.prepareStartBoardAnimation(e);this.scene.time.delayedCall(1600,()=>{let n=t.runStartBoardAnimation(e,s);this.ce=n,this.vn(e,n)})}zo(){let e=[...this.getTiles()];e.reverse();let{animationManager:t}=this.scene,i=t.startBoard(e);this.ce=i,this.vn(e,i)}vn(e,t){t.once(Phaser.Tweens.Events.TWEEN_COMPLETE,()=>{this.scene.tweens.killTweensOf(e);for(let i of e)i.setAlpha(1);this.isSelectable=!0,this.ce=null,this.Vt.updateFirstTilePosition(),this.capturePathGroup.updateFirstTilePosition(),this.Xt.updateFirstTilePosition(),this.Xo(),this.Ko(),$D.emit(j.TILE_SHOWED_UP)})}Ko(){let{boardMap:e}=this.scene.boardManager;if(!e||!e[1])return;let t=Object.keys(e).length,i=Object.keys(e[1]).length;for(let s=1;s<=t;s++)if(e[s])for(let n=1;n<=i;n++){if(!e[s][n])continue;let r=e[s][n];r instanceof je&&r.setBombEffectWhenGameStarts()}}Xo(){let{boardMap:e}=this.scene.boardManager;if(!e||!e[1]||!e[1][1])return;let{x:t,y:i}=e[1][1];this.firstTilePosition=new Phaser.Math.Vector2(t,i)}isCanMove(){return!(!this.isRunning()||this.scene.boardManager.checkIfAllTilesAreCaptured())}processOutOfMove(){if(!this.isRunning())return;let e=this.getTiles();for(let t of e)t.isCaptured()||(this.mn(t),this.removeTile(t));this.scene.finishLevel()}isHavingBomb(){let{levelHandler:e}=this.scene,t=e.getConfigs();if(t.specials&&(!t.specials.bomb||t.specials.bomb===0))return!1;let i=this.getAliveTiles();for(let s=0;s<i.length;s++){let n=i[s];if(n instanceof je&&!n.isDefuse())return!0}return!1}getPairsOfTilesCanCapture(e){let t=[],i=this.getTiles();ek.shuffle(i);for(let s of i){if(s.isCaptured()||s.isCapturing())continue;let n=this.jo(s,t);if(n.length===2&&(t.push(n[0],n[1]),t.length===e*2))break}return t}suggestPairHint(){if(!this.isRunning()||this.isSuggestPairHintShowed)return;let e=this.Zo();if(!e||e.length===0)return;let{x:t=1,y:i=1}=e[0],{x:s=1,y:n=1}=e[e.length-1],{boardMap:r}=this.scene.boardManager,o=r[t][i],a=r[s][n];this.isSuggestPairHintShowed=!0,this.Vt.drawNewPath(e),this.scene.effectManager.playTileHintEffect(o,a),nt.playSound(ut.HINT_ITEM)}removeSuggestPairHint(){this.Vt.clear(),this.hintTiles=[],this.isSuggestPairHintShowed=!1,this.scene.effectManager.stopTileHintEffect()}hideHintEffect(){this.isSuggestPairHintShowed&&(this.scene.effectManager.tileHintEffect.hide(),this.Vt.hideHintEffect())}showHintEffect(){this.isSuggestPairHintShowed&&(this.scene.effectManager.tileHintEffect.show(),this.Vt.showHintEffect())}tileSelect=e=>()=>{if(!this.isSelectable||e.isCapturing()||e.isCaptured())return;let{itemManager:t,boardManager:i,animationManager:s}=this.scene;if(this.emitInteraction(),this.removeSuggestPairHint(),t.itemActive!==""&&t.applyItem(e))return;t.setIsUseableItem(!0);let n=[],r=this.qo(e);if(bC.isBoolean(r))return;if(r===null){let{levelHandler:l,tutorialManager:u}=this.scene,{level:d}=l;if(u.isLevelShowWrongPath(d)&&!ht.isTournamentMode()&&this.Jo(e),nt.playSound(ut.INVALID_MATCH),s.isMoveTilesCompleted){let p=[...this.getTiles()];s.pairWrong(p)}this.firstSelectedTile?.hideHighlight(),this.firstSelectedTile=null;return}this.Xt.clear();let{x:o=0,y:a=0}=r[0],{boardMap:h}=i;n=[h[o][a],e],this.firstSelectedTile=null,this.tilesCapturing(n,r),this.Qo(n.length)};qo(e){if(!this.firstSelectedTile)return e.showHighlight(),this.firstSelectedTile=e,nt.playSound(ut.TILE_SELECT),!1;if(this.firstSelectedTile===e)return e.hideHighlight(),this.firstSelectedTile=null,nt.playSound(ut.TILE_SELECT),!1;if(this.firstSelectedTile.isCaptured()||this.firstSelectedTile.isCapturing())return this.firstSelectedTile=e,!1;let{row:t,column:i,color:s}=this.firstSelectedTile,{row:n,column:r,color:o}=e;if(s!==o)return this.firstSelectedTile.hideHighlight(),e.showHighlight(),this.firstSelectedTile=e,nt.playSound(ut.TILE_SELECT),!1;let a=this.es(t,i,n,r);for(let h of a)h.push(0),h.unshift(0);return a.push(new Array(a[0].length).fill(0)),a.unshift(new Array(a[0].length).fill(0)),this.pathFinder.findPath({x:t,y:i},{x:n,y:r},a)}Jo(e){if(!this.firstSelectedTile)return;let{levelHandler:t}=this.scene,{level:i}=t,s=null,{row:n,column:r}=this.firstSelectedTile,{row:o,column:a}=e;if(i===1&&n===1&&r===2&&o===4&&a===2)s=[],s.push(new Phaser.Math.Vector2(1,2)),s.push(new Phaser.Math.Vector2(4,2)),this.scene.events.emit(tt.EVENTS.NO_PATH_FOUND,"obstacle");else if(i===1&&n===4&&r===2&&o===1&&a===2)s=[],s.push(new Phaser.Math.Vector2(4,2)),s.push(new Phaser.Math.Vector2(1,2)),this.scene.events.emit(tt.EVENTS.NO_PATH_FOUND,"obstacle");else{let h=this.es(n,r,o,a);for(let l of h)l.push(0),l.unshift(0);h.push(new Array(h[0].length).fill(0)),h.unshift(new Array(h[0].length).fill(0)),s=this.pathFinder.findWrongPath({x:n,y:r},{x:o,y:a},h),this.pathFinder.getTurnsOfPath(s)<=2?this.scene.events.emit(tt.EVENTS.NO_PATH_FOUND,"obstacle"):this.scene.events.emit(tt.EVENTS.NO_PATH_FOUND,"more_than_turns")}this.Xt.drawNewPath(s)}es(e=-1,t=-1,i=-1,s=-1){let n=[],{boardMap:r}=this.scene.boardManager,o=Object.keys(r).length;for(let a=1;a<=o;a++){let h=r[a],l=Object.keys(h).length,u=[];for(let d=1;d<=l;d++){let p=h[d];p.isCaptured()||p.isCapturing()||a===e&&d===t||a===i&&d===s?u.push(0):u.push(1)}n.push(u)}return n}Zo(){let e=this.getTiles(),t=[];for(let s of e)s.isCaptured()||s.isCapturing()||t.push(s);if(t.length<2)return[];let i=this.es();for(let s of i)s.push(0),s.unshift(0);i.push(new Array(i[0].length).fill(0)),i.unshift(new Array(i[0].length).fill(0));for(let s=0;s<t.length;s++){let n=t[s],{row:r,column:o}=n;i[r][o]=0;for(let a=s+1;a<t.length;a++){let h=t[a];if(n.color!==h.color)continue;let{row:l,column:u}=h;i[l][u]=0;let d=this.pathFinder.findPath({x:r,y:o},{x:l,y:u},i);if(d)return this.hintTiles=[n,h],d;i[l][u]=1}i[r][o]=1}return null}jo(e,t=[]){if(t.includes(e))return[];let i=[];i.push(e);for(let s of this.getTiles())if(!s.isCaptured()&&!s.isCapturing()&&s!==e&&s.color===e.color&&!t.includes(s)){i.push(s);break}return i}tilesChangeColor(e,t){let{boardManager:i}=this.scene;for(let s of t){let{row:n,column:r,x:o,y:a}=s;this.removeTile(s);let h=this.createTileByType(e,n,r);i.setTileToMap(h,n,r),h.setX(o),h.setY(a)}}$o(){let e=this.getTiles(),t=[];for(let i of e)i.isCapturing()&&t.push(i);return t}tilesCapturing(e,t){if(!this.hi())return;let{animationManager:i,modeManager:s,itemManager:n}=this.scene;this.removeSuggestPairHint(),n.setIsUseableItem(!1);for(let o of e)this.mn(o);this.ri+=e.length/2;let r=this.capturePathGroup.requestPath();t?(r.setScore(5*e.length),r.drawNewPath(t)):this.scene.eatScore(5*e.length),this.th(e),this.scene.events.emit(tt.EVENTS.CAPTURING),i.capturing(e),this.eh(e),this.scene.time.addEvent({delay:400,callback:()=>{this.capturePathGroup.killPath(r)}}),this.$o().length<1&&s.processGravityMode(),this.scene.events.emit(mr.COMBO),this.scene.events.emit(zd.ADD,rk),kt.addMatchPairsMissionProgress(Math.floor(e.length/2))}Wo=e=>{this.tilesCapturing(e)};th(e){if(!this.hi())return;let t=e.filter(r=>r instanceof Ao).length;if(!(t>0))return;let{effectManager:i}=this.scene,s=this.getPairsOfTilesCanCapture(t/2),n=e.filter(r=>r instanceof Ao);for(let r of s)r.setState(tt.STATUS.CAPTURING);n.forEach((r,o)=>{if(o>=s.length||!(r instanceof Ao))return;let a=s[o],{x:h,y:l}=r.getWorldPosition(),u=new Phaser.Math.Vector2(h,l);i.requestTileRocketEffect(u,a)}),i.playTileRocketEffects()}eh(e){if(this.currentDeckPrefix!=="butterfly"||!this.hi())return;let t=new Map;for(let s of e){let n=s.getIcon().frame.name;if(n.includes("tile-")){t.has(n)||t.set(n,[]);let r=t.get(n);r&&r.push(s)}}if(t.size<1)return;let{effectManager:i}=this.scene;for(let s of t.values()){if(s.length<2)continue;let n=Math.floor(s.length/2);for(let r=0;r<n;r++){let o=s[r*2],a=s[r*2+1];i.playButterflyCaptureEffect(o,a)}}}handleExtraSpawn(){if(this.oi===0)return!1;let{tileManager:e}=this.scene;return this.ts?this.ri<5?!1:(this.ts=!1,e.En(),!0):(this.ri-5)%2===0?this.ai?!1:(e.En(),!0):(this.ai=!1,!1)}En(){this.oi-=1;let{boardManager:e,levelHandler:t}=this.scene,{boardMap:i,boardContainer:s}=e,{colors:n}=t.getConfigs(),r=this.ih();if(r.length<2){this.oi++;return}nt.playSound(ut.EXTRA_TILE_SPAWN),r.sort(()=>Math.random()-.5);let o=Phaser.Math.RND.between(1,n),{row:a,column:h}=r[0],{row:l,column:u}=r[1],d=this.createTileByType(o.toString(),a,h),p=this.createTileByType(o.toString(),l,u);this.addTile(d),this.addTile(p),i[a][h]=d,i[l][u]=p;let{x:g,y:c}=this.firstTilePosition;d.setVisible(!1),p.setVisible(!1),s.add(d),s.add(p);let f=this.scene.boardManager.getTileSizeWithSpacing();d.setPosition(g+(h-1)*f,c+(a-1)*f),p.setPosition(g+(u-1)*f,c+(l-1)*f),d.runExtraSpawnEffect(),p.runExtraSpawnEffect(),d.setVisible(!0),p.setVisible(!0),this.ai=!0}ih(){let{boardMap:e}=this.scene.boardManager,t=[],i=Object.keys(e).length,s=Object.keys(e[1]).length;for(let n=1;n<=i;n++)for(let r=1;r<=s;r++)e[n][r].isCaptured()&&t.push({row:n,column:r});return t}Qo(e){try{if(!ak||e<=4||!tk.getPlayerSetting("vibrate"))return;if(e<=6){vr.vibrate(340);return}if(e<=8){vr.vibrate(410);return}if(e<=9){vr.vibrate(480);return}if(e>9){vr.vibrate(600);return}}catch{}}hi(){return this.isRunning()&&(!this.ce||!this.ce.isPlaying())}handleBombTimerRescue=()=>{this.scene.events.emit(tt.EVENTS.BOMB_TIMER_RESCUE);let e=this.getAliveTiles();for(let t of e)t instanceof je&&t.handleInteractionEventAfterRescue()}},hk=ok;U(),U();var{KEY:_C,FRAME:OC}=G.TUTORIAL,lk=class extends Phaser.GameObjects.Container{hand;circleHighlight;circleHighlightOriginScale;toGlobalX=0;toGlobalY=0;constructor(e){super(e),this.name="DoubleTapTutorialHand",this.addHand(),this.addCircleHighlight(),this.bringToTop(this.hand),this.scene.add.existing(this)}addHand(){this.hand=this.scene.make.image({key:_C,frame:OC.HAND,origin:{x:0,y:0}}),this.add(this.hand)}addCircleHighlight(){this.circleHighlight=this.scene.make.image({key:_C,frame:OC.CIRCLE_HIGHLIGHT,origin:{x:.5,y:.5}}),this.circleHighlightOriginScale=this.circleHighlight.scale,this.add(this.circleHighlight),this.circleHighlight.setAlpha(0)}setTarget(e,t){this.toGlobalX=e,this.toGlobalY=t}playAnimation(e,t,i){this.circleHighlight.setWorldSize(i,i),this.circleHighlightOriginScale=this.circleHighlight.scale,this.scene.tweens.killTweensOf(this.hand),this.hand.x=0,this.hand.y=0,this.hand.angle=0,this.hand.setPosition(0,0),this.hand.setAlpha(1),this.runTapTween(!0,e,t)}runTapTween(e,t=0,i=800){this.scene?.tweens.add({delay:t,targets:[this.hand],onStart:()=>{this.scene?.tweens.killTweensOf(this.circleHighlight),this.circleHighlight.setScale(this.circleHighlightOriginScale/4),this.circleHighlight.setAlpha(1),this.circleHighlight.setPosition(this.hand.x+5,this.hand.y),this.scene?.tweens.add({targets:[this.circleHighlight],duration:500,props:{scale:{start:this.circleHighlightOriginScale/6,value:this.circleHighlightOriginScale},alpha:{start:1,value:0}},ease:Phaser.Math.Easing.Cubic.Out})},ease:Phaser.Math.Easing.Cubic.Out,props:{scale:{duration:200,start:1,to:.8}},hold:84,yoyo:!0,onComplete:()=>{let s=this.toGlobalX-this.x,n=this.toGlobalY-this.y;e?this.runMoveTween(0,0,s,n,300,i):this.runMoveTween(s,n,0,0,300,i)}})}runMoveTween(e,t,i,s,n=0,r=800){this.scene?.tweens.add({delay:n,targets:[this.hand],ease:Phaser.Math.Easing.Cubic.Out,props:{x:{from:e,to:i,duration:284},y:{from:t,to:s,duration:284}},onComplete:()=>{this.runTapTween(i===0&&s===0,50,r)}})}stopAnimation(){this.scene.tweens.killTweensOf(this.hand)}kill(){super.kill()}revive(){super.revive()}destroy(e){super.destroy(e)}preDestroy(){this.scene.tweens.killTweensOf(this.hand)}},uk=lk;U();var{KEY:Vd,FRAME:Xd}=G.TUTORIAL,ck=class extends Phaser.GameObjects.Container{text;constructor(e){super(e),this.createBox(),this.createText(),this.scene.add.existing(this)}createBox(){let e=this.scene.make.image({key:Vd,frame:Xd.MIDDLE_PANEL,origin:{x:.5,y:.5}});e.setWorldSize(276,21.5),this.add(e);let t=this.scene.make.image({key:Vd,frame:Xd.TOP_PANEL,origin:{x:.5,y:1}});t.setWorldSize(276,21.5),t.setY(-e.displayHeight/2),this.add(t);let i=this.scene.make.image({key:Vd,frame:Xd.BOTTOM_PANEL,origin:{x:.5,y:0}});i.setWorldSize(276,21.5),i.setY(e.displayHeight/2),this.add(i),this.setSize(e.displayWidth,e.displayHeight+t.displayHeight+i.displayHeight)}createText(){let e=X.createText(this.scene,"",17).setFontStyle("700").setAlign("center");X.applyWoodStyle(e),e.setY(-2),this.add(e),this.text=e}setText(e,t){if(this.text.setText(e),this.text.charColors=[],t)for(let i of t);}playFadeInAnimation(){this.scene.tweens.killTweensOf(this),this.setAlpha(0),this.scene.tweens.add({targets:this,alpha:1,duration:316,ease:"Linear"})}playFadeOutAnimation(){this.scene.tweens.killTweensOf(this),this.scene.tweens.add({targets:this,alpha:0,duration:316,ease:"Linear"})}},dk=ck;U();var{event:Kd,analytics:jd}=codex,{Plugins:{Analytics:{Events:Zd}}}=Ludex,pk=class{scene;manager;isStep1Analyzed;isStep2Analyzed;hintOrder=[[1,2,4,2],[4,1,5,2],[1,5,3,1],[2,4,3,5],[3,2,3,4]];isRunning=!1;constructor(e){this.manager=e,this.scene=e.scene}setup(){this.isStep1Analyzed=!1,this.isStep2Analyzed=!1,Kd.once(j.TILE_SHOWED_UP,this.startGuide),Kd.once(j.FINISH,this.closeTutorial),this.manager.background.setDepth($.EFFECT)}startGuide=()=>{let{tileManager:e,uiManager:t,boardManager:i}=this.scene,{boardContainer:s}=i;this.isRunning=!0,s.add(this.manager.background),t.disableUILogicForGuide1(),e.removeEventsAllTiles(),this.manager.runShowMaskAnimation(.4),this.createHint()};createHint=()=>{if(!this.isRunning)return;let e=this.hintOrder.pop();if(!e){this.manager.runHideMaskAnimation(),this.scene.tileManager.addEventsAllAliveTiles(),this.setBoxText(`Clear all tiles
to win`),this.scene.events.once(tt.EVENTS.INTERACTION,this.handleCloseTextBox),this.scene.events.on(tt.EVENTS.CAPTURING,this.handlePlaySound),this.scene.events.on(tt.EVENTS.NO_PATH_FOUND,this.handleNoPathFoundShowInfo);return}this.showBoxText();let t=e[0],i=e[1],s=e[2],n=e[3],{tileManager:r}=this.scene,{boardMap:o,boardContainer:a}=this.scene.boardManager;a.bringToTop(this.manager.background);let h=o[t][i],{x:l,y:u}=h.getWorldPosition();r.addEventsTile(h),a.bringToTop(h);let d=o[s][n],{x:p,y:g}=d.getWorldPosition();r.addEventsTile(d),a.bringToTop(d),this.createHandAt(l,u,p,g),this.scene.events.once(tt.EVENTS.INTERACTION,this.handleInteract)};showBoxText(){this.hintOrder.length===4?this.setBoxText("Tap to connect"):this.hintOrder.length===3?this.setBoxText(`Connect similar tiles with
less than 2 turns`,["2"]):this.hintOrder.length===0&&this.manager.textBox.playFadeOutAnimation()}setBoxText(e,t){let i=this.manager.textBox;i.revive(),i.setText(e,t),i.setDepth($.EFFECT);let{height:s}=this.scene.boardManager.boardSizeHandler.getBoardSize();lt.isLandscape()?Phaser.Display.Align.In.TopCenter(i,this.scene.gameZone,0,-25):Phaser.Display.Align.In.Center(i,this.scene.gameZone,0,s/2+i.displayHeight/2+50),i.playFadeInAnimation()}handleCloseTextBox=()=>{this.manager.textBox.playFadeOutAnimation()};timer;handleNoPathFoundShowInfo=e=>{let{tileManager:t}=this.scene;e==="more_than_turns"?this.setBoxText(`More than 2 turns
are NOT allowed`,["2","NOT allowed"]):e==="obstacle"&&this.setBoxText(`There's obstacle between
the tiles`,["obstacle"]),this.timer?.remove(),this.timer=this.scene.time.delayedCall(1966,()=>{t.clearWrongPath(),this.manager.textBox.playFadeOutAnimation()})};handlePlaySound=()=>{nt.playSound(ut.COMBO_1)};handleNoPathFound=e=>{this.scene.events.off(tt.EVENTS.CAPTURING,this.handleCapturing);let{tileManager:t}=this.scene;t.removeEventsAllTiles(),this.isStep2Analyzed||(jd.event(Zd.TUTORIAL_STEP,{step:2}),this.isStep2Analyzed=!0),e==="more_than_turns"?this.setBoxText(`More than 2 turns
are NOT allowed`,["2","NOT allowed"]):e==="obstacle"&&this.setBoxText(`There's obstacle between
the tiles`,["obstacle"]),this.scene.time.delayedCall(800,()=>{t.clearWrongPath();let i=100;(this.hintOrder.length===1||this.hintOrder.length===0)&&(i=600),this.scene.time.delayedCall(i,()=>{this.createHint()})})};handleCapturing=()=>{this.scene.events.off(tt.EVENTS.NO_PATH_FOUND,this.handleNoPathFound),nt.playSound(ut.COMBO_1),this.isStep1Analyzed||(jd.event(Zd.TUTORIAL_STEP,{step:1}),this.isStep1Analyzed=!0),this.scene.time.delayedCall(300,()=>{this.createHint()})};handleInteract=()=>{this.hintOrder.length!==3&&this.manager.textBox.playFadeOutAnimation(),this.manager.hand.stopAnimation(),this.manager.hand.kill(),this.scene.events.once(tt.EVENTS.CAPTURING,this.handleCapturing),this.scene.events.once(tt.EVENTS.NO_PATH_FOUND,this.handleNoPathFound)};createHandAt(e,t,i,s){if(!this.isRunning)return;this.manager.hand.setDepth($.ON_TOP),this.manager.hand.setPosition(e-5,t),this.manager.hand.revive(),this.manager.hand.setTarget(i-5,s),this.manager.hand.stopAnimation();let n=this.scene.boardManager.boardSizeHandler.getTileSize();this.manager.hand.playAnimation(300,0,n*1.2)}closeTutorial=()=>{Kd.off(j.TILE_SHOWED_UP,this.startGuide),this.scene.events.off(tt.EVENTS.INTERACTION,this.handleInteract),this.scene.events.off(tt.EVENTS.CAPTURING,this.handleCapturing),this.scene.events.off(tt.EVENTS.NO_PATH_FOUND,this.handleNoPathFound),this.scene.events.off(tt.EVENTS.NO_PATH_FOUND,this.handleNoPathFoundShowInfo),this.scene.events.off(tt.EVENTS.CAPTURING,this.handlePlaySound),this.scene.events.off(tt.EVENTS.INTERACTION,this.handleCloseTextBox);let{boardContainer:e}=this.scene.boardManager;e.remove(this.manager.background,!1),Phaser.Display.Align.In.Center(this.manager.background,this.scene.gameZone),jd.event(Zd.TUTORIAL_STEP,{step:3});let{objects:t}=this.scene.layoutManager;t.skipContainer.kill(),this.manager.textBox.kill(),this.manager.hand.kill(),this.isRunning=!1,this.manager.stopTutorial()}},gk=pk;U();var{event:qe}=codex,fk=class{scene;manager;constructor(e){this.manager=e,this.scene=e.scene}setup(){qe.once(j.TILE_SHOWED_UP,this.startGuide),qe.once(j.FINISH,this.closeTutorial),qe.once(j.DIE,this.closeTutorial),qe.on(j.PAUSE,this.handlePause),qe.on(j.RESUME,this.handleResume)}startGuide=()=>{let{uiManager:e}=this.scene;e.disableUILogicForGuide2(),this.manager.listenAutoHintEvent(),this.manager.startAutoHint()};closeTutorial=()=>{qe.off(j.TILE_SHOWED_UP,this.startGuide),qe.off(j.FINISH,this.closeTutorial),qe.off(j.DIE,this.closeTutorial),qe.off(j.PAUSE,this.handlePause),qe.off(j.RESUME,this.handleResume),this.manager.stopListenAutoHintEvent(),this.manager.stopAutoHint(),this.manager.stopTutorial()};handlePause=()=>{this.manager.stopAutoHint()};handleResume=()=>{this.manager.startAutoHint()}},mk=fk;U();var{event:Je,analytics:MC}=codex,{Plugins:{Analytics:{Events:LC}}}=Ludex,vk=class{scene;manager;constructor(e){this.manager=e,this.scene=e.scene}setup(){Je.once(j.TILE_SHOWED_UP,this.startGuide),Je.once(j.FINISH,this.closeTutorial),Je.once(j.DIE,this.closeTutorial),Je.on(j.PAUSE,this.handlePause),Je.on(j.RESUME,this.handleResume)}startGuide=()=>{this.createInfo(),this.manager.listenAutoHintEvent(),this.manager.startAutoHint()};createInfo(){let{staticHand:e,infoText:t}=this.manager,{layoutManager:i}=this.scene,{objects:s}=i,{width:n,height:r,x:o,y:a}=s.playtimeClock,h=10;this.manager.createMask(o-n*.6-h/2,a-r*.45-h/2,n*1.05+h/2,r+h/2),this.manager.runShowMaskAnimation(),e.revive(),e.angle=30,e.setPosition(o,a+40),t.revive(),t.setPosition(o+130,a+40),t.setText(`Remove all icon tiles before
the end of time`),t.setAlign("left"),this.scene.input.once(Phaser.Input.Events.POINTER_DOWN,this.handlePointerDown)}handlePointerDown=()=>{let{infoText:e,staticHand:t}=this.manager;this.manager.runHideMaskAnimation(),e.kill(),t.kill(),MC.event(LC.TUTORIAL_STEP,{step:4})};closeTutorial=()=>{Je.off(j.TILE_SHOWED_UP,this.startGuide),Je.off(j.FINISH,this.closeTutorial),Je.off(j.DIE,this.closeTutorial),Je.off(j.PAUSE,this.handlePause),Je.off(j.RESUME,this.handleResume),this.manager.stopListenAutoHintEvent(),this.manager.stopAutoHint(),this.manager.stopTutorial(),MC.event(LC.TUTORIAL_STEP,{step:5})};handlePause=()=>{this.manager.stopAutoHint()};handleResume=()=>{this.manager.startAutoHint()}},Ek=vk;U();var{event:Qe,analytics:DC}=codex,{Plugins:{Analytics:{Events:kC}}}=Ludex,yk=class{scene;manager;constructor(e){this.manager=e,this.scene=e.scene}setup(){Qe.once(j.TILE_SHOWED_UP,this.startGuide),Qe.once(j.FINISH,this.closeTutorial),Qe.once(j.DIE,this.closeTutorial),Qe.on(j.PAUSE,this.handlePause),Qe.on(j.RESUME,this.handleResume)}startGuide=()=>{this.createInfo(),this.manager.listenAutoHintEvent()};createInfo(){let{itemManager:e,layoutManager:t}=this.scene,{staticHand:i,infoText:s}=this.manager,{objects:n}=t;e.setDepthItemOnTop(K.HINT.ID);let{x:r,y:o,scale:a,width:h,displayWidth:l,displayHeight:u}=n.hintItem;this.manager.createMask(r-(l-2*a)/2,o-u/2+6*a,(h-2)*a,(h-2)*a,(h-2)*a/2),this.manager.runShowMaskAnimation();let d=lt.isLandscape(),p=d?30:-50,g=d?-90:0,c=d?50:-90,f=d?30:210;i.revive(),i.angle=f,i.setPosition(r,o+p),s.revive(),s.setPosition(r+g,o+c),s.setText(`Tap to reveal a
connectable pair`),s.setAlign("center"),this.manager.alignInfoTextWithinScreen(d),this.scene.input.once(Phaser.Input.Events.POINTER_UP,this.handlePointerDown)}handlePointerDown=()=>{let{itemManager:e}=this.scene,{infoText:t,staticHand:i}=this.manager;this.manager.runHideMaskAnimation(),t.kill(),i.kill(),e.setPaidItem(K.HINT.ID),e.setDepthItemNormal(K.HINT.ID),DC.event(kC.TUTORIAL_STEP,{step:6})};closeTutorial=()=>{Qe.off(j.TILE_SHOWED_UP,this.startGuide),Qe.off(j.FINISH,this.closeTutorial),Qe.off(j.DIE,this.closeTutorial),Qe.off(j.PAUSE,this.handlePause),Qe.off(j.RESUME,this.handleResume),this.manager.stopListenAutoHintEvent(),this.manager.stopAutoHint(),this.manager.stopTutorial(),DC.event(kC.TUTORIAL_STEP,{step:7})};handlePause=()=>{this.manager.stopAutoHint()};handleResume=()=>{this.manager.startAutoHint()}},Tk=yk;U(),U();var{KEY:sn,FRAME:Ce}=G.TUTORIAL,{KEY:wo,FRAME:Co}=G.DEFAULT,xk=class extends Phaser.GameObjects.Container{popup;content;failContent;onClick;goodText;tile1;rocket1;curve1;tile5;tile4;tile7;rocket2;curve2;constructor(e){super(e),this.scene=e,this.setDepth($.POPUP),this.createPopup(),this.updateSize(),this.createTitle(),this.createContent(),this.createText(),this.createButton(),this.createFail(),this.scene.add.existing(this)}createPopup(){let e=this.scene.make.image({key:wo,frame:Co.POPUP});e.setWorldSize(291.5,374),this.add(e),this.popup=e}updateSize(){let{displayWidth:e,displayHeight:t}=this.popup;this.setSize(e/2,t/2)}createTitle(){let e=this.scene.make.image({key:wo,frame:Co.ROCKET});e.setTint(15584418),Phaser.Display.Align.In.TopCenter(e,this.popup,0,-22),this.add(e)}createContent(){this.content=this.scene.make.container({}),this.content.setWorldSize(208,104),this.add(this.content),this.content.setPosition(0,-50),this.createTiles()}createTiles(){let e=[],t=this.createTile(Ce.GUIDE_TILE5);this.content.add(t),e.push(t),this.tile1=t;let i=this.createTile(Ce.GUIDE_TILE4);this.content.add(i),e.push(i);let s=this.createTile(Ce.GUIDE_TILE3);this.content.add(s),e.push(s);let n=this.createTile(Ce.GUIDE_TILE2);this.content.add(n),e.push(n),this.tile4=n;let r=this.createTile(Ce.GUIDE_TILE5);this.content.add(r),e.push(r),this.tile5=r;let o=this.createTile(Ce.GUIDE_TILE1);this.content.add(o),e.push(o);let a=this.createTile(Ce.GUIDE_TILE2);this.content.add(a),e.push(a),this.tile7=a;let h=this.createTile(Ce.GUIDE_TILE1);this.content.add(h),e.push(h),Phaser.Actions.GridAlign(e,{width:4,height:2,cellWidth:58,cellHeight:58,x:-2*58+5,y:-1*58+5});let l=this.scene.make.image({key:sn,frame:Ce.ROCKET});this.content.add(l),this.rocket1=l,this.rocket1.setPosition(t.x,t.y),this.rocket1.kill();let u=this.scene.make.image({key:sn,frame:Ce.ROCKET});this.content.add(u),this.rocket2=u,this.rocket2.setPosition(r.x,r.y),this.rocket2.kill();let d=(n.x-t.x)/2,p=t.x+d,g=t.y;this.curve1=new Phaser.Curves.Ellipse(p,g,d,50,180,360);let c=(a.x-r.x)/2,f=r.x+c,m=r.y;this.curve2=new Phaser.Curves.Ellipse(f,m,c,30,180,360,!0)}createTile(e,t=!1){let i=this.scene.make.container({});i.setWorldSize(50,50);let s=this.scene.make.image({key:sn,frame:Ce.TILE_BG});if(i.add(s),e){let n=this.scene.make.image({key:sn,frame:e});n.setWorldSize(41,43),i.add(n)}if(t){let n=this.scene.add.graphics();n.fillStyle(0,.3),n.fillPoints([{x:0,y:0},{x:0,y:-25},{x:25,y:-25}],!0),i.add(n);let r=this.scene.make.image({key:sn,frame:Ce.BOMB});Phaser.Display.Align.In.BottomRight(r,i,0,-3),i.add(r)}return i}createText(){let e=X.createText(this.scene,"",16).setAlign("center");X.applyWarningStyle(e),e.setText(`After the rocket is eliminated,
two more will be eliminated`),Phaser.Display.Align.In.Center(e,this.popup,0,50),this.add(e)}createButton(){let e=new At(this.scene,wo,Co.BUTTON_GREEN);e.setName("Guide5Btn");let t=X.createText(this.scene,"OK",24);X.applyGreenStyle(t),e.add(t),Phaser.Display.Align.In.Center(t,e),Phaser.Display.Align.In.BottomCenter(e,this.popup,0,-40),e.onClick=this.handleButtonClick;let i=this.scene.make.image({key:wo,frame:Co.BUTTON_FRAME});i.setPosition(e.x,e.y),this.add([i,e])}handleButtonClick=()=>{this.kill(),this.onClick&&this.onClick()};createFail(){this.failContent=this.scene.make.container({}),Phaser.Display.Align.In.Center(this.failContent,this.content),this.add(this.failContent);let e=this.scene.make.image({key:sn,frame:Ce.TEXT_GOOD});this.failContent.add(e),e.kill(),this.goodText=e}stopAnimation(){this.goodText.kill(),this.scene.tweens.killTweensOf([this.tile1,this.tile4,this.tile5,this.tile7,this.rocket1,this.rocket2]),this.scene.tweens.killTweensOf(this.goodText)}playAnimation(){this.scene.tweens.killTweensOf(this.goodText),this.scene.tweens.killTweensOf([this.tile1,this.tile4,this.tile5,this.tile7,this.rocket1,this.rocket2]),this.goodText.kill(),this.goodText.setPosition(0,0),this.rocket1.setPosition(this.tile1.x,this.tile1.y),this.rocket1.setAngle(0),this.rocket1.setAlpha(1),this.rocket1.kill(),this.rocket2.setPosition(this.tile5.x,this.tile5.y),this.rocket2.setAngle(0),this.rocket2.setAlpha(1),this.rocket2.kill(),this.tile1.setAlpha(1),this.tile4.setAlpha(1),this.tile5.setAlpha(1),this.tile7.setAlpha(1),this.scene.time.delayedCall(600,()=>{this.rocket1.revive(),this.rocket2.revive()}),this.scene.tweens.add({targets:[this.tile1,this.tile5],duration:500,delay:300,props:{alpha:{from:1,to:0}},onComplete:()=>{this.scene.tweens.addCounter({from:0,to:1,duration:500,onUpdate:e=>{let t=e.getValue(),i=this.curve1.getPoint(t);this.rocket1.setRotation(Phaser.Math.Angle.Between(this.rocket1.x,this.rocket1.y,i.x,i.y)+Phaser.Math.DegToRad(66)),this.rocket1.setPosition(i.x,i.y);let s=this.curve2.getPoint(t);this.rocket2.setRotation(Phaser.Math.Angle.Between(this.rocket2.x,this.rocket2.y,s.x,s.y)+Phaser.Math.DegToRad(66)),this.rocket2.setPosition(s.x,s.y)},onComplete:()=>{this.scene.tweens.add({targets:[this.tile4,this.tile7,this.rocket1,this.rocket2],duration:300,props:{alpha:{from:1,to:0}}}),this.scene.time.delayedCall(200,()=>{this.playGoodAnimation()})}})}})}playGoodAnimation(){this.goodText.revive(),this.scene.tweens.add({targets:this.goodText,duration:500,ease:Phaser.Math.Easing.Linear,props:{y:{from:0,to:-50}},onComplete:()=>{this.playAnimation()}})}},Sk=xk,{event:$e,analytics:qd}=codex,{Plugins:{Analytics:{Events:Jd}}}=Ludex,Ak=class{scene;manager;popup;constructor(e){this.manager=e,this.scene=e.scene,this.popup=new Sk(this.scene),this.popup.setDepth($.ON_TOP);let t=pt.getBannerHeight()/2;lt.isLandscape()&&this.popup.setScale(.7),Phaser.Display.Align.In.Center(this.popup,this.scene.gameZone,0,-t),this.popup.kill()}setup(){$e.once(j.TILE_SHOWED_UP,this.startGuide),$e.once(j.FINISH,this.closeTutorial),$e.once(j.DIE,this.closeTutorial),$e.on(j.PAUSE,this.handlePause),$e.on(j.RESUME,this.handleResume)}startGuide=()=>{this.createInfo()};createInfo(){this.manager.runShowMaskAnimation(),this.popup.revive(),this.scene.time.delayedCall(500,()=>{this.popup.playAnimation(),qd.event(Jd.TUTORIAL_STEP,{step:8})}),this.popup.onClick=()=>{this.manager.runHideMaskAnimation(),this.popup.stopAnimation(),this.manager.listenAutoHintEvent(),this.manager.startAutoHint(),qd.event(Jd.TUTORIAL_STEP,{step:9})}}closeTutorial=()=>{$e.off(j.TILE_SHOWED_UP,this.startGuide),$e.off(j.FINISH,this.closeTutorial),$e.off(j.DIE,this.closeTutorial),$e.off(j.PAUSE,this.handlePause),$e.off(j.RESUME,this.handleResume),this.manager.stopListenAutoHintEvent(),this.manager.stopAutoHint(),this.manager.stopTutorial(),qd.event(Jd.TUTORIAL_STEP,{step:10})};handlePause=()=>{this.manager.stopAutoHint()};handleResume=()=>{this.manager.startAutoHint()}},wk=Ak;U(),U();var{KEY:os,FRAME:ti}=G.TUTORIAL,{KEY:Po,FRAME:Ro}=G.DEFAULT,Ck=class extends Phaser.GameObjects.Container{popup;content;contentBg;failContent;onClick;failedText;originFailScale;leftLeaf;originLLeafScale;rightLeaf;originRLeafScale;bombCountDownMask;bomb;tileBomb;bombTween;constructor(e){super(e),this.scene=e,this.setDepth($.POPUP),this.createPopup(),this.updateSize(),this.createTitle(),this.createContent(),this.createText(),this.createButton(),this.createFail(),this.scene.add.existing(this)}createPopup(){let e=this.scene.make.image({key:Po,frame:Ro.POPUP});this.add(e),this.popup=e}updateSize(){let{displayWidth:e,displayHeight:t}=this.popup;this.setSize(e/2,t/2)}createTitle(){let e=this.scene.make.image({key:Po,frame:Ro.BOOM});e.setTint(15584418),Phaser.Display.Align.In.TopCenter(e,this.popup,0,-22),this.add(e)}createContent(){this.content=this.scene.make.container({}),this.content.setSize(102,102),this.add(this.content),this.content.setPosition(0,-20),this.createTiles();let e=this.scene.make.image({key:os,frame:ti.BLANK});e.setTint(0),e.setWorldSize(102,102),e.setY(-20),this.content.add(e),e.kill(),this.contentBg=e}createTiles(){let e=this.createTile(ti.GUIDE_TILE1);this.content.add(e),Phaser.Display.Align.In.TopLeft(e,this.content);let t=this.createTile(ti.GUIDE_TILE2);this.content.add(t),Phaser.Display.Align.In.TopRight(t,this.content);let i=this.createTile(ti.GUIDE_TILE1);this.content.add(i),Phaser.Display.Align.In.BottomLeft(i,this.content);let s=this.createTile(ti.GUIDE_TILE2,!0);this.content.add(s),Phaser.Display.Align.In.BottomRight(s,this.content),this.tileBomb=s}createTile(e,t=!1){let i=this.scene.make.container({});i.setSize(50,50);let s=this.scene.make.image({key:os,frame:ti.TILE_BG});s.setWorldSize(50,50),i.add(s);let n=this.scene.make.image({key:os,frame:e});if(n.setWorldSize(41,43.5),i.add(n),t){let r=this.scene.make.image({key:os,frame:ti.BOMB});r.setWorldSize(20,21),Phaser.Display.Align.In.BottomRight(r,i,0,-3),i.add(r),this.bomb=r}return i}createText(){let e=X.createText(this.scene,"",16).setAlign("center");X.applyWarningStyle(e),e.setText(`Remove this icon tile before
the bomb explodes.`),Phaser.Display.Align.In.Center(e,this.popup,0,50),this.add(e)}createButton(){let e=new At(this.scene,Po,Ro.BUTTON_GREEN,180,46.5);e.setName("Guide6Btn");let t=X.createText(this.scene,"OK",24);X.applyGreenStyle(t),e.add(t),Phaser.Display.Align.In.Center(t,e),Phaser.Display.Align.In.BottomCenter(e,this.popup,0,-30),e.onClick=this.handleButtonClick;let i=this.scene.make.image({key:Po,frame:Ro.BUTTON_FRAME});i.setPosition(e.x,e.y),this.add([i,e])}handleButtonClick=()=>{this.kill(),this.onClick&&this.onClick()};createFail(){this.failContent=this.scene.make.container({}),Phaser.Display.Align.In.Center(this.failContent,this.content),this.add(this.failContent);let e=this.scene.make.image({key:os,frame:ti.LEAF_LEFT,origin:{x:1,y:.5}});e.setWorldSize(132.5,61),this.failContent.add(e),e.setY(-17),e.kill(),this.leftLeaf=e,this.originLLeafScale=e.scale;let t=this.scene.make.image({key:os,frame:ti.LEAF_RIGHT,origin:{x:0,y:.5}});t.setWorldSize(120,68),this.failContent.add(t),t.setY(-17),t.kill(),this.rightLeaf=t,this.originRLeafScale=t.scale;let i=this.scene.make.image({key:os,frame:ti.TEXT_FAILED});i.setWorldSize(167.5,61.5),this.failContent.add(i),i.setY(-20),i.kill(),this.failedText=i,this.originFailScale=i.scale}stopAnimation(){this.contentBg.kill(),this.leftLeaf.kill(),this.rightLeaf.kill(),this.failedText.kill(),this.scene.tweens.killTweensOf(this.content),this.scene.tweens.killTweensOf(this.leftLeaf),this.scene.tweens.killTweensOf(this.rightLeaf),this.scene.tweens.killTweensOf(this.failedText)}playAnimation(){this.scene.tweens.killTweensOf(this.content),this.scene.tweens.killTweensOf(this.leftLeaf),this.scene.tweens.killTweensOf(this.rightLeaf),this.scene.tweens.killTweensOf(this.failedText),this.contentBg.revive(),this.contentBg.setAlpha(0),this.bomb.revive(),this.failedText.revive(),this.failedText.setScale(0),this.leftLeaf.revive(),this.leftLeaf.setScale(0),this.leftLeaf.setAngle(-5),this.rightLeaf.revive(),this.rightLeaf.setScale(0),this.rightLeaf.setAngle(5),this.runBombIconTween(),this.scene.tweens.addCounter({from:1,to:0,duration:1e3,ease:"Linear",onUpdate:e=>{let t=e.getValue();this.bombCountDownMask.drawCountdown(t,1)},onComplete:()=>{this.bomb.kill(),this.scene.time.delayedCall(200,()=>{this.playFailAnimation()})}})}runBombIconTween(){this.bombTween?.stop(),this.bombTween?.stop();let{scaleX:e,scaleY:t}=this.bomb;this.bombTween=this.scene.tweens.add({targets:this.bomb,scaleX:e*1.2,scaleY:t*1.2,ease:"Sine.easeInOut",duration:500,yoyo:!0,repeat:-1,onStop:()=>{this.bomb.setScale(e,t)}})}createBombCountDown(){this.bombCountDownMask=new sC(this.scene,50,4),this.tileBomb.add(this.bombCountDownMask),this.bombCountDownMask.drawCountdown(0,1)}playFailAnimation(){this.scene.tweens.add({targets:this.contentBg,duration:1e3,ease:Phaser.Math.Easing.Linear,props:{alpha:{from:0,to:.5}}}),this.scene.tweens.add({targets:this.failedText,duration:1e3,ease:Phaser.Math.Easing.Expo.InOut,props:{scale:{from:0,to:this.originFailScale}},onComplete:()=>{let e=[this.originLLeafScale,this.originRLeafScale];this.scene.tweens.add({targets:[this.leftLeaf,this.rightLeaf],duration:500,ease:Phaser.Math.Easing.Expo.Out,props:{scale:{getStart:()=>0,getEnd:(i,s,n,r)=>e[r]}}});let t=[-5,5];this.scene.tweens.add({targets:[this.leftLeaf,this.rightLeaf],delay:300,duration:500,ease:Phaser.Math.Easing.Linear,props:{angle:{getStart:(i,s,n,r)=>t[r],getEnd:()=>0}},onComplete:()=>{this.playAnimation()}})}})}},Pk=Ck,{event:nn,analytics:Qd}=codex,{Plugins:{Analytics:{Events:$d}}}=Ludex,Rk=class{scene;manager;popup;constructor(e){this.manager=e,this.scene=e.scene,this.popup=new Pk(this.scene),this.popup.setDepth($.ON_TOP);let t=pt.getBannerHeight()/2;lt.isLandscape()&&this.popup.setScale(.7),Phaser.Display.Align.In.Center(this.popup,this.scene.gameZone,0,-t),this.popup.kill(),this.popup.createBombCountDown()}setup(){nn.once(j.TILE_SHOWED_UP,this.startGuide),nn.once(j.FINISH,this.closeTutorial),nn.once(j.DIE,this.closeTutorial)}startGuide=()=>{this.createInfo()};createInfo(){this.manager.runShowMaskAnimation(),this.popup.revive(),this.scene.time.delayedCall(500,()=>{this.popup.playAnimation(),Qd.event($d.TUTORIAL_STEP,{step:11})}),this.popup.onClick=()=>{this.manager.runHideMaskAnimation(),this.popup.stopAnimation(),this.manager.listenAutoHintEvent(),this.manager.startAutoHint(),Qd.event($d.TUTORIAL_STEP,{step:12})}}closeTutorial=()=>{nn.off(j.TILE_SHOWED_UP,this.startGuide),nn.off(j.FINISH,this.closeTutorial),nn.off(j.DIE,this.closeTutorial),this.manager.stopListenAutoHintEvent(),this.manager.stopAutoHint(),this.manager.stopTutorial(),Qd.event($d.TUTORIAL_STEP,{step:13})}},bk=Rk;U();var{event:rn,analytics:FC}=codex,{Plugins:{Analytics:{Events:NC}}}=Ludex,Ik=class{manager;constructor(e){this.manager=e}setup(){rn.once(j.TILE_SHOWED_UP,this.yn),rn.once(j.FINISH,this.closeTutorial),rn.once(j.DIE,this.closeTutorial)}yn=()=>{this.createInfo()};createInfo(){let{itemManager:e,layoutManager:t}=this.manager.scene,{staticHand:i,infoText:s}=this.manager,{objects:n}=t;e.setDepthItemOnTop(K.GUIDE_BOMB_DEFUSE.ID);let{x:r,y:o,scale:a,width:h,displayWidth:l,displayHeight:u}=n.defuseItem;this.manager.createMask(r-(l-2*a)/2,o-u/2+6*a,(h-2)*a,(h-2)*a,(h-2)*a/2),this.manager.runShowMaskAnimation();let d=lt.isLandscape(),p=d?30:-50,g=d?-90:Math.max(0,220-lt.getWorldSize().width/2),c=d?50:-90,f=d?30:210;i.revive(),i.angle=f,i.setPosition(r,o+p),s.revive(),s.setText(`Tap to clear a pair of
bomb tiles`),s.setAlign("center"),s.setPosition(r+g,o+c),this.manager.alignInfoTextWithinScreen(d),this.manager.scene.input.once(Phaser.Input.Events.POINTER_UP,this.handlePointerDown)}handlePointerDown=()=>{let{itemManager:e,uiManager:t}=this.manager.scene,{infoText:i,staticHand:s}=this.manager;this.manager.runHideMaskAnimation(),t.changeToDefuseItem(),i.kill(),s.kill(),e.setPaidItem(K.GUIDE_BOMB_DEFUSE.ID),e.setDepthItemNormal(K.GUIDE_BOMB_DEFUSE.ID),FC.event(NC.TUTORIAL_STEP,{step:14})};closeTutorial=()=>{rn.off(j.TILE_SHOWED_UP,this.yn),rn.off(j.FINISH,this.closeTutorial),rn.off(j.DIE,this.closeTutorial),this.manager.stopTutorial(),FC.event(NC.TUTORIAL_STEP,{step:15})}},_k=Ik;U();var{event:an,analytics:BC}=codex,{Plugins:{Analytics:{Events:UC}}}=Ludex,Ok=class{manager;constructor(e){this.manager=e}setup(){an.once(j.TILE_SHOWED_UP,this.startGuide),an.once(j.FINISH,this.closeTutorial),an.once(j.DIE,this.closeTutorial)}startGuide=()=>{this.createInfo()};createInfo(){let{itemManager:e,layoutManager:t}=this.manager.scene,{staticHand:i,infoText:s}=this.manager,{objects:n}=t;e.setDepthItemOnTop(K.SHUFFLE.ID);let{x:r,y:o,scale:a,width:h,displayWidth:l,displayHeight:u}=n.shuffleItem;this.manager.createMask(r-(l-2*a)/2,o-u/2+6*a,(h-2)*a,(h-2)*a,(h-2)*a/2);let d=lt.isLandscape(),p=d?30:-50,g=d?-70:0,c=d?50:-90,f=d?30:210;this.manager.runShowMaskAnimation(),i.revive(),i.angle=f,i.setPosition(r,o+p),s.revive(),s.setPosition(r+g,o+c),s.setText(`Tap to rearrange
the tiles`),s.setAlign("center"),this.manager.alignInfoTextWithinScreen(d),this.manager.scene.input.once(Phaser.Input.Events.POINTER_UP,this.handlePointerDown)}handlePointerDown=()=>{let{itemManager:e}=this.manager.scene,{infoText:t,staticHand:i}=this.manager;this.manager.runHideMaskAnimation(),t.kill(),i.kill(),e.setPaidItem(K.SHUFFLE.ID),e.setDepthItemNormal(K.SHUFFLE.ID),BC.event(UC.TUTORIAL_STEP,{step:16})};closeTutorial=()=>{an.off(j.TILE_SHOWED_UP,this.startGuide),an.off(j.FINISH,this.closeTutorial),an.off(j.DIE,this.closeTutorial),this.manager.stopTutorial(),BC.event(UC.TUTORIAL_STEP,{step:17})}},Mk=Ok;U();var{event:on,analytics:GC}=codex,{Plugins:{Analytics:{Events:YC}}}=Ludex,Lk=class{scene;manager;constructor(e){this.manager=e,this.scene=e.scene}setup(){on.once(j.TILE_SHOWED_UP,this.startGuide),on.once(j.FINISH,this.closeTutorial),on.once(j.DIE,this.closeTutorial)}startGuide=()=>{this.createInfo()};createInfo(){let{itemManager:e,layoutManager:t}=this.scene,{staticHand:i,infoText:s}=this.manager,{objects:n}=t;e.setDepthItemOnTop(K.ROCKET.ID);let{x:r,y:o,scale:a,width:h,displayWidth:l,displayHeight:u}=n.rocketItem;this.manager.createMask(r-(l-2*a)/2,o-u/2+6*a,(h-2)*a,(h-2)*a,(h-2)*a/2);let d=lt.isLandscape(),p=d?30:-50,g=d?-70:0,c=d?50:-90,f=d?30:210;this.manager.runShowMaskAnimation(),i.revive(),i.angle=f,i.setPosition(r,o+p),s.revive(),s.setPosition(r+g,o+c),s.setText(`Tap to eliminate
two pairs`),s.setAlign("center"),this.manager.alignInfoTextWithinScreen(d),this.scene.input.once(Phaser.Input.Events.POINTER_UP,this.handlePointerDown)}handlePointerDown=()=>{let{itemManager:e}=this.scene,{infoText:t,staticHand:i}=this.manager;this.manager.runHideMaskAnimation(),t.kill(),i.kill(),e.setPaidItem(K.ROCKET.ID,!0),e.setDepthItemNormal(K.ROCKET.ID),e.itemActive!==K.ROCKET.ID&&e.enableItem(K.ROCKET.ID),GC.event(YC.TUTORIAL_STEP,{step:18})};closeTutorial=()=>{on.off(j.TILE_SHOWED_UP,this.startGuide),on.off(j.FINISH,this.closeTutorial),on.off(j.DIE,this.closeTutorial),this.manager.stopTutorial(),this.manager.completeTutorial(),GC.event(YC.TUTORIAL_STEP,{step:19})}},Dk=Lk;U();var{event:hn,analytics:HC}=codex,{Plugins:{Analytics:{Events:zC}}}=Ludex,kk=class{scene;manager;constructor(e){this.manager=e,this.scene=e.scene}setup(){hn.once(j.TILE_SHOWED_UP,this.startGuide),hn.once(j.FINISH,this.closeTutorial),hn.once(j.DIE,this.closeTutorial)}startGuide=()=>{this.createInfo()};createInfo(){let{itemManager:e,layoutManager:t}=this.scene,{staticHand:i,infoText:s}=this.manager,{objects:n}=t;e.setDepthItemOnTop(K.SUPER_ROCKET.ID);let{x:r,y:o,scale:a,width:h,displayWidth:l,displayHeight:u}=n.superRocketItem;this.manager.createMask(r-(l-2*a)/2,o-u/2+6*a,(h-2)*a,(h-2)*a,(h-2)*a/2);let d=lt.isLandscape(),p=d?30:-50,g=d?-90:0,c=d?50:-90,f=d?30:210;this.manager.runShowMaskAnimation(),i.revive(),i.angle=f,i.setPosition(r,o+p),s.revive(),s.setPosition(r+g,o+c),s.setText(`Use the super rocket to
destroy a lot of tiles
on the board.`),s.setAlign("center"),this.manager.alignInfoTextWithinScreen(d),this.scene.input.once(Phaser.Input.Events.POINTER_UP,this.handlePointerDown)}handlePointerDown=()=>{let{itemManager:e}=this.scene,{infoText:t,staticHand:i}=this.manager;this.manager.runHideMaskAnimation(),t.kill(),i.kill(),e.setDepthItemNormal(K.SUPER_ROCKET.ID),HC.event(zC.TUTORIAL_STEP,{step:20})};closeTutorial=()=>{hn.off(j.TILE_SHOWED_UP,this.startGuide),hn.off(j.FINISH,this.closeTutorial),hn.off(j.DIE,this.closeTutorial),this.manager.stopTutorial(),this.manager.completeTutorial(),HC.event(zC.TUTORIAL_STEP,{step:21})}},Fk=kk,{analytics:WC,player:tp}=codex,{Plugins:{Analytics:{Events:VC}},Utils:{Valid:Nk,Object:Bk}}=Ludex,{STATUS:ep}=ns,{KEY:XC,FRAME:KC}=G.TUTORIAL,{FinalGuideLevel:jC,DefuseItemGuideLevel:ZC,RocketItemGuideLevel:qC,SuperRocketGuideLevel:JC}=Lt,Uk=class extends Ne{scene;tutorialId;Tn;xn=[];Sn=!0;hand;staticHand;infoText;textBox;background;rt;An;wn;Cn;Pn;Rn;bn;_n;On;Mn;Ln;Dn;Kt={};constructor(e){super(e),this.scene=e,this.ji(),this.De(),this.sh(),this.nh(),this.rh(),this.checkIsValidForTutorial(),this.ah()}init(){this.hand.kill(),this.infoText.kill(),this.background.kill(),this.staticHand.kill(),this.setState(ep.READY)}start(){this.isRunning()||this.Tn&&(this.setState(ep.RUNNING),this.oh())}stop(){this.isRunning()&&(this.checkIsValidForTutorial(),this.scene.tweens.killTweensOf([this.background,this.hand,this.staticHand,this.infoText]),this.setState(ep.STOPPED))}is(e){this.Tn=e}isLevelHaveTutorial(e){return!![1,2,3,5,7,9,13,JC,qC,ZC].includes(e)}isLevelShowWrongPath(e){return e<=6}displayCount(e){return this.xn.filter(t=>t===e).length}isNothingToDisplay(){return this.scene.levelHandler.level>jC}oh(){if(!this.isRunning())return;let{levelHandler:e}=this.scene;switch(this.Sn&&(WC.event(VC.TUTORIAL_BEGIN),this.Sn=!1),e.level){case 1:this.startTutorial(Tt.NEWBIE);break;case 2:this.startTutorial(Tt.NO_TIMER);break;case 3:this.startTutorial(Tt.TIMER);break;case 5:this.startTutorial(Tt.MAGNIFIER_ITEM);break;case 7:this.startTutorial(Tt.ROCKET_TILES);break;case 9:this.startTutorial(Tt.BOMB_ITEM);break;case ZC:this.startTutorial(Tt.DIFFUSE_ITEM);break;case 13:this.startTutorial(Tt.SHUFFLE_ITEM);break;case qC:this.startTutorial(Tt.ROCKET_ITEM);break;case JC:this.startTutorial(Tt.SUPER_ROCKET_ITEM);break}}startTutorial=e=>{if(!this.isRunning())return!1;if(this.isNothingToDisplay())return this.stop(),this.is(!1),!1;if(this.background.kill(),this.isGuideShown(e))return!1;switch(this.hh(e,!0),e){case Tt.NEWBIE:this.An=new gk(this),this.An.setup();break;case Tt.NO_TIMER:this.wn=new mk(this),this.wn.setup();break;case Tt.TIMER:this.Cn=new Ek(this),this.Cn.setup();break;case Tt.MAGNIFIER_ITEM:this.Pn=new Tk(this),this.Pn.setup();break;case Tt.ROCKET_TILES:this.Rn=new wk(this),this.Rn.setup();break;case Tt.BOMB_ITEM:this.bn=new bk(this),this.bn.setup();break;case Tt.DIFFUSE_ITEM:this._n=new _k(this),this._n.setup();break;case Tt.SHUFFLE_ITEM:this.On=new Mk(this),this.On.setup();break;case Tt.ROCKET_ITEM:this.Mn=new Dk(this),this.Mn.setup();break;case Tt.SUPER_ROCKET_ITEM:this.Ln=new Fk(this),this.Ln.setup();break;default:return!1}return this.isRunning()?(this.tutorialId=e,this.xn.push(this.tutorialId),!0):!1};stopTutorial(){this.tutorialId="",this.hand.kill(),this.infoText.kill(),this.staticHand.kill(),this.background.kill(),GameSDK.extra.checkAndCreateShortcutAsync().catch(()=>{})}completeTutorial(){this.scene.time.delayedCall(500,()=>{WC.event(VC.TUTORIAL_COMPLETE)}),this.is(!1)}checkIsValidForTutorial(){let{level:e}=tp.getGameData()??{},t=(Nk.isNumber(e)?e:0)<=jC;return this.is(t),t}De(){this.hand=new uk(this.scene),this.hand.kill(),this.hand.setDepth($.PRIORITY)}sh(){this.staticHand=this.scene.add.image(0,0,XC,KC.HAND),this.staticHand.setWorldSize(21,21),this.staticHand.kill(),this.staticHand.setDepth($.PRIORITY)}nh(){this.infoText=X.createShadowText(this.scene,"",16),this.infoText.setTint(16637882),this.infoText.kill(),this.infoText.setDepth($.PRIORITY)}rh(){this.textBox=new dk(this.scene),this.textBox.kill()}ji(){this.background=this.scene.make.image({key:XC,frame:KC.BLANK}),this.background.setInteractive(),this.background.setTint(0),this.background.setAlpha(.8),this.background.setDepth($.PRIORITY),this.setBackgroundToWorldSize(),Phaser.Display.Align.In.Center(this.background,this.scene.gameZone),this.background.kill()}setBackgroundToWorldSize(){let{width:e,height:t}=lt.getWorldSize(),i=100;this.background.setWorldSize(e+i,t+i)}createMask(e,t,i,s,n=10){this.rt?.destroy(),this.rt=this.scene.make.graphics({fillStyle:{color:16711680,alpha:1}}),this.rt.setName("MaskGraphics"),this.rt.fillRoundedRect(e,t,i,s,n),this.background.revive(),this.setBackgroundToWorldSize(),this.background.clearMask(!0),this.background.setMask(this.rt.createGeometryMask()),this.background.mask.invertAlpha=!0}createMultiMask(e){this.rt?.destroy(),this.rt=this.scene.make.graphics({fillStyle:{color:16711680,alpha:1}}),this.rt.setName("MaskGraphics");for(let t of e)this.rt.fillRoundedRect(t.x,t.y,t.width,t.height,t.radius);this.background.revive(),this.setBackgroundToWorldSize(),this.background.clearMask(!0),this.background.setMask(this.rt.createGeometryMask()),this.background.mask.invertAlpha=!0}runShowMaskAnimation(e=.8){let t=[this.background];this.background.revive(),this.scene.tweens.killTweensOf(t),this.scene.tweens.add({targets:t,duration:300,ease:Phaser.Math.Easing.Quadratic.Out,props:{alpha:{start:0,to:e}}})}runHideMaskAnimation=()=>{let e=[this.background];this.background.revive(),this.scene.tweens.killTweensOf(e),this.scene.tweens.add({targets:e,duration:400,ease:Phaser.Math.Easing.Quadratic.Out,props:{alpha:0},onComplete:()=>{this.background.kill(),this.background.clearMask(!0)}})};startAutoHint(){this.Dn=this.scene.time.delayedCall(5e3,this.lh)}lh=()=>{let{tileManager:e,itemManager:t}=this.scene;e.hintTiles.length>0||t.getIsUseableItem()===!1?(this.stopAutoHint(),this.startAutoHint()):e.suggestPairHint()};stopAutoHint(){this.Dn?.remove()}listenAutoHintEvent(){this.scene.events.on(tt.EVENTS.INTERACTION,this.kn),this.scene.events.on(tt.EVENTS.NO_PATH_FOUND,this.Fn)}stopListenAutoHintEvent(){this.scene.events.off(tt.EVENTS.INTERACTION,this.kn),this.scene.events.off(tt.EVENTS.NO_PATH_FOUND,this.Fn)}pe=null;Fn=()=>{let{tileManager:e}=this.scene;this.pe?.remove(),this.pe=this.scene.time.delayedCall(1e3,()=>{e.clearWrongPath()})};kn=()=>{this.stopAutoHint();let{tileManager:e}=this.scene;e.clearWrongPath(),this.startAutoHint()};ah(){this.Kt=mw;let{tutorialDisplayed:e}=tp.getGameData()??{};this.Kt=Bk.merge(this.Kt,e)}hh(e,t){this.Kt[e]!==void 0&&(this.Kt[e]=t,tp.setGameData({tutorialDisplayed:this.Kt}))}isGuideShown(e){return this.Kt[e]??!1}alignInfoTextWithinScreen(e){let{width:t}=lt.getWorldSize();if(e)return;let i=this.infoText.getBounds().width,s=this.infoText.x+i/2>t/2-5,n=this.infoText.x-i/2<-t/2+5;s&&(this.infoText.x=t/2-i/2-5),n&&(this.infoText.x=-t/2+i/2+5)}isBombDefuseTutorialShown(){return this.isGuideShown(Tt.DIFFUSE_ITEM)}},Gk=Uk;U();var{event:ip}=codex,{Utils:{Time:Yk}}=Ludex,{FRAME:Hk}=G.GAMEPLAY,{FinalGuideLevel:zk}=Lt,Wk=class extends Ne{scene;constructor(e){super(e),this.scene=e,this.uh()}start(){this.isRunning()||(super.start(),this.updateUIData(),this.enablePause(),this.ss(),this.dh())}stop(){this.disablePause(),this.Nn()}Nn(){ip.off(j.GAMEPLAY_PAUSE_NOTIFICATION,this.ss)}dh(){this.Nn(),ip.on(j.GAMEPLAY_PAUSE_NOTIFICATION,this.ss)}ss=()=>{let e=ge.isGameplayPauseNotificationAvailable,{objects:t}=this.scene.layoutManager,i=ge.isLevelReadyForNotification();e&&i?t.playPauseNotification():t.stopPauseNotification()};updateUIData=()=>{let{levelHandler:e,layoutManager:t}=this.scene,{objects:i}=t,{time:s}=e.getConfigs();if(i.playtimeClock.setDisable(!1),i.playtimeClock.setClockText(s),i.playtimeClock.pauseClock(),ht.isChallengeMode()){let n=ht.getMatchState(),{customData:r={},profiles:o={}}=n,a=r.playerId??"0",h=r.opponentId??"0",l=o[a],u=o[h];i.challengeInfo.setPlayerInfo({id:a,score:l?.score??0,photo:l?.photo??Xt.AVATAR_DEFAULT.FILE}),i.challengeInfo.setOpponentInfo({id:h,score:u?.score??0,photo:u?.photo??Xt.AVATAR_DEFAULT.FILE})}};uh(){let{layoutManager:e}=this.scene,{objects:t}=e;t.skipBtn.onClick=this.ph,t.pauseButton.onClick=this.gh,this.handleHeaderAndFooterResize()}handleHeaderAndFooterResize(){let{width:e}=lt.getWorldSize(),{objects:t}=this.scene.layoutManager;if(lt.isLandscape()){t.topFooterBG.kill(),t.bottomFooterBG.kill(),t.headerBG.setFrame(Hk.LAYOUT_HEADER_LANDSCAPE);let i=e>988?988:e;t.headerBG.setWorldSize(i,65)}else t.topFooterBG.revive(),t.bottomFooterBG.revive(),t.bottomFooterBG.setWorldSize(e),t.headerBG.setWorldSize(e)}ph=()=>{let{tutorialManager:e,layoutManager:t}=this.scene,{objects:i}=t;e.stop(),this.scene.finishLevel(),i.skipContainer.kill(),i.headerBG.revive(),lt.isLandscape()||(i.topFooterBG.revive(),i.bottomFooterBG.revive())};gh=()=>{ge.setGameplayPauseNotificationFlag(!1,1),ot.openScreen(mt.PAUSE_SCREEN)};updateLevel(e){let{objects:t}=this.scene.layoutManager,i=ht.isTournamentMode()?e-1:e;t.levelText.setText(`Lv ${i}`)}showUIForGuide(){let{levelHandler:e,layoutManager:t}=this.scene,{objects:i,groups:s}=t,{level:n}=e;if(!(n>zk)){if(n===1)s.gameUI.killGroup(),i.headerBG.kill(),lt.isLandscape()||(i.topFooterBG.kill(),i.bottomFooterBG.kill());else if(n===2){let{itemManager:r}=this.scene;i.headerBG.revive(),lt.isLandscape()||(i.topFooterBG.revive(),i.bottomFooterBG.revive()),r.invisibleItem(K.BOMB_DEFUSE.ID),r.invisibleItem(K.ROCKET.ID),r.invisibleItem(K.SUPER_ROCKET.ID),ht.isTournamentMode()||i.playtimeClock.kill()}else if([3,4,6,7,8,9,10].includes(n)){let{itemManager:r}=this.scene;r.invisibleItem(K.BOMB_DEFUSE.ID),r.invisibleItem(K.ROCKET.ID),r.invisibleItem(K.SUPER_ROCKET.ID)}else if(n===5){let{itemManager:r,tutorialManager:o}=this.scene;o.isGuideShown(Tt.MAGNIFIER_ITEM)||r.setFreeItem(K.HINT.ID),r.invisibleItem(K.BOMB_DEFUSE.ID),r.invisibleItem(K.ROCKET.ID),r.invisibleItem(K.SUPER_ROCKET.ID)}else if(n===11){let{itemManager:r,tutorialManager:o}=this.scene;o.isGuideShown(Tt.DIFFUSE_ITEM)||(this.changeToGuideDefuseItem(),r.setFreeItem(K.GUIDE_BOMB_DEFUSE.ID)),r.invisibleItem(K.ROCKET.ID),r.invisibleItem(K.SUPER_ROCKET.ID)}else if([12,14,15].includes(n)){let{itemManager:r}=this.scene;r.invisibleItem(K.ROCKET.ID),r.invisibleItem(K.SUPER_ROCKET.ID)}else if(n===13){let{itemManager:r,tutorialManager:o}=this.scene;o.isGuideShown(Tt.SHUFFLE_ITEM)||r.setFreeItem(K.SHUFFLE.ID),r.invisibleItem(K.ROCKET.ID),r.invisibleItem(K.SUPER_ROCKET.ID)}else if(n===16){let{itemManager:r,tutorialManager:o}=this.scene;o.isGuideShown(Tt.ROCKET_ITEM)||r.setFreeItem(K.ROCKET.ID),r.invisibleItem(K.SUPER_ROCKET.ID)}}}disableUILogicForGuide1(){let{objects:e}=this.scene.layoutManager;e.playtimeClock.setDisable(!0),e.skipContainer.revive(),e.skipBtn.setDisabled(!1),this.scene.comboManager.stop(),e.comboProgressBar.kill()}disableUILogicForGuide2(){let{objects:e}=this.scene.layoutManager;e.playtimeClock.setDisable(!0)}changeToGuideDefuseItem(){let{itemManager:e}=this.scene;e.getItem(K.BOMB_DEFUSE.ID)?.kill(),e.getItem(K.GUIDE_BOMB_DEFUSE.ID)?.revive()}changeToDefuseItem(){let{itemManager:e}=this.scene;e.getItem(K.BOMB_DEFUSE.ID)?.revive(),e.getItem(K.GUIDE_BOMB_DEFUSE.ID)?.kill()}async showUIByMatchMode(){ht.isChallengeMode()?(this.showUIForChallenge(),ht.isPlayerFinished()&&(await Yk.sleepAsync(1700),ip.emit(j.SHOW_RESULT_CHALLENGE_SCREEN))):this.showUIForSingle()}showUIForChallenge(){let{objects:e}=this.scene.layoutManager;e.challengeInfo.revive(),e.levelText.kill(),e.starProgressBar.kill()}showUIForSingle(){let{objects:e}=this.scene.layoutManager;e.challengeInfo.kill(),e.levelText.revive(),e.starProgressBar.revive()}enablePause(){let{objects:e}=this.scene.layoutManager;e.pauseButton.setDisabled(!1)}disablePause(){let{objects:e}=this.scene.layoutManager;e.pauseButton.setDisabled(!0),e.pauseButton.setAlpha(1)}},Vk=Wk;U(),U(),U();var{KEY:QC,FRAME:$C}=G.EFFECTS,Xk=class extends Phaser.GameObjects.Container{yellowEmitter;whiteEmitter;constructor(e){super(e),this.scene.add.existing(this)}createEmitters(){this.yellowEmitter=this.scene.add.particles(0,0,QC,{frame:$C.YELLOW_SMOKE,timeScale:1,alpha:{start:.3,end:0,ease:Phaser.Math.Easing.Expo.Out},scale:{start:.3,end:1,ease:Phaser.Math.Easing.Expo.Out},lifespan:1500}),this.yellowEmitter.stop(!0),this.yellowEmitter.setDepth($.EFFECT),this.whiteEmitter=this.scene.add.particles(0,0,QC,{frame:$C.WHITE_SMOKE,timeScale:1,alpha:{start:.3,end:0,ease:Phaser.Math.Easing.Expo.Out},scale:{start:.2,end:1,ease:Phaser.Math.Easing.Expo.Out},rotate:{start:0,end:360*1,random:!0},lifespan:1500}),this.whiteEmitter.stop(!0),this.whiteEmitter.setDepth($.EFFECT)}explodeYellow(e,t,i,s,n){this.yellowEmitter||this.reset(),this.yellowEmitter.setParticleSpeed(s,n),this.yellowEmitter.explode(e,t,i)}explodeWhite(e,t,i,s,n){this.whiteEmitter||this.reset(),this.whiteEmitter.setParticleSpeed(s,n),this.whiteEmitter.explode(e,t,i)}stop(){this.yellowEmitter?.killAll(),this.yellowEmitter?.stop(),this.whiteEmitter?.killAll(),this.whiteEmitter?.stop()}reset(){this.createEmitters()}},sp=Xk,{KEY:tP,FRAME:eP}=G.GAMEPLAY,Kk=class{scene;longRocketList=[];rocketList=[];tween1=[];tween2=[];rocketTrail;explosionSpriteList=[];constructor(e){this.scene=e,this.createRockets(),this.createRocketTrail(),this.createExplosion()}createRockets(){for(let e=0;e<4;e++){let t=this.scene.add.image(0,0,tP,eP.EFFECT_LONG_ROCKET);t.setOrigin(.5,0),t.setDepth($.EFFECT),t.kill(),this.longRocketList.push(t);let i=this.scene.add.image(0,0,tP,eP.EFFECT_SHORT_ROCKET);i.setOrigin(1,.5),i.setDepth($.EFFECT),i.kill(),this.rocketList.push(i)}}createRocketTrail(){this.rocketTrail=new sp(this.scene),this.rocketTrail.setDepth($.EFFECT)}createExplosion(){let e=lt.getZoomRatio();for(let t=0;t<4;t++){let{KEY:i,FRAME:s}=G.EFFECTS,n=this.scene.add.sprite(0,0,i,`${s.EFFECT_ROCKET_EXPLOSION}0`);n.setScale(1.2/e),n.setOrigin(.5,.5),n.setDepth($.EFFECT),n.kill(),this.explosionSpriteList.push(n)}}playExplosion(e,t,i){this.explosionSpriteList[i].revive(),this.explosionSpriteList[i].setPosition(e,t),this.explosionSpriteList[i].play(ne.ROCKET_EXPLOSION.KEY,!0),this.explosionSpriteList[i].once(Phaser.Animations.Events.ANIMATION_COMPLETE,()=>{this.explosionSpriteList[i].kill()})}playTween1(e,t,i){let{width:s,height:n}=lt.getWorldSize(),r=[{x:-100-s/2,y:-50-n/2},{x:-50-s/2,y:-100-n/2},{x:100+s/2,y:-50-n/2},{x:100+s/2,y:-100-n/2}];this.tween1.push(this.getTween1Target(r[0],0,867)),this.tween1.push(this.getTween1Target(r[1],1,967,()=>{this.playTween2([r[0],r[1]],[e[0],e[1]],[0,1],0,t)})),this.tween1.push(this.getTween1Target(r[2],2,1067)),this.tween1.push(this.getTween1Target(r[3],3,1167,()=>{this.playTween2([r[2],r[3]],[e[2],e[3]],[2,3],100,i)}))}getTween1Target(e,t,i,s){let{height:n}=lt.getWorldSize(),r=n/2-67,o=.8,a=this.scene.tweens.chain({targets:this.longRocketList[t],tweens:[{props:{y:{duration:867,getEnd:()=>r},rotation:{delay:i,duration:200,getEnd:h=>Phaser.Math.Angle.Between(e.x,e.y,h.x,r)-Math.PI/2}}},{duration:333,ease:Phaser.Math.Easing.Expo.In,onStart:()=>{nt.playSound(ut.ROCKET_FLY)},props:{x:{getEnd:()=>e.x},y:{getEnd:()=>e.y}},onUpdate:(h,l)=>{let u=l.x-l.height/2*Math.cos(l.rotation-Math.PI/2),d=l.y-l.height/2*Math.sin(l.rotation-Math.PI/2),p=l.x-l.height/1.5*Math.cos(l.rotation-Math.PI/2),g=l.y-l.height/1.5*Math.sin(l.rotation-Math.PI/2);h.progress>o&&(this.rocketTrail.explodeYellow(1,u,d,u-p,d-g),o+=.02),Math.random()<.2&&this.rocketTrail.explodeWhite(1,u,d,u-p,d-g)},onComplete:()=>{s&&s()}}]});return a.play(),a}playTween2(e,t,i,s,n){let r=[],o=[];for(let l of i)r.push(this.longRocketList[l]),o.push(this.rocketList[l]);let a=.3,h=this.scene.tweens.add({targets:o,delay:s,duration:800,ease:Phaser.Math.Easing.Expo.In,onStart:()=>{for(let l of r)l.kill();o.forEach((l,u)=>{l.setPosition(r[u].x,r[u].y),l.rotation=0,l.revive(),l.setRotation(Phaser.Math.Angle.Between(e[u].x,e[u].y,t[u].x,t[u].y))})},props:{x:{getEnd:(l,u,d,p)=>t[p].x},y:{getEnd:(l,u,d,p)=>t[p].y}},onUpdate:(l,u)=>{let d=u.x-1.5*u.height*Math.cos(u.rotation),p=u.y-1.5*u.height*Math.sin(u.rotation),g=u.x-2*u.height*Math.cos(u.rotation),c=u.y-2*u.height*Math.sin(u.rotation);l.progress>a&&(this.rocketTrail.explodeYellow(1,d,p,d-g,p-c),a+=.05),Math.random()<.1&&this.rocketTrail.explodeWhite(1,d,p,d-g,p-c)},onComplete:()=>{o.forEach((l,u)=>{l.kill(),this.playExplosion(t[u].x,t[u].y,i[u])}),n&&n()}});this.tween2.push(h)}play(e,t,i){if(e.length!==4)return;for(let r of this.tween1)r.stop();this.tween1=[];for(let r of this.tween2)r.stop();this.tween2=[];let{width:s,height:n}=lt.getWorldSize();this.longRocketList.forEach((r,o)=>{let a=s/8+s/4*o-s/2,h=n/2+133;r.setPosition(a,h),r.rotation=0,r.revive()}),this.playTween1(e,t,i)}stop(){for(let e of this.tween1)e.stop();this.tween1=[];for(let e of this.tween2)e.stop();this.tween2=[];for(let e of this.longRocketList)e.kill();for(let e of this.rocketList)e.kill();this.rocketTrail.stop()}},jk=Kk;U();var{KEY:iP,FRAME:sP}=G.EFFECTS,Zk=class{scene;glowEffect1;glowEffect2;glowSpinTween;tile1=null;tile2=null;defaultTileValues=null;tileTween;constructor(e){this.scene=e,this.createGlowEffect()}createGlowEffect(){this.glowEffect1=this.scene.add.image(0,0,iP,sP.FX_HINT_GLOW),this.glowEffect1.kill(),this.glowEffect2=this.scene.add.image(0,0,iP,sP.FX_HINT_GLOW),this.glowEffect2.kill()}play(){this.glowSpinTween?.stop(),this.tileTween?.stop(),!(!this.tile1||!this.tile2)&&(this.playGlowSpinTween(),this.playTileTween())}playGlowSpinTween(){if(!this.tile1||!this.tile2)return;let{x:e,y:t}=this.tile1.getWorldPosition(),{x:i,y:s}=this.tile2.getWorldPosition(),{boardContainer:n}=this.scene.boardManager;this.glowEffect1.revive(),this.glowEffect1.setPosition(e,t),this.glowEffect1.setDepth(n.depth-1),this.glowEffect2.revive(),this.glowEffect2.setPosition(i,s),this.glowEffect2.setDepth(n.depth-1),this.glowSpinTween=this.scene.tweens.add({targets:[this.glowEffect1,this.glowEffect2],duration:2e3,props:{angle:{from:0,to:360}},repeat:-1})}playTileTween(){if(!this.tile1||!this.tile2)return;let e=[this.tile1.scaleX,this.tile2.scaleX],t=[this.tile1.scaleY,this.tile2.scaleY],i=[this.tile1,this.tile2],s=this.tile1.scaleX,n=this.tile1.scaleY,r=this.tile2.scaleX,o=this.tile2.scaleY;this.defaultTileValues={scaleX1:s,scaleY1:n,scaleX2:r,scaleY2:o},this.tileTween=this.scene.tweens.chain({targets:i,tweens:[{duration:300,props:{scaleX:{getStart:(a,h,l,u)=>e[u],getEnd:(a,h,l,u)=>e[u]*.7},scaleY:{getStart:(a,h,l,u)=>t[u],getEnd:(a,h,l,u)=>e[u]*.7}}},{duration:100,props:{angle:{from:0,to:-30}}},{duration:100,props:{angle:{from:-30,to:30}}},{duration:100,props:{angle:{from:30,to:-30}}},{duration:100,props:{angle:{from:-30,to:0}}},{duration:300,props:{scaleX:{getStart:(a,h,l,u)=>e[u]*.7,getEnd:(a,h,l,u)=>e[u]},scaleY:{getStart:(a,h,l,u)=>t[u]*.7,getEnd:(a,h,l,u)=>t[u]}}}],loop:-1,loopDelay:300}),this.tileTween.play()}hide(){this.glowEffect1.setVisible(!1),this.glowEffect2.setVisible(!1)}show(){this.glowEffect1.setVisible(!0),this.glowEffect2.setVisible(!0)}stop(){if(this.scene.tweens.killTweensOf([this.glowEffect1,this.glowEffect2,this.tile1,this.tile2]),this.glowEffect1.kill(),this.glowEffect2.kill(),this.defaultTileValues){let{scaleX1:e,scaleY1:t,scaleX2:i,scaleY2:s}=this.defaultTileValues;this.tile1?.setScale(e,t),this.tile2?.setScale(i,s)}this.tile1?.setAngle(0),this.tile2?.setAngle(0),this.tile1=null,this.tile2=null,this.defaultTileValues=null}},qk=Zk;U();var{KEY:Jk,FRAME:Qk}=G.GAMEPLAY,$k=class{scene;startingPosition;target;rocket;flyTween;rocketTrail;explosionSprite;isPlaying;isInQueue;constructor(e){this.scene=e,this.target=null,this.startingPosition=null,this.isPlaying=!1,this.isInQueue=!1,this.createRockets(),this.createRocketTrail(),this.createExplosion()}createExplosion(){let{KEY:e,FRAME:t}=G.EFFECTS;this.explosionSprite=this.scene.add.sprite(0,0,e,`${t.EFFECT_ROCKET_EXPLOSION}0`),this.explosionSprite.setOrigin(.5,.8),this.explosionSprite.kill(),this.explosionSprite.setDepth($.ROCKET),this.explosionSprite.setScale(.5)}createRocketTrail(){this.rocketTrail=new sp(this.scene),this.rocketTrail.setDepth($.ROCKET)}createRockets(){let e=this.scene.add.image(0,0,Jk,Qk.EFFECT_TILE_ROCKET);e.setOrigin(.5,.5),e.kill(),e.setDepth($.ROCKET),this.rocket=e}playTween(){if(!this.target||!this.getTargetPosition())return;let e=.1;this.flyTween=this.scene.tweens.add({targets:[this.rocket],duration:600,ease:Phaser.Math.Easing.Expo.InOut,props:{x:{getEnd:()=>{let t=this.getTargetPosition();if(t)return t.x}},y:{getEnd:()=>{let t=this.getTargetPosition();if(t)return t.y}}},onStart:()=>{nt.playSound(ut.ROCKET_FLY)},onUpdate:t=>{let i=this.rocket.x-this.rocket.height/2*Math.cos(this.rocket.rotation-Math.PI/2),s=this.rocket.y-this.rocket.height/2*Math.sin(this.rocket.rotation-Math.PI/2),n=this.rocket.x-this.rocket.height/1.5*Math.cos(this.rocket.rotation-Math.PI/2)*3,r=this.rocket.y-this.rocket.height/1.5*Math.sin(this.rocket.rotation-Math.PI/2)*3;t.progress>e&&(e+=.05,this.rocketTrail.explodeYellow(1,i,s,n-i,r-s)),Math.random()<.3&&this.rocketTrail.explodeWhite(1,i,s,n-i,r-s)},onComplete:()=>{this.rocket.kill(),this.isPlaying=!1;let t=this.getTargetPosition();if(t){let{x:i,y:s}=t;this.playExplosion(i,s),this.target?.setIsBreakWhenExplosive(!0)}},onStop:()=>{this.rocket.kill(),this.isPlaying=!1;let t=this.getTargetPosition();if(t){let{x:i,y:s}=t;this.playExplosion(i,s),this.target?.setIsBreakWhenExplosive(!0)}this.target=null}})}playExplosion(e,t){this.explosionSprite.revive(),this.explosionSprite.setPosition(e,t),this.explosionSprite.once(Phaser.Animations.Events.ANIMATION_COMPLETE,()=>{this.explosionSprite.kill()}),this.explosionSprite.play(ne.ROCKET_EXPLOSION.KEY,!0)}play(){if(this.flyTween?.stop(),!this.target||!this.startingPosition)return;this.isPlaying=!0;let{x:e,y:t}=this.startingPosition,i=this.getTargetPosition();if(!i)return;let{x:s,y:n}=i,r=Phaser.Math.Angle.Between(e,t,s,n),o=this.scene.boardManager.getTileSize();this.rocket.setWorldSize(20*o/35,33.5*o/35),this.rocket.setPosition(e,t),this.rocket.rotation=r+Math.PI/2,this.rocket.revive(),this.playTween()}getTargetPosition(){return this.target?this.target.getWorldPosition():null}stop(){this.flyTween?.stop(),this.rocket.kill(),this.target=null,this.isPlaying=!1,this.isInQueue=!1}},tF=$k;U();var{Utils:{Signal:eF,Object:iF}}=Ludex,{KEY:nP,FRAME:Mi}=G.EFFECTS,Li={GOOD:"GOOD",GREAT:"GREAT",EXCELLENT:"EXCELLENT",UNBELIEVABLE:"UNBELIEVABLE"},rP={[Li.GOOD]:{text:Mi.TEXT_GOOD,light:Mi.TEXT_GOOD_LIGHT},[Li.GREAT]:{text:Mi.TEXT_GREAT,light:Mi.TEXT_GREAT_LIGHT},[Li.EXCELLENT]:{text:Mi.TEXT_EXCELLENT,light:Mi.TEXT_EXCELLENT_LIGHT},[Li.UNBELIEVABLE]:{text:Mi.TEXT_UNBELIEVABLE,light:Mi.TEXT_UNBELIEVABLE_LIGHT}},sF=class extends Phaser.GameObjects.Container{scene;effects;constructor(e){super(e),this.scene=e,this.setWorldSize(250,80),this.effects=this.createEffects(),this.scene.add.existing(this),this.setDepth($.ENCOURAGING),this.alignContainer()}alignContainer(){Phaser.Display.Align.In.TopCenter(this,this.scene.gameZone,0,-80)}run(e){if(e<2)return;this.disableAllEffects();let t=this.getEffect(e),{text:i,light:s,controller:n}=t;i.revive(),s.revive(),i.setDepth($.ENCOURAGING),s.setDepth($.ENCOURAGING);let r=n.renew();this.alignContainer(),this.runTextAnimation(r),this.runTextLightAnimation(s,r)}getEffect(e){switch(e){case 2:return this.effects[Li.GOOD];case 3:return this.effects[Li.GREAT];case 4:return this.effects[Li.EXCELLENT];default:return this.effects[Li.UNBELIEVABLE]}}disableAllEffects(){for(let e of iF.vals(this.effects))e.controller.abort(),e.text.kill(),e.light.kill()}stop(){this.disableAllEffects()}createEffects(){let e={},t=[],i=[];for(let s in rP){let n=s,{text:r,light:o}=rP[n],a=this.scene.make.image({key:nP,frame:r,origin:{x:.5,y:.5}}),h=this.scene.make.image({key:nP,frame:o,origin:{x:.5,y:.5}}),l=new eF.SignalController;e[n]={text:a,light:h,controller:l},a.kill(),h.kill(),t.push(a),i.push(h)}return this.add(i),this.add(t),e}runTextLightAnimation(e,t){let i=this.scene.tweens.add({targets:[e],props:{alpha:{repeat:2,duration:250,value:{start:1,to:0}},scale:{yoyo:!0,duration:100,ease:Phaser.Math.Easing.Quintic.Out,value:{start:.6,to:.8}}}});J.runTween(i,t)}runTextAnimation(e){let t=this.scene.tweens.add({targets:[this],props:{y:{delay:100,duration:600,ease:Phaser.Math.Easing.Quintic.InOut,value:{start:this.y,to:this.y-20}},scale:{duration:350,ease:Phaser.Math.Easing.Circular.Out,value:{start:.2,to:1}},alpha:{duration:150,value:{start:0,to:1}}},onComplete:()=>{this.runEndAnimation(e)}});J.runTween(t,e)}runEndAnimation(e){let t=this.scene.tweens.add({targets:[this],duration:300,delay:100,props:{alpha:{start:1,to:0},scale:{ease:Phaser.Math.Easing.Sine.Out,value:.8}}});J.runTween(t,e)}},nF=sF;U();var{KEY:aP,FRAME:np}=G.GAMEPLAY,rF=class{scene;currentTile=null;tileHighlightSprite;tileOutline;tileOutlineTween;constructor(e){this.scene=e,this.createTileOutline(),this.createSpinningImage()}createTileOutline(){this.tileOutline=this.scene.add.image(0,0,aP,np.EFFECT_TILE_OUTLINE),this.tileOutline.setDepth($.EFFECT-1),this.tileOutline.kill()}createSpinningImage(){this.tileHighlightSprite=this.scene.make.sprite({key:aP,frame:`${np.EFFECT_TILE_HIGHLIGHT}0`},!0),this.tileHighlightSprite.setDepth($.EFFECT),this.tileHighlightSprite.kill()}play(e){this.tileOutlineTween?.stop(),this.currentTile=e;let t=this.scene.boardManager.getTileSize();this.tileOutline.revive(),this.tileOutline.setAlpha(1),this.tileOutline.setWorldSize(t*.95,t*.95),e.add(this.tileOutline),this.tileHighlightSprite.revive(),this.tileHighlightSprite.setY(-1),this.tileHighlightSprite.setWorldSize(t,t),this.tileHighlightSprite.play(ne.TILE_HIGHLIGHT.KEY),e.add(this.tileHighlightSprite),this.scene.scene.systems.updateList.add(this.tileHighlightSprite),this.runFadeInTween()}runFadeInTween(){this.tileOutlineTween=this.scene.tweens.add({targets:this.tileOutline,duration:1e3,yoyo:!0,repeat:-1,ease:Phaser.Math.Easing.Sine.InOut,props:{alpha:0}})}stop(){this.tileHighlightSprite.anims.stop(),this.tileHighlightSprite.setFrame(`${np.EFFECT_TILE_HIGHLIGHT}0`),this.tileHighlightSprite.kill(),this.tileOutlineTween?.stop(),this.tileOutline.kill(),this.currentTile?.remove(this.tileHighlightSprite),this.currentTile?.remove(this.tileOutline),this.currentTile=null}},aF=rF;U();var{KEY:bo,FRAME:Io}=G.GAMEPLAY,oF=class extends Phaser.GameObjects.Container{isPlaying;constructor(e){super(e),this.setDepth($.EFFECT-1),this.createBreakFragments(),this.scene.add.existing(this)}getIsPlaying(){return this.isPlaying}createBreakFragments(){let e=this.scene.make.image({key:bo,frame:Io.LEF_TILE_FRAGMENT});this.add(e);let t=this.scene.make.image({key:bo,frame:Io.RIGHT_TILE_FRAGMENT});this.add(t);let i=this.scene.make.image({key:bo,frame:Io.TOP_TILE_FRAGMENT});this.add(i);let s=this.scene.make.image({key:bo,frame:Io.BOTTOM_TILE_FRAGMENT});this.add(s)}playAnimation(e,t){this.isPlaying=!0;let i=this.scene.boardManager.getTileSize();this.revive();let s=this.getAll();for(let r of s)r.setPosition(0,0),r.setAlpha(1),r.setAngle(0),r instanceof Phaser.GameObjects.Image&&r.setWorldSize(i,i);this.setPosition(e,t);let n=[{x:-10,y:0,angle:-10},{x:10,y:0,angle:10},{x:0,y:-10,angle:10},{x:0,y:10,angle:-10}];this.scene.tweens.add({targets:this.getAll(),alpha:1,duration:500,props:{x:{value:(r,o,a,h)=>n[h].x},y:{value:(r,o,a,h)=>n[h].y},alpha:{value:0},angle:{value:(r,o,a,h)=>n[h].angle}},onComplete:()=>{this.kill(),this.isPlaying=!1}})}stop(){this.scene.tweens.killTweensOf(this.getAll()),this.kill(),this.isPlaying=!1}},oP=oF;U();var{KEY:hF,FRAME:lF}=G.GAMEPLAY,uF=class{scene;starList;flyingStarCounter;flyingStarTweens;clockRemainingTime;captureStarTrails;explodeParticle;constructor(e){this.scene=e,this.starList=this.scene.add.group(),this.flyingStarTweens=[],this.createEffects(),this.clockRemainingTime=0}createEffects(){this.captureStarTrails=[],this.explodeParticle=new TC(this.scene),this.explodeParticle.setDepth($.EFFECT+1)}play(e){this.flyingStarCounter?.stop();let{layoutManager:t}=this.scene,{playtimeClock:i,starProgressBar:s}=t.objects;if(!i.visible||!s.visible){e&&e();return}i.pauseClock(),this.clockRemainingTime=i.getRemainingTime();let n=this.clockRemainingTime>78?Math.ceil(this.clockRemainingTime/13):6;this.flyingStarCounter=this.scene.tweens.addCounter({from:0,to:100,duration:100,onStart:()=>{this.runStarTweens(),this.clockRemainingTime=this.clockRemainingTime>n?this.clockRemainingTime-n:0,i.setClockText(this.clockRemainingTime),this.clockRemainingTime===0&&(this.flyingStarCounter.stop(),typeof e=="function"&&this.scene.time.delayedCall(1e3,e))},onLoop:()=>{this.runStarTweens(),this.clockRemainingTime=this.clockRemainingTime>n?this.clockRemainingTime-n:0,i.setClockText(this.clockRemainingTime),this.clockRemainingTime===0&&(this.flyingStarCounter.stop(),typeof e=="function"&&this.scene.time.delayedCall(1e3,e))},loop:-1})}stop(){this.flyingStarCounter?.stop();for(let e of this.flyingStarTweens)e.stop();for(let e of this.starList.getChildren())this.starList.killAndHide(e);for(let e of this.captureStarTrails)e.stop()}runStarTweens(){let e=this.requestNewStar(),t=this.requestCaptureStarTrail(),{layoutManager:i}=this.scene,{playtimeClock:s,starProgressBar:n}=i.objects,{x:r,y:o}=s.getWorldPosition(),{x:a,y:h}=n.getStarFlyInPosition(),l=r-20,u=new Phaser.Math.Vector2(l,o),d=new Phaser.Math.Vector2(a,h),p=Phaser.Math.FloatBetween(.2,.5),g=Phaser.Math.FloatBetween(.3,.7),c=Phaser.Math.Interpolation.Linear([l,a],p),f=lt.isLandscape()?Phaser.Math.Interpolation.Linear([h,h+200],g):Phaser.Math.Interpolation.Linear([h,h+100],g),m=new Phaser.Math.Vector2(c,f),v=new Phaser.Curves.QuadraticBezier(u,m,d),E=e.scale,x=this.scene.tweens.addCounter({from:0,to:100,duration:650,ease:Phaser.Math.Easing.Sine.Out,onStart:()=>{e.setScale(0),e.setPosition(l,o),e.setVisible(!0),t.run(1,e.x,e.y,0,0)},onUpdate:T=>{let A=T.getValue(),P=v.getPoint(A/100);e.setPosition(P.x,P.y),t.moveEmitZone(e.x,e.y);let R=A>50?1:A/50;e.setScale(E*R)},onComplete:()=>{this.starList.killAndHide(e),e.setScale(E),t.stop(),this.explodeParticle.explode(5,a,h,20),nt.playSound(ut.COLLECT_STARS,{volume:.7}),this.flyingStarTweens=this.flyingStarTweens.filter(T=>T!==x)},onStop:()=>{this.starList.killAndHide(e),e.setScale(E),t.stop(),this.flyingStarTweens=this.flyingStarTweens.filter(T=>T!==x)}});this.flyingStarTweens.push(x)}requestNewStar(){let e=this.starList.getFirstDead();if(e)return e.setActive(!0),e.setWorldSize(28,28),e;let t=this.scene.make.image({key:hF,frame:lF.ICON_STAR_BIG});return this.starList.add(t),t.setWorldSize(28,28),t.setDepth($.EFFECT),t.setVisible(!1),this.scene.add.existing(t),t}requestCaptureStarTrail(){let e=this.captureStarTrails.find(i=>!i.isRunning);if(e)return e;let t=new Yd(this.scene);return t.setDepth($.EFFECT-1),this.captureStarTrails.push(t),t}},cF=uF;U(),U();var{KEY:dF,FRAME:pF}=G.GAMEPLAY,gF=class extends nC{explode(e,t,i,s){super.explode(e,t,i,s),this.runParticleTween()}createEmitters(){this.emitter=this.scene.add.particles(0,0,dF,{frame:pF.EFFECT_SPARK,speedX:{min:-370,max:370},speedY:{min:-370,max:370},scale:{min:.8,max:1.1},alpha:{min:.8,max:1},tint:16749298,deathZone:{source:this.deathZone,type:"onLeave"}})}runParticleTween(){this.emitter.forEachAlive(e=>{this.scene.tweens.killTweensOf(e),this.scene.tweens.add({targets:[e],duration:400,delay:5*0,ease:Phaser.Math.Easing.Circular.Out,props:{velocityX:e.velocityX/50,velocityY:e.velocityY/50}}),this.scene.add.tween({targets:[e],duration:2e3,delay:300,ease:Phaser.Math.Easing.Circular.Out,props:{alpha:0,scaleX:0,scaleY:0,velocityX:Phaser.Math.RND.between(-20,20),velocityY:Phaser.Math.RND.between(-60,-90)},onComplete:()=>{e.lifeCurrent=0}})},this)}},fF=gF,{KEY:mF,FRAME:vF}=G.EFFECTS,EF=class{scene;comboExplosionParticle;explosionCircle;explosionCircleTween;constructor(e){this.scene=e,this.createComboExplosionParticle(),this.createExplosionCircle()}createComboExplosionParticle(){this.comboExplosionParticle=new fF(this.scene),this.comboExplosionParticle.setDepth($.EFFECT+1)}createExplosionCircle(){this.explosionCircle=this.scene.add.image(0,0,mF,vF.FX_CIRCLE),this.explosionCircle.setTint(16753660),this.explosionCircle.setScale(1),this.explosionCircle.setDepth($.EFFECT+1),this.explosionCircle.setVisible(!1)}play(){this.explosionCircleTween?.stop();let{objects:e}=this.scene.layoutManager;if(!e.comboProgressBar.visible)return;let{x:t,y:i}=e.comboProgressBar.comboNumber.getWorldPosition();this.runExplosionCircleTween(t,i)}runExplosionCircleTween(e,t){let i=this.explosionCircle.scale;this.explosionCircleTween=this.scene.tweens.chain({targets:this.explosionCircle,tweens:[{scaleX:i,scaleY:i,alpha:.4,ease:Phaser.Math.Easing.Cubic.Out,duration:400,onStart:()=>{this.explosionCircle.setScale(.5*i),this.explosionCircle.setAlpha(.1),this.explosionCircle.setPosition(e,t),this.explosionCircle.setVisible(!0),this.comboExplosionParticle.explode(20,e,t,1e3)},onStop:()=>{this.explosionCircle.setVisible(!1),this.explosionCircle.setScale(i)}},{alpha:0,ease:Phaser.Math.Easing.Cubic.Out,duration:800,onComplete:()=>{this.explosionCircle.setVisible(!1),this.explosionCircle.setScale(i)},onStop:()=>{this.explosionCircle.setVisible(!1),this.explosionCircle.setScale(i)}}]}),this.explosionCircleTween.play()}stop(){this.explosionCircleTween?.stop(),this.explosionCircle.setVisible(!1)}},yF=EF;U(),U();var{KEY:hP}=G.TILES.BUTTERFLY,{KEY:TF,FRAME:xF}=G.GAMEPLAY,SF=class extends Phaser.GameObjects.Container{config;objectHeight;targetContainer;targetButterflyImage1;targetButterflyImage2;butterflyImage1;butterflyImage2;butterflyBody;constructor(e,t,i,s){super(e,t,i),this.setConfig(s),this.setVisible(!1),this.scene.add.existing(this)}initContainer(e,t,i,s){this.targetContainer=i,this.targetButterflyImage1=e,this.targetButterflyImage2=t,this.initBody(),this.initShadowButterflyWings(s),this.setSize(this.targetContainer.width,this.targetContainer.height),this.setDepth($.EFFECT-1),this.setAlpha(.7)}initShadowButterflyWings(e){let{flipX:t,originX:i,originY:s}=this.targetButterflyImage1,{flipX:n,originX:r,originY:o}=this.targetButterflyImage2;this.butterflyImage1||(this.butterflyImage1=this.scene.add.image(0,0,hP,e),this.butterflyImage1.kill(),this.add(this.butterflyImage1)),this.butterflyImage1.setFrame(e),this.butterflyImage1.setDepth($.EFFECT),this.butterflyImage1.setOrigin(i,s),this.butterflyImage1.setWorldSize(this.targetButterflyImage1.width,this.targetButterflyImage1.height),this.butterflyImage1.setFlipX(t),this.butterflyImage1.setPosition(0,0),this.butterflyImage1.setTint(0),this.butterflyImage2||(this.butterflyImage2=this.scene.add.image(0,0,hP,e),this.butterflyImage2.kill(),this.add(this.butterflyImage2)),this.butterflyImage2.setFrame(e),this.butterflyImage2.setDepth($.EFFECT),this.butterflyImage2.setOrigin(r,o),this.butterflyImage2.setWorldSize(this.targetButterflyImage2.width,this.targetButterflyImage2.height),this.butterflyImage2.setFlipX(n),this.butterflyImage2.setPosition(0,0),this.butterflyImage2.setTint(0)}initBody(){let{displayHeight:e}=this.targetButterflyImage1;this.butterflyBody||(this.butterflyBody=this.scene.add.image(0,0,TF,xF.TILE_BUTTERFLY_BODY),this.add(this.butterflyBody)),this.butterflyBody.setPosition(-1,-3.5),this.butterflyBody.setDisplaySize(e*(31/59)*.75,e*.75),this.butterflyBody.setDepth($.EFFECT),this.butterflyBody.setTint(0)}setConfig(e){let{width:t,height:i}=lt.getWorldSize();this.config={sunPosition:new Phaser.Math.Vector2(e.sunPosition?.x||-t/2,e.sunPosition?.y||-i/2),sunToGroundDistance:e.sunToGroundDistance||i*.1,inputObject:e.inputObject,initialHeight:e.initialHeight||i*.05},this.objectHeight=this.config.initialHeight}updateShadow(e){let{sunPosition:t,sunToGroundDistance:i,inputObject:s}=this.config,{x:n,y:r}=s,{scale:o,angle:a}=this.targetContainer,{scaleX:h,scaleY:l}=this.targetButterflyImage1,{scaleX:u,scaleY:d}=this.targetButterflyImage2,p=(e||0)/i;if(this.setAngle(a),p>1&&(p=1),p<=0){this.setPosition(n,r),this.butterflyImage1.setScale(h,l),this.butterflyImage2.setScale(u,d),this.setScale(1);return}let g=new Phaser.Math.Vector2(n-t.x,r-t.y),c=new Phaser.Math.Vector2(g.x*p/(1-p),g.y*p/(1-p));this.setScale(1-p),this.setPosition(n+c.x,r+c.y),this.butterflyImage1.setScale(h,l),this.butterflyImage2.setScale(u,d),this.setScale(o)}setNewHeight(e){this.objectHeight=e}update(){this.updateShadow(this.objectHeight)}kill(){this.butterflyImage1.kill(),this.butterflyImage2.kill(),this.butterflyBody.kill(),super.kill()}revive(){this.butterflyImage1.revive(),this.butterflyImage2.revive(),this.butterflyBody.revive(),super.revive()}},AF=SF;U();var{KEY:wF,FRAME:CF}=G.GAMEPLAY,{Utils:{Device:PF}}=Ludex,RF=class extends Yd{createEmitters(){let e=1/PF.pixelRatio();this.emitter=this.scene.add.particles(0,0,wF,{frame:CF.EFFECT_TRAIL_STAR,emitZone:{source:this.emitZone,type:"random"},speed:20,timeScale:1,frequency:100,alpha:{start:1,end:0,ease:Phaser.Math.Easing.Expo.Out},scale:{start:e*1.2,end:e*.3,ease:Phaser.Math.Easing.Expo.Out},lifespan:2666}),this.add(this.emitter)}},bF=RF,{KEY:IF,FRAME:_F}=G.GAMEPLAY,{KEY:lP}=G.TILES.BUTTERFLY,OF=2,rp=1.5,MF=class extends Phaser.GameObjects.GameObject{butterflyImage1;butterflyImage2;butterflyBody;captureStarTrail;butterflyContainer;combineTween;flyTween;flapTween;shadowTexture;constructor(e){super(e,"butterflyCaptureEffect")}init(e,t){this.initCaptureStarTrail(),this.initSprites(e,t),this.scene.time.delayedCall(50,()=>{this.runCombineTween()})}initCaptureStarTrail(){this.captureStarTrail=new bF(this.scene),this.captureStarTrail.stop()}initSprites(e,t){let i=e.getIcon().frame.name,{x:s,y:n}=this.getTileWorldPosition(e.row,e.column);this.butterflyImage1||(this.butterflyImage1=this.scene.add.image(s,n,lP,i)),this.butterflyImage1.setPosition(s,n),this.butterflyImage1.setFrame(i),this.butterflyImage1.setDepth($.EFFECT);let{x:r,y:o}=this.getTileWorldPosition(t.row,t.column);this.butterflyImage2||(this.butterflyImage2=this.scene.add.image(r,o,lP,i)),this.butterflyImage2.setPosition(r,o),this.butterflyImage2.setFrame(i),this.butterflyImage2.setDepth($.EFFECT),s>=r?(this.butterflyImage2.flipX=!0,this.butterflyImage2.setOrigin(0,.5),this.butterflyImage1.flipX=!1,this.butterflyImage1.setOrigin(1,.5)):(this.butterflyImage1.flipX=!0,this.butterflyImage1.setOrigin(0,.5),this.butterflyImage2.flipX=!1,this.butterflyImage2.setOrigin(1,.5)),this.butterflyImage1.revive(),this.butterflyImage2.revive()}runCombineTween(){this.combineTween?.stop(),this.combineTween=this.scene.tweens.add({targets:this.butterflyImage1,x:this.butterflyImage2.x,y:this.butterflyImage2.y,duration:500,ease:Phaser.Math.Easing.Quartic.Out,onComplete:()=>{this.initContainer(),this.initShadowTexture(),this.runFlyTween(),this.captureStarTrail.setDepth(this.butterflyContainer.depth-1)},onStop:()=>{this.butterflyImage1.kill(),this.butterflyImage2.kill()}})}runFlyTween(){this.flyTween?.stop(),this.flapTween?.stop();let{width:e,height:t}=lt.getWorldSize(),{y:i}=this.butterflyContainer,s=this.butterflyContainer.scale,n=OF-rp,r=Math.random()>.5,o=this.butterflyContainer.width/2*(n+rp),a=r?-e/2-o:e/2+o,h=i+Phaser.Math.Between(-t*.15,t*.15),l=t*(Math.random()*.015+.005),u=Math.abs(a-this.butterflyContainer.x),d=Math.abs(h-this.butterflyContainer.y),p=Phaser.Math.RadToDeg(Math.atan(d/u)),g=h>i?90+p:90-p;this.flyTween=this.scene.tweens.add({targets:this.butterflyContainer,props:{x:{value:a,duration:3e3,ease:"Linear"},y:{value:h,duration:3e3,ease:"Linear"},angle:{value:r?g*-1:g,duration:1e3,ease:"Linear"},scale:{value:s*(Math.random()*n+rp),duration:1e3,ease:"Linear"}},onStart:()=>{let{width:m,height:v,x:E,y:x}=this.butterflyContainer;this.captureStarTrail.run(1,E-m/2,x-v/2,m,v)},onUpdate:m=>{let v=m.totalElapsed,{width:E,height:x,x:T,y:A}=this.butterflyContainer;if(this.captureStarTrail.moveEmitZone(T-E/2,A-x/2),v>1e3)return;let P=l*(v/1e3);this.shadowTexture.setNewHeight(P),this.shadowTexture.update(),this.shadowTexture.visible||this.shadowTexture.revive()},onComplete:()=>{this.butterflyContainer.setScale(s),this.captureStarTrail.stop(),this.kill()},onStop:()=>{this.captureStarTrail.stop(),this.butterflyContainer.setScale(s)}});let c=this.butterflyImage1.scaleX,f=Phaser.Math.Between(150,350);this.flapTween=this.scene.tweens.add({targets:[this.butterflyImage1,this.butterflyImage2],props:{scaleX:{value:c*.4,duration:f}},yoyo:!0,repeat:-1,ease:Phaser.Math.Easing.Sine.InOut,onComplete:()=>{this.butterflyImage1.scaleX=c,this.butterflyImage2.scaleX=c},onUpdate:m=>{m.totalElapsed<1e3||this.shadowTexture.update()},onStop:()=>{this.butterflyImage1.scaleX=c,this.butterflyImage2.scaleX=c}})}initContainer(){let{x:e,y:t,displayHeight:i,displayWidth:s}=this.butterflyImage1;this.butterflyContainer?(this.butterflyContainer.setPosition(e,t),this.butterflyContainer.setAngle(0),this.butterflyContainer.revive()):this.butterflyContainer=this.scene.add.container(e,t),this.butterflyBody||(this.butterflyBody=this.scene.add.image(0,0,IF,_F.TILE_BUTTERFLY_BODY)),this.butterflyContainer.add(this.butterflyBody),this.butterflyBody.setPosition(-1,-3.5),this.butterflyBody.setDisplaySize(i*(31/59)*.75,i*.75),this.butterflyBody.revive(),this.butterflyContainer.add(this.butterflyImage1),this.butterflyImage1.setPosition(0,0),this.butterflyContainer.add(this.butterflyImage2),this.butterflyImage2.setPosition(0,0);let n=i>s?i:s;this.butterflyContainer.setSize(n*2,n*2),this.butterflyContainer.setDepth($.EFFECT)}initShadowTexture(){let{x:e,y:t}=this.butterflyContainer,i={inputObject:this.butterflyContainer};this.shadowTexture?(this.shadowTexture.setPosition(e,t),this.shadowTexture.setConfig(i)):(this.shadowTexture=new AF(this.scene,e,t,i),this.scene.add.existing(this.shadowTexture));let s=this.butterflyImage1.frame.name;this.shadowTexture.initContainer(this.butterflyImage1,this.butterflyImage2,this.butterflyContainer,s)}kill(){this.active&&(this.combineTween?.stop(),this.flapTween?.stop(),this.flyTween?.stop(),this.captureStarTrail.stop(),this.butterflyImage1.kill(),this.butterflyImage2.kill(),this.butterflyBody?.kill(),this.butterflyContainer?.removeAll(),this.butterflyContainer?.kill(),this.shadowTexture?.kill(),this.setActive(!1))}getTileWorldPosition(e,t){let{tileManager:i,boardManager:s}=this.scene,{firstTilePosition:n}=i.capturePathGroup,{x:r,y:o}=n||{x:0,y:0},a=s.getTileSizeWithSpacing(),h=r+(t-1)*a,l=o+(e-1)*a;return new Phaser.Math.Vector2(h,l)}},ap=MF;U(),U();var LF={duration:1e3,ease:Phaser.Math.Easing.Quadratic.InOut},DF=class{config;scene;spline;tween;constructor(e,t){this.scene=e;let i={...LF,...t};this.config=i,this.tween=e.tweens.add(this.config);let{curve:s}=this.config;this.spline=new Phaser.Curves.Spline(s),this.tween.on(Phaser.Tweens.Events.TWEEN_START,this.createCounter,this)}createCounter(e,t){let{onCurveUpdate:i}=this.config,s=typeof i=="function"?i:null;t.forEach((n,r)=>{if(!this.scene)return;let{duration:o,delay:a}=e.data[r],h=new Phaser.Math.Vector2;this.scene.tweens.addCounter({delay:a,duration:o,ease:Phaser.Math.Easing.Quadratic.InOut,onUpdate:l=>{this.spline.getPoint(l.getValue(),h),n.x=h.x,n.y=h.y,s?.(n)}})})}},uP=DF;U();var{KEY:kF,FRAME:FF}=G.EFFECTS,NF=class extends Phaser.GameObjects.Container{emitZone;emitter;constructor(e){super(e),this.createEmitZone(),this.scene.add.existing(this)}createEmitZone(){this.emitZone=new Phaser.Geom.Rectangle}createEmitters(){this.emitter=this.scene.add.particles(0,0,kF,{frame:FF.FX_COMET,emitZone:{source:this.emitZone,type:"random"},speed:20,timeScale:1,frequency:100,alpha:{start:1,end:0,ease:Phaser.Math.Easing.Expo.Out},scale:{start:2,end:.1,ease:Phaser.Math.Easing.Expo.Out},lifespan:2666}),this.add(this.emitter)}run(e,t,i,s,n){this.stop(),this.reset(),this.emitZone.setSize(s,n),this.emitZone.setPosition(t-s/2,i-n/2),this.emitter.setQuantity(e),this.emitter.start()}explode(e,t,i){this.emitter||this.reset(),this.emitter.explode(e,t,i)}stop(){this.emitter?.killAll(),this.emitter?.stop()}reset(){this.createEmitters()}},cP=NF;U();var{KEY:BF,FRAME:UF}=G.EFFECTS,GF=class extends Phaser.GameObjects.Container{deathZone;emitter;constructor(e){super(e),this.createDeathZone(),this.createEmitters(),this.setActive(!1),this.setVisible(!1),this.scene.add.existing(this)}createDeathZone(){this.deathZone=new Phaser.Geom.Circle}createEmitters(){this.emitter=this.scene.add.particles(0,0,BF,{frame:UF.FX_SPARK,speed:{min:10,max:1200},scale:{start:1.33,end:0},alpha:{start:1,end:0,ease:Phaser.Math.Easing.Expo.Out},deathZone:{source:this.deathZone,type:"onLeave"},lifespan:3e3}),this.add(this.emitter)}explode(e,t,i,s){this.setActive(!0),this.setVisible(!0),this.deathZone.radius=s,this.deathZone.setPosition(t,i),this.emitter.explode(e,t,i)}},dP=GF,{KEY:YF,FRAME:HF}=G.EFFECTS,zF=class{scene;originImage;starTail;curveAnimation;sparkExplosive;constructor(e){this.scene=e,this.createComponents()}createComponents(){this.originImage=this.scene.make.image({key:YF,frame:HF.BLANK}),this.originImage.setVisible(!1);let e=new cP(this.scene);e.setDepth($.EFFECT),this.starTail=e}runRewardItemCurveAnimation(e,t,i,s,n){let r={x:e,y:t},o={x:i,y:s},a=100,h=lt.isLandscape(),l=Phaser.Math.RND.between(-a,a)*-1,u=Phaser.Math.RND.between(-140,-100),d=[[r.x,r.y],[r.x+l,r.y+u],[o.x,o.y]],p=[[r.x,r.y],[o.x,o.y]];this.curveAnimation=new uP(this.scene,{targets:[this.originImage],props:{scale:.2},delay:this.scene.tweens.stagger(80,{}),duration:1e3,curve:h?d:p,onComplete:()=>{this.runSparksExplosive(o.x,o.y),n!==void 0&&n()},onStop:()=>{n!==void 0&&n()},onCurveUpdate:g=>{let c=g.x+Phaser.Math.RND.between(-16,16),f=g.y+Phaser.Math.RND.between(-16,16);this.isCurveAnimationRunning()&&this.starTail.explode(1,c,f)}}),J.runTween(this.curveAnimation.tween)}isCurveAnimationRunning(){return!this.curveAnimation||!this.curveAnimation.tween?!1:this.curveAnimation.tween.isPlaying()}runSparksExplosive=(e,t)=>{let i=this.scene;this.sparkExplosive=new dP(i),this.sparkExplosive.setDepth($.EFFECT),this.sparkExplosive.explode(100,e,t,50)};stopCurveAnimation(){this.isCurveAnimationRunning()&&(this.curveAnimation.tween.stop(),this.starTail?.stop())}},WF=zF;U();var{KEY:pP,FRAME:Er}=G.GAMEPLAY,{DestroyPairCount:gP}=Lt.SuperRocketConfig,fP={Landscape:8,Portrait:6},VF=class{scene;longRocketList=[];rocketList=[];tween1=[];tween2=[];rocketTrail;explosionSpriteList=[];constructor(e){this.scene=e,this.createRockets(),this.createRocketTrail(),this.createExplosion()}createRockets(){let{Landscape:e,Portrait:t}=fP,i=lt.isLandscape()?e:t;for(let s=0;s<gP*2;s++){let n=Math.floor(s/2)%2===0?Er.EFFECT_SHORT_ROCKET:Er.EFFECT_SHORT_YELLOW_ROCKET;if(s<i){let o=this.scene.add.image(0,0,pP,Er.EFFECT_LONG_ROCKET);o.setOrigin(.5,0),o.setDepth($.EFFECT),o.kill(),this.longRocketList.push(o)}let r=this.scene.add.image(0,0,pP,n);r.setOrigin(1,.5),r.setDepth($.EFFECT),r.kill(),this.rocketList.push(r)}}createRocketTrail(){this.rocketTrail=new sp(this.scene),this.rocketTrail.setDepth($.EFFECT)}createExplosion(){let e=lt.getZoomRatio();for(let t=0;t<gP*2;t++){let{KEY:i,FRAME:s}=G.EFFECTS,n=this.scene.add.sprite(0,0,i,`${s.EFFECT_ROCKET_EXPLOSION}0`);n.setScale(1.2/e),n.setOrigin(.5,.5),n.setDepth($.EFFECT),n.kill(),this.explosionSpriteList.push(n)}}playExplosion(e,t,i){this.explosionSpriteList[i].revive(),this.explosionSpriteList[i].setPosition(e,t),this.explosionSpriteList[i].play(ne.ROCKET_EXPLOSION.KEY,!0),this.explosionSpriteList[i].once(Phaser.Animations.Events.ANIMATION_COMPLETE,()=>{this.explosionSpriteList[i].kill()})}generateAirTargets(e){let{width:t,height:i}=lt.getWorldSize(),{width:s=0,height:n=0}=this.longRocketList[0],r={x:0,y:i/2},o=this.longRocketList.length<e?this.longRocketList.length:e,a={x:-100-t/2,y:-50-i/2},h=({x:100+t/2,y:-50-i/2}.x-a.x)/(o-1),l=[];for(let u=0;u<o;u++){let d={x:a.x+h*u,y:a.y},p={x:d.x-r.x,y:d.y-r.y},g={x:p.x/Math.sqrt(p.x**2+p.y**2),y:p.y/Math.sqrt(p.x**2+p.y**2)};d.x+=s*g.x,d.y+=n*g.y,l.push(d)}return l}reorderRocketLaunchTiming(){let e=this.longRocketList.length/2,t=[];for(let i=0;i<e;i++){let s=i%2===0?Er.EFFECT_LONG_ROCKET:Er.EFFECT_LONG_YELLOW_ROCKET,n=e+i,r=e-i-1;this.longRocketList[n].setFrame(s),this.longRocketList[r].setFrame(s),t.push(this.longRocketList[n]),t.push(this.longRocketList[r])}this.longRocketList=t}reorderAirTargets(e){let t=e.length/2,i=[];for(let s=0;s<t;s++){let n=t+s,r=t-s-1;i.push(e[n]),i.push(e[r])}return i}playTween1(e,t){let i=this.generateAirTargets(e.length),{tileManager:s,itemManager:n}=this.scene,r=e.length/2;this.reorderRocketLaunchTiming();let o=this.reorderAirTargets(i);for(let a=0;a<r;a++){let h=a===r-1,l=a*2,u=a*2+1,d=o[l],p=o[u],g=t[l],c=t[u],f=e[l],m=e[u],v=Math.floor(Math.random()*o.length),E=Math.floor(Math.random()*o.length);for(;v===E;)E=Math.floor(Math.random()*o.length);this.tween1.push(this.getTween1Target(d,l,867+200*a)),this.tween1.push(this.getTween1Target(p,u,867+200*a+100,()=>{this.playTween2([o[v],o[E]],[g,c],[l,u],100,()=>{if(s.tilesCapturing([f,m]),!h)return;let x=n.getItem(K.SUPER_ROCKET.ID);!x||!(x instanceof tn)||(x.setRunningStatus(!1),x.clearTimerEvent(),n.deactivateItem(K.SUPER_ROCKET.ID),n.setIsUseableItem(!1),this.scene.events.emit(tt.EVENTS.RESUME_BOMB_TIMER))})}))}}getTween1Target(e,t,i,s){let{height:n}=lt.getWorldSize(),r=n/2-67,o=this.longRocketList[t];if(!o){let h=this.scene.tweens.chain({targets:[],tweens:[{duration:1200,ease:Phaser.Math.Easing.Expo.In}]}),l=333+i+200;return this.scene.time.delayedCall(l,()=>{s&&s()}),h}let a=.8;return this.scene.tweens.chain({targets:o,tweens:[{props:{y:{duration:867,getEnd:()=>r},rotation:{delay:i,duration:200,getEnd:h=>Phaser.Math.Angle.Between(e.x,e.y,h.x,r)-Math.PI/2}}},{duration:333,ease:Phaser.Math.Easing.Expo.In,onStart:()=>{nt.playSound(ut.ROCKET_FLY)},props:{x:{getEnd:()=>e.x},y:{getEnd:()=>e.y}},onUpdate:(h,l)=>{let u=l.x-l.height/2*Math.cos(l.rotation-Math.PI/2),d=l.y-l.height/2*Math.sin(l.rotation-Math.PI/2),p=l.x-l.height/1.5*Math.cos(l.rotation-Math.PI/2),g=l.y-l.height/1.5*Math.sin(l.rotation-Math.PI/2);h.progress>a&&(this.rocketTrail.explodeYellow(1,u,d,u-p,d-g),a+=.02),Math.random()<.2&&this.rocketTrail.explodeWhite(1,u,d,u-p,d-g)},onComplete:()=>{s&&s()}}]})}playTween2(e,t,i,s,n){let r=[],o=[];for(let l of i)r.push(this.longRocketList[l]),o.push(this.rocketList[l]);let a=.3,h=this.scene.tweens.add({targets:o,delay:s,duration:1300,ease:Phaser.Math.Easing.Expo.In,onStart:()=>{for(let l of r)l&&l.kill();o.forEach((l,u)=>{l.setPosition(e[u].x,e[u].y),l.rotation=0,l.revive(),l.setRotation(Phaser.Math.Angle.Between(e[u].x,e[u].y,t[u].x,t[u].y))})},props:{x:{getEnd:(l,u,d,p)=>t[p].x},y:{getEnd:(l,u,d,p)=>t[p].y}},onUpdate:(l,u)=>{let d=u.x-1.5*u.height*Math.cos(u.rotation),p=u.y-1.5*u.height*Math.sin(u.rotation),g=u.x-2*u.height*Math.cos(u.rotation),c=u.y-2*u.height*Math.sin(u.rotation);l.progress>a&&(this.rocketTrail.explodeYellow(1,d,p,d-g,p-c),a+=.05),Math.random()<.1&&this.rocketTrail.explodeWhite(1,d,p,d-g,p-c)},onComplete:()=>{o.forEach((l,u)=>{l.kill(),this.playExplosion(t[u].x,t[u].y,i[u])}),n&&n()}});this.tween2.push(h)}play(e,t){for(let h of this.tween1)h.stop();this.tween1=[];for(let h of this.tween2)h.stop();this.tween2=[];let{Landscape:i,Portrait:s}=fP,n=lt.isLandscape()?i:s,r=n<e.length?n/2:e.length/2,{width:o,height:a}=lt.getWorldSize();this.longRocketList.forEach((h,l)=>{if(l>=r*2)return;let u=o/(r*4)+o/(r*2)*l-o/2,d=a/2+133;h.setPosition(u,d),h.rotation=0,h.revive()}),this.playTween1(e,t)}stop(){for(let e of this.tween1)e.stop();this.tween1=[];for(let e of this.tween2)e.stop();this.tween2=[];for(let e of this.longRocketList)e.kill();for(let e of this.rocketList)e.kill();this.rocketTrail.stop()}},XF=VF;U(),U();var{KEY:KF,FRAME:mP}=G.CHALLENGE,jF=class extends Phaser.GameObjects.Container{avatar;playerName;constructor(e,t,i){super(e,t,i),this.createAvatar(),this.createName(),this.setSize(100,100)}createAvatar(){let e={width:84,height:84,radius:12,key:KF,background:mP.AVATAR_BIG,frame:mP.AVATAR_BIG_FRAME};this.avatar=new ss(this.scene,e),this.add(this.avatar),this.avatar.setWorldSize(68,68),this.avatar.loading.setWorldSize(50,50)}createName(){this.playerName=X.createText(this.scene,"Anonymous",20),this.playerName.setTint(16112054),this.add(this.playerName),Phaser.Display.Align.To.BottomCenter(this.playerName,this.avatar,0,15)}updatePlayerInfo(e){this.avatar.loadPhoto(e.id,e.photo),this.playerName.setText(e.name)}},vP=jF,{player:op}=codex,{KEY:ZF,FRAME:qF}=G.CHALLENGE,JF=class extends Phaser.GameObjects.Container{scene;vsText;background;playerInfoContainer;opponentInfoContainer;entrancePlayerInfoTween;entranceOpponentInfoTween;isPlaying=!1;constructor(e){super(e),this.scene=e,this.addBackground(),this.createVsText(),this.createPlayerInfoContainer(),this.createOpponentInfoContainer(),this.scene.add.existing(this),this.setVisible(!1),this.setDepth($.EFFECT)}createVsText(){this.vsText=this.scene.make.image({key:ZF,frame:qF.VS}),this.add(this.vsText)}createPlayerInfoContainer(){this.playerInfoContainer=new vP(this.scene,0,0),this.add(this.playerInfoContainer)}createOpponentInfoContainer(){this.opponentInfoContainer=new vP(this.scene,0,0),this.add(this.opponentInfoContainer)}updatePlayerInfoContainer(){let e=op.getPlayerId(),t=op.getPlayer()?.name??"You",i=op.getPlayer()?.photo??Xt.AVATAR_DEFAULT.FILE;this.playerInfoContainer.updatePlayerInfo({id:e,name:t,photo:i})}updateOpponentInfoContainer(){let e=ht.getMatchState(),{customData:t={},profiles:i={}}=e,s=t.opponentId??"0",n=i[s]?.name??"Your Friend",r=i[s]?.photo??Xt.AVATAR_DEFAULT.FILE;this.opponentInfoContainer.updatePlayerInfo({id:s,name:n,photo:r})}addBackground(){let e="screen-background",{width:t,height:i}=lt.getWorldSize();if(!this.scene.textures.exists(e)){let s=this.scene.add.graphics();s.fillStyle(0,1),s.fillRect(0,0,t,i),s.generateTexture(e,t,i),s.destroy()}this.background=this.scene.add.image(0,0,e),this.background.setWorldSize(t,i),this.background.setAlpha(.7),this.add(this.background)}play(){if(this.isPlaying)return;this.updatePlayerInfoContainer(),this.updateOpponentInfoContainer(),this.isPlaying=!0;let{width:e,height:t}=lt.getWorldSize();this.vsText.setPosition(0,-5),this.playerInfoContainer.setPosition(e/2,-140),this.opponentInfoContainer.setPosition(-e/2,100),this.background.setWorldSize(e,t),this.runEntrancePlayerInfoTimeline(),this.runEntranceOpponentInfoTimeline(),this.setVisible(!0),this.setAlpha(1)}runEntrancePlayerInfoTimeline(){let{width:e}=lt.getWorldSize();this.entrancePlayerInfoTween=this.scene.tweens.chain({targets:this.playerInfoContainer,tweens:[{x:e/8,duration:300,ease:Phaser.Math.Easing.Sine.In},{x:-e/8,duration:900,ease:Phaser.Math.Easing.Linear},{x:-e,duration:300,ease:Phaser.Math.Easing.Sine.In,onComplete:()=>{this.stop()}}]}),this.entrancePlayerInfoTween.play()}runEntranceOpponentInfoTimeline(){let{width:e}=lt.getWorldSize();this.entranceOpponentInfoTween=this.scene.tweens.chain({targets:this.opponentInfoContainer,tweens:[{x:-e/8,duration:300,ease:Phaser.Math.Easing.Sine.In},{x:e/8,duration:900,ease:Phaser.Math.Easing.Linear},{x:e,duration:300,ease:Phaser.Math.Easing.Sine.In,onComplete:()=>{this.stop()}}]}),this.entranceOpponentInfoTween.play()}stop(){this.isPlaying&&(this.isPlaying=!1,this.entrancePlayerInfoTween.stop(),this.entranceOpponentInfoTween.stop(),this.scene.tweens.add({targets:this,alpha:0,duration:100,ease:Phaser.Math.Easing.Sine.In,onStop:()=>{this.setVisible(!1)},onComplete:()=>{this.setVisible(!1)}}))}},QF=JF;U();var{KEY:$F,FRAME:tN}=G.GAMEPLAY,eN=class extends Phaser.GameObjects.GameObject{scene;coinIcon;coinTween;constructor(e){super(e,"buyItemAnimation"),this.scene=e,this.createCoinIcon()}createCoinIcon(){this.coinIcon=this.scene.add.image(0,0,$F,tN.ICON_COIN),this.coinIcon.setVisible(!1),this.coinIcon.setDepth($.EFFECT)}play(e,t){this.coinTween?.stop(),this.coinIcon.setPosition(e,t),this.coinIcon.setVisible(!0),this.coinIcon.setAlpha(1),this.runCoinAnimation()}stop(){this.coinTween&&this.coinTween.stop(),this.coinIcon.setVisible(!1)}runCoinAnimation(){this.coinTween=this.scene.tweens.add({targets:[this.coinIcon],props:{y:{value:"-=50",ease:"Sine.Out",duration:400},alpha:{delay:100,value:0,ease:"Sine.In",duration:400}},onComplete:()=>{this.coinIcon.setVisible(!1)}}),J.runTween(this.coinTween)}},iN=eN,sN=class extends Ne{scene;ns;rs;as;li;ge;tileHintEffect;ke;Fe;hs;ui;ci;di;ls;pi;constructor(e){super(e),this.scene=e,this.li=[],this.ge=[],this.ci=this.scene.add.group(),this.fh(),this.mh(),this.vh(),this.Eh(),this.yh(),this.Th(),this.xh(),this.Sh(),this.Ah(),this.wh(),this.Ch()}fh(){this.ns=new nF(this.scene)}mh(){this.rs=new jk(this.scene)}vh(){this.as=new XF(this.scene)}Eh(){this.tileHintEffect=new qk(this.scene)}yh(){this.ke=new aF(this.scene)}xh(){this.hs=new cF(this.scene)}Sh(){this.ui=new yF(this.scene)}Th(){this.Fe=[];for(let e=0;e<2;e++){let t=new oP(this.scene);t.setScale(.8),this.Fe.push(t),t.kill()}}Ah(){this.di=new WF(this.scene)}wh(){this.ls=new QF(this.scene)}Ch(){this.pi=new iN(this.scene)}playComboEffect(e){this.ns.run(e)}playRocketEffect(e,t,i){this.rs.play(e,t,i)}playSuperRocketEffect(e,t){this.as.play(e,t)}requestTileRocketEffect(e,t){let i=this.li.find(s=>!s.isInQueue);i||(i=new tF(this.scene),this.li.push(i)),i.target=t,i.isInQueue=!0,i.startingPosition=e,this.ge.push(i)}playTileRocketEffects(){this.ge.length!==0&&this.scene.time.delayedCall(200,()=>{let e=[];for(let t of this.ge)t.isPlaying||(t.target&&e.push(t.target),t.play());this.scene.time.delayedCall(700,()=>{this.scene.events.emit(tt.EVENTS.ROCKET_EXPLODE,e)}),this.ge=[]})}playTileHintEffect(e,t){this.tileHintEffect.stop(),this.tileHintEffect.tile1=e,this.tileHintEffect.tile2=t,this.tileHintEffect.play()}playRewardItemCurveAnimation(e,t,i,s,n){this.di.runRewardItemCurveAnimation(e,t,i,s,n)}stopTileHintEffect(){this.tileHintEffect.stop()}playTileHighlightEffect(e){this.ke.play(e)}stopTileHighlightEffect(){this.ke.stop()}stopRewardItemCurveAnimation(){this.di.stopCurveAnimation()}getCurrentlyHighlightedTile(){return this.ke.currentTile}playTileBreakEffect(e){let{x:t,y:i}=e.getWorldPosition(),s=this.Fe.find(r=>!r.getIsPlaying());if(s){s.playAnimation(t,i);return}let n=new oP(this.scene);n.playAnimation(t,i),this.Fe.push(n)}playFlyingStarFromClockEffect(e){this.hs.play(e)}playComboExplosionEffect(){this.ui.stop(),this.ui.play()}playButterflyCaptureEffect(e,t){let i=this.ci.getFirstDead();if(i&&i instanceof ap){i.setActive(!0),i.init(e,t);return}let s=new ap(this.scene);s.init(e,t),this.ci.add(s)}playChallengeFriendsStartAnimation(){this.ls.play()}killButterflyCaptureEffects(){let e=this.ci.getChildren();for(let t of e)t instanceof ap&&t.kill()}playBuyItemAnimation(e,t){this.pi.play(e,t)}stopBuyItemAnimation(){this.pi.stop()}stop(){if(this.isRunning()){super.stop(),this.ns.stop(),this.rs.stop(),this.as.stop(),this.tileHintEffect.stop(),this.ke.stop(),this.hs.stop(),this.ui.stop(),this.pi.stop();for(let e of this.li)e.stop();for(let e of this.Fe)e.stop();this.ge=[],this.di.stopCurveAnimation(),this.killButterflyCaptureEffects(),this.ls.stop()}}},nN=sN;U();var{Utils:{Browser:SY}}=Ludex,rN=class extends Ne{scene;at;us;gi;fi;constructor(e){super(e),this.scene=e,this.at=0;let t=lt.isLandscape();this.fi=t?4e3:2e3}init(){this.at=0,this.pe(),this.mi(),this.vi()}start(){this.isRunning()||(super.start(),this.Bn(),this.Ph())}stop(){this.isRunning()&&(super.stop(),this.at=0,this.pe(),this.mi(),this.vi())}getCombo(){return this.at}Bn(){this.pe();let e={repeat:-1,delay:this.fi,callback:this.cs};this.us=this.scene.time.addEvent(e)}pe(){this.us?.remove(),this.us?.destroy(),this.gi?.remove(),this.gi?.destroy()}Ph(){this.scene.events.on(mr.COMBO,this.Un),this.scene.events.on(mr.RESET,this.cs)}mi(){this.scene.events.off(mr.COMBO,this.Un),this.scene.events.off(mr.RESET,this.cs)}Un=()=>{if(this.gi?.remove(),!this.isRunning())return;this.at+=1;let e=Math.min(20+this.at*20,11*20);vr.vibrate(e),this.Bn();let{layoutManager:t,effectManager:i}=this.scene,{comboProgressBar:s}=t.objects;if(this.at>1){let n=1;s.revive(),s.setDepth($.EFFECT),s.setAlpha(1),s.setComboText(this.at),i.playComboExplosionEffect(),s.setProcess(n,!0),this.gi=this.scene.time.addEvent({delay:100,repeat:this.fi/100,callback:()=>{n-=1/(this.fi/100),n<0&&(n=0),n<=0&&this.scene.tweens.add({targets:s,alpha:0,delay:100,duration:100,onComplete:()=>{this.vi()}}),s.setProcess(n)}})}this.scene.time.delayedCall(300,()=>{this.Rh(this.at),i.playComboEffect(this.at)})};Rh(e){let t=`combo_${e>5?5:e}`;nt.playSound(t)}cs=()=>{this.at=0,this.vi()};vi(){let{layoutManager:e}=this.scene,{comboProgressBar:t}=e.objects;t.kill(),this.scene.tweens.killTweensOf(t)}},aN=rN;U(),U(),U(),U();var{ID:_o}=K.HINT,{FRAME:yr}=G.GAMEPLAY,oN=class extends re{scene;constructor(e){super(e,yr.HINT_ITEM,26.5,36.5),this.itemCost=200,this.scene=e,this.setName(_o),this.onClick=this.handleUseItem}handleUseItem=()=>{let{itemManager:e,tileManager:t}=this.scene;if(t.isSuggestPairHintShowed){J.runTween(this.showItemAnimation);return}if(this.isActive){e.deactivateItem(_o);return}if(!e.activeItem(_o)){J.runTween(this.shakeAnimation.tween);return}this.useItem()};useItem(){let{tileManager:e,itemManager:t}=this.scene;e.suggestPairHint(),t.deactivateItem(_o),kt.addUseHintMissionProgress(1)}disableItem(){super.disableItem(),this.item.setAlpha(1),this.item.setFrame(yr.ITEM_HINT_LOCK),this.bg.setFrame(yr.ITEM_BG_LOCK),this.amountItem.setVisible(!1),this.itemLock.setVisible(!0),this.itemLockText.setVisible(!0)}enableItem(){super.enableItem(),this.item.setAlpha(1),this.item.setFrame(yr.HINT_ITEM),this.bg.setFrame(yr.ITEM_BG_ITEM),this.amountItem.setVisible(!0),this.itemLock.setVisible(!1),this.itemLockText.setVisible(!1)}},EP=oN;U();var{ID:Oo}=K.SHUFFLE,{FRAME:Tr}=G.GAMEPLAY,hN=class extends re{scene;duration;isRunning=!1;costTimer;constructor(e){super(e,Tr.ITEM_SHUFFLE,26.5,35.5),this.itemCost=300,this.scene=e,this.duration=1200,this.setName(Oo),this.onClick=this.handleUseItem}handleUseItem=()=>{if(this.isRunning)return;let{itemManager:e,animationManager:t}=this.scene;if(t.isMoveTilesCompleted||J.runTween(this.shakeAnimation.tween),this.isActive){e.deactivateItem(Oo);return}if(!e.activeItem(Oo)){J.runTween(this.shakeAnimation.tween);return}this.useItem()};useItem=()=>{let{tileManager:e}=this.scene;this.isRunning=!0,e.isSelectable=!1,e.emitInteraction(),e.removeSuggestPairHint(),this.costTimer?.remove(),this.scene.time.delayedCall(100,this.runShuffle),kt.addUseShuffleMissionProgress(1)};runShuffle=()=>{let{boardManager:e}=this.scene;e.runShuffle(this.duration),this.scene.time.delayedCall(this.duration+100,this.processNoAvailableMatches)};processNoAvailableMatches=()=>{let{boardManager:e,itemManager:t,tileManager:i}=this.scene,{matchFinder:s}=e;if(s.checkForAvailableMatches()){this.isRunning=!1,t.deactivateItem(Oo),i.isSelectable=!0;return}this.runShuffle()};disableItem(){super.disableItem(),this.item.setAlpha(1),this.item.setFrame(Tr.ITEM_SHUFFLE_LOCK),this.bg.setFrame(Tr.ITEM_BG_LOCK),this.amountItem.setVisible(!1),this.itemLock.setVisible(!0),this.itemLockText.setVisible(!0)}enableItem(){super.enableItem(),this.item.setAlpha(1),this.item.setFrame(Tr.ITEM_SHUFFLE),this.bg.setFrame(Tr.ITEM_BG_ITEM),this.amountItem.setVisible(!0),this.itemLock.setVisible(!1),this.itemLockText.setVisible(!1)}},yP=hN,{ID:Mo}=K.AUTO_MATCH,{FRAME:lN}=G.GAMEPLAY,uN=class extends re{scene;isRunning=!1;matchFinder;delayItemTimer;delayMatchTimer;activeTween;constructor(e){super(e,lN.DEV_TOOL_HAND,25,25),this.scene=e,this.matchFinder=new lC(e),this.setAmount(999),this.onClick=this.handleUseItem}handleUseItem=()=>{let{itemManager:e}=this.scene;if(this.isActive){e.deactivateItem(Mo);return}if(!e.activeItem(Mo)){J.runTween(this.shakeAnimation.tween);return}e.setIsUseableItem(!0),this.useItem()};deactivateItem(){this.cleanState(),super.deactivateItem()}useItem=()=>{this.cleanState(),this.scene.stateManager.isPlaying()&&(this.isRunning=!0,this.autoMatch(),this.autoUseItem(),this.runActiveTween())};runActiveTween=()=>{this.activeTween?.isPlaying()||(this.activeTween=this.scene.tweens.add({targets:[this],duration:400,yoyo:!0,repeat:-1,ease:Phaser.Math.Easing.Sine.InOut,props:{alpha:.3}}))};autoMatch=()=>{if(!this.isRunning)return;let{boardManager:e,tileManager:t,itemManager:i}=this.scene;if(!this.scene.stateManager.isPlaying()){this.cleanState(),i.deactivateItem(Mo);return}if(this.runActiveTween(),t.firstSelectedTile=null,!t.isCanMove()){this.cleanState(),i.deactivateItem(Mo);return}if(!this.matchFinder.checkForAvailableMatches()){this.nextAutoMatch();return}let s=this.matchFinder.pathForAutoplay;if(!s){this.nextAutoMatch();return}let{x:n=1,y:r=1}=s[0],{x:o=1,y:a=1}=s[s.length-1],h=e.getTileByPosition(n,r),l=e.getTileByPosition(o,a);if(!h||!l){this.nextAutoMatch();return}if(!this.emuSelectTile(h)){this.nextAutoMatch();return}let u=Phaser.Math.Between(100,400);this.delayMatchTimer=this.scene.time.delayedCall(u,()=>{this.emuSelectTile(l),this.nextAutoMatch()})};nextAutoMatch=()=>{let e=Phaser.Math.Between(300,2100);this.delayMatchTimer=this.scene.time.delayedCall(e,this.autoMatch)};autoUseItem=()=>{if(!this.isRunning)return;let{itemManager:e}=this.scene;this.runActiveTween();let t=Phaser.Math.Between(3e3,5e3);this.delayItemTimer=this.scene.time.delayedCall(t,()=>{if(!e.getIsUseableItem()){this.autoUseItem();return}let i=e.getItems();Phaser.Utils.Array.Shuffle(i);let s=i.filter(r=>r.isDisabled||r.amount<=0?!1:r instanceof EP||r instanceof Fd||r instanceof yP||r instanceof Dd),n=Phaser.Math.Between(0,s.length-1);s[n]&&s[n].callback(),this.autoUseItem()})};emuSelectTile=e=>{let{tileManager:t}=this.scene;return t.isSelectable?(e.showHighlight(),t.emitInteraction(),t.tileSelect(e)(),!0):!1};cleanState(){this.setAlpha(1),this.isRunning=!1,this.activeTween?.remove(),this.delayItemTimer?.remove(),this.delayMatchTimer?.remove(),this.scene.tweens.killTweensOf(this)}},cN=uN;U();var{ID:hp}=K.BACK_LEVEL,{FRAME:dN}=G.GAMEPLAY,{event:pN,player:gN}=codex,{Utils:{Time:fN}}=Ludex,mN=class extends re{scene;isRunning=!1;constructor(e){super(e,dN.DEV_TOOL_ARROW,25,25),this.scene=e,this.setAmount(999),this.item.flipX=!0,this.onClick=this.handleUseItem}handleUseItem=()=>{if(this.isRunning)return;let{itemManager:e}=this.scene;if(this.isActive){e.deactivateItem(hp);return}if(!e.activeItem(hp)){J.runTween(this.shakeAnimation.tween);return}this.useItem()};useItem=async()=>{let{itemManager:e,levelHandler:t}=this.scene,{level:i}=t,s=i-2;t.level=s,gN.setGameData({level:s}),await fN.sleepAsync(100),pN.emit(j.NEXT_LEVEL),e.deactivateItem(hp)}},vN=mN;U();var{ID:lp}=K.BOMB_EXPLOSIVE,{FRAME:EN}=G.GAMEPLAY,yN=class extends re{scene;constructor(e){super(e,EN.DEV_TOOL_BOMB,25,25),this.scene=e,this.setAmount(999),this.onClick=this.handleUseItem}handleUseItem=()=>{let{itemManager:e}=this.scene;if(this.isActive){e.deactivateItem(lp);return}if(!e.activeItem(lp)){J.runTween(this.shakeAnimation.tween);return}this.useItem()};useItem=()=>{let{itemManager:e,tileManager:t}=this.scene;t.emitInteraction();let i=t.getAliveTiles();for(let s of i)s instanceof je&&s.shortenRemainingTime();e.deactivateItem(lp)}},TN=yN;U();var{ID:up}=K.NEW_GAME,{FRAME:xN}=G.GAMEPLAY,{Dtos:{Player:SN},Utils:{Time:AN}}=Ludex,{player:TP}=codex,wN=class extends re{scene;constructor(e){super(e,xN.DEV_TOOL_NEW_GAME,25,25),this.scene=e,this.setAmount(999),this.onClick=this.handleUseItem}handleUseItem=()=>{let{itemManager:e}=this.scene;if(this.isActive){e.deactivateItem(up);return}if(!e.activeItem(up)){J.runTween(this.shakeAnimation.tween);return}this.useItem()};useItem=async()=>{await this.resetData();let{itemManager:e}=this.scene;e.deactivateItem(up)};resetData=async()=>{let e=SN.Data.getDefaultData();TP.setPlayerData(e),TP.syncDataToSDK(),await AN.sleepAsync(5e3),window.location.reload()}},CN=wN;U();var{ID:cp}=K.NEXT_LEVEL,{FRAME:PN}=G.GAMEPLAY,{event:RN,player:bN}=codex,IN=class extends re{scene;constructor(e){super(e,PN.DEV_TOOL_ARROW,25,25),this.scene=e,this.setAmount(999),this.onClick=this.handleUseItem}handleUseItem=()=>{let{itemManager:e}=this.scene;if(this.isActive){e.deactivateItem(cp);return}if(!e.activeItem(cp)){J.runTween(this.shakeAnimation.tween);return}this.useItem()};useItem=()=>{let{itemManager:e,levelHandler:t}=this.scene,{level:i}=t;bN.setGameData({level:i+1}),RN.emit(j.NEXT_LEVEL),e.deactivateItem(cp)}},_N=IN;U();var{ID:Lo}=K.OPEN_LUCKY_WHEEL,{FRAME:ON}=G.GAMEPLAY,MN=class extends re{scene;constructor(e){super(e,ON.DEV_TOOL_HAND,25,25),this.scene=e,this.setAmount(999),this.onClick=this.handleUseItem}handleUseItem=()=>{let{itemManager:e}=this.scene;if(this.isActive){e.deactivateItem(Lo);return}if(!e.activeItem(Lo)){J.runTween(this.shakeAnimation.tween);return}this.useItem()};useItem=()=>{let{itemManager:e}=this.scene;ot.openScreen(mt.REWARD_ITEM_SCREEN,{itemId:Lo,rewardCount:1}),e.deactivateItem(Lo)}},LN=MN;U();var{ID:dp}=K.RESET_DATA,{FRAME:DN}=G.GAMEPLAY,{player:kN}=codex,FN=class extends re{scene;isResetToDefault;constructor(e){super(e,DN.DEV_TOOL_RESET,25,25),this.scene=e,this.isResetToDefault=!1,this.setAmount(999),this.onClick=this.handleUseItem}handleUseItem=()=>{let{itemManager:e}=this.scene;if(this.isActive){e.deactivateItem(dp);return}if(!e.activeItem(dp)){J.runTween(this.shakeAnimation.tween);return}this.useItem()};useItem=async()=>{await this.resetData(),this.resetItems();let{itemManager:e}=this.scene;e.deactivateItem(dp)};resetData=async()=>{let e={...Lt.StartItems};if(!this.isResetToDefault)for(let t in e)e[t]=0;this.isResetToDefault=!this.isResetToDefault,await kN.setGameData({items:e})};resetItems(){let{itemManager:e}=this.scene;e.init(),e.start()}},NN=FN;U();var{ID:pp}=K.TIME_UP,{FRAME:BN}=G.GAMEPLAY,UN=class extends re{scene;constructor(e){super(e,BN.DEV_TOOL_CLOCK,25,25),this.scene=e,this.setAmount(999),this.onClick=this.handleUseItem}handleUseItem=()=>{let{itemManager:e}=this.scene;if(this.isActive){e.deactivateItem(pp);return}if(!e.activeItem(pp)){J.runTween(this.shakeAnimation.tween);return}this.useItem()};useItem=()=>{let{itemManager:e,layoutManager:t}=this.scene,{objects:i}=t;i.playtimeClock.startClock(0),e.deactivateItem(pp)}},GN=UN;U();var{event:gp}=codex,{ID:fp}=K.INVITE,{FRAME:xP}=G.GAMEPLAY,YN=class extends re{scene;constructor(e){super(e,xP.ITEM_SHARE,27,31),Phaser.Display.Align.In.Center(this.item,this,2,-2),this.scene=e,this.setName("InviteFriends"),this.amountText.setText("Invite"),this.onClick=this.handleUseItem}createAmountText(){super.createAmountText(),this.amountBg.setFrame(xP.NOTE_INVITE),this.amountBg.setWorldSize(42,16),this.amountText.setFontSize(11),Phaser.Display.Align.In.Center(this.amountText,this.amountBg),Phaser.Display.Align.In.TopCenter(this.amountItem,this.bg,2,-2)}handleUseItem=async()=>{let{itemManager:e}=this.scene;if(this.isActive){e.deactivateItem(fp);return}if(!e.activeItem(fp)){J.runTween(this.shakeAnimation.tween);return}try{await this.useItem()}catch{}};useItem=async()=>{let{itemManager:e}=this.scene;gp.emit(j.PAUSE);let t=await ht.startChallengeChooseOpponentAsync();gp.emit(j.RESUME),this.scene.time.delayedCall(500,()=>{e.deactivateItem(fp)}),t?gp.emit(j.REPLAY):ht.startSingleModeAsync()}},HN=YN;U(),U();var{KEY:zN,FRAME:WN}=G.GAMEPLAY,VN=class extends Phaser.GameObjects.Container{deathZone;emitter;constructor(e){super(e),this.createDeathZone(),this.createEmitters(),this.kill()}createDeathZone(){this.deathZone=new Phaser.Geom.Circle}createEmitters(){this.emitter=this.scene.add.particles(0,0,zN,{frame:WN.EFFECT_SPARK,speed:{min:20,max:500},scale:{start:1.33,end:0},deathZone:{source:this.deathZone,type:"onLeave"},tint:16259176,lifespan:200}),this.add(this.emitter)}explode(e,t,i,s){this.revive(),this.deathZone.radius=s,this.deathZone.setPosition(t,i),this.emitter.explode(e,t,i)}},XN=VN,{KEY:mp,FRAME:vp}=G.GAMEPLAY,KN=class extends Phaser.GameObjects.Container{process;minProcess;maxProcess;comboText;comboNumber;progressBox;circleLight;progressBar;comboParticle;circleLightTween;comboTextTween;progressAnimation;constructor(e){super(e),this.setSize(84,8),this.process=0,this.minProcess=0,this.maxProcess=1,this.createComboText(),this.createComboNumber(),this.createProgressBG(),this.createProgressBar(),this.createCircleLight(),this.createComboParticle(),this.createContainer()}setComboText(e){this.comboNumber.setText(`x${e}`),this.comboTextTween?.stop(),this.circleLightTween?.stop();let{x:t,y:i}=this.comboNumber;this.comboParticle.explode(15,t,i,45),this.circleLightTween=this.scene.add.tween({targets:[this.circleLight],duration:200,props:{alpha:{start:.5,to:0,ease:Phaser.Math.Easing.Expo.In},scale:{start:0,to:1.5,ease:Phaser.Math.Easing.Cubic.Out}}}),this.comboTextTween=this.scene.add.tween({targets:[this.comboNumber],duration:100,completeDelay:400,ease:Phaser.Math.Easing.Sine.In,props:{scale:{from:1,to:1.3}},onComplete:()=>{this.comboTextTween=this.scene.add.tween({targets:[this.comboNumber],duration:100,ease:Phaser.Math.Easing.Sine.Out,props:{scale:{start:1.3,to:1}}})}})}setProcess(e,t=!1){if(this.process=this.getCorrectValue(e),!this.scene||t){this.updateProcess();return}this.runProcessAnimation(e)}updateProcess(){let{height:e}=this.progressBar,t=this.getDisplayWidthByProcess(this.process);this.progressBar.setWorldSize(t,e)}getCorrectValue(e){let t=e;return isFinite(t)||(t=0),t<this.minProcess&&(t=this.minProcess),t>this.maxProcess&&(t=this.maxProcess),t}getDisplayWidthByProcess(e){let{width:t}=this;return(t-1)*e}runProcessAnimation(e){this.progressAnimation?.stop(),this.progressAnimation=this.scene.add.tween({targets:[this.progressBar],duration:100,ease:Phaser.Math.Easing.Quadratic.InOut,props:{displayWidth:()=>{let t=this.getCorrectValue(e);return this.getDisplayWidthByProcess(t)}},onUpdate:()=>{let{displayWidth:t,displayHeight:i}=this.progressBar;this.progressBar.setWorldSize(t,i)},onComplete:()=>{this.updateProcess()}})}createComboText(){this.comboText=X.createText(this.scene,"Combo",12),X.applyRedStyle(this.comboText),Phaser.Display.Align.In.Center(this.comboText,this,-17,-12)}createComboNumber(){this.comboNumber=X.createText(this.scene,"x1",16),X.applyRedStyle(this.comboNumber),this.comboNumber.setOrigin(.5,.9),Phaser.Display.Align.In.RightCenter(this.comboNumber,this.comboText,24,-2)}createCircleLight(){this.circleLight=this.scene.make.image({key:mp,frame:vp.EFFECT_CIRCLE}),this.circleLight.setTint(15677098),this.circleLight.setAlpha(0),Phaser.Display.Align.In.Center(this.circleLight,this.comboNumber)}createComboParticle(){this.comboParticle=new XN(this.scene),this.add(this.comboParticle)}createProgressBG(){this.progressBox=this.scene.make.image({key:mp,frame:vp.PROGRESS_BG_COMBO})}createProgressBar(){this.progressBar=this.scene.make.image({key:mp,frame:vp.PROGRESS_BAR_COMBO,origin:{x:0,y:.5}}),Phaser.Display.Align.In.LeftCenter(this.progressBar,this.progressBox,-1),this.setProcess(0)}createContainer(){this.add([this.progressBox,this.progressBar,this.comboText,this.comboNumber,this.circleLight,this.comboParticle]),this.circleLight.setDepth($.EFFECT),this.comboParticle.setDepth($.EFFECT),this.setDepth($.EFFECT),this.scene.add.existing(this)}},jN=KN;U();var{KEY:SP,FRAME:AP}=G.GAMEPLAY,ln={PLAY:"play",PAUSE:"pause"},ZN=class extends Phaser.GameObjects.Container{scene;clockBG;clockIcon;clockIconOriginScale;clockText;tickEvent;remainingTime;tickAnimation;tickEventRemainingTime;disable=!1;constructor(e){super(e),this.scene=e,this.state=ln.PAUSE,this.remainingTime=0,this.setWorldSize(75,34),this.createContents(),this.scene.add.existing(this)}createContents(){this.createClockBG(),this.createClockImage(),this.createClockText()}handleRescueTimeout=()=>{let e=this.scene,{levelHandler:t}=e,{time:i}=t.getConfigs(),s=this.remainingTime||0;this.startClock(Math.floor(i/2)+s)};startClock(e){this.state=ln.PLAY,this.tickEvent?.destroy(),this.remainingTime=e,this.setClockText(this.remainingTime),this.tickEvent=this.scene.time.addEvent({delay:1e3,callback:this.updateClock,callbackScope:this,loop:!0})}updateClock=()=>{if(this.scene.stateManager.isPlaying()){if(this.remainingTime<=31&&this.playNotifyAnimation(),this.remainingTime<=0){this.pauseClock(),this.scene.die("timeUp");return}this.remainingTime-=1,this.setClockText(this.remainingTime)}};setClockText(e){let t=Math.floor(e/60),i=e%60,s=t<10?`0${t}`:t,n=i<10?`0${i}`:i;this.clockText.setText(`${s}:${n}`)}pauseClock(){this.disable||this.state===ln.PAUSE||(this.stopNotifyAnimation(),this.state=ln.PAUSE,this.tickEvent&&(this.tickEventRemainingTime=1e3-this.tickEvent.getElapsed(),this.tickEvent.destroy()))}resumeClock(){this.disable||this.state===ln.PLAY||(this.state=ln.PLAY,this.tickEvent=this.scene.time.addEvent({delay:this.tickEventRemainingTime,callback:()=>{this.updateClock(),this.tickEvent=this.scene.time.addEvent({delay:1e3,callback:this.updateClock,callbackScope:this,loop:!0})},callbackScope:this}))}createClockBG(){this.clockBG=this.scene.make.image({key:SP,frame:AP.TIMER_BG,origin:{x:.5,y:.5}}),this.add(this.clockBG),this.clockBG.setPosition(0,0)}createClockText(){this.clockText=X.createText(this.scene,"00:00",12).setFontStyle("700").setTint(16763191),this.add(this.clockText);let{width:e}=this.clockText,t=e*.08;Phaser.Display.Align.In.Center(this.clockText,this.clockBG,t,.5)}createClockImage(){this.clockIcon=this.scene.make.image({key:SP,frame:AP.ICON_CLOCK}),this.add(this.clockIcon);let{width:e}=this.clockBG,{width:t}=this.clockIcon,i=t/2+e*.05;Phaser.Display.Align.In.LeftCenter(this.clockIcon,this.clockBG,i,-2),this.clockIconOriginScale=this.clockIcon.scaleX}getRemainingTime(){return this.remainingTime}playNotifyAnimation(){if(this.tickAnimation?.isPlaying())return;let e=15;this.tickAnimation?.stop(),this.tickAnimation=this.scene.tweens.chain({targets:this.clockIcon,loop:-1,tweens:[{targets:this.clockIcon,ease:Phaser.Math.Easing.Linear,props:{angle:{duration:100,start:0,to:e}}},{targets:this.clockIcon,ease:Phaser.Math.Easing.Linear,props:{scale:{duration:200,value:this.clockIconOriginScale*1.1}},yoyo:!0},{targets:this.clockIcon,ease:Phaser.Math.Easing.Linear,props:{angle:{duration:100,start:0,to:-e}}},{targets:this.clockIcon,ease:Phaser.Math.Easing.Linear,props:{scale:{duration:200,value:this.clockIconOriginScale*1.1}},yoyo:!0}]}),this.tickAnimation.play()}stopNotifyAnimation(){this.tickAnimation?.stop(),this.clockIcon.setScale(this.clockIconOriginScale),this.clockIcon.setAngle(0)}setDisable(e){this.disable=e}},qN=ZN;U();var{KEY:xr,FRAME:Sr}=G.GAMEPLAY,JN=class extends Phaser.GameObjects.Container{stars=[];process;minProcess;maxProcess;progressBox;progressBarLeft;progressBarBg;progressBarRight;progressAnimation;constructor(e){super(e),this.setWorldSize(165,30),this.process=0,this.minProcess=0,this.maxProcess=1,this.createProgressBox(),this.createProgressBar(),this.createStars(),this.createContainer()}setProcess(e,t=!1){if(this.process=this.getCorrectValue(e),this.updateStarVisibility(),!this.scene||t||!this.visible){this.updateProcess();return}this.runProcessAnimation(e)}updateProcess(){let{displayHeight:e}=this.progressBarBg,t=this.getDisplayWidthByProcess(this.process);this.progressBarBg.setWorldSize(t,e);let{x:i}=this.progressBarBg;this.progressBarRight.setX(i+t)}getCorrectValue(e){let t=e;return isFinite(t)||(t=0),t<this.minProcess&&(t=this.minProcess),t>this.maxProcess&&(t=this.maxProcess),t}getDisplayWidthByProcess(e){let{width:t}=this,i=(t-20)*e;return i<=0?.01:i}runProcessAnimation(e){this.progressAnimation?.stop(),this.progressAnimation=this.scene.add.tween({targets:[this.progressBarBg],duration:300,ease:Phaser.Math.Easing.Quadratic.InOut,props:{displayWidth:()=>{let t=this.getCorrectValue(e);return this.getDisplayWidthByProcess(t)}},onUpdate:()=>{let{x:t,displayWidth:i}=this.progressBarBg;this.progressBarRight.setX(t+i)},onComplete:()=>{this.updateProcess()}})}createProgressBox(){this.progressBox=this.scene.make.image({key:xr,frame:Sr.PROGRESS_STAR}),this.add(this.progressBox)}createProgressBar(){this.progressBarLeft=this.scene.make.image({key:xr,frame:Sr.PROGRESS_BAR_LEFT}),this.progressBarLeft.setOrigin(0,0),this.progressBarLeft.setWorldSize(6,12.5),this.progressBarRight=this.scene.make.image({key:xr,frame:Sr.PROGRESS_BAR_RIGHT}),this.progressBarRight.setOrigin(0,0),this.progressBarRight.setWorldSize(6,12.5),this.progressBarBg=this.scene.make.image({key:xr,frame:Sr.PROGRESS_BAR_MID}),this.progressBarBg.setOrigin(0,0),this.progressBarBg.setWorldSize(6,12.5);let e=-2,t=.5,i=-7.5;Phaser.Display.Align.In.LeftCenter(this.progressBarBg,this.progressBox,i,t),Phaser.Display.Align.In.LeftCenter(this.progressBarLeft,this.progressBox,e,t),Phaser.Display.Align.In.LeftCenter(this.progressBarRight,this.progressBox,i,t),this.setProcess(.01,!0)}createStars(){this.stars=[];for(let e=0;e<3;e++){let t=this.scene.make.image({key:xr,frame:Sr.ICON_STAR_BIG});t.y=0,t.setWorldSize(28,28),t.setVisible(!1),this.stars.push(t)}this.stars[0].x=7,this.stars[1].x=38,this.stars[2].x=67}updateStarVisibility(){if(this.stars.length!==0){if(this.process>=.92){this.stars[0].setVisible(!0),this.stars[1].setVisible(!0),this.stars[2].setVisible(!0);return}if(this.process>=.72){this.stars[0].setVisible(!0),this.stars[1].setVisible(!0),this.stars[2].setVisible(!1);return}if(this.process>=.52){this.stars[0].setVisible(!0),this.stars[1].setVisible(!1),this.stars[2].setVisible(!1);return}this.stars[0].setVisible(!1),this.stars[1].setVisible(!1),this.stars[2].setVisible(!1)}}getStarAmount(){return this.process>=.92?3:this.process>=.72?2:this.process>=.52?1:0}getStarFlyInPosition(){return this.process>=.72?this.stars[2].getWorldPosition():this.process>=.52?this.stars[1].getWorldPosition():this.stars[0].getWorldPosition()}createContainer(){this.add([this.progressBox,this.progressBarBg,this.progressBarLeft,this.progressBarRight]),this.add(this.stars),this.scene.add.existing(this)}},QN=JN;U();var $N=class{scene;group;constructor(e){this.scene=e,this.createGroup()}getAll(){return this.group.getChildren()}createGroup(){this.group=this.scene.add.group()}},wP=$N;U();var{Utils:{Number:CP}}=Ludex,{KEY:Do,FRAME:un}=G.CHALLENGE,t2=class Nr extends Phaser.GameObjects.Container{static AVATAR_SIZE=35;playerScore;playerAvatar;opponentScore;opponentAvatar;constructor(t){super(t),this.setWorldSize(190,50),this.createPlayerSide(),this.createOpponentSide(),this.createContainer()}setPlayerScore(t){let i=CP.getShortNumber(t,4);this.playerScore.setText(i)}setOpponentScore(t){let i=CP.getShortNumber(t,4);this.opponentScore.setText(i)}setPlayerInfo(t){let{id:i,score:s,photo:n=""}=t;this.playerAvatar.loadPhoto(i,n,20),s?this.setPlayerScore(s):this.playerScore.setText("0")}setOpponentInfo(t){let{id:i,score:s,photo:n=""}=t;this.opponentAvatar.loadPhoto(i,n,20),s?this.setOpponentScore(s):this.opponentScore.setText("0")}createPlayerSide(){let t=this.scene.make.image({key:Do,frame:un.SCORE_PANEL});Phaser.Display.Align.In.LeftCenter(t,this,0,0);let i={width:Nr.AVATAR_SIZE,height:Nr.AVATAR_SIZE,key:Do,background:un.AVATAR,frame:un.AVATAR_FRAME};this.playerAvatar=new ss(this.scene,i),Phaser.Display.Align.In.LeftCenter(this.playerAvatar,t,20,0),this.playerScore=X.createShadowText(this.scene,"0",22),this.playerScore.setTint(16636588),Phaser.Display.Align.In.Center(this.playerScore,t,5,2),this.add([t,this.playerAvatar,this.playerScore])}createOpponentSide(){let t=this.scene.make.image({key:Do,frame:un.SCORE_PANEL});Phaser.Display.Align.In.RightCenter(t,this,0,0);let i={width:Nr.AVATAR_SIZE,height:Nr.AVATAR_SIZE,key:Do,background:un.AVATAR,frame:un.AVATAR_FRAME};this.opponentAvatar=new ss(this.scene,i),Phaser.Display.Align.In.RightCenter(this.opponentAvatar,t,20,0),this.opponentScore=X.createShadowText(this.scene,"0",22),this.opponentScore.setTint(16636588),Phaser.Display.Align.In.Center(this.opponentScore,t,-5,2),this.add([t,this.opponentAvatar,this.opponentScore])}createContainer(){this.scene.add.existing(this)}},e2=t2;U();var{ID:PP}=K.NEW_GAME,{FRAME:i2}=G.GAMEPLAY,s2=class extends re{scene;constructor(e){super(e,i2.EFFECT_SPARK,25,25),this.scene=e,this.setAmount(999),this.onClick=this.handleUseItem}handleUseItem=()=>{let{itemManager:e}=this.scene;if(this.isActive){e.deactivateItem(PP);return}if(!e.activeItem(PP)){J.runTween(this.shakeAnimation.tween);return}this.useItem()};useItem=async()=>{this.scene.finishLevel(!0)}},n2=s2,{KEY:Ar,FRAME:wr}=G.GAMEPLAY,{KEY:RP,FRAME:bP}=G.DEFAULT,r2=class extends wP{scene;skipBtn;skipContainer;pauseButton;pauseNotification;headerBG;footerBG;levelText;topFooterBG;bottomFooterBG;playtimeClock;starProgressBar;comboProgressBar;challengeInfo;hintItem;rocketItem;inviteItem;shuffleItem;defuseItem;guideDefuseItem;superRocketItem;timeUp=null;winGame=null;newGame=null;resetData=null;backLevel=null;nextLevel=null;openLuckyWheel=null;autoMatch=null;changeColor=null;bombExplosive=null;constructor(e){super(e),this.scene=e,this.createObjects()}createObjects(){this.createHeaderBG(),this.createFooterBG(),this.createLevelText(),this.createSkipButton(),this.createPauseButton(),this.createPlaytimeClock(),this.createStarProgressBar(),this.createComboProgressBar(),this.createChallengeInfo(),this.createHintItem(),this.createRocketItem(),this.createInviteItem(),this.createDefuseItem(),this.createGuideDefuseItem(),this.createShuffleItem(),this.createSuperRocketItem(),this.createDevTools()}createHeaderBG(){this.headerBG=this.scene.make.image({key:Ar,frame:wr.LAYOUT_HEADER});let{width:e}=lt.getWorldSize();this.headerBG.setWorldSize(e),this.group.add(this.headerBG)}createFooterBG(){this.topFooterBG=this.scene.make.image({key:Ar,frame:wr.LAYOUT_FOOTER_TOP}),this.bottomFooterBG=this.scene.make.image({key:Ar,frame:wr.LAYOUT_FOOTER_BOTTOM}),this.group.add(this.topFooterBG),this.group.add(this.bottomFooterBG)}createLevelText(){this.levelText=X.createText(this.scene,"Lv 1",17),X.applyYellowStyle(this.levelText).setStroke("#784225",1.5).setShadowBlur(2),this.group.add(this.levelText)}createSkipButton(){this.skipContainer=this.scene.add.container(0,0),this.skipContainer.setDepth($.ON_TOP);let e=this.scene.make.image({key:RP,frame:bP.BUTTON_GREEN_SMALL_BG});e.setY(-1),this.skipContainer.add(e),this.skipBtn=new At(this.scene,RP,bP.BUTTON_GREEN_SMALL),this.skipBtn.setName("SkipGuide"),this.skipContainer.add(this.skipBtn);let t=X.createText(this.scene,"Skip",16).setOrigin(.5,.5);X.applyGreenStyle(t),t.setY(0),this.skipBtn.add(t),this.skipContainer.setWorldSize(63,20),this.skipContainer.kill(),this.group.add(this.skipContainer)}createPauseButton(){this.pauseButton=new At(this.scene,Ar,wr.BUTTON_YELLOW_CIRCLE),this.pauseButton.setName("Pause");let e=this.scene.make.image({key:Ar,frame:wr.ICON_PAUSE});this.pauseButton.add(e),this.pauseNotification=new Zw(this.scene,{isMinimized:!0}),this.pauseButton.add(this.pauseNotification),it.alignChildTopRight(this.pauseNotification,this.pauseButton,-7,-5),this.group.add(this.pauseButton)}createPlaytimeClock(){this.playtimeClock=new qN(this.scene),this.group.add(this.playtimeClock)}createStarProgressBar(){this.starProgressBar=new QN(this.scene),this.group.add(this.starProgressBar),this.starProgressBar.setVisible(!1)}createComboProgressBar(){this.comboProgressBar=new jN(this.scene),this.comboProgressBar.setAlpha(0),this.comboProgressBar.kill(),this.group.add(this.comboProgressBar)}createChallengeInfo(){this.challengeInfo=new e2(this.scene),this.group.add(this.challengeInfo)}createHintItem(){this.hintItem=new EP(this.scene),this.group.add(this.hintItem)}createShuffleItem(){this.shuffleItem=new yP(this.scene),this.group.add(this.shuffleItem)}createDefuseItem(){this.defuseItem=new Dd(this.scene),this.group.add(this.defuseItem)}createGuideDefuseItem(){this.guideDefuseItem=new dC(this.scene),this.guideDefuseItem.kill(),this.group.add(this.guideDefuseItem)}createRocketItem(){this.rocketItem=new Fd(this.scene),this.group.add(this.rocketItem)}createInviteItem(){this.inviteItem=new HN(this.scene),this.group.add(this.inviteItem)}createSuperRocketItem(){this.superRocketItem=new tn(this.scene),this.group.add(this.superRocketItem)}createDevTools(){Ludex.Utils.Valid.isDebugger()&&(this.createTimeUpItem(),this.createWinGameItem(),this.createNewGameItem(),this.createAutoMatchItem(),this.createResetDataItem(),this.createBackLevelItem(),this.createNextLevelItem(),this.createOpenLuckyWheelItem(),this.createChangeColorItem(),this.createBombExplosiveItem())}createWinGameItem(){this.winGame=new n2(this.scene),this.winGame.setScale(.7),this.group.add(this.winGame)}createNewGameItem(){this.newGame=new CN(this.scene),this.newGame.setScale(.7),this.group.add(this.newGame)}createChangeColorItem(){this.changeColor=new mC(this.scene),this.changeColor.setScale(.7),this.group.add(this.changeColor)}createResetDataItem(){this.resetData=new NN(this.scene),this.resetData.setScale(.7),this.group.add(this.resetData)}createBackLevelItem(){this.backLevel=new vN(this.scene),this.backLevel.setScale(.7),this.group.add(this.backLevel)}createNextLevelItem(){this.nextLevel=new _N(this.scene),this.nextLevel.setScale(.7),this.group.add(this.nextLevel)}createOpenLuckyWheelItem(){this.openLuckyWheel=new LN(this.scene),this.openLuckyWheel.setScale(.7),this.group.add(this.openLuckyWheel)}createBombExplosiveItem(){this.bombExplosive=new TN(this.scene),this.bombExplosive.setScale(.7),this.group.add(this.bombExplosive)}createTimeUpItem(){this.timeUp=new GN(this.scene),this.timeUp.setScale(.7),this.group.add(this.timeUp)}createAutoMatchItem(){this.autoMatch=new cN(this.scene),this.autoMatch.setScale(.7),this.group.add(this.autoMatch)}playPauseNotification(){this.pauseNotification.playAlertAnimation()}stopPauseNotification(){this.pauseNotification.stopAlertAnimation()}},a2=r2;U(),U(),U();var o2=class{scene;objects;allUI;groups;constructor(e){this.scene=e,this.objects=null,this.createGroups()}setUIObjects(e){this.objects=e,this.allUI.addMultiple(this.objects.getAll())}createGroups(){this.groups={},this.allUI=this.scene.add.group(),this.groups.allUI=this.allUI}killAllUI(){this.allUI.killGroup()}reviveAllUI(){this.allUI.reviveGroup()}},IP=o2,{DefuseItemGuideLevel:h2}=Lt,{Utils:{Valid:l2}}=Ludex,u2=class extends IP{objects;itemUI;gameUI;guideUI;debugUI;constructor(e){super(e),this.objects=null}alignUI(){if(this.objects===null)return;let{headerBG:e,topFooterBG:t,bottomFooterBG:i,levelText:s,skipContainer:n}=this.objects,{pauseButton:r,playtimeClock:o,starProgressBar:a,comboProgressBar:h,challengeInfo:l}=this.objects,{gameZone:u}=this.scene,d=pt.getBannerHeight();Phaser.Display.Align.In.TopCenter(e,u),Phaser.Display.Align.In.BottomCenter(i,u,0,-d+i.height),Phaser.Display.Align.In.TopCenter(t,i,0,t.height-20),Phaser.Display.Align.In.TopRight(n,u,-35,-55),Phaser.Display.Align.In.TopRight(h,u,-20,-80),Phaser.Display.Align.In.Center(l,e,19,-7),Phaser.Display.Align.In.LeftCenter(o,e,-17,-7),Phaser.Display.Align.In.RightCenter(r,e,-8,-7),Phaser.Display.Align.In.Center(s,e,-70,-7),Phaser.Display.Align.In.Center(a,e,45,-7),this.alignItems(),this.alignDebugItems()}alignItems(){let{objects:e}=this;if(!e)return;let{topFooterBG:t}=e,{itemUI:i}=this.groups,{level:s}=this.scene.levelHandler.getConfigs(),{defuseItem:n,guideDefuseItem:r,superRocketItem:o}=e,a=i.getChildren().filter(l=>l.visible),h=!this.scene.tutorialManager.isBombDefuseTutorialShown()&&s===h2;h&&r.setScale(1);for(let l of a)l.setScale(1);h&&a.unshift(r),it.alignChildrenContainer(a,{width:t.width-90,x:t.x-24,y:t.y}),h&&r.setPosition(n.x,n.y),o.setRechargeNotificationLayout("portrait")}alignDebugItems(){if(!l2.isDebugger()||this.objects===null)return;let{debugUI:e}=this.groups,{gameZone:t}=this.scene;e.reviveGroup(),Phaser.Actions.GridAlign(e.getChildren(),{width:1,cellWidth:40,cellHeight:40,x:-t.width/2,y:-t.height/2+50})}createGroups(){super.createGroups(),this.itemUI=this.scene.add.group(),this.gameUI=this.scene.add.group(),this.debugUI=this.scene.add.group(),this.itemUI.setDepth($.ITEM),this.groups.itemUI=this.itemUI,this.groups.gameUI=this.gameUI,this.groups.debugUI=this.debugUI}setUIObjects(e){super.setUIObjects(e),this.addUIObjectsToGroups()}addUIObjectsToGroups(){this.objects!==null&&(this.addObjectsForItem(),this.addObjectsForGame(),this.addObjectsForDebug())}addObjectsForItem(){this.objects!==null&&this.groups.itemUI.addMultiple([this.objects.defuseItem,this.objects.hintItem,this.objects.rocketItem,this.objects.shuffleItem,this.objects.superRocketItem,this.objects.inviteItem])}addObjectsForGame(){this.objects!==null&&this.groups.gameUI.addMultiple([this.objects.levelText,this.objects.pauseButton,this.objects.playtimeClock,this.objects.challengeInfo,this.objects.starProgressBar,...this.groups.itemUI.getChildren()])}addObjectsForDebug(){if(this.objects===null)return;let{changeColor:e,winGame:t,newGame:i,resetData:s,autoMatch:n,backLevel:r,nextLevel:o,timeUp:a,bombExplosive:h,openLuckyWheel:l}=this.objects,u=[e,t,i,s,n,r,o,a,h,l].filter(d=>d!==null);this.groups.debugUI.addMultiple(u),this.groups.debugUI.killGroup()}},_P=u2,{DefuseItemGuideLevel:c2}=Lt,d2=class extends _P{alignUI(){if(this.objects===null)return;super.alignUI();let{gameZone:e}=this.scene,{topFooterBG:t,headerBG:i,pauseButton:s,playtimeClock:n,skipContainer:r,levelText:o,starProgressBar:a,comboProgressBar:h,challengeInfo:l}=this.objects;Phaser.Display.Align.In.TopRight(t,i,-26,16),Phaser.Display.Align.In.TopRight(s,i,-30,-5),Phaser.Display.Align.In.LeftCenter(n,i,-30,-5),Phaser.Display.Align.In.TopCenter(r,e,200,-45),Phaser.Display.Align.To.RightCenter(o,n,20,0),Phaser.Display.Align.To.RightCenter(a,o,30,0),Phaser.Display.Align.In.Center(h,t,60,60),Phaser.Display.Align.In.Center(l,i,0,-7);let u=lt.getWorldSize().width;i.setWorldSize(u,65),this.alignItems()}alignItems(){let{objects:e}=this;if(!e)return;let{itemUI:t}=this.groups,{pauseButton:i,guideDefuseItem:s,defuseItem:n,superRocketItem:r}=e,o=this.scene;if(!(o instanceof YP))return;let{level:a}=o.levelHandler.getConfigs(),h=t.getMatching("visible",!0).reverse(),l=!o.tutorialManager.isBombDefuseTutorialShown()&&a===c2;l&&(h.push(n),s.setScale(.85)),Phaser.Actions.SetXY(h,i.x-70,i.y+3,-60);for(let u of h)u.setScale(.85);l&&s.setPosition(n.x,n.y),r.setRechargeNotificationLayout("landscape")}},p2=d2;U();var{STATUS:Ep}=iC,g2=class extends Ne{scene;layout;objects;constructor(e){super(e),this.scene=e,this.createObjects(),this.createLayouts()}init(){this.initUILogic(),this.layout.alignUI(),this.setState(Ep.READY)}start(){this.isRunning()||(this.updateUIState(),this.setState(Ep.RUNNING))}stop(){this.isRunning()&&this.setState(Ep.STOPPED)}handleResize=()=>{this.layout.alignUI()};handleLayoutChange=()=>{this.createLayouts(),this.layout.setUIObjects(this.objects),this.layout.alignUI()}},OP=g2,{event:MP}=codex,f2=class extends OP{scene;groups;constructor(e){super(e),this.scene=e,this.bh(),this.registerEvents()}registerEvents(){MP.on(yt.VIEW_RESIZED,this.handleResize),MP.on(yt.LAYOUT_CHANGED,this.handleLayoutChange)}createObjects(){this.objects=new a2(this.scene)}createLayouts(){lt.isLandscape()?this.layout=new p2(this.scene):this.layout=new _P(this.scene),this.layout.setUIObjects(this.objects)}bh(){this.groups=this.layout.groups}init(){this.scene.uiManager.handleHeaderAndFooterResize(),this.layout.alignUI(),this.setState(ns.STATUS.READY)}start(){this.isRunning()||(this.updateUIState(),this.setState(ns.STATUS.RUNNING))}stop(){this.isRunning()&&this.setState(ns.STATUS.STOPPED)}handleResize=()=>{this.scene.uiManager.handleHeaderAndFooterResize(),this.layout.alignUI()};handleLayoutChange=()=>{this.createLayouts(),this.handleResize()};initUILogic(){}updateUIState(){}},m2=f2;U();var v2=class extends Ne{scene;Ei;fe;ds;at;constructor(e){super(e),this.scene=e,this.Ei=0,this.fe=0,this.ds=0,this.at=0}init(){this.at=0,this.fe=0}start(){if(this.isRunning())return;super.start();let{level:e}=this.scene.levelHandler;this.ds=e,this.fe=this.scene.getSceneData().score??0,this.bt()}stop(){this.isRunning()&&(super.stop(),this.mi())}getScore(){return this.fe}getBestScore(){return this.Ei}bt(){this.scene.events.on(zd.ADD,this.Gn)}mi(){this.scene.events.off(zd.ADD,this.Gn)}Gn=e=>{this.at=this.scene.comboManager.getCombo();let t=e*this.ds*this.at;this.fe+=t,this.Ei=Math.max(this.Ei,this.fe)}},E2=v2;U(),U(),U();var y2=class{game;manager;constructor(e){this.game=e.getGame(),this.manager=e,this.logDebug()}logDebug(){let e=this.constructor.name}},Cr=y2,{player:LP,analytics:T2}=codex,x2=class extends Cr{enter(){this.enterAsync()}async enterAsync(){try{await this.loadLevel(),this.game.initManager(),this.loadUI(),this.logLevelStartAnalytics(),this.ready()}catch{}}async loadLevel(){let e=ht.isTournamentMode(),t=ht.getMatchLevel();t===void 0&&(t=e?2:Ii.getLevelProgress()),e||this.game.setSceneData({score:0}),LP.isFirstSession()&&t<1&&(t=1,LP.setGameData({level:2})),this.game.levelHandler.init(t)}loadUI(){let{layoutManager:e,uiManager:t,tutorialManager:i,levelHandler:s,tileManager:n}=this.game,{groups:r,objects:o}=e,{level:a}=s;r.gameUI.reviveGroup(),this.game.uiManager.showUIByMatchMode(),t.updateLevel(a),o.starProgressBar.setProcess(0),o.playtimeClock.startClock(s.getConfigs().time),o.playtimeClock.pauseClock(),i.checkIsValidForTutorial()&&t.showUIForGuide(),e.layout.alignItems(),this.game.startManager(),n.hideHintEffect()}logLevelStartAnalytics(){let{level:e=1}=ht.getMatchCustomData()??{},t=ht.getMatchMode()??void 0,i=this.game.scoreManager.getScore();T2.levelStart(e,i,t)}initialize(){}ready(){nt.playSound(ut.LEVEL_START),nt.playMusic();let e=this.manager.createReadyState(this.manager);this.manager.change(e)}playing(){}fail(){}finish(){}},yp=x2;U();var{Utils:{Time:S2},Plugins:{Ads:{Types:A2}}}=Ludex,{storage:w2,player:C2,event:P2,analytics:R2}=codex,{DelayEndGame:b2}=Lt,I2=class extends Cr{reason;constructor(e,t){super(e),this.reason=t}enter(){this.enterAsync()}async enterAsync(){try{let{tileManager:e,itemManager:t,uiManager:i}=this.game;if(e.isSelectable=!1,e.removeSuggestPairHint(),t.setIsUseableItem(!1),i.disablePause(),this.updateMatchData(),this.logLevelFailAnalytics(),await S2.sleepAsync(b2),ht.isTournamentMode()){await this.processFinishTournament();return}if(ht.isChallengeMode()){await this.processFinishChallenge();return}if(ht.isSingleMode()){await this.processFinishSingle();return}}catch{}}updateMatchData(){if(!this.game)return;let{scoreManager:e}=this.game,t=C2.getPlayerId(),i=e.getScore();!t||!i||ht.setProfileMatchDataAsync({id:t,score:i})}logLevelFailAnalytics(){let{mode:e,customData:{level:t=1}}=ht.getMatchState(),i=this.game.scoreManager.getScore();R2.levelFail(t,i,e??"Unknown")}async processFinishTournament(){if(!await ht.finishTournamentAsync())return;w2.setStorageData("Tournament","showResult",!0);let{tournamentId:e=""}=ht.getMatchCustomData()??{};e&&It.switchToDashboardScene()}async processFinishChallenge(){await ht.finishChallengeModeAsync()&&P2.emit(j.SHOW_RESULT_CHALLENGE_SCREEN)}async processFinishSingle(){let{tileManager:e,levelHandler:t}=this.game,{level:i}=t;nt.pauseMusic(),pt.isReadyAdShowable(A2.REWARDED_VIDEO)?(e.hideAllTiles(),ot.openScreen(mt.CONTINUE_SCREEN,{level:i,reason:this.reason})):ot.openScreen(mt.RESCUE_SCREEN,{level:i,reason:this.reason})}initialize(){let e=this.manager.createInitializeState(this.manager);this.manager.change(e)}ready(){let e=this.manager.createReadyState(this.manager);this.manager.change(e)}playing(){}fail(){}finish(){}},DP=I2;U();var{Utils:{Time:kP},Configs:{Gameplay:_2},Plugins:{Ads:O2}}=Ludex,{DelayLevelUp:M2}=Lt,{player:L2,event:Tp,leaderboard:D2,analytics:k2}=codex,F2=class extends Cr{isAdReady;enter(){this.isAdReady=this.isInterstitialAdReady(),this.enterAsync()}async enterAsync(){try{let{effectManager:e,levelHandler:t}=this.game,{level:i}=t;if(this.handleFinishUI(),this.updateMission(),this.updateMatchData(),this.updateSceneData(),this.logLevelCompleteAnalytics(),i===1){Tp.emit(j.NEXT_LEVEL);return}if(await kP.sleepAsync(M2),this.isAdReady&&nt.setVolumeMusic(0,!0),await new Promise(s=>{e.playFlyingStarFromClockEffect(s)}),ht.isTournamentMode()){try{ot.showLoadingScreen(),await this.handlePostTournamentScore()}catch{}finally{ot.closeLoadingScreen(),Tp.emit(j.NEXT_LEVEL)}return}await this.handleShowResult()}catch{}}disableCurrentGameplayNotification(){ge.setGameplayPauseNotificationFlag(!1,3),ge.setPauseScreenNotificationFlag(!1)}handleFinishUI(){let{uiManager:e,layoutManager:t,tileManager:i}=this.game,{objects:s}=t;e.disablePause(),i.removeSuggestPairHint(),s.playtimeClock.pauseClock(),s.starProgressBar.setProcess(1)}logLevelCompleteAnalytics(){let{mode:e,customData:{level:t=1}}=ht.getMatchState(),i=this.game.scoreManager.getScore();k2.levelComplete(t,i,e??"Unknown")}updateMission(){kt.addFinishLevelMissionProgress(1).isMissionFinished||this.disableCurrentGameplayNotification(),ge.clearGameplayPauseGracePeriod()}updateMatchData(){if(!this.game)return;let{scoreManager:e}=this.game,t=L2.getPlayerId(),i=e.getScore();!t||!i||ht.setProfileMatchDataAsync({id:t,score:i})}updateSceneData(){this.game&&this.game.setSceneData({score:this.game.scoreManager.getScore()})}async handlePostTournamentScore(){if(!this.game)return;let e=this.game?.scoreManager.getScore();if(!e)return;try{await GameSDK.tournament.postScoreAsync(e)}catch{}let t=ht.getMatchCustomData();if(!t)return;let{leaderboardId:i,playerId:s}=t;!i||!s||await D2.setLeaderboardScoreAsync(i,s,e)}async handleShowResult(){let{layoutManager:e,levelHandler:t,comboManager:i}=this.game,s=await this.handleShowInterstitialAd()?0:1e3;if(await kP.sleepAsync(s),this.isAdReady||nt.setMinVolumeMusic(),i.stop(),ht.isChallengeMode())await this.showChallengeResultScreen();else{let{starProgressBar:n}=e.objects,{level:r}=t,o=n.getStarAmount();await this.showResultScreen(o,r)}}showChallengeResultScreen=async()=>{await ht.finishChallengeModeAsync()&&Tp.emit(j.SHOW_RESULT_CHALLENGE_SCREEN)};showResultScreen=async(e,t)=>{ot.openScreen(mt.RESULT_SCREEN,{eatStars:e,level:t})};async handleShowInterstitialAd(){if(!this.isAdReady)return!1;try{return await pt.showInterstitialAdAsync(),!0}catch{return!1}finally{nt.setMinVolumeMusic()}}isInterstitialAdReady(){let{level:e}=this.game.levelHandler;return!(e<_2.StartAdAtLevel||!pt.isReadyAdShowable(O2.Types.INTERSTITIAL))}initialize(){let e=this.manager.createInitializeState(this.manager);this.manager.change(e)}ready(){}playing(){}fail(){}finish(){}},FP=F2;U();var N2=class extends Cr{enter(){this.startCountdown()}startCountdown(){let{objects:e}=this.game.layoutManager,{playtimeClock:t}=e;t.resumeClock()}initialize(){let e=this.manager.createInitializeState(this.manager);this.manager.change(e)}ready(){}playing(){}fail(e){let t=this.manager.createFailState(this.manager,e);this.manager.change(t)}finish(){let e=this.manager.createFinishState(this.manager);this.manager.change(e)}},NP=N2;U();var B2=class extends Cr{enter(){}initialize(){let e=this.manager.createInitializeState(this.manager);this.manager.change(e)}ready(){}playing(){let e=this.manager.createPlayingState(this.manager);this.manager.change(e)}fail(){}finish(){let e=this.manager.createFinishState(this.manager);this.manager.change(e)}},BP=B2,U2=class{it;Yn;getGame(){return this.Yn}init(e){this.Yn=e,this.it=new yp(this),this.it.enter()}change(e){this.it=e,this.it.enter()}initialize(){this.it.initialize()}isInitialize(){return this.it instanceof yp}ready(){this.it.ready()}isReady(){return this.it instanceof BP}playing(){this.it.playing()}isPlaying(){return this.it instanceof NP}fail(e){this.it.fail(e)}isFail(){return this.it instanceof DP}finish(){this.it.finish()}isFinished(){return this.it instanceof FP}createInitializeState(...e){return new yp(...e)}createReadyState(...e){return new BP(...e)}createPlayingState(...e){return new NP(...e)}createFailState(...e){return new DP(...e)}createFinishState(...e){return new FP(...e)}},G2=U2,{Plugins:{Ads:{Types:Y2},Analytics:{Events:H2}},Utils:{Valid:z2,Time:W2},Events:V2}=Ludex,{player:UP,analytics:GP,event:ye}=codex,{StartScore:X2,DelayStart:K2}=Lt,j2=class extends hr{gameStatus;ps=0;currentScore=0;isSuperRocketUsed=!1;isReachTargetScore=!1;levelHandler;uiManager;tileManager;modeManager;itemManager;boardManager;scoreManager;comboManager;effectManager;layoutManager;tutorialManager;animationManager;stateManager;gs;fs;preload(){this.events.on(Phaser.Scenes.Events.WAKE,this.Hn),this.events.on(Phaser.Scenes.Events.CREATE,this.Hn),this.events.on(Phaser.Scenes.Events.SLEEP,this.Ih)}create=()=>{super.create(),this.gs=0,this.fs=0,this.createBackground(Xt.BACKGROUND.KEY),this.Oh(),this.Mh(),this.bt()};Oh(){this.levelHandler=new yD(this)}Mh(){this.layoutManager=new m2(this),this.animationManager=new oL(this),this.tileManager=new hk(this),this.modeManager=new xD(this),this.itemManager=new pD(this),this.boardManager=new NL(this),this.scoreManager=new E2(this),this.comboManager=new aN(this),this.effectManager=new nN(this),this.tutorialManager=new Gk(this),this.stateManager=new G2,this.uiManager=new Vk(this)}initManager(){this.uiManager.init(),this.boardManager.init(),this.tileManager.init(),this.modeManager.init(),this.itemManager.init(),this.scoreManager.init(),this.comboManager.init(),this.effectManager.init(),this.tutorialManager.init(),this.animationManager.init(),this.layoutManager.init()}stopManager(){this.uiManager.stop(),this.boardManager.stop(),this.tileManager.stop(),this.modeManager.stop(),this.itemManager.stop(),this.scoreManager.stop(),this.comboManager.stop(),this.effectManager.stop(),this.tutorialManager.stop(),this.animationManager.stop(),this.layoutManager.stop()}startManager(){this.boardManager.start(),this.tileManager.start(),this.modeManager.start(),this.itemManager.start(),this.scoreManager.start(),this.comboManager.start(),this.effectManager.start(),this.tutorialManager.start(),this.animationManager.start(),this.uiManager.start(),this.layoutManager.start()}bt(){ye.on(j.REPLAY,this.zn),ye.on(j.RESCUE,this.Wn),ye.on(j.CONTINUE,this.Lh),ye.on(j.NEXT_LEVEL,this.Dh),ye.on(j.RECEIVE_ITEM,this.kh),ye.on(j.PAUSE,this.Fh),ye.on(j.RESUME,this.Vn),ye.on(j.SHOW_RESULT_CHALLENGE_SCREEN,this.Nh),ye.off(yt.LAYOUT_CHANGED,this.handleResize),ye.on(yt.LAYOUT_CHANGED,this.Bh),this.events.on(tt.EVENTS.INTERACTION,this.Uh)}Hn=async()=>{ye.emit(V2.SCENE_LOADED,{sceneName:this.scene.key}),await this.Gh(),await this.Yh(),this.stateManager.init(this),this.ms(),pt.preloadAdsByType(Y2.INTERSTITIAL)};async Gh(){ht.getMatchMode()||await ht.startSingleModeAsync()}async Yh(){ht.isTournamentMode()&&(kt.addJoinTournamentMissionProgress(1),this.getSceneData()?.isFromLoader&&await ht.setMatchCustomDataAsync({level:2}))}async ms(){UP.getPlayerSetting("music")&&nt.setDefaultVolumeMusic(),this.gs=Date.now(),this.ps=X2,this.currentScore=0,this.vs(this.ps),this.stateManager.initialize()}vs(e){this.currentScore=e;let{targetScore:t}=this.levelHandler;if(this.isReachTargetScore=this.currentScore>=t,ht.isChallengeMode()){let i=this.scoreManager.getScore(),{objects:s}=this.layoutManager;s.challengeInfo.setPlayerScore(i)}}eatScore=e=>{if(!this.stateManager.isPlaying())return;this.currentScore+=e;let{targetScore:t}=this.levelHandler,{objects:i}=this.layoutManager;i.starProgressBar.setProcess(this.currentScore/t),this.vs(this.currentScore)};die=e=>{if(!this.stateManager.isPlaying())return;let{objects:t}=this.layoutManager;t.playtimeClock.pauseClock(),this.events.emit(tt.EVENTS.PAUSE_BOMB_TIMER),ye.emit(j.DIE),this.stateManager.fail(e)};Wn=e=>{let{mode:t,customData:{level:i=1}}=ht.getMatchState();if(GP.levelRescue(i,this.currentScore,t??"Unknown"),this.uiManager.enablePause(),nt.playSound(ut.LEVEL_START),nt.playMusic(),nt.setDefaultVolumeMusic(),W2.sleepAsync(K2/2).then(()=>{this.tileManager.isSelectable=!0,this.itemManager.setIsUseableItem(!0)}),!z2.isObject(e))return;let{objects:s}=this.layoutManager;s.playtimeClock.handleRescueTimeout(),this.tileManager.handleBombTimerRescue(),this.stateManager.ready()};Lh=e=>{this.Wn(e)};finishLevel=(e=!1)=>{!e&&this.stateManager.isFinished()||(this.stateManager.finish(),ye.emit(j.FINISH),this.fs=Date.now(),this.ps=this.currentScore,this.vs(this.currentScore))};zn=async()=>{this.isSuperRocketUsed===!0&&(this.isSuperRocketUsed=!1,this.itemManager.resetSuperRocketUsage()),await this.Hh(),this.stopManager(),this.ms()};Hh=async()=>{if(ht.isTournamentMode())try{ot.showLoadingScreen(),this.setSceneData({score:0}),await ht.setMatchCustomDataAsync({level:2})}catch{}finally{ot.closeLoadingScreen()}};Dh=async()=>{if(ht.isChallengeMode()){this.finishLevel(!0);return}ht.isSingleMode()&&await ht.finishSingleModeAsync(),this.levelHandler.up(),ht.isSingleMode()&&(UP.setGameData({level:this.levelHandler.level}),await ht.startSingleModeAsync()),ht.isTournamentMode()&&(ot.showLoadingScreen(),await ht.setMatchCustomDataAsync({level:this.levelHandler.level}),ot.closeLoadingScreen()),this.stopManager(),this.ms()};kh=e=>{let{itemId:t,rewardCount:i}=e;this.itemManager.addItemAmount(t,i),GP.event(H2.EARN_ITEM,{item_name:t,value:i})};Fh=()=>{let{objects:e}=this.layoutManager;e.playtimeClock.pauseClock(),this.tileManager.hideAllTiles(),this.tileManager.hideHintEffect(),this.events.emit(tt.EVENTS.PAUSE_BOMB_TIMER)};Vn=()=>{if(this.tileManager.showAllTiles(),this.tileManager.showHintEffect(),!this.stateManager.isPlaying())return;let{objects:e}=this.layoutManager;e.playtimeClock.resumeClock(),this.events.emit(tt.EVENTS.RESUME_BOMB_TIMER)};Ih=()=>{this.stopManager(),pt.hideBannerAds()};getPlayedTimeSeconds(){return Math.floor((this.fs-this.gs)/1e3)}Uh=()=>{this.stateManager.playing()};Nh=()=>{let{customData:e,profiles:t}=ht.getMatchState(),{playerId:i,opponentId:s}=e;if(!i||!s)return;let n=t[i],r=t[s],o={playerId:i,opponentId:s,playerAvatar:n.photo,opponentAvatar:r.photo,playerScore:n.score,opponentScore:r.score};ye.emit(j.PAUSE),ot.openScreen(mt.RESULT_CHALLENGE_FRIEND_SCREEN,o)};getSceneData(){return this.data.get("data")}setSceneData(e){let t={...this.data.get("data"),...e};this.data.set("data",t)}Bh=e=>{this.handleResize(e),!this.stateManager.isFinished()&&(ot.closeScreen(mt.CONTINUE_SCREEN),ot.closeScreen(mt.RESCUE_SCREEN),ot.closeScreen(mt.PAUSE_SCREEN),this.Vn(),this.zn())}},YP=j2,Pr=YP;U(),U();var xp={repeat:3,duration:33,ease:Phaser.Math.Easing.Linear,props:{y:5},yoyo:!0},Z2=class{targetY;shakeAmount;tween;constructor(e,t,i){let{endY:s,amount:n}=i,r=n?s+n:s+xp.props.y,o={...xp.props,y:r},a={...xp,targets:t,props:o,onRepeat:this.handleSwitchPosition,onRepeatScope:this};this.tween=e.tweens.create(a),this.targetY=s,this.shakeAmount=r-this.targetY}handleSwitchPosition(){this.shakeAmount*=-.7,this.tween.updateTo("y",this.targetY+this.shakeAmount)}},q2=Z2;U();var{KEY:J2,FRAME:Q2}=G.EFFECTS,{Object:$2}=Ludex.Utils,tB=class extends Phaser.GameObjects.Container{emitter;emitZone;constructor(e,t){super(e),this.createEmitZone(),this.setDepth($.ON_TOP),this.createExplodeAnimation(t),this.scene.add.existing(this)}createEmitZone(){this.emitZone=new Phaser.Geom.Circle(0,0,25)}createExplodeAnimation(e){let t=lt.getZoomRatio(),i={frame:[`${Q2.ANIMATION_STAR_X}1`],active:!1,scale:{start:1.5/t,end:2/t,random:!0},lifespan:{min:600,max:1200},alpha:{start:.5,end:1},speed:{min:50,max:60},rotate:{start:0,end:360},tint:[16777215,16776960,16750848],emitZone:{source:this.emitZone,type:"random"},particleClass:eB};e&&(i=$2.merge(i,e)),this.emitter=this.scene.add.particles(0,0,J2,i),this.add(this.emitter)}explode(e,t,i){return this.emitter.active=!0,this.emitter.explode(e,t,i)}},eB=class extends Phaser.GameObjects.Particles.Particle{constructor(e){super(e);let t=Math.random()*.18+.01;this.data={tint:{min:16777215,max:16777215},alpha:{min:1,max:1},rotate:{min:0,max:0},scaleX:{min:1,max:t},scaleY:{min:1,max:1}}}fire(e,t){let i=e??0,s=t??0;super.fire(i,s);let{x:n,y:r}=this.emitter;e||(i=n),t||(s=r);let o=Phaser.Math.Distance.Between(0,0,this.velocityX,this.velocityY),a=Math.atan2(this.y-s,this.x-i);return this.velocityX=o*Math.cos(a),this.velocityY=o*Math.sin(a),this.rotation=a,!0}update(e,t,i){return super.update(e,t,i)}},iB=tB;U();var{KEY:sB,FRAME:nB}=G.EFFECTS,{Object:AY}=Ludex.Utils,rB=class extends Phaser.GameObjects.Container{config;emitZone;emitter;constructor(e,t){super(e),this.config=t||{},this.createEmitZone(),this.createEmitters(),this.scene.add.existing(this)}createEmitZone(){this.emitZone=new Phaser.Geom.Rectangle}createEmitters(){let e={frame:nB.FX_STAR_YELLOW,emitZone:{source:this.emitZone,type:"random"},timeScale:1,frequency:150,speedY:{min:-20,max:-60},alpha:{start:1,end:0,ease:Phaser.Math.Easing.Cubic.Out},scale:{start:1,end:0,ease:Phaser.Math.Easing.Cubic.Out},lifespan:{min:1500,max:2500},...this.config};this.emitter=this.scene.add.particles(0,0,sB,e),this.add(this.emitter)}run(e,t,i,s,n){this.stop(),this.emitZone.setSize(s,n),this.emitZone.setPosition(t-s/2,i-n/2),this.emitter.setQuantity(e),this.emitter.start()}stop(){this.emitter?.killAll(),this.emitter?.stop()}explode(){this.emitter.explode(100,0,0)}},aB=rB;U();var{KEY:HP,FRAME:zP}=G.DEFAULT,oB=class extends to{text1;icon;x2;text2;constructor(e,t,i){super(e,t,i),this.createAdsICon(),this.createTexts()}createAdsICon(){let e=this.scene.make.image({key:HP,frame:zP.ICON_ADS});e.setPosition(-60,0),this.content.add(e),this.icon=e}createTexts(){let e=X.createText(this.scene,"Get",22);X.applyGreenStyle(e),e.setX(-7),this.content.add(e),this.text1=e;let t=this.scene.make.image({key:HP,frame:zP.X2});t.setWorldSize(40,25),t.setPosition(50,0),this.content.add(t),this.x2=t;let i=X.createText(this.scene,"CONTINUE",20);X.applyGreenStyle(i),this.content.add(i),this.text2=i}setMode(e){e==="item"?(this.text1.revive(),this.icon.revive(),this.x2.revive(),this.text2.kill()):(this.text1.kill(),this.icon.kill(),this.x2.kill(),this.text2.revive())}},hB=oB;U(),U(),U();var{KEY:hs,FRAME:ls}=G.EFFECTS,lB={CONFETTI_HEXAGON:{KEY:"confetti-hexagon-animation",TEXTURE:hs,PREFIX:ls.FX_CONFETTI_HEXAGON,FRAME_RATE:8,END:5,ZERO_PAD:0},CONFETTI_STAR_X:{KEY:"confetti-star-x",TEXTURE:hs,PREFIX:ls.ANIMATION_STAR_X,FRAME_RATE:4,END:4,ZERO_PAD:0},CONFETTI_STAR_Y:{KEY:"confetti-star-y",TEXTURE:hs,PREFIX:ls.ANIMATION_STAR_Y,FRAME_RATE:4,END:4,ZERO_PAD:0},RIBBON_A:{KEY:"animation-ribbon-a",TEXTURE:hs,PREFIX:ls.PREFIX_ANIMATION_RIBBON_CONFETTI_A,FRAME_RATE:16,END:3,ZERO_PAD:0},RIBBON_B:{KEY:"animation-ribbon-b",TEXTURE:hs,PREFIX:ls.PREFIX_ANIMATION_RIBBON_CONFETTI_B,FRAME_RATE:16,END:4,ZERO_PAD:0},RIBBON_C:{KEY:"animation-ribbon-c",TEXTURE:hs,PREFIX:ls.PREFIX_ANIMATION_RIBBON_CONFETTI_C,FRAME_RATE:16,END:4,ZERO_PAD:0},RIBBON_D:{KEY:"animation-ribbon-d",TEXTURE:hs,PREFIX:ls.PREFIX_ANIMATION_RIBBON_CONFETTI_D,FRAME_RATE:16,END:4,ZERO_PAD:0}},_t=lB,{KEY:uB,TEXTURE:cB,FRAME_RATE:dB,END:pB,PREFIX:gB,ZERO_PAD:fB}=_t.RIBBON_A,mB=class extends Phaser.Animations.Animation{constructor(e){let t={repeat:-1,frameRate:dB,frames:e.generateFrameNames(cB,{prefix:gB,end:pB,zeroPad:fB,start:1}),yoyo:!0,showOnStart:!0};super(e,uB,t)}},vB=mB;U();var{KEY:EB,TEXTURE:yB,FRAME_RATE:TB,END:xB,PREFIX:SB,ZERO_PAD:AB}=_t.RIBBON_B,wB=class extends Phaser.Animations.Animation{constructor(e){let t={repeat:-1,frameRate:TB,frames:e.generateFrameNames(yB,{prefix:SB,end:xB,zeroPad:AB,start:1}),yoyo:!0,showOnStart:!0};super(e,EB,t)}},CB=wB;U();var{KEY:PB,TEXTURE:RB,FRAME_RATE:bB,END:IB,PREFIX:_B,ZERO_PAD:OB}=_t.RIBBON_C,MB=class extends Phaser.Animations.Animation{constructor(e){let t={repeat:-1,frameRate:bB,frames:e.generateFrameNames(RB,{prefix:_B,end:IB,zeroPad:OB,start:1}),yoyo:!0,showOnStart:!0};super(e,PB,t)}},LB=MB;U();var{KEY:DB,TEXTURE:kB,FRAME_RATE:FB,END:NB,PREFIX:BB,ZERO_PAD:UB}=_t.RIBBON_D,GB=class extends Phaser.Animations.Animation{constructor(e){let t={repeat:-1,frameRate:FB,frames:e.generateFrameNames(kB,{prefix:BB,end:NB,zeroPad:UB,start:1}),yoyo:!0,showOnStart:!0};super(e,DB,t)}},YB=GB;U();var{KEY:HB,TEXTURE:zB,FRAME_RATE:WB,END:VB,PREFIX:XB,ZERO_PAD:KB}=_t.CONFETTI_STAR_X,jB=class extends Phaser.Animations.Animation{constructor(e){let t={repeat:-1,frameRate:WB,frames:e.generateFrameNames(zB,{prefix:XB,end:VB,zeroPad:KB,start:1}),yoyo:!0,showOnStart:!0};super(e,HB,t)}},ZB=jB;U();var{KEY:qB,TEXTURE:JB,FRAME_RATE:QB,END:$B,PREFIX:tU,ZERO_PAD:eU}=_t.CONFETTI_STAR_Y,iU=class extends Phaser.Animations.Animation{constructor(e){let t={repeat:-1,frameRate:QB,frames:e.generateFrameNames(JB,{prefix:tU,end:$B,zeroPad:eU,start:1}),showOnStart:!0};super(e,qB,t)}},sU=iU;U();var nU=class extends Phaser.GameObjects.Particles.Particle{ribbon;graphics;colorUse;lastChange;currentFrame;isYoyo;isGravityChanged;points;constructor(e){super(e);let{x:t,y:i}=this.emitter;this.points=new Array(10).fill(null).map(()=>({x:this.x+t,y:this.y+i})),this.isYoyo=!1,this.isGravityChanged=!1,this.lastChange=0,this.currentFrame=-1,this.createGraphics(),this.randomRibbonUsedWhenFall()}randomRibbonUsedWhenFall(){switch(Phaser.Math.Between(0,3)){case 0:this.ribbon=this.scene.anims.get(_t.RIBBON_A.KEY);break;case 1:this.ribbon=this.scene.anims.get(_t.RIBBON_B.KEY);break;case 2:this.ribbon=this.scene.anims.get(_t.RIBBON_C.KEY);break;case 3:this.ribbon=this.scene.anims.get(_t.RIBBON_D.KEY);break;default:this.ribbon=this.scene.anims.get(_t.RIBBON_A.KEY);break}}setRibbonPosition(e,t){this.points.map(i=>{i.x=e,i.y=t})}createGraphics(){let e=[8443204,2928867,12013036,16376097,15285798];this.colorUse=e[Phaser.Math.Between(0,e.length-1)],this.graphics=this.scene.add.graphics({lineStyle:{width:3,color:this.colorUse}});let{x:t,y:i,depth:s}=this.emitter;this.graphics.setDepth(s),this.graphics.setPosition(t,i),this.emitter.parentContainer.add(this.graphics)}update(e,t,i){let s=super.update(e,t,i);return this.updateFrames(e),this.updatePoints(),this.updateGraphics(),this.updateGravity(),this.updateVelocity(),this.updateColor(),s}updateFrames(e){this.lastChange+=e,this.lastChange>=this.ribbon.msPerFrame&&(this.isYoyo?this.currentFrame--:this.currentFrame++,this.currentFrame<0&&(this.isYoyo=!1,this.currentFrame=1),this.currentFrame>=this.ribbon.frames.length&&(this.isYoyo=!0,this.currentFrame-=1),this.frame=this.ribbon.frames[this.currentFrame].frame,this.lastChange-=this.ribbon.msPerFrame)}updatePoints(){this.graphics.visible&&(this.points.shift(),this.points.push({x:this.x,y:this.y}))}updateGraphics(){this.graphics.visible&&(this.graphics.clear(),this.graphics.strokePoints(this.points))}updateGravity(){this.lifeCurrent>this.life-2e3||this.isGravityChanged||(this.isGravityChanged=!0,this.graphics.destroy(),this.emitter.setVisible(!0),this.emitter.setParticleGravity(0,45))}updateVelocity(){if(this.graphics.visible){if(this.lifeCurrent>this.life-1800){this.velocityX+=Phaser.Math.Between(-12,12);return}this.velocityX>0?this.velocityX+=Phaser.Math.Between(-10,6):this.velocityX+=Phaser.Math.Between(-6,10)}}updateColor(){this.graphics.visible||(this.tint=this.colorUse)}},rU=nU;U();var aU=class extends Phaser.GameObjects.Particles.Particle{isYoyo;isGravityChanged;lastChange;currentFrame;star;starX;starY;constructor(e){super(e),this.isYoyo=!1,this.isGravityChanged=!1,this.lastChange=0,this.currentFrame=-1,this.starX=this.scene.anims.get(_t.CONFETTI_STAR_X.KEY),this.starY=this.scene.anims.get(_t.CONFETTI_STAR_Y.KEY),this.star=this.starX}update(e,t,i){let s=super.update(e,t,i);return this.updateGravity(),this.updateVelocity(),this.updateFrameRate(),this.updateFrames(e),s}updateGravity(){this.lifeCurrent>this.life-2e3||this.isGravityChanged||(this.isGravityChanged=!0,this.emitter.setParticleGravity(0,15),this.emitter.setParticleSpeed(0))}updateVelocity(){this.lifeCurrent>this.life-2e3||(this.velocityX>0?this.velocityX+=Phaser.Math.Between(-6,3):this.velocityX+=Phaser.Math.Between(-3,6))}updateFrames(e){if(this.lastChange+=e,this.lastChange>=this.star.msPerFrame){let t=Phaser.Math.RND.between(0,1);this.star=t>0?this.starX:this.starY,this.isYoyo?this.currentFrame--:this.currentFrame++,this.currentFrame<0&&(this.isYoyo=!1,this.currentFrame=1,this.emitter.setAlpha(1)),this.currentFrame>=this.star.frames.length&&(this.isYoyo=!0,this.currentFrame-=1,this.emitter.setAlpha(.8)),this.frame=this.star.frames[this.currentFrame].frame,this.lastChange-=this.star.msPerFrame}}updateFrameRate(){this.lifeCurrent<this.life-2e3?this.star.msPerFrame=150:this.star.msPerFrame=Phaser.Math.RND.between(300,600)}},oU=aU,{KEY:ko,FRAME:WP}=G.EFFECTS,hU=class extends Phaser.GameObjects.Container{emitterConfetti;emitterRibbons;ribbonConfig;confettiConfig;constructor(e){super(e),this.emitterRibbons=[],this.emitterConfetti=[],this.createConfigs(),this.createAnimations(),this.scene.add.existing(this)}createConfigs(){let e=[8443204,2928867,12013036,16376097,15285798];this.ribbonConfig={duration:100,visible:!1,timeScale:1.5,frame:WP.BLANK,particleBringToTop:!0,speedY:{min:-480,max:-560},gravityY:290,lifespan:{min:4e3,max:6e3},rotate:{start:0,end:360*5,random:!0},scale:{min:.6,max:1},particleClass:rU};let t=WP.PREFIX_ANIMATION_RIBBON_CONFETTI_A;this.confettiConfig={duration:100,delay:200,timeScale:2,tint:e,particleBringToTop:!0,frame:`${t}1`,speedY:{min:-460,max:-580},gravityY:280,lifespan:{min:5e3,max:8e3},rotate:{start:0,end:360*3},scale:{min:.6,max:1},particleClass:oU}}createAnimations(){if(!this.scene.anims.get(_t.CONFETTI_STAR_X.KEY)){let e=new ZB(this.scene.anims);this.scene.anims.add(_t.CONFETTI_STAR_X.KEY,e)}if(!this.scene.anims.get(_t.CONFETTI_STAR_Y.KEY)){let e=new sU(this.scene.anims);this.scene.anims.add(_t.CONFETTI_STAR_Y.KEY,e)}if(!this.scene.anims.get(_t.RIBBON_A.KEY)){let e=new vB(this.scene.anims);this.scene.anims.add(_t.RIBBON_A.KEY,e)}if(!this.scene.anims.get(_t.RIBBON_B.KEY)){let e=new CB(this.scene.anims);this.scene.anims.add(_t.RIBBON_B.KEY,e)}if(!this.scene.anims.get(_t.RIBBON_C.KEY)){let e=new LB(this.scene.anims);this.scene.anims.add(_t.RIBBON_C.KEY,e)}if(!this.scene.anims.get(_t.RIBBON_D.KEY)){let e=new YB(this.scene.anims);this.scene.anims.add(_t.RIBBON_D.KEY,e)}}run(e,t,i,s){this.setPosition(e,t),this.width=i,this.height=s,this.createEmitters();for(let n of this.emitterConfetti)n.emitParticle(25);for(let n of this.emitterRibbons)n.emitParticle(20)}stop(){for(let e of this.emitterConfetti)e.killAll();for(let e of this.emitterRibbons)e.killAll();this.kill()}createEmitters(){this.emitterRibbons=[],this.emitterConfetti=[],this.createConfettiLeftEmitter(),this.createConfettiRightEmitter(),this.createRibbonLeftEmitter(),this.createRibbonRightEmitter()}createConfettiLeftEmitter(){let{height:e}=this,t=e/667*1.1,i={...this.confettiConfig,speedX:{min:5,max:90},speedY:{min:-460*t,max:-580*t},gravityY:280*t},s=this.scene.add.particles(0,0,ko,i);this.add(s),this.emitterConfetti.push(s)}createConfettiRightEmitter(){let{width:e,height:t}=this,i=t/667*1.1,s={...this.confettiConfig,speedX:{min:-5,max:-90},speedY:{min:-460*i,max:-580*i},gravityY:280*i},n=this.scene.add.particles(e,0,ko,s);this.add(n),this.emitterConfetti.push(n)}createRibbonLeftEmitter(){let{height:e}=this,t=e/667*1.1,i={...this.ribbonConfig,speedX:{min:20,max:80},speedY:{min:-480*t,max:-560*t},gravityY:290*t},s=this.scene.add.particles(0,0,ko,i);this.add(s),this.emitterRibbons.push(s)}createRibbonRightEmitter(){let{width:e,height:t}=this,i=t/667*1.1,s={...this.ribbonConfig,speedX:{min:-20,max:-80},speedY:{min:-480*i,max:-560*i},gravityY:290*i},n=this.scene.add.particles(e,0,ko,s);this.add(n),this.emitterRibbons.push(n)}},lU=hU,{KEY:ei,FRAME:ii}=G.DEFAULT,{KEY:uU,FRAME:Rr}=G.GAMEPLAY,cU=class extends Phaser.GameObjects.Container{t;kt;tt=[];Xn=0;jt;button;_t;wt;ot;Es;Zt;Kn;Ct;zh;onGreenClick;onGetContinueClick;me;Ne=[];qt=[];ve;constructor(e){super(e),this.$(),this.Wh(),this.Be(),this.Vh(),this.Xh(),this.Kh(),this.Wi(),this.jh(),this.Zh(),this.ys(),this.qh(),this.Jh(),this.setDepth($.POPUP),this.scene.add.existing(this)}Jh(){this.me=new lU(this.scene),this.me.setDepth($.ON_TOP),this.add(this.me),this.ve=new aB(this.scene,{scale:{start:.5,end:0,ease:Phaser.Math.Easing.Cubic.Out}}),this.ve.setDepth($.EFFECT),this.add(this.ve)}Xh(){for(let e=0;e<3;e++){let t=new iB(this.scene);this.Ne.push(t)}this.add(this.Ne)}$(){this.t=this.scene.make.image({key:ei,frame:ii.POPUP}),this.add(this.t)}Be(){let e=this.scene.make.image({key:ei,frame:ii.RESULT_RIBBON});e.setPosition(0,-40),this.add(e),this.kt=e}Vh(){let e=this.scene.make.image({key:ei,frame:ii.ART_WHITE_GLOW});e.setScale(e.scale*2),e.setPosition(0,-70),this.add(e),this.Zt=e,e.kill()}Kh(){let e=this.scene.make.image({key:ei,frame:ii.RESULT_STAR});e.setPosition(-85,-60),e.setAngle(-12),this.tt.push(e);let t=this.scene.make.image({key:ei,frame:ii.RESULT_STAR});t.setPosition(0,-70),t.setAngle(0),this.tt.push(t);let i=this.scene.make.image({key:ei,frame:ii.RESULT_STAR});i.setPosition(85,-60),i.setAngle(12),this.tt.push(i),this.add([e,i,t])}Wh(){let{width:e,height:t}=this.t;this.setSize(e,t)}Wi(){this.jt=X.createText(this.scene,"Level 1",20),X.applyWarningStyle(this.jt),this.add(this.jt)}jh(){let e=this.scene.make.image({key:ei,frame:ii.VICTORY});e.setPosition(0,-152),this.add(e)}Zh(){this.button=new hB(this.scene,ei,ii.BUTTON_GREEN),this.button.onClick=this.Qh;let e=this.scene.make.image({key:ei,frame:ii.BUTTON_FRAME});this.button.add(e),this.button.moveTo(e,0),this.add(this.button),Phaser.Display.Align.In.BottomCenter(this.button,this.t,0,-30)}ys(){this.wt=this.scene.make.container({}),this.add(this.wt),this.wt.setPosition(0,50);let e=this.scene.make.image({key:ei,frame:ii.ART_WHITE_GLOW});e.setPosition(-15,0),this.wt.add(e),this.Ct=e;let t=this.scene.make.image({key:uU,frame:Rr.BLANK});t.setPosition(-17,0),this.wt.add(t),this.ot=t;let i=X.createStrokeText(this.scene,"+1",22);i.setOrigin(.5,.57),i.setPosition(17,0),this.wt.add(i)}qh(){this._t=new Rd(this.scene,"Get & Continue",16),this._t.setAlpha(.8),this._t.onClick=this.$h,this._t.kill(),Phaser.Display.Align.In.BottomCenter(this._t,this.t,0,40),this.add(this._t)}setLevel(e,t="normal"){this.jt.setText(`Level ${e}`),t==="mini"?this.jt.setPosition(0,-5):this.jt.setPosition(0,40)}setStars(e){this.Xn=e}setItem(e){if(this.Es!==e){switch(this.Es=e,e){case"defuse":this.ot.setFrame(Rr.DEFUSE_ITEM);break;case"hint":this.ot.setFrame(Rr.HINT_ITEM);break;case"shuffle":this.ot.setFrame(Rr.ITEM_SHUFFLE);break;case"rocket":this.ot.setFrame(Rr.ROCKET_ITEM);break;case"none":this.wt.kill()}e!=="none"?this.button.setMode("item"):this.button.setMode("continue")}}Qh=()=>{this.onGreenClick&&this.onGreenClick()};$h=()=>{this.onGetContinueClick&&this.onGetContinueClick()};playAnimation(e=0){this.tl(e)}tl(e){for(let u of this.qt)u.stop();this.qt=[],this.Zt.kill(),this.ve.stop();let t=e;this.tt.forEach((u,d)=>{if(d>=this.Xn){u.kill();return}u.revive()}),this.tt[0].setAngle(-10),this.tt[1].setAngle(0),this.tt[2].setAngle(10);let i=this.Ts(this.tt[0],t,200,400,366,"-=10","+=10"),s=this.Ts(this.tt[1],t+166,200,233,566,"+=0","+=0"),n=this.Ts(this.tt[2],t+333,200,100,466,"+=10","-=10");this.qt?.push(i,s,n),this.Ee(t,400,this.tt[0],.1,1,Phaser.Math.Easing.Sine.In,()=>{nt.playSound(ut.PROGRESS_STAR,{volume:.7})}),this.Ee(t+166,366,this.tt[1],.1,1,Phaser.Math.Easing.Sine.In),this.Ee(t+333,200,this.tt[2],.1,1,Phaser.Math.Easing.Sine.In),this.Ee(t+400,400,this.tt[0],1,.5,Phaser.Math.Easing.Cubic.In,void 0,()=>{let{x:u,y:d}=this.tt[0];this.Ne[0].explode(50,u,d)}),this.Ee(t+533,266,[this.tt[1],this.tt[2]],1,.5,Phaser.Math.Easing.Cubic.In,void 0,()=>{let{x:u,y:d}=this.tt[1];this.Ne[1].explode(50,u,d);let{x:p,y:g}=this.tt[2];this.Ne[2].explode(50,p,g);let c=new q2(this.scene,[this.kt],{endY:this.kt.y,amount:5});J.runTween(c.tween),this.el(),nt.playSound(ut.THREE_STARS,{volume:.5})}),this.Ee(t+800,166,this.tt,.5,.6,void 0,void 0,()=>{nt.playSound(ut.LEVEL_COMPLETE,{volume:.8})});let r=966,o=[this.jt],a=this.Es!=="none",h=[{targets:o,delay:r+t,duration:800,props:{scale:{start:0,to:1,ease:Phaser.Math.Easing.Elastic.Out}},easeParams:[.1,.45]}];if(a?(this._t.revive(),this.wt.revive(),this.Ct.kill(),h.push({targets:this.wt,duration:800,props:{scale:{start:0,to:1,ease:Phaser.Math.Easing.Elastic.Out}},easeParams:[.1,.45],onStart:()=>{nt.playSound(ut.HINT_ITEM,{volume:1.5})}})):(this._t.kill(),this.wt.kill()),h.push({targets:[this.button],duration:800,props:{scale:{start:0,to:1,ease:Phaser.Math.Easing.Elastic.Out}},easeParams:[.1,.45],onComplete:()=>{this.runContinueButtonAnimation()}}),a){let u=this.scene.tweens.add({targets:this._t,delay:r+t+1600,duration:300,props:{scale:{start:0,to:1}}});this.qt.push(u),u.play()}let l=this.scene.tweens.chain({targets:o,tweens:h});l.play(),this.qt.push(l)}Ee(e,t,i,s,n,r,o,a){this.scene.tweens.add({targets:i,duration:t,delay:e,props:{scale:{start:s,to:n}},ease:r,onStart:o,onComplete:a})}Ts(e,t,i,s,n,r,o){let a=this.scene.tweens.chain({targets:e,tweens:[{delay:t,duration:i,props:{angle:"-=15"}},{delay:s,duration:s,props:{angle:"+=15"}},{delay:n,duration:1300,props:{angle:r,scale:"+=0.1"}},{targets:e,duration:2333,props:{angle:o,scale:"-=0.1"},yoyo:!0,repeat:-1,ease:Phaser.Math.Easing.Sine.InOut}]});return a.play(),a}el(){let e=this.Zt.scale;this.Zt.revive(),this.Zt.setScale(0),this.scene.tweens.add({targets:this.Zt,scale:{from:0,to:e},duration:500,ease:Phaser.Math.Easing.Sine.Out}),this.Kn=this.scene.tweens.add({targets:this.Zt,rotation:{from:0,to:Math.PI*2},duration:5e3,repeat:-1}),this.ve.run(2,this.x,this.y-20,300,100),this.il()}il(){let{displayWidth:e,displayHeight:t}=this.scene.gameZone;this.me.setVisible(!0),this.me.run(-e/2,t/2,e,t)}stopAnimation(){this.Kn?.remove(),this.zh?.remove(),this.ve.stop(),this.me.setVisible(!1),this.button.stopHighlightAnimation(),this.button.setScale(1);for(let e of this.qt)e.stop();this.qt=[]}runContinueButtonAnimation(){this.button.playHighlightAnimation()}},dU=cU,{analytics:pU,event:gU}=codex,{Plugins:{Analytics:{Events:fU}}}=Ludex,{RewardItemResultPopupRatio:mU,DefuseItemGuideLevel:vU,RocketItemGuideLevel:EU}=Lt,yU=class extends ue{t;Jt="none";xs;constructor(e,t){super(e,t),this.$(),this.setDepth(me.POPUP)}open=e=>{super.open(e),this.Vi(),nt.setMinVolumeMusic(),this.et()};Vi(){let e=this.getData("level"),t=this.getData("eatStars"),i=e||1;this.t.setStars(t||0);let s=Math.random();if(this.sl(),s>mU){this.Jt="none",this.t.setItem("none"),this.t.setLevel(i,"normal");return}this.t.setLevel(i,"mini");let n=["ItemHint","ItemShuffle"],r=["hint","shuffle"],o=[.54,1];e>=vU&&(n.push("ItemBombDefuse"),r.push("defuse"),o=[.4,.73,1]),e>=EU&&(n.push("ItemRocket"),r.push("rocket"),o=[.29,.54,.74,1]);let a=Math.random(),h=o.findIndex(d=>a<=d),l=n[h],u=r[h];this.Jt=l,this.t.setItem(u)}sl(){let e=It.getCurrentScene();if(!(e instanceof Pr))return;e.isSuperRocketUsed=!1;let{itemManager:t}=e;t.reduceSuperRocketCountdown()}$(){this.t=new dU(this.scene),this.add(this.t),this.t.onGreenClick=this.nl,this.t.onGetContinueClick=this.jn,Phaser.Display.Align.In.Center(this.t,this.zone,0,-50)}nl=async()=>{if(this.Jt==="none")this.jn();else try{await this.Rt()}catch{}};jn=()=>{this.Zn(1),this.qn()};async qn(){this.Jt!=="none"&&pU.event(fU.GET_FREE_ITEM,{item_name:this.Jt,value:this.xs}),this.t.stopAnimation(),await this.l(),ot.closeScreen(this.name),gU.emit(j.NEXT_LEVEL)}Rt=async()=>{try{await pt.showRewardVideoAdAsync()?(nt.playSound(ut.DAILY_REWARD),this.Zn(2),this.qn()):this.t.runContinueButtonAnimation()}catch{this.t.runContinueButtonAnimation()}};Zn(e){if(this.Jt==="none")return;this.xs=e;let t=It.getCurrentScene();if(!(t instanceof Pr))return;let{itemManager:i}=t;i.increaseItem(this.Jt,this.xs)}et(){this.background.setAlpha(0),this.animateBackgroundAlpha(.6),this.ft(0,300),this.t.playAnimation(300)}ft(e,t){let i=pt.getBannerHeight()/2,s=this.scene.tweens.add({...se,targets:[this.t],delay:e,duration:t,props:{...se.props,y:{from:350-i,to:-i},alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:1}}});J.runTween(s)}async ht(e,t){let i=pt.getBannerHeight()/2,s=this.scene.tweens.add({...Nt,targets:[this.t],delay:e,duration:t,props:{...Nt.props,y:250-i,scale:0},pause:!0});await J.runTweenAsync(s)}async l(){await Promise.all([this.animateBackgroundAlpha(0,200),this.ht(0,200)])}},TU=yU;U(),U();var{KEY:xU,FRAME:SU}=G.TUTORIAL,{Utils:{Device:AU}}=Ludex,wU=class extends Phaser.GameObjects.Container{hand;constructor(e){super(e),this.name="TapTutorialHand",this.addHand(),this.scene.add.existing(this)}addHand(){this.hand=this.scene.make.image({key:xU,frame:SU.HAND,origin:{x:.5,y:.5}}),this.add(this.hand)}playAnimation(e=0,t=800){let i=1/AU.pixelRatio();this.hand.angle=30,this.scene?.tweens.add({delay:e,targets:[this.hand],ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{start:0,value:1,duration:200},scale:{duration:400,start:i*1.6,to:i*1.2},angle:{from:30,value:0,duration:400}},onComplete:()=>{this.scene?.tweens.add({targets:[this.hand],delay:200,duration:200,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:0},onComplete:()=>{this.hand.x=0,this.hand.y=0,this.hand.scale=i,this.playAnimation(t)}})}})}stopAnimation(){this.scene.tweens.killTweensOf(this.hand)}preDestroy(){this.scene.tweens.killTweensOf(this.hand)}},VP=wU,{player:XP}=codex,{DEFAULT:Di,DASHBOARD:KP}=G,CU=class extends ue{Tt;t;Ue;mt;Ge;q;Ye;Pt;Ct;vt;Qt;Ss;p=null;Lt=[];constructor(e,t){super(e,t),this.setDepth(me.POPUP),this.$(),this.He(),this.De(),this.As()}open=e=>{super.open(e),e?.coinBar instanceof ao&&(this.p=e.coinBar),this.ws(),this.et()};handleDailyRewardsUIChange(){let{lastReceiveGift:e=0}=XP.getGameData()||{};if(this.isSameDay(e,Date.now())){this.Ye.kill(),this.q.revive(),this.q.setDisabled(!1);return}this.Ye.revive(),this.q.kill()}isSameDay(e,t){let i=new Date(e),s=new Date(t);return i.toDateString()===s.toDateString()}ne=()=>{this.Qt?.stop(),this.l()};Rt=async()=>{try{if(this.q.setDisabled(!0),!await pt.showRewardVideoAdAsync())return;this.re(500),this.ne()}catch{}finally{this.q.setDisabled(!1)}};et(){this.Tt.kill(),this.vt.setActive(!0),this.vt.setVisible(!0),this.background.setAlpha(0),this.animateBackgroundAlpha(.8),this.Wt(100,400),this.rl()}rl(){this.p&&this.p.bringThisToTop()}al(){this.p&&this.p.revertDepth()}l=()=>{this.animateBackgroundAlpha(0,200),this.Cs(0,200)};re(e){if(!this.p)return;nt.playSound(ut.DAILY_REWARD);let t=this.p.getWorldPosition(),i=this.q.getWorldPosition(),s=this.Re().explode(10,i.x,i.y,t.x,t.y);for(let n of s)n.on(Phaser.Tweens.Events.TWEEN_COMPLETE,()=>{let r=Math.floor(e/10);$i.addCoin(r)})}Wt(e,t){this.q.setDisabled(!0),this.handleDailyRewardsUIChange();let i=this.scene.tweens.add({...we,targets:this.vt.getChildren(),duration:t,delay:this.scene.tweens.stagger(100,{start:e}),props:{scale:{getStart:s=>s===this.mt||s===this.Ue?1:.7,getEnd:s=>1},alpha:{start:0,from:0,to:1}},onComplete:()=>{this.q.setDisabled(!1)}});J.runTween(i)}Cs(e,t){let i=this.scene.tweens.add({...Nt,targets:this.getAll(),delay:e,duration:t});J.runTweenAsync(i).then(()=>{this.mt.setText(""),this.al(),ot.closeScreen(this.name)})}Re(){let e=this.Lt.find(i=>!i.isActive);if(e)return e;let t=new Cd(this.p?.scene??this.scene);return this.Lt.push(t),t}De(){this.Tt=new VP(this.scene),this.add(this.Tt)}As(){this.vt=this.scene.make.group({}),this.vt.addMultiple([this.t,this.Ct,this.Ue,this.Ge,this.mt,this.q,this.Ye,this.Pt])}$(){this.t=this.scene.add.container(0,0),this.t.setWorldSize(283,345.5),this.add(this.t),this.ol(),this.Ps(),this.Rs(),this.bs(),this.hl(),this.It();let e=pt.getBannerHeight()/2;Phaser.Display.Align.In.Center(this.t,this.zone,0,-e)}ol(){this.Ct=this.scene.make.image({key:Di.KEY,frame:Di.FRAME.ART_YELLOW_GLOW}),this.t.add(this.Ct);let e=this.scene.make.image({key:KP.KEY,frame:KP.FRAME.ICON_COIN});e.setSize(150,150),this.t.add(e),it.alignChildCenter(e,this.t,0,-75),this.Ct.setPosition(e.x,e.y),this.Ue=e}Ps(){let e=X.createText(this.scene,"x500",24).setFontStyle("700").setShadow(0,3,"#000000",.5);this.t.add(e),it.alignChildCenter(e,this.t,0,-30),this.Ge=e}Rs(){let e=X.createText(this.scene,"",20);this.t.add(e),it.alignChildCenter(e,this.t,0,10),this.mt=e}bs(){let e=new At(this.scene,Di.KEY,Di.FRAME.BUTTON_GREEN);e.setName("Ads");let t=this.scene.make.image({key:Di.KEY,frame:Di.FRAME.ICON_ADS});Phaser.Display.Align.In.Center(t,e),t.setX(e.x-50),e.add(t);let i=X.createText(this.scene,"Get Now",18).setFontStyle("900");X.applyGreenStyle(i),e.add(i),Phaser.Display.Align.In.Center(i,e,10,0),it.alignChildCenter(e,this.t,0,110),this.t.add(e),this.q=e,e.onClick=this.Rt}hl(){let e=new At(this.scene,Di.KEY,Di.FRAME.BUTTON_GREEN);e.setName("Claim");let t=X.createText(this.scene,"Claim",18).setFontStyle("900");X.applyGreenStyle(t),e.add(t),Phaser.Display.Align.In.Center(t,e,0,0),it.alignChildCenter(e,this.t,0,110),this.t.add(e),this.Ye=e,e.onClick=()=>{XP.setGameData({lastReceiveGift:Date.now()}),this.re(500),this.Ye.kill(),this.q.revive(),this.q.setDisabled(!1)}}It(){this.Pt=new Rd(this.scene,"Close",16),this.Pt.setName("Close"),this.Pt.setButtonHitSoundEffect(ut.CLOSE_POPUP_CLICK),this.t.add(this.Pt),Phaser.Display.Align.To.BottomCenter(this.Pt,this.q,0,0),this.Pt.onClick=this.ne}He(){this.Ss=new ur(this.scene),this.Ss.run(2,0,-140,180,180),this.t.add(this.Ss)}ws(){this.Qt?.stop(),this.Ct.angle=0,this.Ct.setPosition(this.Ue.x,this.Ue.y),this.Qt=this.scene.tweens.add({targets:this.Ct,angle:360,duration:5e3,repeat:-1,ease:"Linear"})}},PU=CU;U(),U(),U();var RU=oh(rw()),bU=(0,RU.default)(.55,.47,.43,.91),IU=bU,_U={yoyo:!0,repeat:-1,duration:600,repeatDelay:50,ease:IU,easeParams:[0,.9]};U();var{KEY:OU,FRAME:MU}=G.EFFECTS,LU=class extends Phaser.GameObjects.Container{emitZone;emitter;constructor(e){super(e),this.createEmitZone(),this.createEmitters(),this.scene.add.existing(this)}createEmitZone(){this.emitZone=new Phaser.Geom.Rectangle}createEmitters(){this.emitter=this.scene.add.particles(0,0,OU,{frame:MU.FX_COMET,emitZone:{source:this.emitZone,type:"random"},deathZone:{source:this.emitZone,type:"onLeave"},timeScale:1,frequency:150,speedY:{min:-20,max:-60},alpha:{start:1,end:0,ease:Phaser.Math.Easing.Cubic.Out},scale:{start:1,end:0,ease:Phaser.Math.Easing.Cubic.Out},lifespan:{min:1500,max:2500}}),this.add(this.emitter)}run(e,t,i,s,n){this.stop(),this.emitZone.setSize(s,n),this.emitZone.setPosition(t-s/2,i-n/2),this.emitter.setQuantity(e),this.emitter.start()}stop(){this.emitter?.killAll(),this.emitter?.stop()}},DU=LU;U();var kU=class extends Phaser.GameObjects.Container{isClicked=!1;scaleUp=1;scaleDown=.985;button;isUsePixelPerfect=!1;hitArea;hitZone;constructor(e,t,i,s,n,r=!1){super(e),this.name="OpenGift",this.isUsePixelPerfect=r,this.setDepth($.BUTTON),this.createButton(t,i,s,n),this.updateSize(),this.listenEvents(),this.scene.add.existing(this)}listenEvents(){this.scene.events.on(Phaser.Scenes.Events.SLEEP,this.handleSceneSleep),this.once(Phaser.GameObjects.Events.DESTROY,this.handelObjectDestroy)}handelObjectDestroy=()=>{this.scene&&this.scene.events.off(Phaser.Scenes.Events.SLEEP,this.handleSceneSleep)};handleSceneSleep=()=>{this.scene&&this.scene.tweens.killTweensOf(this)};set onClick(e){this.isUsePixelPerfect?(this.hitArea=this.button,this.hitArea.setInteractive({useHandCursor:!0,pixelPerfect:!0})):(this.hitArea=this.hitZone,this.updateSize(),this.hitArea.setInteractive({useHandCursor:!0})),this.hitArea.off(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN),this.hitArea.off(Phaser.Input.Events.GAMEOBJECT_POINTER_UP),this.hitArea.off(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handlePointerDown),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleOnClick(e)),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handlePointerOut)}get isUsePixelPerFect(){return this.isUsePixelPerfect}handlePointerDown=()=>{this.isClicked||(this.isClicked=!0)};handleOnClick=e=>()=>{this.isClicked&&(this.isClicked=!1,qi.trackButtonClick(this.name),e())};handlePointerOut=()=>{this.isClicked&&(this.isClicked=!1)};setDisabled(e){e?this.hitArea?.disableInteractive():this.hitArea?.setInteractive()}createButton(e,t,i,s){this.button=this.scene.add.image(0,0,e,t),i&&s&&this.button.setWorldSize(i,s);let{displayWidth:n,displayHeight:r}=this.button;this.hitZone=this.scene.make.zone({width:n,height:r}),this.add([this.button,this.hitZone])}updateSize(){let{width:e,height:t}=this.button,i=10,s=e/100*10,n=t/100*10,r=s<i?s:i,o=n<i?n:i;this.setSize(e+r,t+o),this.hitZone.setSize(e+r,t+o)}},FU=kU,{event:Sp}=codex,{DEFAULT:Kt,GAMEPLAY:si}=G,NU=class extends ue{Tt;j;Ot;t;ot;mt;Ge;q;Pt;Is;Ft;Os;vt;yi;$t;Ti;st;Ms;Ls;Ds;Jn;Qt;constructor(e,t){super(e,t),this.setDepth(me.POPUP),this.$(),this.He(),this.ll(),this.De(),this.As()}open=e=>{super.open(e),Sp.emit(j.PAUSE),this.Os=e?.itemId,this.ul(),this.ws(),this.et()};ul(){if(this.Os){switch(this.Os){case K.HINT.ID:this.ot.setTexture(si.KEY,si.FRAME.HINT_ITEM),this.mt.setText(K.HINT.REWARD_DESC);break;case K.ROCKET.ID:this.ot.setTexture(si.KEY,si.FRAME.ROCKET_ITEM),this.mt.setText(K.ROCKET.REWARD_DESC);break;case K.BOMB_DEFUSE.ID:this.ot.setTexture(si.KEY,si.FRAME.DEFUSE_ITEM),this.mt.setText(K.BOMB_DEFUSE.REWARD_DESC);break;case K.SHUFFLE.ID:this.ot.setTexture(si.KEY,si.FRAME.ITEM_SHUFFLE),this.mt.setText(K.SHUFFLE.REWARD_DESC);break}this.Qn()}}Qn(){this.ot.setWorldSize(100),this.Ft.setWorldSize(150);let{x:e,y:t}=this.ot;this.Ft.setPosition(e,t)}ne=()=>{this.Qt?.stop(),this.l()};Rt=async()=>{try{if(this.q.setDisabled(!0),!await pt.showRewardVideoAdAsync())return;this.$t.stop(),nt.playSound(ut.DAILY_REWARD),this.vt.setActive(!1),this.vt.setVisible(!1),this.cl(0,1500)}catch{}finally{this.q.setDisabled(!1)}};dl=()=>{this.j.setDisabled(!0),this.Tt.kill(),this.Ot.revive(),this.scene.tweens.killTweensOf(this.j),Phaser.Display.Align.In.Center(this.Ot,this.j),nt.playSound(ut.GIFT_CHARGE),this.pl(),this.fl()};et(){this.Tt.kill(),this.vt.setActive(!0),this.vt.setVisible(!0),this.$t.stop(),this.background.setAlpha(0),this.animateBackgroundAlpha(.8),this.Wt(100,400)}l=()=>{Sp.emit(j.RESUME),this.animateBackgroundAlpha(0,200),this.Cs(0,200)};Wt(e,t){this.q.setDisabled(!0),this.q.setAlpha(0),this.Is.setAlpha(0);let i=this.scene.tweens.add({...we,targets:this.vt.getChildren(),duration:t,delay:this.scene.tweens.stagger(100,{start:e}),props:{...we.props,scale:{getStart:s=>s===this.mt?1:.7,getEnd:s=>1},alpha:{start:0,from:0,to:1}},onComplete:()=>{this.Is.setAlpha(1),this.q.setDisabled(!1),this.ml()}});J.runTween(i)}cl(e,t){this.j.revive(),this.j.setAlpha(1),this.yi.setAlpha(1),this.Ti.setAlpha(1),Phaser.Display.Align.In.TopRight(this.j,this.zone),this.Ms?.tween.remove();let{x:i,y:s}=this.j,{x:n,y:r}=this.t,o={x:i,y:s},a={x:n,y:r};this.Ms=new uP(this.scene,{targets:[this.j],delay:e,duration:t,curve:[[o.x,o.y],[o.x-80,o.y+80],[a.x,a.y]],props:{scale:{start:.5,to:1},angle:{start:20,to:0}},onCurveUpdate:h=>{let l=h.x+Phaser.Math.RND.between(-40,40),u=h.y+Phaser.Math.RND.between(-40,40);this.yi.explode(1,l,u)},onComplete:()=>{nt.playSound(ut.GIFT_REVEAL);let h=1.5;this.$t.setScale(h);let{x:l,y:u,width:d,height:p}=this.j;this.$t.run(1,l,u,d/h,p/h),this.moveTo(this.$t,this.length-1),this.vl()}}),J.runTween(this.Ms.tween)}vl(){this.Ls?.stop(),this.Ls=this.scene.tweens.add({..._U,targets:[this.j],props:{scale:"+=0.05"}}),this.Tt.revive(),this.Tt.setAlpha(1),this.Tt.playAnimation(),Phaser.Display.Align.In.Center(this.Tt,this.j,20,20),this.j.setDisabled(!1),J.runTween(this.Ls)}pl(){this.Ds=new cC(this.scene,{targets:[this.j,this.Ot],duration:22,shakeX:5}),J.runTween(this.Ds.tween)}fl(){this.Jn=this.scene.tweens.add({...Hs,targets:[this.j,this.Ot],duration:1500,props:{alpha:0},onUpdate:()=>{this.Ot.setAlpha(1)},onComplete:()=>{this.Ds.tween.stop(),this.j.kill(),this.Ot.kill(),this.Ti.explode(100,this.j.x,this.j.y,230),nt.playSound(ut.GIFT_EXPLODE),this.scene.time.delayedCall(500,this.l),this.El()}}),J.runTween(this.Jn)}El(){let e=It.getCurrentScene();if(!e||!(e instanceof Pr))return;let t=this.j.getWorldPosition(),[i,s]=this.getData(["itemId","rewardCount"]),n=this.yl(i);if(!n)return;let{effectManager:r}=e,{x:o,y:a}=t,{x:h,y:l}=n,u=()=>{Sp.emit(j.RECEIVE_ITEM,{itemId:i,rewardCount:s})};r.playRewardItemCurveAnimation(o,a,h,l,u)}yl(e){let t=It.getCurrentScene();if(!t||!(t instanceof Pr))return null;let{layoutManager:i}=t,{objects:s}=i;switch(e){case K.SHUFFLE.ID:return s.shuffleItem.getWorldPosition();case K.HINT.ID:return s.hintItem.getWorldPosition();case K.ROCKET.ID:return s.rocketItem.getWorldPosition();case K.BOMB_DEFUSE.ID:return s.defuseItem.getWorldPosition();default:return null}}Cs(e,t){this.st=this.scene.tweens.add({...Nt,targets:this.getAll(),delay:e,duration:t}),J.runTweenAsync(this.st).then(()=>{this.mt.setText(""),ot.closeScreen(this.name)})}De(){this.Tt=new VP(this.scene),this.add(this.Tt)}As(){this.vt=this.scene.make.group({}),this.vt.addMultiple([this.t,this.Pt,this.Ft,this.ot,this.Ge,this.mt,this.q])}$(){this.t=this.scene.add.container(0,0);let e=this.scene.make.image({key:Kt.KEY,frame:Kt.FRAME.POPUP});this.t.setWorldSize(e.width,e.height),this.t.add(e),this.add(this.t),this.Tl(),this.Ps(),this.Rs(),this.bs(),this.It();let t=pt.getBannerHeight()/2;Phaser.Display.Align.In.Center(this.t,this.zone,0,-t)}Tl(){this.Ft=this.scene.make.image({key:Kt.KEY,frame:Kt.FRAME.ART_WHITE_GLOW}),this.t.add(this.Ft);let e=this.scene.make.image({key:si.KEY,frame:si.FRAME.HINT_ITEM});this.t.add(e),it.alignChildCenter(e,this.t,0,-40),this.ot=e,this.Qn()}Ps(){let e=X.createText(this.scene,"x1",28).setFontStyle("700");X.applyYellowStyle(e).setStroke("#4a260f",3),this.t.add(e),it.alignChildCenter(e,this.t),this.Ge=e}Rs(){let e=X.createText(this.scene,"",18).setWordWrapWidth(200).setAlign("center");X.applyYellowStyle(e).setStroke("#4a260f",2),this.t.add(e),it.alignChildCenter(e,this.t,0,50),this.mt=e}bs(){let e=new to(this.scene,Kt.KEY,Kt.FRAME.BUTTON_GREEN),t=this.scene.make.image({key:Kt.KEY,frame:Kt.FRAME.ICON_ADS});Phaser.Display.Align.In.Center(t,e),t.setX(e.x-60),e.content.add(t);let i=X.createText(this.scene,"Get Now",20).setFontStyle("900");X.applyGreenStyle(i);let s=this.scene.make.image({key:Kt.KEY,frame:Kt.FRAME.BUTTON_FRAME});e.content.add(i),it.alignChildCenter(i,e,18),it.alignChildCenter(e,this.t,0,110),this.t.add(s),this.t.add(e),Phaser.Display.Align.In.Center(s,e,0,-1),this.q=e,this.Is=s,e.onClick=this.Rt}It(){let e=new At(this.scene,Kt.KEY,Kt.FRAME.BUTTON_CLOSE),t=this.scene.make.image({key:Kt.KEY,frame:Kt.FRAME.ICON_X});e.add(t),e.setName("Close"),it.alignChildTopRight(e,this.t,-15,-15),this.t.add(e),e.onClick=this.ne,this.Pt=e}ll(){this.Ot=this.scene.make.image({key:Kt.KEY,frame:Kt.FRAME.LOGO_GIFT_WHITE,visible:!1}),this.Ot.setDepth($.PRIORITY),this.add(this.Ot),this.j=new FU(this.scene,Kt.KEY,Kt.FRAME.LOGO_GIFT),this.j.onClick=this.dl,this.j.setDisabled(!0),this.j.kill(),this.add(this.j)}He(){this.yi=new cP(this.scene),this.$t=new DU(this.scene),this.Ti=new dP(this.scene),this.add([this.yi,this.$t,this.Ti])}ws(){this.Qt?.stop(),this.Ft.angle=0,this.Ft.setPosition(this.ot.x,this.ot.y),this.Qt=this.scene.tweens.add({targets:this.Ft,angle:360,duration:5e3,repeat:-1,ease:"Linear"})}ml(){this.q.playHighlightAnimation()}},BU=NU;U(),U(),U();var UU=class extends Phaser.GameObjects.Container{useSound=!0;isClicked=!1;scaleUp=1;scaleDown=.985;button;upAnimation;downAnimation;isUsePixelPerfect=!1;hitArea;hitZone;hitSoundEffectKey=ut.GENERAL_BUTTON_CLICK;scaleDownPress;constructor(e,t){super(e),this.isUsePixelPerfect=t.usePixelPerfect??!1,this.setDepth($.BUTTON),this.createButton(t),this.updateSize(),this.listenEvents(),this.scene.add.existing(this)}listenEvents(){this.scene.events.on(Phaser.Scenes.Events.SLEEP,this.handleSceneSleep),this.once(Phaser.GameObjects.Events.DESTROY,this.handelObjectDestroy)}handelObjectDestroy=()=>{this.scene&&this.scene.events.off(Phaser.Scenes.Events.SLEEP,this.handleSceneSleep)};handleSceneSleep=()=>{this.scene&&this.scene.tweens.killTweensOf(this)};set onClick(e){this.isUsePixelPerfect?(this.hitArea=this.button,this.hitArea.setInteractive({useHandCursor:!0,pixelPerfect:!0})):(this.hitArea=this.hitZone,this.updateSize(),this.hitArea.setInteractive({useHandCursor:!0})),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handlePointerDown),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleOnClick(e)),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handlePointerOut)}get isUsePixelPerFect(){return this.isUsePixelPerfect}handlePointerDown=()=>{this.isClicked||this.upAnimation?.isPlaying()||(this.isClicked=!0,this.runDownAnimation())};handleOnClick=e=>()=>{this.isClicked&&(this.upAnimation?.isPlaying()||(this.isClicked=!1,this.runUpAnimation(),this.upAnimation?.once(Phaser.Tweens.Events.TWEEN_COMPLETE,()=>{qi.trackButtonClick(this.name),this.processCallback(e)})))};handlePointerOut=()=>{this.isClicked&&(this.upAnimation?.isPlaying()||(this.isClicked=!1,this.runUpAnimation()))};processCallback(e){this.upAnimation?.stop(),this.downAnimation?.stop(),this.scene?.tweens.killTweensOf(this),this.setScale(this.scaleUp),e()}setDisabled(e){e?(this.setAlpha(.5),this.hitArea?.disableInteractive()):(this.setAlpha(1),this.hitArea?.setInteractive())}createButton(e){this.button=this.scene.make.nineslice(e);let{displayWidth:t,displayHeight:i}=this.button;this.hitZone=this.scene.make.zone({width:t,height:i}),this.add([this.button,this.hitZone])}updateSize(){let{width:e,height:t}=this.button,i=10,s=e/100*10,n=t/100*10,r=s<i?s:i,o=n<i?n:i;this.setSize(e+r,t+o),this.hitZone.setSize(e+r,t+o)}runDownAnimation(){this.useSound&&nt.playSound(this.hitSoundEffectKey),this.downAnimation?.remove(),this.downAnimation=this.scene.tweens.add({...Hs,targets:[this],duration:150,props:{scale:this.scaleDown},onUpdate:()=>{this.hitZone.scale=1/this.scale}}),J.runTween(this.downAnimation)}runUpAnimation(){this.upAnimation?.remove(),this.upAnimation=this.scene.tweens.add({...rr,targets:[this],duration:150,props:{scale:this.scaleUp},onUpdate:()=>{this.hitZone.scale=1/this.scale}}),J.runTween(this.upAnimation)}setButtonHitSoundEffect(e){this.hitSoundEffectKey=e}},GU=UU,{Utils:{Signal:YU}}=Ludex,{KEY:HU,FRAME:zU}=G.DASHBOARD,WU=class extends GU{text;shine;shineAlpha;shineScale;useShine=!1;scaleDown=.985;shineAnimController=new YU.SignalController;constructor(e,t){let i={key:HU,frame:zU.BUTTON_GREEN,width:200,height:50,leftWidth:30,rightWidth:30,topHeight:20,bottomHeight:20,...t};super(e,i),this.shineAlpha=i.shineAlpha??.2,this.shineScale=i.shineScale??1.05,this.setName("PlayButton"),this.createText(),this.createShine(i)}createText(){this.text=X.createText(this.scene,"Level 1",26),X.applyGreenStyle(this.text),this.text.setShadow(0,6,"#27710e",3),this.add(this.text)}createShine(e){!e.key||!e.frame||(this.shine=this.scene.add.nineslice(0,0,e.key,e.frame,e.width,e.height,e.leftWidth,e.rightWidth,e.topHeight,e.bottomHeight),fo.inst.setBlendModeWithPerf(this.shine,Phaser.BlendModes.ADD),this.shine.setAlpha(this.shineAlpha),this.add(this.shine),this.shine.kill())}setLevel(e){this.text.setText(`Level ${e}`)}setButtonSize(e,t){this.button.setSize(e,t)}playShineAnimation(){this.useShine=!0,this.startShineAnimation()}startShineAnimation(){this.shine.revive();let e=this.shineAnimController.renew(),t=this.scene.tweens.add({targets:this.shine,props:{alpha:{from:0,to:this.shineAlpha}},paused:!0,duration:600,ease:Phaser.Math.Easing.Cubic.InOut,repeatDelay:200,yoyo:!0,repeat:-1}),i=this.scene.tweens.add({targets:[this.shine,this.button,this.text],props:{scale:{from:1,to:this.shineScale}},paused:!0,duration:600,ease:Phaser.Math.Easing.Cubic.InOut,repeatDelay:200,yoyo:!0,repeat:-1});J.runTween(t,e),J.runTween(i,e)}stopShineAnimation(){this.startShineExitAnimation(),this.useShine=!1}startShineExitAnimation(){let e=this.shineAnimController.renew(),t=this.scene.tweens.add({targets:this.shine,props:{alpha:0},paused:!0,duration:150,ease:Phaser.Math.Easing.Cubic.Out}),i=this.scene.tweens.add({targets:[this.shine,this.button,this.text],props:{scale:1},paused:!0,duration:150,ease:Phaser.Math.Easing.Cubic.Out,onComplete:()=>{this.shine.kill()}});J.runTween(t,e),J.runTween(i,e)}runDownAnimation(){super.runDownAnimation(),this.startShineExitAnimation()}runUpAnimation(){super.runUpAnimation(),this.useShine&&this.startShineAnimation()}},jP=WU;U();var{KEY:ZP,FRAME:cn}=G.JOURNEY,ft={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",MIDDLE_LTR:"middle-ltr",MIDDLE_RTL:"middle-rtl"},_e={EMPTY:"empty",FILLED:"filled"},Ap=class UR extends Phaser.GameObjects.Container{border;road;config;constructor(t,i){super(t),this.config=i,this.create(i),this.setSize(this.border.width,this.border.height),this.scene.add.existing(this)}setRoadState(t){this.config.state=t,t===_e.EMPTY?this.road.kill():this.road.revive()}static createLinkingRoad(t,i,s){let n=this.getNextRoadType(i.config.type);return new UR(t,{...s,type:n})}static getNextRoadType(t){switch(t){case ft.TOP_LEFT:return ft.MIDDLE_LTR;case ft.TOP_RIGHT:return ft.MIDDLE_RTL;case ft.BOTTOM_LEFT:return ft.TOP_LEFT;case ft.BOTTOM_RIGHT:return ft.TOP_RIGHT;case ft.MIDDLE_LTR:return ft.BOTTOM_RIGHT;case ft.MIDDLE_RTL:return ft.BOTTOM_LEFT}}static alignRoad(t,i){let{type:s}=t.config;switch(s){case ft.TOP_LEFT:Phaser.Display.Align.To.RightTop(i,t,0,0);break;case ft.TOP_RIGHT:Phaser.Display.Align.To.LeftTop(i,t,0,0);break;case ft.BOTTOM_LEFT:Phaser.Display.Align.To.TopLeft(i,t,0,0);break;case ft.BOTTOM_RIGHT:Phaser.Display.Align.To.TopRight(i,t,0,0);break;case ft.MIDDLE_LTR:Phaser.Display.Align.To.RightBottom(i,t,0,0);break;case ft.MIDDLE_RTL:Phaser.Display.Align.To.LeftBottom(i,t,0,0);break}}setConfig(t){this.config.type=t.type,this.config.state=t.state;let i=this.getBorderFrame(t.type);this.border.setFrame(i),this.border.setFlipX(t.type===ft.TOP_LEFT||t.type===ft.BOTTOM_RIGHT);let s=this.getRoadFrame(t.type);switch(this.road.setFrame(s),this.road.setFlipX(!1),this.road.setPosition(0,0),t.type){case ft.TOP_LEFT:this.road.setFlipX(!0),this.road.setPosition(3.5,2.75);break;case ft.TOP_RIGHT:this.road.setPosition(-3.5,2.75);break;case ft.BOTTOM_LEFT:this.road.setPosition(3.5,-2.75);break;case ft.BOTTOM_RIGHT:this.road.setFlipX(!0),this.road.setPosition(-3.5,-2.75);break}t.state===_e.EMPTY?this.road.kill():this.road.revive()}create(t){let{type:i,state:s}=t;this.border=this.createBorder(i),this.add(this.border),this.road=this.createRoad(i),this.add(this.road),s===_e.EMPTY&&this.road.kill()}createBorder(t){let i=this.getBorderFrame(t),s=this.scene.make.image({key:ZP,frame:i});return(t===ft.TOP_LEFT||t===ft.BOTTOM_RIGHT)&&s.setFlipX(!0),s}getBorderFrame(t){switch(t){case ft.TOP_LEFT:case ft.TOP_RIGHT:return cn.BORDER_RIGHT;case ft.BOTTOM_LEFT:case ft.BOTTOM_RIGHT:return cn.BORDER_LEFT;case ft.MIDDLE_LTR:case ft.MIDDLE_RTL:return cn.BORDER_MIDDLE}}getRoadFrame(t){switch(t){case ft.TOP_LEFT:case ft.TOP_RIGHT:return cn.ROAD_RIGHT;case ft.BOTTOM_LEFT:case ft.BOTTOM_RIGHT:return cn.ROAD_LEFT;case ft.MIDDLE_LTR:case ft.MIDDLE_RTL:return cn.ROAD_MIDDLE}}createRoad(t){let i=this.getRoadFrame(t),s=this.scene.make.image({key:ZP,frame:i});switch(t){case ft.TOP_LEFT:s.setFlipX(!0),s.setPosition(s.x+3.5,s.y+2.75);break;case ft.TOP_RIGHT:s.setPosition(s.x-3.5,s.y+2.75);break;case ft.BOTTOM_LEFT:s.setPosition(s.x+3.5,s.y-2.75);break;case ft.BOTTOM_RIGHT:s.setFlipX(!0),s.setPosition(s.x-3.5,s.y-2.75);break}return s}};U(),U();function wp(e,t,i,s,n){return s+(n-s)*(e-t)/(i-t)}var{KEY:qP,FRAME:us}=G.JOURNEY,{Utils:{Signal:VU}}=Ludex,Te={ACTIVE:"active",INACTIVE:"inactive",COMPLETED:"completed"},JP=class extends Phaser.GameObjects.Container{background;label;glow;config;animController=new VU.SignalController;glowOriginScale;constructor(e,t){super(e),this.config=t,this.create(t),this.scene.add.existing(this)}setKnobState(e){this.config.state=e,e===Te.INACTIVE?this.background.setFrame(us.LEVEL_INACTIVE):e===Te.ACTIVE?this.background.setFrame(us.LEVEL_ACTIVE):e===Te.COMPLETED&&this.background.setFrame(us.LEVEL_COMPLETED)}static getKnobPositionOffset(e,t){let i=e-t+1,s=74,n=80,r=75,o=35,a=35;if(e%3===0){let p=e%2===0,g=i===3,c=p?-n:n,f=g?r:r+s*(Math.floor(i/3)-1);return{x:c,y:f}}let h=e%2===1,l=i===1||i===2,u=h?-o:o,d=l?a:a+s*Math.floor(i/3);return{x:u,y:d}}setConfig(e){this.config.state=e.state,this.config.label=e.label;let t=this.getBackgroundFrame(e.state);this.background.setFrame(t),this.label.setText(e.label),Phaser.Display.Align.In.Center(this.label,this.background,0,-5),e.state===Te.ACTIVE?(this.glow.revive(),this.runGlowScaleUpLoopAnimation(0,700)):this.glow.kill()}create(e){let{state:t,label:i}=e;this.glow=this.createGlow(),this.background=this.createBackground(t),this.label=this.createText(i),this.add([this.glow,this.background,this.label]),t!==Te.ACTIVE&&this.glow.kill(),this.setSize(this.background.width,this.background.height)}createGlow(){let e=this.scene.make.image({key:qP,frame:us.GLOW});return this.glowOriginScale=e.scale,e}createBackground(e){let t=this.getBackgroundFrame(e);return this.scene.make.image({key:qP,frame:t})}getBackgroundFrame(e){switch(e){case Te.INACTIVE:return us.LEVEL_INACTIVE;case Te.ACTIVE:return us.LEVEL_ACTIVE;case Te.COMPLETED:return us.LEVEL_COMPLETED}}createText(e){let t=X.createShadowText(this.scene,e,15);return t.setFontStyle("900"),t}runGlowScaleUpLoopAnimation(e,t){let i=this.animController.renew();J.runTween(this.scene.tweens.add({targets:[this.glow],delay:e,duration:t,repeat:-1,props:{scale:{from:this.glowOriginScale,to:this.glowOriginScale*1.5},alpha:{from:1,to:0}},ease:Phaser.Math.Easing.Expo.Out}),i)}setHiddenPercentage(e){let t=wp(e,0,1,1,0);this.setScale(t)}};U(),U();var{FRAME:qt}=G.JOURNEY,{FRAME:Jt}=G.DASHBOARD,rt={BANGKOK:"BANGKOK",BARCELONA:"BARCELONA",DUBAI:"DUBAI",LAS_VEGAS:"LAS_VEGAS",LONDON:"LONDON",NEW_YORK:"NEW_YORK",PARIS:"PARIS",ROME:"ROME",SINGAPORE:"SINGAPORE",TOKYO:"TOKYO",ARGENTINA:"ARGENTINA",INDIA:"INDIA",AUSTRALIA:"AUSTRALIA",BRAZIL:"BRAZIL",CANADA:"CANADA",DENMARK:"DENMARK",EGYPT:"EGYPT"},Fo=[rt.PARIS,rt.LONDON,rt.TOKYO,rt.DUBAI,rt.NEW_YORK,rt.BANGKOK,rt.BARCELONA,rt.LAS_VEGAS,rt.ROME,rt.SINGAPORE,rt.ARGENTINA,rt.INDIA,rt.AUSTRALIA,rt.BRAZIL,rt.CANADA,rt.DENMARK,rt.EGYPT];function XU(){let e={...rt};for(let t of Fo)delete e[t];Object.keys(e).length>0}XU();var KU={[rt.BANGKOK]:"Bangkok",[rt.BARCELONA]:"Barcelona",[rt.DUBAI]:"Dubai",[rt.LAS_VEGAS]:"Las Vegas",[rt.LONDON]:"London",[rt.NEW_YORK]:"New York",[rt.PARIS]:"Paris",[rt.ROME]:"Rome",[rt.SINGAPORE]:"Singapore",[rt.TOKYO]:"Tokyo",[rt.ARGENTINA]:"Argentina",[rt.INDIA]:"India",[rt.AUSTRALIA]:"Australia",[rt.BRAZIL]:"Brazil",[rt.CANADA]:"Canada",[rt.DENMARK]:"Denmark",[rt.EGYPT]:"Egypt"},jU={[rt.BANGKOK]:qt.THEME_BANGKOK,[rt.BARCELONA]:qt.THEME_BARCELONA,[rt.DUBAI]:qt.THEME_DUBAI,[rt.LAS_VEGAS]:qt.THEME_LAS_VEGAS,[rt.LONDON]:qt.THEME_LONDON,[rt.NEW_YORK]:qt.THEME_NEW_YORK,[rt.PARIS]:qt.THEME_PARIS,[rt.ROME]:qt.THEME_ROME,[rt.SINGAPORE]:qt.THEME_SINGAPORE,[rt.TOKYO]:qt.THEME_TOKYO,[rt.ARGENTINA]:qt.THEME_ARGENTINA,[rt.INDIA]:qt.THEME_INDIA,[rt.AUSTRALIA]:qt.THEME_AUSTRALIA,[rt.BRAZIL]:qt.THEME_BRAZIL,[rt.CANADA]:qt.THEME_CANADA,[rt.DENMARK]:qt.THEME_DENMARK,[rt.EGYPT]:qt.THEME_EGYPT},ZU={[rt.BANGKOK]:Jt.THEME_BANGKOK,[rt.BARCELONA]:Jt.THEME_BARCELONA,[rt.DUBAI]:Jt.THEME_DUBAI,[rt.LAS_VEGAS]:Jt.THEME_LAS_VEGAS,[rt.LONDON]:Jt.THEME_LONDON,[rt.NEW_YORK]:Jt.THEME_NEW_YORK,[rt.PARIS]:Jt.THEME_PARIS,[rt.ROME]:Jt.THEME_ROME,[rt.SINGAPORE]:Jt.THEME_SINGAPORE,[rt.TOKYO]:Jt.THEME_TOKYO,[rt.ARGENTINA]:Jt.THEME_ARGENTINA,[rt.INDIA]:Jt.THEME_INDIA,[rt.AUSTRALIA]:Jt.THEME_AUSTRALIA,[rt.BRAZIL]:Jt.THEME_BRAZIL,[rt.CANADA]:Jt.THEME_CANADA,[rt.DENMARK]:Jt.THEME_DENMARK,[rt.EGYPT]:Jt.THEME_EGYPT},Oe=class{static getThemeFrameForJourneyScreen(e){let t=e??this.getThemeKey();return jU[t]}static getThemeFrameForDashboardComponent(e){let t=e??this.getThemeKey();return ZU[t]}static getThemeName(e){let t=e??this.getThemeKey();return KU[t]}static getThemeKey(e){let t=e??Ii.getLevelProgress(),i=(t<=0?0:Math.floor((t-1)/10))%Fo.length;return Fo[i]}static getThemeProgress(e){let t=(e??Ii.getLevelProgress())-1,i=t-t%10;return Phaser.Math.Clamp((t-i)/10,0,1)}static isLastLevelOfTheme(e){let t=e??Ii.getLevelProgress();return t<=0?!1:t%10===0}};U(),U();var{KEY:Cp,FRAME:QP}=G.JOURNEY,No=class extends Phaser.GameObjects.Container{frame;theme;label;check;frameScale=1;frameAngle=0;constructor(e,t){super(e),this.create(t)}static getFramePositionOffset(e,t){let{x:i,y:s}=JP.getKnobPositionOffset(e,t);if(e%3===0){let o=e%2===0?i-4:i+4,a=s-50;return{x:o,y:a}}let n=e%2===1?i-4:i+4,r=s-50;return{x:n,y:r}}static getFrameScale(e){return e%3===0?1:.7}static getFrameAngle(e){return e%3===0?e%2===0?Phaser.Math.FloatBetween(-20,-15):Phaser.Math.FloatBetween(15,20):e%2===1?Phaser.Math.FloatBetween(-15,-10):Phaser.Math.FloatBetween(10,15)}setFrameScale(e){this.frameScale=e,this.setScale(this.frameScale)}setFrameAngle(e){this.frameAngle=e,this.setAngle(this.frameAngle)}create(e){this.frame=this.createFrame(),this.add(this.frame),this.theme=this.createTheme(e.theme),this.add(this.theme),this.label=this.createLabel(e.theme),this.add(this.label),this.check=this.createCheck(),this.add(this.check),e.checked||this.check.kill(),this.setSize(this.frame.width,this.frame.height)}createFrame(){return this.scene.make.image({key:Cp,frame:QP.THEME_FRAME})}createTheme(e){let t=Oe.getThemeFrameForJourneyScreen(e);return this.scene.make.image({key:Cp,frame:t,origin:{x:.5,y:.5}})}createLabel(e){let t=Oe.getThemeName(e).toUpperCase(),i=X.createText(this.scene,t,10).setFontStyle("800");return X.applyWoodStyle(i),i}createCheck(){return this.scene.make.image({key:Cp,frame:QP.ICON_CHECK})}setConfig(e){let t=Oe.getThemeFrameForJourneyScreen(e.theme);this.theme.setFrame(t);let i=Oe.getThemeName(e.theme).toUpperCase();this.label.setText(i),e.checked?this.check.revive():this.check.kill(),Phaser.Display.Align.In.Center(this.theme,this.frame,0,-10),Phaser.Display.Align.In.BottomLeft(this.label,this.frame,-4,-10),this.label.text.length>5?Phaser.Display.Align.In.BottomRight(this.check,this.frame,-6,-30):Phaser.Display.Align.In.BottomRight(this.check,this.frame,-6,-10)}setHiddenPercentage(e){let t=wp(e,0,1,this.frameScale,0);this.setScale(t);let i=wp(e,0,1,this.frameAngle,0);this.setAngle(i)}},qU={type:"full",playerLevel:1,currentLevel:1,frame:{checked:!1,theme:Fo[0]},roads:[{type:ft.TOP_LEFT,state:_e.EMPTY},{type:ft.MIDDLE_LTR,state:_e.EMPTY},{type:ft.BOTTOM_RIGHT,state:_e.EMPTY}],knobs:[{label:"1",state:Te.ACTIVE},{label:"2",state:Te.INACTIVE},{label:"3",state:Te.INACTIVE}]},JU=class extends Phaser.GameObjects.Container{config;frame;roads;knobs;lastLevelOfTheme;constructor(e){super(e),this.config=qU,this.roads=this.config.roads.map(t=>new Ap(this.scene,t)),this.knobs=this.config.knobs.map(t=>new JP(this.scene,t)),this.frame=new No(this.scene,this.config.frame),this.add([...this.roads,...this.knobs,this.frame]),this.alignRoads(),this.alignKnobs(),this.lastLevelOfTheme=this.findLastLevelOfTheme(),this.alignFrame(),this.setSize(this.getWidth(),72)}setConfig(e){this.config=e,this.config.type==="full"?this.setFullConfig(this.config):this.setRoadOnlyConfig(this.config)}setFullConfig(e){for(let t=0;t<this.roads.length;t++){let i=this.roads[t];i.revive(),i.setConfig(e.roads[t])}for(let t=0;t<this.knobs.length;t++){let i=this.knobs[t];i.revive(),i.setConfig(e.knobs[t])}this.frame.revive(),this.frame.setConfig(e.frame),this.alignRoads(),this.alignKnobs(),this.lastLevelOfTheme=this.findLastLevelOfTheme(),this.alignFrame()}setRoadOnlyConfig(e){for(let t=0;t<this.roads.length;t++)this.roads[t].setConfig(e.roads[t]);for(let t of this.knobs)t.kill();this.frame.kill(),this.alignRoads(),this.lastLevelOfTheme=this.findLastLevelOfTheme()}getWidth(){let e=0;for(let t of this.roads)e+=t.width;return e}alignRoads(){let e=this.config.currentLevel>=0?Math.floor(this.config.currentLevel%6)<3:-Math.floor(this.config.currentLevel%6)>=3;this.roads[0].setPosition(e?-62:62,-10);for(let t=1;t<this.roads.length;t++){let i=this.roads[t-1],s=this.roads[t];Ap.alignRoad(i,s)}for(let t of this.roads)t.setY(t.y+22)}alignKnobs(){let e=Math.floor(this.config.currentLevel%6)<3;this.knobs[0].setPosition(e?-35:35,-25),this.knobs[1].setPosition(e?35:-35,-25),this.knobs[2].setPosition(e?85:-85,-65);for(let t of this.knobs)t.setY(t.y+22)}findLastLevelOfTheme(){return[this.config.currentLevel,this.config.currentLevel+1,this.config.currentLevel+2].find(e=>Oe.isLastLevelOfTheme(e))}alignFrame(){if(this.lastLevelOfTheme===void 0){this.frame.setVisible(!1);return}this.frame.setVisible(!0);let{x:e,y:t}=No.getFramePositionOffset(this.lastLevelOfTheme,this.lastLevelOfTheme);this.frame.setPosition(e,t),this.frame.setFrameScale(No.getFrameScale(this.lastLevelOfTheme)),this.frame.setFrameAngle(No.getFrameAngle(this.lastLevelOfTheme))}updateHiddenAmount(e){let t=this.lastLevelOfTheme!==void 0;if(this.config.type==="road-only")return;let i=-e.content.y+e.height/2-e.visualConfig.boundDetectionPadding.bottom,s=this.y,n=220,r=170,o=n-r,a=i-r,h=a-n,l=s<h,u=s>a;if(l){t&&this.frame.setHiddenPercentage(0);for(let g of this.knobs)g.setHiddenPercentage(0);return}if(u){t&&this.frame.setHiddenPercentage(1);for(let g of this.knobs)g.setHiddenPercentage(1);return}let d=a-s,p=1-Phaser.Math.Clamp(d/o,0,1);t&&this.frame.setHiddenPercentage(p);for(let g of this.knobs)g.setHiddenPercentage(p)}};U();var QU=class extends ro{configGenerator;configChecker;constructor(e,t){super(e,t),this.configGenerator=t.infinite.generate,this.configChecker=t.infinite.check}getConfigs(){return this.configs}scrollToConfig(e,t=!1,i=!0){if(e<0||e>=this.configs.length)return;let s=this.getMaxObjectHeight(),n=-this.content.height/2+this.visualConfig.margin.top,r=s+this.visualConfig.spacing,o=n+e*r+s/2;this.scrollTo(-o,t,i)}addConfigs(e,t){t==="before"?(this.configs=[...e,...this.configs],this.contentGameObjects=[...e.map(s=>({config:s,gameObject:void 0})),...this.contentGameObjects]):(this.configs=[...this.configs,...e],this.contentGameObjects=[...this.contentGameObjects,...e.map(s=>({config:s,gameObject:void 0}))]);let i=this.calcContentHeight();this.setInfiniteContentHeight(i,t),this.updateObjectPosition()}setInfiniteContentHeight(e,t){this.isScrolling=!0;let i=this.content.y,s=(e-this.content.height)/2,n=t==="before"?i-s:i+s,r=t==="before"?this.targetY-s:this.targetY+s;this.content.setWorldSize(this.width,e),this.content.setY(n),this.targetY=r}updateObjectVisibility(){if(super.updateObjectVisibility(),this.contentGameObjects.length===0)return;let e=this.contentGameObjects[0]?.gameObject!==void 0&&this.configChecker(this.configs[0],-1),t=this.contentGameObjects[this.contentGameObjects.length-1]?.gameObject!==void 0&&this.configChecker(this.configs[this.configs.length-1],1);if(e){let i=this.configGenerator(this.configs[0],-1);if(i.length===0)return;this.addConfigs(i,"before");return}if(t){let i=this.configGenerator(this.configs[this.configs.length-1],1);if(i.length===0)return;this.addConfigs(i,"after")}}calcDistUnderTop(e){return this.configs.length===0?super.calcDistUnderTop(e):this.configChecker(this.configs[0],-1)?0:super.calcDistUnderTop(e)}calcDistAboveBottom(e){return this.configs.length===0?super.calcDistAboveBottom(e):this.configChecker(this.configs[this.configs.length-1],1)?0:super.calcDistAboveBottom(e)}},{Utils:{Valid:$U,Array:tG}}=Ludex,{KEY:eG,FRAME:iG}=G.DEFAULT,{KEY:sG,FRAME:nG}=G.JOURNEY,{event:Bo}=codex,rG=class extends ue{popup;scroller;backButton;playButton;sceneObjectsOriginalY=[];popupFadeInAnimation;popupFadeOutAnimation;incY(e){super.incY(e),this.popup.y-=e}incX(e){super.incX(e),this.popup.x-=e}incScale(e){super.incScale(e),this.popup.scale-=e^e*(100/e)}constructor(e,t){super(e,t),this.createPopup(),this.createButtons(),this.createJourney(),this.popup.bringToTop(this.playButton),this.popup.bringToTop(this.backButton),this.createInput(),this.background.setAlpha(0),this.setDepth(me.POPUP),this.listenToEvents()}open(){super.open(),this.scrollToPlayerLevelConfig(),this.updatePlayButton(),this.runOpenAnimation()}preDestroy(){this.unlistenToEvents(),super.preDestroy()}listenToEvents(){this.scroller.on(no.SCROLL_VALUE_CHANGED,this.onScrollValueChanged,this),Bo.on(yt.VIEW_RESIZED,this.onViewResized),Bo.on(yt.LAYOUT_CHANGED,this.onViewResized)}unlistenToEvents(){this.scroller.off(no.SCROLL_VALUE_CHANGED,this.onScrollValueChanged,this),Bo.off(yt.VIEW_RESIZED,this.onViewResized),Bo.off(yt.LAYOUT_CHANGED,this.onViewResized)}onScrollValueChanged(){for(let e of this.scroller.getChildren())e.updateHiddenAmount(this.scroller)}onViewResized=e=>{if(!this.scene.scene.isActive())return;let{width:t,height:i}=e;this.popup.setWorldSize(t,i),Phaser.Display.Align.In.Center(this.popup,this.zone),Phaser.Display.Align.In.Center(this.scroller,this.popup),Phaser.Display.Align.In.TopLeft(this.backButton,this.popup,-15,-15),Phaser.Display.Align.In.BottomCenter(this.playButton,this.popup,0,-65)};scrollToPlayerLevelConfig(){let e=i=>{let{playerLevel:s,currentLevel:n}=i;return s<=n&&n<=s+2},t=tG.searchIndex(this.scroller.getConfigs(),e);t!==-1&&this.scroller.scrollToConfig(t,!0)}getPlayerLevel(){let{player:e}=codex,{level:t}=e.getGameData()??{};return $U.isNumber(t)?t:1}createInput(){this.backButton.setButtonHitSoundEffect(ut.CLOSE_POPUP_CLICK),this.backButton.onClick=this.handleClose.bind(this)}handleClose(){this.runCloseAnimation()}createPopup(){let{width:e}=lt.getWorldSize(),t=Math.min(e,600);this.popup=this.scene.add.container(0,0),this.popup.setWorldSize(t,this.zone.height),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)}createButtons(){this.createBackButton(),this.createPlayButton()}createScroller(){let e=this.zone.height;this.scroller=new QU(this.scene,{size:{width:300,height:e},maxOverScroll:{bottom:0},visual:{boundDetectionPadding:{top:-50,bottom:-100},margin:{bottom:-25}},reuse:{depthStrategy:"bottom-to-top",ClassType:JU,configs:[],update:(t,i)=>{t.setConfig(i)}},infinite:{generate:(t,i)=>this.generateGroupOfThreeConfigs(t.playerLevel,t.currentLevel,i),check:(t,i)=>this.hasGroupsOfThreeAvailable(t.currentLevel,i)}}),this.popup.add(this.scroller),Phaser.Display.Align.In.Center(this.scroller,this.popup),this.scroller.setEnabled()}createJourney(){let e=this.getPlayerLevel(),t=11,i=t-(t+1)%3+e%3,s=40,n=s-(s+1)%3+e%3%3,r=Phaser.Math.MinSub(e,i,1),o=r+n;this.createScroller();let a=this.createGroupOfThreeConfigs(e,r,o);a.reverse(),this.scroller.setConfigs(a),this.scrollToPlayerLevelConfig()}generateGroupOfThreeConfigs(e,t,i){let s=i===1;if(t===-5&&s)return[];let n=10,r=Math.max(s?t-3*n:t+3,-5),o=s?t-3:t+3*n,a=this.createGroupOfThreeConfigs(e,r,o);return a.reverse(),a}hasGroupsOfThreeAvailable(e,t){return!(e===-5&&t===1)}createGroupOfThreeConfigs(e,t,i){let s=[];for(let n=t;n<=i;n+=3){if(n<=0){let h=this.createRoadConfigs(e,n,n+2);s.push({type:"road-only",playerLevel:e,currentLevel:n,roads:h});continue}let r=this.createLevelKnobConfigs(e,n,n+2),o=this.createThemeFrameConfig(e,n),a=this.createRoadConfigs(e,n,n+2);s.push({type:"full",playerLevel:e,currentLevel:n,frame:o,roads:a,knobs:r})}return s}createLevelKnobConfigs(e,t,i){let s=[];for(let n=t;n<=i;n++){let r=n===e,o=n<e,a=Te.INACTIVE;r&&(a=Te.ACTIVE),o&&(a=Te.COMPLETED);let h=n.toString();s.push({state:a,label:h})}return s}createRoadConfigs(e,t,i){let s=[],n=t>=0?Math.floor(t%6)<3:-Math.floor(t%6)>=3,r={state:e>=t?_e.FILLED:_e.EMPTY,type:n?ft.TOP_LEFT:ft.TOP_RIGHT};s.push({state:e>=t?_e.FILLED:_e.EMPTY,type:n?ft.TOP_LEFT:ft.TOP_RIGHT});for(let o=t+1;o<=i;o++){let a={type:Ap.getNextRoadType(r.type),state:o-1<e?_e.FILLED:_e.EMPTY};s.push(a),r=a}return s}createThemeFrameConfig(e,t){let i=t<e;return{theme:Oe.getThemeKey(t),checked:i}}createBackButton(){this.backButton=new At(this.scene,eG,iG.BUTTON_YELLOW_CIRCLE,36,36);let e=this.scene.make.image({key:sG,frame:nG.ICON_BACK});this.backButton.add(e),this.backButton.setName("Back"),this.popup.add(this.backButton),Phaser.Display.Align.In.TopLeft(this.backButton,this.popup,-15,-15)}createPlayButton(){this.playButton=new jP(this.scene),this.playButton.button.setSize(215,this.playButton.button.height),Phaser.Display.Align.In.BottomCenter(this.playButton,this.popup,0,-65),this.popup.add(this.playButton),this.playButton.onClick=this.handlePlay}updatePlayButton(){let e=this.getPlayerLevel();this.playButton.setLevel(e)}handlePlay=async()=>{await ht.startSingleModeAsync()&&(this.runSceneTransitionInAnimation(!0),It.switchToGameScene())};runOpenAnimation(){this.popupFadeInAnimation?.isPlaying()||(this.runSceneTransitionOutAnimation(),this.runPopupEntrancesAnimation(0,400))}runSceneTransitionOutAnimation(){if(this.scene.scene.key!==Yt.DASHBOARD_SCENE)return;let e=this.scene.layoutManager.objects.getAll();for(let i of e)this.sceneObjectsOriginalY.push({object:i,y:i.y});let t=this.scene.tweens.add({targets:e,props:{y:"-=100",alpha:0},duration:150,ease:Phaser.Math.Easing.Cubic.Out});J.runTween(t)}runCloseAnimation(){this.popupFadeOutAnimation?.isPlaying()||(this.runSceneTransitionInAnimation(),this.runPopupExitsAnimation(0,200))}runSceneTransitionInAnimation(e=!1){if(this.scene.scene.key!==Yt.DASHBOARD_SCENE)return;let t=this.scene.layoutManager.objects.getAll();if(e){for(let i of t){let s=this.sceneObjectsOriginalY.find(n=>n.object===i)?.y;s&&(i.setY(s),i.setAlpha(1))}return}for(let i of t){let s=this.sceneObjectsOriginalY.find(r=>r.object===i)?.y;if(!s)continue;let n=this.scene.tweens.add({targets:[i],props:{y:s,alpha:1},duration:150,ease:Phaser.Math.Easing.Cubic.Out});J.runTween(n)}}runPopupEntrancesAnimation(e,t){this.popupFadeInAnimation=this.scene.tweens.add({...ar,targets:[this.popup],delay:e,duration:t,props:{y:{from:350,to:0},alpha:{from:0,to:1},scale:{from:.7,to:1}}})}runPopupExitsAnimation(e,t){this.popupFadeOutAnimation=this.scene.tweens.add({...Nt,targets:[this.popup],delay:e,duration:t,props:{...Nt.props,y:350,scale:{from:1,to:.7}},onComplete:()=>{this.popup.setY(0),ot.closeScreen(this.name)}})}},aG=rG;U(),U();var{Utils:{Signal:oG}}=Ludex,{KEY:$P,FRAME:tR}=G.DEFAULT,{KEY:hG,FRAME:br}=G.DASHBOARD,lG=class extends Phaser.GameObjects.Container{darkenBackground;glowBackground;highlightItems=[];starSparkle;animController=new oG.SignalController;constructor(e,t,i,s){super(e,0,0),this.setSize(t,i),this.createDarkenBackground(),this.createGlowBackground(),this.createHighlightItem(s),this.createEffects()}preDestroy(){this.animController.abort()}createDarkenBackground(){this.darkenBackground=this.scene.make.image({key:$P,frame:tR.BLANK}),this.darkenBackground.setTintFill(0),this.darkenBackground.setWorldSize(this.width,this.height),this.darkenBackground.kill(),this.add(this.darkenBackground)}createGlowBackground(){this.glowBackground=this.scene.make.image({key:$P,frame:tR.ART_YELLOW_GLOW,origin:{x:.5,y:.5}}),this.add(this.glowBackground),this.glowBackground.kill()}createHighlightItem(e){this.highlightItems=[];for(let t of e){let i=t,s=this.createItem(i);if(!s)continue;let{icon:n,label:r}=s;this.highlightItems.push({icon:n,label:r}),this.add([n,r]),Phaser.Display.Align.In.Center(r,n,0,90),n.kill(),r.kill()}}createItem(e){let t=this.createItemImage(e);if(!t)return null;let i=this.createItemText(e);return this.add([t,i]),{icon:t,label:i}}createItemImage(e){let t=null;if(e.type==="coin")t=br.LUCKY_WHEEL_ICON_COIN;else switch(e.id){case K.HINT.ID:t=br.LUCKY_WHEEL_ICON_HINT;break;case K.SHUFFLE.ID:t=br.LUCKY_WHEEL_ICON_SHUFFLE;break;case K.BOMB_DEFUSE.ID:t=br.LUCKY_WHEEL_ICON_DEFUSE;break;case K.ROCKET.ID:t=br.LUCKY_WHEEL_ICON_ROCKET;break;default:return null}return this.scene.make.image({key:hG,frame:t})}createItemText(e){return X.createShadowText(this.scene,"Item Received",14).setOrigin(.5,0)}createEffects(){this.starSparkle=new ur(this.scene),this.add(this.starSparkle)}runHighlightItemAnimation(e,t){this.runShowHighlightItemAnimation(e,()=>{this.runHideHighlightItemAnimation(t)})}runShowHighlightItemAnimation(e,t){this.darkenBackground.setAlpha(0),this.starSparkle.run(2,0,0,200,200),this.darkenBackground.revive(),this.glowBackground.revive();for(let n=0;n<this.highlightItems.length;n++)n===e?(this.highlightItems[n].icon.revive(),this.highlightItems[n].label.revive()):(this.highlightItems[n].icon.kill(),this.highlightItems[n].label.kill());let i=this.animController.renew();J.runTween(this.scene.tweens.add({...ar,targets:[this.darkenBackground],duration:300,props:{alpha:{from:0,to:.8}}}),i);let s=this.highlightItems.reduce((n,{icon:r,label:o})=>(n.push(r,o),n),[]);s.push(this.glowBackground),s.push(this.starSparkle),J.runTween(this.scene.tweens.add({...rr,targets:s,duration:300,props:{scale:{from:0,to:1.4}},ease:Phaser.Math.Easing.Cubic.Out}),i),J.runTween(this.scene.tweens.add({targets:[this.glowBackground],duration:2e3,props:{angle:{from:0,to:360}},ease:Phaser.Math.Easing.Linear,onComplete:t}),i)}runHideHighlightItemAnimation(e){let t=this.animController.renew();J.runTween(this.scene.tweens.add({...Nt,targets:[this.darkenBackground],duration:300,onComplete:()=>{this.darkenBackground.kill()}}),t);let i=this.highlightItems.reduce((s,{icon:n,label:r})=>(s.push(n,r),s),[]);i.push(this.glowBackground),i.push(this.starSparkle),J.runTween(this.scene.tweens.add({...Hs,targets:i,duration:300,props:{scale:0},ease:Phaser.Math.Easing.Cubic.In,onComplete:()=>{this.glowBackground.kill();for(let s of this.highlightItems)s.icon.kill(),s.label.kill();this.starSparkle.stop(),e?.()}}),t)}};U();var{Utils:{Time:uG,Signal:cG}}=Ludex,{player:dG}=codex,pG=class extends Phaser.GameObjects.Container{label;lastUpdate=0;animController=new cG.SignalController;constructor(e){super(e),this.label=this.createLabel(),this.listenToEvents()}update(e){e-this.lastUpdate>1e3&&(this.lastUpdate=e,this.updateLabel())}revive(){super.revive(),this.runFlashingAnimation()}kill(){this.animController.abort(),super.kill()}preDestroy(){super.preDestroy(),this.animController.abort(),this.unlistenToEvents()}listenToEvents(){this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.update,this)}unlistenToEvents(){this.scene.events.off(Phaser.Scenes.Events.UPDATE,this.update,this)}createLabel(){let e=X.createText(this.scene,"Now",16).setFontStyle("700").setAlign("center");return this.add(e),e}runFlashingAnimation(){let e=this.animController.renew();J.runTween(this.scene.tweens.add({targets:[this.label],yoyo:!0,duration:700,ease:Phaser.Math.Easing.Sine.InOut,repeat:-1,props:{alpha:{from:.5,to:1}}}),e)}getNextDailySpinTimeStamp(){let{lastDailySpin:e=0}=dG.getGameData()??{},t=new Date(e);t.setHours(0,0,0,0);let i=new Date(t);return i.setDate(i.getDate()+1),i.getTime()}updateLabel(){let e=this.getNextDailySpinTimeStamp()/1e3,t=`Next Free Spin
${uG.getRelativeTime(e,"en",void 0,"soon")}`;this.label.setText(t)}},{player:Uo}=codex,{Utils:{Valid:eR}}=Ludex,{KEY:Go,FRAME:Yo}=G.DEFAULT,{KEY:Be,FRAME:Ue}=G.DASHBOARD,gG=[{type:"coin",amount:500,weight:.6/4,rarity:"common"},{type:"item",id:K.BOMB_DEFUSE.ID,amount:1,weight:.4/4,rarity:"special"},{type:"coin",amount:500,weight:.6/4,rarity:"common"},{type:"item",id:K.HINT.ID,amount:1,weight:.4/4,rarity:"special"},{type:"coin",amount:500,weight:.6/4,rarity:"common"},{type:"item",id:K.SHUFFLE.ID,amount:1,weight:.4/4,rarity:"special"},{type:"coin",amount:500,weight:.6/4,rarity:"common"},{type:"item",id:K.ROCKET.ID,amount:1,weight:.4/4,rarity:"special"}],iR=.15,fG=100,mG=70,Ho=gG,sR=2*Math.PI,nR=12,vG=1e3*60*60*24,rR=class extends At{scaleDown=.98},EG=class extends ue{xt;t;p;k;te;nt;dt;pt;ye;kt;ks=[];Lt=[];Fs=[];xi=[];ze;Si;Ai;incY(e){super.incY(e),this.te.y-=e,this.xt.y-=e}incX(e){super.incX(e),this.te.x-=e,this.xt.x-=e}incScale(e){super.incScale(e),this.te.scale-=e^e*(100/e),this.xt.scale-=e^e*(100/e)}constructor(e,t){super(e,t),this.xl(),this.$(),this.Be(),this.Hi(),this.Sl(),this.Zi(),this.Al(),this.zi(),this.setDepth(me.POPUP),Phaser.Display.Align.In.Center(this.t,this.zone,0,-40)}xl(){this.xt=this.scene.make.image({key:Xt.BACKGROUND.KEY}),this.xt.setName(Xt.BACKGROUND.KEY),this.xt.setWorldSize(this.zone.width,this.zone.height),this.xt.setAlpha(0),this.add(this.xt),Phaser.Display.Align.In.Center(this.xt,this.zone),this.moveAbove(this.background,this.xt)}$(){this.t=this.scene.add.container(0,0),this.t.setWorldSize(375,667);let e=this.scene.make.image({key:Be,frame:Ue.LUCKY_WHEEL_ARROW}),t=this.scene.make.image({key:Be,frame:Ue.LUCKY_WHEEL_KNOB});this.k=this.scene.add.container(0,0),this.k.setWorldSize(360,350),this.wl();let i=this.scene.make.image({key:Be,frame:Ue.LUCKY_WHEEL_BG});this.k.add(i),this.t.add([this.k,e,t]),this.add(this.t);let s=pt.getBannerHeight()/2;Phaser.Display.Align.In.Center(this.t,this.zone,0,-s),it.alignChildCenter(this.k,this.t),it.alignChildCenter(i,this.k),it.alignChildTopCenter(e,this.k),it.alignChildCenter(t,this.k)}wl(){for(let e=0;e<nR;e++){let t=this.scene.make.image({key:Be,frame:Ue.LUCKY_WHEEL_ICON_BULB_ON}),i=this.scene.make.image({key:Be,frame:Ue.LUCKY_WHEEL_ICON_BULB_OFF});i.setAlpha(0),this.Fs.push({on:t,off:i}),this.k.add([t,i]);let s=e*sR/nR;Phaser.Math.RotateAroundDistance(t,this.k.x,this.k.y,s,166),Phaser.Math.RotateAroundDistance(i,this.k.x,this.k.y,s,166);let n=s+Math.PI/2;t.setRotation(n),i.setRotation(n)}}Be(){this.kt=this.scene.make.image({key:Be,frame:Ue.LUCKY_WHEEL_RIBBON}),Phaser.Display.Align.To.TopCenter(this.kt,this.k,0,20),this.t.add(this.kt)}Hi(){this.It(),this.Cl(),this.Pl()}Sl(){this.ye=new pG(this.scene),this.t.add(this.ye),Phaser.Display.Align.To.BottomCenter(this.ye,this.dt,0,30),this.ye.kill()}Zi(){let e=Ho,t=0;this.xi=[],this.ks=[];for(let i=0;i<e.length;i++){let s=e[i],{weight:n}=s,r=this.ys(s,i%2===0);if(!r)continue;t+=n,t>1&&(t=1),this.xi.push(t);let{icon:o,label:a}=r;this.ks.push(o);let{mid:h}=this.$n(i);Phaser.Math.RotateAroundDistance(o,this.k.x,this.k.y,h,fG),Phaser.Math.RotateAroundDistance(a,this.k.x,this.k.y,h,mG);let l=h+Math.PI/2;o.setRotation(l),a.setRotation(l)}}Al(){this.te=new lG(this.scene,this.zone.width,this.zone.height,Ho),this.t.add(this.te),Phaser.Display.Align.In.Center(this.te,this.t)}zi(){this.nt.setButtonHitSoundEffect(ut.CLOSE_POPUP_CLICK),this.nt.onClick=this.$e.bind(this),this.pt.setButtonHitSoundEffect(ut.GENERAL_BUTTON_CLICK),this.pt.onClick=this.tr.bind(this),this.dt.setButtonHitSoundEffect(ut.GENERAL_BUTTON_CLICK),this.dt.onClick=this.tr.bind(this)}Rl(e){if(e.type==="coin")return this.scene.make.image({key:Be,frame:Ue.LUCKY_WHEEL_ICON_COIN});switch(e.id){case K.HINT.ID:return this.scene.make.image({key:Be,frame:Ue.LUCKY_WHEEL_ICON_HINT});case K.SHUFFLE.ID:return this.scene.make.image({key:Be,frame:Ue.LUCKY_WHEEL_ICON_SHUFFLE});case K.BOMB_DEFUSE.ID:return this.scene.make.image({key:Be,frame:Ue.LUCKY_WHEEL_ICON_DEFUSE});case K.ROCKET.ID:return this.scene.make.image({key:Be,frame:Ue.LUCKY_WHEEL_ICON_ROCKET})}return null}bl(e,t){let i=e.type==="coin"?e.amount.toString():`x${e.amount}`,s=X.createText(this.scene,i,16).setFontStyle("700").setOrigin(.5,0);return s.setTint(t?10243599:16777215),s}ys(e,t){let i=this.Rl(e);if(!i)return null;let s=this.bl(e,t);return this.k.add(i),this.k.add(s),{icon:i,label:s}}It(){this.nt=new At(this.scene,Go,Yo.BUTTON_CLOSE),this.nt.setName("Close"),this.t.add(this.nt),Phaser.Display.Align.To.RightCenter(this.nt,this.kt,5,0)}Cl(){this.dt=new rR(this.scene,Go,Yo.BUTTON_GREEN),this.dt.setName("Spin");let e=X.createText(this.scene,"Spin Now",18).setFontStyle("900");X.applyGreenStyle(e),this.dt.add(e),Phaser.Display.Align.In.Center(e,this.dt),this.t.add(this.dt),Phaser.Display.Align.In.BottomCenter(this.dt,this.k,0,80)}Pl(){this.pt=new rR(this.scene,Go,Yo.BUTTON_GREEN);let e=X.createText(this.scene,"Get Spin",18).setFontStyle("900");X.applyGreenStyle(e);let t=this.scene.make.image({key:Go,frame:Yo.ICON_ADS});this.pt.add([t,e]),Phaser.Display.Align.In.Center(e,this.pt,15),Phaser.Display.Align.In.Center(t,this.pt,-45,0),this.pt.setName("GetSpin"),this.t.add(this.pt),Phaser.Display.Align.In.BottomCenter(this.pt,this.k,0,80)}open(e){super.open(e),e?.coinBar instanceof ao&&(this.p=e.coinBar),this.k.setRotation(0),this.et(),this.er()}$e(){this.l()}spin(){this.pt.setDisabled(!0),this.dt.setDisabled(!0),this.nt.setDisabled(!0);let{index:e,item:t}=this.Il();this._l(t);let{min:i,max:s}=this.$n(e),n=Phaser.Math.FloatBetween(-s+iR-Math.PI/2,-i-iR-Math.PI/2),r=Phaser.Math.Between(6,8)*sR,o=this.k.rotation,a=Phaser.Math.Angle.Normalize(o),h=n+r,l=Phaser.Math.RadToDeg(a),u=Phaser.Math.RadToDeg(h),d=()=>{this.nt.setDisabled(!1),this.er()};this.Ol(l,u,()=>{this.Ml(t),t.type==="item"?this.te.runHighlightItemAnimation(e,d):this.re(e,t,d)})}Ml(e){switch(e.rarity){case"common":nt.playSound(ut.WHEEL_GET_COMMON);break;case"special":nt.playSound(ut.WHEEL_GET_SPECIAL);break}}async Ll(){await this.Dl()&&this.spin()}tr(){this.ir()?this.spin():this.Ll()}er(){this.ir()?(this.dt.setDisabled(!1),this.dt.revive(),this.pt.setDisabled(!0),this.pt.kill(),this.ye.kill()):(this.dt.setDisabled(!0),this.dt.kill(),this.pt.setDisabled(!1),this.pt.revive(),this.ye.revive())}_l(e){let t=Date.now();if(Uo.setGameData({lastDailySpin:t}),e.type==="coin"){$i.addCoin(e.amount);return}let{items:i={}}=Uo.getGameData()??{};if(!eR.isObject(i))return;let s=i[e.id];eR.isNumber(s)&&Uo.setGameData({items:{...i,[e.id]:s+e.amount}})}$n(e){let t=Ho,i=e*(Math.PI*2)/t.length,s=Math.PI*2/t.length;return{min:i-s/2,mid:i,max:i+s/2}}Il(){let e=Ho,t=Math.random();for(let i=0;i<this.xi.length;i++){let s=this.xi[i];if(t<=s)return{index:i,item:e[i]}}return{index:e.length-1,item:e[e.length-1]}}async Dl(){try{return await pt.showRewardVideoAdAsync()?(nt.playSound(ut.DAILY_REWARD),!0):!1}catch{return!1}}et(){this.background.setAlpha(0),this.animateBackgroundAlpha(.8,500),this.kl(0,200),this.ft(),this.Wt(),this.Fl()}ir(){let{lastDailySpin:e=0}=Uo.getGameData()??{},t=new Date(e);return t.setHours(0,0,0,0),Date.now()-t.getTime()>vG}l(){this.animateBackgroundAlpha(0,150),this.Nl(0,150),this.ht(),this.Bl(),this.p?.revertDepth()}ft(){let e=pt.getBannerHeight()/2,t=this.scene.tweens.add({...se,targets:[this.t],duration:400,props:{...se.props,y:{from:350-e,to:-e},alpha:{start:0,from:0,to:1},scale:{start:0,from:0,to:1}}});J.runTween(t)}Wt(){let e=this.scene.tweens.add({targets:[this.k],duration:800,props:{angle:{from:-180,to:0}},ease:Phaser.Math.Easing.Sine.Out});J.runTween(e)}kl(e,t){J.runTween(this.scene.tweens.add({...ar,targets:[this.xt],delay:e,duration:t}))}ht(){let e=pt.getBannerHeight()/2,t=this.scene.tweens.add({...Nt,targets:[this.t],duration:200,props:{...Nt.props,y:250-e,scale:0}});J.runTweenAsync(t).then(()=>{this.t.setY(0),ot.closeScreen(this.name)})}Nl(e,t){J.runTween(this.scene.tweens.add({...Nt,targets:[this.xt],delay:e,duration:t}))}Ol(e,t,i){this.ze?.stop(),this.ze?.remove(),this.ze?.off(Phaser.Tweens.Events.TWEEN_COMPLETE);let s=Math.floor((e+22.5)/45),n=0;this.ze=this.scene.tweens.add({targets:[this.k],duration:6e3,props:{angle:{from:e,to:t}},ease:Phaser.Math.Easing.Quintic.Out,onUpdate:r=>{let o=r.progress,a=Phaser.Math.Easing.Quintic.Out(o),h=Phaser.Math.Linear(e,t,a),l=Math.floor((h+22.5)/45),u=Date.now();l!==s&&u-n>70&&(nt.playSound(ut.WHEEL_CLICK),s=l,n=u)}}),J.runTweenAsync(this.ze).then(i)}re(e,t,i){if(!this.p)return;let s=this.ks[e].getWorldPosition(),n=this.p.getWorldPosition(),r=this.Re().explode(10,s.x,s.y,n.x,n.y);this.p?.bringThisToTop();let o=this.scene.tweens.add({targets:this.p,duration:300,props:{alpha:{start:0,from:0,to:1}}}),a=this.scene.tweens.add({targets:this.p,paused:!0,duration:100,delay:200,props:{alpha:{start:1,from:1,to:0}},onComplete:()=>{this.p?.setAlpha(1),this.p?.revertDepth(),i?.()}});J.runTween(o);let h=0;for(let l of r)l.once(Phaser.Tweens.Events.TWEEN_COMPLETE,()=>{let u=Math.floor(t.amount/10);$i.addCoin(u),h++,h===r.length&&J.runTween(a)})}Re(){let e=this.Lt.find(i=>!i.isActive);if(e)return e;let t=new Cd(this.p?.scene??this.scene);return this.Lt.push(t),t}Fl(){if(!this.Si){let e=this.Fs.map(({on:t,off:i},s)=>s%2===0?t:i);this.Si=this.scene.tweens.add({targets:e,repeat:-1,repeatDelay:200,hold:200,duration:200,yoyo:!0,ease:Phaser.Math.Easing.Sine.InOut,props:{alpha:{from:0,to:1}},persist:!0})}if(!this.Ai){let e=this.Fs.map(({on:t,off:i},s)=>s%2===1?t:i);this.Ai=this.scene.tweens.add({targets:e,repeat:-1,repeatDelay:200,hold:200,duration:200,yoyo:!0,ease:Phaser.Math.Easing.Sine.InOut,props:{alpha:{from:1,to:0}},persist:!0})}J.runTween(this.Si),J.runTween(this.Ai)}Bl(){this.Si?.stop(),this.Ai?.stop()}},yG=EG;U(),U(),U(),U();var ki={targets:[],props:{alpha:{start:0,to:1,duration:500,ease:Phaser.Math.Easing.Cubic.Out},scale:{start:.8,to:1,duration:1e3,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]},y:{start:0,to:0,duration:500,ease:Phaser.Math.Easing.Back.Out}},delay:0},TG=class{config;tween;scene;constructor(e){this.config={...ki,...e};let{scene:t}=this.config.targets[0];t&&(this.scene=t,this.tween=this.scene.tweens.add(this.config))}play(){this.tween.play()}},Pp=TG,{KEY:xG,FRAME:SG}=G.CHALLENGE,{KEY:Rp,FRAME:cs}=G.TOURNAMENTS,AG=class extends Phaser.GameObjects.Container{scene;popup;avatar;username;score;rank;rankBackground;payload;showPopUp;constructor(e){super(e),this.scene=e,this.setSize(320,56.5),this.createAvatar(),this.createPopup(),this.createUsername(),this.createScore(),this.createRankBackground(),this.createRank()}createPopup(){this.popup=this.scene.add.container(0,0),this.popup.setSize(320,56.5);let e=this.scene.make.image({key:Rp,frame:cs.ROLL_BAR});e.setWorldSize(320,56.5),this.popup.add(e),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this),this.setSize(320,56.5)}createAvatar(){this.avatar=new ss(this.scene,{key:xG,background:SG.AVATAR,width:33,height:33}),this.avatar.background.setWorldSize(33,33),this.avatar.loading.setWorldSize(33*.5,33*.5),this.add(this.avatar),Phaser.Display.Align.In.LeftCenter(this.avatar,this,-51,-4)}createUsername(){this.username=X.createText(this.scene,"",15).setOrigin(0,.5).setTint(8275998).setFontStyle("700"),X.setTruncateOverflow(this.username,120),this.add(this.username),Phaser.Display.Align.In.LeftCenter(this.username,this.popup,-95,-2)}createClock(){let e=this.scene.make.image({key:Rp,frame:cs.ICON_TIME});e.setWorldSize(26.5,28),this.add(e),Phaser.Display.Align.In.RightCenter(e,this.popup,-80,-2)}createScore(){this.score=X.createText(this.scene,"",15).setTint(15854543).setShadow(0,3,"#846843",.5).setFontStyle("700"),this.add(this.score),Phaser.Display.Align.In.RightCenter(this.score,this.popup,-56,-2)}createRank(){this.rank=X.createText(this.scene,"",17).setTint(16776955).setShadow(0,3,"#896941",.5).setFontStyle("700"),this.add(this.rank),Phaser.Display.Align.In.LeftCenter(this.rank,this.popup,-24,-2)}createRankBackground(){this.rankBackground=this.scene.make.image({key:Rp,frame:cs.RANK_BACKGROUND}),this.rankBackground.setWorldSize(28.5,28.5),this.add(this.rankBackground),Phaser.Display.Align.In.LeftCenter(this.rankBackground,this.popup,-12,-2)}async updateInfo(e){this.payload=e;let{name:t,score:i,rank:s,photo:n,playerId:r}=e;this.username.setText(t),this.score.setText(i.toString()),this.avatar.loadPhoto(r,n,40),this.updateRank(s)}updateRank(e){e<=3?(this.rank.setVisible(!1),e===1?this.rankBackground.setFrame(cs.MEDAL_GOLD):e===2?this.rankBackground.setFrame(cs.MEDAL_SILVER):e===3&&this.rankBackground.setFrame(cs.MEDAL_BRONZE)):(this.rank.setVisible(!0),this.rank.setText(e.toString()),this.rankBackground.setFrame(cs.RANK_BACKGROUND)),this.rankBackground.setWorldSize(28.5,28.5)}async runShowPopUpAnimation(e,t){this.scene.tweens.killTweensOf(this);let i=this.y;return this.showPopUp=new Pp({targets:[this],delay:e,duration:t,props:{...ki.props,y:{...ki.props?.y,start:this.y+70,to:this.y}},onStop:()=>{this.y=i}}),this.showPopUp.play(),new Promise(s=>{this.scene.time.delayedCall(e+t+500,()=>{s()})})}runShowItemAnimation(e,t){let i=this.getItems();this.scene.tweens.killTweensOf(i);for(let s of i)s.setScale(s.type==="Image"?.5:1);this.scene.tweens.add({targets:i,duration:t,delay:this.scene.tweens.stagger(50,{start:e+50}),props:{alpha:{duration:500,value:{start:0,from:0,to:1},ease:Phaser.Math.Easing.Cubic.Out},scale:{duration:800,start:.8,end:1,value:{start:.8,from:.8,to:1},ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]}}})}getItems(){return[this.rank,this.username,this.score]}async runShowUpAnimation(e=0,t=300){let i=e*100;this.runShowItemAnimation(i,t),await this.runShowPopUpAnimation(i,t)}},aR=AG;U();var{KEY:oR,FRAME:ds}=G.DEFAULT,hR=[ds.LOADING_SCREEN_TILE_ICON_1,ds.LOADING_SCREEN_TILE_ICON_2,ds.LOADING_SCREEN_TILE_ICON_3,ds.LOADING_SCREEN_TILE_ICON_4,ds.LOADING_SCREEN_TILE_ICON_5],wG=class extends Phaser.GameObjects.Container{background;icon;anim;constructor(e){super(e,0,0),this.createBackground(),this.createIcon(),this.scene.add.existing(this)}createBackground(){this.background=this.scene.make.image({key:oR,frame:ds.LOADING_SCREEN_TILE_BG}),this.add(this.background)}createIcon(){this.icon=this.scene.make.image({key:oR,frame:ds.LOADING_SCREEN_TILE_ICON_1}),this.add(this.icon),Phaser.Display.Align.In.Center(this.icon,this.background)}runAnimation(){this.icon.setFrame(hR[Phaser.Math.Between(0,hR.length-1)]),this.anim=this.scene.tweens.add({targets:[this],repeat:-1,props:{angle:{from:0,to:360}},duration:1500,ease:Phaser.Math.Easing.Cubic.InOut})}setVisible(e){return super.setVisible(e),e?this.runAnimation():(this.anim.stop(),this.scene.tweens.remove(this.anim)),this}},lR=wG,CG=class extends Phaser.GameObjects.Container{scene;loading;scroller;constructor(e){super(e),this.scene=e,this.createLoading(),this.createScroller()}createLoading(){this.loading=new lR(this.scene),this.add(this.loading),Phaser.Display.Align.In.Center(this.loading,this,0,30)}showLoading(e){this.loading.setVisible(e)}createScroller(){this.scroller=new ro(this.scene,{size:{width:335,height:240},visual:{spacing:2,margin:5},reuse:{ClassType:aR,configs:[],update:(e,t)=>{e.updateInfo(t)}}}),this.scroller.setPosition(0,40),this.add(this.scroller),this.hideLeaders()}hideLeaders(){this.scroller.setVisible(!1)}async showLeaders(){this.scroller.setVisible(!0),this.scroller.setEnabled(!1),this.scroller.scrollToTop(!0);let e=this.getLeaders(),t=Math.min(e.length,4),i=150,s=[];for(let n=0;n<t;n++){let r=e[n];if(!r)continue;r.setVisible(!0);let o=r.runShowUpAnimation(n,i);s.push(o)}await Promise.all(s),this.scroller.setEnabled(!0)}getLeaders(){return this.scroller.getChildren()}updateLeaders(e){this.scroller.setConfigs(e.leaders)}},PG=CG;U();var{leaderboard:dn}=codex,uR=class GR{static _instance;static get inst(){return this._instance||(this._instance=new GR),this._instance}static async getAllLeaderboardAsync(t){if(!dn)return null;let i=dn.getLeaderboardName(t);if(!i)return null;let s=await dn.getLeaderboardResponseAsync(t);return s?(await this.requestLeaderboardAsync(i,s.amountPlayer),dn.getLeaderboard(i)):null}static async requestLeaderboardAsync(t,i){if(this.isLeaderboardRequesting(t)){await this.waitForLeaderboardFinishAsync(t);return}await dn.requestLeaderboardAsync(t,i)}static async waitForLeaderboardFinishAsync(t){if(this.isLeaderboardRequesting(t))return new Promise(i=>{let s=setInterval(()=>{this.isLeaderboardRequesting(t)||(clearInterval(s),i())},100)})}static isLeaderboardRequesting(t){return dn.getLeaderboard(t)?.isRequesting||!1}};try{new uR}catch{}var cR=uR;U();var{KEY:RG,FRAME:bG}=G.CHALLENGE,{KEY:zo,FRAME:ps}=G.TOURNAMENTS,IG=class extends Phaser.GameObjects.Container{scene;glow;avatar;rank;crown;showPopUp;constructor(e,t){super(e),this.scene=e;let i=60;this.setSize(i,i),t===0&&(this.createGlow(),this.createCrown()),this.createAvatar(i),this.createRank(i)}createGlow(){this.glow=this.scene.make.image({key:zo,frame:ps.GLOW}),this.add(this.glow),this.scene.tweens.add({targets:this.glow,props:{angle:{from:0,to:360}},duration:5e3,repeat:-1})}createAvatar(e){this.avatar=new ss(this.scene,{key:RG,background:bG.AVATAR,width:e,height:e}),this.avatar.background.setWorldSize(e,e),this.avatar.loading.setWorldSize(e*.5,e*.5);let t=this.scene.make.image({key:zo,frame:ps.AVATAR_BORDER});this.add([this.avatar,t]),Phaser.Display.Align.In.Center(this.avatar,this),Phaser.Display.Align.In.Center(t,this)}createRank(e){this.rank=this.scene.make.image({key:zo,frame:ps.RANK_BACKGROUND}),this.rank.setWorldSize(e*.5,e*.5),this.add(this.rank),Phaser.Display.Align.In.BottomCenter(this.rank,this.avatar,0,15)}createCrown(){this.crown=this.scene.make.image({key:zo,frame:ps.CROWN}),this.add(this.crown),Phaser.Display.Align.In.Center(this.crown,this,0,-35)}updateInfo(e){let{rank:t,photo:i,playerId:s}=e;this.avatar.loadPhoto(s,i,60),t===1?this.rank.setFrame(ps.MEDAL_GOLD):t===2?this.rank.setFrame(ps.MEDAL_SILVER):t===3&&this.rank.setFrame(ps.MEDAL_BRONZE)}async runShowPopUpAnimation(e,t=300){this.scene.tweens.killTweensOf(this);let i=e*100,s=this.y;return this.showPopUp=new Pp({targets:[this],delay:i,duration:t,props:{...ki.props,scale:{...ki.props?.scale,to:e===0?1:.9},y:{...ki.props?.y,start:this.y+10,to:this.y}},onStop:()=>{this.y=s}}),this.showPopUp.play(),new Promise(n=>{this.scene.time.delayedCall(i+t+500,()=>{n()})})}},_G=IG;U();var{Utils:{String:OG,Valid:Wo,Array:MG},Configs:{Mockup:{Leaderboards:LG}}}=Ludex,{leaderboard:bp,player:dR}=codex,DG=class Ti{static _instance;globalTournamentLBData=[];playerTournaments=[];tournamentData=[];maxTimeRefetch=5e3;lastFetchTournamentsData=0;lastFetchGlobalTournament=0;static getInstance(){return this._instance||(this._instance=new Ti),this._instance}fetchGlobalTournamentLeaderboardAsync=async()=>{try{Date.now()-this.lastFetchGlobalTournament>this.maxTimeRefetch&&(this.globalTournamentLBData=await bp.requestLeaderboardsAsync({limit:100,type:"world_tournament_leaderboard"}),this.globalTournamentLBData.sort((t,i)=>{let s=t.expireTime,n=i.expireTime;return s-n}))}catch{}return this.globalTournamentLBData};fetchTournamentsAsync=async()=>{try{Date.now()-this.lastFetchTournamentsData>this.maxTimeRefetch&&(this.playerTournaments=await GameSDK.tournament.getTournamentsAsync(),this.playerTournaments.sort((t,i)=>{let s=t.getEndTime(),n=i.getEndTime();return s-n}))}catch{}return this.playerTournaments};static async requestTournamentDataAsync(){let t=Ti.getInstance();await Promise.all([t.fetchTournamentsAsync(),t.fetchGlobalTournamentLeaderboardAsync()]);let i=t.processPlayerTournamentData(),s=t.processGlobalTournamentLeaderboardData();i.sort((n,r)=>n.endTime-r.endTime),s.sort((n,r)=>n.endTime-r.endTime),t.tournamentData=[...s,...i];for(let n of t.tournamentData){let{payload:r}=n,{leaderboardId:o}=r;o&&(bp.isExistLeaderboardId(o)||bp.addLeaderboard({type:"tournament",name:o,autoSortRank:!0,leaderboardId:o}))}return t.tournamentData}static getAllTournamentData(){return Ti.getInstance().tournamentData}static getTournamentDataById(t){let i=Ti.getInstance();return MG.search(i.tournamentData,s=>s.id===t)}static getPlayerTournamentData(){let t=Ti.getInstance(),i=dR.getPlayerId();return t.tournamentData.filter(s=>{let{payload:n}=s;return n.playerId===i})}static getFriendsTournamentData(){let t=Ti.getInstance(),i=dR.getPlayerId();return t.tournamentData.filter(s=>{let{payload:n}=s;return n.playerId!==i&&n.playerId!=="global"})}static getGlobalTournamentData(){return Ti.getInstance().tournamentData.filter(t=>{let{payload:i}=t;return i.playerId==="global"})}static validateTournamentExpired(t){let i=Ti.getTournamentDataById(t);if(!i)return!1;let{endTime:s}=i;return s<Date.now()/1e3}processPlayerTournamentData(){let t=[];for(let i of this.playerTournaments){if(!i)continue;let s=`${i.getID()}`,n=i.getContextID(),r=i.getEndTime(),o=this.parseTournamentPayload(i.getPayload());if(!this.validateGameSDKTournamentPayload(o)||r<Date.now()/1e3)continue;let a=i.getTournamentType();if(a==="PAGE_HOSTED")continue;let h=o.playerName??"Player",l={id:s,title:i.getTitle()??this.createDefaultTournamentName(h),endTime:r,contextId:n,payload:o,tournamentType:a};t.push(l)}return t}processGlobalTournamentLeaderboardData(){let t=[],{Enabled:i}=LG;if(i){for(let s of this.playerTournaments){let n=s.getTournamentType();if(n!=="PAGE_HOSTED")continue;let r=`${s.getID()}`,o=s.getContextID(),a=s.getEndTime(),h=this.parseTournamentPayload(s.getPayload()),l={id:r,title:s.getTitle()??"Global Tournament",endTime:a,contextId:o,payload:h,tournamentType:n};t.push(l)}return t}for(let s of this.globalTournamentLBData){let n;try{n=JSON.parse(s.description)}catch{continue}if(!this.validateExpireTime(s)||!this.validateGlobalTournamentPayload(n))continue;let r=s.name,o={id:n.tournamentId,title:r,endTime:this.getTournamentEndTime(s),contextId:n.contextId,payload:{playerId:"global",playerName:"global",leaderboardId:s._id},tournamentType:"PAGE_HOSTED"};t.push(o)}return t}validateGlobalTournamentPayload(t){let{tournamentId:i,contextId:s}=t;return!(!Wo.isString(i)||i===""||!Wo.isString(s)||s==="")}getTournamentEndTime(t){let i=new Date(t.createdAt).getTime();return Math.round((t.expireTime*1e3+i)/1e3)}validateExpireTime(t){return this.getTournamentEndTime(t)*1e3-Date.now()>0}validateGameSDKTournamentPayload(t){return!(!Wo.isString(t.playerId)||t.playerId===""||!Wo.isString(t.leaderboardId)||t.leaderboardId==="")}createDefaultTournamentName(t){let i=t.substring(0,7),s=`${i.split(" ")[0]||i}'s Tournament`;return`${OG.removeDiacritics(s)}`}parseTournamentPayload(t){if(typeof t!="string")return{};try{return JSON.parse(t)}catch{return{}}}},Ip=DG;U();var{KEY:kG,FRAME:FG}=G.EFFECTS,NG=class extends Phaser.GameObjects.Container{emitZone;emitter;constructor(e){super(e),this.scene=e,this.createEmitZone(),this.createEmitters(),this.kill()}createEmitZone(){this.emitZone=new Phaser.Geom.Rectangle}createEmitters(){this.emitter=this.scene.add.particles(0,0,kG,{frame:FG.FX_STAR_YELLOW,emitZone:{source:this.emitZone,type:"random"},speed:{min:50,max:150},scale:{start:1.2,end:0,ease:Phaser.Math.Easing.Quartic.Out},lifespan:{min:600,max:1e3},emitting:!0}),this.add(this.emitter)}explode(e,t,i,s,n){this.revive(),this.emitZone.setSize(s,n),this.emitZone.setPosition(t-s/2,i-n/2),this.emitter.explode(e)}},BG=NG,{Utils:{Object:UG,String:GG,Array:pR}}=Ludex,{event:Vo,player:YG,storage:_p}=codex,{KEY:Ir,FRAME:_r}=G.DEFAULT,{KEY:HG,FRAME:zG}=G.CHALLENGE,{KEY:Ei,FRAME:yi}=G.TOURNAMENTS,WG=class extends ue{popup;tournamentName;tournamentTime;closeButton;playButton;replayButton;shareButton;tournamentLeaders;topLeaders;emptyLabel;tournamentPayload;leadersPayload;previousLeadersPayload;popupShowUpAnimation;popupFadeOutAnimation;starSparkleUp;starSparkleExplosive;countdownTimer;tempPlayerLeader;shineTempPlayerLeader;signalController=new Ludex.Utils.Signal.SignalController;constructor(e,t){super(e,t),this.createPopup(),this.createMiddleBackground(),this.createTournamentLeaders(),this.createTopAndBottomBackground(),this.createRibbon(),this.createTitle(),this.createTournamentName(),this.createTournamentTime(),this.createCloseButton(),this.createPlayButton(),this.createReplayButton(),this.createShareButton(),this.createTempPlayerLeader(),this.createTopLeaders(),this.createEmptyLabel(),this.createEffects(),this.resizePopup(),this.setDepth(me.POPUP),this.background.setAlpha(.8)}listenEvents(){Vo.on(yt.VIEW_RESIZED,this.resizePopup),Vo.on(yt.LAYOUT_CHANGED,this.resizePopup)}unlistenEvents(){Vo.off(yt.VIEW_RESIZED,this.resizePopup),Vo.off(yt.LAYOUT_CHANGED,this.resizePopup)}open(e){super.open(e),this.listenEvents(),this.tournamentPayload=e.tournamentPayload;let{title:t,endTime:i}=this.tournamentPayload;this.tournamentName.setText(this.getTournamentName(t)),this.getRemainingTime(i)>0&&(this.countdownTimer?.remove(),this.tournamentTime.setText(this.getTournamentTime(i)),this.countdownTimer=this.scene.time.addEvent({delay:1e3,callback:()=>{if(this.getRemainingTime(i)<=0){this.countdownTimer?.remove();return}this.tournamentTime.setText(this.getTournamentTime(i))},callbackScope:this,loop:!0})),this.setButtonInteractable(!0),this.updateLeaders(this.tournamentPayload),this.background.setAlpha(0),this.animateBackgroundAlpha(.8,400),this.runPopupEntrancesAnimation(),e.tournamentContext==="tournament_end"?(this.playButton.setVisible(!1),this.replayButton.setVisible(!0),this.shareButton.setVisible(!0)):(this.playButton.setVisible(!0),this.replayButton.setVisible(!1),this.shareButton.setVisible(!1))}close=()=>{super.close(),this.unlistenEvents(),this.countdownTimer?.remove(),this.signalController.abort()};async updateLeaders(e){this.emptyLabel.setVisible(!1);let{leaderboardId:t}=e.payload;if(!t)return;this.tournamentLeaders.hideLeaders(),this.tournamentLeaders.showLoading(!0),this.starSparkleUp.stop();for(let s of this.topLeaders)s.setVisible(!1);let i=this.signalController.renew();if(this.leadersPayload=await this.getLeadersPayload(t),!i.aborted){if(this.previousLeadersPayload=this.getPreviousLeadersPayload(),_p.setStorageData("Tournament","showResult",!1),this.tournamentLeaders.showLoading(!1),this.leadersPayload.leaders.length===0){this.emptyLabel.setVisible(!0);return}if(this.tournamentLeaders.updateLeaders(this.previousLeadersPayload??this.leadersPayload),await this.tournamentLeaders.showLeaders(),!i.aborted&&(await new Promise(s=>{this.leadersPayload.player||s(),this.previousLeadersPayload?.player?.rank?(this.tournamentLeaders.scroller.setEnabled(!1),this.tournamentLeaders.scroller.scrollToConfigWithTween(this.previousLeadersPayload.player.rank-2,!1,()=>{s()})):this.leadersPayload.player&&(this.tournamentLeaders.scroller.scrollToConfig(this.leadersPayload.player.rank-1),s())}),!i.aborted&&(await this.runRankUpAnimation(),!i.aborted))){this.starSparkleUp.run(1,0,-150,60,60);for(let s=0;s<3;s++){let n=this.topLeaders[s],r=this.leadersPayload.leaders[s];r&&(n.setVisible(!0),n.updateInfo(r),n.runShowPopUpAnimation(s))}}}}handleClose=()=>{this.setButtonInteractable(!1),this.animateBackgroundAlpha(0,200),this.runPopupExitsAnimation()};createPopup(){this.popup=this.scene.add.container(0,0),this.popup.setSize(354,534),this.add(this.popup);let e=pt.getBannerHeight()/2;Phaser.Display.Align.In.Center(this.popup,this.zone,0,-e)}createMiddleBackground(){let e=this.scene.make.image({key:Ei,frame:yi.LONG_POPUP_MIDDLE});this.popup.add(e),it.alignChildCenter(e,this.popup,0,68)}createTopAndBottomBackground(){let e=this.scene.make.image({key:Ei,frame:yi.LONG_POPUP_TOP}),t=this.scene.make.image({key:Ei,frame:yi.LONG_POPUP_BOTTOM});this.popup.add([e,t]),it.alignChildTopCenter(e,this.popup,0,0),it.alignChildBottomCenter(t,this.popup,0,0)}createRibbon(){let e=this.scene.make.image({key:Ei,frame:yi.RIBBON});this.popup.add(e),it.alignChildTopCenter(e,this.popup,0,25)}createTitle(){let e=this.scene.make.image({key:Ei,frame:yi.RANKING_TEXT});this.popup.add(e),it.alignChildTopCenter(e,this.popup,0,10)}createTournamentName(){this.tournamentName=X.createShadowText(this.scene,"",18).setFontStyle("700").setTint(16576668),X.setTruncateOverflow(this.tournamentName,230),this.popup.add(this.tournamentName),it.alignChildTopCenter(this.tournamentName,this.popup,0,-30)}createTournamentTime(){let e=this.scene.make.image({key:Ei,frame:yi.PANEL_CLOCK});this.tournamentTime=X.createText(this.scene,"",15).setFontStyle("700"),X.applyYellowStyle(this.tournamentTime);let t=this.scene.make.image({key:Ei,frame:yi.ICON_TIME});this.popup.add(e),this.popup.add(this.tournamentTime),this.popup.add(t),it.alignChildCenter(e,this.popup,0,-70),Phaser.Display.Align.In.Center(this.tournamentTime,e,3,0),Phaser.Display.Align.In.LeftCenter(t,e,13,0)}createCloseButton(){this.closeButton=new At(this.scene,Ei,yi.X,36,37),this.closeButton.setName("Close"),this.closeButton.onClick=this.handleClose,this.closeButton.setButtonHitSoundEffect(ut.CLOSE_POPUP_CLICK),this.popup.add(this.closeButton),it.alignChildTopRight(this.closeButton,this.popup,-15,-16)}createPlayButton(){this.playButton=new At(this.scene,Ir,_r.BUTTON_GREEN,139.5,45.5),this.playButton.setName("Play");let e=X.createText(this.scene,"Join",22).setFontStyle("900");X.applyGreenStyle(e);let t=this.scene.make.image({key:HG,frame:zG.ICON_CONTINUE});this.playButton.add(e),this.playButton.add(t),this.popup.add(this.playButton),Phaser.Display.Align.In.Center(e,this.playButton,13,0),Phaser.Display.Align.In.Center(t,this.playButton,-30,0),it.alignChildBottomCenter(this.playButton,this.popup,0,-23),this.playButton.onClick=this.handlePlayButtonClicked}createReplayButton(){this.replayButton=new At(this.scene,Ir,_r.BUTTON_YELLOW,139.5,45.5),this.replayButton.setName("Replay");let e=X.createText(this.scene,"Replay",18).setTint(16777215,16777215,16770463,16770463).setShadow(0,3,"#b27f34",.5).setStroke("#b27f34",2).setFontStyle("900"),t=this.scene.make.image({key:Ir,frame:_r.ICON_REPLAY});this.replayButton.add(e),this.replayButton.add(t),this.popup.add(this.replayButton),Phaser.Display.Align.In.Center(e,this.replayButton,10,0),Phaser.Display.Align.In.Center(t,this.replayButton,-40,0),it.alignChildBottomCenter(this.replayButton,this.popup,-80,-23),this.replayButton.onClick=this.handleOnReplayButtonClicked}createShareButton(){this.shareButton=new At(this.scene,Ir,_r.BUTTON_BLUE,139.5,45.5),this.shareButton.setName("Share");let e=X.createText(this.scene,"Share",18).setFontStyle("900");X.applyBlueStyle(e);let t=this.scene.make.image({key:Ir,frame:_r.ICON_SHARE});this.shareButton.add(e),this.shareButton.add(t),this.popup.add(this.shareButton),Phaser.Display.Align.In.Center(e,this.shareButton,10,0),Phaser.Display.Align.In.Center(t,this.shareButton,-40,0),it.alignChildBottomCenter(this.shareButton,this.popup,80,-23),this.shareButton.onClick=this.handleOnShareButtonClicked}createTournamentLeaders(){this.tournamentLeaders=new PG(this.scene),this.popup.add(this.tournamentLeaders),it.alignChildCenter(this.tournamentLeaders,this.popup,0,30)}createTempPlayerLeader(){this.tempPlayerLeader=new aR(this.scene),this.shineTempPlayerLeader=this.scene.make.image({key:Ei,frame:yi.ROLL_BAR}),fo.inst.setBlendModeWithPerf(this.shineTempPlayerLeader,Phaser.BlendModes.ADD),this.shineTempPlayerLeader.setAlpha(0),this.popup.add(this.tempPlayerLeader),this.tempPlayerLeader.add(this.shineTempPlayerLeader),it.alignChildCenter(this.tempPlayerLeader,this.popup,0,40),this.tempPlayerLeader.setVisible(!1)}createTopLeaders(){this.topLeaders=[];for(let e=0;e<3;e++){let t=new _G(this.scene,e);this.topLeaders.push(t),this.popup.add(t)}it.alignChildTopCenter(this.topLeaders[0],this.popup,0,-90),it.alignChildTopCenter(this.topLeaders[1],this.popup,-90,-100),it.alignChildTopCenter(this.topLeaders[2],this.popup,90,-100),this.topLeaders[1].setScale(.9),this.topLeaders[2].setScale(.9)}createEmptyLabel(){this.emptyLabel=X.createText(this.scene,`Be the first to join
this epic tournament!`,18).setAlign("center").setTint(16374700).setFontStyle("700"),this.popup.add(this.emptyLabel),it.alignChildCenter(this.emptyLabel,this.popup,0,60)}createEffects(){this.starSparkleUp=new ur(this.scene),this.starSparkleExplosive=new BG(this.scene),this.popup.add([this.starSparkleUp,this.starSparkleExplosive])}resizePopup=()=>{let{height:e}=lt.getWorldSize();if(e>700){this.popup.setScale(1);return}this.popup.setScale(e/700)};getTournamentName(e){let t=e.substring(0,28);return GG.removeDiacritics(t)}getTournamentTime(e){let t=(e*1e3-Date.now())/1e3,i=Math.floor(t/86400),s=Math.floor(t%86400/3600),n=Math.floor(t%3600/60),r=Math.floor(t%60);return`${i}:${String(s).padStart(2,"0")}:${String(n).padStart(2,"0")}:${String(r).padStart(2,"0")}`}getRemainingTime(e){return e*1e3-Date.now()}handlePlayButtonClicked=async()=>{await this.processPlayTournament(2,0)};handleOnReplayButtonClicked=async()=>{this.handlePlayButtonClicked()};handleOnShareButtonClicked=async()=>{if(!this.leadersPayload.player){ot.showNotificationScreen("Sorry, unable to share tournament.",2e3);return}this.setButtonInteractable(!1);try{await ht.shareTournamentAsync(this.leadersPayload.player.score)}catch{ot.showNotificationScreen("Sorry, unable to share tournament.",2e3)}this.setButtonInteractable(!0)};async processPlayTournament(e,t){this.setButtonInteractable(!1);let{id:i=""}=this.tournamentPayload;if(Ip.validateTournamentExpired(i)){this.handleClose(),ot.showNotificationScreen("Tournament has ended",2e3);return}let s=await ht.joinTournamentAsync(i,e);if(s===!1){this.setButtonInteractable(!0);return}if(s||(s=await ht.continueTournamentAsync()),!s){this.setButtonInteractable(!0),ot.showNotificationScreen(`Sorry, unable to get
tournament data.`,2e3);return}this.leadersPayload.player&&_p.setStorageData("Tournament","previousScore",this.leadersPayload.player.score),It.switchToGameScene({score:t})}async getLeadersPayload(e){this.setButtonInteractable(!1);let t=await cR.getAllLeaderboardAsync(e);if(this.setButtonInteractable(!0),!t)return{leaders:[]};let i=UG.vals(t.leaders);return i.sort((s,n)=>n.score-s.score),{leaders:i,player:t.leaders[YG.getPlayerId()]}}getPreviousLeadersPayload(){let{previousScore:e,showResult:t}=_p.getStorage("Tournament")??{};if(e===void 0||!t)return;let{player:i}=this.leadersPayload;if(!i||i.score<=e||i.rank===void 0)return;let s={...i};s.score=e;let n=this.leadersPayload.leaders.filter(r=>r.playerId!==i.playerId);if(n.push(s),n.sort((r,o)=>o.score-r.score),s.rank=pR.searchIndex(n,r=>r.playerId===i.playerId)+2,!(i.rank>=s.rank))return{leaders:n,player:s}}runPopupEntrancesAnimation(){let e=this.popup.scale,t=pt.getBannerHeight()/2;this.popupShowUpAnimation=this.scene.tweens.add({targets:[this.popup],duration:400,ease:Phaser.Math.Easing.Back.Out,props:{y:{from:250-t,to:-t},alpha:{start:0,from:0,to:1},scale:{start:e*.8,from:e*.8,to:e}}}),J.runTween(this.popupShowUpAnimation)}runPopupExitsAnimation(){let e=this.popup.scale;this.popupFadeOutAnimation=this.scene.tweens.add({...Nt,targets:[this.popup],duration:200,props:{...Nt.props,scale:{start:e,from:e,to:e*.8}}}),J.runTweenAsync(this.popupFadeOutAnimation).then(()=>{this.popup.setY(0),this.popup.setScale(e),ot.closeScreen(this.name)})}async runRankUpAnimation(){if(!this.previousLeadersPayload)return;let{player:e}=this.previousLeadersPayload,{player:t}=this.leadersPayload;if(!e||!t)return;let i=this.tempPlayerLeader.height+2,s=this.tournamentLeaders.scroller;this.tempPlayerLeader.updateInfo(e);let n=pR.search(s.getChildren(),h=>h.payload.playerId===e.playerId);if(!n)return;this.closeButton.setDisabled(!0),n.setVisible(!1),this.tempPlayerLeader.setVisible(!0),this.tempPlayerLeader.setPosition(n.getWorldPosition().x,n.getWorldPosition().y);let r=70;t.rank<=2?r=(t.rank-1)*i-17:t.rank===this.leadersPayload.leaders.length-1&&(r=98),await Promise.all([new Promise(h=>{this.scene.add.tween({targets:[this.tempPlayerLeader],props:{scale:{duration:200,from:1,to:1.1},y:{duration:1e3,from:this.tempPlayerLeader.y,to:r}},onUpdate:l=>{let u=Math.round(e.score+(t.score-e.score)*l.progress);this.tempPlayerLeader.score.setText(u.toString());let d=Math.round(e.rank+(t.rank-e.rank)*l.progress);this.tempPlayerLeader.updateRank(d)},onComplete:()=>{this.tempPlayerLeader.score.setText(t.score.toString()),this.tempPlayerLeader.updateRank(t.rank),h()},ease:Phaser.Math.Easing.Quintic.Out})}),new Promise(h=>{this.tournamentLeaders.scroller.scrollToConfigWithTween(t.rank-1,!1,()=>{h()})})]);let o=!1;this.scene.add.tween({targets:[this.tempPlayerLeader],props:{scale:{duration:300,from:1.1,to:1}},ease:Phaser.Math.Easing.Back.InOut,onUpdate:h=>{h.progress>.5&&!o&&(o=!0,this.starSparkleExplosive.explode(10,this.tempPlayerLeader.x,this.tempPlayerLeader.y,this.tempPlayerLeader.width,this.tempPlayerLeader.height))}}),this.scene.add.tween({targets:[this.shineTempPlayerLeader],duration:200,props:{alpha:{from:0,to:.3}},onComplete:()=>{this.tempPlayerLeader.setVisible(!1)},yoyo:!0});let a=s.getChildren().filter(h=>h.payload.rank>t.rank&&h.payload.rank<e.rank).slice(0,4);this.scene.add.tween({targets:a,duration:300,props:{y:{getEnd:h=>h.y+i}},ease:Phaser.Math.Easing.Back.Out,onComplete:()=>{s.setEnabled(!0),this.tournamentLeaders.updateLeaders(this.leadersPayload),this.closeButton.setDisabled(!1)}})}setButtonInteractable(e){this.closeButton.setDisabled(!e),this.playButton.setDisabled(!e),this.replayButton.setDisabled(!e),this.shareButton.setDisabled(!e)}preDestroy(){this.unlistenEvents(),this.countdownTimer?.remove(),super.preDestroy()}},VG=WG;U(),U(),U();var{Utils:{Object:XG,String:KG,Time:jG}}=Ludex,{player:ZG}=codex,{KEY:qG,FRAME:JG}=G.DEFAULT,{KEY:gs,FRAME:fs}=G.TOURNAMENTS,QG=class extends Phaser.GameObjects.Container{scene;popup;tournamentBanner;tournamentIcon;tournamentName;tournamentTime;tournamentPlayers;playButton;joinLabel;continueLabel;blockPayload;leadersPayload;showPopUp;isRequesting;constructor(e){super(e),this.scene=e,this.createPopup(),this.createTournamentBanner(),this.createTournamentIcon(),this.createTournamentName(),this.createTournamentTime(),this.createTournamentPlayers(),this.createPlayButton()}createPopup(){this.popup=this.scene.add.container(0,0),this.popup.setSize(354,296);let e=this.scene.make.image({key:gs,frame:fs.POPUP});this.popup.add(e),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this),this.setSize(354,296)}createTournamentBanner(){this.tournamentBanner=this.scene.make.image({key:gs,frame:fs.FRAME}),this.add(this.tournamentBanner),Phaser.Display.Align.In.Center(this.tournamentBanner,this.popup,0,-15)}createTournamentIcon(){this.tournamentIcon=this.scene.make.image({key:gs,frame:fs.ICON_RANKING}),this.add(this.tournamentIcon),Phaser.Display.Align.In.TopLeft(this.tournamentIcon,this.popup,-20,-16)}createTournamentName(){this.tournamentName=X.createShadowText(this.scene,"",18).setFontStyle("700").setTint(16576668),X.setTruncateOverflow(this.tournamentName,230),this.add(this.tournamentName),Phaser.Display.Align.In.TopCenter(this.tournamentName,this.popup,0,-22)}createTournamentTime(){let e=this.scene.make.image({key:gs,frame:fs.PANEL}),t=this.scene.make.image({key:gs,frame:fs.ICON_TIME});this.tournamentTime=X.createText(this.scene,"",13).setFontStyle("700"),X.applyYellowStyle(this.tournamentTime),this.tournamentTime.setOrigin(0,.5),this.add([e,t,this.tournamentTime]),Phaser.Display.Align.In.BottomLeft(e,this.popup,-25,-22),Phaser.Display.Align.In.LeftCenter(t,e,9,0),Phaser.Display.Align.In.LeftCenter(this.tournamentTime,e,-20,0)}createTournamentPlayers(){let e=this.scene.make.image({key:gs,frame:fs.PANEL}),t=this.scene.make.image({key:gs,frame:fs.ICON_PEOPLE});this.tournamentPlayers=X.createText(this.scene,"",13).setFontStyle("700"),X.applyYellowStyle(this.tournamentPlayers),this.add([e,t,this.tournamentPlayers]),Phaser.Display.Align.In.BottomLeft(e,this.popup,-25,-52),Phaser.Display.Align.In.LeftCenter(t,e,7,0),Phaser.Display.Align.In.Center(this.tournamentPlayers,e)}createPlayButton(){this.playButton=new At(this.scene,qG,JG.BUTTON_GREEN,146.5,50.5),this.playButton.setName("Join"),this.joinLabel=X.createText(this.scene,"Join",22).setFontStyle("900"),X.applyGreenStyle(this.joinLabel),this.continueLabel=X.createText(this.scene,"Continue",22).setFontStyle("900"),X.applyGreenStyle(this.continueLabel),this.playButton.add([this.continueLabel,this.joinLabel]),this.popup.add(this.playButton),Phaser.Display.Align.In.Center(this.joinLabel,this.playButton),Phaser.Display.Align.In.Center(this.continueLabel,this.playButton),Phaser.Display.Align.In.BottomRight(this.playButton,this.popup,-15,-20),this.continueLabel.setVisible(!1),this.playButton.onClick=this.handlePlayButtonClicked}getTournamentName(e){let t=e.substring(0,28);return KG.removeDiacritics(t)}getTournamentTime(e){return`Ends ${jG.getRelativeTime(e,"en",{style:"short"})}`}async updateInfo(e){if(this.isRequesting)return;this.setLoading(),this.blockPayload=e;let{title:t,endTime:i,payload:s}=e,{leaderboardId:n}=s;if(this.tournamentName.setText(this.getTournamentName(t)),this.tournamentTime.setText(this.getTournamentTime(i)),this.isRequesting=!0,!n){this.isRequesting=!1;return}this.leadersPayload=await this.getLeadersPayload(n),this.isRequesting=!1,this.leadersPayload.player&&(this.joinLabel.setVisible(!1),this.continueLabel.setVisible(!0)),this.tournamentPlayers.setText(`${this.leadersPayload.leaders.length}`)}async getLeadersPayload(e){let t=await cR.getAllLeaderboardAsync(e);return t?{leaders:XG.vals(t.leaders),player:t.leaders[ZG.getPlayerId()]}:{leaders:[]}}async runShowPopUpAnimation(e,t){this.scene.tweens.killTweensOf(this);let i=this.y;return this.showPopUp=new Pp({targets:[this],delay:e,duration:t,props:{...ki.props,y:{...ki.props?.y,start:this.y+70,to:this.y}},onStop:()=>{this.y=i}}),this.showPopUp.play(),new Promise(s=>{this.scene.time.delayedCall(e+t+500,()=>{s()})})}runShowItemAnimation(e,t){let i=this.getItems();this.scene.tweens.killTweensOf(i);for(let s of i)s.setScale(s.type==="Image"?.5:1);this.scene.tweens.add({targets:i,duration:t,delay:this.scene.tweens.stagger(50,{start:e+50}),props:{alpha:{duration:500,value:{start:0,from:0,to:1},ease:Phaser.Math.Easing.Cubic.Out},scale:{duration:800,start:.8,end:1,value:{start:.8,from:.8,to:1},ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]}}})}getItems(){return[this.tournamentName,this.tournamentPlayers,this.tournamentTime]}async runShowUpAnimation(e=0,t=300){let i=e*100;this.runShowItemAnimation(i,t),await this.runShowPopUpAnimation(i,t)}setLoading(){this.tournamentPlayers.setText("Loading...")}handlePlayButtonClicked=()=>{this.showTournamentDetailScreen()};showTournamentDetailScreen=()=>{this.isRequesting||ot.openScreen(mt.TOURNAMENT_DETAIL_SCREEN,{tournamentPayload:this.blockPayload,tournamentContext:this.leadersPayload.player?"tournament_end":"tournament_start"})}},$G=QG,t5=class extends Phaser.GameObjects.Container{scene;loading;scroller;constructor(e){super(e),this.scene=e,this.createLoading(),this.createScroller()}showLoading(e){this.loading.setVisible(e)}createLoading(){this.loading=new lR(this.scene),this.loading.setWorldSize(60,60),this.add(this.loading),Phaser.Display.Align.In.Center(this.loading,this,0,-40)}createScroller(){let e=lt.getWorldSize().height-200;this.scroller=new ro(this.scene,{size:{width:364,height:e},visual:{margin:5,mask:!0,bounds:{height:10,tint:2102028}},reuse:{ClassType:$G,configs:[],update:(t,i)=>{t.updateInfo(i)}}}),this.scroller.setPosition(0,0),this.add(this.scroller),this.hideTournaments()}alignUI(){let{height:e}=lt.getWorldSize(),t=364,i=e-200;this.setSize(t,i),this.scroller.setSize(t,i),this.scroller.maskGraphics.clear(),this.scroller.maskGraphics.fillRoundedRect(-t/2,-i/2,t,i,0),this.scroller.boundTop.setY(-i/2),this.scroller.boundBottom.setY(i/2),this.scroller.updateObjectPosition(),this.scroller.updateObjectVisibility()}hideTournaments(){this.scroller.setVisible(!1)}showTournaments(){this.scroller.setVisible(!0),this.scroller.setEnabled(!1),this.scroller.scrollToTop(!0);let e=this.getTournaments(),t=Math.min(e.length,4),i=150,s=[];for(let n=0;n<t;n++){let r=e[n];if(!r)continue;r.setVisible(!0);let o=r.runShowUpAnimation(n,i);s.push(o)}s.length!==0&&Promise.all(s).then(()=>{this.scroller.setEnabled(!0)})}getTournaments(){return this.scroller.getChildren()}updateTournaments(e){this.scroller.setConfigs(e)}},e5=t5,{Events:wY,Utils:{Object:i5,Valid:gR}}=Ludex,{event:Xo}=codex,{KEY:s5,FRAME:n5}=G.DEFAULT,{KEY:Ko,FRAME:jo}=G.TOURNAMENTS,r5=class extends ue{popup;cup;ribbon;title;closeButton;tournamentButton;tournamentsBoard;blockInputZone;emptyLabel;popupShowUpAnimation;popupFadeOutAnimation;starSparkleUp;constructor(e,t){super(e,t),this.$(),this.Ul(),this.Be(),this.Gt(),this.Gl(),this.Yl(),this.Hl(),this.It(),this.zl(),this.He(),this.Te(),this.setDepth(me.POPUP)}$(){this.popup=this.scene.add.container(0,0),this.add(this.popup)}Ul(){this.cup=this.scene.make.image({key:Ko,frame:jo.CUP}),this.popup.add(this.cup)}Be(){this.ribbon=this.scene.make.image({key:Ko,frame:jo.RIBBON}),this.popup.add(this.ribbon)}Gt(){this.title=this.scene.make.image({key:Ko,frame:jo.TOURNAMENT_TEXT}),this.popup.add(this.title)}It(){this.closeButton=new At(this.scene,s5,n5.BUTTON_CLOSE),this.closeButton.setName("Close"),this.closeButton.onClick=this.handleClose,this.closeButton.setButtonHitSoundEffect(ut.CLOSE_POPUP_CLICK),this.popup.add(this.closeButton)}zl(){gR.isDebugger()&&(this.tournamentButton=new At(this.scene,Ko,jo.ICON_RANKING),this.tournamentButton.setName("Tournament"),this.tournamentButton.onClick=this.handleCreateTournament,this.tournamentButton.setButtonHitSoundEffect(ut.CLOSE_POPUP_CLICK),this.popup.add(this.tournamentButton))}Yl(){this.tournamentsBoard=new e5(this.scene),this.popup.add(this.tournamentsBoard)}Gl(){this.emptyLabel=X.createText(this.scene,"",20).setText(["No tournaments available","Check back later!"]).setTint(16374700).setFontStyle("700").setAlign("center"),this.emptyLabel.setVisible(!1),this.popup.add(this.emptyLabel)}Hl(){this.blockInputZone=this.scene.add.zone(0,0,375,150),this.blockInputZone.setInteractive(),this.popup.add(this.blockInputZone)}He(){this.starSparkleUp=new ur(this.scene),this.popup.add(this.starSparkleUp)}Te=()=>{let{width:e,height:t}=lt.getWorldSize();this.popup.setWorldSize(e,t),Phaser.Display.Align.In.TopCenter(this.cup,this.popup,0,-24),Phaser.Display.Align.In.TopCenter(this.ribbon,this.popup,0,-95),Phaser.Display.Align.In.Center(this.title,this.ribbon,0,-7),Phaser.Display.Align.In.TopCenter(this.closeButton,this.popup,150,-70),gR.isDebugger()&&Phaser.Display.Align.In.TopCenter(this.tournamentButton,this.popup,-150,-70),Phaser.Display.Align.In.TopCenter(this.blockInputZone,this.popup,0,0),Phaser.Display.Align.In.Center(this.emptyLabel,this.popup,0,0),this.tournamentsBoard.alignUI(),Phaser.Display.Align.In.TopCenter(this.tournamentsBoard,this.popup,0,-150),this.starSparkleUp.stop(),this.starSparkleUp.run(1.25,0,this.cup.y-20,120,60)};listenEvents(){Xo.on(yt.VIEW_RESIZED,this.Te),Xo.on(yt.LAYOUT_CHANGED,this.Te)}unlistenEvents(){Xo.off(yt.VIEW_RESIZED,this.Te),Xo.off(yt.LAYOUT_CHANGED,this.Te)}open(){super.open(),this.listenEvents(),this.Te(),this.updateTournaments(),this.background.setAlpha(0),this.animateBackgroundAlpha(.8,400),this.runPopupEntrancesAnimation()}handleClose=async()=>{this.unlistenEvents(),this.animateBackgroundAlpha(0,200),this.runPopupExitsAnimation()};handleCreateTournament=async()=>{try{await ht.createTournamentAsync()}catch(e){if(!i5.hasOwn(e,"code")){ot.showNotificationScreen("Sorry, please try again later",2e3);return}if(e.code==="USER_INPUT")return;if(e.code==="PLAYER_HAS_TOURNAMENT"){ot.showNotificationScreen("You already have a tournament",2e3);return}if(e.code==="INVALID_OPERATION"){ot.showNotificationScreen("Sorry, please try again later",2e3);return}ot.showNotificationScreen("Create tournament failed",2e3)}finally{this.updateTournaments()}};async updateTournaments(){this.tournamentsBoard.hideTournaments(),this.tournamentsBoard.showLoading(!0),this.emptyLabel.setVisible(!1);let e=await Ip.requestTournamentDataAsync();this.tournamentsBoard.updateTournaments(e),this.tournamentsBoard.showLoading(!1),this.tournamentsBoard.showTournaments(),e.length===0&&this.emptyLabel.setVisible(!0)}runPopupEntrancesAnimation(){this.popupShowUpAnimation=this.scene.tweens.add({...se,targets:[this.popup],duration:400,props:{...se.props,alpha:{start:0,from:0,to:1},scale:{start:.8,from:.8,to:1}}}),J.runTween(this.popupShowUpAnimation)}runPopupExitsAnimation(){this.popupFadeOutAnimation=this.scene.tweens.add({...Nt,targets:[this.popup],duration:200,props:{...Nt.props,scale:.8}}),J.runTweenAsync(this.popupFadeOutAnimation).then(()=>{this.popup.setY(0),ot.closeScreen(this.name)})}preDestroy(){this.unlistenEvents()}},a5=r5,o5={[mt.PAUSE_SCREEN]:YO,[mt.NOTIFY_SCREEN]:rO,[mt.RESCUE_SCREEN]:ZO,[mt.RESULT_SCREEN]:TU,[mt.CONTINUE_SCREEN]:w_,[mt.LUCKY_WHEEL_SCREEN]:yG,[mt.REWARD_ITEM_SCREEN]:BU,[mt.REWARD_COINS_SCREEN]:PU,[mt.TOURNAMENTS_SCREEN]:a5,[mt.TOURNAMENT_DETAIL_SCREEN]:VG,[mt.RESULT_CHALLENGE_FRIEND_SCREEN]:lM,[mt.DAILY_MISSIONS_SCREEN]:q_,[mt.JOURNEY_SCREEN]:aG,[mt.LOADING_SCREEN]:$_},h5=o5,{event:ms,monitorError:fR}=codex,{Events:pn,Utils:{Valid:mR,Object:l5}}=Ludex,u5=class{screens={};init(){this.bindEventHandlers()}bindEventHandlers(){ms.on(pn.OPEN_SCREEN,this.handleOpenScreen),ms.on(pn.CLOSE_SCREEN,this.handleCloseScreen),ms.on(yt.DESTROY_SCREENS,this.destroyAllScreens)}handleOpenScreen=e=>{this.openScreen(e.screenName,e.screenData)};handleCloseScreen=e=>{this.closeScreen(e.screenName,!0)};createScreen(e){let t=It.getCurrentScene();if(!t)throw new Error(`Create Screen: Invalid scene ${e}`);let{scenes:i}=this.screens[e],s=i[t.scene.key];if(s){this.setupScreen(t,s);return}let n=this.getScreenInstance(e);if(!n)throw new Error(`Create Screen: Invalid screen ${e}`);let r=new n(t,e);this.setupScreen(t,r)}setupScreen(e,t){let i=t.name;this.screens[i].scenes[e.scene.key]=t,ot.addScreen(i,t),e.add.existing(t),l5.hasOwn(e,"gameZone")&&mR.isObject(e.gameZone)&&e.gameZone instanceof Phaser.GameObjects.Zone&&Phaser.Display.Align.In.Center(t,e.gameZone)}getScreenInstance(e){return h5[e]||null}prepareScreen(e){this.addScreen(e),this.createScreen(e)}addScreen(e){if(this.screens[e])return;let t=Object.keys(this.screens).length;this.screens[e]={name:e,order:t,scenes:{}}}getScreen(e){this.prepareScreen(e);let t=It.getCurrentScene();if(!t)throw new Error(`ScreenManager: Invalid scene ${e}`);let{scenes:i}=this.screens[e],s=i[t.scene.key];if(!s)throw new Error(`ScreenManager: Screen ${e} not ready`);return s}validateScreen(e){if(!mR.isString(e))throw new Error(`ScreenManager: Invalid screen name ${e}`)}async openScreen(e,t){this.validateScreen(e),await new Promise(s=>requestAnimationFrame(s));let i=this.getScreen(e);i.active||this.showScreen(i,e,t)}async showScreen(e,t,i){let s={screenName:t,screenData:i};ms.emit(pn.OPENING_SCREEN,s),e.open(i),this.updateAnalytics(t),ms.emit(pn.OPENED_SCREEN,s)}async closeScreen(e,t=!1){this.validateScreen(e),await new Promise(s=>requestAnimationFrame(s));let i=this.getScreen(e);i.active&&(ms.emit(pn.CLOSING_SCREEN,{screenName:e}),i.close(),t&&this.updateAnalytics(e,!1),ms.emit(pn.CLOSED_SCREEN,{screenName:e}))}updateAnalytics(e,t=!0){qi.trackCurrentPage(e,t),t?fR?.addMetadata({currentScreen:e}):fR?.removeMetadata("currentScreen")}closeAllScreens(){for(let e in this.screens)this.closeScreen(e,!1)}destroyAllScreens=e=>{let{sceneKey:t}=e;if(t)for(let i in this.screens){let s=this.screens[i];if(!s)continue;let n=s.scenes[t];n&&(n.destroy(),delete s.scenes[t])}}},c5=u5;U();var{storage:d5}=codex,p5=class{init(){}setupDefaultData(){this.setupTournamentData()}setupTournamentData(){d5.addStorage("Tournament",{showResult:!1,previousScore:void 0})}},g5=p5,{Events:Or,Plugins:{Analytics:{Events:Zo}},Utils:{Function:vR,Valid:f5}}=Ludex,{context:m5,event:Mr,analytics:qo,monitorError:ER}=codex,v5=class{We=new Gb;Wl=new Bb;sr=new i_;nr=new Xb;Vl=new c5;wi=new Qb;rr=new g5;xe=new qI;constructor(){window.isCustomRequestAnimationFrame=!1,qo.event(Zo.ENGINE_READY),this.Xl(),this.bt()}Xl(){this.We.init(),this.Wl.init(),this.sr.init(),this.Vl.init(),this.nr.init(),this.wi.init(),this.rr.init(),this.xe.init()}bt(){this.We.onCoreBoot(this.Kl),this.We.onCoreStart(this.jl),this.We.onCoreReady(this.Zl),this.sr.onSwitchScene(this.handleSwitchScene)}Kl=()=>{this.We.requestStart()};jl=()=>{this.wi.setupDefaultGameData()};Zl=async()=>{await this.wi.syncPlayerData(),this.nr.setupDefaultMatchData(),this.rr.setupDefaultData(),this.ql(),qo.event(Zo.LOAD_START),Mr.catchUp(Or.BUNDLE_READY,this.Jl)};Jl=()=>{Mr.catchUp(Or.SCENE_LAUNCHED,this.Ql),this.$l()};Ql=async()=>{await Mr.waitTo(Or.SCENE_LAUNCHED),window.phaser.isRunning||await this.eu(),this.iu()};async eu(){return new Promise(e=>{window.phaser.events.once(Phaser.Core.Events.RESUME,e)})}$l(){window.phaser.scene.start(Yt.BOOT_SCENE)}async iu(){qo.event(Zo.LOAD_COMPLETE),await this.ar(),Mr.catchUp(Or.PLAYER_INFO_LOADED,this.su)}handleSwitchScene=()=>{};async ar(e=0){let t=GameSDK.startGameAsync(),[i,s]=await vR.handleAsync(t);if(s){if(e<=3){setTimeout(()=>{this.ar(e+1)},1e3);return}ER?.sendException(s)}}su=async()=>{qo.event(Zo.APP_READY),this.wi.requestConnectedPlayers();let e=m5.processContextData(),[t,i]=await vR.handleAsync(e);i&&ER?.sendException(i),Mr.emit(Or.GAME_READY)};ql(){this.xe.initMissions(),this.xe.initLeaderboards(),this.xe.initDailyRewards(),this.xe.initFrameCapture(),this.xe.initAdaptivePerformance()}};new v5,f5.isDebugger()&&new EventSource("/esbuild").addEventListener("change",()=>location.reload()),U(),U();var{DesignSize:{Resolution:E5}}=hd,y5=class{addKillRevive(){[Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Text,Phaser.GameObjects.Zone,Phaser.GameObjects.Particles.ParticleEmitter,Phaser.GameObjects.NineSlice].forEach(e=>{e.prototype.kill=this.kill,e.prototype.revive=this.revive})}addKillReviveGroup(){Phaser.GameObjects.Group.prototype.killGroup=this.killGroup,Phaser.GameObjects.Group.prototype.reviveGroup=this.reviveGroup}addSetFrame(){[Phaser.GameObjects.Image,Phaser.GameObjects.Sprite].forEach(e=>{e.prototype.oriSetFrame=e.prototype.setFrame,e.prototype.setFrame=this.setFrame})}addSetWorldSize(){[Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Zone].forEach(e=>{e.prototype.setWorldSize=this.setWorldSize})}addSetWorldSizeForNineSlice(){[Phaser.GameObjects.NineSlice].forEach(e=>{e.prototype.setWorldSize=this.setWorldSizeForNineSlice})}addSetWorldSizeForContainer(){[Phaser.GameObjects.Container].forEach(e=>{e.prototype.setWorldSize=this.setWorldSizeForContainer})}addGetWorldPosition(){[Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Text,Phaser.GameObjects.Zone].forEach(e=>{e.prototype.getWorldPosition=this.getWorldPosition})}addDrawDebugBox(){[Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Text,Phaser.GameObjects.Zone].forEach(e=>{e.prototype.drawDebugBox=this.drawDebugBox})}addHighQuality(){[Phaser.GameObjects.Text].forEach(e=>{e.prototype.setHighQuality=this.setHighQuality})}kill(){this.setActive(!1),this.setVisible(!1)}revive(){this.setActive(!0),this.setVisible(!0)}killGroup(){let e=this.getChildren();for(let t of e)t.setActive(!1),t.setVisible(!1)}reviveGroup(){let e=this.getChildren();for(let t of e)t.setActive(!0),t.setVisible(!0)}setFrame(e,t=!0,i=!0){return this.oriSetFrame(e,t,i),this.__width=this.width,this.__height=this.height,this}setWorldSize(e,t){typeof this.__width!="number"&&(this.__width=this.width),typeof this.__height!="number"&&(this.__height=this.height);let i=lt.getPixelRatio(),s=e||this.__width/i,n=t||this.__height/i;this.setSize(s,n),this.setDisplaySize(s,n)}setWorldSizeForContainer(e,t){typeof e!="number"||typeof t!="number"||(this.setSize(e,t),this.setDisplaySize(e,t))}setWorldSizeForNineSlice(e,t){this.__width||(this.__width=this.frame.width),this.__height||(this.__height=this.frame.height);let i=lt.getPixelRatio(),s=e||this.__width/i,n=t||this.__height/i;this.leftWidth=this.leftWidth/i,this.rightWidth=this.rightWidth/i,this.topHeight=this.topHeight/i,this.bottomHeight=this.bottomHeight/i,this.setSize(s,n),this.setDisplaySize(s,n)}getWorldPosition(){let e=this.getWorldTransformMatrix(),{translateX:t,translateY:i}=e.decomposeMatrix();return{x:t,y:i}}drawDebugBox(e=65280,t=.2){let{width:i,height:s,depth:n,originX:r,originY:o}=this;if(!i||!s)throw new Error("Width and height are required in drawDebugBox");let a=this.scene.add.rectangle(0,0,i,s,e,t);return a.setName("Debug Box"),a.setDepth(n+1),this instanceof Phaser.GameObjects.Container&&this.add(a),this.parentContainer&&this.parentContainer.add(a),a.setOrigin(r,o),Phaser.Display.Align.In.Center(a,this),a}setHighQuality(){return this.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer?this.setResolution(E5):this}},T5=y5;U();var{event:x5,player:yR}=codex,{Events:S5}=Ludex,A5=class extends hr{create(){super.create();try{x5.catchUp(S5.GAME_SDK_STARTED,this.processWhenGameSdkStarted),It.switchScene(Yt.LOAD_SCENE),this.scene.launch(Yt.GLOBAL_SCENE)}catch{}}processWhenGameSdkStarted=()=>{this.setupGameData()};setupGameData(){let e=yR.getGameData();if(!e)return;let{level:t}=e,i={level:Math.max(t,1)};yR.setGameData(i),$i.loadCoin(),kt.addGameMissions()}},w5=A5;U(),U(),U(),U(),U(),U();var{DEFAULT:{KEY:C5,FRAME:P5},DASHBOARD:{KEY:R5}}=G,b5=class extends At{constructor(e){super(e,C5,P5.BUTTON_YELLOW_CIRCLE),this.setName("IconButton"),this.scene.add.existing(this)}setIcon(e){let t=this.scene.add.image(0,0,R5,e);this.add(t)}},TR=b5,{FRAME:xR}=G.DASHBOARD,I5=class extends Phaser.GameObjects.Container{shopButton;settingsButton;constructor(e){super(e),this.updateWorldSize(),this.createButtons(),this.scene.add.existing(this)}createButtons(){this.shopButton=new TR(this.scene),this.shopButton.setIcon(xR.ICON_SHOP),this.shopButton.kill(),this.settingsButton=new TR(this.scene),this.settingsButton.setIcon(xR.ICON_SETTINGS),this.add([this.shopButton,this.settingsButton])}updateWorldSize(){let{width:e}=lt.getWorldSize(),t=Math.min(e,600);this.setWorldSize(t,50)}},_5=I5;U(),U();var{Utils:{Signal:O5}}=Ludex,{KEY:Lr,FRAME:Jo}=G.DASHBOARD,M5=class extends At{icon;label;alertContainer;alertText;alertIcon;alertShine;alertShineOgScale;panelName;alertAnimController=new O5.SignalController;isAlerting=!1;constructor(e){super(e,Lr,Jo.PANEL_ICON),this.setName("IconMenu"),this.createPanelName(),this.createAlert()}setIcon(e){if(this.icon){this.icon.setFrame(e);return}this.icon=this.scene.add.image(0,0,Lr,e),this.add(this.icon),this.moveBelow(this.icon,this.panelName),Phaser.Display.Align.In.Center(this.icon,this,0,-2)}setText(e){if(this.label){this.label.setText(e);return}this.label=X.createText(this.scene,e,9).setTint(16636332).setShadow(0,2,"#00000075",.5).setFontStyle("700"),this.add(this.label),Phaser.Display.Align.In.BottomCenter(this.label,this.button,0,-3)}createPanelName(){this.panelName=this.scene.add.image(0,0,Lr,Jo.PANEL_NAME),this.add(this.panelName),Phaser.Display.Align.In.BottomCenter(this.panelName,this,0,-1)}createAlert(){this.alertContainer=this.scene.add.container(),this.add(this.alertContainer),this.createAlertIcon(),this.alertContainer.setSize(this.alertIcon.width,this.alertIcon.height),this.createAlertText(),this.createAlertShine(),Phaser.Display.Align.In.TopRight(this.alertContainer,this.button,0,4)}createAlertIcon(){this.alertIcon=this.scene.add.image(0,0,Lr,Jo.ICON_INFO_DOT),this.alertContainer.add(this.alertIcon),this.alertIcon.kill()}createAlertText(){this.alertText=X.createText(this.scene,"1",12).setFontStyle("700").setOrigin(.5,.5).setAlign("center"),this.alertContainer.add(this.alertText),this.alertText.kill()}createAlertShine(){this.alertShine=this.scene.add.image(0,0,Lr,Jo.ICON_INFO_DOT),this.alertShine.setAlpha(0),fo.inst.setBlendModeWithPerf(this.alertShine,Phaser.BlendModes.ADD),this.alertContainer.add(this.alertShine),this.alertShineOgScale=this.alertShine.scale,this.alertShine.kill()}playAlertAnimation(){if(this.isAlerting)return;this.isAlerting=!0;let e=this.alertAnimController.renew();this.alertIcon.revive(),this.alertText.revive(),this.alertShine.revive(),J.runTween(this.scene.tweens.chain({paused:!0,tweens:[{targets:this.alertContainer,props:{scale:{from:0,to:1}},duration:200,ease:Phaser.Math.Easing.Sine.Out},{targets:this.alertShine,props:{alpha:{from:.4,to:0},scale:{from:this.alertShineOgScale,to:this.alertShineOgScale*1.7}},duration:1e3,ease:Phaser.Math.Easing.Cubic.Out,repeat:-1}]}),e)}stopAlertAnimation(){if(!this.isAlerting)return;this.isAlerting=!1;let e=this.alertAnimController.renew(),t=()=>{this.alertIcon.kill(),this.alertText.kill(),this.alertShine.kill()};J.runTween(this.scene.tweens.add({targets:this.alertContainer,props:{scale:{from:1,to:0}},duration:200,ease:Phaser.Math.Easing.Sine.In,paused:!0,onComplete:t}),e)}setAlertText(e){this.alertText.setText(e)}},Qo=M5;U(),U();var L5=class extends Phaser.GameObjects.Container{progressBox;progressBar;constructor(e,t){super(e);let{key:i,boxFrame:s,barFrames:n}=t;this.setWorldSize(115,14),this.createProgressBox(i,s),this.createProgressBar(i,n),this.alignBar(),this.scene.add.existing(this)}setProcess(e){this.progressBar.setWorldSize(this.width*e,this.height),this.alignBar()}alignBar(){let[e,t,i]=this.progressBar.list,{width:s}=this.progressBar,n=e.width+i.width,r=s-n,o=Math.max(r,-8);t.setWorldSize(o),Phaser.Display.Align.In.Center(this.progressBar,this.progressBox,1.5,-.5),Phaser.Display.Align.In.LeftCenter(e,this.progressBar),Phaser.Display.Align.To.RightCenter(t,e),Phaser.Display.Align.To.RightCenter(i,t),Phaser.Display.Align.In.LeftCenter(this.progressBar,this.progressBox)}createProgressBox(e,t){this.progressBox=this.scene.make.image({key:e,frame:t}),this.add(this.progressBox)}createProgressBar(e,t){this.progressBar=this.scene.add.container(),this.progressBar.setWorldSize(this.width,this.height);let i=this.scene.make.image({key:e,frame:t.left}),s=this.scene.make.image({key:e,frame:t.middle}),n=this.scene.make.image({key:e,frame:t.right});this.progressBar.add([i,s,n]),this.add(this.progressBar)}},D5=L5,{KEY:Op,FRAME:Dr}=G.DASHBOARD,k5=class extends At{image;country;progress;constructor(e){super(e,Op,Dr.THEME_FRAME),this.setWorldSize(185,186),this.createBoard(),this.createInfo(),this.createProgress(),this.setName("JourneyProgress")}updateProgress(){this.image.setFrame(Oe.getThemeFrameForDashboardComponent()),this.country.setText(Oe.getThemeName()),this.progress.setProcess(Oe.getThemeProgress())}createBoard(){this.image=this.scene.make.image({key:Op,frame:Oe.getThemeFrameForDashboardComponent()}),this.add(this.image),Phaser.Display.Align.In.TopCenter(this.image,this.button,0,-12)}createInfo(){let e=X.createText(this.scene,"CURRENT TARGET",9).setTint(9060888).setAlpha(.8);this.country=X.createText(this.scene,Oe.getThemeName(),16).setFontStyle("700").setTint(9060888).setOrigin(0,.5),this.add([e,this.country]),Phaser.Display.Align.In.Center(e,this,-32,32),Phaser.Display.Align.In.BottomLeft(this.country,e,0,19)}createProgress(){this.progress=new D5(this.scene,{key:Op,boxFrame:Dr.BORDER_FULL,barFrames:{left:Dr.PROGRESS_LEFT,middle:Dr.PROGRESS_MIDDLE,right:Dr.PROGRESS_RIGHT}}),this.progress.setProcess(Oe.getThemeProgress()),this.add(this.progress),Phaser.Display.Align.In.Center(this.progress,this,-15,65)}},F5=k5;U();var{Events:$o}=Ludex,{player:N5,event:th}=codex,{FRAME:B5}=G.DASHBOARD,U5=1e3*60*60*24,G5=1e3*30,SR=class extends Qo{lastUpdate=0;constructor(e){super(e),this.setIcon(B5.ICON_DAILY_SPIN),this.setText("Daily Spin"),this.setName("DailySpinIconMenu"),this.refresh()}listenToEvents(){this.unlistenToEvents(),this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.update,this),th.on($o.OPEN_SCREEN,this.onOpenScreen),th.on($o.CLOSE_SCREEN,this.onCloseScreen)}unlistenToEvents(){this.scene.events.off(Phaser.Scenes.Events.UPDATE,this.update,this),th.off($o.OPEN_SCREEN,this.onOpenScreen),th.off($o.CLOSE_SCREEN,this.onCloseScreen)}update(e){e-this.lastUpdate>G5&&(this.lastUpdate=e,this.refresh())}preDestroy(){this.unlistenToEvents(),this.alertAnimController.abort(),super.preDestroy()}onOpenScreen=({screenName:e})=>{e===mt.LUCKY_WHEEL_SCREEN&&this.refresh()};onCloseScreen=({screenName:e})=>{e===mt.LUCKY_WHEEL_SCREEN&&this.refresh()};refresh(){this.nu()?this.playAlertAnimation():this.stopAlertAnimation()}nu(){let{lastDailySpin:e=0}=N5.getGameData()??{},t=new Date(e);return t.setHours(0,0,0,0),Date.now()-t.getTime()>U5}};U();var{Events:eh}=Ludex,{player:Y5,event:ih}=codex,{FRAME:H5}=G.DASHBOARD,z5=1e3*30,W5=class extends Qo{lastUpdate=0;constructor(e){super(e),this.setIcon(H5.ICON_REWARDS),this.setText("Daily Rewards"),this.setName("DailyRewardsIconMenu"),this.refresh(),this.listenToEvents()}listenToEvents(){this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.update,this),ih.on(eh.OPEN_SCREEN,this.onOpenScreen),ih.on(eh.CLOSE_SCREEN,this.onCloseScreen)}unlistenToEvents(){this.scene.events.off(Phaser.Scenes.Events.UPDATE,this.update,this),ih.off(eh.OPEN_SCREEN,this.onOpenScreen),ih.off(eh.CLOSE_SCREEN,this.onCloseScreen)}update(e){e-this.lastUpdate>z5&&(this.lastUpdate=e,this.refresh())}preDestroy(){this.unlistenToEvents(),this.alertAnimController.abort(),super.preDestroy()}onOpenScreen=({screenName:e})=>{e===mt.REWARD_COINS_SCREEN&&this.refresh()};onCloseScreen=({screenName:e})=>{e===mt.REWARD_COINS_SCREEN&&this.refresh()};refresh(){this.ru()?this.playAlertAnimation():this.stopAlertAnimation()}ru(){let{lastReceiveGift:e=0}=Y5.getGameData()||{};return!this.isSameDay(e,Date.now())}isSameDay(e,t){let i=new Date(e),s=new Date(t);return i.toDateString()===s.toDateString()}};U();var{FRAME:V5}=G.DASHBOARD,X5=class extends SR{constructor(e){super(e),this.setIcon(V5.ICON_DAILY_MISSIONS),this.setText("Daily Missions"),this.setName("DailyMissionsIconMenu"),this.setAlertText("")}onOpenScreen=({screenName:e})=>{e===mt.DAILY_MISSIONS_SCREEN&&this.refresh()};onCloseScreen=({screenName:e})=>{e===mt.DAILY_MISSIONS_SCREEN&&this.refresh()};refresh(){let e=kt.checkForClaimableMissions();e>0?(this.setAlertText(`${e}`),this.playAlertAnimation()):(this.setAlertText(""),this.stopAlertAnimation())}},K5=X5,{KEY:AR,FRAME:sh}=G.DASHBOARD,j5=class extends Phaser.GameObjects.Container{logo;dailySpin;dailyRewards;inviteFriends;dailyMissions;tournament;playButton;playButtonFrame;progressBar;constructor(e){super(e),this.updateWorldSize(),this.createLogo(),this.createFrame(),this.createPlayButton(),this.createMenuButtons(),this.createProgressBar(),this.scene.add.existing(this)}createLogo(){this.logo=this.scene.add.image(0,0,AR,sh.TITLE),this.add(this.logo)}createFrame(){this.playButtonFrame=this.scene.add.image(0,0,AR,sh.BUTTON_FRAME),Phaser.Display.Align.In.BottomCenter(this.playButtonFrame,this,0,-40),this.add(this.playButtonFrame)}createPlayButton(){this.playButton=new jP(this.scene),Phaser.Display.Align.In.BottomCenter(this.playButton,this,0,-40),this.add(this.playButton)}createMenuButtons(){let e=new SR(this.scene);e.listenToEvents();let t=new Qo(this.scene);t.setIcon(sh.ICON_INVITE_FRIENDS),t.setText("With Friends");let i=new W5(this.scene),s=new K5(this.scene);s.listenToEvents();let n=new Qo(this.scene);n.setIcon(sh.ICON_CUP),n.setText("Tournaments"),this.dailySpin=e,this.tournament=n,this.dailyRewards=i,this.dailyMissions=s,this.inviteFriends=t,this.add([e,t,i,s,n])}createProgressBar(){this.progressBar=new F5(this.scene),this.add(this.progressBar)}updateWorldSize(){let{width:e,height:t}=lt.getWorldSize(),i=Math.min(e,600),s=Math.min(t,420);this.setWorldSize(i,s)}},Z5=j5;U();var q5=class extends Phaser.GameObjects.Container{constructor(e){super(e),this.updateWorldSize(),this.scene.add.existing(this)}updateWorldSize(){let{width:e}=lt.getWorldSize(),t=pt.getBannerHeight();this.setWorldSize(e,t)}},J5=q5,Q5=class extends wP{scene;header;main;footer;coinBar;constructor(e){super(e),this.scene=e,this.createObjects()}createObjects(){this.createHeader(),this.createMain(),this.createFooter(),this.createCoinBar()}createHeader(){this.header=new _5(this.scene),this.group.add(this.header)}createMain(){this.main=new Z5(this.scene),this.group.add(this.main)}createFooter(){this.footer=new J5(this.scene),this.group.add(this.footer)}createCoinBar(){this.coinBar=new ao(this.scene),this.group.add(this.coinBar)}},$5=Q5;U(),U();var tY=class extends IP{objects;constructor(e){super(e),this.objects=null}alignUI(){if(!this.objects)return;let{gameZone:e}=this.scene,{header:t,main:i,footer:s,coinBar:n}=this.objects;t.updateWorldSize(),i.updateWorldSize(),s.updateWorldSize();let r=10,o=90,a=40;it.alignChildTopRight(t.shopButton,t,-r-50,-r),it.alignChildTopRight(t.settingsButton,t,-r,-r),it.alignChildTopCenter(i.logo,i),it.alignChildCenter(i.progressBar,i),it.alignChildTopLeft(i.tournament,i,-r,-10),it.alignChildTopRight(i.dailySpin,i,-r,-10),it.alignChildTopLeft(i.inviteFriends,i,-r,-o),it.alignChildTopRight(i.dailyRewards,i,-r,-o),it.alignChildTopLeft(i.dailyMissions,i,-r,-o*2),it.alignChildBottomCenter(i.playButton,i,0,-a),it.alignChildBottomCenter(i.playButtonFrame,i,0,-a),Phaser.Display.Align.In.TopCenter(t,e),Phaser.Display.Align.In.TopLeft(n,t,-r,-r),Phaser.Display.Align.To.BottomCenter(i,t),Phaser.Display.Align.In.BottomCenter(s,e)}alignItems(){}},wR=tY,eY=class extends wR{objects;constructor(e){super(e),this.objects=null}alignUI(){if(this.objects===null)return;super.alignUI();let{header:e,main:t}=this.objects;Phaser.Display.Align.To.BottomCenter(t,e,0,-10),t.progressBar.setScale(.8),t.progressBar.setTargetScaleUp(.8),t.progressBar.setTargetScaleDown(.78),Phaser.Display.Align.To.BottomCenter(t.progressBar,t.logo),Phaser.Display.Align.To.BottomCenter(t.playButton,t.progressBar),Phaser.Display.Align.In.Center(t.playButtonFrame,t.playButton)}alignItems(){}},iY=eY,{event:CR}=codex,{Utils:{Time:sY}}=Ludex,nY=class extends OP{scene;constructor(e){super(e),this.scene=e,this.registerEvents()}createObjects(){this.objects=new $5(this.scene)}registerEvents(){CR.on(yt.VIEW_RESIZED,this.handleResize),CR.on(yt.LAYOUT_CHANGED,this.handleLayoutChange)}createLayouts(){lt.isLandscape()?this.layout=new iY(this.scene):this.layout=new wR(this.scene),this.layout.setUIObjects(this.objects)}initUILogic(){let{header:e,main:t,coinBar:i}=this.objects;e.shopButton.onClick=()=>{},e.settingsButton.onClick=()=>{ot.openScreen(mt.PAUSE_SCREEN)},t.tournament.onClick=()=>{ot.openScreen(mt.TOURNAMENTS_SCREEN)},t.dailySpin.onClick=()=>{ot.openScreen(mt.LUCKY_WHEEL_SCREEN,{coinBar:i})},t.inviteFriends.onClick=this.handleInviteFriends,t.dailyMissions.onClick=()=>{ot.openScreen(mt.DAILY_MISSIONS_SCREEN,{coinBar:i})},t.dailyRewards.onClick=()=>{ot.openScreen(mt.REWARD_COINS_SCREEN,{coinBar:i})},t.playButton.onClick=this.handlePlay,t.progressBar.onClick=()=>{ot.openScreen(mt.JOURNEY_SCREEN)},sY.sleepAsync(100).then(()=>{})}handlePlay=async()=>{await ht.startSingleModeAsync()&&It.switchToGameScene()};handleInviteFriends=async()=>{await ht.startChallengeChooseOpponentAsync()&&It.switchToGameScene()};updateUIState(){this.objects.main.progressBar.updateProgress()}},rY=nY,{player:aY,storage:oY}=codex,{Utils:{Valid:hY,Array:lY,Time:uY}}=Ludex,cY=class extends hr{layoutManager;run=async()=>{this.layoutManager.init(),this.initEvents(),this.updatePlayButton(),this.updateCoinBar(),this.updateDailyMissionsIconMenu(),this.layoutManager.start(),nt.playMusic(),nt.setDefaultVolumeMusic(),this.tryShowTournamentResult()};initEvents(){let{event:e}=codex;e.off(yt.COINS_CHANGED,this.updateCoinBar),e.on(yt.COINS_CHANGED,this.updateCoinBar)}updatePlayButton(){let{level:e}=aY.getGameData()??{};if(!hY.isNumber(e))return;let{main:t}=this.layoutManager.objects;t.playButton.setLevel(e),t.playButton.playShineAnimation()}updateDailyMissionsIconMenu=()=>{let{main:e}=this.layoutManager.objects;e.dailyMissions.refresh()};updateCoinBar=()=>{let{coinBar:e}=this.layoutManager.objects;e.updatePlayerCoin()};preload(){this.events.on("wake",this.run),this.events.on("resume",this.run),this.events.on("create",this.run)}create(){super.create(),this.createBackground(Xt.BACKGROUND.KEY),this.createManagers()}createManagers(){this.layoutManager=new rY(this)}async tryShowTournamentResult(){await uY.sleepAsync(0);try{let e=oY.getStorage("Tournament"),{showResult:t}=e;if(!t)return;ot.showLoadingScreen();let i=await Ip.requestTournamentDataAsync();ot.closeLoadingScreen();let{tournamentId:s}=ht.getMatchState().customData;if(!s)throw new Error("Tournament ID not found");let n=lY.search(i,r=>r.id===s);if(!n)throw new Error("Tournament not found");ot.openScreen(mt.TOURNAMENT_DETAIL_SCREEN,{tournamentPayload:n,tournamentContext:"tournament_end"})}catch{}}},dY=cY,pY=dY,gY=class extends Phaser.Game{async boot(){super.boot(),this.addExtraGameObjectMethods(),this.addPlugins(),this.addScenes(),this.initWorld(),this.initUtils()}addExtraGameObjectMethods(){let e=new T5;e.addKillRevive(),e.addKillReviveGroup(),e.addDrawDebugBox(),e.addSetFrame(),e.addSetWorldSize(),e.addSetWorldSizeForContainer(),e.addGetWorldPosition(),e.addHighQuality(),e.addSetWorldSizeForNineSlice()}addPlugins(){window.SpinePlugin&&this.plugins.installScenePlugin("SpinePlugin",SpinePlugin,"spine")}addScenes(){this.scene.add(Yt.BOOT_SCENE,w5,!1),this.scene.add(Yt.LOAD_SCENE,Xw,!1),this.scene.add(Yt.GAME_SCENE,Pr,!1),this.scene.add(Yt.DASHBOARD_SCENE,pY,!1),this.scene.add(Yt.GLOBAL_SCENE,Vw,!1)}initWorld(){lt.init(this)}initUtils(){this.removeUnusedPipelines()}removeUnusedPipelines(){let e=this.renderer;if(!(e instanceof Phaser.Renderer.WebGL.WebGLRenderer))return;let{pipelines:t}=e,i=Phaser.Renderer.WebGL.Pipelines,s=[i.ROPE_PIPELINE,i.LIGHT_PIPELINE,i.POSTFX_PIPELINE,i.POINTLIGHT_PIPELINE,i.BITMAPMASK_PIPELINE];for(let n of s)t.get(n)?.destroy(),t.remove(n)}},fY=gY;U();var mY={parent:"GameDiv",scale:{autoRound:!0},dom:{createContainer:!1},fps:{target:60,smoothStep:!0},loader:{maxParallelDownloads:6,crossOrigin:"no-cros"},input:{gamepad:!1,touch:{capture:!0},smoothFactor:1,activePointers:1,windowEvents:!1},disableContextMenu:!0,render:{pixelArt:!1,antialias:!0,transparent:!1,desynchronized:!0,powerPreference:"low-power",clearBeforeRender:!1,roundPixels:!1,mipmapFilter:"LINEAR_MIPMAP_LINEAR"},plugins:{global:[]}},vY=mY,{event:EY}=codex,{Events:yY}=Ludex,TY=()=>{try{window.phaser=new fY(vY),EY.emit(yY.BUNDLE_READY)}catch{}};TY()})();
