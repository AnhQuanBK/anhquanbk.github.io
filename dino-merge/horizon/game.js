"use strict";(()=>{var Lee=Object.create;var Sf=Object.defineProperty;var MA=Object.getOwnPropertyDescriptor;var Mee=Object.getOwnPropertyNames;var Oee=Object.getPrototypeOf,Dee=Object.prototype.hasOwnProperty;var u=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Bee=(t,e,i,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Mee(e))!Dee.call(t,r)&&r!==i&&Sf(t,r,{get:()=>e[r],enumerable:!(s=MA(e,r))||s.enumerable});return t};var E=(t,e,i)=>(i=t!=null?Lee(Oee(t)):{},Bee(e||!t||!t.__esModule?Sf(i,"default",{value:t,enumerable:!0}):i,t));var Bt=(t,e,i,s)=>{for(var r=s>1?void 0:s?MA(e,i):e,n=t.length-1,a;n>=0;n--)(a=t[n])&&(r=(s?a(e,i,r):a(r))||r);return s&&r&&Sf(e,i,r),r};var OA=u(()=>{"use strict";Array.prototype.forEach||(Array.prototype.forEach=function(t){"use strict";if(this===void 0||this===null)throw new TypeError;var e=Object(this),i=e.length>>>0;if(typeof t!="function")throw new TypeError;for(var s=arguments.length>=2?arguments[1]:void 0,r=0;r<i;r++)r in e&&t.call(s,e[r],r,e)})});var DA=u(()=>{"use strict";Array.isArray||(Array.isArray=function(t){return Object.prototype.toString.call(t)==="[object Array]"})});var BA=u(()=>{"use strict";window.console||(window.console={},window.console.log=window.console.assert=function(){},window.console.warn=window.console.assert=function(){})});var UA=u(()=>{"use strict";Math.trunc||(Math.trunc=function(e){return e<0?Math.ceil(e):Math.floor(e)})});var NA=u(()=>{"use strict";(function(){if("performance"in window||(window.performance={}),Date.now=Date.now||function(){return new Date().getTime()},!("now"in window.performance)){var t=Date.now();performance.timing&&performance.timing.navigationStart&&(t=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-t}}})()});var FA=u(()=>{"use strict";var Ef=Date.now(),Wl=["ms","moz","webkit","o"];for(Ra=0;Ra<Wl.length&&!window.requestAnimationFrame;Ra++)window.requestAnimationFrame=window[Wl[Ra]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[Wl[Ra]+"CancelAnimationFrame"]||window[Wl[Ra]+"CancelRequestAnimationFrame"];var Ra;window.requestAnimationFrame||(window.requestAnimationFrame=function(t){if(typeof t!="function")throw new TypeError(t+"is not a function");var e=Date.now(),i=16+Ef-e;return i<0&&(i=0),Ef=e,setTimeout(function(){Ef=Date.now(),t(performance.now())},i)});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})});var kA=u(()=>{"use strict";typeof window.Uint32Array!="function"&&typeof window.Uint32Array!="object"&&(Mr=function(t){var e=new Array;window[t]=function(i){if(typeof i=="number"){Array.call(this,i),this.length=i;for(var s=0;s<this.length;s++)this[s]=0}else{Array.call(this,i.length),this.length=i.length;for(var s=0;s<this.length;s++)this[s]=i[s]}},window[t].prototype=e,window[t].constructor=window[t]},Mr("Float32Array"),Mr("Uint32Array"),Mr("Uint16Array"),Mr("Int16Array"),Mr("ArrayBuffer"),Mr("Int8Array"),Mr("Uint8Array"));var Mr});var R=u((sOe,qA)=>{"use strict";function Uee(t){return!!t.get&&typeof t.get=="function"||!!t.set&&typeof t.set=="function"}function Nee(t,e,i){var s=i?t[e]:Object.getOwnPropertyDescriptor(t,e);return!i&&s.value&&typeof s.value=="object"&&(s=s.value),s&&Uee(s)?(typeof s.enumerable>"u"&&(s.enumerable=!0),typeof s.configurable>"u"&&(s.configurable=!0),s):!1}function Fee(t,e){var i=Object.getOwnPropertyDescriptor(t,e);return i?(i.value&&typeof i.value=="object"&&(i=i.value),i.configurable===!1):!1}function Tf(t,e,i,s){for(var r in e)if(e.hasOwnProperty(r)){var n=Nee(e,r,i);if(n!==!1){var a=s||t;if(Fee(a.prototype,r)){if(jo.ignoreFinals)continue;throw new Error("cannot override final property '"+r+"', set Class.ignoreFinals = true to skip")}Object.defineProperty(t.prototype,r,n)}else t.prototype[r]=e[r]}}function GA(t,e){if(e){Array.isArray(e)||(e=[e]);for(var i=0;i<e.length;i++)Tf(t,e[i].prototype||e[i])}}function jo(t){t||(t={});var e,i;if(t.initialize){if(typeof t.initialize!="function")throw new Error("initialize must be a function");e=t.initialize,delete t.initialize}else if(t.Extends){var s=t.Extends;e=function(){s.apply(this,arguments)}}else e=function(){};t.Extends?(e.prototype=Object.create(t.Extends.prototype),e.prototype.constructor=e,i=t.Extends,delete t.Extends):e.prototype.constructor=e;var r=null;return t.Mixins&&(r=t.Mixins,delete t.Mixins),GA(e,r),Tf(e,t,!0,i),e}jo.extend=Tf;jo.mixin=GA;jo.ignoreFinals=!1;qA.exports=jo});var Je=u((rOe,WA)=>{"use strict";var kee=function(t,e,i){return Math.max(e,Math.min(i,t))};WA.exports=kee});var HA=u((nOe,YA)=>{"use strict";var er=Je(),Pa=2,Gee={_alpha:1,_alphaTL:1,_alphaTR:1,_alphaBL:1,_alphaBR:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(t,e,i,s){return t===void 0&&(t=1),e===void 0?this.alpha=t:(this._alphaTL=er(t,0,1),this._alphaTR=er(e,0,1),this._alphaBL=er(i,0,1),this._alphaBR=er(s,0,1)),this},alpha:{get:function(){return this._alpha},set:function(t){var e=er(t,0,1);this._alpha=e,this._alphaTL=e,this._alphaTR=e,this._alphaBL=e,this._alphaBR=e,e===0?this.renderFlags&=~Pa:this.renderFlags|=Pa}},alphaTopLeft:{get:function(){return this._alphaTL},set:function(t){var e=er(t,0,1);this._alphaTL=e,e!==0&&(this.renderFlags|=Pa)}},alphaTopRight:{get:function(){return this._alphaTR},set:function(t){var e=er(t,0,1);this._alphaTR=e,e!==0&&(this.renderFlags|=Pa)}},alphaBottomLeft:{get:function(){return this._alphaBL},set:function(t){var e=er(t,0,1);this._alphaBL=e,e!==0&&(this.renderFlags|=Pa)}},alphaBottomRight:{get:function(){return this._alphaBR},set:function(t){var e=er(t,0,1);this._alphaBR=e,e!==0&&(this.renderFlags|=Pa)}}};YA.exports=Gee});var XA=u((aOe,VA)=>{"use strict";var qee=Je(),zA=2,Wee={_alpha:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(t){return t===void 0&&(t=1),this.alpha=t,this},alpha:{get:function(){return this._alpha},set:function(t){var e=qee(t,0,1);this._alpha=e,e===0?this.renderFlags&=~zA:this.renderFlags|=zA}}};VA.exports=Wee});var xn=u((oOe,KA)=>{"use strict";KA.exports={SKIP_CHECK:-1,NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,ERASE:17,SOURCE_IN:18,SOURCE_OUT:19,SOURCE_ATOP:20,DESTINATION_OVER:21,DESTINATION_IN:22,DESTINATION_OUT:23,DESTINATION_ATOP:24,LIGHTER:25,COPY:26,XOR:27}});var $A=u((hOe,jA)=>{"use strict";var ZA=xn(),Yee={_blendMode:ZA.NORMAL,blendMode:{get:function(){return this._blendMode},set:function(t){typeof t=="string"&&(t=ZA[t]),t|=0,t>=-1&&(this._blendMode=t)}},setBlendMode:function(t){return this.blendMode=t,this}};jA.exports=Yee});var QA=u((lOe,JA)=>{"use strict";var Hee={width:0,height:0,displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}},setSize:function(t,e){return this.width=t,this.height=e,this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this}};JA.exports=Hee});var tx=u((uOe,ex)=>{"use strict";var zee={texture:null,frame:null,isCropped:!1,setCrop:function(t,e,i,s){if(t===void 0)this.isCropped=!1;else if(this.frame){if(typeof t=="number")this.frame.setCropUVs(this._crop,t,e,i,s,this.flipX,this.flipY);else{var r=t;this.frame.setCropUVs(this._crop,r.x,r.y,r.width,r.height,this.flipX,this.flipY)}this.isCropped=!0}return this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:!1,flipY:!1,cx:0,cy:0,cw:0,ch:0}}};ex.exports=zee});var Yl=u((cOe,ix)=>{"use strict";var Vee=function(t){if(!Array.isArray(t)||!Array.isArray(t[0]))return!1;for(var e=t[0].length,i=1;i<t.length;i++)if(t[i].length!==e)return!1;return!0};ix.exports=Vee});var yf=u((dOe,sx)=>{"use strict";var Xee=function(t,e,i,s){e===void 0&&(e=0),i===void 0&&(i=" "),s===void 0&&(s=3),t=t.toString();var r=0;if(e+1>=t.length)switch(s){case 1:t=new Array(e+1-t.length).join(i)+t;break;case 3:var n=Math.ceil((r=e-t.length)/2),a=r-n;t=new Array(a+1).join(i)+t+new Array(n+1).join(i);break;default:t=t+new Array(e+1-t.length).join(i);break}return t};sx.exports=Xee});var nx=u((fOe,rx)=>{"use strict";var Kee=yf(),Zee=Yl(),jee=function(t){var e="";if(!Zee(t))return e;for(var i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++){var r=t[i][s].toString();r!=="undefined"?e+=Kee(r,2):e+="?",s<t[i].length-1&&(e+=" |")}if(i<t.length-1){e+=`
`;for(var n=0;n<t[i].length;n++)e+="---",n<t[i].length-1&&(e+="+");e+=`
`}}return e};rx.exports=jee});var ox=u((pOe,ax)=>{"use strict";var $ee=function(t){return t.reverse()};ax.exports=$ee});var lx=u((mOe,hx)=>{"use strict";var Jee=function(t){for(var e=0;e<t.length;e++)t[e].reverse();return t};hx.exports=Jee});var bf=u((vOe,ux)=>{"use strict";var Qee=function(t){for(var e=t.length,i=t[0].length,s=new Array(i),r=0;r<i;r++){s[r]=new Array(e);for(var n=e-1;n>-1;n--)s[r][n]=t[n][r]}return s};ux.exports=Qee});var $o=u((gOe,dx)=>{"use strict";var ete=Yl(),cx=bf(),tte=function(t,e){if(e===void 0&&(e=90),!ete(t))return null;if(typeof e!="string"&&(e=(e%360+360)%360),e===90||e===-270||e==="rotateLeft")t=cx(t),t.reverse();else if(e===-90||e===270||e==="rotateRight")t.reverse(),t=cx(t);else if(Math.abs(e)===180||e==="rotate180"){for(var i=0;i<t.length;i++)t[i].reverse();t.reverse()}return t};dx.exports=tte});var px=u((SOe,fx)=>{"use strict";var ite=$o(),ste=function(t){return ite(t,180)};fx.exports=ste});var vx=u((EOe,mx)=>{"use strict";var rte=$o(),nte=function(t,e){e===void 0&&(e=1);for(var i=0;i<e;i++)t=rte(t,90);return t};mx.exports=nte});var Sx=u((TOe,gx)=>{"use strict";var ate=$o(),ote=function(t,e){e===void 0&&(e=1);for(var i=0;i<e;i++)t=ate(t,-90);return t};gx.exports=ote});var Hl=u((yOe,Ex)=>{"use strict";var hte=function(t,e){e===void 0&&(e=1);for(var i=null,s=0;s<e;s++)i=t.shift(),t.push(i);return i};Ex.exports=hte});var zl=u((bOe,Tx)=>{"use strict";var lte=function(t,e){e===void 0&&(e=1);for(var i=null,s=0;s<e;s++)i=t.pop(),t.unshift(i);return i};Tx.exports=lte});var xx=u((AOe,Ax)=>{"use strict";var yx=Hl(),bx=zl(),ute=function(t,e,i){if(e===void 0&&(e=0),i===void 0&&(i=0),i!==0&&(i<0?yx(t,Math.abs(i)):bx(t,i)),e!==0)for(var s=0;s<t.length;s++){var r=t[s];e<0?yx(r,Math.abs(e)):bx(r,e)}return t};Ax.exports=ute});var wx=u((xOe,Cx)=>{"use strict";Cx.exports={CheckMatrix:Yl(),MatrixToString:nx(),ReverseColumns:ox(),ReverseRows:lx(),Rotate180:px(),RotateLeft:vx(),RotateMatrix:$o(),RotateRight:Sx(),Translate:xx(),TransposeMatrix:bf()}});var Px=u((COe,Rx)=>{"use strict";var cte=function(t,e,i,s,r){if(r===void 0&&(r=t),i>0){var n=i-t.length;if(n<=0)return null}if(!Array.isArray(e))return t.indexOf(e)===-1?(t.push(e),s&&s.call(r,e),e):null;for(var a=e.length-1;a>=0;)t.indexOf(e[a])!==-1&&e.splice(a,1),a--;if(a=e.length,a===0)return null;i>0&&a>n&&(e.splice(n),a=n);for(var o=0;o<a;o++){var h=e[o];t.push(h),s&&s.call(r,h)}return e};Rx.exports=cte});var Ix=u((wOe,_x)=>{"use strict";var dte=function(t,e,i,s,r,n){if(i===void 0&&(i=0),n===void 0&&(n=t),s>0){var a=s-t.length;if(a<=0)return null}if(!Array.isArray(e))return t.indexOf(e)===-1?(t.splice(i,0,e),r&&r.call(n,e),e):null;for(var o=e.length-1;o>=0;)t.indexOf(e[o])!==-1&&e.pop(),o--;if(o=e.length,o===0)return null;s>0&&o>a&&(e.splice(a),o=a);for(var h=o-1;h>=0;h--){var l=e[h];t.splice(i,0,l),r&&r.call(n,l)}return e};_x.exports=dte});var Mx=u((ROe,Lx)=>{"use strict";var fte=function(t,e){var i=t.indexOf(e);return i!==-1&&i<t.length&&(t.splice(i,1),t.push(e)),e};Lx.exports=fte});var Or=u((POe,Ox)=>{"use strict";var pte=function(t,e,i,s){var r=t.length;if(e<0||e>=r||e>=i||i>r){if(s)throw new Error("Range Error: Values outside acceptable range");return!1}else return!0};Ox.exports=pte});var Bx=u((_Oe,Dx)=>{"use strict";var mte=Or(),vte=function(t,e,i,s,r){s===void 0&&(s=0),r===void 0&&(r=t.length);var n=0;if(mte(t,s,r))for(var a=s;a<r;a++){var o=t[a];o[e]===i&&n++}return n};Dx.exports=vte});var Jo=u((IOe,Ux)=>{"use strict";var gte=function(t,e,i){var s,r=[null];for(s=3;s<arguments.length;s++)r.push(arguments[s]);for(s=0;s<t.length;s++)r[0]=t[s],e.apply(i,r);return t};Ux.exports=gte});var Fx=u((LOe,Nx)=>{"use strict";var Ste=Or(),Ete=function(t,e,i,s,r){if(s===void 0&&(s=0),r===void 0&&(r=t.length),Ste(t,s,r)){var n,a=[null];for(n=5;n<arguments.length;n++)a.push(arguments[n]);for(n=s;n<r;n++)a[0]=t[n],e.apply(i,a)}return t};Nx.exports=Ete});var Af=u((MOe,kx)=>{"use strict";var Tte=function(t,e,i){if(e.length){if(e.length===1)return e[0]}else return NaN;var s=1,r,n;if(i){if(t<e[0][i])return e[0];for(;e[s][i]<t;)s++}else for(;e[s]<t;)s++;return s>e.length&&(s=e.length),i?(r=e[s-1][i],n=e[s][i],n-t<=t-r?e[s]:e[s-1]):(r=e[s-1],n=e[s],n-t<=t-r?n:r)};kx.exports=Tte});var xf=u((OOe,qx)=>{"use strict";var Gx=function(t,e){e===void 0&&(e=[]);for(var i=0;i<t.length;i++)Array.isArray(t[i])?Gx(t[i],e):e.push(t[i]);return e};qx.exports=Gx});var Vl=u((DOe,Wx)=>{"use strict";var yte=Or(),bte=function(t,e,i,s,r){s===void 0&&(s=0),r===void 0&&(r=t.length);var n=[];if(yte(t,s,r))for(var a=s;a<r;a++){var o=t[a];(!e||e&&i===void 0&&o.hasOwnProperty(e)||e&&i!==void 0&&o[e]===i)&&n.push(o)}return n};Wx.exports=bte});var Cf=u((BOe,Hx)=>{"use strict";var Yx=Or(),Ate=function(t,e,i,s,r){if(s===void 0&&(s=0),r===void 0&&(r=t.length),s!==-1){if(Yx(t,s,r))for(var n=s;n<r;n++){var a=t[n];if(!e||e&&i===void 0&&a.hasOwnProperty(e)||e&&i!==void 0&&a[e]===i)return a}}else if(Yx(t,0,r))for(var n=r;n>=0;n--){var a=t[n];if(!e||e&&i===void 0&&a.hasOwnProperty(e)||e&&i!==void 0&&a[e]===i)return a}return null};Hx.exports=Ate});var wf=u((UOe,zx)=>{"use strict";var xte=function(t,e,i){e===void 0&&(e=0),i===void 0&&(i=t.length);var s=e+Math.floor(Math.random()*i);return t[s]===void 0?null:t[s]};zx.exports=xte});var Xx=u((NOe,Vx)=>{"use strict";var Cte=function(t,e){var i=t.indexOf(e);if(i>0){var s=t[i-1],r=t.indexOf(s);t[i]=s,t[r]=e}return t};Vx.exports=Cte});var Zx=u((FOe,Kx)=>{"use strict";var wte=function(t,e,i){var s=t.indexOf(e);if(s===-1||i<0||i>=t.length)throw new Error("Supplied index out of bounds");return s!==i&&(t.splice(s,1),t.splice(i,0,e)),e};Kx.exports=wte});var $x=u((kOe,jx)=>{"use strict";var Rte=function(t,e){var i=t.indexOf(e);if(i!==-1&&i<t.length-1){var s=t[i+1],r=t.indexOf(s);t[i]=s,t[r]=e}return t};jx.exports=Rte});var Qx=u((GOe,Jx)=>{"use strict";var Pte=function(t,e,i){if(e===i)return t;var s=t.indexOf(e),r=t.indexOf(i);if(s<0||r<0)throw new Error("Supplied items must be elements of the same array");return s>r||(t.splice(s,1),r=t.indexOf(i),t.splice(r+1,0,e)),t};Jx.exports=Pte});var tC=u((qOe,eC)=>{"use strict";var _te=function(t,e,i){if(e===i)return t;var s=t.indexOf(e),r=t.indexOf(i);if(s<0||r<0)throw new Error("Supplied items must be elements of the same array");return s<r||(t.splice(s,1),r===0?t.unshift(e):t.splice(r,0,e)),t};eC.exports=_te});var Rf=u((WOe,iC)=>{"use strict";var Ite=function(t,e,i,s){var r=[],n,a=!1;if((i||s)&&(a=!0,i||(i=""),s||(s="")),e<t)for(n=t;n>=e;n--)a?r.push(i+n.toString()+s):r.push(n);else for(n=t;n<=e;n++)a?r.push(i+n.toString()+s):r.push(n);return r};iC.exports=Ite});var rC=u((YOe,sC)=>{"use strict";var Lte=function(t){return t>0?Math.ceil(t):Math.floor(t)};sC.exports=Lte});var aC=u((HOe,nC)=>{"use strict";var Mte=rC(),Ote=function(t,e,i){t===void 0&&(t=0),e===void 0&&(e=null),i===void 0&&(i=1),e===null&&(e=t,t=0);for(var s=[],r=Math.max(Mte((e-t)/(i||1)),0),n=0;n<r;n++)s.push(t),t+=i;return s};nC.exports=Ote});var lC=u((zOe,hC)=>{"use strict";function Qo(t,e,i){var s=t[e];t[e]=t[i],t[i]=s}function Dte(t,e){return t<e?-1:t>e?1:0}var oC=function(t,e,i,s,r){for(i===void 0&&(i=0),s===void 0&&(s=t.length-1),r===void 0&&(r=Dte);s>i;){if(s-i>600){var n=s-i+1,a=e-i+1,o=Math.log(n),h=.5*Math.exp(2*o/3),l=.5*Math.sqrt(o*h*(n-h)/n)*(a-n/2<0?-1:1),c=Math.max(i,Math.floor(e-a*h/n+l)),d=Math.min(s,Math.floor(e+(n-a)*h/n+l));oC(t,e,c,d,r)}var f=t[e],p=i,m=s;for(Qo(t,i,e),r(t[s],f)>0&&Qo(t,i,s);p<m;){for(Qo(t,p,m),p++,m--;r(t[p],f)<0;)p++;for(;r(t[m],f)>0;)m--}r(t[i],f)===0?Qo(t,i,m):(m++,Qo(t,m,s)),m<=e&&(i=m+1),e<=m&&(s=m-1)}};hC.exports=oC});var Ne=u((VOe,uC)=>{"use strict";var Bte=function(t,e,i,s){if(!t&&!s||typeof t=="number")return i;if(t&&t.hasOwnProperty(e))return t[e];if(s&&s.hasOwnProperty(e))return s[e];if(e.indexOf(".")!==-1){for(var r=e.split("."),n=t,a=s,o=i,h=i,l=!0,c=!0,d=0;d<r.length;d++)n&&n.hasOwnProperty(r[d])?(o=n[r[d]],n=n[r[d]]):l=!1,a&&a.hasOwnProperty(r[d])?(h=a[r[d]],a=a[r[d]]):c=!1;return l?o:c?h:i}else return i};uC.exports=Bte});var Xl=u((XOe,cC)=>{"use strict";var Ute=function(t){for(var e=t.length-1;e>0;e--){var i=Math.floor(Math.random()*(e+1)),s=t[e];t[e]=t[i],t[i]=s}return t};cC.exports=Ute});var Pf=u((KOe,fC)=>{"use strict";var _a=Ne(),dC=Xl(),Nte=function(t,e,i){for(var s=[],r=0;r<t.length;r++)for(var n=0;n<e.length;n++)for(var a=0;a<i;a++)s.push({a:t[r],b:e[n]});return s},Fte=function(t,e,i){var s=_a(i,"max",0),r=_a(i,"qty",1),n=_a(i,"random",!1),a=_a(i,"randomB",!1),o=_a(i,"repeat",0),h=_a(i,"yoyo",!1),l=[];if(a&&dC(e),o===-1)if(s===0)o=0;else{var c=t.length*e.length*r;h&&(c*=2),o=Math.ceil(s/c)}for(var d=0;d<=o;d++){var f=Nte(t,e,r);n&&dC(f),l=l.concat(f),h&&(f.reverse(),l=l.concat(f))}return s&&l.splice(s),l};fC.exports=Fte});var Ia=u((ZOe,pC)=>{"use strict";var kte=function(t,e){if(!(e>=t.length)){for(var i=t.length-1,s=t[e],r=e;r<i;r++)t[r]=t[r+1];return t.length=i,s}};pC.exports=kte});var tr=u((jOe,vC)=>{"use strict";var mC=Ia(),Gte=function(t,e,i,s){s===void 0&&(s=t);var r;if(!Array.isArray(e))return r=t.indexOf(e),r!==-1?(mC(t,r),i&&i.call(s,e),e):null;for(var n=e.length-1,a=[];n>=0;){var o=e[n];r=t.indexOf(o),r!==-1&&(mC(t,r),a.push(o),i&&i.call(s,o)),n--}return a};vC.exports=Gte});var SC=u(($Oe,gC)=>{"use strict";var qte=Ia(),Wte=function(t,e,i,s){if(s===void 0&&(s=t),e<0||e>t.length-1)throw new Error("Index out of bounds");var r=qte(t,e);return i&&i.call(s,r),r};gC.exports=Wte});var TC=u((JOe,EC)=>{"use strict";var Yte=Or(),Hte=function(t,e,i,s,r){if(e===void 0&&(e=0),i===void 0&&(i=t.length),r===void 0&&(r=t),Yte(t,e,i)){var n=i-e,a=t.splice(e,n);if(s)for(var o=0;o<a.length;o++){var h=a[o];s.call(r,h)}return a}else return[]};EC.exports=Hte});var bC=u((QOe,yC)=>{"use strict";var zte=Ia(),Vte=function(t,e,i){e===void 0&&(e=0),i===void 0&&(i=t.length);var s=e+Math.floor(Math.random()*i);return zte(t,s)};yC.exports=Vte});var xC=u((eDe,AC)=>{"use strict";var Xte=function(t,e,i){var s=t.indexOf(e),r=t.indexOf(i);return s!==-1&&r===-1?(t[s]=i,!0):!1};AC.exports=Xte});var wC=u((tDe,CC)=>{"use strict";var Kte=function(t,e){var i=t.indexOf(e);return i!==-1&&i>0&&(t.splice(i,1),t.unshift(e)),e};CC.exports=Kte});var PC=u((iDe,RC)=>{"use strict";var Zte=Or(),jte=function(t,e,i,s,r){if(s===void 0&&(s=0),r===void 0&&(r=t.length),Zte(t,s,r))for(var n=s;n<r;n++){var a=t[n];a.hasOwnProperty(e)&&(a[e]=i)}return t};RC.exports=jte});var _f=u((sDe,_C)=>{"use strict";var $te=function(t){var e=/\D/g;return t.sort(function(i,s){return parseInt(i.replace(e,""),10)-parseInt(s.replace(e,""),10)}),t};_C.exports=$te});var La=u((rDe,IC)=>{"use strict";var me={android:!1,chromeOS:!1,cordova:!1,crosswalk:!1,desktop:!1,ejecta:!1,electron:!1,iOS:!1,iOSVersion:0,iPad:!1,iPhone:!1,kindle:!1,linux:!1,macOS:!1,node:!1,nodeWebkit:!1,pixelRatio:1,webApp:!1,windows:!1,windowsPhone:!1};function Jte(){if(typeof importScripts=="function")return me;var t=navigator.userAgent;/Windows/.test(t)?me.windows=!0:/Mac OS/.test(t)&&!/like Mac OS/.test(t)?navigator.maxTouchPoints&&navigator.maxTouchPoints>2?(me.iOS=!0,me.iPad=!0,navigator.appVersion.match(/Version\/(\d+)/),me.iOSVersion=parseInt(RegExp.$1,10)):me.macOS=!0:/Android/.test(t)?me.android=!0:/Linux/.test(t)?me.linux=!0:/iP[ao]d|iPhone/i.test(t)?(me.iOS=!0,navigator.appVersion.match(/OS (\d+)/),me.iOSVersion=parseInt(RegExp.$1,10),me.iPhone=t.toLowerCase().indexOf("iphone")!==-1,me.iPad=t.toLowerCase().indexOf("ipad")!==-1):/Kindle/.test(t)||/\bKF[A-Z][A-Z]+/.test(t)||/Silk.*Mobile Safari/.test(t)?me.kindle=!0:/CrOS/.test(t)&&(me.chromeOS=!0),(/Windows Phone/i.test(t)||/IEMobile/i.test(t))&&(me.android=!1,me.iOS=!1,me.macOS=!1,me.windows=!0,me.windowsPhone=!0);var e=/Silk/.test(t);return(me.windows||me.macOS||me.linux&&!e||me.chromeOS)&&(me.desktop=!0),(me.windowsPhone||/Windows NT/i.test(t)&&/Touch/i.test(t))&&(me.desktop=!1),navigator.standalone&&(me.webApp=!0),typeof importScripts!="function"&&(window.cordova!==void 0&&(me.cordova=!0),window.ejecta!==void 0&&(me.ejecta=!0)),typeof process<"u"&&process.versions&&process.versions.node&&(me.node=!0),me.node&&typeof process.versions=="object"&&(me.nodeWebkit=!!process.versions["node-webkit"],me.electron=!!process.versions.electron),/Crosswalk/.test(t)&&(me.crosswalk=!0),me.pixelRatio=window.devicePixelRatio||1,me}IC.exports=Jte()});var eh=u((nDe,LC)=>{"use strict";var If=La(),_e={chrome:!1,chromeVersion:0,edge:!1,firefox:!1,firefoxVersion:0,ie:!1,ieVersion:0,mobileSafari:!1,opera:!1,safari:!1,safariVersion:0,silk:!1,trident:!1,tridentVersion:0,es2019:!1};function Qte(){var t=navigator.userAgent;return/Edg\/\d+/.test(t)?(_e.edge=!0,_e.es2019=!0):/OPR/.test(t)?(_e.opera=!0,_e.es2019=!0):/Chrome\/(\d+)/.test(t)&&!If.windowsPhone?(_e.chrome=!0,_e.chromeVersion=parseInt(RegExp.$1,10),_e.es2019=_e.chromeVersion>69):/Firefox\D+(\d+)/.test(t)?(_e.firefox=!0,_e.firefoxVersion=parseInt(RegExp.$1,10),_e.es2019=_e.firefoxVersion>10):/AppleWebKit\/(?!.*CriOS)/.test(t)&&If.iOS?(_e.mobileSafari=!0,_e.es2019=!0):/MSIE (\d+\.\d+);/.test(t)?(_e.ie=!0,_e.ieVersion=parseInt(RegExp.$1,10)):/Version\/(\d+\.\d+(\.\d+)?) Safari/.test(t)&&!If.windowsPhone?(_e.safari=!0,_e.safariVersion=parseInt(RegExp.$1,10),_e.es2019=_e.safariVersion>10):/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(t)&&(_e.ie=!0,_e.trident=!0,_e.tridentVersion=parseInt(RegExp.$1,10),_e.ieVersion=parseInt(RegExp.$3,10)),/Silk/.test(t)&&(_e.silk=!0),_e}LC.exports=Qte()});var Lf=u((aDe,MC)=>{"use strict";var eie={DEFAULT:0,LINEAR:0,NEAREST:1};MC.exports=eie});var Qi=u((oDe,OC)=>{"use strict";var tie={VERSION:"3.88.2",LOG_VERSION:"v388",BlendModes:xn(),ScaleModes:Lf(),AUTO:0,CANVAS:1,WEBGL:2,HEADLESS:3,FOREVER:-1,NONE:4,UP:5,DOWN:6,LEFT:7,RIGHT:8};OC.exports=tie});var Mf=u((hDe,DC)=>{"use strict";var xs="",iie=function(){var t=function(r){for(var n=["i","webkitI","msI","mozI","oI"],a=0;a<n.length;a++){var o=n[a]+"mageSmoothingEnabled";if(o in r)return o}return null},e=function(r){return xs===""&&(xs=t(r)),xs&&(r[xs]=!0),r},i=function(r){return xs===""&&(xs=t(r)),xs&&(r[xs]=!1),r},s=function(r){return xs!==null?r[xs]:null};return{disable:i,enable:e,getPrefix:t,isEnabled:s}};DC.exports=iie()});var Ui=u((lDe,BC)=>{"use strict";var Cn=Qi(),sie=Mf(),wn=[],Of=!1,rie=function(){var t=function(l,c,d,f,p){c===void 0&&(c=1),d===void 0&&(d=1),f===void 0&&(f=Cn.CANVAS),p===void 0&&(p=!1);var m,v=s(f);return v===null?(v={parent:l,canvas:document.createElement("canvas"),type:f},f===Cn.CANVAS&&wn.push(v),m=v.canvas):(v.parent=l,m=v.canvas),p&&(v.parent=m),m.width=c,m.height=d,Of&&f===Cn.CANVAS&&sie.disable(m.getContext("2d",{willReadFrequently:!1})),m},e=function(l,c,d){return t(l,c,d,Cn.CANVAS)},i=function(l,c,d){return t(l,c,d,Cn.WEBGL)},s=function(l){if(l===void 0&&(l=Cn.CANVAS),l===Cn.WEBGL)return null;for(var c=0;c<wn.length;c++){var d=wn[c];if(!d.parent&&d.type===l)return d}return null},r=function(l){var c=l instanceof HTMLCanvasElement;wn.forEach(function(d){(c&&d.canvas===l||!c&&d.parent===l)&&(d.parent=null,d.canvas.width=1,d.canvas.height=1)})},n=function(){var l=0;return wn.forEach(function(c){c.parent&&l++}),l},a=function(){return wn.length-n()},o=function(){Of=!0},h=function(){Of=!1};return{create2D:e,create:t,createWebGL:i,disableSmoothing:o,enableSmoothing:h,first:s,free:a,pool:wn,remove:r,total:n}};BC.exports=rie()});var Zl=u((uDe,UC)=>{"use strict";var nie=La(),Rn=eh(),Kl=Ui(),ct={canvas:!1,canvasBitBltShift:null,file:!1,fileSystem:!1,getUserMedia:!0,littleEndian:!1,localStorage:!1,pointerLock:!1,stableSort:!1,support32bit:!1,vibration:!1,webGL:!1,worker:!1};function aie(){var t=new ArrayBuffer(4),e=new Uint8Array(t),i=new Uint32Array(t);return e[0]=161,e[1]=178,e[2]=195,e[3]=212,i[0]===3569595041?!0:i[0]===2712847316?!1:null}function oie(){if(typeof importScripts=="function")return ct;ct.canvas=!!window.CanvasRenderingContext2D;try{ct.localStorage=!!localStorage.getItem}catch{ct.localStorage=!1}ct.file=!!window.File&&!!window.FileReader&&!!window.FileList&&!!window.Blob,ct.fileSystem=!!window.requestFileSystem;var t=!1,e=function(){if(window.WebGLRenderingContext)try{var i=Kl.createWebGL(this),s=i.getContext("webgl")||i.getContext("experimental-webgl"),r=Kl.create2D(this),n=r.getContext("2d",{willReadFrequently:!0}),a=n.createImageData(1,1);return t=a.data instanceof Uint8ClampedArray,Kl.remove(i),Kl.remove(r),!!s}catch{return!1}return!1};return ct.webGL=e(),ct.worker=!!window.Worker,ct.pointerLock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,ct.getUserMedia=ct.getUserMedia&&!!navigator.getUserMedia&&!!window.URL,Rn.firefox&&Rn.firefoxVersion<21&&(ct.getUserMedia=!1),!nie.iOS&&(Rn.ie||Rn.firefox||Rn.chrome)&&(ct.canvasBitBltShift=!0),(Rn.safari||Rn.mobileSafari)&&(ct.canvasBitBltShift=!1),navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate,navigator.vibrate&&(ct.vibration=!0),typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint32Array<"u"&&(ct.littleEndian=aie()),ct.support32bit=typeof ArrayBuffer<"u"&&typeof Uint8ClampedArray<"u"&&typeof Int32Array<"u"&&ct.littleEndian!==null&&t,ct}UC.exports=oie()});var kC=u((cDe,FC)=>{"use strict";var NC=eh(),Dr={gamepads:!1,mspointer:!1,touch:!1,wheelEvent:null};function hie(){return typeof importScripts=="function"||(("ontouchstart"in document.documentElement||navigator.maxTouchPoints&&navigator.maxTouchPoints>=1)&&(Dr.touch=!0),(navigator.msPointerEnabled||navigator.pointerEnabled)&&(Dr.mspointer=!0),navigator.getGamepads&&(Dr.gamepads=!0),"onwheel"in window||NC.ie&&"WheelEvent"in window?Dr.wheelEvent="wheel":"onmousewheel"in window?Dr.wheelEvent="mousewheel":NC.firefox&&"MouseScrollEvent"in window&&(Dr.wheelEvent="DOMMouseScroll")),Dr}FC.exports=hie()});var qC=u((dDe,GC)=>{"use strict";var Df=eh(),ii={flac:!1,aac:!1,audioData:!1,dolby:!1,m4a:!1,mp3:!1,ogg:!1,opus:!1,wav:!1,webAudio:!1,webm:!1};function lie(){if(typeof importScripts=="function")return ii;ii.audioData=!!window.Audio,ii.webAudio=!!(window.AudioContext||window.webkitAudioContext);var t=document.createElement("audio"),e=!!t.canPlayType;try{if(e){var i=function(n,a){var o=t.canPlayType("audio/"+n).replace(/^no$/,"");return a?!!(o||t.canPlayType("audio/"+a).replace(/^no$/,"")):!!o};if(ii.ogg=i('ogg; codecs="vorbis"'),ii.opus=i('ogg; codecs="opus"',"opus"),ii.mp3=i("mpeg"),ii.wav=i("wav"),ii.m4a=i("x-m4a"),ii.aac=i("aac"),ii.flac=i("flac","x-flac"),ii.webm=i('webm; codecs="vorbis"'),t.canPlayType('audio/mp4; codecs="ec-3"')!==""){if(Df.edge)ii.dolby=!0;else if(Df.safari&&Df.safariVersion>=9&&/Mac OS X (\d+)_(\d+)/.test(navigator.userAgent)){var s=parseInt(RegExp.$1,10),r=parseInt(RegExp.$2,10);(s===10&&r>=11||s>10)&&(ii.dolby=!0)}}}}catch{}return ii}GC.exports=lie()});var re=u((fDe,WC)=>{"use strict";var uie=function(t,e,i){var s=typeof t;return!t||s==="number"||s==="string"?i:t.hasOwnProperty(e)&&t[e]!==void 0?t[e]:i};WC.exports=uie});var zC=u((pDe,HC)=>{"use strict";var YC=re(),es={h264:!1,hls:!1,mp4:!1,m4v:!1,ogg:!1,vp9:!1,webm:!1,hasRequestVideoFrame:!1};function cie(){if(typeof importScripts=="function")return es;var t=document.createElement("video"),e=!!t.canPlayType,i=/^no$/;try{e&&(t.canPlayType('video/ogg; codecs="theora"').replace(i,"")&&(es.ogg=!0),t.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(i,"")&&(es.h264=!0,es.mp4=!0),t.canPlayType("video/x-m4v").replace(i,"")&&(es.m4v=!0),t.canPlayType('video/webm; codecs="vp8, vorbis"').replace(i,"")&&(es.webm=!0),t.canPlayType('video/webm; codecs="vp9"').replace(i,"")&&(es.vp9=!0),t.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(i,"")&&(es.hls=!0))}catch{}return t.parentNode&&t.parentNode.removeChild(t),es.getVideoURL=function(s){Array.isArray(s)||(s=[s]);for(var r=0;r<s.length;r++){var n=YC(s[r],"url",s[r]);if(n.indexOf("blob:")===0)return{url:n,type:""};var a;if(n.indexOf("data:")===0?a=n.split(",")[0].match(/\/(.*?);/):a=n.match(/\.([a-zA-Z0-9]+)($|\?)/),a=YC(s[r],"type",a?a[1]:"").toLowerCase(),es[a])return{url:n,type:a}}return null},es}HC.exports=cie()});var XC=u((mDe,VC)=>{"use strict";var Br={available:!1,cancel:"",keyboard:!1,request:""};function die(){if(typeof importScripts=="function")return Br;var t,e="Fullscreen",i="FullScreen",s=["request"+e,"request"+i,"webkitRequest"+e,"webkitRequest"+i,"msRequest"+e,"msRequest"+i,"mozRequest"+i,"mozRequest"+e];for(t=0;t<s.length;t++)if(document.documentElement[s[t]]){Br.available=!0,Br.request=s[t];break}var r=["cancel"+i,"exit"+e,"webkitCancel"+i,"webkitExit"+e,"msCancel"+i,"msExit"+e,"mozCancel"+i,"mozExit"+e];if(Br.available){for(t=0;t<r.length;t++)if(document[r[t]]){Br.cancel=r[t];break}}return window.Element&&Element.ALLOW_KEYBOARD_INPUT&&!/ Version\/5\.1(?:\.\d+)? Safari\//.test(navigator.userAgent)&&(Br.keyboard=!0),Object.defineProperty(Br,"active",{get:function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}}),Br}VC.exports=die()});var th=u((vDe,KC)=>{"use strict";KC.exports={os:La(),browser:eh(),features:Zl(),input:kC(),audio:qC(),video:zC(),fullscreen:XC()}});var ih=u((gDe,jC)=>{"use strict";var fie=th();function pie(t,e){return String(t).localeCompare(e)}function mie(t,e){var i=t.length;if(i<=1)return t;for(var s=new Array(i),r=1;r<i;r*=2){ZC(t,e,r,s);var n=t;t=s,s=n}return t}function ZC(t,e,i,s){var r=t.length,n=0,a=i*2,o,h,l,c,d;for(o=0;o<r;o+=a)for(h=o+i,l=h+i,h>r&&(h=r),l>r&&(l=r),c=o,d=h;;)if(c<h&&d<l)e(t[c],t[d])<=0?s[n++]=t[c++]:s[n++]=t[d++];else if(c<h)s[n++]=t[c++];else if(d<l)s[n++]=t[d++];else break}var vie=function(t,e){if(e===void 0&&(e=pie),!t||t.length<2)return t;if(fie.features.stableSort)return t.sort(e);var i=mie(t,e);return i!==t&&ZC(i,null,t.length,t),t};jC.exports=vie});var JC=u((SDe,$C)=>{"use strict";var gie=function(t,e,i){if(e===i)return t;var s=t.indexOf(e),r=t.indexOf(i);if(s<0||r<0)throw new Error("Supplied items must be elements of the same array");return t[s]=i,t[r]=e,t};$C.exports=gie});var jl=u((EDe,QC)=>{"use strict";QC.exports={Matrix:wx(),Add:Px(),AddAt:Ix(),BringToTop:Mx(),CountAllMatching:Bx(),Each:Jo(),EachInRange:Fx(),FindClosestInSorted:Af(),Flatten:xf(),GetAll:Vl(),GetFirst:Cf(),GetRandom:wf(),MoveDown:Xx(),MoveTo:Zx(),MoveUp:$x(),MoveAbove:Qx(),MoveBelow:tC(),NumberArray:Rf(),NumberArrayStep:aC(),QuickSelect:lC(),Range:Pf(),Remove:tr(),RemoveAt:SC(),RemoveBetween:TC(),RemoveRandomElement:bC(),Replace:xC(),RotateLeft:Hl(),RotateRight:zl(),SafeRange:Or(),SendToBack:wC(),SetAll:PC(),Shuffle:Xl(),SortByDigits:_f(),SpliceOne:Ia(),StableSort:ih(),Swap:JC()}});var tw=u((TDe,ew)=>{"use strict";var $l=jl(),Sie={_depth:0,depth:{get:function(){return this._depth},set:function(t){this.displayList&&this.displayList.queueDepthSort(),this._depth=t}},setDepth:function(t){return t===void 0&&(t=0),this.depth=t,this},setToTop:function(){var t=this.getDisplayList();return t&&$l.BringToTop(t,this),this},setToBack:function(){var t=this.getDisplayList();return t&&$l.SendToBack(t,this),this},setAbove:function(t){var e=this.getDisplayList();return e&&t&&$l.MoveAbove(e,this,t),this},setBelow:function(t){var e=this.getDisplayList();return e&&t&&$l.MoveBelow(e,this,t),this}};ew.exports=Sie});var sw=u((yDe,iw)=>{"use strict";var Eie={flipX:!1,flipY:!1,toggleFlipX:function(){return this.flipX=!this.flipX,this},toggleFlipY:function(){return this.flipY=!this.flipY,this},setFlipX:function(t){return this.flipX=t,this},setFlipY:function(t){return this.flipY=t,this},setFlip:function(t,e){return this.flipX=t,this.flipY=e,this},resetFlip:function(){return this.flipX=!1,this.flipY=!1,this}};iw.exports=Eie});var Pn=u((bDe,rw)=>{"use strict";var Tie=function(t,e,i){return t.width<=0||t.height<=0?!1:t.x<=e&&t.x+t.width>=e&&t.y<=i&&t.y+t.height>=i};rw.exports=Tie});var sh=u((ADe,nw)=>{"use strict";var yie=function(t){return 2*(t.width+t.height)};nw.exports=yie});var _n=u((xDe,aw)=>{"use strict";var bie={CIRCLE:0,ELLIPSE:1,LINE:2,POINT:3,POLYGON:4,RECTANGLE:5,TRIANGLE:6};aw.exports=bie});var Ct=u((CDe,ow)=>{"use strict";var Aie=R(),xie=_n(),Cie=new Aie({initialize:function(e,i){e===void 0&&(e=0),i===void 0&&(i=e),this.type=xie.POINT,this.x=e,this.y=i},setTo:function(t,e){return t===void 0&&(t=0),e===void 0&&(e=t),this.x=t,this.y=e,this}});ow.exports=Cie});var Jl=u((wDe,hw)=>{"use strict";var wie=sh(),Rie=Ct(),Pie=function(t,e,i){if(i===void 0&&(i=new Rie),e<=0||e>=1)return i.x=t.x,i.y=t.y,i;var s=wie(t)*e;return e>.5?(s-=t.width+t.height,s<=t.width?(i.x=t.right-s,i.y=t.bottom):(i.x=t.x,i.y=t.bottom-(s-t.width))):s<=t.width?(i.x=t.x+s,i.y=t.y):(i.x=t.right,i.y=t.y+(s-t.width)),i};hw.exports=Pie});var Bf=u((RDe,lw)=>{"use strict";var _ie=Jl(),Iie=sh(),Lie=function(t,e,i,s){s===void 0&&(s=[]),!e&&i>0&&(e=Iie(t)/i);for(var r=0;r<e;r++){var n=r/e;s.push(_ie(t,n))}return s};lw.exports=Lie});var cw=u((PDe,uw)=>{"use strict";var Mie=Ct(),Oie=function(t,e,i){return i===void 0&&(i=new Mie),i.x=t.x1+(t.x2-t.x1)*e,i.y=t.y1+(t.y2-t.y1)*e,i};uw.exports=Oie});var fw=u((_De,dw)=>{"use strict";var Die=function(t){return Math.sqrt((t.x2-t.x1)*(t.x2-t.x1)+(t.y2-t.y1)*(t.y2-t.y1))};dw.exports=Die});var Uf=u((IDe,pw)=>{"use strict";var Bie=fw(),Uie=Ct(),Nie=function(t,e,i,s){s===void 0&&(s=[]),!e&&i>0&&(e=Bie(t)/i);for(var r=t.x1,n=t.y1,a=t.x2,o=t.y2,h=0;h<e;h++){var l=h/e,c=r+(a-r)*l,d=n+(o-n)*l;s.push(new Uie(c,d))}return s};pw.exports=Nie});var Nf=u((LDe,mw)=>{"use strict";var Fie=Ct(),kie=function(t,e){e===void 0&&(e=new Fie);var i=Math.random();return e.x=t.x1+i*(t.x2-t.x1),e.y=t.y1+i*(t.y2-t.y1),e};mw.exports=kie});var Ff=u((MDe,vw)=>{"use strict";var Gie=function(t,e,i){return i===void 0&&(i=1e-4),Math.abs(t-e)<i};vw.exports=Gie});var Fe=u((ODe,Sw)=>{"use strict";var qie=R(),gw=Ff(),si=new qie({initialize:function(e,i){this.x=0,this.y=0,typeof e=="object"?(this.x=e.x||0,this.y=e.y||0):(i===void 0&&(i=e),this.x=e||0,this.y=i||0)},clone:function(){return new si(this.x,this.y)},copy:function(t){return this.x=t.x||0,this.y=t.y||0,this},setFromObject:function(t){return this.x=t.x||0,this.y=t.y||0,this},set:function(t,e){return e===void 0&&(e=t),this.x=t,this.y=e,this},setTo:function(t,e){return this.set(t,e)},setToPolar:function(t,e){return e==null&&(e=1),this.x=Math.cos(t)*e,this.y=Math.sin(t)*e,this},equals:function(t){return this.x===t.x&&this.y===t.y},fuzzyEquals:function(t,e){return gw(this.x,t.x,e)&&gw(this.y,t.y,e)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},setAngle:function(t){return this.setToPolar(t,this.length())},add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},scale:function(t){return isFinite(t)?(this.x*=t,this.y*=t):(this.x=0,this.y=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},negate:function(){return this.x=-this.x,this.y=-this.y,this},distance:function(t){var e=t.x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},distanceSq:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},length:function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},setLength:function(t){return this.normalize().scale(t)},lengthSq:function(){var t=this.x,e=this.y;return t*t+e*e},normalize:function(){var t=this.x,e=this.y,i=t*t+e*e;return i>0&&(i=1/Math.sqrt(i),this.x=t*i,this.y=e*i),this},normalizeRightHand:function(){var t=this.x;return this.x=this.y*-1,this.y=t,this},normalizeLeftHand:function(){var t=this.x;return this.x=this.y,this.y=t*-1,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lerp:function(t,e){e===void 0&&(e=0);var i=this.x,s=this.y;return this.x=i+e*(t.x-i),this.y=s+e*(t.y-s),this},transformMat3:function(t){var e=this.x,i=this.y,s=t.val;return this.x=s[0]*e+s[3]*i+s[6],this.y=s[1]*e+s[4]*i+s[7],this},transformMat4:function(t){var e=this.x,i=this.y,s=t.val;return this.x=s[0]*e+s[4]*i+s[12],this.y=s[1]*e+s[5]*i+s[13],this},reset:function(){return this.x=0,this.y=0,this},limit:function(t){var e=this.length();return e&&e>t&&this.scale(t/e),this},reflect:function(t){return t=t.clone().normalize(),this.subtract(t.scale(2*this.dot(t)))},mirror:function(t){return this.reflect(t).negate()},rotate:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e*this.x-i*this.y,i*this.x+e*this.y)},project:function(t){var e=this.dot(t)/t.dot(t);return this.copy(t).scale(e)}});si.ZERO=new si;si.RIGHT=new si(1,0);si.LEFT=new si(-1,0);si.UP=new si(0,-1);si.DOWN=new si(0,1);si.ONE=new si(1,1);Sw.exports=si});var Ql=u((DDe,Tw)=>{"use strict";var Wie=R(),Yie=cw(),Hie=Uf(),zie=_n(),Vie=Nf(),Ew=Fe(),Xie=new Wie({initialize:function(e,i,s,r){e===void 0&&(e=0),i===void 0&&(i=0),s===void 0&&(s=0),r===void 0&&(r=0),this.type=zie.LINE,this.x1=e,this.y1=i,this.x2=s,this.y2=r},getPoint:function(t,e){return Yie(this,t,e)},getPoints:function(t,e,i){return Hie(this,t,e,i)},getRandomPoint:function(t){return Vie(this,t)},setTo:function(t,e,i,s){return t===void 0&&(t=0),e===void 0&&(e=0),i===void 0&&(i=0),s===void 0&&(s=0),this.x1=t,this.y1=e,this.x2=i,this.y2=s,this},setFromObjects:function(t,e){return this.x1=t.x,this.y1=t.y,this.x2=e.x,this.y2=e.y,this},getPointA:function(t){return t===void 0&&(t=new Ew),t.set(this.x1,this.y1),t},getPointB:function(t){return t===void 0&&(t=new Ew),t.set(this.x2,this.y2),t},left:{get:function(){return Math.min(this.x1,this.x2)},set:function(t){this.x1<=this.x2?this.x1=t:this.x2=t}},right:{get:function(){return Math.max(this.x1,this.x2)},set:function(t){this.x1>this.x2?this.x1=t:this.x2=t}},top:{get:function(){return Math.min(this.y1,this.y2)},set:function(t){this.y1<=this.y2?this.y1=t:this.y2=t}},bottom:{get:function(){return Math.max(this.y1,this.y2)},set:function(t){this.y1>this.y2?this.y1=t:this.y2=t}}});Tw.exports=Xie});var eu=u((BDe,yw)=>{"use strict";var Kie=Ct(),Zie=function(t,e){return e===void 0&&(e=new Kie),e.x=t.x+Math.random()*t.width,e.y=t.y+Math.random()*t.height,e};yw.exports=Zie});var Ze=u((UDe,bw)=>{"use strict";var jie=R(),$ie=Pn(),Jie=Jl(),Qie=Bf(),ese=_n(),tu=Ql(),tse=eu(),ise=new jie({initialize:function(e,i,s,r){e===void 0&&(e=0),i===void 0&&(i=0),s===void 0&&(s=0),r===void 0&&(r=0),this.type=ese.RECTANGLE,this.x=e,this.y=i,this.width=s,this.height=r},contains:function(t,e){return $ie(this,t,e)},getPoint:function(t,e){return Jie(this,t,e)},getPoints:function(t,e,i){return Qie(this,t,e,i)},getRandomPoint:function(t){return tse(this,t)},setTo:function(t,e,i,s){return this.x=t,this.y=e,this.width=i,this.height=s,this},setEmpty:function(){return this.setTo(0,0,0,0)},setPosition:function(t,e){return e===void 0&&(e=t),this.x=t,this.y=e,this},setSize:function(t,e){return e===void 0&&(e=t),this.width=t,this.height=e,this},isEmpty:function(){return this.width<=0||this.height<=0},getLineA:function(t){return t===void 0&&(t=new tu),t.setTo(this.x,this.y,this.right,this.y),t},getLineB:function(t){return t===void 0&&(t=new tu),t.setTo(this.right,this.y,this.right,this.bottom),t},getLineC:function(t){return t===void 0&&(t=new tu),t.setTo(this.right,this.bottom,this.x,this.bottom),t},getLineD:function(t){return t===void 0&&(t=new tu),t.setTo(this.x,this.bottom,this.x,this.y),t},left:{get:function(){return this.x},set:function(t){t>=this.right?this.width=0:this.width=this.right-t,this.x=t}},right:{get:function(){return this.x+this.width},set:function(t){t<=this.x?this.width=0:this.width=t-this.x}},top:{get:function(){return this.y},set:function(t){t>=this.bottom?this.height=0:this.height=this.bottom-t,this.y=t}},bottom:{get:function(){return this.y+this.height},set:function(t){t<=this.y?this.height=0:this.height=t-this.y}},centerX:{get:function(){return this.x+this.width/2},set:function(t){this.x=t-this.width/2}},centerY:{get:function(){return this.y+this.height/2},set:function(t){this.y=t-this.height/2}}});bw.exports=ise});var kf=u((NDe,Aw)=>{"use strict";var sse=function(t,e,i,s){var r=Math.cos(s),n=Math.sin(s),a=t.x-e,o=t.y-i;return t.x=a*r-o*n+e,t.y=a*n+o*r+i,t};Aw.exports=sse});var Cw=u((FDe,xw)=>{"use strict";var rse=Ze(),nse=kf(),ir=Fe(),ase={prepareBoundsOutput:function(t,e){if(e===void 0&&(e=!1),this.rotation!==0&&nse(t,this.x,this.y,this.rotation),e&&this.parentContainer){var i=this.parentContainer.getBoundsTransformMatrix();i.transformPoint(t.x,t.y,t)}return t},getCenter:function(t,e){return t===void 0&&(t=new ir),t.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(t,e)},getTopLeft:function(t,e){return t||(t=new ir),t.x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getTopCenter:function(t,e){return t||(t=new ir),t.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getTopRight:function(t,e){return t||(t=new ir),t.x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getLeftCenter:function(t,e){return t||(t=new ir),t.x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(t,e)},getRightCenter:function(t,e){return t||(t=new ir),t.x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(t,e)},getBottomLeft:function(t,e){return t||(t=new ir),t.x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBottomCenter:function(t,e){return t||(t=new ir),t.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBottomRight:function(t,e){return t||(t=new ir),t.x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBounds:function(t){t===void 0&&(t=new rse);var e,i,s,r,n,a,o,h;if(this.parentContainer){var l=this.parentContainer.getBoundsTransformMatrix();this.getTopLeft(t),l.transformPoint(t.x,t.y,t),e=t.x,i=t.y,this.getTopRight(t),l.transformPoint(t.x,t.y,t),s=t.x,r=t.y,this.getBottomLeft(t),l.transformPoint(t.x,t.y,t),n=t.x,a=t.y,this.getBottomRight(t),l.transformPoint(t.x,t.y,t),o=t.x,h=t.y}else this.getTopLeft(t),e=t.x,i=t.y,this.getTopRight(t),s=t.x,r=t.y,this.getBottomLeft(t),n=t.x,a=t.y,this.getBottomRight(t),o=t.x,h=t.y;return t.x=Math.min(e,s,n,o),t.y=Math.min(i,r,a,h),t.width=Math.max(e,s,n,o)-t.x,t.height=Math.max(i,r,a,h)-t.y,t}};xw.exports=ase});var Vt=u((kDe,ww)=>{"use strict";var Ur={},Cs={},Ni={};Ni.register=function(t,e,i,s){s===void 0&&(s=!1),Ur[t]={plugin:e,mapping:i,custom:s}};Ni.registerCustom=function(t,e,i,s){Cs[t]={plugin:e,mapping:i,data:s}};Ni.hasCore=function(t){return Ur.hasOwnProperty(t)};Ni.hasCustom=function(t){return Cs.hasOwnProperty(t)};Ni.getCore=function(t){return Ur[t]};Ni.getCustom=function(t){return Cs[t]};Ni.getCustomClass=function(t){return Cs.hasOwnProperty(t)?Cs[t].plugin:null};Ni.remove=function(t){Ur.hasOwnProperty(t)&&delete Ur[t]};Ni.removeCustom=function(t){Cs.hasOwnProperty(t)&&delete Cs[t]};Ni.destroyCorePlugins=function(){for(var t in Ur)Ur.hasOwnProperty(t)&&delete Ur[t]};Ni.destroyCustomPlugins=function(){for(var t in Cs)Cs.hasOwnProperty(t)&&delete Cs[t]};ww.exports=Ni});var Pw=u((GDe,Rw)=>{"use strict";Rw.exports="addedtoscene"});var Iw=u((qDe,_w)=>{"use strict";_w.exports="boot"});var Mw=u((WDe,Lw)=>{"use strict";Lw.exports="create"});var Dw=u((YDe,Ow)=>{"use strict";Ow.exports="destroy"});var Uw=u((HDe,Bw)=>{"use strict";Bw.exports="pause"});var Fw=u((zDe,Nw)=>{"use strict";Nw.exports="postupdate"});var Gw=u((VDe,kw)=>{"use strict";kw.exports="prerender"});var Ww=u((XDe,qw)=>{"use strict";qw.exports="preupdate"});var Hw=u((KDe,Yw)=>{"use strict";Yw.exports="ready"});var Vw=u((ZDe,zw)=>{"use strict";zw.exports="removedfromscene"});var Kw=u((jDe,Xw)=>{"use strict";Xw.exports="render"});var jw=u(($De,Zw)=>{"use strict";Zw.exports="resume"});var Jw=u((JDe,$w)=>{"use strict";$w.exports="shutdown"});var eR=u((QDe,Qw)=>{"use strict";Qw.exports="sleep"});var iR=u((eBe,tR)=>{"use strict";tR.exports="start"});var rR=u((tBe,sR)=>{"use strict";sR.exports="transitioncomplete"});var aR=u((iBe,nR)=>{"use strict";nR.exports="transitioninit"});var hR=u((sBe,oR)=>{"use strict";oR.exports="transitionout"});var uR=u((rBe,lR)=>{"use strict";lR.exports="transitionstart"});var dR=u((nBe,cR)=>{"use strict";cR.exports="transitionwake"});var pR=u((aBe,fR)=>{"use strict";fR.exports="update"});var vR=u((oBe,mR)=>{"use strict";mR.exports="wake"});var qe=u((hBe,gR)=>{"use strict";gR.exports={ADDED_TO_SCENE:Pw(),BOOT:Iw(),CREATE:Mw(),DESTROY:Dw(),PAUSE:Uw(),POST_UPDATE:Fw(),PRE_RENDER:Gw(),PRE_UPDATE:Ww(),READY:Hw(),REMOVED_FROM_SCENE:Vw(),RENDER:Kw(),RESUME:jw(),SHUTDOWN:Jw(),SLEEP:eR(),START:iR(),TRANSITION_COMPLETE:rR(),TRANSITION_INIT:aR(),TRANSITION_OUT:hR(),TRANSITION_START:uR(),TRANSITION_WAKE:dR(),UPDATE:pR(),WAKE:vR()}});var dt=u((lBe,SR)=>{"use strict";var ose=R(),hse=Vt(),Ma=qe(),Nr=new ose({initialize:function(e){this.scene=e,this.systems=e.sys,this.events=e.sys.events,this.displayList,this.updateList,this.events.once(Ma.BOOT,this.boot,this),this.events.on(Ma.START,this.start,this)},boot:function(){this.displayList=this.systems.displayList,this.updateList=this.systems.updateList,this.events.once(Ma.DESTROY,this.destroy,this)},start:function(){this.events.once(Ma.SHUTDOWN,this.shutdown,this)},existing:function(t){return(t.renderCanvas||t.renderWebGL)&&this.displayList.add(t),t.preUpdate&&this.updateList.add(t),t},shutdown:function(){this.events.off(Ma.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(Ma.START,this.start,this),this.scene=null,this.systems=null,this.events=null,this.displayList=null,this.updateList=null}});Nr.register=function(t,e){Nr.prototype.hasOwnProperty(t)||(Nr.prototype[t]=e)};Nr.remove=function(t){Nr.prototype.hasOwnProperty(t)&&delete Nr.prototype[t]};hse.register("GameObjectFactory",Nr,"add");SR.exports=Nr});var Gf=u((uBe,TR)=>{"use strict";var lse=R(),use=dt(),ER=new lse({initialize:function(e,i,s,r,n,a){i||(i=e.sys.make.image({x:s,y:r,key:n,frame:a,add:!1})),this.bitmapMask=i,this.invertAlpha=!1,this.isStencil=!1},setBitmap:function(t){this.bitmapMask=t},preRenderWebGL:function(t,e,i){t.pipelines.BITMAPMASK_PIPELINE.beginMask(this,e,i)},postRenderWebGL:function(t,e,i){t.pipelines.BITMAPMASK_PIPELINE.endMask(this,e,i)},preRenderCanvas:function(){},postRenderCanvas:function(){},destroy:function(){this.bitmapMask=null}});use.register("bitmapMask",function(t,e,i,s,r){return new ER(this.scene,t,e,i,s,r)});TR.exports=ER});var qf=u((cBe,yR)=>{"use strict";var cse=R(),dse=new cse({initialize:function(e,i){this.geometryMask=i,this.invertAlpha=!1,this.isStencil=!0,this.level=0},setShape:function(t){return this.geometryMask=t,this},setInvertAlpha:function(t){return t===void 0&&(t=!0),this.invertAlpha=t,this},preRenderWebGL:function(t,e,i){var s=t.gl;t.flush(),t.maskStack.length===0&&(s.enable(s.STENCIL_TEST),s.clear(s.STENCIL_BUFFER_BIT),t.maskCount=0),t.currentCameraMask.mask!==this&&(t.currentMask.mask=this),t.maskStack.push({mask:this,camera:i}),this.applyStencil(t,i,!0),t.maskCount++},applyStencil:function(t,e,i){var s=t.gl,r=this.geometryMask,n=t.maskCount,a=255;s.colorMask(!1,!1,!1,!1),i?(s.stencilFunc(s.EQUAL,n,a),s.stencilOp(s.KEEP,s.KEEP,s.INCR),n++):(s.stencilFunc(s.EQUAL,n+1,a),s.stencilOp(s.KEEP,s.KEEP,s.DECR)),this.level=n,r.renderWebGL(t,r,e),t.flush(),s.colorMask(!0,!0,!0,!0),s.stencilOp(s.KEEP,s.KEEP,s.KEEP),this.invertAlpha?s.stencilFunc(s.NOTEQUAL,n,a):s.stencilFunc(s.EQUAL,n,a)},postRenderWebGL:function(t){var e=t.gl;t.maskStack.pop(),t.maskCount--,t.flush();var i=t.currentMask;if(t.maskStack.length===0)i.mask=null,e.disable(e.STENCIL_TEST);else{var s=t.maskStack[t.maskStack.length-1];s.mask.applyStencil(t,s.camera,!1),t.currentCameraMask.mask!==s.mask?(i.mask=s.mask,i.camera=s.camera):i.mask=null}},preRenderCanvas:function(t,e,i){var s=this.geometryMask;t.currentContext.save(),s.renderCanvas(t,s,i,null,null,!0),t.currentContext.clip()},postRenderCanvas:function(t){t.currentContext.restore()},destroy:function(){this.geometryMask=null}});yR.exports=dse});var AR=u((dBe,bR)=>{"use strict";var fse=Gf(),pse=qf(),mse={mask:null,setMask:function(t){return this.mask=t,this},clearMask:function(t){return t===void 0&&(t=!1),t&&this.mask&&this.mask.destroy(),this.mask=null,this},createBitmapMask:function(t,e,i,s,r){return t===void 0&&(this.texture||this.shader||this.geom)&&(t=this),new fse(this.scene,t,e,i,s,r)},createGeometryMask:function(t){return t===void 0&&(this.type==="Graphics"||this.geom)&&(t=this),new pse(this.scene,t)}};bR.exports=mse});var CR=u((fBe,xR)=>{"use strict";var vse={_originComponent:!0,originX:.5,originY:.5,_displayOriginX:0,_displayOriginY:0,displayOriginX:{get:function(){return this._displayOriginX},set:function(t){this._displayOriginX=t,this.originX=t/this.width}},displayOriginY:{get:function(){return this._displayOriginY},set:function(t){this._displayOriginY=t,this.originY=t/this.height}},setOrigin:function(t,e){return t===void 0&&(t=.5),e===void 0&&(e=t),this.originX=t,this.originY=e,this.updateDisplayOrigin()},setOriginFromFrame:function(){return!this.frame||!this.frame.customPivot?this.setOrigin():(this.originX=this.frame.pivotX,this.originY=this.frame.pivotY,this.updateDisplayOrigin())},setDisplayOrigin:function(t,e){return t===void 0&&(t=0),e===void 0&&(e=t),this.displayOriginX=t,this.displayOriginY=e,this},updateDisplayOrigin:function(){return this._displayOriginX=this.originX*this.width,this._displayOriginY=this.originY*this.height,this}};xR.exports=vse});var iu=u((pBe,RR)=>{"use strict";var wR=function(t){var e,i,s;if(typeof t!="object"||t===null)return t;e=Array.isArray(t)?[]:{};for(s in t)i=t[s],e[s]=wR(i);return e};RR.exports=wR});var _R=u((mBe,PR)=>{"use strict";var gse=iu(),Sse={defaultPipeline:null,pipeline:null,pipelineData:null,initPipeline:function(t){this.pipelineData={};var e=this.scene.sys.renderer;if(!e)return!1;var i=e.pipelines;if(i){t===void 0&&(t=i.default);var s=i.get(t);if(s)return this.defaultPipeline=s,this.pipeline=s,!0}return!1},setPipeline:function(t,e,i){var s=this.scene.sys.renderer;if(!s)return this;var r=s.pipelines;if(r){var n=r.get(t);n&&(this.pipeline=n),e&&(this.pipelineData=i?gse(e):e)}return this},setPipelineData:function(t,e){var i=this.pipelineData;return e===void 0?delete i[t]:i[t]=e,this},resetPipeline:function(t){return t===void 0&&(t=!1),this.pipeline=this.defaultPipeline,t&&(this.pipelineData={}),this.pipeline!==null},getPipelineName:function(){return this.pipeline===null?null:this.pipeline.name}};PR.exports=Sse});var LR=u((vBe,IR)=>{"use strict";var Ese=iu(),Tse=Ia(),yse={hasPostPipeline:!1,postPipelines:null,postPipelineData:null,preFX:null,postFX:null,initPostPipeline:function(t){this.postPipelines=[],this.postPipelineData={}},setPostPipeline:function(t,e,i){var s=this.scene.sys.renderer;if(!s)return this;var r=s.pipelines;if(r){Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var a=r.getPostPipeline(t[n],this,e);a&&this.postPipelines.push(a)}e&&(this.postPipelineData=i?Ese(e):e)}return this.hasPostPipeline=this.postPipelines.length>0,this},setPostPipelineData:function(t,e){var i=this.postPipelineData;return e===void 0?delete i[t]:i[t]=e,this},getPostPipeline:function(t){for(var e=typeof t=="string",i=this.postPipelines,s=[],r=0;r<i.length;r++){var n=i[r];(e&&n.name===t||!e&&n instanceof t)&&s.push(n)}return s.length===1?s[0]:s},resetPostPipeline:function(t){t===void 0&&(t=!1);for(var e=this.postPipelines,i=0;i<e.length;i++)e[i].destroy();this.postPipelines=[],this.hasPostPipeline=!1,t&&(this.postPipelineData={})},removePostPipeline:function(t){for(var e=typeof t=="string",i=this.postPipelines,s=i.length-1;s>=0;s--){var r=i[s];(e&&r.name===t||!e&&r===t)&&(r.destroy(),Tse(i,s))}return this.hasPostPipeline=this.postPipelines.length>0,this},clearFX:function(){return this.preFX&&this.preFX.clear(),this.postFX&&this.postFX.clear(),this}};IR.exports=yse});var OR=u((gBe,MR)=>{"use strict";var bse={scrollFactorX:1,scrollFactorY:1,setScrollFactor:function(t,e){return e===void 0&&(e=t),this.scrollFactorX=t,this.scrollFactorY=e,this}};MR.exports=bse});var BR=u((SBe,DR)=>{"use strict";var Ase={_sizeComponent:!0,width:0,height:0,displayWidth:{get:function(){return Math.abs(this.scaleX*this.frame.realWidth)},set:function(t){this.scaleX=t/this.frame.realWidth}},displayHeight:{get:function(){return Math.abs(this.scaleY*this.frame.realHeight)},set:function(t){this.scaleY=t/this.frame.realHeight}},setSizeToFrame:function(t){t||(t=this.frame),this.width=t.realWidth,this.height=t.realHeight;var e=this.input;return e&&!e.customHitArea&&(e.hitArea.width=this.width,e.hitArea.height=this.height),this},setSize:function(t,e){return this.width=t,this.height=e,this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this}};DR.exports=Ase});var Xt=u((EBe,UR)=>{"use strict";var xse=function(t){if(!t||typeof t!="object"||t.nodeType||t===t.window)return!1;try{if(t.constructor&&!{}.hasOwnProperty.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch{return!1}return!0};UR.exports=xse});var mi=u((TBe,kR)=>{"use strict";var NR=Xt(),FR=function(){var t,e,i,s,r,n,a=arguments[0]||{},o=1,h=arguments.length,l=!1;for(typeof a=="boolean"&&(l=a,a=arguments[1]||{},o=2),h===o&&(a=this,--o);o<h;o++)if((t=arguments[o])!=null)for(e in t)i=a[e],s=t[e],a!==s&&(l&&s&&(NR(s)||(r=Array.isArray(s)))?(r?(r=!1,n=i&&Array.isArray(i)?i:[]):n=i&&NR(i)?i:{},a[e]=FR(l,n,s)):s!==void 0&&(a[e]=s));return a};kR.exports=FR});var Da=u((yBe,qR)=>{"use strict";var Cse=R(),Oa=Je(),wse=mi(),GR=new Cse({initialize:function(e,i,s,r,n,a,o){this.texture=e,this.name=i,this.source=e.source[s],this.sourceIndex=s,this.cutX,this.cutY,this.cutWidth,this.cutHeight,this.x=0,this.y=0,this.width,this.height,this.halfWidth,this.halfHeight,this.centerX,this.centerY,this.pivotX=0,this.pivotY=0,this.customPivot=!1,this.rotated=!1,this.autoRound=-1,this.customData={},this.u0=0,this.v0=0,this.u1=0,this.v1=0,this.data={cut:{x:0,y:0,w:0,h:0,r:0,b:0},trim:!1,sourceSize:{w:0,h:0},spriteSourceSize:{x:0,y:0,w:0,h:0,r:0,b:0},radius:0,drawImage:{x:0,y:0,width:0,height:0},is3Slice:!1,scale9:!1,scale9Borders:{x:0,y:0,w:0,h:0}},this.setSize(a,o,r,n)},setCutPosition:function(t,e){return t===void 0&&(t=0),e===void 0&&(e=0),this.cutX=t,this.cutY=e,this.updateUVs()},setCutSize:function(t,e){return this.cutWidth=t,this.cutHeight=e,this.updateUVs()},setSize:function(t,e,i,s){i===void 0&&(i=0),s===void 0&&(s=0),this.setCutPosition(i,s),this.setCutSize(t,e),this.width=t,this.height=e,this.halfWidth=Math.floor(t*.5),this.halfHeight=Math.floor(e*.5),this.centerX=Math.floor(t/2),this.centerY=Math.floor(e/2);var r=this.data,n=r.cut;n.x=i,n.y=s,n.w=t,n.h=e,n.r=i+t,n.b=s+e,r.sourceSize.w=t,r.sourceSize.h=e,r.spriteSourceSize.w=t,r.spriteSourceSize.h=e,r.radius=.5*Math.sqrt(t*t+e*e);var a=r.drawImage;return a.x=i,a.y=s,a.width=t,a.height=e,this.updateUVs()},setTrim:function(t,e,i,s,r,n){var a=this.data,o=a.spriteSourceSize;return a.trim=!0,a.sourceSize.w=t,a.sourceSize.h=e,o.x=i,o.y=s,o.w=r,o.h=n,o.r=i+r,o.b=s+n,this.x=i,this.y=s,this.width=r,this.height=n,this.halfWidth=r*.5,this.halfHeight=n*.5,this.centerX=Math.floor(r/2),this.centerY=Math.floor(n/2),this.updateUVs()},setScale9:function(t,e,i,s){var r=this.data;return r.scale9=!0,r.is3Slice=e===0&&s===this.height,r.scale9Borders.x=t,r.scale9Borders.y=e,r.scale9Borders.w=i,r.scale9Borders.h=s,this},setCropUVs:function(t,e,i,s,r,n,a){var o=this.cutX,h=this.cutY,l=this.cutWidth,c=this.cutHeight,d=this.realWidth,f=this.realHeight;e=Oa(e,0,d),i=Oa(i,0,f),s=Oa(s,0,d-e),r=Oa(r,0,f-i);var p=o+e,m=h+i,v=s,g=r,S=this.data;if(S.trim){var y=S.spriteSourceSize;s=Oa(s,0,y.x+l-e),r=Oa(r,0,y.y+c-i);var b=e+s,x=i+r,A=!(y.r<e||y.b<i||y.x>b||y.y>x);if(A){var w=Math.max(y.x,e),C=Math.max(y.y,i),_=Math.min(y.r,b)-w,N=Math.min(y.b,x)-C;v=_,g=N,n?p=o+(l-(w-y.x)-_):p=o+(w-y.x),a?m=h+(c-(C-y.y)-N):m=h+(C-y.y),e=w,i=C,s=_,r=N}else p=0,m=0,v=0,g=0}else n&&(p=o+(l-e-s)),a&&(m=h+(c-i-r));var D=this.source.width,Y=this.source.height;return t.u0=Math.max(0,p/D),t.v0=Math.max(0,m/Y),t.u1=Math.min(1,(p+v)/D),t.v1=Math.min(1,(m+g)/Y),t.x=e,t.y=i,t.cx=p,t.cy=m,t.cw=v,t.ch=g,t.width=s,t.height=r,t.flipX=n,t.flipY=a,t},updateCropUVs:function(t,e,i){return this.setCropUVs(t,t.x,t.y,t.width,t.height,e,i)},setUVs:function(t,e,i,s,r,n){var a=this.data.drawImage;return a.width=t,a.height=e,this.u0=i,this.v0=s,this.u1=r,this.v1=n,this},updateUVs:function(){var t=this.cutX,e=this.cutY,i=this.cutWidth,s=this.cutHeight,r=this.data.drawImage;r.width=i,r.height=s;var n=this.source.width,a=this.source.height;return this.u0=t/n,this.v0=e/a,this.u1=(t+i)/n,this.v1=(e+s)/a,this},updateUVsInverted:function(){var t=this.source.width,e=this.source.height;return this.u0=(this.cutX+this.cutHeight)/t,this.v0=this.cutY/e,this.u1=this.cutX/t,this.v1=(this.cutY+this.cutWidth)/e,this},clone:function(){var t=new GR(this.texture,this.name,this.sourceIndex);return t.cutX=this.cutX,t.cutY=this.cutY,t.cutWidth=this.cutWidth,t.cutHeight=this.cutHeight,t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t.halfWidth=this.halfWidth,t.halfHeight=this.halfHeight,t.centerX=this.centerX,t.centerY=this.centerY,t.rotated=this.rotated,t.data=wse(!0,t.data,this.data),t.updateUVs(),t},destroy:function(){this.texture=null,this.source=null,this.customData=null,this.data=null},glTexture:{get:function(){return this.source.glTexture}},realWidth:{get:function(){return this.data.sourceSize.w}},realHeight:{get:function(){return this.data.sourceSize.h}},radius:{get:function(){return this.data.radius}},trimmed:{get:function(){return this.data.trim}},scale9:{get:function(){return this.data.scale9}},is3Slice:{get:function(){return this.data.is3Slice}},canvasData:{get:function(){return this.data.drawImage}}});qR.exports=GR});var HR=u((bBe,YR)=>{"use strict";var Rse=Da(),WR=8,Pse={texture:null,frame:null,isCropped:!1,setTexture:function(t,e,i,s){return this.texture=this.scene.sys.textures.get(t),this.setFrame(e,i,s)},setFrame:function(t,e,i){return e===void 0&&(e=!0),i===void 0&&(i=!0),t instanceof Rse?(this.texture=this.scene.sys.textures.get(t.texture.key),this.frame=t):this.frame=this.texture.get(t),!this.frame.cutWidth||!this.frame.cutHeight?this.renderFlags&=~WR:this.renderFlags|=WR,this._sizeComponent&&e&&this.setSizeToFrame(),this._originComponent&&i&&(this.frame.customPivot?this.setOrigin(this.frame.pivotX,this.frame.pivotY):this.updateDisplayOrigin()),this}};YR.exports=Pse});var XR=u((ABe,VR)=>{"use strict";var _se=Da(),zR=8,Ise={texture:null,frame:null,isCropped:!1,setCrop:function(t,e,i,s){if(t===void 0)this.isCropped=!1;else if(this.frame){if(typeof t=="number")this.frame.setCropUVs(this._crop,t,e,i,s,this.flipX,this.flipY);else{var r=t;this.frame.setCropUVs(this._crop,r.x,r.y,r.width,r.height,this.flipX,this.flipY)}this.isCropped=!0}return this},setTexture:function(t,e){return this.texture=this.scene.sys.textures.get(t),this.setFrame(e)},setFrame:function(t,e,i){return e===void 0&&(e=!0),i===void 0&&(i=!0),t instanceof _se?(this.texture=this.scene.sys.textures.get(t.texture.key),this.frame=t):this.frame=this.texture.get(t),!this.frame.cutWidth||!this.frame.cutHeight?this.renderFlags&=~zR:this.renderFlags|=zR,this._sizeComponent&&e&&this.setSizeToFrame(),this._originComponent&&i&&(this.frame.customPivot?this.setOrigin(this.frame.pivotX,this.frame.pivotY):this.updateDisplayOrigin()),this.isCropped&&this.frame.updateCropUVs(this._crop,this.flipX,this.flipY),this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:!1,flipY:!1,cx:0,cy:0,cw:0,ch:0}}};VR.exports=Ise});var ZR=u((xBe,KR)=>{"use strict";var Lse={tintTopLeft:16777215,tintTopRight:16777215,tintBottomLeft:16777215,tintBottomRight:16777215,tintFill:!1,clearTint:function(){return this.setTint(16777215),this},setTint:function(t,e,i,s){return t===void 0&&(t=16777215),e===void 0&&(e=t,i=t,s=t),this.tintTopLeft=t,this.tintTopRight=e,this.tintBottomLeft=i,this.tintBottomRight=s,this.tintFill=!1,this},setTintFill:function(t,e,i,s){return this.setTint(t,e,i,s),this.tintFill=!0,this},tint:{get:function(){return this.tintTopLeft},set:function(t){this.setTint(t,t,t,t)}},isTinted:{get:function(){var t=16777215;return this.tintFill||this.tintTopLeft!==t||this.tintTopRight!==t||this.tintBottomLeft!==t||this.tintBottomRight!==t}}};KR.exports=Lse});var su=u((CBe,jR)=>{"use strict";var Mse=function(t){var e={name:t.name,type:t.type,x:t.x,y:t.y,depth:t.depth,scale:{x:t.scaleX,y:t.scaleY},origin:{x:t.originX,y:t.originY},flipX:t.flipX,flipY:t.flipY,rotation:t.rotation,alpha:t.alpha,visible:t.visible,blendMode:t.blendMode,textureKey:"",frameKey:"",data:{}};return t.texture&&(e.textureKey=t.texture.key,e.frameKey=t.frame.name),e};jR.exports=Mse});var Kt=u((wBe,$R)=>{"use strict";var Ose={PI2:Math.PI*2,TAU:Math.PI*.5,EPSILON:1e-6,DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,RND:null,MIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER||-9007199254740991,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991};$R.exports=Ose});var ws=u((RBe,JR)=>{"use strict";var Dse=R(),Bse=Kt(),Use=Fe(),Nse=new Dse({initialize:function(e,i,s,r,n,a){e===void 0&&(e=1),i===void 0&&(i=0),s===void 0&&(s=0),r===void 0&&(r=1),n===void 0&&(n=0),a===void 0&&(a=0),this.matrix=new Float32Array([e,i,s,r,n,a,0,0,1]),this.decomposedMatrix={translateX:0,translateY:0,scaleX:1,scaleY:1,rotation:0},this.quad=new Float32Array(8)},a:{get:function(){return this.matrix[0]},set:function(t){this.matrix[0]=t}},b:{get:function(){return this.matrix[1]},set:function(t){this.matrix[1]=t}},c:{get:function(){return this.matrix[2]},set:function(t){this.matrix[2]=t}},d:{get:function(){return this.matrix[3]},set:function(t){this.matrix[3]=t}},e:{get:function(){return this.matrix[4]},set:function(t){this.matrix[4]=t}},f:{get:function(){return this.matrix[5]},set:function(t){this.matrix[5]=t}},tx:{get:function(){return this.matrix[4]},set:function(t){this.matrix[4]=t}},ty:{get:function(){return this.matrix[5]},set:function(t){this.matrix[5]=t}},rotation:{get:function(){return Math.acos(this.a/this.scaleX)*(Math.atan(-this.c/this.a)<0?-1:1)}},rotationNormalized:{get:function(){var t=this.matrix,e=t[0],i=t[1],s=t[2],r=t[3];return e||i?i>0?Math.acos(e/this.scaleX):-Math.acos(e/this.scaleX):s||r?Bse.TAU-(r>0?Math.acos(-s/this.scaleY):-Math.acos(s/this.scaleY)):0}},scaleX:{get:function(){return Math.sqrt(this.a*this.a+this.b*this.b)}},scaleY:{get:function(){return Math.sqrt(this.c*this.c+this.d*this.d)}},loadIdentity:function(){var t=this.matrix;return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,this},translate:function(t,e){var i=this.matrix;return i[4]=i[0]*t+i[2]*e+i[4],i[5]=i[1]*t+i[3]*e+i[5],this},scale:function(t,e){var i=this.matrix;return i[0]*=t,i[1]*=t,i[2]*=e,i[3]*=e,this},rotate:function(t){var e=Math.sin(t),i=Math.cos(t),s=this.matrix,r=s[0],n=s[1],a=s[2],o=s[3];return s[0]=r*i+a*e,s[1]=n*i+o*e,s[2]=r*-e+a*i,s[3]=n*-e+o*i,this},multiply:function(t,e){var i=this.matrix,s=t.matrix,r=i[0],n=i[1],a=i[2],o=i[3],h=i[4],l=i[5],c=s[0],d=s[1],f=s[2],p=s[3],m=s[4],v=s[5],g=e===void 0?i:e.matrix;return g[0]=c*r+d*a,g[1]=c*n+d*o,g[2]=f*r+p*a,g[3]=f*n+p*o,g[4]=m*r+v*a+h,g[5]=m*n+v*o+l,g},multiplyWithOffset:function(t,e,i){var s=this.matrix,r=t.matrix,n=s[0],a=s[1],o=s[2],h=s[3],l=s[4],c=s[5],d=e*n+i*o+l,f=e*a+i*h+c,p=r[0],m=r[1],v=r[2],g=r[3],S=r[4],y=r[5];return s[0]=p*n+m*o,s[1]=p*a+m*h,s[2]=v*n+g*o,s[3]=v*a+g*h,s[4]=S*n+y*o+d,s[5]=S*a+y*h+f,this},transform:function(t,e,i,s,r,n){var a=this.matrix,o=a[0],h=a[1],l=a[2],c=a[3],d=a[4],f=a[5];return a[0]=t*o+e*l,a[1]=t*h+e*c,a[2]=i*o+s*l,a[3]=i*h+s*c,a[4]=r*o+n*l+d,a[5]=r*h+n*c+f,this},transformPoint:function(t,e,i){i===void 0&&(i={x:0,y:0});var s=this.matrix,r=s[0],n=s[1],a=s[2],o=s[3],h=s[4],l=s[5];return i.x=t*r+e*a+h,i.y=t*n+e*o+l,i},invert:function(){var t=this.matrix,e=t[0],i=t[1],s=t[2],r=t[3],n=t[4],a=t[5],o=e*r-i*s;return t[0]=r/o,t[1]=-i/o,t[2]=-s/o,t[3]=e/o,t[4]=(s*a-r*n)/o,t[5]=-(e*a-i*n)/o,this},copyFrom:function(t){var e=this.matrix;return e[0]=t.a,e[1]=t.b,e[2]=t.c,e[3]=t.d,e[4]=t.e,e[5]=t.f,this},copyFromArray:function(t){var e=this.matrix;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],this},copyToContext:function(t){var e=this.matrix;return t.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t},setToContext:function(t){return t.setTransform(this.a,this.b,this.c,this.d,this.e,this.f),t},copyToArray:function(t){var e=this.matrix;return t===void 0?t=[e[0],e[1],e[2],e[3],e[4],e[5]]:(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5]),t},setTransform:function(t,e,i,s,r,n){var a=this.matrix;return a[0]=t,a[1]=e,a[2]=i,a[3]=s,a[4]=r,a[5]=n,this},decomposeMatrix:function(){var t=this.decomposedMatrix,e=this.matrix,i=e[0],s=e[1],r=e[2],n=e[3],a=i*n-s*r;if(t.translateX=e[4],t.translateY=e[5],i||s){var o=Math.sqrt(i*i+s*s);t.rotation=s>0?Math.acos(i/o):-Math.acos(i/o),t.scaleX=o,t.scaleY=a/o}else if(r||n){var h=Math.sqrt(r*r+n*n);t.rotation=Math.PI*.5-(n>0?Math.acos(-r/h):-Math.acos(r/h)),t.scaleX=a/h,t.scaleY=h}else t.rotation=0,t.scaleX=0,t.scaleY=0;return t},applyITRS:function(t,e,i,s,r){var n=this.matrix,a=Math.sin(i),o=Math.cos(i);return n[4]=t,n[5]=e,n[0]=o*s,n[1]=a*s,n[2]=-a*r,n[3]=o*r,this},applyInverse:function(t,e,i){i===void 0&&(i=new Use);var s=this.matrix,r=s[0],n=s[1],a=s[2],o=s[3],h=s[4],l=s[5],c=1/(r*o+a*-n);return i.x=o*c*t+-a*c*e+(l*a-h*o)*c,i.y=r*c*e+-n*c*t+(-l*r+h*n)*c,i},setQuad:function(t,e,i,s,r,n){r===void 0&&(r=!1),n===void 0&&(n=this.quad);var a=this.matrix,o=a[0],h=a[1],l=a[2],c=a[3],d=a[4],f=a[5],p=t*o+e*l+d,m=t*h+e*c+f,v=t*o+s*l+d,g=t*h+s*c+f,S=i*o+s*l+d,y=i*h+s*c+f,b=i*o+e*l+d,x=i*h+e*c+f;if(r){var A=Math.floor(p+.5),w=Math.floor(m+.5),C=A-p,_=w-m;n[0]=A,n[1]=w,n[2]=v+C,n[3]=g+_,n[4]=S+C,n[5]=y+_,n[6]=b+C,n[7]=x+_}else n[0]=p,n[1]=m,n[2]=v,n[3]=g,n[4]=S,n[5]=y,n[6]=b,n[7]=x;return n},getX:function(t,e){return t*this.a+e*this.c+this.e},getY:function(t,e){return t*this.b+e*this.d+this.f},getXRound:function(t,e,i){var s=this.getX(t,e);return i&&(s=Math.floor(s+.5)),s},getYRound:function(t,e,i){var s=this.getY(t,e);return i&&(s=Math.floor(s+.5)),s},getCSSMatrix:function(){var t=this.matrix;return"matrix("+t[0]+","+t[1]+","+t[2]+","+t[3]+","+t[4]+","+t[5]+")"},destroy:function(){this.matrix=null,this.quad=null,this.decomposedMatrix=null}});JR.exports=Nse});var Wf=u((PBe,QR)=>{"use strict";var Fse=Fe(),kse=function(t,e,i,s,r,n,a,o){o===void 0&&(o=new Fse);var h=Math.sin(r),l=Math.cos(r),c=l*n,d=h*n,f=-h*a,p=l*a,m=1/(c*p+f*-d);return o.x=p*m*t+-f*m*e+(s*f-i*p)*m,o.y=c*m*e+-d*m*t+(-s*c+i*d)*m,o};QR.exports=kse});var Ba=u((_Be,eP)=>{"use strict";var Gse=function(t,e,i){var s=i-e;return e+((t-e)%s+s)%s};eP.exports=Gse});var Yf=u((IBe,tP)=>{"use strict";var qse=Ba(),Wse=function(t){return qse(t,-Math.PI,Math.PI)};tP.exports=Wse});var Hf=u((LBe,iP)=>{"use strict";var Yse=Ba(),Hse=function(t){return Yse(t,-180,180)};iP.exports=Hse});var oP=u((MBe,aP)=>{"use strict";var sP=Kt(),zf=ws(),zse=Wf(),Vse=Yf(),rP=Hf(),nP=Fe(),Ua=4,Xse={hasTransformComponent:!0,_scaleX:1,_scaleY:1,_rotation:0,x:0,y:0,z:0,w:0,scale:{get:function(){return(this._scaleX+this._scaleY)/2},set:function(t){this._scaleX=t,this._scaleY=t,t===0?this.renderFlags&=~Ua:this.renderFlags|=Ua}},scaleX:{get:function(){return this._scaleX},set:function(t){this._scaleX=t,t===0?this.renderFlags&=~Ua:this._scaleY!==0&&(this.renderFlags|=Ua)}},scaleY:{get:function(){return this._scaleY},set:function(t){this._scaleY=t,t===0?this.renderFlags&=~Ua:this._scaleX!==0&&(this.renderFlags|=Ua)}},angle:{get:function(){return rP(this._rotation*sP.RAD_TO_DEG)},set:function(t){this.rotation=rP(t)*sP.DEG_TO_RAD}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation=Vse(t)}},setPosition:function(t,e,i,s){return t===void 0&&(t=0),e===void 0&&(e=t),i===void 0&&(i=0),s===void 0&&(s=0),this.x=t,this.y=e,this.z=i,this.w=s,this},copyPosition:function(t){return t.x!==void 0&&(this.x=t.x),t.y!==void 0&&(this.y=t.y),t.z!==void 0&&(this.z=t.z),t.w!==void 0&&(this.w=t.w),this},setRandomPosition:function(t,e,i,s){return t===void 0&&(t=0),e===void 0&&(e=0),i===void 0&&(i=this.scene.sys.scale.width),s===void 0&&(s=this.scene.sys.scale.height),this.x=t+Math.random()*i,this.y=e+Math.random()*s,this},setRotation:function(t){return t===void 0&&(t=0),this.rotation=t,this},setAngle:function(t){return t===void 0&&(t=0),this.angle=t,this},setScale:function(t,e){return t===void 0&&(t=1),e===void 0&&(e=t),this.scaleX=t,this.scaleY=e,this},setX:function(t){return t===void 0&&(t=0),this.x=t,this},setY:function(t){return t===void 0&&(t=0),this.y=t,this},setZ:function(t){return t===void 0&&(t=0),this.z=t,this},setW:function(t){return t===void 0&&(t=0),this.w=t,this},getLocalTransformMatrix:function(t){return t===void 0&&(t=new zf),t.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY)},getWorldTransformMatrix:function(t,e){t===void 0&&(t=new zf);var i=this.parentContainer;if(!i)return this.getLocalTransformMatrix(t);var s=!1;for(e||(e=new zf,s=!0),t.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY);i;)e.applyITRS(i.x,i.y,i._rotation,i._scaleX,i._scaleY),e.multiply(t,t),i=i.parentContainer;return s&&e.destroy(),t},getLocalPoint:function(t,e,i,s){i||(i=new nP),s||(s=this.scene.sys.cameras.main);var r=s.scrollX,n=s.scrollY,a=t+r*this.scrollFactorX-r,o=e+n*this.scrollFactorY-n;return this.parentContainer?this.getWorldTransformMatrix().applyInverse(a,o,i):zse(a,o,this.x,this.y,this.rotation,this.scaleX,this.scaleY,i),this._originComponent&&(i.x+=this._displayOriginX,i.y+=this._displayOriginY),i},getWorldPoint:function(t,e,i){t===void 0&&(t=new nP);var s=this.parentContainer;if(!s)return t.x=this.x,t.y=this.y,t;var r=this.getWorldTransformMatrix(e,i);return t.x=r.tx,t.y=r.ty,t},getParentRotation:function(){for(var t=0,e=this.parentContainer;e;)t+=e.rotation,e=e.parentContainer;return t}};aP.exports=Xse});var uP=u((OBe,lP)=>{"use strict";var hP=1,Kse={_visible:!0,visible:{get:function(){return this._visible},set:function(t){t?(this._visible=!0,this.renderFlags|=hP):(this._visible=!1,this.renderFlags&=~hP)}},setVisible:function(t){return this.visible=t,this}};lP.exports=Kse});var ri=u((DBe,cP)=>{"use strict";cP.exports={Alpha:HA(),AlphaSingle:XA(),BlendMode:$A(),ComputedSize:QA(),Crop:tx(),Depth:tw(),Flip:sw(),GetBounds:Cw(),Mask:AR(),Origin:CR(),Pipeline:_R(),PostPipeline:LR(),ScrollFactor:OR(),Size:BR(),Texture:HR(),TextureCrop:XR(),Tint:ZR(),ToJSON:su(),Transform:oP(),TransformMatrix:ws(),Visible:uP()}});var Na=u((BBe,dP)=>{"use strict";var Zse=Kt(),jse=function(t){return t*Zse.DEG_TO_RAD};dP.exports=jse});var ze=u((UBe,Vf)=>{"use strict";var $se=Object.prototype.hasOwnProperty,Zt="~";function rh(){}Object.create&&(rh.prototype=Object.create(null),new rh().__proto__||(Zt=!1));function Jse(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function fP(t,e,i,s,r){if(typeof i!="function")throw new TypeError("The listener must be a function");var n=new Jse(i,s||t,r),a=Zt?Zt+e:e;return t._events[a]?t._events[a].fn?t._events[a]=[t._events[a],n]:t._events[a].push(n):(t._events[a]=n,t._eventsCount++),t}function ru(t,e){--t._eventsCount===0?t._events=new rh:delete t._events[e]}function Ut(){this._events=new rh,this._eventsCount=0}Ut.prototype.eventNames=function(){var e=[],i,s;if(this._eventsCount===0)return e;for(s in i=this._events)$se.call(i,s)&&e.push(Zt?s.slice(1):s);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(i)):e};Ut.prototype.listeners=function(e){var i=Zt?Zt+e:e,s=this._events[i];if(!s)return[];if(s.fn)return[s.fn];for(var r=0,n=s.length,a=new Array(n);r<n;r++)a[r]=s[r].fn;return a};Ut.prototype.listenerCount=function(e){var i=Zt?Zt+e:e,s=this._events[i];return s?s.fn?1:s.length:0};Ut.prototype.emit=function(e,i,s,r,n,a){var o=Zt?Zt+e:e;if(!this._events[o])return!1;var h=this._events[o],l=arguments.length,c,d;if(h.fn){switch(h.once&&this.removeListener(e,h.fn,void 0,!0),l){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,i),!0;case 3:return h.fn.call(h.context,i,s),!0;case 4:return h.fn.call(h.context,i,s,r),!0;case 5:return h.fn.call(h.context,i,s,r,n),!0;case 6:return h.fn.call(h.context,i,s,r,n,a),!0}for(d=1,c=new Array(l-1);d<l;d++)c[d-1]=arguments[d];h.fn.apply(h.context,c)}else{var f=h.length,p;for(d=0;d<f;d++)switch(h[d].once&&this.removeListener(e,h[d].fn,void 0,!0),l){case 1:h[d].fn.call(h[d].context);break;case 2:h[d].fn.call(h[d].context,i);break;case 3:h[d].fn.call(h[d].context,i,s);break;case 4:h[d].fn.call(h[d].context,i,s,r);break;default:if(!c)for(p=1,c=new Array(l-1);p<l;p++)c[p-1]=arguments[p];h[d].fn.apply(h[d].context,c)}}return!0};Ut.prototype.on=function(e,i,s){return fP(this,e,i,s,!1)};Ut.prototype.once=function(e,i,s){return fP(this,e,i,s,!0)};Ut.prototype.removeListener=function(e,i,s,r){var n=Zt?Zt+e:e;if(!this._events[n])return this;if(!i)return ru(this,n),this;var a=this._events[n];if(a.fn)a.fn===i&&(!r||a.once)&&(!s||a.context===s)&&ru(this,n);else{for(var o=0,h=[],l=a.length;o<l;o++)(a[o].fn!==i||r&&!a[o].once||s&&a[o].context!==s)&&h.push(a[o]);h.length?this._events[n]=h.length===1?h[0]:h:ru(this,n)}return this};Ut.prototype.removeAllListeners=function(e){var i;return e?(i=Zt?Zt+e:e,this._events[i]&&ru(this,i)):(this._events=new rh,this._eventsCount=0),this};Ut.prototype.off=Ut.prototype.removeListener;Ut.prototype.addListener=Ut.prototype.on;Ut.prefixed=Zt;Ut.EventEmitter=Ut;typeof Vf<"u"&&(Vf.exports=Ut)});var mP=u((NBe,pP)=>{"use strict";pP.exports="cameradestroy"});var gP=u((FBe,vP)=>{"use strict";vP.exports="camerafadeincomplete"});var EP=u((kBe,SP)=>{"use strict";SP.exports="camerafadeinstart"});var yP=u((GBe,TP)=>{"use strict";TP.exports="camerafadeoutcomplete"});var AP=u((qBe,bP)=>{"use strict";bP.exports="camerafadeoutstart"});var CP=u((WBe,xP)=>{"use strict";xP.exports="cameraflashcomplete"});var RP=u((YBe,wP)=>{"use strict";wP.exports="cameraflashstart"});var _P=u((HBe,PP)=>{"use strict";PP.exports="followupdate"});var LP=u((zBe,IP)=>{"use strict";IP.exports="camerapancomplete"});var OP=u((VBe,MP)=>{"use strict";MP.exports="camerapanstart"});var BP=u((XBe,DP)=>{"use strict";DP.exports="postrender"});var NP=u((KBe,UP)=>{"use strict";UP.exports="prerender"});var kP=u((ZBe,FP)=>{"use strict";FP.exports="camerarotatecomplete"});var qP=u((jBe,GP)=>{"use strict";GP.exports="camerarotatestart"});var YP=u(($Be,WP)=>{"use strict";WP.exports="camerashakecomplete"});var zP=u((JBe,HP)=>{"use strict";HP.exports="camerashakestart"});var XP=u((QBe,VP)=>{"use strict";VP.exports="camerazoomcomplete"});var ZP=u((eUe,KP)=>{"use strict";KP.exports="camerazoomstart"});var ts=u((tUe,jP)=>{"use strict";jP.exports={DESTROY:mP(),FADE_IN_COMPLETE:gP(),FADE_IN_START:EP(),FADE_OUT_COMPLETE:yP(),FADE_OUT_START:AP(),FLASH_COMPLETE:CP(),FLASH_START:RP(),FOLLOW_UPDATE:_P(),PAN_COMPLETE:LP(),PAN_START:OP(),POST_RENDER:BP(),PRE_RENDER:NP(),ROTATE_COMPLETE:kP(),ROTATE_START:qP(),SHAKE_COMPLETE:YP(),SHAKE_START:zP(),ZOOM_COMPLETE:XP(),ZOOM_START:ZP()}});var In=u((iUe,$P)=>{"use strict";var Qse=function(t,e,i){return t<<16|e<<8|i};$P.exports=Qse});var Xf=u((sUe,JP)=>{"use strict";var ere=function(t,e,i,s){return s<<24|t<<16|e<<8|i};JP.exports=ere});var nu=u((rUe,e_)=>{"use strict";var QP=In();function Kf(t,e,i,s){var r=(t+e*6)%6,n=Math.min(r,4-r,1);return Math.round(255*(s-s*i*Math.max(0,n)))}var tre=function(t,e,i,s){e===void 0&&(e=1),i===void 0&&(i=1);var r=Kf(5,t,e,i),n=Kf(3,t,e,i),a=Kf(1,t,e,i);return s?s.setTo?s.setTo(r,n,a,s.alpha,!0):(s.r=r,s.g=n,s.b=a,s.color=QP(r,n,a),s):{r,g:n,b:a,color:QP(r,n,a)}};e_.exports=tre});var Zf=u((nUe,t_)=>{"use strict";var ire=function(t,e,i,s){s===void 0&&(s={h:0,s:0,v:0}),t/=255,e/=255,i/=255;var r=Math.min(t,e,i),n=Math.max(t,e,i),a=n-r,o=0,h=n===0?0:a/n,l=n;return n!==r&&(n===t?o=(e-i)/a+(e<i?6:0):n===e?o=(i-t)/a+2:n===i&&(o=(t-e)/a+4),o/=6),s.hasOwnProperty("_h")?(s._h=o,s._s=h,s._v=l):(s.h=o,s.s=h,s.v=l),s};t_.exports=ire});var is=u((aUe,r_)=>{"use strict";var sre=R(),rre=In(),nre=Xf(),au=nu(),i_=Zf(),s_=new sre({initialize:function(e,i,s,r){e===void 0&&(e=0),i===void 0&&(i=0),s===void 0&&(s=0),r===void 0&&(r=255),this.r=0,this.g=0,this.b=0,this.a=255,this._h=0,this._s=0,this._v=0,this._locked=!1,this.gl=[0,0,0,1],this._color=0,this._color32=0,this._rgba="",this.setTo(e,i,s,r)},transparent:function(){return this._locked=!0,this.red=0,this.green=0,this.blue=0,this.alpha=0,this._locked=!1,this.update(!0)},setTo:function(t,e,i,s,r){return s===void 0&&(s=255),r===void 0&&(r=!0),this._locked=!0,this.red=t,this.green=e,this.blue=i,this.alpha=s,this._locked=!1,this.update(r)},setGLTo:function(t,e,i,s){return s===void 0&&(s=1),this._locked=!0,this.redGL=t,this.greenGL=e,this.blueGL=i,this.alphaGL=s,this._locked=!1,this.update(!0)},setFromRGB:function(t){return this._locked=!0,this.red=t.r,this.green=t.g,this.blue=t.b,t.hasOwnProperty("a")&&(this.alpha=t.a),this._locked=!1,this.update(!0)},setFromHSV:function(t,e,i){return au(t,e,i,this)},update:function(t){if(t===void 0&&(t=!1),this._locked)return this;var e=this.r,i=this.g,s=this.b,r=this.a;return this._color=rre(e,i,s),this._color32=nre(e,i,s,r),this._rgba="rgba("+e+","+i+","+s+","+r/255+")",t&&i_(e,i,s,this),this},updateHSV:function(){var t=this.r,e=this.g,i=this.b;return i_(t,e,i,this),this},clone:function(){return new s_(this.r,this.g,this.b,this.a)},gray:function(t){return this.setTo(t,t,t)},random:function(t,e){t===void 0&&(t=0),e===void 0&&(e=255);var i=Math.floor(t+Math.random()*(e-t)),s=Math.floor(t+Math.random()*(e-t)),r=Math.floor(t+Math.random()*(e-t));return this.setTo(i,s,r)},randomGray:function(t,e){t===void 0&&(t=0),e===void 0&&(e=255);var i=Math.floor(t+Math.random()*(e-t));return this.setTo(i,i,i)},saturate:function(t){return this.s+=t/100,this},desaturate:function(t){return this.s-=t/100,this},lighten:function(t){return this.v+=t/100,this},darken:function(t){return this.v-=t/100,this},brighten:function(t){var e=this.r,i=this.g,s=this.b;return e=Math.max(0,Math.min(255,e-Math.round(255*-(t/100)))),i=Math.max(0,Math.min(255,i-Math.round(255*-(t/100)))),s=Math.max(0,Math.min(255,s-Math.round(255*-(t/100)))),this.setTo(e,i,s)},color:{get:function(){return this._color}},color32:{get:function(){return this._color32}},rgba:{get:function(){return this._rgba}},redGL:{get:function(){return this.gl[0]},set:function(t){this.gl[0]=Math.min(Math.abs(t),1),this.r=Math.floor(this.gl[0]*255),this.update(!0)}},greenGL:{get:function(){return this.gl[1]},set:function(t){this.gl[1]=Math.min(Math.abs(t),1),this.g=Math.floor(this.gl[1]*255),this.update(!0)}},blueGL:{get:function(){return this.gl[2]},set:function(t){this.gl[2]=Math.min(Math.abs(t),1),this.b=Math.floor(this.gl[2]*255),this.update(!0)}},alphaGL:{get:function(){return this.gl[3]},set:function(t){this.gl[3]=Math.min(Math.abs(t),1),this.a=Math.floor(this.gl[3]*255),this.update()}},red:{get:function(){return this.r},set:function(t){t=Math.floor(Math.abs(t)),this.r=Math.min(t,255),this.gl[0]=t/255,this.update(!0)}},green:{get:function(){return this.g},set:function(t){t=Math.floor(Math.abs(t)),this.g=Math.min(t,255),this.gl[1]=t/255,this.update(!0)}},blue:{get:function(){return this.b},set:function(t){t=Math.floor(Math.abs(t)),this.b=Math.min(t,255),this.gl[2]=t/255,this.update(!0)}},alpha:{get:function(){return this.a},set:function(t){t=Math.floor(Math.abs(t)),this.a=Math.min(t,255),this.gl[3]=t/255,this.update()}},h:{get:function(){return this._h},set:function(t){this._h=t,au(t,this._s,this._v,this)}},s:{get:function(){return this._s},set:function(t){this._s=t,au(this._h,t,this._v,this)}},v:{get:function(){return this._v},set:function(t){this._v=t,au(this._h,this._s,t,this)}}});r_.exports=s_});var jf=u((oUe,n_)=>{"use strict";var are=is(),ore=function(t){var e=new are;t=t.replace(/^(?:#|0x)?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,o,h,l){return o+o+h+h+l+l});var i=/^(?:#|0x)?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);if(i){var s=parseInt(i[1],16),r=parseInt(i[2],16),n=parseInt(i[3],16);e.setTo(s,r,n)}return e};n_.exports=ore});var ou=u((hUe,a_)=>{"use strict";var hre=function(t){return t>16777215?{a:t>>>24,r:t>>16&255,g:t>>8&255,b:t&255}:{a:255,r:t>>16&255,g:t>>8&255,b:t&255}};a_.exports=hre});var $f=u((lUe,o_)=>{"use strict";var lre=is(),ure=ou(),cre=function(t){var e=ure(t);return new lre(e.r,e.g,e.b,e.a)};o_.exports=cre});var Jf=u((uUe,h_)=>{"use strict";var dre=is(),fre=function(t){return new dre(t.r,t.g,t.b,t.a)};h_.exports=fre});var Qf=u((cUe,l_)=>{"use strict";var pre=is(),mre=function(t){var e=new pre,i=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(t.toLowerCase());if(i){var s=parseInt(i[1],10),r=parseInt(i[2],10),n=parseInt(i[3],10),a=i[4]!==void 0?parseFloat(i[4]):1;e.setTo(s,r,n,a*255)}return e};l_.exports=mre});var hu=u((dUe,u_)=>{"use strict";var vre=jf(),gre=$f(),Sre=Jf(),Ere=Qf(),Tre=function(t){var e=typeof t;switch(e){case"string":return t.substr(0,3).toLowerCase()==="rgb"?Ere(t):vre(t);case"number":return gre(t);case"object":return Sre(t)}};u_.exports=Tre});var lu=u((fUe,p_)=>{"use strict";var yre=R(),c_=ri(),bre=Na(),d_=ze(),Are=ts(),ep=Ze(),xre=ws(),f_=hu(),tp=Fe(),Cre=new yre({Extends:d_,Mixins:[c_.AlphaSingle,c_.Visible],initialize:function(e,i,s,r){e===void 0&&(e=0),i===void 0&&(i=0),s===void 0&&(s=0),r===void 0&&(r=0),d_.call(this),this.scene,this.sceneManager,this.scaleManager,this.cameraManager,this.id=0,this.name="",this.roundPixels=!1,this.useBounds=!1,this.worldView=new ep,this.dirty=!0,this._x=e,this._y=i,this._width=s,this._height=r,this._bounds=new ep,this._scrollX=0,this._scrollY=0,this._zoomX=1,this._zoomY=1,this._rotation=0,this.matrix=new xre,this.transparent=!0,this.backgroundColor=f_("rgba(0,0,0,0)"),this.disableCull=!1,this.culledObjects=[],this.midPoint=new tp(s/2,r/2),this.originX=.5,this.originY=.5,this._customViewport=!1,this.mask=null,this._maskCamera=null,this.renderList=[],this.isSceneCamera=!0,this.renderRoundPixels=!0},addToRenderList:function(t){this.renderList.push(t)},setOrigin:function(t,e){return t===void 0&&(t=.5),e===void 0&&(e=t),this.originX=t,this.originY=e,this},getScroll:function(t,e,i){i===void 0&&(i=new tp);var s=this.width*.5,r=this.height*.5;return i.x=t-s,i.y=e-r,this.useBounds&&(i.x=this.clampX(i.x),i.y=this.clampY(i.y)),i},centerOnX:function(t){var e=this.width*.5;return this.midPoint.x=t,this.scrollX=t-e,this.useBounds&&(this.scrollX=this.clampX(this.scrollX)),this},centerOnY:function(t){var e=this.height*.5;return this.midPoint.y=t,this.scrollY=t-e,this.useBounds&&(this.scrollY=this.clampY(this.scrollY)),this},centerOn:function(t,e){return this.centerOnX(t),this.centerOnY(e),this},centerToBounds:function(){if(this.useBounds){var t=this._bounds,e=this.width*.5,i=this.height*.5;this.midPoint.set(t.centerX,t.centerY),this.scrollX=t.centerX-e,this.scrollY=t.centerY-i}return this},centerToSize:function(){return this.scrollX=this.width*.5,this.scrollY=this.height*.5,this},cull:function(t){if(this.disableCull)return t;var e=this.matrix.matrix,i=e[0],s=e[1],r=e[2],n=e[3],a=i*n-s*r;if(!a)return t;var o=e[4],h=e[5],l=this.scrollX,c=this.scrollY,d=this.width,f=this.height,p=this.y,m=p+f,v=this.x,g=v+d,S=this.culledObjects,y=t.length;a=1/a,S.length=0;for(var b=0;b<y;++b){var x=t[b];if(!x.hasOwnProperty("width")||x.parentContainer){S.push(x);continue}var A=x.width,w=x.height,C=x.x-l*x.scrollFactorX-A*x.originX,_=x.y-c*x.scrollFactorY-w*x.originY,N=C*i+_*r+o,D=C*s+_*n+h,Y=(C+A)*i+(_+w)*r+o,$=(C+A)*s+(_+w)*n+h;Y>v&&N<g&&$>p&&D<m&&S.push(x)}return S},getWorldPoint:function(t,e,i){i===void 0&&(i=new tp);var s=this.matrix.matrix,r=s[0],n=s[1],a=s[2],o=s[3],h=s[4],l=s[5],c=r*o-n*a;if(!c)return i.x=t,i.y=e,i;c=1/c;var d=o*c,f=-n*c,p=-a*c,m=r*c,v=(a*l-o*h)*c,g=(n*h-r*l)*c,S=Math.cos(this.rotation),y=Math.sin(this.rotation),b=this.zoomX,x=this.zoomY,A=this.scrollX,w=this.scrollY,C=t+(A*S-w*y)*b,_=e+(A*y+w*S)*x;return i.x=C*d+_*p+v,i.y=C*f+_*m+g,i},ignore:function(t){var e=this.id;Array.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++){var s=t[i];Array.isArray(s)?this.ignore(s):s.isParent?this.ignore(s.getChildren()):s.cameraFilter|=e}return this},clampX:function(t){var e=this._bounds,i=this.displayWidth,s=e.x+(i-this.width)/2,r=Math.max(s,s+e.width-i);return t<s?t=s:t>r&&(t=r),t},clampY:function(t){var e=this._bounds,i=this.displayHeight,s=e.y+(i-this.height)/2,r=Math.max(s,s+e.height-i);return t<s?t=s:t>r&&(t=r),t},removeBounds:function(){return this.useBounds=!1,this.dirty=!0,this._bounds.setEmpty(),this},setAngle:function(t){return t===void 0&&(t=0),this.rotation=bre(t),this},setBackgroundColor:function(t){return t===void 0&&(t="rgba(0,0,0,0)"),this.backgroundColor=f_(t),this.transparent=this.backgroundColor.alpha===0,this},setBounds:function(t,e,i,s,r){return r===void 0&&(r=!1),this._bounds.setTo(t,e,i,s),this.dirty=!0,this.useBounds=!0,r?this.centerToBounds():(this.scrollX=this.clampX(this.scrollX),this.scrollY=this.clampY(this.scrollY)),this},getBounds:function(t){t===void 0&&(t=new ep);var e=this._bounds;return t.setTo(e.x,e.y,e.width,e.height),t},setName:function(t){return t===void 0&&(t=""),this.name=t,this},setPosition:function(t,e){return e===void 0&&(e=t),this.x=t,this.y=e,this},setRotation:function(t){return t===void 0&&(t=0),this.rotation=t,this},setRoundPixels:function(t){return this.roundPixels=t,this},setScene:function(t,e){e===void 0&&(e=!0),this.scene&&this._customViewport&&this.sceneManager.customViewports--,this.scene=t,this.isSceneCamera=e;var i=t.sys;return this.sceneManager=i.game.scene,this.scaleManager=i.scale,this.cameraManager=i.cameras,this.updateSystem(),this},setScroll:function(t,e){return e===void 0&&(e=t),this.scrollX=t,this.scrollY=e,this},setSize:function(t,e){return e===void 0&&(e=t),this.width=t,this.height=e,this},setViewport:function(t,e,i,s){return this.x=t,this.y=e,this.width=i,this.height=s,this},setZoom:function(t,e){return t===void 0&&(t=1),e===void 0&&(e=t),t===0&&(t=.001),e===0&&(e=.001),this.zoomX=t,this.zoomY=e,this},setMask:function(t,e){return e===void 0&&(e=!0),this.mask=t,this._maskCamera=e?this.cameraManager.default:this,this},clearMask:function(t){return t===void 0&&(t=!1),t&&this.mask&&this.mask.destroy(),this.mask=null,this},toJSON:function(){var t={name:this.name,x:this.x,y:this.y,width:this.width,height:this.height,zoom:this.zoom,rotation:this.rotation,roundPixels:this.roundPixels,scrollX:this.scrollX,scrollY:this.scrollY,backgroundColor:this.backgroundColor.rgba};return this.useBounds&&(t.bounds={x:this._bounds.x,y:this._bounds.y,width:this._bounds.width,height:this._bounds.height}),t},update:function(){},setIsSceneCamera:function(t){return this.isSceneCamera=t,this},updateSystem:function(){if(!(!this.scaleManager||!this.isSceneCamera)){var t=this._x!==0||this._y!==0||this.scaleManager.width!==this._width||this.scaleManager.height!==this._height,e=this.sceneManager;t&&!this._customViewport?e.customViewports++:!t&&this._customViewport&&e.customViewports--,this.dirty=!0,this._customViewport=t}},destroy:function(){this.emit(Are.DESTROY,this),this.removeAllListeners(),this.matrix.destroy(),this.culledObjects=[],this._customViewport&&this.sceneManager.customViewports--,this.renderList=[],this._bounds=null,this.scene=null,this.scaleManager=null,this.sceneManager=null,this.cameraManager=null},x:{get:function(){return this._x},set:function(t){this._x=t,this.updateSystem()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.updateSystem()}},width:{get:function(){return this._width},set:function(t){this._width=t,this.updateSystem()}},height:{get:function(){return this._height},set:function(t){this._height=t,this.updateSystem()}},scrollX:{get:function(){return this._scrollX},set:function(t){t!==this._scrollX&&(this._scrollX=t,this.dirty=!0)}},scrollY:{get:function(){return this._scrollY},set:function(t){t!==this._scrollY&&(this._scrollY=t,this.dirty=!0)}},zoom:{get:function(){return(this._zoomX+this._zoomY)/2},set:function(t){this._zoomX=t,this._zoomY=t,this.dirty=!0}},zoomX:{get:function(){return this._zoomX},set:function(t){this._zoomX=t,this.dirty=!0}},zoomY:{get:function(){return this._zoomY},set:function(t){this._zoomY=t,this.dirty=!0}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation=t,this.dirty=!0}},centerX:{get:function(){return this.x+.5*this.width}},centerY:{get:function(){return this.y+.5*this.height}},displayWidth:{get:function(){return this.width/this.zoomX}},displayHeight:{get:function(){return this.height/this.zoomY}}});p_.exports=Cre});var uu=u((pUe,m_)=>{"use strict";var wre=function(t,e,i){return t.x=e-t.width/2,t.y=i-t.height/2,t};m_.exports=wre});var g_=u((mUe,v_)=>{"use strict";var Rre=Je(),Pre=R(),cu=ts(),_re=new Pre({initialize:function(e){this.camera=e,this.isRunning=!1,this.isComplete=!1,this.direction=!0,this.duration=0,this.red=0,this.green=0,this.blue=0,this.alpha=0,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(t,e,i,s,r,n,a,o){if(t===void 0&&(t=!0),e===void 0&&(e=1e3),i===void 0&&(i=0),s===void 0&&(s=0),r===void 0&&(r=0),n===void 0&&(n=!1),a===void 0&&(a=null),o===void 0&&(o=this.camera.scene),!n&&this.isRunning)return this.camera;this.isRunning=!0,this.isComplete=!1,this.duration=e,this.direction=t,this.progress=0,this.red=i,this.green=s,this.blue=r,this.alpha=t?Number.MIN_VALUE:1,this._elapsed=0,this._onUpdate=a,this._onUpdateScope=o;var h=t?cu.FADE_OUT_START:cu.FADE_IN_START;return this.camera.emit(h,this.camera,this,e,i,s,r),this.camera},update:function(t,e){this.isRunning&&(this._elapsed+=e,this.progress=Rre(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration?this.alpha=this.direction?this.progress:1-this.progress:(this.alpha=this.direction?1:0,this.effectComplete()))},postRenderCanvas:function(t){if(!this.isRunning&&!this.isComplete)return!1;var e=this.camera;return t.fillStyle="rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")",t.fillRect(e.x,e.y,e.width,e.height),!0},postRenderWebGL:function(t,e){if(!this.isRunning&&!this.isComplete)return!1;var i=this.camera,s=this.red/255,r=this.green/255,n=this.blue/255;return t.drawFillRect(i.x,i.y,i.width,i.height,e(n,r,s,1),this.alpha),!0},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.isComplete=!0;var t=this.direction?cu.FADE_OUT_COMPLETE:cu.FADE_IN_COMPLETE;this.camera.emit(t,this.camera,this)},reset:function(){this.isRunning=!1,this.isComplete=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});v_.exports=_re});var T_=u((vUe,E_)=>{"use strict";var Ire=Je(),Lre=R(),S_=ts(),Mre=new Lre({initialize:function(e){this.camera=e,this.isRunning=!1,this.duration=0,this.red=0,this.green=0,this.blue=0,this.alpha=1,this.progress=0,this._elapsed=0,this._alpha,this._onUpdate,this._onUpdateScope},start:function(t,e,i,s,r,n,a){return t===void 0&&(t=250),e===void 0&&(e=255),i===void 0&&(i=255),s===void 0&&(s=255),r===void 0&&(r=!1),n===void 0&&(n=null),a===void 0&&(a=this.camera.scene),!r&&this.isRunning?this.camera:(this.isRunning=!0,this.duration=t,this.progress=0,this.red=e,this.green=i,this.blue=s,this._alpha=this.alpha,this._elapsed=0,this._onUpdate=n,this._onUpdateScope=a,this.camera.emit(S_.FLASH_START,this.camera,this,t,e,i,s),this.camera)},update:function(t,e){this.isRunning&&(this._elapsed+=e,this.progress=Ire(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration?this.alpha=this._alpha*(1-this.progress):this.effectComplete())},postRenderCanvas:function(t){if(!this.isRunning)return!1;var e=this.camera;return t.fillStyle="rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")",t.fillRect(e.x,e.y,e.width,e.height),!0},postRenderWebGL:function(t,e){if(!this.isRunning)return!1;var i=this.camera,s=this.red/255,r=this.green/255,n=this.blue/255;return t.drawFillRect(i.x,i.y,i.width,i.height,e(n,r,s,1),this.alpha),!0},effectComplete:function(){this.alpha=this._alpha,this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(S_.FLASH_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});E_.exports=Mre});var b_=u((gUe,y_)=>{"use strict";var Ore=function(t,e){return e===void 0&&(e=1.70158),t*t*((e+1)*t-e)};y_.exports=Ore});var x_=u((SUe,A_)=>{"use strict";var Dre=function(t,e){return e===void 0&&(e=1.70158),--t*t*((e+1)*t+e)+1};A_.exports=Dre});var w_=u((EUe,C_)=>{"use strict";var Bre=function(t,e){e===void 0&&(e=1.70158);var i=e*1.525;return(t*=2)<1?.5*(t*t*((i+1)*t-i)):.5*((t-=2)*t*((i+1)*t+i)+2)};C_.exports=Bre});var ip=u((TUe,R_)=>{"use strict";R_.exports={In:b_(),Out:x_(),InOut:w_()}});var __=u((yUe,P_)=>{"use strict";var Ure=function(t){return t=1-t,t<.36363636363636365?1-7.5625*t*t:t<.7272727272727273?1-(7.5625*(t-=.5454545454545454)*t+.75):t<.9090909090909091?1-(7.5625*(t-=.8181818181818182)*t+.9375):1-(7.5625*(t-=.9545454545454546)*t+.984375)};P_.exports=Ure});var L_=u((bUe,I_)=>{"use strict";var Nre=function(t){return t<.36363636363636365?7.5625*t*t:t<.7272727272727273?7.5625*(t-=.5454545454545454)*t+.75:t<.9090909090909091?7.5625*(t-=.8181818181818182)*t+.9375:7.5625*(t-=.9545454545454546)*t+.984375};I_.exports=Nre});var O_=u((AUe,M_)=>{"use strict";var Fre=function(t){var e=!1;return t<.5?(t=1-t*2,e=!0):t=t*2-1,t<.36363636363636365?t=7.5625*t*t:t<.7272727272727273?t=7.5625*(t-=.5454545454545454)*t+.75:t<.9090909090909091?t=7.5625*(t-=.8181818181818182)*t+.9375:t=7.5625*(t-=.9545454545454546)*t+.984375,e?(1-t)*.5:t*.5+.5};M_.exports=Fre});var sp=u((xUe,D_)=>{"use strict";D_.exports={In:__(),Out:L_(),InOut:O_()}});var U_=u((CUe,B_)=>{"use strict";var kre=function(t){return 1-Math.sqrt(1-t*t)};B_.exports=kre});var F_=u((wUe,N_)=>{"use strict";var Gre=function(t){return Math.sqrt(1- --t*t)};N_.exports=Gre});var G_=u((RUe,k_)=>{"use strict";var qre=function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)};k_.exports=qre});var rp=u((PUe,q_)=>{"use strict";q_.exports={In:U_(),Out:F_(),InOut:G_()}});var Y_=u((_Ue,W_)=>{"use strict";var Wre=function(t){return t*t*t};W_.exports=Wre});var z_=u((IUe,H_)=>{"use strict";var Yre=function(t){return--t*t*t+1};H_.exports=Yre});var X_=u((LUe,V_)=>{"use strict";var Hre=function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)};V_.exports=Hre});var np=u((MUe,K_)=>{"use strict";K_.exports={In:Y_(),Out:z_(),InOut:X_()}});var j_=u((OUe,Z_)=>{"use strict";var zre=function(t,e,i){if(e===void 0&&(e=.1),i===void 0&&(i=.1),t===0)return 0;if(t===1)return 1;var s=i/4;return e<1?e=1:s=i*Math.asin(1/e)/(2*Math.PI),-(e*Math.pow(2,10*(t-=1))*Math.sin((t-s)*(2*Math.PI)/i))};Z_.exports=zre});var J_=u((DUe,$_)=>{"use strict";var Vre=function(t,e,i){if(e===void 0&&(e=.1),i===void 0&&(i=.1),t===0)return 0;if(t===1)return 1;var s=i/4;return e<1?e=1:s=i*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-s)*(2*Math.PI)/i)+1};$_.exports=Vre});var eI=u((BUe,Q_)=>{"use strict";var Xre=function(t,e,i){if(e===void 0&&(e=.1),i===void 0&&(i=.1),t===0)return 0;if(t===1)return 1;var s=i/4;return e<1?e=1:s=i*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?-.5*(e*Math.pow(2,10*(t-=1))*Math.sin((t-s)*(2*Math.PI)/i)):e*Math.pow(2,-10*(t-=1))*Math.sin((t-s)*(2*Math.PI)/i)*.5+1};Q_.exports=Xre});var ap=u((UUe,tI)=>{"use strict";tI.exports={In:j_(),Out:J_(),InOut:eI()}});var sI=u((NUe,iI)=>{"use strict";var Kre=function(t){return Math.pow(2,10*(t-1))-.001};iI.exports=Kre});var nI=u((FUe,rI)=>{"use strict";var Zre=function(t){return 1-Math.pow(2,-10*t)};rI.exports=Zre});var oI=u((kUe,aI)=>{"use strict";var jre=function(t){return(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))};aI.exports=jre});var op=u((GUe,hI)=>{"use strict";hI.exports={In:sI(),Out:nI(),InOut:oI()}});var uI=u((qUe,lI)=>{"use strict";var $re=function(t){return t};lI.exports=$re});var hp=u((WUe,cI)=>{"use strict";cI.exports=uI()});var fI=u((YUe,dI)=>{"use strict";var Jre=function(t){return t*t};dI.exports=Jre});var mI=u((HUe,pI)=>{"use strict";var Qre=function(t){return t*(2-t)};pI.exports=Qre});var gI=u((zUe,vI)=>{"use strict";var ene=function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)};vI.exports=ene});var lp=u((VUe,SI)=>{"use strict";SI.exports={In:fI(),Out:mI(),InOut:gI()}});var TI=u((XUe,EI)=>{"use strict";var tne=function(t){return t*t*t*t};EI.exports=tne});var bI=u((KUe,yI)=>{"use strict";var ine=function(t){return 1- --t*t*t*t};yI.exports=ine});var xI=u((ZUe,AI)=>{"use strict";var sne=function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)};AI.exports=sne});var up=u((jUe,CI)=>{"use strict";CI.exports={In:TI(),Out:bI(),InOut:xI()}});var RI=u(($Ue,wI)=>{"use strict";var rne=function(t){return t*t*t*t*t};wI.exports=rne});var _I=u((JUe,PI)=>{"use strict";var nne=function(t){return--t*t*t*t*t+1};PI.exports=nne});var LI=u((QUe,II)=>{"use strict";var ane=function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)};II.exports=ane});var cp=u((e1e,MI)=>{"use strict";MI.exports={In:RI(),Out:_I(),InOut:LI()}});var DI=u((t1e,OI)=>{"use strict";var one=function(t){return t===0?0:t===1?1:1-Math.cos(t*Math.PI/2)};OI.exports=one});var UI=u((i1e,BI)=>{"use strict";var hne=function(t){return t===0?0:t===1?1:Math.sin(t*Math.PI/2)};BI.exports=hne});var FI=u((s1e,NI)=>{"use strict";var lne=function(t){return t===0?0:t===1?1:.5*(1-Math.cos(Math.PI*t))};NI.exports=lne});var dp=u((r1e,kI)=>{"use strict";kI.exports={In:DI(),Out:UI(),InOut:FI()}});var qI=u((n1e,GI)=>{"use strict";var une=function(t,e){return e===void 0&&(e=1),t<=0?0:t>=1?1:((e*t|0)+1)*(1/e)};GI.exports=une});var fp=u((a1e,WI)=>{"use strict";WI.exports=qI()});var lh=u((o1e,HI)=>{"use strict";var du=ip(),fu=sp(),pu=rp(),nh=np(),mu=ap(),vu=op(),YI=hp(),ah=lp(),oh=up(),hh=cp(),gu=dp(),cne=fp();HI.exports={Power0:YI,Power1:ah.Out,Power2:nh.Out,Power3:oh.Out,Power4:hh.Out,Linear:YI,Quad:ah.Out,Cubic:nh.Out,Quart:oh.Out,Quint:hh.Out,Sine:gu.Out,Expo:vu.Out,Circ:pu.Out,Elastic:mu.Out,Back:du.Out,Bounce:fu.Out,Stepped:cne,"Quad.easeIn":ah.In,"Cubic.easeIn":nh.In,"Quart.easeIn":oh.In,"Quint.easeIn":hh.In,"Sine.easeIn":gu.In,"Expo.easeIn":vu.In,"Circ.easeIn":pu.In,"Elastic.easeIn":mu.In,"Back.easeIn":du.In,"Bounce.easeIn":fu.In,"Quad.easeOut":ah.Out,"Cubic.easeOut":nh.Out,"Quart.easeOut":oh.Out,"Quint.easeOut":hh.Out,"Sine.easeOut":gu.Out,"Expo.easeOut":vu.Out,"Circ.easeOut":pu.Out,"Elastic.easeOut":mu.Out,"Back.easeOut":du.Out,"Bounce.easeOut":fu.Out,"Quad.easeInOut":ah.InOut,"Cubic.easeInOut":nh.InOut,"Quart.easeInOut":oh.InOut,"Quint.easeInOut":hh.InOut,"Sine.easeInOut":gu.InOut,"Expo.easeInOut":vu.InOut,"Circ.easeInOut":pu.InOut,"Elastic.easeInOut":mu.InOut,"Back.easeInOut":du.InOut,"Bounce.easeInOut":fu.InOut}});var XI=u((h1e,VI)=>{"use strict";var dne=Je(),fne=R(),pp=lh(),zI=ts(),mp=Fe(),pne=new fne({initialize:function(e){this.camera=e,this.isRunning=!1,this.duration=0,this.source=new mp,this.current=new mp,this.destination=new mp,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(t,e,i,s,r,n,a){i===void 0&&(i=1e3),s===void 0&&(s=pp.Linear),r===void 0&&(r=!1),n===void 0&&(n=null),a===void 0&&(a=this.camera.scene);var o=this.camera;return!r&&this.isRunning||(this.isRunning=!0,this.duration=i,this.progress=0,this.source.set(o.scrollX,o.scrollY),this.destination.set(t,e),o.getScroll(t,e,this.current),typeof s=="string"&&pp.hasOwnProperty(s)?this.ease=pp[s]:typeof s=="function"&&(this.ease=s),this._elapsed=0,this._onUpdate=n,this._onUpdateScope=a,this.camera.emit(zI.PAN_START,this.camera,this,i,t,e)),o},update:function(t,e){if(this.isRunning){this._elapsed+=e;var i=dne(this._elapsed/this.duration,0,1);this.progress=i;var s=this.camera;if(this._elapsed<this.duration){var r=this.ease(i);s.getScroll(this.destination.x,this.destination.y,this.current);var n=this.source.x+(this.current.x-this.source.x)*r,a=this.source.y+(this.current.y-this.source.y)*r;s.setScroll(n,a),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,s,i,n,a)}else s.centerOn(this.destination.x,this.destination.y),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,s,i,s.scrollX,s.scrollY),this.effectComplete()}},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(zI.PAN_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.source=null,this.destination=null}});VI.exports=pne});var jI=u((l1e,ZI)=>{"use strict";var mne=Je(),vne=R(),KI=ts(),gne=Fe(),Sne=new vne({initialize:function(e){this.camera=e,this.isRunning=!1,this.duration=0,this.intensity=new gne,this.progress=0,this._elapsed=0,this._offsetX=0,this._offsetY=0,this._onUpdate,this._onUpdateScope},start:function(t,e,i,s,r){return t===void 0&&(t=100),e===void 0&&(e=.05),i===void 0&&(i=!1),s===void 0&&(s=null),r===void 0&&(r=this.camera.scene),!i&&this.isRunning?this.camera:(this.isRunning=!0,this.duration=t,this.progress=0,typeof e=="number"?this.intensity.set(e):this.intensity.set(e.x,e.y),this._elapsed=0,this._offsetX=0,this._offsetY=0,this._onUpdate=s,this._onUpdateScope=r,this.camera.emit(KI.SHAKE_START,this.camera,this,t,e),this.camera)},preRender:function(){this.isRunning&&this.camera.matrix.translate(this._offsetX,this._offsetY)},update:function(t,e){if(this.isRunning)if(this._elapsed+=e,this.progress=mne(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration){var i=this.intensity,s=this.camera.width,r=this.camera.height,n=this.camera.zoom;this._offsetX=(Math.random()*i.x*s*2-i.x*s)*n,this._offsetY=(Math.random()*i.y*r*2-i.y*r)*n,this.camera.roundPixels&&(this._offsetX=Math.round(this._offsetX),this._offsetY=Math.round(this._offsetY))}else this.effectComplete()},effectComplete:function(){this._offsetX=0,this._offsetY=0,this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(KI.SHAKE_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._offsetX=0,this._offsetY=0,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.intensity=null}});ZI.exports=Sne});var QI=u((u1e,JI)=>{"use strict";var Ene=Je(),Tne=R(),$I=ts(),vp=lh(),yne=new Tne({initialize:function(e){this.camera=e,this.isRunning=!1,this.duration=0,this.source=0,this.current=0,this.destination=0,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope,this.clockwise=!0,this.shortestPath=!1},start:function(t,e,i,s,r,n,a){i===void 0&&(i=1e3),s===void 0&&(s=vp.Linear),r===void 0&&(r=!1),n===void 0&&(n=null),a===void 0&&(a=this.camera.scene),e===void 0&&(e=!1),this.shortestPath=e;var o=t;t<0?(o=-1*t,this.clockwise=!1):this.clockwise=!0;var h=360*Math.PI/180;o=o-Math.floor(o/h)*h;var l=this.camera;if(!r&&this.isRunning)return l;if(this.isRunning=!0,this.duration=i,this.progress=0,this.source=l.rotation,this.destination=o,typeof s=="string"&&vp.hasOwnProperty(s)?this.ease=vp[s]:typeof s=="function"&&(this.ease=s),this._elapsed=0,this._onUpdate=n,this._onUpdateScope=a,this.shortestPath){var c=0,d=0;this.destination>this.source?c=Math.abs(this.destination-this.source):c=Math.abs(this.destination+h)-this.source,this.source>this.destination?d=Math.abs(this.source-this.destination):d=Math.abs(this.source+h)-this.destination,c<d?this.clockwise=!0:c>d&&(this.clockwise=!1)}return this.camera.emit($I.ROTATE_START,this.camera,this,i,o),l},update:function(t,e){if(this.isRunning){this._elapsed+=e;var i=Ene(this._elapsed/this.duration,0,1);this.progress=i;var s=this.camera;if(this._elapsed<this.duration){var r=this.ease(i);this.current=s.rotation;var n=0,a=360*Math.PI/180,o=this.destination,h=this.current;this.clockwise===!1&&(o=this.current,h=this.destination),o>=h?n=Math.abs(o-h):n=Math.abs(o+a)-h;var l=0;this.clockwise?l=s.rotation+n*r:l=s.rotation-n*r,s.rotation=l,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,s,i,l)}else s.rotation=this.destination,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,s,i,this.destination),this.effectComplete()}},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit($I.ROTATE_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.source=null,this.destination=null}});JI.exports=yne});var iL=u((c1e,tL)=>{"use strict";var bne=Je(),Ane=R(),gp=lh(),eL=ts(),xne=new Ane({initialize:function(e){this.camera=e,this.isRunning=!1,this.duration=0,this.source=1,this.destination=1,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(t,e,i,s,r,n){e===void 0&&(e=1e3),i===void 0&&(i=gp.Linear),s===void 0&&(s=!1),r===void 0&&(r=null),n===void 0&&(n=this.camera.scene);var a=this.camera;return!s&&this.isRunning||(this.isRunning=!0,this.duration=e,this.progress=0,this.source=a.zoom,this.destination=t,typeof i=="string"&&gp.hasOwnProperty(i)?this.ease=gp[i]:typeof i=="function"&&(this.ease=i),this._elapsed=0,this._onUpdate=r,this._onUpdateScope=n,this.camera.emit(eL.ZOOM_START,this.camera,this,e,t)),a},update:function(t,e){this.isRunning&&(this._elapsed+=e,this.progress=bne(this._elapsed/this.duration,0,1),this._elapsed<this.duration?(this.camera.zoom=this.source+(this.destination-this.source)*this.ease(this.progress),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress,this.camera.zoom)):(this.camera.zoom=this.destination,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress,this.destination),this.effectComplete()))},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(eL.ZOOM_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});tL.exports=xne});var rL=u((d1e,sL)=>{"use strict";sL.exports={Fade:g_(),Flash:T_(),Pan:XI(),Shake:jI(),RotateTo:QI(),Zoom:iL()}});var uh=u((f1e,nL)=>{"use strict";var Cne=function(t,e,i){return(e-t)*i+t};nL.exports=Cne});var ch=u((p1e,lL)=>{"use strict";var Sp=lu(),aL=uu(),oL=Je(),wne=R(),Rne=ri(),Pne=rL(),_ne=ts(),Fa=uh(),Ine=Ze(),hL=Fe(),Lne=new wne({Extends:Sp,Mixins:[Rne.PostPipeline],initialize:function(e,i,s,r){Sp.call(this,e,i,s,r),this.initPostPipeline(),this.inputEnabled=!0,this.fadeEffect=new Pne.Fade(this),this.lerp=new hL(1,1),this.followOffset=new hL,this.deadzone=null,this._follow=null},setDeadzone:function(t,e){if(t===void 0)this.deadzone=null;else{if(this.deadzone?(this.deadzone.width=t,this.deadzone.height=e):this.deadzone=new Ine(0,0,t,e),this._follow){var i=this.width/2,s=this.height/2,r=this._follow.x-this.followOffset.x,n=this._follow.y-this.followOffset.y;this.midPoint.set(r,n),this.scrollX=r-i,this.scrollY=n-s}aL(this.deadzone,this.midPoint.x,this.midPoint.y)}return this},fadeIn:function(t,e,i,s,r,n){return this.fadeEffect.start(!1,t,e,i,s,!0,r,n)},fadeOut:function(t,e,i,s,r,n){return this.fadeEffect.start(!0,t,e,i,s,!0,r,n)},preRender:function(){this.renderList.length=0;var t=this.width,e=this.height,i=t*.5,s=e*.5,r=this.zoomX,n=this.zoomY,a=this.matrix;this.renderRoundPixels=this.roundPixels&&Number.isInteger(r)&&Number.isInteger(n);var o=t*this.originX,h=e*this.originY,l=this._follow,c=this.deadzone,d=this.scrollX,f=this.scrollY;c&&aL(c,this.midPoint.x,this.midPoint.y);var p=!1;if(l){var m=this.lerp,v=l.x-this.followOffset.x,g=l.y-this.followOffset.y;c?(v<c.x?d=Fa(d,d-(c.x-v),m.x):v>c.right&&(d=Fa(d,d+(v-c.right),m.x)),g<c.y?f=Fa(f,f-(c.y-g),m.y):g>c.bottom&&(f=Fa(f,f+(g-c.bottom),m.y))):(d=Fa(d,v-o,m.x),f=Fa(f,g-h,m.y)),p=!0}this.roundPixels&&(d=Math.floor(d),f=Math.floor(f)),this.useBounds&&(d=this.clampX(d),f=this.clampY(f)),this.scrollX=d,this.scrollY=f;var S=d+i,y=f+s;this.midPoint.set(S,y);var b=Math.floor(t/r+.5),x=Math.floor(e/n+.5),A=Math.floor(S-b/2+.5),w=Math.floor(y-x/2+.5);this.worldView.setTo(A,w,b,x),a.applyITRS(Math.floor(this.x+o+.5),Math.floor(this.y+h+.5),this.rotation,r,n),a.translate(-o,-h),p&&this.emit(_ne.FOLLOW_UPDATE,this,l)},setLerp:function(t,e){return t===void 0&&(t=1),e===void 0&&(e=t),this.lerp.set(t,e),this},setFollowOffset:function(t,e){return t===void 0&&(t=0),e===void 0&&(e=0),this.followOffset.set(t,e),this},startFollow:function(t,e,i,s,r,n){e===void 0&&(e=!1),i===void 0&&(i=1),s===void 0&&(s=i),r===void 0&&(r=0),n===void 0&&(n=r),this._follow=t,this.roundPixels=e,i=oL(i,0,1),s=oL(s,0,1),this.lerp.set(i,s),this.followOffset.set(r,n);var a=this.width/2,o=this.height/2,h=t.x-r,l=t.y-n;return this.midPoint.set(h,l),this.scrollX=h-a,this.scrollY=l-o,this.useBounds&&(this.scrollX=this.clampX(this.scrollX),this.scrollY=this.clampY(this.scrollY)),this},stopFollow:function(){return this._follow=null,this},resetFX:function(){return this},update:function(t,e){this.visible&&this.fadeEffect.update(t,e)},destroy:function(){this.resetFX(),Sp.prototype.destroy.call(this),this._follow=null,this.deadzone=null}});lL.exports=Lne});var cL=u((m1e,uL)=>{"use strict";uL.exports="enterfullscreen"});var fL=u((v1e,dL)=>{"use strict";dL.exports="fullscreenfailed"});var mL=u((g1e,pL)=>{"use strict";pL.exports="fullscreenunsupported"});var gL=u((S1e,vL)=>{"use strict";vL.exports="leavefullscreen"});var EL=u((E1e,SL)=>{"use strict";SL.exports="orientationchange"});var yL=u((T1e,TL)=>{"use strict";TL.exports="resize"});var Su=u((y1e,bL)=>{"use strict";bL.exports={ENTER_FULLSCREEN:cL(),FULLSCREEN_FAILED:fL(),FULLSCREEN_UNSUPPORTED:mL(),LEAVE_FULLSCREEN:gL(),ORIENTATION_CHANGE:EL(),RESIZE:yL()}});var RL=u((b1e,wL)=>{"use strict";var AL=ch(),Mne=R(),wt=re(),One=Vt(),Dne=Pn(),xL=Su(),sr=qe(),CL=new Mne({initialize:function(e){this.scene=e,this.systems=e.sys,this.roundPixels=e.sys.game.config.roundPixels,this.cameras=[],this.main,this.default,e.sys.events.once(sr.BOOT,this.boot,this),e.sys.events.on(sr.START,this.start,this)},boot:function(){var t=this.systems;t.settings.cameras?this.fromJSON(t.settings.cameras):this.add(),this.main=this.cameras[0],this.default=new AL(0,0,t.scale.width,t.scale.height).setScene(this.scene),t.game.scale.on(xL.RESIZE,this.onResize,this),this.systems.events.once(sr.DESTROY,this.destroy,this)},start:function(){if(!this.main){var t=this.systems;t.settings.cameras?this.fromJSON(t.settings.cameras):this.add(),this.main=this.cameras[0]}var e=this.systems.events;e.on(sr.UPDATE,this.update,this),e.once(sr.SHUTDOWN,this.shutdown,this)},add:function(t,e,i,s,r,n){t===void 0&&(t=0),e===void 0&&(e=0),i===void 0&&(i=this.scene.sys.scale.width),s===void 0&&(s=this.scene.sys.scale.height),r===void 0&&(r=!1),n===void 0&&(n="");var a=new AL(t,e,i,s);return a.setName(n),a.setScene(this.scene),a.setRoundPixels(this.roundPixels),a.id=this.getNextID(),this.cameras.push(a),r&&(this.main=a),a},addExisting:function(t,e){e===void 0&&(e=!1);var i=this.cameras.indexOf(t);return i===-1?(t.id=this.getNextID(),t.setRoundPixels(this.roundPixels),this.cameras.push(t),e&&(this.main=t),t):null},getNextID:function(){for(var t=this.cameras,e=1,i=0;i<32;i++){for(var s=!1,r=0;r<t.length;r++){var n=t[r];if(n&&n.id===e){s=!0;continue}}if(s)e=e<<1;else return e}return 0},getTotal:function(t){t===void 0&&(t=!1);for(var e=0,i=this.cameras,s=0;s<i.length;s++){var r=i[s];(!t||t&&r.visible)&&e++}return e},fromJSON:function(t){Array.isArray(t)||(t=[t]);for(var e=this.scene.sys.scale.width,i=this.scene.sys.scale.height,s=0;s<t.length;s++){var r=t[s],n=wt(r,"x",0),a=wt(r,"y",0),o=wt(r,"width",e),h=wt(r,"height",i),l=this.add(n,a,o,h);l.name=wt(r,"name",""),l.zoom=wt(r,"zoom",1),l.rotation=wt(r,"rotation",0),l.scrollX=wt(r,"scrollX",0),l.scrollY=wt(r,"scrollY",0),l.roundPixels=wt(r,"roundPixels",!1),l.visible=wt(r,"visible",!0);var c=wt(r,"backgroundColor",!1);c&&l.setBackgroundColor(c);var d=wt(r,"bounds",null);if(d){var f=wt(d,"x",0),p=wt(d,"y",0),m=wt(d,"width",e),v=wt(d,"height",i);l.setBounds(f,p,m,v)}}return this},getCamera:function(t){for(var e=this.cameras,i=0;i<e.length;i++)if(e[i].name===t)return e[i];return null},getCamerasBelowPointer:function(t){for(var e=this.cameras,i=t.x,s=t.y,r=[],n=0;n<e.length;n++){var a=e[n];a.visible&&a.inputEnabled&&Dne(a,i,s)&&r.unshift(a)}return r},remove:function(t,e){e===void 0&&(e=!0),Array.isArray(t)||(t=[t]);for(var i=0,s=this.cameras,r=0;r<t.length;r++){var n=s.indexOf(t[r]);n!==-1&&(e?s[n].destroy():s[n].renderList=[],s.splice(n,1),i++)}return!this.main&&s[0]&&(this.main=s[0]),i},render:function(t,e){for(var i=this.scene,s=this.cameras,r=0;r<s.length;r++){var n=s[r];if(n.visible&&n.alpha>0){n.preRender();var a=this.getVisibleChildren(e.getChildren(),n);t.render(i,a,n)}}},getVisibleChildren:function(t,e){return t.filter(function(i){return i.willRender(e)})},resetAll:function(){for(var t=0;t<this.cameras.length;t++)this.cameras[t].destroy();return this.cameras=[],this.main=this.add(),this.main},update:function(t,e){for(var i=0;i<this.cameras.length;i++)this.cameras[i].update(t,e)},onResize:function(t,e,i,s,r){for(var n=0;n<this.cameras.length;n++){var a=this.cameras[n];a._x===0&&a._y===0&&a._width===s&&a._height===r&&a.setSize(e.width,e.height)}},resize:function(t,e){for(var i=0;i<this.cameras.length;i++)this.cameras[i].setSize(t,e)},shutdown:function(){this.main=void 0;for(var t=0;t<this.cameras.length;t++)this.cameras[t].destroy();this.cameras=[];var e=this.systems.events;e.off(sr.UPDATE,this.update,this),e.off(sr.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.default.destroy(),this.systems.events.off(sr.START,this.start,this),this.systems.events.off(sr.DESTROY,this.destroy,this),this.systems.game.scale.off(xL.RESIZE,this.onResize,this),this.scene=null,this.systems=null}});One.register("CameraManager",CL,"cameras");wL.exports=CL});var _L=u((A1e,PL)=>{"use strict";PL.exports={Camera:ch(),BaseCamera:lu(),CameraManager:RL(),Events:ts()}});var Ep=u((x1e,IL)=>{"use strict";IL.exports={Scene2D:_L()}});var DL=u((C1e,OL)=>{"use strict";var Bne=R(),LL=ze(),Une=Vt(),ML=new Bne({Extends:LL,initialize:function(){LL.call(this)},shutdown:function(){this.removeAllListeners()},destroy:function(){this.removeAllListeners()}});Une.register("EventEmitter",ML,"events");OL.exports=ML});var UL=u((w1e,BL)=>{"use strict";BL.exports={EventEmitter:DL()}});var Eu=u((R1e,NL)=>{"use strict";var Nne={MOUSE_DOWN:0,MOUSE_MOVE:1,MOUSE_UP:2,TOUCH_START:3,TOUCH_MOVE:4,TOUCH_END:5,POINTER_LOCK_CHANGE:6,TOUCH_CANCEL:7,MOUSE_WHEEL:8};NL.exports=Nne});var Tp=u((P1e,FL)=>{"use strict";var Fne=function(t,e){return function(i,s,r,n){var a=t.getPixelAlpha(s,r,n.texture.key,n.frame.name);return a&&a>=e}};FL.exports=Fne});var yp=u((_1e,kL)=>{"use strict";var kne=function(t,e,i){return{gameObject:t,enabled:!0,draggable:!1,dropZone:!1,cursor:!1,target:null,camera:null,hitArea:e,hitAreaCallback:i,hitAreaDebug:null,customHitArea:!1,localX:0,localY:0,dragState:0,dragStartX:0,dragStartY:0,dragStartXGlobal:0,dragStartYGlobal:0,dragStartCamera:null,dragX:0,dragY:0}};kL.exports=kne});var qL=u((I1e,GL)=>{"use strict";GL.exports="boot"});var YL=u((L1e,WL)=>{"use strict";WL.exports="destroy"});var zL=u((M1e,HL)=>{"use strict";HL.exports="dragend"});var XL=u((O1e,VL)=>{"use strict";VL.exports="dragenter"});var ZL=u((D1e,KL)=>{"use strict";KL.exports="drag"});var $L=u((B1e,jL)=>{"use strict";jL.exports="dragleave"});var QL=u((U1e,JL)=>{"use strict";JL.exports="dragover"});var tM=u((N1e,eM)=>{"use strict";eM.exports="dragstart"});var sM=u((F1e,iM)=>{"use strict";iM.exports="drop"});var nM=u((k1e,rM)=>{"use strict";rM.exports="gameout"});var oM=u((G1e,aM)=>{"use strict";aM.exports="gameover"});var lM=u((q1e,hM)=>{"use strict";hM.exports="gameobjectdown"});var cM=u((W1e,uM)=>{"use strict";uM.exports="dragend"});var fM=u((Y1e,dM)=>{"use strict";dM.exports="dragenter"});var mM=u((H1e,pM)=>{"use strict";pM.exports="drag"});var gM=u((z1e,vM)=>{"use strict";vM.exports="dragleave"});var EM=u((V1e,SM)=>{"use strict";SM.exports="dragover"});var yM=u((X1e,TM)=>{"use strict";TM.exports="dragstart"});var AM=u((K1e,bM)=>{"use strict";bM.exports="drop"});var CM=u((Z1e,xM)=>{"use strict";xM.exports="gameobjectmove"});var RM=u((j1e,wM)=>{"use strict";wM.exports="gameobjectout"});var _M=u(($1e,PM)=>{"use strict";PM.exports="gameobjectover"});var LM=u((J1e,IM)=>{"use strict";IM.exports="pointerdown"});var OM=u((Q1e,MM)=>{"use strict";MM.exports="pointermove"});var BM=u((eNe,DM)=>{"use strict";DM.exports="pointerout"});var NM=u((tNe,UM)=>{"use strict";UM.exports="pointerover"});var kM=u((iNe,FM)=>{"use strict";FM.exports="pointerup"});var qM=u((sNe,GM)=>{"use strict";GM.exports="wheel"});var YM=u((rNe,WM)=>{"use strict";WM.exports="gameobjectup"});var zM=u((nNe,HM)=>{"use strict";HM.exports="gameobjectwheel"});var XM=u((aNe,VM)=>{"use strict";VM.exports="boot"});var ZM=u((oNe,KM)=>{"use strict";KM.exports="process"});var $M=u((hNe,jM)=>{"use strict";jM.exports="update"});var QM=u((lNe,JM)=>{"use strict";JM.exports="pointerdown"});var tO=u((uNe,eO)=>{"use strict";eO.exports="pointerdownoutside"});var sO=u((cNe,iO)=>{"use strict";iO.exports="pointermove"});var nO=u((dNe,rO)=>{"use strict";rO.exports="pointerout"});var oO=u((fNe,aO)=>{"use strict";aO.exports="pointerover"});var lO=u((pNe,hO)=>{"use strict";hO.exports="pointerup"});var cO=u((mNe,uO)=>{"use strict";uO.exports="pointerupoutside"});var fO=u((vNe,dO)=>{"use strict";dO.exports="wheel"});var mO=u((gNe,pO)=>{"use strict";pO.exports="pointerlockchange"});var gO=u((SNe,vO)=>{"use strict";vO.exports="preupdate"});var EO=u((ENe,SO)=>{"use strict";SO.exports="shutdown"});var yO=u((TNe,TO)=>{"use strict";TO.exports="start"});var AO=u((yNe,bO)=>{"use strict";bO.exports="update"});var nt=u((bNe,xO)=>{"use strict";xO.exports={BOOT:qL(),DESTROY:YL(),DRAG_END:zL(),DRAG_ENTER:XL(),DRAG:ZL(),DRAG_LEAVE:$L(),DRAG_OVER:QL(),DRAG_START:tM(),DROP:sM(),GAME_OUT:nM(),GAME_OVER:oM(),GAMEOBJECT_DOWN:lM(),GAMEOBJECT_DRAG_END:cM(),GAMEOBJECT_DRAG_ENTER:fM(),GAMEOBJECT_DRAG:mM(),GAMEOBJECT_DRAG_LEAVE:gM(),GAMEOBJECT_DRAG_OVER:EM(),GAMEOBJECT_DRAG_START:yM(),GAMEOBJECT_DROP:AM(),GAMEOBJECT_MOVE:CM(),GAMEOBJECT_OUT:RM(),GAMEOBJECT_OVER:_M(),GAMEOBJECT_POINTER_DOWN:LM(),GAMEOBJECT_POINTER_MOVE:OM(),GAMEOBJECT_POINTER_OUT:BM(),GAMEOBJECT_POINTER_OVER:NM(),GAMEOBJECT_POINTER_UP:kM(),GAMEOBJECT_POINTER_WHEEL:qM(),GAMEOBJECT_UP:YM(),GAMEOBJECT_WHEEL:zM(),MANAGER_BOOT:XM(),MANAGER_PROCESS:ZM(),MANAGER_UPDATE:$M(),POINTER_DOWN:QM(),POINTER_DOWN_OUTSIDE:tO(),POINTER_MOVE:sO(),POINTER_OUT:nO(),POINTER_OVER:oO(),POINTER_UP:lO(),POINTER_UP_OUTSIDE:cO(),POINTER_WHEEL:fO(),POINTERLOCK_CHANGE:mO(),PRE_UPDATE:gO(),SHUTDOWN:EO(),START:yO(),UPDATE:AO()}});var wO=u((ANe,CO)=>{"use strict";CO.exports="blur"});var PO=u((xNe,RO)=>{"use strict";RO.exports="boot"});var IO=u((CNe,_O)=>{"use strict";_O.exports="contextlost"});var MO=u((wNe,LO)=>{"use strict";LO.exports="destroy"});var DO=u((RNe,OO)=>{"use strict";OO.exports="focus"});var UO=u((PNe,BO)=>{"use strict";BO.exports="hidden"});var FO=u((_Ne,NO)=>{"use strict";NO.exports="pause"});var GO=u((INe,kO)=>{"use strict";kO.exports="postrender"});var WO=u((LNe,qO)=>{"use strict";qO.exports="poststep"});var HO=u((MNe,YO)=>{"use strict";YO.exports="prerender"});var VO=u((ONe,zO)=>{"use strict";zO.exports="prestep"});var KO=u((DNe,XO)=>{"use strict";XO.exports="ready"});var jO=u((BNe,ZO)=>{"use strict";ZO.exports="resume"});var JO=u((UNe,$O)=>{"use strict";$O.exports="step"});var eD=u((NNe,QO)=>{"use strict";QO.exports="systemready"});var iD=u((FNe,tD)=>{"use strict";tD.exports="visible"});var vi=u((kNe,sD)=>{"use strict";sD.exports={BLUR:wO(),BOOT:PO(),CONTEXT_LOST:IO(),DESTROY:MO(),FOCUS:DO(),HIDDEN:UO(),PAUSE:FO(),POST_RENDER:GO(),POST_STEP:WO(),PRE_RENDER:HO(),PRE_STEP:VO(),READY:KO(),RESUME:jO(),STEP:JO(),SYSTEM_READY:eD(),VISIBLE:iD()}});var Ie=u((GNe,rD)=>{"use strict";var Gne=function(){};rD.exports=Gne});var bp=u((qNe,nD)=>{"use strict";var qne=R(),Tu=Zl(),Wne=nt(),rr=Ie(),Yne=new qne({initialize:function(e){this.manager=e,this.preventDefaultDown=!0,this.preventDefaultUp=!0,this.preventDefaultMove=!0,this.preventDefaultWheel=!1,this.enabled=!1,this.target,this.locked=!1,this.onMouseMove=rr,this.onMouseDown=rr,this.onMouseUp=rr,this.onMouseDownWindow=rr,this.onMouseUpWindow=rr,this.onMouseOver=rr,this.onMouseOut=rr,this.onMouseWheel=rr,this.pointerLockChange=rr,this.isTop=!0,e.events.once(Wne.MANAGER_BOOT,this.boot,this)},boot:function(){var t=this.manager.config;this.enabled=t.inputMouse,this.target=t.inputMouseEventTarget,this.passive=t.inputMousePassive,this.preventDefaultDown=t.inputMousePreventDefaultDown,this.preventDefaultUp=t.inputMousePreventDefaultUp,this.preventDefaultMove=t.inputMousePreventDefaultMove,this.preventDefaultWheel=t.inputMousePreventDefaultWheel,this.target?typeof this.target=="string"&&(this.target=document.getElementById(this.target)):this.target=this.manager.game.canvas,t.disableContextMenu&&this.disableContextMenu(),this.enabled&&this.target&&this.startListeners()},disableContextMenu:function(){return this.target.addEventListener("contextmenu",function(t){return t.preventDefault(),!1}),this},requestPointerLock:function(){if(Tu.pointerLock){var t=this.target;t.requestPointerLock=t.requestPointerLock||t.mozRequestPointerLock||t.webkitRequestPointerLock,t.requestPointerLock()}},releasePointerLock:function(){Tu.pointerLock&&(document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,document.exitPointerLock())},startListeners:function(){var t=this.target;if(t){var e=this,i=this.manager,s=i.canvas,r=window&&window.focus&&i.game.config.autoFocus;this.onMouseMove=function(a){!a.defaultPrevented&&e.enabled&&i&&i.enabled&&(i.onMouseMove(a),e.preventDefaultMove&&a.preventDefault())},this.onMouseDown=function(a){r&&window.focus(),!a.defaultPrevented&&e.enabled&&i&&i.enabled&&(i.onMouseDown(a),e.preventDefaultDown&&a.target===s&&a.preventDefault())},this.onMouseDownWindow=function(a){a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||!a.defaultPrevented&&e.enabled&&i&&i.enabled&&a.target!==s&&i.onMouseDown(a)},this.onMouseUp=function(a){!a.defaultPrevented&&e.enabled&&i&&i.enabled&&(i.onMouseUp(a),e.preventDefaultUp&&a.target===s&&a.preventDefault())},this.onMouseUpWindow=function(a){a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||!a.defaultPrevented&&e.enabled&&i&&i.enabled&&a.target!==s&&i.onMouseUp(a)},this.onMouseOver=function(a){!a.defaultPrevented&&e.enabled&&i&&i.enabled&&i.setCanvasOver(a)},this.onMouseOut=function(a){!a.defaultPrevented&&e.enabled&&i&&i.enabled&&i.setCanvasOut(a)},this.onMouseWheel=function(a){!a.defaultPrevented&&e.enabled&&i&&i.enabled&&i.onMouseWheel(a),e.preventDefaultWheel&&a.target===s&&a.preventDefault()};var n={passive:!0};if(t.addEventListener("mousemove",this.onMouseMove),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("mouseup",this.onMouseUp),t.addEventListener("mouseover",this.onMouseOver,n),t.addEventListener("mouseout",this.onMouseOut,n),this.preventDefaultWheel?t.addEventListener("wheel",this.onMouseWheel,{passive:!1}):t.addEventListener("wheel",this.onMouseWheel,n),window&&i.game.config.inputWindowEvents)try{window.top.addEventListener("mousedown",this.onMouseDownWindow,n),window.top.addEventListener("mouseup",this.onMouseUpWindow,n)}catch{window.addEventListener("mousedown",this.onMouseDownWindow,n),window.addEventListener("mouseup",this.onMouseUpWindow,n),this.isTop=!1}Tu.pointerLock&&(this.pointerLockChange=function(a){var o=e.target;e.locked=document.pointerLockElement===o||document.mozPointerLockElement===o||document.webkitPointerLockElement===o,i.onPointerLockChange(a)},document.addEventListener("pointerlockchange",this.pointerLockChange,!0),document.addEventListener("mozpointerlockchange",this.pointerLockChange,!0),document.addEventListener("webkitpointerlockchange",this.pointerLockChange,!0)),this.enabled=!0}},stopListeners:function(){var t=this.target;t.removeEventListener("mousemove",this.onMouseMove),t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("mouseup",this.onMouseUp),t.removeEventListener("mouseover",this.onMouseOver),t.removeEventListener("mouseout",this.onMouseOut),window&&(t=this.isTop?window.top:window,t.removeEventListener("mousedown",this.onMouseDownWindow),t.removeEventListener("mouseup",this.onMouseUpWindow)),Tu.pointerLock&&(document.removeEventListener("pointerlockchange",this.pointerLockChange,!0),document.removeEventListener("mozpointerlockchange",this.pointerLockChange,!0),document.removeEventListener("webkitpointerlockchange",this.pointerLockChange,!0))},destroy:function(){this.stopListeners(),this.target=null,this.enabled=!1,this.manager=null}});nD.exports=Yne});var Ap=u((WNe,aD)=>{"use strict";var Hne=function(t,e,i,s){return Math.atan2(s-e,i-t)};aD.exports=Hne});var dh=u((YNe,oD)=>{"use strict";var zne=function(t,e,i,s){var r=t-i,n=e-s;return Math.sqrt(r*r+n*n)};oD.exports=zne});var xp=u((HNe,hD)=>{"use strict";var Vne=function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e),t*t*(3-2*t))};hD.exports=Vne});var Cp=u((zNe,lD)=>{"use strict";var Xne=xp(),Kne=function(t,e,i){return e+(i-e)*Xne(t,0,1)};lD.exports=Kne});var Rp=u((VNe,dD)=>{"use strict";var wp=Ap(),Zne=R(),uD=dh(),cD=Ff(),yu=Cp(),bu=Fe(),jne=La(),$ne=new Zne({initialize:function(e,i){this.manager=e,this.id=i,this.event,this.downElement,this.upElement,this.camera=null,this.button=0,this.buttons=0,this.position=new bu,this.prevPosition=new bu,this.midPoint=new bu(-1,-1),this.velocity=new bu,this.angle=0,this.distance=0,this.smoothFactor=0,this.motionFactor=.2,this.worldX=0,this.worldY=0,this.moveTime=0,this.downX=0,this.downY=0,this.downTime=0,this.upX=0,this.upY=0,this.upTime=0,this.primaryDown=!1,this.isDown=!1,this.wasTouch=!1,this.wasCanceled=!1,this.movementX=0,this.movementY=0,this.identifier=0,this.pointerId=null,this.active=i===0,this.locked=!1,this.deltaX=0,this.deltaY=0,this.deltaZ=0},updateWorldPoint:function(t){var e=t.getWorldPoint(this.x,this.y);return this.worldX=e.x,this.worldY=e.y,this},positionToCamera:function(t,e){return t.getWorldPoint(this.x,this.y,e)},updateMotion:function(){var t=this.position.x,e=this.position.y,i=this.midPoint.x,s=this.midPoint.y;if(!(t===i&&e===s)){var r=yu(this.motionFactor,i,t),n=yu(this.motionFactor,s,e);cD(r,t,.1)&&(r=t),cD(n,e,.1)&&(n=e),this.midPoint.set(r,n);var a=t-r,o=e-n;this.velocity.set(a,o),this.angle=wp(r,n,t,e),this.distance=Math.sqrt(a*a+o*o)}},up:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.button=t.button,this.upElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),t.button===0&&(this.primaryDown=!1,this.upX=this.x,this.upY=this.y),this.buttons===0&&(this.isDown=!1,this.upTime=t.timeStamp,this.wasTouch=!1)},down:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.button=t.button,this.downElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),t.button===0&&(this.primaryDown=!0,this.downX=this.x,this.downY=this.y),jne.macOS&&t.ctrlKey&&(this.buttons=2,this.primaryDown=!1),this.isDown||(this.isDown=!0,this.downTime=t.timeStamp),this.wasTouch=!1},move:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.manager.transformPointer(this,t.pageX,t.pageY,!0),this.locked&&(this.movementX=t.movementX||t.mozMovementX||t.webkitMovementX||0,this.movementY=t.movementY||t.mozMovementY||t.webkitMovementY||0),this.moveTime=t.timeStamp,this.wasTouch=!1},wheel:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.deltaX=t.deltaX,this.deltaY=t.deltaY,this.deltaZ=t.deltaZ,this.wasTouch=!1},touchstart:function(t,e){t.pointerId&&(this.pointerId=t.pointerId),this.identifier=t.identifier,this.target=t.target,this.active=!0,this.buttons=1,this.event=e,this.downElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.primaryDown=!0,this.downX=this.x,this.downY=this.y,this.downTime=e.timeStamp,this.isDown=!0,this.wasTouch=!0,this.wasCanceled=!1,this.updateMotion()},touchmove:function(t,e){this.event=e,this.manager.transformPointer(this,t.pageX,t.pageY,!0),this.moveTime=e.timeStamp,this.wasTouch=!0,this.updateMotion()},touchend:function(t,e){this.buttons=0,this.event=e,this.upElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.primaryDown=!1,this.upX=this.x,this.upY=this.y,this.upTime=e.timeStamp,this.isDown=!1,this.wasTouch=!0,this.wasCanceled=!1,this.active=!1,this.updateMotion()},touchcancel:function(t,e){this.buttons=0,this.event=e,this.upElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.primaryDown=!1,this.upX=this.x,this.upY=this.y,this.upTime=e.timeStamp,this.isDown=!1,this.wasTouch=!0,this.wasCanceled=!0,this.active=!1},noButtonDown:function(){return this.buttons===0},leftButtonDown:function(){return!!(this.buttons&1)},rightButtonDown:function(){return!!(this.buttons&2)},middleButtonDown:function(){return!!(this.buttons&4)},backButtonDown:function(){return!!(this.buttons&8)},forwardButtonDown:function(){return!!(this.buttons&16)},leftButtonReleased:function(){return this.buttons===0?this.button===0&&!this.isDown:this.button===0},rightButtonReleased:function(){return this.buttons===0?this.button===2&&!this.isDown:this.button===2},middleButtonReleased:function(){return this.buttons===0?this.button===1&&!this.isDown:this.button===1},backButtonReleased:function(){return this.buttons===0?this.button===3&&!this.isDown:this.button===3},forwardButtonReleased:function(){return this.buttons===0?this.button===4&&!this.isDown:this.button===4},getDistance:function(){return this.isDown?uD(this.downX,this.downY,this.x,this.y):uD(this.downX,this.downY,this.upX,this.upY)},getDistanceX:function(){return this.isDown?Math.abs(this.downX-this.x):Math.abs(this.downX-this.upX)},getDistanceY:function(){return this.isDown?Math.abs(this.downY-this.y):Math.abs(this.downY-this.upY)},getDuration:function(){return this.isDown?this.manager.time-this.downTime:this.upTime-this.downTime},getAngle:function(){return this.isDown?wp(this.downX,this.downY,this.x,this.y):wp(this.downX,this.downY,this.upX,this.upY)},getInterpolatedPosition:function(t,e){t===void 0&&(t=10),e===void 0&&(e=[]);for(var i=this.prevPosition.x,s=this.prevPosition.y,r=this.position.x,n=this.position.y,a=0;a<t;a++){var o=1/t*a;e[a]={x:yu(o,i,r),y:yu(o,s,n)}}return e},reset:function(){this.event=null,this.downElement=null,this.upElement=null,this.button=0,this.buttons=0,this.position.set(0,0),this.prevPosition.set(0,0),this.midPoint.set(-1,-1),this.velocity.set(0,0),this.angle=0,this.distance=0,this.worldX=0,this.worldY=0,this.downX=0,this.downY=0,this.upX=0,this.upY=0,this.moveTime=0,this.upTime=0,this.downTime=0,this.primaryDown=!1,this.isDown=!1,this.wasTouch=!1,this.wasCanceled=!1,this.movementX=0,this.movementY=0,this.identifier=0,this.pointerId=null,this.deltaX=0,this.deltaY=0,this.deltaZ=0,this.active=this.id===0},destroy:function(){this.camera=null,this.manager=null,this.position=null},x:{get:function(){return this.position.x},set:function(t){this.position.x=t}},y:{get:function(){return this.position.y},set:function(t){this.position.y=t}},time:{get:function(){return this.event?this.event.timeStamp:0}}});dD.exports=$ne});var Pp=u((XNe,fD)=>{"use strict";var Jne=R(),Qne=nt(),Ln=Ie(),eae=new Jne({initialize:function(e){this.manager=e,this.capture=!0,this.enabled=!1,this.target,this.onTouchStart=Ln,this.onTouchStartWindow=Ln,this.onTouchMove=Ln,this.onTouchEnd=Ln,this.onTouchEndWindow=Ln,this.onTouchCancel=Ln,this.onTouchCancelWindow=Ln,this.isTop=!0,e.events.once(Qne.MANAGER_BOOT,this.boot,this)},boot:function(){var t=this.manager.config;this.enabled=t.inputTouch,this.target=t.inputTouchEventTarget,this.capture=t.inputTouchCapture,this.target?typeof this.target=="string"&&(this.target=document.getElementById(this.target)):this.target=this.manager.game.canvas,t.disableContextMenu&&this.disableContextMenu(),this.enabled&&this.target&&this.startListeners()},disableContextMenu:function(){return this.target.addEventListener("contextmenu",function(t){return t.preventDefault(),!1}),this},startListeners:function(){var t=this.target;if(t){var e=this,i=this.manager,s=i.canvas,r=window&&window.focus&&i.game.config.autoFocus;this.onTouchMove=function(h){!h.defaultPrevented&&e.enabled&&i&&i.enabled&&(i.onTouchMove(h),e.capture&&h.cancelable&&h.preventDefault())},this.onTouchStart=function(h){r&&window.focus(),!h.defaultPrevented&&e.enabled&&i&&i.enabled&&(i.onTouchStart(h),e.capture&&h.cancelable&&h.target===s&&h.preventDefault())},this.onTouchStartWindow=function(h){!h.defaultPrevented&&e.enabled&&i&&i.enabled&&h.target!==s&&i.onTouchStart(h)},this.onTouchEnd=function(h){!h.defaultPrevented&&e.enabled&&i&&i.enabled&&(i.onTouchEnd(h),e.capture&&h.cancelable&&h.target===s&&h.preventDefault())},this.onTouchEndWindow=function(h){!h.defaultPrevented&&e.enabled&&i&&i.enabled&&h.target!==s&&i.onTouchEnd(h)},this.onTouchCancel=function(h){!h.defaultPrevented&&e.enabled&&i&&i.enabled&&(i.onTouchCancel(h),e.capture&&h.preventDefault())},this.onTouchCancelWindow=function(h){!h.defaultPrevented&&e.enabled&&i&&i.enabled&&i.onTouchCancel(h)};var n=this.capture,a={passive:!0},o={passive:!1};if(t.addEventListener("touchstart",this.onTouchStart,n?o:a),t.addEventListener("touchmove",this.onTouchMove,n?o:a),t.addEventListener("touchend",this.onTouchEnd,n?o:a),t.addEventListener("touchcancel",this.onTouchCancel,n?o:a),window&&i.game.config.inputWindowEvents)try{window.top.addEventListener("touchstart",this.onTouchStartWindow,o),window.top.addEventListener("touchend",this.onTouchEndWindow,o),window.top.addEventListener("touchcancel",this.onTouchCancelWindow,o)}catch{window.addEventListener("touchstart",this.onTouchStartWindow,o),window.addEventListener("touchend",this.onTouchEndWindow,o),window.addEventListener("touchcancel",this.onTouchCancelWindow,o),this.isTop=!1}this.enabled=!0}},stopListeners:function(){var t=this.target;t.removeEventListener("touchstart",this.onTouchStart),t.removeEventListener("touchmove",this.onTouchMove),t.removeEventListener("touchend",this.onTouchEnd),t.removeEventListener("touchcancel",this.onTouchCancel),window&&(t=this.isTop?window.top:window,t.removeEventListener("touchstart",this.onTouchStartWindow),t.removeEventListener("touchend",this.onTouchEndWindow),t.removeEventListener("touchcancel",this.onTouchCancelWindow))},destroy:function(){this.stopListeners(),this.target=null,this.enabled=!1,this.manager=null}});fD.exports=eae});var _p=u((KNe,vD)=>{"use strict";var tae=R(),Fr=Eu(),iae=ze(),fh=nt(),Au=vi(),sae=bp(),pD=Rp(),rae=Pp(),mD=ws(),nae=Wf(),aae=new tae({initialize:function(e,i){this.game=e,this.scaleManager,this.canvas,this.config=i,this.enabled=!0,this.events=new iae,this.isOver=!0,this.defaultCursor="",this.keyboard=null,this.mouse=i.inputMouse?new sae(this):null,this.touch=i.inputTouch?new rae(this):null,this.pointers=[],this.pointersTotal=i.inputActivePointers;for(var s=0;s<=this.pointersTotal;s++){var r=new pD(this,s);r.smoothFactor=i.inputSmoothFactor,this.pointers.push(r)}this.mousePointer=i.inputMouse?this.pointers[0]:null,this.activePointer=this.pointers[0],this.globalTopOnly=!0,this.time=0,this._tempPoint={x:0,y:0},this._tempHitTest=[],this._tempMatrix=new mD,this._tempMatrix2=new mD,this._tempSkip=!1,this.mousePointerContainer=[this.mousePointer],e.events.once(Au.BOOT,this.boot,this)},boot:function(){var t=this.game,e=t.events;this.canvas=t.canvas,this.scaleManager=t.scale,this.events.emit(fh.MANAGER_BOOT),e.on(Au.PRE_RENDER,this.preRender,this),e.once(Au.DESTROY,this.destroy,this)},setCanvasOver:function(t){this.isOver=!0,this.events.emit(fh.GAME_OVER,t)},setCanvasOut:function(t){this.isOver=!1,this.events.emit(fh.GAME_OUT,t)},preRender:function(){var t=this.game.loop.now,e=this.game.loop.delta,i=this.game.scene.getScenes(!0,!0);this.time=t,this.events.emit(fh.MANAGER_UPDATE);for(var s=0;s<i.length;s++){var r=i[s];if(r.sys.input&&r.sys.input.updatePoll(t,e)&&this.globalTopOnly)return}},setDefaultCursor:function(t){this.defaultCursor=t,this.canvas.style.cursor!==t&&(this.canvas.style.cursor=t)},setCursor:function(t){t.cursor&&(this.canvas.style.cursor=t.cursor)},resetCursor:function(t,e){(e||t&&t.cursor)&&this.canvas&&(this.canvas.style.cursor=this.defaultCursor)},addPointer:function(t){t===void 0&&(t=1);var e=[];this.pointersTotal+t>10&&(t=10-this.pointersTotal);for(var i=0;i<t;i++){var s=this.pointers.length,r=new pD(this,s);r.smoothFactor=this.config.inputSmoothFactor,this.pointers.push(r),this.pointersTotal++,e.push(r)}return e},updateInputPlugins:function(t,e){var i=this.game.scene.getScenes(!1,!0);this._tempSkip=!1;for(var s=0;s<i.length;s++){var r=i[s];if(r.sys.input){var n=r.sys.input.update(t,e);if(n&&this.globalTopOnly||this._tempSkip)return}}},onTouchStart:function(t){for(var e=this.pointers,i=[],s=0;s<t.changedTouches.length;s++)for(var r=t.changedTouches[s],n=1;n<e.length;n++){var a=e[n];if(!a.active){a.touchstart(r,t),this.activePointer=a,i.push(a);break}}this.updateInputPlugins(Fr.TOUCH_START,i)},onTouchMove:function(t){for(var e=this.pointers,i=[],s=0;s<t.changedTouches.length;s++)for(var r=t.changedTouches[s],n=1;n<e.length;n++){var a=e[n];if(a.active&&a.identifier===r.identifier){var o=document.elementFromPoint(r.clientX,r.clientY),h=o===this.canvas;!this.isOver&&h?this.setCanvasOver(t):this.isOver&&!h&&this.setCanvasOut(t),this.isOver&&(a.touchmove(r,t),this.activePointer=a,i.push(a));break}}this.updateInputPlugins(Fr.TOUCH_MOVE,i)},onTouchEnd:function(t){for(var e=this.pointers,i=[],s=0;s<t.changedTouches.length;s++)for(var r=t.changedTouches[s],n=1;n<e.length;n++){var a=e[n];if(a.active&&a.identifier===r.identifier){a.touchend(r,t),i.push(a);break}}this.updateInputPlugins(Fr.TOUCH_END,i)},onTouchCancel:function(t){for(var e=this.pointers,i=[],s=0;s<t.changedTouches.length;s++)for(var r=t.changedTouches[s],n=1;n<e.length;n++){var a=e[n];if(a.active&&a.identifier===r.identifier){a.touchcancel(r,t),i.push(a);break}}this.updateInputPlugins(Fr.TOUCH_CANCEL,i)},onMouseDown:function(t){var e=this.mousePointer;e.down(t),e.updateMotion(),this.activePointer=e,this.updateInputPlugins(Fr.MOUSE_DOWN,this.mousePointerContainer)},onMouseMove:function(t){var e=this.mousePointer;e.move(t),e.updateMotion(),this.activePointer=e,this.updateInputPlugins(Fr.MOUSE_MOVE,this.mousePointerContainer)},onMouseUp:function(t){var e=this.mousePointer;e.up(t),e.updateMotion(),this.activePointer=e,this.updateInputPlugins(Fr.MOUSE_UP,this.mousePointerContainer)},onMouseWheel:function(t){var e=this.mousePointer;e.wheel(t),this.activePointer=e,this.updateInputPlugins(Fr.MOUSE_WHEEL,this.mousePointerContainer)},onPointerLockChange:function(t){var e=this.mouse.locked;this.mousePointer.locked=e,this.events.emit(fh.POINTERLOCK_CHANGE,t,e)},inputCandidate:function(t,e){var i=t.input;if(!i||!i.enabled||!t.willRender(e))return!1;var s=!0,r=t.parentContainer;if(r)do{if(!r.willRender(e)){s=!1;break}r=r.parentContainer}while(r);return s},hitTest:function(t,e,i,s){s===void 0&&(s=this._tempHitTest);var r=this._tempPoint,n=i.scrollX,a=i.scrollY;s.length=0;var o=t.x,h=t.y;i.getWorldPoint(o,h,r),t.worldX=r.x,t.worldY=r.y;for(var l={x:0,y:0},c=this._tempMatrix,d=this._tempMatrix2,f=0;f<e.length;f++){var p=e[f];if(this.inputCandidate(p,i)){var m=r.x+n*p.scrollFactorX-n,v=r.y+a*p.scrollFactorY-a;p.parentContainer?(p.getWorldTransformMatrix(c,d),c.applyInverse(m,v,l)):nae(m,v,p.x,p.y,p.rotation,p.scaleX,p.scaleY,l),this.pointWithinHitArea(p,l.x,l.y)&&s.push(p)}}return s},pointWithinHitArea:function(t,e,i){e+=t.displayOriginX,i+=t.displayOriginY;var s=t.input;return s&&s.hitAreaCallback(s.hitArea,e,i,t)?(s.localX=e,s.localY=i,!0):!1},pointWithinInteractiveObject:function(t,e,i){return t.hitArea?(e+=t.gameObject.displayOriginX,i+=t.gameObject.displayOriginY,t.localX=e,t.localY=i,t.hitAreaCallback(t.hitArea,e,i,t)):!1},transformPointer:function(t,e,i,s){var r=t.position,n=t.prevPosition;n.x=r.x,n.y=r.y;var a=this.scaleManager.transformX(e),o=this.scaleManager.transformY(i),h=t.smoothFactor;!s||h===0?(r.x=a,r.y=o):(r.x=a*h+n.x*(1-h),r.y=o*h+n.y*(1-h))},destroy:function(){this.events.removeAllListeners(),this.game.events.off(Au.PRE_RENDER),this.keyboard&&this.keyboard.destroy(),this.mouse&&this.mouse.destroy(),this.touch&&this.touch.destroy();for(var t=0;t<this.pointers.length;t++)this.pointers[t].destroy();this.pointers=[],this._tempHitTest=[],this._tempMatrix.destroy(),this.canvas=null,this.game=null}});vD.exports=aae});var Ip=u((ZNe,gD)=>{"use strict";var oae=Ne(),nr={},ph={};ph.register=function(t,e,i,s,r){nr[t]={plugin:e,mapping:i,settingsKey:s,configKey:r}};ph.getPlugin=function(t){return nr[t]};ph.install=function(t){var e=t.scene.sys,i=e.settings.input,s=e.game.config;for(var r in nr){var n=nr[r].plugin,a=nr[r].mapping,o=nr[r].settingsKey,h=nr[r].configKey;oae(i,o,s[h])&&(t[a]=new n(t))}};ph.remove=function(t){nr.hasOwnProperty(t)&&delete nr[t]};gD.exports=ph});var AD=u((jNe,bD)=>{"use strict";var hae=R(),kr=Eu(),SD=yp(),lae=Tp(),uae=dh(),V=nt(),Lp=ze(),Gr=re(),ka=_n(),cae=Ip(),dae=Xt(),fae=Vt(),ED=Ze(),TD=Pn(),ni=qe(),yD=new hae({Extends:Lp,initialize:function(e){Lp.call(this),this.scene=e,this.systems=e.sys,this.settings=e.sys.settings,this.manager=e.sys.game.input,this.pluginEvents=new Lp,this.enabled=!0,this.displayList,this.cameras,cae.install(this),this.mouse=this.manager.mouse,this.topOnly=!0,this.pollRate=-1,this._pollTimer=0;var i={cancelled:!1};this._eventContainer={stopPropagation:function(){i.cancelled=!0}},this._eventData=i,this.dragDistanceThreshold=0,this.dragTimeThreshold=0,this._temp=[],this._tempZones=[],this._list=[],this._pendingInsertion=[],this._pendingRemoval=[],this._draggable=[],this._drag={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[],10:[]},this._dragState=[],this._over={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[],10:[]},this._validTypes=["onDown","onUp","onOver","onOut","onMove","onDragStart","onDrag","onDragEnd","onDragEnter","onDragLeave","onDragOver","onDrop"],this._updatedThisFrame=!1,e.sys.events.once(ni.BOOT,this.boot,this),e.sys.events.on(ni.START,this.start,this)},boot:function(){this.cameras=this.systems.cameras,this.displayList=this.systems.displayList,this.systems.events.once(ni.DESTROY,this.destroy,this),this.pluginEvents.emit(V.BOOT)},start:function(){var t=this.systems.events;t.on(ni.TRANSITION_START,this.transitionIn,this),t.on(ni.TRANSITION_OUT,this.transitionOut,this),t.on(ni.TRANSITION_COMPLETE,this.transitionComplete,this),t.on(ni.PRE_UPDATE,this.preUpdate,this),t.once(ni.SHUTDOWN,this.shutdown,this),this.manager.events.on(V.GAME_OUT,this.onGameOut,this),this.manager.events.on(V.GAME_OVER,this.onGameOver,this),this.enabled=!0,this._dragState=[0,0,0,0,0,0,0,0,0,0],this.pluginEvents.emit(V.START)},onGameOver:function(t){this.isActive()&&this.emit(V.GAME_OVER,t.timeStamp,t)},onGameOut:function(t){this.isActive()&&this.emit(V.GAME_OUT,t.timeStamp,t)},preUpdate:function(){this.pluginEvents.emit(V.PRE_UPDATE);var t=this._pendingRemoval,e=this._pendingInsertion,i=t.length,s=e.length;if(!(i===0&&s===0)){for(var r=this._list,n=0;n<i;n++){var a=t[n],o=r.indexOf(a);o>-1&&(r.splice(o,1),this.clear(a,!0))}this._pendingRemoval.length=0,this._list=r.concat(e.splice(0))}},isActive:function(){return this.manager&&this.manager.enabled&&this.enabled&&this.scene.sys.canInput()},setCursor:function(t){this.manager&&this.manager.setCursor(t)},resetCursor:function(){this.manager&&this.manager.resetCursor(null,!0)},updatePoll:function(t,e){if(!this.isActive())return!1;if(this.pluginEvents.emit(V.UPDATE,t,e),this._updatedThisFrame)return this._updatedThisFrame=!1,!1;var i,s=this.manager,r=s.pointers;for(i=0;i<r.length;i++)r[i].updateMotion();if(this._list.length===0)return!1;var n=this.pollRate;if(n===-1)return!1;if(n>0)if(this._pollTimer-=e,this._pollTimer<0)this._pollTimer=this.pollRate;else return!1;var a=!1;for(i=0;i<r.length;i++){var o=0,h=r[i];this._tempZones=[],this._temp=this.hitTestPointer(h),this.sortGameObjects(this._temp,h),this.sortDropZones(this._tempZones),this.topOnly&&(this._temp.length&&this._temp.splice(1),this._tempZones.length&&this._tempZones.splice(1)),o+=this.processOverOutEvents(h),this.getDragState(h)===2&&this.processDragThresholdEvent(h,t),o>0&&(a=!0)}return a},update:function(t,e){if(!this.isActive())return!1;for(var i=!1,s=0;s<e.length;s++){var r=0,n=e[s];switch(this._tempZones=[],this._temp=this.hitTestPointer(n),this.sortGameObjects(this._temp,n),this.sortDropZones(this._tempZones),this.topOnly&&(this._temp.length&&this._temp.splice(1),this._tempZones.length&&this._tempZones.splice(1)),t){case kr.MOUSE_DOWN:r+=this.processDragDownEvent(n),r+=this.processDownEvents(n),r+=this.processOverOutEvents(n);break;case kr.MOUSE_UP:r+=this.processDragUpEvent(n),r+=this.processUpEvents(n),r+=this.processOverOutEvents(n);break;case kr.TOUCH_START:r+=this.processDragDownEvent(n),r+=this.processDownEvents(n),r+=this.processOverEvents(n);break;case kr.TOUCH_END:case kr.TOUCH_CANCEL:r+=this.processDragUpEvent(n),r+=this.processUpEvents(n),r+=this.processOutEvents(n);break;case kr.MOUSE_MOVE:case kr.TOUCH_MOVE:r+=this.processDragMoveEvent(n),r+=this.processMoveEvents(n),r+=this.processOverOutEvents(n);break;case kr.MOUSE_WHEEL:r+=this.processWheelEvent(n);break}r>0&&(i=!0)}return this._updatedThisFrame=!0,i},clear:function(t,e){e===void 0&&(e=!1),this.disable(t);var i=t.input;i&&(this.removeDebug(t),this.manager.resetCursor(i),i.gameObject=void 0,i.target=void 0,i.hitArea=void 0,i.hitAreaCallback=void 0,i.callbackContext=void 0,t.input=null),e||this.queueForRemoval(t);var s=this._draggable.indexOf(t);return s>-1&&this._draggable.splice(s,1),t},disable:function(t,e){e===void 0&&(e=!1);var i=t.input;i&&(i.enabled=!1,i.dragState=0);for(var s=this._drag,r=this._over,n=this.manager,a=0,o;a<n.pointers.length;a++)o=s[a].indexOf(t),o>-1&&s[a].splice(o,1),o=r[a].indexOf(t),o>-1&&r[a].splice(o,1);return e&&this.resetCursor(),this},enable:function(t,e,i,s){return s===void 0&&(s=!1),t.input?t.input.enabled=!0:this.setHitArea(t,e,i),t.input&&s&&!t.input.dropZone&&(t.input.dropZone=s),this},hitTestPointer:function(t){for(var e=this.cameras.getCamerasBelowPointer(t),i=0;i<e.length;i++){for(var s=e[i],r=this.manager.hitTest(t,this._list,s),n=0;n<r.length;n++){var a=r[n];a.input.dropZone&&this._tempZones.push(a)}if(r.length>0)return t.camera=s,r}return t.camera=e[0],[]},processDownEvents:function(t){var e=0,i=this._temp,s=this._eventData,r=this._eventContainer;s.cancelled=!1;for(var n=0;n<i.length;n++){var a=i[n];if(!(!a.input||!a.input.enabled)&&(e++,a.emit(V.GAMEOBJECT_POINTER_DOWN,t,a.input.localX,a.input.localY,r),s.cancelled||!this.isActive()||a.input&&a.input.enabled&&(this.emit(V.GAMEOBJECT_DOWN,t,a,r),s.cancelled||!this.isActive())))break}return!s.cancelled&&this.isActive()&&(t.downElement===this.manager.game.canvas?this.emit(V.POINTER_DOWN,t,i):this.emit(V.POINTER_DOWN_OUTSIDE,t)),e},getDragState:function(t){return this._dragState[t.id]},setDragState:function(t,e){this._dragState[t.id]=e},processDragThresholdEvent:function(t,e){var i=!1,s=this.dragTimeThreshold,r=this.dragDistanceThreshold;if((r>0&&uae(t.x,t.y,t.downX,t.downY)>=r||s>0&&e>=t.downTime+s)&&(i=!0),i)return this.setDragState(t,3),this.processDragStartList(t)},processDragStartList:function(t){if(this.getDragState(t)!==3)return 0;var e=this._drag[t.id];e.length>1&&(e=e.slice(0));for(var i=0;i<e.length;i++){var s=e[i],r=s.input;r.dragState=2,r.dragStartX=s.x,r.dragStartY=s.y,r.dragStartXGlobal=t.worldX,r.dragStartYGlobal=t.worldY,r.dragStartCamera=t.camera,r.dragX=r.dragStartXGlobal-r.dragStartX,r.dragY=r.dragStartYGlobal-r.dragStartY,s.emit(V.GAMEOBJECT_DRAG_START,t,r.dragX,r.dragY),this.emit(V.DRAG_START,t,s)}return this.setDragState(t,4),e.length},processDragDownEvent:function(t){var e=this._temp;if(this._draggable.length===0||e.length===0||!t.primaryDown||this.getDragState(t)!==0)return 0;this.setDragState(t,1);for(var i=[],s=0;s<e.length;s++){var r=e[s];r.input.draggable&&r.input.dragState===0&&i.push(r)}return i.length===0?(this.setDragState(t,0),0):(i.length>1&&(this.sortGameObjects(i,t),this.topOnly&&i.splice(1)),this._drag[t.id]=i,this.dragDistanceThreshold===0&&this.dragTimeThreshold===0?(this.setDragState(t,3),this.processDragStartList(t)):(this.setDragState(t,2),0))},processDragMoveEvent:function(t){if(this.getDragState(t)===2&&this.processDragThresholdEvent(t,this.manager.game.loop.now),this.getDragState(t)!==4)return 0;var e=this._tempZones,i=this._drag[t.id];i.length>1&&(i=i.slice(0));for(var s=0;s<i.length;s++){var r=i[s],n=r.input,a=n.target;if(a){var o=e.indexOf(a);o===0?(r.emit(V.GAMEOBJECT_DRAG_OVER,t,a),this.emit(V.DRAG_OVER,t,r,a)):o>0?(r.emit(V.GAMEOBJECT_DRAG_LEAVE,t,a),this.emit(V.DRAG_LEAVE,t,r,a),n.target=e[0],a=n.target,r.emit(V.GAMEOBJECT_DRAG_ENTER,t,a),this.emit(V.DRAG_ENTER,t,r,a)):(r.emit(V.GAMEOBJECT_DRAG_LEAVE,t,a),this.emit(V.DRAG_LEAVE,t,r,a),e[0]?(n.target=e[0],a=n.target,r.emit(V.GAMEOBJECT_DRAG_ENTER,t,a),this.emit(V.DRAG_ENTER,t,r,a)):n.target=null)}else!a&&e[0]&&(n.target=e[0],a=n.target,r.emit(V.GAMEOBJECT_DRAG_ENTER,t,a),this.emit(V.DRAG_ENTER,t,r,a));var h,l,c=t.positionToCamera(n.dragStartCamera);if(!r.parentContainer)h=c.x-n.dragX,l=c.y-n.dragY;else{var d=c.x-n.dragStartXGlobal,f=c.y-n.dragStartYGlobal,p=r.getParentRotation(),m=d*Math.cos(p)+f*Math.sin(p),v=f*Math.cos(p)-d*Math.sin(p);m*=1/r.parentContainer.scaleX,v*=1/r.parentContainer.scaleY,h=m+n.dragStartX,l=v+n.dragStartY}r.emit(V.GAMEOBJECT_DRAG,t,h,l),this.emit(V.DRAG,t,r,h,l)}return i.length},processDragUpEvent:function(t){var e=this._drag[t.id];e.length>1&&(e=e.slice(0));for(var i=0;i<e.length;i++){var s=e[i],r=s.input;if(r&&r.dragState===2){r.dragState=0,r.dragX=r.localX-s.displayOriginX,r.dragY=r.localY-s.displayOriginY,r.dragStartCamera=null;var n=!1,a=r.target;a&&(s.emit(V.GAMEOBJECT_DROP,t,a),this.emit(V.DROP,t,s,a),r.target=null,n=!0),s.input&&s.input.enabled&&(s.emit(V.GAMEOBJECT_DRAG_END,t,r.dragX,r.dragY,n),this.emit(V.DRAG_END,t,s,n))}}return this.setDragState(t,0),e.splice(0),0},processMoveEvents:function(t){var e=0,i=this._temp,s=this._eventData,r=this._eventContainer;s.cancelled=!1;for(var n=0;n<i.length;n++){var a=i[n];if(!(!a.input||!a.input.enabled)&&(e++,a.emit(V.GAMEOBJECT_POINTER_MOVE,t,a.input.localX,a.input.localY,r),s.cancelled||!this.isActive()||a.input&&a.input.enabled&&(this.emit(V.GAMEOBJECT_MOVE,t,a,r),s.cancelled||!this.isActive()||this.topOnly)))break}return!s.cancelled&&this.isActive()&&this.emit(V.POINTER_MOVE,t,i),e},processWheelEvent:function(t){var e=0,i=this._temp,s=this._eventData,r=this._eventContainer;s.cancelled=!1;for(var n=t.deltaX,a=t.deltaY,o=t.deltaZ,h=0;h<i.length;h++){var l=i[h];if(!(!l.input||!l.input.enabled)&&(e++,l.emit(V.GAMEOBJECT_POINTER_WHEEL,t,n,a,o,r),s.cancelled||!this.isActive()||l.input&&l.input.enabled&&(this.emit(V.GAMEOBJECT_WHEEL,t,l,n,a,o,r),s.cancelled||!this.isActive())))break}return!s.cancelled&&this.isActive()&&this.emit(V.POINTER_WHEEL,t,i,n,a,o),e},processOverEvents:function(t){var e=this._temp,i=0,s=e.length,r=[];if(s>0){var n=this.manager,a=this._eventData,o=this._eventContainer;a.cancelled=!1;for(var h=0;h<s;h++){var l=e[h];if(!(!l.input||!l.input.enabled)&&(r.push(l),n.setCursor(l.input),l.emit(V.GAMEOBJECT_POINTER_OVER,t,l.input.localX,l.input.localY,o),i++,a.cancelled||!this.isActive()||l.input&&l.input.enabled&&(this.emit(V.GAMEOBJECT_OVER,t,l,o),a.cancelled||!this.isActive())))break}!a.cancelled&&this.isActive()&&this.emit(V.POINTER_OVER,t,r)}return this._over[t.id]=r,i},processOutEvents:function(t){var e=this._over[t.id],i=0,s=e.length;if(s>0){var r=this.manager,n=this._eventData,a=this._eventContainer;n.cancelled=!1,this.sortGameObjects(e,t);for(var o=0;o<s;o++){var h=e[o];if(h=e[o],!(!h.input||!h.input.enabled)&&(r.resetCursor(h.input),h.emit(V.GAMEOBJECT_POINTER_OUT,t,a),i++,n.cancelled||!this.isActive()||h.input&&h.input.enabled&&(this.emit(V.GAMEOBJECT_OUT,t,h,a),n.cancelled||!this.isActive())))break}!n.cancelled&&this.isActive()&&this.emit(V.POINTER_OUT,t,e),this._over[t.id]=[]}return i},processOverOutEvents:function(t){var e=this._temp,i,s,r=[],n=[],a=[],o=this._over[t.id],h=this._drag[t.id],l=this.manager;for(i=0;i<o.length;i++)s=o[i],e.indexOf(s)===-1&&h.indexOf(s)===-1?r.push(s):a.push(s);for(i=0;i<e.length;i++)s=e[i],o.indexOf(s)===-1&&n.push(s);var c=r.length,d=0,f=this._eventData,p=this._eventContainer;if(f.cancelled=!1,c>0){for(this.sortGameObjects(r,t),i=0;i<c&&(s=r[i],!(!(!s.input||!s.input.enabled)&&(l.resetCursor(s.input),s.emit(V.GAMEOBJECT_POINTER_OUT,t,p),d++,f.cancelled||!this.isActive()||s.input&&s.input.enabled&&(this.emit(V.GAMEOBJECT_OUT,t,s,p),f.cancelled||!this.isActive()))));i++);(!f.cancelled||this.isActive())&&this.emit(V.POINTER_OUT,t,r)}if(c=n.length,f.cancelled=!1,c>0){for(this.sortGameObjects(n,t),i=0;i<c&&(s=n[i],!(!(!s.input||!s.input.enabled)&&(l.setCursor(s.input),s.emit(V.GAMEOBJECT_POINTER_OVER,t,s.input.localX,s.input.localY,p),d++,f.cancelled||!this.isActive()||s.input&&s.input.enabled&&(this.emit(V.GAMEOBJECT_OVER,t,s,p),f.cancelled||!this.isActive()))));i++);!f.cancelled&&this.isActive()&&this.emit(V.POINTER_OVER,t,n)}return o=a.concat(n),this._over[t.id]=this.sortGameObjects(o,t),d},processUpEvents:function(t){var e=this._temp,i=this._eventData,s=this._eventContainer;i.cancelled=!1;for(var r=0;r<e.length;r++){var n=e[r];if(!(!n.input||!n.input.enabled)&&(n.emit(V.GAMEOBJECT_POINTER_UP,t,n.input.localX,n.input.localY,s),i.cancelled||!this.isActive()||n.input&&n.input.enabled&&(this.emit(V.GAMEOBJECT_UP,t,n,s),i.cancelled||!this.isActive())))break}return!i.cancelled&&this.isActive()&&(t.upElement===this.manager.game.canvas?this.emit(V.POINTER_UP,t,e):this.emit(V.POINTER_UP_OUTSIDE,t)),e.length},forceDownState:function(t,e){this.forceState(t,e,V.GAMEOBJECT_POINTER_DOWN,V.GAMEOBJECT_DOWN,!1)},forceUpState:function(t,e){this.forceState(t,e,V.GAMEOBJECT_POINTER_UP,V.GAMEOBJECT_UP,!1)},forceOverState:function(t,e){this.forceState(t,e,V.GAMEOBJECT_POINTER_OVER,V.GAMEOBJECT_OVER,!0)},forceOutState:function(t,e){this.forceState(t,e,V.GAMEOBJECT_POINTER_OUT,V.GAMEOBJECT_OUT,!1)},forceState:function(t,e,i,s,r){var n=this._eventData,a=this._eventContainer;n.cancelled=!1,e.input&&e.input.enabled&&(e.emit(i,t,e.input.localX,e.input.localY,a),r&&this.setCursor(e.input),!n.cancelled&&this.isActive()&&e.input&&e.input.enabled&&this.emit(s,t,e,a))},queueForInsertion:function(t){return this._pendingInsertion.indexOf(t)===-1&&this._list.indexOf(t)===-1&&this._pendingInsertion.push(t),this},queueForRemoval:function(t){return this._pendingRemoval.push(t),this},setDraggable:function(t,e){e===void 0&&(e=!0),Array.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++){var s=t[i];s.input.draggable=e;var r=this._draggable.indexOf(s);e&&r===-1?this._draggable.push(s):!e&&r>-1&&this._draggable.splice(r,1)}return this},makePixelPerfect:function(t){t===void 0&&(t=1);var e=this.systems.textures;return lae(e,t)},setHitArea:function(t,e,i){if(e===void 0)return this.setHitAreaFromTexture(t);Array.isArray(t)||(t=[t]);var s=!1,r=!1,n=!1,a=!1,o=!1,h=!0;if(dae(e)&&Object.keys(e).length){var l=e,c=t.some(function(v){return v.hasOwnProperty("faces")});if(!c){e=Gr(l,"hitArea",null),i=Gr(l,"hitAreaCallback",null),o=Gr(l,"pixelPerfect",!1);var d=Gr(l,"alphaTolerance",1);o&&(e={},i=this.makePixelPerfect(d))}s=Gr(l,"draggable",!1),r=Gr(l,"dropZone",!1),n=Gr(l,"cursor",!1),a=Gr(l,"useHandCursor",!1),(!e||!i)&&(this.setHitAreaFromTexture(t),h=!1)}else typeof e=="function"&&!i&&(i=e,e={});for(var f=0;f<t.length;f++){var p=t[f];if(o&&p.type==="Container"){console.warn("Cannot pixelPerfect test a Container. Use a custom callback.");continue}var m=p.input?p.input:SD(p,e,i);m.customHitArea=h,m.dropZone=r,m.cursor=a?"pointer":n,p.input=m,s&&this.setDraggable(p),this.queueForInsertion(p)}return this},setHitAreaFromTexture:function(t,e){e===void 0&&(e=TD),Array.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++){var s=t[i],r=s.frame,n=0,a=0;if(s.width?(n=s.width,a=s.height):r&&(n=r.realWidth,a=r.realHeight),s.type==="Container"&&(n===0||a===0)){console.warn("Container.setInteractive must specify a Shape or call setSize() first");continue}n!==0&&a!==0&&(s.input=SD(s,new ED(0,0,n,a),e),this.queueForInsertion(s))}return this},setHitAreaRectangle:function(t,e,i,s,r,n){n===void 0&&(n=TD);var a=new ED(e,i,s,r);return this.setHitArea(t,a,n)},enableDebug:function(t,e){e===void 0&&(e=65280);var i=t.input;if(!i||!i.hitArea)return this;var s=i.hitArea,r=s.type,n=i.hitAreaDebug,a=this.systems.add,o=this.systems.updateList;n&&(o.remove(n),n.destroy(),n=null);var h=0,l=0;switch(r){case ka.CIRCLE:n=a.arc(0,0,s.radius),h=s.x-s.radius,l=s.y-s.radius;break;case ka.ELLIPSE:n=a.ellipse(0,0,s.width,s.height),h=s.x-s.width/2,l=s.y-s.height/2;break;case ka.LINE:n=a.line(0,0,s.x1,s.y1,s.x2,s.y2);break;case ka.POLYGON:n=a.polygon(0,0,s.points);break;case ka.RECTANGLE:n=a.rectangle(0,0,s.width,s.height),h=s.x,l=s.y;break;case ka.TRIANGLE:n=a.triangle(0,0,s.x1,s.y1,s.x2,s.y2,s.x3,s.y3);break}return n&&(n.isFilled=!1,n.strokeColor=e,n.preUpdate=function(){n.setVisible(t.visible),n.setStrokeStyle(1/t.scale,n.strokeColor),n.setDisplayOrigin(t.displayOriginX,t.displayOriginY);var c=t.x,d=t.y,f=t.rotation,p=t.scaleX,m=t.scaleY;if(t.parentContainer){var v=t.getWorldTransformMatrix();c=v.tx,d=v.ty,f=v.rotation,p=v.scaleX,m=v.scaleY}n.setRotation(f),n.setScale(p,m),n.setPosition(c+h*p,d+l*m),n.setScrollFactor(t.scrollFactorX,t.scrollFactorY),n.setDepth(t.depth)},o.add(n),i.hitAreaDebug=n),this},removeDebug:function(t){var e=t.input;if(e&&e.hitAreaDebug){var i=e.hitAreaDebug;i.destroy(),e.hitAreaDebug=null}return this},setPollAlways:function(){return this.setPollRate(0)},setPollOnMove:function(){return this.setPollRate(-1)},setPollRate:function(t){return this.pollRate=t,this._pollTimer=0,this},setGlobalTopOnly:function(t){return this.manager.globalTopOnly=t,this},setTopOnly:function(t){return this.topOnly=t,this},sortGameObjects:function(t,e){if(t.length<2||!e.camera)return t;var i=e.camera.renderList;return t.sort(function(s,r){var n=Math.max(i.indexOf(s),0),a=Math.max(i.indexOf(r),0);return a-n})},sortDropZones:function(t){return t.length<2?t:(this.scene.sys.depthSort(),t.sort(this.sortDropZoneHandler.bind(this)))},sortDropZoneHandler:function(t,e){if(!t.parentContainer&&!e.parentContainer)return this.displayList.getIndex(e)-this.displayList.getIndex(t);if(t.parentContainer===e.parentContainer)return e.parentContainer.getIndex(e)-t.parentContainer.getIndex(t);if(t.parentContainer===e)return-1;if(e.parentContainer===t)return 1;for(var i=t.getIndexList(),s=e.getIndexList(),r=Math.min(i.length,s.length),n=0;n<r;n++){var a=i[n],o=s[n];if(a!==o)return o-a}return s.length-i.length;return 0},stopPropagation:function(){return this.manager._tempSkip=!0,this},addPointer:function(t){return this.manager.addPointer(t)},setDefaultCursor:function(t){return this.manager.setDefaultCursor(t),this},transitionIn:function(){this.enabled=this.settings.transitionAllowInput},transitionComplete:function(){this.settings.transitionAllowInput||(this.enabled=!0)},transitionOut:function(){this.enabled=this.settings.transitionAllowInput},shutdown:function(){this.pluginEvents.emit(V.SHUTDOWN),this._temp.length=0,this._list.length=0,this._draggable.length=0,this._pendingRemoval.length=0,this._pendingInsertion.length=0,this._dragState.length=0;for(var t=0;t<10;t++)this._drag[t]=[],this._over[t]=[];this.removeAllListeners();var e=this.manager;e.canvas.style.cursor=e.defaultCursor;var i=this.systems.events;i.off(ni.TRANSITION_START,this.transitionIn,this),i.off(ni.TRANSITION_OUT,this.transitionOut,this),i.off(ni.TRANSITION_COMPLETE,this.transitionComplete,this),i.off(ni.PRE_UPDATE,this.preUpdate,this),e.events.off(V.GAME_OUT,this.onGameOut,this),e.events.off(V.GAME_OVER,this.onGameOver,this),i.off(ni.SHUTDOWN,this.shutdown,this)},resetPointers:function(){for(var t=this.manager.pointers,e=0;e<t.length;e++)t[e].reset()},destroy:function(){this.shutdown(),this.pluginEvents.emit(V.DESTROY),this.pluginEvents.removeAllListeners(),this.scene.sys.events.off(ni.START,this.start,this),this.scene=null,this.cameras=null,this.manager=null,this.events=null,this.mouse=null},x:{get:function(){return this.manager.activePointer.x}},y:{get:function(){return this.manager.activePointer.y}},isOver:{get:function(){return this.manager.isOver}},mousePointer:{get:function(){return this.manager.mousePointer}},activePointer:{get:function(){return this.manager.activePointer}},pointer1:{get:function(){return this.manager.pointers[1]}},pointer2:{get:function(){return this.manager.pointers[2]}},pointer3:{get:function(){return this.manager.pointers[3]}},pointer4:{get:function(){return this.manager.pointers[4]}},pointer5:{get:function(){return this.manager.pointers[5]}},pointer6:{get:function(){return this.manager.pointers[6]}},pointer7:{get:function(){return this.manager.pointers[7]}},pointer8:{get:function(){return this.manager.pointers[8]}},pointer9:{get:function(){return this.manager.pointers[9]}},pointer10:{get:function(){return this.manager.pointers[10]}}});fae.register("InputPlugin",yD,"input");bD.exports=yD});var CD=u(($Ne,xD)=>{"use strict";xD.exports={MouseManager:bp()}});var RD=u((JNe,wD)=>{"use strict";wD.exports={TouchManager:Pp()}});var _D=u((QNe,PD)=>{"use strict";var pae=Eu(),mae=mi(),Mp={CreatePixelPerfectHandler:Tp(),CreateInteractiveObject:yp(),Events:nt(),InputManager:_p(),InputPlugin:AD(),InputPluginCache:Ip(),Mouse:CD(),Pointer:Rp(),Touch:RD()};Mp=mae(!1,Mp,pae);PD.exports=Mp});var Op=u((eFe,ID)=>{"use strict";var vae=R(),ar=re(),gae=new vae({initialize:function(e){this.delay=0,this.repeat=0,this.repeatCount=0,this.loop=!1,this.callback,this.callbackScope,this.args,this.timeScale=1,this.startAt=0,this.elapsed=0,this.paused=!1,this.hasDispatched=!1,this.reset(e)},reset:function(t){if(this.delay=ar(t,"delay",0),this.repeat=ar(t,"repeat",0),this.loop=ar(t,"loop",!1),this.callback=ar(t,"callback",void 0),this.callbackScope=ar(t,"callbackScope",this),this.args=ar(t,"args",[]),this.timeScale=ar(t,"timeScale",1),this.startAt=ar(t,"startAt",0),this.paused=ar(t,"paused",!1),this.elapsed=this.startAt,this.hasDispatched=!1,this.repeatCount=this.repeat===-1||this.loop?999999999999:this.repeat,this.delay<=0&&this.repeatCount>0)throw new Error("TimerEvent infinite loop created via zero delay");return this},getProgress:function(){return this.elapsed/this.delay},getOverallProgress:function(){if(this.repeat>0){var t=this.delay+this.delay*this.repeat,e=this.elapsed+this.delay*(this.repeat-this.repeatCount);return e/t}else return this.getProgress()},getRepeatCount:function(){return this.repeatCount},getElapsed:function(){return this.elapsed},getElapsedSeconds:function(){return this.elapsed*.001},getRemaining:function(){return this.delay-this.elapsed},getRemainingSeconds:function(){return this.getRemaining()*.001},getOverallRemaining:function(){return this.delay*(1+this.repeatCount)-this.elapsed},getOverallRemainingSeconds:function(){return this.getOverallRemaining()*.001},remove:function(t){t===void 0&&(t=!1),this.elapsed=this.delay,this.hasDispatched=!t,this.repeatCount=0},destroy:function(){this.callback=void 0,this.callbackScope=void 0,this.args=[]}});ID.exports=gae});var DD=u((tFe,OD)=>{"use strict";var Sae=R(),Eae=Vt(),Rs=qe(),LD=Op(),Dp=tr(),MD=new Sae({initialize:function(e){this.scene=e,this.systems=e.sys,this.now=0,this.startTime=0,this.timeScale=1,this.paused=!1,this._active=[],this._pendingInsertion=[],this._pendingRemoval=[],e.sys.events.once(Rs.BOOT,this.boot,this),e.sys.events.on(Rs.START,this.start,this)},boot:function(){this.now=this.systems.game.loop.time,this.systems.events.once(Rs.DESTROY,this.destroy,this)},start:function(){this.startTime=this.systems.game.loop.time;var t=this.systems.events;t.on(Rs.PRE_UPDATE,this.preUpdate,this),t.on(Rs.UPDATE,this.update,this),t.once(Rs.SHUTDOWN,this.shutdown,this)},addEvent:function(t){var e;if(t instanceof LD){if(e=t,this.removeEvent(e),e.elapsed=e.startAt,e.hasDispatched=!1,e.repeatCount=e.repeat===-1||e.loop?999999999999:e.repeat,e.delay<=0&&e.repeatCount>0)throw new Error("TimerEvent infinite loop created via zero delay")}else e=new LD(t);return this._pendingInsertion.push(e),e},delayedCall:function(t,e,i,s){return this.addEvent({delay:t,callback:e,args:i,callbackScope:s})},clearPendingEvents:function(){return this._pendingInsertion=[],this},removeEvent:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var i=t[e];Dp(this._pendingRemoval,i),Dp(this._pendingInsertion,i),Dp(this._active,i)}return this},removeAllEvents:function(){return this._pendingRemoval=this._pendingRemoval.concat(this._active),this},preUpdate:function(){var t=this._pendingRemoval.length,e=this._pendingInsertion.length;if(!(t===0&&e===0)){var i,s;for(i=0;i<t;i++){s=this._pendingRemoval[i];var r=this._active.indexOf(s);r>-1&&this._active.splice(r,1),s.destroy()}for(i=0;i<e;i++)s=this._pendingInsertion[i],this._active.push(s);this._pendingRemoval.length=0,this._pendingInsertion.length=0}},update:function(t,e){if(this.now=t,!this.paused){e*=this.timeScale;for(var i=0;i<this._active.length;i++){var s=this._active[i];if(!s.paused&&(s.elapsed+=e*s.timeScale,s.elapsed>=s.delay)){var r=s.elapsed-s.delay;if(s.elapsed=s.delay,!s.hasDispatched&&s.callback&&(s.hasDispatched=!0,s.callback.apply(s.callbackScope,s.args)),s.repeatCount>0){if(s.repeatCount--,r>=s.delay)for(;r>=s.delay&&s.repeatCount>0;)s.callback&&s.callback.apply(s.callbackScope,s.args),r-=s.delay,s.repeatCount--;s.elapsed=r,s.hasDispatched=!1}else s.hasDispatched&&this._pendingRemoval.push(s)}}}},shutdown:function(){var t;for(t=0;t<this._pendingInsertion.length;t++)this._pendingInsertion[t].destroy();for(t=0;t<this._active.length;t++)this._active[t].destroy();for(t=0;t<this._pendingRemoval.length;t++)this._pendingRemoval[t].destroy();this._active.length=0,this._pendingRemoval.length=0,this._pendingInsertion.length=0;var e=this.systems.events;e.off(Rs.PRE_UPDATE,this.preUpdate,this),e.off(Rs.UPDATE,this.update,this),e.off(Rs.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.scene.sys.events.off(Rs.START,this.start,this),this.scene=null,this.systems=null}});Eae.register("Clock",MD,"time");OD.exports=MD});var UD=u((iFe,BD)=>{"use strict";BD.exports="complete"});var Bp=u((sFe,ND)=>{"use strict";ND.exports={COMPLETE:UD()}});var qD=u((rFe,GD)=>{"use strict";var Tae=R(),FD=ze(),yae=dt(),gi=re(),Ga=qe(),bae=Bp(),kD=new Tae({Extends:FD,initialize:function(e,i){FD.call(this),this.scene=e,this.systems=e.sys,this.elapsed=0,this.timeScale=1,this.paused=!0,this.complete=!1,this.totalComplete=0,this.loop=0,this.iteration=0,this.events=[];var s=this.systems.events;s.on(Ga.PRE_UPDATE,this.preUpdate,this),s.on(Ga.UPDATE,this.update,this),s.once(Ga.SHUTDOWN,this.destroy,this),i&&this.add(i)},preUpdate:function(t,e){this.paused||(this.elapsed+=e*this.timeScale)},update:function(){if(!(this.paused||this.complete)){var t,e=this.events,i=!1,s=this.systems,r;for(t=0;t<e.length;t++){var n=e[t];if(!n.complete&&n.time<=this.elapsed){if(n.complete=!0,this.totalComplete++,r=n.target?n.target:this,n.if&&!n.if.call(r,n))continue;if(n.once&&(i=!0),n.set&&n.target)for(var a in n.set)n.target[a]=n.set[a];this.iteration&&n.repeat++,n.loop&&n.repeat&&n.loop.call(r),n.tween&&(n.tweenInstance=s.tweens.add(n.tween)),n.sound&&(typeof n.sound=="string"?s.sound.play(n.sound):s.sound.play(n.sound.key,n.sound.config)),n.event&&this.emit(n.event,r),n.run&&n.run.call(r),n.stop&&this.stop()}}if(i)for(t=0;t<e.length;t++)e[t].complete&&e[t].once&&(e.splice(t,1),t--);this.totalComplete>=e.length&&(this.loop!==0&&(this.loop===-1||this.loop>this.iteration)?(this.iteration++,this.reset(!0)):this.complete=!0),this.complete&&this.emit(bae.COMPLETE,this)}},play:function(t){return t===void 0&&(t=!0),this.paused=!1,this.complete=!1,this.totalComplete=0,t&&this.reset(),this},pause:function(){this.paused=!0;for(var t=this.events,e=0;e<t.length;e++){var i=t[e];i.tweenInstance&&(i.tweenInstance.paused=!0)}return this},repeat:function(t){return(t===void 0||t===!0)&&(t=-1),t===!1&&(t=0),this.loop=t,this},resume:function(){this.paused=!1;for(var t=this.events,e=0;e<t.length;e++){var i=t[e];i.tweenInstance&&(i.tweenInstance.paused=!1)}return this},stop:function(){return this.paused=!0,this.complete=!0,this},reset:function(t){t===void 0&&(t=!1),this.elapsed=0,t||(this.iteration=0);for(var e=this.events,i=0;i<e.length;i++){var s=e[i];s.complete=!1,t||(s.repeat=0),s.tweenInstance&&s.tweenInstance.stop()}return this.play(!1)},add:function(t){Array.isArray(t)||(t=[t]);var e=this.events,i=0;e.length>0&&(i=e[e.length-1].time);for(var s=0;s<t.length;s++){var r=t[s],n=gi(r,"at",0),a=gi(r,"in",null);a!==null&&(n=this.elapsed+a);var o=gi(r,"from",null);o!==null&&(n=i+o),e.push({complete:!1,time:n,repeat:0,if:gi(r,"if",null),run:gi(r,"run",null),loop:gi(r,"loop",null),event:gi(r,"event",null),target:gi(r,"target",null),set:gi(r,"set",null),tween:gi(r,"tween",null),sound:gi(r,"sound",null),once:gi(r,"once",!1),stop:gi(r,"stop",!1)}),i=n}return this.complete=!1,this},clear:function(){for(var t=this.events,e=0;e<t.length;e++){var i=t[e];i.tweenInstance&&i.tweenInstance.stop()}return t=[],this.elapsed=0,this.paused=!0,this},isPlaying:function(){return!this.paused&&!this.complete},getProgress:function(){var t=Math.min(this.totalComplete,this.events.length);return t/this.events.length},destroy:function(){var t=this.systems.events;t.off(Ga.PRE_UPDATE,this.preUpdate,this),t.off(Ga.UPDATE,this.update,this),t.off(Ga.SHUTDOWN,this.destroy,this),this.clear(),this.scene=null,this.systems=null}});yae.register("timeline",function(t){return new kD(this.scene,t)});GD.exports=kD});var YD=u((nFe,WD)=>{"use strict";WD.exports={Clock:DD(),Events:Bp(),Timeline:qD(),TimerEvent:Op()}});var zD=u((aFe,HD)=>{"use strict";HD.exports="changedata"});var XD=u((oFe,VD)=>{"use strict";VD.exports="changedata-"});var ZD=u((hFe,KD)=>{"use strict";KD.exports="destroy"});var $D=u((lFe,jD)=>{"use strict";jD.exports="removedata"});var QD=u((uFe,JD)=>{"use strict";JD.exports="setdata"});var Up=u((cFe,eB)=>{"use strict";eB.exports={CHANGE_DATA:zD(),CHANGE_DATA_KEY:XD(),DESTROY:ZD(),REMOVE_DATA:$D(),SET_DATA:QD()}});var mh=u((dFe,tB)=>{"use strict";var Aae=R(),or=Up(),xae=new Aae({initialize:function(e,i){this.parent=e,this.events=i,i||(this.events=e.events?e.events:e),this.list={},this.values={},this._frozen=!1,!e.hasOwnProperty("sys")&&this.events&&this.events.once(or.DESTROY,this.destroy,this)},get:function(t){var e=this.list;if(Array.isArray(t)){for(var i=[],s=0;s<t.length;s++)i.push(e[t[s]]);return i}else return e[t]},getAll:function(){var t={};for(var e in this.list)this.list.hasOwnProperty(e)&&(t[e]=this.list[e]);return t},query:function(t){var e={};for(var i in this.list)this.list.hasOwnProperty(i)&&i.match(t)&&(e[i]=this.list[i]);return e},set:function(t,e){if(this._frozen)return this;if(typeof t=="string")return this.setValue(t,e);for(var i in t)this.setValue(i,t[i]);return this},inc:function(t,e){if(this._frozen)return this;e===void 0&&(e=1);var i=this.get(t);return i===void 0&&(i=0),this.set(t,i+e),this},toggle:function(t){return this._frozen?this:(this.set(t,!this.get(t)),this)},setValue:function(t,e){if(this._frozen)return this;if(this.has(t))this.values[t]=e;else{var i=this,s=this.list,r=this.events,n=this.parent;Object.defineProperty(this.values,t,{enumerable:!0,configurable:!0,get:function(){return s[t]},set:function(a){if(!i._frozen){var o=s[t];s[t]=a,r.emit(or.CHANGE_DATA,n,t,a,o),r.emit(or.CHANGE_DATA_KEY+t,n,a,o)}}}),s[t]=e,r.emit(or.SET_DATA,n,t,e)}return this},each:function(t,e){for(var i=[this.parent,null,void 0],s=1;s<arguments.length;s++)i.push(arguments[s]);for(var r in this.list)i[1]=r,i[2]=this.list[r],t.apply(e,i);return this},merge:function(t,e){e===void 0&&(e=!0);for(var i in t)t.hasOwnProperty(i)&&(e||!e&&!this.has(i))&&this.setValue(i,t[i]);return this},remove:function(t){if(this._frozen)return this;if(Array.isArray(t))for(var e=0;e<t.length;e++)this.removeValue(t[e]);else return this.removeValue(t);return this},removeValue:function(t){if(this.has(t)){var e=this.list[t];delete this.list[t],delete this.values[t],this.events.emit(or.REMOVE_DATA,this.parent,t,e)}return this},pop:function(t){var e=void 0;return!this._frozen&&this.has(t)&&(e=this.list[t],delete this.list[t],delete this.values[t],this.events.emit(or.REMOVE_DATA,this.parent,t,e)),e},has:function(t){return this.list.hasOwnProperty(t)},setFreeze:function(t){return this._frozen=t,this},reset:function(){for(var t in this.list)delete this.list[t],delete this.values[t];return this._frozen=!1,this},destroy:function(){this.reset(),this.events.off(or.CHANGE_DATA),this.events.off(or.SET_DATA),this.events.off(or.REMOVE_DATA),this.parent=null},freeze:{get:function(){return this._frozen},set:function(t){this._frozen=!!t}},count:{get:function(){var t=0;for(var e in this.list)this.list[e]!==void 0&&t++;return t}}});tB.exports=xae});var rB=u((fFe,sB)=>{"use strict";var Cae=R(),Np=mh(),wae=Vt(),qa=qe(),iB=new Cae({Extends:Np,initialize:function(e){Np.call(this,e,e.sys.events),this.scene=e,this.systems=e.sys,e.sys.events.once(qa.BOOT,this.boot,this),e.sys.events.on(qa.START,this.start,this)},boot:function(){this.events=this.systems.events,this.events.once(qa.DESTROY,this.destroy,this)},start:function(){this.events.once(qa.SHUTDOWN,this.shutdown,this)},shutdown:function(){this.systems.events.off(qa.SHUTDOWN,this.shutdown,this)},destroy:function(){Np.prototype.destroy.call(this),this.events.off(qa.START,this.start,this),this.scene=null,this.systems=null}});wae.register("DataManagerPlugin",iB,"data");sB.exports=iB});var aB=u((pFe,nB)=>{"use strict";nB.exports={DataManager:mh(),DataManagerPlugin:rB(),Events:Up()}});var vh=u((mFe,oB)=>{"use strict";var Rae={PENDING:0,INIT:1,START:2,LOADING:3,CREATING:4,RUNNING:5,PAUSED:6,SLEEPING:7,SHUTDOWN:8,DESTROYED:9};oB.exports=Rae});var Fp=u((vFe,hB)=>{"use strict";var Pae=re(),_ae=function(t){var e=t.plugins.getDefaultScenePlugins(),i=Pae(t.settings,"plugins",!1);return Array.isArray(i)?i:e||[]};hB.exports=_ae});var uB=u((gFe,lB)=>{"use strict";lB.exports="addfile"});var dB=u((SFe,cB)=>{"use strict";cB.exports="complete"});var pB=u((EFe,fB)=>{"use strict";fB.exports="filecomplete"});var vB=u((TFe,mB)=>{"use strict";mB.exports="filecomplete-"});var SB=u((yFe,gB)=>{"use strict";gB.exports="loaderror"});var TB=u((bFe,EB)=>{"use strict";EB.exports="load"});var bB=u((AFe,yB)=>{"use strict";yB.exports="fileprogress"});var xB=u((xFe,AB)=>{"use strict";AB.exports="postprocess"});var wB=u((CFe,CB)=>{"use strict";CB.exports="progress"});var PB=u((wFe,RB)=>{"use strict";RB.exports="start"});var ss=u((RFe,_B)=>{"use strict";_B.exports={ADD:uB(),COMPLETE:dB(),FILE_COMPLETE:pB(),FILE_KEY_COMPLETE:vB(),FILE_LOAD_ERROR:SB(),FILE_LOAD:TB(),FILE_PROGRESS:bB(),POST_PROCESS:xB(),PROGRESS:wB(),START:PB()}});var kp=u((PFe,IB)=>{"use strict";var Iae={Global:["game","anims","cache","plugins","registry","scale","sound","textures","renderer"],CoreScene:["EventEmitter","CameraManager","GameObjectCreator","GameObjectFactory","ScenePlugin","DisplayList","UpdateList"],DefaultScene:["Clock","DataManagerPlugin","InputPlugin","Loader","TweenManager","LightsPlugin"]};IB.exports=Iae});var Gp=u((_Fe,LB)=>{"use strict";var Lae=function(t){return t&&t[0].toUpperCase()+t.slice(1)};LB.exports=Lae});var DB=u((IFe,OB)=>{"use strict";var Mae=re(),MB=Gp(),Oae=function(t){var e=t.game.config.defaultPhysicsSystem,i=Mae(t.settings,"physics",!1);if(!(!e&&!i)){var s=[];if(e&&s.push(MB(e+"Physics")),i)for(var r in i)r=MB(r.concat("Physics")),s.indexOf(r)===-1&&s.push(r);return s}};OB.exports=Oae});var gh=u((LFe,BB)=>{"use strict";var Dae=function(t){var e={};for(var i in t)Array.isArray(t[i])?e[i]=t[i].slice(0):e[i]=t[i];return e};BB.exports=Dae});var NB=u((MFe,UB)=>{"use strict";var Bae=gh(),Uae=function(t,e){var i=Bae(t);for(var s in e)i.hasOwnProperty(s)||(i[s]=e[s]);return i};UB.exports=Uae});var kB=u((OFe,FB)=>{"use strict";var Nae={game:"game",renderer:"renderer",anims:"anims",cache:"cache",plugins:"plugins",registry:"registry",scale:"scale",sound:"sound",textures:"textures",events:"events",cameras:"cameras",add:"add",make:"make",scenePlugin:"scene",displayList:"children",lights:"lights",data:"data",input:"input",load:"load",time:"time",tweens:"tweens",arcadePhysics:"physics",impactPhysics:"impact",matterPhysics:"matter"};FB.exports=Nae});var qp=u((DFe,GB)=>{"use strict";var Fae=vh(),rs=Ne(),kae=NB(),Gae=kB(),qae={create:function(t){return typeof t=="string"?t={key:t}:t===void 0&&(t={}),{status:Fae.PENDING,key:rs(t,"key",""),active:rs(t,"active",!1),visible:rs(t,"visible",!0),isBooted:!1,isTransition:!1,transitionFrom:null,transitionDuration:0,transitionAllowInput:!0,data:{},pack:rs(t,"pack",!1),cameras:rs(t,"cameras",null),map:rs(t,"map",kae(Gae,rs(t,"mapAdd",{}))),physics:rs(t,"physics",{}),loader:rs(t,"loader",{}),plugins:rs(t,"plugins",!1),input:rs(t,"input",{})}}};GB.exports=qae});var xu=u((BFe,YB)=>{"use strict";var Wae=R(),Rt=vh(),qB=kp(),ft=qe(),Yae=DB(),Hae=Fp(),WB=Ie(),zae=qp(),Vae=new Wae({initialize:function(e,i){this.scene=e,this.game,this.renderer,this.config=i,this.settings=zae.create(i),this.canvas,this.context,this.anims,this.cache,this.plugins,this.registry,this.scale,this.sound,this.textures,this.add,this.cameras,this.displayList,this.events,this.make,this.scenePlugin,this.updateList,this.sceneUpdate=WB},init:function(t){this.settings.status=Rt.INIT,this.sceneUpdate=WB,this.game=t,this.renderer=t.renderer,this.canvas=t.canvas,this.context=t.context;var e=t.plugins;this.plugins=e,e.addToScene(this,qB.Global,[qB.CoreScene,Hae(this),Yae(this)]),this.events.emit(ft.BOOT,this),this.settings.isBooted=!0},step:function(t,e){var i=this.events;i.emit(ft.PRE_UPDATE,t,e),i.emit(ft.UPDATE,t,e),this.sceneUpdate.call(this.scene,t,e),i.emit(ft.POST_UPDATE,t,e)},render:function(t){var e=this.displayList;e.depthSort(),this.events.emit(ft.PRE_RENDER,t),this.cameras.render(t,e),this.events.emit(ft.RENDER,t)},queueDepthSort:function(){this.displayList.queueDepthSort()},depthSort:function(){this.displayList.depthSort()},pause:function(t){var e=this.settings,i=this.getStatus();return i!==Rt.CREATING&&i!==Rt.RUNNING?console.warn("Cannot pause non-running Scene",e.key):this.settings.active&&(e.status=Rt.PAUSED,e.active=!1,this.events.emit(ft.PAUSE,this,t)),this},resume:function(t){var e=this.events,i=this.settings;return this.settings.active||(i.status=Rt.RUNNING,i.active=!0,e.emit(ft.RESUME,this,t)),this},sleep:function(t){var e=this.settings,i=this.getStatus();return i!==Rt.CREATING&&i!==Rt.RUNNING?console.warn("Cannot sleep non-running Scene",e.key):(e.status=Rt.SLEEPING,e.active=!1,e.visible=!1,this.events.emit(ft.SLEEP,this,t)),this},wake:function(t){var e=this.events,i=this.settings;return i.status=Rt.RUNNING,i.active=!0,i.visible=!0,e.emit(ft.WAKE,this,t),i.isTransition&&e.emit(ft.TRANSITION_WAKE,i.transitionFrom,i.transitionDuration),this},getData:function(){return this.settings.data},getStatus:function(){return this.settings.status},canInput:function(){var t=this.settings.status;return t>Rt.PENDING&&t<=Rt.RUNNING},isSleeping:function(){return this.settings.status===Rt.SLEEPING},isActive:function(){return this.settings.status===Rt.RUNNING},isPaused:function(){return this.settings.status===Rt.PAUSED},isTransitioning:function(){return this.settings.isTransition||this.scenePlugin._target!==null},isTransitionOut:function(){return this.scenePlugin._target!==null&&this.scenePlugin._duration>0},isTransitionIn:function(){return this.settings.isTransition},isVisible:function(){return this.settings.visible},setVisible:function(t){return this.settings.visible=t,this},setActive:function(t,e){return t?this.resume(e):this.pause(e)},start:function(t){var e=this.events,i=this.settings;t&&(i.data=t),i.status=Rt.START,i.active=!0,i.visible=!0,e.emit(ft.START,this),e.emit(ft.READY,this,t)},shutdown:function(t){var e=this.events,i=this.settings;e.off(ft.TRANSITION_INIT),e.off(ft.TRANSITION_START),e.off(ft.TRANSITION_COMPLETE),e.off(ft.TRANSITION_OUT),i.status=Rt.SHUTDOWN,i.active=!1,i.visible=!1,e.emit(ft.SHUTDOWN,this,t)},destroy:function(){var t=this.events,e=this.settings;e.status=Rt.DESTROYED,e.active=!1,e.visible=!1,t.emit(ft.DESTROY,this),t.removeAllListeners();for(var i=["scene","game","anims","cache","plugins","registry","sound","textures","add","camera","displayList","events","make","scenePlugin","updateList"],s=0;s<i.length;s++)this[i[s]]=null}});YB.exports=Vae});var Wp=u((UFe,HB)=>{"use strict";var Xae=R(),Kae=xu(),Zae=new Xae({initialize:function(e){this.sys=new Kae(this,e),this.game,this.anims,this.cache,this.registry,this.sound,this.textures,this.events,this.cameras,this.add,this.make,this.scene,this.children,this.lights,this.data,this.input,this.load,this.time,this.tweens,this.physics,this.matter,this.scale,this.plugins,this.renderer},update:function(){}});HB.exports=Zae});var Hp=u((NFe,VB)=>{"use strict";var jae=R(),Pt=vh(),Yp=qe(),zB=vi(),$ae=Ne(),Cu=ss(),wu=Ie(),Wa=Wp(),Jae=xu(),Qae=new jae({initialize:function(e,i){if(this.game=e,this.keys={},this.scenes=[],this._pending=[],this._start=[],this._queue=[],this._data={},this.isProcessing=!1,this.isBooted=!1,this.customViewports=0,this.systemScene,i){Array.isArray(i)||(i=[i]);for(var s=0;s<i.length;s++)this._pending.push({key:"default",scene:i[s],autoStart:s===0,data:{}})}e.events.once(zB.READY,this.bootQueue,this)},bootQueue:function(){if(!this.isBooted){this.systemScene=this.createSceneFromInstance("__SYSTEM",new Wa),this.game.events.emit(zB.SYSTEM_READY,this.systemScene,this);var t,e,i,s;for(t=0;t<this._pending.length;t++){e=this._pending[t],i=e.key,s=e.scene;var r;s instanceof Wa?r=this.createSceneFromInstance(i,s):typeof s=="object"?r=this.createSceneFromObject(i,s):typeof s=="function"&&(r=this.createSceneFromFunction(i,s)),i=r.sys.settings.key,this.keys[i]=r,this.scenes.push(r),this._data[i]&&(r.sys.settings.data=this._data[i].data,this._data[i].autoStart&&(e.autoStart=!0)),(e.autoStart||r.sys.settings.active)&&this._start.push(i)}for(this._pending.length=0,this._data={},this.isBooted=!0,t=0;t<this._start.length;t++)e=this._start[t],this.start(e);this._start.length=0}},processQueue:function(){var t=this._pending.length,e=this._queue.length;if(!(t===0&&e===0)){var i,s;if(t){for(i=0;i<t;i++)s=this._pending[i],this.add(s.key,s.scene,s.autoStart,s.data);for(i=0;i<this._start.length;i++)s=this._start[i],this.start(s);this._start.length=0,this._pending.length=0}for(i=0;i<this._queue.length;i++)s=this._queue[i],this[s.op](s.keyA,s.keyB,s.data);this._queue.length=0}},add:function(t,e,i,s){if(i===void 0&&(i=!1),s===void 0&&(s={}),this.isProcessing||!this.isBooted)return this._pending.push({key:t,scene:e,autoStart:i,data:s}),this.isBooted||(this._data[t]={data:s}),null;t=this.getKey(t,e);var r;return e instanceof Wa?r=this.createSceneFromInstance(t,e):typeof e=="object"?(e.key=t,r=this.createSceneFromObject(t,e)):typeof e=="function"&&(r=this.createSceneFromFunction(t,e)),r.sys.settings.data=s,t=r.sys.settings.key,this.keys[t]=r,this.scenes.push(r),(i||r.sys.settings.active)&&(this._pending.length?this._start.push(t):this.start(t)),r},remove:function(t){if(this.isProcessing)return this.queueOp("remove",t);var e=this.getScene(t);if(!e||e.sys.isTransitioning())return this;var i=this.scenes.indexOf(e),s=e.sys.settings.key;return i>-1&&(delete this.keys[s],this.scenes.splice(i,1),this._start.indexOf(s)>-1&&(i=this._start.indexOf(s),this._start.splice(i,1)),e.sys.destroy()),this},bootScene:function(t){var e=t.sys,i=e.settings;e.sceneUpdate=wu,t.init&&(t.init.call(t,i.data),i.status=Pt.INIT,i.isTransition&&e.events.emit(Yp.TRANSITION_INIT,i.transitionFrom,i.transitionDuration));var s;e.load&&(s=e.load,s.reset()),s&&t.preload?(t.preload.call(t),i.status=Pt.LOADING,s.once(Cu.COMPLETE,this.loadComplete,this),s.start()):this.create(t)},loadComplete:function(t){this.create(t.scene)},payloadComplete:function(t){this.bootScene(t.scene)},update:function(t,e){this.processQueue(),this.isProcessing=!0;for(var i=this.scenes.length-1;i>=0;i--){var s=this.scenes[i].sys;s.settings.status>Pt.START&&s.settings.status<=Pt.RUNNING&&s.step(t,e),s.scenePlugin&&s.scenePlugin._target&&s.scenePlugin.step(t,e)}},render:function(t){for(var e=0;e<this.scenes.length;e++){var i=this.scenes[e].sys;i.settings.visible&&i.settings.status>=Pt.LOADING&&i.settings.status<Pt.SLEEPING&&i.render(t)}this.isProcessing=!1},create:function(t){var e=t.sys,i=e.settings;t.create&&(i.status=Pt.CREATING,t.create.call(t,i.data),i.status===Pt.DESTROYED)||(i.isTransition&&e.events.emit(Yp.TRANSITION_START,i.transitionFrom,i.transitionDuration),t.update&&(e.sceneUpdate=t.update),i.status=Pt.RUNNING,e.events.emit(Yp.CREATE,t))},createSceneFromFunction:function(t,e){var i=new e;if(i instanceof Wa){var s=i.sys.settings.key;if(s!==""&&(t=s),this.keys.hasOwnProperty(t))throw new Error("Cannot add Scene with duplicate key: "+t);return this.createSceneFromInstance(t,i)}else return i.sys=new Jae(i),i.sys.settings.key=t,i.sys.init(this.game),i},createSceneFromInstance:function(t,e){var i=e.sys.settings.key;return i===""&&(e.sys.settings.key=t),e.sys.init(this.game),e},createSceneFromObject:function(t,e){var i=new Wa(e),s=i.sys.settings.key;s!==""?t=s:i.sys.settings.key=t,i.sys.init(this.game);for(var r=["init","preload","create","update","render"],n=0;n<r.length;n++){var a=$ae(e,r[n],null);a&&(i[r[n]]=a)}if(e.hasOwnProperty("extend")){for(var o in e.extend)if(e.extend.hasOwnProperty(o)){var h=e.extend[o];o==="data"&&i.hasOwnProperty("data")&&typeof h=="object"?i.data.merge(h):o!=="sys"&&(i[o]=h)}}return i},getKey:function(t,e){if(t||(t="default"),typeof e=="function")return t;if(e instanceof Wa?t=e.sys.settings.key:typeof e=="object"&&e.hasOwnProperty("key")&&(t=e.key),this.keys.hasOwnProperty(t))throw new Error("Cannot add Scene with duplicate key: "+t);return t},getScenes:function(t,e){t===void 0&&(t=!0),e===void 0&&(e=!1);for(var i=[],s=this.scenes,r=0;r<s.length;r++){var n=s[r];n&&(!t||t&&n.sys.isActive())&&i.push(n)}return e?i.reverse():i},getScene:function(t){if(typeof t=="string"){if(this.keys[t])return this.keys[t]}else for(var e=0;e<this.scenes.length;e++)if(t===this.scenes[e])return t;return null},isActive:function(t){var e=this.getScene(t);return e?e.sys.isActive():null},isPaused:function(t){var e=this.getScene(t);return e?e.sys.isPaused():null},isVisible:function(t){var e=this.getScene(t);return e?e.sys.isVisible():null},isSleeping:function(t){var e=this.getScene(t);return e?e.sys.isSleeping():null},pause:function(t,e){var i=this.getScene(t);return i&&i.sys.pause(e),this},resume:function(t,e){var i=this.getScene(t);return i&&i.sys.resume(e),this},sleep:function(t,e){var i=this.getScene(t);return i&&!i.sys.isTransitioning()&&i.sys.sleep(e),this},wake:function(t,e){var i=this.getScene(t);return i&&i.sys.wake(e),this},run:function(t,e){var i=this.getScene(t);if(!i){for(var s=0;s<this._pending.length;s++)if(this._pending[s].key===t){this.queueOp("start",t,e);break}return this}i.sys.isSleeping()?i.sys.wake(e):i.sys.isPaused()?i.sys.resume(e):this.start(t,e)},start:function(t,e){if(!this.isBooted)return this._data[t]={autoStart:!0,data:e},this;var i=this.getScene(t);if(!i)return console.warn("Scene key not found: "+t),this;var s=i.sys,r=s.settings.status;if(r>=Pt.START&&r<=Pt.CREATING)return this;if(r>=Pt.RUNNING&&r<=Pt.SLEEPING)s.shutdown(),s.sceneUpdate=wu,s.start(e);else{s.sceneUpdate=wu,s.start(e);var n;if(s.load&&(n=s.load),n&&s.settings.hasOwnProperty("pack")&&(n.reset(),n.addPack({payload:s.settings.pack})))return s.settings.status=Pt.LOADING,n.once(Cu.COMPLETE,this.payloadComplete,this),n.start(),this}return this.bootScene(i),this},stop:function(t,e){var i=this.getScene(t);if(i&&!i.sys.isTransitioning()&&i.sys.settings.status!==Pt.SHUTDOWN){var s=i.sys.load;s&&(s.off(Cu.COMPLETE,this.loadComplete,this),s.off(Cu.COMPLETE,this.payloadComplete,this)),i.sys.shutdown(e)}return this},switch:function(t,e,i){var s=this.getScene(t),r=this.getScene(e);return s&&r&&s!==r&&(this.sleep(t),this.isSleeping(e)?this.wake(e,i):this.start(e,i)),this},getAt:function(t){return this.scenes[t]},getIndex:function(t){var e=this.getScene(t);return this.scenes.indexOf(e)},bringToTop:function(t){if(this.isProcessing)return this.queueOp("bringToTop",t);var e=this.getIndex(t),i=this.scenes;if(e!==-1&&e<i.length){var s=this.getScene(t);i.splice(e,1),i.push(s)}return this},sendToBack:function(t){if(this.isProcessing)return this.queueOp("sendToBack",t);var e=this.getIndex(t);if(e!==-1&&e>0){var i=this.getScene(t);this.scenes.splice(e,1),this.scenes.unshift(i)}return this},moveDown:function(t){if(this.isProcessing)return this.queueOp("moveDown",t);var e=this.getIndex(t);if(e>0){var i=e-1,s=this.getScene(t),r=this.getAt(i);this.scenes[e]=r,this.scenes[i]=s}return this},moveUp:function(t){if(this.isProcessing)return this.queueOp("moveUp",t);var e=this.getIndex(t);if(e<this.scenes.length-1){var i=e+1,s=this.getScene(t),r=this.getAt(i);this.scenes[e]=r,this.scenes[i]=s}return this},moveAbove:function(t,e){if(t===e)return this;if(this.isProcessing)return this.queueOp("moveAbove",t,e);var i=this.getIndex(t),s=this.getIndex(e);if(i!==-1&&s!==-1&&s<i){var r=this.getAt(s);this.scenes.splice(s,1),this.scenes.splice(i+(s>i),0,r)}return this},moveBelow:function(t,e){if(t===e)return this;if(this.isProcessing)return this.queueOp("moveBelow",t,e);var i=this.getIndex(t),s=this.getIndex(e);if(i!==-1&&s!==-1&&s>i){var r=this.getAt(s);this.scenes.splice(s,1),i===0?this.scenes.unshift(r):this.scenes.splice(i-(s<i),0,r)}return this},queueOp:function(t,e,i,s){return this._queue.push({op:t,keyA:e,keyB:i,data:s}),this},swapPosition:function(t,e){if(t===e)return this;if(this.isProcessing)return this.queueOp("swapPosition",t,e);var i=this.getIndex(t),s=this.getIndex(e);if(i!==s&&i!==-1&&s!==-1){var r=this.getAt(i);this.scenes[i]=this.scenes[s],this.scenes[s]=r}return this},dump:function(){for(var t=[],e=["pending","init","start","loading","creating","running","paused","sleeping","shutdown","destroyed"],i=0;i<this.scenes.length;i++){var s=this.scenes[i].sys,r=s.settings.visible&&(s.settings.status===Pt.RUNNING||s.settings.status===Pt.PAUSED)?"[*] ":"[-] ";r+=s.settings.key+" ("+e[s.settings.status]+")",t.push(r)}console.log(t.join(`
`))},destroy:function(){for(var t=0;t<this.scenes.length;t++){var e=this.scenes[t].sys;e.destroy()}this.systemScene.sys.destroy(),this.update=wu,this.scenes=[],this._pending=[],this._start=[],this._queue=[],this.game=null,this.systemScene=null}});VB.exports=Qae});var ZB=u((FFe,KB)=>{"use strict";var eoe=Je(),toe=R(),hr=qe(),Si=re(),ioe=Vt(),XB=new toe({initialize:function(e){this.scene=e,this.systems=e.sys,this.settings=e.sys.settings,this.key=e.sys.settings.key,this.manager=e.sys.game.scene,this.transitionProgress=0,this._elapsed=0,this._target=null,this._duration=0,this._onUpdate,this._onUpdateScope,this._willSleep=!1,this._willRemove=!1,e.sys.events.once(hr.BOOT,this.boot,this),e.sys.events.on(hr.START,this.pluginStart,this)},boot:function(){this.systems.events.once(hr.DESTROY,this.destroy,this)},pluginStart:function(){this._target=null,this.systems.events.once(hr.SHUTDOWN,this.shutdown,this)},start:function(t,e){return t===void 0&&(t=this.key),this.manager.queueOp("stop",this.key),this.manager.queueOp("start",t,e),this},restart:function(t){var e=this.key;return this.manager.queueOp("stop",e),this.manager.queueOp("start",e,t),this},transition:function(t){t===void 0&&(t={});var e=Si(t,"target",!1),i=this.manager.getScene(e);if(!e||!this.checkValidTransition(i))return!1;var s=Si(t,"duration",1e3);this._elapsed=0,this._target=i,this._duration=s,this._willSleep=Si(t,"sleep",!1),this._willRemove=Si(t,"remove",!1);var r=Si(t,"onUpdate",null);r&&(this._onUpdate=r,this._onUpdateScope=Si(t,"onUpdateScope",this.scene));var n=Si(t,"allowInput",!1);this.settings.transitionAllowInput=n;var a=i.sys.settings;a.isTransition=!0,a.transitionFrom=this.scene,a.transitionDuration=s,a.transitionAllowInput=n,Si(t,"moveAbove",!1)?this.manager.moveAbove(this.key,e):Si(t,"moveBelow",!1)&&this.manager.moveBelow(this.key,e),i.sys.isSleeping()?i.sys.wake(Si(t,"data")):this.manager.start(e,Si(t,"data"));var o=Si(t,"onStart",null),h=Si(t,"onStartScope",this.scene);return o&&o.call(h,this.scene,i,s),this.systems.events.emit(hr.TRANSITION_OUT,i,s),!0},checkValidTransition:function(t){return!(!t||t.sys.isActive()||t.sys.isTransitioning()||t===this.scene||this.systems.isTransitioning())},step:function(t,e){this._elapsed+=e,this.transitionProgress=eoe(this._elapsed/this._duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.transitionProgress),this._elapsed>=this._duration&&this.transitionComplete()},transitionComplete:function(){var t=this._target.sys,e=this._target.sys.settings;t.events.emit(hr.TRANSITION_COMPLETE,this.scene),e.isTransition=!1,e.transitionFrom=null,this._duration=0,this._target=null,this._onUpdate=null,this._onUpdateScope=null,this._willRemove?this.manager.remove(this.key):this._willSleep?this.systems.sleep():this.manager.stop(this.key)},add:function(t,e,i,s){return this.manager.add(t,e,i,s)},launch:function(t,e){return t&&t!==this.key&&this.manager.queueOp("start",t,e),this},run:function(t,e){return t&&t!==this.key&&this.manager.queueOp("run",t,e),this},pause:function(t,e){return t===void 0&&(t=this.key),this.manager.queueOp("pause",t,e),this},resume:function(t,e){return t===void 0&&(t=this.key),this.manager.queueOp("resume",t,e),this},sleep:function(t,e){return t===void 0&&(t=this.key),this.manager.queueOp("sleep",t,e),this},wake:function(t,e){return t===void 0&&(t=this.key),this.manager.queueOp("wake",t,e),this},switch:function(t,e){return t!==this.key&&this.manager.queueOp("switch",this.key,t,e),this},stop:function(t,e){return t===void 0&&(t=this.key),this.manager.queueOp("stop",t,e),this},setActive:function(t,e,i){e===void 0&&(e=this.key);var s=this.manager.getScene(e);return s&&s.sys.setActive(t,i),this},setVisible:function(t,e){e===void 0&&(e=this.key);var i=this.manager.getScene(e);return i&&i.sys.setVisible(t),this},isSleeping:function(t){return t===void 0&&(t=this.key),this.manager.isSleeping(t)},isActive:function(t){return t===void 0&&(t=this.key),this.manager.isActive(t)},isPaused:function(t){return t===void 0&&(t=this.key),this.manager.isPaused(t)},isVisible:function(t){return t===void 0&&(t=this.key),this.manager.isVisible(t)},swapPosition:function(t,e){return e===void 0&&(e=this.key),t!==e&&this.manager.swapPosition(t,e),this},moveAbove:function(t,e){return e===void 0&&(e=this.key),t!==e&&this.manager.moveAbove(t,e),this},moveBelow:function(t,e){return e===void 0&&(e=this.key),t!==e&&this.manager.moveBelow(t,e),this},remove:function(t){return t===void 0&&(t=this.key),this.manager.remove(t),this},moveUp:function(t){return t===void 0&&(t=this.key),this.manager.moveUp(t),this},moveDown:function(t){return t===void 0&&(t=this.key),this.manager.moveDown(t),this},bringToTop:function(t){return t===void 0&&(t=this.key),this.manager.bringToTop(t),this},sendToBack:function(t){return t===void 0&&(t=this.key),this.manager.sendToBack(t),this},get:function(t){return this.manager.getScene(t)},getStatus:function(t){var e=this.manager.getScene(t);if(e)return e.sys.getStatus()},getIndex:function(t){return t===void 0&&(t=this.key),this.manager.getIndex(t)},shutdown:function(){var t=this.systems.events;t.off(hr.SHUTDOWN,this.shutdown,this),t.off(hr.TRANSITION_OUT)},destroy:function(){this.shutdown(),this.scene.sys.events.off(hr.START,this.start,this),this.scene=null,this.systems=null,this.settings=null,this.manager=null}});ioe.register("ScenePlugin",XB,"scenePlugin");KB.exports=XB});var $B=u((kFe,jB)=>{"use strict";var soe=vh(),roe=mi(),zp={GetScenePlugins:Fp(),SceneManager:Hp(),ScenePlugin:ZB(),Settings:qp(),Systems:xu()};zp=roe(!1,zp,soe);jB.exports=zp});var sU=u((eke,iU)=>{"use strict";iU.exports="active"});var nU=u((tke,rU)=>{"use strict";rU.exports="complete"});var oU=u((ike,aU)=>{"use strict";aU.exports="loop"});var lU=u((ske,hU)=>{"use strict";hU.exports="pause"});var cU=u((rke,uU)=>{"use strict";uU.exports="resume"});var fU=u((nke,dU)=>{"use strict";dU.exports="repeat"});var mU=u((ake,pU)=>{"use strict";pU.exports="start"});var gU=u((oke,vU)=>{"use strict";vU.exports="stop"});var EU=u((hke,SU)=>{"use strict";SU.exports="update"});var yU=u((lke,TU)=>{"use strict";TU.exports="yoyo"});var Fi=u((uke,bU)=>{"use strict";bU.exports={TWEEN_ACTIVE:sU(),TWEEN_COMPLETE:nU(),TWEEN_LOOP:oU(),TWEEN_PAUSE:lU(),TWEEN_RESUME:cU(),TWEEN_REPEAT:fU(),TWEEN_START:mU(),TWEEN_STOP:gU(),TWEEN_UPDATE:EU(),TWEEN_YOYO:yU()}});var xU=u((dke,AU)=>{"use strict";AU.exports="addedtoscene"});var wU=u((fke,CU)=>{"use strict";CU.exports="destroy"});var PU=u((pke,RU)=>{"use strict";RU.exports="removedfromscene"});var IU=u((mke,_U)=>{"use strict";_U.exports="complete"});var MU=u((vke,LU)=>{"use strict";LU.exports="created"});var DU=u((gke,OU)=>{"use strict";OU.exports="error"});var UU=u((Ske,BU)=>{"use strict";BU.exports="locked"});var FU=u((Eke,NU)=>{"use strict";NU.exports="loop"});var GU=u((Tke,kU)=>{"use strict";kU.exports="metadata"});var WU=u((yke,qU)=>{"use strict";qU.exports="play"});var HU=u((bke,YU)=>{"use strict";YU.exports="playing"});var VU=u((Ake,zU)=>{"use strict";zU.exports="seeked"});var KU=u((xke,XU)=>{"use strict";XU.exports="seeking"});var jU=u((Cke,ZU)=>{"use strict";ZU.exports="stalled"});var JU=u((wke,$U)=>{"use strict";$U.exports="stop"});var e1=u((Rke,QU)=>{"use strict";QU.exports="textureready"});var i1=u((Pke,t1)=>{"use strict";t1.exports="unlocked"});var r1=u((_ke,s1)=>{"use strict";s1.exports="unsupported"});var Wr=u((Ike,n1)=>{"use strict";n1.exports={ADDED_TO_SCENE:xU(),DESTROY:wU(),REMOVED_FROM_SCENE:PU(),VIDEO_COMPLETE:IU(),VIDEO_CREATED:MU(),VIDEO_ERROR:DU(),VIDEO_LOCKED:UU(),VIDEO_LOOP:FU(),VIDEO_METADATA:GU(),VIDEO_PLAY:WU(),VIDEO_PLAYING:HU(),VIDEO_SEEKED:VU(),VIDEO_SEEKING:KU(),VIDEO_STALLED:jU(),VIDEO_STOP:JU(),VIDEO_TEXTURE:e1(),VIDEO_UNLOCKED:i1(),VIDEO_UNSUPPORTED:r1()}});var Zp=u((Lke,o1)=>{"use strict";var Le=jl(),poe=R(),a1=Ie(),moe=ih(),voe=new poe({initialize:function(e){this.parent=e,this.list=[],this.position=0,this.addCallback=a1,this.removeCallback=a1,this._sortKey=""},add:function(t,e){return e?Le.Add(this.list,t):Le.Add(this.list,t,0,this.addCallback,this)},addAt:function(t,e,i){return i?Le.AddAt(this.list,t,e):Le.AddAt(this.list,t,e,0,this.addCallback,this)},getAt:function(t){return this.list[t]},getIndex:function(t){return this.list.indexOf(t)},sort:function(t,e){return t?(e===void 0&&(e=function(i,s){return i[t]-s[t]}),moe(this.list,e),this):this},getByName:function(t){return Le.GetFirst(this.list,"name",t)},getRandom:function(t,e){return Le.GetRandom(this.list,t,e)},getFirst:function(t,e,i,s){return Le.GetFirst(this.list,t,e,i,s)},getAll:function(t,e,i,s){return Le.GetAll(this.list,t,e,i,s)},count:function(t,e){return Le.CountAllMatching(this.list,t,e)},swap:function(t,e){Le.Swap(this.list,t,e)},moveTo:function(t,e){return Le.MoveTo(this.list,t,e)},moveAbove:function(t,e){return Le.MoveAbove(this.list,t,e)},moveBelow:function(t,e){return Le.MoveBelow(this.list,t,e)},remove:function(t,e){return e?Le.Remove(this.list,t):Le.Remove(this.list,t,this.removeCallback,this)},removeAt:function(t,e){return e?Le.RemoveAt(this.list,t):Le.RemoveAt(this.list,t,this.removeCallback,this)},removeBetween:function(t,e,i){return i?Le.RemoveBetween(this.list,t,e):Le.RemoveBetween(this.list,t,e,this.removeCallback,this)},removeAll:function(t){for(var e=this.list.length;e--;)this.remove(this.list[e],t);return this},bringToTop:function(t){return Le.BringToTop(this.list,t)},sendToBack:function(t){return Le.SendToBack(this.list,t)},moveUp:function(t){return Le.MoveUp(this.list,t),t},moveDown:function(t){return Le.MoveDown(this.list,t),t},reverse:function(){return this.list.reverse(),this},shuffle:function(){return Le.Shuffle(this.list),this},replace:function(t,e){return Le.Replace(this.list,t,e)},exists:function(t){return this.list.indexOf(t)>-1},setAll:function(t,e,i,s){return Le.SetAll(this.list,t,e,i,s),this},each:function(t,e){for(var i=[null],s=2;s<arguments.length;s++)i.push(arguments[s]);for(s=0;s<this.list.length;s++)i[0]=this.list[s],t.apply(e,i)},shutdown:function(){this.removeAll(),this.list=[]},destroy:function(){this.removeAll(),this.parent=null,this.addCallback=null,this.removeCallback=null},length:{get:function(){return this.list.length}},first:{get:function(){return this.position=0,this.list.length>0?this.list[0]:null}},last:{get:function(){return this.list.length>0?(this.position=this.list.length-1,this.list[this.position]):null}},next:{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}},previous:{get:function(){return this.position>0?(this.position--,this.list[this.position]):null}}});o1.exports=voe});var d1=u((Mke,c1)=>{"use strict";var goe=R(),h1=Zp(),Soe=Vt(),l1=Wr(),Yr=qe(),Eoe=ih(),u1=new goe({Extends:h1,initialize:function(e){h1.call(this,e),this.sortChildrenFlag=!1,this.scene=e,this.systems=e.sys,this.events=e.sys.events,this.addCallback=this.addChildCallback,this.removeCallback=this.removeChildCallback,this.events.once(Yr.BOOT,this.boot,this),this.events.on(Yr.START,this.start,this)},boot:function(){this.events.once(Yr.DESTROY,this.destroy,this)},addChildCallback:function(t){t.displayList&&t.displayList!==this&&t.removeFromDisplayList(),t.parentContainer&&t.parentContainer.remove(t),t.displayList||(this.queueDepthSort(),t.displayList=this,t.emit(l1.ADDED_TO_SCENE,t,this.scene),this.events.emit(Yr.ADDED_TO_SCENE,t,this.scene))},removeChildCallback:function(t){this.queueDepthSort(),t.displayList=null,t.emit(l1.REMOVED_FROM_SCENE,t,this.scene),this.events.emit(Yr.REMOVED_FROM_SCENE,t,this.scene)},start:function(){this.events.once(Yr.SHUTDOWN,this.shutdown,this)},queueDepthSort:function(){this.sortChildrenFlag=!0},depthSort:function(){this.sortChildrenFlag&&(Eoe(this.list,this.sortByDepth),this.sortChildrenFlag=!1)},sortByDepth:function(t,e){return t._depth-e._depth},getChildren:function(){return this.list},shutdown:function(){for(var t=this.list,e=t.length;e--;)t[e].destroy(!0);t.length=0,this.events.off(Yr.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(Yr.START,this.start,this),this.scene=null,this.systems=null,this.events=null}});Soe.register("DisplayList",u1,"displayList");c1.exports=u1});var ai=u((Oke,f1)=>{"use strict";var Toe=R(),yoe=Vt(),Ha=qe(),Hr=new Toe({initialize:function(e){this.scene=e,this.systems=e.sys,this.events=e.sys.events,this.displayList,this.updateList,this.events.once(Ha.BOOT,this.boot,this),this.events.on(Ha.START,this.start,this)},boot:function(){this.displayList=this.systems.displayList,this.updateList=this.systems.updateList,this.events.once(Ha.DESTROY,this.destroy,this)},start:function(){this.events.once(Ha.SHUTDOWN,this.shutdown,this)},shutdown:function(){this.events.off(Ha.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(Ha.START,this.start,this),this.scene=null,this.systems=null,this.events=null,this.displayList=null,this.updateList=null}});Hr.register=function(t,e){Hr.prototype.hasOwnProperty(t)||(Hr.prototype[t]=e)};Hr.remove=function(t){Hr.prototype.hasOwnProperty(t)&&delete Hr.prototype[t]};yoe.register("GameObjectCreator",Hr,"make");f1.exports=Hr});var m1=u((Dke,p1)=>{"use strict";p1.exports="add"});var g1=u((Bke,v1)=>{"use strict";v1.exports="remove"});var E1=u((Uke,S1)=>{"use strict";S1.exports={PROCESS_QUEUE_ADD:m1(),PROCESS_QUEUE_REMOVE:g1()}});var A1=u((Nke,b1)=>{"use strict";var boe=R(),T1=ze(),y1=E1(),Aoe=new boe({Extends:T1,initialize:function(){T1.call(this),this._pending=[],this._active=[],this._destroy=[],this._toProcess=0,this.checkQueue=!1},isActive:function(t){return this._active.indexOf(t)>-1},isPending:function(t){return this._toProcess>0&&this._pending.indexOf(t)>-1},isDestroying:function(t){return this._destroy.indexOf(t)>-1},add:function(t){return this.checkQueue&&this.isActive(t)&&!this.isDestroying(t)||this.isPending(t)||(this._pending.push(t),this._toProcess++),t},remove:function(t){if(this.isPending(t)){var e=this._pending,i=e.indexOf(t);i!==-1&&e.splice(i,1)}else this.isActive(t)&&(this._destroy.push(t),this._toProcess++);return t},removeAll:function(){for(var t=this._active,e=this._destroy,i=t.length;i--;)e.push(t[i]),this._toProcess++;return this},update:function(){if(this._toProcess===0)return this._active;var t=this._destroy,e=this._active,i,s;for(i=0;i<t.length;i++){s=t[i];var r=e.indexOf(s);r!==-1&&(e.splice(r,1),this.emit(y1.PROCESS_QUEUE_REMOVE,s))}for(t.length=0,t=this._pending,i=0;i<t.length;i++)s=t[i],(!this.checkQueue||this.checkQueue&&e.indexOf(s)===-1)&&(e.push(s),this.emit(y1.PROCESS_QUEUE_ADD,s));return t.length=0,this._toProcess=0,e},getActive:function(){return this._active},length:{get:function(){return this._active.length}},destroy:function(){this._toProcess=0,this._pending=[],this._active=[],this._destroy=[]}});b1.exports=Aoe});var R1=u((Fke,w1)=>{"use strict";var xoe=R(),x1=A1(),Coe=Vt(),Ps=qe(),C1=new xoe({Extends:x1,initialize:function(e){x1.call(this),this.checkQueue=!0,this.scene=e,this.systems=e.sys,e.sys.events.once(Ps.BOOT,this.boot,this),e.sys.events.on(Ps.START,this.start,this)},boot:function(){this.systems.events.once(Ps.DESTROY,this.destroy,this)},start:function(){var t=this.systems.events;t.on(Ps.PRE_UPDATE,this.update,this),t.on(Ps.UPDATE,this.sceneUpdate,this),t.once(Ps.SHUTDOWN,this.shutdown,this)},sceneUpdate:function(t,e){for(var i=this._active,s=i.length,r=0;r<s;r++){var n=i[r];n.active&&n.preUpdate.call(n,t,e)}},shutdown:function(){for(var t=this._active.length;t--;)this._active[t].destroy(!0);for(t=this._pending.length;t--;)this._pending[t].destroy(!0);for(t=this._destroy.length;t--;)this._destroy[t].destroy(!0);this._toProcess=0,this._pending=[],this._active=[],this._destroy=[],this.removeAllListeners();var e=this.systems.events;e.off(Ps.PRE_UPDATE,this.update,this),e.off(Ps.UPDATE,this.sceneUpdate,this),e.off(Ps.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.systems.events.off(Ps.START,this.start,this),this.scene=null,this.systems=null}});Coe.register("UpdateList",C1,"updateList");w1.exports=C1});var zr=u((kke,L1)=>{"use strict";var jp=ws(),P1=new jp,_1=new jp,I1=new jp,woe={camera:P1,sprite:_1,calc:I1},Roe=function(t,e,i){var s=P1,r=_1,n=I1;return r.applyITRS(t.x,t.y,t.rotation,t.scaleX,t.scaleY),s.copyFrom(e.matrix),i?(s.multiplyWithOffset(i,-e.scrollX*t.scrollFactorX,-e.scrollY*t.scrollFactorY),r.e=t.x,r.f=t.y):(r.e-=e.scrollX*t.scrollFactorX,r.f-=e.scrollY*t.scrollFactorY),s.multiply(r,n),woe};L1.exports=Roe});var O1=u((Gke,M1)=>{"use strict";var Poe=function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)};M1.exports=Poe});var B1=u((qke,D1)=>{"use strict";var _oe=function(t,e){return Math.atan2(e.x-t.x,e.y-t.y)};D1.exports=_oe});var N1=u((Wke,U1)=>{"use strict";var Ioe=function(t,e,i,s){return Math.atan2(i-t,s-e)};U1.exports=Ioe});var k1=u((Yke,F1)=>{"use strict";var Sh=Kt(),Loe=function(t){return t>Math.PI&&(t-=Sh.PI2),Math.abs(((t+Sh.TAU)%Sh.PI2-Sh.PI2)%Sh.PI2)};F1.exports=Loe});var $p=u((Hke,G1)=>{"use strict";var Moe=function(t){return t=t%(2*Math.PI),t>=0?t:t+2*Math.PI};G1.exports=Moe});var za=u((zke,q1)=>{"use strict";var Ooe=function(t,e){return Math.random()*(e-t)+t};q1.exports=Ooe});var Y1=u((Vke,W1)=>{"use strict";var Doe=za(),Boe=function(){return Doe(-Math.PI,Math.PI)};W1.exports=Boe});var z1=u((Xke,H1)=>{"use strict";var Uoe=za(),Noe=function(){return Uoe(-180,180)};H1.exports=Noe});var X1=u((Kke,V1)=>{"use strict";var Foe=$p(),koe=function(t){return Foe(t+Math.PI)};V1.exports=koe});var Z1=u((Zke,K1)=>{"use strict";var Jp=Kt(),Goe=function(t,e,i){return i===void 0&&(i=.05),t===e||(Math.abs(e-t)<=i||Math.abs(e-t)>=Jp.PI2-i?t=e:(Math.abs(e-t)>Math.PI&&(e<t?e+=Jp.PI2:e-=Jp.PI2),e>t?t+=i:e<t&&(t-=i))),t};K1.exports=Goe});var $1=u((jke,j1)=>{"use strict";var qoe=function(t,e){var i=e-t;if(i===0)return 0;var s=Math.floor((i- -180)/360);return i-s*360};j1.exports=qoe});var Q1=u(($ke,J1)=>{"use strict";J1.exports={Between:Ap(),BetweenPoints:O1(),BetweenPointsY:B1(),BetweenY:N1(),CounterClockwise:k1(),Normalize:$p(),Random:Y1(),RandomDegrees:z1(),Reverse:X1(),RotateTo:Z1(),ShortestBetween:$1(),Wrap:Yf(),WrapDegrees:Hf()}});var Qp=u((Jke,eN)=>{"use strict";var Woe=function(t,e){var i=t.x-e.x,s=t.y-e.y;return Math.sqrt(i*i+s*s)};eN.exports=Woe});var iN=u((Qke,tN)=>{"use strict";var Yoe=function(t,e){var i=t.x-e.x,s=t.y-e.y;return i*i+s*s};tN.exports=Yoe});var rN=u((eGe,sN)=>{"use strict";var Hoe=function(t,e,i,s){return Math.max(Math.abs(t-i),Math.abs(e-s))};sN.exports=Hoe});var aN=u((tGe,nN)=>{"use strict";var zoe=function(t,e,i,s,r){return r===void 0&&(r=2),Math.sqrt(Math.pow(i-t,r)+Math.pow(s-e,r))};nN.exports=zoe});var hN=u((iGe,oN)=>{"use strict";var Voe=function(t,e,i,s){return Math.abs(t-i)+Math.abs(e-s)};oN.exports=Voe});var uN=u((sGe,lN)=>{"use strict";var Xoe=function(t,e,i,s){var r=t-i,n=e-s;return r*r+n*n};lN.exports=Xoe});var dN=u((rGe,cN)=>{"use strict";cN.exports={Between:dh(),BetweenPoints:Qp(),BetweenPointsSquared:iN(),Chebyshev:rN(),Power:aN(),Snake:hN(),Squared:uN()}});var he=u((nGe,fN)=>{"use strict";fN.exports={Back:ip(),Bounce:sp(),Circular:rp(),Cubic:np(),Elastic:ap(),Expo:op(),Linear:hp(),Quadratic:lp(),Quartic:up(),Quintic:cp(),Sine:dp(),Stepped:fp()}});var mN=u((aGe,pN)=>{"use strict";var Koe=function(t){if(t===0)return 1;for(var e=t;--t;)e*=t;return e};pN.exports=Koe});var gN=u((oGe,vN)=>{"use strict";var em=mN(),Zoe=function(t,e){return em(t)/em(e)/em(t-e)};vN.exports=Zoe});var tm=u((hGe,SN)=>{"use strict";var joe=gN(),$oe=function(t,e){for(var i=0,s=t.length-1,r=0;r<=s;r++)i+=Math.pow(1-e,s-r)*Math.pow(e,r)*t[r]*joe(s,r);return i};SN.exports=$oe});var im=u((lGe,EN)=>{"use strict";var Joe=function(t,e,i,s,r){var n=(s-e)*.5,a=(r-i)*.5,o=t*t,h=t*o;return(2*i-2*s+n+a)*h+(-3*i+3*s-2*n-a)*o+n*t+i};EN.exports=Joe});var sm=u((uGe,TN)=>{"use strict";var Ru=im(),Qoe=function(t,e){var i=t.length-1,s=i*e,r=Math.floor(s);return t[0]===t[i]?(e<0&&(r=Math.floor(s=i*(1+e))),Ru(s-r,t[(r-1+i)%i],t[r],t[(r+1)%i],t[(r+2)%i])):e<0?t[0]-(Ru(-s,t[0],t[0],t[1],t[1])-t[0]):e>1?t[i]-(Ru(s-i,t[i],t[i],t[i-1],t[i-1])-t[i]):Ru(s-r,t[r?r-1:0],t[r],t[i<r+1?i:r+1],t[i<r+2?i:r+2])};TN.exports=Qoe});var rm=u((cGe,yN)=>{"use strict";function ehe(t,e){var i=1-t;return i*i*i*e}function the(t,e){var i=1-t;return 3*i*i*t*e}function ihe(t,e){return 3*(1-t)*t*t*e}function she(t,e){return t*t*t*e}var rhe=function(t,e,i,s,r){return ehe(t,e)+the(t,i)+ihe(t,s)+she(t,r)};yN.exports=rhe});var am=u((dGe,bN)=>{"use strict";var nm=uh(),nhe=function(t,e){var i=t.length-1,s=i*e,r=Math.floor(s);return e<0?nm(t[0],t[1],s):e>1?nm(t[i],t[i-1],i-s):nm(t[r],t[r+1>i?i:r+1],s-r)};bN.exports=nhe});var om=u((fGe,AN)=>{"use strict";function ahe(t,e){var i=1-t;return i*i*e}function ohe(t,e){return 2*(1-t)*t*e}function hhe(t,e){return t*t*e}var lhe=function(t,e,i,s){return ahe(t,e)+ohe(t,i)+hhe(t,s)};AN.exports=lhe});var hm=u((pGe,xN)=>{"use strict";var uhe=function(t,e,i){return t=Math.max(0,Math.min(1,(t-e)/(i-e))),t*t*t*(t*(t*6-15)+10)};xN.exports=uhe});var wN=u((mGe,CN)=>{"use strict";var che=hm(),dhe=function(t,e,i){return e+(i-e)*che(t,0,1)};CN.exports=dhe});var PN=u((vGe,RN)=>{"use strict";RN.exports={Bezier:tm(),CatmullRom:sm(),CubicBezier:rm(),Linear:am(),QuadraticBezier:om(),SmoothStep:Cp(),SmootherStep:wN()}});var IN=u((gGe,_N)=>{"use strict";var fhe=R(),phe=new fhe({initialize:function(e){e===void 0&&(e=[(Date.now()*Math.random()).toString()]),this.c=1,this.s0=0,this.s1=0,this.s2=0,this.n=0,this.signs=[-1,1],e&&this.init(e)},rnd:function(){var t=2091639*this.s0+this.c*23283064365386963e-26;return this.c=t|0,this.s0=this.s1,this.s1=this.s2,this.s2=t-this.c,this.s2},hash:function(t){var e,i=this.n;t=t.toString();for(var s=0;s<t.length;s++)i+=t.charCodeAt(s),e=.02519603282416938*i,i=e>>>0,e-=i,e*=i,i=e>>>0,e-=i,i+=e*4294967296;return this.n=i,(i>>>0)*23283064365386963e-26},init:function(t){typeof t=="string"?this.state(t):this.sow(t)},sow:function(t){if(this.n=4022871197,this.s0=this.hash(" "),this.s1=this.hash(" "),this.s2=this.hash(" "),this.c=1,!!t)for(var e=0;e<t.length&&t[e]!=null;e++){var i=t[e];this.s0-=this.hash(i),this.s0+=~~(this.s0<0),this.s1-=this.hash(i),this.s1+=~~(this.s1<0),this.s2-=this.hash(i),this.s2+=~~(this.s2<0)}},integer:function(){return this.rnd()*4294967296},frac:function(){return this.rnd()+(this.rnd()*2097152|0)*11102230246251565e-32},real:function(){return this.integer()+this.frac()},integerInRange:function(t,e){return Math.floor(this.realInRange(0,e-t+1)+t)},between:function(t,e){return Math.floor(this.realInRange(0,e-t+1)+t)},realInRange:function(t,e){return this.frac()*(e-t)+t},normal:function(){return 1-2*this.frac()},uuid:function(){var t="",e="";for(e=t="";t++<36;e+=~t%5|t*3&4?(t^15?8^this.frac()*(t^20?16:4):4).toString(16):"-");return e},pick:function(t){return t[this.integerInRange(0,t.length-1)]},sign:function(){return this.pick(this.signs)},weightedPick:function(t){return t[~~(Math.pow(this.frac(),2)*(t.length-.5)+.5)]},timestamp:function(t,e){return this.realInRange(t||9466848e5,e||1577862e6)},angle:function(){return this.integerInRange(-180,180)},rotation:function(){return this.realInRange(-3.1415926,3.1415926)},state:function(t){return typeof t=="string"&&t.match(/^!rnd/)&&(t=t.split(","),this.c=parseFloat(t[1]),this.s0=parseFloat(t[2]),this.s1=parseFloat(t[3]),this.s2=parseFloat(t[4])),["!rnd",this.c,this.s0,this.s1,this.s2].join(",")},shuffle:function(t){for(var e=t.length-1,i=e;i>0;i--){var s=Math.floor(this.frac()*(i+1)),r=t[s];t[s]=t[i],t[i]=r}return t}});_N.exports=phe});var Mn=u((SGe,LN)=>{"use strict";var mhe=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)};LN.exports=mhe});var ON=u((EGe,MN)=>{"use strict";var vhe=function(t,e,i){return Math.max(t-e,i)};MN.exports=vhe});var lm=u((TGe,DN)=>{"use strict";var ghe=Kt(),She=function(t){return t*ghe.RAD_TO_DEG};DN.exports=She});var UN=u((yGe,BN)=>{"use strict";var Ehe=function(t,e){e===void 0&&(e=1);var i=Math.random()*2*Math.PI;return t.x=Math.cos(i)*e,t.y=Math.sin(i)*e,t};BN.exports=Ehe});var Pu=u((bGe,NN)=>{"use strict";var The=function(t,e,i,s,r){var n=s+Math.atan2(t.y-i,t.x-e);return t.x=e+r*Math.cos(n),t.y=i+r*Math.sin(n),t};NN.exports=The});var um=u((AGe,FN)=>{"use strict";var yhe=R(),Tt=new yhe({initialize:function(e,i,s){this.x=0,this.y=0,this.z=0,typeof e=="object"?(this.x=e.x||0,this.y=e.y||0,this.z=e.z||0):(this.x=e||0,this.y=i||0,this.z=s||0)},up:function(){return this.x=0,this.y=1,this.z=0,this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clone:function(){return new Tt(this.x,this.y,this.z)},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},crossVectors:function(t,e){var i=t.x,s=t.y,r=t.z,n=e.x,a=e.y,o=e.z;return this.x=s*o-r*a,this.y=r*n-i*o,this.z=i*a-s*n,this},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z||0,this},set:function(t,e,i){return typeof t=="object"?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0):(this.x=t||0,this.y=e||0,this.z=i||0),this},setFromMatrixPosition:function(t){return this.fromArray(t.val,12)},setFromMatrixColumn:function(t,e){return this.fromArray(t.val,e*4)},fromArray:function(t,e){return e===void 0&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z||0,this},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addScale:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e||0,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z||0,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z||1,this},scale:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z||1,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},distance:function(t){var e=t.x-this.x,i=t.y-this.y,s=t.z-this.z||0;return Math.sqrt(e*e+i*i+s*s)},distanceSq:function(t){var e=t.x-this.x,i=t.y-this.y,s=t.z-this.z||0;return e*e+i*i+s*s},length:function(){var t=this.x,e=this.y,i=this.z;return Math.sqrt(t*t+e*e+i*i)},lengthSq:function(){var t=this.x,e=this.y,i=this.z;return t*t+e*e+i*i},normalize:function(){var t=this.x,e=this.y,i=this.z,s=t*t+e*e+i*i;return s>0&&(s=1/Math.sqrt(s),this.x=t*s,this.y=e*s,this.z=i*s),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},cross:function(t){var e=this.x,i=this.y,s=this.z,r=t.x,n=t.y,a=t.z;return this.x=i*a-s*n,this.y=s*r-e*a,this.z=e*n-i*r,this},lerp:function(t,e){e===void 0&&(e=0);var i=this.x,s=this.y,r=this.z;return this.x=i+e*(t.x-i),this.y=s+e*(t.y-s),this.z=r+e*(t.z-r),this},applyMatrix3:function(t){var e=this.x,i=this.y,s=this.z,r=t.val;return this.x=r[0]*e+r[3]*i+r[6]*s,this.y=r[1]*e+r[4]*i+r[7]*s,this.z=r[2]*e+r[5]*i+r[8]*s,this},applyMatrix4:function(t){var e=this.x,i=this.y,s=this.z,r=t.val,n=1/(r[3]*e+r[7]*i+r[11]*s+r[15]);return this.x=(r[0]*e+r[4]*i+r[8]*s+r[12])*n,this.y=(r[1]*e+r[5]*i+r[9]*s+r[13])*n,this.z=(r[2]*e+r[6]*i+r[10]*s+r[14])*n,this},transformMat3:function(t){var e=this.x,i=this.y,s=this.z,r=t.val;return this.x=e*r[0]+i*r[3]+s*r[6],this.y=e*r[1]+i*r[4]+s*r[7],this.z=e*r[2]+i*r[5]+s*r[8],this},transformMat4:function(t){var e=this.x,i=this.y,s=this.z,r=t.val;return this.x=r[0]*e+r[4]*i+r[8]*s+r[12],this.y=r[1]*e+r[5]*i+r[9]*s+r[13],this.z=r[2]*e+r[6]*i+r[10]*s+r[14],this},transformCoordinates:function(t){var e=this.x,i=this.y,s=this.z,r=t.val,n=e*r[0]+i*r[4]+s*r[8]+r[12],a=e*r[1]+i*r[5]+s*r[9]+r[13],o=e*r[2]+i*r[6]+s*r[10]+r[14],h=e*r[3]+i*r[7]+s*r[11]+r[15];return this.x=n/h,this.y=a/h,this.z=o/h,this},transformQuat:function(t){var e=this.x,i=this.y,s=this.z,r=t.x,n=t.y,a=t.z,o=t.w,h=o*e+n*s-a*i,l=o*i+a*e-r*s,c=o*s+r*i-n*e,d=-r*e-n*i-a*s;return this.x=h*o+d*-r+l*-a-c*-n,this.y=l*o+d*-n+c*-r-h*-a,this.z=c*o+d*-a+h*-n-l*-r,this},project:function(t){var e=this.x,i=this.y,s=this.z,r=t.val,n=r[0],a=r[1],o=r[2],h=r[3],l=r[4],c=r[5],d=r[6],f=r[7],p=r[8],m=r[9],v=r[10],g=r[11],S=r[12],y=r[13],b=r[14],x=r[15],A=1/(e*h+i*f+s*g+x);return this.x=(e*n+i*l+s*p+S)*A,this.y=(e*a+i*c+s*m+y)*A,this.z=(e*o+i*d+s*v+b)*A,this},projectViewMatrix:function(t,e){return this.applyMatrix4(t).applyMatrix4(e)},unprojectViewMatrix:function(t,e){return this.applyMatrix4(t).applyMatrix4(e)},unproject:function(t,e){var i=t.x,s=t.y,r=t.z,n=t.w,a=this.x-i,o=n-this.y-1-s,h=this.z;return this.x=2*a/r-1,this.y=2*o/n-1,this.z=2*h-1,this.project(e)},reset:function(){return this.x=0,this.y=0,this.z=0,this}});Tt.ZERO=new Tt;Tt.RIGHT=new Tt(1,0,0);Tt.LEFT=new Tt(-1,0,0);Tt.UP=new Tt(0,-1,0);Tt.DOWN=new Tt(0,1,0);Tt.FORWARD=new Tt(0,0,1);Tt.BACK=new Tt(0,0,-1);Tt.ONE=new Tt(1,1,1);FN.exports=Tt});var Mu=u((xGe,kN)=>{"use strict";var bhe=R(),cm=um(),_u=1e-6,Lu=new bhe({initialize:function(e){this.val=new Float32Array(16),e?this.copy(e):this.identity()},clone:function(){return new Lu(this)},set:function(t){return this.copy(t)},setValues:function(t,e,i,s,r,n,a,o,h,l,c,d,f,p,m,v){var g=this.val;return g[0]=t,g[1]=e,g[2]=i,g[3]=s,g[4]=r,g[5]=n,g[6]=a,g[7]=o,g[8]=h,g[9]=l,g[10]=c,g[11]=d,g[12]=f,g[13]=p,g[14]=m,g[15]=v,this},copy:function(t){var e=t.val;return this.setValues(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},fromArray:function(t){return this.setValues(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},zero:function(){return this.setValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)},transform:function(t,e,i){var s=Va.fromQuat(i),r=s.val,n=e.x,a=e.y,o=e.z;return this.setValues(r[0]*n,r[1]*n,r[2]*n,0,r[4]*a,r[5]*a,r[6]*a,0,r[8]*o,r[9]*o,r[10]*o,0,t.x,t.y,t.z,1)},xyz:function(t,e,i){this.identity();var s=this.val;return s[12]=t,s[13]=e,s[14]=i,this},scaling:function(t,e,i){this.zero();var s=this.val;return s[0]=t,s[5]=e,s[10]=i,s[15]=1,this},identity:function(){return this.setValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},transpose:function(){var t=this.val,e=t[1],i=t[2],s=t[3],r=t[6],n=t[7],a=t[11];return t[1]=t[4],t[2]=t[8],t[3]=t[12],t[4]=e,t[6]=t[9],t[7]=t[13],t[8]=i,t[9]=r,t[11]=t[14],t[12]=s,t[13]=n,t[14]=a,this},getInverse:function(t){return this.copy(t),this.invert()},invert:function(){var t=this.val,e=t[0],i=t[1],s=t[2],r=t[3],n=t[4],a=t[5],o=t[6],h=t[7],l=t[8],c=t[9],d=t[10],f=t[11],p=t[12],m=t[13],v=t[14],g=t[15],S=e*a-i*n,y=e*o-s*n,b=e*h-r*n,x=i*o-s*a,A=i*h-r*a,w=s*h-r*o,C=l*m-c*p,_=l*v-d*p,N=l*g-f*p,D=c*v-d*m,Y=c*g-f*m,$=d*g-f*v,j=S*$-y*Y+b*D+x*N-A*_+w*C;return j?(j=1/j,this.setValues((a*$-o*Y+h*D)*j,(s*Y-i*$-r*D)*j,(m*w-v*A+g*x)*j,(d*A-c*w-f*x)*j,(o*N-n*$-h*_)*j,(e*$-s*N+r*_)*j,(v*b-p*w-g*y)*j,(l*w-d*b+f*y)*j,(n*Y-a*N+h*C)*j,(i*N-e*Y-r*C)*j,(p*A-m*b+g*S)*j,(c*b-l*A-f*S)*j,(a*_-n*D-o*C)*j,(e*D-i*_+s*C)*j,(m*y-p*x-v*S)*j,(l*x-c*y+d*S)*j)):this},adjoint:function(){var t=this.val,e=t[0],i=t[1],s=t[2],r=t[3],n=t[4],a=t[5],o=t[6],h=t[7],l=t[8],c=t[9],d=t[10],f=t[11],p=t[12],m=t[13],v=t[14],g=t[15];return this.setValues(a*(d*g-f*v)-c*(o*g-h*v)+m*(o*f-h*d),-(i*(d*g-f*v)-c*(s*g-r*v)+m*(s*f-r*d)),i*(o*g-h*v)-a*(s*g-r*v)+m*(s*h-r*o),-(i*(o*f-h*d)-a*(s*f-r*d)+c*(s*h-r*o)),-(n*(d*g-f*v)-l*(o*g-h*v)+p*(o*f-h*d)),e*(d*g-f*v)-l*(s*g-r*v)+p*(s*f-r*d),-(e*(o*g-h*v)-n*(s*g-r*v)+p*(s*h-r*o)),e*(o*f-h*d)-n*(s*f-r*d)+l*(s*h-r*o),n*(c*g-f*m)-l*(a*g-h*m)+p*(a*f-h*c),-(e*(c*g-f*m)-l*(i*g-r*m)+p*(i*f-r*c)),e*(a*g-h*m)-n*(i*g-r*m)+p*(i*h-r*a),-(e*(a*f-h*c)-n*(i*f-r*c)+l*(i*h-r*a)),-(n*(c*v-d*m)-l*(a*v-o*m)+p*(a*d-o*c)),e*(c*v-d*m)-l*(i*v-s*m)+p*(i*d-s*c),-(e*(a*v-o*m)-n*(i*v-s*m)+p*(i*o-s*a)),e*(a*d-o*c)-n*(i*d-s*c)+l*(i*o-s*a))},determinant:function(){var t=this.val,e=t[0],i=t[1],s=t[2],r=t[3],n=t[4],a=t[5],o=t[6],h=t[7],l=t[8],c=t[9],d=t[10],f=t[11],p=t[12],m=t[13],v=t[14],g=t[15],S=e*a-i*n,y=e*o-s*n,b=e*h-r*n,x=i*o-s*a,A=i*h-r*a,w=s*h-r*o,C=l*m-c*p,_=l*v-d*p,N=l*g-f*p,D=c*v-d*m,Y=c*g-f*m,$=d*g-f*v;return S*$-y*Y+b*D+x*N-A*_+w*C},multiply:function(t){var e=this.val,i=e[0],s=e[1],r=e[2],n=e[3],a=e[4],o=e[5],h=e[6],l=e[7],c=e[8],d=e[9],f=e[10],p=e[11],m=e[12],v=e[13],g=e[14],S=e[15],y=t.val,b=y[0],x=y[1],A=y[2],w=y[3];return e[0]=b*i+x*a+A*c+w*m,e[1]=b*s+x*o+A*d+w*v,e[2]=b*r+x*h+A*f+w*g,e[3]=b*n+x*l+A*p+w*S,b=y[4],x=y[5],A=y[6],w=y[7],e[4]=b*i+x*a+A*c+w*m,e[5]=b*s+x*o+A*d+w*v,e[6]=b*r+x*h+A*f+w*g,e[7]=b*n+x*l+A*p+w*S,b=y[8],x=y[9],A=y[10],w=y[11],e[8]=b*i+x*a+A*c+w*m,e[9]=b*s+x*o+A*d+w*v,e[10]=b*r+x*h+A*f+w*g,e[11]=b*n+x*l+A*p+w*S,b=y[12],x=y[13],A=y[14],w=y[15],e[12]=b*i+x*a+A*c+w*m,e[13]=b*s+x*o+A*d+w*v,e[14]=b*r+x*h+A*f+w*g,e[15]=b*n+x*l+A*p+w*S,this},multiplyLocal:function(t){var e=this.val,i=t.val;return this.setValues(e[0]*i[0]+e[1]*i[4]+e[2]*i[8]+e[3]*i[12],e[0]*i[1]+e[1]*i[5]+e[2]*i[9]+e[3]*i[13],e[0]*i[2]+e[1]*i[6]+e[2]*i[10]+e[3]*i[14],e[0]*i[3]+e[1]*i[7]+e[2]*i[11]+e[3]*i[15],e[4]*i[0]+e[5]*i[4]+e[6]*i[8]+e[7]*i[12],e[4]*i[1]+e[5]*i[5]+e[6]*i[9]+e[7]*i[13],e[4]*i[2]+e[5]*i[6]+e[6]*i[10]+e[7]*i[14],e[4]*i[3]+e[5]*i[7]+e[6]*i[11]+e[7]*i[15],e[8]*i[0]+e[9]*i[4]+e[10]*i[8]+e[11]*i[12],e[8]*i[1]+e[9]*i[5]+e[10]*i[9]+e[11]*i[13],e[8]*i[2]+e[9]*i[6]+e[10]*i[10]+e[11]*i[14],e[8]*i[3]+e[9]*i[7]+e[10]*i[11]+e[11]*i[15],e[12]*i[0]+e[13]*i[4]+e[14]*i[8]+e[15]*i[12],e[12]*i[1]+e[13]*i[5]+e[14]*i[9]+e[15]*i[13],e[12]*i[2]+e[13]*i[6]+e[14]*i[10]+e[15]*i[14],e[12]*i[3]+e[13]*i[7]+e[14]*i[11]+e[15]*i[15])},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var i=t.val,s=e.val,r=i[0],n=i[4],a=i[8],o=i[12],h=i[1],l=i[5],c=i[9],d=i[13],f=i[2],p=i[6],m=i[10],v=i[14],g=i[3],S=i[7],y=i[11],b=i[15],x=s[0],A=s[4],w=s[8],C=s[12],_=s[1],N=s[5],D=s[9],Y=s[13],$=s[2],j=s[6],G=s[10],Z=s[14],ee=s[3],te=s[7],Q=s[11],Ae=s[15];return this.setValues(r*x+n*_+a*$+o*ee,h*x+l*_+c*$+d*ee,f*x+p*_+m*$+v*ee,g*x+S*_+y*$+b*ee,r*A+n*N+a*j+o*te,h*A+l*N+c*j+d*te,f*A+p*N+m*j+v*te,g*A+S*N+y*j+b*te,r*w+n*D+a*G+o*Q,h*w+l*D+c*G+d*Q,f*w+p*D+m*G+v*Q,g*w+S*D+y*G+b*Q,r*C+n*Y+a*Z+o*Ae,h*C+l*Y+c*Z+d*Ae,f*C+p*Y+m*Z+v*Ae,g*C+S*Y+y*Z+b*Ae)},translate:function(t){return this.translateXYZ(t.x,t.y,t.z)},translateXYZ:function(t,e,i){var s=this.val;return s[12]=s[0]*t+s[4]*e+s[8]*i+s[12],s[13]=s[1]*t+s[5]*e+s[9]*i+s[13],s[14]=s[2]*t+s[6]*e+s[10]*i+s[14],s[15]=s[3]*t+s[7]*e+s[11]*i+s[15],this},scale:function(t){return this.scaleXYZ(t.x,t.y,t.z)},scaleXYZ:function(t,e,i){var s=this.val;return s[0]=s[0]*t,s[1]=s[1]*t,s[2]=s[2]*t,s[3]=s[3]*t,s[4]=s[4]*e,s[5]=s[5]*e,s[6]=s[6]*e,s[7]=s[7]*e,s[8]=s[8]*i,s[9]=s[9]*i,s[10]=s[10]*i,s[11]=s[11]*i,this},makeRotationAxis:function(t,e){var i=Math.cos(e),s=Math.sin(e),r=1-i,n=t.x,a=t.y,o=t.z,h=r*n,l=r*a;return this.setValues(h*n+i,h*a-s*o,h*o+s*a,0,h*a+s*o,l*a+i,l*o-s*n,0,h*o-s*a,l*o+s*n,r*o*o+i,0,0,0,0,1)},rotate:function(t,e){var i=this.val,s=e.x,r=e.y,n=e.z,a=Math.sqrt(s*s+r*r+n*n);if(Math.abs(a)<_u)return this;a=1/a,s*=a,r*=a,n*=a;var o=Math.sin(t),h=Math.cos(t),l=1-h,c=i[0],d=i[1],f=i[2],p=i[3],m=i[4],v=i[5],g=i[6],S=i[7],y=i[8],b=i[9],x=i[10],A=i[11],w=i[12],C=i[13],_=i[14],N=i[15],D=s*s*l+h,Y=r*s*l+n*o,$=n*s*l-r*o,j=s*r*l-n*o,G=r*r*l+h,Z=n*r*l+s*o,ee=s*n*l+r*o,te=r*n*l-s*o,Q=n*n*l+h;return this.setValues(c*D+m*Y+y*$,d*D+v*Y+b*$,f*D+g*Y+x*$,p*D+S*Y+A*$,c*j+m*G+y*Z,d*j+v*G+b*Z,f*j+g*G+x*Z,p*j+S*G+A*Z,c*ee+m*te+y*Q,d*ee+v*te+b*Q,f*ee+g*te+x*Q,p*ee+S*te+A*Q,w,C,_,N)},rotateX:function(t){var e=this.val,i=Math.sin(t),s=Math.cos(t),r=e[4],n=e[5],a=e[6],o=e[7],h=e[8],l=e[9],c=e[10],d=e[11];return e[4]=r*s+h*i,e[5]=n*s+l*i,e[6]=a*s+c*i,e[7]=o*s+d*i,e[8]=h*s-r*i,e[9]=l*s-n*i,e[10]=c*s-a*i,e[11]=d*s-o*i,this},rotateY:function(t){var e=this.val,i=Math.sin(t),s=Math.cos(t),r=e[0],n=e[1],a=e[2],o=e[3],h=e[8],l=e[9],c=e[10],d=e[11];return e[0]=r*s-h*i,e[1]=n*s-l*i,e[2]=a*s-c*i,e[3]=o*s-d*i,e[8]=r*i+h*s,e[9]=n*i+l*s,e[10]=a*i+c*s,e[11]=o*i+d*s,this},rotateZ:function(t){var e=this.val,i=Math.sin(t),s=Math.cos(t),r=e[0],n=e[1],a=e[2],o=e[3],h=e[4],l=e[5],c=e[6],d=e[7];return e[0]=r*s+h*i,e[1]=n*s+l*i,e[2]=a*s+c*i,e[3]=o*s+d*i,e[4]=h*s-r*i,e[5]=l*s-n*i,e[6]=c*s-a*i,e[7]=d*s-o*i,this},fromRotationTranslation:function(t,e){var i=t.x,s=t.y,r=t.z,n=t.w,a=i+i,o=s+s,h=r+r,l=i*a,c=i*o,d=i*h,f=s*o,p=s*h,m=r*h,v=n*a,g=n*o,S=n*h;return this.setValues(1-(f+m),c+S,d-g,0,c-S,1-(l+m),p+v,0,d+g,p-v,1-(l+f),0,e.x,e.y,e.z,1)},fromQuat:function(t){var e=t.x,i=t.y,s=t.z,r=t.w,n=e+e,a=i+i,o=s+s,h=e*n,l=e*a,c=e*o,d=i*a,f=i*o,p=s*o,m=r*n,v=r*a,g=r*o;return this.setValues(1-(d+p),l+g,c-v,0,l-g,1-(h+p),f+m,0,c+v,f-m,1-(h+d),0,0,0,0,1)},frustum:function(t,e,i,s,r,n){var a=1/(e-t),o=1/(s-i),h=1/(r-n);return this.setValues(r*2*a,0,0,0,0,r*2*o,0,0,(e+t)*a,(s+i)*o,(n+r)*h,-1,0,0,n*r*2*h,0)},perspective:function(t,e,i,s){var r=1/Math.tan(t/2),n=1/(i-s);return this.setValues(r/e,0,0,0,0,r,0,0,0,0,(s+i)*n,-1,0,0,2*s*i*n,0)},perspectiveLH:function(t,e,i,s){return this.setValues(2*i/t,0,0,0,0,2*i/e,0,0,0,0,-s/(i-s),1,0,0,i*s/(i-s),0)},ortho:function(t,e,i,s,r,n){var a=t-e,o=i-s,h=r-n;return a=a===0?a:1/a,o=o===0?o:1/o,h=h===0?h:1/h,this.setValues(-2*a,0,0,0,0,-2*o,0,0,0,0,2*h,0,(t+e)*a,(s+i)*o,(n+r)*h,1)},lookAtRH:function(t,e,i){var s=this.val;return Ei.subVectors(t,e),Ei.lengthSq()===0&&(Ei.z=1),Ei.normalize(),Vr.crossVectors(i,Ei),Vr.lengthSq()===0&&(Math.abs(i.z)===1?Ei.x+=1e-4:Ei.z+=1e-4,Ei.normalize(),Vr.crossVectors(i,Ei)),Vr.normalize(),Iu.crossVectors(Ei,Vr),s[0]=Vr.x,s[1]=Vr.y,s[2]=Vr.z,s[4]=Iu.x,s[5]=Iu.y,s[6]=Iu.z,s[8]=Ei.x,s[9]=Ei.y,s[10]=Ei.z,this},lookAt:function(t,e,i){var s=t.x,r=t.y,n=t.z,a=i.x,o=i.y,h=i.z,l=e.x,c=e.y,d=e.z;if(Math.abs(s-l)<_u&&Math.abs(r-c)<_u&&Math.abs(n-d)<_u)return this.identity();var f=s-l,p=r-c,m=n-d,v=1/Math.sqrt(f*f+p*p+m*m);f*=v,p*=v,m*=v;var g=o*m-h*p,S=h*f-a*m,y=a*p-o*f;v=Math.sqrt(g*g+S*S+y*y),v?(v=1/v,g*=v,S*=v,y*=v):(g=0,S=0,y=0);var b=p*y-m*S,x=m*g-f*y,A=f*S-p*g;return v=Math.sqrt(b*b+x*x+A*A),v?(v=1/v,b*=v,x*=v,A*=v):(b=0,x=0,A=0),this.setValues(g,b,f,0,S,x,p,0,y,A,m,0,-(g*s+S*r+y*n),-(b*s+x*r+A*n),-(f*s+p*r+m*n),1)},yawPitchRoll:function(t,e,i){this.zero(),Va.zero(),Eh.zero();var s=this.val,r=Va.val,n=Eh.val,a=Math.sin(i),o=Math.cos(i);return s[10]=1,s[15]=1,s[0]=o,s[1]=a,s[4]=-a,s[5]=o,a=Math.sin(e),o=Math.cos(e),r[0]=1,r[15]=1,r[5]=o,r[10]=o,r[9]=-a,r[6]=a,a=Math.sin(t),o=Math.cos(t),n[5]=1,n[15]=1,n[0]=o,n[2]=-a,n[8]=a,n[10]=o,this.multiplyLocal(Va),this.multiplyLocal(Eh),this},setWorldMatrix:function(t,e,i,s,r){return this.yawPitchRoll(t.y,t.x,t.z),Va.scaling(i.x,i.y,i.z),Eh.xyz(e.x,e.y,e.z),this.multiplyLocal(Va),this.multiplyLocal(Eh),s&&this.multiplyLocal(s),r&&this.multiplyLocal(r),this},multiplyToMat4:function(t,e){var i=this.val,s=t.val,r=i[0],n=i[1],a=i[2],o=i[3],h=i[4],l=i[5],c=i[6],d=i[7],f=i[8],p=i[9],m=i[10],v=i[11],g=i[12],S=i[13],y=i[14],b=i[15],x=s[0],A=s[1],w=s[2],C=s[3],_=s[4],N=s[5],D=s[6],Y=s[7],$=s[8],j=s[9],G=s[10],Z=s[11],ee=s[12],te=s[13],Q=s[14],Ae=s[15];return e.setValues(x*r+A*h+w*f+C*g,A*n+A*l+w*p+C*S,w*a+A*c+w*m+C*y,C*o+A*d+w*v+C*b,_*r+N*h+D*f+Y*g,_*n+N*l+D*p+Y*S,_*a+N*c+D*m+Y*y,_*o+N*d+D*v+Y*b,$*r+j*h+G*f+Z*g,$*n+j*l+G*p+Z*S,$*a+j*c+G*m+Z*y,$*o+j*d+G*v+Z*b,ee*r+te*h+Q*f+Ae*g,ee*n+te*l+Q*p+Ae*S,ee*a+te*c+Q*m+Ae*y,ee*o+te*d+Q*v+Ae*b)},fromRotationXYTranslation:function(t,e,i){var s=e.x,r=e.y,n=e.z,a=Math.sin(t.x),o=Math.cos(t.x),h=Math.sin(t.y),l=Math.cos(t.y),c=s,d=r,f=n,p=-a,m=0-p*h,v=0-o*h,g=p*l,S=o*l;return i||(c=l*s+h*n,d=m*s+o*r+g*n,f=v*s+a*r+S*n),this.setValues(l,m,v,0,0,o,a,0,h,g,S,0,c,d,f,1)},getMaxScaleOnAxis:function(){var t=this.val,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],s=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,i,s))}}),Va=new Lu,Eh=new Lu,Vr=new cm,Iu=new cm,Ei=new cm;kN.exports=Lu});var ve=u((CGe,GN)=>{"use strict";var Ahe=Kt(),xhe=mi(),dm={Angle:Q1(),Distance:dN(),Easing:he(),Interpolation:PN(),RandomDataGenerator:IN(),Between:Mn(),Clamp:Je(),DegToRad:Na(),FloatBetween:za(),Linear:uh(),MinSub:ON(),RadToDeg:lm(),RandomXY:UN(),RotateAroundDistance:Pu(),Vector2:Fe(),Matrix4:Mu()};dm=xhe(!1,dm,Ahe);GN.exports=dm});var oi=u((wGe,qN)=>{"use strict";var fm=ve(),Che=Ne(),whe=function(t,e,i){var s=Che(t,e,null);if(s===null)return i;if(Array.isArray(s))return fm.RND.pick(s);if(typeof s=="object"){if(s.hasOwnProperty("randInt"))return fm.RND.integerInRange(s.randInt[0],s.randInt[1]);if(s.hasOwnProperty("randFloat"))return fm.RND.realInRange(s.randFloat[0],s.randFloat[1])}else if(typeof s=="function")return s(e);return s};qN.exports=whe});var Xr=u((RGe,WN)=>{"use strict";var Rhe=xn(),at=oi(),Phe=function(t,e,i){e.x=at(i,"x",0),e.y=at(i,"y",0),e.depth=at(i,"depth",0),e.flipX=at(i,"flipX",!1),e.flipY=at(i,"flipY",!1);var s=at(i,"scale",null);typeof s=="number"?e.setScale(s):s!==null&&(e.scaleX=at(s,"x",1),e.scaleY=at(s,"y",1));var r=at(i,"scrollFactor",null);typeof r=="number"?e.setScrollFactor(r):r!==null&&(e.scrollFactorX=at(r,"x",1),e.scrollFactorY=at(r,"y",1)),e.rotation=at(i,"rotation",0);var n=at(i,"angle",null);n!==null&&(e.angle=n),e.alpha=at(i,"alpha",1);var a=at(i,"origin",null);if(typeof a=="number")e.setOrigin(a);else if(a!==null){var o=at(a,"x",.5),h=at(a,"y",.5);e.setOrigin(o,h)}e.blendMode=at(i,"blendMode",Rhe.NORMAL),e.visible=at(i,"visible",!0);var l=at(i,"add",!0);return l&&t.sys.displayList.add(e),e.preUpdate&&t.sys.updateList.add(e),e};WN.exports=Phe});var ki=u((PGe,zN)=>{"use strict";var _he=R(),Ihe=su(),Th=mh(),YN=ze(),yh=Wr(),HN=qe(),pm=new _he({Extends:YN,initialize:function(e,i){YN.call(this),this.scene=e,this.displayList=null,this.type=i,this.state=0,this.parentContainer=null,this.name="",this.active=!0,this.tabIndex=-1,this.data=null,this.renderFlags=15,this.cameraFilter=0,this.input=null,this.body=null,this.ignoreDestroy=!1,this.on(yh.ADDED_TO_SCENE,this.addedToScene,this),this.on(yh.REMOVED_FROM_SCENE,this.removedFromScene,this),e.sys.queueDepthSort()},setActive:function(t){return this.active=t,this},setName:function(t){return this.name=t,this},setState:function(t){return this.state=t,this},setDataEnabled:function(){return this.data||(this.data=new Th(this)),this},setData:function(t,e){return this.data||(this.data=new Th(this)),this.data.set(t,e),this},incData:function(t,e){return this.data||(this.data=new Th(this)),this.data.inc(t,e),this},toggleData:function(t){return this.data||(this.data=new Th(this)),this.data.toggle(t),this},getData:function(t){return this.data||(this.data=new Th(this)),this.data.get(t)},setInteractive:function(t,e,i){return this.scene.sys.input.enable(this,t,e,i),this},disableInteractive:function(t){return t===void 0&&(t=!1),this.scene.sys.input.disable(this,t),this},removeInteractive:function(t){return t===void 0&&(t=!1),this.scene.sys.input.clear(this),t&&this.scene.sys.input.resetCursor(),this.input=void 0,this},addedToScene:function(){},removedFromScene:function(){},update:function(){},toJSON:function(){return Ihe(this)},willRender:function(t){var e=this.displayList&&this.displayList.active?this.displayList.willRender(t):!0;return!(!e||pm.RENDER_MASK!==this.renderFlags||this.cameraFilter!==0&&this.cameraFilter&t.id)},getIndexList:function(){for(var t=this,e=this.parentContainer,i=[];e&&(i.unshift(e.getIndex(t)),t=e,e.parentContainer);)e=e.parentContainer;return this.displayList?i.unshift(this.displayList.getIndex(t)):i.unshift(this.scene.sys.displayList.getIndex(t)),i},addToDisplayList:function(t){return t===void 0&&(t=this.scene.sys.displayList),this.displayList&&this.displayList!==t&&this.removeFromDisplayList(),t.exists(this)||(this.displayList=t,t.add(this,!0),t.queueDepthSort(),this.emit(yh.ADDED_TO_SCENE,this,this.scene),t.events.emit(HN.ADDED_TO_SCENE,this,this.scene)),this},addToUpdateList:function(){return this.scene&&this.preUpdate&&this.scene.sys.updateList.add(this),this},removeFromDisplayList:function(){var t=this.displayList||this.scene.sys.displayList;return t&&t.exists(this)&&(t.remove(this,!0),t.queueDepthSort(),this.displayList=null,this.emit(yh.REMOVED_FROM_SCENE,this,this.scene),t.events.emit(HN.REMOVED_FROM_SCENE,this,this.scene)),this},removeFromUpdateList:function(){return this.scene&&this.preUpdate&&this.scene.sys.updateList.remove(this),this},getDisplayList:function(){var t=null;return this.parentContainer?t=this.parentContainer.list:this.displayList&&(t=this.displayList.list),t},destroy:function(t){!this.scene||this.ignoreDestroy||(t===void 0&&(t=!1),this.preDestroy&&this.preDestroy.call(this),this.emit(yh.DESTROY,this,t),this.removeAllListeners(),this.postPipelines&&this.resetPostPipeline(!0),this.removeFromDisplayList(),this.removeFromUpdateList(),this.input&&(this.scene.sys.input.clear(this),this.input=void 0),this.data&&(this.data.destroy(),this.data=void 0),this.body&&(this.body.destroy(),this.body=void 0),this.preFX&&(this.preFX.destroy(),this.preFX=void 0),this.postFX&&(this.postFX.destroy(),this.postFX=void 0),this.active=!1,this.visible=!1,this.scene=void 0,this.parentContainer=void 0)}});pm.RENDER_MASK=15;zN.exports=pm});var XN=u((_Ge,VN)=>{"use strict";var Lhe=function(t,e,i,s){i.addToRenderList(e);var r=e.list,n=r.length;if(n!==0){var a=e.localTransform;s?(a.loadIdentity(),a.multiply(s),a.translate(e.x,e.y),a.rotate(e.rotation),a.scale(e.scaleX,e.scaleY)):a.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),t.pipelines.preBatch(e);var o=e.blendMode!==-1;o||t.setBlendMode(0);for(var h=e.alpha,l=e.scrollFactorX,c=e.scrollFactorY,d=0;d<n;d++){var f=r[d];if(f.willRender(i)){var p,m,v,g;if(f.alphaTopLeft!==void 0)p=f.alphaTopLeft,m=f.alphaTopRight,v=f.alphaBottomLeft,g=f.alphaBottomRight;else{var S=f.alpha;p=S,m=S,v=S,g=S}var y=f.scrollFactorX,b=f.scrollFactorY;!o&&f.blendMode!==t.currentBlendMode&&t.setBlendMode(f.blendMode);var x=f.mask;x&&x.preRenderWebGL(t,f,i);var A=f.type;A!==t.currentType&&(t.newType=!0,t.currentType=A),t.nextTypeMatch=d<n-1?r[d+1].type===t.currentType:!1,f.setScrollFactor(y*l,b*c),f.setAlpha(p*h,m*h,v*h,g*h),f.renderWebGL(t,f,i,a,e),f.setAlpha(p,m,v,g),f.setScrollFactor(y,b),x&&x.postRenderWebGL(t,i),t.newType=!1}}t.pipelines.postBatch(e)}};VN.exports=Lhe});var $N=u((IGe,jN)=>{"use strict";var KN=Ie(),ZN=KN,Mhe=KN;ZN=XN();jN.exports={renderWebGL:ZN,renderCanvas:Mhe}});var mm=u((LGe,JN)=>{"use strict";var Ohe=Ze(),Dhe=function(t,e,i){i===void 0&&(i=new Ohe);var s=Math.min(t.x,e.x),r=Math.min(t.y,e.y),n=Math.max(t.right,e.right)-s,a=Math.max(t.bottom,e.bottom)-r;return i.setTo(s,r,n,a)};JN.exports=Dhe});var Ou=u((MGe,iF)=>{"use strict";var Me=jl(),Bhe=xn(),Uhe=R(),_s=ri(),vm=Wr(),QN=ki(),eF=Ze(),Nhe=$N(),Fhe=mm(),khe=Fe(),tF=new _s.TransformMatrix,Ghe=new Uhe({Extends:QN,Mixins:[_s.AlphaSingle,_s.BlendMode,_s.ComputedSize,_s.Depth,_s.Mask,_s.PostPipeline,_s.Transform,_s.Visible,Nhe],initialize:function(e,i,s,r){QN.call(this,e,"Container"),this.list=[],this.exclusive=!0,this.maxSize=-1,this.position=0,this.localTransform=new _s.TransformMatrix,this._sortKey="",this._sysEvents=e.sys.events,this.scrollFactorX=1,this.scrollFactorY=1,this.initPostPipeline(),this.setPosition(i,s),this.setBlendMode(Bhe.SKIP_CHECK),r&&this.add(r)},originX:{get:function(){return .5}},originY:{get:function(){return .5}},displayOriginX:{get:function(){return this.width*.5}},displayOriginY:{get:function(){return this.height*.5}},setExclusive:function(t){return t===void 0&&(t=!0),this.exclusive=t,this},getBounds:function(t){if(t===void 0&&(t=new eF),t.setTo(this.x,this.y,0,0),this.parentContainer){var e=this.parentContainer.getBoundsTransformMatrix(),i=e.transformPoint(this.x,this.y);t.setTo(i.x,i.y,0,0)}if(this.list.length>0){var s=this.list,r=new eF,n=!1;t.setEmpty();for(var a=0;a<s.length;a++){var o=s[a];o.getBounds&&(o.getBounds(r),n?Fhe(r,t,t):(t.setTo(r.x,r.y,r.width,r.height),n=!0))}}return t},addHandler:function(t){t.once(vm.DESTROY,this.onChildDestroyed,this),this.exclusive&&(t.parentContainer&&t.parentContainer.remove(t),t.parentContainer=this,t.removeFromDisplayList(),t.addedToScene())},removeHandler:function(t){t.off(vm.DESTROY,this.remove,this),this.exclusive&&(t.parentContainer=null,t.removedFromScene(),t.addToDisplayList())},pointToContainer:function(t,e){e===void 0&&(e=new khe),this.parentContainer?this.parentContainer.pointToContainer(t,e):(e.x=t.x,e.y=t.y);var i=tF;return i.applyITRS(this.x,this.y,this.rotation,this.scaleX,this.scaleY),i.invert(),i.transformPoint(t.x,t.y,e),e},getBoundsTransformMatrix:function(){return this.getWorldTransformMatrix(tF,this.localTransform)},add:function(t){return Me.Add(this.list,t,this.maxSize,this.addHandler,this),this},addAt:function(t,e){return Me.AddAt(this.list,t,e,this.maxSize,this.addHandler,this),this},getAt:function(t){return this.list[t]},getIndex:function(t){return this.list.indexOf(t)},sort:function(t,e){return t?(e===void 0&&(e=function(i,s){return i[t]-s[t]}),Me.StableSort(this.list,e),this):this},getByName:function(t){return Me.GetFirst(this.list,"name",t)},getRandom:function(t,e){return Me.GetRandom(this.list,t,e)},getFirst:function(t,e,i,s){return Me.GetFirst(this.list,t,e,i,s)},getAll:function(t,e,i,s){return Me.GetAll(this.list,t,e,i,s)},count:function(t,e,i,s){return Me.CountAllMatching(this.list,t,e,i,s)},swap:function(t,e){return Me.Swap(this.list,t,e),this},moveTo:function(t,e){return Me.MoveTo(this.list,t,e),this},moveAbove:function(t,e){return Me.MoveAbove(this.list,t,e),this},moveBelow:function(t,e){return Me.MoveBelow(this.list,t,e),this},remove:function(t,e){var i=Me.Remove(this.list,t,this.removeHandler,this);if(e&&i){Array.isArray(i)||(i=[i]);for(var s=0;s<i.length;s++)i[s].destroy()}return this},removeAt:function(t,e){var i=Me.RemoveAt(this.list,t,this.removeHandler,this);return e&&i&&i.destroy(),this},removeBetween:function(t,e,i){var s=Me.RemoveBetween(this.list,t,e,this.removeHandler,this);if(i)for(var r=0;r<s.length;r++)s[r].destroy();return this},removeAll:function(t){var e=this.list;if(t){for(var i=0;i<e.length;i++)e[i]&&e[i].scene&&(e[i].off(vm.DESTROY,this.onChildDestroyed,this),e[i].destroy());this.list=[]}else Me.RemoveBetween(e,0,e.length,this.removeHandler,this);return this},bringToTop:function(t){return Me.BringToTop(this.list,t),this},sendToBack:function(t){return Me.SendToBack(this.list,t),this},moveUp:function(t){return Me.MoveUp(this.list,t),this},moveDown:function(t){return Me.MoveDown(this.list,t),this},reverse:function(){return this.list.reverse(),this},shuffle:function(){return Me.Shuffle(this.list),this},replace:function(t,e,i){var s=Me.Replace(this.list,t,e);return s&&(this.addHandler(e),this.removeHandler(t),i&&t.destroy()),this},exists:function(t){return this.list.indexOf(t)>-1},setAll:function(t,e,i,s){return Me.SetAll(this.list,t,e,i,s),this},each:function(t,e){var i=[null],s,r=this.list.slice(),n=r.length;for(s=2;s<arguments.length;s++)i.push(arguments[s]);for(s=0;s<n;s++)i[0]=r[s],t.apply(e,i);return this},iterate:function(t,e){var i=[null],s;for(s=2;s<arguments.length;s++)i.push(arguments[s]);for(s=0;s<this.list.length;s++)i[0]=this.list[s],t.apply(e,i);return this},setScrollFactor:function(t,e,i){return e===void 0&&(e=t),i===void 0&&(i=!1),this.scrollFactorX=t,this.scrollFactorY=e,i&&(Me.SetAll(this.list,"scrollFactorX",t),Me.SetAll(this.list,"scrollFactorY",e)),this},length:{get:function(){return this.list.length}},first:{get:function(){return this.position=0,this.list.length>0?this.list[0]:null}},last:{get:function(){return this.list.length>0?(this.position=this.list.length-1,this.list[this.position]):null}},next:{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}},previous:{get:function(){return this.position>0?(this.position--,this.list[this.position]):null}},preDestroy:function(){this.removeAll(!!this.exclusive),this.localTransform.destroy(),this.list=[]},onChildDestroyed:function(t){Me.Remove(this.list,t),this.exclusive&&(t.parentContainer=null,t.removedFromScene())}});iF.exports=Ghe});var rF=u((OGe,sF)=>{"use strict";var qhe=zr(),Whe=function(t,e,i,s){t.pipelines.clear();var r=qhe(e,i,s).calc;e.render.call(e,t,i,r),t.pipelines.rebind()};sF.exports=Whe});var hF=u((DGe,oF)=>{"use strict";var nF=Ie(),aF=nF,Yhe=nF;aF=rF();oF.exports={renderWebGL:aF,renderCanvas:Yhe}});var gm=u((BGe,uF)=>{"use strict";var Hhe=R(),ns=ri(),lF=ki(),zhe=hF(),Vhe=new Hhe({Extends:lF,Mixins:[ns.Alpha,ns.BlendMode,ns.Depth,ns.Flip,ns.Origin,ns.ScrollFactor,ns.Size,ns.Texture,ns.Tint,ns.Transform,ns.Visible,zhe],initialize:function(e){lF.call(this,e,"Extern")},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},preUpdate:function(){},render:function(){}});uF.exports=Vhe});var Du=u((UGe,cF)=>{"use strict";cF.exports={ARC:0,BEGIN_PATH:1,CLOSE_PATH:2,FILL_RECT:3,LINE_TO:4,MOVE_TO:5,LINE_STYLE:6,FILL_STYLE:7,FILL_PATH:8,STROKE_PATH:9,FILL_TRIANGLE:10,STROKE_TRIANGLE:11,SAVE:14,RESTORE:15,TRANSLATE:16,SCALE:17,ROTATE:18,GRADIENT_FILL_STYLE:21,GRADIENT_LINE_STYLE:22}});var Ti=u((NGe,dF)=>{"use strict";dF.exports={getTintFromFloats:function(t,e,i,s){var r=(t*255|0)&255,n=(e*255|0)&255,a=(i*255|0)&255,o=(s*255|0)&255;return(o<<24|r<<16|n<<8|a)>>>0},getTintAppendFloatAlpha:function(t,e){var i=(e*255|0)&255;return(i<<24|t)>>>0},getTintAppendFloatAlphaAndSwap:function(t,e){var i=(t>>16|0)&255,s=(t>>8|0)&255,r=(t|0)&255,n=(e*255|0)&255;return(n<<24|r<<16|s<<8|i)>>>0},getFloatsFromUintRGB:function(t){var e=(t>>16|0)&255,i=(t>>8|0)&255,s=(t|0)&255;return[e/255,i/255,s/255]},checkShaderMax:function(t,e){var i=Math.min(16,t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS));return!e||e===-1?i:Math.min(i,e)},parseFragmentShaderMaxTextures:function(t,e){if(!t)return"";for(var i="",s=0;s<e;s++)s>0&&(i+=`
	else `),s<e-1&&(i+="if (outTexId < "+s+".5)"),i+=`
	{`,i+=`
		texture = texture2D(uMainSampler[`+s+"], outTexCoord);",i+=`
	}`;return t=t.replace(/%count%/gi,e.toString()),t.replace(/%forloop%/gi,i)},setGlowQuality:function(t,e,i,s){return i===void 0&&(i=e.config.glowFXQuality),s===void 0&&(s=e.config.glowFXDistance),t=t.replace(/__SIZE__/gi,(1/i/s).toFixed(7)),t=t.replace(/__DIST__/gi,s.toFixed(0)+".0"),t}}});var mF=u((FGe,pF)=>{"use strict";var pt=Du(),Xhe=zr(),Khe=ws(),Zhe=Ti(),Bu=function(t,e,i){this.x=t,this.y=e,this.width=i},Sm=function(t,e,i){this.points=[],this.pointsLength=1,this.points[0]=new Bu(t,e,i)},fF=[],jhe=new Khe,$he=function(t,e,i,s){if(e.commandBuffer.length!==0){i.addToRenderList(e);var r=t.pipelines.set(e.pipeline,e);t.pipelines.preBatch(e);for(var n=Xhe(e,i,s).calc,a=jhe.loadIdentity(),o=e.commandBuffer,h=i.alpha*e.alpha,l=1,c=r.fillTint,d=r.strokeTint,f=0,p=0,m=0,v=.01,g=Math.PI*2,S,y=[],b=0,x=!0,A=null,w=Zhe.getTintAppendFloatAlpha,C=0;C<o.length;C++)switch(S=o[C],S){case pt.BEGIN_PATH:{y.length=0,A=null,x=!0;break}case pt.CLOSE_PATH:{x=!1,A&&A.points.length&&A.points.push(A.points[0]);break}case pt.FILL_PATH:{for(b=0;b<y.length;b++)r.batchFillPath(y[b].points,a,n);break}case pt.STROKE_PATH:{for(b=0;b<y.length;b++)r.batchStrokePath(y[b].points,l,x,a,n);break}case pt.LINE_STYLE:{l=o[++C];var _=o[++C],N=o[++C]*h,D=w(_,N);d.TL=D,d.TR=D,d.BL=D,d.BR=D;break}case pt.FILL_STYLE:{var Y=o[++C],$=o[++C]*h,j=w(Y,$);c.TL=j,c.TR=j,c.BL=j,c.BR=j;break}case pt.GRADIENT_FILL_STYLE:{var G=o[++C]*h,Z=o[++C]*h,ee=o[++C]*h,te=o[++C]*h;c.TL=w(o[++C],G),c.TR=w(o[++C],Z),c.BL=w(o[++C],ee),c.BR=w(o[++C],te);break}case pt.GRADIENT_LINE_STYLE:{l=o[++C];var Q=o[++C]*h;d.TL=w(o[++C],Q),d.TR=w(o[++C],Q),d.BL=w(o[++C],Q),d.BR=w(o[++C],Q);break}case pt.ARC:{var Ae=0,gt=o[++C],St=o[++C],rt=o[++C],Et=o[++C],Ee=o[++C],ut=o[++C],Ca=o[++C];for(Ee-=Et,ut?Ee<-g?Ee=-g:Ee>0&&(Ee=-g+Ee%g):Ee>g?Ee=g:Ee<0&&(Ee=g+Ee%g),A===null&&(A=new Sm(gt+Math.cos(Et)*rt,St+Math.sin(Et)*rt,l),y.push(A),Ae+=v);Ae<1+Ca;)m=Ee*Ae+Et,f=gt+Math.cos(m)*rt,p=St+Math.sin(m)*rt,A.points.push(new Bu(f,p,l)),Ae+=v;m=Ee+Et,f=gt+Math.cos(m)*rt,p=St+Math.sin(m)*rt,A.points.push(new Bu(f,p,l));break}case pt.FILL_RECT:{r.batchFillRect(o[++C],o[++C],o[++C],o[++C],a,n);break}case pt.FILL_TRIANGLE:{r.batchFillTriangle(o[++C],o[++C],o[++C],o[++C],o[++C],o[++C],a,n);break}case pt.STROKE_TRIANGLE:{r.batchStrokeTriangle(o[++C],o[++C],o[++C],o[++C],o[++C],o[++C],l,a,n);break}case pt.LINE_TO:{A!==null?A.points.push(new Bu(o[++C],o[++C],l)):(A=new Sm(o[++C],o[++C],l),y.push(A));break}case pt.MOVE_TO:{A=new Sm(o[++C],o[++C],l),y.push(A);break}case pt.SAVE:{fF.push(a.copyToArray());break}case pt.RESTORE:{a.copyFromArray(fF.pop());break}case pt.TRANSLATE:{gt=o[++C],St=o[++C],a.translate(gt,St);break}case pt.SCALE:{gt=o[++C],St=o[++C],a.scale(gt,St);break}case pt.ROTATE:{a.rotate(o[++C]);break}}t.pipelines.postBatch(e)}};pF.exports=$he});var gF=u((kGe,vF)=>{"use strict";var Jhe=zr(),Qhe=function(t,e,i,s,r){var n=s.alpha*i.alpha;if(n<=0)return!1;var a=Jhe(i,s,r).calc;return e.globalCompositeOperation=t.blendModes[i.blendMode],e.globalAlpha=n,e.save(),a.setToContext(e),e.imageSmoothingEnabled=i.frame?!i.frame.source.scaleMode:t.antialias,!0};vF.exports=Qhe});var EF=u((GGe,SF)=>{"use strict";var Qe=Du(),ele=gF(),tle=function(t,e,i,s,r,n){var a=e.commandBuffer,o=a.length,h=r||t.currentContext;if(!(o===0||!ele(t,h,e,i,s))){i.addToRenderList(e);var l=1,c=1,d=0,f=0,p=1,m=0,v=0,g=0;h.beginPath();for(var S=0;S<o;++S){var y=a[S];switch(y){case Qe.ARC:h.arc(a[S+1],a[S+2],a[S+3],a[S+4],a[S+5],a[S+6]),S+=7;break;case Qe.LINE_STYLE:p=a[S+1],d=a[S+2],l=a[S+3],m=(d&16711680)>>>16,v=(d&65280)>>>8,g=d&255,h.strokeStyle="rgba("+m+","+v+","+g+","+l+")",h.lineWidth=p,S+=3;break;case Qe.FILL_STYLE:f=a[S+1],c=a[S+2],m=(f&16711680)>>>16,v=(f&65280)>>>8,g=f&255,h.fillStyle="rgba("+m+","+v+","+g+","+c+")",S+=2;break;case Qe.BEGIN_PATH:h.beginPath();break;case Qe.CLOSE_PATH:h.closePath();break;case Qe.FILL_PATH:n||h.fill();break;case Qe.STROKE_PATH:n||h.stroke();break;case Qe.FILL_RECT:n?h.rect(a[S+1],a[S+2],a[S+3],a[S+4]):h.fillRect(a[S+1],a[S+2],a[S+3],a[S+4]),S+=4;break;case Qe.FILL_TRIANGLE:h.beginPath(),h.moveTo(a[S+1],a[S+2]),h.lineTo(a[S+3],a[S+4]),h.lineTo(a[S+5],a[S+6]),h.closePath(),n||h.fill(),S+=6;break;case Qe.STROKE_TRIANGLE:h.beginPath(),h.moveTo(a[S+1],a[S+2]),h.lineTo(a[S+3],a[S+4]),h.lineTo(a[S+5],a[S+6]),h.closePath(),n||h.stroke(),S+=6;break;case Qe.LINE_TO:h.lineTo(a[S+1],a[S+2]),S+=2;break;case Qe.MOVE_TO:h.moveTo(a[S+1],a[S+2]),S+=2;break;case Qe.LINE_FX_TO:h.lineTo(a[S+1],a[S+2]),S+=5;break;case Qe.MOVE_FX_TO:h.moveTo(a[S+1],a[S+2]),S+=5;break;case Qe.SAVE:h.save();break;case Qe.RESTORE:h.restore();break;case Qe.TRANSLATE:h.translate(a[S+1],a[S+2]),S+=2;break;case Qe.SCALE:h.scale(a[S+1],a[S+2]),S+=2;break;case Qe.ROTATE:h.rotate(a[S+1]),S+=1;break;case Qe.GRADIENT_FILL_STYLE:S+=5;break;case Qe.GRADIENT_LINE_STYLE:S+=6;break}}h.restore()}};SF.exports=tle});var xF=u((qGe,AF)=>{"use strict";var TF=Ie(),yF=TF,bF=TF;yF=mF(),bF=EF();AF.exports={renderWebGL:yF,renderCanvas:bF}});var Uu=u((WGe,wF)=>{"use strict";var ile=lu(),sle=R(),Oe=Du(),lr=ri(),CF=ki(),Kr=re(),ur=Ne(),yt=Kt(),rle=xF(),On=new sle({Extends:CF,Mixins:[lr.AlphaSingle,lr.BlendMode,lr.Depth,lr.Mask,lr.Pipeline,lr.PostPipeline,lr.Transform,lr.Visible,lr.ScrollFactor,rle],initialize:function(e,i){var s=ur(i,"x",0),r=ur(i,"y",0);CF.call(this,e,"Graphics"),this.setPosition(s,r),this.initPipeline(),this.initPostPipeline(),this.displayOriginX=0,this.displayOriginY=0,this.commandBuffer=[],this.defaultFillColor=-1,this.defaultFillAlpha=1,this.defaultStrokeWidth=1,this.defaultStrokeColor=-1,this.defaultStrokeAlpha=1,this._lineWidth=1,this.lineStyle(1,0,0),this.fillStyle(0,0),this.setDefaultStyles(i)},setDefaultStyles:function(t){return ur(t,"lineStyle",null)&&(this.defaultStrokeWidth=ur(t,"lineStyle.width",1),this.defaultStrokeColor=ur(t,"lineStyle.color",16777215),this.defaultStrokeAlpha=ur(t,"lineStyle.alpha",1),this.lineStyle(this.defaultStrokeWidth,this.defaultStrokeColor,this.defaultStrokeAlpha)),ur(t,"fillStyle",null)&&(this.defaultFillColor=ur(t,"fillStyle.color",16777215),this.defaultFillAlpha=ur(t,"fillStyle.alpha",1),this.fillStyle(this.defaultFillColor,this.defaultFillAlpha)),this},lineStyle:function(t,e,i){return i===void 0&&(i=1),this.commandBuffer.push(Oe.LINE_STYLE,t,e,i),this._lineWidth=t,this},fillStyle:function(t,e){return e===void 0&&(e=1),this.commandBuffer.push(Oe.FILL_STYLE,t,e),this},fillGradientStyle:function(t,e,i,s,r,n,a,o){return r===void 0&&(r=1),n===void 0&&(n=r),a===void 0&&(a=r),o===void 0&&(o=r),this.commandBuffer.push(Oe.GRADIENT_FILL_STYLE,r,n,a,o,t,e,i,s),this},lineGradientStyle:function(t,e,i,s,r,n){return n===void 0&&(n=1),this.commandBuffer.push(Oe.GRADIENT_LINE_STYLE,t,n,e,i,s,r),this},beginPath:function(){return this.commandBuffer.push(Oe.BEGIN_PATH),this},closePath:function(){return this.commandBuffer.push(Oe.CLOSE_PATH),this},fillPath:function(){return this.commandBuffer.push(Oe.FILL_PATH),this},fill:function(){return this.commandBuffer.push(Oe.FILL_PATH),this},strokePath:function(){return this.commandBuffer.push(Oe.STROKE_PATH),this},stroke:function(){return this.commandBuffer.push(Oe.STROKE_PATH),this},fillCircleShape:function(t){return this.fillCircle(t.x,t.y,t.radius)},strokeCircleShape:function(t){return this.strokeCircle(t.x,t.y,t.radius)},fillCircle:function(t,e,i){return this.beginPath(),this.arc(t,e,i,0,yt.PI2),this.fillPath(),this},strokeCircle:function(t,e,i){return this.beginPath(),this.arc(t,e,i,0,yt.PI2),this.strokePath(),this},fillRectShape:function(t){return this.fillRect(t.x,t.y,t.width,t.height)},strokeRectShape:function(t){return this.strokeRect(t.x,t.y,t.width,t.height)},fillRect:function(t,e,i,s){return this.commandBuffer.push(Oe.FILL_RECT,t,e,i,s),this},strokeRect:function(t,e,i,s){var r=this._lineWidth/2,n=t-r,a=t+r;return this.beginPath(),this.moveTo(t,e),this.lineTo(t,e+s),this.strokePath(),this.beginPath(),this.moveTo(t+i,e),this.lineTo(t+i,e+s),this.strokePath(),this.beginPath(),this.moveTo(n,e),this.lineTo(a+i,e),this.strokePath(),this.beginPath(),this.moveTo(n,e+s),this.lineTo(a+i,e+s),this.strokePath(),this},fillRoundedRect:function(t,e,i,s,r){r===void 0&&(r=20);var n=r,a=r,o=r,h=r;typeof r!="number"&&(n=Kr(r,"tl",20),a=Kr(r,"tr",20),o=Kr(r,"bl",20),h=Kr(r,"br",20));var l=n>=0,c=a>=0,d=o>=0,f=h>=0;return n=Math.abs(n),a=Math.abs(a),o=Math.abs(o),h=Math.abs(h),this.beginPath(),this.moveTo(t+n,e),this.lineTo(t+i-a,e),c?this.arc(t+i-a,e+a,a,-yt.TAU,0):this.arc(t+i,e,a,Math.PI,yt.TAU,!0),this.lineTo(t+i,e+s-h),f?this.arc(t+i-h,e+s-h,h,0,yt.TAU):this.arc(t+i,e+s,h,-yt.TAU,Math.PI,!0),this.lineTo(t+o,e+s),d?this.arc(t+o,e+s-o,o,yt.TAU,Math.PI):this.arc(t,e+s,o,0,-yt.TAU,!0),this.lineTo(t,e+n),l?this.arc(t+n,e+n,n,-Math.PI,-yt.TAU):this.arc(t,e,n,yt.TAU,0,!0),this.fillPath(),this},strokeRoundedRect:function(t,e,i,s,r){r===void 0&&(r=20);var n=r,a=r,o=r,h=r,l=Math.min(i,s)/2;typeof r!="number"&&(n=Kr(r,"tl",20),a=Kr(r,"tr",20),o=Kr(r,"bl",20),h=Kr(r,"br",20));var c=n>=0,d=a>=0,f=o>=0,p=h>=0;return n=Math.min(Math.abs(n),l),a=Math.min(Math.abs(a),l),o=Math.min(Math.abs(o),l),h=Math.min(Math.abs(h),l),this.beginPath(),this.moveTo(t+n,e),this.lineTo(t+i-a,e),this.moveTo(t+i-a,e),d?this.arc(t+i-a,e+a,a,-yt.TAU,0):this.arc(t+i,e,a,Math.PI,yt.TAU,!0),this.lineTo(t+i,e+s-h),this.moveTo(t+i,e+s-h),p?this.arc(t+i-h,e+s-h,h,0,yt.TAU):this.arc(t+i,e+s,h,-yt.TAU,Math.PI,!0),this.lineTo(t+o,e+s),this.moveTo(t+o,e+s),f?this.arc(t+o,e+s-o,o,yt.TAU,Math.PI):this.arc(t,e+s,o,0,-yt.TAU,!0),this.lineTo(t,e+n),this.moveTo(t,e+n),c?this.arc(t+n,e+n,n,-Math.PI,-yt.TAU):this.arc(t,e,n,yt.TAU,0,!0),this.strokePath(),this},fillPointShape:function(t,e){return this.fillPoint(t.x,t.y,e)},fillPoint:function(t,e,i){return!i||i<1?i=1:(t-=i/2,e-=i/2),this.commandBuffer.push(Oe.FILL_RECT,t,e,i,i),this},fillTriangleShape:function(t){return this.fillTriangle(t.x1,t.y1,t.x2,t.y2,t.x3,t.y3)},strokeTriangleShape:function(t){return this.strokeTriangle(t.x1,t.y1,t.x2,t.y2,t.x3,t.y3)},fillTriangle:function(t,e,i,s,r,n){return this.commandBuffer.push(Oe.FILL_TRIANGLE,t,e,i,s,r,n),this},strokeTriangle:function(t,e,i,s,r,n){return this.commandBuffer.push(Oe.STROKE_TRIANGLE,t,e,i,s,r,n),this},strokeLineShape:function(t){return this.lineBetween(t.x1,t.y1,t.x2,t.y2)},lineBetween:function(t,e,i,s){return this.beginPath(),this.moveTo(t,e),this.lineTo(i,s),this.strokePath(),this},lineTo:function(t,e){return this.commandBuffer.push(Oe.LINE_TO,t,e),this},moveTo:function(t,e){return this.commandBuffer.push(Oe.MOVE_TO,t,e),this},strokePoints:function(t,e,i,s){e===void 0&&(e=!1),i===void 0&&(i=!1),s===void 0&&(s=t.length),this.beginPath(),this.moveTo(t[0].x,t[0].y);for(var r=1;r<s;r++)this.lineTo(t[r].x,t[r].y);return e&&this.lineTo(t[0].x,t[0].y),i&&this.closePath(),this.strokePath(),this},fillPoints:function(t,e,i,s){e===void 0&&(e=!1),i===void 0&&(i=!1),s===void 0&&(s=t.length),this.beginPath(),this.moveTo(t[0].x,t[0].y);for(var r=1;r<s;r++)this.lineTo(t[r].x,t[r].y);return e&&this.lineTo(t[0].x,t[0].y),i&&this.closePath(),this.fillPath(),this},strokeEllipseShape:function(t,e){e===void 0&&(e=32);var i=t.getPoints(e);return this.strokePoints(i,!0)},arc:function(t,e,i,s,r,n,a){return n===void 0&&(n=!1),a===void 0&&(a=0),this.commandBuffer.push(Oe.ARC,t,e,i,s,r,n,a),this},slice:function(t,e,i,s,r,n,a){return n===void 0&&(n=!1),a===void 0&&(a=0),this.commandBuffer.push(Oe.BEGIN_PATH),this.commandBuffer.push(Oe.MOVE_TO,t,e),this.commandBuffer.push(Oe.ARC,t,e,i,s,r,n,a),this.commandBuffer.push(Oe.CLOSE_PATH),this},save:function(){return this.commandBuffer.push(Oe.SAVE),this},restore:function(){return this.commandBuffer.push(Oe.RESTORE),this},translateCanvas:function(t,e){return this.commandBuffer.push(Oe.TRANSLATE,t,e),this},scaleCanvas:function(t,e){return this.commandBuffer.push(Oe.SCALE,t,e),this},rotateCanvas:function(t){return this.commandBuffer.push(Oe.ROTATE,t),this},clear:function(){return this.commandBuffer.length=0,this.defaultFillColor>-1&&this.fillStyle(this.defaultFillColor,this.defaultFillAlpha),this.defaultStrokeColor>-1&&this.lineStyle(this.defaultStrokeWidth,this.defaultStrokeColor,this.defaultStrokeAlpha),this},generateTexture:function(t,e,i){var s=this.scene.sys,r=s.game.renderer;e===void 0&&(e=s.scale.width),i===void 0&&(i=s.scale.height),On.TargetCamera.setScene(this.scene),On.TargetCamera.setViewport(0,0,e,i),On.TargetCamera.scrollX=this.x,On.TargetCamera.scrollY=this.y;var n,a,o={willReadFrequently:!0};if(typeof t=="string")if(s.textures.exists(t)){n=s.textures.get(t);var h=n.getSourceImage();h instanceof HTMLCanvasElement&&(a=h.getContext("2d",o))}else n=s.textures.createCanvas(t,e,i),a=n.getSourceImage().getContext("2d",o);else t instanceof HTMLCanvasElement&&(a=t.getContext("2d",o));return a&&(this.renderCanvas(r,this,On.TargetCamera,null,a,!1),n&&n.refresh()),this},preDestroy:function(){this.commandBuffer=[]}});On.TargetCamera=new ile;wF.exports=On});var bh=u((YGe,RF)=>{"use strict";var nle={TOP_LEFT:0,TOP_CENTER:1,TOP_RIGHT:2,LEFT_TOP:3,LEFT_CENTER:4,LEFT_BOTTOM:5,CENTER:6,RIGHT_TOP:7,RIGHT_CENTER:8,RIGHT_BOTTOM:9,BOTTOM_LEFT:10,BOTTOM_CENTER:11,BOTTOM_RIGHT:12};RF.exports=nle});var as=u((HGe,PF)=>{"use strict";var ale=function(t){return t.y+t.height-t.height*t.originY};PF.exports=ale});var Dn=u((zGe,_F)=>{"use strict";var ole=function(t){return t.x-t.width*t.originX+t.width*.5};_F.exports=ole});var Bn=u((VGe,IF)=>{"use strict";var hle=function(t,e){var i=t.width*t.originX;return t.x=e+i-t.width*.5,t};IF.exports=hle});var Is=u((XGe,LF)=>{"use strict";var lle=function(t,e){return t.y=e+t.height*t.originY,t};LF.exports=lle});var Em=u((KGe,MF)=>{"use strict";var ule=as(),cle=Dn(),dle=Bn(),fle=Is(),ple=function(t,e,i,s){return i===void 0&&(i=0),s===void 0&&(s=0),dle(t,cle(e)+i),fle(t,ule(e)+s),t};MF.exports=ple});var os=u((ZGe,OF)=>{"use strict";var mle=function(t){return t.x-t.width*t.originX};OF.exports=mle});var Ls=u((jGe,DF)=>{"use strict";var vle=function(t,e){return t.x=e+t.width*t.originX,t};DF.exports=vle});var Tm=u(($Ge,BF)=>{"use strict";var gle=as(),Sle=os(),Ele=Ls(),Tle=Is(),yle=function(t,e,i,s){return i===void 0&&(i=0),s===void 0&&(s=0),Ele(t,Sle(e)-i),Tle(t,gle(e)+s),t};BF.exports=yle});var hs=u((JGe,UF)=>{"use strict";var ble=function(t){return t.x+t.width-t.width*t.originX};UF.exports=ble});var Ms=u((QGe,NF)=>{"use strict";var Ale=function(t,e){return t.x=e-t.width+t.width*t.originX,t};NF.exports=Ale});var ym=u((eqe,FF)=>{"use strict";var xle=as(),Cle=hs(),wle=Ms(),Rle=Is(),Ple=function(t,e,i,s){return i===void 0&&(i=0),s===void 0&&(s=0),wle(t,Cle(e)+i),Rle(t,xle(e)+s),t};FF.exports=Ple});var Os=u((tqe,kF)=>{"use strict";var _le=function(t,e){return t.y=e-t.height+t.height*t.originY,t};kF.exports=_le});var bm=u((iqe,GF)=>{"use strict";var Ile=as(),Lle=os(),Mle=Os(),Ole=Ms(),Dle=function(t,e,i,s){return i===void 0&&(i=0),s===void 0&&(s=0),Ole(t,Lle(e)-i),Mle(t,Ile(e)+s),t};GF.exports=Dle});var Un=u((sqe,qF)=>{"use strict";var Ble=function(t){return t.y-t.height*t.originY+t.height*.5};qF.exports=Ble});var Nn=u((rqe,WF)=>{"use strict";var Ule=function(t,e){var i=t.height*t.originY;return t.y=e+i-t.height*.5,t};WF.exports=Ule});var Am=u((nqe,YF)=>{"use strict";var Nle=Un(),Fle=os(),kle=Nn(),Gle=Ms(),qle=function(t,e,i,s){return i===void 0&&(i=0),s===void 0&&(s=0),Gle(t,Fle(e)-i),kle(t,Nle(e)+s),t};YF.exports=qle});var ls=u((aqe,HF)=>{"use strict";var Wle=function(t){return t.y-t.height*t.originY};HF.exports=Wle});var xm=u((oqe,zF)=>{"use strict";var Yle=os(),Hle=ls(),zle=Ms(),Vle=Is(),Xle=function(t,e,i,s){return i===void 0&&(i=0),s===void 0&&(s=0),zle(t,Yle(e)-i),Vle(t,Hle(e)-s),t};zF.exports=Xle});var Cm=u((hqe,VF)=>{"use strict";var Kle=as(),Zle=hs(),jle=Os(),$le=Ls(),Jle=function(t,e,i,s){return i===void 0&&(i=0),s===void 0&&(s=0),$le(t,Zle(e)+i),jle(t,Kle(e)+s),t};VF.exports=Jle});var wm=u((lqe,XF)=>{"use strict";var Qle=Un(),eue=hs(),tue=Nn(),iue=Ls(),sue=function(t,e,i,s){return i===void 0&&(i=0),s===void 0&&(s=0),iue(t,eue(e)+i),tue(t,Qle(e)+s),t};XF.exports=sue});var Rm=u((uqe,KF)=>{"use strict";var rue=hs(),nue=ls(),aue=Ls(),oue=Is(),hue=function(t,e,i,s){return i===void 0&&(i=0),s===void 0&&(s=0),aue(t,rue(e)+i),oue(t,nue(e)-s),t};KF.exports=hue});var Pm=u((cqe,ZF)=>{"use strict";var lue=Dn(),uue=ls(),cue=Os(),due=Bn(),fue=function(t,e,i,s){return i===void 0&&(i=0),s===void 0&&(s=0),due(t,lue(e)+i),cue(t,uue(e)-s),t};ZF.exports=fue});var _m=u((dqe,jF)=>{"use strict";var pue=os(),mue=ls(),vue=Os(),gue=Ls(),Sue=function(t,e,i,s){return i===void 0&&(i=0),s===void 0&&(s=0),gue(t,pue(e)-i),vue(t,mue(e)-s),t};jF.exports=Sue});var Im=u((fqe,$F)=>{"use strict";var Eue=hs(),Tue=ls(),yue=Os(),bue=Ms(),Aue=function(t,e,i,s){return i===void 0&&(i=0),s===void 0&&(s=0),bue(t,Eue(e)+i),yue(t,Tue(e)-s),t};$F.exports=Aue});var Lm=u((pqe,JF)=>{"use strict";var Gi=bh(),yi=[];yi[Gi.BOTTOM_CENTER]=Em();yi[Gi.BOTTOM_LEFT]=Tm();yi[Gi.BOTTOM_RIGHT]=ym();yi[Gi.LEFT_BOTTOM]=bm();yi[Gi.LEFT_CENTER]=Am();yi[Gi.LEFT_TOP]=xm();yi[Gi.RIGHT_BOTTOM]=Cm();yi[Gi.RIGHT_CENTER]=wm();yi[Gi.RIGHT_TOP]=Rm();yi[Gi.TOP_CENTER]=Pm();yi[Gi.TOP_LEFT]=_m();yi[Gi.TOP_RIGHT]=Im();var xue=function(t,e,i,s,r){return yi[i](t,e,s,r)};JF.exports=xue});var ek=u((mqe,QF)=>{"use strict";var Cue=Lm(),wue=function(t,e,i,s){for(var r=t[0],n=1;n<t.length;n++){var a=t[n];Cue(a,r,e,i,s),r=a}return t};QF.exports=wue});var us=u((vqe,tk)=>{"use strict";var Rue=function(t,e,i,s,r,n){s===void 0&&(s=0),r===void 0&&(r=0),n===void 0&&(n=1);var a,o=0,h=t.length;if(n===1)for(a=r;a<h;a++)t[a][e]+=i+o*s,o++;else for(a=r;a>=0;a--)t[a][e]+=i+o*s,o++;return t};tk.exports=Rue});var sk=u((gqe,ik)=>{"use strict";var Pue=us(),_ue=function(t,e,i,s,r){return Pue(t,"angle",e,i,s,r)};ik.exports=_ue});var nk=u((Sqe,rk)=>{"use strict";var Iue=function(t,e,i){for(var s=0;s<t.length;s++){var r=t[s];e.call(i,r)}return t};rk.exports=Iue});var ok=u((Eqe,ak)=>{"use strict";var Lue=function(t,e,i){i===void 0&&(i=0);for(var s=i;s<t.length;s++){var r=t[s],n=!0;for(var a in e)r[a]!==e[a]&&(n=!1);if(n)return r}return null};ak.exports=Lue});var lk=u((Tqe,hk)=>{"use strict";var Mue=function(t,e,i){i===void 0&&(i=0);for(var s=t.length-1;s>=i;s--){var r=t[s],n=!0;for(var a in e)r[a]!==e[a]&&(n=!1);if(n)return r}return null};hk.exports=Mue});var Mm=u((yqe,uk)=>{"use strict";var Oue=as(),Due=Dn(),Bue=Os(),Uue=Bn(),Nue=function(t,e,i,s){return i===void 0&&(i=0),s===void 0&&(s=0),Uue(t,Due(e)+i),Bue(t,Oue(e)+s),t};uk.exports=Nue});var Om=u((bqe,ck)=>{"use strict";var Fue=as(),kue=os(),Gue=Os(),que=Ls(),Wue=function(t,e,i,s){return i===void 0&&(i=0),s===void 0&&(s=0),que(t,kue(e)-i),Gue(t,Fue(e)+s),t};ck.exports=Wue});var Dm=u((Aqe,dk)=>{"use strict";var Yue=as(),Hue=hs(),zue=Os(),Vue=Ms(),Xue=function(t,e,i,s){return i===void 0&&(i=0),s===void 0&&(s=0),Vue(t,Hue(e)+i),zue(t,Yue(e)+s),t};dk.exports=Xue});var Bm=u((xqe,fk)=>{"use strict";var Kue=Bn(),Zue=Nn(),jue=function(t,e,i){return Kue(t,e),Zue(t,i)};fk.exports=jue});var Um=u((Cqe,pk)=>{"use strict";var $ue=Bm(),Jue=Dn(),Que=Un(),ece=function(t,e,i,s){return i===void 0&&(i=0),s===void 0&&(s=0),$ue(t,Jue(e)+i,Que(e)+s),t};pk.exports=ece});var Nm=u((wqe,mk)=>{"use strict";var tce=Un(),ice=os(),sce=Nn(),rce=Ls(),nce=function(t,e,i,s){return i===void 0&&(i=0),s===void 0&&(s=0),rce(t,ice(e)-i),sce(t,tce(e)+s),t};mk.exports=nce});var Fm=u((Rqe,vk)=>{"use strict";var ace=Un(),oce=hs(),hce=Nn(),lce=Ms(),uce=function(t,e,i,s){return i===void 0&&(i=0),s===void 0&&(s=0),lce(t,oce(e)+i),hce(t,ace(e)+s),t};vk.exports=uce});var km=u((Pqe,gk)=>{"use strict";var cce=Dn(),dce=ls(),fce=Bn(),pce=Is(),mce=function(t,e,i,s){return i===void 0&&(i=0),s===void 0&&(s=0),fce(t,cce(e)+i),pce(t,dce(e)-s),t};gk.exports=mce});var Gm=u((_qe,Sk)=>{"use strict";var vce=os(),gce=ls(),Sce=Ls(),Ece=Is(),Tce=function(t,e,i,s){return i===void 0&&(i=0),s===void 0&&(s=0),Sce(t,vce(e)-i),Ece(t,gce(e)-s),t};Sk.exports=Tce});var qm=u((Iqe,Ek)=>{"use strict";var yce=hs(),bce=ls(),Ace=Ms(),xce=Is(),Cce=function(t,e,i,s){return i===void 0&&(i=0),s===void 0&&(s=0),Ace(t,yce(e)+i),xce(t,bce(e)-s),t};Ek.exports=Cce});var Wm=u((Lqe,Tk)=>{"use strict";var _t=bh(),bt=[];bt[_t.BOTTOM_CENTER]=Mm();bt[_t.BOTTOM_LEFT]=Om();bt[_t.BOTTOM_RIGHT]=Dm();bt[_t.CENTER]=Um();bt[_t.LEFT_CENTER]=Nm();bt[_t.RIGHT_CENTER]=Fm();bt[_t.TOP_CENTER]=km();bt[_t.TOP_LEFT]=Gm();bt[_t.TOP_RIGHT]=qm();bt[_t.LEFT_BOTTOM]=bt[_t.BOTTOM_LEFT];bt[_t.LEFT_TOP]=bt[_t.TOP_LEFT];bt[_t.RIGHT_BOTTOM]=bt[_t.BOTTOM_RIGHT];bt[_t.RIGHT_TOP]=bt[_t.TOP_RIGHT];var wce=function(t,e,i,s,r){return bt[i](t,e,s,r)};Tk.exports=wce});var Xa=u((Mqe,yk)=>{"use strict";var Rce=function(t,e,i){if(t.radius>0&&e>=t.left&&e<=t.right&&i>=t.top&&i<=t.bottom){var s=(t.x-e)*(t.x-e),r=(t.y-i)*(t.y-i);return s+r<=t.radius*t.radius}else return!1};yk.exports=Rce});var Nu=u((Oqe,bk)=>{"use strict";var Pce=Ct(),_ce=function(t,e,i){return i===void 0&&(i=new Pce),i.x=t.x+t.radius*Math.cos(e),i.y=t.y+t.radius*Math.sin(e),i};bk.exports=_ce});var Ym=u((Dqe,Ak)=>{"use strict";var Ice=Je(),Lce=function(t,e,i){return t=Ice(t,0,1),(i-e)*t+e};Ak.exports=Lce});var Hm=u((Bqe,xk)=>{"use strict";var Mce=Nu(),Oce=Ym(),Dce=Kt(),Bce=Ct(),Uce=function(t,e,i){i===void 0&&(i=new Bce);var s=Oce(e,0,Dce.PI2);return Mce(t,s,i)};xk.exports=Uce});var zm=u((Uqe,Ck)=>{"use strict";var Nce=function(t){return 2*(Math.PI*t.radius)};Ck.exports=Nce});var Vm=u((Nqe,wk)=>{"use strict";var Fce=zm(),kce=Nu(),Gce=Ym(),qce=Kt(),Wce=function(t,e,i,s){s===void 0&&(s=[]),!e&&i>0&&(e=Fce(t)/i);for(var r=0;r<e;r++){var n=Gce(r/e,0,qce.PI2);s.push(kce(t,n))}return s};wk.exports=Wce});var Fu=u((Fqe,Rk)=>{"use strict";var Yce=Ct(),Hce=function(t,e){e===void 0&&(e=new Yce);var i=2*Math.PI*Math.random(),s=Math.random()+Math.random(),r=s>1?2-s:s,n=r*Math.cos(i),a=r*Math.sin(i);return e.x=t.x+n*t.radius,e.y=t.y+a*t.radius,e};Rk.exports=Hce});var ku=u((kqe,Pk)=>{"use strict";var zce=R(),Vce=Xa(),Xce=Hm(),Kce=Vm(),Zce=_n(),jce=Fu(),$ce=new zce({initialize:function(e,i,s){e===void 0&&(e=0),i===void 0&&(i=0),s===void 0&&(s=0),this.type=Zce.CIRCLE,this.x=e,this.y=i,this._radius=s,this._diameter=s*2},contains:function(t,e){return Vce(this,t,e)},getPoint:function(t,e){return Xce(this,t,e)},getPoints:function(t,e,i){return Kce(this,t,e,i)},getRandomPoint:function(t){return jce(this,t)},setTo:function(t,e,i){return this.x=t,this.y=e,this._radius=i,this._diameter=i*2,this},setEmpty:function(){return this._radius=0,this._diameter=0,this},setPosition:function(t,e){return e===void 0&&(e=t),this.x=t,this.y=e,this},isEmpty:function(){return this._radius<=0},radius:{get:function(){return this._radius},set:function(t){this._radius=t,this._diameter=t*2}},diameter:{get:function(){return this._diameter},set:function(t){this._diameter=t,this._radius=t*.5}},left:{get:function(){return this.x-this._radius},set:function(t){this.x=t+this._radius}},right:{get:function(){return this.x+this._radius},set:function(t){this.x=t-this._radius}},top:{get:function(){return this.y-this._radius},set:function(t){this.y=t+this._radius}},bottom:{get:function(){return this.y+this._radius},set:function(t){this.y=t-this._radius}}});Pk.exports=$ce});var Ah=u((Gqe,Ik)=>{"use strict";var Jce=xn(),Qce=ku(),ede=Xa(),tde=R(),Ka=ri(),_k=ki(),ide=Ze(),sde=Pn(),rde=new tde({Extends:_k,Mixins:[Ka.Depth,Ka.GetBounds,Ka.Origin,Ka.Transform,Ka.ScrollFactor,Ka.Visible],initialize:function(e,i,s,r,n){r===void 0&&(r=1),n===void 0&&(n=r),_k.call(this,e,"Zone"),this.setPosition(i,s),this.width=r,this.height=n,this.blendMode=Jce.NORMAL,this.updateDisplayOrigin()},displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}},setSize:function(t,e,i){i===void 0&&(i=!0),this.width=t,this.height=e,this.updateDisplayOrigin();var s=this.input;return i&&s&&!s.customHitArea&&(s.hitArea.width=t,s.hitArea.height=e),this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this},setCircleDropZone:function(t){return this.setDropZone(new Qce(0,0,t),ede)},setRectangleDropZone:function(t,e){return this.setDropZone(new ide(0,0,t,e),sde)},setDropZone:function(t,e){return this.input||this.setInteractive(t,e,!0),this},setAlpha:function(){},setBlendMode:function(){},renderCanvas:function(t,e,i){i.addToRenderList(e)},renderWebGL:function(t,e,i){i.addToRenderList(e)}});Ik.exports=rde});var Ok=u((qqe,Mk)=>{"use strict";var nde=Wm(),ade=bh(),Fn=re(),Lk=Ie(),ode=Ah(),cs=new ode({sys:{queueDepthSort:Lk,events:{once:Lk}}},0,0,1,1).setOrigin(0,0),hde=function(t,e){e===void 0&&(e={});var i=e.hasOwnProperty("width"),s=e.hasOwnProperty("height"),r=Fn(e,"width",-1),n=Fn(e,"height",-1),a=Fn(e,"cellWidth",1),o=Fn(e,"cellHeight",a),h=Fn(e,"position",ade.TOP_LEFT),l=Fn(e,"x",0),c=Fn(e,"y",0),d=0,f=0,p=r*a,m=n*o;cs.setPosition(l,c),cs.setSize(a,o);for(var v=0;v<t.length;v++)if(nde(t[v],cs,h),i&&r===-1)cs.x+=a;else if(s&&n===-1)cs.y+=o;else if(s&&!i){if(f+=o,cs.y+=o,f===m&&(f=0,d+=a,cs.y=c,cs.x+=a,d===p))break}else if(d+=a,cs.x+=a,d===p&&(d=0,f+=o,cs.x=l,cs.y+=o,f===m))break;return t};Mk.exports=hde});var Bk=u((Wqe,Dk)=>{"use strict";var lde=us(),ude=function(t,e,i,s,r){return lde(t,"alpha",e,i,s,r)};Dk.exports=ude});var Nk=u((Yqe,Uk)=>{"use strict";var cde=us(),dde=function(t,e,i,s,r){return cde(t,"x",e,i,s,r)};Uk.exports=dde});var Gk=u((Hqe,kk)=>{"use strict";var Fk=us(),fde=function(t,e,i,s,r,n,a){return i==null&&(i=e),Fk(t,"x",e,s,n,a),Fk(t,"y",i,r,n,a)};kk.exports=fde});var Wk=u((zqe,qk)=>{"use strict";var pde=us(),mde=function(t,e,i,s,r){return pde(t,"y",e,i,s,r)};qk.exports=mde});var Hk=u((Vqe,Yk)=>{"use strict";var vde=function(t,e,i,s){i===void 0&&(i=0),s===void 0&&(s=6.28);for(var r=i,n=(s-i)/t.length,a=e.x,o=e.y,h=e.radius,l=0;l<t.length;l++)t[l].x=a+h*Math.cos(r),t[l].y=o+h*Math.sin(r),r+=n;return t};Yk.exports=vde});var Vk=u((Xqe,zk)=>{"use strict";var gde=function(t,e,i,s){i===void 0&&(i=0),s===void 0&&(s=6.28);for(var r=i,n=(s-i)/t.length,a=e.width/2,o=e.height/2,h=0;h<t.length;h++)t[h].x=e.x+a*Math.cos(r),t[h].y=e.y+o*Math.sin(r),r+=n;return t};zk.exports=gde});var Zr=u((Kqe,Xk)=>{"use strict";var xh=lh(),Sde=Gp(),Ede=function(t,e){var i=xh.Power0;if(typeof t=="string")if(xh.hasOwnProperty(t))i=xh[t];else{var s="";if(t.indexOf(".")){s=t.substring(t.indexOf(".")+1);var r=s.toLowerCase();r==="in"?s="easeIn":r==="out"?s="easeOut":r==="inout"&&(s="easeInOut")}t=Sde(t.substring(0,t.indexOf(".")+1)+s),xh.hasOwnProperty(t)&&(i=xh[t])}else typeof t=="function"&&(i=t);if(!e)return i;var n=e.slice(0);return n.unshift(0),function(a){return n[0]=a,i.apply(this,n)}};Xk.exports=Ede});var $k=u((Zqe,jk)=>{"use strict";var Kk=Qp(),Tde=Zr(),Zk=Ct(),yde=function(t,e,i,s,r){s===void 0&&(s=0),r===void 0&&(r=[]);var n=[],a=t.x1,o=t.y1,h=t.x2-a,l=t.y2-o,c=Tde(e,r),d,f,p=i-1;for(d=0;d<p;d++)f=c(d/p),n.push(new Zk(a+h*f,o+l*f));if(f=c(1),n.push(new Zk(a+h*f,o+l*f)),s>0){var m=n[0],v=[m];for(d=1;d<n.length-1;d++){var g=n[d];Kk(m,g)>=s&&(v.push(g),m=g)}var S=n[n.length-1];return Kk(m,S)<s&&v.pop(),v.push(S),v}else return n};jk.exports=yde});var Qk=u((jqe,Jk)=>{"use strict";var bde=Uf(),Ade=$k(),xde=function(t,e,i){var s;i?s=Ade(e,i,t.length):s=bde(e,t.length);for(var r=0;r<t.length;r++){var n=t[r],a=s[r];n.x=a.x,n.y=a.y}return t};Jk.exports=xde});var Xm=u(($qe,tG)=>{"use strict";var eG=sh(),Cde=Ct(),wde=function(t,e,i,s){if(s===void 0&&(s=[]),!e&&!i)return s;e?i=Math.round(eG(t)/e):e=eG(t)/i;for(var r=t.x,n=t.y,a=0,o=0;o<i;o++)switch(s.push(new Cde(r,n)),a){case 0:r+=e,r>=t.right&&(a=1,n+=r-t.right,r=t.right);break;case 1:n+=e,n>=t.bottom&&(a=2,r-=n-t.bottom,n=t.bottom);break;case 2:r-=e,r<=t.left&&(a=3,n-=t.left-r,r=t.left);break;case 3:n-=e,n<=t.top&&(a=0,n=t.top);break}return s};tG.exports=wde});var sG=u((Jqe,iG)=>{"use strict";var Rde=Xm(),Pde=Hl(),_de=zl(),Ide=function(t,e,i){i===void 0&&(i=0);var s=Rde(e,!1,t.length);i>0?Pde(s,i):i<0&&_de(s,Math.abs(i));for(var r=0;r<t.length;r++)t[r].x=s[r].x,t[r].y=s[r].y;return t};iG.exports=Ide});var nG=u((Qqe,rG)=>{"use strict";var Lde=function(t,e,i){e===void 0&&(e=1),i===void 0&&(i=[]);var s=Math.round(t.x1),r=Math.round(t.y1),n=Math.round(t.x2),a=Math.round(t.y2),o=Math.abs(n-s),h=Math.abs(a-r),l=s<n?1:-1,c=r<a?1:-1,d=o-h;i.push({x:s,y:r});for(var f=1;!(s===n&&r===a);){var p=d<<1;p>-h&&(d-=h,s+=l),p<o&&(d+=o,r+=c),f%e===0&&i.push({x:s,y:r}),f++}return i};rG.exports=Lde});var oG=u((e2e,aG)=>{"use strict";var Km=nG(),Mde=function(t,e,i){var s=Km({x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2},i),r=Km({x1:e.x2,y1:e.y2,x2:e.x3,y2:e.y3},i),n=Km({x1:e.x3,y1:e.y3,x2:e.x1,y2:e.y1},i);s.pop(),r.pop(),n.pop(),s=s.concat(r,n);for(var a=s.length/t.length,o=0,h=0;h<t.length;h++){var l=t[h],c=s[Math.floor(o)];l.x=c.x,l.y=c.y,o+=a}return t};aG.exports=Mde});var lG=u((t2e,hG)=>{"use strict";var Ode=function(t,e,i){for(var s=0;s<t.length;s++){var r=t[s];r.anims&&r.anims.play(e,i)}return t};hG.exports=Ode});var It=u((i2e,uG)=>{"use strict";var Dde=function(t,e,i,s,r,n){s===void 0&&(s=0),r===void 0&&(r=0),n===void 0&&(n=1);var a,o=0,h=t.length;if(n===1)for(a=r;a<h;a++)t[a][e]=i+o*s,o++;else for(a=r;a>=0;a--)t[a][e]=i+o*s,o++;return t};uG.exports=Dde});var dG=u((s2e,cG)=>{"use strict";var Bde=Fu(),Ude=function(t,e){for(var i=0;i<t.length;i++)Bde(e,t[i]);return t};cG.exports=Ude});var pG=u((r2e,fG)=>{"use strict";var Nde=Ct(),Fde=function(t,e){e===void 0&&(e=new Nde);var i=Math.random()*Math.PI*2,s=Math.sqrt(Math.random());return e.x=t.x+s*Math.cos(i)*t.width/2,e.y=t.y+s*Math.sin(i)*t.height/2,e};fG.exports=Fde});var vG=u((n2e,mG)=>{"use strict";var kde=pG(),Gde=function(t,e){for(var i=0;i<t.length;i++)kde(e,t[i]);return t};mG.exports=Gde});var SG=u((a2e,gG)=>{"use strict";var qde=Nf(),Wde=function(t,e){for(var i=0;i<t.length;i++)qde(e,t[i]);return t};gG.exports=Wde});var TG=u((o2e,EG)=>{"use strict";var Yde=eu(),Hde=function(t,e){for(var i=0;i<t.length;i++)Yde(e,t[i]);return t};EG.exports=Hde});var bG=u((h2e,yG)=>{"use strict";var zde=Ct(),Vde=function(t,e){e===void 0&&(e=new zde);var i=t.x2-t.x1,s=t.y2-t.y1,r=t.x3-t.x1,n=t.y3-t.y1,a=Math.random(),o=Math.random();return a+o>=1&&(a=1-a,o=1-o),e.x=t.x1+(i*a+r*o),e.y=t.y1+(s*a+n*o),e};yG.exports=Vde});var xG=u((l2e,AG)=>{"use strict";var Xde=bG(),Kde=function(t,e){for(var i=0;i<t.length;i++)Xde(e,t[i]);return t};AG.exports=Kde});var wG=u((u2e,CG)=>{"use strict";var Zde=us(),jde=function(t,e,i,s,r){return Zde(t,"rotation",e,i,s,r)};CG.exports=jde});var PG=u((c2e,RG)=>{"use strict";var $de=Pu(),Jde=dh(),Qde=function(t,e,i){for(var s=e.x,r=e.y,n=0;n<t.length;n++){var a=t[n];$de(a,s,r,i,Math.max(1,Jde(a.x,a.y,s,r)))}return t};RG.exports=Qde});var IG=u((d2e,_G)=>{"use strict";var efe=Pu(),tfe=function(t,e,i,s){var r=e.x,n=e.y;if(s===0)return t;for(var a=0;a<t.length;a++)efe(t[a],r,n,i,s);return t};_G.exports=tfe});var MG=u((f2e,LG)=>{"use strict";var ife=us(),sfe=function(t,e,i,s,r){return ife(t,"scaleX",e,i,s,r)};LG.exports=sfe});var BG=u((p2e,DG)=>{"use strict";var OG=us(),rfe=function(t,e,i,s,r,n,a){return i==null&&(i=e),OG(t,"scaleX",e,s,n,a),OG(t,"scaleY",i,r,n,a)};DG.exports=rfe});var NG=u((m2e,UG)=>{"use strict";var nfe=us(),afe=function(t,e,i,s,r){return nfe(t,"scaleY",e,i,s,r)};UG.exports=afe});var kG=u((v2e,FG)=>{"use strict";var ofe=It(),hfe=function(t,e,i,s,r){return ofe(t,"alpha",e,i,s,r)};FG.exports=hfe});var qG=u((g2e,GG)=>{"use strict";var lfe=It(),ufe=function(t,e,i,s){return lfe(t,"blendMode",e,0,i,s)};GG.exports=ufe});var YG=u((S2e,WG)=>{"use strict";var cfe=It(),dfe=function(t,e,i,s,r){return cfe(t,"depth",e,i,s,r)};WG.exports=dfe});var zG=u((E2e,HG)=>{"use strict";var ffe=function(t,e,i){for(var s=0;s<t.length;s++)t[s].setInteractive(e,i);return t};HG.exports=ffe});var KG=u((T2e,XG)=>{"use strict";var VG=It(),pfe=function(t,e,i,s,r,n,a){return i==null&&(i=e),VG(t,"originX",e,s,n,a),VG(t,"originY",i,r,n,a),t.forEach(function(o){o.updateDisplayOrigin()}),t};XG.exports=pfe});var jG=u((y2e,ZG)=>{"use strict";var mfe=It(),vfe=function(t,e,i,s,r){return mfe(t,"rotation",e,i,s,r)};ZG.exports=vfe});var QG=u((b2e,JG)=>{"use strict";var $G=It(),gfe=function(t,e,i,s,r,n,a){return i==null&&(i=e),$G(t,"scaleX",e,s,n,a),$G(t,"scaleY",i,r,n,a)};JG.exports=gfe});var tq=u((A2e,eq)=>{"use strict";var Sfe=It(),Efe=function(t,e,i,s,r){return Sfe(t,"scaleX",e,i,s,r)};eq.exports=Efe});var sq=u((x2e,iq)=>{"use strict";var Tfe=It(),yfe=function(t,e,i,s,r){return Tfe(t,"scaleY",e,i,s,r)};iq.exports=yfe});var aq=u((C2e,nq)=>{"use strict";var rq=It(),bfe=function(t,e,i,s,r,n,a){return i==null&&(i=e),rq(t,"scrollFactorX",e,s,n,a),rq(t,"scrollFactorY",i,r,n,a)};nq.exports=bfe});var hq=u((w2e,oq)=>{"use strict";var Afe=It(),xfe=function(t,e,i,s,r){return Afe(t,"scrollFactorX",e,i,s,r)};oq.exports=xfe});var uq=u((R2e,lq)=>{"use strict";var Cfe=It(),wfe=function(t,e,i,s,r){return Cfe(t,"scrollFactorY",e,i,s,r)};lq.exports=wfe});var dq=u((P2e,cq)=>{"use strict";var Rfe=function(t,e,i,s,r){for(var n=0;n<t.length;n++)t[n].setTint(e,i,s,r);return t};cq.exports=Rfe});var pq=u((_2e,fq)=>{"use strict";var Pfe=It(),_fe=function(t,e,i,s){return Pfe(t,"visible",e,0,i,s)};fq.exports=_fe});var vq=u((I2e,mq)=>{"use strict";var Ife=It(),Lfe=function(t,e,i,s,r){return Ife(t,"x",e,i,s,r)};mq.exports=Lfe});var Eq=u((L2e,Sq)=>{"use strict";var gq=It(),Mfe=function(t,e,i,s,r,n,a){return i==null&&(i=e),gq(t,"x",e,s,n,a),gq(t,"y",i,r,n,a)};Sq.exports=Mfe});var yq=u((M2e,Tq)=>{"use strict";var Ofe=It(),Dfe=function(t,e,i,s,r){return Ofe(t,"y",e,i,s,r)};Tq.exports=Dfe});var Aq=u((O2e,bq)=>{"use strict";var Bfe=Fe(),Ufe=function(t,e,i,s,r){s===void 0&&(s=0),r===void 0&&(r=new Bfe);var n,a,o=t.length;if(o===1)n=t[0].x,a=t[0].y,t[0].x=e,t[0].y=i;else{var h=1,l=0;s===0&&(l=o-1,h=o-2),n=t[l].x,a=t[l].y,t[l].x=e,t[l].y=i;for(var c=0;c<o;c++)if(!(h>=o||h===-1)){var d=t[h],f=d.x,p=d.y;d.x=n,d.y=a,n=f,a=p,s===0?h--:h++}}return r.x=n,r.y=a,r};bq.exports=Ufe});var Cq=u((D2e,xq)=>{"use strict";var Nfe=Xl(),Ffe=function(t){return Nfe(t)};xq.exports=Ffe});var Pq=u((B2e,Rq)=>{"use strict";var wq=hm(),kfe=function(t,e,i,s,r){r===void 0&&(r=!1);var n=Math.abs(s-i)/t.length,a;if(r)for(a=0;a<t.length;a++)t[a][e]+=wq(a*n,i,s);else for(a=0;a<t.length;a++)t[a][e]=wq(a*n,i,s);return t};Rq.exports=kfe});var Lq=u((U2e,Iq)=>{"use strict";var _q=xp(),Gfe=function(t,e,i,s,r){r===void 0&&(r=!1);var n=Math.abs(s-i)/t.length,a;if(r)for(a=0;a<t.length;a++)t[a][e]+=_q(a*n,i,s);else for(a=0;a<t.length;a++)t[a][e]=_q(a*n,i,s);return t};Iq.exports=Gfe});var Oq=u((N2e,Mq)=>{"use strict";var qfe=function(t,e,i,s,r){if(r===void 0&&(r=!1),t.length===0)return t;if(t.length===1)return r?t[0][e]+=(s+i)/2:t[0][e]=(s+i)/2,t;var n=Math.abs(s-i)/(t.length-1),a;if(r)for(a=0;a<t.length;a++)t[a][e]+=a*n+i;else for(a=0;a<t.length;a++)t[a][e]=a*n+i;return t};Mq.exports=qfe});var Bq=u((F2e,Dq)=>{"use strict";var Wfe=function(t){for(var e=0;e<t.length;e++)t[e].visible=!t[e].visible;return t};Dq.exports=Wfe});var Fq=u((k2e,Nq)=>{"use strict";var Uq=Ba(),Yfe=function(t,e,i){i===void 0&&(i=0);for(var s=0;s<t.length;s++){var r=t[s];r.x=Uq(r.x,e.left-i,e.right+i),r.y=Uq(r.y,e.top-i,e.bottom+i)}return t};Nq.exports=Yfe});var Gq=u((G2e,kq)=>{"use strict";kq.exports={AlignTo:ek(),Angle:sk(),Call:nk(),GetFirst:ok(),GetLast:lk(),GridAlign:Ok(),IncAlpha:Bk(),IncX:Nk(),IncXY:Gk(),IncY:Wk(),PlaceOnCircle:Hk(),PlaceOnEllipse:Vk(),PlaceOnLine:Qk(),PlaceOnRectangle:sG(),PlaceOnTriangle:oG(),PlayAnimation:lG(),PropertyValueInc:us(),PropertyValueSet:It(),RandomCircle:dG(),RandomEllipse:vG(),RandomLine:SG(),RandomRectangle:TG(),RandomTriangle:xG(),Rotate:wG(),RotateAround:PG(),RotateAroundDistance:IG(),ScaleX:MG(),ScaleXY:BG(),ScaleY:NG(),SetAlpha:kG(),SetBlendMode:qG(),SetDepth:YG(),SetHitArea:zG(),SetOrigin:KG(),SetRotation:jG(),SetScale:QG(),SetScaleX:tq(),SetScaleY:sq(),SetScrollFactor:aq(),SetScrollFactorX:hq(),SetScrollFactorY:uq(),SetTint:dq(),SetVisible:pq(),SetX:vq(),SetXY:Eq(),SetY:yq(),ShiftPosition:Aq(),Shuffle:Cq(),SmootherStep:Pq(),SmoothStep:Lq(),Spread:Oq(),ToggleVisible:Bq(),WrapInRectangle:Fq()}});var Zm=u((q2e,qq)=>{"use strict";var Hfe=function(t,e){return t.hasOwnProperty(e)};qq.exports=Hfe});var jm=u((W2e,Wq)=>{"use strict";var zfe=R(),Gu=new zfe({initialize:function(e){if(this.entries=[],Array.isArray(e))for(var i=0;i<e.length;i++)this.set(e[i])},set:function(t){return this.entries.indexOf(t)===-1&&this.entries.push(t),this},get:function(t,e){for(var i=0;i<this.entries.length;i++){var s=this.entries[i];if(s[t]===e)return s}},getArray:function(){return this.entries.slice(0)},delete:function(t){var e=this.entries.indexOf(t);return e>-1&&this.entries.splice(e,1),this},dump:function(){console.group("Set");for(var t=0;t<this.entries.length;t++){var e=this.entries[t];console.log(e)}console.groupEnd()},each:function(t,e){var i,s=this.entries.slice(),r=s.length;if(e)for(i=0;i<r&&t.call(e,s[i],i)!==!1;i++);else for(i=0;i<r&&t(s[i],i)!==!1;i++);return this},iterate:function(t,e){var i,s=this.entries.length;if(e)for(i=0;i<s&&t.call(e,this.entries[i],i)!==!1;i++);else for(i=0;i<s&&t(this.entries[i],i)!==!1;i++);return this},iterateLocal:function(t){var e,i=[];for(e=1;e<arguments.length;e++)i.push(arguments[e]);var s=this.entries.length;for(e=0;e<s;e++){var r=this.entries[e];r[t].apply(r,i)}return this},clear:function(){return this.entries.length=0,this},contains:function(t){return this.entries.indexOf(t)>-1},union:function(t){var e=new Gu;return t.entries.forEach(function(i){e.set(i)}),this.entries.forEach(function(i){e.set(i)}),e},intersect:function(t){var e=new Gu;return this.entries.forEach(function(i){t.contains(i)&&e.set(i)}),e},difference:function(t){var e=new Gu;return this.entries.forEach(function(i){t.contains(i)||e.set(i)}),e},size:{get:function(){return this.entries.length},set:function(t){return t<this.entries.length?this.entries.length=t:this.entries.length}}});Wq.exports=Gu});var Hq=u((Y2e,Yq)=>{"use strict";Yq.exports="add"});var Vq=u((H2e,zq)=>{"use strict";zq.exports="animationcomplete"});var Kq=u((z2e,Xq)=>{"use strict";Xq.exports="animationcomplete-"});var jq=u((V2e,Zq)=>{"use strict";Zq.exports="animationrepeat"});var Jq=u((X2e,$q)=>{"use strict";$q.exports="animationrestart"});var e2=u((K2e,Qq)=>{"use strict";Qq.exports="animationstart"});var i2=u((Z2e,t2)=>{"use strict";t2.exports="animationstop"});var r2=u((j2e,s2)=>{"use strict";s2.exports="animationupdate"});var a2=u(($2e,n2)=>{"use strict";n2.exports="pauseall"});var h2=u((J2e,o2)=>{"use strict";o2.exports="remove"});var u2=u((Q2e,l2)=>{"use strict";l2.exports="resumeall"});var Ds=u((eWe,c2)=>{"use strict";c2.exports={ADD_ANIMATION:Hq(),ANIMATION_COMPLETE:Vq(),ANIMATION_COMPLETE_KEY:Kq(),ANIMATION_REPEAT:jq(),ANIMATION_RESTART:Jq(),ANIMATION_START:e2(),ANIMATION_STOP:i2(),ANIMATION_UPDATE:r2(),PAUSE_ALL:a2(),REMOVE_ANIMATION:h2(),RESUME_ALL:u2()}});var $m=u((tWe,d2)=>{"use strict";var Vfe=R(),Xfe=new Vfe({initialize:function(e,i,s,r,n){n===void 0&&(n=!1),this.textureKey=e,this.textureFrame=i,this.index=s,this.frame=r,this.isFirst=!1,this.isLast=!1,this.prevFrame=null,this.nextFrame=null,this.duration=0,this.progress=0,this.isKeyFrame=n},toJSON:function(){return{key:this.textureKey,frame:this.textureFrame,duration:this.duration,keyframe:this.isKeyFrame}},destroy:function(){this.frame=void 0}});d2.exports=Xfe});var Wu=u((iWe,f2)=>{"use strict";var Kfe=Je(),Zfe=R(),qu=Ds(),jfe=Af(),$fe=$m(),Lt=Ne(),Jfe=_f(),Qfe=new Zfe({initialize:function(e,i,s){this.manager=e,this.key=i,this.type="frame",this.frames=this.getFrames(e.textureManager,Lt(s,"frames",[]),Lt(s,"defaultTextureKey",null),Lt(s,"sortFrames",!0)),this.frameRate=Lt(s,"frameRate",null),this.duration=Lt(s,"duration",null),this.msPerFrame,this.skipMissedFrames=Lt(s,"skipMissedFrames",!0),this.delay=Lt(s,"delay",0),this.repeat=Lt(s,"repeat",0),this.repeatDelay=Lt(s,"repeatDelay",0),this.yoyo=Lt(s,"yoyo",!1),this.showBeforeDelay=Lt(s,"showBeforeDelay",!1),this.showOnStart=Lt(s,"showOnStart",!1),this.hideOnComplete=Lt(s,"hideOnComplete",!1),this.randomFrame=Lt(s,"randomFrame",!1),this.paused=!1,this.calculateDuration(this,this.getTotalFrames(),this.duration,this.frameRate),this.manager.on&&(this.manager.on(qu.PAUSE_ALL,this.pause,this),this.manager.on(qu.RESUME_ALL,this.resume,this))},getTotalFrames:function(){return this.frames.length},calculateDuration:function(t,e,i,s){i===null&&s===null?(t.frameRate=24,t.duration=24/e*1e3):i&&s===null?(t.duration=i,t.frameRate=e/(i/1e3)):(t.frameRate=s,t.duration=e/s*1e3),t.msPerFrame=1e3/t.frameRate},addFrame:function(t){return this.addFrameAt(this.frames.length,t)},addFrameAt:function(t,e){var i=this.getFrames(this.manager.textureManager,e);if(i.length>0){if(t===0)this.frames=i.concat(this.frames);else if(t===this.frames.length)this.frames=this.frames.concat(i);else{var s=this.frames.slice(0,t),r=this.frames.slice(t);this.frames=s.concat(i,r)}this.updateFrameSequence()}return this},checkFrame:function(t){return t>=0&&t<this.frames.length},getFirstTick:function(t){t.accumulator=0,t.nextTick=t.msPerFrame||t.currentFrame.duration},getFrameAt:function(t){return this.frames[t]},getFrames:function(t,e,i,s){s===void 0&&(s=!0);var r=[],n,a,o=1,h,l;if(typeof e=="string"){if(l=e,!t.exists(l))return console.warn('Texture "%s" not found',l),r;var c=t.get(l),d=c.getFrameNames();s&&Jfe(d),e=[],d.forEach(function(S){e.push({key:l,frame:S})})}if(!Array.isArray(e)||e.length===0)return r;for(h=0;h<e.length;h++){var f=e[h],p=Lt(f,"key",i);if(p){var m=Lt(f,"frame",0),v=t.getFrame(p,m);if(!v){console.warn('Texture "%s" not found',p);continue}a=new $fe(p,m,o,v),a.duration=Lt(f,"duration",0),a.isFirst=!n,n&&(n.nextFrame=a,a.prevFrame=n),r.push(a),n=a,o++}}if(r.length>0){a.isLast=!0,a.nextFrame=r[0],r[0].prevFrame=a;var g=1/(r.length-1);for(h=0;h<r.length;h++)r[h].progress=h*g}return r},getNextTick:function(t){t.accumulator-=t.nextTick,t.nextTick=t.msPerFrame||t.currentFrame.duration},getFrameByProgress:function(t){return t=Kfe(t,0,1),jfe(t,this.frames,"progress")},nextFrame:function(t){var e=t.currentFrame;e.isLast?t.yoyo?this.handleYoyoFrame(t,!1):t.repeatCounter>0?t.inReverse&&t.forward?t.forward=!1:this.repeatAnimation(t):t.complete():this.updateAndGetNextTick(t,e.nextFrame)},handleYoyoFrame:function(t,e){if(e||(e=!1),t.inReverse===!e&&t.repeatCounter>0){(t.repeatDelay===0||t.pendingRepeat)&&(t.forward=e),this.repeatAnimation(t);return}if(t.inReverse!==e&&t.repeatCounter===0){t.complete();return}t.forward=e;var i=e?t.currentFrame.nextFrame:t.currentFrame.prevFrame;this.updateAndGetNextTick(t,i)},getLastFrame:function(){return this.frames[this.frames.length-1]},previousFrame:function(t){var e=t.currentFrame;e.isFirst?t.yoyo?this.handleYoyoFrame(t,!0):t.repeatCounter>0?t.inReverse&&!t.forward?this.repeatAnimation(t):(t.forward=!0,this.repeatAnimation(t)):t.complete():this.updateAndGetNextTick(t,e.prevFrame)},updateAndGetNextTick:function(t,e){t.setCurrentFrame(e),this.getNextTick(t)},removeFrame:function(t){var e=this.frames.indexOf(t);return e!==-1&&this.removeFrameAt(e),this},removeFrameAt:function(t){return this.frames.splice(t,1),this.updateFrameSequence(),this},repeatAnimation:function(t){if(t._pendingStop===2){if(t._pendingStopValue===0)return t.stop();t._pendingStopValue--}t.repeatDelay>0&&!t.pendingRepeat?(t.pendingRepeat=!0,t.accumulator-=t.nextTick,t.nextTick+=t.repeatDelay):(t.repeatCounter--,t.forward?t.setCurrentFrame(t.currentFrame.nextFrame):t.setCurrentFrame(t.currentFrame.prevFrame),t.isPlaying&&(this.getNextTick(t),t.handleRepeat()))},toJSON:function(){var t={key:this.key,type:this.type,frames:[],frameRate:this.frameRate,duration:this.duration,skipMissedFrames:this.skipMissedFrames,delay:this.delay,repeat:this.repeat,repeatDelay:this.repeatDelay,yoyo:this.yoyo,showBeforeDelay:this.showBeforeDelay,showOnStart:this.showOnStart,randomFrame:this.randomFrame,hideOnComplete:this.hideOnComplete};return this.frames.forEach(function(e){t.frames.push(e.toJSON())}),t},updateFrameSequence:function(){for(var t=this.frames.length,e=1/(t-1),i,s=0;s<t;s++)i=this.frames[s],i.index=s+1,i.isFirst=!1,i.isLast=!1,i.progress=s*e,s===0?(i.isFirst=!0,t===1?(i.isLast=!0,i.nextFrame=i,i.prevFrame=i):(i.isLast=!1,i.prevFrame=this.frames[t-1],i.nextFrame=this.frames[s+1])):s===t-1&&t>1?(i.isLast=!0,i.prevFrame=this.frames[t-2],i.nextFrame=this.frames[0]):t>1&&(i.prevFrame=this.frames[s-1],i.nextFrame=this.frames[s+1]);return this},pause:function(){return this.paused=!0,this},resume:function(){return this.paused=!1,this},destroy:function(){this.manager.off&&(this.manager.off(qu.PAUSE_ALL,this.pause,this),this.manager.off(qu.RESUME_ALL,this.resume,this)),this.manager.remove(this.key);for(var t=0;t<this.frames.length;t++)this.frames[t].destroy();this.frames=[],this.manager=null}});f2.exports=Qfe});var Ch=u((sWe,p2)=>{"use strict";var epe=R(),tpe=new epe({initialize:function(e){this.entries={},this.size=0,this.setAll(e)},setAll:function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this.set(t[e][0],t[e][1]);return this},set:function(t,e){return this.has(t)||this.size++,this.entries[t]=e,this},get:function(t){if(this.has(t))return this.entries[t]},getArray:function(){var t=[],e=this.entries;for(var i in e)t.push(e[i]);return t},has:function(t){return this.entries.hasOwnProperty(t)},delete:function(t){return this.has(t)&&(delete this.entries[t],this.size--),this},clear:function(){return Object.keys(this.entries).forEach(function(t){delete this.entries[t]},this),this.size=0,this},keys:function(){return Object.keys(this.entries)},values:function(){var t=[],e=this.entries;for(var i in e)t.push(e[i]);return t},dump:function(){var t=this.entries;console.group("Map");for(var e in t)console.log(e,t[e]);console.groupEnd()},each:function(t){var e=this.entries;for(var i in e)if(t(i,e[i])===!1)break;return this},contains:function(t){var e=this.entries;for(var i in e)if(e[i]===t)return!0;return!1},merge:function(t,e){e===void 0&&(e=!1);var i=this.entries,s=t.entries;for(var r in s)i.hasOwnProperty(r)&&e?i[r]=s[r]:this.set(r,s[r]);return this}});p2.exports=tpe});var Yu=u((rWe,m2)=>{"use strict";var ipe=Wu(),spe=Mn(),rpe=R(),npe=Ch(),cr=Ds(),hi=re(),ape=new rpe({initialize:function(e){this.parent=e,this.animationManager=e.scene.sys.anims,this.animationManager.on(cr.REMOVE_ANIMATION,this.globalRemove,this),this.textureManager=this.animationManager.textureManager,this.anims=null,this.isPlaying=!1,this.hasStarted=!1,this.currentAnim=null,this.currentFrame=null,this.nextAnim=null,this.nextAnimsQueue=[],this.timeScale=1,this.frameRate=0,this.duration=0,this.msPerFrame=0,this.skipMissedFrames=!0,this.randomFrame=!1,this.delay=0,this.repeat=0,this.repeatDelay=0,this.yoyo=!1,this.showBeforeDelay=!1,this.showOnStart=!1,this.hideOnComplete=!1,this.forward=!0,this.inReverse=!1,this.accumulator=0,this.nextTick=0,this.delayCounter=0,this.repeatCounter=0,this.pendingRepeat=!1,this._paused=!1,this._wasPlaying=!1,this._pendingStop=0,this._pendingStopValue},chain:function(t){var e=this.parent;if(t===void 0)return this.nextAnimsQueue.length=0,this.nextAnim=null,e;Array.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++){var s=t[i];this.nextAnim?this.nextAnimsQueue.push(s):this.nextAnim=s}return this.parent},getName:function(){return this.currentAnim?this.currentAnim.key:""},getFrameName:function(){return this.currentFrame?this.currentFrame.textureFrame:""},load:function(t){this.isPlaying&&this.stop();var e=this.animationManager,i=typeof t=="string"?t:hi(t,"key",null),s=this.exists(i)?this.get(i):e.get(i);if(!s)console.warn("Missing animation: "+i);else{this.currentAnim=s;var r=s.getTotalFrames(),n=hi(t,"frameRate",s.frameRate),a=hi(t,"duration",s.duration);s.calculateDuration(this,r,a,n),this.delay=hi(t,"delay",s.delay),this.repeat=hi(t,"repeat",s.repeat),this.repeatDelay=hi(t,"repeatDelay",s.repeatDelay),this.yoyo=hi(t,"yoyo",s.yoyo),this.showBeforeDelay=hi(t,"showBeforeDelay",s.showBeforeDelay),this.showOnStart=hi(t,"showOnStart",s.showOnStart),this.hideOnComplete=hi(t,"hideOnComplete",s.hideOnComplete),this.skipMissedFrames=hi(t,"skipMissedFrames",s.skipMissedFrames),this.randomFrame=hi(t,"randomFrame",s.randomFrame),this.timeScale=hi(t,"timeScale",this.timeScale);var o=hi(t,"startFrame",0);o>r&&(o=0),this.randomFrame&&(o=spe(0,r-1));var h=s.frames[o];o===0&&!this.forward&&(h=s.getLastFrame()),this.currentFrame=h}return this.parent},pause:function(t){return this._paused||(this._paused=!0,this._wasPlaying=this.isPlaying,this.isPlaying=!1),t!==void 0&&this.setCurrentFrame(t),this.parent},resume:function(t){return this._paused&&(this._paused=!1,this.isPlaying=this._wasPlaying),t!==void 0&&this.setCurrentFrame(t),this.parent},playAfterDelay:function(t,e){if(!this.isPlaying)this.delayCounter=e,this.play(t,!0);else{var i=this.nextAnim,s=this.nextAnimsQueue;i&&s.unshift(i),this.nextAnim=t,this._pendingStop=1,this._pendingStopValue=e}return this.parent},playAfterRepeat:function(t,e){if(e===void 0&&(e=1),!this.isPlaying)this.play(t);else{var i=this.nextAnim,s=this.nextAnimsQueue;i&&s.unshift(i),this.repeatCounter!==-1&&e>this.repeatCounter&&(e=this.repeatCounter),this.nextAnim=t,this._pendingStop=2,this._pendingStopValue=e}return this.parent},play:function(t,e){e===void 0&&(e=!1);var i=this.currentAnim,s=this.parent,r=typeof t=="string"?t:t.key;if(e&&this.isPlaying&&i.key===r)return s;if(i&&this.isPlaying){var n=this.animationManager.getMix(i.key,t);if(n>0)return this.playAfterDelay(t,n)}return this.forward=!0,this.inReverse=!1,this._paused=!1,this._wasPlaying=!0,this.startAnimation(t)},playReverse:function(t,e){e===void 0&&(e=!1);var i=typeof t=="string"?t:t.key;return e&&this.isPlaying&&this.currentAnim.key===i?this.parent:(this.forward=!1,this.inReverse=!0,this._paused=!1,this._wasPlaying=!0,this.startAnimation(t))},startAnimation:function(t){this.load(t);var e=this.currentAnim,i=this.parent;return e&&(this.repeatCounter=this.repeat===-1?Number.MAX_VALUE:this.repeat,e.getFirstTick(this),this.isPlaying=!0,this.pendingRepeat=!1,this.hasStarted=!1,this._pendingStop=0,this._pendingStopValue=0,this._paused=!1,this.delayCounter+=this.delay,this.delayCounter===0?this.handleStart():this.showBeforeDelay&&this.setCurrentFrame(this.currentFrame)),i},handleStart:function(){this.showOnStart&&this.parent.setVisible(!0),this.setCurrentFrame(this.currentFrame),this.hasStarted=!0,this.emitEvents(cr.ANIMATION_START)},handleRepeat:function(){this.pendingRepeat=!1,this.emitEvents(cr.ANIMATION_REPEAT)},handleStop:function(){this._pendingStop=0,this.isPlaying=!1,this.emitEvents(cr.ANIMATION_STOP)},handleComplete:function(){this._pendingStop=0,this.isPlaying=!1,this.hideOnComplete&&this.parent.setVisible(!1),this.emitEvents(cr.ANIMATION_COMPLETE,cr.ANIMATION_COMPLETE_KEY)},emitEvents:function(t,e){var i=this.currentAnim;if(i){var s=this.currentFrame,r=this.parent,n=s.textureFrame;r.emit(t,i,s,r,n),e&&r.emit(e+i.key,i,s,r,n)}},reverse:function(){return this.isPlaying&&(this.inReverse=!this.inReverse,this.forward=!this.forward),this.parent},getProgress:function(){var t=this.currentFrame;if(!t)return 0;var e=t.progress;return this.inReverse&&(e*=-1),e},setProgress:function(t){return this.forward||(t=1-t),this.setCurrentFrame(this.currentAnim.getFrameByProgress(t)),this.parent},setRepeat:function(t){return this.repeatCounter=t===-1?Number.MAX_VALUE:t,this.parent},globalRemove:function(t,e){e===void 0&&(e=this.currentAnim),this.isPlaying&&e.key===this.currentAnim.key&&(this.stop(),this.setCurrentFrame(this.currentAnim.frames[0]))},restart:function(t,e){t===void 0&&(t=!1),e===void 0&&(e=!1);var i=this.currentAnim,s=this.parent;return i?(e&&(this.repeatCounter=this.repeat===-1?Number.MAX_VALUE:this.repeat),i.getFirstTick(this),this.emitEvents(cr.ANIMATION_RESTART),this.isPlaying=!0,this.pendingRepeat=!1,this.hasStarted=!t,this._pendingStop=0,this._pendingStopValue=0,this._paused=!1,this.setCurrentFrame(i.frames[0]),this.parent):s},complete:function(){if(this._pendingStop=0,this.isPlaying=!1,this.currentAnim&&this.handleComplete(),this.nextAnim){var t=this.nextAnim;this.nextAnim=this.nextAnimsQueue.length>0?this.nextAnimsQueue.shift():null,this.play(t)}return this.parent},stop:function(){if(this._pendingStop=0,this.isPlaying=!1,this.delayCounter=0,this.currentAnim&&this.handleStop(),this.nextAnim){var t=this.nextAnim;this.nextAnim=this.nextAnimsQueue.shift(),this.play(t)}return this.parent},stopAfterDelay:function(t){return this._pendingStop=1,this._pendingStopValue=t,this.parent},stopAfterRepeat:function(t){return t===void 0&&(t=1),this.repeatCounter!==-1&&t>this.repeatCounter&&(t=this.repeatCounter),this._pendingStop=2,this._pendingStopValue=t,this.parent},stopOnFrame:function(t){return this._pendingStop=3,this._pendingStopValue=t,this.parent},getTotalFrames:function(){return this.currentAnim?this.currentAnim.getTotalFrames():0},update:function(t,e){var i=this.currentAnim;if(!(!this.isPlaying||!i||i.paused)){if(this.accumulator+=e*this.timeScale*this.animationManager.globalTimeScale,this._pendingStop===1&&(this._pendingStopValue-=e,this._pendingStopValue<=0))return this.stop();if(!this.hasStarted)this.accumulator>=this.delayCounter&&(this.accumulator-=this.delayCounter,this.handleStart());else if(this.accumulator>=this.nextTick&&(this.forward?i.nextFrame(this):i.previousFrame(this),this.isPlaying&&this._pendingStop===0&&this.skipMissedFrames&&this.accumulator>this.nextTick)){var s=0;do this.forward?i.nextFrame(this):i.previousFrame(this),s++;while(this.isPlaying&&this.accumulator>this.nextTick&&s<60)}}},setCurrentFrame:function(t){var e=this.parent;return this.currentFrame=t,e.texture=t.frame.texture,e.frame=t.frame,e.isCropped&&e.frame.updateCropUVs(e._crop,e.flipX,e.flipY),t.setAlpha&&(e.alpha=t.alpha),e.setSizeToFrame(),e._originComponent&&(t.frame.customPivot?e.setOrigin(t.frame.pivotX,t.frame.pivotY):e.updateDisplayOrigin()),this.isPlaying&&this.hasStarted&&(this.emitEvents(cr.ANIMATION_UPDATE),this._pendingStop===3&&this._pendingStopValue===t&&this.stop()),e},nextFrame:function(){return this.currentAnim&&this.currentAnim.nextFrame(this),this.parent},previousFrame:function(){return this.currentAnim&&this.currentAnim.previousFrame(this),this.parent},get:function(t){return this.anims?this.anims.get(t):null},exists:function(t){return this.anims?this.anims.has(t):!1},create:function(t){var e=t.key,i=!1;return e&&(i=this.get(e),i?console.warn("Animation key already exists: "+e):(i=new ipe(this,e,t),this.anims||(this.anims=new npe),this.anims.set(e,i))),i},createFromAseprite:function(t,e){return this.animationManager.createFromAseprite(t,e,this.parent)},generateFrameNames:function(t,e){return this.animationManager.generateFrameNames(t,e)},generateFrameNumbers:function(t,e){return this.animationManager.generateFrameNumbers(t,e)},remove:function(t){var e=this.get(t);return e&&(this.currentAnim===e&&this.stop(),this.anims.delete(t)),e},destroy:function(){this.animationManager.off(cr.REMOVE_ANIMATION,this.globalRemove,this),this.anims&&this.anims.clear(),this.animationManager=null,this.parent=null,this.nextAnim=null,this.nextAnimsQueue.length=0,this.currentAnim=null,this.currentFrame=null},isPaused:{get:function(){return this._paused}}});m2.exports=ape});var g2=u((nWe,v2)=>{"use strict";var ope=function(t,e,i,s){i.addToRenderList(e),e.pipeline.batchSprite(e,i,s)};v2.exports=ope});var y2=u((aWe,T2)=>{"use strict";var S2=Ie(),E2=S2,hpe=S2;E2=g2();T2.exports={renderWebGL:E2,renderCanvas:hpe}});var wh=u((oWe,A2)=>{"use strict";var lpe=Yu(),upe=R(),Nt=ri(),b2=ki(),cpe=y2(),dpe=new upe({Extends:b2,Mixins:[Nt.Alpha,Nt.BlendMode,Nt.Depth,Nt.Flip,Nt.GetBounds,Nt.Mask,Nt.Origin,Nt.Pipeline,Nt.PostPipeline,Nt.ScrollFactor,Nt.Size,Nt.TextureCrop,Nt.Tint,Nt.Transform,Nt.Visible,cpe],initialize:function(e,i,s,r,n){b2.call(this,e,"Sprite"),this._crop=this.resetCropObject(),this.anims=new lpe(this),this.setTexture(r,n),this.setPosition(i,s),this.setSizeToFrame(),this.setOriginFromFrame(),this.initPipeline(),this.initPostPipeline(!0)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},preUpdate:function(t,e){this.anims.update(t,e)},play:function(t,e){return this.anims.play(t,e)},playReverse:function(t,e){return this.anims.playReverse(t,e)},playAfterDelay:function(t,e){return this.anims.playAfterDelay(t,e)},playAfterRepeat:function(t,e){return this.anims.playAfterRepeat(t,e)},chain:function(t){return this.anims.chain(t)},stop:function(){return this.anims.stop()},stopAfterDelay:function(t){return this.anims.stopAfterDelay(t)},stopAfterRepeat:function(t){return this.anims.stopAfterRepeat(t)},stopOnFrame:function(t){return this.anims.stopOnFrame(t)},toJSON:function(){return Nt.ToJSON(this)},preDestroy:function(){this.anims.destroy(),this.anims=void 0}});A2.exports=dpe});var Hu=u((hWe,w2)=>{"use strict";var ge=Gq(),fpe=R(),Za=Wr(),x2=ze(),ppe=Vl(),Re=re(),je=Ne(),kn=Zm(),C2=Xt(),mpe=Pf(),vpe=jm(),gpe=wh(),Spe=new fpe({Extends:x2,initialize:function(e,i,s){x2.call(this),s?i&&!Array.isArray(i)&&(i=[i]):Array.isArray(i)?C2(i[0])&&(s=i,i=null):C2(i)&&(s=i,i=null),this.scene=e,this.children=new vpe,this.isParent=!0,this.type="Group",this.classType=Re(s,"classType",gpe),this.name=Re(s,"name",""),this.active=Re(s,"active",!0),this.maxSize=Re(s,"maxSize",-1),this.defaultKey=Re(s,"defaultKey",null),this.defaultFrame=Re(s,"defaultFrame",null),this.runChildUpdate=Re(s,"runChildUpdate",!1),this.createCallback=Re(s,"createCallback",null),this.removeCallback=Re(s,"removeCallback",null),this.createMultipleCallback=Re(s,"createMultipleCallback",null),this.internalCreateCallback=Re(s,"internalCreateCallback",null),this.internalRemoveCallback=Re(s,"internalRemoveCallback",null),i&&this.addMultiple(i),s&&this.createMultiple(s),this.on(Za.ADDED_TO_SCENE,this.addedToScene,this),this.on(Za.REMOVED_FROM_SCENE,this.removedFromScene,this)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},create:function(t,e,i,s,r,n){if(t===void 0&&(t=0),e===void 0&&(e=0),i===void 0&&(i=this.defaultKey),s===void 0&&(s=this.defaultFrame),r===void 0&&(r=!0),n===void 0&&(n=!0),this.isFull())return null;var a=new this.classType(this.scene,t,e,i,s);return a.addToDisplayList(this.scene.sys.displayList),a.addToUpdateList(),a.visible=r,a.setActive(n),this.add(a),a},createMultiple:function(t){if(this.isFull())return[];Array.isArray(t)||(t=[t]);var e=[];if(t[0].key)for(var i=0;i<t.length;i++){var s=this.createFromConfig(t[i]);e=e.concat(s)}return e},createFromConfig:function(t){if(this.isFull())return[];this.classType=Re(t,"classType",this.classType);var e=Re(t,"key",void 0),i=Re(t,"frame",null),s=Re(t,"visible",!0),r=Re(t,"active",!0),n=[];if(e===void 0)return n;Array.isArray(e)||(e=[e]),Array.isArray(i)||(i=[i]);var a=Re(t,"repeat",0),o=Re(t,"randomKey",!1),h=Re(t,"randomFrame",!1),l=Re(t,"yoyo",!1),c=Re(t,"quantity",!1),d=Re(t,"frameQuantity",1),f=Re(t,"max",0),p=mpe(e,i,{max:f,qty:c||d,random:o,randomB:h,repeat:a,yoyo:l});t.createCallback&&(this.createCallback=t.createCallback),t.removeCallback&&(this.removeCallback=t.removeCallback),t.internalCreateCallback&&(this.internalCreateCallback=t.internalCreateCallback),t.internalRemoveCallback&&(this.internalRemoveCallback=t.internalRemoveCallback);for(var m=0;m<p.length;m++){var v=this.create(0,0,p[m].a,p[m].b,s,r);if(!v)break;n.push(v)}if(kn(t,"setXY")){var g=je(t,"setXY.x",0),S=je(t,"setXY.y",0),y=je(t,"setXY.stepX",0),b=je(t,"setXY.stepY",0);ge.SetXY(n,g,S,y,b)}if(kn(t,"setRotation")){var x=je(t,"setRotation.value",0),A=je(t,"setRotation.step",0);ge.SetRotation(n,x,A)}if(kn(t,"setScale")){var w=je(t,"setScale.x",1),C=je(t,"setScale.y",w),_=je(t,"setScale.stepX",0),N=je(t,"setScale.stepY",0);ge.SetScale(n,w,C,_,N)}if(kn(t,"setOrigin")){var D=je(t,"setOrigin.x",.5),Y=je(t,"setOrigin.y",D),$=je(t,"setOrigin.stepX",0),j=je(t,"setOrigin.stepY",0);ge.SetOrigin(n,D,Y,$,j)}if(kn(t,"setAlpha")){var G=je(t,"setAlpha.value",1),Z=je(t,"setAlpha.step",0);ge.SetAlpha(n,G,Z)}if(kn(t,"setDepth")){var ee=je(t,"setDepth.value",0),te=je(t,"setDepth.step",0);ge.SetDepth(n,ee,te)}if(kn(t,"setScrollFactor")){var Q=je(t,"setScrollFactor.x",1),Ae=je(t,"setScrollFactor.y",Q),gt=je(t,"setScrollFactor.stepX",0),St=je(t,"setScrollFactor.stepY",0);ge.SetScrollFactor(n,Q,Ae,gt,St)}var rt=Re(t,"hitArea",null),Et=Re(t,"hitAreaCallback",null);rt&&ge.SetHitArea(n,rt,Et);var Ee=Re(t,"gridAlign",!1);return Ee&&ge.GridAlign(n,Ee),this.createMultipleCallback&&this.createMultipleCallback.call(this,n),n},preUpdate:function(t,e){if(!(!this.runChildUpdate||this.children.size===0))for(var i=this.children.entries.slice(),s=0;s<i.length;s++){var r=i[s];r.active&&r.update(t,e)}},add:function(t,e){return e===void 0&&(e=!1),this.isFull()?this:(this.children.set(t),this.internalCreateCallback&&this.internalCreateCallback.call(this,t),this.createCallback&&this.createCallback.call(this,t),e&&(t.addToDisplayList(this.scene.sys.displayList),t.addToUpdateList()),t.on(Za.DESTROY,this.remove,this),this)},addMultiple:function(t,e){if(e===void 0&&(e=!1),Array.isArray(t))for(var i=0;i<t.length;i++)this.add(t[i],e);return this},remove:function(t,e,i){return e===void 0&&(e=!1),i===void 0&&(i=!1),this.children.contains(t)?(this.children.delete(t),this.internalRemoveCallback&&this.internalRemoveCallback.call(this,t),this.removeCallback&&this.removeCallback.call(this,t),t.off(Za.DESTROY,this.remove,this),i?t.destroy():e&&(t.removeFromDisplayList(),t.removeFromUpdateList()),this):this},clear:function(t,e){t===void 0&&(t=!1),e===void 0&&(e=!1);for(var i=this.children,s=0;s<i.size;s++){var r=i.entries[s];r.off(Za.DESTROY,this.remove,this),e?r.destroy():t&&(r.removeFromDisplayList(),r.removeFromUpdateList())}return this.children.clear(),this},contains:function(t){return this.children.contains(t)},getChildren:function(){return this.children.entries},getLength:function(){return this.children.size},getMatching:function(t,e,i,s){return ppe(this.children.entries,t,e,i,s)},getFirst:function(t,e,i,s,r,n,a){return this.getHandler(!0,1,t,e,i,s,r,n,a)},getFirstNth:function(t,e,i,s,r,n,a,o){return this.getHandler(!0,t,e,i,s,r,n,a,o)},getLast:function(t,e,i,s,r,n,a){return this.getHandler(!1,1,t,e,i,s,r,n,a)},getLastNth:function(t,e,i,s,r,n,a,o){return this.getHandler(!1,t,e,i,s,r,n,a,o)},getHandler:function(t,e,i,s,r,n,a,o,h){i===void 0&&(i=!1),s===void 0&&(s=!1);var l,c,d=0,f=this.children.entries;if(t)for(c=0;c<f.length;c++)if(l=f[c],l.active===i){if(d++,d===e)break}else l=null;else for(c=f.length-1;c>=0;c--)if(l=f[c],l.active===i){if(d++,d===e)break}else l=null;return l?(typeof r=="number"&&(l.x=r),typeof n=="number"&&(l.y=n),l):s?this.create(r,n,a,o,h):null},get:function(t,e,i,s,r){return this.getFirst(!1,!0,t,e,i,s,r)},getFirstAlive:function(t,e,i,s,r,n){return this.getFirst(!0,t,e,i,s,r,n)},getFirstDead:function(t,e,i,s,r,n){return this.getFirst(!1,t,e,i,s,r,n)},playAnimation:function(t,e){return ge.PlayAnimation(this.children.entries,t,e),this},isFull:function(){return this.maxSize===-1?!1:this.children.size>=this.maxSize},countActive:function(t){t===void 0&&(t=!0);for(var e=0,i=0;i<this.children.size;i++)this.children.entries[i].active===t&&e++;return e},getTotalUsed:function(){return this.countActive()},getTotalFree:function(){var t=this.getTotalUsed(),e=this.maxSize===-1?999999999999:this.maxSize;return e-t},setActive:function(t){return this.active=t,this},setName:function(t){return this.name=t,this},propertyValueSet:function(t,e,i,s,r){return ge.PropertyValueSet(this.children.entries,t,e,i,s,r),this},propertyValueInc:function(t,e,i,s,r){return ge.PropertyValueInc(this.children.entries,t,e,i,s,r),this},setX:function(t,e){return ge.SetX(this.children.entries,t,e),this},setY:function(t,e){return ge.SetY(this.children.entries,t,e),this},setXY:function(t,e,i,s){return ge.SetXY(this.children.entries,t,e,i,s),this},incX:function(t,e){return ge.IncX(this.children.entries,t,e),this},incY:function(t,e){return ge.IncY(this.children.entries,t,e),this},incXY:function(t,e,i,s){return ge.IncXY(this.children.entries,t,e,i,s),this},shiftPosition:function(t,e,i){return ge.ShiftPosition(this.children.entries,t,e,i),this},angle:function(t,e){return ge.Angle(this.children.entries,t,e),this},rotate:function(t,e){return ge.Rotate(this.children.entries,t,e),this},rotateAround:function(t,e){return ge.RotateAround(this.children.entries,t,e),this},rotateAroundDistance:function(t,e,i){return ge.RotateAroundDistance(this.children.entries,t,e,i),this},setAlpha:function(t,e){return ge.SetAlpha(this.children.entries,t,e),this},setTint:function(t,e,i,s){return ge.SetTint(this.children.entries,t,e,i,s),this},setOrigin:function(t,e,i,s){return ge.SetOrigin(this.children.entries,t,e,i,s),this},scaleX:function(t,e){return ge.ScaleX(this.children.entries,t,e),this},scaleY:function(t,e){return ge.ScaleY(this.children.entries,t,e),this},scaleXY:function(t,e,i,s){return ge.ScaleXY(this.children.entries,t,e,i,s),this},setDepth:function(t,e){return ge.SetDepth(this.children.entries,t,e),this},setBlendMode:function(t){return ge.SetBlendMode(this.children.entries,t),this},setHitArea:function(t,e){return ge.SetHitArea(this.children.entries,t,e),this},shuffle:function(){return ge.Shuffle(this.children.entries),this},kill:function(t){this.children.contains(t)&&t.setActive(!1)},killAndHide:function(t){this.children.contains(t)&&(t.setActive(!1),t.setVisible(!1))},setVisible:function(t,e,i){return ge.SetVisible(this.children.entries,t,e,i),this},toggleVisible:function(){return ge.ToggleVisible(this.children.entries),this},destroy:function(t,e){t===void 0&&(t=!1),e===void 0&&(e=!1),!(!this.scene||this.ignoreDestroy)&&(this.emit(Za.DESTROY,this),this.removeAllListeners(),this.scene.sys.updateList.remove(this),this.clear(e,t),this.scene=void 0,this.children=void 0)}});w2.exports=Spe});var P2=u((lWe,R2)=>{"use strict";var Epe=function(t,e,i,s){i.addToRenderList(e),this.pipeline.batchSprite(e,i,s)};R2.exports=Epe});var M2=u((uWe,L2)=>{"use strict";var _2=Ie(),I2=_2,Tpe=_2;I2=P2();L2.exports={renderWebGL:I2,renderCanvas:Tpe}});var Rh=u((cWe,D2)=>{"use strict";var ype=R(),jt=ri(),O2=ki(),bpe=M2(),Ape=new ype({Extends:O2,Mixins:[jt.Alpha,jt.BlendMode,jt.Depth,jt.Flip,jt.GetBounds,jt.Mask,jt.Origin,jt.Pipeline,jt.PostPipeline,jt.ScrollFactor,jt.Size,jt.TextureCrop,jt.Tint,jt.Transform,jt.Visible,bpe],initialize:function(e,i,s,r,n){O2.call(this,e,"Image"),this._crop=this.resetCropObject(),this.setTexture(r,n),this.setPosition(i,s),this.setSizeToFrame(),this.setOriginFromFrame(),this.initPipeline(),this.initPostPipeline(!0)}});D2.exports=Ape});var Ph=u((dWe,U2)=>{"use strict";var xpe=tm(),B2=sm(),Cpe=am(),Jm={bezier:xpe,catmull:B2,catmullrom:B2,linear:Cpe},wpe=function(t){if(t===null)return null;var e=Jm.linear;return typeof t=="string"?Jm.hasOwnProperty(t)&&(e=Jm[t]):typeof t=="function"&&(e=t),e};U2.exports=wpe});var F2=u((fWe,N2)=>{"use strict";var Rpe=function(t,e,i,s){return i===void 0&&(i=0),e===0?t:(t-=i,t=e*Math.round(t/e),s?(i+t)/e:i+t)};N2.exports=Rpe});var zu=u((pWe,G2)=>{"use strict";var Ppe=Mn(),_pe=Je(),Ipe=R(),Lpe=za(),k2=Zr(),Mpe=re(),Ope=Ph(),Dpe=F2(),Bpe=Ba(),Upe=new Ipe({initialize:function(e,i,s){s===void 0&&(s=!1),this.propertyKey=e,this.propertyValue=i,this.defaultValue=i,this.steps=0,this.counter=0,this.yoyo=!1,this.direction=0,this.start=0,this.current=0,this.end=0,this.ease=null,this.interpolation=null,this.emitOnly=s,this.onEmit=this.defaultEmit,this.onUpdate=this.defaultUpdate,this.active=!0,this.method=0,this._onEmit,this._onUpdate},loadConfig:function(t,e){t===void 0&&(t={}),e&&(this.propertyKey=e),this.propertyValue=Mpe(t,this.propertyKey,this.defaultValue),this.method=this.getMethod(),this.setMethods(),this.emitOnly&&(this.onUpdate=this.defaultUpdate)},toJSON:function(){return JSON.stringify(this.propertyValue)},onChange:function(t){var e;switch(this.method){case 1:case 3:case 8:e=t;break;case 2:this.propertyValue.indexOf(t)>=0&&(e=t);break;case 4:var i=(this.end-this.start)/this.steps;e=Dpe(t,i),this.counter=e;break;case 5:case 6:case 7:e=_pe(t,this.start,this.end);break;case 9:e=this.start[0];break}return this.current=e,this},getMethod:function(){var t=this.propertyValue;if(t===null)return 0;var e=typeof t;if(e==="number")return 1;if(Array.isArray(t))return 2;if(e==="function")return 3;if(e==="object"){if(this.hasBoth(t,"start","end"))return this.has(t,"steps")?4:5;if(this.hasBoth(t,"min","max"))return 6;if(this.has(t,"random"))return 7;if(this.hasEither(t,"onEmit","onUpdate"))return 8;if(this.hasEither(t,"values","interpolation"))return 9}return 0},setMethods:function(){var t=this.propertyValue,e=t,i=this.defaultEmit,s=this.defaultUpdate;switch(this.method){case 1:i=this.staticValueEmit;break;case 2:i=this.randomStaticValueEmit,e=t[0];break;case 3:this._onEmit=t,i=this.proxyEmit,e=this.defaultValue;break;case 4:this.start=t.start,this.end=t.end,this.steps=t.steps,this.counter=this.start,this.yoyo=this.has(t,"yoyo")?t.yoyo:!1,this.direction=0,i=this.steppedEmit,e=this.start;break;case 5:this.start=t.start,this.end=t.end;var r=this.has(t,"ease")?t.ease:"Linear";this.ease=k2(r,t.easeParams),i=this.has(t,"random")&&t.random?this.randomRangedValueEmit:this.easedValueEmit,s=this.easeValueUpdate,e=this.start;break;case 6:this.start=t.min,this.end=t.max,i=this.has(t,"int")&&t.int?this.randomRangedIntEmit:this.randomRangedValueEmit,e=this.start;break;case 7:var n=t.random;Array.isArray(n)&&(this.start=n[0],this.end=n[1]),i=this.randomRangedIntEmit,e=this.start;break;case 8:this._onEmit=this.has(t,"onEmit")?t.onEmit:this.defaultEmit,this._onUpdate=this.has(t,"onUpdate")?t.onUpdate:this.defaultUpdate,i=this.proxyEmit,s=this.proxyUpdate,e=this.defaultValue;break;case 9:this.start=t.values;var a=this.has(t,"ease")?t.ease:"Linear";this.ease=k2(a,t.easeParams),this.interpolation=Ope(t.interpolation),i=this.easedValueEmit,s=this.easeValueUpdate,e=this.start[0];break}return this.onEmit=i,this.onUpdate=s,this.current=e,this},has:function(t,e){return t.hasOwnProperty(e)},hasBoth:function(t,e,i){return t.hasOwnProperty(e)&&t.hasOwnProperty(i)},hasEither:function(t,e,i){return t.hasOwnProperty(e)||t.hasOwnProperty(i)},defaultEmit:function(){return this.defaultValue},defaultUpdate:function(t,e,i,s){return s},proxyEmit:function(t,e,i){var s=this._onEmit(t,e,i);return this.current=s,s},proxyUpdate:function(t,e,i,s){var r=this._onUpdate(t,e,i,s);return this.current=r,r},staticValueEmit:function(){return this.current},staticValueUpdate:function(){return this.current},randomStaticValueEmit:function(){var t=Math.floor(Math.random()*this.propertyValue.length);return this.current=this.propertyValue[t],this.current},randomRangedValueEmit:function(t,e){var i=Lpe(this.start,this.end);return t&&t.data[e]&&(t.data[e].min=i,t.data[e].max=this.end),this.current=i,i},randomRangedIntEmit:function(t,e){var i=Ppe(this.start,this.end);return t&&t.data[e]&&(t.data[e].min=i,t.data[e].max=this.end),this.current=i,i},steppedEmit:function(){var t=this.counter,e=t,i=(this.end-this.start)/this.steps;if(this.yoyo){var s;this.direction===0?(e+=i,e>=this.end&&(s=e-this.end,e=this.end-s,this.direction=1)):(e-=i,e<=this.start&&(s=this.start-e,e=this.start+s,this.direction=0)),this.counter=e}else this.counter=Bpe(e+i,this.start,this.end);return this.current=t,t},easedValueEmit:function(t,e){if(t&&t.data[e]){var i=t.data[e];i.min=this.start,i.max=this.end}return this.current=this.start,this.start},easeValueUpdate:function(t,e,i){var s=t.data[e],r,n=this.ease(i);return this.interpolation?r=this.interpolation(this.start,n):r=(s.max-s.min)*n+s.min,this.current=r,r},destroy:function(){this.propertyValue=null,this.defaultValue=null,this.ease=null,this.interpolation=null,this._onEmit=null,this._onUpdate=null}});G2.exports=Upe});var Qm=u((mWe,Y2)=>{"use strict";var Npe=R(),q2=zu(),Fpe=In(),W2=Zr(),kpe=Ph(),Gpe=ou(),qpe=new Npe({Extends:q2,initialize:function(e){q2.call(this,e,null,!1),this.active=!1,this.easeName="Linear",this.r=[],this.g=[],this.b=[]},getMethod:function(){return this.propertyValue===null?0:9},setMethods:function(){var t=this.propertyValue,e=t,i=this.defaultEmit,s=this.defaultUpdate;if(this.method===9){this.start=t[0],this.ease=W2("Linear"),this.interpolation=kpe("linear"),i=this.easedValueEmit,s=this.easeValueUpdate,e=t[0],this.active=!0;for(var r=0;r<t.length;r++){var n=Gpe(t[r]);this.r.push(n.r),this.g.push(n.g),this.b.push(n.b)}}return this.onEmit=i,this.onUpdate=s,this.current=e,this},setEase:function(t){this.easeName=t,this.ease=W2(t)},easedValueEmit:function(){return this.current=this.start,this.start},easeValueUpdate:function(t,e,i){var s=this.ease(i),r=this.interpolation(this.r,s),n=this.interpolation(this.g,s),a=this.interpolation(this.b,s),o=Fpe(r,n,a);return this.current=o,o}});Y2.exports=qpe});var z2=u((vWe,H2)=>{"use strict";H2.exports="complete"});var X2=u((gWe,V2)=>{"use strict";V2.exports="deathzone"});var Z2=u((SWe,K2)=>{"use strict";K2.exports="explode"});var $2=u((EWe,j2)=>{"use strict";j2.exports="start"});var Q2=u((TWe,J2)=>{"use strict";J2.exports="stop"});var ev=u((yWe,eW)=>{"use strict";eW.exports={COMPLETE:z2(),DEATH_ZONE:X2(),EXPLODE:Z2(),START:$2(),STOP:Q2()}});var Vu=u((bWe,tW)=>{"use strict";var Wpe=R(),Ype=new Wpe({initialize:function(e,i,s){e===void 0&&(e=0),i===void 0&&(i=0),s===void 0&&(s=!0),this.emitter,this.x=e,this.y=i,this.active=s},update:function(){},destroy:function(){this.emitter=null}});tW.exports=Ype});var tv=u((AWe,sW)=>{"use strict";var Hpe=R(),_h=re(),iW=Vu(),zpe=new Hpe({Extends:iW,initialize:function(e,i,s,r,n){if(typeof e=="object"){var a=e;e=_h(a,"x",0),i=_h(a,"y",0),s=_h(a,"power",0),r=_h(a,"epsilon",100),n=_h(a,"gravity",50)}else e===void 0&&(e=0),i===void 0&&(i=0),s===void 0&&(s=0),r===void 0&&(r=100),n===void 0&&(n=50);iW.call(this,e,i,!0),this._gravity=n,this._power=s*n,this._epsilon=r*r},update:function(t,e){var i=this.x-t.x,s=this.y-t.y,r=i*i+s*s;if(r!==0){var n=Math.sqrt(r);r<this._epsilon&&(r=this._epsilon);var a=this._power*e/(r*n)*100;t.velocityX+=i*a,t.velocityY+=s*a}},epsilon:{get:function(){return Math.sqrt(this._epsilon)},set:function(t){this._epsilon=t*t}},power:{get:function(){return this._power/this._gravity},set:function(t){this._power=t*this._gravity}},gravity:{get:function(){return this._gravity},set:function(t){var e=this.power;this._gravity=t,this.power=e}}});sW.exports=zpe});var rv=u((xWe,rW)=>{"use strict";var Vpe=Yu(),iv=Je(),Xpe=R(),sv=Na(),Kpe=Ze(),Xu=kf(),Ih=Fe(),Zpe=new Xpe({initialize:function(e){this.emitter=e,this.texture=null,this.frame=null,this.x=0,this.y=0,this.worldPosition=new Ih,this.velocityX=0,this.velocityY=0,this.accelerationX=0,this.accelerationY=0,this.maxVelocityX=1e4,this.maxVelocityY=1e4,this.bounce=0,this.scaleX=1,this.scaleY=1,this.alpha=1,this.angle=0,this.rotation=0,this.tint=16777215,this.life=1e3,this.lifeCurrent=1e3,this.delayCurrent=0,this.holdCurrent=0,this.lifeT=0,this.data={tint:{min:16777215,max:16777215},alpha:{min:1,max:1},rotate:{min:0,max:0},scaleX:{min:1,max:1},scaleY:{min:1,max:1},x:{min:0,max:0},y:{min:0,max:0},accelerationX:{min:0,max:0},accelerationY:{min:0,max:0},maxVelocityX:{min:0,max:0},maxVelocityY:{min:0,max:0},moveToX:{min:0,max:0},moveToY:{min:0,max:0},bounce:{min:0,max:0}},this.isCropped=!1,this.scene=e.scene,this.anims=null,this.emitter.anims.length>0&&(this.anims=new Vpe(this)),this.bounds=new Kpe},emit:function(t,e,i,s,r,n){return this.emitter.emit(t,e,i,s,r,n)},isAlive:function(){return this.lifeCurrent>0},kill:function(){this.lifeCurrent=0},setPosition:function(t,e){t===void 0&&(t=0),e===void 0&&(e=0),this.x=t,this.y=e},fire:function(t,e){var i=this.emitter,s=i.ops,r=i.getAnim();if(r?this.anims.play(r):(this.frame=i.getFrame(),this.texture=this.frame.texture),!this.frame)throw new Error("Particle has no texture frame");if(i.getEmitZone(this),t===void 0?this.x+=s.x.onEmit(this,"x"):s.x.steps>0?this.x+=t+s.x.onEmit(this,"x"):this.x+=t,e===void 0?this.y+=s.y.onEmit(this,"y"):s.y.steps>0?this.y+=e+s.y.onEmit(this,"y"):this.y+=e,this.life=s.lifespan.onEmit(this,"lifespan"),this.lifeCurrent=this.life,this.lifeT=0,this.delayCurrent=s.delay.onEmit(this,"delay"),this.holdCurrent=s.hold.onEmit(this,"hold"),this.scaleX=s.scaleX.onEmit(this,"scaleX"),this.scaleY=s.scaleY.active?s.scaleY.onEmit(this,"scaleY"):this.scaleX,this.angle=s.rotate.onEmit(this,"rotate"),this.rotation=sv(this.angle),i.worldMatrix.transformPoint(this.x,this.y,this.worldPosition),this.delayCurrent===0&&i.getDeathZone(this))return this.lifeCurrent=0,!1;var n=s.speedX.onEmit(this,"speedX"),a=s.speedY.active?s.speedY.onEmit(this,"speedY"):n;if(i.radial){var o=sv(s.angle.onEmit(this,"angle"));this.velocityX=Math.cos(o)*Math.abs(n),this.velocityY=Math.sin(o)*Math.abs(a)}else if(i.moveTo){var h=s.moveToX.onEmit(this,"moveToX"),l=s.moveToY.onEmit(this,"moveToY"),c=this.life/1e3;this.velocityX=(h-this.x)/c,this.velocityY=(l-this.y)/c}else this.velocityX=n,this.velocityY=a;return i.acceleration&&(this.accelerationX=s.accelerationX.onEmit(this,"accelerationX"),this.accelerationY=s.accelerationY.onEmit(this,"accelerationY")),this.maxVelocityX=s.maxVelocityX.onEmit(this,"maxVelocityX"),this.maxVelocityY=s.maxVelocityY.onEmit(this,"maxVelocityY"),this.bounce=s.bounce.onEmit(this,"bounce"),this.alpha=s.alpha.onEmit(this,"alpha"),s.color.active?this.tint=s.color.onEmit(this,"tint"):this.tint=s.tint.onEmit(this,"tint"),!0},update:function(t,e,i){if(this.lifeCurrent<=0)return this.holdCurrent>0?(this.holdCurrent-=t,this.holdCurrent<=0):!0;if(this.delayCurrent>0)return this.delayCurrent-=t,!1;this.anims&&this.anims.update(0,t);var s=this.emitter,r=s.ops,n=1-this.lifeCurrent/this.life;if(this.lifeT=n,this.x=r.x.onUpdate(this,"x",n,this.x),this.y=r.y.onUpdate(this,"y",n,this.y),s.moveTo){var a=r.moveToX.onUpdate(this,"moveToX",n,s.moveToX),o=r.moveToY.onUpdate(this,"moveToY",n,s.moveToY),h=this.lifeCurrent/1e3;this.velocityX=(a-this.x)/h,this.velocityY=(o-this.y)/h}return this.computeVelocity(s,t,e,i,n),this.scaleX=r.scaleX.onUpdate(this,"scaleX",n,this.scaleX),r.scaleY.active?this.scaleY=r.scaleY.onUpdate(this,"scaleY",n,this.scaleY):this.scaleY=this.scaleX,this.angle=r.rotate.onUpdate(this,"rotate",n,this.angle),this.rotation=sv(this.angle),s.getDeathZone(this)?(this.lifeCurrent=0,!0):(this.alpha=iv(r.alpha.onUpdate(this,"alpha",n,this.alpha),0,1),r.color.active?this.tint=r.color.onUpdate(this,"color",n,this.tint):this.tint=r.tint.onUpdate(this,"tint",n,this.tint),this.lifeCurrent-=t,this.lifeCurrent<=0&&this.holdCurrent<=0)},computeVelocity:function(t,e,i,s,r){var n=t.ops,a=this.velocityX,o=this.velocityY,h=n.accelerationX.onUpdate(this,"accelerationX",r,this.accelerationX),l=n.accelerationY.onUpdate(this,"accelerationY",r,this.accelerationY),c=n.maxVelocityX.onUpdate(this,"maxVelocityX",r,this.maxVelocityX),d=n.maxVelocityY.onUpdate(this,"maxVelocityY",r,this.maxVelocityY);this.bounce=n.bounce.onUpdate(this,"bounce",r,this.bounce),a+=t.gravityX*i+h*i,o+=t.gravityY*i+l*i,a=iv(a,-c,c),o=iv(o,-d,d),this.velocityX=a,this.velocityY=o,this.x+=a*i,this.y+=o*i,t.worldMatrix.transformPoint(this.x,this.y,this.worldPosition);for(var f=0;f<s.length;f++){var p=s[f];p.active&&p.update(this,e,i,r)}},setSizeToFrame:function(){},getBounds:function(t){t===void 0&&(t=this.emitter.getWorldTransformMatrix());var e=Math.abs(t.scaleX)*this.scaleX,i=Math.abs(t.scaleY)*this.scaleY,s=this.x,r=this.y,n=this.rotation,a=this.frame.width*e/2,o=this.frame.height*i/2,h=this.bounds,l=new Ih(s-a,r-o),c=new Ih(s+a,r-o),d=new Ih(s-a,r+o),f=new Ih(s+a,r+o);return n!==0&&(Xu(l,s,r,n),Xu(c,s,r,n),Xu(d,s,r,n),Xu(f,s,r,n)),t.transformPoint(l.x,l.y,l),t.transformPoint(c.x,c.y,c),t.transformPoint(d.x,d.y,d),t.transformPoint(f.x,f.y,f),h.x=Math.min(l.x,c.x,d.x,f.x),h.y=Math.min(l.y,c.y,d.y,f.y),h.width=Math.max(l.x,c.x,d.x,f.x)-h.x,h.height=Math.max(l.y,c.y,d.y,f.y)-h.y,h},destroy:function(){this.anims&&this.anims.destroy(),this.anims=null,this.emitter=null,this.texture=null,this.frame=null,this.scene=null}});rW.exports=Zpe});var nv=u((CWe,aW)=>{"use strict";var jpe=R(),nW=Vu(),$pe=Ze(),Jpe=new jpe({Extends:nW,initialize:function(e,i,s,r,n,a,o,h){n===void 0&&(n=!0),a===void 0&&(a=!0),o===void 0&&(o=!0),h===void 0&&(h=!0),nW.call(this,e,i,!0),this.bounds=new $pe(e,i,s,r),this.collideLeft=n,this.collideRight=a,this.collideTop=o,this.collideBottom=h},update:function(t){var e=this.bounds,i=-t.bounce,s=t.worldPosition;s.x<e.x&&this.collideLeft?(t.x+=e.x-s.x,t.velocityX*=i):s.x>e.right&&this.collideRight&&(t.x-=s.x-e.right,t.velocityX*=i),s.y<e.y&&this.collideTop?(t.y+=e.y-s.y,t.velocityY*=i):s.y>e.bottom&&this.collideBottom&&(t.y-=s.y-e.bottom,t.velocityY*=i)}});aW.exports=Jpe});var av=u((wWe,oW)=>{"use strict";var Qpe=function(t,e){return e.setTo(t.x,t.y,t.width,t.height)};oW.exports=Qpe});var ov=u((RWe,hW)=>{"use strict";var eme=R(),tme=new eme({initialize:function(e,i){this.source=e,this.killOnEnter=i},willKill:function(t){var e=t.worldPosition,i=this.source.contains(e.x,e.y);return i&&this.killOnEnter||!i&&!this.killOnEnter}});hW.exports=tme});var hv=u((PWe,lW)=>{"use strict";var ime=R(),sme=new ime({initialize:function(e,i,s,r,n,a){r===void 0&&(r=!1),n===void 0&&(n=!0),a===void 0&&(a=-1),this.source=e,this.points=[],this.quantity=i,this.stepRate=s,this.yoyo=r,this.counter=-1,this.seamless=n,this._length=0,this._direction=0,this.total=a,this.updateSource()},updateSource:function(){if(this.points=this.source.getPoints(this.quantity,this.stepRate),this.seamless){var t=this.points[0],e=this.points[this.points.length-1];t.x===e.x&&t.y===e.y&&this.points.pop()}var i=this._length;return this._length=this.points.length,this._length<i&&this.counter>this._length&&(this.counter=this._length-1),this},changeSource:function(t){return this.source=t,this.updateSource()},getPoint:function(t){this._direction===0?(this.counter++,this.counter>=this._length&&(this.yoyo?(this._direction=1,this.counter=this._length-1):this.counter=0)):(this.counter--,this.counter===-1&&(this.yoyo?(this._direction=0,this.counter=0):this.counter=this._length-1));var e=this.points[this.counter];e&&(t.x=e.x,t.y=e.y)}});lW.exports=sme});var cW=u((_We,uW)=>{"use strict";var rme=function(t,e){for(var i=0;i<e.length;i++)if(t.hasOwnProperty(e[i]))return!0;return!1};uW.exports=rme});var lv=u((IWe,dW)=>{"use strict";var nme=uu(),ame=function(t,e,i){var s=t.centerX,r=t.centerY;return t.setSize(t.width+e*2,t.height+i*2),nme(t,s,r)};dW.exports=ame});var uv=u((LWe,fW)=>{"use strict";var ome=function(t,e){var i=Math.min(t.x,e.x),s=Math.max(t.right,e.right);t.x=i,t.width=s-i;var r=Math.min(t.y,e.y),n=Math.max(t.bottom,e.bottom);return t.y=r,t.height=n-r,t};fW.exports=ome});var Ku=u((MWe,pW)=>{"use strict";var hme=gh(),lme=function(t,e){var i=hme(t);for(var s in e)i.hasOwnProperty(s)&&(i[s]=e[s]);return i};pW.exports=lme});var cv=u((OWe,mW)=>{"use strict";var ume=R(),cme=Fe(),dme=new ume({initialize:function(e){this.source=e,this._tempVec=new cme,this.total=-1},getPoint:function(t){var e=this._tempVec;this.source.getRandomPoint(e),t.x=e.x,t.y=e.y}});mW.exports=dme});var Zu=u((DWe,vW)=>{"use strict";var fme=function(t,e){return t.width<=0||t.height<=0||e.width<=0||e.height<=0?!1:!(t.right<e.x||t.bottom<e.y||t.x>e.right||t.y>e.bottom)};vW.exports=fme});var SW=u((BWe,gW)=>{"use strict";var pme=Zu(),ju=ws(),mme=Ti(),vme=new ju,gme=new ju,Sme=new ju,Eme=new ju,Tme=function(t,e,i,s){var r=t.pipelines.set(e.pipeline),n=vme,a=gme,o=Sme,h=Eme;s?(h.loadIdentity(),h.multiply(s),h.translate(e.x,e.y),h.rotate(e.rotation),h.scale(e.scaleX,e.scaleY)):h.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY);var l=mme.getTintAppendFloatAlpha,c=i.alpha,d=e.alpha;t.pipelines.preBatch(e);var f=e.alive,p=f.length,m=e.viewBounds;if(!(p===0||m&&!pme(m,i.worldView))){e.sortCallback&&e.depthSort(),i.addToRenderList(e),n.copyFrom(i.matrix),n.multiplyWithOffset(h,-i.scrollX*e.scrollFactorX,-i.scrollY*e.scrollFactorY),t.setBlendMode(e.blendMode),e.mask&&(e.mask.preRenderWebGL(t,e,i),t.pipelines.set(e.pipeline));for(var v=e.tintFill,g,S,y=0;y<p;y++){var b=f[y],x=b.alpha*d*c;if(!(x<=0||b.scaleX===0||b.scaleY===0)){o.applyITRS(b.x,b.y,b.rotation,b.scaleX,b.scaleY),o.e=b.x,o.f=b.y,n.multiply(o,a);var A=b.frame;A.glTexture!==S&&(S=A.glTexture,g=r.setGameObject(e,A));var w=-A.halfWidth,C=-A.halfHeight,_=a.setQuad(w,C,w+A.width,C+A.height),N=l(b.tint,x);r.shouldFlush(6)&&(r.flush(),g=r.setGameObject(e,A)),r.batchQuad(e,_[0],_[1],_[2],_[3],_[4],_[5],_[6],_[7],A.u0,A.v0,A.u1,A.v1,N,N,N,N,v,S,g)}}e.mask&&e.mask.postRenderWebGL(t,i),t.pipelines.postBatch(e)}};gW.exports=Tme});var bW=u((UWe,yW)=>{"use strict";var EW=Ie(),TW=EW,yme=EW;TW=SW();yW.exports={renderWebGL:TW,renderCanvas:yme}});var Ju=u((NWe,IW)=>{"use strict";var bme=R(),Bs=ri(),Ame=su(),AW=av(),dv=ov(),xW=hv(),xme=Qm(),et=zu(),ja=ev(),CW=ki(),$e=re(),wW=wf(),Cme=tv(),wme=cW(),$t=Zm(),Rme=lv(),Pme=Zp(),RW=uv(),_me=Ku(),Ime=rv(),Lme=nv(),PW=cv(),Mme=Ze(),Ome=Zu(),_W=tr(),Dme=bW(),Bme=ih(),Ume=ws(),Nme=Fe(),Fme=Ba(),$u=["active","advance","blendMode","colorEase","deathCallback","deathCallbackScope","duration","emitCallback","emitCallbackScope","follow","frequency","gravityX","gravityY","maxAliveParticles","maxParticles","name","emitting","particleBringToTop","particleClass","radial","sortCallback","sortOrderAsc","sortProperty","stopAfter","tintFill","timeScale","trackVisible","visible"],$a=["accelerationX","accelerationY","alpha","angle","bounce","color","delay","hold","lifespan","maxVelocityX","maxVelocityY","moveToX","moveToY","quantity","rotate","scaleX","scaleY","speedX","speedY","tint","x","y"],kme=new bme({Extends:CW,Mixins:[Bs.AlphaSingle,Bs.BlendMode,Bs.Depth,Bs.Mask,Bs.Pipeline,Bs.PostPipeline,Bs.ScrollFactor,Bs.Texture,Bs.Transform,Bs.Visible,Dme],initialize:function(e,i,s,r,n){CW.call(this,e,"ParticleEmitter"),this.particleClass=Ime,this.config=null,this.ops={accelerationX:new et("accelerationX",0),accelerationY:new et("accelerationY",0),alpha:new et("alpha",1),angle:new et("angle",{min:0,max:360},!0),bounce:new et("bounce",0),color:new xme("color"),delay:new et("delay",0,!0),hold:new et("hold",0,!0),lifespan:new et("lifespan",1e3,!0),maxVelocityX:new et("maxVelocityX",1e4),maxVelocityY:new et("maxVelocityY",1e4),moveToX:new et("moveToX",0),moveToY:new et("moveToY",0),quantity:new et("quantity",1,!0),rotate:new et("rotate",0),scaleX:new et("scaleX",1),scaleY:new et("scaleY",1),speedX:new et("speedX",0,!0),speedY:new et("speedY",0,!0),tint:new et("tint",16777215),x:new et("x",0),y:new et("y",0)},this.radial=!0,this.gravityX=0,this.gravityY=0,this.acceleration=!1,this.moveTo=!1,this.emitCallback=null,this.emitCallbackScope=null,this.deathCallback=null,this.deathCallbackScope=null,this.maxParticles=0,this.maxAliveParticles=0,this.stopAfter=0,this.duration=0,this.frequency=0,this.emitting=!0,this.particleBringToTop=!0,this.timeScale=1,this.emitZones=[],this.deathZones=[],this.viewBounds=null,this.follow=null,this.followOffset=new Nme,this.trackVisible=!1,this.frames=[],this.randomFrame=!0,this.frameQuantity=1,this.anims=[],this.randomAnim=!0,this.animQuantity=1,this.dead=[],this.alive=[],this.counters=new Float32Array(10),this.skipping=!1,this.worldMatrix=new Ume,this.sortProperty="",this.sortOrderAsc=!0,this.sortCallback=this.depthSortCallback,this.processors=new Pme(this),this.tintFill=!1,this.initPipeline(),this.initPostPipeline(),this.setPosition(i,s),this.setTexture(r),n&&this.setConfig(n)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},setConfig:function(t){if(!t)return this;this.config=t;var e=0,i="",s=this.ops;for(e=0;e<$a.length;e++)i=$a[e],s[i].loadConfig(t);for(e=0;e<$u.length;e++)i=$u[e],$t(t,i)&&(this[i]=$e(t,i));if(this.acceleration=this.accelerationX!==0||this.accelerationY!==0,this.moveTo=this.moveToX!==0&&this.moveToY!==0,$t(t,"speed")&&(s.speedX.loadConfig(t,"speed"),s.speedY.active=!1),(wme(t,["speedX","speedY"])||this.moveTo)&&(this.radial=!1),$t(t,"scale")&&(s.scaleX.loadConfig(t,"scale"),s.scaleY.active=!1),$t(t,"callbackScope")){var r=$e(t,"callbackScope",null);this.emitCallbackScope=r,this.deathCallbackScope=r}if($t(t,"emitZone")&&this.addEmitZone(t.emitZone),$t(t,"deathZone")&&this.addDeathZone(t.deathZone),$t(t,"bounds")){var n=this.addParticleBounds(t.bounds);n.collideLeft=$e(t,"collideLeft",!0),n.collideRight=$e(t,"collideRight",!0),n.collideTop=$e(t,"collideTop",!0),n.collideBottom=$e(t,"collideBottom",!0)}return $t(t,"followOffset")&&this.followOffset.setFromObject($e(t,"followOffset",0)),$t(t,"texture")&&this.setTexture(t.texture),$t(t,"frame")?this.setEmitterFrame(t.frame):$t(t,"anim")&&this.setAnim(t.anim),$t(t,"reserve")&&this.reserve(t.reserve),$t(t,"advance")&&this.fastForward(t.advance),this.resetCounters(this.frequency,this.emitting),this.emitting&&this.emit(ja.START,this),this},updateConfig:function(t){return t&&(this.config?this.setConfig(_me(this.config,t)):this.setConfig(t)),this},toJSON:function(){var t=Ame(this),e=0,i="";for(e=0;e<$u.length;e++)i=$u[e],t[i]=this[i];var s=this.ops;for(e=0;e<$a.length;e++)i=$a[e],s[i]&&(t[i]=s[i].toJSON());return s.speedY.active||(delete t.speedX,t.speed=s.speedX.toJSON()),this.scaleX===this.scaleY&&(delete t.scaleX,delete t.scaleY,t.scale=s.scaleX.toJSON()),t},resetCounters:function(t,e){var i=this.counters;i.fill(0),i[0]=t,e&&(i[5]=1)},startFollow:function(t,e,i,s){return e===void 0&&(e=0),i===void 0&&(i=0),s===void 0&&(s=!1),this.follow=t,this.followOffset.set(e,i),this.trackVisible=s,this},stopFollow:function(){return this.follow=null,this.followOffset.set(0,0),this.trackVisible=!1,this},getFrame:function(){var t=this.frames,e=t.length,i;return e===1?i=t[0]:this.randomFrame?i=wW(t):(i=t[this.currentFrame],this.frameCounter++,this.frameCounter===this.frameQuantity&&(this.frameCounter=0,this.currentFrame++,this.currentFrame===e&&(this.currentFrame=0))),this.texture.get(i)},setEmitterFrame:function(t,e,i){e===void 0&&(e=!0),i===void 0&&(i=1),this.randomFrame=e,this.frameQuantity=i,this.currentFrame=0;var s=typeof t;if(this.frames.length=0,Array.isArray(t))this.frames=this.frames.concat(t);else if(s==="string"||s==="number")this.frames.push(t);else if(s==="object"){var r=t;t=$e(r,"frames",null),t&&(this.frames=this.frames.concat(t));var n=$e(r,"cycle",!1);this.randomFrame=!n,this.frameQuantity=$e(r,"quantity",i)}return this.frames.length===1&&(this.frameQuantity=1,this.randomFrame=!1),this},getAnim:function(){var t=this.anims,e=t.length;if(e===0)return null;if(e===1)return t[0];if(this.randomAnim)return wW(t);var i=t[this.currentAnim];return this.animCounter++,this.animCounter>=this.animQuantity&&(this.animCounter=0,this.currentAnim=Fme(this.currentAnim+1,0,e)),i},setAnim:function(t,e,i){e===void 0&&(e=!0),i===void 0&&(i=1),this.randomAnim=e,this.animQuantity=i,this.currentAnim=0;var s=typeof t;if(this.anims.length=0,Array.isArray(t))this.anims=this.anims.concat(t);else if(s==="string")this.anims.push(t);else if(s==="object"){var r=t;t=$e(r,"anims",null),t&&(this.anims=this.anims.concat(t));var n=$e(r,"cycle",!1);this.randomAnim=!n,this.animQuantity=$e(r,"quantity",i)}return this.anims.length===1&&(this.animQuantity=1,this.randomAnim=!1),this},setRadial:function(t){return t===void 0&&(t=!0),this.radial=t,this},addParticleBounds:function(t,e,i,s,r,n,a,o){if(typeof t=="object"){var h=t;t=h.x,e=h.y,i=$t(h,"w")?h.w:h.width,s=$t(h,"h")?h.h:h.height}return this.addParticleProcessor(new Lme(t,e,i,s,r,n,a,o))},setParticleSpeed:function(t,e){return e===void 0&&(e=t),this.ops.speedX.onChange(t),t===e?this.ops.speedY.active=!1:this.ops.speedY.onChange(e),this.radial=!0,this},setParticleScale:function(t,e){return t===void 0&&(t=1),e===void 0&&(e=t),this.ops.scaleX.onChange(t),this.ops.scaleY.onChange(e),this},setParticleGravity:function(t,e){return this.gravityX=t,this.gravityY=e,this},setParticleAlpha:function(t){return this.ops.alpha.onChange(t),this},setParticleTint:function(t){return this.ops.tint.onChange(t),this},setEmitterAngle:function(t){return this.ops.angle.onChange(t),this},setParticleLifespan:function(t){return this.ops.lifespan.onChange(t),this},setQuantity:function(t){return this.quantity=t,this},setFrequency:function(t,e){return this.frequency=t,this.flowCounter=t>0?t:0,e&&(this.quantity=e),this},addDeathZone:function(t){Array.isArray(t)||(t=[t]);for(var e,i=[],s=0;s<t.length;s++)if(e=t[s],e instanceof dv)i.push(e);else if(typeof e.contains=="function")e=new dv(e,!0),i.push(e);else{var r=$e(e,"type","onEnter"),n=$e(e,"source",null);if(n&&typeof n.contains=="function"){var a=r==="onEnter";e=new dv(n,a),i.push(e)}}return this.deathZones=this.deathZones.concat(i),i},removeDeathZone:function(t){return _W(this.deathZones,t),this},clearDeathZones:function(){return this.deathZones.length=0,this},addEmitZone:function(t){Array.isArray(t)||(t=[t]);for(var e,i=[],s=0;s<t.length;s++)if(e=t[s],e instanceof PW||e instanceof xW)i.push(e);else{var r=$e(e,"source",null);if(r){var n=$e(e,"type","random");if(n==="random"&&typeof r.getRandomPoint=="function")e=new PW(r),i.push(e);else if(n==="edge"&&typeof r.getPoints=="function"){var a=$e(e,"quantity",1),o=$e(e,"stepRate",0),h=$e(e,"yoyo",!1),l=$e(e,"seamless",!0),c=$e(e,"total",-1);e=new xW(r,a,o,h,l,c),i.push(e)}}}return this.emitZones=this.emitZones.concat(i),i},removeEmitZone:function(t){return _W(this.emitZones,t),this.zoneIndex=0,this},clearEmitZones:function(){return this.emitZones.length=0,this.zoneIndex=0,this},getEmitZone:function(t){var e=this.emitZones,i=e.length;if(i!==0){var s=e[this.zoneIndex];s.getPoint(t),s.total>-1&&(this.zoneTotal++,this.zoneTotal===s.total&&(this.zoneTotal=0,this.zoneIndex++,this.zoneIndex===i&&(this.zoneIndex=0)))}},getDeathZone:function(t){for(var e=this.deathZones,i=0;i<e.length;i++){var s=e[i];if(s.willKill(t))return this.emit(ja.DEATH_ZONE,this,t,s),!0}return!1},setEmitZone:function(t){var e;return isFinite(t)?e=t:e=this.emitZones.indexOf(t),e>=0&&(this.zoneIndex=e),this},addParticleProcessor:function(t){return this.processors.exists(t)||(t.emitter&&t.emitter.removeParticleProcessor(t),this.processors.add(t),t.emitter=this),t},removeParticleProcessor:function(t){return this.processors.exists(t)&&(this.processors.remove(t,!0),t.emitter=null),t},getProcessors:function(){return this.processors.getAll("active",!0)},createGravityWell:function(t){return this.addParticleProcessor(new Cme(t))},reserve:function(t){var e=this.dead;if(this.maxParticles>0){var i=this.getParticleCount();i+t>this.maxParticles&&(t=this.maxParticles-(i+t))}for(var s=0;s<t;s++)e.push(new this.particleClass(this));return this},getAliveParticleCount:function(){return this.alive.length},getDeadParticleCount:function(){return this.dead.length},getParticleCount:function(){return this.getAliveParticleCount()+this.getDeadParticleCount()},atLimit:function(){return this.maxParticles>0&&this.getParticleCount()>=this.maxParticles?!0:this.maxAliveParticles>0&&this.getAliveParticleCount()>=this.maxAliveParticles},onParticleEmit:function(t,e){return t===void 0?(this.emitCallback=null,this.emitCallbackScope=null):typeof t=="function"&&(this.emitCallback=t,e&&(this.emitCallbackScope=e)),this},onParticleDeath:function(t,e){return t===void 0?(this.deathCallback=null,this.deathCallbackScope=null):typeof t=="function"&&(this.deathCallback=t,e&&(this.deathCallbackScope=e)),this},killAll:function(){for(var t=this.dead,e=this.alive;e.length>0;)t.push(e.pop());return this},forEachAlive:function(t,e){for(var i=this.alive,s=i.length,r=0;r<s;r++)t.call(e,i[r],this);return this},forEachDead:function(t,e){for(var i=this.dead,s=i.length,r=0;r<s;r++)t.call(e,i[r],this);return this},start:function(t,e){return t===void 0&&(t=0),this.emitting||(t>0&&this.fastForward(t),this.emitting=!0,this.resetCounters(this.frequency,!0),e!==void 0&&(this.duration=Math.abs(e)),this.emit(ja.START,this)),this},stop:function(t){return t===void 0&&(t=!1),this.emitting&&(this.emitting=!1,t&&this.killAll(),this.emit(ja.STOP,this)),this},pause:function(){return this.active=!1,this},resume:function(){return this.active=!0,this},setSortProperty:function(t,e){return t===void 0&&(t=""),e===void 0&&(e=this.true),this.sortProperty=t,this.sortOrderAsc=e,this.sortCallback=this.depthSortCallback,this},setSortCallback:function(t){return this.sortProperty!==""?t=this.depthSortCallback:t=null,this.sortCallback=t,this},depthSort:function(){return Bme(this.alive,this.sortCallback.bind(this)),this},depthSortCallback:function(t,e){var i=this.sortProperty;return this.sortOrderAsc?t[i]-e[i]:e[i]-t[i]},flow:function(t,e,i){return e===void 0&&(e=1),this.emitting=!1,this.frequency=t,this.quantity=e,i!==void 0&&(this.stopAfter=i),this.start()},explode:function(t,e,i){this.frequency=-1,this.resetCounters(-1,!0);var s=this.emitParticle(t,e,i);return this.emit(ja.EXPLODE,this,s),s},emitParticleAt:function(t,e,i){return this.emitParticle(i,t,e)},emitParticle:function(t,e,i){if(!this.atLimit()){t===void 0&&(t=this.ops.quantity.onEmit());for(var s=this.dead,r=this.stopAfter,n=this.follow?this.follow.x+this.followOffset.x:e,a=this.follow?this.follow.y+this.followOffset.y:i,o=0;o<t;o++){var h=s.pop();if(h||(h=new this.particleClass(this)),h.fire(n,a)?(this.particleBringToTop?this.alive.push(h):this.alive.unshift(h),this.emitCallback&&this.emitCallback.call(this.emitCallbackScope,h,this)):this.dead.push(h),r>0&&(this.stopCounter++,this.stopCounter>=r)||this.atLimit())break}return h}},fastForward:function(t,e){e===void 0&&(e=1e3/60);var i=0;for(this.skipping=!0;i<Math.abs(t);)this.preUpdate(0,e),i+=e;return this.skipping=!1,this},preUpdate:function(t,e){e*=this.timeScale;var i=e/1e3;this.trackVisible&&(this.visible=this.follow.visible),this.getWorldTransformMatrix(this.worldMatrix);var s=this.getProcessors(),r=this.alive,n=this.dead,a=0,o=[],h=r.length;for(a=0;a<h;a++){var l=r[a];l.update(e,i,s)&&o.push({index:a,particle:l})}if(h=o.length,h>0){var c=this.deathCallback,d=this.deathCallbackScope;for(a=h-1;a>=0;a--){var f=o[a];r.splice(f.index,1),n.push(f.particle),c&&c.call(d,f.particle),f.particle.setPosition()}}if(!this.emitting&&!this.skipping){this.completeFlag===1&&r.length===0&&(this.completeFlag=0,this.emit(ja.COMPLETE,this));return}if(this.frequency===0)this.emitParticle();else if(this.frequency>0)for(this.flowCounter-=e;this.flowCounter<=0;)this.emitParticle(),this.flowCounter+=this.frequency;this.skipping||(this.duration>0&&(this.elapsed+=e,this.elapsed>=this.duration&&this.stop()),this.stopAfter>0&&this.stopCounter>=this.stopAfter&&this.stop())},overlap:function(t){for(var e=this.getWorldTransformMatrix(),i=this.alive,s=i.length,r=[],n=0;n<s;n++){var a=i[n];Ome(t,a.getBounds(e))&&r.push(a)}return r},getBounds:function(t,e,i,s){t===void 0&&(t=0),e===void 0&&(e=0),i===void 0&&(i=1e3/60),s===void 0&&(s=new Mme);var r=this.getWorldTransformMatrix(),n,a,o=this.alive,h=!1;if(s.setTo(0,0,0,0),e>0){var l=0;for(this.skipping=!0;l<Math.abs(e);){for(this.preUpdate(0,i),n=0;n<o.length;n++)a=o[n].getBounds(r),h?RW(s,a):(h=!0,AW(a,s));l+=i}this.skipping=!1}else for(n=0;n<o.length;n++)a=o[n].getBounds(r),h?RW(s,a):(h=!0,AW(a,s));return t>0&&Rme(s,t,t),s},createEmitter:function(){throw new Error("createEmitter removed. See ParticleEmitter docs for info")},particleX:{get:function(){return this.ops.x.current},set:function(t){this.ops.x.onChange(t)}},particleY:{get:function(){return this.ops.y.current},set:function(t){this.ops.y.onChange(t)}},accelerationX:{get:function(){return this.ops.accelerationX.current},set:function(t){this.ops.accelerationX.onChange(t)}},accelerationY:{get:function(){return this.ops.accelerationY.current},set:function(t){this.ops.accelerationY.onChange(t)}},maxVelocityX:{get:function(){return this.ops.maxVelocityX.current},set:function(t){this.ops.maxVelocityX.onChange(t)}},maxVelocityY:{get:function(){return this.ops.maxVelocityY.current},set:function(t){this.ops.maxVelocityY.onChange(t)}},speed:{get:function(){return this.ops.speedX.current},set:function(t){this.ops.speedX.onChange(t),this.ops.speedY.onChange(t)}},speedX:{get:function(){return this.ops.speedX.current},set:function(t){this.ops.speedX.onChange(t)}},speedY:{get:function(){return this.ops.speedY.current},set:function(t){this.ops.speedY.onChange(t)}},moveToX:{get:function(){return this.ops.moveToX.current},set:function(t){this.ops.moveToX.onChange(t)}},moveToY:{get:function(){return this.ops.moveToY.current},set:function(t){this.ops.moveToY.onChange(t)}},bounce:{get:function(){return this.ops.bounce.current},set:function(t){this.ops.bounce.onChange(t)}},particleScaleX:{get:function(){return this.ops.scaleX.current},set:function(t){this.ops.scaleX.onChange(t)}},particleScaleY:{get:function(){return this.ops.scaleY.current},set:function(t){this.ops.scaleY.onChange(t)}},particleColor:{get:function(){return this.ops.color.current},set:function(t){this.ops.color.onChange(t)}},colorEase:{get:function(){return this.ops.color.easeName},set:function(t){this.ops.color.setEase(t)}},particleTint:{get:function(){return this.ops.tint.current},set:function(t){this.ops.tint.onChange(t)}},particleAlpha:{get:function(){return this.ops.alpha.current},set:function(t){this.ops.alpha.onChange(t)}},lifespan:{get:function(){return this.ops.lifespan.current},set:function(t){this.ops.lifespan.onChange(t)}},particleAngle:{get:function(){return this.ops.angle.current},set:function(t){this.ops.angle.onChange(t)}},particleRotate:{get:function(){return this.ops.rotate.current},set:function(t){this.ops.rotate.onChange(t)}},quantity:{get:function(){return this.ops.quantity.current},set:function(t){this.ops.quantity.onChange(t)}},delay:{get:function(){return this.ops.delay.current},set:function(t){this.ops.delay.onChange(t)}},hold:{get:function(){return this.ops.hold.current},set:function(t){this.ops.hold.onChange(t)}},flowCounter:{get:function(){return this.counters[0]},set:function(t){this.counters[0]=t}},frameCounter:{get:function(){return this.counters[1]},set:function(t){this.counters[1]=t}},animCounter:{get:function(){return this.counters[2]},set:function(t){this.counters[2]=t}},elapsed:{get:function(){return this.counters[3]},set:function(t){this.counters[3]=t}},stopCounter:{get:function(){return this.counters[4]},set:function(t){this.counters[4]=t}},completeFlag:{get:function(){return this.counters[5]},set:function(t){this.counters[5]=t}},zoneIndex:{get:function(){return this.counters[6]},set:function(t){this.counters[6]=t}},zoneTotal:{get:function(){return this.counters[7]},set:function(t){this.counters[7]=t}},currentFrame:{get:function(){return this.counters[8]},set:function(t){this.counters[8]=t}},currentAnim:{get:function(){return this.counters[9]},set:function(t){this.counters[9]=t}},preDestroy:function(){this.texture=null,this.frames=null,this.anims=null,this.emitCallback=null,this.emitCallbackScope=null,this.deathCallback=null,this.deathCallbackScope=null,this.emitZones=null,this.deathZones=null,this.bounds=null,this.follow=null,this.counters=null;var t,e=this.ops;for(t=0;t<$a.length;t++){var i=$a[t];e[i].destroy()}for(t=0;t<this.alive.length;t++)this.alive[t].destroy();for(t=0;t<this.dead.length;t++)this.dead[t].destroy();this.ops=null,this.alive=[],this.dead=[],this.worldMatrix.destroy()}});IW.exports=kme});var MW=u((FWe,LW)=>{"use strict";LW.exports={DeathZone:ov(),EdgeZone:hv(),RandomZone:cv()}});var DW=u((kWe,OW)=>{"use strict";OW.exports={EmitterColorOp:Qm(),EmitterOp:zu(),Events:ev(),GravityWell:tv(),Particle:rv(),ParticleBounds:nv(),ParticleEmitter:Ju(),ParticleProcessor:Vu(),Zones:MW()}});var Qu=u((GWe,BW)=>{"use strict";var Gme=function(t,e){var i;if(e)typeof e=="string"?i=document.getElementById(e):typeof e=="object"&&e.nodeType===1&&(i=e);else if(t.parentElement||e===null)return t;return i||(i=document.body),i.appendChild(t),t};BW.exports=Gme});var fv=u((qWe,UW)=>{"use strict";var qme=function(t,e,i){var s=t.canvas,r=t.context,n=t.style,a=[],o=0,h=i.length;n.maxLines>0&&n.maxLines<i.length&&(h=n.maxLines),n.syncFont(s,r);for(var l=t.letterSpacing,c=0;c<h;c++){var d=n.strokeThickness;if(l===0)d+=r.measureText(i[c]).width;else{for(var f=i[c],p=0;p<f.length;p++)d+=r.measureText(f[p]).width;f.length>1&&(d+=l*(f.length-1))}n.wordWrap&&(d-=r.measureText(" ").width),a[c]=Math.ceil(d),o=Math.max(o,a[c])}var m=e.fontSize+n.strokeThickness,v=m*h,g=t.lineSpacing;return h>1&&(v+=g*(h-1)),{width:o,height:v,lines:h,lineWidths:a,lineSpacing:g,lineHeight:m}};UW.exports=qme});var FW=u((WWe,NW)=>{"use strict";var Wme=function(t){t.parentNode&&t.parentNode.removeChild(t)};NW.exports=Wme});var GW=u((YWe,kW)=>{"use strict";var Yme=Ti(),Hme=function(t,e,i,s){if(!(e.width===0||e.height===0)){i.addToRenderList(e);var r=e.frame,n=r.width,a=r.height,o=Yme.getTintAppendFloatAlpha,h=t.pipelines.set(e.pipeline,e),l=h.setTexture2D(r.glTexture,e);h.batchTexture(e,r.glTexture,n,a,e.x,e.y,n/e.style.resolution,a/e.style.resolution,e.scaleX,e.scaleY,e.rotation,e.flipX,e.flipY,e.scrollFactorX,e.scrollFactorY,e.displayOriginX,e.displayOriginY,0,0,n,a,o(e.tintTopLeft,i.alpha*e._alphaTL),o(e.tintTopRight,i.alpha*e._alphaTR),o(e.tintBottomLeft,i.alpha*e._alphaBL),o(e.tintBottomRight,i.alpha*e._alphaBR),e.tintFill,0,0,i,s,!1,l)}};kW.exports=Hme});var HW=u((HWe,YW)=>{"use strict";var qW=Ie(),WW=qW,zme=qW;WW=GW();YW.exports={renderWebGL:WW,renderCanvas:zme}});var pv=u((zWe,zW)=>{"use strict";var ec=Ui(),Vme=function(t){var e=ec.create(this),i=e.getContext("2d",{willReadFrequently:!0});t.syncFont(e,i);var s=i.measureText(t.testString);if("actualBoundingBoxAscent"in s){var r=s.actualBoundingBoxAscent,n=s.actualBoundingBoxDescent;return ec.remove(e),{ascent:r,descent:n,fontSize:r+n}}var a=Math.ceil(s.width*t.baselineX),o=a,h=2*o;o=o*t.baselineY|0,e.width=a,e.height=h,i.fillStyle="#f00",i.fillRect(0,0,a,h),i.font=t._font,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(t.testString,0,o);var l={ascent:0,descent:0,fontSize:0},c=i.getImageData(0,0,a,h);if(!c)return l.ascent=o,l.descent=o+6,l.fontSize=l.ascent+l.descent,ec.remove(e),l;var d=c.data,f=d.length,p=a*4,m,v,g=0,S=!1;for(m=0;m<o;m++){for(v=0;v<p;v+=4)if(d[g+v]!==255){S=!0;break}if(!S)g+=p;else break}for(l.ascent=o-m,g=f-p,S=!1,m=h;m>o;m--){for(v=0;v<p;v+=4)if(d[g+v]!==255){S=!0;break}if(!S)g-=p;else break}return l.descent=m-o,l.fontSize=l.ascent+l.descent,ec.remove(e),l};zW.exports=Vme});var mv=u((VWe,XW)=>{"use strict";var Xme=R(),Kme=oi(),Us=Ne(),VW=pv(),Lh={fontFamily:["fontFamily","Courier"],fontSize:["fontSize","16px"],fontStyle:["fontStyle",""],backgroundColor:["backgroundColor",null],color:["color","#fff"],stroke:["stroke","#fff"],strokeThickness:["strokeThickness",0],shadowOffsetX:["shadow.offsetX",0],shadowOffsetY:["shadow.offsetY",0],shadowColor:["shadow.color","#000"],shadowBlur:["shadow.blur",0],shadowStroke:["shadow.stroke",!1],shadowFill:["shadow.fill",!1],align:["align","left"],maxLines:["maxLines",0],fixedWidth:["fixedWidth",0],fixedHeight:["fixedHeight",0],resolution:["resolution",0],rtl:["rtl",!1],testString:["testString","|M\xC3\u2030qgy"],baselineX:["baselineX",1.2],baselineY:["baselineY",1.4],wordWrapWidth:["wordWrap.width",null],wordWrapCallback:["wordWrap.callback",null],wordWrapCallbackScope:["wordWrap.callbackScope",null],wordWrapUseAdvanced:["wordWrap.useAdvancedWrap",!1]},Zme=new Xme({initialize:function(e,i){this.parent=e,this.fontFamily,this.fontSize,this.fontStyle,this.backgroundColor,this.color,this.stroke,this.strokeThickness,this.shadowOffsetX,this.shadowOffsetY,this.shadowColor,this.shadowBlur,this.shadowStroke,this.shadowFill,this.align,this.maxLines,this.fixedWidth,this.fixedHeight,this.resolution,this.rtl,this.testString,this.baselineX,this.baselineY,this.wordWrapWidth,this.wordWrapCallback,this.wordWrapCallbackScope,this.wordWrapUseAdvanced,this._font,this.setStyle(i,!1,!0)},setStyle:function(t,e,i){e===void 0&&(e=!0),i===void 0&&(i=!1);for(var s in Lh){var r=i?Lh[s][1]:this[s];s==="wordWrapCallback"||s==="wordWrapCallbackScope"?this[s]=Us(t,Lh[s][0],r):t&&s==="fontSize"&&typeof t.fontSize=="number"?this[s]=t.fontSize.toString()+"px":this[s]=Kme(t,Lh[s][0],r)}var n=Us(t,"font",null);n!==null&&this.setFont(n,!1),this._font=[this.fontStyle,this.fontSize,this.fontFamily].join(" ").trim();var a=Us(t,"fill",null);a!==null&&(this.color=a);var o=Us(t,"metrics",!1);return o?this.metrics={ascent:Us(o,"ascent",0),descent:Us(o,"descent",0),fontSize:Us(o,"fontSize",0)}:(e||!this.metrics)&&(this.metrics=VW(this)),e?this.parent.updateText():this.parent},syncFont:function(t,e){e.font=this._font},syncStyle:function(t,e){e.textBaseline="alphabetic",e.fillStyle=this.color,e.strokeStyle=this.stroke,e.lineWidth=this.strokeThickness,e.lineCap="round",e.lineJoin="round"},syncShadow:function(t,e){e?(t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY,t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur):(t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowColor=0,t.shadowBlur=0)},update:function(t){return t&&(this._font=[this.fontStyle,this.fontSize,this.fontFamily].join(" ").trim(),this.metrics=VW(this)),this.parent.updateText()},setFont:function(t,e){e===void 0&&(e=!0);var i=t,s="",r="";if(typeof t!="string")i=Us(t,"fontFamily","Courier"),s=Us(t,"fontSize","16px"),r=Us(t,"fontStyle","");else{var n=t.split(" "),a=0;r=n.length>2?n[a++]:"",s=n[a++]||"16px",i=n[a++]||"Courier"}return(i!==this.fontFamily||s!==this.fontSize||r!==this.fontStyle)&&(this.fontFamily=i,this.fontSize=s,this.fontStyle=r,e&&this.update(!0)),this.parent},setFontFamily:function(t){return this.fontFamily!==t&&(this.fontFamily=t,this.update(!0)),this.parent},setFontStyle:function(t){return this.fontStyle!==t&&(this.fontStyle=t,this.update(!0)),this.parent},setFontSize:function(t){return typeof t=="number"&&(t=t.toString()+"px"),this.fontSize!==t&&(this.fontSize=t,this.update(!0)),this.parent},setTestString:function(t){return this.testString=t,this.update(!0)},setFixedSize:function(t,e){return this.fixedWidth=t,this.fixedHeight=e,t&&(this.parent.width=t),e&&(this.parent.height=e),this.update(!1)},setBackgroundColor:function(t){return this.backgroundColor=t,this.update(!1)},setFill:function(t){return this.color=t,this.update(!1)},setColor:function(t){return this.color=t,this.update(!1)},setResolution:function(t){return this.resolution=t,this.update(!1)},setStroke:function(t,e){return e===void 0&&(e=this.strokeThickness),t===void 0&&this.strokeThickness!==0?(this.strokeThickness=0,this.update(!0)):(this.stroke!==t||this.strokeThickness!==e)&&(this.stroke=t,this.strokeThickness=e,this.update(!0)),this.parent},setShadow:function(t,e,i,s,r,n){return t===void 0&&(t=0),e===void 0&&(e=0),i===void 0&&(i="#000"),s===void 0&&(s=0),r===void 0&&(r=!1),n===void 0&&(n=!0),this.shadowOffsetX=t,this.shadowOffsetY=e,this.shadowColor=i,this.shadowBlur=s,this.shadowStroke=r,this.shadowFill=n,this.update(!1)},setShadowOffset:function(t,e){return t===void 0&&(t=0),e===void 0&&(e=t),this.shadowOffsetX=t,this.shadowOffsetY=e,this.update(!1)},setShadowColor:function(t){return t===void 0&&(t="#000"),this.shadowColor=t,this.update(!1)},setShadowBlur:function(t){return t===void 0&&(t=0),this.shadowBlur=t,this.update(!1)},setShadowStroke:function(t){return this.shadowStroke=t,this.update(!1)},setShadowFill:function(t){return this.shadowFill=t,this.update(!1)},setWordWrapWidth:function(t,e){return e===void 0&&(e=!1),this.wordWrapWidth=t,this.wordWrapUseAdvanced=e,this.update(!1)},setWordWrapCallback:function(t,e){return e===void 0&&(e=null),this.wordWrapCallback=t,this.wordWrapCallbackScope=e,this.update(!1)},setAlign:function(t){return t===void 0&&(t="left"),this.align=t,this.update(!1)},setMaxLines:function(t){return t===void 0&&(t=0),this.maxLines=t,this.update(!1)},getTextMetrics:function(){var t=this.metrics;return{ascent:t.ascent,descent:t.descent,fontSize:t.fontSize}},toJSON:function(){var t={};for(var e in Lh)t[e]=this[e];return t.metrics=this.getTextMetrics(),t},destroy:function(){this.parent=void 0}});XW.exports=Zme});var ZW=u((XWe,KW)=>{"use strict";var jme=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=Math.random()*16|0,i=t==="x"?e:e&3|8;return i.toString(16)})};KW.exports=jme});var JW=u((ZWe,$W)=>{"use strict";var KWe=Qi(),Ja=[],jr={},jW={},$me=function(){var t=function(n){var a=n.scene,o=s();if(o===null){o={key:n.key,texture:a.textures.addCanvas(null,n.canvas,!0),text:n,dirty:!0};var h=o.texture.source[0];h._originRedrawGlTexture=h.redrawGlTexture,h._container=o,h.redrawGlTexture=function(){var l=this._textObject;if(l!=null){var c=this._container;c!=null&&(this._originRedrawGlTexture(),l.dirty=!0,c.dirty=!0,l.updateTexture())}},Ja.push(o)}jr[n.key]=o,jW[n.key]=!0,n.texture=o.texture,n.frame=o.texture.get(),o.text=n,o.key=n.key,o.texture.source[0]._textObject=n},e=function(n){if(jW[n.key]=!0,jr[n.key]!==void 0){var a=jr[n.key];n.texture=a.texture,n.frame=a.texture.get(),a.texture.source[0]._textObject=n}else t(n);return jr[n.key]},i=function(){for(var n=0;n<Ja.length;n++){var a=Ja[n];a.text!==null&&(a.text.texture=null,a.text.frame=null,a.text.dirty=!0,a.dirty=!0,a.key="",a.text=null)}jr={},this.poolByKey=jr},s=function(){for(var n=0;n<Ja.length;n++){var a=Ja[n];if(a.key==="")return a}return null},r=function(n){return jr[n]};return{create:t,use:e,pool:Ja,poolByKey:jr,clear:i,getContainer:r}};$W.exports=$me()});var ic=u((jWe,sY)=>{"use strict";var QW=Qu(),eY=Ui(),Jme=R(),Ft=ri(),tY=ki(),Qme=fv(),Qa=Ne(),eve=FW(),tve=HW(),ive=mv(),iY=ZW(),tc=JW(),sve=new Jme({Extends:tY,Mixins:[Ft.Alpha,Ft.BlendMode,Ft.ComputedSize,Ft.Crop,Ft.Depth,Ft.Flip,Ft.GetBounds,Ft.Mask,Ft.Origin,Ft.Pipeline,Ft.PostPipeline,Ft.ScrollFactor,Ft.Tint,Ft.Transform,Ft.Visible,tve],initialize:function(e,i,s,r,n){i===void 0&&(i=0),s===void 0&&(s=0),tY.call(this,e,"Text"),this.key=iY(),this.renderer=e.sys.renderer,this.setPosition(i,s),this.setOrigin(0,0),this.initPipeline(),this.initPostPipeline(!0),this.canvas=eY.create(this),this.context=this.canvas.getContext("2d",{willReadFrequently:!0}),this.style=new ive(this,n),this.autoRound=!0,this.splitRegExp=/(?:\r\n|\r|\n)/,this._text=void 0,this.padding={left:0,right:0,top:0,bottom:0},this.width=1,this.height=1,this.lineSpacing=0,this.letterSpacing=0,this.dirty=!0,this.style.resolution===0&&(this.style.resolution=1),this._crop=this.resetCropObject(),this._textureKey=iY(),this.reuseTexture=!1,this.texture=e.sys.textures.addCanvas(this._textureKey,this.canvas),this.frame=this.texture.get(),this.frame.source.resolution=this.style.resolution,this.renderer&&this.renderer.gl&&(this.renderer.deleteTexture(this.frame.source.glTexture),this.frame.source.glTexture=null),this.initRTL(),this.setText(r),n&&n.padding&&this.setPadding(n.padding),n&&n.lineSpacing&&this.setLineSpacing(n.lineSpacing),n&&n.letterSpacing&&this.setLetterSpacing(n.letterSpacing)},initRTL:function(){this.style.rtl&&(QW(this.canvas,this.scene.sys.canvas),this.originX=1)},runWordWrap:function(t){var e=this.style;if(e.wordWrapCallback){var i=e.wordWrapCallback.call(e.wordWrapCallbackScope,t,this);return Array.isArray(i)&&(i=i.join(`
`)),i}else return e.wordWrapWidth?e.wordWrapUseAdvanced?this.advancedWordWrap(t,this.context,this.style.wordWrapWidth):this.basicWordWrap(t,this.context,this.style.wordWrapWidth):t},advancedWordWrap:function(t,e,i){for(var s="",r=t.replace(/ +/gi," ").split(this.splitRegExp),n=r.length,a=0;a<n;a++){var o=r[a],h="";o=o.replace(/^ *|\s*$/gi,"");var l=o.length*this.letterSpacing,c=e.measureText(o).width+l;if(c<i){s+=o+`
`;continue}for(var d=i,f=o.split(" "),p=0;p<f.length;p++){var m=f[p],v=m+" ",g=v.length*this.letterSpacing,S=e.measureText(v).width+g;if(console.log(f.length,m),S>d){if(p===0){for(var y=v;y.length;){y=y.slice(0,-1);var b=y.length*this.letterSpacing;if(S=e.measureText(y).width+b,S<=d)break}if(!y.length)throw new Error("wordWrapWidth < a single character");var x=m.substr(y.length);f[p]=x,h+=y}var A=f[p].length?p:p+1,w=f.slice(A).join(" ").replace(/[ \n]*$/gi,"");r.splice(a+1,0,w),n=r.length;break}else h+=v,d-=S}s+=h.replace(/[ \n]*$/gi,"")+`
`}return s=s.replace(/[\s|\n]*$/gi,""),s},basicWordWrap:function(t,e,i){for(var s="",r=t.split(this.splitRegExp),n=r.length-1,a=e.measureText(" ").width,o=0;o<=n;o++){for(var h=i,l=r[o].split(" "),c=l.length-1,d=0;d<=c;d++){var f=l[d],p=f.length*this.letterSpacing,m=e.measureText(f).width+p,v=m;d<c&&(v+=a),v>h&&d>0&&(s+=`
`,h=i),s+=f,d<c?(s+=" ",h-=v):h-=m}o<n&&(s+=`
`)}return s},getWrappedText:function(t){t===void 0&&(t=this._text),this.style.syncFont(this.canvas,this.context);var e=this.runWordWrap(t);return e.split(this.splitRegExp)},setText:function(t){return!t&&t!==0&&(t=""),Array.isArray(t)&&(t=t.join(`
`)),t!==this._text&&(this._text=t.toString(),this.dirty=!0,this.updateText()),this},appendText:function(t,e){e===void 0&&(e=!0),!t&&t!==0&&(t=""),Array.isArray(t)&&(t=t.join(`
`)),t=t.toString();var i=this._text.concat(e?`
`+t:t);return i!==this._text&&(this._text=i,this.dirty=!0,this.updateText()),this},setStyle:function(t){return this.style.setStyle(t)},setFont:function(t){return this.style.setFont(t)},setFontFamily:function(t){return this.style.setFontFamily(t)},setFontSize:function(t){return this.style.setFontSize(t)},setFontStyle:function(t){return this.style.setFontStyle(t)},setFixedSize:function(t,e){return this.style.setFixedSize(t,e)},setBackgroundColor:function(t){return this.style.setBackgroundColor(t)},setFill:function(t){return this.style.setFill(t)},setColor:function(t){return this.style.setColor(t)},setStroke:function(t,e){return this.style.setStroke(t,e)},setShadow:function(t,e,i,s,r,n){return this.style.setShadow(t,e,i,s,r,n)},setShadowOffset:function(t,e){return this.style.setShadowOffset(t,e)},setShadowColor:function(t){return this.style.setShadowColor(t)},setShadowBlur:function(t){return this.style.setShadowBlur(t)},setShadowStroke:function(t){return this.style.setShadowStroke(t)},setShadowFill:function(t){return this.style.setShadowFill(t)},setWordWrapWidth:function(t,e){return this.style.setWordWrapWidth(t,e)},setWordWrapCallback:function(t,e){return this.style.setWordWrapCallback(t,e)},setAlign:function(t){return this.style.setAlign(t)},setResolution:function(t){return this.style.setResolution(t)},setLineSpacing:function(t){return this.lineSpacing=t,this.dirty=!0,this.updateText()},setLetterSpacing:function(t){return this.letterSpacing=t,this.dirty=!0,this.updateText()},setPadding:function(t,e,i,s){if(typeof t=="object"){var r=t,n=Qa(r,"x",null);n!==null?(t=n,i=n):(t=Qa(r,"left",0),i=Qa(r,"right",t));var a=Qa(r,"y",null);a!==null?(e=a,s=a):(e=Qa(r,"top",0),s=Qa(r,"bottom",e))}else t===void 0&&(t=0),e===void 0&&(e=t),i===void 0&&(i=t),s===void 0&&(s=e);return this.padding.left=t,this.padding.top=e,this.padding.right=i,this.padding.bottom=s,this.updateText()},setMaxLines:function(t){return this.style.setMaxLines(t)},setRTL:function(t){t===void 0&&(t=!0);var e=this.style;return e.rtl===t?this:(e.rtl=t,t?(this.canvas.dir="rtl",this.context.direction="rtl",this.canvas.style.display="none",QW(this.canvas,this.scene.sys.canvas)):(this.canvas.dir="ltr",this.context.direction="ltr"),e.align==="left"?e.align="right":e.align==="right"&&(e.align="left"),this)},updateText:function(){var t=this.canvas,e=this.context,i=this.style,s=i.resolution,r=i.metrics;i.syncFont(t,e);var n=this._text;(i.wordWrapWidth||i.wordWrapCallback)&&(n=this.runWordWrap(this._text));var a=n.split(this.splitRegExp),o=Qme(this,r,a),h=this.padding,l;i.fixedWidth===0?(this.width=o.width+h.left+h.right,l=o.width):(this.width=i.fixedWidth,l=this.width-h.left-h.right,l<o.width&&(l=o.width)),i.fixedHeight===0?this.height=o.height+h.top+h.bottom:this.height=i.fixedHeight,this.updateDisplayOrigin(),this.lines=a,this.textSize=o,this.textWidth=l,this.dirty=!0;var c=this.input;c&&!c.customHitArea&&(c.hitArea.width=this.width,c.hitArea.height=this.height);var d=tc.getContainer(this.key);return d&&(d.dirty=!0),(!this.reuseTexture||!d)&&this.drawTextCanvas(),this},getTextMetrics:function(){return this.style.getTextMetrics()},text:{get:function(){return this._text},set:function(t){this.setText(t)}},toJSON:function(){var t=Ft.ToJSON(this),e={autoRound:this.autoRound,text:this._text,style:this.style.toJSON(),padding:{left:this.padding.left,right:this.padding.right,top:this.padding.top,bottom:this.padding.bottom}};return t.data=e,t},preDestroy:function(){if(eve(this.canvas),this.reuseTexture){var t=tc.getContainer(this.key);t&&(t.text=null,t.key="",t.dirty=!0)}else{eY.remove(this.canvas);var e=this.texture;e&&e.destroy()}},drawTextCanvas:function(){var t=this.reuseTexture?tc.use(this):null;if(t&&!t.dirty&&!this.dirty)return this;if(!this.lines)return this;var e=this.canvas,i=this.context,s=this.style,r=s.metrics,n=this.textSize,a=this.textWidth,o=this.padding,h=this.lines,l=this.width,c=this.height;l*=s.resolution,c*=s.resolution,l=Math.max(l,1),c=Math.max(c,1),e.width!==l||e.height!==c?(e.width=l,e.height=c,this.frame.setSize(l,c),s.syncFont(e,i),s.rtl&&(i.direction="rtl")):i.clearRect(0,0,l,c),i.save(),i.scale(s.resolution,s.resolution),s.backgroundColor&&(i.fillStyle=s.backgroundColor,i.fillRect(0,0,l,c)),s.syncStyle(e,i),i.translate(o.left,o.top);for(var d,f,p=0;p<n.lines;p++){if(d=s.strokeThickness/2,f=s.strokeThickness/2+p*n.lineHeight+r.ascent,p>0&&(f+=n.lineSpacing*p),s.rtl)d=l-d-o.left-o.right;else if(s.align==="right")d+=a-n.lineWidths[p];else if(s.align==="center")d+=(a-n.lineWidths[p])/2;else if(s.align==="justify"){var m=.85;if(n.lineWidths[p]/n.width>=m){var v=n.width-n.lineWidths[p],g=i.measureText(" ").width,S=h[p].trim(),y=S.split(" ");v+=(h[p].length-S.length)*g;for(var b=Math.floor(v/g),x=0;b>0;)y[x]+=" ",x=(x+1)%(y.length-1||1),--b;h[p]=y.join(" ")}}this.autoRound&&(d=Math.round(d),f=Math.round(f));var A=this.letterSpacing;if(s.strokeThickness&&A===0&&(s.syncShadow(i,s.shadowStroke),i.strokeText(h[p],d,f)),s.color)if(s.syncShadow(i,s.shadowFill),A!==0)for(var w=0,C=h[p].split(""),_=0;_<C.length;_++)s.strokeThickness&&(s.syncShadow(i,s.shadowStroke),i.strokeText(C[_],d+w,f),s.syncShadow(i,s.shadowFill)),i.fillText(C[_],d+w,f),w+=i.measureText(C[_]).width+A;else i.fillText(h[p],d,f)}return i.restore(),this.renderer&&this.renderer.gl&&(this.frame.source.glTexture=this.renderer.canvasToTexture(e,this.frame.source.glTexture,!0)),this.dirty=!1,t&&(t.dirty=!1),this},setObjectKey:function(t){return this.key=t,tc.use(this),this.reuseTexture=!0,this}});sY.exports=sve});var vv=u(($We,nY)=>{"use strict";var rve=R(),ds=ri(),rY=ki(),nve=Ql(),ave=new rve({Extends:rY,Mixins:[ds.AlphaSingle,ds.BlendMode,ds.Depth,ds.GetBounds,ds.Mask,ds.Origin,ds.Pipeline,ds.PostPipeline,ds.ScrollFactor,ds.Transform,ds.Visible],initialize:function(e,i,s){i===void 0&&(i="Shape"),rY.call(this,e,i),this.geom=s,this.pathData=[],this.pathIndexes=[],this.fillColor=16777215,this.fillAlpha=1,this.strokeColor=16777215,this.strokeAlpha=1,this.lineWidth=1,this.isFilled=!1,this.isStroked=!1,this.closePath=!0,this._tempLine=new nve,this.width=0,this.height=0,this.initPipeline(),this.initPostPipeline()},setFillStyle:function(t,e){return e===void 0&&(e=1),t===void 0?this.isFilled=!1:(this.fillColor=t,this.fillAlpha=e,this.isFilled=!0),this},setStrokeStyle:function(t,e,i){return i===void 0&&(i=1),t===void 0?this.isStroked=!1:(this.lineWidth=t,this.strokeColor=e,this.strokeAlpha=i,this.isStroked=!0),this},setClosePath:function(t){return this.closePath=t,this},setSize:function(t,e){return this.width=t,this.height=e,this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this},preDestroy:function(){this.geom=null,this._tempLine=null,this.pathData=[],this.pathIndexes=[]},displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}}});nY.exports=ave});var oY=u((JWe,aY)=>{"use strict";var ove=zr(),hve=Ti(),lve=function(t,e,i,s){i.addToRenderList(e);var r=t.pipelines.set(e.pipeline),n=ove(e,i,s);r.calcMatrix.copyFrom(n.calc);var a=e._displayOriginX,o=e._displayOriginY,h=i.alpha*e.alpha;if(t.pipelines.preBatch(e),e.isStroked){var l=r.strokeTint,c=hve.getTintAppendFloatAlpha(e.strokeColor,e.strokeAlpha*h);l.TL=c,l.TR=c,l.BL=c,l.BR=c,r.batchLine(e.geom.x1-a,e.geom.y1-o,e.geom.x2-a,e.geom.y2-o,e._startWidth/2,e._endWidth/2,1,0,!1,n.sprite,n.camera)}t.pipelines.postBatch(e)};aY.exports=lve});var cY=u((QWe,uY)=>{"use strict";var hY=Ie(),lY=hY,uve=hY;lY=oY();uY.exports={renderWebGL:lY,renderCanvas:uve}});var gv=u((eYe,fY)=>{"use strict";var cve=R(),dY=vv(),dve=Ql(),fve=cY(),pve=new cve({Extends:dY,Mixins:[fve],initialize:function(e,i,s,r,n,a,o,h,l){i===void 0&&(i=0),s===void 0&&(s=0),r===void 0&&(r=0),n===void 0&&(n=0),a===void 0&&(a=128),o===void 0&&(o=0),dY.call(this,e,"Line",new dve(r,n,a,o));var c=Math.max(1,this.geom.right-this.geom.left),d=Math.max(1,this.geom.bottom-this.geom.top);this.lineWidth=1,this._startWidth=1,this._endWidth=1,this.setPosition(i,s),this.setSize(c,d),h!==void 0&&this.setStrokeStyle(1,h,l),this.updateDisplayOrigin()},setLineWidth:function(t,e){return e===void 0&&(e=t),this._startWidth=t,this._endWidth=e,this.lineWidth=t,this},setTo:function(t,e,i,s){return this.geom.setTo(t,e,i,s),this}});fY.exports=pve});var mY=u((tYe,pY)=>{"use strict";var mve=Ti(),vve=function(t,e,i,s,r){var n=t.strokeTint,a=mve.getTintAppendFloatAlpha(e.strokeColor,e.strokeAlpha*i);n.TL=a,n.TR=a,n.BL=a,n.BR=a;var o=e.pathData,h=o.length-1,l=e.lineWidth,c=l/2,d=o[0]-s,f=o[1]-r;e.closePath||(h-=2);for(var p=2;p<h;p+=2){var m=o[p]-s,v=o[p+1]-r;t.batchLine(d,f,m,v,c,c,l,p-2,e.closePath?p===h-1:!1),d=m,f=v}};pY.exports=vve});var gY=u((iYe,vY)=>{"use strict";var gve=zr(),Sve=mY(),Eve=Ti(),Tve=function(t,e,i,s){i.addToRenderList(e);var r=t.pipelines.set(e.pipeline),n=gve(e,i,s);r.calcMatrix.copyFrom(n.calc);var a=e._displayOriginX,o=e._displayOriginY,h=i.alpha*e.alpha;if(t.pipelines.preBatch(e),e.isFilled){var l=r.fillTint,c=Eve.getTintAppendFloatAlpha(e.fillColor,e.fillAlpha*h);l.TL=c,l.TR=c,l.BL=c,l.BR=c,r.batchFillRect(-a,-o,e.width,e.height)}e.isStroked&&Sve(r,e,h,a,o),t.pipelines.postBatch(e)};vY.exports=Tve});var yY=u((sYe,TY)=>{"use strict";var SY=Ie(),EY=SY,yve=SY;EY=gY();TY.exports={renderWebGL:EY,renderCanvas:yve}});var Sv=u((rYe,AY)=>{"use strict";var bve=R(),Ave=Ze(),bY=vv(),xve=yY(),Cve=new bve({Extends:bY,Mixins:[xve],initialize:function(e,i,s,r,n,a,o){i===void 0&&(i=0),s===void 0&&(s=0),r===void 0&&(r=128),n===void 0&&(n=128),bY.call(this,e,"Rectangle",new Ave(0,0,r,n)),this.setPosition(i,s),this.setSize(r,n),a!==void 0&&this.setFillStyle(a,o),this.updateDisplayOrigin(),this.updateData()},setSize:function(t,e){this.width=t,this.height=e,this.geom.setSize(t,e),this.updateData(),this.updateDisplayOrigin();var i=this.input;return i&&!i.customHitArea&&(i.hitArea.width=t,i.hitArea.height=e),this},updateData:function(){var t=[],e=this.geom,i=this._tempLine;return e.getLineA(i),t.push(i.x1,i.y1,i.x2,i.y2),e.getLineB(i),t.push(i.x2,i.y2),e.getLineC(i),t.push(i.x2,i.y2),e.getLineD(i),t.push(i.x2,i.y2),this.pathData=t,this}});AY.exports=Cve});var xY=u(()=>{"use strict";var wve=Ou(),Rve=dt();Rve.register("container",function(t,e,i){return this.displayList.add(new wve(this.scene,t,e,i))})});var CY=u(()=>{"use strict";var Pve=gm(),_ve=dt();_ve.register("extern",function(){var t=new Pve(this.scene);return this.displayList.add(t),t})});var wY=u(()=>{"use strict";var Ive=Uu(),Lve=dt();Lve.register("graphics",function(t){return this.displayList.add(new Ive(this.scene,t))})});var RY=u(()=>{"use strict";var Mve=Hu(),Ove=dt();Ove.register("group",function(t,e){return this.updateList.add(new Mve(this.scene,t,e))})});var PY=u(()=>{"use strict";var Dve=Rh(),Bve=dt();Bve.register("image",function(t,e,i,s){return this.displayList.add(new Dve(this.scene,t,e,i,s))})});var _Y=u(()=>{"use strict";var Uve=dt(),Nve=Ju();Uve.register("particles",function(t,e,i,s){return t!==void 0&&typeof t=="string"&&console.warn("ParticleEmitterManager was removed in Phaser 3.60. See documentation for details"),this.displayList.add(new Nve(this.scene,t,e,i,s))})});var IY=u(()=>{"use strict";var Fve=dt(),kve=wh();Fve.register("sprite",function(t,e,i,s){return this.displayList.add(new kve(this.scene,t,e,i,s))})});var LY=u(()=>{"use strict";var Gve=ic(),qve=dt();qve.register("text",function(t,e,i,s){return this.displayList.add(new Gve(this.scene,t,e,i,s))})});var MY=u(()=>{"use strict";var Wve=Ah(),Yve=dt();Yve.register("zone",function(t,e,i,s){return this.displayList.add(new Wve(this.scene,t,e,i,s))})});var OY=u(()=>{"use strict";var Hve=dt(),zve=gv();Hve.register("line",function(t,e,i,s,r,n,a,o){return this.displayList.add(new zve(this.scene,t,e,i,s,r,n,a,o))})});var DY=u(()=>{"use strict";var Vve=dt(),Xve=Sv();Vve.register("rectangle",function(t,e,i,s,r,n){return this.displayList.add(new Xve(this.scene,t,e,i,s,r,n))})});var UY=u(()=>{"use strict";var Kve=Xr(),Zve=Ou(),jve=ai(),BY=oi(),$ve=re();jve.register("container",function(t,e){t===void 0&&(t={});var i=BY(t,"x",0),s=BY(t,"y",0),r=$ve(t,"children",null),n=new Zve(this.scene,i,s,r);return e!==void 0&&(t.add=e),Kve(this.scene,n,t),n})});var NY=u(()=>{"use strict";var Jve=ai(),Qve=Uu();Jve.register("graphics",function(t,e){t===void 0&&(t={}),e!==void 0&&(t.add=e);var i=new Qve(this.scene,t);return t.add&&this.scene.sys.displayList.add(i),i})});var FY=u(()=>{"use strict";var ege=ai(),tge=Hu();ege.register("group",function(t){return new tge(this.scene,null,t)})});var GY=u(()=>{"use strict";var ige=Xr(),sge=ai(),kY=oi(),rge=Rh();sge.register("image",function(t,e){t===void 0&&(t={});var i=kY(t,"key",null),s=kY(t,"frame",null),r=new rge(this.scene,0,0,i,s);return e!==void 0&&(t.add=e),ige(this.scene,r,t),r})});var qY=u(()=>{"use strict";var nge=Xr(),age=ai(),oge=oi(),hge=re(),lge=Ju();age.register("particles",function(t,e){t===void 0&&(t={});var i=oge(t,"key",null),s=hge(t,"config",null),r=new lge(this.scene,0,0,i);return e!==void 0&&(t.add=e),nge(this.scene,r,t),s&&r.setConfig(s),r})});var YY=u((NYe,WY)=>{"use strict";var dr=oi(),uge=function(t,e){var i=dr(e,"anims",null);if(i===null)return t;if(typeof i=="string")t.anims.play(i);else if(typeof i=="object"){var s=t.anims,r=dr(i,"key",void 0);if(r){var n=dr(i,"startFrame",void 0),a=dr(i,"delay",0),o=dr(i,"repeat",0),h=dr(i,"repeatDelay",0),l=dr(i,"yoyo",!1),c=dr(i,"play",!1),d=dr(i,"delayedPlay",0),f={key:r,delay:a,repeat:o,repeatDelay:h,yoyo:l,startFrame:n};c?s.play(f):d>0?s.playAfterDelay(f,d):s.load(f)}}return t};WY.exports=uge});var zY=u(()=>{"use strict";var cge=Xr(),dge=YY(),fge=ai(),HY=oi(),pge=wh();fge.register("sprite",function(t,e){t===void 0&&(t={});var i=HY(t,"key",null),s=HY(t,"frame",null),r=new pge(this.scene,0,0,i,s);return e!==void 0&&(t.add=e),cge(this.scene,r,t),dge(r,t),r})});var VY=u(()=>{"use strict";var mge=Xr(),vge=ai(),Mh=oi(),gge=ic();vge.register("text",function(t,e){t===void 0&&(t={});var i=Mh(t,"text",""),s=Mh(t,"style",null),r=Mh(t,"padding",null);r!==null&&(s.padding=r);var n=new gge(this.scene,0,0,i,s);return e!==void 0&&(t.add=e),mge(this.scene,n,t),n.autoRound=Mh(t,"autoRound",!0),n.resolution=Mh(t,"resolution",1),n})});var XY=u(()=>{"use strict";var Sge=ai(),sc=oi(),Ege=Ah();Sge.register("zone",function(t){var e=sc(t,"x",0),i=sc(t,"y",0),s=sc(t,"width",1),r=sc(t,"height",s);return new Ege(this.scene,e,i,s,r)})});var ZY=u((HYe,KY)=>{"use strict";var Tge=zr(),yge=Ti(),bge=function(t,e,i,s){var r=e.vertices,n=r.length;if(n!==0){i.addToRenderList(e);var a=t.pipelines.set(e.pipeline,e),o=Tge(e,i,s,!1).calc;t.pipelines.preBatch(e);var h=a.setGameObject(e),l=a.vertexViewF32,c=a.vertexViewU32,d=a.vertexCount*a.currentShader.vertexComponentCount-1,f=i.roundPixels,p=e.tintFill,m=i.alpha*e.alpha,v=yge.getTintAppendFloatAlpha(e.tint,m),g=a.vertexAvailable(),S=-1;g<n&&(S=g);for(var y=0;y<n;y++){var b=r[y];y===S&&(a.flush(),h=a.setGameObject(e),d=0),l[++d]=o.getXRound(b.vx,b.vy,f),l[++d]=o.getYRound(b.vx,b.vy,f),l[++d]=b.u,l[++d]=b.v,l[++d]=h,l[++d]=p,c[++d]=v,a.vertexCount++,a.currentBatch.count=a.vertexCount-a.currentBatch.start}t.pipelines.postBatch(e)}};KY.exports=bge});var QY=u((zYe,JY)=>{"use strict";var jY=Ie(),$Y=jY,Age=jY;$Y=ZY();JY.exports={renderWebGL:$Y,renderCanvas:Age}});var iH=u((VYe,tH)=>{"use strict";var xge=R(),Cge=Ti(),eH=um(),wge=new xge({Extends:eH,initialize:function(e,i,s,r,n,a,o,h,l,c){a===void 0&&(a=16777215),o===void 0&&(o=1),h===void 0&&(h=0),l===void 0&&(l=0),c===void 0&&(c=0),eH.call(this,e,i,s),this.vx=0,this.vy=0,this.vz=0,this.nx=h,this.ny=l,this.nz=c,this.u=r,this.v=n,this.color=a,this.alpha=o,this.tx=0,this.ty=0,this.ta=0,this.tu=r,this.tv=n},setUVs:function(t,e){return this.u=t,this.v=e,this.tu=t,this.tv=e,this},scrollUV:function(t,e){return this.tu+=t,this.tv+=e,this},scaleUV:function(t,e){return this.tu=this.u*t,this.tv=this.v*e,this},transformCoordinatesLocal:function(t,e,i,s){var r=this.x,n=this.y,a=this.z,o=t.val,h=r*o[0]+n*o[4]+a*o[8]+o[12],l=r*o[1]+n*o[5]+a*o[9]+o[13],c=r*o[2]+n*o[6]+a*o[10]+o[14],d=r*o[3]+n*o[7]+a*o[11]+o[15];this.vx=h/d*e,this.vy=-(l/d)*i,s<=0?this.vz=c/d:this.vz=-(c/d)},resize:function(t,e,i,s,r,n){return this.x=t,this.y=e,this.vx=this.x*i,this.vy=-this.y*s,this.vz=0,r<.5?this.vx+=i*(.5-r):r>.5&&(this.vx-=i*(r-.5)),n<.5?this.vy+=s*(.5-n):n>.5&&(this.vy-=s*(n-.5)),this},update:function(t,e,i,s,r,n,a,o){var h=this.vx*t+this.vy*i+r,l=this.vx*e+this.vy*s+n;return a&&(h=Math.round(h),l=Math.round(l)),this.tx=h,this.ty=l,this.ta=this.alpha*o,this},load:function(t,e,i,s,r){return t[++i]=this.tx,t[++i]=this.ty,t[++i]=this.tu,t[++i]=this.tv,t[++i]=s,t[++i]=r,e[++i]=Cge.getTintAppendFloatAlpha(this.color,this.ta),i}});tH.exports=wge});var rc=u((XYe,rH)=>{"use strict";var Rge=R(),qi=ri(),sH=ki(),Pge=QY(),_ge=iH(),Ige=new Rge({Extends:sH,Mixins:[qi.AlphaSingle,qi.BlendMode,qi.Depth,qi.GetBounds,qi.Mask,qi.Origin,qi.Pipeline,qi.PostPipeline,qi.ScrollFactor,qi.Texture,qi.Transform,qi.Visible,Pge],initialize:function(e,i,s,r,n,a,o,h,l,c,d){sH.call(this,e,"NineSlice"),this._width,this._height,this._originX=.5,this._originY=.5,this._sizeComponent=!0,this.vertices=[],this.leftWidth,this.rightWidth,this.topHeight,this.bottomHeight,this.tint=16777215,this.tintFill=!1;var f=e.textures.getFrame(r,n);this.is3Slice=!c&&!d,f&&f.scale9&&(this.is3Slice=f.is3Slice);for(var p=this.is3Slice?18:54,m=0;m<p;m++)this.vertices.push(new _ge);this.setPosition(i,s),this.setTexture(r,n),this.setSlices(a,o,h,l,c,d,!1),this.updateDisplayOrigin(),this.initPipeline(),this.initPostPipeline()},setSlices:function(t,e,i,s,r,n,a){i===void 0&&(i=10),s===void 0&&(s=10),r===void 0&&(r=0),n===void 0&&(n=0),a===void 0&&(a=!1);var o=this.frame,h=!1;if(this.is3Slice&&a&&r!==0&&n!==0&&(h=!0),h)console.warn("Cannot change 9 slice to 3 slice");else{if(o&&o.scale9&&!a){var l=o.data.scale9Borders,c=l.x,d=l.y;i=c,s=o.width-l.w-c,r=d,n=o.height-l.h-d,t===void 0&&(t=o.width),e===void 0&&(e=o.height)}else t===void 0&&(t=256),e===void 0&&(e=256);this._width=t,this._height=e,this.leftWidth=i,this.rightWidth=s,this.topHeight=r,this.bottomHeight=n,this.is3Slice&&(e=o.height,this._height=e,this.topHeight=e,this.bottomHeight=0),this.updateVertices(),this.updateUVs()}return this},updateUVs:function(){var t=this.leftWidth,e=this.rightWidth,i=this.topHeight,s=this.bottomHeight,r=this.frame.width,n=this.frame.height;this.updateQuadUVs(0,0,0,t/r,i/n),this.updateQuadUVs(6,t/r,0,1-e/r,i/n),this.updateQuadUVs(12,1-e/r,0,1,i/n),this.is3Slice||(this.updateQuadUVs(18,0,i/n,t/r,1-s/n),this.updateQuadUVs(24,t/r,i/n,1-e/r,1-s/n),this.updateQuadUVs(30,1-e/r,i/n,1,1-s/n),this.updateQuadUVs(36,0,1-s/n,t/r,1),this.updateQuadUVs(42,t/r,1-s/n,1-e/r,1),this.updateQuadUVs(48,1-e/r,1-s/n,1,1))},updateVertices:function(){var t=this.leftWidth,e=this.rightWidth,i=this.topHeight,s=this.bottomHeight,r=this.width,n=this.height;this.updateQuad(0,-.5,.5,-.5+t/r,.5-i/n),this.updateQuad(6,-.5+t/r,.5,.5-e/r,.5-i/n),this.updateQuad(12,.5-e/r,.5,.5,.5-i/n),this.is3Slice||(this.updateQuad(18,-.5,.5-i/n,-.5+t/r,-.5+s/n),this.updateQuad(24,-.5+t/r,.5-i/n,.5-e/r,-.5+s/n),this.updateQuad(30,.5-e/r,.5-i/n,.5,-.5+s/n),this.updateQuad(36,-.5,-.5+s/n,-.5+t/r,-.5),this.updateQuad(42,-.5+t/r,-.5+s/n,.5-e/r,-.5),this.updateQuad(48,.5-e/r,-.5+s/n,.5,-.5))},updateQuad:function(t,e,i,s,r){var n=this.width,a=this.height,o=this.originX,h=this.originY,l=this.vertices;l[t+0].resize(e,i,n,a,o,h),l[t+1].resize(e,r,n,a,o,h),l[t+2].resize(s,i,n,a,o,h),l[t+3].resize(e,r,n,a,o,h),l[t+4].resize(s,r,n,a,o,h),l[t+5].resize(s,i,n,a,o,h)},updateQuadUVs:function(t,e,i,s,r){var n=this.vertices,a=this.frame,o=a.u0,h=a.v0,l=a.u1,c=a.v1;if(o!==0||l!==1){var d=l-o;e=o+e*d,s=o+s*d}if(h!==0||c!==1){var f=c-h;i=h+i*f,r=h+r*f}n[t+0].setUVs(e,i),n[t+1].setUVs(e,r),n[t+2].setUVs(s,i),n[t+3].setUVs(e,r),n[t+4].setUVs(s,r),n[t+5].setUVs(s,i)},clearTint:function(){return this.setTint(16777215),this},setTint:function(t){return t===void 0&&(t=16777215),this.tint=t,this.tintFill=!1,this},setTintFill:function(t){return this.setTint(t),this.tintFill=!0,this},isTinted:{get:function(){return this.tint!==16777215}},width:{get:function(){return this._width},set:function(t){this._width=Math.max(t,this.leftWidth+this.rightWidth),this.updateVertices()}},height:{get:function(){return this._height},set:function(t){this.is3Slice||(this._height=Math.max(t,this.topHeight+this.bottomHeight),this.updateVertices())}},displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}},setSize:function(t,e){this.width=t,this.height=e,this.updateDisplayOrigin();var i=this.input;return i&&!i.customHitArea&&(i.hitArea.width=this.width,i.hitArea.height=this.height),this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this},originX:{get:function(){return this._originX},set:function(t){this._originX=t,this.updateVertices()}},originY:{get:function(){return this._originY},set:function(t){this._originY=t,this.updateVertices()}},setOrigin:function(t,e){return t===void 0&&(t=.5),e===void 0&&(e=t),this._originX=t,this._originY=e,this.updateVertices(),this.updateDisplayOrigin()},setSizeToFrame:function(){if(this.is3Slice){var t=this.frame.height;this._height=t,this.topHeight=t,this.bottomHeight=0}return this.updateUVs(),this},preDestroy:function(){this.vertices=[]}});rH.exports=Ige});var nH=u(()=>{"use strict";var Lge=rc(),Mge=dt();Mge.register("nineslice",function(t,e,i,s,r,n,a,o,h,l){return this.displayList.add(new Lge(this.scene,t,e,i,s,r,n,a,o,h,l))})});var oH=u(()=>{"use strict";var Oge=Xr(),Dge=ai(),aH=oi(),eo=Ne(),Bge=rc();Dge.register("nineslice",function(t,e){t===void 0&&(t={});var i=aH(t,"key",null),s=aH(t,"frame",null),r=eo(t,"width",256),n=eo(t,"height",256),a=eo(t,"leftWidth",10),o=eo(t,"rightWidth",10),h=eo(t,"topHeight",0),l=eo(t,"bottomHeight",0),c=new Bge(this.scene,0,0,i,s,r,n,a,o,h,l);return e!==void 0&&(t.add=e),Oge(this.scene,c,t),c})});var X=u((JYe,hH)=>{"use strict";var nc={Events:Wr(),DisplayList:d1(),GameObjectCreator:ai(),GameObjectFactory:dt(),UpdateList:R1(),Components:ri(),GetCalcMatrix:zr(),BuildGameObject:Xr(),GameObject:ki(),Container:Ou(),Extern:gm(),Graphics:Uu(),Group:Hu(),Image:Rh(),Particles:DW(),Sprite:wh(),Text:ic(),GetTextSize:fv(),MeasureText:pv(),TextStyle:mv(),Zone:Ah(),Line:gv(),Rectangle:Sv(),Factories:{Container:xY(),Extern:CY(),Graphics:wY(),Group:RY(),Image:PY(),Particles:_Y(),Sprite:IY(),Text:LY(),Zone:MY(),Line:OY(),Rectangle:DY()},Creators:{Container:UY(),Graphics:NY(),Group:FY(),Image:GY(),Particles:qY(),Sprite:zY(),Text:VY(),Zone:XY()}};nc.NineSlice=rc(),nc.Factories.NineSlice=nH(),nc.Creators.NineSlice=oH();hH.exports=nc});var pH=u((cHe,fH)=>{"use strict";fH.exports={BottomCenter:Mm(),BottomLeft:Om(),BottomRight:Dm(),Center:Um(),LeftCenter:Nm(),QuickSet:Wm(),RightCenter:Fm(),TopCenter:km(),TopLeft:Gm(),TopRight:qm()}});var vH=u((dHe,mH)=>{"use strict";mH.exports={BottomCenter:Em(),BottomLeft:Tm(),BottomRight:ym(),LeftBottom:bm(),LeftCenter:Am(),LeftTop:xm(),QuickSet:Lm(),RightBottom:Cm(),RightCenter:wm(),RightTop:Rm(),TopCenter:Pm(),TopLeft:_m(),TopRight:Im()}});var SH=u((fHe,gH)=>{"use strict";var kge=bh(),Gge=mi(),bv={In:pH(),To:vH()};bv=Gge(!1,bv,kge);gH.exports=bv});var TH=u((pHe,EH)=>{"use strict";var qge=as(),Wge=os(),Yge=hs(),Hge=ls(),zge=Ze(),Vge=function(t,e){e===void 0&&(e=new zge);var i=Wge(t),s=Hge(t);return e.x=i,e.y=s,e.width=Yge(t)-i,e.height=qge(t)-s,e};EH.exports=Vge});var bH=u((mHe,yH)=>{"use strict";var Xge=function(t){return t.width*t.originX};yH.exports=Xge});var xH=u((vHe,AH)=>{"use strict";var Kge=function(t){return t.height*t.originY};AH.exports=Kge});var wH=u((gHe,CH)=>{"use strict";CH.exports={CenterOn:Bm(),GetBottom:as(),GetBounds:TH(),GetCenterX:Dn(),GetCenterY:Un(),GetLeft:os(),GetOffsetX:bH(),GetOffsetY:xH(),GetRight:hs(),GetTop:ls(),SetBottom:Os(),SetCenterX:Bn(),SetCenterY:Nn(),SetLeft:Ls(),SetRight:Ms(),SetTop:Is()}});var PH=u((SHe,RH)=>{"use strict";var Zge={setCrisp:function(t){var e=["optimizeSpeed","-moz-crisp-edges","-o-crisp-edges","-webkit-optimize-contrast","optimize-contrast","crisp-edges","pixelated"];return e.forEach(function(i){t.style["image-rendering"]=i}),t.style.msInterpolationMode="nearest-neighbor",t},setBicubic:function(t){return t.style["image-rendering"]="auto",t.style.msInterpolationMode="bicubic",t}};RH.exports=Zge});var IH=u((EHe,_H)=>{"use strict";var jge=function(t,e){return e===void 0&&(e="none"),t.style.msTouchAction=e,t.style["ms-touch-action"]=e,t.style["touch-action"]=e,t};_H.exports=jge});var MH=u((THe,LH)=>{"use strict";var $ge=function(t,e){e===void 0&&(e="none");var i=["-webkit-","-khtml-","-moz-","-ms-",""];return i.forEach(function(s){t.style[s+"user-select"]=e}),t.style["-webkit-touch-callout"]=e,t.style["-webkit-tap-highlight-color"]="rgba(0, 0, 0, 0)",t};LH.exports=$ge});var DH=u((yHe,OH)=>{"use strict";OH.exports={CanvasInterpolation:PH(),CanvasPool:Ui(),Smoothing:Mf(),TouchAction:IH(),UserSelect:MH()}});var UH=u((bHe,BH)=>{"use strict";BH.exports={BitmapMask:Gf(),GeometryMask:qf()}});var ie=u((AHe,NH)=>{"use strict";NH.exports={Align:SH(),Bounds:wH(),Canvas:DH(),Masks:UH()}});var Fs=u((OHe,YH)=>{"use strict";var iSe={LOADER_IDLE:0,LOADER_LOADING:1,LOADER_PROCESSING:2,LOADER_COMPLETE:3,LOADER_SHUTDOWN:4,LOADER_DESTROYED:5,FILE_PENDING:10,FILE_LOADING:11,FILE_LOADED:12,FILE_FAILED:13,FILE_PROCESSING:14,FILE_ERRORED:16,FILE_COMPLETE:17,FILE_DESTROYED:18,FILE_POPULATED:19,FILE_PENDING_DESTROY:20};YH.exports=iSe});var Wi=u((DHe,HH)=>{"use strict";var lc={},sSe={install:function(t){for(var e in lc)t[e]=lc[e]},register:function(t,e){lc[t]=e},destroy:function(){lc={}}};HH.exports=sSe});var Dh=u((BHe,zH)=>{"use strict";var rSe=function(t,e){return t.url?t.url.match(/^(?:blob:|data:|capacitor:\/\/|http:\/\/|https:\/\/|\/\/)/)?t.url:e+t.url:!1};zH.exports=rSe});var Bh=u((UHe,VH)=>{"use strict";var nSe=function(t,e,i,s,r,n){return t===void 0&&(t=""),e===void 0&&(e=!0),i===void 0&&(i=""),s===void 0&&(s=""),r===void 0&&(r=0),n===void 0&&(n=!1),{responseType:t,async:e,user:i,password:s,timeout:r,headers:void 0,header:void 0,headerValue:void 0,requestedWith:!1,overrideMimeType:void 0,withCredentials:n}};VH.exports=nSe});var uc=u((NHe,XH)=>{"use strict";var aSe=mi(),oSe=Bh(),hSe=function(t,e){var i=t===void 0?oSe():aSe({},t);if(e)for(var s in e)e[s]!==void 0&&(i[s]=e[s]);return i};XH.exports=hSe});var wv=u((FHe,KH)=>{"use strict";var lSe=uc(),uSe=function(t,e){var i=lSe(e,t.xhrSettings);if(t.base64){var s=t.url.split(";base64,").pop()||t.url.split(",").pop(),r={responseText:atob(s)};t.onBase64Load(r);return}var n=new XMLHttpRequest;if(n.open("GET",t.src,i.async,i.user,i.password),n.responseType=t.xhrSettings.responseType,n.timeout=i.timeout,i.headers)for(var a in i.headers)n.setRequestHeader(a,i.headers[a]);return i.header&&i.headerValue&&n.setRequestHeader(i.header,i.headerValue),i.requestedWith&&n.setRequestHeader("X-Requested-With",i.requestedWith),i.overrideMimeType&&n.overrideMimeType(i.overrideMimeType),i.withCredentials&&(n.withCredentials=!0),n.onload=t.onLoad.bind(t,n),n.onerror=t.onError.bind(t,n),n.onprogress=t.onProgress.bind(t),n.ontimeout=t.onError.bind(t,n),n.send(),n};KH.exports=uSe});var Gn=u((kHe,ZH)=>{"use strict";var cSe=R(),fs=Fs(),cc=ss(),ks=re(),dSe=Dh(),fSe=uc(),pSe=wv(),mSe=Bh(),Rv=new cSe({initialize:function(e,i){if(this.loader=e,this.cache=ks(i,"cache",!1),this.type=ks(i,"type",!1),!this.type)throw new Error("Invalid File type: "+this.type);this.key=ks(i,"key",!1);var s=this.key;if(e.prefix&&e.prefix!==""&&(this.key=e.prefix+s),!this.key)throw new Error("Invalid File key: "+this.key);var r=ks(i,"url");r===void 0?r=e.path+s+"."+ks(i,"extension",""):typeof r=="string"&&!r.match(/^(?:blob:|data:|capacitor:\/\/|http:\/\/|https:\/\/|\/\/)/)&&(r=e.path+r),this.url=r,this.src="",this.xhrSettings=mSe(ks(i,"responseType",void 0)),ks(i,"xhrSettings",!1)&&(this.xhrSettings=fSe(this.xhrSettings,ks(i,"xhrSettings",{}))),this.xhrLoader=null,this.state=typeof this.url=="function"?fs.FILE_POPULATED:fs.FILE_PENDING,this.bytesTotal=0,this.bytesLoaded=-1,this.percentComplete=-1,this.crossOrigin=void 0,this.data=void 0,this.config=ks(i,"config",{}),this.multiFile,this.linkFile,this.base64=typeof r=="string"&&r.indexOf("data:")===0,this.retryAttempts=ks(i,"maxRetries",e.maxRetries)},setLink:function(t){this.linkFile=t,t.linkFile=this},resetXHR:function(){this.xhrLoader&&(this.xhrLoader.onload=void 0,this.xhrLoader.onerror=void 0,this.xhrLoader.onprogress=void 0)},load:function(){if(this.state===fs.FILE_POPULATED)this.loader.nextFile(this,!0);else{if(this.state=fs.FILE_LOADING,this.src=dSe(this,this.loader.baseURL),!this.src)throw new Error("URL Error in File: "+this.key+" from: "+this.url);this.src.indexOf("data:")===0&&(this.base64=!0),this.xhrLoader=pSe(this,this.loader.xhr)}},onLoad:function(t,e){var i=t.responseURL&&this.loader.localSchemes.some(function(n){return t.responseURL.indexOf(n)===0}),s=i&&e.target.status===0,r=!(e.target&&e.target.status!==200)||s;t.readyState===4&&t.status>=400&&t.status<=599&&(r=!1),this.state=fs.FILE_LOADED,this.resetXHR(),this.loader.nextFile(this,r)},onBase64Load:function(t){this.xhrLoader=t,this.state=fs.FILE_LOADED,this.percentComplete=1,this.loader.emit(cc.FILE_PROGRESS,this,this.percentComplete),this.loader.nextFile(this,!0)},onError:function(){this.resetXHR(),this.retryAttempts>0?(this.retryAttempts--,this.load()):this.loader.nextFile(this,!1)},onProgress:function(t){t.lengthComputable&&(this.bytesLoaded=t.loaded,this.bytesTotal=t.total,this.percentComplete=Math.min(this.bytesLoaded/this.bytesTotal,1),this.loader.emit(cc.FILE_PROGRESS,this,this.percentComplete))},onProcess:function(){this.state=fs.FILE_PROCESSING,this.onProcessComplete()},onProcessComplete:function(){this.state=fs.FILE_COMPLETE,this.multiFile&&this.multiFile.onFileComplete(this),this.loader.fileProcessComplete(this)},onProcessError:function(){console.error('Failed to process file: %s "%s"',this.type,this.key),this.state=fs.FILE_ERRORED,this.multiFile&&this.multiFile.onFileFailed(this),this.loader.fileProcessComplete(this)},hasCacheConflict:function(){return this.cache&&this.cache.exists(this.key)},addToCache:function(){this.cache&&this.data&&this.cache.add(this.key,this.data)},pendingDestroy:function(t){if(this.state!==fs.FILE_PENDING_DESTROY){t===void 0&&(t=this.data);var e=this.key,i=this.type;this.loader.emit(cc.FILE_COMPLETE,e,i,t),this.loader.emit(cc.FILE_KEY_COMPLETE+i+"-"+e,e,i,t),this.loader.flagForRemoval(this),this.state=fs.FILE_PENDING_DESTROY}},destroy:function(){this.loader=null,this.cache=null,this.xhrSettings=null,this.multiFile=null,this.linkFile=null,this.data=null}});Rv.createObjectURL=function(t,e,i){if(typeof URL=="function")t.src=URL.createObjectURL(e);else{var s=new FileReader;s.onload=function(){t.removeAttribute("crossOrigin"),t.src="data:"+(e.type||i)+";base64,"+s.result.split(",")[1]},s.onerror=t.onerror,s.readAsDataURL(e)}};Rv.revokeObjectURL=function(t){typeof URL=="function"&&URL.revokeObjectURL(t.src)};ZH.exports=Rv});var ro=u((GHe,jH)=>{"use strict";var vSe=R(),io=Fs(),Uh=Gn(),gSe=Wi(),so=re(),SSe=Xt(),ESe=Dh(),Pv=new vSe({Extends:Uh,initialize:function t(e,i,s,r,n){var a="png",o;if(SSe(i)){var h=i;i=so(h,"key"),s=so(h,"url"),o=so(h,"normalMap"),r=so(h,"xhrSettings"),a=so(h,"extension",a),n=so(h,"frameConfig")}Array.isArray(s)&&(o=s[1],s=s[0]);var l={type:"image",cache:e.textureManager,extension:a,responseType:"blob",key:i,url:s,xhrSettings:r,config:n};if(Uh.call(this,e,l),o){var c=new t(e,this.key,o,r,n);c.type="normalMap",this.setLink(c),e.addFile(c)}this.useImageElementLoad=e.imageLoadType==="HTMLImageElement"||this.base64,this.useImageElementLoad&&(this.load=this.loadImage,this.onProcess=this.onProcessImage)},onProcess:function(){this.state=io.FILE_PROCESSING,this.data=new Image,this.data.crossOrigin=this.crossOrigin;var t=this;this.data.onload=function(){Uh.revokeObjectURL(t.data),t.onProcessComplete()},this.data.onerror=function(){Uh.revokeObjectURL(t.data),t.onProcessError()},Uh.createObjectURL(this.data,this.xhrLoader.response,"image/png")},onProcessImage:function(){var t=this.state;this.state=io.FILE_PROCESSING,t===io.FILE_LOADED?this.onProcessComplete():this.onProcessError()},loadImage:function(){this.state=io.FILE_LOADING,this.src=ESe(this,this.loader.baseURL),this.data=new Image,this.data.crossOrigin=this.crossOrigin;var t=this;this.data.onload=function(){t.state=io.FILE_LOADED,t.loader.nextFile(t,!0)},this.data.onerror=function(){t.loader.nextFile(t,!1)},this.data.src=this.src},addToCache:function(){var t=this.linkFile;t?t.state>=io.FILE_COMPLETE&&(t.type==="spritesheet"?t.addToCache():this.type==="normalMap"?this.cache.addImage(this.key,t.data,this.data):this.cache.addImage(this.key,this.data,t.data)):this.cache.addImage(this.key,this.data)}});gSe.register("image",function(t,e,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)this.addFile(new Pv(this,t[s]));else this.addFile(new Pv(this,t,e,i));return this});jH.exports=Pv});var dc=u((qHe,ez)=>{"use strict";var TSe=R(),_v=Fs(),$H=Gn(),ySe=Wi(),Nh=re(),JH=Ne(),QH=Xt(),Iv=new TSe({Extends:$H,initialize:function(e,i,s,r,n){var a="json";if(QH(i)){var o=i;i=Nh(o,"key"),s=Nh(o,"url"),r=Nh(o,"xhrSettings"),a=Nh(o,"extension",a),n=Nh(o,"dataKey",n)}var h={type:"json",cache:e.cacheManager.json,extension:a,responseType:"text",key:i,url:s,xhrSettings:r,config:n};$H.call(this,e,h),QH(s)&&(n?this.data=JH(s,n):this.data=s,this.state=_v.FILE_POPULATED)},onProcess:function(){if(this.state!==_v.FILE_POPULATED){this.state=_v.FILE_PROCESSING;try{var t=JSON.parse(this.xhrLoader.responseText)}catch(i){throw this.onProcessError(),i}var e=this.config;typeof e=="string"?this.data=JH(t,e,t):this.data=t}this.onProcessComplete()}});ySe.register("json",function(t,e,i,s){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new Iv(this,t[r]));else this.addFile(new Iv(this,t,e,s,i));return this});ez.exports=Iv});var Fh=u((WHe,iz)=>{"use strict";var bSe=R(),Lv=Fs(),tz=ss(),ASe=new bSe({initialize:function(e,i,s,r){var n=[];r.forEach(function(h){h&&n.push(h)}),this.loader=e,this.type=i,this.key=s;var a=this.key;e.prefix&&e.prefix!==""&&(this.key=e.prefix+a),this.multiKeyIndex=e.multiKeyIndex++,this.files=n,this.state=Lv.FILE_PENDING,this.complete=!1,this.pending=n.length,this.failed=0,this.config={},this.baseURL=e.baseURL,this.path=e.path,this.prefix=e.prefix;for(var o=0;o<n.length;o++)n[o].multiFile=this},isReadyToProcess:function(){return this.pending===0&&this.failed===0&&!this.complete},addToMultiFile:function(t){return this.files.push(t),t.multiFile=this,this.pending++,this.complete=!1,this},onFileComplete:function(t){var e=this.files.indexOf(t);e!==-1&&this.pending--},onFileFailed:function(t){var e=this.files.indexOf(t);e!==-1&&(this.failed++,console.error('File failed: %s "%s" (via %s "%s")',this.type,this.key,t.type,t.key))},pendingDestroy:function(){if(this.state!==Lv.FILE_PENDING_DESTROY){var t=this.key,e=this.type;this.loader.emit(tz.FILE_COMPLETE,t,e),this.loader.emit(tz.FILE_KEY_COMPLETE+e+"-"+t,t,e),this.loader.flagForRemoval(this);for(var i=0;i<this.files.length;i++)this.files[i].pendingDestroy();this.state=Lv.FILE_PENDING_DESTROY}},destroy:function(){this.loader=null,this.files=null,this.config=null}});iz.exports=ASe});var az=u((YHe,nz)=>{"use strict";var xSe=R(),CSe=Wi(),Jr=re(),sz=ro(),wSe=Xt(),rz=dc(),Mv=Fh(),Ov=new xSe({Extends:Mv,initialize:function(e,i,s,r,n,a){var o,h;if(wSe(i)){var l=i;i=Jr(l,"key"),o=new sz(e,{key:i,url:Jr(l,"textureURL"),extension:Jr(l,"textureExtension","png"),normalMap:Jr(l,"normalMap"),xhrSettings:Jr(l,"textureXhrSettings")}),h=new rz(e,{key:i,url:Jr(l,"atlasURL"),extension:Jr(l,"atlasExtension","json"),xhrSettings:Jr(l,"atlasXhrSettings")})}else o=new sz(e,i,s,n),h=new rz(e,i,r,a);o.linkFile?Mv.call(this,e,"atlasjson",i,[o,h,o.linkFile]):Mv.call(this,e,"atlasjson",i,[o,h])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],i=this.files[2]?this.files[2].data:null;this.loader.textureManager.addAtlas(t.key,t.data,e.data,i),this.complete=!0}}});CSe.register("atlas",function(t,e,i,s,r){var n;if(Array.isArray(t))for(var a=0;a<t.length;a++)n=new Ov(this,t[a]),this.addFile(n.files);else n=new Ov(this,t,e,i,s,r),this.addFile(n.files);return this});nz.exports=Ov});var uz=u((HHe,lz)=>{"use strict";var RSe=R(),PSe=ss(),oz=Gn(),hz=re(),_Se=Dh(),ISe=Xt(),LSe=new RSe({Extends:oz,initialize:function(e,i,s,r){if(ISe(i)){var n=i;i=hz(n,"key"),r=hz(n,"config",r)}var a={type:"audio",cache:e.cacheManager.audio,extension:s.type,key:i,url:s.url,config:r};oz.call(this,e,a),this.locked="ontouchstart"in window,this.loaded=!1,this.filesLoaded=0,this.filesTotal=0},onLoad:function(){this.loaded||(this.loaded=!0,this.loader.nextFile(this,!0))},onError:function(){for(var t=0;t<this.data.length;t++){var e=this.data[t];e.oncanplaythrough=null,e.onerror=null}this.loader.nextFile(this,!1)},onProgress:function(t){var e=t.target;e.oncanplaythrough=null,e.onerror=null,this.filesLoaded++,this.percentComplete=Math.min(this.filesLoaded/this.filesTotal,1),this.loader.emit(PSe.FILE_PROGRESS,this,this.percentComplete),this.filesLoaded===this.filesTotal&&this.onLoad()},load:function(){this.data=[];var t=this.config&&this.config.instances||1;this.filesTotal=t,this.filesLoaded=0,this.percentComplete=0;for(var e=0;e<t;e++){var i=new Audio;i.dataset||(i.dataset={}),i.dataset.name=this.key+("0"+e).slice(-2),i.dataset.used="false",this.locked?i.dataset.locked="true":(i.dataset.locked="false",i.preload="auto",i.oncanplaythrough=this.onProgress.bind(this),i.onerror=this.onError.bind(this)),this.data.push(i)}for(e=0;e<this.data.length;e++)i=this.data[e],i.src=_Se(this,this.loader.baseURL),this.locked||i.load();this.locked&&setTimeout(this.onLoad.bind(this))}});lz.exports=LSe});var pz=u((zHe,fz)=>{"use strict";var MSe=R(),OSe=Fs(),cz=Gn(),DSe=Wi(),qn=re(),BSe=uz(),dz=Xt(),Wn=new MSe({Extends:cz,initialize:function(e,i,s,r,n){if(dz(i)){var a=i;i=qn(a,"key"),r=qn(a,"xhrSettings"),n=qn(a,"context",n)}var o={type:"audio",cache:e.cacheManager.audio,extension:s.type,responseType:"arraybuffer",key:i,url:s.url,xhrSettings:r,config:{context:n}};cz.call(this,e,o)},onProcess:function(){this.state=OSe.FILE_PROCESSING;var t=this;this.config.context.decodeAudioData(this.xhrLoader.response,function(e){t.data=e,t.onProcessComplete()},function(e){console.error("Error decoding audio: "+t.key+" - ",e?e.message:null),t.onProcessError()}),this.config.context=null}});Wn.create=function(t,e,i,s,r){var n=t.systems.game,a=n.config.audio,o=n.device.audio;dz(e)&&(i=qn(e,"url",[]),s=qn(e,"config",{}));var h=Wn.getAudioURL(n,i);return h?o.webAudio&&!a.disableWebAudio?new Wn(t,e,h,r,n.sound.context):new BSe(t,e,h,s):(console.warn('No audio URLs for "%s" can play on this device',e),null)};Wn.getAudioURL=function(t,e){Array.isArray(e)||(e=[e]);for(var i=0;i<e.length;i++){var s=qn(e[i],"url",e[i]);if(s.indexOf("blob:")===0||s.indexOf("data:")===0)return{url:s,type:""};var r=s.match(/\.([a-zA-Z0-9]+)($|\?)/);if(r=qn(e[i],"type",r?r[1]:"").toLowerCase(),t.device.audio[r])return{url:s,type:r}}return null};DSe.register("audio",function(t,e,i,s){var r=this.systems.game,n=r.config.audio,a=r.device.audio;if(n.noAudio||!a.webAudio&&!a.audioData)return this;var o;if(Array.isArray(t))for(var h=0;h<t.length;h++)o=Wn.create(this,t[h]),o&&this.addFile(o);else o=Wn.create(this,t,e,i,s),o&&this.addFile(o);return this});fz.exports=Wn});var vz=u((VHe,mz)=>{"use strict";function bi(t,e){return parseInt(t.getAttribute(e),10)}var USe=function(t,e,i,s,r){i===void 0&&(i=0),s===void 0&&(s=0);var n=e.cutX,a=e.cutY,o=e.source.width,h=e.source.height,l=e.sourceIndex,c={},d=t.getElementsByTagName("info")[0],f=t.getElementsByTagName("common")[0];c.font=d.getAttribute("face"),c.size=bi(d,"size"),c.lineHeight=bi(f,"lineHeight")+s,c.chars={};var p=t.getElementsByTagName("char"),m=e!==void 0&&e.trimmed;if(m)var v=e.height,g=e.width;for(var S=0;S<p.length;S++){var y=p[S],b=bi(y,"id"),x=String.fromCharCode(b),A=bi(y,"x"),w=bi(y,"y"),C=bi(y,"width"),_=bi(y,"height");m&&(A<g&&(g=A),w<v&&(v=w)),m&&v!==0&&g!==0&&(A-=e.x,w-=e.y);var N=(n+A)/o,D=(a+w)/h,Y=(n+A+C)/o,$=(a+w+_)/h;if(c.chars[b]={x:A,y:w,width:C,height:_,centerX:Math.floor(C/2),centerY:Math.floor(_/2),xOffset:bi(y,"xoffset"),yOffset:bi(y,"yoffset"),xAdvance:bi(y,"xadvance")+i,data:{},kerning:{},u0:N,v0:D,u1:Y,v1:$},r&&C!==0&&_!==0){var j=r.add(x,l,A,w,C,_);j&&j.setUVs(C,_,N,D,Y,$)}}var G=t.getElementsByTagName("kerning");for(S=0;S<G.length;S++){var Z=G[S],ee=bi(Z,"first"),te=bi(Z,"second"),Q=bi(Z,"amount");c.chars[te].kerning[ee]=Q}return c};mz.exports=USe});var Sz=u((XHe,gz)=>{"use strict";var NSe=function(t){var e="";try{if(window.DOMParser){var i=new DOMParser;e=i.parseFromString(t,"text/xml")}else e=new ActiveXObject("Microsoft.XMLDOM"),e.loadXML(t)}catch{e=null}return!e||!e.documentElement||e.getElementsByTagName("parsererror").length?null:e};gz.exports=NSe});var yz=u((KHe,Tz)=>{"use strict";var FSe=R(),kSe=Fs(),Ez=Gn(),GSe=Wi(),fc=re(),qSe=Xt(),WSe=Sz(),Dv=new FSe({Extends:Ez,initialize:function(e,i,s,r){var n="xml";if(qSe(i)){var a=i;i=fc(a,"key"),s=fc(a,"url"),r=fc(a,"xhrSettings"),n=fc(a,"extension",n)}var o={type:"xml",cache:e.cacheManager.xml,extension:n,responseType:"text",key:i,url:s,xhrSettings:r};Ez.call(this,e,o)},onProcess:function(){this.state=kSe.FILE_PROCESSING,this.data=WSe(this.xhrLoader.responseText),this.data?this.onProcessComplete():this.onProcessError()}});GSe.register("xml",function(t,e,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)this.addFile(new Dv(this,t[s]));else this.addFile(new Dv(this,t,e,i));return this});Tz.exports=Dv});var Cz=u((ZHe,xz)=>{"use strict";var YSe=R(),HSe=Wi(),Qr=re(),bz=ro(),zSe=Xt(),Bv=Fh(),VSe=vz(),Az=yz(),Uv=new YSe({Extends:Bv,initialize:function(e,i,s,r,n,a){var o,h;if(zSe(i)){var l=i;i=Qr(l,"key"),o=new bz(e,{key:i,url:Qr(l,"textureURL"),extension:Qr(l,"textureExtension","png"),normalMap:Qr(l,"normalMap"),xhrSettings:Qr(l,"textureXhrSettings")}),h=new Az(e,{key:i,url:Qr(l,"fontDataURL"),extension:Qr(l,"fontDataExtension","xml"),xhrSettings:Qr(l,"fontDataXhrSettings")})}else o=new bz(e,i,s,n),h=new Az(e,i,r,a);o.linkFile?Bv.call(this,e,"bitmapfont",i,[o,h,o.linkFile]):Bv.call(this,e,"bitmapfont",i,[o,h])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1];t.addToCache();var i=t.cache.get(t.key),s=VSe(e.data,t.cache.getFrame(t.key),0,0,i);this.loader.cacheManager.bitmapFont.add(t.key,{data:s,texture:t.key,frame:null}),this.complete=!0}}});HSe.register("bitmapFont",function(t,e,i,s,r){var n;if(Array.isArray(t))for(var a=0;a<t.length;a++)n=new Uv(this,t[a]),this.addFile(n.files);else n=new Uv(this,t,e,i,s,r),this.addFile(n.files);return this});xz.exports=Uv});var _z=u((jHe,Pz)=>{"use strict";var XSe=R(),KSe=Wi(),Yi=re(),wz=ro(),ZSe=Xt(),jSe=dc(),Rz=Fh(),Nv=new XSe({Extends:Rz,initialize:function(e,i,s,r,n,a,o){if(ZSe(i)){var h=i;i=Yi(h,"key"),Yi(h,"url",!1)?s=Yi(h,"url"):s=Yi(h,"atlasURL"),a=Yi(h,"xhrSettings"),r=Yi(h,"path"),n=Yi(h,"baseURL"),o=Yi(h,"textureXhrSettings")}var l=new jSe(e,i,s,a);Rz.call(this,e,"multiatlas",i,[l]),this.config.path=r,this.config.baseURL=n,this.config.textureXhrSettings=o},onFileComplete:function(t){var e=this.files.indexOf(t);if(e!==-1&&(this.pending--,t.type==="json"&&t.data.hasOwnProperty("textures"))){var i=t.data.textures,s=this.config,r=this.loader,n=r.baseURL,a=r.path,o=r.prefix,h=Yi(s,"baseURL",this.baseURL),l=Yi(s,"path",this.path),c=Yi(s,"prefix",this.prefix),d=Yi(s,"textureXhrSettings");r.setBaseURL(h),r.setPath(l),r.setPrefix(c);for(var f=0;f<i.length;f++){var p=i[f].image,m="MA"+this.multiKeyIndex+"_"+p,v=new wz(r,m,p,d);if(this.addToMultiFile(v),r.addFile(v),i[f].normalMap){var g=new wz(r,m,i[f].normalMap,d);g.type="normalMap",v.setLink(g),this.addToMultiFile(g),r.addFile(g)}}r.setBaseURL(n),r.setPath(a),r.setPrefix(o)}},addToCache:function(){if(this.isReadyToProcess()){for(var t=this.files[0],e=[],i=[],s=[],r=1;r<this.files.length;r++){var n=this.files[r];if(n.type!=="normalMap")for(var a=n.key.indexOf("_"),o=n.key.substr(a+1),h=n.data,l=0;l<t.data.textures.length;l++){var c=t.data.textures[l];if(c.image===o){i.push(h),e.push(c),n.linkFile&&s.push(n.linkFile.data);break}}}s.length===0&&(s=void 0),this.loader.textureManager.addAtlasJSONArray(this.key,i,e,s),this.complete=!0}}});KSe.register("multiatlas",function(t,e,i,s,r){var n;if(Array.isArray(t))for(var a=0;a<t.length;a++)n=new Nv(this,t[a]),this.addFile(n.files);else n=new Nv(this,t,e,i,s,r),this.addFile(n.files);return this});Pz.exports=Nv});var Mz=u(($He,Lz)=>{"use strict";var $Se=R(),JSe=Fs(),QSe=Wi(),Iz=ro(),Fv=new $Se({Extends:Iz,initialize:function(e,i,s,r,n){Iz.call(this,e,i,s,n,r),this.type="spritesheet"},addToCache:function(){var t=this.linkFile;t?t.state>=JSe.FILE_COMPLETE&&(this.type==="normalMap"?this.cache.addSpriteSheet(this.key,t.data,this.config,this.data):this.cache.addSpriteSheet(this.key,this.data,this.config,t.data)):this.cache.addSpriteSheet(this.key,this.data,this.config)}});QSe.register("spritesheet",function(t,e,i,s){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new Fv(this,t[r]));else this.addFile(new Fv(this,t,e,i,s));return this});Lz.exports=Fv});var Dz=u((JHe,Oz)=>{"use strict";Oz.exports={AtlasJSONFile:az(),AudioFile:pz(),BitmapFontFile:Cz(),ImageFile:ro(),JSONFile:dc(),MultiAtlasFile:_z(),SpriteSheetFile:Mz()}});var Fz=u((QHe,Nz)=>{"use strict";var eEe=R(),Jt=Fs(),pc=jm(),Bz=ze(),Yn=ss(),tEe=Wi(),ke=re(),iEe=Ne(),sEe=Xt(),rEe=Vt(),Gs=qe(),nEe=Bh(),Uz=new eEe({Extends:Bz,initialize:function(e){Bz.call(this);var i=e.sys.game.config,s=e.sys.settings.loader;this.scene=e,this.systems=e.sys,this.cacheManager=e.sys.cache,this.textureManager=e.sys.textures,this.sceneManager=e.sys.game.scene,tEe.install(this),this.prefix="",this.path="",this.baseURL="",this.setBaseURL(ke(s,"baseURL",i.loaderBaseURL)),this.setPath(ke(s,"path",i.loaderPath)),this.setPrefix(ke(s,"prefix",i.loaderPrefix)),this.maxParallelDownloads=ke(s,"maxParallelDownloads",i.loaderMaxParallelDownloads),this.xhr=nEe(ke(s,"responseType",i.loaderResponseType),ke(s,"async",i.loaderAsync),ke(s,"user",i.loaderUser),ke(s,"password",i.loaderPassword),ke(s,"timeout",i.loaderTimeout),ke(s,"withCredentials",i.loaderWithCredentials)),this.crossOrigin=ke(s,"crossOrigin",i.loaderCrossOrigin),this.imageLoadType=ke(s,"imageLoadType",i.loaderImageLoadType),this.localSchemes=ke(s,"localScheme",i.loaderLocalScheme),this.totalToLoad=0,this.progress=0,this.list=new pc,this.inflight=new pc,this.queue=new pc,this._deleteQueue=new pc,this.totalFailed=0,this.totalComplete=0,this.state=Jt.LOADER_IDLE,this.multiKeyIndex=0,this.maxRetries=ke(s,"maxRetries",i.loaderMaxRetries),e.sys.events.once(Gs.BOOT,this.boot,this),e.sys.events.on(Gs.START,this.pluginStart,this)},boot:function(){this.systems.events.once(Gs.DESTROY,this.destroy,this)},pluginStart:function(){this.systems.events.once(Gs.SHUTDOWN,this.shutdown,this)},setBaseURL:function(t){return t===void 0&&(t=""),t!==""&&t.substr(-1)!=="/"&&(t=t.concat("/")),this.baseURL=t,this},setPath:function(t){return t===void 0&&(t=""),t!==""&&t.substr(-1)!=="/"&&(t=t.concat("/")),this.path=t,this},setPrefix:function(t){return t===void 0&&(t=""),this.prefix=t,this},setCORS:function(t){return this.crossOrigin=t,this},addFile:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var i=t[e];this.keyExists(i)||(this.list.set(i),this.emit(Yn.ADD,i.key,i.type,this,i),this.isLoading()&&(this.totalToLoad++,this.updateProgress()))}},keyExists:function(t){var e=t.hasCacheConflict();return e||this.list.iterate(function(i){if(i.type===t.type&&i.key===t.key)return e=!0,!1}),!e&&this.isLoading()&&(this.inflight.iterate(function(i){if(i.type===t.type&&i.key===t.key)return e=!0,!1}),this.queue.iterate(function(i){if(i.type===t.type&&i.key===t.key)return e=!0,!1})),e},addPack:function(t,e){if(typeof e=="string"){var i=iEe(t,e);i&&(t={packKey:i})}var s=0,r=this.baseURL,n=this.path,a=this.prefix;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var h=t[o],l=ke(h,"baseURL",r),c=ke(h,"path",n),d=ke(h,"prefix",a),f=ke(h,"files",null),p=ke(h,"defaultType","void");if(Array.isArray(f)){this.setBaseURL(l),this.setPath(c),this.setPrefix(d);for(var m=0;m<f.length;m++){var v=f[m],g=v.hasOwnProperty("type")?v.type:p;this[g]&&(this[g](v),s++)}}}return this.setBaseURL(r),this.setPath(n),this.setPrefix(a),s>0},removePack:function(t,e){var i=this.systems.anims,s=this.cacheManager,r=this.textureManager,n={animation:"json",aseprite:"json",audio:"audio",audioSprite:"audio",binary:"binary",bitmapFont:"bitmapFont",css:null,glsl:"shader",html:"html",json:"json",obj:"obj",plugin:null,scenePlugin:null,script:null,spine:"json",text:"text",tilemapCSV:"tilemap",tilemapImpact:"tilemap",tilemapTiledJSON:"tilemap",video:"video",xml:"xml"},a;if(sEe(t))a=t;else if(a=s.json.get(t),!a){console.warn("Asset Pack not found in JSON cache:",t);return}e&&(a={_:a[e]});for(var o in a){var h=a[o],l=ke(h,"prefix",""),c=ke(h,"files"),d=ke(h,"defaultType");if(Array.isArray(c))for(var f=0;f<c.length;f++){var p=c[f],m=p.hasOwnProperty("type")?p.type:d;if(!m){console.warn("No type:",p);continue}var v=l+p.key;if(m==="animation"&&i.remove(v),!((m==="aseprite"||m==="atlas"||m==="atlasXML"||m==="htmlTexture"||m==="image"||m==="multiatlas"||m==="spritesheet"||m==="svg"||m==="texture"||m==="unityAtlas")&&(r.remove(v),!n[m]))){if(m==="pack"){this.removePack(v,p.dataKey);continue}if(m==="spine"){var g=s.custom.spine.get(v);if(!g)continue;var S=g.prefix===void 0?"":g.prefix;s.custom.spine.remove(v);var y=s.custom.spineTextures.get(v);if(!y)continue;s.custom.spineTextures.remove(v);for(var b=0;b<y.pages.length;b++){var x=y.pages[b],A=S+x.name,w=v+":"+A;r.exists(w)?r.remove(w):r.remove(A)}}var C=n[m];if(C!==null){if(!C){console.warn("Unknown type:",m);continue}var _=s[C];_.remove(v)}}}}},isLoading:function(){return this.state===Jt.LOADER_LOADING||this.state===Jt.LOADER_PROCESSING},isReady:function(){return this.state===Jt.LOADER_IDLE||this.state===Jt.LOADER_COMPLETE},start:function(){this.isReady()&&(this.progress=0,this.totalFailed=0,this.totalComplete=0,this.totalToLoad=this.list.size,this.emit(Yn.START,this),this.list.size===0?this.loadComplete():(this.state=Jt.LOADER_LOADING,this.inflight.clear(),this.queue.clear(),this.updateProgress(),this.checkLoadQueue(),this.systems.events.on(Gs.UPDATE,this.update,this)))},updateProgress:function(){this.progress=1-(this.list.size+this.inflight.size)/this.totalToLoad,this.emit(Yn.PROGRESS,this.progress)},update:function(){this.state===Jt.LOADER_LOADING&&this.list.size>0&&this.inflight.size<this.maxParallelDownloads&&this.checkLoadQueue()},checkLoadQueue:function(){this.list.each(function(t){if((t.state===Jt.FILE_POPULATED||t.state===Jt.FILE_PENDING&&this.inflight.size<this.maxParallelDownloads)&&(this.inflight.set(t),this.list.delete(t),t.crossOrigin||(t.crossOrigin=this.crossOrigin),t.load()),this.inflight.size===this.maxParallelDownloads)return!1},this)},nextFile:function(t,e){this.inflight&&(this.inflight.delete(t),this.updateProgress(),e?(this.totalComplete++,this.queue.set(t),this.emit(Yn.FILE_LOAD,t),t.onProcess()):(this.totalFailed++,this._deleteQueue.set(t),this.emit(Yn.FILE_LOAD_ERROR,t),this.fileProcessComplete(t)))},fileProcessComplete:function(t){!this.scene||!this.systems||!this.systems.game||this.systems.game.pendingDestroy||(t.state===Jt.FILE_ERRORED?t.multiFile&&t.multiFile.onFileFailed(t):t.state===Jt.FILE_COMPLETE&&(t.multiFile?t.multiFile.isReadyToProcess()&&(t.multiFile.addToCache(),t.multiFile.pendingDestroy()):(t.addToCache(),t.pendingDestroy())),this.queue.delete(t),this.list.size===0&&this.inflight.size===0&&this.queue.size===0&&this.loadComplete())},loadComplete:function(){this.emit(Yn.POST_PROCESS,this),this.list.clear(),this.inflight.clear(),this.queue.clear(),this.progress=1,this.state=Jt.LOADER_COMPLETE,this.systems.events.off(Gs.UPDATE,this.update,this),this._deleteQueue.iterateLocal("destroy"),this._deleteQueue.clear(),this.emit(Yn.COMPLETE,this,this.totalComplete,this.totalFailed)},flagForRemoval:function(t){this._deleteQueue.set(t)},saveJSON:function(t,e){return this.save(JSON.stringify(t),e)},save:function(t,e,i){e===void 0&&(e="file.json"),i===void 0&&(i="application/json");var s=new Blob([t],{type:i}),r=URL.createObjectURL(s),n=document.createElement("a");return n.download=e,n.textContent="Download "+e,n.href=r,n.click(),this},reset:function(){this.list.clear(),this.inflight.clear(),this.queue.clear();var t=this.systems.game.config,e=this.systems.settings.loader;this.setBaseURL(ke(e,"baseURL",t.loaderBaseURL)),this.setPath(ke(e,"path",t.loaderPath)),this.setPrefix(ke(e,"prefix",t.loaderPrefix)),this.state=Jt.LOADER_IDLE},shutdown:function(){this.reset(),this.state=Jt.LOADER_SHUTDOWN,this.removeAllListeners(),this.systems.events.off(Gs.UPDATE,this.update,this),this.systems.events.off(Gs.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.state=Jt.LOADER_DESTROYED,this.systems.events.off(Gs.UPDATE,this.update,this),this.systems.events.off(Gs.START,this.pluginStart,this),this.list=null,this.inflight=null,this.queue=null,this.scene=null,this.systems=null,this.textureManager=null,this.cacheManager=null,this.sceneManager=null}});rEe.register("Loader",Uz,"load");Nz.exports=Uz});var Gv=u((eze,kz)=>{"use strict";var aEe=Fs(),oEe=mi(),kv={Events:ss(),FileTypes:Dz(),File:Gn(),FileTypesManager:Wi(),GetURL:Dh(),LoaderPlugin:Fz(),MergeXHRSettings:uc(),MultiFile:Fh(),XHRLoader:wv(),XHRSettings:Bh()};kv=oEe(!1,kv,aEe);kz.exports=kv});var $v=u((Nze,a5)=>{"use strict";var AEe=Wu(),xEe=R(),i5=Ch(),s5=ze(),qh=Ds(),r5=vi(),Wh=re(),Qt=Ne(),CEe=Kt(),n5=Rf(),wEe=yf(),REe=new xEe({Extends:s5,initialize:function(e){s5.call(this),this.game=e,this.textureManager=null,this.globalTimeScale=1,this.anims=new i5,this.mixes=new i5,this.paused=!1,this.name="AnimationManager",e.events.once(r5.BOOT,this.boot,this)},boot:function(){this.textureManager=this.game.textures,this.game.events.once(r5.DESTROY,this.destroy,this)},addMix:function(t,e,i){var s=this.anims,r=this.mixes,n=typeof t=="string"?t:t.key,a=typeof e=="string"?e:e.key;if(s.has(n)&&s.has(a)){var o=r.get(n);o||(o={}),o[a]=i,r.set(n,o)}return this},removeMix:function(t,e){var i=this.mixes,s=typeof t=="string"?t:t.key,r=i.get(s);if(r)if(e){var n=typeof e=="string"?e:e.key;r.hasOwnProperty(n)&&delete r[n]}else e||i.delete(s);return this},getMix:function(t,e){var i=this.mixes,s=typeof t=="string"?t:t.key,r=typeof e=="string"?e:e.key,n=i.get(s);return n&&n.hasOwnProperty(r)?n[r]:0},add:function(t,e){return this.anims.has(t)?(console.warn("Animation key exists: "+t),this):(e.key=t,this.anims.set(t,e),this.emit(qh.ADD_ANIMATION,t,e),this)},exists:function(t){return this.anims.has(t)},createFromAseprite:function(t,e,i){var s=[],r=this.game.cache.json.get(t);if(!r)return console.warn("No Aseprite data found for: "+t),s;var n=this,a=Qt(r,"meta",null),o=Qt(r,"frames",null);if(a&&o){var h=Qt(a,"frameTags",[]);h.forEach(function(l){var c=[],d=Wh(l,"name",null),f=Wh(l,"from",0),p=Wh(l,"to",0),m=Wh(l,"direction","forward");if(d&&(!e||e&&e.indexOf(d)>-1)){for(var v=0,g=f;g<=p;g++){var S=g.toString(),y=o[S];if(y){var b=Wh(y,"duration",CEe.MAX_SAFE_INTEGER);c.push({key:t,frame:S,duration:b}),v+=b}}m==="reverse"&&(c=c.reverse());var x={key:d,frames:c,duration:v,yoyo:m==="pingpong"},A;i?i.anims&&(A=i.anims.create(x)):A=n.create(x),A&&s.push(A)}})}return s},create:function(t){var e=t.key,i=!1;return e&&(i=this.get(e),i?console.warn("AnimationManager key already exists: "+e):(i=new AEe(this,e,t),this.anims.set(e,i),this.emit(qh.ADD_ANIMATION,e,i))),i},fromJSON:function(t,e){e===void 0&&(e=!1),e&&this.anims.clear(),typeof t=="string"&&(t=JSON.parse(t));var i=[];if(t.hasOwnProperty("anims")&&Array.isArray(t.anims)){for(var s=0;s<t.anims.length;s++)i.push(this.create(t.anims[s]));t.hasOwnProperty("globalTimeScale")&&(this.globalTimeScale=t.globalTimeScale)}else t.hasOwnProperty("key")&&t.type==="frame"&&i.push(this.create(t));return i},generateFrameNames:function(t,e){var i=Qt(e,"prefix",""),s=Qt(e,"start",0),r=Qt(e,"end",0),n=Qt(e,"suffix",""),a=Qt(e,"zeroPad",0),o=Qt(e,"outputArray",[]),h=Qt(e,"frames",!1);if(!this.textureManager.exists(t))return console.warn('Texture "%s" not found',t),o;var l=this.textureManager.get(t);if(!l)return o;var c;if(e)for(h||(h=n5(s,r)),c=0;c<h.length;c++){var d=i+wEe(h[c],a,"0",1)+n;l.has(d)?o.push({key:t,frame:d}):console.warn('Frame "%s" not found in texture "%s"',d,t)}else for(h=l.getFrameNames(),c=0;c<h.length;c++)o.push({key:t,frame:h[c]});return o},generateFrameNumbers:function(t,e){var i=Qt(e,"start",0),s=Qt(e,"end",-1),r=Qt(e,"first",!1),n=Qt(e,"outputArray",[]),a=Qt(e,"frames",!1);if(!this.textureManager.exists(t))return console.warn('Texture "%s" not found',t),n;var o=this.textureManager.get(t);if(!o)return n;r&&o.has(r)&&n.push({key:t,frame:r}),a||(s===-1&&(s=o.frameTotal-2),a=n5(i,s));for(var h=0;h<a.length;h++){var l=a[h];o.has(l)?n.push({key:t,frame:l}):console.warn('Frame "%s" not found in texture "%s"',l,t)}return n},get:function(t){return this.anims.get(t)},getAnimsFromTexture:function(t){for(var e=this.textureManager.get(t),i=e.key,s=this.anims.getArray(),r=[],n=0;n<s.length;n++)for(var a=s[n],o=a.frames,h=0;h<o.length;h++)if(o[h].textureKey===i){r.push(a.key);break}return r},pauseAll:function(){return this.paused||(this.paused=!0,this.emit(qh.PAUSE_ALL)),this},play:function(t,e){Array.isArray(e)||(e=[e]);for(var i=0;i<e.length;i++)e[i].anims.play(t);return this},staggerPlay:function(t,e,i,s){i===void 0&&(i=0),s===void 0&&(s=!0),Array.isArray(e)||(e=[e]);var r=e.length;s||r--;for(var n=0;n<e.length;n++){var a=i<0?Math.abs(i)*(r-n):i*n;e[n].anims.playAfterDelay(t,a)}return this},remove:function(t){var e=this.get(t);return e&&(this.emit(qh.REMOVE_ANIMATION,t,e),this.anims.delete(t),this.removeMix(t)),e},resumeAll:function(){return this.paused&&(this.paused=!1,this.emit(qh.RESUME_ALL)),this},toJSON:function(t){var e={anims:[],globalTimeScale:this.globalTimeScale};return t!==void 0&&t!==""?e.anims.push(this.anims.get(t).toJSON()):this.anims.each(function(i,s){e.anims.push(s.toJSON())}),e},destroy:function(){this.anims.clear(),this.mixes.clear(),this.textureManager=null,this.game=null}});a5.exports=REe});var mt=u((Fze,o5)=>{"use strict";o5.exports={Animation:Wu(),AnimationFrame:$m(),AnimationManager:$v(),AnimationState:Yu(),Events:Ds()}});var Sg=u((Y5e,k5)=>{"use strict";var dye=Ze(),F5=Kt(),fye=function(t,e){if(e===void 0&&(e=new dye),t.length===0)return e;for(var i=Number.MAX_VALUE,s=Number.MAX_VALUE,r=F5.MIN_SAFE_INTEGER,n=F5.MIN_SAFE_INTEGER,a,o,h,l=0;l<t.length;l++)a=t[l],Array.isArray(a)?(o=a[0],h=a[1]):(o=a.x,h=a.y),i=Math.min(i,o),s=Math.min(s,h),r=Math.max(r,o),n=Math.max(n,h);return e.x=i,e.y=s,e.width=r-i,e.height=n-s,e};k5.exports=fye});var Yh=u((H5e,G5)=>{"use strict";var pye=R(),mye=Sg(),vye=Ze(),lo=Fe(),gye=new pye({initialize:function(e){this.type=e,this.defaultDivisions=5,this.arcLengthDivisions=100,this.cacheArcLengths=[],this.needsUpdate=!0,this.active=!0,this._tmpVec2A=new lo,this._tmpVec2B=new lo},draw:function(t,e){return e===void 0&&(e=32),t.strokePoints(this.getPoints(e))},getBounds:function(t,e){t||(t=new vye),e===void 0&&(e=16);var i=this.getLength();e>i&&(e=i/2);var s=Math.max(1,Math.round(i/e));return mye(this.getSpacedPoints(s),t)},getDistancePoints:function(t){var e=this.getLength(),i=Math.max(1,e/t);return this.getSpacedPoints(i)},getEndPoint:function(t){return t===void 0&&(t=new lo),this.getPointAt(1,t)},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(t===void 0&&(t=this.arcLengthDivisions),this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e=[],i,s=this.getPoint(0,this._tmpVec2A),r=0;e.push(0);for(var n=1;n<=t;n++)i=this.getPoint(n/t,this._tmpVec2B),r+=i.distance(s),e.push(r),s.copy(i);return this.cacheArcLengths=e,e},getPointAt:function(t,e){var i=this.getUtoTmapping(t);return this.getPoint(i,e)},getPoints:function(t,e,i){i===void 0&&(i=[]),t||(e?t=this.getLength()/e:t=this.defaultDivisions);for(var s=0;s<=t;s++)i.push(this.getPoint(s/t));return i},getRandomPoint:function(t){return t===void 0&&(t=new lo),this.getPoint(Math.random(),t)},getSpacedPoints:function(t,e,i){i===void 0&&(i=[]),t||(e?t=this.getLength()/e:t=this.defaultDivisions);for(var s=0;s<=t;s++){var r=this.getUtoTmapping(s/t,null,t);i.push(this.getPoint(r))}return i},getStartPoint:function(t){return t===void 0&&(t=new lo),this.getPointAt(0,t)},getTangent:function(t,e){e===void 0&&(e=new lo);var i=1e-4,s=t-i,r=t+i;return s<0&&(s=0),r>1&&(r=1),this.getPoint(s,this._tmpVec2A),this.getPoint(r,e),e.subtract(this._tmpVec2A).normalize()},getTangentAt:function(t,e){var i=this.getUtoTmapping(t);return this.getTangent(i,e)},getTFromDistance:function(t,e){return t<=0?0:this.getUtoTmapping(0,t,e)},getUtoTmapping:function(t,e,i){var s=this.getLengths(i),r=0,n=s.length,a;e?a=Math.min(e,s[n-1]):a=t*s[n-1];for(var o=0,h=n-1,l;o<=h;)if(r=Math.floor(o+(h-o)/2),l=s[r]-a,l<0)o=r+1;else if(l>0)h=r-1;else{h=r;break}if(r=h,s[r]===a)return r/(n-1);var c=s[r],d=s[r+1],f=d-c,p=(a-c)/f;return(r+p)/(n-1)},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()}});G5.exports=gye});var H5=u((z5e,Y5)=>{"use strict";var Sye=R(),q5=rm(),W5=Yh(),qs=Fe(),Eg=new Sye({Extends:W5,initialize:function(e,i,s,r){W5.call(this,"CubicBezierCurve"),Array.isArray(e)&&(r=new qs(e[6],e[7]),s=new qs(e[4],e[5]),i=new qs(e[2],e[3]),e=new qs(e[0],e[1])),this.p0=e,this.p1=i,this.p2=s,this.p3=r},getStartPoint:function(t){return t===void 0&&(t=new qs),t.copy(this.p0)},getResolution:function(t){return t},getPoint:function(t,e){e===void 0&&(e=new qs);var i=this.p0,s=this.p1,r=this.p2,n=this.p3;return e.set(q5(t,i.x,s.x,r.x,n.x),q5(t,i.y,s.y,r.y,n.y))},draw:function(t,e){e===void 0&&(e=32);var i=this.getPoints(e);t.beginPath(),t.moveTo(this.p0.x,this.p0.y);for(var s=1;s<i.length;s++)t.lineTo(i[s].x,i[s].y);return t.strokePath(),t},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y,this.p2.x,this.p2.y,this.p3.x,this.p3.y]}}});Eg.fromJSON=function(t){var e=t.points,i=new qs(e[0],e[1]),s=new qs(e[2],e[3]),r=new qs(e[4],e[5]),n=new qs(e[6],e[7]);return new Eg(i,s,r,n)};Y5.exports=Eg});var X5=u((V5e,V5)=>{"use strict";var Eye=R(),z5=Yh(),uo=Na(),sn=Ne(),co=lm(),Tg=Fe(),yg=new Eye({Extends:z5,initialize:function(e,i,s,r,n,a,o,h){if(typeof e=="object"){var l=e;e=sn(l,"x",0),i=sn(l,"y",0),s=sn(l,"xRadius",0),r=sn(l,"yRadius",s),n=sn(l,"startAngle",0),a=sn(l,"endAngle",360),o=sn(l,"clockwise",!1),h=sn(l,"rotation",0)}else r===void 0&&(r=s),n===void 0&&(n=0),a===void 0&&(a=360),o===void 0&&(o=!1),h===void 0&&(h=0);z5.call(this,"EllipseCurve"),this.p0=new Tg(e,i),this._xRadius=s,this._yRadius=r,this._startAngle=uo(n),this._endAngle=uo(a),this._clockwise=o,this._rotation=uo(h)},getStartPoint:function(t){return t===void 0&&(t=new Tg),this.getPoint(0,t)},getResolution:function(t){return t*2},getPoint:function(t,e){e===void 0&&(e=new Tg);for(var i=Math.PI*2,s=this._endAngle-this._startAngle,r=Math.abs(s)<Number.EPSILON;s<0;)s+=i;for(;s>i;)s-=i;s<Number.EPSILON&&(r?s=0:s=i),this._clockwise&&!r&&(s===i?s=-i:s=s-i);var n=this._startAngle+t*s,a=this.p0.x+this._xRadius*Math.cos(n),o=this.p0.y+this._yRadius*Math.sin(n);if(this._rotation!==0){var h=Math.cos(this._rotation),l=Math.sin(this._rotation),c=a-this.p0.x,d=o-this.p0.y;a=c*h-d*l+this.p0.x,o=c*l+d*h+this.p0.y}return e.set(a,o)},setXRadius:function(t){return this.xRadius=t,this},setYRadius:function(t){return this.yRadius=t,this},setWidth:function(t){return this.xRadius=t/2,this},setHeight:function(t){return this.yRadius=t/2,this},setStartAngle:function(t){return this.startAngle=t,this},setEndAngle:function(t){return this.endAngle=t,this},setClockwise:function(t){return this.clockwise=t,this},setRotation:function(t){return this.rotation=t,this},x:{get:function(){return this.p0.x},set:function(t){this.p0.x=t}},y:{get:function(){return this.p0.y},set:function(t){this.p0.y=t}},xRadius:{get:function(){return this._xRadius},set:function(t){this._xRadius=t}},yRadius:{get:function(){return this._yRadius},set:function(t){this._yRadius=t}},startAngle:{get:function(){return co(this._startAngle)},set:function(t){this._startAngle=uo(t)}},endAngle:{get:function(){return co(this._endAngle)},set:function(t){this._endAngle=uo(t)}},clockwise:{get:function(){return this._clockwise},set:function(t){this._clockwise=t}},angle:{get:function(){return co(this._rotation)},set:function(t){this._rotation=uo(t)}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation=t}},toJSON:function(){return{type:this.type,x:this.p0.x,y:this.p0.y,xRadius:this._xRadius,yRadius:this._yRadius,startAngle:co(this._startAngle),endAngle:co(this._endAngle),clockwise:this._clockwise,rotation:co(this._rotation)}}});yg.fromJSON=function(t){return new yg(t)};V5.exports=yg});var $5=u((X5e,j5)=>{"use strict";var Tye=R(),K5=Yh(),Z5=om(),rn=Fe(),bg=new Tye({Extends:K5,initialize:function(e,i,s){K5.call(this,"QuadraticBezierCurve"),Array.isArray(e)&&(s=new rn(e[4],e[5]),i=new rn(e[2],e[3]),e=new rn(e[0],e[1])),this.p0=e,this.p1=i,this.p2=s},getStartPoint:function(t){return t===void 0&&(t=new rn),t.copy(this.p0)},getResolution:function(t){return t},getPoint:function(t,e){e===void 0&&(e=new rn);var i=this.p0,s=this.p1,r=this.p2;return e.set(Z5(t,i.x,s.x,r.x),Z5(t,i.y,s.y,r.y))},draw:function(t,e){e===void 0&&(e=32);var i=this.getPoints(e);t.beginPath(),t.moveTo(this.p0.x,this.p0.y);for(var s=1;s<i.length;s++)t.lineTo(i[s].x,i[s].y);return t.strokePath(),t},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y,this.p2.x,this.p2.y]}}});bg.fromJSON=function(t){var e=t.points,i=new rn(e[0],e[1]),s=new rn(e[2],e[3]),r=new rn(e[4],e[5]);return new bg(i,s,r)};j5.exports=bg});var tV=u((K5e,eV)=>{"use strict";var J5=im(),yye=R(),Q5=Yh(),Tc=Fe(),Ag=new yye({Extends:Q5,initialize:function(e){e===void 0&&(e=[]),Q5.call(this,"SplineCurve"),this.points=[],this.addPoints(e)},addPoints:function(t){for(var e=0;e<t.length;e++){var i=new Tc;typeof t[e]=="number"?(i.x=t[e],i.y=t[e+1],e++):Array.isArray(t[e])?(i.x=t[e][0],i.y=t[e][1]):(i.x=t[e].x,i.y=t[e].y),this.points.push(i)}return this},addPoint:function(t,e){var i=new Tc(t,e);return this.points.push(i),i},getStartPoint:function(t){return t===void 0&&(t=new Tc),t.copy(this.points[0])},getResolution:function(t){return t*this.points.length},getPoint:function(t,e){e===void 0&&(e=new Tc);var i=this.points,s=(i.length-1)*t,r=Math.floor(s),n=s-r,a=i[r===0?r:r-1],o=i[r],h=i[r>i.length-2?i.length-1:r+1],l=i[r>i.length-3?i.length-1:r+2];return e.set(J5(n,a.x,o.x,h.x,l.x),J5(n,a.y,o.y,h.y,l.y))},toJSON:function(){for(var t=[],e=0;e<this.points.length;e++)t.push(this.points[e].x),t.push(this.points[e].y);return{type:this.type,points:t}}});Ag.fromJSON=function(t){return new Ag(t.points)};eV.exports=Ag});var yc=u((Z5e,iV)=>{"use strict";iV.exports={CubicBezier:H5(),Ellipse:X5(),QuadraticBezier:$5(),Spline:tV()}});var oV=u((J5e,aV)=>{"use strict";var xye=function(t){return t.radius>0?Math.PI*t.radius*t.radius:0};aV.exports=xye});var lV=u((Q5e,hV)=>{"use strict";var Cye=ku(),wye=function(t){return new Cye(t.x,t.y,t.radius)};hV.exports=wye});var cV=u((eVe,uV)=>{"use strict";var Rye=Xa(),Pye=function(t,e){return Rye(t,e.x,e.y)};uV.exports=Pye});var fV=u((tVe,dV)=>{"use strict";var bc=Xa(),_ye=function(t,e){return bc(t,e.x,e.y)&&bc(t,e.right,e.y)&&bc(t,e.x,e.bottom)&&bc(t,e.right,e.bottom)};dV.exports=_ye});var mV=u((iVe,pV)=>{"use strict";var Iye=function(t,e){return e.setTo(t.x,t.y,t.radius)};pV.exports=Iye});var gV=u((sVe,vV)=>{"use strict";var Lye=function(t,e){return t.x===e.x&&t.y===e.y&&t.radius===e.radius};vV.exports=Lye});var EV=u((rVe,SV)=>{"use strict";var Mye=Ze(),Oye=function(t,e){return e===void 0&&(e=new Mye),e.x=t.left,e.y=t.top,e.width=t.diameter,e.height=t.diameter,e};SV.exports=Oye});var yV=u((nVe,TV)=>{"use strict";var Dye=function(t,e,i){return t.x+=e,t.y+=i,t};TV.exports=Dye});var AV=u((aVe,bV)=>{"use strict";var Bye=function(t,e){return t.x+=e.x,t.y+=e.y,t};bV.exports=Bye});var CV=u((oVe,xV)=>{"use strict";var Gt=ku();Gt.Area=oV();Gt.Circumference=zm();Gt.CircumferencePoint=Nu();Gt.Clone=lV();Gt.Contains=Xa();Gt.ContainsPoint=cV();Gt.ContainsRect=fV();Gt.CopyFrom=mV();Gt.Equals=gV();Gt.GetBounds=EV();Gt.GetPoint=Hm();Gt.GetPoints=Vm();Gt.Offset=yV();Gt.OffsetPoint=AV();Gt.Random=Fu();xV.exports=Gt});var RV=u((hVe,wV)=>{"use strict";var Uye=function(t){return t.width*t.height};wV.exports=Uye});var _V=u((lVe,PV)=>{"use strict";var Nye=function(t){return t.x=Math.ceil(t.x),t.y=Math.ceil(t.y),t};PV.exports=Nye});var LV=u((uVe,IV)=>{"use strict";var Fye=function(t){return t.x=Math.ceil(t.x),t.y=Math.ceil(t.y),t.width=Math.ceil(t.width),t.height=Math.ceil(t.height),t};IV.exports=Fye});var OV=u((cVe,MV)=>{"use strict";var kye=Ze(),Gye=function(t){return new kye(t.x,t.y,t.width,t.height)};MV.exports=Gye});var BV=u((dVe,DV)=>{"use strict";var qye=Pn(),Wye=function(t,e){return qye(t,e.x,e.y)};DV.exports=Wye});var xg=u((fVe,UV)=>{"use strict";var Yye=function(t,e){return e.width*e.height>t.width*t.height?!1:e.x>t.x&&e.x<t.right&&e.right>t.x&&e.right<t.right&&e.y>t.y&&e.y<t.bottom&&e.bottom>t.y&&e.bottom<t.bottom};UV.exports=Yye});var FV=u((pVe,NV)=>{"use strict";var Hye=function(t,e){return e===void 0&&(e=[]),e.push({x:t.x,y:t.y}),e.push({x:t.right,y:t.y}),e.push({x:t.right,y:t.bottom}),e.push({x:t.x,y:t.bottom}),e};NV.exports=Hye});var GV=u((mVe,kV)=>{"use strict";var zye=function(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height};kV.exports=zye});var Ac=u((vVe,qV)=>{"use strict";var Vye=function(t){return t.height===0?NaN:t.width/t.height};qV.exports=Vye});var HV=u((gVe,YV)=>{"use strict";var WV=Ac(),Xye=function(t,e){var i=WV(t);return i<WV(e)?t.setSize(e.height*i,e.height):t.setSize(e.width,e.width/i),t.setPosition(e.centerX-t.width/2,e.centerY-t.height/2)};YV.exports=Xye});var XV=u((SVe,VV)=>{"use strict";var zV=Ac(),Kye=function(t,e){var i=zV(t);return i>zV(e)?t.setSize(e.height*i,e.height):t.setSize(e.width,e.width/i),t.setPosition(e.centerX-t.width/2,e.centerY-t.height/2)};VV.exports=Kye});var ZV=u((EVe,KV)=>{"use strict";var Zye=function(t){return t.x=Math.floor(t.x),t.y=Math.floor(t.y),t};KV.exports=Zye});var $V=u((TVe,jV)=>{"use strict";var jye=function(t){return t.x=Math.floor(t.x),t.y=Math.floor(t.y),t.width=Math.floor(t.width),t.height=Math.floor(t.height),t};jV.exports=jye});var QV=u((yVe,JV)=>{"use strict";var $ye=Ze(),Jye=function(t,e,i,s,r){return r===void 0&&(r=new $ye),r.setTo(Math.min(t,i),Math.min(e,s),Math.abs(t-i),Math.abs(e-s))};JV.exports=Jye});var tX=u((bVe,eX)=>{"use strict";var Qye=Ct(),ebe=function(t,e){return e===void 0&&(e=new Qye),e.x=t.centerX,e.y=t.centerY,e};eX.exports=ebe});var sX=u((AVe,iX)=>{"use strict";var tbe=Ct(),ibe=function(t,e){return e===void 0&&(e=new tbe),e.x=t.width,e.y=t.height,e};iX.exports=ibe});var nX=u((xVe,rX)=>{"use strict";var sbe=Ze(),rbe=Zu(),nbe=function(t,e,i){return i===void 0&&(i=new sbe),rbe(t,e)?(i.x=Math.max(t.x,e.x),i.y=Math.max(t.y,e.y),i.width=Math.min(t.right,e.right)-i.x,i.height=Math.min(t.bottom,e.bottom)-i.y):i.setEmpty(),i};rX.exports=nbe});var oX=u((CVe,aX)=>{"use strict";var abe=function(t,e){for(var i=t.x,s=t.right,r=t.y,n=t.bottom,a=0;a<e.length;a++)i=Math.min(i,e[a].x),s=Math.max(s,e[a].x),r=Math.min(r,e[a].y),n=Math.max(n,e[a].y);return t.x=i,t.y=r,t.width=s-i,t.height=n-r,t};aX.exports=abe});var lX=u((wVe,hX)=>{"use strict";var obe=function(t,e,i){var s=Math.min(t.x,e),r=Math.max(t.right,e);t.x=s,t.width=r-s;var n=Math.min(t.y,i),a=Math.max(t.bottom,i);return t.y=n,t.height=a-n,t};hX.exports=obe});var cX=u((RVe,uX)=>{"use strict";var hbe=function(t,e,i){return t.x+=e,t.y+=i,t};uX.exports=hbe});var fX=u((PVe,dX)=>{"use strict";var lbe=function(t,e){return t.x+=e.x,t.y+=e.y,t};dX.exports=lbe});var mX=u((_Ve,pX)=>{"use strict";var ube=function(t,e){return t.x<e.right&&t.right>e.x&&t.y<e.bottom&&t.bottom>e.y};pX.exports=ube});var gX=u((IVe,vX)=>{"use strict";var cbe=Ct(),dbe=Na(),fbe=function(t,e,i){i===void 0&&(i=new cbe),e=dbe(e);var s=Math.sin(e),r=Math.cos(e),n=r>0?t.width/2:t.width/-2,a=s>0?t.height/2:t.height/-2;return Math.abs(n*s)<Math.abs(a*r)?a=n*s/r:n=a*r/s,i.x=n+t.centerX,i.y=a+t.centerY,i};vX.exports=fbe});var EX=u((LVe,SX)=>{"use strict";var pbe=Mn(),mbe=xg(),vbe=Ct(),gbe=function(t,e,i){if(i===void 0&&(i=new vbe),mbe(t,e))switch(pbe(0,3)){case 0:i.x=t.x+Math.random()*(e.right-t.x),i.y=t.y+Math.random()*(e.top-t.y);break;case 1:i.x=e.x+Math.random()*(t.right-e.x),i.y=e.bottom+Math.random()*(t.bottom-e.bottom);break;case 2:i.x=t.x+Math.random()*(e.x-t.x),i.y=e.y+Math.random()*(t.bottom-e.y);break;case 3:i.x=e.right+Math.random()*(t.right-e.right),i.y=t.y+Math.random()*(e.bottom-t.y);break}return i};SX.exports=gbe});var yX=u((MVe,TX)=>{"use strict";var Sbe=function(t,e){return t.width===e.width&&t.height===e.height};TX.exports=Sbe});var AX=u((OVe,bX)=>{"use strict";var Ebe=function(t,e,i){return i===void 0&&(i=e),t.width*=e,t.height*=i,t};bX.exports=Ebe});var CX=u((DVe,xX)=>{"use strict";var ce=Ze();ce.Area=RV();ce.Ceil=_V();ce.CeilAll=LV();ce.CenterOn=uu();ce.Clone=OV();ce.Contains=Pn();ce.ContainsPoint=BV();ce.ContainsRect=xg();ce.CopyFrom=av();ce.Decompose=FV();ce.Equals=GV();ce.FitInside=HV();ce.FitOutside=XV();ce.Floor=ZV();ce.FloorAll=$V();ce.FromPoints=Sg();ce.FromXY=QV();ce.GetAspectRatio=Ac();ce.GetCenter=tX();ce.GetPoint=Jl();ce.GetPoints=Bf();ce.GetSize=sX();ce.Inflate=lv();ce.Intersection=nX();ce.MarchingAnts=Xm();ce.MergePoints=oX();ce.MergeRect=uv();ce.MergeXY=lX();ce.Offset=cX();ce.OffsetPoint=fX();ce.Overlaps=mX();ce.Perimeter=sh();ce.PerimeterPoint=gX();ce.Random=eu();ce.RandomOutside=EX();ce.SameDimensions=yX();ce.Scale=AX();ce.Union=mm();xX.exports=ce});var vr=u((BVe,wX)=>{"use strict";var Tbe=_n(),ybe=mi(),Cg={Circle:CV(),Rectangle:CX()};Cg=ybe(!1,Cg,Tbe);wX.exports=Cg});var m3=u((jKe,p3)=>{"use strict";var Dc=In(),a0e=function(t){t===void 0&&(t=1024);var e=[],i=255,s,r=255,n=0,a=0;for(s=0;s<=i;s++)e.push({r,g:s,b:a,color:Dc(r,s,a)});for(n=255,s=i;s>=0;s--)e.push({r:s,g:n,b:a,color:Dc(s,n,a)});for(r=0,s=0;s<=i;s++,n--)e.push({r,g:n,b:s,color:Dc(r,n,s)});for(n=0,a=255,s=0;s<=i;s++,a--,r++)e.push({r,g:n,b:a,color:Dc(r,n,a)});if(t===1024)return e;var o=[],h=0,l=1024/t;for(s=0;s<t;s++)o.push(e[Math.floor(h)]),h+=l;return o};p3.exports=a0e});var g3=u(($Ke,v3)=>{"use strict";var o0e=function(t){var e={r:t>>16&255,g:t>>8&255,b:t&255,a:255};return t>16777215&&(e.a=t>>>24),e};v3.exports=o0e});var fS=u((JKe,S3)=>{"use strict";var h0e=function(t){var e=t.toString(16);return e.length===1?"0"+e:e};S3.exports=h0e});var pS=u((QKe,E3)=>{"use strict";var l0e=function(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<.16666666666666666?t+(e-t)*6*i:i<.5?e:i<.6666666666666666?t+(e-t)*(.6666666666666666-i)*6:t};E3.exports=l0e});var y3=u((e4e,T3)=>{"use strict";var u0e=is(),mS=pS(),c0e=function(t,e,i){var s=i,r=i,n=i;if(e!==0){var a=i<.5?i*(1+e):i+e-i*e,o=2*i-a;s=mS(o,a,t+1/3),r=mS(o,a,t),n=mS(o,a,t-1/3)}var h=new u0e;return h.setGLTo(s,r,n,1)};T3.exports=c0e});var A3=u((t4e,b3)=>{"use strict";var d0e=nu(),f0e=function(t,e){t===void 0&&(t=1),e===void 0&&(e=1);for(var i=[],s=0;s<=359;s++)i.push(d0e(s/359,t,e));return i};b3.exports=f0e});var C3=u((i4e,x3)=>{"use strict";var vS=uh(),p0e=In(),gS=function(t,e,i,s,r,n,a,o){a===void 0&&(a=100),o===void 0&&(o=0);var h=o/a,l=vS(t,s,h),c=vS(e,r,h),d=vS(i,n,h);return{r:l,g:c,b:d,a:255,color:p0e(l,c,d)}},m0e=function(t,e,i,s){return i===void 0&&(i=100),s===void 0&&(s=0),gS(t.r,t.g,t.b,e.r,e.g,e.b,i,s)},v0e=function(t,e,i,s,r,n){return r===void 0&&(r=100),n===void 0&&(n=0),gS(t.r,t.g,t.b,e,i,s,r,n)};x3.exports={RGBWithRGB:gS,ColorWithRGB:v0e,ColorWithColor:m0e}});var R3=u((s4e,w3)=>{"use strict";var SS=Mn(),g0e=is(),S0e=function(t,e){return t===void 0&&(t=0),e===void 0&&(e=255),new g0e(SS(t,e),SS(t,e),SS(t,e))};w3.exports=S0e});var _3=u((r4e,P3)=>{"use strict";var Bc=fS(),E0e=function(t,e,i,s,r){return s===void 0&&(s=255),r===void 0&&(r="#"),r==="#"?"#"+((1<<24)+(t<<16)+(e<<8)+i).toString(16).slice(1,7):"0x"+Bc(s)+Bc(t)+Bc(e)+Bc(i)};P3.exports=E0e});var ES=u((n4e,I3)=>{"use strict";var ot=is();ot.ColorSpectrum=m3();ot.ColorToRGBA=g3();ot.ComponentToHex=fS();ot.GetColor=In();ot.GetColor32=Xf();ot.HexStringToColor=jf();ot.HSLToColor=y3();ot.HSVColorWheel=A3();ot.HSVToRGB=nu();ot.HueToComponent=pS();ot.IntegerToColor=$f();ot.IntegerToRGB=ou();ot.Interpolate=C3();ot.ObjectToColor=Jf();ot.RandomRGB=R3();ot.RGBStringToColor=Qf();ot.RGBToHSV=Zf();ot.RGBToString=_3();ot.ValueToColor=hu();I3.exports=ot});var Fc=u((o4e,N3)=>{var T0e=4,y0e=.001,b0e=1e-7,A0e=10,Zh=11,Uc=1/(Zh-1),x0e=typeof Float32Array=="function";function O3(t,e){return 1-3*e+3*t}function D3(t,e){return 3*e-6*t}function B3(t){return 3*t}function Nc(t,e,i){return((O3(e,i)*t+D3(e,i))*t+B3(e))*t}function U3(t,e,i){return 3*O3(e,i)*t*t+2*D3(e,i)*t+B3(e)}function C0e(t,e,i,s,r){var n,a,o=0;do a=e+(i-e)/2,n=Nc(a,s,r)-t,n>0?i=a:e=a;while(Math.abs(n)>b0e&&++o<A0e);return a}function w0e(t,e,i,s){for(var r=0;r<T0e;++r){var n=U3(e,i,s);if(n===0)return e;var a=Nc(e,i,s)-t;e-=a/n}return e}function R0e(t){return t}N3.exports=function(e,i,s,r){if(!(0<=e&&e<=1&&0<=s&&s<=1))throw new Error("bezier x values must be in [0, 1] range");if(e===i&&s===r)return R0e;for(var n=x0e?new Float32Array(Zh):new Array(Zh),a=0;a<Zh;++a)n[a]=Nc(a*Uc,e,s);function o(h){for(var l=0,c=1,d=Zh-1;c!==d&&n[c]<=h;++c)l+=Uc;--c;var f=(h-n[c])/(n[c+1]-n[c]),p=l+f*Uc,m=U3(p,e,s);return m>=y0e?w0e(h,p,e,s):m===0?p:C0e(h,l,l+Uc,e,s)}return function(l){return l===0?0:l===1?1:Nc(o(l),i,r)}}});var EZ=u((wtt,SZ)=>{"use strict";SZ.exports="losewebgl"});var yZ=u((Rtt,TZ)=>{"use strict";TZ.exports="postrender"});var AZ=u((Ptt,bZ)=>{"use strict";bZ.exports="prerender"});var CZ=u((_tt,xZ)=>{"use strict";xZ.exports="render"});var RZ=u((Itt,wZ)=>{"use strict";wZ.exports="resize"});var _Z=u((Ltt,PZ)=>{"use strict";PZ.exports="restorewebgl"});var yo=u((Mtt,IZ)=>{"use strict";IZ.exports={LOSE_WEBGL:EZ(),POST_RENDER:yZ(),PRE_RENDER:AZ(),RENDER:CZ(),RESIZE:RZ(),RESTORE_WEBGL:_Z()}});var dl=u((Lit,ij)=>{"use strict";var cCe={BITMAPMASK_PIPELINE:"BitmapMaskPipeline",LIGHT_PIPELINE:"Light2D",POINTLIGHT_PIPELINE:"PointLightPipeline",SINGLE_PIPELINE:"SinglePipeline",MULTI_PIPELINE:"MultiPipeline",ROPE_PIPELINE:"RopePipeline",GRAPHICS_PIPELINE:"GraphicsPipeline",POSTFX_PIPELINE:"PostFXPipeline",UTILITY_PIPELINE:"UtilityPipeline",MOBILE_PIPELINE:"MobilePipeline",FX_PIPELINE:"FxPipeline"};ij.exports=cCe});var rj=u((Mit,sj)=>{"use strict";sj.exports=["#define SHADER_NAME PHASER_BITMAP_MASK_FS","precision mediump float;","uniform vec2 uResolution;","uniform sampler2D uMainSampler;","uniform sampler2D uMaskSampler;","uniform bool uInvertMaskAlpha;","void main ()","{","    vec2 uv = gl_FragCoord.xy / uResolution;","    vec4 mainColor = texture2D(uMainSampler, uv);","    vec4 maskColor = texture2D(uMaskSampler, uv);","    if (!uInvertMaskAlpha)","    {","        mainColor *= maskColor.a;","    }","    else","    {","        mainColor *= (1.0 - maskColor.a);","    }","    gl_FragColor = mainColor;","}"].join(`
`)});var aj=u((Oit,nj)=>{"use strict";nj.exports=["#define SHADER_NAME PHASER_BITMAP_MASK_VS","precision mediump float;","attribute vec2 inPosition;","void main ()","{","    gl_Position = vec4(inPosition, 0.0, 1.0);","}"].join(`
`)});var xo=u((Dit,oj)=>{"use strict";var dCe={BYTE:{enum:5120,size:1},UNSIGNED_BYTE:{enum:5121,size:1},SHORT:{enum:5122,size:2},UNSIGNED_SHORT:{enum:5123,size:2},INT:{enum:5124,size:4},UNSIGNED_INT:{enum:5125,size:4},FLOAT:{enum:5126,size:4}};oj.exports=dCe});var lj=u((Bit,hj)=>{"use strict";hj.exports="pipelineafterflush"});var cj=u((Uit,uj)=>{"use strict";uj.exports="pipelinebeforeflush"});var fj=u((Nit,dj)=>{"use strict";dj.exports="pipelinebind"});var mj=u((Fit,pj)=>{"use strict";pj.exports="pipelineboot"});var gj=u((kit,vj)=>{"use strict";vj.exports="pipelinedestroy"});var Ej=u((Git,Sj)=>{"use strict";Sj.exports="pipelinerebind"});var yj=u((qit,Tj)=>{"use strict";Tj.exports="pipelineresize"});var Xy=u((Wit,bj)=>{"use strict";bj.exports={AFTER_FLUSH:lj(),BEFORE_FLUSH:cj(),BIND:fj(),BOOT:mj(),DESTROY:gj(),REBIND:Ej(),RESIZE:yj()}});var fl=u((Yit,Aj)=>{"use strict";var fCe=R(),fd=yo(),pCe=new fCe({initialize:function(e,i,s,r,n,a,o,h,l){r===void 0&&(r=1),n===void 0&&(n=0),a===void 0&&(a=!0),o===void 0&&(o=!1),h===void 0&&(h=!0),l===void 0&&(l=!0),this.renderer=e,this.framebuffer=null,this.texture=null,this.width=0,this.height=0,this.scale=r,this.minFilter=n,this.autoClear=a,this.autoResize=!0,this.hasDepthBuffer=h,this.forceClamp=l,this.init(i,s),o?this.renderer.on(fd.RESIZE,this.resize,this):this.autoResize=!1},init:function(t,e){var i=this.renderer;try{this.texture=i.createTextureFromSource(null,t,e,this.minFilter,this.forceClamp),this.framebuffer=i.createFramebuffer(t,e,this.texture,this.hasDepthBuffer)}catch(s){this.texture=null,this.framebuffer=null,console.warn("Failed to init render target",s)}this.width=t,this.height=e},setAutoResize:function(t){return t&&!this.autoResize?(this.renderer.on(fd.RESIZE,this.resize,this),this.autoResize=!0):!t&&this.autoResize&&(this.renderer.off(fd.RESIZE,this.resize,this),this.autoResize=!1),this},resize:function(t,e){try{if(this.autoResize&&this.willResize(t,e)){var i=this.renderer;i.deleteFramebuffer(this.framebuffer),i.deleteTexture(this.texture),this.texture=i.createTextureFromSource(null,t,e,this.minFilter,this.forceClamp),this.framebuffer=i.createFramebuffer(t,e,this.texture,this.hasDepthBuffer),this.width=t,this.height=e}}catch(s){console.warn("Failed to resize render target",s)}finally{return this}},willResize:function(t,e){return typeof t!="number"||typeof e!="number"?!1:(t=Math.round(t*this.scale),e=Math.round(e*this.scale),t=Math.max(t,1),e=Math.max(e,1),t!==this.width||e!==this.height)},bind:function(t,e,i){t===void 0&&(t=!1);var s=this.renderer;if(t&&s.flush(),e&&i&&this.resize(e,i),s.pushFramebuffer(this.framebuffer,!1,!1),t&&this.adjustViewport(),this.autoClear){var r=this.renderer.gl;r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT)}s.clearStencilMask()},adjustViewport:function(){var t=this.renderer.gl;t.viewport(0,0,this.width,this.height),t.disable(t.SCISSOR_TEST)},clear:function(t,e,i,s){var r=this.renderer,n=r.gl;r.pushFramebuffer(this.framebuffer),t!==void 0&&e!==void 0&&i!==void 0&&s!==void 0?(n.enable(n.SCISSOR_TEST),n.scissor(t,e,i,s)):n.disable(n.SCISSOR_TEST),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),r.popFramebuffer(),r.resetScissor()},unbind:function(t){t===void 0&&(t=!1);var e=this.renderer;return t&&e.flush(),e.popFramebuffer()},destroy:function(){var t=this.renderer;t.off(fd.RESIZE,this.resize,this),t.deleteFramebuffer(this.framebuffer),t.deleteTexture(this.texture),this.renderer=null,this.framebuffer=null,this.texture=null}});Aj.exports=pCe});var Rj=u((Hit,wj)=>{"use strict";var mCe=R(),xj=Jo(),Cj=re(),vCe=xo(),gCe=new mCe({initialize:function(e,i,s,r,n){this.pipeline=e,this.name=i,this.renderer=e.renderer,this.gl=this.renderer.gl,this.fragSrc=r,this.vertSrc=s,this.program=this.renderer.createProgram(s,r),this.attributes,this.vertexComponentCount=0,this.vertexSize=0,this.uniforms={},this.createAttributes(n),this.createUniforms()},createAttributes:function(t){var e=0,i=0,s=[];this.vertexComponentCount=0;for(var r=0;r<t.length;r++){var n=t[r],a=n.name,o=Cj(n,"size",1),h=Cj(n,"type",vCe.FLOAT),l=h.enum,c=h.size,d=!!n.normalized;s.push({name:a,size:o,type:l,normalized:d,offset:i,enabled:!1,location:-1}),c===4?e+=o:e++,i+=o*c}this.vertexSize=i,this.vertexComponentCount=e,this.attributes=s},bind:function(t,e){return t===void 0&&(t=!1),e===void 0&&(e=!1),e&&this.pipeline.flush(),this.renderer.setProgram(this.program),t&&this.setAttribPointers(),this},rebind:function(){return this.renderer.setProgram(this.program),this.setAttribPointers(!0),this},setAttribPointers:function(t){t===void 0&&(t=!1);for(var e=this.gl,i=this.renderer,s=this.vertexSize,r=this.attributes,n=this.program,a=0;a<r.length;a++){var o=r[a],h=o.size,l=o.type,c=o.offset,d=o.enabled,f=o.location,p=!!o.normalized;if(t){f!==-1&&i.deleteAttribLocation(f);var m=this.renderer.createAttribLocation(n,o.name);m.webGLAttribLocation>=0?(e.enableVertexAttribArray(m.webGLAttribLocation),e.vertexAttribPointer(m.webGLAttribLocation,h,l,p,s,c),o.enabled=!0,o.location=m):m.webGLAttribLocation!==-1&&e.disableVertexAttribArray(m.webGLAttribLocation)}else d?e.vertexAttribPointer(f.webGLAttribLocation,h,l,p,s,c):!d&&f!==-1&&f.webGLAttribLocation>-1&&(e.disableVertexAttribArray(f.webGLAttribLocation),o.location=-1)}return this},createUniforms:function(){var t=this.gl,e=this.program,i=this.uniforms,s,r,n,a=t.getProgramParameter(e.webGLProgram,t.ACTIVE_UNIFORMS);for(s=0;s<a;s++){var o=t.getActiveUniform(e.webGLProgram,s);if(o){r=o.name,n=this.renderer.createUniformLocation(e,r),n!==null&&(i[r]={name:r,location:n,setter:null,value1:null,value2:null,value3:null,value4:null});var h=r.indexOf("[");h>0&&(r=r.substr(0,h),i.hasOwnProperty(r)||(n=this.renderer.createUniformLocation(e,r),n!==null&&(i[r]={name:r,location:n,setter:null,value1:null,value2:null,value3:null,value4:null})))}}return this},syncUniforms:function(){var t=this.gl;this.renderer.setProgram(this.program);for(var e in this.uniforms){var i=this.uniforms[e];i.setter&&i.setter.call(t,i.location.webGLUniformLocation,i.value1,i.value2,i.value3,i.value4)}},hasUniform:function(t){return this.uniforms.hasOwnProperty(t)},resetUniform:function(t){var e=this.uniforms[t];return e&&(e.value1=null,e.value2=null,e.value3=null,e.value4=null),this},setUniform1:function(t,e,i,s){var r=this.uniforms[e];return r?((s||r.value1!==i)&&(r.setter||(r.setter=t),r.value1=i,this.renderer.setProgram(this.program),t.call(this.gl,r.location.webGLUniformLocation,i),this.pipeline.currentShader=this),this):this},setUniform2:function(t,e,i,s,r){var n=this.uniforms[e];return n?((r||n.value1!==i||n.value2!==s)&&(n.setter||(n.setter=t),n.value1=i,n.value2=s,this.renderer.setProgram(this.program),t.call(this.gl,n.location.webGLUniformLocation,i,s),this.pipeline.currentShader=this),this):this},setUniform3:function(t,e,i,s,r,n){var a=this.uniforms[e];return a?((n||a.value1!==i||a.value2!==s||a.value3!==r)&&(a.setter||(a.setter=t),a.value1=i,a.value2=s,a.value3=r,this.renderer.setProgram(this.program),t.call(this.gl,a.location.webGLUniformLocation,i,s,r),this.pipeline.currentShader=this),this):this},setUniform4:function(t,e,i,s,r,n,a){var o=this.uniforms[e];return o?((a||o.value1!==i||o.value2!==s||o.value3!==r||o.value4!==n)&&(o.setter||(o.setter=t),o.value1=i,o.value2=s,o.value3=r,o.value4=n,this.renderer.setProgram(this.program),t.call(this.gl,o.location.webGLUniformLocation,i,s,r,n),this.pipeline.currentShader=this),this):this},setBoolean:function(t,e){return this.setUniform1(this.gl.uniform1i,t,Number(e))},set1f:function(t,e){return this.setUniform1(this.gl.uniform1f,t,e)},set2f:function(t,e,i){return this.setUniform2(this.gl.uniform2f,t,e,i)},set3f:function(t,e,i,s){return this.setUniform3(this.gl.uniform3f,t,e,i,s)},set4f:function(t,e,i,s,r){return this.setUniform4(this.gl.uniform4f,t,e,i,s,r)},set1fv:function(t,e){return this.setUniform1(this.gl.uniform1fv,t,e,!0)},set2fv:function(t,e){return this.setUniform1(this.gl.uniform2fv,t,e,!0)},set3fv:function(t,e){return this.setUniform1(this.gl.uniform3fv,t,e,!0)},set4fv:function(t,e){return this.setUniform1(this.gl.uniform4fv,t,e,!0)},set1iv:function(t,e){return this.setUniform1(this.gl.uniform1iv,t,e,!0)},set2iv:function(t,e){return this.setUniform1(this.gl.uniform2iv,t,e,!0)},set3iv:function(t,e){return this.setUniform1(this.gl.uniform3iv,t,e,!0)},set4iv:function(t,e){return this.setUniform1(this.gl.uniform4iv,t,e,!0)},set1i:function(t,e){return this.setUniform1(this.gl.uniform1i,t,e)},set2i:function(t,e,i){return this.setUniform2(this.gl.uniform2i,t,e,i)},set3i:function(t,e,i,s){return this.setUniform3(this.gl.uniform3i,t,e,i,s)},set4i:function(t,e,i,s,r){return this.setUniform4(this.gl.uniform4i,t,e,i,s,r)},setMatrix2fv:function(t,e,i){return this.setUniform2(this.gl.uniformMatrix2fv,t,e,i,!0)},setMatrix3fv:function(t,e,i){return this.setUniform2(this.gl.uniformMatrix3fv,t,e,i,!0)},setMatrix4fv:function(t,e,i){return this.setUniform2(this.gl.uniformMatrix4fv,t,e,i,!0)},createProgram:function(t,e){return t===void 0&&(t=this.vertSrc),e===void 0&&(e=this.fragSrc),this.program&&this.renderer.deleteProgram(this.program),this.vertSrc=t,this.fragSrc=e,this.program=this.renderer.createProgram(t,e),this.createUniforms(),this.rebind()},destroy:function(){var t=this.renderer;xj(this.uniforms,function(e){t.deleteUniformLocation(e.location)}),this.uniforms=null,xj(this.attributes,function(e){t.deleteAttribLocation(e.location)}),this.attributes=null,t.deleteProgram(this.program),this.pipeline=null,this.renderer=null,this.gl=null,this.program=null}});wj.exports=gCe});var Co=u((zit,Lj)=>{"use strict";var SCe=R(),Pj=iu(),_j=ze(),ta=Xy(),it=re(),ECe=Mu(),hn=yo(),Ky=fl(),pd=Ti(),Ij=Rj(),TCe=new SCe({Extends:_j,initialize:function(e){_j.call(this);var i=e.game,s=i.renderer,r=s.gl;this.name=it(e,"name","WebGLPipeline"),this.game=i,this.renderer=s,this.manager,this.gl=r,this.view=i.canvas,this.width=0,this.height=0,this.vertexCount=0,this.vertexCapacity=0,this.vertexData,this.vertexBuffer,this.activeBuffer,this.topology=it(e,"topology",r.TRIANGLES),this.bytes,this.vertexViewF32,this.vertexViewU32,this.active=!0,this.forceZero=it(e,"forceZero",!1),this.hasBooted=!1,this.isPostFX=!1,this.isPreFX=!1,this.renderTargets=[],this.currentRenderTarget,this.shaders=[],this.currentShader,this.projectionMatrix,this.projectionWidth=0,this.projectionHeight=0,this.config=e,this.glReset=!1,this.batch=[],this.currentBatch=null,this.currentTexture=null,this.currentUnit=0,this.activeTextures=[],this.resizeUniform=it(e,"resizeUniform","")},boot:function(){var t,e=this.gl,i=this.config,s=this.renderer;this.isPostFX||(this.projectionMatrix=new ECe().identity());var r=this.renderTargets,n=it(i,"renderTarget",!1);typeof n=="boolean"&&n&&(n=1);var a=s.width,o=s.height;if(typeof n=="number")for(t=0;t<n;t++)r.push(new Ky(s,a,o,1,0,!0));else if(Array.isArray(n))for(t=0;t<n.length;t++){var h=it(n[t],"scale",1),l=it(n[t],"minFilter",0),c=it(n[t],"autoClear",1),d=it(n[t],"autoResize",!1),f=it(n[t],"width",null),p=it(n[t],"height",f);f?r.push(new Ky(s,f,p,1,l,c,d)):r.push(new Ky(s,a,o,h,l,c,d))}r.length&&(this.currentRenderTarget=r[0]),this.setShadersFromConfig(i);var m=this.shaders,v=0;for(t=0;t<m.length;t++)m[t].vertexSize>v&&(v=m[t].vertexSize);var g=it(i,"batchSize",s.config.batchSize);this.vertexCapacity=g*6;var S=new ArrayBuffer(this.vertexCapacity*v);this.vertexData=S,this.bytes=new Uint8Array(S),this.vertexViewF32=new Float32Array(S),this.vertexViewU32=new Uint32Array(S);var y=it(i,"vertices",null);for(y?(this.vertexViewF32.set(y),this.vertexBuffer=s.createVertexBuffer(S,e.STATIC_DRAW)):this.vertexBuffer=s.createVertexBuffer(S.byteLength,e.DYNAMIC_DRAW),this.setVertexBuffer(),t=m.length-1;t>=0;t--)m[t].rebind();this.hasBooted=!0,s.on(hn.RESIZE,this.resize,this),s.on(hn.PRE_RENDER,this.onPreRender,this),s.on(hn.RENDER,this.onRender,this),s.on(hn.POST_RENDER,this.onPostRender,this),this.emit(ta.BOOT,this),this.onBoot()},onBoot:function(){},onResize:function(){},setShader:function(t,e,i){var s=this.renderer;if(t!==this.currentShader||s.currentProgram!==this.currentShader.program){this.flush();var r=this.setVertexBuffer(i);r&&!e&&(e=!0),t.bind(e,!1),this.currentShader=t}return this},getShaderByName:function(t){for(var e=this.shaders,i=0;i<e.length;i++)if(e[i].name===t)return e[i]},setShadersFromConfig:function(t){var e,i=this.shaders,s=this.renderer;for(e=0;e<i.length;e++)i[e].destroy();var r="vertShader",n="fragShader",a="attributes",o=it(t,r,null),h=pd.parseFragmentShaderMaxTextures(it(t,n,null),s.maxTextures),l=it(t,a,null),c=it(t,"shaders",[]),d=c.length;if(d===0)o&&h&&(this.shaders=[new Ij(this,"default",o,h,Pj(l))]);else{var f=[];for(e=0;e<d;e++){var p=c[e],m,v,g,S;if(typeof p=="string"?(m="default",v=o,g=pd.parseFragmentShaderMaxTextures(p,s.maxTextures),S=l):(m=it(p,"name","default"),v=it(p,r,o),g=pd.parseFragmentShaderMaxTextures(it(p,n,h),s.maxTextures),S=it(p,a,l)),m==="default"){var y=g.split(`
`),b=y[0].trim();b.indexOf("#define SHADER_NAME")>-1&&(m=b.substring(20))}v&&g&&f.push(new Ij(this,m,v,g,Pj(S)))}this.shaders=f}return this.shaders.length===0?console.warn("Pipeline: "+this.name+" - Invalid shader config"):this.currentShader=this.shaders[0],this},createBatch:function(t){return this.currentBatch={start:this.vertexCount,count:0,texture:[t],unit:0,maxUnit:0},this.currentUnit=0,this.currentTexture=t,this.batch.push(this.currentBatch),0},addTextureToBatch:function(t){var e=this.currentBatch;e&&(e.texture.push(t),e.unit++,e.maxUnit++)},pushBatch:function(t){if(!this.currentBatch||this.forceZero&&t!==this.currentTexture)return this.createBatch(t);if(t===this.currentTexture)return this.currentUnit;var e=this.currentBatch,i=e.texture.indexOf(t);return i===-1?e.texture.length===this.renderer.maxTextures?this.createBatch(t):(e.unit++,e.maxUnit++,e.texture.push(t),this.currentUnit=e.unit,this.currentTexture=t,e.unit):(this.currentUnit=i,this.currentTexture=t,i)},setGameObject:function(t,e){return e===void 0&&(e=t.frame),this.pushBatch(e.source.glTexture)},shouldFlush:function(t){return t===void 0&&(t=0),this.vertexCount+t>this.vertexCapacity},vertexAvailable:function(){return this.vertexCapacity-this.vertexCount},resize:function(t,e){(t!==this.width||e!==this.height)&&this.flush(),this.width=t,this.height=e;for(var i=this.renderTargets,s=0;s<i.length;s++)i[s].resize(t,e);return this.setProjectionMatrix(t,e),this.resizeUniform&&this.set2f(this.resizeUniform,t,e),this.emit(ta.RESIZE,t,e,this),this.onResize(t,e),this},setProjectionMatrix:function(t,e){var i=this.projectionMatrix;if(!i)return this;this.projectionWidth=t,this.projectionHeight=e,i.ortho(0,t,e,0,-1e3,1e3);for(var s=this.shaders,r="uProjectionMatrix",n=0;n<s.length;n++){var a=s[n];a.hasUniform(r)&&(a.resetUniform(r),a.setMatrix4fv(r,!1,i.val,a))}return this},flipProjectionMatrix:function(t){t===void 0&&(t=!0);var e=this.projectionMatrix;if(!e)return this;var i=this.projectionWidth,s=this.projectionHeight;t?e.ortho(0,i,0,s,-1e3,1e3):e.ortho(0,i,s,0,-1e3,1e3),this.setMatrix4fv("uProjectionMatrix",!1,e.val)},updateProjectionMatrix:function(){if(this.projectionMatrix){var t=this.renderer.projectionWidth,e=this.renderer.projectionHeight;(this.projectionWidth!==t||this.projectionHeight!==e)&&this.setProjectionMatrix(t,e)}},bind:function(t){if(t===void 0&&(t=this.currentShader),this.glReset)return this.rebind(t);var e=!1,i=this.gl;return i.getParameter(i.ARRAY_BUFFER_BINDING)!==this.vertexBuffer&&(i.bindBuffer(i.ARRAY_BUFFER,this.vertexBuffer.webGLBuffer),this.activeBuffer=this.vertexBuffer,e=!0),t.bind(e),this.currentShader=t,this.activeTextures.length=0,this.emit(ta.BIND,this,t),this.onActive(t),this},rebind:function(t){this.activeBuffer=null,this.setVertexBuffer();for(var e=this.shaders,i=e.length-1;i>=0;i--){var s=e[i].rebind();(!t||s===t)&&(this.currentShader=s)}return this.activeTextures.length=0,this.emit(ta.REBIND,this.currentShader),this.onActive(this.currentShader),this.onRebind(),this.glReset=!1,this},restoreContext:function(){var t=this.shaders,e=!!this.vertexBuffer;this.activeBuffer=null,this.activeTextures.length=0,this.batch.length=0,this.currentBatch=null,this.currentTexture=null,this.currentUnit=0,e&&this.setVertexBuffer();for(var i=0;i<t.length;i++){var s=t[i];s.syncUniforms(),e&&s.rebind()}},setVertexBuffer:function(t){if(t===void 0&&(t=this.vertexBuffer),t!==this.activeBuffer){var e=this.gl;return this.gl.bindBuffer(e.ARRAY_BUFFER,t.webGLBuffer),this.activeBuffer=t,!0}return!1},preBatch:function(t){return this.currentRenderTarget&&this.currentRenderTarget.bind(),this.onPreBatch(t),this},postBatch:function(t){return this.onDraw(this.currentRenderTarget),this.onPostBatch(t),this},onDraw:function(){},unbind:function(){this.currentRenderTarget&&this.currentRenderTarget.unbind()},flush:function(t){if(t===void 0&&(t=!1),this.vertexCount>0){this.emit(ta.BEFORE_FLUSH,this,t),this.onBeforeFlush(t);var e=this.gl,i=this.vertexCount,s=this.currentShader.vertexSize,r=this.topology;if(this.active){this.setVertexBuffer(),i===this.vertexCapacity?e.bufferData(e.ARRAY_BUFFER,this.vertexData,e.DYNAMIC_DRAW):e.bufferSubData(e.ARRAY_BUFFER,0,this.bytes.subarray(0,i*s));var n,a,o,h=this.batch,l=this.activeTextures;if(this.forceZero)for(l[0]||e.activeTexture(e.TEXTURE0),n=0;n<h.length;n++)a=h[n],o=a.texture[0],l[0]!==o&&(e.bindTexture(e.TEXTURE_2D,o.webGLTexture),l[0]=o),e.drawArrays(r,a.start,a.count);else for(n=0;n<h.length;n++){a=h[n];for(var c=0;c<=a.maxUnit;c++)o=a.texture[c],l[c]!==o&&(e.activeTexture(e.TEXTURE0+c),e.bindTexture(e.TEXTURE_2D,o.webGLTexture),l[c]=o);e.drawArrays(r,a.start,a.count)}}this.vertexCount=0,this.batch.length=0,this.currentBatch=null,this.currentTexture=null,this.currentUnit=0,this.emit(ta.AFTER_FLUSH,this,t),this.onAfterFlush(t)}return this},onActive:function(){},onBind:function(){},onRebind:function(){},onBatch:function(){},onPreBatch:function(){},onPostBatch:function(){},onPreRender:function(){},onRender:function(){},onPostRender:function(){},onBeforeFlush:function(){},onAfterFlush:function(){},batchVert:function(t,e,i,s,r,n,a){var o=this.vertexViewF32,h=this.vertexViewU32,l=this.vertexCount*this.currentShader.vertexComponentCount-1;o[++l]=t,o[++l]=e,o[++l]=i,o[++l]=s,o[++l]=r,o[++l]=n,h[++l]=a,this.vertexCount++,this.currentBatch.count=this.vertexCount-this.currentBatch.start},batchQuad:function(t,e,i,s,r,n,a,o,h,l,c,d,f,p,m,v,g,S,y,b){b===void 0&&(b=this.currentUnit);var x=!1;this.shouldFlush(6)&&(this.flush(),x=!0),this.currentBatch||(b=this.setTexture2D(y));var A=this.vertexViewF32,w=this.vertexViewU32,C=this.vertexCount*this.currentShader.vertexComponentCount-1;return A[++C]=e,A[++C]=i,A[++C]=l,A[++C]=c,A[++C]=b,A[++C]=S,w[++C]=p,A[++C]=s,A[++C]=r,A[++C]=l,A[++C]=f,A[++C]=b,A[++C]=S,w[++C]=v,A[++C]=n,A[++C]=a,A[++C]=d,A[++C]=f,A[++C]=b,A[++C]=S,w[++C]=g,A[++C]=e,A[++C]=i,A[++C]=l,A[++C]=c,A[++C]=b,A[++C]=S,w[++C]=p,A[++C]=n,A[++C]=a,A[++C]=d,A[++C]=f,A[++C]=b,A[++C]=S,w[++C]=g,A[++C]=o,A[++C]=h,A[++C]=d,A[++C]=c,A[++C]=b,A[++C]=S,w[++C]=m,this.vertexCount+=6,this.currentBatch.count=this.vertexCount-this.currentBatch.start,this.onBatch(t),x},batchTri:function(t,e,i,s,r,n,a,o,h,l,c,d,f,p,m,v,g){g===void 0&&(g=this.currentUnit);var S=!1;this.shouldFlush(3)&&(this.flush(),S=!0),this.currentBatch||(g=this.setTexture2D(v));var y=this.vertexViewF32,b=this.vertexViewU32,x=this.vertexCount*this.currentShader.vertexComponentCount-1;return y[++x]=e,y[++x]=i,y[++x]=o,y[++x]=h,y[++x]=g,y[++x]=m,b[++x]=d,y[++x]=s,y[++x]=r,y[++x]=o,y[++x]=c,y[++x]=g,y[++x]=m,b[++x]=f,y[++x]=n,y[++x]=a,y[++x]=l,y[++x]=c,y[++x]=g,y[++x]=m,b[++x]=p,this.vertexCount+=3,this.currentBatch.count=this.vertexCount-this.currentBatch.start,this.onBatch(t),S},drawFillRect:function(t,e,i,s,r,n,a,o){a===void 0&&(a=this.renderer.whiteTexture),o===void 0&&(o=!0),t=Math.floor(t),e=Math.floor(e);var h=Math.floor(t+i),l=Math.floor(e+s),c=this.setTexture2D(a),d=pd.getTintAppendFloatAlphaAndSwap(r,n),f=0,p=0,m=1,v=1;o&&(p=1,v=0),this.batchQuad(null,t,e,t,l,h,l,h,e,f,p,m,v,d,d,d,d,0,a,c)},setTexture2D:function(t){return t===void 0&&(t=this.renderer.whiteTexture),this.pushBatch(t)},bindTexture:function(t,e){e===void 0&&(e=0);var i=this.gl;return i.activeTexture(i.TEXTURE0+e),i.bindTexture(i.TEXTURE_2D,t.webGLTexture),this},bindRenderTarget:function(t,e){return this.bindTexture(t.texture,e)},setTime:function(t,e){return this.set1f(t,this.game.loop.getDuration(),e),this},setBoolean:function(t,e,i){return i===void 0&&(i=this.currentShader),i.setBoolean(t,e),this},set1f:function(t,e,i){return i===void 0&&(i=this.currentShader),i.set1f(t,e),this},set2f:function(t,e,i,s){return s===void 0&&(s=this.currentShader),s.set2f(t,e,i),this},set3f:function(t,e,i,s,r){return r===void 0&&(r=this.currentShader),r.set3f(t,e,i,s),this},set4f:function(t,e,i,s,r,n){return n===void 0&&(n=this.currentShader),n.set4f(t,e,i,s,r),this},set1fv:function(t,e,i){return i===void 0&&(i=this.currentShader),i.set1fv(t,e),this},set2fv:function(t,e,i){return i===void 0&&(i=this.currentShader),i.set2fv(t,e),this},set3fv:function(t,e,i){return i===void 0&&(i=this.currentShader),i.set3fv(t,e),this},set4fv:function(t,e,i){return i===void 0&&(i=this.currentShader),i.set4fv(t,e),this},set1iv:function(t,e,i){return i===void 0&&(i=this.currentShader),i.set1iv(t,e),this},set2iv:function(t,e,i){return i===void 0&&(i=this.currentShader),i.set2iv(t,e),this},set3iv:function(t,e,i){return i===void 0&&(i=this.currentShader),i.set3iv(t,e),this},set4iv:function(t,e,i){return i===void 0&&(i=this.currentShader),i.set4iv(t,e),this},set1i:function(t,e,i){return i===void 0&&(i=this.currentShader),i.set1i(t,e),this},set2i:function(t,e,i,s){return s===void 0&&(s=this.currentShader),s.set2i(t,e,i),this},set3i:function(t,e,i,s,r){return r===void 0&&(r=this.currentShader),r.set3i(t,e,i,s),this},set4i:function(t,e,i,s,r,n){return n===void 0&&(n=this.currentShader),n.set4i(t,e,i,s,r),this},setMatrix2fv:function(t,e,i,s){return s===void 0&&(s=this.currentShader),s.setMatrix2fv(t,e,i),this},setMatrix3fv:function(t,e,i,s){return s===void 0&&(s=this.currentShader),s.setMatrix3fv(t,e,i),this},setMatrix4fv:function(t,e,i,s){return s===void 0&&(s=this.currentShader),s.setMatrix4fv(t,e,i),this},destroy:function(){this.emit(ta.DESTROY,this);var t,e=this.shaders;for(t=0;t<e.length;t++)e[t].destroy();var i=this.renderTargets;for(t=0;t<i.length;t++)i[t].destroy();var s=this.renderer;return s.deleteBuffer(this.vertexBuffer),s.off(hn.RESIZE,this.resize,this),s.off(hn.PRE_RENDER,this.onPreRender,this),s.off(hn.RENDER,this.onRender,this),s.off(hn.POST_RENDER,this.onPostRender,this),this.removeAllListeners(),this.game=null,this.renderer=null,this.manager=null,this.gl=null,this.view=null,this.shaders=null,this.renderTargets=null,this.bytes=null,this.vertexViewF32=null,this.vertexViewU32=null,this.vertexData=null,this.vertexBuffer=null,this.currentShader=null,this.currentRenderTarget=null,this.activeTextures=null,this}});Lj.exports=TCe});var Zy=u((Vit,Mj)=>{"use strict";var yCe=R(),pl=re(),bCe=rj(),ACe=aj(),xCe=xo(),md=Co(),CCe=new yCe({Extends:md,initialize:function(e){e.fragShader=pl(e,"fragShader",bCe),e.vertShader=pl(e,"vertShader",ACe),e.batchSize=pl(e,"batchSize",1),e.vertices=pl(e,"vertices",[-1,1,-1,-7,7,1]),e.attributes=pl(e,"attributes",[{name:"inPosition",size:2,type:xCe.FLOAT}]),md.call(this,e)},boot:function(){md.prototype.boot.call(this),this.set1i("uMainSampler",0),this.set1i("uMaskSampler",1)},resize:function(t,e){md.prototype.resize.call(this,t,e),this.set2f("uResolution",t,e)},beginMask:function(t,e,i){this.renderer.beginBitmapMask(t,i)},endMask:function(t,e,i){var s=this.gl,r=this.renderer,n=t.bitmapMask;n&&s&&(r.drawBitmapMask(n,e,this),i&&this.set2f("uResolution",i.width,i.height),this.set1i("uInvertMaskAlpha",t.invertAlpha),s.drawArrays(this.topology,0,3),i&&this.set2f("uResolution",this.width,this.height),s.bindTexture(s.TEXTURE_2D,null))}});Mj.exports=CCe});var Fj=u((Xit,Nj)=>{"use strict";function Qy(t,e,i){i=i||2;var s=e&&e.length,r=s?e[0]*i:t.length,n=Dj(t,0,r,i,!0),a=[];if(!n||n.next===n.prev)return a;var o,h,l,c,d,f,p;if(s&&(n=ICe(t,e,n,i)),t.length>80*i){o=l=t[0],h=c=t[1];for(var m=i;m<r;m+=i)d=t[m],f=t[m+1],d<o&&(o=d),f<h&&(h=f),d>l&&(l=d),f>c&&(c=f);p=Math.max(l-o,c-h),p=p!==0?32767/p:0}return ml(n,a,i,o,h,p,0),a}function Dj(t,e,i,s,r){var n,a;if(r===Jy(t,e,i,s)>0)for(n=e;n<i;n+=s)a=Oj(n,t[n],t[n+1],a);else for(n=i-s;n>=e;n-=s)a=Oj(n,t[n],t[n+1],a);return a&&Sd(a,a.next)&&(gl(a),a=a.next),a}function ia(t,e){if(!t)return t;e||(e=t);var i=t,s;do if(s=!1,!i.steiner&&(Sd(i,i.next)||Ve(i.prev,i,i.next)===0)){if(gl(i),i=e=i.prev,i===i.next)break;s=!0}else i=i.next;while(s||i!==e);return e}function ml(t,e,i,s,r,n,a){if(t){!a&&n&&BCe(t,s,r,n);for(var o=t,h,l;t.prev!==t.next;){if(h=t.prev,l=t.next,n?RCe(t,s,r,n):wCe(t)){e.push(h.i/i|0),e.push(t.i/i|0),e.push(l.i/i|0),gl(t),t=l.next,o=l.next;continue}if(t=l,t===o){a?a===1?(t=PCe(ia(t),e,i),ml(t,e,i,s,r,n,2)):a===2&&_Ce(t,e,i,s,r,n):ml(ia(t),e,i,s,r,n,1);break}}}}function wCe(t){var e=t.prev,i=t,s=t.next;if(Ve(e,i,s)>=0)return!1;for(var r=e.x,n=i.x,a=s.x,o=e.y,h=i.y,l=s.y,c=r<n?r<a?r:a:n<a?n:a,d=o<h?o<l?o:l:h<l?h:l,f=r>n?r>a?r:a:n>a?n:a,p=o>h?o>l?o:l:h>l?h:l,m=s.next;m!==e;){if(m.x>=c&&m.x<=f&&m.y>=d&&m.y<=p&&wo(r,o,n,h,a,l,m.x,m.y)&&Ve(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function RCe(t,e,i,s){var r=t.prev,n=t,a=t.next;if(Ve(r,n,a)>=0)return!1;for(var o=r.x,h=n.x,l=a.x,c=r.y,d=n.y,f=a.y,p=o<h?o<l?o:l:h<l?h:l,m=c<d?c<f?c:f:d<f?d:f,v=o>h?o>l?o:l:h>l?h:l,g=c>d?c>f?c:f:d>f?d:f,S=jy(p,m,e,i,s),y=jy(v,g,e,i,s),b=t.prevZ,x=t.nextZ;b&&b.z>=S&&x&&x.z<=y;){if(b.x>=p&&b.x<=v&&b.y>=m&&b.y<=g&&b!==r&&b!==a&&wo(o,c,h,d,l,f,b.x,b.y)&&Ve(b.prev,b,b.next)>=0||(b=b.prevZ,x.x>=p&&x.x<=v&&x.y>=m&&x.y<=g&&x!==r&&x!==a&&wo(o,c,h,d,l,f,x.x,x.y)&&Ve(x.prev,x,x.next)>=0))return!1;x=x.nextZ}for(;b&&b.z>=S;){if(b.x>=p&&b.x<=v&&b.y>=m&&b.y<=g&&b!==r&&b!==a&&wo(o,c,h,d,l,f,b.x,b.y)&&Ve(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;x&&x.z<=y;){if(x.x>=p&&x.x<=v&&x.y>=m&&x.y<=g&&x!==r&&x!==a&&wo(o,c,h,d,l,f,x.x,x.y)&&Ve(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function PCe(t,e,i){var s=t;do{var r=s.prev,n=s.next.next;!Sd(r,n)&&Bj(r,s,s.next,n)&&vl(r,n)&&vl(n,r)&&(e.push(r.i/i|0),e.push(s.i/i|0),e.push(n.i/i|0),gl(s),gl(s.next),s=t=n),s=s.next}while(s!==t);return ia(s)}function _Ce(t,e,i,s,r,n){var a=t;do{for(var o=a.next.next;o!==a.prev;){if(a.i!==o.i&&FCe(a,o)){var h=Uj(a,o);a=ia(a,a.next),h=ia(h,h.next),ml(a,e,i,s,r,n,0),ml(h,e,i,s,r,n,0);return}o=o.next}a=a.next}while(a!==t)}function ICe(t,e,i,s){var r=[],n,a,o,h,l;for(n=0,a=e.length;n<a;n++)o=e[n]*s,h=n<a-1?e[n+1]*s:t.length,l=Dj(t,o,h,s,!1),l===l.next&&(l.steiner=!0),r.push(NCe(l));for(r.sort(LCe),n=0;n<r.length;n++)i=MCe(r[n],i);return i}function LCe(t,e){return t.x-e.x}function MCe(t,e){var i=OCe(t,e);if(!i)return e;var s=Uj(i,t);return ia(s,s.next),ia(i,i.next)}function OCe(t,e){var i=e,s=t.x,r=t.y,n=-1/0,a;do{if(r<=i.y&&r>=i.next.y&&i.next.y!==i.y){var o=i.x+(r-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(o<=s&&o>n&&(n=o,a=i.x<i.next.x?i:i.next,o===s))return a}i=i.next}while(i!==e);if(!a)return null;var h=a,l=a.x,c=a.y,d=1/0,f;i=a;do s>=i.x&&i.x>=l&&s!==i.x&&wo(r<c?s:n,r,l,c,r<c?n:s,r,i.x,i.y)&&(f=Math.abs(r-i.y)/(s-i.x),vl(i,t)&&(f<d||f===d&&(i.x>a.x||i.x===a.x&&DCe(a,i)))&&(a=i,d=f)),i=i.next;while(i!==h);return a}function DCe(t,e){return Ve(t.prev,t,e.prev)<0&&Ve(e.next,t,t.next)<0}function BCe(t,e,i,s){var r=t;do r.z===0&&(r.z=jy(r.x,r.y,e,i,s)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,UCe(r)}function UCe(t){var e,i,s,r,n,a,o,h,l=1;do{for(i=t,t=null,n=null,a=0;i;){for(a++,s=i,o=0,e=0;e<l&&(o++,s=s.nextZ,!!s);e++);for(h=l;o>0||h>0&&s;)o!==0&&(h===0||!s||i.z<=s.z)?(r=i,i=i.nextZ,o--):(r=s,s=s.nextZ,h--),n?n.nextZ=r:t=r,r.prevZ=n,n=r;i=s}n.nextZ=null,l*=2}while(a>1);return t}function jy(t,e,i,s,r){return t=(t-i)*r|0,e=(e-s)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function NCe(t){var e=t,i=t;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==t);return i}function wo(t,e,i,s,r,n,a,o){return(r-a)*(e-o)>=(t-a)*(n-o)&&(t-a)*(s-o)>=(i-a)*(e-o)&&(i-a)*(n-o)>=(r-a)*(s-o)}function FCe(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!kCe(t,e)&&(vl(t,e)&&vl(e,t)&&GCe(t,e)&&(Ve(t.prev,t,e.prev)||Ve(t,e.prev,e))||Sd(t,e)&&Ve(t.prev,t,t.next)>0&&Ve(e.prev,e,e.next)>0)}function Ve(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function Sd(t,e){return t.x===e.x&&t.y===e.y}function Bj(t,e,i,s){var r=gd(Ve(t,e,i)),n=gd(Ve(t,e,s)),a=gd(Ve(i,s,t)),o=gd(Ve(i,s,e));return!!(r!==n&&a!==o||r===0&&vd(t,i,e)||n===0&&vd(t,s,e)||a===0&&vd(i,t,s)||o===0&&vd(i,e,s))}function vd(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function gd(t){return t>0?1:t<0?-1:0}function kCe(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&Bj(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}function vl(t,e){return Ve(t.prev,t,t.next)<0?Ve(t,e,t.next)>=0&&Ve(t,t.prev,e)>=0:Ve(t,e,t.prev)<0||Ve(t,t.next,e)<0}function GCe(t,e){var i=t,s=!1,r=(t.x+e.x)/2,n=(t.y+e.y)/2;do i.y>n!=i.next.y>n&&i.next.y!==i.y&&r<(i.next.x-i.x)*(n-i.y)/(i.next.y-i.y)+i.x&&(s=!s),i=i.next;while(i!==t);return s}function Uj(t,e){var i=new $y(t.i,t.x,t.y),s=new $y(e.i,e.x,e.y),r=t.next,n=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,s.next=i,i.prev=s,n.next=s,s.prev=n,s}function Oj(t,e,i,s){var r=new $y(t,e,i);return s?(r.next=s.next,r.prev=s,s.next.prev=r,s.next=r):(r.prev=r,r.next=r),r}function gl(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function $y(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Qy.deviation=function(t,e,i,s){var r=e&&e.length,n=r?e[0]*i:t.length,a=Math.abs(Jy(t,0,n,i));if(r)for(var o=0,h=e.length;o<h;o++){var l=e[o]*i,c=o<h-1?e[o+1]*i:t.length;a-=Math.abs(Jy(t,l,c,i))}var d=0;for(o=0;o<s.length;o+=3){var f=s[o]*i,p=s[o+1]*i,m=s[o+2]*i;d+=Math.abs((t[f]-t[m])*(t[p+1]-t[f+1])-(t[f]-t[p])*(t[m+1]-t[f+1]))}return a===0&&d===0?0:Math.abs((d-a)/a)};function Jy(t,e,i,s){for(var r=0,n=e,a=i-s;n<i;n+=s)r+=(t[a]-t[n])*(t[n+1]+t[a+1]),a=n;return r}Qy.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},s=0,r=0;r<t.length;r++){for(var n=0;n<t[r].length;n++)for(var a=0;a<e;a++)i.vertices.push(t[r][n][a]);r>0&&(s+=t[r-1].length,i.holes.push(s))}return i};Nj.exports=Qy});var Gj=u((Kit,kj)=>{"use strict";kj.exports=["#define SHADER_NAME PHASER_MULTI_FS","#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","uniform sampler2D uMainSampler[%count%];","varying vec2 outTexCoord;","varying float outTexId;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    vec4 texture;","    %forloop%","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","    vec4 color = texture * texel;","    if (outTintEffect == 1.0)","    {","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        color = texel;","    }","    gl_FragColor = color;","}"].join(`
`)});var Wj=u((Zit,qj)=>{"use strict";qj.exports=["#define SHADER_NAME PHASER_MULTI_VS","precision mediump float;","uniform mat4 uProjectionMatrix;","uniform vec2 uResolution;","attribute vec2 inPosition;","attribute vec2 inTexCoord;","attribute float inTexId;","attribute float inTintEffect;","attribute vec4 inTint;","varying vec2 outTexCoord;","varying float outTexId;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","    outTexCoord = inTexCoord;","    outTexId = inTexId;","    outTint = inTint;","    outTintEffect = inTintEffect;","}"].join(`
`)});var Sl=u((jit,Yj)=>{"use strict";var qCe=R(),WCe=Fj(),eb=re(),YCe=Gj(),HCe=Wj(),Ed=ws(),tb=Ti(),zCe=xo(),Td=Co(),VCe=new qCe({Extends:Td,initialize:function(e){var i=e.game.renderer,s=eb(e,"fragShader",YCe);e.fragShader=tb.parseFragmentShaderMaxTextures(s,i.maxTextures),e.vertShader=eb(e,"vertShader",HCe),e.attributes=eb(e,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2},{name:"inTexId"},{name:"inTintEffect"},{name:"inTint",size:4,type:zCe.UNSIGNED_BYTE,normalized:!0}]),e.resizeUniform="uResolution",Td.call(this,e),this._tempMatrix1=new Ed,this._tempMatrix2=new Ed,this._tempMatrix3=new Ed,this.calcMatrix=new Ed,this.tempTriangle=[{x:0,y:0,width:0},{x:0,y:0,width:0},{x:0,y:0,width:0},{x:0,y:0,width:0}],this.strokeTint={TL:0,TR:0,BL:0,BR:0},this.fillTint={TL:0,TR:0,BL:0,BR:0},this.currentFrame={u0:0,v0:0,u1:1,v1:1},this.firstQuad=[0,0,0,0,0],this.prevQuad=[0,0,0,0,0],this.polygonCache=[]},boot:function(){Td.prototype.boot.call(this);var t=this.renderer;this.set1iv("uMainSampler",t.textureIndexes),this.set2f("uResolution",t.width,t.height)},batchSprite:function(t,e,i){this.manager.set(this,t);var s=this._tempMatrix1,r=this._tempMatrix2,n=this._tempMatrix3,a=t.frame,o=a.glTexture,h=a.u0,l=a.v0,c=a.u1,d=a.v1,f=a.x,p=a.y,m=a.cutWidth,v=a.cutHeight,g=a.customPivot,S=t.displayOriginX,y=t.displayOriginY,b=-S+f,x=-y+p;if(t.isCropped){var A=t._crop;(A.flipX!==t.flipX||A.flipY!==t.flipY)&&a.updateCropUVs(A,t.flipX,t.flipY),h=A.u0,l=A.v0,c=A.u1,d=A.v1,m=A.width,v=A.height,f=A.x,p=A.y,b=-S+f,x=-y+p}var w=1,C=1;t.flipX&&(g||(b+=-a.realWidth+S*2),w=-1),t.flipY&&(g||(x+=-a.realHeight+y*2),C=-1);var _=t.x,N=t.y;e.roundPixels&&(_=Math.floor(_),N=Math.floor(N)),r.applyITRS(_,N,t.rotation,t.scaleX*w,t.scaleY*C),s.copyFrom(e.matrix),i?(s.multiplyWithOffset(i,-e.scrollX*t.scrollFactorX,-e.scrollY*t.scrollFactorY),r.e=_,r.f=N):(r.e-=e.scrollX*t.scrollFactorX,r.f-=e.scrollY*t.scrollFactorY),s.multiply(r,n);var D=n.setQuad(b,x,b+m,x+v,e.renderRoundPixels),Y=tb.getTintAppendFloatAlpha,$=e.alpha,j=Y(t.tintTopLeft,$*t._alphaTL),G=Y(t.tintTopRight,$*t._alphaTR),Z=Y(t.tintBottomLeft,$*t._alphaBL),ee=Y(t.tintBottomRight,$*t._alphaBR);this.shouldFlush(6)&&this.flush();var te=this.setGameObject(t,a);this.manager.preBatch(t),this.batchQuad(t,D[0],D[1],D[2],D[3],D[4],D[5],D[6],D[7],h,l,c,d,j,G,Z,ee,t.tintFill,o,te),this.manager.postBatch(t)},batchTexture:function(t,e,i,s,r,n,a,o,h,l,c,d,f,p,m,v,g,S,y,b,x,A,w,C,_,N,D,Y,$,j,G,Z,ee){ee===void 0&&(ee=!1),this.manager.set(this,t);var te=this._tempMatrix1,Q=this._tempMatrix2,Ae=this._tempMatrix3,gt=S/i+D,St=y/s+Y,rt=(S+b)/i+D,Et=(y+x)/s+Y,Ee=a,ut=o,Ca=-v,kl=-g;if(t.isCropped){var wa=t._crop,Gl=wa.width,ql=wa.height;Ee=Gl,ut=ql,a=Gl,o=ql,S=wa.x,y=wa.y;var vf=S,gf=y;d&&(vf=b-wa.x-Gl),f&&(gf=x-wa.y-ql),gt=vf/i+D,St=gf/s+Y,rt=(vf+Gl)/i+D,Et=(gf+ql)/s+Y,Ca=-v+S,kl=-g+y}f=f^(!G&&e.isRenderTexture?1:0),d&&(Ee*=-1,Ca+=a),f&&(ut*=-1,kl+=o),$.roundPixels&&(r=Math.floor(r),n=Math.floor(n)),Q.applyITRS(r,n,c,h,l),te.copyFrom($.matrix),j?(te.multiplyWithOffset(j,-$.scrollX*p,-$.scrollY*m),Q.e=r,Q.f=n):(Q.e-=$.scrollX*p,Q.f-=$.scrollY*m),te.multiply(Q,Ae);var Lr=Ae.setQuad(Ca,kl,Ca+Ee,kl+ut,$.renderRoundPixels);Z==null&&(Z=this.setTexture2D(e)),t&&!ee&&this.manager.preBatch(t),this.batchQuad(t,Lr[0],Lr[1],Lr[2],Lr[3],Lr[4],Lr[5],Lr[6],Lr[7],gt,St,rt,Et,A,w,C,_,N,e,Z),t&&!ee&&this.manager.postBatch(t)},batchTextureFrame:function(t,e,i,s,r,n,a){this.manager.set(this);var o=this._tempMatrix1.copyFrom(n),h=this._tempMatrix2;a?o.multiply(a,h):h=o;var l=h.setQuad(e,i,e+t.width,i+t.height),c=this.setTexture2D(t.source.glTexture);s=tb.getTintAppendFloatAlpha(s,r),this.batchQuad(null,l[0],l[1],l[2],l[3],l[4],l[5],l[6],l[7],t.u0,t.v0,t.u1,t.v1,s,s,s,s,0,t.glTexture,c)},batchFillRect:function(t,e,i,s,r,n){this.renderer.pipelines.set(this);var a=this.calcMatrix;n&&n.multiply(r,a);var o=a.setQuad(t,e,t+i,e+s),h=this.fillTint;this.batchQuad(null,o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],0,0,1,1,h.TL,h.TR,h.BL,h.BR,2)},batchFillTriangle:function(t,e,i,s,r,n,a,o){this.renderer.pipelines.set(this);var h=this.calcMatrix;o&&o.multiply(a,h);var l=h.getX(t,e),c=h.getY(t,e),d=h.getX(i,s),f=h.getY(i,s),p=h.getX(r,n),m=h.getY(r,n),v=this.fillTint;this.batchTri(null,l,c,d,f,p,m,0,0,1,1,v.TL,v.TR,v.BL,2)},batchStrokeTriangle:function(t,e,i,s,r,n,a,o,h){var l=this.tempTriangle;l[0].x=t,l[0].y=e,l[0].width=a,l[1].x=i,l[1].y=s,l[1].width=a,l[2].x=r,l[2].y=n,l[2].width=a,l[3].x=t,l[3].y=e,l[3].width=a,this.batchStrokePath(l,a,!1,o,h)},batchFillPath:function(t,e,i){this.renderer.pipelines.set(this);var s=this.calcMatrix;i&&i.multiply(e,s);for(var r=t.length,n=this.polygonCache,a,o,h=this.fillTint.TL,l=this.fillTint.TR,c=this.fillTint.BL,d=0;d<r;++d)o=t[d],n.push(o.x,o.y);a=WCe(n),r=a.length;for(var f=0;f<r;f+=3){var p=a[f+0]*2,m=a[f+1]*2,v=a[f+2]*2,g=n[p+0],S=n[p+1],y=n[m+0],b=n[m+1],x=n[v+0],A=n[v+1],w=s.getX(g,S),C=s.getY(g,S),_=s.getX(y,b),N=s.getY(y,b),D=s.getX(x,A),Y=s.getY(x,A);this.batchTri(null,w,C,_,N,D,Y,0,0,1,1,h,l,c,2)}n.length=0},batchStrokePath:function(t,e,i,s,r){this.renderer.pipelines.set(this),this.prevQuad[4]=0,this.firstQuad[4]=0;for(var n=t.length-1,a=0;a<n;a++){var o=t[a],h=t[a+1];this.batchLine(o.x,o.y,h.x,h.y,o.width/2,h.width/2,e,a,!i&&a===n-1,s,r)}},batchLine:function(t,e,i,s,r,n,a,o,h,l,c){this.renderer.pipelines.set(this);var d=this.calcMatrix;c&&c.multiply(l,d);var f=i-t,p=s-e,m=Math.sqrt(f*f+p*p);if(m!==0){var v=r*(s-e)/m,g=r*(t-i)/m,S=n*(s-e)/m,y=n*(t-i)/m,b=i-S,x=s-y,A=t-v,w=e-g,C=i+S,_=s+y,N=t+v,D=e+g,Y=d.getX(b,x),$=d.getY(b,x),j=d.getX(A,w),G=d.getY(A,w),Z=d.getX(C,_),ee=d.getY(C,_),te=d.getX(N,D),Q=d.getY(N,D),Ae=this.strokeTint,gt=Ae.TL,St=Ae.TR,rt=Ae.BL,Et=Ae.BR;if(this.batchQuad(null,te,Q,j,G,Y,$,Z,ee,0,0,1,1,gt,St,rt,Et,2),!(a<=2)){var Ee=this.prevQuad,ut=this.firstQuad;o>0&&Ee[4]?this.batchQuad(null,te,Q,j,G,Ee[0],Ee[1],Ee[2],Ee[3],0,0,1,1,gt,St,rt,Et,2):(ut[0]=te,ut[1]=Q,ut[2]=j,ut[3]=G,ut[4]=1),h&&ut[4]?this.batchQuad(null,Y,$,Z,ee,ut[0],ut[1],ut[2],ut[3],0,0,1,1,gt,St,rt,Et,2):(Ee[0]=Y,Ee[1]=$,Ee[2]=Z,Ee[3]=ee,Ee[4]=1)}}},destroy:function(){return this._tempMatrix1.destroy(),this._tempMatrix2.destroy(),this._tempMatrix3.destroy(),this._tempMatrix1=null,this._tempMatrix1=null,this._tempMatrix1=null,Td.prototype.destroy.call(this),this}});Yj.exports=VCe});var ib=u(($it,Hj)=>{"use strict";Hj.exports=["#define SHADER_NAME PHASER_SINGLE_FS","#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","    vec4 color = texture * texel;","    if (outTintEffect == 1.0)","    {","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        color = texel;","    }","    gl_FragColor = color;","}"].join(`
`)});var sb=u((Jit,zj)=>{"use strict";zj.exports=["#define SHADER_NAME PHASER_SINGLE_VS","precision mediump float;","uniform mat4 uProjectionMatrix;","uniform vec2 uResolution;","attribute vec2 inPosition;","attribute vec2 inTexCoord;","attribute float inTexId;","attribute float inTintEffect;","attribute vec4 inTint;","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","    outTexCoord = inTexCoord;","    outTint = inTint;","    outTintEffect = inTintEffect;","}"].join(`
`)});var nb=u((Qit,Xj)=>{"use strict";var XCe=R(),rb=re(),Vj=Sl(),KCe=ib(),ZCe=sb(),jCe=xo(),$Ce=Co(),JCe=new XCe({Extends:Vj,initialize:function(e){e.fragShader=rb(e,"fragShader",KCe),e.vertShader=rb(e,"vertShader",ZCe),e.attributes=rb(e,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2},{name:"inTexId"},{name:"inTintEffect"},{name:"inTint",size:4,type:jCe.UNSIGNED_BYTE,normalized:!0}]),e.forceZero=!0,e.resizeUniform="uResolution",Vj.call(this,e)},boot:function(){$Ce.prototype.boot.call(this);var t=this.renderer;this.set1i("uMainSampler",0),this.set2f("uResolution",t.width,t.height)}});Xj.exports=JCe});var ab=u((est,jj)=>{"use strict";var QCe=R(),Kj=re(),Zj=Sl(),ewe=ib(),twe=sb(),iwe=Co(),swe=new QCe({Extends:Zj,initialize:function(e){e.fragShader=Kj(e,"fragShader",ewe),e.vertShader=Kj(e,"vertShader",twe),e.forceZero=!0,Zj.call(this,e)},boot:function(){iwe.prototype.boot.call(this);var t=this.renderer;this.set1i("uMainSampler",0),this.set2f("uResolution",t.width,t.height)}});jj.exports=swe});var hb=u((tst,$j)=>{"use strict";var rwe=dl(),nwe=mi(),ob={BitmapMaskPipeline:Zy(),Events:Xy(),MobilePipeline:nb(),MultiPipeline:Sl(),SinglePipeline:ab()};ob=nwe(!1,ob,rwe);$j.exports=ob});var Po=u((trt,b8)=>{"use strict";var Swe={CREATED:0,DELAY:2,PENDING_RENDER:4,PLAYING_FORWARD:5,PLAYING_BACKWARD:6,HOLD_DELAY:7,REPEAT_DELAY:8,COMPLETE:9,PENDING:20,ACTIVE:21,LOOP_DELAY:22,COMPLETE_DELAY:23,START_DELAY:24,PENDING_REMOVE:25,REMOVED:26,FINISHED:27,DESTROYED:28,MAX:999999999999};b8.exports=Swe});var Al=u((irt,A8)=>{"use strict";var Ewe=function(t,e,i){return t&&t.hasOwnProperty(e)?t[e]:i};A8.exports=Ewe});var Cd=u((srt,x8)=>{"use strict";var Twe=function(t,e,i){var s;if(t.hasOwnProperty(e)){var r=typeof t[e];r==="function"?s=function(n,a,o,h,l,c){return t[e](n,a,o,h,l,c)}:s=function(){return t[e]}}else typeof i=="function"?s=i:s=function(){return i};return s};x8.exports=Twe});var w8=u((rrt,C8)=>{"use strict";C8.exports=["callbackScope","completeDelay","delay","duration","ease","easeParams","flipX","flipY","hold","interpolation","loop","loopDelay","onActive","onActiveParams","onComplete","onCompleteParams","onLoop","onLoopParams","onPause","onPauseParams","onRepeat","onRepeatParams","onResume","onResumeParams","onStart","onStartParams","onStop","onStopParams","onUpdate","onUpdateParams","onYoyo","onYoyoParams","paused","persist","props","repeat","repeatDelay","targets","yoyo"]});var Sb=u((nrt,R8)=>{"use strict";var ywe=w8(),bwe=function(t){var e,i=[];if(t.hasOwnProperty("props"))for(e in t.props)e.substring(0,1)!=="_"&&i.push({key:e,value:t.props[e]});else for(e in t)ywe.indexOf(e)===-1&&e.substring(0,1)!=="_"&&i.push({key:e,value:t[e]});return i};R8.exports=bwe});var wd=u((art,P8)=>{"use strict";var Awe=Ne(),xwe=function(t){var e=Awe(t,"targets",null);return e===null||(typeof e=="function"&&(e=e.call()),Array.isArray(e)||(e=[e])),e};P8.exports=xwe});var Rd=u((ort,M8)=>{"use strict";var Cwe=Mn(),wwe=za();function _8(t){return!!t.getActive&&typeof t.getActive=="function"}function I8(t){return!!t.getStart&&typeof t.getStart=="function"}function L8(t){return!!t.getEnd&&typeof t.getEnd=="function"}function Rwe(t){return I8(t)||L8(t)||_8(t)}var xl=function(t,e){var i,s=function(A,w,C){return C},r=function(A,w,C){return C},n=null,a=typeof e;if(a==="number")s=function(){return e};else if(Array.isArray(e))r=function(){return e[0]},s=function(){return e[e.length-1]};else if(a==="string"){var o=e.toLowerCase(),h=o.substring(0,6)==="random",l=o.substring(0,3)==="int";if(h||l){var c=o.indexOf("("),d=o.indexOf(")"),f=o.indexOf(",");if(c&&d&&f){var p=parseFloat(o.substring(c+1,f)),m=parseFloat(o.substring(f+1,d));h?s=function(){return wwe(p,m)}:s=function(){return Cwe(p,m)}}else throw new Error("invalid random() format")}else{o=o[0];var v=parseFloat(e.substr(2));switch(o){case"+":s=function(A,w,C){return C+v};break;case"-":s=function(A,w,C){return C-v};break;case"*":s=function(A,w,C){return C*v};break;case"/":s=function(A,w,C){return C/v};break;default:s=function(){return parseFloat(e)}}}}else if(a==="function")s=e;else if(a==="object")if(Rwe(e))_8(e)&&(n=e.getActive),L8(e)&&(s=e.getEnd),I8(e)&&(r=e.getStart);else if(e.hasOwnProperty("value"))i=xl(t,e.value);else{var g=e.hasOwnProperty("to"),S=e.hasOwnProperty("from"),y=e.hasOwnProperty("start");if(g&&(S||y)){if(i=xl(t,e.to),y){var b=xl(t,e.start);i.getActive=b.getEnd}if(S){var x=xl(t,e.from);i.getStart=x.getEnd}}}return i||(i={getActive:n,getEnd:s,getStart:r}),i};M8.exports=xl});var na=u((hrt,B8)=>{"use strict";var Pwe=R(),O8=ze(),ra=Fi(),vt=Po(),D8=new Pwe({Extends:O8,initialize:function(e){O8.call(this),this.parent=e,this.data=[],this.totalData=0,this.startDelay=0,this.hasStarted=!1,this.timeScale=1,this.loop=0,this.loopDelay=0,this.loopCounter=0,this.completeDelay=0,this.countdown=0,this.state=vt.PENDING,this.paused=!1,this.callbacks={onActive:null,onComplete:null,onLoop:null,onPause:null,onRepeat:null,onResume:null,onStart:null,onStop:null,onUpdate:null,onYoyo:null},this.callbackScope,this.persist=!1},setTimeScale:function(t){return this.timeScale=t,this},getTimeScale:function(){return this.timeScale},isPlaying:function(){return!this.paused&&this.isActive()},isPaused:function(){return this.paused},pause:function(){return this.paused||(this.paused=!0,this.dispatchEvent(ra.TWEEN_PAUSE,"onPause")),this},resume:function(){return this.paused&&(this.paused=!1,this.dispatchEvent(ra.TWEEN_RESUME,"onResume")),this},makeActive:function(){this.parent.makeActive(this),this.dispatchEvent(ra.TWEEN_ACTIVE,"onActive")},onCompleteHandler:function(){this.setPendingRemoveState(),this.dispatchEvent(ra.TWEEN_COMPLETE,"onComplete")},complete:function(t){return t===void 0&&(t=0),t?(this.setCompleteDelayState(),this.countdown=t):this.onCompleteHandler(),this},completeAfterLoop:function(t){return t===void 0&&(t=0),this.loopCounter>t&&(this.loopCounter=t),this},remove:function(){return this.parent&&this.parent.remove(this),this},stop:function(){return this.parent&&!this.isRemoved()&&!this.isPendingRemove()&&!this.isDestroyed()&&(this.dispatchEvent(ra.TWEEN_STOP,"onStop"),this.setPendingRemoveState()),this},updateLoopCountdown:function(t){this.countdown-=t,this.countdown<=0&&(this.setActiveState(),this.dispatchEvent(ra.TWEEN_LOOP,"onLoop"))},updateStartCountdown:function(t){return this.countdown-=t,this.countdown<=0&&(this.hasStarted=!0,this.setActiveState(),this.dispatchEvent(ra.TWEEN_START,"onStart"),t=0),t},updateCompleteDelay:function(t){this.countdown-=t,this.countdown<=0&&this.onCompleteHandler()},setCallback:function(t,e,i){return i===void 0&&(i=[]),this.callbacks.hasOwnProperty(t)&&(this.callbacks[t]={func:e,params:i}),this},setPendingState:function(){this.state=vt.PENDING},setActiveState:function(){this.state=vt.ACTIVE,this.hasStarted=!1},setLoopDelayState:function(){this.state=vt.LOOP_DELAY},setCompleteDelayState:function(){this.state=vt.COMPLETE_DELAY},setStartDelayState:function(){this.state=vt.START_DELAY,this.countdown=this.startDelay,this.hasStarted=!1},setPendingRemoveState:function(){this.state=vt.PENDING_REMOVE},setRemovedState:function(){this.state=vt.REMOVED},setFinishedState:function(){this.state=vt.FINISHED},setDestroyedState:function(){this.state=vt.DESTROYED},isPending:function(){return this.state===vt.PENDING},isActive:function(){return this.state===vt.ACTIVE},isLoopDelayed:function(){return this.state===vt.LOOP_DELAY},isCompleteDelayed:function(){return this.state===vt.COMPLETE_DELAY},isStartDelayed:function(){return this.state===vt.START_DELAY},isPendingRemove:function(){return this.state===vt.PENDING_REMOVE},isRemoved:function(){return this.state===vt.REMOVED},isFinished:function(){return this.state===vt.FINISHED},isDestroyed:function(){return this.state===vt.DESTROYED},destroy:function(){this.data&&this.data.forEach(function(t){t.destroy()}),this.removeAllListeners(),this.callbacks=null,this.data=null,this.parent=null,this.setDestroyedState()}});D8.TYPES=["onActive","onComplete","onLoop","onPause","onRepeat","onResume","onStart","onStop","onUpdate","onYoyo"];B8.exports=D8});var Eb=u((lrt,U8)=>{"use strict";var _we={targets:null,delay:0,duration:1e3,ease:"Power0",easeParams:null,hold:0,repeat:0,repeatDelay:0,yoyo:!1,flipX:!1,flipY:!1,persist:!1,interpolation:null};U8.exports=_we});var Tb=u((urt,F8)=>{"use strict";var Iwe=R(),N8=Fi(),xt=Po(),Lwe=new Iwe({initialize:function(e,i,s,r,n,a,o,h,l,c){this.tween=e,this.targetIndex=i,this.duration=r<=0?.01:r,this.totalDuration=0,this.delay=0,this.getDelay=s,this.yoyo=n,this.hold=a,this.repeat=o,this.repeatDelay=h,this.repeatCounter=0,this.flipX=l,this.flipY=c,this.progress=0,this.elapsed=0,this.state=0,this.isCountdown=!1},getTarget:function(){return this.tween.targets[this.targetIndex]},setTargetValue:function(t){t===void 0&&(t=this.current),this.tween.targets[this.targetIndex][this.key]=t},setCreatedState:function(){this.state=xt.CREATED,this.isCountdown=!1},setDelayState:function(){this.state=xt.DELAY,this.isCountdown=!0},setPendingRenderState:function(){this.state=xt.PENDING_RENDER,this.isCountdown=!1},setPlayingForwardState:function(){this.state=xt.PLAYING_FORWARD,this.isCountdown=!1},setPlayingBackwardState:function(){this.state=xt.PLAYING_BACKWARD,this.isCountdown=!1},setHoldState:function(){this.state=xt.HOLD_DELAY,this.isCountdown=!0},setRepeatState:function(){this.state=xt.REPEAT_DELAY,this.isCountdown=!0},setCompleteState:function(){this.state=xt.COMPLETE,this.isCountdown=!1},isCreated:function(){return this.state===xt.CREATED},isDelayed:function(){return this.state===xt.DELAY},isPendingRender:function(){return this.state===xt.PENDING_RENDER},isPlayingForward:function(){return this.state===xt.PLAYING_FORWARD},isPlayingBackward:function(){return this.state===xt.PLAYING_BACKWARD},isHolding:function(){return this.state===xt.HOLD_DELAY},isRepeating:function(){return this.state===xt.REPEAT_DELAY},isComplete:function(){return this.state===xt.COMPLETE},setStateFromEnd:function(t){this.yoyo?this.onRepeat(t,!0,!0):this.repeatCounter>0?this.onRepeat(t,!0,!1):this.setCompleteState()},setStateFromStart:function(t){this.repeatCounter>0?this.onRepeat(t,!1):this.setCompleteState()},reset:function(){var t=this.tween,e=t.totalTargets,i=this.targetIndex,s=t.targets[i],r=this.key;this.progress=0,this.elapsed=0,this.delay=this.getDelay(s,r,0,i,e,t),this.repeatCounter=this.repeat===-1?xt.MAX:this.repeat,this.setPendingRenderState();var n=this.duration+this.hold;this.yoyo&&(n+=this.duration);var a=n+this.repeatDelay;this.totalDuration=this.delay+n,this.repeat===-1?(this.totalDuration+=a*xt.MAX,t.isInfinite=!0):this.repeat>0&&(this.totalDuration+=a*this.repeat),this.totalDuration>t.duration&&(t.duration=this.totalDuration),this.delay<t.startDelay&&(t.startDelay=this.delay),this.delay>0&&(this.elapsed=this.delay,this.setDelayState())},onRepeat:function(t,e,i){var s=this.tween,r=s.totalTargets,n=this.targetIndex,a=s.targets[n],o=this.key,h=o!=="texture";if(this.elapsed=t,this.progress=t/this.duration,this.flipX&&a.toggleFlipX(),this.flipY&&a.toggleFlipY(),h&&(e||i)&&(this.start=this.getStartValue(a,o,this.start,n,r,s)),i){this.setPlayingBackwardState(),this.dispatchEvent(N8.TWEEN_YOYO,"onYoyo");return}this.repeatCounter--,h&&(this.end=this.getEndValue(a,o,this.start,n,r,s)),this.repeatDelay>0?(this.elapsed=this.repeatDelay-t,h&&(this.current=this.start,a[o]=this.current),this.setRepeatState()):(this.setPlayingForwardState(),this.dispatchEvent(N8.TWEEN_REPEAT,"onRepeat"))},destroy:function(){this.tween=null,this.getDelay=null,this.setCompleteState()}});F8.exports=Lwe});var yb=u((crt,G8)=>{"use strict";var Pd=Tb(),Mwe=Je(),Owe=R(),k8=Fi(),Dwe=new Owe({Extends:Pd,initialize:function(e,i,s,r,n,a,o,h,l,c,d,f,p,m,v,g,S){Pd.call(this,e,i,h,l,c,d,f,p,m,v),this.key=s,this.getActiveValue=a,this.getEndValue=r,this.getStartValue=n,this.ease=o,this.start=0,this.previous=0,this.current=0,this.end=0,this.interpolation=g,this.interpolationData=S},reset:function(t){Pd.prototype.reset.call(this);var e=this.tween.targets[this.targetIndex],i=this.key;t&&(e[i]=this.start),this.start=0,this.previous=0,this.current=0,this.end=0,this.getActiveValue&&(e[i]=this.getActiveValue(e,i,0))},update:function(t){var e=this.tween,i=e.totalTargets,s=this.targetIndex,r=e.targets[s],n=this.key;if(!r)return this.setCompleteState(),!1;if(this.isCountdown&&(this.elapsed-=t,this.elapsed<=0&&(this.elapsed=0,t=0,this.isDelayed()?this.setPendingRenderState():this.isRepeating()?(this.setPlayingForwardState(),this.dispatchEvent(k8.TWEEN_REPEAT,"onRepeat")):this.isHolding()&&this.setStateFromEnd(0))),this.isPendingRender())return this.start=this.getStartValue(r,n,r[n],s,i,e),this.end=this.getEndValue(r,n,this.start,s,i,e),this.current=this.start,r[n]=this.start,this.setPlayingForwardState(),!0;var a=this.isPlayingForward(),o=this.isPlayingBackward();if(a||o){var h=this.elapsed,l=this.duration,c=0,d=!1;h+=t,h>=l?(c=h-l,h=l,d=!0):h<0&&(h=0);var f=Mwe(h/l,0,1);this.elapsed=h,this.progress=f,this.previous=this.current,a||(f=1-f);var p=this.ease(f);this.interpolation?this.current=this.interpolation(this.interpolationData,p):this.current=this.start+(this.end-this.start)*p,r[n]=this.current,d&&(a?(e.isNumberTween&&(this.current=this.end,r[n]=this.current),this.hold>0?(this.elapsed=this.hold,this.setHoldState()):this.setStateFromEnd(c)):(e.isNumberTween&&(this.current=this.start,r[n]=this.current),this.setStateFromStart(c))),this.dispatchEvent(k8.TWEEN_UPDATE,"onUpdate")}return!this.isComplete()},dispatchEvent:function(t,e){var i=this.tween;if(!i.isSeeking){var s=i.targets[this.targetIndex],r=this.key,n=this.current,a=this.previous;i.emit(t,i,r,s,n,a);var o=i.callbacks[e];o&&o.func.apply(i.callbackScope,[i,s,r,n,a].concat(o.params))}},destroy:function(){Pd.prototype.destroy.call(this),this.getActiveValue=null,this.getEndValue=null,this.getStartValue=null,this.ease=null}});G8.exports=Dwe});var bb=u((drt,W8)=>{"use strict";var _d=Tb(),Bwe=Je(),Uwe=R(),q8=Fi(),Nwe=new Uwe({Extends:_d,initialize:function(e,i,s,r,n,a,o,h,l,c,d){_d.call(this,e,i,n,a,!1,o,h,l,c,d),this.key="texture",this.startTexture=null,this.endTexture=s,this.startFrame=null,this.endFrame=r,this.yoyo=h!==0},reset:function(t){_d.prototype.reset.call(this);var e=this.tween.targets[this.targetIndex];this.startTexture||(this.startTexture=e.texture.key,this.startFrame=e.frame.name),t&&e.setTexture(this.startTexture,this.startFrame)},update:function(t){var e=this.tween,i=this.targetIndex,s=e.targets[i];if(!s)return this.setCompleteState(),!1;if(this.isCountdown&&(this.elapsed-=t,this.elapsed<=0&&(this.elapsed=0,t=0,this.isDelayed()?this.setPendingRenderState():this.isRepeating()?(this.setPlayingForwardState(),this.dispatchEvent(q8.TWEEN_REPEAT,"onRepeat")):this.isHolding()&&this.setStateFromEnd(0))),this.isPendingRender())return this.startTexture&&s.setTexture(this.startTexture,this.startFrame),this.setPlayingForwardState(),!0;var r=this.isPlayingForward(),n=this.isPlayingBackward();if(r||n){var a=this.elapsed,o=this.duration,h=0,l=!1;a+=t,a>=o?(h=a-o,a=o,l=!0):a<0&&(a=0);var c=Bwe(a/o,0,1);this.elapsed=a,this.progress=c,l&&(r?(s.setTexture(this.endTexture,this.endFrame),this.hold>0?(this.elapsed=this.hold,this.setHoldState()):this.setStateFromEnd(h)):(s.setTexture(this.startTexture,this.startFrame),this.setStateFromStart(h))),this.dispatchEvent(q8.TWEEN_UPDATE,"onUpdate")}return!this.isComplete()},dispatchEvent:function(t,e){var i=this.tween;if(!i.isSeeking){var s=i.targets[this.targetIndex],r=this.key;i.emit(t,i,r,s);var n=i.callbacks[e];n&&n.func.apply(i.callbackScope,[i,s,r].concat(n.params))}},destroy:function(){_d.prototype.destroy.call(this),this.startTexture=null,this.endTexture=null,this.startFrame=null,this.endFrame=null}});W8.exports=Nwe});var Cl=u((frt,Y8)=>{"use strict";var Id=na(),Fwe=R(),Ld=Fi(),kwe=ai(),Gwe=dt(),qwe=Kt(),_o=Po(),Wwe=yb(),Ywe=bb(),Hwe=new Fwe({Extends:Id,initialize:function(e,i){Id.call(this,e),this.targets=i,this.totalTargets=i.length,this.isSeeking=!1,this.isInfinite=!1,this.elapsed=0,this.totalElapsed=0,this.duration=0,this.progress=0,this.totalDuration=0,this.totalProgress=0,this.isNumberTween=!1},add:function(t,e,i,s,r,n,a,o,h,l,c,d,f,p,m,v){var g=new Wwe(this,t,e,i,s,r,n,a,o,h,l,c,d,f,p,m,v);return this.totalData=this.data.push(g),g},addFrame:function(t,e,i,s,r,n,a,o,h,l){var c=new Ywe(this,t,e,i,s,r,n,a,o,h,l);return this.totalData=this.data.push(c),c},getValue:function(t){t===void 0&&(t=0);var e=null;return this.data&&(e=this.data[t].current),e},hasTarget:function(t){return this.targets&&this.targets.indexOf(t)!==-1},updateTo:function(t,e,i){if(i===void 0&&(i=!1),t!=="texture")for(var s=0;s<this.totalData;s++){var r=this.data[s];r.key===t&&(r.isPlayingForward()||r.isPlayingBackward())&&(r.end=e,i&&(r.start=r.current))}return this},restart:function(){switch(this.state){case _o.REMOVED:case _o.FINISHED:this.seek(),this.parent.makeActive(this);break;case _o.PENDING:case _o.PENDING_REMOVE:this.parent.reset(this);break;case _o.DESTROYED:console.warn("Cannot restart destroyed Tween",this);break;default:this.seek();break}return this.paused=!1,this.hasStarted=!1,this},nextState:function(){if(this.loopCounter>0)this.elapsed=0,this.progress=0,this.loopCounter--,this.initTweenData(!0),this.loopDelay>0?(this.countdown=this.loopDelay,this.setLoopDelayState()):(this.setActiveState(),this.dispatchEvent(Ld.TWEEN_LOOP,"onLoop"));else if(this.completeDelay>0)this.countdown=this.completeDelay,this.setCompleteDelayState();else return this.onCompleteHandler(),!0;return!1},onCompleteHandler:function(){this.progress=1,this.totalProgress=1,Id.prototype.onCompleteHandler.call(this)},play:function(){return this.isDestroyed()?(console.warn("Cannot play destroyed Tween",this),this):((this.isPendingRemove()||this.isFinished())&&this.seek(),this.paused=!1,this.setActiveState(),this)},seek:function(t,e,i){if(t===void 0&&(t=0),e===void 0&&(e=16.6),i===void 0&&(i=!1),this.isDestroyed())return console.warn("Cannot seek destroyed Tween",this),this;i||(this.isSeeking=!0),this.reset(!0),this.initTweenData(!0),this.setActiveState(),this.dispatchEvent(Ld.TWEEN_ACTIVE,"onActive");var s=this.paused;if(this.paused=!1,t>0){for(var r=Math.floor(t/e),n=t-r*e,a=0;a<r;a++)this.update(e);n>0&&this.update(n)}return this.paused=s,this.isSeeking=!1,this},initTweenData:function(t){t===void 0&&(t=!1),this.duration=0,this.startDelay=qwe.MAX_SAFE_INTEGER;for(var e=this.data,i=0;i<this.totalData;i++)e[i].reset(t);this.duration=Math.max(this.duration,.01);var s=this.duration,r=this.completeDelay,n=this.loopCounter,a=this.loopDelay;n>0?this.totalDuration=s+r+(s+a)*n:this.totalDuration=s+r},reset:function(t){return t===void 0&&(t=!1),this.elapsed=0,this.totalElapsed=0,this.progress=0,this.totalProgress=0,this.loopCounter=this.loop,this.loop===-1&&(this.isInfinite=!0,this.loopCounter=_o.MAX),t||(this.initTweenData(),this.setActiveState(),this.dispatchEvent(Ld.TWEEN_ACTIVE,"onActive")),this},update:function(t){if(this.isPendingRemove()||this.isDestroyed())return this.persist?(this.setFinishedState(),!1):!0;if(this.paused||this.isFinished())return!1;if(t*=this.timeScale*this.parent.timeScale,this.isLoopDelayed())return this.updateLoopCountdown(t),!1;if(this.isCompleteDelayed())return this.updateCompleteDelay(t),!1;this.hasStarted||(this.startDelay-=t,this.startDelay<=0&&(this.hasStarted=!0,this.dispatchEvent(Ld.TWEEN_START,"onStart"),t=0));var e=!1;if(this.isActive())for(var i=this.data,s=0;s<this.totalData;s++)i[s].update(t)&&(e=!0);this.elapsed+=t,this.progress=Math.min(this.elapsed/this.duration,1),this.totalElapsed+=t,this.totalProgress=Math.min(this.totalElapsed/this.totalDuration,1),e||this.nextState();var r=this.isPendingRemove();return r&&this.persist&&(this.setFinishedState(),r=!1),r},forward:function(t){return this.update(t),this},rewind:function(t){return this.update(-t),this},dispatchEvent:function(t,e){if(!this.isSeeking){if(this.emit(t,this,this.targets),!this.callbacks)return;var i=this.callbacks[e];i&&i.func.apply(this.callbackScope,[this,this.targets].concat(i.params))}},destroy:function(){Id.prototype.destroy.call(this),this.targets=null}});Gwe.register("tween",function(t){return this.scene.sys.tweens.add(t)});kwe.register("tween",function(t){return this.scene.sys.tweens.create(t)});Y8.exports=Hwe});var wb=u((prt,V8)=>{"use strict";var zwe=na(),H8=Eb(),Ab=oi(),xb=Al(),Vwe=Zr(),ys=re(),Xwe=Cd(),Cb=Ne(),Kwe=Rd(),Zwe=Ku(),z8=Cl(),jwe=function(t,e,i){if(e instanceof z8)return e.parent=t,e;i===void 0?i=H8:i=Zwe(H8,i);var s=ys(e,"from",0),r=ys(e,"to",1),n=[{value:s}],a=ys(e,"delay",i.delay),o=ys(e,"easeParams",i.easeParams),h=ys(e,"ease",i.ease),l=Kwe("value",r),c=new z8(t,n),d=c.add(0,"value",l.getEnd,l.getStart,l.getActive,Vwe(ys(e,"ease",h),ys(e,"easeParams",o)),Xwe(e,"delay",a),ys(e,"duration",i.duration),xb(e,"yoyo",i.yoyo),ys(e,"hold",i.hold),ys(e,"repeat",i.repeat),ys(e,"repeatDelay",i.repeatDelay),!1,!1);d.start=s,d.current=s,c.completeDelay=Ab(e,"completeDelay",0),c.loop=Math.round(Ab(e,"loop",0)),c.loopDelay=Math.round(Ab(e,"loopDelay",0)),c.paused=xb(e,"paused",!1),c.persist=xb(e,"persist",!1),c.isNumberTween=!0,c.callbackScope=Cb(e,"callbackScope",c);for(var f=zwe.TYPES,p=0;p<f.length;p++){var m=f[p],v=Cb(e,m,!1);if(v){var g=Cb(e,m+"Params",[]);c.setCallback(m,v,g)}}return c};V8.exports=jwe});var Rb=u((mrt,X8)=>{"use strict";var $we=Zr(),Md=Ne(),Jwe=Kt(),Qwe=function(t,e){e===void 0&&(e={});var i,s=Md(e,"start",0),r=Md(e,"ease",null),n=Md(e,"grid",null),a=Md(e,"from",0),o=a==="first",h=a==="center",l=a==="last",c=typeof a=="number",d=Array.isArray(t),f=parseFloat(d?t[0]:t),p=d?parseFloat(t[1]):0,m=Math.max(f,p);if(d&&(s+=f),n){var v=n[0],g=n[1],S=0,y=0,b=0,x=0,A=[];l?(S=v-1,y=g-1):c?(S=a%v,y=Math.floor(a/v)):h&&(S=(v-1)/2,y=(g-1)/2);for(var w=Jwe.MIN_SAFE_INTEGER,C=0;C<g;C++){A[C]=[];for(var _=0;_<v;_++){b=S-_,x=y-C;var N=Math.sqrt(b*b+x*x);N>w&&(w=N),A[C][_]=N}}}var D=r?$we(r):null;return n?i=function(Y,$,j,G){var Z=0,ee=G%v,te=Math.floor(G/v);ee>=0&&ee<v&&te>=0&&te<g&&(Z=A[te][ee]);var Q;if(d){var Ae=p-f;D?Q=Z/w*Ae*D(Z/w):Q=Z/w*Ae}else D?Q=Z*f*D(Z/w):Q=Z*f;return Q+s}:i=function(Y,$,j,G,Z){Z--;var ee;o?ee=G:h?ee=Math.abs(Z/2-G):l?ee=Z-G:c&&(ee=Math.abs(a-G));var te;if(d){var Q;h?Q=(p-f)/Z*(ee*2):Q=(p-f)/Z*ee,D?te=Q*D(ee/Z):te=Q}else D?te=Z*m*D(ee/Z):te=ee*f;return te+s},i};X8.exports=Qwe});var Od=u((vrt,J8)=>{"use strict";var eRe=na(),K8=Eb(),Pb=oi(),Zs=Al(),tRe=Zr(),lt=re(),iRe=Ph(),Z8=Cd(),sRe=Sb(),rRe=wd(),j8=Ne(),nRe=Rd(),aRe=Ku(),$8=Cl(),oRe=function(t,e,i){if(e instanceof $8)return e.parent=t,e;i===void 0?i=K8:i=aRe(K8,i);var s=rRe(e);!s&&i.targets&&(s=i.targets);for(var r=sRe(e),n=lt(e,"delay",i.delay),a=lt(e,"duration",i.duration),o=lt(e,"easeParams",i.easeParams),h=lt(e,"ease",i.ease),l=lt(e,"hold",i.hold),c=lt(e,"repeat",i.repeat),d=lt(e,"repeatDelay",i.repeatDelay),f=Zs(e,"yoyo",i.yoyo),p=Zs(e,"flipX",i.flipX),m=Zs(e,"flipY",i.flipY),v=lt(e,"interpolation",i.interpolation),g=function(Y,$,j,G){if(j==="texture"){var Z=G,ee=void 0;Array.isArray(G)?(Z=G[0],ee=G[1]):G.hasOwnProperty("value")?(Z=G.value,Array.isArray(G.value)?(Z=G.value[0],ee=G.value[1]):typeof G.value=="string"&&(Z=G.value)):typeof G=="string"&&(Z=G),Y.addFrame($,Z,ee,Z8(G,"delay",n),lt(G,"duration",a),lt(G,"hold",l),lt(G,"repeat",c),lt(G,"repeatDelay",d),Zs(G,"flipX",p),Zs(G,"flipY",m))}else{var te=nRe(j,G),Q=iRe(lt(G,"interpolation",v));Y.add($,j,te.getEnd,te.getStart,te.getActive,tRe(lt(G,"ease",h),lt(G,"easeParams",o)),Z8(G,"delay",n),lt(G,"duration",a),Zs(G,"yoyo",f),lt(G,"hold",l),lt(G,"repeat",c),lt(G,"repeatDelay",d),Zs(G,"flipX",p),Zs(G,"flipY",m),Q,Q?G:null)}},S=new $8(t,s),y=0;y<r.length;y++)for(var b=r[y].key,x=r[y].value,A=0;A<s.length;A++)b==="scale"&&!s[A].hasOwnProperty("scale")?(g(S,A,"scaleX",x),g(S,A,"scaleY",x)):g(S,A,b,x);S.completeDelay=Pb(e,"completeDelay",0),S.loop=Math.round(Pb(e,"loop",0)),S.loopDelay=Math.round(Pb(e,"loopDelay",0)),S.paused=Zs(e,"paused",!1),S.persist=Zs(e,"persist",!1),S.callbackScope=lt(e,"callbackScope",S);for(var w=eRe.TYPES,C=0;C<w.length;C++){var _=w[C],N=j8(e,_,!1);if(N){var D=j8(e,_+"Params",[]);S.setCallback(_,N,D)}}return S};J8.exports=oRe});var e6=u((grt,Q8)=>{"use strict";Q8.exports={GetBoolean:Al(),GetEaseFunction:Zr(),GetInterpolationFunction:Ph(),GetNewValue:Cd(),GetProps:Sb(),GetTargets:wd(),GetValueOp:Rd(),NumberTweenBuilder:wb(),StaggerBuilder:Rb(),TweenBuilder:Od()}});var Dd=u((Srt,i6)=>{"use strict";var hRe=tr(),_b=na(),lRe=R(),t6=Fi(),uRe=ai(),cRe=dt(),dRe=Po(),fRe=new lRe({Extends:_b,initialize:function(e){_b.call(this,e),this.currentTween=null,this.currentIndex=0},init:function(){return this.loopCounter=this.loop===-1?dRe.MAX:this.loop,this.setCurrentTween(0),this.startDelay>0&&!this.isStartDelayed()?this.setStartDelayState():this.setActiveState(),this},add:function(t){var e=this.parent.create(t);Array.isArray(e)||(e=[e]);for(var i=this.data,s=0;s<e.length;s++){var r=e[s];r.parent=this,i.push(r.reset())}return this.totalData=i.length,this},remove:function(t){return hRe(this.data,t),t.setRemovedState(),t===this.currentTween&&this.nextTween(),this.totalData=this.data.length,this},hasTarget:function(t){for(var e=this.data,i=0;i<this.totalData;i++)if(e[i].hasTarget(t))return!0;return!1},restart:function(){return this.isDestroyed()?(console.warn("Cannot restart destroyed TweenChain",this),this):(this.isRemoved()&&this.parent.makeActive(this),this.resetTweens(),this.paused=!1,this.init())},reset:function(t){return t.seek(),t.setActiveState(),this},makeActive:function(t){return t.reset(),t.setActiveState(),this},nextState:function(){if(this.loopCounter>0)this.loopCounter--,this.resetTweens(),this.loopDelay>0?(this.countdown=this.loopDelay,this.setLoopDelayState()):(this.setActiveState(),this.dispatchEvent(t6.TWEEN_LOOP,"onLoop"));else if(this.completeDelay>0)this.countdown=this.completeDelay,this.setCompleteDelayState();else return this.onCompleteHandler(),!0;return!1},play:function(){return this.isDestroyed()?(console.warn("Cannot play destroyed TweenChain",this),this):((this.isPendingRemove()||this.isPending())&&this.resetTweens(),this.paused=!1,this.startDelay>0&&!this.isStartDelayed()?this.setStartDelayState():this.setActiveState(),this)},resetTweens:function(){for(var t=this.data,e=this.totalData,i=0;i<e;i++)t[i].reset(!1);this.setCurrentTween(0)},update:function(t){if(this.isPendingRemove()||this.isDestroyed())return!0;if(this.isFinished()||this.paused)return!1;if(t*=this.parent.timeScale,this.isLoopDelayed())return this.updateLoopCountdown(t),!1;if(this.isCompleteDelayed())return this.updateCompleteDelay(t),!1;this.hasStarted||(this.startDelay-=t,this.startDelay<=0&&(this.hasStarted=!0,this.dispatchEvent(t6.TWEEN_START,"onStart"),t=0));var e=!1;return this.isActive()&&this.currentTween&&(this.currentTween.update(t)&&this.nextTween()&&this.nextState(),e=this.isPendingRemove(),e&&this.persist&&(this.setFinishedState(),e=!1)),e},nextTween:function(){return this.currentIndex++,this.currentIndex===this.totalData?!0:(this.setCurrentTween(this.currentIndex),!1)},setCurrentTween:function(t){this.currentIndex=t,this.currentTween=this.data[t],this.currentTween.setActiveState()},dispatchEvent:function(t,e){this.emit(t,this);var i=this.callbacks[e];i&&i.func.apply(this.callbackScope,[this].concat(i.params))},destroy:function(){_b.prototype.destroy.call(this),this.currentTween=null}});cRe.register("tweenchain",function(t){return this.scene.sys.tweens.chain(t)});uRe.register("tweenchain",function(t){return this.scene.sys.tweens.create(t)});i6.exports=fRe});var a6=u((Ert,n6)=>{"use strict";var pRe=na(),Ib=oi(),s6=Al(),mRe=wd(),aa=Ne(),vRe=Od(),r6=Dd(),gRe=function(t,e){if(e instanceof r6)return e.parent=t,e;var i=new r6(t);i.startDelay=aa(e,"delay",0),i.completeDelay=Ib(e,"completeDelay",0),i.loop=Math.round(Ib(e,"loop",aa(e,"repeat",0))),i.loopDelay=Math.round(Ib(e,"loopDelay",aa(e,"repeatDelay",0))),i.paused=s6(e,"paused",!1),i.persist=s6(e,"persist",!1),i.callbackScope=aa(e,"callbackScope",i);var s,r=pRe.TYPES;for(s=0;s<r.length;s++){var n=r[s],a=aa(e,n,!1);if(a){var o=aa(e,n+"Params",[]);i.setCallback(n,a,o)}}var h=aa(e,"tweens",null);if(Array.isArray(h)){var l=[],c=mRe(e),d=void 0;for(c&&(d={targets:c}),s=0;s<h.length;s++)l.push(vRe(i,h[s],d));i.add(l)}return i};n6.exports=gRe});var l6=u((Trt,h6)=>{"use strict";var SRe=tr(),ERe=R(),TRe=xf(),yRe=wb(),bRe=Vt(),ln=qe(),ARe=Rb(),Lb=Cl(),Mb=Od(),Ob=Dd(),Bd=a6(),o6=new ERe({initialize:function(e){this.scene=e,this.events=e.sys.events,this.timeScale=1,this.paused=!1,this.processing=!1,this.tweens=[],this.time=0,this.startTime=0,this.nextTime=0,this.prevTime=0,this.maxLag=500,this.lagSkip=33,this.gap=1e3/240,this.events.once(ln.BOOT,this.boot,this),this.events.on(ln.START,this.start,this)},boot:function(){this.events.once(ln.DESTROY,this.destroy,this)},start:function(){this.timeScale=1,this.paused=!1,this.startTime=Date.now(),this.prevTime=this.startTime,this.nextTime=this.gap,this.events.on(ln.UPDATE,this.update,this),this.events.once(ln.SHUTDOWN,this.shutdown,this)},create:function(t){Array.isArray(t)||(t=[t]);for(var e=[],i=0;i<t.length;i++){var s=t[i];s instanceof Lb||s instanceof Ob?e.push(s):Array.isArray(s.tweens)?e.push(Bd(this,s)):e.push(Mb(this,s))}return e.length===1?e[0]:e},add:function(t){var e=t,i=this.tweens;return e instanceof Lb||e instanceof Ob||(Array.isArray(e.tweens)?e=Bd(this,e):e=Mb(this,e)),i.push(e.reset()),e},addMultiple:function(t){for(var e,i=[],s=this.tweens,r=0;r<t.length;r++)e=t[r],e instanceof Lb||e instanceof Ob||(Array.isArray(e.tweens)?e=Bd(this,e):e=Mb(this,e)),s.push(e.reset()),i.push(e);return i},chain:function(t){var e=Bd(this,t);return this.tweens.push(e.init()),e},getChainedTweens:function(t){return t.getChainedTweens()},has:function(t){return this.tweens.indexOf(t)>-1},existing:function(t){return this.has(t)||this.tweens.push(t.reset()),this},addCounter:function(t){var e=yRe(this,t);return this.tweens.push(e.reset()),e},stagger:function(t,e){return ARe(t,e)},setLagSmooth:function(t,e){return t===void 0&&(t=1/1e-8),e===void 0&&(e=0),this.maxLag=t,this.lagSkip=Math.min(e,this.maxLag),this},setFps:function(t){return t===void 0&&(t=240),this.gap=1e3/t,this.nextTime=this.time*1e3+this.gap,this},getDelta:function(t){var e=Date.now()-this.prevTime;e>this.maxLag&&(this.startTime+=e-this.lagSkip),this.prevTime+=e;var i=this.prevTime-this.startTime,s=i-this.nextTime,r=i-this.time*1e3;return s>0||t?(i/=1e3,this.time=i,this.nextTime+=s+(s>=this.gap?4:this.gap-s)):r=0,r},tick:function(){return this.step(!0),this},update:function(){this.paused||this.step(!1)},step:function(t){t===void 0&&(t=!1);var e=this.getDelta(t);if(!(e<=0)){this.processing=!0;var i,s,r=[],n=this.tweens;for(i=0;i<n.length;i++)s=n[i],s.update(e)&&r.push(s);var a=r.length;if(a&&n.length>0){for(i=0;i<a;i++){s=r[i];var o=n.indexOf(s);o>-1&&(s.isPendingRemove()||s.isDestroyed())&&(n.splice(o,1),s.destroy())}r.length=0}this.processing=!1}},remove:function(t){return this.processing?t.setPendingRemoveState():(SRe(this.tweens,t),t.setRemovedState()),this},reset:function(t){return this.existing(t),t.seek(),t.setActiveState(),this},makeActive:function(t){return this.existing(t),t.setActiveState(),this},each:function(t,e){var i,s=[null];for(i=1;i<arguments.length;i++)s.push(arguments[i]);return this.tweens.forEach(function(r){s[0]=r,t.apply(e,s)}),this},getTweens:function(){return this.tweens.slice()},getTweensOf:function(t){var e=[],i=this.tweens;Array.isArray(t)?t=TRe(t):t=[t];for(var s=t.length,r=0;r<i.length;r++)for(var n=i[r],a=0;a<s;a++)!n.isDestroyed()&&n.hasTarget(t[a])&&e.push(n);return e},getGlobalTimeScale:function(){return this.timeScale},setGlobalTimeScale:function(t){return this.timeScale=t,this},isTweening:function(t){for(var e=this.tweens,i,s=0;s<e.length;s++)if(i=e[s],i.isPlaying()&&i.hasTarget(t))return!0;return!1},killAll:function(){for(var t=this.processing?this.getTweens():this.tweens,e=0;e<t.length;e++)t[e].destroy();return this.processing||(t.length=0),this},killTweensOf:function(t){for(var e=this.getTweensOf(t),i=0;i<e.length;i++)e[i].destroy();return this},pauseAll:function(){return this.paused=!0,this},resumeAll:function(){return this.paused=!1,this},shutdown:function(){this.killAll(),this.tweens=[],this.events.off(ln.UPDATE,this.update,this),this.events.off(ln.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(ln.START,this.start,this),this.scene=null,this.events=null}});bRe.register("TweenManager",o6,"tweens");h6.exports=o6});var c6=u((yrt,u6)=>{"use strict";var xRe={States:Po(),Builders:e6(),Events:Fi(),TweenManager:l6(),Tween:Cl(),TweenData:yb(),TweenFrameData:bb(),BaseTween:na(),TweenChain:Dd()};u6.exports=xRe});var B6=u((Cnt,D6)=>{"use strict";D6.exports="addtexture"});var N6=u((wnt,U6)=>{"use strict";U6.exports="addtexture-"});var k6=u((Rnt,F6)=>{"use strict";F6.exports="onerror"});var q6=u((Pnt,G6)=>{"use strict";G6.exports="onload"});var Y6=u((_nt,W6)=>{"use strict";W6.exports="ready"});var z6=u((Int,H6)=>{"use strict";H6.exports="removetexture"});var X6=u((Lnt,V6)=>{"use strict";V6.exports="removetexture-"});var Io=u((Mnt,K6)=>{"use strict";K6.exports={ADD:B6(),ADD_KEY:N6(),ERROR:k6(),LOAD:q6(),READY:Y6(),REMOVE:z6(),REMOVE_KEY:X6()}});var Y7=u((yct,W7)=>{"use strict";var w_e=function(t,e,i,s){return i===void 0&&(i=0),e===0?t:(t-=i,t=e*Math.ceil(t/e),s?(i+t)/e:i+t)};W7.exports=w_e});var sA=u((bct,H7)=>{"use strict";var R_e=R(),gn=dl(),iA=Ch(),P_e=th(),__e=re(),I_e=Y7(),L_e=Zy(),M_e=nb(),O_e=Sl(),D_e=ab(),B_e=Jo(),U_e=tr(),N_e=new R_e({initialize:function(e){this.game=e.game,this.renderer=e,this.classes=new iA([[gn.MULTI_PIPELINE,O_e],[gn.BITMAPMASK_PIPELINE,L_e],[gn.SINGLE_PIPELINE,D_e],[gn.MOBILE_PIPELINE,M_e]]),this.postPipelineClasses=new iA,this.pipelines=new iA,this.postPipelineInstances=[],this.default=null,this.current=null,this.previous=null,this.MULTI_PIPELINE=null,this.BITMAPMASK_PIPELINE=null,this.UTILITY_PIPELINE=null,this.MOBILE_PIPELINE=null,this.FX_PIPELINE=null,this.fullFrame1,this.fullFrame2,this.halfFrame1,this.halfFrame2,this.renderTargets=[],this.maxDimension=0,this.frameInc=32,this.targetIndex=0},boot:function(t,e,i){this.frameInc=Math.floor(__e(t,"frameInc",32));var s,r,n=this,a=this.game;if(this.classes.each(function(h,l){s=n.add(h,new l({game:a})),h===gn.UTILITY_PIPELINE&&(n.UTILITY_PIPELINE=s,n.fullFrame1=s.fullFrame1,n.fullFrame2=s.fullFrame2,n.halfFrame1=s.halfFrame1,n.halfFrame2=s.halfFrame2)}),this.MULTI_PIPELINE=this.get(gn.MULTI_PIPELINE),this.BITMAPMASK_PIPELINE=this.get(gn.BITMAPMASK_PIPELINE),this.MOBILE_PIPELINE=this.get(gn.MOBILE_PIPELINE),t)for(r in t){var o=t[r];s=new o(a),s.name=r,s.isPostFX?this.postPipelineClasses.set(r,o):this.has(r)||(this.classes.set(r,o),this.add(r,s))}this.default=this.get(e),i&&!P_e.os.desktop&&(this.default=this.MOBILE_PIPELINE)},setDefaultPipeline:function(t){var e=this.get(t);return e&&(this.default=e),e},add:function(t,e){if(e.isPostFX){console.warn(t+" is a Post Pipeline. Use `addPostPipeline` instead");return}var i=this.pipelines,s=this.renderer;return i.has(t)?console.warn("Pipeline exists: "+t):(e.name=t,e.manager=this,i.set(t,e)),e.hasBooted||e.boot(),s.width!==0&&s.height!==0&&!e.isPreFX&&e.resize(s.width,s.height),e},addPostPipeline:function(t,e){this.postPipelineClasses.has(t)||this.postPipelineClasses.set(t,e)},flush:function(){this.current&&this.current.flush()},has:function(t){var e=this.pipelines;return typeof t=="string"?e.has(t):!!e.contains(t)},get:function(t){var e=this.pipelines;if(typeof t=="string")return e.get(t);if(e.contains(t))return t},getPostPipeline:function(t,e,i){var s=this.postPipelineClasses,r,n="",a=typeof t;if(a==="string"||a==="number"?(r=s.get(t),n=t):a==="function"?(s.contains(t)&&(r=t),n=t.name):a==="object"&&(r=s.get(t.name),n=t.name),r){var o=new r(this.game,i);return o.name=n,e&&(o.gameObject=e),this.postPipelineInstances.push(o),o}},removePostPipeline:function(t){U_e(this.postPipelineInstances,t)},remove:function(t,e,i){e===void 0&&(e=!0),i===void 0&&(i=!0),this.pipelines.delete(t),e&&this.classes.delete(t),i&&this.postPipelineClasses.delete(t)},set:function(t,e,i){if(!t.isPostFX)return this.isCurrent(t,i)||(this.flush(),this.current&&this.current.unbind(),this.current=t,t.bind(i)),t.updateProjectionMatrix(),t.onBind(e),t},preBatch:function(t){if(t.hasPostPipeline){this.flush();for(var e=t.postPipelines,i=e.length-1;i>=0;i--){var s=e[i];s.active&&s.preBatch(t)}}},postBatch:function(t){if(t.hasPostPipeline){this.flush();for(var e=t.postPipelines,i=0;i<e.length;i++){var s=e[i];s.active&&s.postBatch(t)}}},preBatchCamera:function(t){if(t.hasPostPipeline){this.flush();for(var e=t.postPipelines,i=e.length-1;i>=0;i--){var s=e[i];s.active&&s.preBatch(t)}}},postBatchCamera:function(t){if(t.hasPostPipeline){this.flush();for(var e=t.postPipelines,i=0;i<e.length;i++){var s=e[i];s.active&&s.postBatch(t)}}},isCurrent:function(t,e){var i=this.renderer,s=this.current;return s&&!e&&(e=s.currentShader),!(s!==t||e.program!==i.currentProgram)},copyFrame:function(t,e,i,s,r){return this.setUtility(this.UTILITY_PIPELINE.copyShader).copyFrame(t,e,i,s,r),this},copyToGame:function(t){return this.setUtility(this.UTILITY_PIPELINE.copyShader).copyToGame(t),this},drawFrame:function(t,e,i,s){return this.setUtility(this.UTILITY_PIPELINE.colorMatrixShader).drawFrame(t,e,i,s),this},blendFrames:function(t,e,i,s,r){return this.setUtility(this.UTILITY_PIPELINE.linearShader).blendFrames(t,e,i,s,r),this},blendFramesAdditive:function(t,e,i,s,r){return this.setUtility(this.UTILITY_PIPELINE.addShader).blendFramesAdditive(t,e,i,s,r),this},clearFrame:function(t,e){return this.UTILITY_PIPELINE.clearFrame(t,e),this},blitFrame:function(t,e,i,s,r,n){return this.setUtility(this.UTILITY_PIPELINE.copyShader).blitFrame(t,e,i,s,r,n),this},copyFrameRect:function(t,e,i,s,r,n,a,o){return this.UTILITY_PIPELINE.copyFrameRect(t,e,i,s,r,n,a,o),this},forceZero:function(){return this.current&&this.current.forceZero},setMulti:function(){return this.set(this.MULTI_PIPELINE)},setUtility:function(t){return this.UTILITY_PIPELINE.bind(t)},setFX:function(){return this.set(this.FX_PIPELINE)},restoreContext:function(){this.rebind(),this.pipelines.each(function(t,e){e.restoreContext()}),B_e(this.postPipelineInstances,function(t){t.restoreContext()})},rebind:function(t){t===void 0&&this.previous&&(t=this.previous);var e=this.renderer,i=e.gl;i.disable(i.DEPTH_TEST),i.disable(i.CULL_FACE),e.hasActiveStencilMask()?i.clear(i.DEPTH_BUFFER_BIT):(i.disable(i.STENCIL_TEST),i.clear(i.DEPTH_BUFFER_BIT|i.STENCIL_BUFFER_BIT)),i.viewport(0,0,e.width,e.height),e.currentProgram=null,e.setBlendMode(0,!0);var s=e.vaoExtension;s&&s.bindVertexArrayOES(null);var r=this.pipelines.entries;for(var n in r)r[n].glReset=!0;t&&(this.current=t,t.rebind())},clear:function(){var t=this.renderer;this.flush(),this.current?(this.current.unbind(),this.previous=this.current,this.current=null):this.previous=null,t.currentProgram=null,t.setBlendMode(0,!0);var e=t.vaoExtension;e&&e.bindVertexArrayOES(null)},getRenderTarget:function(t){var e=this.renderTargets,i=3;if(t>this.maxDimension)return this.targetIndex=e.length-i,e[this.targetIndex];var s=(I_e(t,this.frameInc,0,!0)-1)*i;return this.targetIndex=s,e[s]},getSwapRenderTarget:function(){return this.renderTargets[this.targetIndex+1]},getAltSwapRenderTarget:function(){return this.renderTargets[this.targetIndex+2]},destroy:function(){this.flush(),this.classes.clear(),this.postPipelineClasses.clear(),this.pipelines.clear(),this.renderer=null,this.game=null,this.classes=null,this.postPipelineClasses=null,this.pipelines=null,this.default=null,this.current=null,this.previous=null}});H7.exports=N_e});var Ol=u((Act,z7)=>{"use strict";var F_e=function(t,e){return t>0&&(t&t-1)===0&&e>0&&(e&e-1)===0};z7.exports=F_e});var X7=u((xct,V7)=>{"use strict";var rA=Ui(),k_e=is(),bs=re(),G_e=function(t,e){var i=t,s=bs(e,"callback"),r=bs(e,"type","image/png"),n=bs(e,"encoder",.92),a=Math.abs(Math.round(bs(e,"x",0))),o=Math.abs(Math.round(bs(e,"y",0))),h=bs(e,"getPixel",!1),l=bs(e,"isFramebuffer",!1),c=l?bs(e,"bufferWidth",1):i.drawingBufferWidth,d=l?bs(e,"bufferHeight",1):i.drawingBufferHeight;if(h){var f=new Uint8Array(4),p=l?o:d-o;i.readPixels(a,p,1,1,i.RGBA,i.UNSIGNED_BYTE,f),s.call(null,new k_e(f[0],f[1],f[2],f[3]))}else{var m=Math.floor(bs(e,"width",c)),v=Math.floor(bs(e,"height",d)),g=m*v*4,S=new Uint8Array(g);i.readPixels(a,d-o-v,m,v,i.RGBA,i.UNSIGNED_BYTE,S);for(var y=rA.createWebGL(this,m,v),b=y.getContext("2d",{willReadFrequently:!0}),x=b.getImageData(0,0,m,v),A=x.data,w=0;w<v;w++)for(var C=0;C<m;C++){var _=((v-w-1)*m+C)*4,N=l?g-(w*m+(m-C))*4:(w*m+C)*4;A[N+0]=S[_+0],A[N+1]=S[_+1],A[N+2]=S[_+2],A[N+3]=S[_+3]}b.putImageData(x,0,0);var D=new Image;D.onerror=function(){s.call(null),rA.remove(y)},D.onload=function(){s.call(null,D),rA.remove(y)},D.src=y.toDataURL(r,n)}};V7.exports=G_e});var nA=u((Cct,K7)=>{"use strict";var q_e=R(),W_e=new q_e({initialize:function(e,i,s,r){this.webGLBuffer=null,this.gl=e,this.initialDataOrSize=i,this.bufferType=s,this.bufferUsage=r,this.createResource()},createResource:function(){if(this.initialDataOrSize!==null){var t=this.gl;if(!t.isContextLost()){var e=this.bufferType,i=t.createBuffer();this.webGLBuffer=i,t.bindBuffer(e,this.webGLBuffer),t.bufferData(e,this.initialDataOrSize,this.bufferUsage),t.bindBuffer(e,null)}}},destroy:function(){var t=this.gl;t.isContextLost()||t.deleteBuffer(this.webGLBuffer),this.webGLBuffer=null,this.initialDataOrSize=null,this.gl=null}});K7.exports=W_e});var aA=u((wct,Z7)=>{"use strict";var Y_e=R(),H_e=new Y_e({initialize:function(e,i,s){this.webGLProgram=null,this.gl=e,this.vertexSource=i,this.fragmentSource=s,this.createResource()},createResource:function(){var t=this.gl;if(!t.isContextLost()){var e=t.createProgram(),i=t.createShader(t.VERTEX_SHADER),s=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(i,this.vertexSource),t.shaderSource(s,this.fragmentSource),t.compileShader(i),t.compileShader(s);var r=`Shader failed:
`;if(!t.getShaderParameter(i,t.COMPILE_STATUS))throw new Error("Vertex "+r+t.getShaderInfoLog(i));if(!t.getShaderParameter(s,t.COMPILE_STATUS))throw new Error("Fragment "+r+t.getShaderInfoLog(s));if(t.attachShader(e,i),t.attachShader(e,s),t.linkProgram(e),!t.getProgramParameter(e,t.LINK_STATUS))throw new Error("Link "+r+t.getProgramInfoLog(e));t.useProgram(e),this.webGLProgram=e}},destroy:function(){this.webGLProgram&&(this.gl.isContextLost()||this.gl.deleteProgram(this.webGLProgram),this.webGLProgram=null,this.gl=null)}});Z7.exports=H_e});var tf=u((Rct,j7)=>{"use strict";var z_e=R(),oA=Ol(),hA=new z_e({initialize:function(e,i,s,r,n,a,o,h,l,c,d,f,p){this.webGLTexture=null,this.isRenderTexture=!1,this.gl=e,this.mipLevel=i,this.minFilter=s,this.magFilter=r,this.wrapT=n,this.wrapS=a,this.format=o,this.pixels=h,this.width=l,this.height=c,this.pma=d??!0,this.forceSize=!!f,this.flipY=!!p,this.__SPECTOR_Metadata={},this.createResource()},createResource:function(){var t=this.gl;if(!t.isContextLost()){if(this.pixels instanceof hA){this.webGLTexture=this.pixels.webGLTexture;return}var e=t.createTexture();e.__SPECTOR_Metadata=this.__SPECTOR_Metadata,this.webGLTexture=e,this._processTexture()}},update:function(t,e,i,s,r,n,a,o,h){if(!(e===0||i===0)){this.pixels=t,this.width=e,this.height=i,this.flipY=s,this.wrapS=r,this.wrapT=n,this.minFilter=a,this.magFilter=o,this.format=h;var l=this.gl;l.isContextLost()||this._processTexture()}},_processTexture:function(){var t=this.gl;t.activeTexture(t.TEXTURE0);var e=t.getParameter(t.TEXTURE_BINDING_2D);t.bindTexture(t.TEXTURE_2D,this.webGLTexture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,this.minFilter),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,this.magFilter),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,this.wrapS),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,this.wrapT),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.pma),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,this.flipY);var i=this.pixels,s=this.mipLevel,r=this.width,n=this.height,a=this.format,o=!1;if(i==null)t.texImage2D(t.TEXTURE_2D,s,a,r,n,0,a,t.UNSIGNED_BYTE,null),o=oA(r,n);else if(i.compressed){r=i.width,n=i.height,o=i.generateMipmap;for(var h=0;h<i.mipmaps.length;h++)t.compressedTexImage2D(t.TEXTURE_2D,h,i.internalFormat,i.mipmaps[h].width,i.mipmaps[h].height,0,i.mipmaps[h].data)}else i instanceof Uint8Array?(t.texImage2D(t.TEXTURE_2D,s,a,r,n,0,a,t.UNSIGNED_BYTE,i),o=oA(r,n)):(this.forceSize||(r=i.width,n=i.height),t.texImage2D(t.TEXTURE_2D,s,a,a,t.UNSIGNED_BYTE,i),o=oA(r,n));o&&t.generateMipmap(t.TEXTURE_2D),e?t.bindTexture(t.TEXTURE_2D,e):t.bindTexture(t.TEXTURE_2D,null)},spectorMetadata:{get:function(){return this.__SPECTOR_Metadata},set:function(t){this.__SPECTOR_Metadata=t,this.gl.isContextLost()||(this.webGLTexture.__SPECTOR_Metadata=t)}},destroy:function(){this.webGLTexture!==null&&(this.gl.isContextLost()||this.pixels instanceof hA||this.gl.deleteTexture(this.webGLTexture),this.pixels=null,this.webGLTexture=null,this.gl=null)}});j7.exports=hA});var lA=u((Pct,$7)=>{"use strict";var V_e=R(),X_e={36054:"Incomplete Attachment",36055:"Missing Attachment",36057:"Incomplete Dimensions",36061:"Framebuffer Unsupported"},K_e=new V_e({initialize:function(e,i,s,r,n){this.webGLFramebuffer=null,this.gl=e,this.width=i,this.height=s,this.renderTexture=r,this.addDepthStencilBuffer=!!n,this.createResource()},createResource:function(){var t=this.gl;if(!t.isContextLost()){var e=this.renderTexture,i=0,s=t.createFramebuffer();if(this.webGLFramebuffer=s,t.bindFramebuffer(t.FRAMEBUFFER,s),e.isRenderTexture=!0,e.isAlphaPremultiplied=!1,t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.webGLTexture,0),i=t.checkFramebufferStatus(t.FRAMEBUFFER),i!==t.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer status: "+(X_e[i]||i));if(this.addDepthStencilBuffer){var r=t.createRenderbuffer();t.bindRenderbuffer(t.RENDERBUFFER,r),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,this.width,this.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,r)}t.bindFramebuffer(t.FRAMEBUFFER,null)}},destroy:function(){if(this.webGLFramebuffer!==null){var t=this.gl;if(!t.isContextLost()){t.bindFramebuffer(t.FRAMEBUFFER,this.webGLFramebuffer);var e=t.getFramebufferAttachmentParameter(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);e!==null&&(t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0),t.deleteTexture(e));var i=t.getFramebufferAttachmentParameter(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);i!==null&&t.deleteRenderbuffer(i),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteFramebuffer(this.webGLFramebuffer)}this.renderTexture=null,this.webGLFramebuffer=null,this.gl=null}}});$7.exports=K_e});var uA=u((_ct,J7)=>{"use strict";var Z_e=R(),j_e=new Z_e({initialize:function(e,i,s){this.webGLAttribLocation=-1,this.gl=e,this.program=i,this.name=s,this.createResource()},createResource:function(){if(this.program.webGLProgram===null){this.webGLAttribLocation=-1;return}var t=this.gl;t.isContextLost()||(this.webGLAttribLocation=t.getAttribLocation(this.program.webGLProgram,this.name))},destroy:function(){this.gl=null,this.program=null,this.name=null,this.webGLAttribLocation=-1}});J7.exports=j_e});var cA=u((Ict,Q7)=>{"use strict";var $_e=R(),J_e=new $_e({initialize:function(e,i,s){this.webGLUniformLocation=null,this.gl=e,this.program=i,this.name=s,this.createResource()},createResource:function(){if(this.program.webGLProgram===null){this.webGLUniformLocation=null;return}var t=this.gl;t.isContextLost()||(this.webGLUniformLocation=t.getUniformLocation(this.program.webGLProgram,this.name))},destroy:function(){this.gl=null,this.program=null,this.name=null,this.webGLUniformLocation=null}});Q7.exports=J_e});var pA=u((Lct,r$)=>{"use strict";var $i=Jo(),Sa=tr(),e$=ts(),Q_e=R(),Ea=Qi(),t$=ze(),Ta=yo(),sf=Ol(),eIe=Mu(),rf=Ie(),tIe=sA(),dA=fl(),iIe=Su(),sIe=Io(),fA=Ti(),i$=X7(),s$=nA(),rIe=aA(),nIe=tf(),aIe=lA(),oIe=uA(),hIe=cA(),Sn=!1,lIe=new Q_e({Extends:t$,initialize:function(e){t$.call(this);var i=e.config,s={alpha:i.transparent,desynchronized:i.desynchronized,depth:!0,antialias:i.antialiasGL,premultipliedAlpha:i.premultipliedAlpha,stencil:!0,failIfMajorPerformanceCaveat:i.failIfMajorPerformanceCaveat,powerPreference:i.powerPreference,preserveDrawingBuffer:i.preserveDrawingBuffer,willReadFrequently:!1};this.config={clearBeforeRender:i.clearBeforeRender,antialias:i.antialias,backgroundColor:i.backgroundColor,contextCreation:s,roundPixels:i.roundPixels,maxTextures:i.maxTextures,maxTextureSize:i.maxTextureSize,batchSize:i.batchSize,maxLights:i.maxLights,mipmapFilter:i.mipmapFilter},this.game=e,this.type=Ea.WEBGL,this.pipelines=null,this.width=0,this.height=0,this.canvas=e.canvas,this.blendModes=[],this.contextLost=!1,this.snapshotState={x:0,y:0,width:1,height:1,getPixel:!1,callback:null,type:"image/png",encoder:.92,isFramebuffer:!1,bufferWidth:0,bufferHeight:0},this.maxTextures=0,this.textureIndexes,this.glBufferWrappers=[],this.glProgramWrappers=[],this.glTextureWrappers=[],this.glFramebufferWrappers=[],this.glAttribLocationWrappers=[],this.glUniformLocationWrappers=[],this.currentFramebuffer=null,this.fboStack=[],this.currentProgram=null,this.currentBlendMode=1/0,this.currentScissorEnabled=!1,this.currentScissor=null,this.scissorStack=[],this.contextLostHandler=rf,this.contextRestoredHandler=rf,this.previousContextLostHandler=rf,this.previousContextRestoredHandler=rf,this.gl=null,this.supportedExtensions=null,this.instancedArraysExtension=null,this.vaoExtension=null,this.extensions={},this.glFormats,this.compression,this.drawingBufferHeight=0,this.blankTexture=null,this.normalTexture=null,this.whiteTexture=null,this.maskCount=0,this.maskStack=[],this.currentMask={mask:null,camera:null},this.currentCameraMask={mask:null,camera:null},this.glFuncMap=null,this.currentType="",this.newType=!1,this.nextTypeMatch=!1,this.finalType=!1,this.mipmapFilter=null,this.defaultScissor=[0,0,0,0],this.isBooted=!1,this.renderTarget=null,this.projectionMatrix,this.projectionWidth=0,this.projectionHeight=0,this.maskSource=null,this.maskTarget=null,this.spector=null,this._debugCapture=!1,this.init(this.config)},init:function(t){var e,i=this.game,s=this.canvas,r=t.backgroundColor;if(i.config.context?e=i.config.context:e=s.getContext("webgl",t.contextCreation)||s.getContext("experimental-webgl",t.contextCreation),!e||e.isContextLost())throw this.contextLost=!0,new Error("WebGL unsupported");this.gl=e,this.setExtensions(),this.setContextHandlers(),i.context=e;for(var n=0;n<=27;n++)this.blendModes.push({func:[e.ONE,e.ONE_MINUS_SRC_ALPHA],equation:e.FUNC_ADD});this.blendModes[1].func=[e.ONE,e.DST_ALPHA],this.blendModes[2].func=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA],this.blendModes[3].func=[e.ONE,e.ONE_MINUS_SRC_COLOR],this.blendModes[17]={func:[e.ZERO,e.ONE_MINUS_SRC_ALPHA],equation:e.FUNC_REVERSE_SUBTRACT},this.glFormats=[e.BYTE,e.SHORT,e.UNSIGNED_BYTE,e.UNSIGNED_SHORT,e.FLOAT],this.glFuncMap={mat2:{func:e.uniformMatrix2fv,length:1,matrix:!0},mat3:{func:e.uniformMatrix3fv,length:1,matrix:!0},mat4:{func:e.uniformMatrix4fv,length:1,matrix:!0},"1f":{func:e.uniform1f,length:1},"1fv":{func:e.uniform1fv,length:1},"1i":{func:e.uniform1i,length:1},"1iv":{func:e.uniform1iv,length:1},"2f":{func:e.uniform2f,length:2},"2fv":{func:e.uniform2fv,length:1},"2i":{func:e.uniform2i,length:2},"2iv":{func:e.uniform2iv,length:1},"3f":{func:e.uniform3f,length:3},"3fv":{func:e.uniform3fv,length:1},"3i":{func:e.uniform3i,length:3},"3iv":{func:e.uniform3iv,length:1},"4f":{func:e.uniform4f,length:4},"4fv":{func:e.uniform4fv,length:1},"4i":{func:e.uniform4i,length:4},"4iv":{func:e.uniform4iv,length:1}},(!t.maxTextures||t.maxTextures===-1)&&(t.maxTextures=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)),t.maxTextureSize||(t.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE)),this.compression=this.getCompressedTextures(),e.disable(e.DEPTH_TEST),e.disable(e.CULL_FACE),e.enable(e.BLEND),e.clearColor(r.redGL,r.greenGL,r.blueGL,r.alphaGL),e.clear(e.COLOR_BUFFER_BIT);var a=["NEAREST","LINEAR","NEAREST_MIPMAP_NEAREST","LINEAR_MIPMAP_NEAREST","NEAREST_MIPMAP_LINEAR","LINEAR_MIPMAP_LINEAR"];return a.indexOf(t.mipmapFilter)!==-1&&(this.mipmapFilter=e[t.mipmapFilter]),this.maxTextures=fA.checkShaderMax(e,t.maxTextures),this.textureIndexes=[],this.createTemporaryTextures(),this.pipelines=new tIe(this),this.setBlendMode(Ea.BlendModes.NORMAL),this.projectionMatrix=new eIe().identity(),i.textures.once(sIe.READY,this.boot,this),this},boot:function(){var t=this.game,e=this.pipelines,i=t.scale.baseSize,s=i.width,r=i.height;this.width=s,this.height=r,this.isBooted=!0,this.renderTarget=new dA(this,s,r,1,0,!0,!0),this.maskTarget=new dA(this,s,r,1,0,!0,!0),this.maskSource=new dA(this,s,r,1,0,!0,!0);var n=t.config;e.boot(n.pipeline,n.defaultPipeline,n.autoMobilePipeline),this.blankTexture=t.textures.getFrame("__DEFAULT").glTexture,this.normalTexture=t.textures.getFrame("__NORMAL").glTexture,this.whiteTexture=t.textures.getFrame("__WHITE").glTexture;var a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,null),a.enable(a.SCISSOR_TEST),t.scale.on(iIe.RESIZE,this.onResize,this),this.resize(s,r)},setExtensions:function(){var t=this.gl,e=t.getSupportedExtensions();this.supportedExtensions=e;var i="ANGLE_instanced_arrays";this.instancedArraysExtension=e.indexOf(i)>-1?t.getExtension(i):null;var s="OES_vertex_array_object";this.vaoExtension=e.indexOf(s)>-1?t.getExtension(s):null},setContextHandlers:function(t,e){this.previousContextLostHandler&&this.canvas.removeEventListener("webglcontextlost",this.previousContextLostHandler,!1),this.previousContextRestoredHandler&&this.canvas.removeEventListener("webglcontextlost",this.previousContextRestoredHandler,!1),typeof t=="function"?this.contextLostHandler=t.bind(this):this.contextLostHandler=this.dispatchContextLost.bind(this),typeof e=="function"?this.contextRestoredHandler=e.bind(this):this.contextRestoredHandler=this.dispatchContextRestored.bind(this),this.canvas.addEventListener("webglcontextlost",this.contextLostHandler,!1),this.canvas.addEventListener("webglcontextrestored",this.contextRestoredHandler,!1),this.previousContextLostHandler=this.contextLostHandler,this.previousContextRestoredHandler=this.contextRestoredHandler},dispatchContextLost:function(t){this.contextLost=!0,console&&console.warn("WebGL Context lost. Renderer disabled"),this.emit(Ta.LOSE_WEBGL,this),t.preventDefault()},dispatchContextRestored:function(t){var e=this.gl;if(e.isContextLost()){console&&console.log("WebGL Context restored, but context is still lost");return}this.currentProgram=null,this.currentFramebuffer=null,this.setBlendMode(Ea.BlendModes.NORMAL),e.disable(e.BLEND),e.disable(e.DEPTH_TEST),e.enable(e.CULL_FACE),this.compression=this.getCompressedTextures();var i=function(s){s.createResource()};$i(this.glTextureWrappers,i),$i(this.glBufferWrappers,i),$i(this.glFramebufferWrappers,i),$i(this.glProgramWrappers,i),$i(this.glAttribLocationWrappers,i),$i(this.glUniformLocationWrappers,i),this.createTemporaryTextures(),this.pipelines.restoreContext(),this.resize(this.game.scale.baseSize.width,this.game.scale.baseSize.height),this.setExtensions(),this.contextLost=!1,console&&console.warn("WebGL Context restored. Renderer running again."),this.emit(Ta.RESTORE_WEBGL,this),t.preventDefault()},createTemporaryTextures:function(){for(var t=this.gl,e=0;e<this.maxTextures;e++){var i=t.createTexture();t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,i),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array([0,0,255,255])),this.textureIndexes.push(e)}},captureFrame:function(t,e){t===void 0&&(t=!1),e===void 0&&(e=!1),Sn&&this.spector&&!this._debugCapture&&(this.spector.captureCanvas(this.canvas,0,t,e),this._debugCapture=!0)},captureNextFrame:function(){Sn&&this.spector&&!this._debugCapture&&(this._debugCapture=!0,this.spector.captureNextFrame(this.canvas))},getFps:function(){if(Sn&&this.spector)return this.spector.getFps()},log:function(){if(Sn&&this.spector){var t=Array.prototype.slice.call(arguments).join(" ");return this.spector.log(t)}},startCapture:function(t,e,i){t===void 0&&(t=0),e===void 0&&(e=!1),i===void 0&&(i=!1),Sn&&this.spector&&!this._debugCapture&&(this.spector.startCapture(this.canvas,t,e,i),this._debugCapture=!0)},stopCapture:function(){if(Sn&&this.spector&&this._debugCapture)return this.spector.stopCapture()},onCapture:function(t){if(Sn){var e=this.spector.getResultUI();e.display(t),this._debugCapture=!1}},onResize:function(t,e){(e.width!==this.width||e.height!==this.height)&&this.resize(e.width,e.height)},beginCapture:function(t,e){t===void 0&&(t=this.width),e===void 0&&(e=this.height),this.renderTarget.bind(!0,t,e),this.setProjectionMatrix(t,e)},endCapture:function(){return this.renderTarget.unbind(!0),this.resetProjectionMatrix(),this.renderTarget},resize:function(t,e){var i=this.gl;return this.width=t,this.height=e,this.setProjectionMatrix(t,e),i.viewport(0,0,t,e),this.drawingBufferHeight=i.drawingBufferHeight,i.scissor(0,i.drawingBufferHeight-e,t,e),this.defaultScissor[2]=t,this.defaultScissor[3]=e,this.emit(Ta.RESIZE,t,e),this},getCompressedTextures:function(){var t="WEBGL_compressed_texture_",e="WEBKIT_"+t,i="EXT_texture_compression_",s=function(n,a){var o=n.getExtension(t+a)||n.getExtension(e+a)||n.getExtension(i+a);if(o){var h={};for(var l in o)h[o[l]]=l;return h}},r=this.gl;return{ETC:s(r,"etc"),ETC1:s(r,"etc1"),ATC:s(r,"atc"),ASTC:s(r,"astc"),BPTC:s(r,"bptc"),RGTC:s(r,"rgtc"),PVRTC:s(r,"pvrtc"),S3TC:s(r,"s3tc"),S3TCSRGB:s(r,"s3tc_srgb"),IMG:!0}},getCompressedTextureName:function(t,e){var i=this.compression[t.toUpperCase()];if(e in i)return i[e]},supportsCompressedTexture:function(t,e){var i=this.compression[t.toUpperCase()];return i?e?e in i:!0:!1},getAspectRatio:function(){return this.width/this.height},setProjectionMatrix:function(t,e){return(t!==this.projectionWidth||e!==this.projectionHeight)&&(this.projectionWidth=t,this.projectionHeight=e,this.projectionMatrix.ortho(0,t,e,0,-1e3,1e3)),this},resetProjectionMatrix:function(){return this.setProjectionMatrix(this.width,this.height)},hasExtension:function(t){return this.supportedExtensions?this.supportedExtensions.indexOf(t):!1},getExtension:function(t){return this.hasExtension(t)?(t in this.extensions||(this.extensions[t]=this.gl.getExtension(t)),this.extensions[t]):null},flush:function(){this.pipelines.flush()},pushScissor:function(t,e,i,s,r){r===void 0&&(r=this.drawingBufferHeight);var n=this.scissorStack,a=[t,e,i,s];return n.push(a),this.setScissor(t,e,i,s,r),this.currentScissor=a,a},setScissor:function(t,e,i,s,r){r===void 0&&(r=this.drawingBufferHeight);var n=this.gl,a=this.currentScissor,o=i>0&&s>0;if(a&&o){var h=a[0],l=a[1],c=a[2],d=a[3];o=h!==t||l!==e||c!==i||d!==s}o&&(this.flush(),n.scissor(t,r-e-s,i,s))},resetScissor:function(){var t=this.gl;t.enable(t.SCISSOR_TEST);var e=this.currentScissor;if(e){var i=e[0],s=e[1],r=e[2],n=e[3];r>0&&n>0&&t.scissor(i,this.drawingBufferHeight-s-n,r,n)}},popScissor:function(){var t=this.scissorStack;t.pop();var e=t[t.length-1];e&&this.setScissor(e[0],e[1],e[2],e[3]),this.currentScissor=e},hasActiveStencilMask:function(){var t=this.currentMask.mask,e=this.currentCameraMask.mask;return t&&t.isStencil||e&&e.isStencil},resetViewport:function(){var t=this.gl;t.viewport(0,0,this.width,this.height),this.drawingBufferHeight=t.drawingBufferHeight},setBlendMode:function(t,e){e===void 0&&(e=!1);var i=this.gl,s=this.blendModes[t];return e||t!==Ea.BlendModes.SKIP_CHECK&&this.currentBlendMode!==t?(this.flush(),i.enable(i.BLEND),i.blendEquation(s.equation),s.func.length>2?i.blendFuncSeparate(s.func[0],s.func[1],s.func[2],s.func[3]):i.blendFunc(s.func[0],s.func[1]),this.currentBlendMode=t,!0):!1},addBlendMode:function(t,e){var i=this.blendModes.push({func:t,equation:e});return i-1},updateBlendMode:function(t,e,i){return this.blendModes[t]&&(this.blendModes[t].func=e,i&&(this.blendModes[t].equation=i)),this},removeBlendMode:function(t){return t>17&&this.blendModes[t]&&this.blendModes.splice(t,1),this},pushFramebuffer:function(t,e,i,s,r){return t===this.currentFramebuffer?this:(this.fboStack.push(t),this.setFramebuffer(t,e,i,s,r))},setFramebuffer:function(t,e,i,s,r){if(e===void 0&&(e=!1),i===void 0&&(i=!0),s===void 0&&(s=null),r===void 0&&(r=!1),t===this.currentFramebuffer)return this;var n=this.gl,a=this.width,o=this.height;return t&&t.renderTexture&&i?(a=t.renderTexture.width,o=t.renderTexture.height):this.flush(),t?n.bindFramebuffer(n.FRAMEBUFFER,t.webGLFramebuffer):n.bindFramebuffer(n.FRAMEBUFFER,null),i&&n.viewport(0,0,a,o),s&&n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,s.webGLTexture,0),r&&(n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT)),e&&(t?(this.drawingBufferHeight=o,this.pushScissor(0,0,a,o)):(this.drawingBufferHeight=this.height,this.popScissor())),this.currentFramebuffer=t,this},popFramebuffer:function(t,e){t===void 0&&(t=!1),e===void 0&&(e=!0);var i=this.fboStack;i.pop();var s=i[i.length-1];return s||(s=null),this.setFramebuffer(s,t,e),s},restoreFramebuffer:function(t,e){t===void 0&&(t=!1),e===void 0&&(e=!0);var i=this.fboStack,s=i[i.length-1];s||(s=null),this.currentFramebuffer=null,this.setFramebuffer(s,t,e)},setProgram:function(t){return t!==this.currentProgram?(this.flush(),this.gl.useProgram(t.webGLProgram),this.currentProgram=t,!0):!1},resetProgram:function(){return this.gl.useProgram(this.currentProgram.webGLProgramWrapper),this},createTextureFromSource:function(t,e,i,s,r){r===void 0&&(r=!1);var n=this.gl,a=n.NEAREST,o=n.NEAREST,h=n.CLAMP_TO_EDGE,l=null;e=t?t.width:e,i=t?t.height:i;var c=sf(e,i);if(c&&!r&&(h=n.REPEAT),s===Ea.ScaleModes.LINEAR&&this.config.antialias){var d=t&&t.compressed,f=!d&&c||d&&t.mipmaps.length>1;a=this.mipmapFilter&&f?this.mipmapFilter:n.LINEAR,o=n.LINEAR}return!t&&typeof e=="number"&&typeof i=="number"?l=this.createTexture2D(0,a,o,h,h,n.RGBA,null,e,i):l=this.createTexture2D(0,a,o,h,h,n.RGBA,t),l},createTexture2D:function(t,e,i,s,r,n,a,o,h,l,c,d){typeof o!="number"&&(o=a?a.width:1),typeof h!="number"&&(h=a?a.height:1);var f=new nIe(this.gl,t,e,i,s,r,n,a,o,h,l,c,d);return this.glTextureWrappers.push(f),f},createFramebuffer:function(t,e,i,s){this.currentFramebuffer=null;var r=new aIe(this.gl,t,e,i,s);return this.glFramebufferWrappers.push(r),r},beginBitmapMask:function(t,e){var i=this.gl;i&&(this.flush(),this.maskTarget.bind(!0),this.currentCameraMask.mask!==t&&(this.currentMask.mask=t,this.currentMask.camera=e))},drawBitmapMask:function(t,e,i){this.flush(),this.maskSource.bind(),this.setBlendMode(0,!0),t.renderWebGL(this,t,e),this.maskSource.unbind(!0),this.maskTarget.unbind();var s=this.gl,r=this.getCurrentStencilMask();r?(s.enable(s.STENCIL_TEST),r.mask.applyStencil(this,r.camera,!0)):this.currentMask.mask=null,this.pipelines.set(i),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,this.maskTarget.texture.webGLTexture),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,this.maskSource.texture.webGLTexture)},createProgram:function(t,e){var i=new rIe(this.gl,t,e);return this.glProgramWrappers.push(i),i},createVertexBuffer:function(t,e){var i=this.gl,s=new s$(i,t,i.ARRAY_BUFFER,e);return this.glBufferWrappers.push(s),s},createAttribLocation:function(t,e){var i=new oIe(this.gl,t,e);return this.glAttribLocationWrappers.push(i),i},createUniformLocation:function(t,e){var i=new hIe(this.gl,t,e);return this.glUniformLocationWrappers.push(i),i},createIndexBuffer:function(t,e){var i=this.gl,s=new s$(i,t,i.ELEMENT_ARRAY_BUFFER,e);return this.glBufferWrappers.push(s),s},deleteTexture:function(t){if(t)return Sa(this.glTextureWrappers,t),t.destroy(),this},deleteFramebuffer:function(t){return t?(Sa(this.fboStack,t),Sa(this.glFramebufferWrappers,t),t.destroy(),this):this},deleteProgram:function(t){return t&&(Sa(this.glProgramWrappers,t),t.destroy()),this},deleteAttribLocation:function(t){return t&&(Sa(this.glAttribLocationWrappers,t),t.destroy()),this},deleteUniformLocation:function(t){return t&&(Sa(this.glUniformLocationWrappers,t),t.destroy()),this},deleteBuffer:function(t){return t?(Sa(this.glBufferWrappers,t),t.destroy(),this):this},preRenderCamera:function(t){var e=t.x,i=t.y,s=t.width,r=t.height,n=t.backgroundColor;if(t.emit(e$.PRE_RENDER,t),this.pipelines.preBatchCamera(t),this.pushScissor(e,i,s,r),t.mask&&(this.currentCameraMask.mask=t.mask,this.currentCameraMask.camera=t._maskCamera,t.mask.preRenderWebGL(this,t,t._maskCamera)),n.alphaGL>0){var a=this.pipelines.setMulti();a.drawFillRect(e,i,s,r,fA.getTintFromFloats(n.blueGL,n.greenGL,n.redGL,1),n.alphaGL)}},getCurrentStencilMask:function(){var t=null,e=this.maskStack,i=this.currentCameraMask;return e.length>0?t=e[e.length-1]:i.mask&&i.mask.isStencil&&(t=i),t},postRenderCamera:function(t){var e=t.fadeEffect;if(e.isRunning||e.isComplete){var i=this.pipelines.setMulti();e.postRenderWebGL(i,fA.getTintFromFloats)}t.dirty=!1,this.popScissor(),t.mask&&(this.currentCameraMask.mask=null,t.mask.postRenderWebGL(this,t._maskCamera)),this.pipelines.postBatchCamera(t),t.emit(e$.POST_RENDER,t)},preRender:function(){if(!this.contextLost){var t=this.gl;if(t.bindFramebuffer(t.FRAMEBUFFER,null),this.emit(Ta.PRE_RENDER_CLEAR),this.config.clearBeforeRender){var e=this.config.backgroundColor;t.clearColor(e.redGL,e.greenGL,e.blueGL,e.alphaGL),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT)}t.enable(t.SCISSOR_TEST),this.currentScissor=this.defaultScissor,this.scissorStack.length=0,this.scissorStack.push(this.currentScissor),this.game.scene.customViewports&&t.scissor(0,this.drawingBufferHeight-this.height,this.width,this.height),this.currentMask.mask=null,this.currentCameraMask.mask=null,this.maskStack.length=0,this.emit(Ta.PRE_RENDER)}},render:function(t,e,i){if(!this.contextLost){var s=e.length;if(this.emit(Ta.RENDER,t,i),this.preRenderCamera(i),s===0){this.setBlendMode(Ea.BlendModes.NORMAL),this.postRenderCamera(i);return}this.currentType="";for(var r=this.currentMask,n=0;n<s;n++){this.finalType=n===s-1;var a=e[n],o=a.mask;r=this.currentMask,r.mask&&r.mask!==o&&r.mask.postRenderWebGL(this,r.camera),o&&r.mask!==o&&o.preRenderWebGL(this,a,i),a.blendMode!==this.currentBlendMode&&this.setBlendMode(a.blendMode);var h=a.type;h!==this.currentType&&(this.newType=!0,this.currentType=h),this.finalType?this.nextTypeMatch=!1:this.nextTypeMatch=e[n+1].type===this.currentType,a.renderWebGL(this,a,i),this.newType=!1}r=this.currentMask,r.mask&&r.mask.postRenderWebGL(this,r.camera),this.setBlendMode(Ea.BlendModes.NORMAL),this.postRenderCamera(i)}},postRender:function(){if(!this.contextLost){this.flush(),this.emit(Ta.POST_RENDER);var t=this.snapshotState;t.callback&&(i$(this.gl,t),t.callback=null)}},clearStencilMask:function(){this.gl.disable(this.gl.STENCIL_TEST)},restoreStencilMask:function(){var t=this.gl,e=this.getCurrentStencilMask();if(e){var i=e.mask;t.enable(t.STENCIL_TEST),i.invertAlpha?t.stencilFunc(t.NOTEQUAL,i.level,255):t.stencilFunc(t.EQUAL,i.level,255)}},snapshot:function(t,e,i){return this.snapshotArea(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight,t,e,i)},snapshotArea:function(t,e,i,s,r,n,a){var o=this.snapshotState;return o.callback=r,o.type=n,o.encoder=a,o.getPixel=!1,o.x=t,o.y=e,o.width=i,o.height=s,this},snapshotPixel:function(t,e,i){return this.snapshotArea(t,e,1,1,i),this.snapshotState.getPixel=!0,this},snapshotFramebuffer:function(t,e,i,s,r,n,a,o,h,l,c){r===void 0&&(r=!1),n===void 0&&(n=0),a===void 0&&(a=0),o===void 0&&(o=e),h===void 0&&(h=i),l==="pixel"&&(r=!0,l="image/png");var d=this.currentFramebuffer;this.snapshotArea(n,a,o,h,s,l,c);var f=this.snapshotState;return f.getPixel=r,f.isFramebuffer=!0,f.bufferWidth=e,f.bufferHeight=i,f.width=Math.min(f.width,e),f.height=Math.min(f.height,i),this.setFramebuffer(t),i$(this.gl,f),this.setFramebuffer(d),f.callback=null,f.isFramebuffer=!1,this},canvasToTexture:function(t,e,i,s){i===void 0&&(i=!1),s===void 0&&(s=!1);var r=this.gl,n=r.NEAREST,a=r.NEAREST,o=t.width,h=t.height,l=r.CLAMP_TO_EDGE,c=sf(o,h);return!i&&c&&(l=r.REPEAT),this.config.antialias&&(n=c&&this.mipmapFilter?this.mipmapFilter:r.LINEAR,a=r.LINEAR),e?(e.update(t,o,h,s,l,l,n,a,e.format),e):this.createTexture2D(0,n,a,l,l,r.RGBA,t,o,h,!0,!1,s)},createCanvasTexture:function(t,e,i){return e===void 0&&(e=!1),i===void 0&&(i=!1),this.canvasToTexture(t,null,e,i)},updateCanvasTexture:function(t,e,i,s){return i===void 0&&(i=!1),s===void 0&&(s=!1),this.canvasToTexture(t,e,s,i)},videoToTexture:function(t,e,i,s){i===void 0&&(i=!1),s===void 0&&(s=!1);var r=this.gl,n=r.NEAREST,a=r.NEAREST,o=t.videoWidth,h=t.videoHeight,l=r.CLAMP_TO_EDGE,c=sf(o,h);return!i&&c&&(l=r.REPEAT),this.config.antialias&&(n=c&&this.mipmapFilter?this.mipmapFilter:r.LINEAR,a=r.LINEAR),e?(e.update(t,o,h,s,l,l,n,a,e.format),e):this.createTexture2D(0,n,a,l,l,r.RGBA,t,o,h,!0,!0,s)},createVideoTexture:function(t,e,i){return e===void 0&&(e=!1),i===void 0&&(i=!1),this.videoToTexture(t,null,e,i)},updateVideoTexture:function(t,e,i,s){return i===void 0&&(i=!1),s===void 0&&(s=!1),this.videoToTexture(t,e,s,i)},createUint8ArrayTexture:function(t,e,i){var s=this.gl,r=s.NEAREST,n=s.NEAREST,a=s.CLAMP_TO_EDGE,o=sf(e,i);return o&&(a=s.REPEAT),this.createTexture2D(0,r,n,a,a,s.RGBA,t,e,i)},setTextureFilter:function(t,e){var i=this.gl,s=e===0?i.LINEAR:i.NEAREST;i.activeTexture(i.TEXTURE0);var r=i.getParameter(i.TEXTURE_BINDING_2D);return i.bindTexture(i.TEXTURE_2D,t.webGLTexture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,s),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,s),t.minFilter=s,t.magFilter=s,r&&i.bindTexture(i.TEXTURE_2D,r),this},getMaxTextureSize:function(){return this.config.maxTextureSize},destroy:function(){this.canvas.removeEventListener("webglcontextlost",this.contextLostHandler,!1),this.canvas.removeEventListener("webglcontextrestored",this.contextRestoredHandler,!1);var t=function(e){e.destroy()};$i(this.glAttribLocationWrappers,t),$i(this.glBufferWrappers,t),$i(this.glFramebufferWrappers,t),$i(this.glProgramWrappers,t),$i(this.glTextureWrappers,t),$i(this.glUniformLocationWrappers,t),this.maskTarget.destroy(),this.maskSource.destroy(),this.pipelines.destroy(),this.removeAllListeners(),this.fboStack=[],this.maskStack=[],this.extensions={},this.textureIndexes=[],this.gl=null,this.game=null,this.canvas=null,this.contextLost=!0,this.currentMask=null,this.currentCameraMask=null,Sn&&(this.spector=null)}});r$.exports=lIe});var a$=u((Mct,n$)=>{"use strict";var uIe={WebGLAttribLocationWrapper:uA(),WebGLBufferWrapper:nA(),WebGLProgramWrapper:aA(),WebGLTextureWrapper:tf(),WebGLFramebufferWrapper:lA(),WebGLUniformLocationWrapper:cA()};n$.exports=uIe});var h$=u((Oct,o$)=>{"use strict";var cIe=xo(),dIe=mi(),mA={PipelineManager:sA(),Pipelines:hb(),RenderTarget:fl(),WebGLPipeline:Co(),WebGLRenderer:pA(),Wrappers:a$()};mA=dIe(!1,mA,cIe);o$.exports=mA});var l$=u((Dct,vA)=>{"use strict";vA.exports={Events:yo()};vA.exports.WebGL=h$()});var m$=u((Fct,p$)=>{"use strict";p$.exports="add"});var g$=u((kct,v$)=>{"use strict";v$.exports="remove"});var E$=u((Gct,S$)=>{"use strict";S$.exports={ADD:m$(),REMOVE:g$()}});var b$=u((qct,y$)=>{"use strict";var pIe=R(),mIe=Ch(),vIe=ze(),T$=E$(),gIe=new pIe({initialize:function(){this.entries=new mIe,this.events=new vIe},add:function(t,e){return this.entries.set(t,e),this.events.emit(T$.ADD,this,t,e),this},has:function(t){return this.entries.has(t)},exists:function(t){return this.entries.has(t)},get:function(t){return this.entries.get(t)},remove:function(t){var e=this.get(t);return e&&(this.entries.delete(t),this.events.emit(T$.REMOVE,this,t,e.data)),this},getKeys:function(){return this.entries.keys()},destroy:function(){this.entries.clear(),this.events.removeAllListeners(),this.entries=null,this.events=null}});y$.exports=gIe});var x$=u((Wct,A$)=>{"use strict";var Li=b$(),SIe=R(),EIe=vi(),TIe=new SIe({initialize:function(e){this.game=e,this.binary=new Li,this.bitmapFont=new Li,this.json=new Li,this.physics=new Li,this.shader=new Li,this.audio=new Li,this.video=new Li,this.text=new Li,this.html=new Li,this.obj=new Li,this.tilemap=new Li,this.xml=new Li,this.custom={},this.game.events.once(EIe.DESTROY,this.destroy,this)},addCustom:function(t){return this.custom.hasOwnProperty(t)||(this.custom[t]=new Li),this.custom[t]},destroy:function(){for(var t=["binary","bitmapFont","json","physics","shader","audio","video","text","html","obj","tilemap","xml"],e=0;e<t.length;e++)this[t[e]].destroy(),this[t[e]]=null;for(var i in this.custom)this.custom[i].destroy();this.custom=null,this.game=null}});A$.exports=TIe});var I$=u((Yct,_$)=>{"use strict";var yIe=R(),nf=Qi(),bIe=kp(),af=th(),C$=re(),M=Ne(),AIe=Xt(),w$=Ie(),R$=ve(),xIe=dl(),P$=hu(),CIe=new yIe({initialize:function(e){e===void 0&&(e={});var i=["#ff0000","#ffff00","#00ff00","#00ffff","#000000"],s="#ffffff",r=M(e,"scale",null);this.width=M(r,"width",1024,e),this.height=M(r,"height",768,e),this.zoom=M(r,"zoom",1,e),this.parent=M(r,"parent",void 0,e),this.scaleMode=M(r,r?"mode":"scaleMode",0,e),this.expandParent=M(r,"expandParent",!0,e),this.autoRound=M(r,"autoRound",!1,e),this.autoCenter=M(r,"autoCenter",0,e),this.resizeInterval=M(r,"resizeInterval",500,e),this.fullscreenTarget=M(r,"fullscreenTarget",null,e),this.minWidth=M(r,"min.width",0,e),this.maxWidth=M(r,"max.width",0,e),this.minHeight=M(r,"min.height",0,e),this.maxHeight=M(r,"max.height",0,e),this.snapWidth=M(r,"snap.width",0,e),this.snapHeight=M(r,"snap.height",0,e),this.renderType=M(e,"type",nf.AUTO),this.canvas=M(e,"canvas",null),this.context=M(e,"context",null),this.canvasStyle=M(e,"canvasStyle",null),this.customEnvironment=M(e,"customEnvironment",!1),this.sceneConfig=M(e,"scene",null),this.seed=M(e,"seed",[(Date.now()*Math.random()).toString()]),R$.RND=new R$.RandomDataGenerator(this.seed),this.gameTitle=M(e,"title",""),this.gameURL=M(e,"url","https://phaser.io/"+nf.LOG_VERSION),this.gameVersion=M(e,"version",""),this.autoFocus=M(e,"autoFocus",!0),this.stableSort=M(e,"stableSort",-1),this.stableSort===-1&&(this.stableSort=af.browser.es2019?1:0),af.features.stableSort=this.stableSort,this.domCreateContainer=M(e,"dom.createContainer",!1),this.domPointerEvents=M(e,"dom.pointerEvents","none"),this.inputKeyboard=M(e,"input.keyboard",!0),this.inputKeyboardEventTarget=M(e,"input.keyboard.target",window),this.inputKeyboardCapture=M(e,"input.keyboard.capture",[]),this.inputMouse=M(e,"input.mouse",!0),this.inputMouseEventTarget=M(e,"input.mouse.target",null),this.inputMousePreventDefaultDown=M(e,"input.mouse.preventDefaultDown",!0),this.inputMousePreventDefaultUp=M(e,"input.mouse.preventDefaultUp",!0),this.inputMousePreventDefaultMove=M(e,"input.mouse.preventDefaultMove",!0),this.inputMousePreventDefaultWheel=M(e,"input.mouse.preventDefaultWheel",!0),this.inputTouch=M(e,"input.touch",af.input.touch),this.inputTouchEventTarget=M(e,"input.touch.target",null),this.inputTouchCapture=M(e,"input.touch.capture",!0),this.inputActivePointers=M(e,"input.activePointers",1),this.inputSmoothFactor=M(e,"input.smoothFactor",0),this.inputWindowEvents=M(e,"input.windowEvents",!0),this.inputGamepad=M(e,"input.gamepad",!1),this.inputGamepadEventTarget=M(e,"input.gamepad.target",window),this.disableContextMenu=M(e,"disableContextMenu",!1),this.audio=M(e,"audio",{}),this.hideBanner=M(e,"banner",null)===!1,this.hidePhaser=M(e,"banner.hidePhaser",!1),this.bannerTextColor=M(e,"banner.text",s),this.bannerBackgroundColor=M(e,"banner.background",i),this.gameTitle===""&&this.hidePhaser&&(this.hideBanner=!0),this.fps=M(e,"fps",null),this.disablePreFX=M(e,"disablePreFX",!1),this.disablePostFX=M(e,"disablePostFX",!1);var n=M(e,"render",null);this.pipeline=M(n,"pipeline",null,e),this.autoMobilePipeline=M(n,"autoMobilePipeline",!0,e),this.defaultPipeline=M(n,"defaultPipeline",xIe.MULTI_PIPELINE,e),this.antialias=M(n,"antialias",!0,e),this.antialiasGL=M(n,"antialiasGL",!0,e),this.mipmapFilter=M(n,"mipmapFilter","",e),this.desynchronized=M(n,"desynchronized",!1,e),this.roundPixels=M(n,"roundPixels",!1,e),this.pixelArt=M(n,"pixelArt",this.zoom!==1,e),this.pixelArt&&(this.antialias=!1,this.antialiasGL=!1,this.roundPixels=!0),this.transparent=M(n,"transparent",!1,e),this.clearBeforeRender=M(n,"clearBeforeRender",!0,e),this.preserveDrawingBuffer=M(n,"preserveDrawingBuffer",!1,e),this.premultipliedAlpha=M(n,"premultipliedAlpha",!0,e),this.failIfMajorPerformanceCaveat=M(n,"failIfMajorPerformanceCaveat",!1,e),this.powerPreference=M(n,"powerPreference","default",e),this.batchSize=M(n,"batchSize",4096,e),this.maxTextures=M(n,"maxTextures",-1,e),this.maxLights=M(n,"maxLights",10,e);var a=M(e,"backgroundColor",0);this.backgroundColor=P$(a),this.transparent&&(this.backgroundColor=P$(0),this.backgroundColor.alpha=0),this.preBoot=M(e,"callbacks.preBoot",w$),this.postBoot=M(e,"callbacks.postBoot",w$),this.physics=M(e,"physics",{}),this.defaultPhysicsSystem=M(this.physics,"default",!1),this.loaderBaseURL=M(e,"loader.baseURL",""),this.loaderPath=M(e,"loader.path",""),this.loaderMaxParallelDownloads=M(e,"loader.maxParallelDownloads",af.os.android?6:32),this.loaderCrossOrigin=M(e,"loader.crossOrigin",void 0),this.loaderResponseType=M(e,"loader.responseType",""),this.loaderAsync=M(e,"loader.async",!0),this.loaderUser=M(e,"loader.user",""),this.loaderPassword=M(e,"loader.password",""),this.loaderTimeout=M(e,"loader.timeout",0),this.loaderMaxRetries=M(e,"loader.maxRetries",2),this.loaderWithCredentials=M(e,"loader.withCredentials",!1),this.loaderImageLoadType=M(e,"loader.imageLoadType","XHR"),this.loaderLocalScheme=M(e,"loader.localScheme",["file://","capacitor://"]),this.glowFXQuality=M(e,"fx.glow.quality",.1),this.glowFXDistance=M(e,"fx.glow.distance",10),this.installGlobalPlugins=[],this.installScenePlugins=[];var o=M(e,"plugins",null),h=bIe.DefaultScene;o&&(Array.isArray(o)?this.defaultPlugins=o:AIe(o)&&(this.installGlobalPlugins=C$(o,"global",[]),this.installScenePlugins=C$(o,"scene",[]),Array.isArray(o.default)?h=o.default:Array.isArray(o.defaultMerge)&&(h=h.concat(o.defaultMerge)))),this.defaultPlugins=h;var l="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAg";this.defaultImage=M(e,"images.default",l+"AQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAABVJREFUeF7NwIEAAAAAgKD9qdeocAMAoAABm3DkcAAAAABJRU5ErkJggg=="),this.missingImage=M(e,"images.missing",l+"CAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg=="),this.whiteImage=M(e,"images.white","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAIAAAAmkwkpAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABdJREFUeNpi/P//PwMMMDEgAdwcgAADAJZuAwXJYZOzAAAAAElFTkSuQmCC"),window&&(window.FORCE_WEBGL?this.renderType=nf.WEBGL:window.FORCE_CANVAS&&(this.renderType=nf.CANVAS))}});_$.exports=CIe});var M$=u((Hct,L$)=>{"use strict";var wIe=Qu(),RIe=function(t){var e=t.config;if(!(!e.parent||!e.domCreateContainer)){var i=document.createElement("div");i.style.cssText=["display: block;","width: "+t.scale.width+"px;","height: "+t.scale.height+"px;","padding: 0; margin: 0;","position: absolute;","overflow: hidden;","pointer-events: "+e.domPointerEvents+";","transform: scale(1);","transform-origin: left top;"].join(" "),t.domContainer=i,wIe(i,e.parent)}};L$.exports=RIe});var B$=u((zct,D$)=>{"use strict";var O$=Ui(),_r=Qi(),SA=Zl(),PIe=function(t){var e=t.config;if((e.customEnvironment||e.canvas)&&e.renderType===_r.AUTO)throw new Error("Must set explicit renderType in custom environment");if(!e.customEnvironment&&!e.canvas&&e.renderType!==_r.HEADLESS)if(e.renderType===_r.AUTO&&(e.renderType=SA.webGL?_r.WEBGL:_r.CANVAS),e.renderType===_r.WEBGL){if(!SA.webGL)throw new Error("Cannot create WebGL context, aborting.")}else if(e.renderType===_r.CANVAS){if(!SA.canvas)throw new Error("Cannot create Canvas context, aborting.")}else throw new Error("Unknown value for renderer type: "+e.renderType);e.antialias||O$.disableSmoothing();var i=t.scale.baseSize,s=i.width,r=i.height;if(e.canvas?(t.canvas=e.canvas,t.canvas.width=s,t.canvas.height=r):t.canvas=O$.create(t,s,r,e.renderType),e.canvasStyle&&(t.canvas.style=e.canvasStyle),e.renderType!==_r.HEADLESS){var n,a;a=pA(),e.renderType=_r.WEBGL,t.renderer=new a(t)}};D$.exports=PIe});var N$=u((Vct,U$)=>{"use strict";var _Ie=La(),IIe=function(t){if(document.readyState==="complete"||document.readyState==="interactive"){t();return}var e=function(){document.removeEventListener("deviceready",e,!0),document.removeEventListener("DOMContentLoaded",e,!0),window.removeEventListener("load",e,!0),t()};document.body?_Ie.cordova?document.addEventListener("deviceready",e,!1):(document.addEventListener("DOMContentLoaded",e,!0),window.addEventListener("load",e,!0)):window.setTimeout(e,20)};U$.exports=IIe});var H$=u((Xct,Y$)=>{"use strict";var LIe=R(),F$=vi(),k$=ze(),MIe=Wi(),G$=ai(),q$=dt(),En=re(),Mi=Vt(),W$=tr(),OIe=Qi(),DIe=new LIe({Extends:k$,initialize:function(e){k$.call(this),this.game=e,this.plugins=[],this.scenePlugins=[],this._pendingGlobal=[],this._pendingScene=[],e.isBooted||e.config.renderType===OIe.HEADLESS?this.boot():e.events.once(F$.BOOT,this.boot,this)},boot:function(){var t,e,i,s,r,n,a,o=this.game.config,h=o.installGlobalPlugins;for(h=h.concat(this._pendingGlobal),t=0;t<h.length;t++)e=h[t],i=En(e,"key",null),s=En(e,"plugin",null),r=En(e,"start",!1),n=En(e,"mapping",null),a=En(e,"data",null),i&&(s?this.install(i,s,r,n,a):console.warn("Missing `plugin` for key: "+i));for(h=o.installScenePlugins,h=h.concat(this._pendingScene),t=0;t<h.length;t++)e=h[t],i=En(e,"key",null),s=En(e,"plugin",null),n=En(e,"mapping",null),i&&(s?this.installScenePlugin(i,s,n):console.warn("Missing `plugin` for key: "+i));this._pendingGlobal=[],this._pendingScene=[],this.game.events.once(F$.DESTROY,this.destroy,this)},addToScene:function(t,e,i){var s,r,n,a=this.game,o=t.scene,h=t.settings.map,l=t.settings.isBooted;for(s=0;s<e.length;s++)r=e[s],a[r]?(t[r]=a[r],h.hasOwnProperty(r)&&(o[h[r]]=t[r])):r==="game"&&h.hasOwnProperty(r)&&(o[h[r]]=a);for(var c=0;c<i.length;c++)for(n=i[c],s=0;s<n.length;s++)if(r=n[s],!!Mi.hasCore(r)){var d=Mi.getCore(r),f=d.mapping,p=new d.plugin(o,this,f);t[f]=p,d.custom?o[f]=p:h.hasOwnProperty(f)&&(o[h[f]]=p),l&&p.boot()}for(n=this.plugins,s=0;s<n.length;s++){var m=n[s];m.mapping&&(o[m.mapping]=m.plugin)}},getDefaultScenePlugins:function(){var t=this.game.config.defaultPlugins;return t=t.concat(this.scenePlugins),t},installScenePlugin:function(t,e,i,s,r){if(r===void 0&&(r=!1),typeof e!="function"){console.warn("Invalid Scene Plugin: "+t);return}if(Mi.hasCore(t)||Mi.register(t,e,i,!0),this.scenePlugins.indexOf(t)===-1)this.scenePlugins.push(t);else if(!r&&Mi.hasCore(t)){console.warn("Scene Plugin key in use: "+t);return}if(s){var n=new e(s,this,t);s.sys[t]=n,i&&i!==""&&(s[i]=n),n.boot()}},install:function(t,e,i,s,r){if(i===void 0&&(i=!1),s===void 0&&(s=null),r===void 0&&(r=null),typeof e!="function")return console.warn("Invalid Plugin: "+t),null;if(Mi.hasCustom(t))return console.warn("Plugin key in use: "+t),null;if(s!==null&&(i=!0),!this.game.isBooted)this._pendingGlobal.push({key:t,plugin:e,start:i,mapping:s,data:r});else if(Mi.registerCustom(t,e,s,r),i)return this.start(t);return null},getIndex:function(t){for(var e=this.plugins,i=0;i<e.length;i++){var s=e[i];if(s.key===t)return i}return-1},getEntry:function(t){var e=this.getIndex(t);if(e!==-1)return this.plugins[e]},isActive:function(t){var e=this.getEntry(t);return e&&e.active},start:function(t,e){e===void 0&&(e=t);var i=this.getEntry(e);return i&&!i.active?(i.active=!0,i.plugin.start()):i||(i=this.createEntry(t,e)),i?i.plugin:null},createEntry:function(t,e){var i=Mi.getCustom(t);if(i){var s=new i.plugin(this);i={key:e,plugin:s,active:!0,mapping:i.mapping,data:i.data},this.plugins.push(i),s.init(i.data),s.start()}return i},stop:function(t){var e=this.getEntry(t);return e&&e.active&&(e.active=!1,e.plugin.stop()),this},get:function(t,e){e===void 0&&(e=!0);var i=this.getEntry(t);if(i)return i.plugin;var s=this.getClass(t);return s&&e?(i=this.createEntry(t,t),i?i.plugin:null):s||null},getClass:function(t){return Mi.getCustomClass(t)},removeGlobalPlugin:function(t){var e=this.getEntry(t);e&&W$(this.plugins,e),Mi.removeCustom(t)},removeScenePlugin:function(t){W$(this.scenePlugins,t),Mi.remove(t)},registerGameObject:function(t,e,i){return e&&q$.register(t,e),i&&G$.register(t,i),this},removeGameObject:function(t,e,i){return e===void 0&&(e=!0),i===void 0&&(i=!0),e&&q$.remove(t),i&&G$.remove(t),this},registerFileType:function(t,e,i){MIe.register(t,e),i&&i.sys.load&&(i.sys.load[t]=e)},destroy:function(){for(var t=0;t<this.plugins.length;t++)this.plugins[t].plugin.destroy();Mi.destroyCustomPlugins(),this.game.noReturn&&Mi.destroyCorePlugins(),this.game=null,this.plugins=[],this.scenePlugins=[]}});Y$.exports=DIe});var V$=u((Kct,z$)=>{"use strict";z$.exports={NO_CENTER:0,CENTER_BOTH:1,CENTER_HORIZONTALLY:2,CENTER_VERTICALLY:3}});var K$=u((Zct,X$)=>{"use strict";X$.exports={LANDSCAPE:"landscape-primary",LANDSCAPE_SECONDARY:"landscape-secondary",PORTRAIT:"portrait-primary",PORTRAIT_SECONDARY:"portrait-secondary"}});var j$=u((jct,Z$)=>{"use strict";Z$.exports={NONE:0,WIDTH_CONTROLS_HEIGHT:1,HEIGHT_CONTROLS_WIDTH:2,FIT:3,ENVELOP:4,RESIZE:5,EXPAND:6}});var J$=u(($ct,$$)=>{"use strict";$$.exports={NO_ZOOM:1,ZOOM_2X:2,ZOOM_4X:4,MAX_ZOOM:-1}});var EA=u((Jct,Q$)=>{"use strict";var BIe={CENTER:V$(),ORIENTATION:K$(),SCALE_MODE:j$(),ZOOM:J$()};Q$.exports=BIe});var tJ=u((Qct,eJ)=>{"use strict";var UIe=function(t){if(!t)return window.innerHeight;var e=Math.abs(window.orientation),i={w:0,h:0},s=document.createElement("div");return s.setAttribute("style","position: fixed; height: 100vh; width: 0; top: 0"),document.documentElement.appendChild(s),i.w=e===90?s.offsetHeight:window.innerWidth,i.h=e===90?window.innerWidth:s.offsetHeight,document.documentElement.removeChild(s),s=null,Math.abs(window.orientation)!==90?i.h:i.w};eJ.exports=UIe});var sJ=u((edt,iJ)=>{"use strict";var NIe=function(t){var e;return t!==""&&(typeof t=="string"?e=document.getElementById(t):t&&t.nodeType===1&&(e=t)),e||(e=document.body),e};iJ.exports=NIe});var nJ=u((tdt,rJ)=>{"use strict";var Yo=EA(),FIe=function(t,e){var i=window.screen,s=i?i.orientation||i.mozOrientation||i.msOrientation:!1;if(s&&typeof s.type=="string")return s.type;if(typeof s=="string")return s;if(typeof window.orientation=="number")return window.orientation===0||window.orientation===180?Yo.ORIENTATION.PORTRAIT:Yo.ORIENTATION.LANDSCAPE;if(window.matchMedia){if(window.matchMedia("(orientation: portrait)").matches)return Yo.ORIENTATION.PORTRAIT;if(window.matchMedia("(orientation: landscape)").matches)return Yo.ORIENTATION.LANDSCAPE}else return e>t?Yo.ORIENTATION.PORTRAIT:Yo.ORIENTATION.LANDSCAPE};rJ.exports=FIe});var TA=u((idt,aJ)=>{"use strict";var kIe=function(t,e,i,s){return i===void 0&&(i=0),e===0?t:(t-=i,t=e*Math.floor(t/e),s?(i+t)/e:i+t)};aJ.exports=kIe});var hJ=u((sdt,oJ)=>{"use strict";var Ho=Je(),GIe=R(),Js=TA(),qIe=Fe(),As=new GIe({initialize:function(e,i,s,r){e===void 0&&(e=0),i===void 0&&(i=e),s===void 0&&(s=0),r===void 0&&(r=null),this._width=e,this._height=i,this._parent=r,this.aspectMode=s,this.aspectRatio=i===0?1:e/i,this.minWidth=0,this.minHeight=0,this.maxWidth=Number.MAX_VALUE,this.maxHeight=Number.MAX_VALUE,this.snapTo=new qIe},setAspectMode:function(t){return t===void 0&&(t=0),this.aspectMode=t,this.setSize(this._width,this._height)},setSnap:function(t,e){return t===void 0&&(t=0),e===void 0&&(e=t),this.snapTo.set(t,e),this.setSize(this._width,this._height)},setParent:function(t){return this._parent=t,this.setSize(this._width,this._height)},setMin:function(t,e){return t===void 0&&(t=0),e===void 0&&(e=t),this.minWidth=Ho(t,0,this.maxWidth),this.minHeight=Ho(e,0,this.maxHeight),this.setSize(this._width,this._height)},setMax:function(t,e){return t===void 0&&(t=Number.MAX_VALUE),e===void 0&&(e=t),this.maxWidth=Ho(t,this.minWidth,Number.MAX_VALUE),this.maxHeight=Ho(e,this.minHeight,Number.MAX_VALUE),this.setSize(this._width,this._height)},setSize:function(t,e){switch(t===void 0&&(t=0),e===void 0&&(e=t),this.aspectMode){case As.NONE:this._width=this.getNewWidth(Js(t,this.snapTo.x)),this._height=this.getNewHeight(Js(e,this.snapTo.y)),this.aspectRatio=this._height===0?1:this._width/this._height;break;case As.WIDTH_CONTROLS_HEIGHT:this._width=this.getNewWidth(Js(t,this.snapTo.x)),this._height=this.getNewHeight(this._width*(1/this.aspectRatio),!1);break;case As.HEIGHT_CONTROLS_WIDTH:this._height=this.getNewHeight(Js(e,this.snapTo.y)),this._width=this.getNewWidth(this._height*this.aspectRatio,!1);break;case As.FIT:this.constrain(t,e,!0);break;case As.ENVELOP:this.constrain(t,e,!1);break}return this},setAspectRatio:function(t){return this.aspectRatio=t,this.setSize(this._width,this._height)},resize:function(t,e){return this._width=this.getNewWidth(Js(t,this.snapTo.x)),this._height=this.getNewHeight(Js(e,this.snapTo.y)),this.aspectRatio=this._height===0?1:this._width/this._height,this},getNewWidth:function(t,e){return e===void 0&&(e=!0),t=Ho(t,this.minWidth,this.maxWidth),e&&this._parent&&t>this._parent.width&&(t=Math.max(this.minWidth,this._parent.width)),t},getNewHeight:function(t,e){return e===void 0&&(e=!0),t=Ho(t,this.minHeight,this.maxHeight),e&&this._parent&&t>this._parent.height&&(t=Math.max(this.minHeight,this._parent.height)),t},constrain:function(t,e,i){t===void 0&&(t=0),e===void 0&&(e=t),i===void 0&&(i=!0),t=this.getNewWidth(t),e=this.getNewHeight(e);var s=this.snapTo,r=e===0?1:t/e;return i&&this.aspectRatio>r||!i&&this.aspectRatio<r?(t=Js(t,s.x),e=t/this.aspectRatio,s.y>0&&(e=Js(e,s.y),t=e*this.aspectRatio)):(i&&this.aspectRatio<r||!i&&this.aspectRatio>r)&&(e=Js(e,s.y),t=e*this.aspectRatio,s.x>0&&(t=Js(t,s.x),e=t*(1/this.aspectRatio))),this._width=t,this._height=e,this},fitTo:function(t,e){return this.constrain(t,e,!0)},envelop:function(t,e){return this.constrain(t,e,!1)},setWidth:function(t){return this.setSize(t,this._height)},setHeight:function(t){return this.setSize(this._width,t)},toString:function(){return"[{ Size (width="+this._width+" height="+this._height+" aspectRatio="+this.aspectRatio+" aspectMode="+this.aspectMode+") }]"},setCSS:function(t){t&&t.style&&(t.style.width=this._width+"px",t.style.height=this._height+"px")},copy:function(t){return t.setAspectMode(this.aspectMode),t.aspectRatio=this.aspectRatio,t.setSize(this.width,this.height)},destroy:function(){this._parent=null,this.snapTo=null},width:{get:function(){return this._width},set:function(t){this.setSize(t,this._height)}},height:{get:function(){return this._height},set:function(t){this.setSize(this._width,t)}}});As.NONE=0;As.WIDTH_CONTROLS_HEIGHT=1;As.HEIGHT_CONTROLS_WIDTH=2;As.FIT=3;As.ENVELOP=4;oJ.exports=As});var mJ=u((ndt,pJ)=>{"use strict";var zt=EA(),WIe=R(),lJ=ze(),ya=Su(),of=vi(),rdt=tJ(),uJ=sJ(),cJ=nJ(),hf=Ie(),dJ=Ze(),lf=hJ(),fJ=TA(),YIe=Fe(),HIe=ch(),zIe=new WIe({Extends:lJ,initialize:function(e){lJ.call(this),this.game=e,this.canvas,this.canvasBounds=new dJ,this.parent=null,this.parentIsWindow=!1,this.parentSize=new lf,this.gameSize=new lf,this.baseSize=new lf,this.displaySize=new lf,this.scaleMode=zt.SCALE_MODE.NONE,this.zoom=1,this._resetZoom=!1,this.displayScale=new YIe(1,1),this.autoRound=!1,this.autoCenter=zt.CENTER.NO_CENTER,this.orientation=zt.ORIENTATION.LANDSCAPE,this.fullscreen,this.fullscreenTarget=null,this._createdFullscreenTarget=!1,this.dirty=!1,this.resizeInterval=500,this._lastCheck=0,this._checkOrientation=!1,this.domlisteners={orientationChange:hf,windowResize:hf,fullScreenChange:hf,fullScreenError:hf}},preBoot:function(){this.parseConfig(this.game.config),this.game.events.once(of.BOOT,this.boot,this)},boot:function(){var t=this.game;this.canvas=t.canvas,this.fullscreen=t.device.fullscreen;var e=this.scaleMode;e!==zt.SCALE_MODE.RESIZE&&e!==zt.SCALE_MODE.EXPAND&&this.displaySize.setAspectMode(e),e===zt.SCALE_MODE.NONE?this.resize(this.width,this.height):(this.getParentBounds(),this.parentSize.width>0&&this.parentSize.height>0&&this.displaySize.setParent(this.parentSize),this.refresh()),t.events.on(of.PRE_STEP,this.step,this),t.events.once(of.READY,this.refresh,this),t.events.once(of.DESTROY,this.destroy,this),this.startListeners()},parseConfig:function(t){this.getParent(t),this.getParentBounds();var e=t.width,i=t.height,s=t.scaleMode,r=t.zoom,n=t.autoRound;if(typeof e=="string")if(e.substr(-1)!=="%")e=parseInt(e,10);else{var a=this.parentSize.width;a===0&&(a=window.innerWidth);var o=parseInt(e,10)/100;e=Math.floor(a*o)}if(typeof i=="string")if(i.substr(-1)!=="%")i=parseInt(i,10);else{var h=this.parentSize.height;h===0&&(h=window.innerHeight);var l=parseInt(i,10)/100;i=Math.floor(h*l)}this.scaleMode=s,this.autoRound=n,this.autoCenter=t.autoCenter,this.resizeInterval=t.resizeInterval,n&&(e=Math.floor(e),i=Math.floor(i)),this.gameSize.setSize(e,i),r===zt.ZOOM.MAX_ZOOM&&(r=this.getMaxZoom()),this.zoom=r,r!==1&&(this._resetZoom=!0),this.baseSize.setSize(e,i),n&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),t.minWidth>0&&this.displaySize.setMin(t.minWidth*r,t.minHeight*r),t.maxWidth>0&&this.displaySize.setMax(t.maxWidth*r,t.maxHeight*r),this.displaySize.setSize(e,i),(t.snapWidth>0||t.snapHeight>0)&&this.displaySize.setSnap(t.snapWidth,t.snapHeight),this.orientation=cJ(e,i)},getParent:function(t){var e=t.parent;if(e!==null){if(this.parent=uJ(e),this.parentIsWindow=this.parent===document.body,t.expandParent&&t.scaleMode!==zt.SCALE_MODE.NONE){var i=this.parent.getBoundingClientRect();(this.parentIsWindow||i.height===0)&&(document.documentElement.style.height="100%",document.body.style.height="100%",i=this.parent.getBoundingClientRect(),!this.parentIsWindow&&i.height===0&&(this.parent.style.overflow="hidden",this.parent.style.width="100%",this.parent.style.height="100%"))}t.fullscreenTarget&&!this.fullscreenTarget&&(this.fullscreenTarget=uJ(t.fullscreenTarget))}},getParentBounds:function(){if(!this.parent)return!1;var t=this.parentSize,e=this.parent.getBoundingClientRect(),i=e.width,s=e.height;if(t.width!==i||t.height!==s)return t.setSize(i,s),!0;if(this.canvas){var r=this.canvasBounds,n=this.canvas.getBoundingClientRect();if(n.x!==r.x||n.y!==r.y)return!0}return!1},lockOrientation:function(t){var e=screen.lockOrientation||screen.mozLockOrientation||screen.msLockOrientation;return e?e.call(screen,t):!1},setParentSize:function(t,e){return this.parentSize.setSize(t,e),this.refresh()},setGameSize:function(t,e){var i=this.autoRound;i&&(t=Math.floor(t),e=Math.floor(e));var s=this.width,r=this.height;return this.gameSize.resize(t,e),this.baseSize.resize(t,e),i&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),this.displaySize.setAspectRatio(t/e),this.canvas.width=this.baseSize.width,this.canvas.height=this.baseSize.height,this.refresh(s,r)},resize:function(t,e){var i=this.zoom,s=this.autoRound;s&&(t=Math.floor(t),e=Math.floor(e));var r=this.width,n=this.height;this.gameSize.resize(t,e),this.baseSize.resize(t,e),s&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),this.displaySize.setSize(t*i,e*i),this.canvas.width=this.baseSize.width,this.canvas.height=this.baseSize.height;var a=this.canvas.style,o=t*i,h=e*i;return s&&(o=Math.floor(o),h=Math.floor(h)),(o!==t||h!==e)&&(a.width=o+"px",a.height=h+"px"),this.refresh(r,n)},setZoom:function(t){return this.zoom=t,this._resetZoom=!0,this.refresh()},setMaxZoom:function(){return this.zoom=this.getMaxZoom(),this._resetZoom=!0,this.refresh()},setSnap:function(t,e){return t===void 0&&(t=0),e===void 0&&(e=t),this.displaySize.setSnap(t,e),this.refresh()},refresh:function(t,e){t===void 0&&(t=this.width),e===void 0&&(e=this.height),this.updateScale(),this.updateBounds(),this.updateOrientation(),this.displayScale.set(this.baseSize.width/this.canvasBounds.width,this.baseSize.height/this.canvasBounds.height);var i=this.game.domContainer;if(i){this.baseSize.setCSS(i);var s=this.canvas.style,r=i.style;r.transform="scale("+this.displaySize.width/this.baseSize.width+","+this.displaySize.height/this.baseSize.height+")",r.marginLeft=s.marginLeft,r.marginTop=s.marginTop}return this.emit(ya.RESIZE,this.gameSize,this.baseSize,this.displaySize,t,e),this},updateOrientation:function(){if(this._checkOrientation){this._checkOrientation=!1;var t=cJ(this.width,this.height);t!==this.orientation&&(this.orientation=t,this.emit(ya.ORIENTATION_CHANGE,t))}},updateScale:function(){var t=this.canvas.style,e=this.gameSize.width,i=this.gameSize.height,s,r,n=this.zoom,a=this.autoRound;if(this.scaleMode===zt.SCALE_MODE.NONE)this.displaySize.setSize(e*n,i*n),s=this.displaySize.width,r=this.displaySize.height,a&&(s=Math.floor(s),r=Math.floor(r)),this._resetZoom&&(t.width=s+"px",t.height=r+"px",this._resetZoom=!1);else if(this.scaleMode===zt.SCALE_MODE.RESIZE)this.displaySize.setSize(this.parentSize.width,this.parentSize.height),this.gameSize.setSize(this.displaySize.width,this.displaySize.height),this.baseSize.setSize(this.displaySize.width,this.displaySize.height),s=this.displaySize.width,r=this.displaySize.height,a&&(s=Math.floor(s),r=Math.floor(r)),this.canvas.width=s,this.canvas.height=r;else if(this.scaleMode===zt.SCALE_MODE.EXPAND){var o=this.game.config.width,h=this.game.config.height;this.displaySize.setSize(this.parentSize.width,this.parentSize.height),s=this.displaySize.width,r=this.displaySize.height,a&&(s=Math.floor(s),r=Math.floor(r)),t.width=s+"px",t.height=r+"px";var l=this.parentSize.width/o,c=this.parentSize.height/h;l<c&&l!==0?this.baseSize.setSize(o,this.parentSize.height/l):c!==0&&this.baseSize.setSize(this.displaySize.width/c,h),this.gameSize.setSize(this.baseSize.width,this.baseSize.height),s=this.baseSize.width,r=this.baseSize.height,a&&(s=Math.floor(s),r=Math.floor(r)),this.canvas.width=s,this.canvas.height=r}else this.displaySize.setSize(this.parentSize.width,this.parentSize.height),s=this.displaySize.width,r=this.displaySize.height,a&&(s=Math.floor(s),r=Math.floor(r)),t.width=s+"px",t.height=r+"px";this.getParentBounds(),this.updateCenter()},getMaxZoom:function(){var t=fJ(this.parentSize.width,this.gameSize.width,0,!0),e=fJ(this.parentSize.height,this.gameSize.height,0,!0);return Math.max(Math.min(t,e),1)},updateCenter:function(){var t=this.autoCenter;if(t!==zt.CENTER.NO_CENTER){var e=this.canvas,i=e.style,s=e.getBoundingClientRect(),r=s.width,n=s.height,a=Math.floor((this.parentSize.width-r)/2),o=Math.floor((this.parentSize.height-n)/2);t===zt.CENTER.CENTER_HORIZONTALLY?o=0:t===zt.CENTER.CENTER_VERTICALLY&&(a=0),i.marginLeft=a+"px",i.marginTop=o+"px"}},updateBounds:function(){var t=this.canvasBounds,e=this.canvas.getBoundingClientRect();t.x=e.left+(window.pageXOffset||0)-(document.documentElement.clientLeft||0),t.y=e.top+(window.pageYOffset||0)-(document.documentElement.clientTop||0),t.width=e.width,t.height=e.height},transformX:function(t){return(t-this.canvasBounds.left)*this.displayScale.x},transformY:function(t){return(t-this.canvasBounds.top)*this.displayScale.y},startFullscreen:function(t){t===void 0&&(t={navigationUI:"hide"});var e=this.fullscreen;if(!e.available){this.emit(ya.FULLSCREEN_UNSUPPORTED);return}if(!e.active){var i=this.getFullscreenTarget();e.keyboard?i[e.request](Element.ALLOW_KEYBOARD_INPUT):i[e.request](t)}},fullscreenSuccessHandler:function(){this.getParentBounds(),this.refresh(),this.emit(ya.ENTER_FULLSCREEN)},fullscreenErrorHandler:function(t){this.removeFullscreenTarget(),this.emit(ya.FULLSCREEN_FAILED,t)},getFullscreenTarget:function(){if(!this.fullscreenTarget){var t=document.createElement("div");t.style.margin="0",t.style.padding="0",t.style.width="100%",t.style.height="100%",this.fullscreenTarget=t,this._createdFullscreenTarget=!0}if(this._createdFullscreenTarget){var e=this.canvas.parentNode;e.insertBefore(this.fullscreenTarget,this.canvas),this.fullscreenTarget.appendChild(this.canvas)}return this.fullscreenTarget},removeFullscreenTarget:function(){if(this._createdFullscreenTarget){var t=this.fullscreenTarget;if(t&&t.parentNode){var e=t.parentNode;e.insertBefore(this.canvas,t),e.removeChild(t)}}},stopFullscreen:function(){var t=this.fullscreen;if(!t.available)return this.emit(ya.FULLSCREEN_UNSUPPORTED),!1;t.active&&document[t.cancel](),this.removeFullscreenTarget()},leaveFullScreenSuccessHandler:function(){this.getParentBounds(),this.emit(ya.LEAVE_FULLSCREEN),this.refresh()},toggleFullscreen:function(t){this.fullscreen.active?this.stopFullscreen():this.startFullscreen(t)},startListeners:function(){var t=this,e=this.domlisteners;if(e.orientationChange=function(){t.updateBounds(),t._checkOrientation=!0,t.dirty=!0,t.refresh()},e.windowResize=function(){t.updateBounds(),t.dirty=!0},screen.orientation&&screen.orientation.addEventListener?screen.orientation.addEventListener("change",e.orientationChange,!1):window.addEventListener("orientationchange",e.orientationChange,!1),window.addEventListener("resize",e.windowResize,!1),this.fullscreen.available){e.fullScreenChange=function(s){return t.onFullScreenChange(s)},e.fullScreenError=function(s){return t.onFullScreenError(s)};var i=["webkit","moz",""];i.forEach(function(s){document.addEventListener(s+"fullscreenchange",e.fullScreenChange,!1),document.addEventListener(s+"fullscreenerror",e.fullScreenError,!1)}),document.addEventListener("MSFullscreenChange",e.fullScreenChange,!1),document.addEventListener("MSFullscreenError",e.fullScreenError,!1)}},onFullScreenChange:function(){document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement||document.mozFullScreenElement?this.fullscreenSuccessHandler():(this.stopFullscreen(),this.leaveFullScreenSuccessHandler())},onFullScreenError:function(){this.removeFullscreenTarget()},getViewPort:function(t,e){t instanceof HIe||(e=t,t=void 0),e===void 0&&(e=new dJ);var i=this.baseSize,s=this.parentSize,r=this.canvasBounds,n=this.displayScale,a=r.x>=0?0:-(r.x*n.x),o=r.y>=0?0:-(r.y*n.y),h;s.width>=r.width?h=i.width:h=i.width-(r.width-s.width)*n.x;var l;return s.height>=r.height?l=i.height:l=i.height-(r.height-s.height)*n.y,e.setTo(a,o,h,l),t&&(e.width/=t.zoomX,e.height/=t.zoomY,e.centerX=t.centerX+t.scrollX,e.centerY=t.centerY+t.scrollY),e},step:function(t,e){this.parent&&(this._lastCheck+=e,(this.dirty||this._lastCheck>this.resizeInterval)&&(this.getParentBounds()&&this.refresh(),this.dirty=!1,this._lastCheck=0))},stopListeners:function(){var t=this.domlisteners;screen.orientation&&screen.orientation.addEventListener?screen.orientation.removeEventListener("change",t.orientationChange,!1):window.removeEventListener("orientationchange",t.orientationChange,!1),window.removeEventListener("resize",t.windowResize,!1);var e=["webkit","moz",""];e.forEach(function(i){document.removeEventListener(i+"fullscreenchange",t.fullScreenChange,!1),document.removeEventListener(i+"fullscreenerror",t.fullScreenError,!1)}),document.removeEventListener("MSFullscreenChange",t.fullScreenChange,!1),document.removeEventListener("MSFullscreenError",t.fullScreenError,!1)},destroy:function(){this.removeAllListeners(),this.stopListeners(),this.game=null,this.canvas=null,this.canvasBounds=null,this.parent=null,this.fullscreenTarget=null,this.parentSize.destroy(),this.gameSize.destroy(),this.baseSize.destroy(),this.displaySize.destroy()},isFullscreen:{get:function(){return this.fullscreen.active}},width:{get:function(){return this.gameSize.width}},height:{get:function(){return this.gameSize.height}},isPortrait:{get:function(){return this.orientation===zt.ORIENTATION.PORTRAIT}},isLandscape:{get:function(){return this.orientation===zt.ORIENTATION.LANDSCAPE}},isGamePortrait:{get:function(){return this.height>this.width}},isGameLandscape:{get:function(){return this.width>this.height}}});pJ.exports=zIe});var gJ=u((adt,vJ)=>{"use strict";var VIe=Ui(),XIe=R(),KIe=Ol(),ZIe=Lf(),jIe=tf(),$Ie=new XIe({initialize:function(e,i,s,r,n){n===void 0&&(n=!1);var a=e.manager.game;this.renderer=a.renderer,this.texture=e,this.source=i,this.image=i.compressed?null:i,this.compressionAlgorithm=i.compressed?i.format:null,this.resolution=1,this.width=s||i.naturalWidth||i.videoWidth||i.width||0,this.height=r||i.naturalHeight||i.videoHeight||i.height||0,this.scaleMode=ZIe.DEFAULT,this.isCanvas=i instanceof HTMLCanvasElement,this.isVideo=window.hasOwnProperty("HTMLVideoElement")&&i instanceof HTMLVideoElement,this.isRenderTexture=i.type==="RenderTexture"||i.type==="DynamicTexture",this.isGLTexture=i instanceof jIe,this.isPowerOf2=KIe(this.width,this.height),this.glTexture=null,this.flipY=n,this.init(a)},init:function(t){var e=this.renderer;if(e){var i=this.source;if(e.gl){var s=this.image,r=this.flipY,n=this.width,a=this.height,o=this.scaleMode;this.isCanvas?this.glTexture=e.createCanvasTexture(s,!1,r):this.isVideo?this.glTexture=e.createVideoTexture(s,!1,r):this.isRenderTexture?this.glTexture=e.createTextureFromSource(null,n,a,o):this.isGLTexture?this.glTexture=i:this.compressionAlgorithm?this.glTexture=e.createTextureFromSource(i,void 0,void 0,o):i instanceof Uint8Array?this.glTexture=e.createUint8ArrayTexture(i,n,a,o):this.glTexture=e.createTextureFromSource(s,n,a,o)}else this.isRenderTexture&&(this.image=i.canvas)}t.config.antialias||this.setFilter(1)},setFilter:function(t){this.renderer&&this.renderer.gl&&this.renderer.setTextureFilter(this.glTexture,t),this.scaleMode=t},setFlipY:function(t){return t===void 0&&(t=!0),t===this.flipY?this:(this.flipY=t,this.update(),this)},update:function(){var t=this.renderer,e=this.image,i=this.flipY,s=t.gl;s&&this.isCanvas?t.updateCanvasTexture(e,this.glTexture,i):s&&this.isVideo&&t.updateVideoTexture(e,this.glTexture,i)},destroy:function(){this.glTexture&&this.renderer.deleteTexture(this.glTexture),this.isCanvas&&VIe.remove(this.image),this.renderer=null,this.texture=null,this.source=null,this.image=null,this.glTexture=null}});vJ.exports=$Ie});var uf=u((odt,EJ)=>{"use strict";var JIe=R(),QIe=Da(),SJ=gJ(),yA='Texture "%s" has no frame "%s"',eLe=new JIe({initialize:function(e,i,s,r,n){Array.isArray(s)||(s=[s]),this.manager=e,this.key=i,this.source=[],this.dataSource=[],this.frames={},this.customData={},this.firstFrame="__BASE",this.frameTotal=0;for(var a=0;a<s.length;a++)this.source.push(new SJ(this,s[a],r,n))},add:function(t,e,i,s,r,n){if(this.has(t))return null;var a=new QIe(this,t,e,i,s,r,n);return this.frames[t]=a,this.firstFrame==="__BASE"&&(this.firstFrame=t),this.frameTotal++,a},remove:function(t){if(this.has(t)){var e=this.get(t);return e.destroy(),delete this.frames[t],!0}return!1},has:function(t){return this.frames.hasOwnProperty(t)},get:function(t){t||(t=this.firstFrame);var e=this.frames[t];return e||(console.warn(yA,this.key,t),e=this.frames[this.firstFrame]),e},getTextureSourceIndex:function(t){for(var e=0;e<this.source.length;e++)if(this.source[e]===t)return e;return-1},getFramesFromTextureSource:function(t,e){e===void 0&&(e=!1);var i=[];for(var s in this.frames)if(!(s==="__BASE"&&!e)){var r=this.frames[s];r.sourceIndex===t&&i.push(r)}return i},getFrameBounds:function(t){t===void 0&&(t=0);for(var e=this.getFramesFromTextureSource(t,!0),i=e[0],s=i.cutX,r=i.cutY,n=i.cutX+i.cutWidth,a=i.cutY+i.cutHeight,o=1;o<e.length;o++){var h=e[o];h.cutX<s&&(s=h.cutX),h.cutY<r&&(r=h.cutY),h.cutX+h.cutWidth>n&&(n=h.cutX+h.cutWidth),h.cutY+h.cutHeight>a&&(a=h.cutY+h.cutHeight)}return{x:s,y:r,width:n-s,height:a-r}},getFrameNames:function(t){t===void 0&&(t=!1);var e=Object.keys(this.frames);if(!t){var i=e.indexOf("__BASE");i!==-1&&e.splice(i,1)}return e},getSourceImage:function(t){(t==null||this.frameTotal===1)&&(t="__BASE");var e=this.frames[t];return e?e.source.image:(console.warn(yA,this.key,t),this.frames.__BASE.source.image)},getDataSourceImage:function(t){(t==null||this.frameTotal===1)&&(t="__BASE");var e=this.frames[t],i;return e?i=e.sourceIndex:(console.warn(yA,this.key,t),i=this.frames.__BASE.sourceIndex),this.dataSource[i].image},setDataSource:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var i=this.source[e];this.dataSource.push(new SJ(this,t[e],i.width,i.height))}},setFilter:function(t){var e;for(e=0;e<this.source.length;e++)this.source[e].setFilter(t);for(e=0;e<this.dataSource.length;e++)this.dataSource[e].setFilter(t)},destroy:function(){var t,e=this.source,i=this.dataSource;for(t=0;t<e.length;t++)e[t]&&e[t].destroy();for(t=0;t<i.length;t++)i[t]&&i[t].destroy();for(var s in this.frames){var r=this.frames[s];r&&r.destroy()}this.source=[],this.dataSource=[],this.frames={},this.manager.removeKey(this.key),this.manager=null}});EJ.exports=eLe});var bJ=u((hdt,yJ)=>{"use strict";var tLe=R(),Tn=Je(),TJ=is(),iLe=Qi(),sLe=Ol(),bA=uf(),rLe=new tLe({Extends:bA,initialize:function(e,i,s,r,n){bA.call(this,e,i,s,r,n),this.add("__BASE",0,0,0,r,n),this._source=this.frames.__BASE.source,this.canvas=this._source.image,this.context=this.canvas.getContext("2d",{willReadFrequently:!0}),this.width=r,this.height=n,this.imageData=this.context.getImageData(0,0,r,n),this.data=null,this.imageData&&(this.data=this.imageData.data),this.pixels=null,this.buffer,this.data&&(this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data)},update:function(){return this.imageData=this.context.getImageData(0,0,this.width,this.height),this.data=this.imageData.data,this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data,this.manager.game.config.renderType===iLe.WEBGL&&this.refresh(),this},draw:function(t,e,i,s){return s===void 0&&(s=!0),this.context.drawImage(i,t,e),s&&this.update(),this},drawFrame:function(t,e,i,s,r){i===void 0&&(i=0),s===void 0&&(s=0),r===void 0&&(r=!0);var n=this.manager.getFrame(t,e);if(n){var a=n.canvasData,o=n.cutWidth,h=n.cutHeight,l=n.source.resolution;this.context.drawImage(n.source.image,a.x,a.y,o,h,i,s,o/l,h/l),r&&this.update()}return this},setPixel:function(t,e,i,s,r,n){n===void 0&&(n=255),t=Math.abs(Math.floor(t)),e=Math.abs(Math.floor(e));var a=this.getIndex(t,e);if(a>-1){var o=this.context.getImageData(t,e,1,1);o.data[0]=i,o.data[1]=s,o.data[2]=r,o.data[3]=n,this.context.putImageData(o,t,e)}return this},putData:function(t,e,i,s,r,n,a){return s===void 0&&(s=0),r===void 0&&(r=0),n===void 0&&(n=t.width),a===void 0&&(a=t.height),this.context.putImageData(t,e,i,s,r,n,a),this},getData:function(t,e,i,s){t=Tn(Math.floor(t),0,this.width-1),e=Tn(Math.floor(e),0,this.height-1),i=Tn(i,1,this.width-t),s=Tn(s,1,this.height-e);var r=this.context.getImageData(t,e,i,s);return r},getPixel:function(t,e,i){i||(i=new TJ);var s=this.getIndex(t,e);if(s>-1){var r=this.data,n=r[s+0],a=r[s+1],o=r[s+2],h=r[s+3];i.setTo(n,a,o,h)}return i},getPixels:function(t,e,i,s){t===void 0&&(t=0),e===void 0&&(e=0),i===void 0&&(i=this.width),s===void 0&&(s=i),t=Math.abs(Math.round(t)),e=Math.abs(Math.round(e));for(var r=Tn(t,0,this.width),n=Tn(t+i,0,this.width),a=Tn(e,0,this.height),o=Tn(e+s,0,this.height),h=new TJ,l=[],c=a;c<o;c++){for(var d=[],f=r;f<n;f++)h=this.getPixel(f,c,h),d.push({x:f,y:c,color:h.color,alpha:h.alphaGL});l.push(d)}return l},getIndex:function(t,e){return t=Math.abs(Math.round(t)),e=Math.abs(Math.round(e)),t<this.width&&e<this.height?(t+e*this.width)*4:-1},refresh:function(){return this._source.update(),this},getCanvas:function(){return this.canvas},getContext:function(){return this.context},clear:function(t,e,i,s,r){return t===void 0&&(t=0),e===void 0&&(e=0),i===void 0&&(i=this.width),s===void 0&&(s=this.height),r===void 0&&(r=!0),this.context.clearRect(t,e,i,s),r&&this.update(),this},setSize:function(t,e){return e===void 0&&(e=t),(t!==this.width||e!==this.height)&&(this.canvas.width=t,this.canvas.height=e,this._source.width=t,this._source.height=e,this._source.isPowerOf2=sLe(t,e),this.frames.__BASE.setSize(t,e,0,0),this.width=t,this.height=e,this.refresh()),this},destroy:function(){bA.prototype.destroy.call(this),this._source=null,this.canvas=null,this.context=null,this.imageData=null,this.data=null,this.pixels=null,this.buffer=null}});yJ.exports=rLe});var wJ=u((ldt,CJ)=>{"use strict";var nLe=xn(),aLe=ch(),AJ=Ui(),oLe=R(),hLe=Qi(),xJ=Da(),Ji=re(),lLe=dl(),uLe=fl(),AA=uf(),cLe=Ti(),dLe=new oLe({Extends:AA,initialize:function(e,i,s,r,n){s===void 0&&(s=256),r===void 0&&(r=256),n===void 0&&(n=!0),this.type="DynamicTexture";var a=e.game.renderer,o=a&&a.type===hLe.CANVAS,h=o?AJ.create2D(this,s,r):[this];AA.call(this,e,i,h,s,r),this.add("__BASE",0,0,0,s,r),this.renderer=a,this.width=-1,this.height=-1,this.isDrawing=!1,this.canvas=o?h:null,this.context=o?h.getContext("2d",{willReadFrequently:!0}):null,this.dirty=!1,this.isSpriteTexture=!0,this._eraseMode=!1,this.camera=new aLe(0,0,s,r).setScene(e.game.scene.systemScene,!1),this.renderTarget=o?null:new uLe(a,s,r,1,0,!1,!1,!0,!1),this.pipeline=o?null:a.pipelines.get(lLe.SINGLE_PIPELINE),this.setSize(s,r,n)},setSize:function(t,e,i){e===void 0&&(e=t),i===void 0&&(i=!0),i&&(t=Math.floor(t),e=Math.floor(e),t%2!==0&&t++,e%2!==0&&e++);var s=this.get(),r=s.source;if(t!==this.width||e!==this.height){this.canvas&&(this.canvas.width=t,this.canvas.height=e);var n=this.renderTarget;n&&(n.willResize(t,e)&&n.resize(t,e),n.texture!==r.glTexture&&this.renderer.deleteTexture(r.glTexture),this.setFromRenderTarget()),this.camera.setSize(t,e),r.width=t,r.height=e,s.setSize(t,e),this.width=t,this.height=e}else{var a=this.getSourceImage();s.cutX+t>a.width&&(t=a.width-s.cutX),s.cutY+e>a.height&&(e=a.height-s.cutY),s.setSize(t,e,s.cutX,s.cutY)}return this},setFromRenderTarget:function(){var t=this.get(),e=t.source,i=this.renderTarget;return e.isRenderTexture=!0,e.isGLTexture=!0,e.glTexture=i.texture,this},setIsSpriteTexture:function(t){return this.isSpriteTexture=t,this},fill:function(t,e,i,s,r,n){var a=this.camera,o=this.renderer;e===void 0&&(e=1),i===void 0&&(i=0),s===void 0&&(s=0),r===void 0&&(r=this.width),n===void 0&&(n=this.height);var h=t>>16&255,l=t>>8&255,c=t&255,d=this.renderTarget;if(a.preRender(),d){d.bind(!0);var f=this.pipeline.manager.set(this.pipeline),p=o.width/d.width,m=o.height/d.height,v=d.height-(s+n);f.drawFillRect(i*p,v*m,r*p,n*m,cLe.getTintFromFloats(c/255,l/255,h/255,1),e),d.unbind(!0)}else{var g=this.context;o.setContext(g),g.globalCompositeOperation="source-over",g.fillStyle="rgba("+h+","+l+","+c+","+e+")",g.fillRect(i,s,r,n),o.setContext()}return this.dirty=!0,this},clear:function(t,e,i,s){if(this.dirty){var r=this.context,n=this.renderTarget;n?n.clear(t,e,i,s):r&&(t!==void 0&&e!==void 0&&i!==void 0&&s!==void 0?r.clearRect(t,e,i,s):(r.save(),r.setTransform(1,0,0,1,0,0),r.clearRect(0,0,this.width,this.height),r.restore())),this.dirty=!1}return this},stamp:function(t,e,i,s,r){i===void 0&&(i=0),s===void 0&&(s=0);var n=Ji(r,"alpha",1),a=Ji(r,"tint",16777215),o=Ji(r,"angle",0),h=Ji(r,"rotation",0),l=Ji(r,"scale",1),c=Ji(r,"scaleX",l),d=Ji(r,"scaleY",l),f=Ji(r,"originX",.5),p=Ji(r,"originY",.5),m=Ji(r,"blendMode",0),v=Ji(r,"erase",!1),g=Ji(r,"skipBatch",!1),S=this.manager.resetStamp(n,a);return S.setAngle(0),o!==0?S.setAngle(o):h!==0&&S.setRotation(h),S.setScale(c,d),S.setTexture(t,e),S.setOrigin(f,p),S.setBlendMode(m),v&&(this._eraseMode=!0),g?this.batchGameObject(S,i,s):this.draw(S,i,s),v&&(this._eraseMode=!1),this},erase:function(t,e,i){return this._eraseMode=!0,this.draw(t,e,i),this._eraseMode=!1,this},draw:function(t,e,i,s,r){return this.beginDraw(),this.batchDraw(t,e,i,s,r),this.endDraw(),this},drawFrame:function(t,e,i,s,r,n){return this.beginDraw(),this.batchDrawFrame(t,e,i,s,r,n),this.endDraw(),this},repeat:function(t,e,i,s,r,n,a,o,h){if(i===void 0&&(i=0),s===void 0&&(s=0),r===void 0&&(r=this.width),n===void 0&&(n=this.height),a===void 0&&(a=1),o===void 0&&(o=16777215),h===void 0&&(h=!1),t instanceof xJ?e=t:e=this.manager.getFrame(t,e),!e)return this;var l=this.manager.resetStamp(a,o);l.setFrame(e),l.setOrigin(0);var c=e.width,d=e.height;r=Math.floor(r),n=Math.floor(n);var f=Math.ceil(r/c),p=Math.ceil(n/d),m=f*c-r,v=p*d-n;m>0&&(m=c-m),v>0&&(v=d-v),i<0&&(f+=Math.ceil(Math.abs(i)/c)),s<0&&(p+=Math.ceil(Math.abs(s)/d));var g=i,S=s,y=!1,b=this.manager.stampCrop.setTo(0,0,c,d);h||this.beginDraw();for(var x=0;x<p;x++){if(S+d<0){S+=d;continue}for(var A=0;A<f;A++){if(y=!1,g+c<0){g+=c;continue}else g<0&&(y=!0,b.width=c+g,b.x=c-b.width);S<0&&(y=!0,b.height=d+S,b.y=d-b.height),m>0&&A===f-1&&(y=!0,b.width=m),v>0&&x===p-1&&(y=!0,b.height=v),y&&l.setCrop(b),this.batchGameObject(l,g,S),l.isCropped=!1,b.setTo(0,0,c,d),g+=c}g=i,S+=d}return h||this.endDraw(),this},beginDraw:function(){if(!this.isDrawing){var t=this.camera,e=this.renderer,i=this.renderTarget;t.preRender(),i?e.beginCapture(i.width,i.height):e.setContext(this.context),this.isDrawing=!0}return this},batchDraw:function(t,e,i,s,r){return Array.isArray(t)||(t=[t]),this.batchList(t,e,i,s,r),this},batchDrawFrame:function(t,e,i,s,r,n){i===void 0&&(i=0),s===void 0&&(s=0),r===void 0&&(r=1),n===void 0&&(n=16777215);var a=this.manager.getFrame(t,e);return a&&(this.renderTarget?this.pipeline.batchTextureFrame(a,i,s,n,r,this.camera.matrix,null):this.batchTextureFrame(a,i,s,r,n)),this},endDraw:function(t){if(t===void 0&&(t=this._eraseMode),this.isDrawing){var e=this.renderer,i=this.renderTarget;if(i){var s=e.endCapture(),r=e.pipelines.setUtility();r.blitFrame(s,i,1,!1,!1,t,this.isSpriteTexture),e.resetScissor(),e.resetViewport()}else e.setContext();this.dirty=!0,this.isDrawing=!1}return this},batchList:function(t,e,i,s,r){var n=t.length;if(n!==0)for(var a=0;a<n;a++){var o=t[a];!o||o===this||(o.renderWebGL||o.renderCanvas?this.batchGameObject(o,e,i):o.isParent||o.list?this.batchGroup(o.getChildren(),e,i):typeof o=="string"?this.batchTextureFrameKey(o,null,e,i,s,r):o instanceof xJ?this.batchTextureFrame(o,e,i,s,r):Array.isArray(o)&&this.batchList(o,e,i,s,r))}},batchGroup:function(t,e,i){e===void 0&&(e=0),i===void 0&&(i=0);for(var s=0;s<t.length;s++){var r=t[s];r.willRender(this.camera)&&this.batchGameObject(r,r.x+e,r.y+i)}},batchGameObject:function(t,e,i){e===void 0&&(e=t.x),i===void 0&&(i=t.y);var s=t.x,r=t.y,n=this.camera,a=this.renderer,o=this._eraseMode,h=t.mask;if(t.setPosition(e,i),this.canvas){if(o){var l=t.blendMode;t.blendMode=nLe.ERASE}h&&h.preRenderCanvas(a,t,n),t.renderCanvas(a,t,n,null),h&&h.postRenderCanvas(a,t,n),o&&(t.blendMode=l)}else a&&(h&&h.preRenderWebGL(a,t,n),o||a.setBlendMode(t.blendMode),t.renderWebGL(a,t,n),h&&h.postRenderWebGL(a,n,this.renderTarget));t.setPosition(s,r)},batchTextureFrameKey:function(t,e,i,s,r,n){var a=this.manager.getFrame(t,e);a&&this.batchTextureFrame(a,i,s,r,n)},batchTextureFrame:function(t,e,i,s,r){e===void 0&&(e=0),i===void 0&&(i=0),s===void 0&&(s=1),r===void 0&&(r=16777215);var n=this.camera.matrix,a=this.renderTarget;if(a)this.pipeline.batchTextureFrame(t,e,i,r,s,n,null);else{var o=this.context,h=t.canvasData,l=t.source.image;o.save(),o.globalCompositeOperation=this._eraseMode?"destination-out":"source-over",o.globalAlpha=s,n.setToContext(o),h.width>0&&h.height>0&&o.drawImage(l,h.x,h.y,h.width,h.height,e,i,h.width,h.height),o.restore()}},snapshotArea:function(t,e,i,s,r,n,a){return this.renderTarget?this.renderer.snapshotFramebuffer(this.renderTarget.framebuffer,this.width,this.height,r,!1,t,e,i,s,n,a):this.renderer.snapshotCanvas(this.canvas,r,!1,t,e,i,s,n,a),this},snapshot:function(t,e,i){return this.snapshotArea(0,0,this.width,this.height,t,e,i)},snapshotPixel:function(t,e,i){return this.snapshotArea(t,e,1,1,i,"pixel")},getWebGLTexture:function(){if(this.renderTarget)return this.renderTarget.texture},renderWebGL:function(t,e,i,s){var r=this.manager.resetStamp();r.setTexture(this),r.setOrigin(0),r.renderWebGL(t,r,i,s)},renderCanvas:function(){},destroy:function(){var t=this.manager.stamp;t&&t.texture===this&&this.manager.resetStamp(),AA.prototype.destroy.call(this),AJ.remove(this.canvas),this.renderTarget&&this.renderTarget.destroy(),this.camera.destroy(),this.canvas=null,this.context=null,this.renderer=null}});CJ.exports=dLe});var PJ=u((udt,RJ)=>{"use strict";RJ.exports={0:"#000",1:"#9D9D9D",2:"#FFF",3:"#BE2633",4:"#E06F8B",5:"#493C2B",6:"#A46422",7:"#EB8931",8:"#F7E26B",9:"#2F484E",A:"#44891A",B:"#A3CE27",C:"#1B2632",D:"#005784",E:"#31A2F2",F:"#B2DCEF"}});var IJ=u((cdt,_J)=>{"use strict";var fLe=PJ(),pLe=Ui(),Ir=Ne(),mLe=function(t){var e=Ir(t,"data",[]),i=Ir(t,"canvas",null),s=Ir(t,"palette",fLe),r=Ir(t,"pixelWidth",1),n=Ir(t,"pixelHeight",r),a=Ir(t,"resizeCanvas",!0),o=Ir(t,"clearCanvas",!0),h=Ir(t,"preRender",null),l=Ir(t,"postRender",null),c=Math.floor(Math.abs(e[0].length*r)),d=Math.floor(Math.abs(e.length*n));i||(i=pLe.create2D(this,c,d),a=!1,o=!1),a&&(i.width=c,i.height=d);var f=i.getContext("2d",{willReadFrequently:!0});o&&f.clearRect(0,0,c,d),h&&h(i,f);for(var p=0;p<e.length;p++)for(var m=e[p],v=0;v<m.length;v++){var g=m[v];g!=="."&&g!==" "&&(f.fillStyle=s[g],f.fillRect(v*r,p*n,r,n))}return l&&l(i,f),i};_J.exports=mLe});var MJ=u((ddt,LJ)=>{"use strict";var vLe=function(t,e){var i=t.source[e];return t.add("__BASE",e,0,0,i.width,i.height),t};LJ.exports=vLe});var DJ=u((fdt,OJ)=>{"use strict";var gLe=function(t,e){var i=t.source[e];return t.add("__BASE",e,0,0,i.width,i.height),t};OJ.exports=gLe});var UJ=u((pdt,BJ)=>{"use strict";var SLe=gh(),ELe=function(t,e,i){if(!i.frames&&!i.textures){console.warn("Invalid Texture Atlas JSON Array");return}var s=t.source[e];t.add("__BASE",e,0,0,s.width,s.height);for(var r=Array.isArray(i.textures)?i.textures[e].frames:i.frames,n,a=0;a<r.length;a++){var o=r[a];if(n=t.add(o.filename,e,o.frame.x,o.frame.y,o.frame.w,o.frame.h),!n){console.warn("Invalid atlas json, frame already exists: "+o.filename);continue}o.trimmed&&n.setTrim(o.sourceSize.w,o.sourceSize.h,o.spriteSourceSize.x,o.spriteSourceSize.y,o.spriteSourceSize.w,o.spriteSourceSize.h),o.rotated&&(n.rotated=!0,n.updateUVsInverted());var h=o.anchor||o.pivot;h&&(n.customPivot=!0,n.pivotX=h.x,n.pivotY=h.y),o.scale9Borders&&n.setScale9(o.scale9Borders.x,o.scale9Borders.y,o.scale9Borders.w,o.scale9Borders.h),n.customData=SLe(o)}for(var l in i)l!=="frames"&&(Array.isArray(i[l])?t.customData[l]=i[l].slice(0):t.customData[l]=i[l]);return t};BJ.exports=ELe});var FJ=u((mdt,NJ)=>{"use strict";var zo=re(),TLe=function(t,e,i,s,r,n,a){var o=zo(a,"frameWidth",null),h=zo(a,"frameHeight",o);if(o===null)throw new Error("TextureManager.SpriteSheet: Invalid frameWidth given.");var l=t.source[e];t.add("__BASE",e,0,0,l.width,l.height);var c=zo(a,"startFrame",0),d=zo(a,"endFrame",-1),f=zo(a,"margin",0),p=zo(a,"spacing",0),m=Math.floor((r-f+p)/(o+p)),v=Math.floor((n-f+p)/(h+p)),g=m*v;g===0&&console.warn("SpriteSheet frame dimensions will result in zero frames for texture:",t.key),(c>g||c<-g)&&(c=0),c<0&&(c=g+c),(d===-1||d>g||d<c)&&(d=g);for(var S=f,y=f,b=0,x=0,A=0,w=0;w<g;w++){b=0,x=0;var C=S+o,_=y+h;C>r&&(b=C-r),_>n&&(x=_-n),w>=c&&w<=d&&(t.add(A,e,i+S,s+y,o-b,h-x),A++),S+=o+p,S+o>r&&(S=f,y+=h+p)}return t};NJ.exports=TLe});var GJ=u((vdt,kJ)=>{"use strict";var Vo=re(),yLe=function(t,e,i){var s=Vo(i,"frameWidth",null),r=Vo(i,"frameHeight",s);if(!s)throw new Error("TextureManager.SpriteSheetFromAtlas: Invalid frameWidth given.");var n=t.source[0];t.add("__BASE",0,0,0,n.width,n.height);var a=Vo(i,"startFrame",0),o=Vo(i,"endFrame",-1),h=Vo(i,"margin",0),l=Vo(i,"spacing",0),c=e.cutX,d=e.cutY,f=e.cutWidth,p=e.cutHeight,m=e.realWidth,v=e.realHeight,g=Math.floor((m-h+l)/(s+l)),S=Math.floor((v-h+l)/(r+l)),y=g*S,b=e.x,x=s-b,A=s-(m-f-b),w=e.y,C=r-w,_=r-(v-p-w);(a>y||a<-y)&&(a=0),a<0&&(a=y+a),o!==-1&&(y=a+(o+1));for(var N,D=h,Y=h,$=0,j=0,G=0;G<S;G++){for(var Z=G===0,ee=G===S-1,te=0;te<g;te++){var Q=te===0,Ae=te===g-1;if(N=t.add($,j,c+D,d+Y,s,r),Q||Z||Ae||ee){var gt=Q?b:0,St=Z?w:0,rt=0,Et=0;Q&&(rt+=s-x),Ae&&(rt+=s-A),Z&&(Et+=r-C),ee&&(Et+=r-_);var Ee=s-rt,ut=r-Et;N.cutWidth=Ee,N.cutHeight=ut,N.setTrim(s,r,gt,St,Ee,ut)}D+=l,Q?D+=x:Ae?D+=A:D+=s,$++}D=h,Y+=l,Z?Y+=C:ee?Y+=_:Y+=r}return t};kJ.exports=yLe});var WJ=u((gdt,qJ)=>{"use strict";qJ.exports={Canvas:MJ(),Image:DJ(),JSONArray:UJ(),SpriteSheet:FJ(),SpriteSheetFromAtlas:GJ()}});var KJ=u((Sdt,XJ)=>{"use strict";var Xo=Ui(),YJ=bJ(),bLe=R(),ALe=is(),xLe=Qi(),CLe=wJ(),HJ=ze(),pe=Io(),zJ=Da(),xA=vi(),wLe=IJ(),VJ=Ne(),RLe=Rh(),PLe=Xt(),Oi=WJ(),_Le=Ze(),yn=uf(),ILe=new bLe({Extends:HJ,initialize:function(e){HJ.call(this),this.game=e,this.name="TextureManager",this.list={},this._tempCanvas=Xo.create2D(this),this._tempContext=this._tempCanvas.getContext("2d",{willReadFrequently:!0}),this._pending=0,this.stamp,this.stampCrop=new _Le,this.silentWarnings=!1,e.events.once(xA.BOOT,this.boot,this)},boot:function(){this._pending=3,this.on(pe.LOAD,this.updatePending,this),this.on(pe.ERROR,this.updatePending,this);var t=this.game.config;t.defaultImage!==null&&this.addBase64("__DEFAULT",t.defaultImage),t.missingImage!==null&&this.addBase64("__MISSING",t.missingImage),t.whiteImage!==null&&this.addBase64("__WHITE",t.whiteImage),this.game.renderer&&this.game.renderer.gl&&this.addUint8Array("__NORMAL",new Uint8Array([127,127,255,255]),1,1),this.game.events.once(xA.DESTROY,this.destroy,this),this.game.events.once(xA.SYSTEM_READY,function(e){this.stamp=new RLe(e).setOrigin(0)},this)},updatePending:function(){this._pending--,this._pending===0&&(this.off(pe.LOAD),this.off(pe.ERROR),this.emit(pe.READY))},checkKey:function(t){return!t||typeof t!="string"||this.exists(t)?(this.silentWarnings||console.error("Texture key already in use: "+t),!1):!0},remove:function(t){if(typeof t=="string")if(this.exists(t))t=this.get(t);else return this.silentWarnings||console.warn("No texture found matching key: "+t),this;var e=t.key;return this.list.hasOwnProperty(e)&&(t.destroy(),this.emit(pe.REMOVE,e),this.emit(pe.REMOVE_KEY+e)),this},removeKey:function(t){return this.list.hasOwnProperty(t)&&delete this.list[t],this},addBase64:function(t,e){if(this.checkKey(t)){var i=this,s=new Image;s.onerror=function(){i.emit(pe.ERROR,t)},s.onload=function(){var r=i.create(t,s);r&&(Oi.Image(r,0),i.emit(pe.ADD,t,r),i.emit(pe.ADD_KEY+t,r),i.emit(pe.LOAD,t,r))},s.src=e}return this},getBase64:function(t,e,i,s){i===void 0&&(i="image/png"),s===void 0&&(s=.92);var r="",n=this.getFrame(t,e);if(n&&(n.source.isRenderTexture||n.source.isGLTexture))this.silentWarnings||console.warn("Cannot getBase64 from WebGL Texture");else if(n){var a=n.canvasData,o=Xo.create2D(this,a.width,a.height),h=o.getContext("2d",{willReadFrequently:!0});a.width>0&&a.height>0&&h.drawImage(n.source.image,a.x,a.y,a.width,a.height,0,0,a.width,a.height),r=o.toDataURL(i,s),Xo.remove(o)}return r},addImage:function(t,e,i){var s=null;return this.checkKey(t)&&(s=this.create(t,e),Oi.Image(s,0),i&&s.setDataSource(i),this.emit(pe.ADD,t,s),this.emit(pe.ADD_KEY+t,s)),s},addGLTexture:function(t,e){var i=null;if(this.checkKey(t)){var s=e.width,r=e.height;i=this.create(t,e,s,r),i.add("__BASE",0,0,0,s,r),this.emit(pe.ADD,t,i),this.emit(pe.ADD_KEY+t,i)}return i},addCompressedTexture:function(t,e,i){var s=null;if(this.checkKey(t)){if(s=this.create(t,e),s.add("__BASE",0,0,0,e.width,e.height),i){var r=function(a,o,h){Array.isArray(h.textures)||Array.isArray(h.frames)?Oi.JSONArray(a,o,h):Oi.JSONHash(a,o,h)};if(Array.isArray(i))for(var n=0;n<i.length;n++)r(s,n,i[n]);else r(s,0,i)}this.emit(pe.ADD,t,s),this.emit(pe.ADD_KEY+t,s)}return s},addRenderTexture:function(t,e){var i=null;return this.checkKey(t)&&(i=this.create(t,e),i.add("__BASE",0,0,0,e.width,e.height),this.emit(pe.ADD,t,i),this.emit(pe.ADD_KEY+t,i)),i},generate:function(t,e){if(this.checkKey(t)){var i=Xo.create(this,1,1);return e.canvas=i,wLe(e),this.addCanvas(t,i)}else return null},createCanvas:function(t,e,i){if(e===void 0&&(e=256),i===void 0&&(i=256),this.checkKey(t)){var s=Xo.create(this,e,i,xLe.CANVAS,!0);return this.addCanvas(t,s)}return null},addCanvas:function(t,e,i){i===void 0&&(i=!1);var s=null;return i?s=new YJ(this,t,e,e.width,e.height):this.checkKey(t)&&(s=new YJ(this,t,e,e.width,e.height),this.list[t]=s,this.emit(pe.ADD,t,s),this.emit(pe.ADD_KEY+t,s)),s},addDynamicTexture:function(t,e,i){var s=null;return typeof t=="string"&&!this.exists(t)?s=new CLe(this,t,e,i):(s=t,t=s.key),this.checkKey(t)?(this.list[t]=s,this.emit(pe.ADD,t,s),this.emit(pe.ADD_KEY+t,s)):s=null,s},addAtlas:function(t,e,i,s){return Array.isArray(i.textures)||Array.isArray(i.frames)?this.addAtlasJSONArray(t,e,i,s):this.addAtlasJSONHash(t,e,i,s)},addAtlasJSONArray:function(t,e,i,s){var r=null;if(e instanceof yn?(t=e.key,r=e):this.checkKey(t)&&(r=this.create(t,e)),r){if(Array.isArray(i))for(var n=i.length===1,a=0;a<r.source.length;a++){var o=n?i[0]:i[a];Oi.JSONArray(r,a,o)}else Oi.JSONArray(r,0,i);s&&r.setDataSource(s),this.emit(pe.ADD,t,r),this.emit(pe.ADD_KEY+t,r)}return r},addAtlasJSONHash:function(t,e,i,s){var r=null;if(e instanceof yn?(t=e.key,r=e):this.checkKey(t)&&(r=this.create(t,e)),r){if(Array.isArray(i))for(var n=0;n<i.length;n++)Oi.JSONHash(r,n,i[n]);else Oi.JSONHash(r,0,i);s&&r.setDataSource(s),this.emit(pe.ADD,t,r),this.emit(pe.ADD_KEY+t,r)}return r},addAtlasXML:function(t,e,i,s){var r=null;return e instanceof yn?(t=e.key,r=e):this.checkKey(t)&&(r=this.create(t,e)),r&&(Oi.AtlasXML(r,0,i),s&&r.setDataSource(s),this.emit(pe.ADD,t,r),this.emit(pe.ADD_KEY+t,r)),r},addUnityAtlas:function(t,e,i,s){var r=null;return e instanceof yn?(t=e.key,r=e):this.checkKey(t)&&(r=this.create(t,e)),r&&(Oi.UnityYAML(r,0,i),s&&r.setDataSource(s),this.emit(pe.ADD,t,r),this.emit(pe.ADD_KEY+t,r)),r},addSpriteSheet:function(t,e,i,s){var r=null;if(e instanceof yn?(t=e.key,r=e):this.checkKey(t)&&(r=this.create(t,e)),r){var n=r.source[0].width,a=r.source[0].height;Oi.SpriteSheet(r,0,0,0,n,a,i),s&&r.setDataSource(s),this.emit(pe.ADD,t,r),this.emit(pe.ADD_KEY+t,r)}return r},addSpriteSheetFromAtlas:function(t,e){if(!this.checkKey(t))return null;var i=VJ(e,"atlas",null),s=VJ(e,"frame",null);if(!(!i||!s)){var r=this.get(i),n=r.get(s);if(n){var a=n.source.image;a||(a=n.source.glTexture);var o=this.create(t,a);return n.trimmed?Oi.SpriteSheetFromAtlas(o,n,e):Oi.SpriteSheet(o,0,n.cutX,n.cutY,n.cutWidth,n.cutHeight,e),this.emit(pe.ADD,t,o),this.emit(pe.ADD_KEY+t,o),o}}},addUint8Array:function(t,e,i,s){if(!this.checkKey(t)||e.length/4!==i*s)return null;var r=this.create(t,e,i,s);return r.add("__BASE",0,0,0,i,s),this.emit(pe.ADD,t,r),this.emit(pe.ADD_KEY+t,r),r},create:function(t,e,i,s){var r=null;return this.checkKey(t)&&(r=new yn(this,t,e,i,s),this.list[t]=r),r},exists:function(t){return this.list.hasOwnProperty(t)},get:function(t){return t===void 0&&(t="__DEFAULT"),this.list[t]?this.list[t]:t instanceof yn?t:t instanceof zJ?t.texture:this.list.__MISSING},cloneFrame:function(t,e){if(this.list[t])return this.list[t].get(e).clone()},getFrame:function(t,e){if(this.list[t])return this.list[t].get(e)},parseFrame:function(t){if(t){if(typeof t=="string")return this.getFrame(t);if(Array.isArray(t)&&t.length===2)return this.getFrame(t[0],t[1]);if(PLe(t))return this.getFrame(t.key,t.frame);if(t instanceof yn)return t.get();if(t instanceof zJ)return t}else return},getTextureKeys:function(){var t=[];for(var e in this.list)e!=="__DEFAULT"&&e!=="__MISSING"&&e!=="__WHITE"&&e!=="__NORMAL"&&t.push(e);return t},getPixel:function(t,e,i,s){var r=this.getFrame(i,s);if(r){t-=r.x,e-=r.y;var n=r.data.cut;if(t+=n.x,e+=n.y,t>=n.x&&t<n.r&&e>=n.y&&e<n.b){var a=this._tempContext;a.clearRect(0,0,1,1),a.drawImage(r.source.image,t,e,1,1,0,0,1,1);var o=a.getImageData(0,0,1,1);return new ALe(o.data[0],o.data[1],o.data[2],o.data[3])}}return null},getPixelAlpha:function(t,e,i,s){var r=this.getFrame(i,s);if(r){t-=r.x,e-=r.y;var n=r.data.cut;if(t+=n.x,e+=n.y,t>=n.x&&t<n.r&&e>=n.y&&e<n.b){var a=this._tempContext;a.clearRect(0,0,1,1),a.drawImage(r.source.image,t,e,1,1,0,0,1,1);var o=a.getImageData(0,0,1,1);return o.data[3]}}return null},setTexture:function(t,e,i){return this.list[e]&&(t.texture=this.list[e],t.frame=t.texture.get(i)),t},renameTexture:function(t,e){var i=this.get(t);return i&&t!==e?(i.key=e,this.list[e]=i,delete this.list[t],!0):!1},each:function(t,e){for(var i=[null],s=1;s<arguments.length;s++)i.push(arguments[s]);for(var r in this.list)i[0]=this.list[r],t.apply(e,i)},resetStamp:function(t,e){t===void 0&&(t=1),e===void 0&&(e=16777215);var i=this.stamp;return i.setCrop(),i.setPosition(0),i.setAngle(0),i.setScale(1),i.setAlpha(t),i.setTint(e),i.setTexture("__WHITE"),i},destroy:function(){for(var t in this.list)this.list[t].destroy();this.list={},this.stamp.destroy(),this.game=null,this.stamp=null,Xo.remove(this._tempCanvas)}});XJ.exports=ILe});var $J=u((Edt,jJ)=>{"use strict";var LLe=R(),ZJ=Ie(),MLe=new LLe({initialize:function(){this.isRunning=!1,this.callback=ZJ,this.isSetTimeOut=!1,this.timeOutID=null,this.delay=0;var e=this;this.step=function i(s){e.callback(s),e.isRunning&&(e.timeOutID=window.requestAnimationFrame(i))},this.stepTimeout=function i(){e.isRunning&&(e.timeOutID=window.setTimeout(i,e.delay)),e.callback(window.performance.now())}},start:function(t,e,i){this.isRunning||(this.callback=t,this.isSetTimeOut=e,this.delay=i,this.isRunning=!0,this.timeOutID=e?window.setTimeout(this.stepTimeout,0):window.requestAnimationFrame(this.step))},stop:function(){this.isRunning=!1,this.isSetTimeOut?clearTimeout(this.timeOutID):window.cancelAnimationFrame(this.timeOutID)},destroy:function(){this.stop(),this.callback=ZJ}});jJ.exports=MLe});var QJ=u((Tdt,JJ)=>{"use strict";var OLe=R(),ba=Ne(),DLe=Ie(),BLe=$J(),ULe=new OLe({initialize:function(e,i){this.game=e,this.raf=new BLe,this.started=!1,this.running=!1,this.minFps=ba(i,"min",5),this.targetFps=ba(i,"target",60),this.fpsLimit=ba(i,"limit",0),this.hasFpsLimit=this.fpsLimit>0,this._limitRate=this.hasFpsLimit?1e3/this.fpsLimit:0,this._min=1e3/this.minFps,this._target=1e3/this.targetFps,this.actualFps=this.targetFps,this.nextFpsUpdate=0,this.framesThisSecond=0,this.callback=DLe,this.forceSetTimeOut=ba(i,"forceSetTimeOut",!1),this.time=0,this.startTime=0,this.lastTime=0,this.frame=0,this.inFocus=!0,this.pauseDuration=0,this._pauseTime=0,this._coolDown=0,this.delta=0,this.deltaIndex=0,this.deltaHistory=[],this.deltaSmoothingMax=ba(i,"deltaHistory",10),this.panicMax=ba(i,"panicMax",120),this.rawDelta=0,this.now=0,this.smoothStep=ba(i,"smoothStep",!0)},blur:function(){this.inFocus=!1},focus:function(){this.inFocus=!0,this.resetDelta()},pause:function(){this._pauseTime=window.performance.now()},resume:function(){this.resetDelta(),this.pauseDuration=this.time-this._pauseTime,this.startTime+=this.pauseDuration},resetDelta:function(){var t=window.performance.now();this.time=t,this.lastTime=t,this.nextFpsUpdate=t+1e3,this.framesThisSecond=0;for(var e=0;e<this.deltaSmoothingMax;e++)this.deltaHistory[e]=Math.min(this._target,this.deltaHistory[e]);this.delta=0,this.deltaIndex=0,this._coolDown=this.panicMax},start:function(t){if(this.started)return this;this.started=!0,this.running=!0;for(var e=0;e<this.deltaSmoothingMax;e++)this.deltaHistory[e]=this._target;this.resetDelta(),this.startTime=window.performance.now(),this.callback=t;var i=this.hasFpsLimit?this.stepLimitFPS.bind(this):this.step.bind(this);this.raf.start(i,this.forceSetTimeOut,this._target)},smoothDelta:function(t){var e=this.deltaIndex,i=this.deltaHistory,s=this.deltaSmoothingMax;(this._coolDown>0||!this.inFocus)&&(this._coolDown--,t=Math.min(t,this._target)),t>this._min&&(t=i[e],t=Math.min(t,this._min)),i[e]=t,this.deltaIndex++,this.deltaIndex>=s&&(this.deltaIndex=0);for(var r=0,n=0;n<s;n++)r+=i[n];return r/=s,r},updateFPS:function(t){this.actualFps=.25*this.framesThisSecond+.75*this.actualFps,this.nextFpsUpdate=t+1e3,this.framesThisSecond=0},stepLimitFPS:function(t){this.now=t;var e=Math.max(0,t-this.lastTime);this.rawDelta=e,this.time+=this.rawDelta,this.smoothStep&&(e=this.smoothDelta(e)),this.delta+=e,t>=this.nextFpsUpdate&&this.updateFPS(t),this.framesThisSecond++,this.delta>=this._limitRate&&(this.callback(t,this.delta),this.delta=0),this.lastTime=t,this.frame++},step:function(t){this.now=t;var e=Math.max(0,t-this.lastTime);this.rawDelta=e,this.time+=this.rawDelta,this.smoothStep&&(e=this.smoothDelta(e)),this.delta=e,t>=this.nextFpsUpdate&&this.updateFPS(t),this.framesThisSecond++,this.callback(t,e),this.lastTime=t,this.frame++},tick:function(){var t=window.performance.now();this.hasFpsLimit?this.stepLimitFPS(t):this.step(t)},sleep:function(){this.running&&(this.raf.stop(),this.running=!1)},wake:function(t){t===void 0&&(t=!1);var e=window.performance.now();if(!this.running){t&&(this.startTime+=-this.lastTime+(this.lastTime+e));var i=this.hasFpsLimit?this.stepLimitFPS.bind(this):this.step.bind(this);this.raf.start(i,this.forceSetTimeOut,this._target),this.running=!0,this.nextFpsUpdate=e+1e3,this.framesThisSecond=0,this.fpsLimitTriggered=!1,this.tick()}},getDuration:function(){return Math.round(this.lastTime-this.startTime)/1e3},getDurationMS:function(){return Math.round(this.lastTime-this.startTime)},stop:function(){return this.running=!1,this.started=!1,this.raf.stop(),this},destroy:function(){this.stop(),this.raf.destroy(),this.raf=null,this.game=null,this.callback=null}});JJ.exports=ULe});var tQ=u((ydt,eQ)=>{"use strict";var cf=vi(),NLe=function(t){var e,i=t.events;if(document.hidden!==void 0)e="visibilitychange";else{var s=["webkit","moz","ms"];s.forEach(function(n){document[n+"Hidden"]!==void 0&&(document.hidden=function(){return document[n+"Hidden"]},e=n+"visibilitychange")})}var r=function(n){document.hidden||n.type==="pause"?i.emit(cf.HIDDEN):i.emit(cf.VISIBLE)};e&&document.addEventListener(e,r,!1),window.onblur=function(){i.emit(cf.BLUR)},window.onfocus=function(){i.emit(cf.FOCUS)},window.focus&&t.config.autoFocus&&window.focus()};eQ.exports=NLe});var sQ=u((bdt,iQ)=>{"use strict";iQ.exports="complete"});var nQ=u((Adt,rQ)=>{"use strict";rQ.exports="decoded"});var oQ=u((xdt,aQ)=>{"use strict";aQ.exports="decodedall"});var lQ=u((Cdt,hQ)=>{"use strict";hQ.exports="destroy"});var cQ=u((wdt,uQ)=>{"use strict";uQ.exports="detune"});var fQ=u((Rdt,dQ)=>{"use strict";dQ.exports="detune"});var mQ=u((Pdt,pQ)=>{"use strict";pQ.exports="mute"});var gQ=u((_dt,vQ)=>{"use strict";vQ.exports="rate"});var EQ=u((Idt,SQ)=>{"use strict";SQ.exports="volume"});var yQ=u((Ldt,TQ)=>{"use strict";TQ.exports="loop"});var AQ=u((Mdt,bQ)=>{"use strict";bQ.exports="looped"});var CQ=u((Odt,xQ)=>{"use strict";xQ.exports="mute"});var RQ=u((Ddt,wQ)=>{"use strict";wQ.exports="pan"});var _Q=u((Bdt,PQ)=>{"use strict";PQ.exports="pauseall"});var LQ=u((Udt,IQ)=>{"use strict";IQ.exports="pause"});var OQ=u((Ndt,MQ)=>{"use strict";MQ.exports="play"});var BQ=u((Fdt,DQ)=>{"use strict";DQ.exports="rate"});var NQ=u((kdt,UQ)=>{"use strict";UQ.exports="resumeall"});var kQ=u((Gdt,FQ)=>{"use strict";FQ.exports="resume"});var qQ=u((qdt,GQ)=>{"use strict";GQ.exports="seek"});var YQ=u((Wdt,WQ)=>{"use strict";WQ.exports="stopall"});var zQ=u((Ydt,HQ)=>{"use strict";HQ.exports="stop"});var XQ=u((Hdt,VQ)=>{"use strict";VQ.exports="unlocked"});var ZQ=u((zdt,KQ)=>{"use strict";KQ.exports="volume"});var Dl=u((Vdt,jQ)=>{"use strict";jQ.exports={COMPLETE:sQ(),DECODED:nQ(),DECODED_ALL:oQ(),DESTROY:lQ(),DETUNE:cQ(),GLOBAL_DETUNE:fQ(),GLOBAL_MUTE:mQ(),GLOBAL_RATE:gQ(),GLOBAL_VOLUME:EQ(),LOOP:yQ(),LOOPED:AQ(),MUTE:CQ(),PAN:RQ(),PAUSE_ALL:_Q(),PAUSE:LQ(),PLAY:OQ(),RATE:BQ(),RESUME_ALL:NQ(),RESUME:kQ(),SEEK:qQ(),STOP_ALL:YQ(),STOP:zQ(),UNLOCKED:XQ(),VOLUME:ZQ()}});var wA=u((Xdt,JQ)=>{"use strict";var FLe=R(),kLe=gh(),$Q=ze(),bn=Dl(),Aa=vi(),CA=Vl(),GLe=Cf(),Bl=Ie(),qLe=Fe(),WLe=new FLe({Extends:$Q,initialize:function(e){$Q.call(this),this.game=e,this.jsonCache=e.cache.json,this.sounds=[],this.mute=!1,this.volume=1,this.pauseOnBlur=!0,this._rate=1,this._detune=0,this.locked=this.locked||!1,this.unlocked=!1,this.gameLostFocus=!1,this.listenerPosition=new qLe;var i=e.events;i.on(Aa.BLUR,this.onGameBlur,this),i.on(Aa.FOCUS,this.onGameFocus,this),i.on(Aa.PRE_STEP,this.update,this),i.once(Aa.DESTROY,this.destroy,this)},add:Bl,addAudioSprite:function(t,e){e===void 0&&(e={});var i=this.add(t,e);i.spritemap=this.jsonCache.get(t).spritemap;for(var s in i.spritemap)if(i.spritemap.hasOwnProperty(s)){var r=kLe(e),n=i.spritemap[s];r.loop=n.hasOwnProperty("loop")?n.loop:!1,i.addMarker({name:s,start:n.start,duration:n.end-n.start,config:r})}return i},get:function(t){return GLe(this.sounds,"key",t)},getAll:function(t){return t?CA(this.sounds,"key",t):CA(this.sounds)},getAllPlaying:function(){return CA(this.sounds,"isPlaying",!0)},play:function(t,e){var i=this.add(t);return i.once(bn.COMPLETE,i.destroy,i),e?e.name?(i.addMarker(e),i.play(e.name)):i.play(e):i.play()},playAudioSprite:function(t,e,i){var s=this.addAudioSprite(t);return s.once(bn.COMPLETE,s.destroy,s),s.play(e,i)},remove:function(t){var e=this.sounds.indexOf(t);return e!==-1?(t.destroy(),this.sounds.splice(e,1),!0):!1},removeAll:function(){this.sounds.forEach(function(t){t.destroy()}),this.sounds.length=0},removeByKey:function(t){for(var e=0,i=this.sounds.length-1;i>=0;i--){var s=this.sounds[i];s.key===t&&(s.destroy(),this.sounds.splice(i,1),e++)}return e},pauseAll:function(){this.forEachActiveSound(function(t){t.pause()}),this.emit(bn.PAUSE_ALL,this)},resumeAll:function(){this.forEachActiveSound(function(t){t.resume()}),this.emit(bn.RESUME_ALL,this)},setListenerPosition:Bl,stopAll:function(){this.forEachActiveSound(function(t){t.stop()}),this.emit(bn.STOP_ALL,this)},stopByKey:function(t){var e=0;return this.getAll(t).forEach(function(i){i.stop()&&e++}),e},isPlaying:function(t){var e=this.sounds,i=e.length-1,s;if(t===void 0){for(;i>=0;i--)if(s=this.sounds[i],s.isPlaying)return!0}else for(;i>=0;i--)if(s=this.sounds[i],s.key===t&&s.isPlaying)return!0;return!1},unlock:Bl,onBlur:Bl,onFocus:Bl,onGameBlur:function(){this.gameLostFocus=!0,this.pauseOnBlur&&this.onBlur()},onGameFocus:function(){this.gameLostFocus=!1,this.pauseOnBlur&&this.onFocus()},update:function(t,e){this.unlocked&&(this.unlocked=!1,this.locked=!1,this.emit(bn.UNLOCKED,this));for(var i=this.sounds.length-1;i>=0;i--)this.sounds[i].pendingRemove&&this.sounds.splice(i,1);this.sounds.forEach(function(s){s.update(t,e)})},destroy:function(){this.game.events.off(Aa.BLUR,this.onGameBlur,this),this.game.events.off(Aa.FOCUS,this.onGameFocus,this),this.game.events.off(Aa.PRE_STEP,this.update,this),this.removeAllListeners(),this.removeAll(),this.sounds.length=0,this.sounds=null,this.listenerPosition=null,this.game=null},forEachActiveSound:function(t,e){var i=this;this.sounds.forEach(function(s,r){s&&!s.pendingRemove&&t.call(e||i,s,r,i.sounds)})},setRate:function(t){return this.rate=t,this},rate:{get:function(){return this._rate},set:function(t){this._rate=t,this.forEachActiveSound(function(e){e.calculateRate()}),this.emit(bn.GLOBAL_RATE,this,t)}},setDetune:function(t){return this.detune=t,this},detune:{get:function(){return this._detune},set:function(t){this._detune=t,this.forEachActiveSound(function(e){e.calculateRate()}),this.emit(bn.GLOBAL_DETUNE,this,t)}}});JQ.exports=WLe});var RA=u((Kdt,eee)=>{"use strict";var YLe=R(),QQ=ze(),HLe=Dl(),df=mi(),zLe=Ie(),VLe=new YLe({Extends:QQ,initialize:function(e,i,s){QQ.call(this),this.manager=e,this.key=i,this.isPlaying=!1,this.isPaused=!1,this.totalRate=1,this.duration=this.duration||0,this.totalDuration=this.totalDuration||0,this.config={mute:!1,volume:1,rate:1,detune:0,seek:0,loop:!1,delay:0,pan:0},this.currentConfig=this.config,this.config=df(this.config,s),this.markers={},this.currentMarker=null,this.pendingRemove=!1},addMarker:function(t){return!t||!t.name||typeof t.name!="string"?!1:this.markers[t.name]?(console.error("addMarker "+t.name+" already exists in Sound"),!1):(t=df(!0,{name:"",start:0,duration:this.totalDuration-(t.start||0),config:{mute:!1,volume:1,rate:1,detune:0,seek:0,loop:!1,delay:0,pan:0}},t),this.markers[t.name]=t,!0)},updateMarker:function(t){return!t||!t.name||typeof t.name!="string"?!1:this.markers[t.name]?(this.markers[t.name]=df(!0,this.markers[t.name],t),!0):(console.warn("Audio Marker: "+t.name+" missing in Sound: "+this.key),!1)},removeMarker:function(t){var e=this.markers[t];return e?(this.markers[t]=null,e):null},play:function(t,e){if(t===void 0&&(t=""),typeof t=="object"&&(e=t,t=""),typeof t!="string")return!1;if(!t)this.currentMarker=null,this.currentConfig=this.config,this.duration=this.totalDuration;else{if(!this.markers[t])return console.warn("Marker: "+t+" missing in Sound: "+this.key),!1;this.currentMarker=this.markers[t],this.currentConfig=this.currentMarker.config,this.duration=this.currentMarker.duration}return this.resetConfig(),this.currentConfig=df(this.currentConfig,e),this.isPlaying=!0,this.isPaused=!1,!0},pause:function(){return this.isPaused||!this.isPlaying?!1:(this.isPlaying=!1,this.isPaused=!0,!0)},resume:function(){return!this.isPaused||this.isPlaying?!1:(this.isPlaying=!0,this.isPaused=!1,!0)},stop:function(){return!this.isPaused&&!this.isPlaying?!1:(this.isPlaying=!1,this.isPaused=!1,this.resetConfig(),!0)},applyConfig:function(){this.mute=this.currentConfig.mute,this.volume=this.currentConfig.volume,this.rate=this.currentConfig.rate,this.detune=this.currentConfig.detune,this.loop=this.currentConfig.loop,this.pan=this.currentConfig.pan},resetConfig:function(){this.currentConfig.seek=0,this.currentConfig.delay=0},update:zLe,calculateRate:function(){var t=1.0005777895065548,e=this.currentConfig.detune+this.manager.detune,i=Math.pow(t,e);this.totalRate=this.currentConfig.rate*this.manager.rate*i},destroy:function(){this.pendingRemove||(this.stop(),this.emit(HLe.DESTROY,this),this.removeAllListeners(),this.pendingRemove=!0,this.manager=null,this.config=null,this.currentConfig=null,this.markers=null,this.currentMarker=null)}});eee.exports=VLe});var see=u((Zdt,iee)=>{"use strict";var XLe=RA(),KLe=R(),tee=ze(),ZLe=mi(),jLe=Ie(),Ko=function(){return!1},ff=function(){return null},xa=function(){return this},$Le=new KLe({Extends:tee,initialize:function(e,i,s){s===void 0&&(s={}),tee.call(this),this.manager=e,this.key=i,this.isPlaying=!1,this.isPaused=!1,this.totalRate=1,this.duration=0,this.totalDuration=0,this.config=ZLe({mute:!1,volume:1,rate:1,detune:0,seek:0,loop:!1,delay:0,pan:0},s),this.currentConfig=this.config,this.mute=!1,this.volume=1,this.rate=1,this.detune=0,this.seek=0,this.loop=!1,this.pan=0,this.markers={},this.currentMarker=null,this.pendingRemove=!1},addMarker:Ko,updateMarker:Ko,removeMarker:ff,play:Ko,pause:Ko,resume:Ko,stop:Ko,setMute:xa,setVolume:xa,setRate:xa,setDetune:xa,setSeek:xa,setLoop:xa,setPan:xa,applyConfig:ff,resetConfig:ff,update:jLe,calculateRate:ff,destroy:function(){XLe.prototype.destroy.call(this)}});iee.exports=$Le});var aee=u((jdt,nee)=>{"use strict";var An=wA(),JLe=R(),ree=ze(),QLe=see(),Di=Ie(),eMe=new JLe({Extends:ree,initialize:function(e){ree.call(this),this.game=e,this.sounds=[],this.mute=!1,this.volume=1,this.rate=1,this.detune=0,this.pauseOnBlur=!0,this.locked=!1},add:function(t,e){var i=new QLe(this,t,e);return this.sounds.push(i),i},addAudioSprite:function(t,e){var i=this.add(t,e);return i.spritemap={},i},get:function(t){return An.prototype.get.call(this,t)},getAll:function(t){return An.prototype.getAll.call(this,t)},play:function(t,e){return!1},playAudioSprite:function(t,e,i){return!1},remove:function(t){return An.prototype.remove.call(this,t)},removeAll:function(){return An.prototype.removeAll.call(this)},removeByKey:function(t){return An.prototype.removeByKey.call(this,t)},stopByKey:function(t){return An.prototype.stopByKey.call(this,t)},onBlur:Di,onFocus:Di,onGameBlur:Di,onGameFocus:Di,pauseAll:Di,resumeAll:Di,stopAll:Di,update:Di,setRate:Di,setDetune:Di,setMute:Di,setVolume:Di,unlock:Di,forEachActiveSound:function(t,e){An.prototype.forEachActiveSound.call(this,t,e)},destroy:function(){An.prototype.destroy.call(this)}});nee.exports=eMe});var lee=u(($dt,hee)=>{"use strict";var oee="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Nl=new Uint8Array(256);for(Ul=0;Ul<oee.length;Ul++)Nl[oee.charCodeAt(Ul)]=Ul;var Ul,tMe=function(t){t=t.substr(t.indexOf(",")+1);var e=t.length,i=e*.75,s=0,r,n,a,o;t[e-1]==="="&&(i--,t[e-2]==="="&&i--);for(var h=new ArrayBuffer(i),l=new Uint8Array(h),c=0;c<e;c+=4)r=Nl[t.charCodeAt(c)],n=Nl[t.charCodeAt(c+1)],a=Nl[t.charCodeAt(c+2)],o=Nl[t.charCodeAt(c+3)],l[s++]=r<<2|n>>4,l[s++]=(n&15)<<4|a>>2,l[s++]=(a&3)<<6|o&63;return h};hee.exports=tMe});var cee=u((Jdt,uee)=>{"use strict";var Qs=RA(),iMe=R(),Bi=Dl(),Dt=re(),sMe=new iMe({Extends:Qs,initialize:function(e,i,s){if(s===void 0&&(s={}),this.audioBuffer=e.game.cache.audio.get(i),!this.audioBuffer)throw new Error('Audio key "'+i+'" not found in cache');this.source=null,this.loopSource=null,this.muteNode=e.context.createGain(),this.volumeNode=e.context.createGain(),this.pannerNode=null,this.spatialNode=null,this.spatialSource=null,this.playTime=0,this.startTime=0,this.loopTime=0,this.rateUpdates=[],this.hasEnded=!1,this.hasLooped=!1,this.muteNode.connect(this.volumeNode),e.context.createPanner&&(this.spatialNode=e.context.createPanner(),this.volumeNode.connect(this.spatialNode)),e.context.createStereoPanner?(this.pannerNode=e.context.createStereoPanner(),e.context.createPanner?this.spatialNode.connect(this.pannerNode):this.volumeNode.connect(this.pannerNode),this.pannerNode.connect(e.destination)):e.context.createPanner?this.spatialNode.connect(e.destination):this.volumeNode.connect(e.destination),this.duration=this.audioBuffer.duration,this.totalDuration=this.audioBuffer.duration,Qs.call(this,e,i,s)},play:function(t,e){return Qs.prototype.play.call(this,t,e)?(this.stopAndRemoveBufferSource(),this.createAndStartBufferSource(),this.emit(Bi.PLAY,this),!0):!1},pause:function(){return this.manager.context.currentTime<this.startTime||!Qs.prototype.pause.call(this)?!1:(this.currentConfig.seek=this.getCurrentTime(),this.stopAndRemoveBufferSource(),this.emit(Bi.PAUSE,this),!0)},resume:function(){return this.manager.context.currentTime<this.startTime||!Qs.prototype.resume.call(this)?!1:(this.createAndStartBufferSource(),this.emit(Bi.RESUME,this),!0)},stop:function(){return Qs.prototype.stop.call(this)?(this.stopAndRemoveBufferSource(),this.emit(Bi.STOP,this),!0):!1},createAndStartBufferSource:function(){var t=this.currentConfig.seek,e=this.currentConfig.delay,i=this.manager.context.currentTime+e,s=(this.currentMarker?this.currentMarker.start:0)+t,r=this.duration-t;this.playTime=i-t,this.startTime=i,this.source=this.createBufferSource(),this.applyConfig(),this.source.start(Math.max(0,i),Math.max(0,s),Math.max(0,r)),this.resetConfig()},createAndStartLoopBufferSource:function(){var t=this.getLoopTime(),e=this.currentMarker?this.currentMarker.start:0,i=this.duration;this.loopTime=t,this.loopSource=this.createBufferSource(),this.loopSource.playbackRate.setValueAtTime(this.totalRate,0),this.loopSource.start(Math.max(0,t),Math.max(0,e),Math.max(0,i))},createBufferSource:function(){var t=this,e=this.manager.context.createBufferSource();return e.buffer=this.audioBuffer,e.connect(this.muteNode),e.onended=function(i){var s=i.target;(s===t.source||s===t.loopSource)&&(t.currentConfig.loop?t.hasLooped=!0:t.hasEnded=!0)},e},stopAndRemoveBufferSource:function(){if(this.source){var t=this.source;this.source=null,t.stop(),t.disconnect()}this.playTime=0,this.startTime=0,this.hasEnded=!1,this.stopAndRemoveLoopBufferSource()},stopAndRemoveLoopBufferSource:function(){this.loopSource&&(this.loopSource.stop(),this.loopSource.disconnect(),this.loopSource=null),this.loopTime=0},applyConfig:function(){this.rateUpdates.length=0,this.rateUpdates.push({time:0,rate:1});var t=this.currentConfig.source;if(t&&this.manager.context.createPanner){var e=this.spatialNode;e.panningModel=Dt(t,"panningModel","equalpower"),e.distanceModel=Dt(t,"distanceModel","inverse"),e.orientationX.value=Dt(t,"orientationX",0),e.orientationY.value=Dt(t,"orientationY",0),e.orientationZ.value=Dt(t,"orientationZ",-1),e.refDistance=Dt(t,"refDistance",1),e.maxDistance=Dt(t,"maxDistance",1e4),e.rolloffFactor=Dt(t,"rolloffFactor",1),e.coneInnerAngle=Dt(t,"coneInnerAngle",360),e.coneOuterAngle=Dt(t,"coneOuterAngle",0),e.coneOuterGain=Dt(t,"coneOuterGain",0),this.spatialSource=Dt(t,"follow",null),this.spatialSource||(e.positionX.value=Dt(t,"x",0),e.positionY.value=Dt(t,"y",0),e.positionZ.value=Dt(t,"z",0))}Qs.prototype.applyConfig.call(this)},x:{get:function(){return this.spatialNode?this.spatialNode.positionX:0},set:function(t){this.spatialNode&&(this.spatialNode.positionX.value=t)}},y:{get:function(){return this.spatialNode?this.spatialNode.positionY:0},set:function(t){this.spatialNode&&(this.spatialNode.positionY.value=t)}},update:function(){if(this.isPlaying&&this.spatialSource){var t=Dt(this.spatialSource,"x",null),e=Dt(this.spatialSource,"y",null);t&&t!==this._spatialx&&(this._spatialx=this.spatialNode.positionX.value=t),e&&e!==this._spatialy&&(this._spatialy=this.spatialNode.positionY.value=e)}this.hasEnded?(Qs.prototype.stop.call(this),this.stopAndRemoveBufferSource(),this.emit(Bi.COMPLETE,this)):this.hasLooped&&(this.hasLooped=!1,this.source=this.loopSource,this.loopSource=null,this.playTime=this.startTime=this.loopTime,this.rateUpdates.length=0,this.rateUpdates.push({time:0,rate:this.totalRate}),this.createAndStartLoopBufferSource(),this.emit(Bi.LOOPED,this))},destroy:function(){this.pendingRemove||(Qs.prototype.destroy.call(this),this.audioBuffer=null,this.stopAndRemoveBufferSource(),this.muteNode.disconnect(),this.muteNode=null,this.volumeNode.disconnect(),this.volumeNode=null,this.pannerNode&&(this.pannerNode.disconnect(),this.pannerNode=null),this.spatialNode&&(this.spatialNode.disconnect(),this.spatialNode=null,this.spatialSource=null),this.rateUpdates.length=0,this.rateUpdates=null)},calculateRate:function(){Qs.prototype.calculateRate.call(this);var t=this.manager.context.currentTime;this.source&&typeof this.totalRate=="number"&&this.source.playbackRate.setValueAtTime(this.totalRate,t),this.isPlaying&&(this.rateUpdates.push({time:Math.max(this.startTime,t)-this.playTime,rate:this.totalRate}),this.loopSource&&(this.stopAndRemoveLoopBufferSource(),this.createAndStartLoopBufferSource()))},getCurrentTime:function(){for(var t=0,e=0;e<this.rateUpdates.length;e++){var i=0;e<this.rateUpdates.length-1?i=this.rateUpdates[e+1].time:i=this.manager.context.currentTime-this.playTime,t+=(i-this.rateUpdates[e].time)*this.rateUpdates[e].rate}return t},getLoopTime:function(){for(var t=0,e=0;e<this.rateUpdates.length-1;e++)t+=(this.rateUpdates[e+1].time-this.rateUpdates[e].time)*this.rateUpdates[e].rate;var i=this.rateUpdates[this.rateUpdates.length-1];return this.playTime+i.time+(this.duration-t)/i.rate},rate:{get:function(){return this.currentConfig.rate},set:function(t){this.currentConfig.rate=t,this.calculateRate(),this.emit(Bi.RATE,this,t)}},setRate:function(t){return this.rate=t,this},detune:{get:function(){return this.currentConfig.detune},set:function(t){this.currentConfig.detune=t,this.calculateRate(),this.emit(Bi.DETUNE,this,t)}},setDetune:function(t){return this.detune=t,this},mute:{get:function(){return this.muteNode.gain.value===0},set:function(t){this.currentConfig.mute=t,this.muteNode.gain.setValueAtTime(t?0:1,0),this.emit(Bi.MUTE,this,t)}},setMute:function(t){return this.mute=t,this},volume:{get:function(){return this.volumeNode.gain.value},set:function(t){this.currentConfig.volume=t,this.volumeNode.gain.setValueAtTime(t,0),this.emit(Bi.VOLUME,this,t)}},setVolume:function(t){return this.volume=t,this},seek:{get:function(){return this.isPlaying?this.manager.context.currentTime<this.startTime?this.startTime-this.playTime:this.getCurrentTime():this.isPaused?this.currentConfig.seek:0},set:function(t){this.manager.context.currentTime<this.startTime||(this.isPlaying||this.isPaused)&&(t=Math.min(Math.max(0,t),this.duration),this.currentConfig.seek=t,this.isPlaying&&(this.stopAndRemoveBufferSource(),this.createAndStartBufferSource()),this.emit(Bi.SEEK,this,t))}},setSeek:function(t){return this.seek=t,this},loop:{get:function(){return this.currentConfig.loop},set:function(t){this.currentConfig.loop=t,this.isPlaying&&(this.stopAndRemoveLoopBufferSource(),t&&this.createAndStartLoopBufferSource()),this.emit(Bi.LOOP,this,t)}},setLoop:function(t){return this.loop=t,this},pan:{get:function(){return this.pannerNode?this.pannerNode.pan.value:0},set:function(t){this.currentConfig.pan=t,this.pannerNode&&this.pannerNode.pan.setValueAtTime(t,this.manager.context.currentTime),this.emit(Bi.PAN,this,t)}},setPan:function(t){return this.pan=t,this}});uee.exports=sMe});var pee=u((Qdt,fee)=>{"use strict";var rMe=lee(),pf=wA(),nMe=R(),Fl=Dl(),PA=vi(),aMe=cee(),dee=re(),oMe=new nMe({Extends:pf,initialize:function(e){this.context=this.createAudioContext(e),this.masterMuteNode=this.context.createGain(),this.masterVolumeNode=this.context.createGain(),this.masterMuteNode.connect(this.masterVolumeNode),this.masterVolumeNode.connect(this.context.destination),this.destination=this.masterMuteNode,this.locked=this.context.state==="suspended",pf.call(this,e),this.locked&&(e.isBooted?this.unlock():e.events.once(PA.BOOT,this.unlock,this)),e.events.on(PA.VISIBLE,this.onGameVisible,this)},onGameVisible:function(){var t=this.context;window.setTimeout(function(){t&&(t.suspend(),t.resume())},100)},createAudioContext:function(t){var e=t.config.audio;if(e.context)return e.context.resume(),e.context;if(window.hasOwnProperty("AudioContext"))return new AudioContext;if(window.hasOwnProperty("webkitAudioContext"))return new window.webkitAudioContext},setAudioContext:function(t){return this.context&&this.context.close(),this.masterMuteNode&&this.masterMuteNode.disconnect(),this.masterVolumeNode&&this.masterVolumeNode.disconnect(),this.context=t,this.masterMuteNode=t.createGain(),this.masterVolumeNode=t.createGain(),this.masterMuteNode.connect(this.masterVolumeNode),this.masterVolumeNode.connect(t.destination),this.destination=this.masterMuteNode,this},add:function(t,e){var i=new aMe(this,t,e);return this.sounds.push(i),i},decodeAudio:function(t,e){var i;Array.isArray(t)?i=t:i=[{key:t,data:e}];for(var s=this.game.cache.audio,r=i.length,n=0;n<i.length;n++){var a=i[n],o=a.key,h=a.data;typeof h=="string"&&(h=rMe(h));var l=function(d,f){s.add(d,f),this.emit(Fl.DECODED,d),r--,r===0&&this.emit(Fl.DECODED_ALL)}.bind(this,o),c=function(d,f){console.error("Error decoding audio: "+d+" - ",f?f.message:""),r--,r===0&&this.emit(Fl.DECODED_ALL)}.bind(this,o);this.context.decodeAudioData(h,l,c)}},setListenerPosition:function(t,e){return t===void 0&&(t=this.game.scale.width/2),e===void 0&&(e=this.game.scale.height/2),this.listenerPosition.set(t,e),this},unlock:function(){var t=this,e=document.body,i=function s(){if(t.context&&e){var r=e.removeEventListener.bind(e);t.context.resume().then(function(){r("touchstart",s),r("touchend",s),r("mousedown",s),r("mouseup",s),r("keydown",s),t.unlocked=!0},function(){r("touchstart",s),r("touchend",s),r("mousedown",s),r("mouseup",s),r("keydown",s)})}};e&&(e.addEventListener("touchstart",i,!1),e.addEventListener("touchend",i,!1),e.addEventListener("mousedown",i,!1),e.addEventListener("mouseup",i,!1),e.addEventListener("keydown",i,!1))},onBlur:function(){this.locked||this.context.suspend()},onFocus:function(){var t=this.context;t&&!this.locked&&(t.state==="suspended"||t.state==="interrupted")&&t.resume()},update:function(t,e){var i=this.context.listener;if(i&&i.positionX!==void 0){var s=dee(this.listenerPosition,"x",null),r=dee(this.listenerPosition,"y",null);s&&s!==this._spatialx&&(this._spatialx=i.positionX.value=s),r&&r!==this._spatialy&&(this._spatialy=i.positionY.value=r)}pf.prototype.update.call(this,t,e),this.gameLostFocus||this.onFocus()},destroy:function(){if(this.destination=null,this.masterVolumeNode.disconnect(),this.masterVolumeNode=null,this.masterMuteNode.disconnect(),this.masterMuteNode=null,this.game.config.audio.context)this.context.suspend();else{var t=this;this.context.close().then(function(){t.context=null})}this.game.events.off(PA.VISIBLE,this.onGameVisible,this),pf.prototype.destroy.call(this)},setMute:function(t){return this.mute=t,this},mute:{get:function(){return this.masterMuteNode.gain.value===0},set:function(t){this.masterMuteNode.gain.setValueAtTime(t?0:1,0),this.emit(Fl.GLOBAL_MUTE,this,t)}},setVolume:function(t){return this.volume=t,this},volume:{get:function(){return this.masterVolumeNode.gain.value},set:function(t){this.masterVolumeNode.gain.setValueAtTime(t,0),this.emit(Fl.GLOBAL_VOLUME,this,t)}}});fee.exports=oMe});var gee=u((eft,vee)=>{"use strict";var mee=aee(),hMe=pee(),lMe={create:function(t){var e=t.config.audio,i=t.device.audio;return e.noAudio||!i.webAudio&&!i.audioData?new mee(t):i.webAudio&&!e.disableWebAudio?new hMe(t):new mee(t)}};vee.exports=lMe});var yee=u((tft,Tee)=>{"use strict";var uMe=Qu(),cMe=$v(),dMe=x$(),fMe=Ui(),pMe=R(),mMe=I$(),vMe=M$(),gMe=B$(),SMe=mh(),EMe=th(),TMe=N$(),See=ze(),st=vi(),yMe=_p(),bMe=Vt(),AMe=H$(),xMe=mJ(),CMe=Hp(),wMe=Io(),RMe=KJ(),PMe=QJ(),_Me=tQ();Eee=gee();var Eee,IMe=new pMe({initialize:function(e){this.config=new mMe(e),this.renderer=null,this.domContainer=null,this.canvas=null,this.context=null,this.isBooted=!1,this.isRunning=!1,this.events=new See,this.anims=new cMe(this),this.textures=new RMe(this),this.cache=new dMe(this),this.registry=new SMe(this,new See),this.input=new yMe(this,this.config),this.scene=new CMe(this,this.config.sceneConfig),this.device=EMe,this.scale=new xMe(this,this.config),this.sound=null,this.sound=Eee.create(this),this.loop=new PMe(this,this.config.fps),this.plugins=new AMe(this,this.config),this.pendingDestroy=!1,this.removeCanvas=!1,this.noReturn=!1,this.hasFocus=!1,this.isPaused=!1,TMe(this.boot.bind(this))},boot:function(){if(!bMe.hasCore("EventEmitter")){console.warn("Aborting. Core Plugins missing.");return}this.isBooted=!0,this.config.preBoot(this),this.scale.preBoot(),gMe(this),vMe(this),uMe(this.canvas,this.config.parent),this.textures.once(wMe.READY,this.texturesReady,this),this.events.emit(st.BOOT)},texturesReady:function(){this.events.emit(st.READY),this.start()},start:function(){this.isRunning=!0,this.config.postBoot(this),this.renderer?this.loop.start(this.step.bind(this)):this.loop.start(this.headlessStep.bind(this)),_Me(this);var t=this.events;t.on(st.HIDDEN,this.onHidden,this),t.on(st.VISIBLE,this.onVisible,this),t.on(st.BLUR,this.onBlur,this),t.on(st.FOCUS,this.onFocus,this)},step:function(t,e){if(this.pendingDestroy)return this.runDestroy();if(!this.isPaused){var i=this.events;i.emit(st.PRE_STEP,t,e),i.emit(st.STEP,t,e),this.scene.update(t,e),i.emit(st.POST_STEP,t,e);var s=this.renderer;s.preRender(),i.emit(st.PRE_RENDER,s,t,e),this.scene.render(s),s.postRender(),i.emit(st.POST_RENDER,s,t,e)}},headlessStep:function(t,e){if(this.pendingDestroy)return this.runDestroy();if(!this.isPaused){var i=this.events;i.emit(st.PRE_STEP,t,e),i.emit(st.STEP,t,e),this.scene.update(t,e),i.emit(st.POST_STEP,t,e),this.scene.isProcessing=!1,i.emit(st.PRE_RENDER,null,t,e),i.emit(st.POST_RENDER,null,t,e)}},onHidden:function(){this.loop.pause(),this.events.emit(st.PAUSE)},pause:function(){var t=this.isPaused;this.isPaused=!0,t||this.events.emit(st.PAUSE)},onVisible:function(){this.loop.resume(),this.events.emit(st.RESUME,this.loop.pauseDuration)},resume:function(){var t=this.isPaused;this.isPaused=!1,t&&this.events.emit(st.RESUME,0)},onBlur:function(){this.hasFocus=!1,this.loop.blur()},onFocus:function(){this.hasFocus=!0,this.loop.focus()},getFrame:function(){return this.loop.frame},getTime:function(){return this.loop.now},destroy:function(t,e){e===void 0&&(e=!1),this.pendingDestroy=!0,this.removeCanvas=t,this.noReturn=e},runDestroy:function(){this.scene.destroy(),this.events.emit(st.DESTROY),this.events.removeAllListeners(),this.renderer&&this.renderer.destroy(),this.removeCanvas&&this.canvas&&(fMe.remove(this.canvas),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)),this.domContainer&&this.domContainer.parentNode&&this.domContainer.parentNode.removeChild(this.domContainer),this.loop.destroy(),this.pendingDestroy=!1}});Tee.exports=IMe});OA();DA();BA();UA();NA();FA();kA();var qFe=E(Ep()),WFe=E(UL()),YFe=E(_D()),HFe=E(YD()),zFe=E(aB()),VFe=E($B());var noe={BOOT_SCENE:"BootScene",LOAD_SCENE:"LoadScene",GAME_SCENE:"GameScene",GLOBAL_SCENE:"GlobalScene",TEST_LAYOUT_SCENE:"TestLayoutScene",DASHBOARD_SCENE:"DashboardScene"},z=noe;var aoe={VIEW_RESIZED:"view-resized",REQUEST_VIEW_RESIZE:"request-view-resize",LAYOUT_CHANGED:"layout-changed",PRELOAD_LANGUAGE:"preload-language",CHOOSE_LANGUAGE:"choose-language",LOCALIZE_APPLIED:"localize-applied",COINS_CHANGED:"coins-changed",DESTROY_SCREENS:"destroy-screens"},we=aoe;var ooe={Layout:{Portrait:"portrait",Landscape:"landscape"},DesignSize:{Portrait:{WIDTH:750,HEIGHT:1334},Landscape:{WIDTH:1920,HEIGHT:1080},Resolution:2,DesignScale:{Portrait:1,Landscape:1}},AcceptPortraitRatio:.72,PRIMARY_LAYOUT:"auto",FULL_PORTRAIT_SIZE:!0,FULL_LANDSCAPE_SIZE:!0},qr=ooe;var{event:Vp}=codex,{Utils:{Browser:JB,Function:hoe,Device:loe}}=Ludex,{AcceptPortraitRatio:uoe,DesignSize:{Portrait:QB,Landscape:eU,Resolution:Xp,DesignScale:tU},FULL_PORTRAIT_SIZE:coe,FULL_LANDSCAPE_SIZE:doe}=qr,Kp=class t{game;static _instance;layoutMode;static get inst(){return this._instance||(this._instance=new t),this._instance}static init(e){this.inst.game=e,e.canvas.id="GameCanvas",this.inst.listenEvents(),Vp.emit(we.REQUEST_VIEW_RESIZE)}listenEvents(){new ResizeObserver(this.handleBodyResize).observe(window.document.body),Vp.on(we.REQUEST_VIEW_RESIZE,this.resizeGame)}handleBodyResize=hoe.debounce(()=>{this.resizeGame()},300);resizeGame=e=>{let{width:i,height:s}=t.getWorldSize(),{width:r,height:n}=t.getCanvasSize(),a=t.getWorldScale();this.game.scale.resize(r,n),this.game.scale.setZoom(a);let o=t.isLandscape()?"landscape":"portrait",l=!this.layoutMode||this.layoutMode===o?we.VIEW_RESIZED:we.LAYOUT_CHANGED;Vp.emit(l,{width:i,height:s}),this.layoutMode=o};static dump(){console.warn("--------------------------------");let e=this.getPixelRatio(),i=this.getZoomRatio(),s=this.getWorldScale(),r=this.isFullPortrait(),n=this.isFullLandscape(),{width:a,height:o}=this.getWorldSize(),{width:h,height:l}=this.getDesignSize(),{width:c,height:d}=this.getScreenSize(),{width:f,height:p}=this.getCanvasSize();console.warn("dpr",e),console.warn("zoomRatio",i),console.warn("worldScale",s),console.warn("isFullPortrait",r),console.warn("isFullLandscape",n),console.warn("worldSize",a,o),console.warn("designSize",h,l),console.warn("screenSize",c,d),console.warn("canvasSize",f,p),console.warn("--------------------------------")}static isLandscape(){return this.getScreenRatio()>uoe}static isFullPortrait(){return!this.isLandscape()&&coe}static isFullLandscape(){return this.isLandscape()&&doe}static getZoomRatio(){let{width:e}=this.getCanvasSize(),{width:i}=this.getWorldSize();return e/i}static getWorldScale(){let{width:e,height:i}=this.getCanvasSize(),{width:s,height:r}=this.getScreenSize(),n=(s/e).toFixed(3),a=(r/i).toFixed(3);return Math.min(+n,+a)}static getDesignSize(){let e=QB.WIDTH,i=QB.HEIGHT;this.isLandscape()&&(e=eU.WIDTH,i=eU.HEIGHT);let s=this.isLandscape()?tU.Landscape:tU.Portrait,r=e/Xp*s,n=i/Xp*s;return{width:r,height:n}}static getWorldSize(){return this.isLandscape()?this.getWorldSizeLandscape():this.getWorldSizePortrait()}static getWorldSizePortrait(){let{width:e,height:i}=this.getDesignSize(),s=e,r=i,n=this.getDesignRatio(),a=this.getScreenRatio();return(a>n||this.isFullPortrait())&&(r=s/a),{width:s,height:r}}static getWorldSizeLandscape(){let{width:e,height:i}=this.getDesignSize(),{width:s,height:r}=this.getScreenSize(),n=e,a=i,o=this.getPixelRatio();if(!this.isFullLandscape())return{width:n,height:a};let{width:h}=this.calculateCanvasSizeForFullLandscape(),l=h/n;n=s*o/l,a=r*o/l;let c=n/a;return a<i&&(a=i,n=i*c),{width:n,height:a}}static calculateCanvasSizeForFullLandscape(){let{width:e,height:i}=this.getScreenSize(),s=this.getPixelRatio(),r=e*s,n=i*s,a=this.getDesignRatio(),o=this.getScreenRatio();return o>a?n=r/o:r=n*o,{width:r,height:n}}static getScreenSize(){let e=JB.getScreenWidth(),i=JB.getScreenHeight();return{width:e,height:i}}static getCanvasSize(){let{width:e,height:i}=this.getScreenSize(),s=this.getPixelRatio(),r=e*s,n=i*s;if(this.isFullLandscape()||this.isFullPortrait())return{width:r,height:n};let{width:a,height:o}=this.getWorldSize(),h=e/a,l=i/o,c=Math.min(h,l);return r=a*c*s,n=o*c*s,{width:r,height:n}}static getPixelRatio(){return Math.ceil(Math.min(loe.pixelRatio(),Xp))}static toPixelSize(e){let i=this.getPixelRatio();return Math.round(e*i)}static toDisplaySize(e){let i=this.getPixelRatio();return Math.round(e/i)}static getSizeForBackgroundMask(e){let{width:i,height:s}=this.getWorldSize();if(!e)return{width:i,height:s};let{width:r,height:n}=e,a=r||i,o=n||s,h=i/a,l=s/o;return{width:i*h,height:s*l}}static getDesignRatio(){let{width:e,height:i}=this.getDesignSize();return e/i}static getScreenRatio(){let{width:e,height:i}=this.getScreenSize();return e/i}static isGameWorldSmallerRatio(e){let{width:i,height:s}=this.getWorldSize();return i/s<=e}static isUsingLandscapeBackground(){let{width:e,height:i}=this.getWorldSize();return e/i>.796}},I=Kp;var q7=E(vi());var foe={UNITS_SCREEN:"UNITS_SCREEN",READY_SCREEN:"READY_SCREEN",NOTIFY_SCREEN:"NOTIFY_SCREEN",RESULT_SCREEN:"RESULT_SCREEN",BATTLE_SCREEN:"BATTLE_SCREEN",LOADING_SCREEN:"LOADING_SCREEN",SETTINGS_SCREEN:"SETTINGS_SCREEN",UNIT_REWARD_SCREEN:"UNIT_REWARD_SCREEN",UNIT_UNLOCK_SCREEN:"UNIT_UNLOCK_SCREEN",LEADER_BOARD_SCREEN:"LEADER_BOARD_SCREEN",BATTLE_RESULT_SCREEN:"BATTLE_RESULT_SCREEN",OFFLINE_REWARD_SCREEN:"OFFLINE_REWARD_SCREEN",FREE_GOLD_REWARD_SCREEN:"FREE_GOLD_REWARD_SCREEN",CHALLENGE_SPLASH_SCREEN:"CHALLENGE_SPLASH_SCREEN",RESET_DATA_SCREEN:"RESET_DATA_SCREEN",START_OVER_POPUP:"START_OVER_POPUP",BOSS_CHALLENGE_SCREEN:"BOSS_CHALLENGE_SCREEN"},O=foe;var Ya=E(Fi()),H=class{static runTween(e,i){if(i===void 0){e.hasStarted?e.restart():e.play();return}if(i.aborted){e.stop();return}let s=()=>e.stop(),r=()=>i.off(s);i.once(s),e.once(Ya.TWEEN_COMPLETE,r),e.once(Ya.TWEEN_STOP,r),e.hasStarted?e.restart():e.play()}static runTweenAsync(e){return new Promise(i=>{e.off(Ya.TWEEN_COMPLETE,i),e.once(Ya.TWEEN_COMPLETE,i),e.hasStarted?e.restart():e.play()})}};var uH=E(X());var lH=E(he()),Uge={duration:600,ease:lH.Cubic.Out,props:{alpha:{start:0,from:0,to:1}}},$r=Uge;var cH=E(ve()),{event:ac}=codex,{Utils:{Valid:Nge}}=Ludex,Ev=class extends uH.Container{zone;background;backgroundFadeAnimation$;async animateBackgroundAlpha(e,i=400){this.scene&&(this.backgroundFadeAnimation$?.remove(),this.backgroundFadeAnimation$=this.scene.tweens.add({...$r,targets:[this.background],props:{alpha:(0,cH.Clamp)(e,.01,1)},duration:i,paused:!0,onComplete:()=>{this.background.setAlpha(e)}}),await H.runTweenAsync(this.backgroundFadeAnimation$))}constructor(e,i){super(e),this.setName(i);let{width:s,height:r}=I.getWorldSize();this.setWorldSize(s,r),this.addZone$(),this.addBackground$(),this.registerEvents(),this.kill()}registerEvents(){ac.on(we.VIEW_RESIZED,this.handleResize$),ac.on(we.LAYOUT_CHANGED,this.handleResize$)}unregisterEvents(){ac.off(we.VIEW_RESIZED,this.handleResize$),ac.off(we.LAYOUT_CHANGED,this.handleResize$)}destroy(){this.unregisterEvents(),super.destroy()}open(e){this.revive(),Nge.isObject(e)&&(this.setDataEnabled(),this.setData(e)),this.scene.children.bringToTop(this),this.handleResize$()}close(){this.kill()}incY(e){this.y+=e,this.background.y-=e}incX(e){this.x+=e,this.background.x-=e}incScale(e){this.scale+=e,this.background.scale-=e^e*(100/e)}addZone$(){this.zone=this.scene.add.zone(0,0,0,0),this.zone.setWorldSize(this.width,this.height),this.zone.setInteractive(),this.add(this.zone)}addBackground$(){let e="screen-background";if(!this.scene.textures.exists(e)){let i=this.width+2,s=this.height+2,r=this.scene.add.graphics();r.fillStyle(0,1),r.fillRect(0,0,i,s),r.generateTexture(e,i,s),r.destroy()}this.background=this.scene.add.image(0,0,e),this.background.setWorldSize(this.width,this.height),this.add(this.background)}handleResize$=()=>{let{width:e,height:i}=I.getWorldSize();this.setWorldSize(e,i),this.zone.setSize(this.width,this.height),this.background.setWorldSize(this.width,this.height)};setBlockInputOutsideEnabled(e){this.scene.input.setTopOnly(e)}recalculateLightPosition(){}},De=Ev;var Fge=(t,e,i)=>{if(e&&i){let r=W.getCurrentScene();if(!r)return;let n=r.children.getAll(),a=!0;for(let o of n)!(o instanceof De)||o===i||o.visible&&(a=!1);if(!a)return}let s=document.getElementById("background-mask");s&&(s.style.backgroundColor=`rgba(0, 0, 0, ${t})`)},Tv=Fge;var yv=class{backgroundAlphaList;constructor(){this.backgroundAlphaList=[]}requestBackgroundMaskUpdate(e,i){let s=this.backgroundAlphaList.findIndex(r=>r.screenName===e);if(e===O.CHALLENGE_SPLASH_SCREEN){let r=this.backgroundAlphaList.find(n=>n.screenName===O.LOADING_SCREEN);if(r&&r.alpha!==0){this.handleChallengeSplashScreenCase();return}}s===-1?this.backgroundAlphaList.push({alpha:i,screenName:e}):this.backgroundAlphaList[s].alpha=i,this.updateBackgroundMask()}handleChallengeSplashScreenCase(){let e=this.backgroundAlphaList.findIndex(s=>s.screenName===O.CHALLENGE_SPLASH_SCREEN),i=this.backgroundAlphaList.find(s=>s.screenName===O.LOADING_SCREEN);i&&i.alpha!==0&&(e===-1?this.backgroundAlphaList.push({alpha:0,screenName:O.CHALLENGE_SPLASH_SCREEN}):this.backgroundAlphaList[e].alpha=0)}updateBackgroundMask(){if(this.backgroundAlphaList.length===0){Tv(0);return}let e=1;this.backgroundAlphaList.forEach(i=>{e*=1-i.alpha}),Tv(1-e)}},dH=yv;var Kz=E(ie()),Zz=E(nt());var FH=E(X()),Oh=class extends FH.Zone{constructor(e,i,s){super(e,0,0,i,s),this.setWorldSize(i,s)}};var Av=E(ie()),kH=E(Wp()),fr=E(qe()),{Events:oc,Utils:{Valid:hc}}=Ludex,{event:to}=codex,xv=class extends kH.default{unsubscribeList;gameZone;background;handleResize=e=>{if(!this.background||!this.gameZone)return;let{width:i,height:s}=e;this.gameZone.setWorldSize(i,s),this.background.setWorldSize(i,s),this.scaleGame(),Av.Align.In.Center(this.background,this.gameZone)};constructor(){super({visible:!1})}create(){to.emit(oc.SCENE_LOADED,{sceneName:this.scene.key}),this.createGameZone(),this.scaleGame(),to.on(we.VIEW_RESIZED,this.handleResize),to.on(we.LAYOUT_CHANGED,this.handleResize),this.events.once(fr.RENDER,()=>{to.emit(oc.SCENE_LAUNCHED,{sceneName:this.scene.key})}),this.events.on(fr.WAKE,this.handleSceneRendered),this.events.on(fr.RESUME,this.handleSceneRendered),this.events.on(fr.ADDED_TO_SCENE,e=>{"setWorldSize"in e&&hc.isFunction(e.setWorldSize)&&e.setWorldSize(),"setHighQuality"in e&&hc.isFunction(e.setHighQuality)&&e.setHighQuality()})}handleSceneRendered=()=>{to.emit(oc.SCENE_RENDERED,{sceneName:this.scene.key}),this.events.once(fr.RENDER,()=>{to.emit(oc.SCENE_LAUNCHED,{sceneName:this.scene.key})})};scaleGame(){let e=this.getCamera("main"),i=I.getZoomRatio();e.setZoom(i),e.startFollow(this.gameZone)}createGameZone(){let{width:e,height:i}=I.getWorldSize();this.gameZone=new Oh(this,e,i)}getCamera(e){return e==="main"?this.cameras.main:this.cameras.getCamera(e)}createMask(e=1){this.getCamera("main").setBackgroundColor(`rgba(0, 0, 0, ${e})`)}fontSize(e){return e/1}createBackground(e,i,s,r){this.background?(this.background.setTexture(e),i&&this.background.setFrame(i)):this.background=this.make.image({key:e,frame:i}),this.background.setName(e);let{width:n,height:a}=this.gameZone;this.background.setWorldSize(n,a),hc.isNumber(s)&&this.background.setAlpha(s),hc.isNumber(r)&&this.background.setTint(r),Av.Align.In.Center(this.background,this.gameZone)}},Ns=xv;var Jge={FIELD_BACKGROUND:0,BACKGROUND:1,FIREWORKS:5,FIELD_SQUARE:10,FIELD_SQUARE_RECT:11,MANAGER_BASE_DEPTH:20,ENCOURAGING:31,MESSAGE:33,POPUP:40,DEPTH_ON_DRAG:70,UNIT_HP_BAR:71,DMG_POPUP_NUMBER:80,BUTTON:90,ITEM:91,EFFECT:95,PRIORITY:100,TUTORIAL_OBJECT:101,DEBUG:110,ON_TOP:1e4},B=Jge;var{Utils:{Device:Qge}}=Ludex,li=Math.ceil(Math.min(Qge.pixelRatio(),2)),eSe={DEFAULT_8_BIT:{KEY:"default-8bit-resources",PATH:`./assets/textures/${li}x/`,JSON:`./assets/textures/${li}x/default-8bit-resources.json`,FRAME:{BLANK:"blank",CHALLENGE_BACK_EFFECT:"challenge-screen/back-effect",CHALLENGE_FX:"challenge-screen/fx",CHALLENGE_GLOW:"challenge-screen/glow",CHALLENGE_GRADE_BLUE:"challenge-screen/grade-blue",CHALLENGE_GRADE_RED:"challenge-screen/grade-red",CHALLENGE_ICON_ENERGY:"challenge-screen/icon-energy",CHALLENGE_SHAPE:"challenge-screen/shape",CHALLENGE_VS:"challenge-screen/vs",RESULT_SCREEN_FX_WIN:"result-screen/win-fx",RESULT_SCREEN_FX_LOSE:"result-screen/lose-fx",RESULT_SCREEN_GOLD_ICON:"result-screen/golds",RESULT_SCREEN_GREEN_BUTTON:"result-screen/green-button",RESULT_SCREEN_SINGLE_COIN_ICON:"result-screen/mini-gold",RESULT_SCREEN_LEVEL_COMPLETE_TEXT:"result-screen/level-complete",RESULT_SCREEN_CONTINUE_TEXT:"result-screen/continue",RESULT_SCREEN_WIN_TEXT:"result-screen/victory",RESULT_SCREEN_CLAIM_TEXT:"result-screen/claim",RESULT_SCREEN_EARN_TEXT:"result-screen/you-earned",RESULT_SCREEN_RIBBON_WIN:"result-screen/ribbon-green",RESULT_SCREEN_RIBBON_LOSE:"result-screen/ribbon-red",RESULT_SCREEN_YELLOW_BUTTON:"result-screen/yellow-button",RESULT_SCREEN_GREEN_BUTTON_RESULT:"result-screen/green-button-result",UNIT_UNLOCK_GLOW:"unit-unlock/glow",UNIT_UNLOCK_BG:"unit-unlock/bg",UNIT_UNLOCK_BG_1:"unit-unlock/bg-1",UNIT_UNLOCK_FRAME:"unit-unlock/frame",UNIT_UNLOCK_ICON_BATTLE:"unit-unlock/icon-battle",UNIT_UNLOCK_ICON_HEART:"unit-unlock/icon-heart",UNIT_UNLOCK_ROTATE:"unit-unlock/rotate",UNIT_REWARD_ELLIPSE_FX:"unit-reward/ellipse-fx",UNIT_REWARD_FX:"unit-reward/fx",UNIT_REWARD_GLOW:"unit-reward/glow",UNIT_REWARD_GIFT:"unit-reward/gift",UNIT_REWARD_GIFT_GLOW:"unit-reward/gift-glow",UNIT_REWARD_NO_THANKS_TEXT:"unit-reward/no-thanks-text",UNIT_REWARD_GIFT_AD:"unit-reward/gift-ad",UNIT_REWARD_PARTICLE:"unit-reward/particle",TEXT_LOADING:"loading",PRELOADER:"preloader/dual-ring",LEADERBOARD_BG_DARK:"leaderboards/bg-dark",LEADERBOARD_BG_LIGHT:"leaderboards/bg-light",LEADERBOARD_BG_LOSE:"leaderboards/bg-lose",LEADERBOARD_BG_WIN:"leaderboards/bg-win",LEADERBOARD_TAB_BG:"leaderboards/tab-bg",LEADERBOARD_TAB_LINE:"leaderboards/tab-focus",LEADERBOARD_AVATAR:"leaderboards/avatar",LEADERBOARD_RANK_GOLD:"leaderboards/rank-gold",LEADERBOARD_RANK_SILVER:"leaderboards/rank-silver",LEADERBOARD_RANK_COPPER:"leaderboards/rank-copper",LEADERBOARD_BUTTON_GREEN:"leaderboards/green-button",RIBBON_GREEN:"ribbon/green",ICON_AD:"icons/ad-icon",ICON_VIBRATION:"icons/vib",ICON_MUSIC:"icons/music",ICON_SOUND:"icons/sound",ICON_SHARE:"icons/share",ICON_BATTLE:"icons/battle",ICON_TITLE:"icons/title",ICON_ALERT:"icons/alert",ICON_BACK_TO:"icons/back-to",ICON_REPLAY:"icons/replay",ICON_QUICK_FIGHT:"icons/quick-fight",BUTTON_CLOSE:"buttons/close",BUTTON_GREEN:"buttons/green",BUTTON_GREEN_LONG:"buttons/green-long",BUTTON_RED:"buttons/red",OFFLINE_REWARD_ADS:"offline-reward/ads",OFFLINE_REWARD_CLOSE_BTN:"offline-reward/close-btn",OFFLINE_REWARD_GOLD:"offline-reward/gold",OFFLINE_REWARD_GOLDS:"offline-reward/golds",OFFLINE_REWARD_GREEN_BTN:"offline-reward/green-btn",OFFLINE_REWARD_PARTICLE_1:"offline-reward/particle-1",OFFLINE_REWARD_PARTICLE_2:"offline-reward/particle-2",OFFLINE_REWARD_RIBBON:"offline-reward/ribbon",OFFLINE_REWARD_TICKET:"offline-reward/ticket",OFFLINE_REWARD_YELLOW_BTN:"offline-reward/yellow-btn",UNIT_SCREEN_AD_BUTTON:"unit-screen/ad-button",UNIT_SCREEN_AD_COUNT_BG:"unit-screen/ad-count-bg",UNIT_SCREEN_AD_ICON:"unit-screen/ad-icon",UNIT_SCREEN_BAR:"unit-screen/bar",UNIT_SCREEN_BG:"unit-screen/bg",UNIT_SCREEN_COIN_ICON:"unit-screen/coin-icon",UNIT_SCREEN_FRAME_1:"unit-screen/frame-1",UNIT_SCREEN_FRAME_LOCKED:"unit-screen/frame-locked",UNIT_SCREEN_ICON_BATTLE:"unit-screen/icon-battle",UNIT_SCREEN_ICON_HEART:"unit-screen/icon-heart",UNIT_SCREEN_ICON_LOCK:"unit-screen/icon-lock",UNIT_SCREEN_SLIDEBAR_BG:"unit-screen/slidebar-bg",UNIT_SCREEN_TAB_BG:"unit-screen/tab-bg",UNIT_SCREEN_TAB_FOCUS:"unit-screen/tab-focus",WHEEL_ARROW:"reward-wheel/arrow",WHEEL_LUCKY_SPIN:"reward-wheel/lucky-spin"}},DEFAULT:{KEY:"default-resources",TEXTURE:`./assets/textures/${li}x/default-resources.png`,JSON:`./assets/textures/${li}x/default-resources.json`,FRAME:{BLANK:"blank",RIBBON_BLUE:"ribbon/blue",PROGRESS_BAR_MID:"progress/bar-mid",PROGRESS_BG_LEFT:"progress/bg-left",PROGRESS_BG_MID:"progress/bg-mid",PROGRESS_BG_RIGHT:"progress/bg-right",PROGRESS_BAR_LEFT:"progress/bar-left",PROGRESS_BAR_RIGHT:"progress/bar-right",SETTINGS_SWITCH_ON:"settings/switch-on",SETTINGS_SWITCH_OFF:"settings/switch-off",TITLE_LINE:"settings/title-line",DASHBOARD_UNITBAR_BOTTOM_BG:"dashboard/unitbar-bottom-bg"}},EFFECTS:{KEY:"effects-resources",PATH:`./assets/textures/${li}x/`,JSON:`./assets/textures/${li}x/effects-resources.json`,FRAME:{BLANK:"blank",FX_COMET:"comet",FX_SPARK:"spark",FX_CIRCLE:"circle",FX_CIRCLE_LIGHT:"circle-light",FX_GLOW_LIGHT:"glow-light",FX_GLOW_SMALL:"glow-small",FX_STAR_WHITE:"star-white",FX_STAR_YELLOW:"star-yellow",FX_WHITE_GLOW:"white-glow",FX_CONFETTI_SMALL_1:"confetti/small-1",FX_CONFETTI_SMALL_2:"confetti/small-2",FX_CONFETTI_SMALL_3:"confetti/small-3",FX_CONFETTI_SMALL_4:"confetti/small-4",FX_CONFETTI_HEXAGON:"confetti/hexagon-",FX_FIREWORKS_SMALL:"fireworks/small",FX_FIREWORKS_BIG_0:"fireworks/big-explosive-0",FX_FIREWORKS_BIG_1:"fireworks/big-explosive-1",FX_FIREWORKS_SOAR_LINE:"fireworks/soar-line",FX_FIREWORKS_SOAR_CIRCLE:"fireworks/soar-circle",ANIMATION_STAR_X:"star-x/star-",ANIMATION_STAR_Y:"star-y/star-",PREFIX_ANIMATION_RIBBON_CONFETTI_A:"ribbon/falling-confetti/confetti-a/confetti-a-",PREFIX_ANIMATION_RIBBON_CONFETTI_B:"ribbon/falling-confetti/confetti-b/confetti-b-",PREFIX_ANIMATION_RIBBON_CONFETTI_C:"ribbon/falling-confetti/confetti-c/confetti-c-",PREFIX_ANIMATION_RIBBON_CONFETTI_D:"ribbon/falling-confetti/confetti-d/confetti-d-"}},ANIMATION_SCENE:{KEY:"effects-resources",PATH:`./assets/textures/${li}x/`,JSON:`./assets/textures/${li}x/animation-scene-resources.json`,FRAME:{BLANK:"blank",COIN:"coins/coin",COIN_SMALL:"coins/coin-small",COIN_SMALL_GREY:"coins/coin-small-grey",ANIMATION_STAR_X:"star-x/star-",ANIMATION_STAR_Y:"star-y/star-",FX_SPARK_YELLOW:"yellow-spark",FX_CONFETTI_RIBBON:"ribbon/ribbon",PREFIX_ANIMATION_RIBBON_CONFETTI_A:"ribbon/falling-confetti/confetti-a/confetti-a-",PREFIX_ANIMATION_RIBBON_CONFETTI_B:"ribbon/falling-confetti/confetti-b/confetti-b-",PREFIX_ANIMATION_RIBBON_CONFETTI_C:"ribbon/falling-confetti/confetti-c/confetti-c-",PREFIX_ANIMATION_RIBBON_CONFETTI_D:"ribbon/falling-confetti/confetti-d/confetti-d-"}},GAMEPLAY:{KEY:"gameplay-resources",TEXTURE:`./assets/textures/${li}x/gameplay-resources.png`,JSON:`./assets/textures/${li}x/gameplay-resources.json`,FRAME:{BLANK:"blank",GUIDE_HAND:"hand-guide/hand",GUIDE_ARROW_START:"hand-guide/arrow-start",GUIDE_ARROW_END:"hand-guide/arrow-end",GUIDE_ARROW_MIDDLE:"hand-guide/arrow-middle",HP_BAR_BG:"hp-bar/bg",TOOL_RESET:"dev-tool/reset",TOOL_EDIT:"dev-tool/edit",TOOL_ATTACK:"dev-tool/attack",TOOL_UNIT:"dev-tool/unit",ROCK:"projectiles/rock",JAVELIN:"projectiles/javelin",BOOMERANG:"projectiles/boomerang",MACE:"projectiles/mace",ARROW_1:"projectiles/arrow-1",ARROW_2:"projectiles/arrow-2",BOLT_1:"projectiles/bolt-1",BOLT_2:"projectiles/bolt-2",FIRE_RING:"projectiles/fire-ring",BLUE_FIRE:"projectiles/blue-fire",GREEN_FIRE:"projectiles/level11/green-fire-1",GREEN_FIRE_PREFIX:"projectiles/level11/green-fire-",DASHBOARD_AD_ICON:"dashboard/ad-icon",DASHBOARD_FREE_GOLD:"dashboard/btn-free-gold",DASHBOARD_FREE_GOLD_OFF:"dashboard/btn-free-gold-off",DASHBOARD_FREE_GOLD_GLOW:"dashboard/btn-free-gold-glow",DASHBOARD_COINBAR_COIN:"dashboard/coin-bar-coin",DASHBOARD_COINBAR_BG:"dashboard/coin-bar-bg",DASHBOARD_MINI_COIN:"dashboard/coin-mini",DASHBOARD_UNIT_LIST:"dashboard/btn-unit-list",DASHBOARD_UNITBAR_BG:"dashboard/unitbar-bg",DASHBOARD_UNITBAR_STAMPS:"dashboard/unitbar-stamps",DASHBOARD_UNITBAR_ARCHER:"dashboard/unitbar-archer",DASHBOARD_UNITBAR_DINO:"dashboard/unitbar-dino",DASHBOARD_START_BTN:"dashboard/btn-start",DASHBOARD_SETTINGS_BTN:"dashboard/btn-settings",DASHBOARD_LEADERBOARD_BTN:"dashboard/btn-leaderboard",DASHBOARD_BATTLE_BTN:"dashboard/btn-battle",DASHBOARD_SPEED_BTN_OFF:"dashboard/btn-speed-off",DASHBOARD_SPEED_BTN_ON:"dashboard/btn-speed-on",DASHBOARD_HPBAR_BG:"dashboard/bar/bg",DASHBOARD_HPBAR_FRONT:"dashboard/bar/bg-front",DASHBOARD_HPBAR_RED_LEFT:"dashboard/bar/red-bar/bar-left",DASHBOARD_HPBAR_RED_RIGHT:"dashboard/bar/red-bar/bar-right",DASHBOARD_HPBAR_RED_MID:"dashboard/bar/red-bar/bar-mid",DASHBOARD_HPBAR_RED:"dashboard/bar/red-bar/full-bar",DASHBOARD_HPBAR_RED_HEART:"dashboard/bar/red-bar/icon-heart-red",DASHBOARD_HPBAR_BLUE_LEFT:"dashboard/bar/blue-bar/bar-left",DASHBOARD_HPBAR_BLUE_RIGHT:"dashboard/bar/blue-bar/bar-right",DASHBOARD_HPBAR_BLUE_MID:"dashboard/bar/blue-bar/bar-mid",DASHBOARD_HPBAR_BLUE:"dashboard/bar/blue-bar/full-bar",DASHBOARD_HPBAR_BLUE_HEART:"dashboard/bar/blue-bar/icon-heart-blue",DASHBOARD_BATTLE_BUTTON_GREEN:"dashboard/btn-battle-green",DASHBOARD_BATTLE_ICON:"dashboard/icon-battle",DASHBOARD_MESSAGE_ICON:"dashboard/icon-message",DASHBOARD_AVATAR_FRAME_BLUE:"dashboard/avatar-frame-blue",DASHBOARD_AVATAR_FRAME_RED:"dashboard/avatar-frame-red",DASHBOARD_VS:"dashboard/vs",DASHBOARD_UNITBAR_BG_LANDSCAPE:"dashboard/unitbar-bg-landscape",DASHBOARD_AD_ICON_LANDSCAPE:"dashboard/ad-icon-landscape",DASHBOARD_START_BTN_LANDSCAPE:"dashboard/btn-start-landscape",DASHBOARD_BOSS_BTN:"dashboard/btn-boss-on",DASHBOARD_BOSS_BTN_OFF:"dashboard/btn-boss-off",PURPLE_EFFECT:"effect-text/purple-effect",EFFECT_WIN_GLOW:"effect-text/win/glow",EFFECT_WIN_SHAPE_ABOVE:"effect-text/win/shape-above",EFFECT_WIN_SHAPE_BELOW:"effect-text/win/shape-below",EFFECT_LOSE_GLOW:"effect-text/lose/glow",EFFECT_LOSE_SHAPE_ABOVE:"effect-text/lose/shape-above",EFFECT_LOSE_SHAPE_BELOW:"effect-text/lose/shape-below"}},UNITS:{KEY:"units-resources",PATH:`./assets/textures/${li}x/`,JSON:`./assets/textures/${li}x/units-resources.json`,FRAME:{DINO_MALE_DOUX_PREFIX:"dino/male/doux/doux-",DINO_MALE_KIRA_PREFIX:"dino/male/kira/kira-",DINO_MALE_LOKI_PREFIX:"dino/male/loki/loki-",DINO_MALE_MORT_PREFIX:"dino/male/mort/mort-",DINO_MALE_NICO_PREFIX:"dino/male/nico/nico-",DINO_MALE_OLAF_PREFIX:"dino/male/olaf/olaf-",DINO_MALE_TARD_PREFIX:"dino/male/tard/tard-",DINO_MALE_VITA_PREFIX:"dino/male/vita/vita-",DINO_FEMALE_DOUX_PREFIX:"dino/female/doux/doux-",DINO_FEMALE_KIRA_PREFIX:"dino/female/kira/kira-",DINO_FEMALE_LOKI_PREFIX:"dino/female/loki/loki-",DINO_FEMALE_MORT_PREFIX:"dino/female/mort/mort-",DINO_FEMALE_NICO_PREFIX:"dino/female/nico/nico-",DINO_FEMALE_OLAF_PREFIX:"dino/female/olaf/olaf-",DINO_FEMALE_TARD_PREFIX:"dino/female/tard/tard-",DINO_FEMALE_VITA_PREFIX:"dino/female/vita/vita-",LOCKED:{MELEE:{1:"dino-locked/lv01-velociraptor",2:"dino-locked/lv02-saurolophus",3:"dino-locked/lv03-pachysaurus",4:"dino-locked/lv04-triceratops",5:"dino-locked/lv05-stegosaurus",6:"dino-locked/lv06-ankylosaurus",7:"dino-locked/lv07-baroptiloraptor",8:"dino-locked/lv08-tyrannosaurus",9:"dino-locked/lv09-dilophosaurus",10:"dino-locked/lv10-triceradonosaurus",11:"dino-locked/lv11-spinosaurus-rex"},RANGED:{1:"warriors-locked/lv01-rockthrower",2:"warriors-locked/lv02-javelineer",3:"warriors-locked/lv03-boomeranger",4:"warriors-locked/lv04-macer",5:"warriors-locked/lv05-artemis",6:"warriors-locked/lv06-william",7:"warriors-locked/lv07-blanchette",8:"warriors-locked/lv08-phantom",9:"warriors-locked/lv09-oracle",10:"warriors-locked/lv10-shaman",11:"warriors-locked/lv11-seraph"}},UNLOCKED:{MELEE:{1:"dino-unlocked/lv01-velociraptor",2:"dino-unlocked/lv02-saurolophus",3:"dino-unlocked/lv03-pachysaurus",4:"dino-unlocked/lv04-triceratops",5:"dino-unlocked/lv05-stegosaurus",6:"dino-unlocked/lv06-ankylosaurus",7:"dino-unlocked/lv07-baroptiloraptor",8:"dino-unlocked/lv08-tyrannosaurus",9:"dino-unlocked/lv09-dilophosaurus",10:"dino-unlocked/lv10-triceradonosaurus",11:"dino-unlocked/lv11-spinosaurus-rex"},RANGED:{1:"warriors-unlocked/lv01-rockthrower",2:"warriors-unlocked/lv02-javelineer",3:"warriors-unlocked/lv03-boomeranger",4:"warriors-unlocked/lv04-macer",5:"warriors-unlocked/lv05-artemis",6:"warriors-unlocked/lv06-william",7:"warriors-unlocked/lv07-blanchette",8:"warriors-unlocked/lv08-phantom",9:"warriors-unlocked/lv09-oracle",10:"warriors-unlocked/lv10-shaman",11:"warriors-unlocked/lv11-seraph"}}}},UNITS_SPRITES:{KEY:"units-sprite-resources",PATH:`./assets/textures/${li}x/`,JSON:`./assets/textures/${li}x/units-sprite-resources.json`,FRAME:{MELEE:{1:{MAIN_TEXTURE:"melee-1/idle/idle-00",ATTACK_PREFIX:"melee-1/attack/attack-",DIE_PREFIX:"melee-1/die/die-",IDLE_PREFIX:"melee-1/idle/idle-",RUN_PREFIX:"melee-1/run/run-"}},RANGED:{1:{MAIN_TEXTURE:"ranged-1/idle/idle-00",ATTACK_PREFIX:"ranged-1/attack/attack-",DIE_PREFIX:"ranged-1/die/die-",IDLE_PREFIX:"ranged-1/idle/idle-"}}}},UNITS_SPINES:{MELEE:{1:{KEY:"velociraptor-spine",jsonPATH:"./assets/spines/units/melee-1/velociraptor.json",atlasPATH:"./assets/spines/units/melee-1/velociraptor.atlas"},2:{KEY:"saurolophus-spine",jsonPATH:"./assets/spines/units/melee-2/saurolophus.json",atlasPATH:"./assets/spines/units/melee-2/saurolophus.atlas"},3:{KEY:"pachysaurus-spine",jsonPATH:"./assets/spines/units/melee-3/pachysaurus.json",atlasPATH:"./assets/spines/units/melee-3/pachysaurus.atlas"},4:{KEY:"triceratops-spine",jsonPATH:"./assets/spines/units/melee-4/triceratops.json",atlasPATH:"./assets/spines/units/melee-4/triceratops.atlas"},5:{KEY:"stegosaurus-spine",jsonPATH:"./assets/spines/units/melee-5/stegosaurus.json",atlasPATH:"./assets/spines/units/melee-5/stegosaurus.atlas"},6:{KEY:"ankyntrosaurus-spine",jsonPATH:"./assets/spines/units/melee-6/ankyntrosaurus.json",atlasPATH:"./assets/spines/units/melee-6/ankyntrosaurus.atlas"},7:{KEY:"baroptiloraptor-spine",jsonPATH:"./assets/spines/units/melee-7/baroptiloraptor.json",atlasPATH:"./assets/spines/units/melee-7/baroptiloraptor.atlas"},8:{KEY:"tyrannosaurus-spine",jsonPATH:"./assets/spines/units/melee-8/tyrannosaurus.json",atlasPATH:"./assets/spines/units/melee-8/tyrannosaurus.atlas"},9:{KEY:"dilophosaurus-spine",jsonPATH:"./assets/spines/units/melee-9/dilophosaurus.json",atlasPATH:"./assets/spines/units/melee-9/dilophosaurus.atlas"},10:{KEY:"triceradonosaurus-spine",jsonPATH:"./assets/spines/units/melee-10/triceradonosaurus.json",atlasPATH:"./assets/spines/units/melee-10/triceradonosaurus.atlas"},11:{KEY:"spinosaurus-rex-spine",jsonPATH:"./assets/spines/units/melee-11/spinosaurus-rex.json",atlasPATH:"./assets/spines/units/melee-11/spinosaurus-rex.atlas"}},RANGED:{1:{KEY:"rockthrower-spine",jsonPATH:"./assets/spines/units/ranged-1/rockthrower.json",atlasPATH:"./assets/spines/units/ranged-1/rockthrower.atlas"},2:{KEY:"javelineer-spine",jsonPATH:"./assets/spines/units/ranged-2/javelineer.json",atlasPATH:"./assets/spines/units/ranged-2/javelineer.atlas"},3:{KEY:"boomeranger-spine",jsonPATH:"./assets/spines/units/ranged-3/boomeranger.json",atlasPATH:"./assets/spines/units/ranged-3/boomeranger.atlas"},4:{KEY:"macer-spine",jsonPATH:"./assets/spines/units/ranged-4/macer.json",atlasPATH:"./assets/spines/units/ranged-4/macer.atlas"},5:{KEY:"artemis-spine",jsonPATH:"./assets/spines/units/ranged-5/artemis.json",atlasPATH:"./assets/spines/units/ranged-5/artemis.atlas"},6:{KEY:"william-spine",jsonPATH:"./assets/spines/units/ranged-6/william.json",atlasPATH:"./assets/spines/units/ranged-6/william.atlas"},7:{KEY:"blanchette-spine",jsonPATH:"./assets/spines/units/ranged-7/blanchette.json",atlasPATH:"./assets/spines/units/ranged-7/blanchette.atlas"},8:{KEY:"phantom-spine",jsonPATH:"./assets/spines/units/ranged-8/phantom.json",atlasPATH:"./assets/spines/units/ranged-8/phantom.atlas"},9:{KEY:"oracle-spine",jsonPATH:"./assets/spines/units/ranged-9/oracle.json",atlasPATH:"./assets/spines/units/ranged-9/oracle.atlas"},10:{KEY:"shaman-spine",jsonPATH:"./assets/spines/units/ranged-10/shaman.json",atlasPATH:"./assets/spines/units/ranged-10/shaman.atlas"},11:{KEY:"seraph-spine",jsonPATH:"./assets/spines/units/ranged-11/seraph.json",atlasPATH:"./assets/spines/units/ranged-11/seraph.atlas"}}},SPINE_EFFECTS:{FX_MERGE:{KEY:"fx-merge-spine",jsonPATH:"./assets/spines/effects/merge/fx_merge.json",atlasPATH:"./assets/spines/effects/merge/fx_merge.atlas"}}},T=eSe;var GH="Lilita One",qH={tr:"Baloo 2",ja:"M PLUS 1p",en:"Lilita One"},WH={tr:"Baloo 2",ja:"M PLUS 1p",en:"Lilita One"};var tSe={en:"assets/json/language/en.json",ru:"assets/json/language/ru.json",ja:"assets/json/language/ja.json",zh:"assets/json/language/zh.json",pt:"assets/json/language/pt.json",es:"assets/json/language/es.json",tr:"assets/json/language/tr.json",fr:"assets/json/language/fr.json",id:"assets/json/language/id.json",de:"assets/json/language/de.json",it:"assets/json/language/it.json"},Cv=tSe;var qz=E(Gv()),{Utils:{Array:qv,Function:hEe}}=Ludex,{language:pr}=codex,Wz=Object.keys(Cv),ps="en";function lEe(t){return t.reduce((e,i)=>(i.status==="fulfilled"?e.successes.push(i.value):e.failures.push(i.reason),e),{successes:[],failures:[]})}function Gz(t){return qv.search(Wz,e=>e===t)!==void 0}var kh=class extends Error{locales;constructor(...e){super(`Failed to load languages: ${e.join(", ")}`),this.name="LanguageLoadingError",this.locales=e}},Hi=class t{static inst;constructor(){}static get instance(){return this.inst||(this.inst=new t),this.inst}async loadAllLanguages(e){let i=await this.loadLanguages(e,Wz),{successes:s,failures:r}=i;for(let{locale:n,data:a}of s)pr.add(n,a);if(r.length>0){let n=r.flatMap(a=>a.locales);throw new kh(...n)}}async loadPlayerLanguage(e){let i=pr.getPlayerLanguage();if(!Gz(i)||i===ps){let{successes:h,failures:l}=await this.loadLanguages(e,[ps]);if(l.length>0)throw l[0];let{data:c}=h[0];pr.add(ps,c,!0),pr.choose(ps);return}let{successes:n}=await this.loadLanguages(e,[ps,i]),a=qv.search(n,h=>h.locale===ps),o=qv.search(n,h=>h.locale===i);if(!a)throw new kh(ps);pr.add(ps,a.data,!0),pr.choose(ps),o&&(pr.add(i,o.data),pr.choose(i))}async loadLanguages(e,i){let s=i.map(n=>this.queueLanguage(e,n));e.load.start();let r=await hEe.allSettled(s);return lEe(r)}queueLanguage(e,i){let s=e.cache.json.get(i);return s?Promise.resolve({locale:i,data:s}):new Promise((r,n)=>{let a=(p,m,v)=>{d(v)},o=p=>{p instanceof qz.FileTypes.JSONFile&&p.key===i&&f(new kh(i))},h=()=>{e.load.json(i,Cv[i])},l=()=>{e.load.once(`filecomplete-json-${i}`,a),e.load.on("loaderror",o)},c=()=>{e.load.off(`filecomplete-json-${i}`,a),e.load.off("loaderror",o)},d=p=>{c(),r({locale:i,data:p})},f=p=>{c(),n(p)};l(),h()})}getPlayerLocale(){let e=pr.getPlayerLanguage();return!Gz(e)||e===ps?ps:e}};var uEe=1,Hn=18,mc={CLIP:"clip",ELLIPSIS:"ellipsis"},Gh=class t{static getLocaleFont(e){return qH[e]??GH}static getGoogleFontFamilies(e){return[WH[e]??'"Lilita One"']}static getModSize(e,i=uEe){return e*i}static createText(e,i,s=Hn){let r=Hi.instance.getPlayerLocale(),n=this.getLocaleFont(r);return e.make.text({text:i,padding:{left:2,right:2,top:1,bottom:1},origin:{x:.5,y:.5},style:{fontSize:`${s}px`,fontStyle:"500",fontFamily:n}})}static buildText(e,i=Hn){return new Wv(e,i)}static createStrokeText(e,i,s=Hn){return this.createText(e,i,s).setStroke("#000000",2)}static createUnderlineText(e,i,s=Hn){if(!i)return this.createText(e,"",s);let r=this.createText(e,"_",s),n=this.getUnderscoreWidth(r),a=this.getTextWidthForUnderscore(r,i),o=Math.ceil(a/n),l=-(s*.9);return r.setLineSpacing(l),r.setText(`${i}
${"_".repeat(o)}`),r}static getUnderscoreWidth(e){e.setText("_".repeat(5));let{left:s=0,right:r=0}=e.padding;return(e.getBounds().width-s-r)/5}static getTextWidthForUnderscore(e,i){e.setText(i);let{left:s=0,right:r=0}=e.padding;return e.getBounds().width-s-r}static applyShadow(e,i="#000000",s=0,r=3,n=.5){return e.setShadow(s,r,i,n)}static calcStrokeWidth(e,i=1){let{fontSize:s}=e.style,r=Hn;return typeof s=="string"&&(r=+s.replace("px","")),r*.2*i}static calcStrokeWidthSimple(e,i=1){return e*.2*i}static setTruncateOverflow(e,i,s=mc.ELLIPSIS){return e.setWordWrapWidth(i).setWordWrapCallback(t.applyTruncate(s))}static applyTruncate=(e=mc.ELLIPSIS)=>(i,s)=>{let{wordWrapWidth:r}=s.style,n=r??0,a=s.context,o=e===mc.CLIP?"":"...";if(a.measureText(i).width<=n)return i;let h=i;for(;a.measureText(`${h}${o}`).width>n;)h=h.slice(0,-1);return`${h}${o}`}},Wv=class{config;postCreateActions=[];constructor(e,i=Hn){let s=Hi.instance.getPlayerLocale(),r=Gh.getLocaleFont(s);this.config={text:e,padding:{left:2,right:2,top:1,bottom:1},origin:{x:.5,y:.5},style:{fontSize:`${i}px`,fontStyle:"500",fontFamily:r}}}build(e){let i=e.make.text(this.config);for(let s of this.postCreateActions)s(i);return this.postCreateActions=[],i}getConfig(){return this.config}addPostCreateAction(e){return this.postCreateActions.push(e),this}setDefaultStroke(){return this.setStrokeColor("#000000"),this.setStrokeThickness(2),this}setFloatCoinStroke(){return this.setStrokeColor("#000000"),this.setStrokeThickness(1),this}setDefaultShadow(e={}){let i=this.getConfig();return this.setShadow({...i.style?.shadow,offsetX:0,offsetY:0,fill:!0,stroke:!0,color:"#000000",blur:0,...e}),this}applyScreenHeaderStyle(){this.setDefaultStroke();let e=this.getConfig();return this.setShadow({...e.style?.shadow,offsetX:-4,offsetY:4,fill:!0,stroke:!0}),this.setFixedWidth(13*25),this.setAlign("center"),this.setHighQuality(),this}setText(e){return this.config={...this.config,text:e},this}setStyle(e){return this.config={...this.config,style:e},this}setFont(e){return this.config={...this.config,style:{...this.config.style,font:e}},this}setFontFamily(e){return this.config={...this.config,style:{...this.config.style,fontFamily:e}},this}setFontSize(e){return this.config={...this.config,style:{...this.config.style,fontSize:e}},this}setFontStyle(e){return this.config={...this.config,style:{...this.config.style,fontStyle:e}},this}setFixedWidth(e){return this.config={...this.config,style:{...this.config.style,fixedWidth:e}},this}setFixedHeight(e){return this.config={...this.config,style:{...this.config.style,fixedHeight:e}},this}setBackgroundColor(e){return this.config={...this.config,style:{...this.config.style,backgroundColor:e}},this}setColor(e){return this.config={...this.config,style:{...this.config.style,color:e}},this}setStrokeColor(e){return this.config={...this.config,style:{...this.config.style,stroke:e}},this}setStrokeThickness(e){return this.config={...this.config,style:{...this.config.style,strokeThickness:e}},this}setShadow(e){return this.config={...this.config,style:{...this.config.style,shadow:e}},this}setWordWrap(e){return this.config={...this.config,style:{...this.config.style,wordWrap:e}},this}setTruncateOverflow(e,i=mc.ELLIPSIS){return this.config={...this.config,style:{...this.config.style,wordWrap:{...this.config.style?.wordWrap,width:e,callback:Gh.applyTruncate(i)}}},this}setAlign(e){return this.config={...this.config,style:{...this.config.style,align:e}},this}setResolution(e){return this.config={...this.config,style:{...this.config.style,resolution:e}},this}setHighQuality(){return this.setResolution(qr.DesignSize.Resolution)}setLineSpacing(e){return this.config={...this.config,style:{...this.config.style,lineSpacing:e}},this}setLetterSpacing(e){return this.config={...this.config,style:{...this.config.style,letterSpacing:e}},this}setPadding(e){return this.config={...this.config,padding:e},this}setMaxLines(e){return this.config={...this.config,style:{...this.config.style,maxLines:e}},this}setRTL(e){return this.config={...this.config,style:{...this.config.style,rtl:e}},this}setAlpha(e){return this.config={...this.config,alpha:e},this}setDepth(e){return this.config={...this.config,depth:e},this}setFlipX(e){return this.config={...this.config,flipX:e},this}setFlipY(e){return this.config={...this.config,flipY:e},this}setOrigin(e){return this.config={...this.config,origin:e},this}setScrollFactor(e){return this.config={...this.config,scrollFactor:e},this}setRotation(e){return this.config={...this.config,rotation:e},this}setAngle(e){return this.config={...this.config,angle:e},this}setScale(e){return this.config={...this.config,scale:e},this}setX(e){return this.config={...this.config,x:e},this}setY(e){return this.config={...this.config,y:e},this}setVisible(e){return this.config={...this.config,visible:e},this}setTint(e,i,s,r){return this.addPostCreateAction(n=>n.setTint(e,i,s,r)),this}static calcStrokeWidth(e,i=1){let s=r=>r*.2*i;return s(typeof e=="number"?e:typeof e=="string"?parseFloat(e.replace("px","")):Hn)}},P=Gh;var Yz=E(ie()),Hz=E(X()),zz=E(nt()),Yv=E(qe()),{Utils:{Valid:cEe}}=Ludex,{KEY:dEe,FRAME:fEe}=T.DEFAULT,Hv=class extends Hz.Container{fps=0;fpsString="FPS: %1";fpsText;background;zone;lastUpdate;constructor(e){super(e,0,0),this.createFps(),this.createInputZone(),this.setDepth(B.DEBUG),this.scene.add.existing(this),cEe.isDebugger()?this.enable():this.disable()}update=e=>{if(e-this.lastUpdate<800)return;this.lastUpdate=e;let i=Math.floor(this.scene.game.loop.actualFps);this.setFps(i)};setFps(e){this.fps=e;let i=this.fpsString.replace("%1",e.toString());this.fpsText.setText(i)}createFps(){this.background=this.scene.make.image({key:dEe,frame:fEe.BLANK}),this.background.setTint(32768),this.background.setAlpha(.5),this.background.setWorldSize(50,20),this.fpsText=P.createText(this.scene,this.fpsString,10),this.fpsText.setName("FPS Meter"),Yz.Align.In.Center(this.fpsText,this.background,4),this.add([this.background,this.fpsText])}createInputZone(){let{width:e,height:i}=this.background;this.zone=this.scene.make.zone({width:e,height:i}),this.add(this.zone),this.zone.setInteractive({useHandCursor:!0}),this.zone.on(zz.GAMEOBJECT_POINTER_DOWN,this.handleShowFps)}handleShowFps=()=>{this.fpsText.visible?this.disable():this.enable()};disable(){this.fpsText.setVisible(!1),this.background.setVisible(!1),this.scene.events.off(Yv.UPDATE,this.update)}enable(){this.fpsText.setVisible(!0),this.background.setVisible(!0),this.scene.events.on(Yv.UPDATE,this.update)}},Vz=Hv;var{ads:pEe,event:vc}=codex,{Events:Xz}=Ludex,zv=class extends Ns{fpsMeter$;backgroundMaskManager$;init(){this.setGlobalSceneOnTop$(),this.backgroundMaskManager$=new dH,this.listenEvents$()}listenEvents$(){vc.on("hideFPS",this.hideFPS$),vc.on("showFPS",this.showFPS$),this.handlePauseAudio$()}handlePauseAudio$(){vc.on(Xz.VISIBILITY_HIDDEN,this.muteAudio),vc.on(Xz.VISIBILITY_VISIBLE,this.unmuteAudio)}muteAudio=()=>{console.log("mute audio"),q.muteAudio(!0),this.input.once(Zz.POINTER_DOWN,this.unmuteAudio)};unmuteAudio=async()=>{if(!pEe.isAdFullSizeShowing()&&(console.log("unmute audio"),q.muteAudio(!1),"context"in window.phaser.sound))try{await window.phaser.sound.context.suspend(),await window.phaser.sound.context.resume()}catch(e){console.error("can not resume audio",e)}};setup(){this.scene.isActive()&&(this.addFPS$(),this.setGlobalSceneOnTop$())}addFPS$(){this.fpsMeter$=new Vz(this),Kz.Align.In.TopLeft(this.fpsMeter$,this.gameZone,-20,-10)}hideFPS$=()=>{this.fpsMeter$?.kill()};showFPS$=()=>{this.fpsMeter$?.revive()};setGlobalSceneOnTop$(){this.scene.bringToTop(this)}requestBackgroundMaskUpdate(e,i){this.backgroundMaskManager$.requestBackgroundMaskUpdate(e,i)}recalculateBackgroundMask(){this.backgroundMaskManager$.updateBackgroundMask()}},jz=zv;var no=jz;var mEe={NORMAL:"NORMAL",BATTLE:"BATTLE",TUTORIAL:"TUTORIAL",BOSS:"BOSS"},ne=mEe;var vEe={StartLevel:1,StartCoins:6,DelayFinishGame:1700,HintWaitTime:5e3,Powers:{FreeCoins:{enable:!0,duration:12e4},SpeedUp:{enable:!0,modifier:2},BossChallenge:{enable:!0,duration:6e5}},MaxLevel:1598,MaxBossLevel:11,MaximumMeleeLevel:11,MaximumRangedLevel:11,CheaterIds:[],ChallengeFriends:{activePerLevel:2,maxActiveCount:1},Tutorial:{ForceUseTutorial:!1,NumberOfTutorial:{GuideOne:1,GuideTwo:1,GuidePrevent:-1,GuideThree:1}},Leaderboards:{Name:null,UseMock:!1,Prefix:"leaderboards",LeaderboardId:"62f5bc51b2198c615726a9a1",Limit:50,MockOptions:{PlayerEntryIndex:-1}}},le=vEe;var $z=E(X()),Jz=E(he()),{KEY:Vv,FRAME:Xv}=T.GAMEPLAY,Kv=class extends $z.Container{arrowStart;arrowEnd;arrowMiddle;expandTween;constructor(e){super(e),this.name="AdjustableArrow",this.addArrowStart(),this.addArrowEnd(),this.addArrowMiddle(),this.setDepth(B.EFFECT),this.scene.add.existing(this)}addArrowStart(){this.arrowStart=this.scene.make.image({key:Vv,frame:Xv.GUIDE_ARROW_START,origin:{x:0,y:.5}}),this.arrowStart.setWorldSize(20,26),this.add(this.arrowStart)}addArrowEnd(){this.arrowEnd=this.scene.make.image({key:Vv,frame:Xv.GUIDE_ARROW_END,origin:{x:1,y:.5}}),this.arrowEnd.setWorldSize(4,13),this.add(this.arrowEnd)}addArrowMiddle(){this.arrowMiddle=this.scene.make.image({key:Vv,frame:Xv.GUIDE_ARROW_MIDDLE,origin:{x:.5,y:.5}}),this.arrowMiddle.setWorldSize(1,13),this.add(this.arrowMiddle)}changeArrowLength(e){let i=e-this.arrowStart.width-this.arrowEnd.width;this.arrowMiddle.setWorldSize(i,this.arrowMiddle.height),this.arrowEnd.setPosition(-i/2,0),this.arrowStart.setPosition(i/2,0)}runArrowExpandTween(e,i,s){let r=s-this.arrowStart.width-this.arrowEnd.width;this.arrowEnd.setPosition(-r/2,0),this.arrowStart.setPosition(-r/2,0),this.arrowMiddle.setWorldSize(0,this.arrowMiddle.height),this.expandTween=this.scene.tweens.addCounter({from:0,to:100,duration:e,completeDelay:i,ease:Jz.Cubic.Out,onUpdate:n=>{let a=n.getValue(),o=r*a/100;this.arrowMiddle.setWorldSize(o,this.arrowMiddle.height);let h=-r/2+o/2;this.arrowMiddle.setPosition(h,0);let l=-r/2+o;this.arrowStart.setPosition(l,0)},onComplete:()=>{this.setAlpha(0)},onStop:()=>{this.setAlpha(0)}})}killExpandTween(){this.expandTween?.stop()}},Qz=Kv;var e5=E(X());var gc=E(he()),{KEY:gEe,FRAME:SEe}=T.GAMEPLAY,Zv=class extends e5.Container{hand;arrow;toGlobalX=0;toGlobalY=0;constructor(e){super(e),this.name="DragTutorialHand",this.addHand(),this.addArrow(),this.bringToTop(this.hand),this.scene.add.existing(this)}addHand(){this.hand=this.scene.make.image({key:gEe,frame:SEe.GUIDE_HAND,origin:{x:0,y:0}}),this.hand.setWorldSize(65.5,55.5),this.add(this.hand)}addArrow(){this.arrow=new Qz(this.scene),this.arrow.setAlpha(0)}setTarget(e,i){this.toGlobalX=e,this.toGlobalY=i}playAnimation(e=0,i=800){let s=1/I.getPixelRatio();this.hand.angle=0;let r=this.toGlobalX-this.x,n=this.toGlobalY-this.y,a=this.x+r/2,o=this.y+n/2,h=Math.sqrt(r*r+n*n)*.8;this.arrow.setPosition(a,o),this.arrow.rotation=Math.atan2(n,r),this.arrow.setAlpha(0),this.arrow.killExpandTween(),this.hand.setPosition(0,0),this.hand.setAlpha(1),this.scene?.tweens.add({delay:e,targets:this.arrow,ease:gc.Cubic.Out,onStart:()=>{this.arrow.runArrowExpandTween(1200,200,h)},props:{alpha:{start:0,value:.5,duration:200}}}),this.scene?.tweens.add({delay:e,targets:[this.hand],ease:gc.Cubic.Out,props:{alpha:{start:0,value:1,duration:200},x:{from:0,to:r,duration:1200},y:{from:0,to:n,duration:1200}},onComplete:()=>{this.scene?.tweens.add({targets:[this.hand],delay:200,duration:200,completeDelay:200,ease:gc.Cubic.Out,props:{alpha:0},onComplete:()=>{this.hand.x=0,this.hand.y=0,this.hand.scale=s,this.playAnimation(e,i)}})}})}stopAnimation(){this.scene.tweens.killTweensOf(this.hand),this.scene.tweens.killTweensOf(this.arrow)}kill(){this.arrow.kill(),super.kill()}revive(){this.arrow.revive(),super.revive()}destroy(e){this.arrow.destroy(e),super.destroy(e)}preDestroy(){this.scene.tweens.killTweensOf(this.hand),this.scene.tweens.killTweensOf(this.arrow)}},Sc=Zv;var EEe={STATUS:{READY:"ready",RUNNING:"running",STOPPED:"stopped"}},kt=EEe;var{STATUS:ao}=kt,xe=class{state$;scene;constructor(e){this.scene=e}init(){this.setState(ao.READY)}start(){this.isRunning()||this.setState(ao.RUNNING)}stop(){this.isRunning()&&this.setState(ao.STOPPED)}setState(e){this.state$=e}isReady(){return this.state$===ao.READY}isRunning(){return this.state$===ao.RUNNING}isStopped(){return this.state$===ao.STOPPED}};var mr=E(nt()),{HintWaitTime:TEe}=le,jv=class extends xe{scene;hand;autoTimeEvent;isDragging=!1;constructor(e){super(e),this.scene=e,this.createHand()}init(){super.init()}start(){this.isRunning()||(super.start(),this.listenEvent(),this.startAutoHint())}stop(){this.isRunning()&&(super.stop(),this.isDragging=!1,this.stopListenEvent(),this.stopAutoHint())}createHand(){this.hand=new Sc(this.scene),this.hand.kill(),this.hand.setDepth(B.PRIORITY)}startAutoHint(){this.autoTimeEvent=this.scene.time.delayedCall(TEe,this.handleAutomaticallyHint)}handleAutomaticallyHint=()=>{let{unitManager:e}=this.scene,i=e.getSameCoupleUnits();if(!i){this.startAutoHint();return}this.hand.stopAnimation(),this.hand.revive(),this.hand.setPosition(i.unit1.x,i.unit1.y),this.hand.setTarget(i.unit2.x,i.unit2.y),this.hand.playAnimation(500)};listenEvent(){this.scene.input.on(mr.POINTER_DOWN,this.handlePlayerInteract),this.scene.input.on(mr.DRAG_START,this.handlePlayerDragging),this.scene.input.on(mr.DRAG_END,this.handlePlayerEndDrag)}stopListenEvent(){this.scene.input.off(mr.POINTER_DOWN,this.handlePlayerInteract),this.scene.input.off(mr.DRAG_START,this.handlePlayerDragging),this.scene.input.off(mr.DRAG_END,this.handlePlayerEndDrag)}handlePlayerDragging=()=>{this.isDragging||(this.isDragging=!0,this.stopAutoHint())};handlePlayerEndDrag=()=>{this.isDragging=!1,this.startAutoHint()};handlePlayerInteract=()=>{this.stopAutoHint(),!this.isDragging&&this.startAutoHint()};stopAutoHint(){this.hand.kill(),this.hand.stopAnimation(),this.autoTimeEvent?.remove()}},t5=jv;var{KEY:zi,FRAME:Vi}=T.UNITS_SPRITES,{KEY:yEe,FRAME:bEe}=T.GAMEPLAY,ms={END:2,START:0,EVENT:5,DISPOSE:3,COMPLETE:4,INTERRUPT:1},F={MELEE:{RUN:"run",DIE:"die",IDLE:"idle",ATTACK:"attack",CUSTOM_EVENTS:{FINISHED_ATTACKING:"finished_attacking"}},RANGED:{DIE:"die",IDLE:"idle",ATTACK:"attack",ATTACK_ABOVE:"attack_above",ATTACK_BELOW:"attack_below",CUSTOM_EVENTS:{FINISHED_ATTACKING:"finished_attacking"}}},zn={GREEN_FIRE:{KEY:"confetti-hexagon-animation",TEXTURE:yEe,PREFIX:bEe.GREEN_FIRE_PREFIX,FRAME_RATE:30,START:1,END:3,ZERO_PAD:0}},Te={MELEE:{1:{ATTACK:{KEY:"velociraptor-attack",TEXTURE:zi,PREFIX:Vi.MELEE[1].ATTACK_PREFIX,FRAME_RATE:30,EVENT_FRAME:9,START:0,END:20,ZERO_PAD:2},DIE:{KEY:"velociraptor-die",TEXTURE:zi,PREFIX:Vi.MELEE[1].DIE_PREFIX,FRAME_RATE:20,START:0,END:19,ZERO_PAD:2},IDLE:{KEY:"velociraptor-idle",TEXTURE:zi,PREFIX:Vi.MELEE[1].IDLE_PREFIX,FRAME_RATE:30,START:0,END:39,ZERO_PAD:2},RUN:{KEY:"velociraptor-move",TEXTURE:zi,PREFIX:Vi.MELEE[1].RUN_PREFIX,FRAME_RATE:40,START:0,END:20,ZERO_PAD:2}}},RANGED:{1:{ATTACK_ABOVE:{KEY:"rockthrower-attack",TEXTURE:zi,PREFIX:Vi.RANGED[1].ATTACK_PREFIX,FRAME_RATE:30,EVENT_FRAME:16,START:0,END:29,ZERO_PAD:2},ATTACK_BELOW:{KEY:"rockthrower-attack",TEXTURE:zi,PREFIX:Vi.RANGED[1].ATTACK_PREFIX,FRAME_RATE:30,EVENT_FRAME:16,START:0,END:29,ZERO_PAD:2},DIE:{KEY:"rockthrower-die",TEXTURE:zi,PREFIX:Vi.RANGED[1].DIE_PREFIX,FRAME_RATE:24,START:0,END:23,ZERO_PAD:2},IDLE:{KEY:"rockthrower-idle",TEXTURE:zi,PREFIX:Vi.RANGED[1].IDLE_PREFIX,FRAME_RATE:24,START:0,END:23,ZERO_PAD:2}}},ALIEN:{1:{ATTACK:{KEY:"velociraptor-attack",TEXTURE:zi,PREFIX:Vi.MELEE[1].ATTACK_PREFIX,FRAME_RATE:30,START:0,END:29,ZERO_PAD:2},DIE:{KEY:"velociraptor-die",TEXTURE:zi,PREFIX:Vi.MELEE[1].DIE_PREFIX,FRAME_RATE:20,START:0,END:19,ZERO_PAD:2},IDLE:{KEY:"velociraptor-idle",TEXTURE:zi,PREFIX:Vi.MELEE[1].IDLE_PREFIX,FRAME_RATE:40,START:0,END:39,ZERO_PAD:2},RUN:{KEY:"velociraptor-move",TEXTURE:zi,PREFIX:Vi.MELEE[1].RUN_PREFIX,FRAME_RATE:25,START:0,END:24,ZERO_PAD:2}}}};var h5=E(mt()),{KEY:PEe,TEXTURE:_Ee,FRAME_RATE:IEe,START:LEe,END:MEe,PREFIX:OEe,ZERO_PAD:DEe}=Te.ALIEN[1].ATTACK,Jv=class extends h5.Animation{constructor(e){let i={repeat:-1,frameRate:IEe,frames:e.generateFrameNames(_Ee,{prefix:OEe,start:LEe,end:MEe,zeroPad:DEe}),showOnStart:!0,hideOnComplete:!0,skipMissedFrames:!0};super(e,PEe,i)}},l5=Jv;var u5=E(mt()),{KEY:BEe,TEXTURE:UEe,FRAME_RATE:NEe,START:FEe,END:kEe,PREFIX:GEe,ZERO_PAD:qEe}=Te.ALIEN[1].DIE,Qv=class extends u5.Animation{constructor(e){let i={repeat:0,frameRate:NEe,frames:e.generateFrameNames(UEe,{prefix:GEe,start:FEe,end:kEe,zeroPad:qEe}),showOnStart:!0,hideOnComplete:!1,skipMissedFrames:!0};super(e,BEe,i)}},c5=Qv;var d5=E(mt()),{KEY:WEe,TEXTURE:YEe,FRAME_RATE:HEe,START:zEe,END:VEe,PREFIX:XEe,ZERO_PAD:KEe}=Te.ALIEN[1].IDLE,eg=class extends d5.Animation{constructor(e){let i={repeat:-1,frameRate:HEe,frames:e.generateFrameNames(YEe,{prefix:XEe,start:zEe,end:VEe,zeroPad:KEe}),showOnStart:!0,hideOnComplete:!0,skipMissedFrames:!0};super(e,WEe,i)}},f5=eg;var p5=E(mt()),{KEY:ZEe,TEXTURE:jEe,FRAME_RATE:$Ee,START:JEe,END:QEe,PREFIX:eTe,ZERO_PAD:tTe}=Te.ALIEN[1].RUN,tg=class extends p5.Animation{constructor(e){let i={repeat:-1,frameRate:$Ee,frames:e.generateFrameNames(jEe,{prefix:eTe,start:JEe,end:QEe,zeroPad:tTe}),showOnStart:!0,hideOnComplete:!0,skipMissedFrames:!0};super(e,ZEe,i)}},m5=tg;var v5=E(mt()),{KEY:iTe,TEXTURE:sTe,FRAME_RATE:rTe,START:nTe,END:aTe,PREFIX:oTe,ZERO_PAD:hTe}=Te.MELEE[1].ATTACK,ig=class extends v5.Animation{constructor(e){let i={repeat:-1,frameRate:rTe,frames:e.generateFrameNames(sTe,{prefix:oTe,start:nTe,end:aTe,zeroPad:hTe}),showOnStart:!0,hideOnComplete:!1,skipMissedFrames:!0};super(e,iTe,i)}},g5=ig;var S5=E(mt()),{KEY:lTe,TEXTURE:uTe,FRAME_RATE:cTe,START:dTe,END:fTe,PREFIX:pTe,ZERO_PAD:mTe}=Te.MELEE[1].DIE,sg=class extends S5.Animation{constructor(e){let i={repeat:0,frameRate:cTe,frames:e.generateFrameNames(uTe,{prefix:pTe,start:dTe,end:fTe,zeroPad:mTe}),showOnStart:!0,hideOnComplete:!1,skipMissedFrames:!0};super(e,lTe,i)}},E5=sg;var T5=E(mt()),{KEY:vTe,TEXTURE:gTe,FRAME_RATE:STe,START:ETe,END:TTe,PREFIX:yTe,ZERO_PAD:bTe}=Te.MELEE[1].IDLE,rg=class extends T5.Animation{constructor(e){let i={repeat:-1,frameRate:STe,frames:e.generateFrameNames(gTe,{prefix:yTe,start:ETe,end:TTe,zeroPad:bTe}),showOnStart:!0,hideOnComplete:!0,skipMissedFrames:!0};super(e,vTe,i)}},y5=rg;var b5=E(mt()),{KEY:ATe,TEXTURE:xTe,FRAME_RATE:CTe,START:wTe,END:RTe,PREFIX:PTe,ZERO_PAD:_Te}=Te.MELEE[1].RUN,ng=class extends b5.Animation{constructor(e){let i={repeat:-1,frameRate:CTe,frames:e.generateFrameNames(xTe,{prefix:PTe,start:wTe,end:RTe,zeroPad:_Te}),showOnStart:!0,hideOnComplete:!0,skipMissedFrames:!0};super(e,ATe,i)}},A5=ng;var x5=E(mt()),{KEY:ITe,TEXTURE:LTe,FRAME_RATE:MTe,START:OTe,END:DTe,PREFIX:BTe,ZERO_PAD:UTe}=zn.GREEN_FIRE,ag=class extends x5.Animation{constructor(e){let i={repeat:-1,frameRate:MTe,frames:e.generateFrameNames(LTe,{prefix:BTe,start:OTe,end:DTe,zeroPad:UTe}),showOnStart:!0,hideOnComplete:!1,skipMissedFrames:!0};super(e,ITe,i)}},C5=ag;var w5=E(mt()),{KEY:NTe,TEXTURE:FTe,FRAME_RATE:kTe,START:GTe,END:qTe,PREFIX:WTe,ZERO_PAD:YTe}=Te.RANGED[1].ATTACK_ABOVE,og=class extends w5.Animation{constructor(e){let i={repeat:-1,frameRate:kTe,frames:e.generateFrameNames(FTe,{prefix:WTe,start:GTe,end:qTe,zeroPad:YTe}),showOnStart:!0,hideOnComplete:!1,skipMissedFrames:!0};super(e,NTe,i)}},R5=og;var P5=E(mt()),{KEY:HTe,TEXTURE:zTe,FRAME_RATE:VTe,START:XTe,END:KTe,PREFIX:ZTe,ZERO_PAD:jTe}=Te.RANGED[1].DIE,hg=class extends P5.Animation{constructor(e){let i={repeat:0,frameRate:VTe,frames:e.generateFrameNames(zTe,{prefix:ZTe,start:XTe,end:KTe,zeroPad:jTe}),showOnStart:!0,hideOnComplete:!1,skipMissedFrames:!0};super(e,HTe,i)}},_5=hg;var I5=E(mt()),{KEY:$Te,TEXTURE:JTe,FRAME_RATE:QTe,START:eye,END:tye,PREFIX:iye,ZERO_PAD:sye}=Te.RANGED[1].IDLE,lg=class extends I5.Animation{constructor(e){let i={repeat:-1,frameRate:QTe,frames:e.generateFrameNames(JTe,{prefix:iye,start:eye,end:tye,zeroPad:sye}),showOnStart:!0,hideOnComplete:!0,skipMissedFrames:!0};super(e,$Te,i)}},L5=lg;var ug=class extends xe{scene;constructor(e){super(e),this.scene=e}addLevel11ProjectileAnimation(){if(!this.scene.anims.exists(zn.GREEN_FIRE.KEY)){let e=new C5(this.scene.anims);this.scene.anims.add(zn.GREEN_FIRE.KEY,e)}}addAlienAnimation(){let{ATTACK:e,DIE:i,IDLE:s}=Te.ALIEN[1];if(!this.scene.anims.exists(s.KEY)){let r=new f5(this.scene.anims);this.scene.anims.add(s.KEY,r)}if(!this.scene.anims.exists(e.KEY)){let r=new m5(this.scene.anims);this.scene.anims.add(e.KEY,r)}if(!this.scene.anims.exists(s.KEY)){let r=new l5(this.scene.anims);this.scene.anims.add(s.KEY,r)}if(!this.scene.anims.exists(i.KEY)){let r=new c5(this.scene.anims);this.scene.anims.add(i.KEY,r)}}addMeleeLevel1Animation(){let{ATTACK:e,DIE:i,IDLE:s,RUN:r}=Te.MELEE[1];if(!this.scene.anims.exists(e.KEY)){let n=new g5(this.scene.anims);this.scene.anims.add(e.KEY,n)}if(!this.scene.anims.exists(i.KEY)){let n=new E5(this.scene.anims);this.scene.anims.add(i.KEY,n)}if(!this.scene.anims.exists(s.KEY)){let n=new y5(this.scene.anims);this.scene.anims.add(s.KEY,n)}if(!this.scene.anims.exists(r.KEY)){let n=new A5(this.scene.anims);this.scene.anims.add(r.KEY,n)}}addRangedLevel1Animation(){let{ATTACK_ABOVE:e,DIE:i,IDLE:s}=Te.RANGED[1];if(!this.scene.anims.exists(e.KEY)){let r=new R5(this.scene.anims);this.scene.anims.add(e.KEY,r)}if(!this.scene.anims.exists(i.KEY)){let r=new _5(this.scene.anims);this.scene.anims.add(i.KEY,r)}if(!this.scene.anims.exists(s.KEY)){let r=new L5(this.scene.anims);this.scene.anims.add(s.KEY,r)}}checkIfAnimationIsAdded(e){return this.scene.anims.exists(e)}addMeleeUnitAnimationBasedOnLevel(e){switch(e){case 1:this.addMeleeLevel1Animation();break;default:this.addAlienAnimation()}}addRangedUnitAnimationBasedOnLevel(e){switch(e){case 1:this.addRangedLevel1Animation();break;default:this.addAlienAnimation()}}},M5=ug;var cg=class t{baseValue;suffix;constructor(e,i,s){this.suffix=i||0,this.baseValue=Math.floor(e),!s&&(this.initValue(),this.refactorValue())}initValue(){if(this.suffix===0&&this.baseValue>=1e3){let e=this.baseValue.toString(),i=e.length-1;this.suffix=Math.floor(i/3);let s=i%3;this.suffix>=2&&(this.baseValue=parseInt(e.substring(0,4+s)));return}this.baseValue*=1e3}refactorValue(){if(this.baseValue=Math.floor(this.baseValue),this.baseValue>=1e6){this.baseValue=Math.floor(this.baseValue/1e3),this.suffix++;return}if(this.baseValue===0){this.suffix=0;return}if(this.baseValue<1e3&&this.suffix>0){this.baseValue*=1e3,this.suffix--;return}}add(e,i){let s=typeof e=="number"?new t(e,i,!0):e;if(s.baseValue<0){this.subtract(new t(s.baseValue*-1,s.suffix,!0));return}if(!(this.suffix-s.suffix>=2)){if(s.suffix-this.suffix>=2){this.baseValue=s.baseValue,this.suffix=s.suffix;return}if(this.suffix===s.suffix)this.baseValue+=s.baseValue;else{this.suffix=this.suffix>s.suffix?this.suffix:s.suffix;let r=this.suffix>s.suffix?this.baseValue:s.baseValue,n=this.suffix>s.suffix?s:this;this.baseValue=r+Math.floor(n.baseValue/1e3)}this.refactorValue()}}subtract(e,i){let s=typeof e=="number"?new t(e,i,!0):e;if(s.suffix>this.suffix){this.baseValue=0,this.suffix=0;return}if(s.baseValue>this.baseValue&&s.suffix===this.suffix){this.baseValue=0,this.suffix=0;return}this.suffix-s.suffix>=2||(this.baseValue-=Math.floor(s.baseValue/Math.pow(1e3,this.suffix-s.suffix)),this.refactorValue())}multiply(e){if(typeof e=="number"&&e<1e3){this.baseValue*=e,this.refactorValue();return}let i=typeof e=="number"?new t(e):e;this.suffix+=i.suffix,this.baseValue*=Math.floor(i.baseValue/1e3),this.refactorValue()}divide(e){if(typeof e=="number"&&e<1e3){this.baseValue/=e,this.refactorValue();return}let i=typeof e=="number"?new t(e):e;this.suffix-=i.suffix,this.baseValue/=Math.floor(i.baseValue/1e3),this.refactorValue()}clone(){return new t(this.baseValue,this.suffix,!0)}biggerThan(e){return this.suffix>e.suffix?!0:this.suffix<e.suffix?!1:this.baseValue>e.baseValue}smallerThan(e){return this.suffix<e.suffix?!0:this.suffix>e.suffix?!1:this.baseValue<e.baseValue}toString(){return`${Math.floor(this.baseValue/1e3)}${this.generateTextSuffix()}`}generateTextSuffix(){switch(this.suffix){case 0:return"";case 1:return"K";case 2:return"M";case 3:return"B";case 4:return"T";default:{let e=this.suffix-5,i=Math.floor(e/26),s=e%26,r=String.fromCharCode(i+65),n=String.fromCharCode(s+65);return`${r}${n}`}}}},be=cg;var rye={MELEE_UNIT_TYPE:"melee",RANGED_UNIT_TYPE:"ranged",ALIEN_UNIT_TYPE:"alien",MELEE_ATTACK_RANGE:40,MELEE_MOVEMENT_SPEED:100,MELEE_ATTACK_INTERVAL:800,RANGED_ATTACK_INTERVAL:1100,RANGED_PROJECTILE_SPEED:600,BASE_UNIT_COIN:2,UNIT_COIN_SCALE:1.6,COINS_PER_ATTACK:1,ATTACK_COIN_SCALE:1.6,ATTACK_COIN_BOSS_MULTIPLIER:3,MULTIPLY_REWARD_ROUND:6,MULTIPLY_REWARD_BATTLE:2,UNIT_SIZE_SCALE:1,UNIT_PRICE_CUSTOM_MODIFIER:[[1,1],[3,5],[10,2],[25,1.5],[40,1.5]],ATTACK_CUSTOM_MODIFIER:[[1,1],[9,2],[30,1.2]],AD_WATCH_REQUIREMENT:[0,1,2,3,4,5,7,9,12,15,20],BUYING_UNIT_LEVEL:[1,51,151,251]},L=rye;var nye={playerUnitData:"0-0-0-0-0/0-0-0-0-0/0-0-m1-0-0",level:0,coins:0,gameCompletedCount:0,meleeUnlockedUnitLevel:0,rangedUnlockedUnitLevel:0,bossLevelProgress:0,finalBossDefeated:!1,lastBossChallengeTime:0,isEligibleForReset:!1,coinBaseValue:1e4,coinSuffixValue:0,freeCoinsLastUsedTime:0,offlineRewardLastCheck:0,unitScreenAdWatchedCount:{MELEE:{},RANGED:{}}},oo=nye;var{player:en}=codex,{MaxBossLevel:O5}=le,{Utils:{Valid:D5}}=Ludex,dg=class t{static _instance;static get inst(){return this._instance||(this._instance=new t),this._instance}static getLevelProgress(){let e=en.getGameData()?.level;return!D5.isNumber(e)||e<0?0:e}static getPlayerUnitData(){let e=en.getGameData()?.playerUnitData;return!e||e===""?null:e}static getPlayerUnlockedMeleeLevel(){return en.getGameData()?.meleeUnlockedUnitLevel??1}static getPlayerUnlockedRangedLevel(){return en.getGameData()?.rangedUnlockedUnitLevel??1}static getPlayerAdWatchedCount(){let e=oo.unitScreenAdWatchedCount;return en.getGameData()?.unitScreenAdWatchedCount??e}static getPlayerBossLevelProgress(){let e=en.getGameData()?.bossLevelProgress;return!D5.isNumber(e)||e<1?1:e>O5?O5:e+1}static getLastBossChallengeTime(){return en.getGameData()?.lastBossChallengeTime??0}static getGameCompletedCount(){return en.getGameData()?.gameCompletedCount??0}},de=dg;var{player:B5e}=codex,{Utils:{Valid:U5e}}=Ludex,{MULTIPLY_REWARD_ROUND:aye,UNIT_COIN_SCALE:fg,BASE_UNIT_COIN:oye,COINS_PER_ATTACK:hye,ATTACK_COIN_SCALE:pg,ATTACK_COIN_BOSS_MULTIPLIER:lye,MULTIPLY_REWARD_BATTLE:uye}=L,mg=class extends xe{scene;unitModifier;currentUnitModifier;attackModifier;currentAttackModifier;totalCoinsByAttack;isPostGame=!1;constructor(e){super(e),this.scene=e,this.initModifier()}initModifier(){this.unitModifier=new be(1),this.attackModifier=new be(1),this.currentUnitModifier=new be(1)}init(){super.init(),this.totalCoinsByAttack=new be(0),this.checkForPostGame()}getUnitPrice(e){let i=e||0,s=2**(this.scene.getBuyingUnitLevel()-1),r=new be(oye),n=r.clone();return n.multiply(i),n.multiply(s),n.multiply(this.unitModifier),n.biggerThan(r)?n:r}getUnitAttackBaseCoin(e){let i=(e.level-1)*.75+hye;return e.unitType===L.RANGED_UNIT_TYPE&&this.isPostGame&&(i*=.75),i}getAttackCoinByUnit(e,i){let s=this.getUnitAttackBaseCoin(e),r=this.attackModifier.clone();r.multiply(s);let n=i.currentHp,a=e.attackPower;return n<a&&(r.multiply(n),r.divide(a)),r.biggerThan(new be(1))?r:new be(1)}setUnitModifier(e,i=1){if(e<=50){let s=fg**e;this.currentUnitModifier=new be(1),this.currentUnitModifier.multiply(s)}else{let s=fg**50,r=Math.floor(e/50),n=e%50;this.currentUnitModifier=new be(1);for(let o=0;o<r;o++)this.currentUnitModifier.multiply(s);let a=fg**n;this.currentUnitModifier.multiply(a)}this.currentUnitModifier.multiply(i),this.unitModifier=this.currentUnitModifier}getUnitModifier(){return this.unitModifier}setAttackModifier(e,i=1){if(e<=50){let s=pg**e;this.currentAttackModifier=new be(1),this.currentAttackModifier.multiply(s)}else{let s=pg**50,r=Math.floor(e/50),n=e%50;this.currentAttackModifier=new be(1);for(let o=0;o<r;o++)console.log("Attack modifier: ",this.attackModifier.toString()),this.currentAttackModifier.multiply(s),this.currentAttackModifier.multiply(1.5),console.log("Attack modifier: ",this.attackModifier.toString());let a=pg**n;this.currentAttackModifier.multiply(a)}this.currentAttackModifier.multiply(i),this.scene.gameMode===ne.BOSS&&this.currentAttackModifier.multiply(lye),this.attackModifier=this.currentAttackModifier}getAttackModifier(){return this.attackModifier}addCoinsByAttack(e){this.totalCoinsByAttack.add(e)}getTotalCoinsByAttack(){return this.totalCoinsByAttack.clone()}getRewardCoinsByAttackCoins(){let{gameMode:e}=this.scene,i=this.totalCoinsByAttack.clone();return i.multiply(aye),e===ne.BATTLE&&i.multiply(uye),i}checkForPostGame(){let e=de.getGameCompletedCount();this.isPostGame=e>0}},B5=mg;var{UNIT_PRICE_CUSTOM_MODIFIER:vg,ATTACK_CUSTOM_MODIFIER:U5}=L,{Utils:{Valid:tn,Browser:Xi}}=Ludex,gg=class extends xe{scene;currentGameMode;unitLevelsUpdated;customUnitModifier;attackLevelsUpdated;customAttackModifier;constructor(e){super(e),this.scene=e,this.intData()}intData(){this.currentGameMode=ne.NORMAL,this.unitLevelsUpdated=[!1],this.customUnitModifier=0,this.attackLevelsUpdated=[!1],this.customAttackModifier=0,tn.isDebugger()&&localStorage.clear(),this.initDataToolDev()}init(){let{levelManager:e}=this.scene;(this.scene.gameMode!==this.currentGameMode||e.isInLevelBuilderLevel())&&(this.currentGameMode=this.scene.gameMode,this.unitLevelsUpdated=[!1],this.customUnitModifier=0,this.attackLevelsUpdated=[!1],this.customAttackModifier=0)}initDataToolDev(){if(!tn.isDebugger())return;if(!Xi.getLocalStorage("DevCustomUnitMod")){let s={};vg.forEach(r=>{s[r[0]]=r[1]}),Xi.writeLocalStorage("DevCustomUnitMod",s)}if(!Xi.getLocalStorage("DevCustomAttackMod")){let s={};U5.forEach(r=>{s[r[0]]=r[1]}),Xi.writeLocalStorage("DevCustomAttackMod",s)}}addCustomUnitModifier(e){this.customUnitModifier+=e}updateCustomUnitModifierByLevel(e){if(this.updateCustomUnitModSuccessByDevTool(e))return;for(let s=0;s<vg.length;s++){let r=vg[s],n=r[0],a=r[1];if(n>e)break;this.unitLevelsUpdated[n]||(this.addCustomUnitModifier(a),this.unitLevelsUpdated[n]=!0)}let{coinManager:i}=this.scene;i.setUnitModifier(e,this.customUnitModifier)}updateCustomUnitModSuccessByDevTool(e){if(!tn.isDebugger())return!1;let i=Xi.getLocalStorage("DevCustomUnitMod");if(!tn.isObject(i))return!1;let s=0;for(let[a,o]of Object.entries(i)){let h=parseInt(a),l=o;if(h>e)break;h===e&&(s=l),this.unitLevelsUpdated[h]||(this.addCustomUnitModifier(l),this.unitLevelsUpdated[h]=!0)}let{coinManager:r,devToolManager:n}=this.scene;return r.setUnitModifier(e,this.customUnitModifier),n.setCurrentUnitModText(s,r.getUnitModifier()),!0}editCurrentLevelUnitMod(e){let{levelManager:i}=this.scene,s=i.getCurrentLevelId(),r=Xi.getLocalStorage("DevCustomUnitMod");if(tn.isObject(r)){let a=r[s];this.customUnitModifier=this.customUnitModifier-a+e,Xi.writeLocalStorage("DevCustomUnitMod",{[s]:e})}else this.addCustomUnitModifier(e),this.unitLevelsUpdated[s]=!0,Xi.writeLocalStorage("DevCustomUnitMod",{[s]:e});let{coinManager:n}=this.scene;return n.setUnitModifier(s,this.customUnitModifier),n.getUnitModifier()}addCustomAttackModifier(e){this.customAttackModifier+=e}updateCustomAttackModifierByLevel(e){if(this.updateCustomAttackModSuccessByDevTool(e))return;for(let s of U5){let r=s[0],n=s[1];if(r>e)break;this.attackLevelsUpdated[r]||(this.addCustomAttackModifier(n),this.attackLevelsUpdated[r]=!0)}let{coinManager:i}=this.scene;i.setAttackModifier(e,this.customAttackModifier)}updateCustomAttackModSuccessByDevTool(e){if(!tn.isDebugger())return!1;let i=Xi.getLocalStorage("DevCustomAttackMod");if(!tn.isObject(i))return!1;let s=0;for(let[a,o]of Object.entries(i)){let h=parseInt(a),l=o;if(h>e)break;h===e&&(s=l),this.attackLevelsUpdated[h]||(this.addCustomAttackModifier(l),this.attackLevelsUpdated[h]=!0)}let{coinManager:r,devToolManager:n}=this.scene;return r.setAttackModifier(e,this.customAttackModifier),n.setCurrentAttackModText(s,r.getAttackModifier()),!0}editCurrentLevelAttackMod(e){let{levelManager:i}=this.scene,s=i.getCurrentLevelId(),r=Xi.getLocalStorage("DevCustomAttackMod");if(tn.isObject(r)){let a=r[s];this.customAttackModifier=this.customAttackModifier-a+e,Xi.writeLocalStorage("DevCustomAttackMod",{[s]:e})}else this.addCustomAttackModifier(e),this.attackLevelsUpdated[s]=!0,Xi.writeLocalStorage("DevCustomAttackMod",{[s]:e});let{coinManager:n}=this.scene;return n.setAttackModifier(s,this.customAttackModifier),n.getAttackModifier()}},N5=gg;var Ec=E(he()),cye={props:{alpha:{duration:500,value:{start:0,from:0,to:1},ease:Ec.Cubic.Out},scale:{duration:1e3,value:{start:.8,from:.8,to:1},ease:Ec.Elastic.Out,easeParams:[.1,.45]}}},ho=cye;var sV=E(yc()),rV=E(ve()),nV=E(he()),bye={duration:1e3,ease:nV.Quadratic.InOut};function fo(t,e){let i={...bye,...e},{targets:s,curve:r,onCurveUpdate:n,...a}=i,o=new sV.Spline(r),h=Array.isArray(s)?s:[s],l=new rV.Vector2,c=d=>{o.getPoint(d.getValue(),l);for(let f of h)f.setPosition(l.x,l.y),n?.(f)};return t.tweens.addCounter({...a,onUpdate:c})}var Aye={CONGRATULATION:"congratulation",DAILY_REWARD:"daily_reward",DIAMONDS_DROP:"diamonds_drop",DIAMONDS_EAT:"diamonds_eat",FIREWORKS_BIG:"fireworks_big",FIREWORKS_SOAR:"fireworks_soar",FIREWORKS_SMALL:"fireworks_small",GEM_DROP:"gem_drop",GAME_OVER_SCENE:"game_over_scene",MISSION_COMPLETED:"mission_completed",MISSION_REWARD:"mission_reward",MOVE_WRONG:"move_wrong",START_LEVEL:"start_level",POPUP_OFF:"popup_off",POPUP_SHOW:"popup_show",SCORE_COUNTER:"score_counter",START_GAME:"start_game",YOU_LOSE:"you_lose",YOU_WIN:"you_win",NEXT_ROUND_EFFECT:"next-round-effect",LOSE_SOUND:"lose-sound",THUNDER_SOUND:"thunder-sound",CLOSE_CLICK:"close-click",BUTTON_CLICK:"button-click",UNIT_DRAG_END:"drag-unit-end",UNIT_DRAG_START:"drag-unit-start",START_BATTLE:"start-battle",MELEE_ATTACK:"melee-attack",ARROW_SHOOT:"arrow-shoot",UNIT_DAMAGED:"unit-damaged",UNIT_MERGE:"unit-merge",WIN_BATTLE:"win-battle",TURN_SWITCH:"turn-switch",UNIT_UNLOCK:"unit-unlock",COIN_SPAWN_SOUND:"coin-spawn",COIN_INCREASE_REPEATEDLY_SOUND:"coin-increase-repeatedly",GIFT_CHARGE:"gift-charge",GIFT_EXPLODE:"gift-explode",GIFT_REVEAL:"gift-reveal"},J=Aye;var RX=E(X()),PX=E(vr()),wg=E(he()),{KEY:bbe,FRAME:Abe}=T.EFFECTS,Rg=class extends RX.Container{emitZone;emitter;constructor(e){super(e),this.createEmitZone(),this.scene.add.existing(this)}createEmitZone(){this.emitZone=new PX.Rectangle}createEmitters(){this.emitter=this.scene.add.particles(0,0,bbe,{frame:Abe.FX_COMET,emitZone:{source:this.emitZone,type:"random"},speed:20,timeScale:1,frequency:100,alpha:{start:1,end:0,ease:wg.Expo.Out},scale:{start:2,end:.1,ease:wg.Expo.Out},lifespan:2666}),this.add(this.emitter),this.emitter.stop()}run(e,i,s,r,n){this.stop(),this.reset(),this.emitZone.setSize(r,n),this.emitZone.setPosition(i-r/2,s-n/2),this.emitter.setQuantity(e),this.emitter.start()}explode(e,i,s){this.emitter||this.reset(),this.emitter.explode(e,i,s)}stop(){this.emitter?.killAll(),this.emitter?.stop()}reset(){this.createEmitters()}},xc=Rg;var _X=E(X()),IX=E(vr()),LX=E(he()),{KEY:xbe,FRAME:Cbe}=T.EFFECTS,Pg=class extends _X.Container{deathZone;emitter;constructor(e){super(e),this.createDeathZone(),this.createEmitters(),this.setActive(!1),this.setVisible(!1),this.scene.add.existing(this)}createDeathZone(){this.deathZone=new IX.Circle}createEmitters(){this.emitter=this.scene.add.particles(0,0,xbe,{frame:Cbe.FX_SPARK,speed:{min:10,max:1200},scale:{start:1.33,end:0},alpha:{start:1,end:0,ease:LX.Expo.Out},deathZone:{source:this.deathZone,type:"onLeave"},lifespan:3e3}),this.add(this.emitter),this.emitter.stop()}explode(e,i,s,r){this.setActive(!0),this.setVisible(!0),this.deathZone.radius=r,this.deathZone.setPosition(i,s),this.emitter.explode(e,i,s)}stop(){this.emitter.forEachAlive(e=>{e.lifeCurrent=0},this)}},Cc=Pg;var wc=E(X()),Ai=E(ie()),gr=E(ve()),Ig=E(he()),Vn=E(he()),{FX_MERGE:wbe}=T.SPINE_EFFECTS,{KEY:nn,FRAME:an}=T.GAMEPLAY,{language:_g}=codex,{Utils:{Signal:MX}}=Ludex,Lg=class extends xe{scene;textObjects;activeTextObjects;mergeEffect;isRewardAnimRunning=!1;rewardUnitCurveAnimController=new MX.SignalController;sample;starTail;fullContainer;fullTextAnimController=new MX.SignalController;resultWinAnimationResetFunc=null;resultLoseAnimationResetFunc=null;sparkExplosive;constructor(e){super(e),this.scene=e,this.createMergeEffect(),this.createTextObjects(),this.createCurveAnimation(),this.createFullText(),this.createResultWinEffect(),this.createResultLoseEffect()}stop(){this.isRunning()&&(super.stop(),this.stopMergeEffect(),this.stopTextEffect(),this.resetFullFloatText())}playMergeEffect(e){let{x:i,y:s}=e.getWorldPosition();this.mergeEffect.setActive(!0),this.mergeEffect.setVisible(!0),this.mergeEffect.setPosition(i,s);let r=this.mergeEffect.getAnimationList();this.mergeEffect.play(r[0],!1,!1),q.playSound(J.UNIT_MERGE,{volume:.5})}createMergeEffect(){this.mergeEffect=this.scene.add.spine(0,0,wbe.KEY,"animation"),this.mergeEffect.setName("MergeEffect"),this.mergeEffect.setDepth(B.EFFECT),this.mergeEffect.setScale(.5,.5),this.mergeEffect.setActive(!1),this.mergeEffect.setVisible(!1)}stopMergeEffect(){this.mergeEffect.setActive(!1),this.mergeEffect.setVisible(!1)}createTextObjects(){this.textObjects=this.scene.add.group({runChildUpdate:!1}),this.activeTextObjects=this.scene.add.group({runChildUpdate:!1})}getTextEffectObject(){let e=this.textObjects.getMatching("active",!1)[0];return e||this.createTextEffect()}createTextEffect(){let e=P.buildText("",18).setDepth(B.DMG_POPUP_NUMBER).setFloatCoinStroke().build(this.scene);return this.textObjects.add(e),e}hideAllTextEffects(){this.textObjects.getChildren().forEach(e=>{e instanceof wc.Text&&e.active&&e.visible&&(this.activeTextObjects.add(e),e.kill())})}showAllTextEffects(){this.activeTextObjects.getChildren().forEach(e=>{e instanceof wc.Text&&e.revive()}),this.activeTextObjects.clear()}stopTextEffect(){this.textObjects.getChildren().forEach(e=>{e instanceof wc.Text&&(e.kill(),e.setAlpha(1),this.scene.tweens.killTweensOf(e))})}createCurveAnimation(){this.sample=this.scene.make.image({key:nn,frame:an.BLANK}),this.sample.setVisible(!1);let e=new xc(this.scene);e.setDepth(B.EFFECT),this.starTail=e}runCurveAnimation(e,i,s,r){let n={x:e,y:i},a={x:s,y:r},o=100;H.runTween(fo(this.scene,{targets:this.sample,duration:1e3,curve:[[n.x,n.y],[n.x-gr.RND.between(-o,o),n.y+gr.RND.between(-140,-100)],[a.x,a.y]],onComplete:()=>{this.runSparksExplosive(s,r)},onCurveUpdate:h=>{let c=h.x+gr.RND.between(-16,16),d=h.y+gr.RND.between(-16,16);this.starTail.explode(1,c,d)}}))}runCurveAnimationRewardUnit(e,i,s,r,n){let a={x:e,y:i},o={x:s.x,y:s.y},h=n||1,l=100,c=()=>{this.isRewardAnimRunning=!1;let{unitManager:f}=this.scene;r==="MELEE"&&f.createPlayerMelee(s.rowId,s.colId,h),r==="RANGED"&&f.createPlayerArcher(s.rowId,s.colId,h),this.scene.updateUI()},d=this.rewardUnitCurveAnimController.renew();H.runTween(fo(this.scene,{targets:this.sample,duration:1e3,curve:[[a.x,a.y],[a.x-gr.RND.between(-l,l),a.y+gr.RND.between(-140,-100)],[o.x,o.y]],onStart:()=>{this.isRewardAnimRunning=!0},onComplete:()=>{this.runSparksExplosive(o.x,o.y),c()},onStop:()=>{c()},onCurveUpdate:f=>{if(!this.isRewardAnimRunning)return;let p=16,m=f.x+gr.RND.between(-p,p),v=f.y+gr.RND.between(-p,p);this.starTail.explode(1,m,v)}}),d)}runSparksExplosive=(e,i)=>{let s=this.scene;this.sparkExplosive=new Cc(s),this.sparkExplosive.setDepth(B.EFFECT),this.sparkExplosive.explode(100,e,i,50)};createFullText(){this.fullContainer=this.scene.add.container(0,0),this.fullContainer.setDepth(B.EFFECT);let e=this.scene.make.image({key:nn,frame:an.PURPLE_EFFECT});e.setWorldSize(263.5,79.5),this.fullContainer.add(e);let i=P.buildText(_g.getText("FULL"),25).setHighQuality().build(this.scene);Ai.Align.In.Center(i,e,-3,-5),this.fullContainer.add(i),this.fullContainer.kill(),Ai.Align.In.Center(this.fullContainer,this.scene.gameZone,0,30)}playFullFloatText(){let e=this.fullTextAnimController.renew();H.runTween(this.scene.tweens.add({...ho,paused:!0,targets:this.fullContainer,onStart:()=>{this.fullContainer.revive()},onComplete:()=>{this.scene.tweens.add({targets:this.fullContainer,duration:300,delay:200,alpha:0})}}),e)}resetFullFloatText(){this.fullTextAnimController.abort()}createResultWinEffect(){let e=this.scene.add.container(0,0);e.setDepth(B.EFFECT);let i=this.scene.make.image({key:nn,frame:an.EFFECT_WIN_GLOW});i.setWorldSize(276.5,58.5),e.add(i);let s=P.buildText(_g.getText("WIN"),25).setHighQuality().build(this.scene);Ai.Align.In.Center(s,i),e.add(s);let r=this.scene.make.image({key:nn,frame:an.EFFECT_WIN_SHAPE_ABOVE});r.setWorldSize(87.5,18.5),e.add(r),Ai.Align.In.TopCenter(r,i,0,5);let n=this.scene.make.image({key:nn,frame:an.EFFECT_WIN_SHAPE_BELOW});n.setWorldSize(147,23.5),e.add(n),Ai.Align.In.BottomCenter(n,i,0,8),e.kill(),I.isLandscape()?Ai.Align.In.Center(e,this.scene.gameZone,0,-20):Ai.Align.In.Center(e,this.scene.gameZone,0,-80),this.resultWinAnimationResetFunc=()=>{this.scene.tweens.add({paused:!0,targets:[e],onActive:()=>{e.revive(),e.setAlpha(1),e.setScale(1),i.setAlpha(0),s.setAlpha(0),r.setAlpha(0),n.setAlpha(0),this.scene.add.tween({targets:[i,s],duration:400,alpha:{start:0,to:1},ease:Ig.Quadratic.In}),this.scene.add.tween({targets:[r,n],duration:300,alpha:{start:0,to:1}}),this.scene.add.tween({targets:[r],duration:300,delay:200,y:{start:-10,to:-25},ease:Vn.Cubic.InOut}),this.scene.add.tween({targets:[n],duration:300,delay:200,y:{start:10,to:25},ease:Vn.Cubic.InOut}),this.scene.add.tween({targets:[e],duration:600,delay:1e3,scale:{from:1,to:1.2},ease:Vn.Cubic.InOut}),this.scene.tweens.add({targets:[e],duration:300,delay:1300,alpha:0})}})}}playResultWinAnimation(){this.resultWinAnimationResetFunc?.call(this)}createResultLoseEffect(){let e=this.scene.add.container(0,0);e.setDepth(B.EFFECT);let i=this.scene.make.image({key:nn,frame:an.EFFECT_LOSE_GLOW});i.setWorldSize(253.5,55),e.add(i);let s=P.buildText(_g.getText("LOSE"),25).setHighQuality().build(this.scene);Ai.Align.In.Center(s,i),e.add(s);let r=this.scene.make.image({key:nn,frame:an.EFFECT_LOSE_SHAPE_ABOVE});r.setWorldSize(86,22.5),e.add(r),Ai.Align.In.TopCenter(r,i,0,5);let n=this.scene.make.image({key:nn,frame:an.EFFECT_LOSE_SHAPE_BELOW});n.setWorldSize(126.5,25.5),e.add(n),Ai.Align.In.BottomCenter(n,i,0,8),e.kill(),I.isLandscape()?Ai.Align.In.Center(e,this.scene.gameZone,0,-20):Ai.Align.In.Center(e,this.scene.gameZone,0,-80),this.resultLoseAnimationResetFunc=()=>{this.scene.tweens.add({paused:!0,targets:[e],onActive:()=>{e.revive(),e.setAlpha(1),e.setScale(1),i.setAlpha(0),s.setAlpha(0),r.setAlpha(0),n.setAlpha(0),this.scene.add.tween({targets:[i,s],duration:400,alpha:{start:0,to:1},ease:Ig.Quadratic.In}),this.scene.add.tween({targets:[r,n],duration:300,alpha:{start:0,to:1}}),this.scene.add.tween({targets:[r],duration:300,delay:200,y:{start:-10,to:-25},ease:Vn.Cubic.InOut}),this.scene.add.tween({targets:[n],duration:300,delay:200,y:{start:10,to:25},ease:Vn.Cubic.InOut}),this.scene.add.tween({targets:[e],duration:600,delay:1e3,scale:{from:1,to:.8},ease:Vn.Cubic.InOut}),this.scene.tweens.add({targets:[e],duration:300,delay:1300,alpha:0})}})}}playResultLoseAnimation(){this.resultLoseAnimationResetFunc?.call(this)}isRewardCurveAnimationRunning(){return this.isRewardAnimRunning}stopRewardCurveAnimation(){this.isRewardAnimRunning&&(this.rewardUnitCurveAnimController.abort(),this.starTail?.stop(),this.sparkExplosive?.stop())}},OX=Lg;var{Utils:{Device:Rbe}}=Ludex,Ws=Math.ceil(Math.min(Rbe.pixelRatio(),2)),Pbe={AVATAR_DEFAULT:{KEY:"avatar-default",FILE:"./assets/images/others/avatar-default.png",CONFIG:{}},BG_DESERT:{KEY:"background_desert",FILE:`./assets/images/${Ws}x/bg_desert.jpg`,CONFIG:{}},BG_ICE:{KEY:"background_ice",FILE:`./assets/images/${Ws}x/bg_ice.jpg`,CONFIG:{}},BG_TREE:{KEY:"background_tree",FILE:`./assets/images/${Ws}x/bg_tree.jpg`,CONFIG:{}},BG_VOLCANO:{KEY:"background_volcano",FILE:`./assets/images/${Ws}x/bg_volcano.jpg`,CONFIG:{}},BG_CRYSTAL:{KEY:"background_crystal",FILE:`./assets/images/${Ws}x/bg_crystal.jpg`,CONFIG:{}},BG_LANDSCAPE_DESERT:{KEY:"background_landscape_desert",FILE:`./assets/images/${Ws}x/bg_landscape_desert.jpg`,CONFIG:{}},BG_LANDSCAPE_ICE:{KEY:"background_landscape_ice",FILE:`./assets/images/${Ws}x/bg_landscape_ice.jpg`,CONFIG:{}},BG_LANDSCAPE_TREE:{KEY:"background_landscape_tree",FILE:`./assets/images/${Ws}x/bg_landscape_tree.jpg`,CONFIG:{}},BG_LANDSCAPE_VOLCANO:{KEY:"background_landscape_volcano",FILE:`./assets/images/${Ws}x/bg_landscape_volcano.jpg`,CONFIG:{}},BG_LANDSCAPE_CRYSTAL:{KEY:"background_landscape_crystal",FILE:`./assets/images/${Ws}x/bg_landscape_crystal.jpg`,CONFIG:{}}},U=Pbe;var DX=E(X()),BX=E(nt()),Mg=class extends DX.Container{placementArea;areaRect;scene;rowId;colId;isTaken;constructor(e,i,s,r){super(e,i,s),this.scene=e,this.createAreaRect(r),this.createPlacementArea(r),this.addEventListener(),this.scene.add.existing(this),this.setDepth(B.FIELD_SQUARE)}createPlacementArea(e){let i=I.getPixelRatio();this.placementArea=this.scene.add.zone(0,0,e*i,e*i),this.add(this.placementArea)}createAreaRect(e){this.areaRect=this.scene.add.rectangle(0,0,e,e,16368767,1),this.add(this.areaRect),this.areaRect.setDepth(B.FIELD_SQUARE_RECT)}updateAreaRect(e){this.areaRect.setFillStyle(e)}setSquarePosition(e,i){this.rowId=e,this.colId=i,this.isTaken=!1}setTaken(e){this.isTaken=e}addEventListener(){this.placementArea.setInteractive({useHandCursor:!0}),this.placementArea.on(BX.GAMEOBJECT_POINTER_DOWN,()=>{console.log(this.rowId,this.colId)})}},Og=Mg;var _be=[{KEY_PORTRAIT:U.BG_TREE.KEY,KEY_LANDSCAPE:U.BG_LANDSCAPE_TREE.KEY,BG_EXTENSION_COLOR:8102725,SQUARE_COLOR:11452994,SQUARE_HIGHT_LIGHT_COLOR:9692964,SQUARE_HIGHT_LIGHT_BORDER_COLOR:14089889},{KEY_PORTRAIT:U.BG_DESERT.KEY,KEY_LANDSCAPE:U.BG_LANDSCAPE_DESERT.KEY,BG_EXTENSION_COLOR:16761714,SQUARE_COLOR:16368767,SQUARE_HIGHT_LIGHT_COLOR:16766227,SQUARE_HIGHT_LIGHT_BORDER_COLOR:16773290},{KEY_PORTRAIT:U.BG_ICE.KEY,KEY_LANDSCAPE:U.BG_LANDSCAPE_ICE.KEY,BG_EXTENSION_COLOR:15330021,SQUARE_COLOR:13952244,SQUARE_HIGHT_LIGHT_COLOR:6402815,SQUARE_HIGHT_LIGHT_BORDER_COLOR:16777215},{KEY_PORTRAIT:U.BG_CRYSTAL.KEY,KEY_LANDSCAPE:U.BG_LANDSCAPE_CRYSTAL.KEY,BG_EXTENSION_COLOR:3224690,SQUARE_COLOR:5792413,SQUARE_HIGHT_LIGHT_COLOR:6195962,SQUARE_HIGHT_LIGHT_BORDER_COLOR:11848191},{KEY_PORTRAIT:U.BG_VOLCANO.KEY,KEY_LANDSCAPE:U.BG_LANDSCAPE_VOLCANO.KEY,BG_EXTENSION_COLOR:13383207,SQUARE_COLOR:7886462,SQUARE_HIGHT_LIGHT_COLOR:12016072,SQUARE_HIGHT_LIGHT_BORDER_COLOR:15310583}],Rc=_be;var{STATUS:Ibe}=kt,{player:Lbe}=codex,Mbe={PORTRAIT:{x:30.5,y:158},LANDSCAPE:{x:323,y:55}},Obe={PORTRAIT:{x:30.5,y:-246},LANDSCAPE:{x:323,y:-77}},Dbe=50,Dg=class extends xe{scene;fieldBackground;playerPlacementSquares;enemyPlacementSquares;firstHightLineZone;secondHightLineZone;fieldBackgroundExtension;playerSquareOffsetX;playerSquareOffsetY;enemySquareOffsetX;enemySquareOffsetY;constructor(e){super(e),this.scene=e,this.enemyPlacementSquares=[],this.playerPlacementSquares=[],this.updateSquareOffset(),this.createBattlefield(),this.createHightLineZone()}updateSquareOffset(){let e=I.isUsingLandscapeBackground(),{PORTRAIT:i,LANDSCAPE:s}=Obe,{PORTRAIT:r,LANDSCAPE:n}=Mbe;this.playerSquareOffsetX=i.x,this.playerSquareOffsetY=i.y,this.enemySquareOffsetX=r.x,this.enemySquareOffsetY=r.y,e&&(this.playerSquareOffsetX=s.x,this.playerSquareOffsetY=s.y,this.enemySquareOffsetX=n.x,this.enemySquareOffsetY=n.y)}init(){super.init(),this.updateField(),this.resetPlacementSquareStatus()}start(){this.isRunning()||(this.showPlacementSquares(),this.setState(Ibe.RUNNING))}updateField(){let e=this.getCurrentLevel(),i=this.getBgData(e);this.updateFieldBackground(i),this.updatePlacementSquares(i),this.updateHightLightSquares(i)}getCurrentLevel(){let{currentLevelData:e=null}=this.scene.levelManager;return e?e.level_id:Lbe.getGameData()?.level??1}getBgData(e){let i=Math.floor(e/10)%Object.keys(Rc).length,s=Rc[i],n=I.isUsingLandscapeBackground()?s.KEY_LANDSCAPE:s.KEY_PORTRAIT;return this.scene.textures.exists(n)?s:(console.log("Background not found, using default"),Rc[0])}updateFieldBackground(e){let s=I.isUsingLandscapeBackground()?e.KEY_LANDSCAPE:e.KEY_PORTRAIT;this.fieldBackground.setTexture(s),this.fieldBackgroundExtension.setFillStyle(e.BG_EXTENSION_COLOR)}updatePlacementSquares(e){this.playerPlacementSquares.forEach(i=>{i.updateAreaRect(e.SQUARE_COLOR)}),this.enemyPlacementSquares.forEach(i=>{i.updateAreaRect(e.SQUARE_COLOR)})}updateHightLightSquares(e){this.firstHightLineZone.setFillStyle(e.SQUARE_HIGHT_LIGHT_COLOR),this.firstHightLineZone.setStrokeStyle(2,e.SQUARE_HIGHT_LIGHT_BORDER_COLOR),this.secondHightLineZone.setFillStyle(e.SQUARE_HIGHT_LIGHT_COLOR),this.secondHightLineZone.setStrokeStyle(2,e.SQUARE_HIGHT_LIGHT_BORDER_COLOR)}createHightLineZone(){let{displayWidth:e,scale:i}=this.fieldBackground,s=i*I.getPixelRatio(),r={x:this.enemySquareOffsetX*s,y:this.enemySquareOffsetY*s},n=e-r.x*2;this.firstHightLineZone=this.scene.add.rectangle(0,0,n/5,n/5,16777215,1),this.firstHightLineZone.setStrokeStyle(2,16776960),this.firstHightLineZone.setDepth(B.FIELD_SQUARE_RECT),this.firstHightLineZone.kill(),this.secondHightLineZone=this.scene.add.rectangle(0,0,n/5,n/5,16777215,1),this.secondHightLineZone.setStrokeStyle(2,16776960),this.secondHightLineZone.setDepth(B.FIELD_SQUARE),this.secondHightLineZone.kill()}createBattlefield(){let e=this.getCurrentLevel(),i=this.getBgData(e);this.createFieldBackground(i),this.createPlacementSquares(i)}createFieldBackground(e){let s=I.isUsingLandscapeBackground()?e.KEY_LANDSCAPE:e.KEY_PORTRAIT;this.createBackground(s),this.handleBackgroundTopOffset(),this.createBackgroundExtension(e.BG_EXTENSION_COLOR)}createBackground(e){let{width:i}=I.getWorldSize(),s=I.getPixelRatio();this.fieldBackground=this.scene.make.image({key:e,origin:{x:.5,y:1}}),this.fieldBackground.setScale(i/this.fieldBackground.width/s),this.fieldBackground.setDepth(B.FIELD_BACKGROUND)}handleBackgroundTopOffset(){let{height:e}=I.getWorldSize(),i=this.enemySquareOffsetY-(this.fieldBackground.displayHeight-e),s=Dbe-i;if(s<=-e/10&&(s=-e/10),I.isUsingLandscapeBackground()){this.handleBackgroundLandscapeSize(),this.fieldBackground.setPosition(0,e/2);return}this.fieldBackground.setPosition(0,e/2+s)}handleBackgroundLandscapeSize(){let{height:e}=I.getWorldSize(),{width:i,height:s}=I.getDesignSize(),r=e/s;this.fieldBackground.setWorldSize(i*r,s*r)}createBackgroundExtension(e){let{width:i,height:s}=I.getWorldSize(),r=this.fieldBackground.getBottomLeft();this.fieldBackgroundExtension=this.scene.add.rectangle(r.x,r.y,i,s,e),this.fieldBackgroundExtension.setOrigin(0,0)}createPlacementSquares(e){this.createPlayerPlacementSquares(e.SQUARE_COLOR),this.createEnemyPlacementSquares(e.SQUARE_COLOR)}createEnemyPlacementSquares(e){let{displayWidth:i,scaleX:s,scaleY:r}=this.fieldBackground,n=I.getPixelRatio(),a=s*n,o=r*n,h={x:this.enemySquareOffsetX*a,y:this.enemySquareOffsetY*a},l={x:this.enemySquareOffsetX*o,y:this.enemySquareOffsetY*o},{x:c,y:d}=h,{x:f,y:p}=l,m=i-c*2,v=i-f*2,g=m<v?m:v,S={x:m<v?h.x:l.x,y:Math.abs(d)<Math.abs(p)?d:p},y=this.fieldBackground.getTopLeft();y.x+=S.x,y.y+=S.y;let b=1;for(let x=0;x<3;x++)for(let A=0;A<5;A++){let w=new Og(this.scene,y.x+A*g/5+g/10,y.y+x*g/5+g/10,g/5);w.updateAreaRect(e),w.setSquarePosition(x+1,A+1),w.setAlpha(b),b=b===1?0:1,this.enemyPlacementSquares.push(w)}}createPlayerPlacementSquares(e){let{displayWidth:i,scaleX:s,scaleY:r}=this.fieldBackground,n=I.getPixelRatio(),a=s*n,o=r*n,h={x:this.playerSquareOffsetX*a,y:this.playerSquareOffsetY*a},l={x:this.playerSquareOffsetX*o,y:this.playerSquareOffsetY*o},{x:c,y:d}=h,{x:f,y:p}=l,m=i-c*2,v=i-f*2,g=m<v?m:v,S={x:m<v?h.x:l.x,y:Math.abs(d)<Math.abs(p)?d:p},y=this.fieldBackground.getBottomLeft();y.x+=S.x,y.y+=S.y;let b=1;for(let x=0;x<3;x++)for(let A=0;A<5;A++){let w=new Og(this.scene,y.x+A*g/5+g/10,y.y-x*g/5-g/10,g/5);w.updateAreaRect(e),w.setSquarePosition(3-x,A+1),w.setAlpha(b),b=b===1?0:1,this.playerPlacementSquares.push(w)}}hidePlacementSquares(){this.playerPlacementSquares.forEach(e=>e.kill()),this.enemyPlacementSquares.forEach(e=>e.kill())}showPlacementSquares(){this.playerPlacementSquares.forEach(e=>e.revive()),this.enemyPlacementSquares.forEach(e=>e.revive())}getPlayerPlacementSquare(e,i){return this.playerPlacementSquares.filter(r=>r.rowId===e&&r.colId===i)[0]}getEnemyPlacementSquare(e,i){return this.enemyPlacementSquares.filter(r=>r.rowId===e&&r.colId===i)[0]}getSquareBasedOnPosition(e,i){for(let s=0;s<this.playerPlacementSquares.length;s++){let r=this.playerPlacementSquares[s];if(r.placementArea.getBounds().contains(e,i))return r}return null}getSquareBasedOnIndex(e,i){for(let s=0;s<this.playerPlacementSquares.length;s++){let r=this.playerPlacementSquares[s];if(r.rowId===e&&r.colId===i)return r}return null}tryGettingAvailablePlacement(e,i){let s=this.getSquareBasedOnIndex(e,i);return s&&!s.isTaken?s:null}getAvailablePlacement(){let e=null;for(let i of this.playerPlacementSquares)if(!i.isTaken)return e=i,e;return e}resetPlacementSquareStatus(){for(let e of this.playerPlacementSquares)e.isTaken=!1}getRemainingAvailablePlacement(){return this.playerPlacementSquares.filter(i=>!i.isTaken).length}updateBackgroundElement(e){if(!I.isUsingLandscapeBackground())return;let s=document.getElementById("background-image");if(!s)return;let r=de.getLevelProgress();if(typeof r!="number"||r<0){s.src=U.BG_LANDSCAPE_TREE.FILE;return}let n=U.BG_LANDSCAPE_TREE.FILE;switch(Math.floor((r+1)/10)%5){case 0:n=U.BG_LANDSCAPE_TREE.FILE;break;case 1:n=U.BG_LANDSCAPE_DESERT.FILE;break;case 2:n=U.BG_LANDSCAPE_ICE.FILE;break;case 3:n=U.BG_LANDSCAPE_CRYSTAL.FILE;break;case 4:n=U.BG_LANDSCAPE_VOLCANO.FILE;break}s.onload=()=>{this.updateFieldBackground(e),this.updatePlacementSquares(e),this.updateHightLightSquares(e),s.onload=()=>{}},s.src=n}},UX=Dg;var Bg=new be(0,0,!0),Ug=class t{static _instance;coin=Bg;static get inst(){return this._instance||(this._instance=new t),this._instance}getCoin(){return this.coin}setCoin(e,i){let s=typeof e=="number"?new be(e,i,!0):e;this.coin=s.clone(),this.saveCoin(),this.emitCoinChanged()}addCoin(e,i){let s=this.coin.clone();if(typeof e=="number"){let r=e;s.add(r,i)}else{let r=e;s.add(r)}this.coin=s,this.saveCoin(),this.emitCoinChanged()}removeCoin(e,i){let s=this.coin.clone();if(typeof e=="number"){let r=e;s.subtract(r,i)}else{let r=e;s.subtract(r)}s.smallerThan(Bg)&&(this.coin=Bg),this.coin=s,this.saveCoin(),this.emitCoinChanged()}saveCoin(){let{player:e}=codex;e.setGameData({coinBaseValue:this.coin.baseValue,coinSuffixValue:this.coin.suffix})}loadCoin(){let{player:e}=codex,i=e.getGameData(),s=i?.coinBaseValue??0,r=i?.coinSuffixValue??0;this.coin=new be(s,r,!0)}emitCoinChanged(){let{event:e}=codex;e.emit(we.COINS_CHANGED)}},Se=Ug;var{STATUS:Bbe}=kt,{MELEE_UNIT_TYPE:Xn,RANGED_UNIT_TYPE:po}=L,{player:NX}=codex,{Utils:{Valid:AXe,Object:Ube}}=Ludex,Ng=class extends xe{scene;playerLevel;currentLevelId;currentLevelData;enemyData;playerData;constructor(e){super(e),this.scene=e}init(){let{gameMode:e}=this.scene;this.enemyData=[],(e===ne.NORMAL||e===ne.BOSS)&&(this.updatePlayerLevel(),this.loadLevel()),ne.BATTLE}start(){this.isRunning()||this.setState(Bbe.RUNNING)}setCurrentLevelId(e){this.currentLevelId=e}updatePlayerLevel(){let e=de.getLevelProgress();this.playerLevel=e}loadLevel(){try{if(this.scene.game.cache.json.exists("level-builder-json")){this.loadLevelBuilderLevel();return}this.setCurrentLevelId(this.playerLevel?this.playerLevel+1:1),console.log("\u{1F916} ? this.playerLevel",this.playerLevel);let e=this.playerLevel?this.playerLevel:0,i=Math.floor(e/100)*100+1,s=i+99,r=(1e4+i).toString().substring(1),n=(1e4+s).toString().substring(1),a=this.scene.cache.json.get(`levels-${r}-${n}`),o=this.currentLevelId-i;o>=a.levels.length&&this.setCurrentLevelId(a.levels.length-1),this.currentLevelData=a.levels[o],this.scene.gameMode===ne.BOSS?this.createBossEnemyData():this.createNormalEnemyData()}catch(e){console.warn(e)}}createNormalEnemyData(){this.currentLevelData.enemy_row1.split("-").forEach((e,i)=>{if(e!=="0"){let s=e.charAt(0)==="m"?Xn:po,r=parseInt(e.substring(1)),n=1,a=i+1;this.enemyData.push({type:s,level:r,positionRow:n,positionColumn:a})}}),this.currentLevelData.enemy_row2.split("-").forEach((e,i)=>{if(e!=="0"){let s=e.charAt(0)==="m"?Xn:po,r=parseInt(e.substring(1)),n=2,a=i+1;this.enemyData.push({type:s,level:r,positionRow:n,positionColumn:a})}}),this.currentLevelData.enemy_row3.split("-").forEach((e,i)=>{if(e!=="0"){let s=e.charAt(0)==="m"?Xn:po,r=parseInt(e.substring(1)),n=3,a=i+1;this.enemyData.push({type:s,level:r,positionRow:n,positionColumn:a})}})}createBossEnemyData(){let e=this.getPlayerBossLevel();this.enemyData.push({type:Xn,level:e,positionRow:2,positionColumn:3,isBoss:!0})}loadLevelBuilderLevel(){let e=this.scene.cache.json.get("level-builder-json");this.currentLevelId=e.level_id;try{this.currentLevelData=e}catch(i){console.log(i)}this.createData()}createData(){this.createNormalEnemyData(),this.createPlayerData()}createPlayerData(){this.playerData=[];let e=this.currentLevelData;e&&(Se.inst.setCoin(e.coins.baseValue,e.coins.suffix),e.player_row1.split("-").forEach((i,s)=>{if(i!=="0"){let r=i.charAt(0)==="m"?Xn:po,n=parseInt(i.substring(1)),a=1,o=s+1;this.playerData.push({type:r,level:n,positionRow:a,positionColumn:o})}}),e.player_row2.split("-").forEach((i,s)=>{if(i!=="0"){let r=i.charAt(0)==="m"?Xn:po,n=parseInt(i.substring(1)),a=2,o=s+1;this.playerData.push({type:r,level:n,positionRow:a,positionColumn:o})}}),e.player_row3.split("-").forEach((i,s)=>{if(i!=="0"){let r=i.charAt(0)==="m"?Xn:po,n=parseInt(i.substring(1)),a=3,o=s+1;this.playerData.push({type:r,level:n,positionRow:a,positionColumn:o})}}))}isInLevelBuilderLevel(){return this.scene.gameMode!==ne.NORMAL?!1:Ube.hasOwn(this.currentLevelData,"player_row1")}updateHighestCurrentLevel(){this.isInLevelBuilderLevel()||this.playerLevel<this.currentLevelId&&NX.setGameData({level:this.currentLevelId})}updateHighestCurrentBossLevel(){let e=this.getPlayerBossLevel();e&&NX.setGameData({bossLevelProgress:e})}getCurrentLevelId(){return this.currentLevelId}getModifierLevel(){let{gameMode:e}=this.scene;if(e===ne.NORMAL||e===ne.BOSS)return this.currentLevelId;let i=de.getLevelProgress();return Math.min(this.currentLevelId,i+1)}getPlayerLevel(){return this.isInLevelBuilderLevel()?this.currentLevelId:de.getLevelProgress()}getPlayerBossLevel(){return de.getPlayerBossLevelProgress()}loadAllLevels(){this.scene.cache.json.get("levels").levels.forEach((i,s)=>{this.currentLevelData=i,console.log(s),this.createNormalEnemyData()})}},FX=Ng;var Nbe={FREE_COINS:{ID:"free-coins"},SPEED_UP:{ID:"speed-up"},BOSS_CHALLENGE:{ID:"boss-challenge"}},mo=Nbe;var{STATUS:kX}=kt,{enable:Fbe}=le.Powers.FreeCoins,{enable:IXe}=le.Powers.SpeedUp,{player:LXe}=codex,Fg=class extends xe{scene;items={};readyStateItems={};playingStateItems={};itemActive;isSpeedUp;constructor(e){super(e),this.scene=e,this.isSpeedUp=!1,this.createItems()}init(){this.setState(kX.READY),this.deactivateItems();let{objects:e}=this.scene.layoutManager;e.freeCoinsItem.startCountdown()}stop(){this.isRunning()&&(this.deactivateItems(),this.setState(kX.STOPPED))}activeItem=e=>{this.isRunning()&&this.items[e]&&(this.deactivateItems(),this.itemActive=e,this.items[e].activeItem())};deactivateItem=e=>{this.items[e]&&(this.itemActive="",this.items[e].deactivateItem())};deactivateItems(){for(let e in this.items)this.deactivateItem(e)}createItems(){this.createFreeCoinsButton()}createFreeCoinsButton(){if(!Fbe)return;let{objects:e}=this.scene.layoutManager;this.items[mo.FREE_COINS.ID]=e.freeCoinsItem}getAllItems(){return Object.values(this.items)}getItemsForReadyState(){return Object.values(this.readyStateItems)}getItemsForPlayingState(){return Object.values(this.playingStateItems)}isGameSpeedUp(){return this.isSpeedUp||!1}forceReturnToNormalSpeed(){this.scene.unitManager.resetSpeedAllUnits()}checkForSpeedSetting(){}syncSpeedSetting(){}updateTimers(){let{freeCoinsItem:e}=this.scene.layoutManager.objects;e.disableItem(),e.startCountdown()}},GX=Fg;var WX=E(X()),{UNIT_SIZE_SCALE:qX}=L,kg=class extends xe{scene;isDirtyDepth;spineUnits=[];spineContainer;constructor(e){super(e),this.scene=e,this.isDirtyDepth=!1,this.spineUnits=[],this.spineContainer=this.scene.add.spineContainer(0,0),this.spineContainer.setDepth(B.MANAGER_BASE_DEPTH)}init(){super.init(),this.spineUnits=[],this.spineContainer.removeAll()}update(e){this.isRunning()&&(this.spineUnits.forEach(i=>{let s=i.getSpineDisplay();if(!s)return;s.depth!==i.depth&&(s.setDepth(i.depth),this.isDirtyDepth=!0);let{x:r,y:n}=i.getWorldPosition();s.setPosition(r,n+25)}),e&&this.isDirtyDepth&&this.sortSpineContainerByDepth())}sortSpineContainerByDepth(){this.spineContainer.sort("depth",(e,i)=>e.depth-i.depth)}sortSpineContainerByName(){this.spineContainer.sort("name",(e,i)=>e.name.localeCompare(i.name))}sortSpineContainerByLevel(){this.spineContainer.sort("level",(e,i)=>e.level-i.level)}addSpines(e){if(this.isRunning())for(let i of e){if(this.spineUnits.some(r=>r===i))continue;let s=i.getSpineDisplay();s&&(s instanceof WX.Sprite||(s.level=i.level,i.display.setSpineScale(qX*.5,qX*.5),this.spineUnits.push(i),this.spineContainer.add(s)))}}removeSpine(e){let i=e.getSpineDisplay();i&&(this.spineUnits=this.spineUnits.filter(s=>s!==e),this.spineContainer.remove(i,!1))}bringToTopOnDrag(e){let i=e.getSpineDisplay();i&&this.spineContainer.bringToTop(i)}hideAllSpines(){this.spineContainer.setActive(!1),this.spineContainer.setVisible(!1)}showAllSpines(){this.spineContainer.setActive(!0),this.spineContainer.setVisible(!0)}},YX=kg;var Gg=class{scene;constructor(e){this.scene=e}},Ki=Gg;var qg=class extends Ki{constructor(e){super(e),this.scene.stopManager(),q.setVolumeMusic(0,!0)}ready(){}play(){}levelComplete(){}levelFail(){}levelLoading(){let e=new xi(this.scene);this.scene.stateManager.changeStateTo(e)}quit(){}update(){}},Ys=qg;var{event:HX}=codex,{Events:zX}=Ludex,Wg=class t{static screens={};static _instance;static timeoutEvent;static get inst(){return this._instance||(this._instance=new t),this._instance}static addScreen(e,i){this.screens[e]=i}static getScreen(e){return this.screens[e]||null}static openScreen(e,i){HX.emit(zX.OPEN_SCREEN,{screenName:e,screenData:i})}static closeScreen(e){HX.emit(zX.CLOSE_SCREEN,{screenName:e})}static showLoadingScreen(){this.openScreen(O.LOADING_SCREEN)}static closeLoadingScreen(){this.closeScreen(O.LOADING_SCREEN)}static showNotificationScreen(e){this.openScreen(O.NOTIFY_SCREEN,e)}static closeNotificationScreen(){this.closeScreen(O.NOTIFY_SCREEN)}static showLoadingNotificationScreen(){this.openScreen(O.NOTIFY_SCREEN,{message:"Loading",loading:!0,enableCloseOnTouch:!1})}static listenResizeEventForCalculateLight(e){window.addEventListener("resize",()=>this.updateLightPosition(e))}static removeResizeEventForCalculateLight(e){window.removeEventListener("resize",()=>this.updateLightPosition(e))}static updateLightPosition=e=>{this.timeoutEvent&&clearTimeout(this.timeoutEvent),this.timeoutEvent=setTimeout(()=>{e.recalculateLightPosition()},500)}},k=Wg;var Yg=class extends Error{code;constructor(e,i){super(i),this.code=e}},VX=Yg;var Hh=class extends VX{playerId;tournamentId;constructor(e,i){super("PLAYER_HAS_TOURNAMENT","Player has a tournament"),this.playerId=e,this.tournamentId=i}};var Hg=class t{static _instance;static get inst(){return this._instance||(this._instance=new t),this._instance}static get isShareAvailable(){let e="shareAsync"in GameSDK.extra,i=GameSDK.getSDKName()==="Ludex";return e||i}static get isInviteAvailable(){let e="inviteAsync"in GameSDK.extra,i=GameSDK.getSDKName()==="Ludex";return e||i}},XX=Hg;var{missions:vo,storage:zh,player:KX}=codex,zg=class t{static _instance;static finishedMissionCountTracker=null;static get inst(){return this._instance||(this._instance=new t),this._instance}static addGameMissions(){this.removeDefaultMissions();let e=this.filterExistingMissions();for(let i of e)this.addMission(i)}static removeDefaultMissions(){vo.removeMission("finish-level")}static filterExistingMissions(){return[]}static getAllMissions(){let e=zh.getStorageData("missions","tasks")??[];return this.removeUnusedMissions$(e)}static removeUnusedMissions$(e){let i=["finish-level"],{isInviteAvailable:s,isShareAvailable:r}=XX;s||i.push("invite-friend-1","invite-friend-weekly"),r||i.push("share-score-1");let n=[];for(let a of e)i.includes(a.id)||n.push(a);return n}static getAllProcessLogs(){let e=zh.getStorageData("missions","process")??{};return delete e["finish-level"],e}static getGenericExpirationTime(){let e=this.getAllMissions();if(e.length===0)return-1;let i=e[0],{expirationTime:s,duration:r}=i;return s||Date.now()+r}static getMissionById(e){return this.getAllMissions().find(s=>s.id===e)}static getProcessLogById(e){return this.getAllProcessLogs()[e]}static addMission(e){vo.addMission(e)}static removeMission(e){vo.removeMission(e)}static addMissionProgress(e,i,s){vo.addMissionValue({id:e,type:i,value:s});let r=this.checkForFinishedMissions(),n={isMissionFinished:!1};return this.finishedMissionCountTracker=r,n}static setMissionRewardClaimed(e){vo.setMissionRewardClaimed(e)}static addFinishLevelMissionProgress(e){return this.addMissionProgress("finish-level","level",e)}static addMatchPairsMissionProgress(e){return this.addMissionProgress("match-pairs","pairs",e)}static addUseBombDefuseMissionProgress(e){return this.addMissionProgress("bomb-defuse","defuse",e)}static addUseRocketMissionProgress(e){return this.addMissionProgress("rocket","rocket",e)}static addUseShuffleMissionProgress(e){return this.addMissionProgress("shuffle","shuffle",e)}static addUseHintMissionProgress(e){return this.addMissionProgress("hint","hint",e)}static addInviteFriendMissionProgress(e){return this.addMissionProgress("invite-friend","invite",e)}static addShareScoreMissionProgress(e){return this.addMissionProgress("share-score","share",e)}static addJoinTournamentMissionProgress(e){return this.addMissionProgress("join-tournament","tournament",e)}static resetMissions(){t.resetProcessLog(),t.resetPlayerMissionProcess(),zh.setStorageData("missions","tasks",[]),vo.requestMissions(),this.addDefaultMissions()}static resetProcessLog(){let e=this.getAllProcessLogs(),i=Object.keys(e);for(let s of i){let r=e[s],{require:n}=r,a=Object.keys(n);for(let o of a)n[o]=0;r.rewarded=!1}}static resetPlayerMissionProcess(){let e=KX.getPlayerDataByKey("missionsData");if(!e)return;let{process:i}=e,s=Object.keys(i);for(let r of s){let n=i[r],{require:a}=n,o=Object.keys(a);for(let h of o)a[h]=0;n.rewarded=!1}KX.setPlayerDataByName("missionsData",{process:i})}static addDefaultMissions(){}static getMissionProgressIcon(e){return""}static checkForClaimableMissions(){let e=this.getAllMissions(),i=this.getAllProcessLogs(),s=0;for(let r of e){if(r.expirationTime&&r.expirationTime<Date.now())continue;let n=i[r.id];if(n.rewarded)continue;let a=n.require,o=Object.keys(a);for(let h of o){let l=a[h],c=r.require[h];!c||l<c||s++}}return s}static checkForFinishedMissions(){let e=this.getAllMissions(),i=this.getAllProcessLogs(),s=0;for(let r of e){if(r.expirationTime&&r.expirationTime<Date.now())continue;let n=i[r.id];if(n.rewarded){s++;continue}let a=n.require,o=Object.keys(a);for(let h of o){let l=a[h],c=r.require[h];!c||l<c||s++}}return s}static initializeFinishedMissionCount(){let e=this.checkForFinishedMissions();this.finishedMissionCountTracker=e}static reduceAllMissionExpirationTime(){let e=this.getAllMissions();for(let i of e)i.expirationTime&&(i.expirationTime=i.expirationTime-1e3*60*60*24*2);zh.setStorageData("missions","tasks",e),zh.updateToWebStorage("missions")}},Vh=zg;var{Match:{Modes:Xh},Utils:{Object:kbe,Valid:gs,String:ZX,Decorator:We,Function:go,Time:Gbe},Plugins:{Analytics:{Events:qbe}}}=Ludex,{match:qt,player:ui,leaderboard:Wbe,analytics:Ybe}=codex,Sr=()=>{k.showLoadingNotificationScreen()},Hbe=async()=>{await Gbe.sleepAsync(0),k.closeNotificationScreen()},vs=t=>{if(Hbe(),t instanceof Error){let e="Something went wrong";gs.isDebugger()&&(e=t.message,console.warn("Error handled",t)),k.showNotificationScreen({message:e,duration:3e3})}},tt=class tt{static _instance;static get inst(){return this._instance||(this._instance=new tt),this._instance}static isMatchActive(){let e=this.getMatchState(),{status:i}=e;return i==="active"}static isMatchFinished(){let e=this.getMatchState(),{status:i}=e;return i==="finished"}static isSingleMode(){return this.getMatchMode()===Xh.SINGLE}static isChallengeMode(){return this.getMatchMode()===Xh.CHALLENGE_FRIEND}static isTournamentMode(){return this.getMatchMode()===Xh.TOURNAMENT}static isPlayerFinished(){let e=this.getMatchState(),{profiles:i={}}=e,s=ui.getPlayerId(),r=i[s];return r?r.finished??!1:!1}static getMatchPlayerScore(){let e=this.getMatchState(),{profiles:i={}}=e,s=ui.getPlayerId();return i[s]?.score??0}static getMatchMode(){let e=this.getMatchState();return gs.isString(e.mode)?e.mode:null}static getMatchState(){let e=qt.getMatchState();if(!e)throw new Error("Match state not found");return e}static getMatchCustomData(){let e=this.getMatchState();return gs.isObject(e.customData)?e.customData:null}static async setProfileMatchDataAsync(e){await qt.handler.setProfileData(e)}static async setMatchCustomDataAsync(e){await qt.handler.setMatchCustomData(e)}static async fetchMatchCustomDataAsync(){await qt.handler.getMatchCustomData()}static async setLeaderboardScoreAsync(e){await qt.handler.setLeaderboardScore(e)}static getMatchLevel(){let{level:e=2}=this.getMatchCustomData()??{};return e}static async startSingleModeAsync(){let e=ui.getPlayerId(),i=de.getLevelProgress();return await qt.strategy.start.processAsync({matchId:"local",playerId:e,gameMode:Xh.SINGLE,extraData:{level:i}}),!0}static async finishSingleModeAsync(){return await qt.strategy.finish.processAsync({setPlayerBestScore:!0,postGlobalLeaderboard:!0}),!0}static async autoChallengeModeAsync(){let e=await this.continueChallengeModeAsync();return!!(e||(k.closeNotificationScreen(),e=await this.startChallengeRandomOpponentAsync(),e)||(k.closeNotificationScreen(),e=await this.startChallengeChooseOpponentAsync(),e)||(k.closeNotificationScreen(),e=await this.joinChallengeModeAsync(),e))}static async startChallengeRandomOpponentAsync(){let e=ui.getConnectedPlayerIds(10,0),i=Math.floor(Math.random()*e.length),s=e[i];return!gs.isString(s)||gs.isEmpty(s)?!1:(Vh.addInviteFriendMissionProgress(1),this.startChallengeModeAsync(s))}static async startChallengeChooseOpponentAsync(){let e=ui.getPlayerId(),i=de.getLevelProgress(),s=Math.max(i,2),r=qt.context.choose.processAsync({playerId:e,fallbackSingleMode:!1,extraData:{level:s}}),[n,a]=await go.handleAsync(r);if(this.inst.isUserInputError(a))return!1;if(a)throw a;return Vh.addInviteFriendMissionProgress(1),!0}static async startChallengeModeAsync(e){let i=ui.getPlayerId(),s=de.getLevelProgress(),r=Math.max(s,2),n=qt.challenge.friend.processAsync({playerId:i,opponentId:e,extraData:{level:r}}),[a,o]=await go.handleAsync(n);if(this.inst.isUserInputError(o))return!1;if(o)throw o;return!0}static async joinChallengeModeAsync(){let{id:e,customData:i}=tt.getMatchState(),{playerId:s,opponentId:r}=i;if(!gs.isString(e))throw new Error("Invalid match id");if(!gs.isString(s))throw new Error("Invalid player id");if(!gs.isString(r))throw new Error("Invalid opponent id");let n=qt.challenge.join.processAsync({matchId:e,playerId:s,opponentId:r}),[a,o]=await go.handleAsync(n);if(this.inst.isUserInputError(o))return!1;if(o)throw o;return Vh.addInviteFriendMissionProgress(1),!0}static async continueChallengeModeAsync(){let{id:e,customData:i}=tt.getMatchState(),{playerId:s,opponentId:r}=i;if(!gs.isString(e))throw new Error("Invalid match id");if(!gs.isString(s))throw new Error("Invalid player id");if(!gs.isString(r))throw new Error("Invalid opponent id");let n=GameSDK.context.getID();if(!n)throw new Error("Cannot get contextId");let a=qt.challenge.continue.processAsync({matchId:e,contextId:n,playerId:s,opponentId:r}),[o,h]=await go.handleAsync(a);if(this.inst.isUserInputError(h))return!1;if(h)throw h;return Vh.addInviteFriendMissionProgress(1),!0}static async finishChallengeModeAsync(){let e=this.getMatchLevel();return await qt.challenge.finish.processAsync({extraData:{level:e}}),!0}static async joinTournamentAsync(e,i){let s=ui.getPlayerId();await this.setMatchCustomDataAsync({playerId:s,level:i,contextId:"SOLO"});let r=qt.tournament.join.processAsync({tournamentId:e,playerId:s}),[n,a]=await go.handleAsync(r);if(!a)return!0;if(this.inst.isUserInputError(a))return!1;throw a}static async continueTournamentAsync(){let e=ui.getPlayerId(),i=GameSDK.context.getID();return await qt.tournament.continue.processAsync({playerId:e,contextId:i}),!0}static async finishTournamentAsync(){let e=ui.getPlayerId(),i=ui.getBestScore();return await qt.tournament.finish.processAsync({playerId:e,bestScore:i}),!0}static async createTournamentAsync(){let e=!1,s=(await this.inst.getTournamentsAsync()).find(n=>{let a=JSON.parse(n.getPayload());return n.getTournamentType()==="DEFAULT"&&a.playerId===ui.getPlayerId()});if(s)throw new Hh(ui.getPlayerId(),s.getID());let r=this.inst.createTournamentPayload();try{await qt.tournament.create.processAsync(r);let{leaderboardId:n}=r;Wbe.addLeaderboard({name:n,type:"tournament",autoSortRank:!0,leaderboardId:n}),e=!0}catch(n){console.warn("processCreateTournament",n)}return e}static async shareTournamentAsync(e){let[i,s]=await go.handleAsync(GameSDK.tournament.shareAsync({score:e})),r=!s;if(Ybe.event(qbe.TOURNAMENT_SHARE,{success:r}),r)return!0;if(this.inst.isUserInputError(s))return!1;throw s}async getTournamentsAsync(){try{return await GameSDK.tournament.getTournamentsAsync()}catch(e){return console.error(e),[]}}createTournamentPayload(){let e=ZX.generateObjectId(),i=ui.getPlayerId(),s=tt.getMatchState(),{profiles:r={}}=s;return{score:r[i]?.score??0,playerId:i,mode:Xh.TOURNAMENT,name:this.createTournamentName(),leaderboardId:e,payload:{playerId:i,leaderboardId:e}}}createTournamentName(){let e=ui.getPlayer(),{name:i=null}=e;if(i){let s=i.substring(0,7),r=`${s.split(" ")[0]||s}'s Tournament`;return`${ZX.removeDiacritics(r)}`}return"Tournament"}isUserInputError(e){return e?!!(e instanceof Error&&(["dismissed","closed","refused"].some(s=>e.message.indexOf(s)!==-1)||kbe.hasOwn(e,"code")&&e.code==="USER_INPUT")):!1}static async handleMatchStartFlow(){let e=this.isSingleMode()&&this.isMatchFinished();(!this.getMatchMode()||e)&&await this.startSingleModeAsync()}};Bt([We.tryCatch()],tt,"setProfileMatchDataAsync",1),Bt([We.tryCatch()],tt,"setMatchCustomDataAsync",1),Bt([We.tryCatch()],tt,"fetchMatchCustomDataAsync",1),Bt([We.tryCatch()],tt,"setLeaderboardScoreAsync",1),Bt([We.tryCatch(vs),We.preStart(Sr)],tt,"startSingleModeAsync",1),Bt([We.tryCatch(vs)],tt,"finishSingleModeAsync",1),Bt([We.tryCatch(vs)],tt,"autoChallengeModeAsync",1),Bt([We.tryCatch(vs),We.preStart(Sr)],tt,"startChallengeChooseOpponentAsync",1),Bt([We.tryCatch(vs),We.preStart(Sr)],tt,"startChallengeModeAsync",1),Bt([We.tryCatch(vs),We.preStart(Sr)],tt,"joinChallengeModeAsync",1),Bt([We.tryCatch(vs),We.preStart(Sr)],tt,"continueChallengeModeAsync",1),Bt([We.tryCatch(vs),We.preStart(Sr)],tt,"finishChallengeModeAsync",1),Bt([We.tryCatch(vs),We.preStart(Sr)],tt,"joinTournamentAsync",1),Bt([We.tryCatch(vs),We.preStart(Sr)],tt,"continueTournamentAsync",1),Bt([We.tryCatch(vs),We.preStart(Sr)],tt,"finishTournamentAsync",1);var Vg=tt,Ci=Vg;var{Utils:{Array:jX,String:Xg},Plugins:{Analytics:{Events:Kn}}}=Ludex,Pc={BOSS_START:"boss_start",BOSS_END:"boss_end",TUTORIAL_STEP:"tutorial_step",EARN_UNIT:"earn_unit"},{analytics:wi}=codex,zbe=[O.LOADING_SCREEN,O.NOTIFY_SCREEN],Kg=class t{static _instance;static get inst(){return this._instance||(this._instance=new t),this._instance}static trackingPages=[];static trackCurrentPage(e,i){if(jX.has(zbe,e)||!i&&!jX.has(this.trackingPages,e))return;this.trackingPages=this.trackingPages.filter(r=>r!==e),i&&this.trackingPages.push(e);let s=this.getCurrentPage();wi.pageview(s)}static switchSceneTracking(){this.trackingPages=[];let e=this.getCurrentPage();wi.pageview(e)}static getCurrentPage(){return this.trackingPages.length>0?this.trackingPages[this.trackingPages.length-1]||"Unknown Page":W.getCurrentScene()?.scene.key||"Unknown Page"}static trackButtonClick(e){let i=this.getCurrentPage();wi.event(Kn.BUTTON_CLICK,{screen_name:i,button_name:e})}static trackItemUsage(e,i){wi.event(Kn.USE_ITEM,{active:i,item_name:e})}static logLevelStartAnalytics(){let{mode:e,customData:{level:i=1}}=Ci.getMatchState();wi.event(Kn.LEVEL_START,{level:i,level_name:`Level ${i.toString().padStart(5,"0")}`,game_mode:e?Xg.toUpperCamelCase(e):void 0})}static logLevelCompleteAnalytics(e){let{mode:i,customData:{level:s=1}}=Ci.getMatchState();wi.event(Kn.LEVEL_END,{level:s,score:0,success:!0,played_time:e,level_name:`Level ${s.toString().padStart(5,"0")}`,game_mode:i?Xg.toUpperCamelCase(i):void 0})}static logLevelFailAnalytics(e){let{mode:i,customData:{level:s=1}}=Ci.getMatchState();wi.event(Kn.LEVEL_END,{level:s,score:0,success:!1,played_time:e,level_name:`Level ${s.toString().padStart(5,"0")}`,game_mode:i?Xg.toUpperCamelCase(i):void 0})}static logBossStartAnalytics(e,i){wi.event(Pc.BOSS_START,{boss_level:e,current_level:`Level ${i.toString().padStart(5,"0")}`})}static logBossEndAnalytics(e,i,s){wi.event(Pc.BOSS_END,{boss_level:e,current_level:`Level ${i.toString().padStart(5,"0")}`,success:s})}static logEarnUnitAnalytics(e,i){wi.event(Pc.EARN_UNIT,{value:`${e.toLowerCase()}-lv${i}`})}static trackTutorialBegin(){wi.event(Kn.TUTORIAL_BEGIN)}static trackTutorialStep(e){wi.event(Pc.TUTORIAL_STEP,{step:e})}static trackTutorialComplete(){wi.event(Kn.TUTORIAL_COMPLETE)}},se=Kg;var{DelayFinishGame:Zg}=le,{Plugins:{Ads:{Types:{INTERSTITIAL:Vbe}}}}=Ludex,jg=class extends Ki{constructor(e){super(e);let{gameMode:i,levelManager:s,tutorialManager:r,powerManager:n}=this.scene,a=s.getCurrentLevelId(),o=this.scene.getPlayedTimeSeconds();n.forceReturnToNormalSpeed(),i===ne.BOSS&&se.logBossEndAnalytics(s.getPlayerBossLevel(),a,!1),i===ne.NORMAL&&se.logLevelFailAnalytics(o),q.playSound(J.LOSE_SOUND),this.scene.effectManger.playResultLoseAnimation(),ae.hideBannerAds(),this.scene.isBannerAdShowed=!1,this.handleMatchEnd(),r.isRunning()?this.handleTutorialCase():this.openResultScreen()}handleMatchEnd(){Ci.isSingleMode()&&Ci.finishSingleModeAsync()}openResultScreen(){let{gameMode:e}=this.scene,i=this.scene.coinManager.getTotalCoinsByAttack();this.scene.time.delayedCall(Zg,async()=>{this.scene.stopManager(),ae.isReadyAdShowable(Vbe)&&await ae.showInterstitialAdAsync(),k.openScreen(O.RESULT_SCREEN,{result:"lose",gameMode:e,coinRewarded:i})})}handleTutorialCase(){let{levelManager:e,coinManager:i,gameMode:s}=this.scene,r=e.getCurrentLevelId(),n=i.getTotalCoinsByAttack(),a=r===1?Zg*1.5:Zg;this.scene.time.delayedCall(a,async()=>{if(this.scene.stopManager(),r===1){Se.inst.addCoin(n),this.scene.prepareRound();return}k.openScreen(O.RESULT_SCREEN,{result:"lose",gameMode:s,coinRewarded:n})})}ready(){let e=new on(this.scene);this.scene.stateManager.changeStateTo(e)}play(){}levelFail(){}levelComplete(){}levelLoading(){let e=new xi(this.scene);this.scene.stateManager.changeStateTo(e)}quit(){let e=new Ys(this.scene);this.scene.stateManager.changeStateTo(e)}update(){}},_c=jg;var $g=class extends Ki{isLevelOver;constructor(e){super(e),this.isLevelOver=!1;let{fieldManager:i,unitManager:s,uiManager:r,spineManager:n,tutorialManager:a,effectManger:o,powerManager:h}=this.scene;this.scene.accessibilityManager.stop(),i.hidePlacementSquares(),n.sortSpineContainerByName(),o.stopRewardCurveAnimation(),s.savePlayerUnits(),s.setReadyAllUnits(),s.runChildUpdateGroups(!0),s.disableDragOnPlayerUnits(),r.showUIForPlayingState(),h.checkForSpeedSetting(),this.scene.isBannerAdShowed===!1&&!a.isRunning()&&(this.scene.isBannerAdShowed=!0,ae.showBannerAds()),q.setVolumeMusic(.04,!0)}ready(){let e=new on(this.scene);this.scene.stateManager.changeStateTo(e)}play(){}levelFail(){let e=new _c(this.scene);this.scene.stateManager.changeStateTo(e)}levelComplete(){let e=new Lc(this.scene);this.scene.stateManager.changeStateTo(e)}levelLoading(){let e=new xi(this.scene);this.scene.stateManager.changeStateTo(e)}quit(){let e=new Ys(this.scene);this.scene.stateManager.changeStateTo(e)}update(){if(this.isLevelOver)return;let{uiManager:e,spineManager:i}=this.scene,s=e.getCurrentEnemyHp()<=0,r=e.getCurrentPlayerHp()<=0;if(s){this.scene.gameOver("win"),this.isLevelOver=!0;return}if(r&&!s){this.scene.gameOver("lose"),this.isLevelOver=!0;return}i.update(!1)}},Ic=$g;var{Utils:{Device:Xbe}}=Ludex,Jg=class t extends Ki{constructor(e){super(e);let{uiManager:i,unitManager:s,coinManager:r,spineManager:n,levelManager:a,tutorialManager:o,difficultyManager:h,powerManager:l,gameMode:c}=this.scene;this.scene.initManager(),this.scene.startManager();let f=I.isGameWorldSmallerRatio(.575)||this.scene.gameMode===ne.BATTLE;!Xbe.isDesktop()&&f&&!o.isRunning()?(this.scene.isBannerAdShowed=!0,ae.showBannerAds()):this.scene.isBannerAdShowed=!1;let p=s.getPlayerUnits(),m=s.getEnemyUnits();n.addSpines([...m,...p]),s.enableDragOnPlayerUnits(),s.runChildUpdateGroups(!0);let v=a.getCurrentLevelId(),g=a.getModifierLevel(),S=a.getPlayerLevel();console.log("\u{1F916} ? currentLevelId",v),console.log("\u{1F916} ? modifierLevel",g),console.log("\u{1F916} ? playerLevel",S),r.setUnitModifier(S),r.setAttackModifier(g),h.updateCustomUnitModifierByLevel(S),h.updateCustomAttackModifierByLevel(g),c===ne.NORMAL&&this.scene.time.delayedCall(1e3,()=>{}),k.closeLoadingScreen(),this.scene.gameMode===ne.BATTLE||(this.scene.gameMode===ne.BOSS?(s.hideAllUnits(),this.scene.time.delayedCall(450,()=>{q.setVolumeMusic(.4,!0),i.showUIForReadyState(),this.scene.updateUI()})):(q.setVolumeMusic(.4,!0),i.showUIForReadyState(),this.scene.updateUI())),o.showTutorial(),l.syncSpeedSetting(),this.scene.handleStartOverFlow(),this.logLevelStart()}logLevelStart(){let{levelManager:e}=this.scene,i=this.scene.gameMode===ne.BOSS,s=e.getCurrentLevelId();if(i){se.logBossStartAnalytics(e.getPlayerBossLevel(),s);return}se.logLevelStartAnalytics()}ready(){if(this.scene.gameMode!==ne.BOSS)return;let e=new t(this.scene);this.scene.stateManager.changeStateTo(e)}play(){let e=new Ic(this.scene);this.scene.stateManager.changeStateTo(e)}levelFail(){}levelComplete(){}levelLoading(){let e=new xi(this.scene);this.scene.stateManager.changeStateTo(e)}quit(){let e=new Ys(this.scene);this.scene.stateManager.changeStateTo(e)}update(){this.scene.spineManager.update(!0)}},on=Jg;var $X=E(ss()),{player:Kbe}=codex,{Utils:{Valid:X3e}}=Ludex,Qg=class extends Ki{isRequesting=!1;constructor(e){super(e),this.run()}async run(){let{uiManager:e,layoutManager:i}=this.scene;this.scene.initGameMode(),i.layout.alignUI(),e.showUIForLevelLoadingState(),this.autoUpgradeUnitData();let s=this.getCurrentLevel();if(console.info("\u{1F680} > currentLevel",s),this.loadLevelsJson(),this.isRequesting){k.showLoadingScreen();let r=this.scene.scene.get(z.LOAD_SCENE);r.scene.wake(),r.load.once($X.COMPLETE,this.handleLoadComplete),r.load.start()}else this.scene.time.delayedCall(0,this.handleLoadComplete)}autoUpgradeUnitData(){let e=de.getPlayerUnitData();if(!e||typeof e!="string")return;let s=this.scene.scene.get(z.LOAD_SCENE).upgradePlayerUnits(e);s!==e&&Kbe.setGameData({playerUnitData:s})}handleLoadComplete=()=>{this.scene.prepareRound();let e=this.scene.scene.get(z.LOAD_SCENE);e.scene.sleep(),e.lazyLoadResource()};loadOpponentUnits(){}getCurrentLevel(){return de.getLevelProgress()}loadLevelsJson(){let e=this.getCurrentLevel();this.loadLevelJsonByLevel(e),this.reloadNextLevelJson(e)}reloadNextLevelJson(e){let i=e+1;i%100===0&&this.loadLevelJsonByLevel(i,!1)}loadLevelJsonByLevel(e,i=!0){let s=this.getJsonKey(e);if(this.scene.cache.json.exists(s))return;i&&(this.isRequesting=!0),this.scene.scene.get(z.LOAD_SCENE).load.json(s,`assets/json/${s}.json`)}getJsonKey(e){let i=Math.floor(e/100)*100+1,s=i+99,r=(1e4+i).toString().substring(1),n=(1e4+s).toString().substring(1);return`levels-${r}-${n}`}ready(){let e=new on(this.scene);this.scene.stateManager.changeStateTo(e)}play(){}levelFail(){}levelComplete(){}levelLoading(){}quit(){let e=new Ys(this.scene);this.scene.stateManager.changeStateTo(e)}update(){}},xi=Qg;var{DelayFinishGame:JX,MaxLevel:Zbe}=le,{Plugins:{Ads:{Types:{INTERSTITIAL:jbe}}}}=Ludex,{player:$be}=codex,eS=class extends Ki{constructor(e){super(e);let{gameMode:i,levelManager:s,tutorialManager:r,powerManager:n}=this.scene;n.forceReturnToNormalSpeed();let a=s.getCurrentLevelId(),o=a>=Zbe,h=this.scene.getPlayedTimeSeconds();i===ne.NORMAL&&!o&&(s.updateHighestCurrentLevel(),this.scene.updateLevelToLeaderboard(a),se.logLevelCompleteAnalytics(h)),i===ne.BOSS&&(se.logBossEndAnalytics(s.getPlayerBossLevel(),a,!0),s.updateHighestCurrentBossLevel()),q.playSound(J.WIN_BATTLE),this.scene.effectManger.playResultWinAnimation(),o&&this.setPlayerEligibleForReset(),ae.hideBannerAds(),this.scene.isBannerAdShowed=!1,this.handleMatchEnd(),r.isRunning()?this.handleTutorialCase():this.openResultScreen()}handleMatchEnd(){Ci.isSingleMode()&&Ci.finishSingleModeAsync()}openResultScreen(){let{coinManager:e,gameMode:i}=this.scene,s=e.getRewardCoinsByAttackCoins(),r=JX;this.scene.time.delayedCall(r,async()=>{this.scene.stopManager(),ae.isReadyAdShowable(jbe)&&await ae.showInterstitialAdAsync(),k.openScreen(O.RESULT_SCREEN,{result:"win",gameMode:i,coinRewarded:s})})}handleTutorialCase(){let{levelManager:e,coinManager:i,gameMode:s}=this.scene;e.getCurrentLevelId()===1&&se.trackTutorialStep(5);let n=i.getRewardCoinsByAttackCoins();this.scene.time.delayedCall(JX,async()=>{this.scene.stopManager(),k.openScreen(O.RESULT_SCREEN,{result:"win",gameMode:s,coinRewarded:n})})}setPlayerEligibleForReset(){$be.setGameData({isEligibleForReset:!0})}ready(){}play(){}levelFail(){}levelComplete(){}levelLoading(){let e=new xi(this.scene);this.scene.stateManager.changeStateTo(e)}quit(){let e=new Ys(this.scene);this.scene.stateManager.changeStateTo(e)}update(){}},Lc=eS;var tS=class{scene;currentState;constructor(e){this.scene=e}init(){this.currentState||(this.currentState=new xi(this.scene)),this.currentState.levelLoading()}changeStateTo(e){this.currentState=e}isInReadyState(){return this.currentState instanceof on}isInPlayingState(){return this.currentState instanceof Ic}isInLevelLoadingState(){return this.currentState instanceof xi}isInLevelFailState(){return this.currentState instanceof _c}isInLevelCompleteState(){return this.currentState instanceof Lc}ready(){this.currentState.ready()}play(){this.currentState.play()}levelFail(){this.currentState.levelFail()}levelComplete(){this.currentState.levelComplete()}levelLoading(){this.currentState.levelLoading()}quit(){this.currentState.quit()}update(){this.currentState.update()}},QX=tS;var e3=E(he()),Jbe={duration:600,ease:e3.Quadratic.Out,props:{alpha:{start:1,from:1,to:0}}},Mc=Jbe;var t3=E(X());var i3=E(nt()),s3=E(ie()),iS=class extends t3.Container{scene;id;isActive;isDisabled;zone;icon;constructor(e,i,s,r,n,a){super(e),this.id=i,this.scene=e,this.createIcon(s,r,n,a),this.setWorldSize(n,a),this.createInput(),this.setDepth(B.ITEM),this.scene.add.existing(this)}activeItem=()=>{if(this.isActive===!0||this.isDisabled===!0)return;this.isActive=!0,this.icon.setTint(2927998);let{powerManager:e}=this.scene;e.isStopped()||(q.playSound(J.BUTTON_CLICK),this.activeLogic())};deactivateItem=()=>{if(this.isActive===!1)return;this.isActive=!1,this.icon.setTint(3487029);let{powerManager:e}=this.scene;e.isStopped()||this.deactivateLogic()};enableItem(){this.isDisabled!==!1&&(this.icon.setAlpha(1),this.isDisabled=!1)}disableItem(){this.isDisabled!==!0&&(this.deactivateItem(),this.icon.setAlpha(.4),this.isDisabled=!0)}createIcon(e,i,s,r){this.icon=this.scene.make.image({key:e,frame:i},!1),this.icon.setWorldSize(s,r),this.add(this.icon)}createInput(){let{displayWidth:e,displayHeight:i}=this.icon;this.zone=this.scene.make.zone({width:e,height:i}),this.add(this.zone),s3.Align.In.Center(this.zone,this.icon),this.zone.setInteractive({useHandCursor:!0}),this.zone.on(i3.GAMEOBJECT_POINTER_UP,this.handleOnClick)}handleOnClick=()=>{this.logItemEvent();let{powerManager:e}=this.scene;e.activeItem(this.id)};logItemEvent(){se.trackButtonClick(this.name),se.trackItemUsage(this.id,this.isActive)}},Oc=iS;var a3=E(ie()),{KEY:sS,FRAME:rS}=T.GAMEPLAY,{ID:Qbe}=mo.SPEED_UP,{player:r3,language:n3}=codex,nS=class extends Oc{scene;isSpeedUp;speedText;constructor(e){super(e,Qbe,sS,rS.DASHBOARD_SPEED_BTN_OFF,34,38.5),this.scene=e,this.isSpeedUp=!1,this.setName("SpeedUpItem"),this.createSpeedText()}enableItem(){this.isDisabled!==!1&&(this.isDisabled=!1,this.zone.setInteractive())}activeItem=()=>{if(this.isActive===!0||this.isDisabled===!0)return;this.isActive=!0;let{powerManager:e}=this.scene;e.isStopped()||(q.playSound(J.BUTTON_CLICK),this.activeLogic())};activeLogic(){let{stateManager:e}=this.scene;!e.isInPlayingState()&&!e.isInReadyState()||(this.isSpeedUp?this.returnToNormalSpeed():this.speedUpGameplay())}disableItem(){this.isDisabled!==!0&&(this.zone.disableInteractive(),this.isDisabled=!0)}deactivateItem=()=>{if(this.isActive===!1)return;this.isActive=!1;let{powerManager:e}=this.scene;e.isStopped()||this.deactivateLogic()};deactivateLogic(){}speedUpGameplay(){this.icon.setTexture(sS,rS.DASHBOARD_SPEED_BTN_ON),this.isSpeedUp=!0,r3.setSetting("speedUp",!0);let{stateManager:e}=this.scene;e.isInPlayingState()&&this.scene.unitManager.speedUpAllUnits()}returnToNormalSpeed(){this.icon.setTexture(sS,rS.DASHBOARD_SPEED_BTN_OFF),this.isSpeedUp=!1,r3.setSetting("speedUp",!1);let{stateManager:e}=this.scene;e.isInPlayingState()&&this.scene.unitManager.resetSpeedAllUnits()}createSpeedText(){let e=n3.getCurrentLocale(),i=11;if(!I.isLandscape())switch(e){case"ru":case"ja":i=7;break;case"pt":case"es":case"it":i=9;break}this.speedText=P.buildText(n3.getText("SPEED").toUpperCase(),i).setDefaultStroke().build(this.scene),this.add(this.speedText),this.bringToTop(this.speedText);let s=I.isLandscape()?15:-2;a3.Align.In.BottomCenter(this.speedText,this.icon,0,s)}},aS=nS;var l3=E(he());var{MaximumMeleeLevel:o3,MaximumRangedLevel:h3}=le,{Utils:{Valid:e0e,Signal:t0e}}=Ludex,{event:i0e}=codex,oS=class extends xe{scene;hideUIAnimController=new t0e.SignalController;constructor(e){super(e),this.scene=e,this.initUILogic()}start(){this.isRunning()||(super.start(),this.updateUIData())}updateUIData=()=>{this.updateCoinBar(),this.updateUnitBarUI(),this.updateTotalHpBar()};initUILogic(){let{layoutManager:e,devToolManager:i}=this.scene,{objects:s}=e;s.startButton.onClick=this.startFight,s.settingsButton.onClick=()=>{k.openScreen(O.SETTINGS_SCREEN)},e0e.isDebugger()&&(s.resetLevelButton.onClick=this.scene.resetLevel,s.selectLevelButton.onClick=i.handleShowLoadMapInput,s.currentUnitModButton.onClick=i.handleShowModUnitInput,s.currentAttackModButton.onClick=i.handleShowModAttackInput),i0e.on(we.COINS_CHANGED,this.updateWhenReceivedCoin)}updateWhenReceivedCoin=()=>{let{tutorialManager:e,layoutManager:i}=this.scene,s=Se.inst.getCoin();i.objects.coinBar.setCoins(s),e.isRunning()?e.reupdateGuideUI():this.updateUnitBarUI()};updateCoinBar(){let{layoutManager:e}=this.scene,{objects:i}=e,s=Se.inst.getCoin();i.coinBar.setCoins(s)}updateUnitBarUI(){let{unitManager:e,coinManager:i,layoutManager:s}=this.scene,r=Se.inst.getCoin(),{objects:n}=s,a=e.getPlayerMeleeSpawnedUnitsCount(),o=i.getUnitPrice(a);n.unitBar.setMeleePrice(o);let h=r.toString(),l=o.toString();n.unitBar.enableMeleeBlock();let c=o.biggerThan(r)&&h!==l;n.unitBar.setMeleeAdsMode(c);let d=e.getPlayerRangedSpawnedUnitsCount(),f=i.getUnitPrice(d);n.unitBar.setRangedPrice(f);let p=f.toString();n.unitBar.enableRangedBlock();let m=f.biggerThan(r)&&h!==p;n.unitBar.setRangedAdsMode(m),this.handleLastSquareCase()}handleLastSquareCase(){let{fieldManager:e,unitManager:i,layoutManager:s}=this.scene;if(e.getRemainingAvailablePlacement()!==1)return;let{objects:r}=s,n=i.getLowestLevelPlayerMeleeUnit(),a=i.getLowestLevelPlayerRangedUnit();n===o3&&a!==h3&&r.unitBar.disableMeleeBlock(),a===h3&&n!==o3&&r.unitBar.disableRangedBlock()}updateTotalHpBar(){let{layoutManager:e}=this.scene,{objects:i}=e;i.totalHpBar.setAlpha(1),i.totalHpBar.updateCurrentHp()}setTotalHpBar(e,i){let{objects:s}=this.scene.layoutManager;i?s.totalHpBar.updatePlayerHpUIByMinus(e):s.totalHpBar.updateEnemyHpUIByMinus(e)}startFight=()=>{let{objects:e}=this.scene.layoutManager,i=this.getAllPowerItems(),s=[...i,e.unitBar,e.levelBar,e.startButton,e.battleLevelBar],r=i.findIndex(a=>a instanceof aS);r!==-1&&s.splice(r,1);let n=this.hideUIAnimController.renew();H.runTween(this.scene.tweens.add({...Mc,paused:!0,targets:s,duration:300,onActive:()=>{this.scene.input.enabled=!1},ease:l3.Circular.Out,onComplete:()=>{for(let a of s)a.setAlpha(1);for(let a of i)a instanceof aS||a.disableItem();this.scene.startRound(),this.scene.input.enabled=!0}}),n)};getCurrentEnemyHp(){let{objects:e}=this.scene.layoutManager;return e.totalHpBar.getCurrentEnemyHp()}getCurrentPlayerHp(){let{objects:e}=this.scene.layoutManager;return e.totalHpBar.getCurrentPlayerHp()}getAllPowerItems(){return this.scene.powerManager.getAllItems()}disableUnitBlocks(){let{objects:e}=this.scene.layoutManager;e.unitBar.disableUnitBlocks()}disableAdsUnitBlocks(){let{objects:e}=this.scene.layoutManager;e.unitBar.disableAdsForBlocks()}enableStartButton(){let{objects:e}=this.scene.layoutManager;e.startButton.setDisabled(!1)}isStartButtonDisabled(){let{objects:e}=this.scene.layoutManager;return e.startButton.isDisabled}runUnitBtnAnim(){let{objects:e}=this.scene.layoutManager}showUIForLevelLoadingState(){let{groups:e}=this.scene.layoutManager;e.allUI.killGroup(),e.levelLoadingStateUI.reviveGroup()}showUIForReadyState(){let{gameMode:e}=this.scene,{levelManager:i,layoutManager:s}=this.scene,{groups:r,objects:n}=s;if(r.allUI.killGroup(),e===ne.NORMAL||e===ne.BOSS){let a=i.getCurrentLevelId();n.levelBar.setLevel(a),r.normalPlayingStateUI.killGroup(),e===ne.BOSS?r.bossReadyStateUI.reviveGroup():r.normalReadyStateUI.reviveGroup()}this.updateUIData()}showUIForPlayingState(){let{gameMode:e,layoutManager:i}=this.scene,{groups:s}=i;(e===ne.NORMAL||e===ne.BOSS)&&(e===ne.BOSS?s.bossReadyStateUI.killGroup():s.normalReadyStateUI.killGroup(),s.normalPlayingStateUI.reviveGroup()),e===ne.BATTLE&&(s.battleReadyStateUI.killGroup(),s.battlePlayingStateUI.reviveGroup()),this.updateUIData()}showUIForGuide1(){let{layoutManager:e}=this.scene,{groups:i,objects:s}=e;i.allUI.killGroup(),i.guideStateUI.reviveGroup(),s.unitBar.kill()}showUIForGuide2(e){let{layoutManager:i}=this.scene,{groups:s,objects:r}=i;r.unitBar.killBg(),e===1?(s.allUI.killGroup(),s.guideStateUI.reviveGroup(),r.startButton.kill(),this.updateCoinBar(),this.updateUnitBarUI(),r.unitBar.killMeleeBlock(),r.unitBar.setDepth(B.TUTORIAL_OBJECT)):e===2?(r.unitBar.reviveMeleeBlock(),r.unitBar.kill(),r.unitBar.setDepth(B.BUTTON)):e===3&&(s.allUI.killGroup(),s.guideStateUI.reviveGroup(),r.unitBar.kill(),r.startButton.revive())}showUIForGuidePrevent(){let{layoutManager:e}=this.scene,{groups:i,objects:s}=e;i.allUI.killGroup(),i.guideStateUI.reviveGroup(),s.unitBar.kill()}showUIForGuide3(e){let{layoutManager:i}=this.scene,{groups:s,objects:r}=i;if(r.unitBar.killBg(),e===1){let{accessibilityManager:n}=this.scene;n.stop(),s.allUI.killGroup(),s.guideStateUI.reviveGroup(),r.startButton.kill(),this.updateCoinBar(),this.updateUnitBarUI(),r.unitBar.killRangedBlock(),r.unitBar.setDepth(B.TUTORIAL_OBJECT)}else if(e===2){let{accessibilityManager:n}=this.scene;n.stop(),s.allUI.killGroup(),s.guideStateUI.reviveGroup(),r.startButton.kill(),r.unitBar.reviveRangedBlock(),r.unitBar.kill(),r.unitBar.setDepth(B.BUTTON)}else e===3&&(s.allUI.killGroup(),s.guideStateUI.reviveGroup(),r.unitBar.kill(),r.startButton.revive())}addOnceCallbackForMeleeBlock(e){let{objects:i}=this.scene.layoutManager;i.unitBar.addOnceClickEventForMeleeBlock(e)}addOnceCallbackForRangedBlock(e){let{objects:i}=this.scene.layoutManager;i.unitBar.addOnceClickEventForRangedBlock(e)}addOnceCallbackForStartBtn(e){let{objects:i}=this.scene.layoutManager;i.startButton.onClick=e}getMeleeBlockWorldPosition(){let e=this.getMeleeBlockConfig();return{x:e.worldX,y:e.worldY}}getRangedBlockWorldPosition(){let e=this.getRangedBlockConfig();return{x:e.worldX,y:e.worldY}}getMeleeBlockConfig(){let{objects:e}=this.scene.layoutManager;return e.unitBar.getMeleeBlockConfig()}getRangedBlockConfig(){let{objects:e}=this.scene.layoutManager;return e.unitBar.getRangedBlockConfig()}getStartBtnWorldPosition(){let{objects:e}=this.scene.layoutManager;return e.startButton.getWorldPosition()}},u3=oS;var hS=class extends Error{constructor(){super("NoUnitFound"),this.name="NoUnitFound"}},Mt=hS;var{Utils:{Browser:s0e}}=Ludex,{player:r0e}=codex,lS=class t{static _instance;static vibrationProfiles={default:[100]};static get inst(){return this._instance||(this._instance=new t),this._instance}static addVibrationProfile(e,i){this.vibrationProfiles[e]=i}static vibrate(e){this.isVibrateEnable()&&this.handleVibrate(e)}static vibrateUsingProfile(e){if(!this.isVibrateEnable())return;let i=this.vibrationProfiles[e];i||(console.warn(`Vibration profile ${e} not found. Using default profile.`),i=this.vibrationProfiles.default),this.handleVibrate(i)}static handleVibrate(e){if(!s0e.vibrate(e)){if("performHapticFeedbackAsync"in GameSDK.extra){this.useFBInstantHapticFeedback(e);return}console.warn("Vibrate failed")}}static async useFBInstantHapticFeedback(e){if(!("performHapticFeedbackAsync"in GameSDK.extra))return;let{Time:i}=Ludex.Utils,s=async()=>{try{"performHapticFeedbackAsync"in GameSDK.extra&&await GameSDK.extra.performHapticFeedbackAsync()}catch(r){console.error(r)}};if(Array.isArray(e)){for(let r=0;r<e.length;r++){let n=e[r];r%2===0&&await s(),await i.sleepAsync(n)}return}await s()}static isVibrateEnable(){return this.isSupportVibrateApi()?!!r0e.getPlayerSetting("vibrate"):!1}static isSupportVibrateApi(){let e="vibrate"in window.navigator;if(e)try{window.navigator.vibrate(0)}catch{return!1}return e}},Wt=lS;var n0e={PREPARE:"prepare",READY:"ready",MOVING_TO_TARGET:"movingToTarget",PREPARE_TO_ATTACK:"prepareToAttack",ATTACKING:"attacking",FINISHED_ATTACKING:"finishedAttacking",KILLED:"killed"},Ce=n0e;var Er=E(ve()),uS=class{unit;attackSpots;attackTarget;beingAttackedByMelee;beingAttackedByRanged;attackSpotPairings;constructor(e){this.unit=e,this.attackSpots=[],this.attackSpotPairings=[]}reset(){this.resetAttackSpots(),this.resetAttackTarget(),this.beingAttackedByMelee=null,this.beingAttackedByRanged=null}createAttackSpots(){let{x:e,y:i}=this.unit,{MELEE_ATTACK_RANGE:s}=L;for(let r=0;r<=8;r++)if(r===0){let n=new Er.Vector2(e+s,i),a=new Er.Vector2(e-s,i);this.attackSpots.push({location:n,occupiedUnit:null}),this.attackSpots.push({location:a,occupiedUnit:null});let o=this.attackSpots.length-1;this.attackSpotPairings.push({a:o-1,b:o})}else{let n=(0,Er.DegToRad)(r*20/4),a=new Er.Vector2(e+s*Math.cos(n),i+s*Math.sin(n)),o=new Er.Vector2(e-s*Math.cos(n),i+s*Math.sin(n)),h=new Er.Vector2(e+s*Math.cos(n),i-s*Math.sin(n)),l=new Er.Vector2(e-s*Math.cos(n),i-s*Math.sin(n));this.attackSpots.push({location:a,occupiedUnit:null}),this.attackSpots.push({location:o,occupiedUnit:null}),this.attackSpots.push({location:h,occupiedUnit:null}),this.attackSpots.push({location:l,occupiedUnit:null});let c=this.attackSpots.length-1;this.attackSpotPairings.push({a:c-3,b:c}),this.attackSpotPairings.push({a:c-2,b:c-1})}}assignAttackingUnit(e){if(this.attackTarget===e){let o=-1;for(let[h,l]of e.attackController.attackSpots.entries())if(l.occupiedUnit===this.unit&&o===-1){o=h;break}if(o!==-1){let h=this.attackSpotPairings.find(l=>l.a===o||l.b===o);if(h){let l=h.a===o?h.b:h.a;return this.attackSpots[l]}}}let i,s=this.attackSpots.filter(o=>{let h=o.occupiedUnit===null||o.occupiedUnit===e,l=!0;o.occupiedUnit===e&&(i=o);let{gameZone:c}=this.unit.scene;return this.unit.x<c.displayWidth/5&&(l=o.location.x>this.unit.x),this.unit.x>c.displayWidth-c.displayWidth/5&&(l=o.location.x<this.unit.x),h&&l});if(s.length===0)return null;let{x:r,y:n}=e,a=s.reduce((o,h)=>{let{x:l,y:c}=h.location,{x:d,y:f}=o.location,p=Math.sqrt((l-r)**2+(c-n)**2),m=Math.sqrt((d-r)**2+(f-n)**2);return p<m?h:o},s[0]);return i&&i!==a&&(i.occupiedUnit=null),a.occupiedUnit=e,a}clearAttackingUnit(e){for(let i of this.attackSpots)i.occupiedUnit===e&&(i.occupiedUnit=null)}moveAttackSpotMelee(e,i){for(let s of this.attackSpots){let{x:r,y:n}=s.location;s.location.set(r+e,n+i)}}checkForInvalidOccupiedUnits(){for(let e of this.attackSpots)e.occupiedUnit?.isKilled()&&(e.occupiedUnit=null)}resetAttackSpots(){this.attackSpots=[],this.createAttackSpots()}resetAttackSpotOfUnit(e){for(let i of this.attackSpots)i.occupiedUnit===e&&(i.occupiedUnit=null)}getAttackTarget(){return this.attackTarget}setAttackTarget(e){this.attackTarget=e}notifyTargetAttacked(e){e.unitType===L.MELEE_UNIT_TYPE?this.beingAttackedByMelee=e:e.unitType===L.RANGED_UNIT_TYPE&&(this.beingAttackedByRanged=e)}resetAttackTarget(){this.attackTarget=null}},c3=uS;var{MANAGER_BASE_DEPTH:d3}=B,cS=class{unit;scene;constructor(e){this.unit=e,this.scene=e.scene}calculateDepth(){let{y:e,currentLocation:i=null}=this.unit,{height:s}=this.scene.fieldManager.firstHightLineZone,r=e+s/4,n=0;i&&this.unit.isInPrepareMode()&&(n=i.colId);let{fieldBackground:a}=this.scene.fieldManager,o=a.getTopLeft().y,h=a.displayHeight/100,l=-n;return d3+(Math.floor((r-o)/h)+l)*.4}setDepthOnDeath(){this.unit.isDepthDirty=!1;let e=this.calculateDepth()-.2;this.unit.setDepth(e)}getProjectileDepth(){return d3+41}},f3=cS;var dS=class{unit;scene;constructor(e){this.unit=e,this.scene=e.scene}getAttackTarget(){let{unitType:e}=this.unit;switch(e){case L.MELEE_UNIT_TYPE:return this.getAttackTargetForMeleeUnit();case L.RANGED_UNIT_TYPE:return this.getAttackTargetForRangedUnit();default:return null}}getAttackTargetForMeleeUnit(){let{x:e,y:i,isPlayer:s}=this.unit;if(this.unit.isKilled())return null;let{enemyUnits:r,playerUnits:n}=this.scene.unitManager,o=(s?r:n).getChildren().filter(v=>v instanceof K?!v.isKilled():!1);switch(o.length){case 0:return null;case 1:return o[0];default:break}let h=1e4,l=o.sort((v,g)=>{let{x:S,y}=v,{x:b,y:x}=g,A=Math.sqrt(Math.pow(S-e,2)+Math.pow(y-i,2)),w=Math.sqrt(Math.pow(b-e,2)+Math.pow(x-i,2));return h=Math.min(h,A),h=Math.min(h,w),A-w}),c=[l[0]];for(let v=1;v<l.length;v++){let g=l[v],{x:S,y}=g;if(Math.sqrt(Math.pow(S-e,2)+Math.pow(y-i,2))!==h)break;c.push(g)}switch(c.length){case 1:return c[0];default:break}let d=c[0].currentHp,f=c.sort((v,g)=>(d=Math.min(d,v.currentHp),d=Math.min(d,g.currentHp),v.currentHp-g.currentHp)),p=[f[0]];for(let v=1;v<f.length;v++){let g=f[v];if(g.currentHp!==d)break;p.push(g)}switch(p.length){case 1:return p[0];default:break}return p.sort((v,g)=>g.attackPower-v.attackPower)[0]}getAttackTargetForRangedUnit(){let{x:e,y:i,isPlayer:s}=this.unit;if(this.unit.isKilled())return null;let{enemyUnits:r,playerUnits:n}=this.scene.unitManager,o=(s?r:n).getChildren().filter(v=>v instanceof K?!v.isKilled():!1);switch(o.length){case 0:return null;case 1:return o[0];default:break}let h=1e4,l=o.sort((v,g)=>{let{x:S,y}=v,{x:b,y:x}=g,A=Math.sqrt(Math.pow(S-e,2)+Math.pow(y-i,2)),w=Math.sqrt(Math.pow(b-e,2)+Math.pow(x-i,2));return h=Math.min(h,A),h=Math.min(h,w),A-w}),c=[l[0]];for(let v=1;v<l.length;v++){let g=l[v],{x:S,y}=g;if(Math.sqrt(Math.pow(S-e,2)+Math.pow(y-i,2))!==h)break;c.push(g)}switch(c.length){case 1:return c[0];default:break}let d=c[0].currentHp,f=c.sort((v,g)=>(d=Math.min(d,v.currentHp),d=Math.min(d,g.currentHp),v.currentHp-g.currentHp)),p=[f[0]];for(let v=1;v<f.length;v++){let g=f[v];if(g.currentHp!==d)break;p.push(g)}switch(p.length){case 1:return p[0];default:break}return p.sort((v,g)=>v.attackPower-g.attackPower)[0]}},Kh=dS;var L3=E(ES()),TS=class{unit;scene;tween;constructor(e){this.unit=e,this.scene=e.scene}createTween(){this.tween?.remove(),this.tween=this.scene.tweens.addCounter({from:0,to:100,duration:200,onStart:()=>{this.unit.display.clearTint()},onUpdate:e=>{let i=e.getValue(),s=Math.floor(255/100*i),r=Math.floor(255/100*i),n=(0,L3.GetColor)(255,r,s);this.unit.display.setTint(n)},onComplete:()=>{this.unit.display.clearTint()}})}run(){this.createTween()}stop(){this.tween?.remove(),this.unit.display.clearTint()}},M3=TS;var F3=E(Fc()),P0e=(0,F3.default)(0,1.9,.42,1.9),k3=P0e;var G3=E(ve()),jh=E(he()),yS=class{unit;scene;currentTotalNumber;constructor(e){this.unit=e,this.scene=e.scene,this.currentTotalNumber=new be(0)}increaseNumberStack(e){this.currentTotalNumber.baseValue===0&&this.scene.time.delayedCall(150,this.handleShowEffect),this.currentTotalNumber.add(e)}handleShowEffect=()=>{this.createFloatingText(this.currentTotalNumber),this.currentTotalNumber=new be(0)};createFloatingText(e){let s=this.getText(e),{effectManger:r}=this.scene,n=r.getTextEffectObject();n.revive(),n.setText(s),n.setFontSize(14),n.setPosition(this.unit.x,this.unit.y),this.scene.add.tween({targets:n,props:{alpha:{from:0,duration:100,ease:jh.Expo.Out,to:1}},onComplete:()=>{let{displayHeight:a}=this.unit.display;n.setTint(16753920);let h=this.unit.display.isSpine()?this.unit.y-a/2:this.unit.y,l=G3.RND.between(-1,1)<0?this.unit.x-50:this.unit.x+50;this.scene.add.tween({targets:n,props:{alpha:{from:1,duration:300,ease:jh.Expo.Out,to:0,delay:700},x:{from:this.unit.x,duration:1e3,ease:jh.Linear,to:l},y:{from:h,duration:1e3,ease:k3,to:h-15}},onComplete:()=>{n.setAlpha(1),n.kill()}})}})}getText(e){return`${e.toString()}`}},q3=yS;var bS=class extends q3{handleShowEffect=()=>{this.createFloatingText(this.currentTotalNumber),Se.inst.addCoin(this.currentTotalNumber);let e=Se.inst.getCoin(),{objects:i}=this.scene.layoutManager;i.coinBar.setCoins(e),this.currentTotalNumber=new be(0)};getText(e){return`$${e.toString()}`}},W3=bS;var Y3=E(he()),AS=class{unit;scene;tween;constructor(e){this.unit=e,this.scene=e.scene}createTween(){if(this.tween?.remove(),!this.unit.isKilled())return;let e=this.unit.getCurrentDisplay();e&&(this.tween=this.scene.tweens.add({targets:[e],delay:200,duration:300,ease:Y3.Quintic.InOut,props:{alpha:{start:1,from:1,to:0}},onStart:()=>{this.unit.active||this.stop()},onComplete:()=>{this.unit.kill()}}))}play(){this.createTween()}stop(){this.tween?.remove();let e=this.unit.getCurrentDisplay();this.scene.tweens.killTweensOf(e),e.setAlpha(1),this.unit.revive()}},H3=AS;var xS=class{unit;coinsEffect;damagedEffect;dieEffect;constructor(e){this.unit=e,this.createCoinsEffect(),this.createDamagedEffect(),this.createDieEffect()}createCoinsEffect(){this.coinsEffect=new W3(this.unit)}createDamagedEffect(){this.damagedEffect=new M3(this.unit)}createDieEffect(){this.dieEffect=new H3(this.unit)}runDamagedEffect(){this.damagedEffect.run()}stopDamageEffect(){this.damagedEffect.stop()}runDieEffect(){this.dieEffect.play()}stopDieEffect(){this.dieEffect.stop()}increaseCoinEffectStack(e){this.coinsEffect.increaseNumberStack(e)}},z3=xS;var K3=E(X()),{KEY:V3,FRAME:X3}=T.GAMEPLAY,CS=class extends K3.Container{bg;frame;defaultHp;currentHp;color;hpLength;hpHeight;constructor(e,i){super(e),this.defaultHp=100,this.currentHp=100,this.hpLength=30,this.hpHeight=4,this.color=i,this.createHealthBar(),this.scene.add.existing(this)}createHealthBar(){let e=this.scene.make.image({key:V3,frame:X3.HP_BAR_BG,origin:{x:0,y:.5}}),i=.5,s=this.hpLength+i*2,r=this.hpHeight+i*2;e.setWorldSize(s,r),e.setX(-s/2),this.add(e),this.bg=e;let n=this.scene.make.image({key:V3,frame:X3.HP_BAR_BG,origin:{x:0,y:.5}});n.setWorldSize(this.hpLength,this.hpHeight),n.setX(-this.hpLength/2),this.add(n),this.frame=n}setInitHp(e){this.defaultHp=e,this.currentHp=e,this.updateFrameUI()}getCurrentHp(){return this.currentHp}updateCurrentHpUI(e){let i=Math.max(e,0);this.currentHp=i,this.updateFrameUI()}updateHpUIByMinus(e){this.currentHp-=e,this.currentHp<0&&(this.currentHp=0),this.updateFrameUI()}updateFrameUI(){this.frame.setWorldSize(this.currentHp/this.defaultHp*this.hpLength,this.hpHeight),this.frame.setTintFill(this.color)}changeHpColor(e){let i=e?39423:15466524;this.frame.setTintFill(i),this.color=i}},kc=CS;var wS=class{unit;hpBar;spineOffset;constructor(e){this.unit=e,this.createHpBar()}createHpBar(){let{scene:e,isPlayer:i}=this.unit,s=i?39423:15466524;this.hpBar=new kc(e,s),this.updatePositionHpBar(),this.hpBar.setDepth(B.UNIT_HP_BAR)}destroyHpBar(){this.hpBar.destroy()}updatePositionHpBar(){this.spineOffset||(this.spineOffset=this.unit.display.displayHeight-20);let{x:e,y:i}=this.unit.getWorldPosition();this.hpBar.setPosition(e,i-this.spineOffset)}setInitHp(e){this.hpBar.setInitHp(e)}updateCurrentHpUI(e){this.hpBar.updateCurrentHpUI(e)}reviveHpBar(){this.hpBar.revive()}killHpBar(){this.hpBar.kill()}changeHpColor(e){this.hpBar.changeHpColor(e)}update(){this.updatePositionHpBar()}},Z3=wS;var j3=E(X()),Tr=E(Ds()),{UNIT_SIZE_SCALE:Gc}=L,{modifier:_0e}=le.Powers.SpeedUp,I0e={end:()=>{},start:()=>{},event:(t,e)=>{},dispose:()=>{},complete:()=>{},interrupt:()=>{}},RS=class extends j3.Container{scene;unit;config;spine;spineScale;isUseSpine;sprite;spriteEvent;isFlipX;constructor(e,i){super(e.scene),this.unit=e,this.scene=e.scene,this.config=i,this.isUseSpine=i.useSpine,this.isFlipX=!1,this.initDisplay(),this.scaleDisplay(),this.y+=20}initDisplay(){let{spine:e,sprite:i,useSpine:s}=this.config;s?(this.createSpine(e.key,e.spineConfig),this.spine.setVisible(!0),this.spine.setActive(!0)):i&&(this.createSprite(i.key,i.frame,i.displayWidth,i.displayHeight),this.sprite.revive())}scaleDisplay(){if(this.spine){let{displayWidth:e,displayHeight:i}=this.spine;this.setSize(e,i)}else if(this.sprite){let{displayWidth:e,displayHeight:i}=this.sprite;this.setSize(e,i)}}createSprite(e,i,s,r){this.sprite=this.scene.add.sprite(0,0,e,i),this.sprite.setOrigin(.5,1),this.sprite.setDisplaySize(s*Gc,r*Gc),this.add(this.sprite),this.sprite.kill()}createSpine(e,i,s=!1){if(this.spine=this.scene.add.spine(0,0,e,i.animation,i.loop),this.setSpineScale(.5*Gc,.5*Gc),this.spine.setName(e),this.add(this.spine),s){let{spineManager:r}=this.scene;r.addSpines([this.unit])}this.spine.setVisible(!1),this.spine.setActive(!1)}setSpineScale(e,i){this.spine&&(this.spine.scaleX===e&&this.spine.scaleY===i||(this.spineScale=i,this.spine.setScale(e,i)))}getSpineScale(){return this.spineScale}isSpine(){return this.isUseSpine}getCurrentDisplay(){return this.isUseSpine?this.spine:this.sprite}getSpineDisplay(){return this.spine}getSpriteDisplay(){return this.sprite}play(e,i,s=!1,r=!0,n=!0){if(this.setUseSpine(n),this.isUseSpine)this.spine.play(i,s,r);else{let a=this.sprite.visible;this.sprite.play({key:e,repeat:s?-1:0},r),this.sprite.setVisible(a)}}setUseSpine(e){if(this.isUseSpine!==e){if(this.isUseSpine=e,e){if(!this.spine){let{key:i,spineConfig:s}=this.config.spine;this.createSpine(i,s,!0)}}else if(!this.sprite&&this.config.sprite){let{key:i,frame:s,displayWidth:r,displayHeight:n}=this.config.sprite;this.createSprite(i,s,r,n)}e?(this.sprite.removeAllListeners(),this.spriteEvent?.remove()):this.spine.state.clearListeners(),this.setFlipX(this.isFlipX),e?(this.spine.setVisible(!0),this.spine.setActive(!0),this.sprite.kill()):(this.spine.setVisible(!1),this.spine.setActive(!1),this.sprite.revive())}}setAnimationTimeScale(e){let s=this.unit.scene.powerManager.isGameSpeedUp()?_0e:1;this.isUseSpine?this.spine.timeScale=e*s:this.sprite.anims.timeScale=e*s}getAnimationTimeScale(){return this.isUseSpine?this.spine.timeScale:this.sprite.anims.timeScale}setFlipX(e){if(this.isUseSpine){if(e&&this.spine.scaleX<0||!e&&this.spine.scaleX>0)return;this.setSpineScale(e?-this.spineScale:this.spineScale,this.spineScale)}else this.sprite.setFlipX(e);this.isFlipX=e}isFaceLeft(){return this.isUseSpine?this.spine.scaleX<0:this.sprite.flipX}setTint(e){try{this.isUseSpine?this.spine.setColor(e):this.sprite.setTint(e)}catch(i){console.warn(i)}}clearTint(){try{this.spine&&this.spine.setColor(),this.sprite&&this.sprite.clearTint()}catch(e){console.warn(e)}}getSpineAnimationAttackingTime(){if(!this.spine)return 0;let e=null,{unitType:i,isPlayer:s}=this.unit,{MELEE:r,RANGED:n}=F;switch(i){case L.MELEE_UNIT_TYPE:e=this.spine.findAnimation(r.ATTACK);break;case L.RANGED_UNIT_TYPE:e=this.spine.findAnimation(s?n.ATTACK_BELOW:n.ATTACK_ABOVE),e||(e=this.spine.findAnimation(n.ATTACK));break;default:return 0}return e.duration*1e3}addAnimEventListener(e,i,s=!0){if(this.isUseSpine){s&&this.spine.state.clearListeners();let r=this.getEventNameForSpine(e);this.addSpineEventListener(r,i)}else{let r=this.getEventNameForSprite(e);if(typeof r=="string")s&&this.sprite.off(r),this.sprite.on(r,i);else{if(!s)return;let{timeScale:n,msPerFrame:a}=this.sprite.anims;this.spriteEvent?.remove();let o=r*a/n;this.spriteEvent=this.scene.time.delayedCall(o,i)}}}changeCurrentSpriteEventTime(){return this.isUseSpine||!this.spriteEvent?!1:(this.spriteEvent.timeScale=3,!0)}getEventNameForSprite(e){let{START:i,DISPOSE:s,INTERRUPT:r}=ms,{unitType:n,level:a}=this.unit;switch(e){case s:case r:return Tr.ANIMATION_STOP;case i:return Tr.ANIMATION_START;case F[n.toUpperCase()].CUSTOM_EVENTS.FINISHED_ATTACKING:{let o=Te[n.toUpperCase()][a].ATTACK.EVENT_FRAME;return o||(o=0),o}default:return Tr.ANIMATION_COMPLETE}}getEventNameForSpine(e){switch(e){case Tr.ANIMATION_START:return ms.START;case Tr.ANIMATION_STOP:return ms.DISPOSE;case Tr.ANIMATION_COMPLETE:return ms.COMPLETE;default:return e}}addSpineEventListener(e,i){let s={...I0e};switch(e){case ms.END:s.end=()=>{i()};break;case ms.START:s.start=()=>{i()};break;case ms.EVENT:s.event=()=>{i()};break;case ms.DISPOSE:s.dispose=()=>{i()};break;case ms.COMPLETE:s.complete=()=>{this.spine.state.removeListener(s),i()};break;case ms.INTERRUPT:s.interrupt=()=>{i()};break;default:s.event=(r,n)=>{n.data.name===e&&i()};break}this.spine.state.addListener(s)}runFadeInAnimation(){let e=this.isUseSpine?this.spine:this.sprite;this.scene.add.tween({targets:e,duration:200,props:{alpha:{getStart:()=>0,getEnd:()=>1}}})}},$3=RS;var PS=class extends Kh{getFirstPriorityRatio(e,i){return i===0?0:e/i}getSecondPriorityRatio(e,i){return i===0?0:e/i}getAttackTargetForMeleeUnit(){let{x:e,y:i,isPlayer:s,attackPower:r,currentHp:n}=this.unit;if(this.unit.isKilled())return null;let{enemyUnits:a,playerUnits:o}=this.scene.unitManager,l=(s?a:o).getChildren().filter(S=>S instanceof K?!S.isKilled():!1);switch(l.length){case 0:return null;case 1:return l[0];default:break}let c=1e4,d=l.sort((S,y)=>{let{x:b,y:x}=S,{x:A,y:w}=y,C=Math.sqrt((b-e)**2+(x-i)**2),_=Math.sqrt((A-e)**2+(w-i)**2);return c=Math.min(c,C),c=Math.min(c,_),C-_}),f=[d[0]];for(let S=1;S<d.length;S++){let y=d[S],{x:b,y:x}=y;if(Math.sqrt(Math.pow(b-e,2)+Math.pow(x-i,2))!==c)break;f.push(y)}switch(f.length){case 1:return f[0];default:break}let p=this.getFirstPriorityRatio(r,f[0].currentHp),m=f.sort((S,y)=>{let b=this.getFirstPriorityRatio(r,S.currentHp),x=this.getFirstPriorityRatio(r,y.currentHp);return p=Math.max(p,b),p=Math.max(p,x),x-b}),v=[m[0]];for(let S=1;S<m.length;S++){let y=m[S];if(this.getFirstPriorityRatio(r,y.currentHp)!==p)break;v.push(y)}switch(v.length){case 1:return v[0];default:break}return v.sort((S,y)=>{let b=this.getSecondPriorityRatio(S.attackPower,n);return this.getSecondPriorityRatio(y.attackPower,n)-b})[0]}getAttackTargetForRangedUnit(){let{isPlayer:e}=this.unit;if(this.unit.isKilled())return null;let{enemyUnits:i,playerUnits:s}=this.scene.unitManager,n=(e?i:s).getChildren().filter(o=>o instanceof K?!o.isKilled():!1);switch(n.length){case 0:return null;case 1:return n[0];default:break}switch(n.sort((o,h)=>{let l=o.attackPower,c=Math.sqrt((o.x-this.unit.x)**2+(o.y-this.unit.y)**2),d=h.attackPower,f=Math.sqrt((h.x-this.unit.x)**2+(h.y-this.unit.y)**2);return d/f-l/c}).length){case 0:return null;default:return n[0]}}},J3=PS;var Q3=E(X()),eK=E(ve()),yr=E(nt());var{DEPTH_ON_DRAG:L0e}=B,_S=class extends Q3.Container{isDebug=!1;scene;display;dragZone;attackEvent;status;unitName;level;actions;hp;attackPower;attackInterval;unitType;uiController;depthController;attackController;targetController;effectController;currentLocation;isPlayer;lastDragPosition;lastWorldPosition;originalUnitData;isDepthDirty;isPositionDirty;constructor(e,i,s,r,n,a){super(e,i,s),this.scene=e,this.createDragZone(),this.createDisplay(a),this.hp=0,this.level=0,this.attackPower=0,this.isDepthDirty=!1,this.isPositionDirty=!0,this.unitType="base",this.isPlayer=r,this.uiController=new Z3(this),this.depthController=new f3(this),this.attackController=new c3(this),this.targetController=new Kh(this),this.effectController=new z3(this),this.setUnitData(n),this.isPlayer&&this.addEventListener(),this.createActions(),this.actions.prepare(),this.scene.add.existing(this)}createDisplay(e){this.display=new $3(this,e),this.add(this.display)}createDragZone(){let{fieldManager:e}=this.scene;if(!e)return;let{displayWidth:i,displayHeight:s}=e.getPlayerPlacementSquare(1,1).areaRect,r=I.getPixelRatio();this.dragZone=this.scene.add.zone(0,0,i*r,s*r),this.add(this.dragZone)}addEventListener(){this.dragZone.setInteractive({draggable:!0,useHandCursor:!0}),this.dragZone.on(yr.GAMEOBJECT_DRAG_START,this.onDragStart),this.dragZone.on(yr.GAMEOBJECT_DRAG_END,this.onDragEnd),this.dragZone.on(yr.GAMEOBJECT_DRAG,this.onDrag)}addOnceEvent(e,i){this.dragZone.once(e,i)}removeOnceEvent(e,i){this.dragZone.off(e,i)}updatePositionHpBar(){this.uiController.updatePositionHpBar()}removeEventListener(){this.dragZone.off(yr.GAMEOBJECT_DRAG_START,this.onDragStart),this.dragZone.off(yr.GAMEOBJECT_DRAG_END,this.onDragEnd),this.dragZone.off(yr.GAMEOBJECT_DRAG,this.onDrag),this.dragZone.disableInteractive()}startEventListener(){this.removeEventListener(),this.addEventListener()}setDefaultHp(e){let{playerIsCheater:i,opponentIsCheater:s}=window.clientInformation||{},r=e;this.level>1&&(i&&this.isPlayer&&(r/=2),s&&!this.isPlayer&&(r/=2)),this.hp=r,this.uiController.setInitHp(r)}get currentHp(){return this.hp}canbeAttacked(){if(this.isFinishedAttacking())throw new Error("Unit is finished attacking");if(this.isKilled())throw new Error("Unit is killed");let e=this.attackController.getAttackTarget();if(!e||e?.isKilled())throw new Error("No attack target")}attack=()=>{try{if(this.canbeAttacked(),!this.isPreparingToAttack()&&!this.isAttacking())return;this.actions.attack();let e=this.attackController.getAttackTarget();if(!e)throw new Error("No attack target");if(e.isKilled())throw new Error("Attack target is killed");let i=this.scene.powerManager.isGameSpeedUp()?.5:1;this.attackEvent=this.scene.time.delayedCall(this.attackInterval*i,this.attack)}catch{this.attackEvent?.destroy(),this.actions.ready()}};modifyCurrentAttackEvent(){if(!this.attackEvent||this.attackEvent.getProgress()===1||this.isKilled())return;let e=this.attackEvent.getRemaining();if(e===0)return;let i=this.scene.powerManager.isGameSpeedUp()?.5:2;this.attackEvent.reset({delay:e*i,callback:this.attack})}takeDamage(e){if(this.hp<=0)return;let{coinManager:i,uiManager:s}=this.scene;if(!this.isPlayer){let a=i.getAttackCoinByUnit(e,this);i.addCoinsByAttack(a),this.effectController.increaseCoinEffectStack(a)}let r=this.hp,n=this.getCorrectAttackPower(e);if(this.hp-=n,this.hp<0&&(this.hp=0),this.uiController.updateCurrentHpUI(this.hp),s.setTotalHpBar(r-this.hp,this.isPlayer),q.playSound(J.UNIT_DAMAGED,{volume:.2+Math.random()*.8}),Wt.vibrate(50),this.hp<=0){this.actions.die();return}this.effectController.runDamagedEffect()}getCorrectAttackPower(e){let{playerIsCheater:i,opponentIsCheater:s}=window.clientInformation||{},{attackPower:r}=e;return i&&this.level>1&&(this.isPlayer?r*=1*e.level:r/=2*this.level),s&&(this.isPlayer?r/=10*this.level:r*=20*e.level),r}onDragStart=()=>{let{firstHightLineZone:e}=this.scene.fieldManager;e.revive(),e.setPosition(this.x,this.y),this.lastDragPosition=new eK.Vector2(this.x,this.y),this.setDepthOnDrag();let{spineManager:i}=this.scene;i.bringToTopOnDrag(this),q.playSound(J.UNIT_DRAG_START)};onDragEnd=()=>{let{unitManager:e,fieldManager:i}=this.scene,{firstHightLineZone:s,secondHightLineZone:r}=i;s.kill(),r.kill(),this.isDepthDirty=!0;let n=i.getSquareBasedOnPosition(this.lastDragPosition.x,this.lastDragPosition.y);if(!n||n===this.currentLocation){this.assignUnitToSquare(this.currentLocation.rowId,this.currentLocation.colId,this.isPlayer),e.resetAttackSpots(this),q.playSound(J.UNIT_DRAG_END);return}let a=e.getUnitBasedOnPosition(n.rowId,n.colId);if(!a){this.assignUnitToSquare(n.rowId,n.colId,this.isPlayer),e.resetAttackSpots(this),q.playSound(J.UNIT_DRAG_END);return}let o=a.unitType===this.unitType,h=a.level===this.level;if(!o||!h){this.swapUnitPosition(a),this.isDepthDirty=!0,a.isDepthDirty=!0,q.playSound(J.UNIT_DRAG_END);return}e.mergeUnits(this,a)?this.currentLocation&&this.currentLocation.setTaken(!1):(this.assignUnitToSquare(this.currentLocation.rowId,this.currentLocation.colId,this.isPlayer),q.playSound(J.UNIT_DRAG_END))};getLastDragPos(){return this.lastDragPosition}dragUnitOnto(e,i){let{unitManager:s,fieldManager:r}=this.scene;this.isDepthDirty=!0;let n=r.getSquareBasedOnIndex(e,i);if(!n||n===this.currentLocation){this.assignUnitToSquare(this.currentLocation.rowId,this.currentLocation.colId,this.isPlayer),s.resetAttackSpots(this);return}let a=s.getUnitBasedOnPosition(n.rowId,n.colId);if(!a){this.assignUnitToSquare(n.rowId,n.colId,this.isPlayer),s.resetAttackSpots(this);return}let o=a.unitType===this.unitType,h=a.level===this.level;if(!o||!h){this.swapUnitPosition(a),this.isDepthDirty=!0,a.isDepthDirty=!0;return}s.mergeUnits(this,a)?this.currentLocation&&this.currentLocation.setTaken(!1):this.assignUnitToSquare(this.currentLocation.rowId,this.currentLocation.colId,this.isPlayer)}onDrag=e=>{let{worldX:i,worldY:s,wasTouch:r}=e,{height:n}=this.scene.fieldManager.firstHightLineZone,a=r?n*.8:n/4,o=r?n*.55:0;this.setPosition(i,s-a),this.lastDragPosition.x=i,this.lastDragPosition.y=s-o;let{fieldManager:h}=this.scene,l=h.getSquareBasedOnPosition(this.lastDragPosition.x,this.lastDragPosition.y),{secondHightLineZone:c}=this.scene.fieldManager;if(!l||l===this.currentLocation){c.kill();return}c.revive(),c.setPosition(l.x,l.y),c.isStroked=!1;let d=this.scene.unitManager.getUnitBasedOnPosition(l.rowId,l.colId);d&&d.unitName===this.unitName&&(c.isStroked=!0)};findTarget(){if(this.isKilled())return;let e=this.targetController.getAttackTarget();e&&this.attackController.setAttackTarget(e)}setUnitData(e){let{health:i,attackSpeed:s,damage:r,name:n,level:a}=e;this.setDefaultHp(i),this.attackInterval=s,this.attackPower=r,this.unitName=n,this.level=a,this.originalUnitData=e}assignUnitToSquare(e,i,s){e===0&&i===0&&!this.isPlayer&&(this.isDebug=!0,console.log(`%c turn on debug for: row ${e} col ${i} isPlayer ${s}`,"font-size:12px;background-color: #9E9689;color:#fff;"));let{fieldManager:r}=this.scene,n=s?r.getPlayerPlacementSquare(e,i):r.getEnemyPlacementSquare(e,i);this.currentLocation&&this.currentLocation.setTaken(!1),this.setPosition(n.x,n.y),n.setTaken(!0),this.currentLocation=n,this.attackController.resetAttackSpots()}spawnUnitOnSquare(e,i,s){let{fieldManager:r}=this.scene,n=s?r.getPlayerPlacementSquare(e,i):r.getEnemyPlacementSquare(e,i);this.setPosition(n.x,n.y),n.setTaken(!0),this.currentLocation=n,this.attackController.resetAttackSpots()}summonMinionOnSquare(e,i,s=!1){let{fieldManager:r}=this.scene,n=s?r.getPlayerPlacementSquare(e,i):r.getEnemyPlacementSquare(e,i);this.setPosition(n.x,n.y),this.currentLocation=n,this.attackController.resetAttackSpots()}swapUnitPosition(e){let i=e.currentLocation,s=this.currentLocation;e.setPosition(s.x,s.y),this.setPosition(i.x,i.y);let{unitManager:r}=this.scene;r.resetAttackSpots(this),r.resetAttackSpots(e),e.currentLocation=s,this.currentLocation=i}setDepthOnDrag(){this.setDepth(L0e)}calcDepth(){if(this.isKilled())return;let e=this.depthController.calculateDepth();e&&this.depth!==e&&this.setDepth(e)}requestAttackPosition(e){return this.attackController.assignAttackingUnit(e)}getCurrentDisplay(){return this.display.getCurrentDisplay()}getSpineDisplay(){return this.display.getSpineDisplay()}reuseUnitOnReady(){this.setActive(!0),this.isDepthDirty=!0,this.assignUnitToSquare(this.currentLocation.rowId,this.currentLocation.colId,this.isPlayer),this.setDefaultHp(this.originalUnitData.health),this.uiController.updateCurrentHpUI(this.hp),this.actions.prepare(),this.setVisible(!0)}reuseUnitFromPool(e){this.setActive(!0),this.isDepthDirty=!0,this.isPlayer!==e&&(this.uiController.changeHpColor(e),this.isPlayer=e),this.uiController.reviveHpBar();let i=this.getSpineDisplay();e?this.startEventListener():this.removeEventListener(),this.setDefaultHp(this.originalUnitData.health),this.uiController.updateCurrentHpUI(this.hp),this.actions.prepare(),i&&i.setVisible(!0),this.setVisible(!0)}handleRemoveFromScene(){this.uiController.killHpBar(),this.attackController.resetAttackSpots(),this.effectController.stopDamageEffect(),this.effectController.stopDieEffect(),this.removeEventListener(),this.setStatus(Ce.KILLED),this.attackEvent?.remove(),this.currentLocation&&this.currentLocation.setTaken(!1);let e=this.getSpineDisplay();if(e){let{spineManager:i}=this.scene;i.removeSpine(this),e.setVisible(!1)}this.kill()}setStatus(e){this.status=e}getStatus(){return this.status}getWorldPosition(){return this.isPositionDirty=!1,this.lastWorldPosition=super.getWorldPosition(),this.lastWorldPosition}setPosition(e,i,s,r){return super.setPosition(e,i,s,r),this.isPositionDirty=!0,this}isInPrepareMode(){return this.status===Ce.PREPARE}isReady(){return this.status===Ce.READY}isMovingToTarget(){return this.status===Ce.MOVING_TO_TARGET}isPreparingToAttack(){return this.status===Ce.PREPARE_TO_ATTACK}isAttacking(){return this.status===Ce.ATTACKING}isKilled(){return this.status===Ce.KILLED}isFinishedAttacking(){return this.status===Ce.FINISHED_ATTACKING}update(e,i){this.isDepthDirty&&(this.calcDepth(),this.isDepthDirty=!1),this.scene.stateManager.isInPlayingState()&&this.uiController.update()}runFadeInAnimation(){this.display.runFadeInAnimation()}setTargetControllerToDefault(){this.targetController=new Kh(this)}setTaretControllerToPostGame(){this.targetController=new J3(this)}},K=_S;var{KEY:M0e,FRAME:O0e}=T.UNITS_SPRITES,{KEY:D0e}=T.UNITS_SPINES.MELEE[1],IS=class extends K{constructor(e,i){super(e,0,0,i,{level:100,id:"alien",name:"Warlock",health:1,damage:1,attackSpeed:1},{spine:{key:D0e,spineConfig:{animation:F.MELEE.IDLE,loop:!0}},sprite:{key:M0e,frame:O0e.MELEE[1].MAIN_TEXTURE,displayWidth:86.5,displayHeight:68},useSpine:!0}),this.level=1,this.unitName="Alien Lv.100",this.attackPower=1,this.setDefaultHp(999999)}createActions(){throw new Error("Method not implemented.")}findTarget(){throw new Error("Method not implemented.")}},br=IS;var LS=class{unit;dieCommand;moveCommand;readyCommand;attackCommand;prepareCommand;constructor(e){this.unit=e,this.addDieCommand(),this.addMoveCommand(),this.addReadyCommand(),this.addAttackCommand(),this.addPrepareCommand()}prepare(){this.prepareCommand.execute()}ready(){this.unit.isKilled()||this.readyCommand.execute()}move(){this.unit.isKilled()||this.moveCommand.execute()}attack(){this.unit.isKilled()||this.attackCommand.execute()}die(){this.unit.isKilled()||this.dieCommand.execute()}},qc=LS;var MS=class{unit;constructor(e){this.unit=e}},tK=MS;var OS=class extends tK{payload;constructor(e,i){super(e),this.payload=i}execute(){let{spriteAnimKey:e,spineAnimKey:i,status:s}=this.payload;this.unit.setStatus(s),this.unit.display.play(e,i,!0,!0),this.unit.display.setAnimationTimeScale(.5+Math.random())}},ht=OS;var iK=E(Ds());var DS=class extends ht{execute(){let{spriteAnimKey:e,spineAnimKey:i,status:s}=this.payload;this.unit.setStatus(s),this.unit.display.play(e,i,!1),this.unit.display.setAnimationTimeScale(1),this.unit.display.addAnimEventListener(F.MELEE.CUSTOM_EVENTS.FINISHED_ATTACKING,this.handleAttacked),q.playSound(J.MELEE_ATTACK,{volume:.5});let r=this.unit.attackController.getAttackTarget();r&&this.unit.display.setFlipX(r.x<=this.unit.x)}handleAttacked=()=>{if(this.unit.isKilled())return;let e=this.unit.attackController.getAttackTarget();if(e){if(e.isKilled()){this.unit.display.addAnimEventListener(iK.ANIMATION_COMPLETE,this.handleFinishedAttacking);return}e.takeDamage(this.unit),e.attackController.notifyTargetAttacked(this.unit)}};handleFinishedAttacking=()=>{this.unit.setStatus(Ce.FINISHED_ATTACKING)}},sK=DS;var rK=E(Ds()),BS=class extends ht{execute(){let{spriteAnimKey:e,spineAnimKey:i,status:s}=this.payload;this.unit.setStatus(s),this.unit.attackEvent?.remove(),this.unit.uiController.killHpBar(),this.unit.depthController.setDepthOnDeath(),this.unit.effectController.stopDamageEffect(),this.unit.display.play(e,i,!1,!0),this.unit.display.setAnimationTimeScale(1),this.unit.display.addAnimEventListener(rK.ANIMATION_COMPLETE,this.handleAnimationComplete)}handleAnimationComplete=()=>{this.unit.effectController.runDieEffect()}},nK=BS;var US=class extends ht{execute(){let{spriteAnimKey:e,spineAnimKey:i,status:s}=this.payload,r=this.unit.attackController.getAttackTarget();r&&(this.unit.isDepthDirty=!0,this.unit.getStatus()!==s&&(this.unit.setStatus(s),this.unit.display.play(e,i,!0),this.unit.display.setAnimationTimeScale(.5+Math.random())),this.unit.display.setFlipX(r.x<this.unit.x))}},aK=US;var NS=class extends ht{execute(){let{spriteAnimKey:e,spineAnimKey:i,status:s}=this.payload;this.unit.revive(),this.unit.setStatus(s),this.unit.isDepthDirty=!0,this.unit.uiController.killHpBar(),this.unit.effectController.stopDieEffect(),this.unit.display.setFlipX(!1),this.unit.display.play(e,i,!0,!0),this.unit.display.setAnimationTimeScale(.5+Math.random()),this.unit.attackController.reset()}},oK=NS;var FS=class extends ht{execute(){let{spriteAnimKey:e,spineAnimKey:i,status:s}=this.payload;this.unit.setStatus(s),this.unit.uiController.reviveHpBar(),this.unit.display.play(e,i,!0,!0),this.unit.display.setAnimationTimeScale(.5+Math.random())}},hK=FS;var kS=class extends qc{addAttackCommand(){this.attackCommand=new sK(this.unit,{status:Ce.ATTACKING,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("ATTACK"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("ATTACK")})}addReadyCommand(){this.readyCommand=new hK(this.unit,{status:Ce.READY,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("IDLE"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("IDLE")})}addMoveCommand(){this.moveCommand=new aK(this.unit,{status:Ce.MOVING_TO_TARGET,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("RUN"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("RUN")})}addDieCommand(){this.dieCommand=new nK(this.unit,{status:Ce.KILLED,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("DIE"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("DIE")})}addPrepareCommand(){this.prepareCommand=new oK(this.unit,{status:Ce.PREPARE,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("IDLE"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("IDLE")})}getSpriteAnimKeyByUnitLevel(e){try{let{level:i}=this.unit,s=i;return s>=2&&(s=1),Te.MELEE[s][e].KEY}catch(i){return console.warn(i),Te.ALIEN[1].IDLE.KEY}}getSpineAnimKeyByUnitLevel(e){let i=F.MELEE[e];if(!i)throw new Error(`Can't find spine animation ${e}`);return i}},lK=kS;var $h=E(ve()),{modifier:B0e}=le.Powers.SpeedUp,GS=class extends K{movementSpeed;savedApproachXOffset;savedApproachYOffset;constructor(e,i,s,r,n,a){super(e,i,s,r,n,a),this.unitType=L.MELEE_UNIT_TYPE,this.movementSpeed=L.MELEE_MOVEMENT_SPEED,this.attackInterval=L.MELEE_ATTACK_INTERVAL;let o=this.display.getSpineAnimationAttackingTime();this.attackInterval<o&&(this.attackInterval=o),this.savedApproachXOffset=null,this.savedApproachYOffset=null}createActions(){this.actions=new lK(this)}moveToAttackPosition(e){if(this.isKilled())return;let i=this.attackController.getAttackTarget();if(!i||i?.isKilled())return;let s=i.requestAttackPosition(this);s&&(this.isDepthDirty=!0,this.executeMovement(e,s.location))}executeMovement(e,i){let{x:s,y:r}=this,a=this.scene.powerManager.isGameSpeedUp()?this.movementSpeed*B0e:this.movementSpeed,o=a/1e3*e,h=$h.Distance.Between(s,r,i.x,i.y),l=i.x-s,c=i.y-r,d=l!==0?l/h*a/1e3*e:0,f=c!==0?c/h*a/1e3*e:0;if($h.Distance.Between(s+d,r+f,i.x,i.y)<=o){this.setPosition(s+d,r+f),this.setStatus(Ce.PREPARE_TO_ATTACK),this.attackController.moveAttackSpotMelee(i.x-s,i.y-r);return}this.display.setFlipX(d<0),this.setPosition(s+d,r+f),this.attackController.moveAttackSpotMelee(d,f)}moveToTarget(e){this.moveToAttackPosition(e)}determineCounteringEnemy(){let{beingAttackedByMelee:e,beingAttackedByRanged:i}=this.attackController,s=this.attackController.getAttackTarget();if(s?.isKilled()&&(s=null),e&&!e.isKilled())return this.attackController.setAttackTarget(e),s?.attackController.resetAttackSpotOfUnit(this),!0;if(i&&!i.isKilled()){let r=$h.Distance.Between(this.x,this.y,i.x,i.y),n=s?$h.Distance.Between(this.x,this.y,s.x,s.y):1e4;if(r<n)return this.attackController.setAttackTarget(i),s?.attackController.resetAttackSpotOfUnit(this),!0}return!1}setUnitData(e){super.setUnitData(e),this.unitType=L.MELEE_UNIT_TYPE}update(e,i){if(super.update(e,i),this.isKilled()||!this.scene.stateManager.isInPlayingState())return;let s=this.attackController.getAttackTarget();if(this.isReady()){(!s||s.isKilled())&&this.findTarget(),s&&this.actions.move();return}if(this.isMovingToTarget()){let r=this.determineCounteringEnemy();if(this.moveToTarget(i),r)return;if(s?.isKilled()){this.attackController.resetAttackTarget(),this.actions.ready();return}return}if(this.isPreparingToAttack()){if(s?.isKilled()){this.actions.ready();return}this.attack();return}this.isFinishedAttacking()&&(this.savedApproachXOffset=null,this.savedApproachYOffset=null,this.actions.ready())}},Pe=GS;var U0e={SUMMON_MINIONS:"summon-minions",SUMMON_RANGED_MINIONS:"summon-ranged-minions",SUMMON_AMBUSH:"summon-ambush"},Ss=U0e;var qS=class extends Pe{isBoss;availableSkills;constructor(e,i,s,r,n,a){super(e,i,s,r,n,a),this.isBoss=!0,this.availableSkills={SummonMinions:!1,SummonRangedMinions:!1,SummonAmbush:!1}}triggerSummonMinions(){this.scene.events.emit(Ss.SUMMON_MINIONS,this.level)}triggerSummonRangedMinions(){this.scene.events.emit(Ss.SUMMON_RANGED_MINIONS,this.level)}triggerSummonAmbush(){this.scene.events.emit(Ss.SUMMON_AMBUSH,this.level)}update(e,i){if(super.update(e,i),this.isKilled()||!this.scene.stateManager.isInPlayingState())return;let s=this.attackController.getAttackTarget();if(this.availableSkills.SummonMinions&&this.currentHp<=this.originalUnitData.health*.5&&(this.availableSkills.SummonMinions=!1,this.triggerSummonMinions()),this.availableSkills.SummonRangedMinions&&this.currentHp<=this.originalUnitData.health*.25&&(this.availableSkills.SummonRangedMinions=!1,this.triggerSummonRangedMinions()),this.availableSkills.SummonAmbush&&this.currentHp<=this.originalUnitData.health*.1&&(this.availableSkills.SummonAmbush=!1,this.triggerSummonAmbush()),this.isReady()){(!s||s.isKilled())&&this.findTarget(),s&&this.actions.move();return}if(this.isMovingToTarget()){let r=this.determineCounteringEnemy();if(this.moveToTarget(i),r)return;if(s?.isKilled()){this.attackController.resetAttackTarget(),this.actions.ready();return}return}if(this.isPreparingToAttack()){if(s?.isKilled()){this.actions.ready();return}this.attack();return}this.isFinishedAttacking()&&(this.savedApproachXOffset=null,this.savedApproachYOffset=null,this.actions.ready())}},Be=qS;var{KEY:N0e}=T.UNITS_SPINES.MELEE[10],WS=class extends Be{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:N0e,spineConfig:{animation:F.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!0}}reuseUnitFromPool(e){super.reuseUnitFromPool(e),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!0}}reuseUnitOnReady(){super.reuseUnitOnReady(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!0}}},uK=WS;var{KEY:F0e}=T.UNITS_SPINES.MELEE[11],YS=class extends Be{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:F0e,spineConfig:{animation:F.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!0}}reuseUnitFromPool(e){super.reuseUnitFromPool(e),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!0}}reuseUnitOnReady(){super.reuseUnitOnReady(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!0}}},cK=YS;var{KEY:k0e,FRAME:G0e}=T.UNITS_SPRITES,{KEY:q0e}=T.UNITS_SPINES.MELEE[1],HS=class extends Be{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:q0e,spineConfig:{animation:F.MELEE.IDLE,loop:!0}},sprite:{key:k0e,frame:G0e.MELEE[1].MAIN_TEXTURE,displayWidth:86.5,displayHeight:68},useSpine:!0})}},dK=HS;var{KEY:W0e}=T.UNITS_SPINES.MELEE[2],zS=class extends Be{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:W0e,spineConfig:{animation:F.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!1,SummonAmbush:!1}}reuseUnitFromPool(e){super.reuseUnitFromPool(e),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!1,SummonAmbush:!1}}reuseUnitOnReady(){super.reuseUnitOnReady(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!1,SummonAmbush:!1}}},fK=zS;var{KEY:Y0e}=T.UNITS_SPINES.MELEE[3],VS=class extends Be{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:Y0e,spineConfig:{animation:F.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!1,SummonAmbush:!1}}reuseUnitFromPool(e){super.reuseUnitFromPool(e),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!1,SummonAmbush:!1}}reuseUnitOnReady(){super.reuseUnitOnReady(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!1,SummonAmbush:!1}}},pK=VS;var{KEY:H0e}=T.UNITS_SPINES.MELEE[4],XS=class extends Be{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:H0e,spineConfig:{animation:F.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!1}}reuseUnitFromPool(e){super.reuseUnitFromPool(e),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!1}}reuseUnitOnReady(){super.reuseUnitOnReady(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!1}}},mK=XS;var{KEY:z0e}=T.UNITS_SPINES.MELEE[5],KS=class extends Be{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:z0e,spineConfig:{animation:F.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!1}}reuseUnitFromPool(e){super.reuseUnitFromPool(e),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!1}}reuseUnitOnReady(){super.reuseUnitOnReady(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!1}}},vK=KS;var{KEY:V0e}=T.UNITS_SPINES.MELEE[6],ZS=class extends Be{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:V0e,spineConfig:{animation:F.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!1}}reuseUnitFromPool(e){super.reuseUnitFromPool(e),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!1}}reuseUnitOnReady(){super.reuseUnitOnReady(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!1}}},gK=ZS;var{KEY:X0e}=T.UNITS_SPINES.MELEE[7],jS=class extends Be{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:X0e,spineConfig:{animation:F.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!1}}reuseUnitFromPool(e){super.reuseUnitFromPool(e),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!1}}reuseUnitOnReady(){super.reuseUnitOnReady(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!1}}},SK=jS;var{KEY:K0e}=T.UNITS_SPINES.MELEE[8],$S=class extends Be{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:K0e,spineConfig:{animation:F.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!0}}reuseUnitFromPool(e){super.reuseUnitFromPool(e),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!0}}reuseUnitOnReady(){super.reuseUnitOnReady(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!0}}},EK=$S;var{KEY:Z0e}=T.UNITS_SPINES.MELEE[9],JS=class extends Be{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:Z0e,spineConfig:{animation:F.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!0}}reuseUnitFromPool(e){super.reuseUnitFromPool(e),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!0}}reuseUnitOnReady(){super.reuseUnitOnReady(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!0}}},TK=JS;var{KEY:j0e}=T.UNITS_SPINES.MELEE[10],QS=class extends Pe{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:j0e,spineConfig:{animation:F.MELEE.IDLE,loop:!0}},useSpine:!0})}},eE=QS;var{KEY:$0e}=T.UNITS_SPINES.MELEE[11],tE=class extends Pe{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:$0e,spineConfig:{animation:F.MELEE.IDLE,loop:!0}},useSpine:!0})}},iE=tE;var{KEY:J0e,FRAME:Q0e}=T.UNITS_SPRITES,{KEY:eAe}=T.UNITS_SPINES.MELEE[1],sE=class extends Pe{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:eAe,spineConfig:{animation:F.MELEE.IDLE,loop:!0}},sprite:{key:J0e,frame:Q0e.MELEE[1].MAIN_TEXTURE,displayWidth:86.5,displayHeight:68},useSpine:!0})}},rE=sE;var{KEY:tAe}=T.UNITS_SPINES.MELEE[2],nE=class extends Pe{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:tAe,spineConfig:{animation:F.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar()}},aE=nE;var{KEY:iAe}=T.UNITS_SPINES.MELEE[3],oE=class extends Pe{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:iAe,spineConfig:{animation:F.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar()}},hE=oE;var{KEY:sAe}=T.UNITS_SPINES.MELEE[4],lE=class extends Pe{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:sAe,spineConfig:{animation:F.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar()}},uE=lE;var{KEY:rAe}=T.UNITS_SPINES.MELEE[5],cE=class extends Pe{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:rAe,spineConfig:{animation:F.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar()}},dE=cE;var{KEY:nAe}=T.UNITS_SPINES.MELEE[6],fE=class extends Pe{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:nAe,spineConfig:{animation:F.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar()}},pE=fE;var{KEY:aAe}=T.UNITS_SPINES.MELEE[7],mE=class extends Pe{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:aAe,spineConfig:{animation:F.MELEE.IDLE,loop:!0}},useSpine:!0})}},vE=mE;var{KEY:oAe}=T.UNITS_SPINES.MELEE[8],gE=class extends Pe{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:oAe,spineConfig:{animation:F.MELEE.IDLE,loop:!0}},useSpine:!0})}},SE=gE;var{KEY:hAe}=T.UNITS_SPINES.MELEE[9],EE=class extends Pe{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:hAe,spineConfig:{animation:F.MELEE.IDLE,loop:!0}},useSpine:!0})}},TE=EE;var yE=E(X()),bE=class{scene;numOfPlayerSpawnedUnits;resourcePool;bossResourcePool;constructor(e){this.scene=e,this.resourcePool=new yE.Group(this.scene,{runChildUpdate:!1}),this.bossResourcePool=new yE.Group(this.scene,{runChildUpdate:!1})}init(){this.numOfPlayerSpawnedUnits=0}returnToPool(e){if(e instanceof Be){this.bossResourcePool.add(e);return}this.resourcePool.add(e)}getPlayerSpawnedUnitsCount(){return this.numOfPlayerSpawnedUnits}setSpawnedUnits(e){this.numOfPlayerSpawnedUnits=e}},Wc=bE;var AE=class extends Wc{requestUnitByLevel(e,i,s=!1){let r=this.getUnitFromResourcePoolByLevel(e);return r?(i&&!s&&(this.numOfPlayerSpawnedUnits+=Math.pow(2,e-1)),r.reuseUnitFromPool(i),this.scene.add.existing(r),r):(r=this.createUnitByLevel(e,i,s),r)}requestUnitById(e,i,s=!1){let r=this.getUnitFromResourcePoolById(e);return r?(i&&!s&&(this.numOfPlayerSpawnedUnits+=Math.pow(2,r.level-1)),r.reuseUnitFromPool(i),this.scene.add.existing(r),r):(r=this.createUnitById(e,i,s),r)}requestBossByLevel(e){let i=this.getUnitFromBossResoucePool(e);return i?(i.reuseUnitFromPool(!1),this.scene.add.existing(i),i):(i=this.createBossUnitByLevel(e),i)}createBossUnitByLevel(e){let i,s=this.getBossDataByLevel(e);switch(e){case 2:i=new fK(this.scene,!1,s);break;case 3:i=new pK(this.scene,!1,s);break;case 4:i=new mK(this.scene,!1,s);break;case 5:i=new vK(this.scene,!1,s);break;case 6:i=new gK(this.scene,!1,s);break;case 7:i=new SK(this.scene,!1,s);break;case 8:i=new EK(this.scene,!1,s);break;case 9:i=new TK(this.scene,!1,s);break;case 10:i=new uK(this.scene,!1,s);break;case 11:i=new cK(this.scene,!1,s);break;default:i=new dK(this.scene,!1,s);break}return i}createUnitByLevel(e,i,s=!1){let r,n=this.getUnitDataByLevel(e);switch(e){case 1:r=new rE(this.scene,i,n);break;case 2:r=new aE(this.scene,i,n);break;case 3:r=new hE(this.scene,i,n);break;case 4:r=new uE(this.scene,i,n);break;case 5:r=new dE(this.scene,i,n);break;case 6:r=new pE(this.scene,i,n);break;case 7:r=new vE(this.scene,i,n);break;case 8:r=new SE(this.scene,i,n);break;case 9:r=new TE(this.scene,i,n);break;case 10:r=new eE(this.scene,i,n);break;case 11:r=new iE(this.scene,i,n);break;default:return new br(this.scene,i)}return i&&!s&&(this.numOfPlayerSpawnedUnits+=Math.pow(2,e-1)),r}createUnitById(e,i,s=!1){let r,n=this.getUnitDataById(e);if(!n)return new br(this.scene,i);switch(e){case"velociraptor":r=new rE(this.scene,i,n);break;case"saurolophus":r=new aE(this.scene,i,n);break;case"pachysaurus":r=new hE(this.scene,i,n);break;case"triceratops":r=new uE(this.scene,i,n);break;case"stegosaurus":r=new dE(this.scene,i,n);break;case"ankylosaurus":r=new pE(this.scene,i,n);break;case"baroptiloraptor":r=new vE(this.scene,i,n);break;case"tyrannosaurus":r=new SE(this.scene,i,n);break;case"dilophosaurus":r=new TE(this.scene,i,n);break;case"triceradonosaurus":r=new eE(this.scene,i,n);break;case"spinosaurus-rex":r=new iE(this.scene,i,n);break;default:return new br(this.scene,i)}return i&&!s&&(this.numOfPlayerSpawnedUnits+=Math.pow(2,n.level-1)),r}getUnitDataByLevel(e){return this.scene.cache.json.get("unitData").melee[e-1]}getUnitDataById(e){return this.scene.cache.json.get("unitData").melee.find(s=>s.id===e)}getBossDataByLevel(e){return this.scene.cache.json.get("bossData").melee[e-1]}getUnitFromResourcePoolByLevel(e){let s=this.resourcePool.getChildren().find(r=>r instanceof Pe?r.level===e:!1);if(s instanceof K)return this.resourcePool.remove(s),s}getUnitFromBossResoucePool(e){let s=this.bossResourcePool.getChildren().find(r=>r instanceof Be?r.level===e:!1);if(s instanceof K)return this.bossResourcePool.remove(s),s}getUnitFromResourcePoolById(e){let s=this.resourcePool.getChildren().find(r=>{if(!(r instanceof Pe))return!1;let{originalUnitData:n}=r;return n.id===e});if(s instanceof K)return this.resourcePool.remove(s),s}},yK=AE;var xE=E(X()),Yc=E(ve()),{KEY:lAe,FRAME:uAe}=T.GAMEPLAY,{modifier:cAe}=le.Powers.SpeedUp,CE=class extends xE.Sprite{scene;target;attacker;speed;heightOffset;upwardDirectionOffset;downwardDirectionOffset;constructor(e,i){let{attacker:s,target:r,speed:n,frame:a}=i,o=a||uAe.BLANK;super(e,s.x,s.y,lAe,o),this.setDisplaySize(5,5),this.scene=e,this.speed=n||L.RANGED_PROJECTILE_SPEED,this.target=r,this.attacker=s,this.heightOffset=0;let h=this.target.display;h instanceof xE.Sprite||(this.heightOffset=h.displayHeight*.4),this.rotation=Yc.Angle.Between(this.x,this.y,r.x,r.y-this.heightOffset);let{depthController:l}=this.attacker;this.setDepth(l.getProjectileDepth()),this.scene.add.existing(this)}update(e,i){let r=this.scene.powerManager.isGameSpeedUp()?this.speed*cAe:this.speed,n=r/1e3*i,a=Yc.Distance.Between(this.x,this.y,this.target.x,this.target.y-this.heightOffset);if(a<n){this.target.takeDamage(this.attacker),this.scene.unitManager.rangedProjectiles.remove(this,!0);return}let o=this.target.x-this.x,h=this.target.y-this.heightOffset-this.y,l=o/a*r/1e3*i,c=h/a*r/1e3*i;this.setPosition(this.x+l,this.y+c)}},Ye=CE;var wE=E(ve()),{FRAME:dAe}=T.GAMEPLAY,{UNIT_SIZE_SCALE:fAe}=L,RE=class extends Ye{constructor(e,i){i.frame=dAe.ROCK,super(e,i),this.setOrigin(.5,.5);let s=fAe;this.setDisplaySize(7.5*s,6.5*s),this.upwardDirectionOffset=new wE.Vector2(0,-10),this.downwardDirectionOffset=new wE.Vector2(0,-10);let r=this.downwardDirectionOffset.x,n=this.downwardDirectionOffset.y;this.attacker.y>this.target.y&&(r=this.upwardDirectionOffset.x,n=this.upwardDirectionOffset.y),this.setPosition(this.attacker.x+r,this.attacker.y+n)}},bK=RE;var Jh=E(ve()),{FRAME:pAe}=T.GAMEPLAY,{UNIT_SIZE_SCALE:mAe}=L,PE=class extends Ye{constructor(e,i){i.frame=pAe.JAVELIN,super(e,i),this.setOrigin(1,.5);let s=mAe;this.setDisplaySize(67*s,3.5*s),this.upwardDirectionOffset=new Jh.Vector2(0,-20),this.downwardDirectionOffset=new Jh.Vector2(10,0);let r=this.downwardDirectionOffset.x,n=this.downwardDirectionOffset.y;this.attacker.y>this.target.y&&(r=this.upwardDirectionOffset.x,n=this.upwardDirectionOffset.y),this.attacker.display.isFaceLeft()&&(r=-r);let a=this.attacker.x+r,o=this.attacker.y+n;this.rotation=Jh.Angle.Between(a,o,this.target.x,this.target.y-this.heightOffset);let h=this.displayWidth*Math.cos(this.rotation),l=this.displayWidth*Math.sin(this.rotation);this.setPosition(a+h,o+l)}},AK=PE;var _E=E(ve()),{FRAME:vAe}=T.GAMEPLAY,{UNIT_SIZE_SCALE:gAe}=L,IE=class extends Ye{isGoToLeft;constructor(e,i){i.frame=vAe.BOOMERANG,super(e,i),this.setOrigin(.5,.5);let s=gAe;this.setDisplaySize(12*s,27.5*s),this.upwardDirectionOffset=new _E.Vector2(0,-20),this.downwardDirectionOffset=new _E.Vector2(0,-20);let r=this.downwardDirectionOffset.x,n=this.downwardDirectionOffset.y;this.attacker.y>this.target.y&&(r=this.upwardDirectionOffset.x,n=this.upwardDirectionOffset.y),this.setPosition(this.attacker.x+r,this.attacker.y+n),this.isGoToLeft=this.attacker.display.isFaceLeft()}update(e,i){this.isGoToLeft?this.angle-=i*1.5:this.angle+=i*1.5,super.update(e,i)}},xK=IE;var LE=E(ve()),{FRAME:SAe}=T.GAMEPLAY,{UNIT_SIZE_SCALE:EAe}=L,ME=class extends Ye{isGoToLeft;constructor(e,i){i.frame=SAe.MACE,super(e,i),this.setOrigin(.4,.4);let s=EAe;this.setDisplaySize(36.5*s,14.5*s),this.upwardDirectionOffset=new LE.Vector2(20,-40),this.downwardDirectionOffset=new LE.Vector2(10,0);let r=this.downwardDirectionOffset.x,n=this.downwardDirectionOffset.y;this.attacker.y>this.target.y&&(r=this.upwardDirectionOffset.x,n=this.upwardDirectionOffset.y),this.attacker.display.isFaceLeft()&&(r=-r),this.setPosition(this.attacker.x+r,this.attacker.y+n),this.isGoToLeft=this.attacker.display.isFaceLeft()}update(e,i){this.isGoToLeft?this.angle-=i*.9:this.angle+=i*.9,super.update(e,i)}},CK=ME;var Qh=E(ve()),{FRAME:TAe}=T.GAMEPLAY,{UNIT_SIZE_SCALE:yAe}=L,OE=class extends Ye{constructor(e,i){i.frame=TAe.ARROW_1,super(e,i),this.setOrigin(1,.5);let s=yAe;this.setDisplaySize(38.5*s,10*s),this.upwardDirectionOffset=new Qh.Vector2(5,-10),this.downwardDirectionOffset=new Qh.Vector2(5,-8);let r=this.downwardDirectionOffset.x,n=this.downwardDirectionOffset.y;this.attacker.y>this.target.y&&(r=this.upwardDirectionOffset.x,n=this.upwardDirectionOffset.y),this.attacker.display.isFaceLeft()&&(r=-r);let a=this.attacker.x+r,o=this.attacker.y+n;this.rotation=Qh.Angle.Between(a,o,this.target.x,this.target.y-this.heightOffset);let h=this.displayWidth*Math.cos(this.rotation),l=this.displayWidth*Math.sin(this.rotation);this.setPosition(a+h,o+l)}},wK=OE;var el=E(ve()),{FRAME:bAe}=T.GAMEPLAY,{UNIT_SIZE_SCALE:AAe}=L,DE=class extends Ye{constructor(e,i){i.frame=bAe.ARROW_2,super(e,i),this.setOrigin(1,.5);let s=AAe;this.setDisplaySize(37*s,11*s),this.upwardDirectionOffset=new el.Vector2(15,-15),this.downwardDirectionOffset=new el.Vector2(15,-15);let r=this.downwardDirectionOffset.x,n=this.downwardDirectionOffset.y;this.attacker.y>this.target.y&&(r=this.upwardDirectionOffset.x,n=this.upwardDirectionOffset.y),this.attacker.display.isFaceLeft()&&(r=-r);let a=this.attacker.x+r,o=this.attacker.y+n;this.rotation=el.Angle.Between(a,o,this.target.x,this.target.y-this.heightOffset);let h=this.displayWidth*Math.cos(this.rotation),l=this.displayWidth*Math.sin(this.rotation);this.setPosition(a+h,o+l)}},RK=DE;var tl=E(ve()),{FRAME:xAe}=T.GAMEPLAY,{UNIT_SIZE_SCALE:CAe}=L,BE=class extends Ye{constructor(e,i){i.frame=xAe.BOLT_1,super(e,i),this.setOrigin(1,.5);let s=CAe;this.setDisplaySize(38*s,6*s),this.upwardDirectionOffset=new tl.Vector2(20,-30),this.downwardDirectionOffset=new tl.Vector2(20,12);let r=this.downwardDirectionOffset.x,n=this.downwardDirectionOffset.y;this.attacker.y>this.target.y&&(r=this.upwardDirectionOffset.x,n=this.upwardDirectionOffset.y),this.attacker.display.isFaceLeft()&&(r=-r);let a=this.attacker.x+r,o=this.attacker.y+n;this.rotation=tl.Angle.Between(a,o,this.target.x,this.target.y-this.heightOffset);let h=this.displayWidth*Math.cos(this.rotation),l=this.displayWidth*Math.sin(this.rotation);this.setPosition(a+h,o+l)}},PK=BE;var il=E(ve()),{FRAME:wAe}=T.GAMEPLAY,{UNIT_SIZE_SCALE:RAe}=L,UE=class extends Ye{constructor(e,i){i.frame=wAe.BOLT_2,super(e,i),this.setOrigin(1,.5);let s=RAe;this.setDisplaySize(46*s,9.5*s),this.upwardDirectionOffset=new il.Vector2(20,-40),this.downwardDirectionOffset=new il.Vector2(20,10);let r=this.downwardDirectionOffset.x,n=this.downwardDirectionOffset.y;this.attacker.y>this.target.y&&(r=this.upwardDirectionOffset.x,n=this.upwardDirectionOffset.y),this.attacker.display.isFaceLeft()&&(r=-r);let a=this.attacker.x+r,o=this.attacker.y+n;this.rotation=il.Angle.Between(a,o,this.target.x,this.target.y-this.heightOffset);let h=this.displayWidth*Math.cos(this.rotation),l=this.displayWidth*Math.sin(this.rotation);this.setPosition(a+h,o+l)}},_K=UE;var NE=E(ve()),{FRAME:PAe}=T.GAMEPLAY,{UNIT_SIZE_SCALE:_Ae}=L,FE=class extends Ye{isGoToLeft;constructor(e,i){i.frame=PAe.FIRE_RING,super(e,i),this.setOrigin(.5,.5);let s=_Ae;this.setDisplaySize(34.5*s,36*s),this.upwardDirectionOffset=new NE.Vector2(20,-40),this.downwardDirectionOffset=new NE.Vector2(20,0);let r=this.downwardDirectionOffset.x,n=this.downwardDirectionOffset.y;this.attacker.y>this.target.y&&(r=this.upwardDirectionOffset.x,n=this.upwardDirectionOffset.y),this.attacker.display.isFaceLeft()&&(r=-r),this.setPosition(this.attacker.x+r,this.attacker.y+n),this.isGoToLeft=this.attacker.display.isFaceLeft()}update(e,i){this.isGoToLeft?this.angle-=i*.9:this.angle+=i*.9,super.update(e,i)}},IK=FE;var sl=E(ve()),{FRAME:IAe}=T.GAMEPLAY,{UNIT_SIZE_SCALE:LAe}=L,kE=class extends Ye{constructor(e,i){i.frame=IAe.BLUE_FIRE,super(e,i),this.setOrigin(1,.5);let s=LAe;this.setDisplaySize(70.5*s,33.5*s),this.upwardDirectionOffset=new sl.Vector2(40,-60),this.downwardDirectionOffset=new sl.Vector2(50,35);let r=this.downwardDirectionOffset.x,n=this.downwardDirectionOffset.y;this.attacker.y>this.target.y&&(r=this.upwardDirectionOffset.x,n=this.upwardDirectionOffset.y),this.attacker.display.isFaceLeft()&&(r=-r);let a=this.attacker.x+r,o=this.attacker.y+n;this.rotation=sl.Angle.Between(a,o,this.target.x,this.target.y-this.heightOffset);let h=this.displayWidth*Math.cos(this.rotation),l=this.displayWidth*Math.sin(this.rotation);this.setPosition(a+h,o+l)}},LK=kE;var GE=E(ve()),{FRAME:MAe}=T.GAMEPLAY,{UNIT_SIZE_SCALE:OAe}=L,qE=class extends Ye{constructor(e,i){i.frame=MAe.GREEN_FIRE,super(e,i),this.setOrigin(1,.5);let s=OAe;this.setDisplaySize(50*s,50*s),this.upwardDirectionOffset=new GE.Vector2(30,-70),this.downwardDirectionOffset=new GE.Vector2(40,0);let r=this.downwardDirectionOffset.x,n=this.downwardDirectionOffset.y;this.attacker.y>this.target.y&&(r=this.upwardDirectionOffset.x,n=this.upwardDirectionOffset.y),this.attacker.display.isFaceLeft()&&(r=-r),this.setPosition(this.attacker.x+r,this.attacker.y+n);let{animationManager:a}=this.scene;a.addLevel11ProjectileAnimation(),this.play(zn.GREEN_FIRE.KEY,!0)}},MK=qE;var WE=class{unit;scene;constructor(e){this.unit=e,this.scene=e.scene}createProjectile(e){let{level:i,speed:s,target:r}=e,n={attacker:this.unit,target:r,speed:s},a;switch(i){case 1:a=new bK(this.unit.scene,n);break;case 2:a=new AK(this.unit.scene,n);break;case 3:a=new xK(this.unit.scene,n);break;case 4:a=new CK(this.unit.scene,n);break;case 5:a=new wK(this.unit.scene,n);break;case 6:a=new RK(this.unit.scene,n);break;case 7:a=new PK(this.unit.scene,n);break;case 8:a=new _K(this.unit.scene,n);break;case 9:a=new IK(this.unit.scene,n);break;case 10:a=new LK(this.unit.scene,n);break;case 11:a=new MK(this.unit.scene,n);break;default:a=new Ye(this.unit.scene,n)}let{unitManager:o}=this.scene;o.rangedProjectiles.add(a)}},OK=WE;var DK=E(Ds()),YE=class extends ht{unit;spriteBelowAnimKey;spineBelowAnimKey;constructor(e,i){super(e,{spineAnimKey:i.spineAboveAnimKey,spriteAnimKey:i.spriteAboveAnimKey,status:i.status}),this.spriteBelowAnimKey=i.spriteBelowAnimKey,this.spineBelowAnimKey=i.spineBelowAnimKey,this.unit=e}execute(){let{spriteAnimKey:e,spineAnimKey:i,status:s}=this.payload,r=this.unit.attackController.getAttackTarget();if(!r){this.unit.setStatus(Ce.FINISHED_ATTACKING);return}this.unit.setStatus(s),this.unit.display.setAnimationTimeScale(1),this.unit.y>r.y?this.unit.display.play(this.spriteBelowAnimKey,this.spineBelowAnimKey,!1):this.unit.display.play(e,i,!1),this.unit.display.addAnimEventListener(F.RANGED.CUSTOM_EVENTS.FINISHED_ATTACKING,this.handleAttacked),this.unit.display.setFlipX(r.x<=this.unit.x)}handleAttacked=()=>{if(this.unit.isKilled())return;let e=this.unit.attackController.getAttackTarget();e&&(e.isKilled()&&this.unit.display.addAnimEventListener(DK.ANIMATION_COMPLETE,this.handleFinishedAttacking),this.unit.projectileController.createProjectile({level:this.unit.level,target:e}),q.playSound(J.ARROW_SHOOT,{volume:.5}))};handleFinishedAttacking=()=>{this.unit.setStatus(Ce.FINISHED_ATTACKING)}},BK=YE;var UK=E(Ds()),HE=class extends ht{execute(){let{spriteAnimKey:e,spineAnimKey:i,status:s}=this.payload;this.unit.setStatus(s),this.unit.attackEvent?.remove(),this.unit.uiController.killHpBar(),this.unit.depthController.setDepthOnDeath(),this.unit.effectController.stopDamageEffect(),this.unit.display.setAnimationTimeScale(1),this.unit.display.play(e,i,!1,!0),this.unit.display.addAnimEventListener(UK.ANIMATION_COMPLETE,this.handleAnimationComplete)}handleAnimationComplete=()=>{this.unit.effectController.runDieEffect()}},NK=HE;var zE=class extends ht{execute(){let{spriteAnimKey:e,spineAnimKey:i,status:s}=this.payload;this.unit.revive(),this.unit.setStatus(s),this.unit.isDepthDirty=!0,this.unit.uiController.killHpBar(),this.unit.effectController.stopDieEffect(),this.unit.display.setFlipX(!1),this.unit.display.play(e,i,!0,!0),this.unit.display.setAnimationTimeScale(.5+Math.random()),this.unit.attackController.reset()}},FK=zE;var VE=class extends ht{execute(){let{spriteAnimKey:e,spineAnimKey:i,status:s}=this.payload;this.unit.setStatus(s),this.unit.uiController.reviveHpBar(),this.unit.display.play(e,i,!0,!0),this.unit.display.setAnimationTimeScale(.5+Math.random())}},kK=VE;var XE=class extends qc{unit;constructor(e){super(e),this.unit=e}addAttackCommand(){this.attackCommand=new BK(this.unit,{status:Ce.ATTACKING,spriteAboveAnimKey:this.getSpriteAnimKeyByUnitLevel("ATTACK_ABOVE"),spriteBelowAnimKey:this.getSpriteAnimKeyByUnitLevel("ATTACK_BELOW"),spineAboveAnimKey:this.getSpineAnimKeyByUnitLevel("ATTACK_ABOVE"),spineBelowAnimKey:this.getSpineAnimKeyByUnitLevel("ATTACK_BELOW")})}addReadyCommand(){this.readyCommand=new kK(this.unit,{status:Ce.READY,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("IDLE"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("IDLE")})}addMoveCommand(){this.moveCommand=new ht(this.unit,{status:Ce.MOVING_TO_TARGET,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("IDLE"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("IDLE")})}addDieCommand(){this.dieCommand=new NK(this.unit,{status:Ce.KILLED,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("DIE"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("DIE")})}addPrepareCommand(){this.prepareCommand=new FK(this.unit,{status:Ce.PREPARE,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("IDLE"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("IDLE")})}resetRangedAttackAnimation(){this.addAttackCommand()}getSpriteAnimKeyByUnitLevel(e){try{let{level:i}=this.unit,s=i;return s>=2&&(s=1),Te.RANGED[s][e].KEY}catch(i){return console.warn(i),Te.ALIEN[1].IDLE.KEY}}getSpineAnimKeyByUnitLevel(e){let i=F.RANGED[e];if(!i)throw new Error(`Can't find spine animation ${e}`);return i}},KE=XE;var ZE=class extends K{projectileColor;projectileSpeed;projectileController;constructor(e,i,s,r,n,a){super(e,i,s,r,n,a),this.projectileController=new OK(this),this.unitType=L.RANGED_UNIT_TYPE,this.attackInterval=L.RANGED_ATTACK_INTERVAL;let o=this.display.getSpineAnimationAttackingTime();this.attackInterval<o&&(this.attackInterval=o),this.projectileSpeed=L.RANGED_PROJECTILE_SPEED}createActions(){this.actions=new KE(this)}determineCounteringEnemy(){let{beingAttackedByMelee:e,beingAttackedByRanged:i}=this.attackController,s=this.attackController.getAttackTarget();return s?.isKilled()&&(s=null),e&&!e.isKilled()?(this.attackController.setAttackTarget(e),!0):i&&!i.isKilled()?(this.attackController.setAttackTarget(i),!0):!1}setUnitData(e){super.setUnitData(e),this.unitType=L.RANGED_UNIT_TYPE}update(e,i){if(super.update(e,i),this.isKilled()||!this.scene.stateManager.isInPlayingState())return;let s=this.attackController.getAttackTarget();if(this.isReady()){!this.determineCounteringEnemy()&&(!s||s.isKilled())&&this.findTarget(),s&&this.setStatus(Ce.PREPARE_TO_ATTACK);return}if(this.isPreparingToAttack()){if(s?.isKilled()){this.actions.ready();return}this.attack();return}this.isAttacking()&&s?.isKilled()&&this.display.getAnimationTimeScale()!==3&&(this.display.setAnimationTimeScale(3),this.display.changeCurrentSpriteEventTime()),this.isFinishedAttacking()&&this.actions.ready()}reuseUnitFromPool(e){super.reuseUnitFromPool(e);let i=this.actions;i instanceof KE&&i.resetRangedAttackAnimation()}},Ge=ZE;var{KEY:DAe}=T.UNITS_SPINES.RANGED[10],jE=class extends Ge{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:DAe,spineConfig:{animation:F.RANGED.IDLE,loop:!0}},useSpine:!0})}},$E=jE;var{KEY:BAe}=T.UNITS_SPINES.RANGED[11],JE=class extends Ge{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:BAe,spineConfig:{animation:F.RANGED.IDLE,loop:!0}},useSpine:!0})}},QE=JE;var{KEY:UAe,FRAME:NAe}=T.UNITS_SPRITES,{KEY:FAe}=T.UNITS_SPINES.RANGED[1],eT=class extends Ge{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:FAe,spineConfig:{animation:F.RANGED.IDLE,loop:!0}},sprite:{key:UAe,frame:NAe.RANGED[1].MAIN_TEXTURE,displayWidth:55,displayHeight:73},useSpine:!0})}},tT=eT;var{KEY:kAe}=T.UNITS_SPINES.RANGED[2],iT=class extends Ge{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:kAe,spineConfig:{animation:F.RANGED.IDLE,loop:!0}},useSpine:!0})}},sT=iT;var{KEY:GAe}=T.UNITS_SPINES.RANGED[3],rT=class extends Ge{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:GAe,spineConfig:{animation:F.RANGED.IDLE,loop:!0}},useSpine:!0})}},nT=rT;var{KEY:qAe}=T.UNITS_SPINES.RANGED[4],aT=class extends Ge{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:qAe,spineConfig:{animation:F.RANGED.IDLE,loop:!0}},useSpine:!0})}},oT=aT;var{KEY:WAe}=T.UNITS_SPINES.RANGED[5],hT=class extends Ge{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:WAe,spineConfig:{animation:F.RANGED.IDLE,loop:!0}},useSpine:!0})}},lT=hT;var{KEY:YAe}=T.UNITS_SPINES.RANGED[6],uT=class extends Ge{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:YAe,spineConfig:{animation:F.RANGED.IDLE,loop:!0}},useSpine:!0})}},cT=uT;var{KEY:HAe}=T.UNITS_SPINES.RANGED[7],dT=class extends Ge{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:HAe,spineConfig:{animation:F.RANGED.IDLE,loop:!0}},useSpine:!0})}},fT=dT;var{KEY:zAe}=T.UNITS_SPINES.RANGED[8],pT=class extends Ge{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:zAe,spineConfig:{animation:F.RANGED.IDLE,loop:!0}},useSpine:!0})}},mT=pT;var{KEY:VAe}=T.UNITS_SPINES.RANGED[9],vT=class extends Ge{constructor(e,i,s){super(e,0,0,i,s,{spine:{key:VAe,spineConfig:{animation:F.RANGED.IDLE,loop:!0}},useSpine:!0})}},gT=vT;var ST=class extends Wc{requestUnitByLevel(e,i,s=!1){let r=this.getUnitFromResourcePoolByLevel(e);return r?(i&&!s&&(this.numOfPlayerSpawnedUnits+=Math.pow(2,e-1)),r.reuseUnitFromPool(i),this.scene.add.existing(r),r):(r=this.createUnitByLevel(e,i,s),r)}requestUnitById(e,i,s=!1){let r=this.getUnitFromResourcePoolById(e);return r?(i&&!s&&(this.numOfPlayerSpawnedUnits+=Math.pow(2,r.level-1)),r.reuseUnitFromPool(i),this.scene.add.existing(r),r):(r=this.createUnitById(e,i,s),r)}requestBossByLevel(e){return new br(this.scene,!1)}createUnitByLevel(e,i,s=!1){let r,n=this.getUnitDataByLevel(e);switch(e){case 1:r=new tT(this.scene,i,n);break;case 2:r=new sT(this.scene,i,n);break;case 3:r=new nT(this.scene,i,n);break;case 4:r=new oT(this.scene,i,n);break;case 5:r=new lT(this.scene,i,n);break;case 6:r=new cT(this.scene,i,n);break;case 7:r=new fT(this.scene,i,n);break;case 8:r=new mT(this.scene,i,n);break;case 9:r=new gT(this.scene,i,n);break;case 10:r=new $E(this.scene,i,n);break;case 11:r=new QE(this.scene,i,n);break;default:return new br(this.scene,i)}return i&&!s&&(this.numOfPlayerSpawnedUnits+=Math.pow(2,e-1)),r}createUnitById(e,i,s=!1){let r,n=this.getUnitDataById(e);if(!n)return new br(this.scene,i);switch(e){case"rockthrower":r=new tT(this.scene,i,n);break;case"javelineer":r=new sT(this.scene,i,n);break;case"boomeranger":r=new nT(this.scene,i,n);break;case"macer":r=new oT(this.scene,i,n);break;case"artemis":r=new lT(this.scene,i,n);break;case"william":r=new cT(this.scene,i,n);break;case"blanchette":r=new fT(this.scene,i,n);break;case"phantom":r=new mT(this.scene,i,n);break;case"oracle":r=new gT(this.scene,i,n);break;case"shaman":r=new $E(this.scene,i,n);break;case"seraph":r=new QE(this.scene,i,n);break;default:return new br(this.scene,i)}return i&&!s&&(this.numOfPlayerSpawnedUnits+=Math.pow(2,n.level-1)),r}getUnitDataByLevel(e){return this.scene.cache.json.get("unitData").ranged[e-1]}getUnitDataById(e){return this.scene.cache.json.get("unitData").ranged.find(s=>s.id===e)}getUnitFromResourcePoolByLevel(e){let s=this.resourcePool.getChildren().find(r=>r instanceof Ge?r.level===e:!1);if(s instanceof K)return this.resourcePool.remove(s),s}getUnitFromResourcePoolById(e){let s=this.resourcePool.getChildren().find(r=>{if(!(r instanceof Ge))return!1;let{originalUnitData:n}=r;return n.id===e});if(s instanceof K)return this.resourcePool.remove(s),s}getUnitFromBossResoucePool(e){}},GK=ST;var Hc=E(he()),{STATUS:qK}=kt,{MELEE_UNIT_TYPE:ei,RANGED_UNIT_TYPE:Zi,ALIEN_UNIT_TYPE:WK}=L,{MaximumMeleeLevel:ET,MaximumRangedLevel:TT}=le,{modifier:rl}=le.Powers.SpeedUp,{player:Zn}=codex,{Utils:{Valid:XAe}}=Ludex,yT=class extends xe{scene;meleeSpawnPool;rangedSpawnPool;isPostGame;playerUnits;enemyUnits;rangedProjectiles;latestUnitMergePayload;constructor(e){super(e),this.scene=e,this.latestUnitMergePayload={level:1,type:"melee"},this.createFactories(),this.createUnitGroups()}init(){super.init(),this.initSpawnPools(),this.emptyEnemyUnits(),this.emptyPlayerUnits(),this.emptyProjectiles()}start(){this.isRunning()||(this.listenEvents(),this.createEnemyUnits(),this.checkForPostGame(),this.createPlayerUnitsNormal(),this.calculatePlayerTotalUnitsUsed(),this.setState(qK.RUNNING))}stop(){this.isRunning()&&(this.stopDieEffectOfAllUnits(),this.setReadyAllUnits(),this.removeAttackEventsOfAllUnits(),this.hideAllUnits(),this.disableDragOnPlayerUnits(),this.runChildUpdateGroups(!1),this.setState(qK.STOPPED))}listenEvents(){this.scene.events.off(Ss.SUMMON_MINIONS,this.handleBossSummonMinions),this.scene.events.on(Ss.SUMMON_MINIONS,this.handleBossSummonMinions),this.scene.events.off(Ss.SUMMON_RANGED_MINIONS,this.handleBossSummonRangedMinions),this.scene.events.on(Ss.SUMMON_RANGED_MINIONS,this.handleBossSummonRangedMinions),this.scene.events.off(Ss.SUMMON_AMBUSH,this.handleBossSummonAmbush),this.scene.events.on(Ss.SUMMON_AMBUSH,this.handleBossSummonAmbush)}createFactories(){this.meleeSpawnPool=new yK(this.scene),this.rangedSpawnPool=new GK(this.scene)}createUnitGroups(){this.enemyUnits=this.scene.add.group(),this.playerUnits=this.scene.add.group(),this.rangedProjectiles=this.scene.add.group()}runChildUpdateGroups(e){this.enemyUnits.runChildUpdate=e,this.playerUnits.runChildUpdate=e,this.rangedProjectiles.runChildUpdate=e}initSpawnPools(){this.meleeSpawnPool.init(),this.rangedSpawnPool.init()}emptyEnemyUnits(){this.enemyUnits.getChildren().forEach(i=>{if(!(i instanceof K))return;i.handleRemoveFromScene();let{unitType:s}=i;s===ei&&this.meleeSpawnPool.returnToPool(i),s===Zi&&this.rangedSpawnPool.returnToPool(i)}),this.enemyUnits.clear(!0,!1)}emptyPlayerUnits(){this.playerUnits.getChildren().forEach(i=>{if(!(i instanceof K))return;i.handleRemoveFromScene();let{unitType:s}=i;s===ei&&this.meleeSpawnPool.returnToPool(i),s===Zi&&this.rangedSpawnPool.returnToPool(i)}),this.playerUnits.clear(!0,!1)}emptyProjectiles(){this.rangedProjectiles.clear(!0,!0)}getPlayerUnits(){return this.playerUnits.getChildren()}getEnemyUnits(){return this.enemyUnits.getChildren()}getTotalPlayerUnitsHp(){let e=0;return this.playerUnits.getChildren().forEach(i=>{i instanceof K&&(e+=i.currentHp)}),e}getTotalEnemyUnitsHp(){let e=0;return this.enemyUnits.getChildren().forEach(i=>{i instanceof K&&(e+=i.currentHp)}),e}getPlayerMeleeSpawnedUnitsCount(){return this.meleeSpawnPool.getPlayerSpawnedUnitsCount()}getPlayerRangedSpawnedUnitsCount(){return this.rangedSpawnPool.getPlayerSpawnedUnitsCount()}createPlayerArcher(e,i,s=1){if(!this.isRunning())return;let{fieldManager:r,spineManager:n}=this.scene,a=r.getRemainingAvailablePlacement()===1,o=this.checkIfBoardCanBeMerged(),h=this.getLowestLevelPlayerRangedUnit(),l=a&&!o&&h>s?h:s,c=this.createUnit({level:l,isPlayer:!0,unitType:Zi});c.spawnUnitOnSquare(e,i,!0),n.addSpines([c]),this.resetAttackSpots(c),this.playerUnits.add(c)}createPlayerMelee(e,i,s=1){if(!this.isRunning())return;let{fieldManager:r,spineManager:n}=this.scene,a=r.getRemainingAvailablePlacement()===1,o=this.checkIfBoardCanBeMerged(),h=this.getLowestLevelPlayerMeleeUnit(),l=a&&!o&&h>s?h:s,c=this.createUnit({level:l,isPlayer:!0,unitType:ei});c.spawnUnitOnSquare(e,i,!0),n.addSpines([c]),this.resetAttackSpots(c),this.playerUnits.add(c)}createEnemyUnits(){let{levelManager:e}=this.scene;e.enemyData.forEach(s=>{let r;s.isBoss?r=this.createBossUnit(s.level):r=this.createUnit({level:s.level,isPlayer:!1,unitType:s.type==="melee"?ei:Zi}),r.spawnUnitOnSquare(s.positionRow,s.positionColumn,!1),r.actions.prepare(),this.resetAttackSpots(r),this.enemyUnits.add(r)})}createPlayerUnitsNormal(){this.playerUnits.getLength()===0?this.loadPlayerUnits():this.reusePlayerUnits();let{uiManager:e}=this.scene;this.playerUnits.getLength()>0&&e.enableStartButton()}createPlayerUnitsLevelBuilder(){let{levelManager:e}=this.scene;e.playerData.forEach(s=>{let r=this.createUnit({level:s.level,isPlayer:!0,unitType:s.type==="melee"?ei:Zi});r.spawnUnitOnSquare(s.positionRow,s.positionColumn,!0),this.resetAttackSpots(r),this.playerUnits.add(r)})}stopDieEffectOfAllUnits(){this.enemyUnits.getChildren().forEach(e=>{e instanceof K&&e.effectController.stopDieEffect()}),this.playerUnits.getChildren().forEach(e=>{e instanceof K&&e.effectController.stopDieEffect()})}setReadyAllUnits(){let e=this.playerUnits.getChildren();e.sort((s,r)=>{if(!(s instanceof K)||!(r instanceof K))throw new Mt;let{currentLocation:{rowId:n,colId:a}}=s,{currentLocation:{rowId:o,colId:h}}=r;return n===o?a-h:n-o}),e.forEach(s=>{if(!(s instanceof K))throw new Mt;s.isDepthDirty=!0,s.actions.ready()});let i=this.enemyUnits.getChildren();i.sort((s,r)=>{if(!(s instanceof K)||!(r instanceof K))throw new Mt;let{currentLocation:{rowId:n,colId:a}}=s,{currentLocation:{rowId:o,colId:h}}=r;return n===o?a-h:o-n}),i.forEach(s=>{if(!(s instanceof K))throw new Mt;s.isDepthDirty=!0,s.actions.ready()})}removeAttackEventsOfAllUnits(){this.enemyUnits.getChildren().forEach(e=>{e instanceof K&&e.attackEvent?.remove()}),this.playerUnits.getChildren().forEach(e=>{e instanceof K&&e.attackEvent?.remove()})}getUnitBasedOnPosition(e,i){let s=null;return this.playerUnits.getChildren().forEach(r=>{if(!(r instanceof K))throw new Mt;r.currentLocation.rowId===e&&r.currentLocation.colId===i&&(s=r)}),s}mergeUnits(e,i){let{effectManger:s}=this.scene,r=e.level+1,n=e.unitType,a=i.currentLocation;if(r>(n===ei?ET:TT))return!1;let h=this.createUnit({level:r,unitType:n,isPlayer:!0,isMerged:!0});if(!h)return!1;s.playMergeEffect(i),Wt.vibrate(50),e.handleRemoveFromScene(),i.handleRemoveFromScene(),n===ei&&(this.meleeSpawnPool.returnToPool(e),this.meleeSpawnPool.returnToPool(i),this.playerUnits.remove(e,!0,!1),this.playerUnits.remove(i,!0,!1)),n===Zi&&(this.rangedSpawnPool.returnToPool(e),this.rangedSpawnPool.returnToPool(i),this.playerUnits.remove(e,!0,!1),this.playerUnits.remove(i,!0,!1)),this.latestUnitMergePayload={type:n,level:r},h.spawnUnitOnSquare(a.rowId,a.colId,!0),this.playerUnits.add(h),this.resetAttackSpots(h);let{uiManager:l,spineManager:c}=this.scene;c.addSpines([h]),l.updateUIData(),this.savePlayerUnits();let d=this.checkIfNewUnitIsUnlocked(r,n);return!0}checkIfNewUnitIsUnlocked(e,i){let s=Zn.getGameData();if(i===L.MELEE_UNIT_TYPE){let r=s?.meleeUnlockedUnitLevel??0;if(!r||typeof r!="number")return Zn.setGameData({meleeUnlockedUnitLevel:e}),!0;if(e>r)return Zn.setGameData({meleeUnlockedUnitLevel:e}),!0}if(i===L.RANGED_UNIT_TYPE){let r=s?.rangedUnlockedUnitLevel??0;if(!r||typeof r!="number")return Zn.setGameData({rangedUnlockedUnitLevel:e}),!0;if(e>r)return Zn.setGameData({rangedUnlockedUnitLevel:e}),!0}return!1}reusePlayerUnits(){let e=this.playerUnits.getChildren();for(let i of e){if(!(i instanceof K))throw new Mt;i.reuseUnitOnReady(),this.resetAttackSpots(i)}}loadPlayerUnits(){let e=Zn.getGameData()?.playerUnitData??"";if(!e||typeof e!="string")return;e.split("/").forEach((s,r)=>{s.split("-").forEach((a,o)=>{if(a==="0")return;let h=WK;if(a[0].startsWith("m")?h=ei:a[0].startsWith("r")&&(h=Zi),h===WK)return;let l=this.createUnit({level:parseInt(a.substring(1)),isPlayer:!0,unitType:a[0].startsWith("m")?ei:Zi});l.spawnUnitOnSquare(r+1,o+1,!0),this.resetAttackSpots(l),this.playerUnits.add(l)})})}checkIfBoardCanBeMerged(){let e=this.playerUnits.getChildren(),i=new Map,s=new Map;for(let h of e){if(!(h instanceof K))continue;let{level:l,unitType:c}=h;switch(c){case ei:{let d=i.get(l);d?i.set(l,d+1):i.set(l,1);break}case Zi:{let d=s.get(l);d?s.set(l,d+1):s.set(l,1);break}}}let n=Array.from(i,([h,l])=>({key:h,value:l})).some(h=>{let{key:l,value:c}=h;return c>1&&l+1<=ET}),o=Array.from(s,([h,l])=>({key:h,value:l})).some(h=>{let{key:l,value:c}=h;return c>1&&l+1<=TT});return n||o}createUnit(e){let{id:i,level:s,unitType:r,isPlayer:n,isMerged:a}=e,{fieldBackground:o}=this.scene.fieldManager,h=o.scale*I.getPixelRatio();switch(r){case L.MELEE_UNIT_TYPE:if(i){let l=this.meleeSpawnPool.requestUnitById(i,n,a);return l.setScale(h),this.setTargetControllerForUnit(l),l}if(s){let l=this.meleeSpawnPool.requestUnitByLevel(s,n,a);return l.setScale(h),this.setTargetControllerForUnit(l),l}return this.meleeSpawnPool.requestUnitByLevel(-1,n,a);case L.RANGED_UNIT_TYPE:if(i){let l=this.rangedSpawnPool.requestUnitById(i,n,a);return l.setScale(h),this.setTargetControllerForUnit(l),l}if(s){let l=this.rangedSpawnPool.requestUnitByLevel(s,n,a);return l.setScale(h),this.setTargetControllerForUnit(l),l}return this.rangedSpawnPool.requestUnitByLevel(-1,n,a);default:return this.meleeSpawnPool.requestUnitByLevel(-1,n,a)}}createBossUnit(e){let{fieldBackground:i}=this.scene.fieldManager,s=i.scale*I.getPixelRatio()*1.7,r=this.meleeSpawnPool.requestBossByLevel(e);return r.setScale(s),this.setTargetControllerForUnit(r),r}preparePlayerUnits(){let e=this.playerUnits.getChildren();for(let i of e){if(!(i instanceof K))throw new Mt;i.actions.prepare()}}enableDragOnPlayerUnits(){let e=this.playerUnits.getChildren();for(let i of e)i instanceof K&&i.startEventListener()}disableDragOnPlayerUnits(){let e=this.playerUnits.getChildren();for(let i of e)i instanceof K&&i.removeEventListener()}serializePlayerUnitData(){let e=this.playerUnits.getChildren();e.sort((r,n)=>{if(!(r instanceof K)||!(n instanceof K))throw new Mt;let{currentLocation:{rowId:a,colId:o}}=r,{currentLocation:{rowId:h,colId:l}}=n;return a===h?o-l:a-h});let i="",s=0;for(let r=0;r<3;r++){let n="";for(let a=0;a<5;a++){let o=s>=e.length?null:e[s];if(o instanceof K){let{rowId:h,colId:l}=o.currentLocation;if(h===r+1&&l===a+1){let c=this.createUnitDataForSaving(o);n+=c,s++}else n+="0"}else n+="0";a!==4&&(n+="-")}i+=n,r!==2&&(i+="/")}return i}createUnitDataForSaving(e){if(!e)return"0";let{unitType:i,level:s}=e;return`${i===ei?"m":"r"}${s}`}savePlayerUnits(){this.scene.levelManager.isInLevelBuilderLevel()||this.scene.updateUnitData()}calculatePlayerTotalUnitsUsed(){let e=this.playerUnits.getChildren(),i=0,s=0;for(let r of e){if(!(r instanceof K))throw new Mt;if(r.unitType===ei){let n=2**(r.level-1);i+=n}if(r.unitType===Zi){let n=2**(r.level-1);s+=n}}this.meleeSpawnPool.setSpawnedUnits(i),this.rangedSpawnPool.setSpawnedUnits(s)}getLowestLevelPlayerMeleeUnit(){let i=this.playerUnits.getChildren().filter(r=>{if(!(r instanceof K))throw new Mt;return r.unitType===ei});return i.length===0?1:i.reduce((r,n)=>{if(!(n instanceof K))throw new Mt;return!r||!(r instanceof K)||n.level<r.level?n:r}).level}getLowestLevelPlayerRangedUnit(){let i=this.playerUnits.getChildren().filter(r=>{if(!(r instanceof K))throw new Mt;return r.unitType===Zi});return i.length===0?1:i.reduce((r,n)=>{if(!(n instanceof K))throw new Mt;return!r||!(r instanceof K)||n.level<r.level?n:r}).level}getUnitDataForUnlockingScreen(){let{level:e,type:i}=this.latestUnitMergePayload;return i===L.MELEE_UNIT_TYPE?this.meleeSpawnPool.getUnitDataByLevel(e):this.rangedSpawnPool.getUnitDataByLevel(e)}resetAttackSpots(e){e.attackController.resetAttackSpots()}hideAllUnits(){let e=this.enemyUnits.getChildren();for(let s of e)s instanceof K&&(s.kill(),s.uiController.killHpBar());let i=this.playerUnits.getChildren();for(let s of i)s instanceof K&&(s.kill(),s.uiController.killHpBar())}hideAllProjectiles(){this.rangedProjectiles.killGroup()}showAllProjectiles(){this.rangedProjectiles.reviveGroup()}showAllAliveUnits(){let e=this.enemyUnits.getChildren();for(let s of e)s instanceof K&&(s.isKilled()||(s.revive(),this.scene.stateManager.isInPlayingState()||s.runFadeInAnimation()));let i=this.playerUnits.getChildren();for(let s of i)s instanceof K&&(s.isKilled()||(s.revive(),this.scene.stateManager.isInPlayingState()||s.runFadeInAnimation()))}showAllHpBarUnits(){let e=this.enemyUnits.getChildren();for(let s of e)s instanceof K&&(s.isKilled()||s.uiController.reviveHpBar());let i=this.playerUnits.getChildren();for(let s of i)s instanceof K&&(s.isKilled()||s.uiController.reviveHpBar())}getSameCoupleUnits(){let e=new Map,i=this.playerUnits.getChildren();for(let s of i){if(!(s instanceof K))throw new Mt;let{level:r,unitType:n}=s;if(n===L.MELEE_UNIT_TYPE&&r>=ET||n===L.RANGED_UNIT_TYPE&&r>=TT)continue;let a=`${r}${n}`,o=e.get(a);if(o)return{unit1:o,unit2:s};e.set(a,s)}return null}getFirstMeleeUnit(){let e=this.playerUnits.getChildren();for(let i=0;i<e.length;i++){let s=e[i];if(!(s instanceof K))throw new Mt;let{unitType:r}=s;if(r===L.MELEE_UNIT_TYPE)return s}return null}getFirstRangedUnit(){let e=this.playerUnits.getChildren();for(let i=0;i<e.length;i++){let s=e[i];if(!(s instanceof K))throw new Mt;let{unitType:r}=s;if(r===L.RANGED_UNIT_TYPE)return s}return null}speedUpAllUnits(){this.scene.powerManager.isSpeedUp=!0;let e=this.enemyUnits.getChildren();for(let s of e)s instanceof K&&(s.display.setAnimationTimeScale(rl),s.modifyCurrentAttackEvent());let i=this.playerUnits.getChildren();for(let s of i)s instanceof K&&(s.display.setAnimationTimeScale(rl),s.modifyCurrentAttackEvent())}resetSpeedAllUnits(){this.scene.powerManager.isSpeedUp=!1;let e=this.enemyUnits.getChildren();for(let s of e)s instanceof K&&(s.display.setAnimationTimeScale(1),s.modifyCurrentAttackEvent());let i=this.playerUnits.getChildren();for(let s of i)s instanceof K&&(s.display.setAnimationTimeScale(1),s.modifyCurrentAttackEvent())}checkForPostGame(){let i=Zn.getGameData()?.gameCompletedCount??0;if(!XAe.isNumber(i)){this.isPostGame=!1;return}this.isPostGame=i>0}setTargetControllerForUnit(e){this.isPostGame?e.setTaretControllerToPostGame():e.setTargetControllerToDefault()}handleBossSummonMinions=e=>{if(!this.scene.stateManager.isInPlayingState())return;let i=[{x:1,y:1},{x:1,y:5},{x:3,y:1},{x:3,y:5}],s=[];for(let n=0;n<4;n++){let a=i[n],o=this.createUnit({level:e>1?e-1:1,isPlayer:!1,unitType:ei});o.summonMinionOnSquare(a.x,a.y),this.enemyUnits.add(o),this.scene.uiManager.setTotalHpBar(-o.currentHp,!1),s.push(o)}let{isSpeedUp:r}=this.scene.powerManager;this.scene.tweens.add({targets:s,alpha:{from:0,to:1},duration:r?250:500,ease:Hc.Sine.Out,onComplete:()=>{if(this.setReadyAllUnits(),!!this.scene.powerManager.isSpeedUp)for(let n of s)n.display.setAnimationTimeScale(rl),n.modifyCurrentAttackEvent()}})};handleBossSummonRangedMinions=e=>{if(!this.scene.stateManager.isInPlayingState())return;let i=[{x:1,y:1},{x:1,y:5},{x:3,y:1},{x:3,y:5}],s=[];for(let n=0;n<2;n++){let a=i[n],o=this.createUnit({level:e>1?e-1:1,isPlayer:!1,unitType:Zi});o.summonMinionOnSquare(a.x,a.y),this.enemyUnits.add(o),this.scene.uiManager.setTotalHpBar(-o.currentHp,!1),s.push(o)}let{isSpeedUp:r}=this.scene.powerManager;this.scene.tweens.add({targets:s,alpha:{from:0,to:1},duration:r?250:500,ease:Hc.Sine.Out,onComplete:()=>{if(this.setReadyAllUnits(),!!this.scene.powerManager.isSpeedUp)for(let n of s)n.display.setAnimationTimeScale(rl),n.modifyCurrentAttackEvent()}})};handleBossSummonAmbush=e=>{if(!this.scene.stateManager.isInPlayingState())return;let i=[{x:1,y:1},{x:1,y:5},{x:3,y:1},{x:3,y:5}],s=[];for(let n=0;n<2;n++){let a=i[n],o=this.createUnit({level:e>3?e-3:3,isPlayer:!1,unitType:ei});o.summonMinionOnSquare(a.x,a.y,!0),this.enemyUnits.add(o),this.scene.uiManager.setTotalHpBar(-o.currentHp,!1),s.push(o)}let{isSpeedUp:r}=this.scene.powerManager;this.scene.tweens.add({targets:s,alpha:{from:0,to:1},duration:r?250:500,ease:Hc.Sine.Out,onComplete:()=>{if(this.setReadyAllUnits(),!!this.scene.powerManager.isSpeedUp)for(let n of s)n.display.setAnimationTimeScale(rl),n.modifyCurrentAttackEvent()}})}},YK=yT;var HK=E(X()),bT=E(he()),{KEY:KAe,FRAME:ZAe}=T.GAMEPLAY,AT=class extends HK.Container{hand;constructor(e){super(e),this.name="TapTutorialHand",this.addHand(),this.scene.add.existing(this)}addHand(){this.hand=this.scene.make.image({key:KAe,frame:ZAe.GUIDE_HAND,origin:{x:.5,y:.5}}),this.hand.setWorldSize(65.5,55.5),this.setSize(65.5,55.5),this.add(this.hand)}playAnimation(e=0,i=800){let s=1/I.getPixelRatio();this.hand.angle=30,this.scene?.tweens.add({delay:e,targets:[this.hand],ease:bT.Cubic.Out,props:{alpha:{start:0,value:1,duration:200},scale:{duration:400,start:s*1.6,to:s*1.2},angle:{from:30,value:0,duration:400}},onComplete:()=>{this.scene?.tweens.add({targets:[this.hand],delay:200,duration:200,ease:bT.Cubic.Out,props:{alpha:0},onComplete:()=>{this.hand.x=0,this.hand.y=0,this.hand.scale=s,this.playAnimation(i)}})}})}stopAnimation(){this.scene.tweens.killTweensOf(this.hand)}preDestroy(){this.scene.tweens.killTweensOf(this.hand)}},zc=AT;var ci={GUIDE_ONE:"GuideOne",GUIDE_TWO:"GuideTwo",GUIDE_PREVENT:"GuidePrevent",GUIDE_THREE:"GuideThree"};var xT=class{manager;constructor(e){this.manager=e}setup(){this.startGuide()}startGuide=()=>{let{uiManager:e}=this.manager.scene;this.manager.scene.time.delayedCall(500,()=>{se.trackTutorialStep(1)}),e.showUIForGuide1();let i=e.getStartBtnWorldPosition();this.showTapHand(i.x,i.y),e.addOnceCallbackForStartBtn(this.closeTutorial)};showTapHand(e,i){let{tapHand:s}=this.manager;s.setDepth(B.ON_TOP),s.setPosition(e+s.width/2,i+s.height/2),s.revive(),s.stopAnimation(),s.playAnimation(300)}closeTutorial=()=>{let{uiManager:e}=this.manager.scene;this.manager.stopTutorial(),e.startFight()}},zK=xT;var jn=E(nt()),{Plugins:{Analytics:{Events:e$e}}}=Ludex,CT=class{manager;currentStep;targetUnit1;targetUnit2;wrongUnit;constructor(e){this.manager=e,this.currentStep=0}setup(){this.startGuide()}startGuide=()=>{let{uiManager:e,unitManager:i}=this.manager.scene,s=i.getPlayerUnits(),r=s.length,n=!1;for(let o of s)if(o.level===2){n=!0;break}if(r===2&&n){this.showStep3();return}if(r>=3){this.handleOnClick();return}this.currentStep=1,this.manager.scene.giveEnoughCoins("MELEE"),e.showUIForGuide3(1);let a=e.getMeleeBlockConfig();this.createHighlightItem(a),this.showTapHand(a.worldX,a.worldY),se.trackTutorialStep(6),e.addOnceCallbackForMeleeBlock(this.handleOnClick),this.manager.scene.input.setTopOnly(!0)};createHighlightItem(e){let{worldX:i,worldY:s,width:r,height:n}=e,a=20;this.manager.createMask(i-r/2-a,s-n/2-a,r+a*2,n+a*2)}handleOnClick=()=>{let{uiManager:e,unitManager:i}=this.manager.scene;this.currentStep=2,this.manager.scene.input.setTopOnly(!1),this.manager.background.kill(),W.getGlobalScene()?.requestBackgroundMaskUpdate("TutorialManager",0),e.showUIForGuide3(2),this.manager.tapHand.stopAnimation(),this.manager.tapHand.kill(),se.trackTutorialStep(7);let r=i.getSameCoupleUnits(),n=i.getFirstRangedUnit();if(!r||!n){this.showStep3();return}this.targetUnit1=r.unit2,this.targetUnit2=r.unit1,this.wrongUnit=n,this.createHint()};createHint(){let{x:e,y:i}=this.targetUnit1.getWorldPosition(),{x:s,y:r}=this.targetUnit2.getWorldPosition();this.createHandAt(e,i,s,r),this.createEvents()}createEvents(){this.targetUnit1.addOnceEvent(jn.GAMEOBJECT_DRAG_END,this.handleOnDragEnd),this.targetUnit2.addOnceEvent(jn.GAMEOBJECT_DRAG_END,this.handleOnDragEnd),this.wrongUnit.addOnceEvent(jn.GAMEOBJECT_DRAG_END,this.handleOnDragEnd)}createHandAt(e,i,s,r){this.manager.hand.setDepth(B.ON_TOP),this.manager.hand.setPosition(e,i),this.manager.hand.revive(),this.manager.hand.setTarget(s,r),this.manager.hand.stopAnimation(),this.manager.hand.playAnimation(300)}handleOnDragEnd=()=>{if(this.manager.hand.kill(),this.targetUnit1.removeOnceEvent(jn.GAMEOBJECT_DRAG_END,this.handleOnDragEnd),this.targetUnit2.removeOnceEvent(jn.GAMEOBJECT_DRAG_END,this.handleOnDragEnd),this.wrongUnit.removeOnceEvent(jn.GAMEOBJECT_DRAG_END,this.handleOnDragEnd),this.targetUnit1.isKilled()||this.targetUnit2.isKilled()){se.trackTutorialStep(8),this.showStep3();return}this.createHint()};showStep3(){let{uiManager:e}=this.manager.scene;this.currentStep=3,e.showUIForGuide3(3);let i=e.getStartBtnWorldPosition();this.showTapHand(i.x,i.y),se.trackTutorialStep(9),e.addOnceCallbackForStartBtn(this.closeTutorial)}showTapHand(e,i){let{tapHand:s}=this.manager;s.setDepth(B.ON_TOP),s.setPosition(e+s.width/2,i+s.height/2),s.revive(),s.stopAnimation(),s.playAnimation(300)}closeTutorial=()=>{se.trackTutorialStep(10),this.manager.scene.time.delayedCall(500,()=>{se.trackTutorialComplete()});let{uiManager:e}=this.manager.scene;this.currentStep=0,this.manager.stopTutorial(),e.startFight()};reupdateUI(){let{uiManager:e}=this.manager.scene;this.currentStep!==0&&e.showUIForGuide3(this.currentStep)}},VK=CT;var wT=E(nt()),RT=class{manager;currentStep;guideUnit;targetSquare;constructor(e){this.manager=e,this.currentStep=0}setup(){this.startGuide()}startGuide=()=>{let{uiManager:e,unitManager:i}=this.manager.scene;if(i.getPlayerUnits().length===2){this.showStep3();return}this.currentStep=1,this.manager.scene.giveEnoughCoins("RANGED"),e.showUIForGuide2(1);let r=e.getRangedBlockConfig();this.createHighlightItem(r),this.showTapHand(r.worldX,r.worldY),se.trackTutorialStep(2),e.addOnceCallbackForRangedBlock(this.handleOnClickRangedBlock),this.manager.scene.input.setTopOnly(!0)};createHighlightItem(e){let{worldX:i,worldY:s,width:r,height:n}=e,a=20;this.manager.createMask(i-r/2-a,s-n/2-a,r+a*2,n+a*2)}handleOnClickRangedBlock=()=>{let{uiManager:e,unitManager:i,fieldManager:s}=this.manager.scene;this.currentStep=2,this.manager.scene.input.setTopOnly(!1),this.manager.background.kill(),W.getGlobalScene()?.requestBackgroundMaskUpdate("TutorialManager",0),e.showUIForGuide2(2),this.manager.tapHand.stopAnimation(),this.manager.tapHand.kill(),se.trackTutorialStep(3);let n=i.getFirstMeleeUnit(),a=s.getSquareBasedOnIndex(1,3);if(!a||!n)throw new Error("Guide fail due to target square or unit null");if(this.guideUnit=n,this.targetSquare=a,this.guideUnit.currentLocation===this.targetSquare){this.showStep3();return}this.createHint()};handleOnDragEnd=()=>{let{unitManager:e}=this.manager.scene;this.manager.hand.kill(),e.getPlayerUnits().forEach(r=>{r.removeOnceEvent(wT.GAMEOBJECT_DRAG_END,this.handleOnDragEnd)});let s=this.guideUnit.getLastDragPos();s&&(s.y<268||s.y>458||s.x<29||s.x>346)&&this.guideUnit.dragUnitOnto(1,3),this.showStep3()};showStep3(){let{uiManager:e}=this.manager.scene;this.currentStep=3,e.showUIForGuide2(3);let i=e.getStartBtnWorldPosition();this.showTapHand(i.x,i.y),se.trackTutorialStep(4),e.addOnceCallbackForStartBtn(this.closeTutorial)}createHint(){let{unitManager:e}=this.manager.scene,{x:i,y:s}=this.guideUnit.getWorldPosition(),{x:r,y:n}=this.targetSquare.getWorldPosition();this.createHandAt(i,s,r,n),e.getPlayerUnits().forEach(o=>{o.addOnceEvent(wT.GAMEOBJECT_DRAG_END,this.handleOnDragEnd)})}createHandAt(e,i,s,r){this.manager.hand.setDepth(B.ON_TOP),this.manager.hand.setPosition(e,i),this.manager.hand.revive(),this.manager.hand.setTarget(s,r),this.manager.hand.stopAnimation(),this.manager.hand.playAnimation(300)}showTapHand(e,i){let{tapHand:s}=this.manager;s.setDepth(B.ON_TOP),s.setPosition(e+s.width/2,i+s.height/2),s.revive(),s.stopAnimation(),s.playAnimation(300)}closeTutorial=()=>{this.currentStep=0;let{uiManager:e}=this.manager.scene;e.startFight(),this.manager.stopTutorial()};reupdateUI(){let{uiManager:e}=this.manager.scene;this.currentStep!==0&&e.showUIForGuide2(this.currentStep)}},XK=RT;var PT=class{manager;constructor(e){this.manager=e}setup(){this.startGuide()}startGuide=()=>{let{uiManager:e}=this.manager.scene;e.showUIForGuidePrevent();let i=e.getStartBtnWorldPosition();this.showTapHand(i.x,i.y),e.addOnceCallbackForStartBtn(this.closeTutorial)};showTapHand(e,i){let{tapHand:s}=this.manager;s.setDepth(B.ON_TOP),s.setPosition(e+s.width/2,i+s.height/2),s.revive(),s.stopAnimation(),s.playAnimation(300)}closeTutorial=()=>{let{uiManager:e}=this.manager.scene;this.manager.stopTutorial(),e.startFight()};reupdateUI(){let{uiManager:e}=this.manager.scene;e.showUIForGuidePrevent()}},KK=PT;var ZK=E(ie()),jK=E(he());var{Utils:{Valid:jAe}}=Ludex,{player:x$e}=codex,{STATUS:_T}=kt,{Tutorial:IT}=le,{KEY:$Ae,FRAME:JAe}=T.DEFAULT,LT=class extends xe{scene;tutorialId;lastTutorialId;tutorialsDisplayed;isAnalyticFirstSent=!0;hand;tapHand;background;maskGraphics;tutOne;tutTwo;tutPrevent;tutThree;constructor(e){super(e),this.scene=e,this.createHand(),this.createTapHand(),this.createBackground(),this.initTutorialData()}getLastTutorialId(){return this.lastTutorialId}initTutorialData(){this.tutorialId="",this.lastTutorialId="",this.tutorialsDisplayed=[]}init(){this.hand.kill(),this.tapHand.kill(),this.background.kill(),this.setState(_T.READY)}start(){if(!this.isRunning()){if(this.isNothingToDisplay()){W.getGlobalScene()?.requestBackgroundMaskUpdate("TutorialManager",0);return}this.setState(_T.RUNNING)}}stop(){if(!this.isRunning())return;this.scene.tweens.killTweensOf([this.hand,this.tapHand,this.background]),W.getGlobalScene()?.requestBackgroundMaskUpdate("TutorialManager",0),this.setState(_T.STOPPED)}displayCount(e){return this.tutorialsDisplayed.filter(s=>s===e).length}hasDisplayedEnough(e){if(!Object.prototype.hasOwnProperty.call(IT.NumberOfTutorial,e))return!0;let i=IT.NumberOfTutorial[e];return jAe.isNumber(i)?i===-1?!1:this.displayCount(e)>=i:!0}isNothingToDisplay(){let e=this.scene.levelManager.getCurrentLevelId(),s=de.getGameCompletedCount()>0;return this.scene.gameMode===ne.BATTLE||e>=3||s?!0:Object.keys(IT.NumberOfTutorial).filter(n=>!this.hasDisplayedEnough(n)).length<1}showTutorial(){if(!this.isRunning())return;this.isAnalyticFirstSent&&(se.trackTutorialBegin(),this.isAnalyticFirstSent=!1);let{unitManager:e}=this.scene,i=this.scene.levelManager.getCurrentLevelId();if(i===1){if(e.getPlayerUnits().length===1&&!this.hasDisplayedEnough(ci.GUIDE_ONE)){this.startTutorial(ci.GUIDE_ONE);return}if(!this.hasDisplayedEnough(ci.GUIDE_TWO)){this.startTutorial(ci.GUIDE_TWO);return}this.startTutorial(ci.GUIDE_PREVENT)}else i===2&&this.startTutorial(ci.GUIDE_THREE)}startTutorial=e=>{if(!this.isRunning())return!1;if(this.isNothingToDisplay())return this.stop(),!1;if(this.hasDisplayedEnough(e))return!1;switch(this.background.kill(),W.getGlobalScene()?.requestBackgroundMaskUpdate("TutorialManager",0),e){case ci.GUIDE_ONE:this.tutOne=new zK(this),this.tutOne.setup();break;case ci.GUIDE_TWO:this.tutTwo=new XK(this),this.tutTwo.setup();break;case ci.GUIDE_PREVENT:this.tutPrevent=new KK(this),this.tutPrevent.setup();break;case ci.GUIDE_THREE:this.tutThree=new VK(this),this.tutThree.setup();break;default:return!1}return this.isRunning()?(this.tutorialId=e,this.lastTutorialId=e,this.tutorialsDisplayed.push(this.tutorialId),!0):!1};reupdateGuideUI(){this.tutorialId!==""&&(this.tutorialId===ci.GUIDE_TWO?this.tutTwo.reupdateUI():this.tutorialId===ci.GUIDE_PREVENT?this.tutPrevent.reupdateUI():this.tutorialId===ci.GUIDE_THREE&&this.tutThree.reupdateUI())}stopTutorial(){this.tutorialId="",this.hand.kill(),this.tapHand.kill(),this.background.kill(),W.getGlobalScene()?.requestBackgroundMaskUpdate("TutorialManager",0)}createHand(){this.hand=new Sc(this.scene),this.hand.kill(),this.hand.setDepth(B.PRIORITY)}createTapHand(){this.tapHand=new zc(this.scene),this.tapHand.kill(),this.tapHand.setDepth(B.PRIORITY)}createBackground(){this.background=this.scene.make.image({key:$Ae,frame:JAe.BLANK}),this.background.setInteractive(),this.scene.input.setTopOnly(!1),this.background.setTint(0),this.background.setAlpha(.8),W.getGlobalScene()?.requestBackgroundMaskUpdate("TutorialManager",.8),this.background.setDepth(B.PRIORITY);let{displayWidth:i,displayHeight:s}=this.scene.gameZone,r=i+100,n=s+100;this.background.setDisplaySize(r,n),ZK.Align.In.Center(this.background,this.scene.gameZone)}createMask(e,i,s,r,n=10){this.maskGraphics?.destroy(),this.maskGraphics=this.scene.make.graphics({fillStyle:{color:16711680,alpha:1}}),this.maskGraphics.setName("MaskGraphics"),this.maskGraphics.fillRoundedRect(e,i,s,r,n),this.background.setActive(!0),this.background.setVisible(!0),this.background.clearMask(!0),this.background.setMask(this.maskGraphics.createGeometryMask()),this.background.mask.invertAlpha=!0,this.runShowMaskAnimation()}createMultiMask(e){this.maskGraphics?.destroy(),this.maskGraphics=this.scene.make.graphics({fillStyle:{color:16711680,alpha:1}}),this.maskGraphics.setName("MaskGraphics"),e.forEach(i=>{this.maskGraphics.fillRoundedRect(i.x,i.y,i.width,i.height,i.radius)}),this.background.setVisible(!0),this.background.setActive(!0),this.background.clearMask(!0),this.background.setMask(this.maskGraphics.createGeometryMask()),this.background.mask.invertAlpha=!0,this.runShowMaskAnimation()}runShowMaskAnimation(){let e=[this.background];this.background.setAlpha(0),W.getGlobalScene()?.requestBackgroundMaskUpdate("TutorialManager",0),this.scene.tweens.killTweensOf(e),this.scene.tweens.add({targets:e,duration:300,ease:jK.Quadratic.Out,props:{alpha:{from:0,to:.8}},onUpdate:(s,r)=>{W.getGlobalScene()?.requestBackgroundMaskUpdate("TutorialManager",r.alpha)}})}},$K=LT;var JK=E(Fc()),QAe=(0,JK.default)(.48,1.57,.6,.83),So=QAe;var exe={duration:400,ease:So,props:{scale:"-=0.1"}},Vc=exe;var txe={targets:[],duration:400,ease:So,props:{scale:"+=0.1"}},Xc=txe;var QK=E(X()),e4=E(Wr()),Ar=E(nt()),MT=E(qe()),t4=E(Fi()),OT=class extends QK.Container{useSound=!0;isClicked=!1;disabledFlag=!1;scaleUp=1;scaleDown=.985;button;upAnimation;downAnimation;isUsePixelPerfect=!1;hitArea;hitZone;hitSoundEffectKey=J.BUTTON_CLICK;scaleDownPress;constructor(e,i,s,r,n,a=!1){super(e),this.isUsePixelPerfect=a,this.setDepth(B.BUTTON),this.createButton(i,s,r,n),this.updateSize(),this.listenEvents(),this.scene.add.existing(this)}listenEvents(){this.scene.events.on(MT.SLEEP,this.handleSceneSleep),this.once(e4.DESTROY,this.handelObjectDestroy)}handelObjectDestroy=()=>{this.scene&&this.scene.events.off(MT.SLEEP,this.handleSceneSleep)};handleSceneSleep=()=>{this.scene&&this.scene.tweens.killTweensOf(this)};set onClick(e){this.hitArea?.off(Ar.GAMEOBJECT_POINTER_DOWN),this.hitArea?.off(Ar.GAMEOBJECT_POINTER_UP),this.hitArea?.off(Ar.GAMEOBJECT_POINTER_OUT),this.isUsePixelPerfect?(this.hitArea=this.button,this.hitArea.setInteractive({useHandCursor:!0,pixelPerfect:!0})):(this.hitArea=this.hitZone,this.updateSize(),this.hitArea.setInteractive({useHandCursor:!0})),this.hitArea.on(Ar.GAMEOBJECT_POINTER_DOWN,this.handlePointerDown),this.hitArea.on(Ar.GAMEOBJECT_POINTER_UP,this.handleOnClick(e)),this.hitArea.on(Ar.GAMEOBJECT_POINTER_OUT,this.handlePointerOut)}get isUsePixelPerFect(){return this.isUsePixelPerfect}getTargetScaleUp(){return this.scaleUp}getTargetScaleDown(){return this.scaleDown}setTargetScaleUp(e){this.scaleUp=e}setTargetScaleDown(e){this.scaleDown=e}handlePointerDown=()=>{this.isClicked||this.upAnimation?.isPlaying()||(this.isClicked=!0,this.runDownAnimation())};handleOnClick=e=>()=>{this.isClicked&&(this.upAnimation?.isPlaying()||(this.isClicked=!1,this.runUpAnimation(),this.upAnimation?.once(t4.TWEEN_COMPLETE,()=>{se.trackButtonClick(this.name),this.processCallback(e)})))};handlePointerOut=()=>{this.isClicked&&(this.upAnimation?.isPlaying()||(this.isClicked=!1,this.runUpAnimation()))};processCallback(e){this.upAnimation?.stop(),this.downAnimation?.stop(),this.scene?.tweens.killTweensOf(this),this.setScale(this.scaleUp),e()}setDisabled(e){e?(this.setAlpha(.5),this.hitArea?.disableInteractive()):(this.setAlpha(1),this.hitArea?.setInteractive()),this.disabledFlag=e}get isDisabled(){return this.disabledFlag}createButton(e,i,s,r){this.button=this.scene.add.image(0,0,e,i),s&&r&&this.button.setWorldSize(s,r);let{displayWidth:n,displayHeight:a}=this.button;this.hitZone=this.scene.make.zone({width:n,height:a}),this.add([this.button,this.hitZone])}updateSize(){let{width:e,height:i}=this.button,s=10,r=e/100*10,n=i/100*10,a=r<s?r:s,o=n<s?n:s;this.setSize(e+a,i+o),this.hitZone.setSize(e+a,i+o)}runDownAnimation(){this.useSound&&q.playSound(this.hitSoundEffectKey),this.downAnimation?.remove(),this.downAnimation=this.scene.tweens.add({...Vc,targets:[this],duration:150,props:{scale:this.scaleDown},onUpdate:()=>{this.hitZone.scale=1/this.scale}}),H.runTween(this.downAnimation)}runUpAnimation(){this.upAnimation?.remove(),this.upAnimation=this.scene.tweens.add({...Xc,targets:[this],duration:150,props:{scale:this.scaleUp},onUpdate:()=>{this.hitZone.scale=1/this.scale}}),H.runTween(this.upAnimation)}setButtonHitSoundEffect(e){this.hitSoundEffectKey=e}setScale(e,i){super.setScale(e,i);let s=e??1,n=(s+(i??s))/2;return this.scaleUp=n,this.scaleDown=n*.985,this}},fe=OT;var s4=E(ie()),r4=E(he());var{KEY:i4,FRAME:DT}=T.GAMEPLAY,{language:BT}=codex,UT=class extends fe{text;constructor(e){super(e,i4,DT.DASHBOARD_START_BTN,159,63),this.setName("StartFight"),this.createText(),this.runUpAnimation()}createText(){let e=BT.getCurrentLocale(),i=22,s=-6;switch(e){case"pt":case"es":case"ja":case"de":case"id":i=20;break;case"tr":i=20,s=-8;break;case"it":i=18}let r=P.buildText(BT.getText("START_FIGHT"),i).setDefaultShadow({offsetY:6}).setDefaultStroke().build(this.scene);this.add(r),s4.Align.In.Center(r,this,0,s),this.text=r}changeToDesktopFrame(){let e=BT.getCurrentLocale(),i=15;switch(e){case"pt":case"ja":case"de":case"id":case"tr":i=13;break;case"es":case"it":i=12;break}this.button.setFrame(DT.DASHBOARD_START_BTN_LANDSCAPE),this.updateSize(),this.text.setFontSize(i),this.text.setX(15);let s=this.scene.make.image({key:i4,frame:DT.DASHBOARD_BATTLE_ICON});s.setWorldSize(26.5,23.5),s.setPosition(-45,-3),this.add(s)}setDisabled(e){super.setDisabled(e),e||this.runUpAnimation()}runUpAnimation(){this.upAnimation?.destroy(),this.upAnimation=this.scene.tweens.chain({targets:this,tweens:[{...Xc,targets:[this],duration:150,props:{scale:this.scaleUp},onUpdate:()=>{this.hitZone.scale=1/this.scale}},{targets:this,yoyo:!0,repeat:-1,duration:180,ease:r4.Sine.InOut,props:{scale:{from:1,to:.95}}}]}),H.runTween(this.upAnimation)}handleOnClick=e=>()=>{this.isClicked&&(this.isClicked=!1,se.trackButtonClick(this.name),this.processCallback(e))};handlePointerDown=()=>{this.isClicked||(this.isClicked=!0,this.runDownAnimation())};updateSize(){let{width:e,height:i}=this.button,s=I.getPixelRatio(),r=10,n=e/100*10,a=i/100*10,o=n<r?n:r,h=a<r?a:r,l=(e+o)/s,c=(i+h)/s;this.setWorldSize(l,c),this.hitZone.setWorldSize(l,c)}},n4=UT;var a4=E(X()),{KEY:ixe,FRAME:sxe}=T.EFFECTS,NT=class extends a4.Container{emitter;constructor(e){super(e),this.scene=e,this.createEmitters(),this.setActive(!1),this.setVisible(!1),this.scene.add.existing(this)}createEmitters(){this.emitter=this.scene.add.particles(0,0,ixe,{frame:sxe.FX_STAR_YELLOW,alpha:{start:1,end:.8},speed:{min:50,max:150},scale:{start:.4,end:.7},lifespan:{min:600,max:1500},emitting:!0}),this.add(this.emitter)}explode(e,i,s){this.setActive(!0),this.setVisible(!0),this.emitter.explode(e,i,s)}},o4=NT;var h4=E(X()),{KEY:rxe,FRAME:nxe}=T.EFFECTS,FT=class extends h4.Container{emitter;constructor(e){super(e),this.scene=e,this.createEmitters(),this.setActive(!1),this.setVisible(!1)}createEmitters(){this.emitter=this.scene.add.particles(0,0,rxe,{frame:nxe.FX_COMET,alpha:{start:1,end:.8},speed:{min:40,max:80},scale:{start:.4,end:.7},lifespan:{min:400,max:600}}),this.add(this.emitter),this.emitter.stop()}explode(e,i,s){this.revive(),this.setPosition(i,s),this.emitter.explode(e)}},l4=FT;var kT=E(X());var di=E(ve()),u4=E(yc()),c4=E(Fi()),{KEY:axe,FRAME:oxe}=T.GAMEPLAY,GT=class extends kT.Container{coinGroup;containerGroup;startsExplosive;startsExplosiveSmall;startsExplosiveSmallTimer;gravity=300;constructor(e){super(e),this.setVisible(!0),this.coinGroup=this.scene.add.group({defaultKey:axe,defaultFrame:oxe.DASHBOARD_COINBAR_COIN}),this.containerGroup=this.scene.add.group({classType:kT.Container}),this.startsExplosive=new o4(e),this.startsExplosive.setDepth(B.ON_TOP+1),this.startsExplosiveSmall=new l4(e),this.startsExplosiveSmall.setDepth(B.ON_TOP+1),this.scene.add.existing(this)}createConfigOne(e,i,s){let r=e/300,n=new di.Vector2(0,0),a=new di.Vector2(0,-e),o=s?-1:1,h=di.RND.between(-90,90),l=h<0?1:(300-Math.abs(h))/300,c=(h+90)/180*180*l*r,d=di.RND.between(20,c+20),f=new di.Vector2(1,0);f.setAngle(h*Math.PI/180);let p=di.RND.between(-Math.abs(h)-15,-Math.abs(h)+15),m=d*(100-Math.abs(h))/100*r,v=di.RND.between(m*.2,m),g=new di.Vector2(1,0);g.setAngle(p*Math.PI/180);let S=o*f.x*d,y=f.y*d,b=o*g.x*v,x=g.y*v-e,A=new di.Vector2(S,y),w=new di.Vector2(b,x),C=new u4.CubicBezier(n,A,w,a),_=di.RND.between(1500+d*3,2e3+d*3),N=this.coinGroup.get(0,0);return N.revive(),N.setRotation(-i.rotation),N.setWorldSize(24,22),i.add(N),{from:0,to:1,duration:_,ease:"Sine.In",onUpdate:D=>{let Y=C.getPointAt(D.getValue());N.setPosition(Y.x,Y.y)},onComplete:D=>{if(N.kill(),D.totalProgress<1||(q.playSound(J.DIAMONDS_EAT),this.startsExplosiveSmallTimer&&!this.startsExplosiveSmallTimer.hasDispatched))return;this.startsExplosiveSmallTimer=this.scene.time.delayedCall(100,()=>null);let Y=N.getWorldPosition();this.startsExplosiveSmall.explode(10,Y.x,Y.y)}}}explode(e,i,s,r,n){if(e<=0)return[];this.startsExplosive.explode(30,i,s);let a=new di.Vector2(r-i,n-s),o=a.length(),h=this.containerGroup.get(i,s);h.setRotation(a.angle()+Math.PI/2),h.revive(),this.add(h);let l,c=0,d=[];for(let p=0;p<e;p++){let m=this.createConfigOne(o,h,p%2===0),v=this.scene.tweens.addCounter(m);d.push(v),m.duration>c&&(c=m.duration,l=v)}let f=()=>{for(let p of d)p.complete();this.startsExplosive.emitter.killAll(),this.startsExplosiveSmall.emitter.killAll(),h.kill()};return l?.once(c4.TWEEN_COMPLETE,()=>{h.kill(),this.scene.events.off("sleep",f)}),this.scene.events.once("sleep",f),d}},d4=GT;var Ri=E(ve()),f4=E(yc()),qT=class extends d4{createConfigOne(e,i,s){let r=e/300,n=new Ri.Vector2(0,0),a=new Ri.Vector2(0,-e),o=s?-1:1,h=Ri.RND.between(-90,90),l=h<0?1:(300-Math.abs(h))/300,c=(h+90)/180*180*l*r,d=Ri.RND.between(20,c+20),f=new Ri.Vector2(1,0);f.setAngle(h*Math.PI/180);let p=Ri.RND.between(-Math.abs(h)-15,-Math.abs(h)+15),m=d*(100-Math.abs(h))/100*r,v=Ri.RND.between(m*.2,m),g=new Ri.Vector2(1,0);g.setAngle(p*Math.PI/180);let S=o*f.x*d,y=f.y*d,b=o*g.x*v,x=g.y*v-e,A=new Ri.Vector2(S,y),w=new Ri.Vector2(b,x),C=new f4.CubicBezier(n,A,w,a),_=Ri.RND.between(750+d*3,1e3+d*3),N=this.coinGroup.get(0,0);return N.revive(),N.setRotation(-i.rotation),N.setWorldSize(24,22),i.add(N),{from:0,to:1,duration:_,ease:"Sine.In",onUpdate:D=>{let Y=C.getPointAt(D.getValue());N.setPosition(Y.x,Y.y)},onComplete:D=>{if(N.kill(),D.totalProgress<1||(q.playSound(J.DIAMONDS_EAT),this.startsExplosiveSmallTimer&&!this.startsExplosiveSmallTimer.hasDispatched))return;this.startsExplosiveSmallTimer=this.scene.time.delayedCall(100,()=>null);let Y=N.getWorldPosition();this.startsExplosiveSmall.explode(10,Y.x,Y.y)}}}},p4=qT;var g4=E(X()),S4=E(vr());var m4=E(X()),Kc=E(ve()),WT=class extends m4.Particles.Particle{scale;update(e,i,s){let r=super.update(e,i,s);return this.updateScale(),this.updateVelocity(),r}setScale(e){this.scale=(0,Kc.FloatBetween)(e.min,e.max)}easeInCubic(e){return e*e*e}updateScale(){let e=this.easeInCubic(1-this.lifeT);this.scaleX=this.scale*Math.sin(e*Math.PI),this.scaleY=this.scale*Math.sin(e*Math.PI)}updateVelocity(){this.velocityX+=(0,Kc.Between)(-1,1)}},v4=WT;var{KEY:hxe,FRAME:lxe}=T.EFFECTS,YT=class extends g4.Container{emitZone;emitter;constructor(e){super(e),this.scene=e,this.createEmitZone(),this.createEmitters(),this.scene.add.existing(this)}createEmitZone(){this.emitZone=new S4.Rectangle}createEmitters(){let e=1/I.getPixelRatio();this.emitter=this.scene.add.particles(0,0,hxe,{frame:lxe.FX_STAR_YELLOW,emitZone:{source:this.emitZone,type:"random"},frequency:200,speedX:{min:-1,max:1},speedY:{min:-9,max:-13},lifespan:{min:1e3,max:1500},scale:{min:.01,max:.015},emitCallback:i=>{i.setScale({min:e,max:e})},particleClass:v4}),this.add(this.emitter)}run(e,i,s,r,n){this.stop(),this.reset(),this.emitZone.setSize(r,n),this.setPosition(i-r/2,s-n/2),this.setSize(r,n),this.emitter.setQuantity(e),this.emitter.start()}stop(){this.emitter?.killAll(),this.emitter?.stop(),this.emitter?.destroy()}reset(){this.createEmitters()}},E4=YT;var jc=E(ie()),b4=E(he()),A4=E(Fi()),{KEY:T4,FRAME:Zc}=T.GAMEPLAY,{ID:uxe}=mo.FREE_COINS,{duration:cxe}=le.Powers.FreeCoins,{language:y4,player:HT}=codex,zT=class extends Oc{scene;lastUsedTime;collectText;remainingTimeText;glowEffect;timer;moveTween;sparkleEffect;remainingTime;originalX;originalY;constructor(e){super(e,uxe,T4,Zc.DASHBOARD_FREE_GOLD,47,50),this.scene=e,this.setName("FreeCoinsItem"),this.createGlowEffect(),this.createCollectText(),this.createRemainingTimeText(),this.createSparkleEffect()}playSound(){q.playSound(J.COIN_SPAWN_SOUND)}createRemainingTimeText(){this.remainingTimeText=P.buildText("00:00",13).setDefaultStroke().build(this.scene),this.remainingTimeText.setVisible(!1),this.add(this.remainingTimeText),this.bringToTop(this.remainingTimeText),jc.Align.In.BottomCenter(this.remainingTimeText,this.icon,0,-2)}createCollectText(){let e=11;switch(y4.getCurrentLocale()){case"es":case"pt":e=10;break;case"de":case"it":e=9;break}this.collectText=P.buildText(y4.getText("COLLECT").toUpperCase(),e).setDefaultStroke().build(this.scene),this.collectText.setVisible(!1),this.add(this.collectText),this.bringToTop(this.collectText),jc.Align.In.BottomCenter(this.collectText,this.icon,0,-2)}createGlowEffect(){this.glowEffect=this.scene.add.image(0,0,T4,Zc.DASHBOARD_FREE_GOLD_GLOW),this.glowEffect.setOrigin(0,0),this.glowEffect.setVisible(!1),this.glowEffect.setWorldSize(127.5,124.8),this.add(this.glowEffect),this.moveDown(this.glowEffect),this.moveUp(this.icon),jc.Align.In.Center(this.glowEffect,this,1,0)}createSparkleEffect(){this.sparkleEffect=new E4(this.scene),this.sparkleEffect.setDepth(B.ON_TOP)}enableItem(){this.visible&&this.isDisabled!==!1&&(this.isDisabled=!1,this.zone.setInteractive(),this.setAvailable(!0))}activeItem=()=>{if(this.isActive===!0||this.isDisabled===!0)return;this.isActive=!0;let{powerManager:e}=this.scene;e.isStopped()||(q.playSound(J.BUTTON_CLICK),this.activeLogic())};activeLogic(){this.rewardCoins()}disableItem(){this.isDisabled!==!0&&(this.zone.disableInteractive(),this.setAvailable(!1),this.isDisabled=!0)}deactivateItem=()=>{if(this.isActive===!1)return;this.isActive=!1;let{powerManager:e}=this.scene;e.isStopped()||this.deactivateLogic()};deactivateLogic(){this.stopTimer()}startCountdown(){if(this.stopTimer(),this.initRemainingWaitTime(),this.remainingTime===0){this.setAvailable(!0),this.enableItem();return}this.startTimer()}startTimer(){this.setRemainingTime(this.remainingTime),this.disableItem(),this.timer=this.scene.time.addEvent({delay:1e3,callback:this.timerCallback,loop:!0})}timerCallback=()=>{this.scene.scene.isPaused()||(this.remainingTime<2e3?(this.remainingTime=0,this.setRemainingTime(0),this.enableItem(),this.stopTimer()):(this.remainingTime-=1e3,this.setRemainingTime(this.remainingTime),this.disableItem()))};stopTimer(){this.timer?.remove()}initRemainingWaitTime(){if(!this.lastUsedTime){let r=HT.getGameData()?.freeCoinsLastUsedTime??-1;this.lastUsedTime=typeof r=="number"?r:-1}if(this.lastUsedTime<0){this.remainingTime=0;return}let e=Date.now(),i=cxe-(e-this.lastUsedTime);this.remainingTime=i>0?i:0}rewardCoins=()=>{let e=Date.now(),i=HT.getGameData();HT.setGameData({...i,freeCoinsLastUsedTime:e}),this.lastUsedTime=e;let{layoutManager:s,powerManager:r}=this.scene,n=this.calculateRewardCoins(),a=new p4(this.scene),{x:o,y:h}=s.objects.coinBar;a.setDepth(B.ON_TOP);let l=a.explode(10,this.x,this.y,o,h);for(let c of l)c.once(A4.TWEEN_COMPLETE,()=>{let d=n.clone();d.divide(10),Se.inst.addCoin(d),this.scene.updateUI()});this.scene.time.delayedCall(600,()=>{q.playSound(J.COIN_INCREASE_REPEATEDLY_SOUND)}),r.updateTimers()};getUnitLevelModifier(){let e=this.scene.getBuyingUnitLevel(),i=1;switch(e){case 1:i=6;break;case 2:i=4;break;case 3:i=2;break;default:break}return i+.5}calculateRewardCoins(){let{unitManager:e,coinManager:i}=this.scene,s=e.getPlayerMeleeSpawnedUnitsCount(),r=e.getPlayerRangedSpawnedUnitsCount(),n=i.getUnitPrice(s),a=i.getUnitPrice(r),o=this.getUnitLevelModifier(),h=a.biggerThan(n)?a:n;return h.multiply(o),h}setAvailable(e){this.collectText.setVisible(e),this.remainingTimeText.setVisible(!e),this.glowEffect.setVisible(e),this.icon.setFrame(e?Zc.DASHBOARD_FREE_GOLD:Zc.DASHBOARD_FREE_GOLD_OFF),e?(this.setVisible(!0),this.runMoveTween()):(this.stopMoveTween(),this.sparkleEffect.stop())}setRemainingTime(e){let i=Math.floor(e/1e3),s=Math.floor(i/60),r=i%60,n=r<10?`0${r}`:r.toString();this.remainingTimeText.setText(`${s}:${n}`)}runMoveTween(){this.stopMoveTween();let e=-2;this.moveTween=this.scene.tweens.add({targets:[this],duration:500,repeat:-1,ease:b4.Sine.InOut,props:{y:"-=2"},onStart:()=>{let i=this.scene.levelManager.currentLevelId<3;if(!this.originalX||!this.originalY){if(i)return;this.originalX=this.x,this.originalY=this.y}this.setPosition(this.originalX,this.originalY)},onStop:()=>{this.setPosition(this.originalX,this.originalY)},onRepeat:()=>{e=-e,this.moveTween.updateTo("y",this.originalY+e,!0),this.moveTween.data[0].duration=1e3}})}stopMoveTween(){this.moveTween?.stop(),this.moveTween?.remove()}setVisible(e){return e||this.sparkleEffect.stop(),e&&this.remainingTime<1e3&&this.sparkleEffect.run(1,this.x,this.y-2.5,this.width,this.height+5),super.setVisible(e)}},x4=zT;var C4=E(X()),{KEY:dxe,FRAME:fxe}=T.DEFAULT_8_BIT,VT=class extends C4.Image{anim;constructor(e){super(e,0,0,dxe,fxe.PRELOADER),this.runAnimation(),this.scene.add.existing(this)}runAnimation(){this.anim=this.scene.tweens.add({targets:this,props:{angle:{from:0,to:360}},duration:1200,repeat:-1})}setVisible(e){return super.setVisible(e),e?this.runAnimation():(this.anim.stop(),this.scene.tweens.remove(this.anim)),this}},Hs=VT;var w4=E(X()),R4=E(ie()),XT=E(ss()),P4=E(Wr()),{KEY:pxe,FRAME:mxe}=T.DEFAULT_8_BIT,KT=class extends w4.Container{payload;loading;photo;avtFrame;loadPhotoTimer;constructor(e,i){super(e),this.scene.add.existing(this),this.payload=i;let{size:s}=this.payload;this.setSize(s,s),this.createLoading(),this.createPhoto(),this.createFrame(),this.addDefaultListeners()}loadPhoto(e,i){if(this.payload.id=e,this.payload.url=i,this.loadPhotoTimer?.remove(),!e||!i){this.setPhoto(U.AVATAR_DEFAULT.KEY);return}let s=this.scene.textures.get(e);if(s&&s.key===e){this.handleLoadComplete(e);return}this.showLoading(!0);let{loadDelay:r=0}=this.payload||{};this.loadPhotoTimer=this.scene.time.delayedCall(r,this.handleLoadPhotoAfterDelay(e,i))}handleLoadPhotoAfterDelay=(e,i)=>()=>{let s=this.scene.textures.get(e);if(s&&s.key===e){this.handleLoadComplete(e);return}this.scene.load.once(`filecomplete-image-${e}`,this.handleLoadComplete),this.scene.load.image(e,i),this.scene.load.start()};addDefaultListeners(){this.scene.load.on(XT.FILE_LOAD_ERROR,this.handleLoadPhotoFailed),this.on(P4.DESTROY,()=>{this.loadPhotoTimer?.remove(),this.scene.load.off(XT.FILE_LOAD_ERROR,this.handleLoadPhotoFailed)})}handleLoadComplete=e=>{if(!this.scene)return;let{id:i}=this.payload;if(!i||i!==e)return;let s=`${i}_bordered_100`,r=this.scene.textures.get(s);if(r&&r.key===s){this.setPhoto(r.key);return}if(!!1){this.showLoading(!1);return}this.setPhoto(s)};handleLoadPhotoFailed=e=>{e.key===this.payload.id&&this.setDefaultAvatar(e.key)};setDefaultAvatar(e){this.loadPhoto(e,U.AVATAR_DEFAULT.FILE)}createLoading(){this.loading=new Hs(this.scene),this.loading.setWorldSize(this.width*.75,this.height*.75),this.loading.setVisible(!1),this.add(this.loading)}createPhoto(){this.photo=this.scene.make.image({x:0,y:0,origin:{x:.5,y:.5},visible:!1}),this.add(this.photo)}createFrame(){this.avtFrame=this.scene.make.image({key:pxe,frame:mxe.LEADERBOARD_AVATAR}),this.avtFrame.setWorldSize(34,38),this.add(this.avtFrame)}showLoading(e){this.photo.setVisible(!e),this.loading.setVisible(e)}setPhoto(e){this.showLoading(!1),this.photo.setTexture(e),this.photo.setFrame(0);let{size:i}=this.payload,s=i-10;this.photo.setWorldSize(s,s),R4.Align.In.Center(this.photo,this.avtFrame,0,-2)}},$c=KT;var ZT=class extends $c{constructor(e){super(e,{size:38}),this.avtFrame.kill()}handleLoadComplete=e=>{if(!this.scene)return;let{id:i}=this.payload;if(!i||i!==e)return;let s=i,r=this.scene.textures.get(s);if(r&&r.key===s){this.setPhoto(r.key);return}this.setPhoto(U.AVATAR_DEFAULT.KEY)}},_4=ZT;var L4=E(X());var{KEY:vxe,FRAME:I4}=T.GAMEPLAY,jT=class extends L4.Container{bg;avatar;level;constructor(e,i){super(e),this.setName("PlayerCard"),this.createAvatar(),this.createFrame(i),this.updateSize(),this.createLevelText(),this.scene.add.existing(this)}updateData(e){let{playerId:i,playerPhoto:s,playerLevel:r}=e;this.level.setText(`Lv. ${r}`),this.avatar.loadPhoto(i,s)}createFrame(e){let i=e?I4.DASHBOARD_AVATAR_FRAME_BLUE:I4.DASHBOARD_AVATAR_FRAME_RED,s=this.scene.make.image({key:vxe,frame:i});s.setName("bg"),s.setWorldSize(35.5,48.5),this.add(s),this.bg=s}updateSize(){this.setSize(this.bg.displayWidth,this.bg.displayHeight)}createAvatar(){let e=new _4(this.scene);e.setName("avatar"),e.setPosition(0,-4),this.add(e),this.avatar=e}createLevelText(){let e=P.createText(this.scene,"Lv. 1",8);e.setPosition(0,14),this.add(e),this.level=e}},$T=jT;var M4=E(X()),{KEY:gxe,FRAME:Sxe}=T.GAMEPLAY,JT=class extends M4.Container{playerFrame;opponentFrame;VS;constructor(e){super(e),this.createPlayerFrame(),this.createOpponentFrame(),this.createVS(),this.setDepth(B.BUTTON),this.scene.add.existing(this)}createPlayerFrame(){this.playerFrame=new $T(this.scene,!0),this.playerFrame.setName("playerFrame"),this.add(this.playerFrame),this.playerFrame.setPosition(28,0)}createOpponentFrame(){this.opponentFrame=new $T(this.scene,!1),this.opponentFrame.setName("opponentFrame"),this.add(this.opponentFrame),this.opponentFrame.setPosition(-28,0)}createVS(){this.VS=this.scene.make.image({key:gxe,frame:Sxe.DASHBOARD_VS}),this.VS.setWorldSize(17,14),this.VS.setName("VS"),this.add(this.VS)}updateData(e,i){e&&this.playerFrame.updateData(e),i&&this.opponentFrame.updateData(i)}changeToDesktopFrame(){this.playerFrame.setPosition(200/this.scale,60/this.scale),this.opponentFrame.setPosition(-200/this.scale,-225/this.scale),this.VS.kill()}},O4=JT;var U4=E(X()),QT=E(ie());var{KEY:D4,FRAME:B4}=T.GAMEPLAY,{language:Exe}=codex,ey=class extends U4.Container{bar;coinText;constructor(e){super(e),this.createBar(),this.createText(),this.createCoinIcon(),this.setDepth(B.BUTTON),this.scene.add.existing(this)}createBar(){this.bar=this.scene.make.image({key:D4,frame:B4.DASHBOARD_COINBAR_BG}),this.add(this.bar)}createCoinIcon(){let e=this.scene.make.image({key:D4,frame:B4.DASHBOARD_COINBAR_COIN});this.add(e),QT.Align.In.RightCenter(e,this,55,0)}createText(){let e=Exe.getCurrentLocale(),i=17;switch(e){case"tr":i=19;break}this.coinText=P.createText(this.scene,"0",i),this.add(this.coinText),QT.Align.In.Center(this.coinText,this.bar,-5,0)}setCoins(e){this.coinText.setText(`${e.toString()}`)}},N4=ey;var k4=E(X());var{MaxLevel:Txe}=le,{language:F4}=codex,ty=class extends k4.Container{text;constructor(e){super(e),this.createText(),this.setDepth(B.BUTTON),this.scene.add.existing(this)}createText(){this.text=P.buildText("").setDefaultShadow({offsetY:3}).setDefaultStroke().build(this.scene),this.add(this.text)}setLevel(e){let i=W.getCurrentScene();if(i instanceof Eo&&i.gameMode===ne.BOSS){let r=i.levelManager.getPlayerBossLevel();this.text.setText(F4.getText("BOSS_LEVEL",[`${r}`]).toUpperCase());return}let s=de.getGameCompletedCount();this.text.setText(`${F4.getText("LEVEL").toUpperCase()} ${e+s*Txe}`)}},G4=ty;var{KEY:Jc,FRAME:Qc}=T.GAMEPLAY,iy=class extends kc{front;iconImage;constructor(e){super(e,0),this.updateHealthBar(),this.setFrameSize(94.5,11.5),this.createIconImage()}updateHealthBar(){this.bg.setTexture(Jc),this.bg.setFrame(Qc.DASHBOARD_HPBAR_BG),this.frame.setTexture(Jc),this.frame.setFrame(Qc.DASHBOARD_HPBAR_RED),this.frame.setOrigin(1,.5),this.frame.setX(0);let e=this.scene.make.image({key:Jc,frame:Qc.DASHBOARD_HPBAR_FRONT,origin:{x:0,y:.5}});e.setWorldSize(this.hpLength,this.hpHeight),e.setX(-this.hpLength/2),this.add(e),this.front=e}createIconImage(){this.iconImage=this.scene.add.image(0,0,Jc,Qc.DASHBOARD_HPBAR_RED_HEART),this.iconImage.setWorldSize(20,19),this.iconImage.setX(-this.hpLength/2-this.iconImage.displayWidth/2+8),this.iconImage.setAngle(90),this.add(this.iconImage)}setFrameSize(e,i){this.hpLength=e,this.hpHeight=i,this.bg.setWorldSize(this.hpLength,this.hpHeight),this.bg.setX(-this.hpLength/2),this.front.setWorldSize(this.hpLength,this.hpHeight),this.front.setX(-this.hpLength/2),this.updateFrameUI(),this.frame.setX((-this.hpLength+2)/2)}updateFrameUI(){let e=this.currentHp/this.defaultHp*(-this.hpLength+2),i=Math.abs(e)>1?e:1;this.frame.setWorldSize(i,this.hpHeight-1)}},ed=iy;var{FRAME:q4}=T.GAMEPLAY,sy=class extends ed{updateHealthBar(){super.updateHealthBar(),this.frame.setFrame(q4.DASHBOARD_HPBAR_BLUE)}createIconImage(){super.createIconImage(),this.iconImage.setFrame(q4.DASHBOARD_HPBAR_BLUE_HEART)}},W4=sy;var Y4=E(X()),ry=class extends Y4.Container{scene;playerHpBar;enemyHpBar;constructor(e){super(e),this.scene=e,this.setDepth(B.BUTTON),this.createPlayerHpBar(),this.createEnemyHpBar(),this.setSize(300,200),this.init(),this.scene.add.existing(this)}init(){this.enemyHpBar.setInitHp(1),this.playerHpBar.setInitHp(1)}createPlayerHpBar(){this.playerHpBar=new W4(this.scene),this.playerHpBar.setAngle(-90),this.playerHpBar.setPosition(175,50),this.add(this.playerHpBar)}createEnemyHpBar(){this.enemyHpBar=new ed(this.scene),this.enemyHpBar.setAngle(-90),this.enemyHpBar.setPosition(-175,-160),this.add(this.enemyHpBar)}updateCurrentHp(){this.updateCurrentEnemyHp(),this.updateCurrentPlayerHp()}updateCurrentPlayerHp(){let e=this.scene.unitManager.getTotalPlayerUnitsHp();this.playerHpBar.setInitHp(e)}updatePlayerHpUIByMinus(e){this.playerHpBar.updateHpUIByMinus(e)}getCurrentPlayerHp(){return this.playerHpBar.getCurrentHp()}updateCurrentEnemyHp(){let e=this.scene.unitManager.getTotalEnemyUnitsHp();this.enemyHpBar.setInitHp(e)}updateEnemyHpUIByMinus(e){this.enemyHpBar.updateHpUIByMinus(e)}getCurrentEnemyHp(){return this.enemyHpBar.getCurrentHp()}},H4=ry;var z4=E(X());var Jn=E(ie()),ny=E(nt()),{KEY:nl,FRAME:xr}=T.GAMEPLAY,{language:$n}=codex,ay=class extends z4.Container{isDisable=!1;block;clickZone;adsBanner;unitImage;priceText;coinIcon;stampText;stampBanner;adsMode=!1;constructor(e,i,s){super(e),this.createBlock(),this.createZone(),this.updateSize(),this.createUnitImage(i),this.createPriceText(s),this.createMiniCoinIcon(),this.createAdsBanner()}updateSize(){let{displayWidth:e,displayHeight:i}=this.block;this.setSize(e,i)}createBlock(){this.block=this.scene.add.image(0,0,nl,xr.DASHBOARD_UNITBAR_BG),this.block.setWorldSize(71,77),this.add(this.block)}createZone(){let e=this.block.displayWidth,i=39/1.7,s=I.isLandscape()?0:i,r=this.block.displayHeight+s,n=.5-s/r/2;this.clickZone=this.scene.add.zone(0,0,e,r),this.clickZone.setOrigin(.5,n),this.add(this.clickZone)}getStampTextFontSize(){switch($n.getCurrentLocale()){case"pt":case"es":case"ja":case"zh":case"fr":case"id":case"de":case"it":return 12;case"tr":return 14;default:return 16}}getAdsTextFontSize(){switch($n.getCurrentLocale()){case"pt":case"es":case"tr":case"ja":case"zh":case"fr":case"id":case"it":return 12;default:return 11}}createStampsBanner(){if(this.stampText)return;let e=this.scene.make.container({});this.stampBanner=e;let i=this.scene.make.image({key:nl,frame:xr.DASHBOARD_UNITBAR_STAMPS});i.setWorldSize(64,39),e.setSize(64,39),e.add(i);let s=P.buildText($n.getText("BUY").toUpperCase(),this.getStampTextFontSize()).setDefaultStroke().setDefaultShadow({offsetY:2}).build(this.scene);s.setY(-2),e.add(s),this.stampText=s,Jn.Align.In.BottomCenter(e,this.block,0,26),this.add(e)}createAdsBanner(){let e=this.scene.make.image({key:nl,frame:xr.DASHBOARD_AD_ICON});e.setOrigin(1,0),e.setDisplaySize(33,33),e.setPosition(this.block.x+this.block.displayWidth/2,this.block.y-this.block.displayHeight/2),this.add(e),e.kill(),this.adsBanner=e}createUnitImage(e){if(this.unitImage=this.scene.add.image(0,0,nl),e===L.MELEE_UNIT_TYPE){let i=xr.DASHBOARD_UNITBAR_DINO;this.unitImage.setFrame(i),this.unitImage.setDisplaySize(49,37.5)}else{let i=xr.DASHBOARD_UNITBAR_ARCHER;this.unitImage.setFrame(i),this.unitImage.setDisplaySize(35,43)}Jn.Align.In.Center(this.unitImage,this.block,0,-10),this.add(this.unitImage)}createPriceText(e){let i=$n.getCurrentLocale(),s=18;switch(i){case"tr":s=16;break}this.priceText=P.buildText(e.toString(),15).setDefaultStroke().build(this.scene),Jn.Align.In.Center(this.priceText,this.block,8,s),this.add(this.priceText)}createMiniCoinIcon(){let e=this.scene.make.image({key:nl,frame:xr.DASHBOARD_MINI_COIN});this.add(e),e.setDisplaySize(12.5,13.5),Jn.Align.In.Center(e,this,-22,20),this.coinIcon=e}setImage(e){this.unitImage.setTexture(e)}setPrice(e){let i=e.toString();this.priceText.setText(`${i}`)}set onClick(e){this.clickZone.setInteractive({useHandCursor:!0}),this.clickZone.on(ny.GAMEOBJECT_POINTER_DOWN,()=>{this.logButtonEvent(),e(),Wt.vibrate(50)})}set onceClick(e){this.clickZone.setInteractive({useHandCursor:!0}),this.clickZone.once(ny.GAMEOBJECT_POINTER_DOWN,()=>{this.logButtonEvent(),e()})}setAdsMode(e){this.adsMode=e,this.adsBanner.setVisible(e),this.priceText.setVisible(!e),this.coinIcon.setVisible(!e);let i=this.block.frame.name===xr.DASHBOARD_UNITBAR_BG_LANDSCAPE;if(e)this.stampText&&(this.stampText.setFontSize(this.getAdsTextFontSize()),this.stampText.setText($n.getText("FREE").toUpperCase())),Jn.Align.In.Center(this.unitImage,this.block,0,0);else{this.stampText&&(this.stampText.setFontSize(this.getStampTextFontSize()),this.stampText.setText($n.getText("BUY").toUpperCase()));let s=i?-6:-10;Jn.Align.In.Center(this.unitImage,this.block,0,s)}}setDisabled(e){e!==this.isDisable&&(this.setAlpha(e?.5:1),this.isDisable=e)}isDisabled(){return this.isDisable}logButtonEvent(){let e=this.name;se.trackButtonClick(e)}changeToDesktopFrame(){let e=$n.getCurrentLocale(),i=7.5;switch(e){case"tr":i=5.5;break}this.block.setFrame(xr.DASHBOARD_UNITBAR_BG_LANDSCAPE),this.clickZone.setSize(this.block.displayWidth,this.block.displayHeight),this.adsBanner.setFrame(xr.DASHBOARD_AD_ICON_LANDSCAPE),this.adsBanner.setPosition(this.block.x+this.block.displayWidth/2,this.block.y-this.block.displayHeight/2);let s=1/I.getPixelRatio();this.unitImage.setOrigin(.5,.45),this.unitImage.setScale(s/2),this.priceText.setFontSize(10),this.priceText.setPosition(8,i),this.coinIcon.setPosition(-15,8),this.coinIcon.setScale(s/1.2),this.updateSize(),this.stampBanner&&this.stampBanner.kill()}},oy=ay;var V4=E(X());var{Plugins:{Ads:{Types:{REWARDED_VIDEO:td}}}}=Ludex,hy=class extends V4.Container{scene;bg;meleeBlock;rangedBlock;adChangeMeleeTimer;adChangeRangedTimer;constructor(e){super(e),this.scene=e,this.createBg(),this.createMeleeBlock(),this.createRangedBlock(),this.setDepth(B.BUTTON),this.scene.add.existing(this)}createStampsBanner(){this.meleeBlock.createStampsBanner(),this.rangedBlock.createStampsBanner()}setMeleePrice(e){this.meleeBlock.setPrice(e)}setRangedPrice(e){this.rangedBlock.setPrice(e)}createBg(){this.bg=this.scene.make.image({key:T.DEFAULT.KEY,frame:T.DEFAULT.FRAME.DASHBOARD_UNITBAR_BOTTOM_BG}),this.bg.setWorldSize(375,195),this.bg.setY(52),this.add(this.bg)}getGapFromContainerCenterToBottomBg(){return this.bg.y+this.bg.displayHeight/2}isBgHigherBottom(){let{height:e}=I.getWorldSize();return this.bg.getWorldPosition().y+this.bg.displayHeight/2<e/2}createMeleeBlock(){this.meleeBlock=new oy(this.scene,L.MELEE_UNIT_TYPE,999),this.meleeBlock.setName("BuyMeleeUnit"),this.meleeBlock.setPosition(39,0),this.add(this.meleeBlock),this.meleeBlock.onClick=this.buyMeleeUnit}buyMeleeUnit=()=>{let{effectManger:e}=this.scene;this.checkIfFullBoard()&&e.playFullFloatText(),!e.isRewardCurveAnimationRunning()&&(this.meleeBlock.isDisable||this.scene.handleSpawnMelee())};buyRangedUnit=()=>{let{effectManger:e}=this.scene;this.checkIfFullBoard()&&(e.playFullFloatText(),this.rangedBlock.setName("BuyRangedUnit"),this.rangedBlock.setAdsMode(!1)),!e.isRewardCurveAnimationRunning()&&(this.rangedBlock.isDisable||this.scene.handleSpawnRanged())};createRangedBlock(){this.rangedBlock=new oy(this.scene,L.RANGED_UNIT_TYPE,999),this.meleeBlock.setName("BuyRangedUnit"),this.rangedBlock.setPosition(-39,0),this.add(this.rangedBlock),this.rangedBlock.onClick=this.buyRangedUnit}setMeleeAdsMode(e){if(e&&this.scene.tutorialManager.isRunning()){this.disableMeleeBlock();return}let i=this.adChangeMeleeTimer&&this.adChangeMeleeTimer.getProgress()<1,{adsMode:s}=this.meleeBlock;if(e){if(e===s){ae.isReadyAdShowable(td)||this.disableMeleeBlock();return}if(this.disableMeleeBlock(),i)return;this.adChangeMeleeTimer=this.scene.time.delayedCall(2e3,()=>{if(this.meleeBlock){let r=ae.isReadyAdShowable(td),n=this.delayedAdMeleePriceCheck();if(this.checkIfFullBoard()||!r){this.disableMeleeBlock(),this.meleeBlock.setName("BuyMeleeUnit"),this.meleeBlock.setAdsMode(!1);return}else this.enableMeleeBlock();if(!n){this.meleeBlock.setAdsMode(!1);return}this.meleeBlock.setName("ViewAdMeleeUnit"),this.meleeBlock.setAdsMode(!0)}});return}this.adChangeMeleeTimer?.destroy(),this.enableMeleeBlock(),this.meleeBlock.setName("BuyMeleeUnit"),this.meleeBlock.setAdsMode(e)}disableMeleeBlock(){this.meleeBlock.setDisabled(!0)}enableMeleeBlock(){this.meleeBlock.setDisabled(!1)}killMeleeBlock(){this.meleeBlock.kill()}reviveMeleeBlock(){this.meleeBlock.revive()}setRangedAdsMode(e){if(e&&this.scene.tutorialManager.isRunning()){this.disableRangedBlock();return}let i=this.adChangeRangedTimer&&this.adChangeRangedTimer.getProgress()<1,{adsMode:s}=this.rangedBlock;if(e){if(e===s){ae.isReadyAdShowable(td)||this.disableRangedBlock();return}if(this.disableRangedBlock(),e&&i)return;this.adChangeRangedTimer=this.scene.time.delayedCall(2e3,()=>{if(this.rangedBlock){let r=ae.isReadyAdShowable(td),n=this.delayedAdRangedPriceCheck();if(this.checkIfFullBoard()||!r){this.disableRangedBlock(),this.rangedBlock.setName("BuyRangedUnit"),this.rangedBlock.setAdsMode(!1);return}else this.enableRangedBlock();if(!n){this.rangedBlock.setAdsMode(!1);return}this.rangedBlock.setName("ViewAdRangedUnit"),this.rangedBlock.setAdsMode(!0)}});return}this.adChangeRangedTimer?.destroy(),this.enableRangedBlock(),this.rangedBlock.setName("BuyRangedUnit"),this.rangedBlock.setAdsMode(e)}checkIfFullBoard(){let{fieldManager:e}=this.scene;return e.getRemainingAvailablePlacement()===0}delayedAdMeleePriceCheck(){let{unitManager:e,coinManager:i}=this.scene,s=Se.inst.getCoin(),r=e.getPlayerMeleeSpawnedUnitsCount(),n=i.getUnitPrice(r),a=s.toString(),o=n.toString();return n.biggerThan(s)&&a!==o}delayedAdRangedPriceCheck(){let{unitManager:e,coinManager:i}=this.scene,s=Se.inst.getCoin(),r=e.getPlayerRangedSpawnedUnitsCount(),n=i.getUnitPrice(r),a=s.toString(),o=n.toString();return n.biggerThan(s)&&a!==o}disableRangedBlock(){this.rangedBlock.setDisabled(!0)}enableRangedBlock(){this.rangedBlock.setDisabled(!1)}killRangedBlock(){this.rangedBlock.kill()}reviveRangedBlock(){this.rangedBlock.revive()}disableUnitBlocks(){this.meleeBlock.setDisabled(!0),this.rangedBlock.setDisabled(!0)}disableAdsForBlocks(){this.meleeBlock.setName("BuyMeleeUnit"),this.rangedBlock.setName("BuyRangedUnit"),this.meleeBlock.setAdsMode(!1),this.rangedBlock.setAdsMode(!1)}addOnceClickEventForMeleeBlock(e){this.meleeBlock.onceClick=e}addOnceClickEventForRangedBlock(e){this.rangedBlock.onceClick=e}getMeleeBlockConfig(){let{x:e,y:i}=this.meleeBlock.getWorldPosition(),{width:s,height:r}=this.meleeBlock,n=I.isLandscape()?0:10;return{worldX:e,worldY:i+n,width:s*this.scaleX,height:r*this.scaleY}}getRangedBlockConfig(){let{x:e,y:i}=this.rangedBlock.getWorldPosition(),{width:s,height:r}=this.rangedBlock,n=I.isLandscape()?0:10;return{worldX:e,worldY:i+n,width:s*this.scaleX,height:r*this.scaleY}}killBg(){this.bg.kill()}reviveBg(){this.bg.revive()}changeToDesktopFrame(){this.bg.kill(),this.rangedBlock.changeToDesktopFrame(),this.meleeBlock.changeToDesktopFrame(),this.meleeBlock.setPosition(36,0),this.rangedBlock.setPosition(-36,0)}},X4=hy;var ly=class{scene;group;constructor(e){this.scene=e,this.createGroup()}getAll(){return this.group.getChildren()}createGroup(){this.group=this.scene.add.group()}},K4=ly;var{KEY:al,FRAME:ol}=T.GAMEPLAY,uy=class extends K4{scene;coinBar;unitBar;levelBar;totalHpBar;startButton;settingsButton;battleLevelBar;freeCoinsItem;unitModButton;resetLevelButton;selectLevelButton;currentUnitModText;currentUnitModButton;currentAttackModText;currentAttackModButton;constructor(e){super(e),this.scene=e,this.createObjects()}getAll(){return this.group.getChildren()}createObjects(){this.createCoinBar(),this.createUnitBar(),this.createLevelBar(),this.createTotalHpBar(),this.createStartButton(),this.createBattleLevelBar(),this.createSettingsButton(),this.createFreeCoinsItem(),this.createDevTools()}createCoinBar(){this.coinBar=new N4(this.scene),this.group.add(this.coinBar)}createUnitBar(){this.unitBar=new X4(this.scene),this.group.add(this.unitBar)}createLevelBar(){this.levelBar=new G4(this.scene),this.group.add(this.levelBar)}createTotalHpBar(){this.totalHpBar=new H4(this.scene),this.group.add(this.totalHpBar)}createStartButton(){this.startButton=new n4(this.scene),this.group.add(this.startButton)}createBattleLevelBar(){this.battleLevelBar=new O4(this.scene),this.group.add(this.battleLevelBar)}createSettingsButton(){this.settingsButton=new fe(this.scene,al,ol.DASHBOARD_SETTINGS_BTN,32.5,39),this.group.add(this.settingsButton),this.settingsButton.setName("Settings")}createFreeCoinsItem(){this.freeCoinsItem=new x4(this.scene),this.group.add(this.freeCoinsItem)}createDevTools(){Ludex.Utils.Valid.isDebugger()&&(this.createResetLevelButton(),this.createSelectLevelButton(),this.createUnitModButton(),this.createAttackModButton())}createResetLevelButton(){this.resetLevelButton=new fe(this.scene,al,ol.TOOL_RESET,40,35),this.group.add(this.resetLevelButton),this.resetLevelButton.setName("Reset")}createSelectLevelButton(){this.selectLevelButton=new fe(this.scene,al,ol.TOOL_EDIT,40,40),this.group.add(this.selectLevelButton),this.selectLevelButton.setName("Select"),this.selectLevelButton.setAngle(90)}createUnitModButton(){this.currentUnitModButton=new fe(this.scene,al,ol.TOOL_UNIT,40,38.5),this.group.add(this.currentUnitModButton),this.currentUnitModButton.setName("UnitMod"),this.currentUnitModText=P.buildText("0",18).setOrigin({x:0,y:.5}).build(this.scene),this.currentUnitModText.x=20,this.currentUnitModButton.add(this.currentUnitModText)}createAttackModButton(){this.currentAttackModButton=new fe(this.scene,al,ol.TOOL_ATTACK,40,40),this.group.add(this.currentAttackModButton),this.currentAttackModButton.setName("UnitMod"),this.currentAttackModText=P.buildText("0",18).setOrigin({x:0,y:.5}).build(this.scene),this.currentAttackModText.x=20,this.currentAttackModButton.add(this.currentAttackModText)}},Z4=uy;var cy=class{scene;objects;allUI;groups;constructor(e){this.scene=e,this.objects=null,this.createGroups()}setUIObjects(e){this.objects=e,this.allUI.addMultiple(this.objects.getAll())}createGroups(){this.groups={},this.allUI=this.scene.add.group(),this.groups.allUI=this.allUI}},j4=cy;var ti=E(ie()),{Utils:{Valid:$4}}=Ludex,dy=class extends j4{scene;uiZone;guideStateUI;battleReadyStateUI;normalReadyStateUI;levelLoadingStateUI;battlePlayingStateUI;normalPlayingStateUI;bossReadyStateUI;constructor(e){super(e),this.scene=e;let{height:i}=I.getWorldSize(),s=I.getPixelRatio();this.uiZone=this.scene.add.zone(0,0,400*s,i*s),ti.Align.In.Center(this.uiZone,this.scene.gameZone)}setUIObjects(e){super.setUIObjects(e),this.updateDepthGroups(),this.addUIObjectsToGroups()}alignUI(){this.alignMainUI(),this.alignItems(),this.alignDevTools()}alignMainUI(){if(this.objects===null)return;let{gameZone:e,fieldManager:i}=this.scene,{coinBar:s,levelBar:r,battleLevelBar:n,settingsButton:a,unitBar:o,totalHpBar:h,startButton:l}=this.objects;ti.Align.In.TopRight(s,e,-60,-25),ti.Align.In.TopCenter(r,e,0,-22),ti.Align.In.TopCenter(n,e,10,-27),ti.Align.In.TopLeft(a,e,-5,-2);let{y:c,scaleY:d}=i.fieldBackground,{height:f}=I.getWorldSize(),p=I.getPixelRatio(),m=0;I.isLandscape()||o.createStampsBanner(),o.reviveBg(),o.x=m,h.x=m,l.x=m;let v=c-f/2;h.y=v;let g=255;if(o.y=v-g*d*p,o.isBgHigherBottom()){let b=o.getGapFromContainerCenterToBottomBg();o.y=f/2-b}l.y=o.y-72;let S=I.isLandscape(),y=e.displayHeight-(o.y+70)<ae.getBannerHeight();!S&&y&&this.changeUnitBarForBannerAds()}alignItems(){if(this.objects===null)return;let{gameZone:e}=this.scene,{freeCoinsItem:i,unitBar:s}=this.objects;ti.Align.In.TopRight(i,e,-15,-45);let r=I.isLandscape(),n=e.displayHeight-(s.y+70)<ae.getBannerHeight();!r&&n&&this.changeItemAlignForBannerAds()}alignDevTools(){if(this.objects===null||!$4.isDebugger())return;let{gameZone:e}=this.scene,{selectLevelButton:i,resetLevelButton:s,currentUnitModButton:r,currentAttackModButton:n}=this.objects;ti.Align.In.BottomRight(i,e,0,-80),ti.Align.In.BottomRight(s,e,-50,-80),ti.Align.In.BottomLeft(r,e,0,-150),ti.Align.In.BottomLeft(n,e,0,-100)}createGroups(){super.createGroups(),this.guideStateUI=this.scene.add.group(),this.battleReadyStateUI=this.scene.add.group(),this.normalReadyStateUI=this.scene.add.group(),this.levelLoadingStateUI=this.scene.add.group(),this.battlePlayingStateUI=this.scene.add.group(),this.normalPlayingStateUI=this.scene.add.group(),this.bossReadyStateUI=this.scene.add.group(),this.groups.guideStateUI=this.guideStateUI,this.groups.battleReadyStateUI=this.battleReadyStateUI,this.groups.normalReadyStateUI=this.normalReadyStateUI,this.groups.levelLoadingStateUI=this.levelLoadingStateUI,this.groups.battlePlayingStateUI=this.battlePlayingStateUI,this.groups.normalPlayingStateUI=this.normalPlayingStateUI,this.groups.bossReadyStateUI=this.bossReadyStateUI}updateDepthGroups(){this.allUI.setDepth(B.BUTTON),this.groups.guideStateUI.setDepth(B.BUTTON),this.groups.levelLoadingStateUI.setDepth(B.BUTTON),this.groups.normalReadyStateUI.setDepth(B.BUTTON),this.groups.battleReadyStateUI.setDepth(B.BUTTON),this.groups.normalPlayingStateUI.setDepth(B.BUTTON),this.groups.battlePlayingStateUI.setDepth(B.BUTTON),this.groups.bossReadyStateUI.setDepth(B.BUTTON)}addUIObjectsToGroups(){this.objects!==null&&(this.addObjectForGuideState(),this.addObjectsToLoadingState(),this.addObjectsForReadyState(),this.addObjectsForPlayingState())}addObjectForGuideState(){this.objects!==null&&this.groups.guideStateUI.addMultiple([this.objects.unitBar,this.objects.coinBar,this.objects.levelBar,this.objects.totalHpBar,this.objects.startButton,this.objects.settingsButton])}addObjectsToLoadingState(){this.objects!==null&&this.groups.levelLoadingStateUI.addMultiple([this.objects.coinBar,this.objects.totalHpBar,this.objects.freeCoinsItem,this.objects.settingsButton])}addObjectsForReadyState(){this.objects!==null&&(this.groups.normalReadyStateUI.addMultiple([this.objects.coinBar,this.objects.unitBar,this.objects.levelBar,this.objects.totalHpBar,this.objects.startButton,this.objects.freeCoinsItem,this.objects.settingsButton]),this.groups.bossReadyStateUI.addMultiple([this.objects.coinBar,this.objects.unitBar,this.objects.levelBar,this.objects.totalHpBar,this.objects.startButton,this.objects.freeCoinsItem,this.objects.settingsButton]),$4.isDebugger()&&this.groups.normalReadyStateUI.addMultiple([this.objects.resetLevelButton,this.objects.selectLevelButton,this.objects.currentUnitModButton,this.objects.currentAttackModButton]),this.groups.battleReadyStateUI.addMultiple([this.objects.coinBar,this.objects.totalHpBar,this.objects.startButton,this.objects.freeCoinsItem,this.objects.battleLevelBar,this.objects.settingsButton]))}addObjectsForPlayingState(){this.objects!==null&&(this.groups.normalPlayingStateUI.addMultiple([this.objects.coinBar,this.objects.totalHpBar,this.objects.settingsButton]),this.groups.battlePlayingStateUI.addMultiple([this.objects.coinBar,this.objects.totalHpBar,this.objects.settingsButton]))}changeUnitBarForBannerAds(){if(!this.objects)return;let{unitBar:e,startButton:i}=this.objects,{tutorialManager:s}=this.scene,r=ae.getBannerHeight();e.changeToDesktopFrame(),ti.Align.In.BottomCenter(e,this.uiZone,-90,-30-r),i.changeToDesktopFrame(),s.isNothingToDisplay()?ti.Align.In.BottomCenter(i,this.uiZone,55,-7-r):ti.Align.In.BottomCenter(i,this.uiZone,0,-7-r)}changeItemAlignForBannerAds(){if(this.objects===null)return;let{gameZone:e}=this.scene,{freeCoinsItem:i}=this.objects;ti.Align.In.TopRight(i,e,-15,-45)}},id=dy;var Pi=E(ie()),{Utils:{Device:yxe,Valid:bxe}}=Ludex,fy=class extends id{alignUI(){super.alignUI()}alignMainUI(){if(this.objects===null)return;let{coinBar:e,levelBar:i,settingsButton:s,unitBar:r,startButton:n,totalHpBar:a}=this.objects,{tutorialManager:o,gameZone:h}=this.scene;e.setScale(.75),Pi.Align.In.TopRight(e,this.uiZone,-80,-18),i.setScale(.75),Pi.Align.In.TopCenter(i,this.uiZone,0,-18),s.setScale(.75),Pi.Align.In.TopLeft(s,this.uiZone,-40,3),r.changeToDesktopFrame(),Pi.Align.In.BottomCenter(r,this.uiZone,-90,-30);let l=yxe.isMobile(),c=I.isLandscape(),d=h.displayHeight-(r.y+12)<ae.getBannerHeight();l&&c&&d&&ae.hideBannerAds(),n.changeToDesktopFrame(),o.isNothingToDisplay()?Pi.Align.In.BottomCenter(n,this.uiZone,55,-7):Pi.Align.In.BottomCenter(n,this.uiZone,0,-7),a.playerHpBar.setScale(.75),a.playerHpBar.setPosition(190,125),a.enemyHpBar.setScale(.75),a.enemyHpBar.setPosition(-190,-160),Pi.Align.In.Center(a,this.uiZone,0,0)}alignItems(){if(this.objects===null)return;let{freeCoinsItem:e,startButton:i}=this.objects;e.setScale(.75),Pi.Align.In.RightCenter(e,i,e.width,-2)}alignDevTools(){if(this.objects===null||!bxe.isDebugger())return;let{selectLevelButton:e,resetLevelButton:i,currentUnitModButton:s,currentAttackModButton:r}=this.objects;Pi.Align.In.LeftCenter(e,this.uiZone,150,-50),Pi.Align.In.LeftCenter(i,this.uiZone,150,10),Pi.Align.In.LeftCenter(s,this.uiZone,150,60),Pi.Align.In.LeftCenter(r,this.uiZone,150,120)}},J4=fy;var{STATUS:py}=kt,my=class extends xe{scene;layout;objects;constructor(e){super(e),this.scene=e,this.createObjects(),this.createLayouts()}init(){this.initUILogic(),this.layout.alignUI(),this.setState(py.READY)}start(){this.isRunning()||(this.updateUIState(),this.setState(py.RUNNING))}stop(){this.isRunning()&&this.setState(py.STOPPED)}handleResize=()=>{this.layout.alignUI()};handleLayoutChange=()=>{this.createLayouts(),this.layout.setUIObjects(this.objects),this.layout.alignUI()}},Q4=my;var{event:eZ}=codex,vy=class extends Q4{scene;constructor(e){super(e),this.scene=e,this.registerEvents()}registerEvents(){eZ.on(we.VIEW_RESIZED,this.handleResize),eZ.on(we.LAYOUT_CHANGED,this.handleLayoutChange)}createObjects(){this.objects=new Z4(this.scene)}createLayouts(){I.isLandscape()?this.layout=new J4(this.scene):this.layout=new id(this.scene),this.layout.setUIObjects(this.objects)}get groups(){return this.layout.groups}initUILogic(){}updateUIState(){}},tZ=vy;var{STATUS:Axe}=kt,{MaxLevel:iZ}=le,{Utils:{Valid:sZ}}=Ludex,gy=class extends xe{scene;loadMapInput;unitModifierInput;attackModifierInput;constructor(e){super(e),this.scene=e,this.createDevTools()}start(){this.isRunning()||sZ.isDebugger()&&this.setState(Axe.RUNNING)}createDevTools(){sZ.isDebugger()&&(this.createLoadMapInput(),this.createUnitModifierInput(),this.createAttackModifierInput())}createLoadMapInput(){this.loadMapInput=this.createInput("input-level","level-id","load-level-id","Load level",this.handleStartLoadMapById)}createUnitModifierInput(){this.unitModifierInput=this.createInput("input-level","unit-mod","edit-unit-mod","Set Unit Price Modifier",this.handleEditUnitModifier)}createAttackModifierInput(){this.attackModifierInput=this.createInput("input-level","attack-mod","edit-attack-mod","Set Attack Coin Modifier",this.handleEditAttackModifier)}createInput(e,i,s,r,n){let a=document.createElement("div");return a.id=e,a.style.height="100vh",a.style.width="calc(100vw - 100px)",a.style.padding="50px",a.style.display="flex",a.style.flexFlow="column",a.style.position="absolute",a.style.justifyContent="center",a.style.backgroundColor="#000000cc",a.innerHTML=`<input id=${i} style="height: 50px;text-align: center;font-size: 30px;"></input><input type="button" id=${s} value=${r} style="height:40px">`,document.body.appendChild(a),document.getElementById(s)?.addEventListener("click",n),a.style.display="none",a}handleStartLoadMapById=()=>{try{this.loadMapInput.style.display="none";let e=document.getElementById("level-id");if(!e)return;let i=JSON.parse(e.value),s=parseInt(i)>iZ?iZ:parseInt(i);this.scene.selectLevel(s)}catch(e){console.warn(e)}};handleEditUnitModifier=()=>{try{this.unitModifierInput.style.display="none";let e=document.getElementById("unit-mod");if(!e)return;let i=JSON.parse(e.value),s=parseInt(i),{difficultyManager:r,uiManager:n}=this.scene,a=r.editCurrentLevelUnitMod(s);this.setCurrentUnitModText(i,a),n.updateUIData()}catch(e){console.warn(e)}};setCurrentUnitModText(e,i){let{objects:s}=this.scene.layoutManager;s.currentUnitModText.setText(`C: ${e*100}%
T: ${i.toString()}%`)}handleEditAttackModifier=()=>{try{this.attackModifierInput.style.display="none";let e=document.getElementById("attack-mod");if(!e)return;let i=JSON.parse(e.value),s=parseInt(i),{difficultyManager:r,uiManager:n}=this.scene,a=r.editCurrentLevelAttackMod(s);this.setCurrentAttackModText(i,a),n.updateUIData()}catch(e){console.warn(e)}};setCurrentAttackModText(e,i){let{objects:s}=this.scene.layoutManager;s.currentAttackModText.setText(`C: ${e}%
T: ${i.toString()}%`)}handleShowLoadMapInput=()=>{this.loadMapInput.style.display="flex"};handleShowModUnitInput=()=>{this.unitModifierInput.style.display="flex"};handleShowModAttackInput=()=>{this.attackModifierInput.style.display="flex"}},rZ=gy;var xxe={gameData:oo,dailyRewardedData:{logDays:[],firstReward:0,lastReward:0}},sd=xxe;function rd(t,e,i){var s,r,n;e===void 0&&(e=50),i===void 0&&(i={});var a=(s=i.isImmediate)!=null&&s,o=(r=i.callback)!=null&&r,h=i.maxWait,l=Date.now(),c=[];function d(){if(h!==void 0){var p=Date.now()-l;if(p+e>=h)return h-p}return e}var f=function(){var p=[].slice.call(arguments),m=this;return new Promise(function(v,g){var S=a&&n===void 0;if(n!==void 0&&clearTimeout(n),n=setTimeout(function(){if(n=void 0,l=Date.now(),!a){var b=t.apply(m,p);o&&o(b),c.forEach(function(x){return(0,x.resolve)(b)}),c=[]}},d()),S){var y=t.apply(m,p);return o&&o(y),v(y)}c.push({resolve:v,reject:g})})};return f.cancel=function(p){n!==void 0&&clearTimeout(n),c.forEach(function(m){return(0,m.reject)(p)}),c=[]},f}var Vs=E(qe());var{player:zs,monitorError:Cxe}=codex,{Utils:{Valid:nZ}}=Ludex,Sy=class extends Ns{uiManager;unitManager;coinManager;fieldManager;levelManager;powerManager;stateManager;spineManager;effectManger;layoutManager;devToolManager;tutorialManager;animationManager;difficultyManager;accessibilityManager;gameMode;levelStartAt;levelEndAt;isBannerAdShowed;isStartOverPopupShowed;isBossFightRequested;preload(){this.events.on(Vs.WAKE,this.run),this.events.on(Vs.CREATE,this.run),this.events.on(Vs.SLEEP,this.quit),this.events.on(Vs.PAUSE,this.handlePauseScene),this.events.on(Vs.RESUME,this.handleResumeScene)}handlePauseScene=()=>{this.unitManager.hideAllUnits(),this.unitManager.hideAllProjectiles(),this.spineManager.hideAllSpines(),this.effectManger.hideAllTextEffects()};handleResumeScene=()=>{this.stateManager.isInLevelLoadingState()||this.unitManager.showAllAliveUnits(),this.stateManager.isInPlayingState()&&this.unitManager.showAllHpBarUnits(),this.unitManager.showAllProjectiles(),this.spineManager.showAllSpines(),this.effectManger.showAllTextEffects(),this.powerManager.syncSpeedSetting()};create(){super.create(),console.log("create here",this),this.createManager(),this.levelStartAt=0,this.levelEndAt=0,this.isBannerAdShowed=!1,this.isStartOverPopupShowed=!1}createManager(){this.layoutManager=new tZ(this),this.coinManager=new B5(this),this.unitManager=new YK(this),this.levelManager=new FX(this),this.fieldManager=new UX(this),this.powerManager=new GX(this),this.stateManager=new QX(this),this.spineManager=new YX(this),this.effectManger=new OX(this),this.devToolManager=new rZ(this),this.tutorialManager=new $K(this),this.animationManager=new M5(this),this.difficultyManager=new N5(this),this.accessibilityManager=new t5(this),this.uiManager=new u3(this)}initManager(){this.uiManager.init(),this.unitManager.init(),this.coinManager.init(),this.levelManager.init(),this.fieldManager.init(),this.spineManager.init(),this.effectManger.init(),this.powerManager.init(),this.devToolManager.init(),this.tutorialManager.init(),this.difficultyManager.init(),this.accessibilityManager.init(),this.layoutManager.init()}startManager(){this.coinManager.start(),this.unitManager.start(),this.levelManager.start(),this.fieldManager.start(),this.effectManger.start(),this.powerManager.start(),this.devToolManager.start(),this.tutorialManager.start(),this.difficultyManager.start(),this.accessibilityManager.start(),this.uiManager.start(),this.uiManager.start(),this.layoutManager.start()}stopManager(){this.uiManager.stop(),this.levelManager.stop(),this.coinManager.stop(),this.fieldManager.stop(),this.unitManager.stop(),this.spineManager.stop(),this.effectManger.stop(),this.powerManager.stop(),this.devToolManager.stop(),this.tutorialManager.stop(),this.difficultyManager.stop(),this.accessibilityManager.stop(),this.layoutManager.stop()}handleSpawnRanged=()=>{if(!this.stateManager.isInReadyState())return;let e=Se.inst.getCoin(),i=this.unitManager.getPlayerRangedSpawnedUnitsCount(),s=this.coinManager.getUnitPrice(i);console.log("\u{1F916} ? rangedPrice",s);let r=this.getBuyingUnitLevel();if(e.smallerThan(s)){let a=e.toString(),o=s.toString();if(a!==o){k.openScreen(O.UNIT_REWARD_SCREEN,{type:"RANGED"});return}s=e}let n=this.fieldManager.getAvailablePlacement();n&&(Se.inst.removeCoin(s),this.unitManager.createPlayerArcher(n.rowId,n.colId,r),this.fieldManager.getRemainingAvailablePlacement()===0&&this.effectManger.playFullFloatText(),this.updateUI(),this.unitManager.savePlayerUnits(),q.playSound(J.BUTTON_CLICK))};handleSpawnMelee=()=>{if(!this.stateManager.isInReadyState())return;let e=this.unitManager.getPlayerMeleeSpawnedUnitsCount(),i=this.coinManager.getUnitPrice(e);console.log("\u{1F916} ? meleePrice",i);let s=this.getBuyingUnitLevel(),r=Se.inst.getCoin();if(r.smallerThan(i)){let a=r.toString(),o=i.toString();if(a!==o){k.openScreen(O.UNIT_REWARD_SCREEN,{type:"MELEE"});return}i=r}let n=this.fieldManager.getAvailablePlacement();n&&(Se.inst.removeCoin(i),this.unitManager.createPlayerMelee(n.rowId,n.colId,s),this.fieldManager.getRemainingAvailablePlacement()===0&&this.effectManger.playFullFloatText(),this.updateUI(),this.unitManager.savePlayerUnits(),q.playSound(J.BUTTON_CLICK))};spawnUnit(e,i=!0,s=1,r=!1){if(!this.stateManager.isInReadyState())return!1;let n=this.fieldManager.getAvailablePlacement();if(!n)return!1;if(r){let o=Se.inst.getCoin(),h=0;e==="MELEE"?h=this.unitManager.getPlayerMeleeSpawnedUnitsCount():h=this.unitManager.getPlayerRangedSpawnedUnitsCount();let l=this.coinManager.getUnitPrice(h);if(console.log(`\u{1F916} ? ${e} unit price`,l),o.smallerThan(l)){let c=o.toString(),d=l.toString();if(c!==d)return!1;l=o}Se.inst.removeCoin(l)}let a;return i?(e==="MELEE"?a=this.uiManager.getMeleeBlockWorldPosition():a=this.uiManager.getRangedBlockWorldPosition(),this.effectManger.runCurveAnimationRewardUnit(a.x,a.y,n,e,s)):e==="MELEE"?this.unitManager.createPlayerMelee(n.rowId,n.colId,s):this.unitManager.createPlayerArcher(n.rowId,n.colId,s),this.updateUI(),this.unitManager.savePlayerUnits(),!0}getBuyingUnitLevel(){let{currentLevelId:e}=this.levelManager,{BUYING_UNIT_LEVEL:i}=L,s=1;return i.forEach((r,n)=>{r<=e&&(s=n+1)}),s}giveEnoughCoins(e){let i=0,s=new be(0);e==="MELEE"?(i=this.unitManager.getPlayerMeleeSpawnedUnitsCount(),s=this.coinManager.getUnitPrice(i)):(i=this.unitManager.getPlayerRangedSpawnedUnitsCount(),s=this.coinManager.getUnitPrice(i));let r=Se.inst.getCoin();r.smallerThan(s)&&(s.subtract(r),Se.inst.addCoin(s))}updateUI(){this.uiManager.updateUIData(),this.fieldManager.getRemainingAvailablePlacement()===0&&(this.uiManager.disableUnitBlocks(),this.uiManager.disableAdsUnitBlocks()),this.uiManager.isStartButtonDisabled()&&this.uiManager.enableStartButton()}run=()=>{this.stateManager.init(),Hi.instance.loadAllLanguages(this).catch(e=>{console.error(e),Cxe?.sendException(e)})};quit=()=>{this.stateManager.quit()};prepareRound=async()=>{this.levelStartAt=Date.now(),await Ci.handleMatchStartFlow(),this.stateManager.ready()};restartScene=()=>{this.stateManager.init()};startRound=()=>{this.stateManager.play(),q.playSound(J.START_BATTLE)};replayRound=async()=>{this.unitManager.hideAllUnits(),this.layoutManager.objects.freeCoinsItem.revive(),this.stateManager.ready(),this.unitManager.showAllAliveUnits()};requestBossFight=()=>{this.unitManager.hideAllUnits(),this.stopManager(),this.gameMode=ne.BOSS;let e=Date.now(),i=zs.getGameData();zs.setGameData({...i,lastBossChallengeTime:e}),this.replayRound(),this.powerManager.updateTimers()};nextRound=()=>{this.unitManager.hideAllUnits(),this.stateManager.levelLoading()};gameOver(e){this.unitManager.setReadyAllUnits(),this.levelEndAt=Date.now(),e==="win"?this.stateManager.levelComplete():this.stateManager.levelFail()}handleStartOverFlow(){if(this.isStartOverPopupShowed)return;let i=zs.getGameData()?.isEligibleForReset??!1;nZ.isBoolean(i)&&i&&(this.isStartOverPopupShowed=!0,k.openScreen(O.START_OVER_POPUP))}rewardLostCoin(e){let i=this.coinManager.getTotalCoinsByAttack();i.multiply(e),console.log("\u{1F916} ? rewardLostCoin",i,{rewardCoins:i,multiply:e}),Se.inst.addCoin(i)}rewardWinCoin(e){let i=this.coinManager.getRewardCoinsByAttackCoins();i.multiply(e),console.log("\u{1F916} ? rewardWinCoin",i,{rewardCoins:i,multiply:e}),Se.inst.addCoin(i)}updateLevelToLeaderboard(e){}update(){this.stateManager.update()}resetLevel=async(e=!0)=>{let i=sd,{gameData:s}=i,r=zs.getGameData(),n=r?.gameCompletedCount??0;nZ.isNumber(n)?n++:n=1,e&&(n=0),await zs.setGameData({...s,gameCompletedCount:n}),Se.inst.setCoin(new be(r?.coinBaseValue??0,r?.coinSuffixValue??0,!0)),this.coinManager.initModifier(),this.difficultyManager.intData(),this.levelManager.setCurrentLevelId(1),this.tutorialManager.initTutorialData(),this.resetGameplay()};selectLevel=e=>{let i=zs.getGameData();zs.setGameData({...i,level:e-1}),this.coinManager.initModifier(),this.difficultyManager.intData(),this.levelManager.setCurrentLevelId(e-1),this.resetGameplay()};resetGameplay(){this.unitManager.initSpawnPools(),this.unitManager.emptyPlayerUnits(),this.uiManager.updateUIData(),this.stateManager.quit(),this.stateManager.levelLoading()}setOfflineRewardsToMax(){zs.setGameData({offlineRewardLastCheck:Date.now()-24*60*60*1e3})}initGameMode(){this.gameMode=ne.NORMAL,console.log("\u{1F916} ? initGameMode",this.gameMode)}updateUnitData=rd(()=>{let e=zs.getGameData();zs.setGameData({...e,playerUnitData:this.unitManager.serializePlayerUnitData()})},2e3);isChallengeMode(){return Ci.isChallengeMode()}isContextChallenge(){return!1}getPlayedTimeSeconds(){return Math.floor((this.levelEndAt-this.levelStartAt)/1e3)}},Eo=Sy;var oe=Eo;var{event:wxe}=codex,{Events:Rxe}=Ludex,Pxe={duration:200,color:{r:164,g:90,b:48}},Ey=class t{currentScene=null;static _instance;static get inst(){return this._instance||(this._instance=new t),this._instance}static setCurrentScene(e){let i=window.phaser.scene.getScene(e);this.inst.currentScene=i}static getCurrentScene(){let{currentScene:e}=this.inst;return e?.scene.isSleeping()?window.phaser.scene.getScenes(!0).find(s=>!s.scene.isSleeping())??null:e}static switchScene(e,i,s){wxe.emit(Rxe.SWITCH_SCENE,{sceneName:e,sceneData:i,transition:s})}static async switchToGameScene(e){let{score:i=0}=e??{};this.switchScene(z.GAME_SCENE,{score:i},Pxe)}static getGlobalScene(){let e=window.phaser.scene.getScene(z.GLOBAL_SCENE);return!e||!(e instanceof no)?null:e}static getGameScene(){let e=window.phaser.scene.getScene(z.GAME_SCENE);return!e||!(e instanceof oe)?null:e}static pauseGameScene(){window.phaser.scene.pause(z.GAME_SCENE)}static resumeGameScene(){window.phaser.scene.resume(z.GAME_SCENE)}},W=Ey;var _xe={BACKGROUND:{KEY:"background_music",FILE:"./assets/music/bg_music.mp3"},EFFECTS_FILES:{"start-game-sound":"./assets/sounds/start-game-sound.mp3","next-round-effect":"./assets/sounds/next-round-effect.mp3","lose-sound":"./assets/sounds/lose-sound.mp3","thunder-sound":"./assets/sounds/thunder-sound.mp3","close-click":"./assets/sounds/close-click.mp3","button-click":"./assets/sounds/button-click.mp3","drag-unit-end":"./assets/sounds/drag-unit-end.mp3","drag-unit-start":"./assets/sounds/drag-unit-start.mp3","start-battle":"./assets/sounds/start-battle.mp3","melee-attack":"./assets/sounds/melee-attack.mp3","arrow-shoot":"./assets/sounds/arrow-shoot.mp3","win-battle":"./assets/sounds/win-battle.mp3","unit-damaged":"./assets/sounds/unit-damaged.mp3","unit-merge":"./assets/sounds/unit-merge.mp3","turn-switch":"./assets/sounds/turn-switch.mp3","unit-unlock":"./assets/sounds/unit-unlock.mp3","coin-spawn":"./assets/sounds/coin-spawn.mp3","coin-increase-repeatedly":"./assets/sounds/coin-increase-repeatedly.mp3","gift-charge":"./assets/sounds/gift-charge.mp3","gift-explode":"./assets/sounds/gift-explode.mp3","gift-reveal":"./assets/sounds/gift-reveal.mp3"}},Es=_xe;var oZ=E(Gv());var{Plugins:{Audio:{BaseAudioPlayer:Ixe}}}=Ludex,Ty=class extends Ixe{audioSource;constructor(e,i){super(e),this.audioSource=i}play(e){if(e){let{volume:i=1,loop:s=!1}=e;this.audioSource.volume=i,this.audioSource.loop=s}this.audioSource.play()}pause(){this.audioSource.pause()}resume(){this.audioSource.isPaused&&this.audioSource.play()}stop(){this.audioSource.stop()}setVolume(e){this.audioSource.volume=e}getVolume(){return this.audioSource.volume}getAudioSource(){return this.audioSource}},aZ=Ty;var{Plugins:{Audio:{BaseChannelManager:Lxe}},Utils:{Array:Mxe}}=Ludex,Qn=class extends Lxe{game;players;constructor(e,i){super(i),this.game=e,this.players={}}playing(e){let i=this.players[e];if(!i)return!1;for(let s of i)if(s.getAudioSource().isPlaying)return!0;return!1}async onLoadAudio(e,i){try{return this.isCached(e)||await this.loadAudio(e),this.getPlayer(e,i?.allowMultiple)}catch(s){return console.warn("onLoadAudio",s),null}}playWithRealConfig(e,i){if(i&&!this.isPlayable(i.checkList))return;let s=this.getVolume()*(i?.volume??1);e.play({...i,volume:s})}loadAudio(e){let i;if(e===Es.BACKGROUND.KEY&&(i=q.getMusicPath()),i||(i=Es.EFFECTS_FILES[e]??void 0),!!i)return new Promise((s,r)=>{let n=W.getCurrentScene();if(!n){r(new Error("No scene found"));return}n.load.audio(e,i),n.load.on(`${oZ.Events.FILE_KEY_COMPLETE}audio-${e}`,s),n.load.start()})}isPlayable(e=[]){if(e.length===0)return!0;let i=Object.keys(this.players);for(let s of i){if(!Mxe.has(e,s))continue;let r=this.players[s];for(let n of r)if(n.getAudioSource().isPlaying)return!1}return!0}isCached(e){let i=this.players[e];return i&&i.length>0||this.game.cache.audio.exists(e)}getPlayer(e,i=!1){let s=this.players[e];if(!s||s.length===0)return this.createPlayer(e);if(!i)return s[0];for(let a of s)if(!a.getAudioSource().isPlaying)return a;let r=`-${s.length}`;return this.createPlayer(e,r)}createPlayer(e,i=""){let s=this.game.sound.add(e),r=new aZ(`${e}${i}`,s),n=this.players[e]??[];return n.push(r),this.players[e]=n,r}};var{audio:Xs}=codex,hl=class t{static _instance;channels={};static get inst(){return this._instance||(this._instance=new t),this._instance}static playing(e){try{return this.inst.playing(e)}catch(i){return console.warn("Error checking if audio is playing:",i),!1}}static async play(e,i){try{return await this.inst.play(e,i)}catch(s){console.warn("Error playing audio:",s)}}static pause(e){try{this.inst.pause(e)}catch(i){console.warn("Error pausing audio:",i)}}static resume(e){try{this.inst.resume(e)}catch(i){console.warn("Error resuming audio:",i)}}static stop(e){try{this.inst.stop(e)}catch(i){console.warn("Error stopping audio:",i)}}static stopAll(){try{this.inst.stopAll()}catch(e){console.warn("Error stopping all audio:",e)}}static mute(){try{this.inst.mute()}catch(e){console.warn("Error muting audio:",e)}}static unmute(){try{this.inst.unmute()}catch(e){console.warn("Error un-muting audio:",e)}}static setVolume(e){try{this.inst.setVolume(e)}catch(i){console.warn("Error setting audio volume:",i)}}static getVolume(){try{return this.inst.getVolume()}catch(e){return console.warn("Error getting audio volume:",e),0}}getCurrentChannel(){let i=W.getCurrentScene()?.scene.key??void 0;if(i===void 0)throw new Error("AudioManager.getCurrentChannelId: No scene found");if(this.channels[i])return this.channels[i];let s=new Qn(window.phaser,i);return Xs.addChannel(s),this.channels[i]=s,s}playing(e){return this.getCurrentChannel().playing(e)}play(e,i){let s=this.getCurrentChannel().getId();return Xs.play(e,i,s)}pause(e){let i=this.getCurrentChannel().getId();Xs.pause(e,i)}resume(e){let i=this.getCurrentChannel().getId();Xs.resume(e,i)}stop(e){let i=this.getCurrentChannel().getId();Xs.stop(e,i)}stopAll(){let e=this.getCurrentChannel().getId();Xs.stopAll(e)}mute(){let e=this.getCurrentChannel().getId();Xs.mute(e)}unmute(){let e=this.getCurrentChannel().getId();Xs.unmute(e)}setVolume(e){let i=this.getCurrentChannel().getId();Xs.setVolume(e,i)}getVolume(){let e=this.getCurrentChannel().getId();return Xs.getVolume(e)}};var yy=class t{musicChannel;static get inst(){return this._instance||(this._instance=new t),this._instance}constructor(){this.musicChannel=new Qn(window.phaser,"music");let{audio:e}=codex;e.addChannel(this.musicChannel)}static playing(e){try{return this.inst.playing(e)}catch(i){return console.warn("Error checking if audio is playing:",i),!1}}static async play(e,i){try{return await this.inst.play(e,i)}catch(s){console.warn("Error playing audio:",s)}}static pause(e){try{this.inst.pause(e)}catch(i){console.warn("Error pausing audio:",i)}}static resume(e){try{this.inst.resume(e)}catch(i){console.warn("Error resuming audio:",i)}}static stop(e){try{this.inst.stop(e)}catch(i){console.warn("Error stopping audio:",i)}}static stopAll(){try{this.inst.stopAll()}catch(e){console.warn("Error stopping all audio:",e)}}static mute(){try{this.inst.mute()}catch(e){console.warn("Error muting audio:",e)}}static unmute(){try{this.inst.unmute()}catch(e){console.warn("Error un-muting audio:",e)}}static setVolume(e){try{this.inst.setVolume(e)}catch(i){console.warn("Error setting audio volume:",i)}}static getVolume(){try{return this.inst.getVolume()}catch(e){return console.warn("Error getting audio volume:",e),0}}getCurrentChannel(){return this.musicChannel}playing(e){return this.musicChannel.playing(e)}play(e,i){let{audio:s}=codex;return s.play(e,i,"music")}pause(e){let{audio:i}=codex;i.pause(e,"music")}resume(e){let{audio:i}=codex;i.resume(e,"music")}stop(e){let{audio:i}=codex;i.stop(e,"music")}stopAll(){let{audio:e}=codex;e.stopAll("music")}mute(){let{audio:e}=codex;e.mute("music")}unmute(){let{audio:e}=codex;e.unmute("music")}setVolume(e){let{audio:i}=codex;i.setVolume(e,"music")}getVolume(){let{audio:e}=codex;return e.getVolume("music")}},hZ=yy;var uZ=E(he());var{player:lZ}=codex,by=class t{static _instance;static musicKey;static volumeTween;static get inst(){return this._instance||(this._instance=new t,this.initializeMusicKey$()),this._instance}static initializeMusicKey$(){this.musicKey||(this.musicKey="bg_music.mp3")}get sound(){return hl}get music(){return hZ}static muteAudio(e){this.muteMusic(e),this.muteSound(e)}static async playSound(e,i){if(!(!this.inst.sound||!(lZ.getPlayerSetting("sound")??!0)))return this.inst.sound.play(e,i)}static pauseSound(e){this.inst.sound&&this.inst.sound.pause(e)}static resumeSound(e){this.inst.sound&&this.inst.sound.resume(e)}static stopSound(e){this.inst.sound&&this.inst.sound.stop(e)}static stopAllSounds(){this.inst.sound&&this.inst.sound.stopAll()}static muteSound(e){this.inst.sound&&(e?this.inst.sound.mute():this.inst.sound.unmute())}static getMusicKey(){return Es.BACKGROUND.KEY}static getMusicPath(){return this.musicKey||this.initializeMusicKey$(),this.musicKey}static getAllMusicKeys(){return[Es.BACKGROUND.KEY]}static playMusic(e,i=!1){if(!this.inst.music||!(lZ.getPlayerSetting("music")??!0))return;let r=e??this.getMusicKey();if(!r)return;let n=this.inst.music.playing(r);!i&&n||(this.stopOtherMusic(r),this.inst.music.play(r,{loop:!0}))}static stopOtherMusic(e){if(this.inst.music)for(let i of this.getAllMusicKeys())i!==e&&this.inst.music.stop(i)}static pauseMusic(){if(!this.inst.music)return;let e=this.getMusicKey();if(e)this.inst.music.pause(e);else for(let i of this.getAllMusicKeys())this.inst.music.pause(i)}static muteMusic(e){this.inst.music&&(e?this.inst.music.mute():this.inst.music.unmute())}static async turnOffMusic(){await this.setVolumeMusic(0)}static getVolumeMusic(){return this.inst.music?.getVolume()??0}static async setVolumeMusic(e,i=!1){if(!this.inst.music)return;this.volumeTween?.isPlaying()&&this.volumeTween?.stop();let s=this.inst.music.getVolume();if(s===e)return;if(!i){this.inst.music?.setVolume(e);return}let r=W.getGlobalScene();if(!r){this.inst.music.setVolume(e);return}let n=r.tweens.addCounter({from:1,to:1e3,duration:1e3,ease:uZ.Sine.Out,onUpdate:a=>{let o=(e-s)*a.getValue()/1e3;this.inst.music.setVolume(s+o)},onComplete:()=>{this.inst.music.setVolume(e)}});this.volumeTween=n,n.play()}},q=by;var{Configs:{Ads:{Enabled:Ts,InterstitialAdOptions:Oxe,RewardedVideoAdOptions:Dxe,RewardedInterstitialAdOptions:Bxe,BannerDisplayAdOptions:Ay},Gameplay:{StartAdAtLevel:cZ}},Plugins:{Ads:{Types:_i,Status:nd}},Utils:{Array:To,Function:Uxe}}=Ludex,{ads:fi,player:Nxe}=codex,Fxe={MAX_BOTTOM_BANNER_RATIO:1/6},xy=class t{static _instance;isAvoidBannerShowed=!1;static get inst(){return this._instance||(this._instance=new t),this._instance}static async preloadAds(){this.preloadAdsByType(_i.INTERSTITIAL),this.preloadAdsByType(_i.REWARDED_VIDEO),this.preloadAdsByType(_i.REWARDED_INTERSTITIAL)}static isServiceDegraded(){return fi.isServiceDegraded()}static preloadAdsByType(e,i){if(!Ts)return;let s=fi.getAdsByType(e);for(let r of s)i&&r.placementId!==i||r.instance.status===nd.FILLED||fi.loadAdAsync(e,r.placementId).catch(()=>{})}static setAvoidBannerShowed(e){this.inst.isAvoidBannerShowed=e}static showBannerAds(){if(!(!Ts||(Nxe.getGameData()?.level??1)<cZ)&&!this.inst.isAvoidBannerShowed)for(let{PlacementId:i,Position:s,BannerHeight:r}of Ay){if(s==="bottom"){let{height:n}=I.getWorldSize(),a=I.toPixelSize(n*Fxe.MAX_BOTTOM_BANNER_RATIO);if(r>a){fi.hideBannerAdAsync(i).catch(o=>{});continue}}fi.showBannerAdAsync(i).catch(n=>{console.warn("showBannerAdAsync",n)})}}static hideBannerAds(){if(!Ts)return;fi.getAdsByType(_i.BANNER).forEach(i=>{i.instance.status!==nd.IDLE&&this.hideBannerAd(i.placementId)})}static showBannerAd(e){Ts&&(this.inst.isAvoidBannerShowed||fi.showBannerAdAsync(e).catch(i=>{}))}static hideBannerAd(e){Ts&&fi.hideBannerAdAsync(e).catch(i=>{})}static getBannerHeight(){if(!Ts)return 0;let e=Ay.find(({Position:s})=>s==="bottom"),i=I.getPixelRatio()/I.getZoomRatio();return fi.getBannerHeight(e?.PlacementId||"",i,!0)||0}getAdReady(e,i){if(!Ts)return null;if(i){if(fi.getAdStatus(e,i)===nd.FILLED)return i}else{let s=fi.getAdsByType(e);for(let r of s)if(r.instance.status===nd.FILLED)return r.placementId}return null}getPlacementIdByService(e,i){if(!i)return!1;switch(e){case _i.BANNER:return To.search(Ay,s=>s.AdService===i)?.PlacementId||!1;case _i.INTERSTITIAL:return To.search(Oxe,s=>s.AdService===i)?.PlacementId||!1;case _i.REWARDED_VIDEO:return To.search(Dxe,s=>s.AdService===i)?.PlacementId||!1;case _i.REWARDED_INTERSTITIAL:return To.search(Bxe,s=>s.AdService===i)?.PlacementId||!1;default:return!1}}getAdIdByPayload(e,i){let{adService:s,placementId:r}=i||{};return this.getPlacementIdByService(e,s)||r}static isReadyAdShowable(e,i){if(!Ts)return!1;let s=this.inst.getAdReady(e,i);return s?fi.canShowAd(e,s):!1}getAdErrorMessage(e,i){switch(e){case _i.REWARDED_VIDEO:case _i.REWARDED_INTERSTITIAL:return this.isUserCancelledAdError(i)?`Sorry, no rewards!
 You have cancelled the ad.`:"No ads to display.";default:return null}}async showAdWithType(e,i){let{placementId:s,includeSDK:r,excludeSDK:n,forceLoad:a,adService:o,timeout:h=15e3}=i||{};if(!this.canbeShowInSDK(r,n))return!1;let l=this.getAdIdByPayload(e,i),c=!1,d=!1;try{if(q.muteAudio(!0),a){k.showLoadingNotificationScreen();let f=await Uxe.timeOut(fi.loadAdAsync(e,l),h);if(f.status==="timeout")throw new Error(`AdsUtils.loadAdAsync: Timed out after ${f.duration}ms.`)}for(;!c;)try{let f=this.getAdReady(e,l);if(!f)return!1;l=f,await fi.showAdAsync(e,l),c=!0}catch(f){if(o||this.isUserCancelledAdError(f)||this.isRequestAdTimeoutError(f))throw f;l=void 0,c=!1,d=!0}return!0}catch(f){d=!0;let p=this.getAdErrorMessage(e,f);return p&&k.showNotificationScreen({message:p,duration:2e3,enableCloseOnTouch:!0}),!1}finally{q.muteAudio(!1),a&&k.closeLoadingScreen(),d&&(l=s),t.preloadAdsByType(e,l)}}static async showInterstitialAdAsync(e){if(!Ts)return!1;let{forLevel:i,contextType:s,forceLoad:r}=e||{};if(i&&cZ>=i)return!1;s&&(window.GoogleAds?.setInterstitialType(s),window.TranssionH5Ads?.setInterstitialType(s));let n=r;return GameSDK.getSDKName()==="MsGames"&&(n=!0),this.inst.showAdWithType(_i.INTERSTITIAL,{...e,forceLoad:n})}static async showRewardVideoAdAsync(e){if(!Ts)return!1;let{contextType:i}=e||{};return i&&(window.GoogleAds?.setRewardType(i),window.TranssionH5Ads?.setRewardType(i)),this.inst.showAdWithType(_i.REWARDED_VIDEO,{...e,forceLoad:!0})}static async showRewardedInterstitialAdAsync(e){if(!Ts)return!1;let{contextType:i}=e||{};return i&&(window.GoogleAds?.setRewardType(i),window.TranssionH5Ads?.setRewardType(i)),this.inst.showAdWithType(_i.REWARDED_INTERSTITIAL,{...e,forceLoad:!0})}canbeShowInSDK(e=[],i=[]){let s=GameSDK.getSDKName();return!(i?.length&&To.has(i,s)||e?.length&&!To.has(e,s))}isUserCancelledAdError(e){return e instanceof Object&&"code"in e&&e.code==="USER_INPUT"}isRequestAdTimeoutError(e){return e instanceof Object&&"code"in e&&e.code==="SHOW_ADS_TIMEOUT"}},ae=xy;var{Events:Cy,Configs:{Ads:{Enabled:kxe,PreloadAds:Gxe,ShowAdOnLoad:qxe,BannerDisplayAdOptions:Wxe},Gameplay:{StartAdAtLevel:Yxe}},Utils:{Time:wy}}=Ludex,{phaser:dZ}=window,{event:ad}=codex,Ry=class{currentLayout="";init(){this.listenEvents(),console.info("Ads Manager: Initialized")}listenEvents(){ad.on(we.LAYOUT_CHANGED,this.handleLayoutChanged),ad.catchUp(Cy.GAME_READY,this.processPreloadAds),ad.catchUp(Cy.GAME_READY,this.processShowBannerAds),ad.catchUp(Cy.GAME_SDK_READY,this.processShowFirstInterstitialAd)}processShowBannerAds=async()=>{de.getLevelProgress()<Yxe||(await wy.sleepAsync(1500),ae.showBannerAds())};processPreloadAds=async()=>{Gxe&&(await wy.sleepAsync(6*1e3),ae.preloadAds())};processShowFirstInterstitialAd=async()=>{if(!kxe)return;let{Enabled:e,DelaySeconds:i}=qxe;if(!e)return;i>0&&await wy.sleepAsync(i*1e3);let s=GameSDK.getSDKName()==="Yandex";s&&dZ.loop.pause();try{await ae.showInterstitialAdAsync({forceLoad:!0,contextType:"preroll"})}catch(r){console.warn("AdsManager: showFirstInterstitialAd",r)}s&&dZ.loop.resume()};handleLayoutChanged=e=>{if(this.currentLayout!==e){if(this.currentLayout=e,e===qr.Layout.Landscape){this.processShowBannerAds();return}Wxe.forEach(({PlacementId:i,Position:s})=>{s==="bottom"||s==="top"?ae.showBannerAd(i):ae.hideBannerAd(i)})}}},fZ=Ry;var{Events:od}=Ludex,{event:hd}=codex,Py=class{init(){console.info("Core Manager: Initialized")}requestStart(){hd.emit(od.REQUEST_CORE_START)}onCoreBoot(e){hd.catchUp(od.CORE_BOOTING,e)}onCoreStart(e){hd.catchUp(od.CORE_STARTING,e)}onCoreReady(e){hd.catchUp(od.CORE_READY,e)}},pZ=Py;var Hxe={level:1},mZ=Hxe;var{player:zxe,storage:Vxe}=codex,_y=class{init(){console.info("Match Manager: Initialized")}setupDefaultMatchData(){this.setupMatchCustomData()}setupMatchCustomData(){let e=zxe.getGameData()?.level??1;Vxe.setStorageData("match","customData",{...mZ,level:e})}},vZ=_y;var{Utils:{Valid:Ue,Browser:Xxe},Dtos:{Player:Ot}}=Ludex,{player:ld}=codex,Iy=class{init(){console.info("Player Manager: Initialized")}setupDefaultGameData(){Ot.Data.addDefaultData(sd),Ot.GameData.addDefaultData(oo),Ot.GameData.addValidateFunction("playerUnitData",e=>{if(!Ue.isString(e))throw new Error(`playerUnitData ${e} is invalid`)}),Ot.GameData.addValidateFunction("gameCompletedCount",e=>{if(!Ue.isNumber(e)||e<0)throw new Error(`gameCompletedCount ${e} is invalid`)}),Ot.GameData.addValidateFunction("meleeUnlockedUnitLevel",e=>{if(!Ue.isNumber(e)||e<0)throw new Error(`meleeUnlockedUnitLevel ${e} is invalid`)}),Ot.GameData.addValidateFunction("rangedUnlockedUnitLevel",e=>{if(!Ue.isNumber(e)||e<0)throw new Error(`rangedUnlockedUnitLevel ${e} is invalid`)}),Ot.GameData.addValidateFunction("bossLevelProgress",e=>{if(!Ue.isNumber(e)||e<0)throw new Error(`bossLevelProgress ${e} is invalid`)}),Ot.GameData.addValidateFunction("finalBossDefeated",e=>{if(!Ue.isBoolean(e))throw new Error(`finalBossDefeated ${e} is invalid`)}),Ot.GameData.addValidateFunction("lastBossChallengeTime",e=>{if(!Ue.isNumber(e)||e<0)throw new Error(`lastBossChallengeTime ${e} is invalid`)}),Ot.GameData.addValidateFunction("isEligibleForReset",e=>{if(!Ue.isBoolean(e))throw new Error(`isEligibleForReset ${e} is invalid`)}),Ot.GameData.addValidateFunction("coinBaseValue",e=>{if(!Ue.isNumber(e)||e<0)throw new Error(`coinBaseValue ${e} is invalid`)}),Ot.GameData.addValidateFunction("coinSuffixValue",e=>{if(!Ue.isNumber(e)||e<0)throw new Error(`coinSuffixValue ${e} is invalid`)}),Ot.GameData.addValidateFunction("freeCoinsLastUsedTime",e=>{if(!Ue.isNumber(e)||e<0)throw new Error(`freeCoinsLastUsedTime ${e} is invalid`)}),Ot.GameData.addValidateFunction("offlineRewardLastCheck",e=>{if(!Ue.isNumber(e)||e<0)throw new Error(`offlineRewardLastCheck ${e} is invalid`)}),Ot.GameData.addValidateFunction("unitScreenAdWatchedCount",e=>{if(!Ue.isObject(e))throw new Error(`unitScreenAdWatchedCount ${e} is invalid`)}),Ot.GameData.addValidateFunction("level",e=>{if(!Ue.isNumber(e)||e<0)throw new Error(`level ${e} is invalid`)}),Ot.GameData.addValidateFunction("levelProgress",e=>{if(!Ue.isNumber(e)||e<0)throw new Error(`levelProgress ${e} is invalid`)})}async syncPlayerData(){let e={},i=await this.getOldGameData$(),s=await this.getUserFirstLogin$(),{playerLevelProgress:r}=i??{},{level:n=1}=ld.getGameData()??{},a={playerLevelProgress:r};s||(e.isFirstLogin=!1),Ue.isEmpty(i)||(e.gameData={},Ue.isNumber(r)&&r>n&&(e.gameData.level=r)),!Ue.isEmpty(e)&&!Ue.isEmpty(e.gameData)&&(e.oldData=a,ld.setPlayerData(e)),this.syncOldXiaomiPlayerId$(),this.disableSpeedUpSettings()}requestConnectedPlayers(){ld.requestConnectedPlayers().catch(e=>{console.warn("player.requestConnectedPlayers",e)})}async getOldGameData$(){let{gameData:e={}}=await GameSDK.player.getDataAsync(["gameData"]),i={playerLevelProgress:1};if("getCoreserData"in GameSDK.extra){let s=GameSDK.extra.getCoreserData(),{playerData:r}=s,n=this.getOldXiaomiPlayerData$(r);if(n)return n}return Ue.isEmpty(e)?i:e}async getUserFirstLogin$(e){let{isFirstLogin:i=!1}=await GameSDK.player.getDataAsync(["isFirstLogin"]);if(!i)return!1;if(!Ue.isObject(e)||!("userGuideDisplays"in e)||!Ue.isNumber(e.userGuideDisplays))return!0;let{userGuideDisplays:s}=e;return s===0}getOldXiaomiPlayerData$(e){if(!Ue.isObject(e)||!("gameData"in e)||!Ue.isObject(e.gameData))return null;let{gameData:i}=e;return{playerLevelProgress:this.getOldPlayerProgress$(i)}}getOldPlayerProgress$(e){if("levelProgress"in e&&Ue.isNumber(e.levelProgress)){let{levelProgress:i}=e;return Math.max(i,1)}return 1}syncOldXiaomiPlayerId$(){if(!("getCoreserData"in GameSDK.extra))return;let{playerInfo:e}=GameSDK.extra.getCoreserData();if(!e||!Ue.isString(e)||!window.GameName)return;let s=`${window.GameName.replace(/ /g,"-")}_PlayerInfo`;Xxe.writeLocalStorage(s,{playerId:e})}disableSpeedUpSettings(){ld.setSetting("speedUp",!1)}},gZ=Iy;var bo=E(yo()),{Events:LZ,Utils:{Valid:MZ}}=Ludex,{ads:Kxe,event:Ly,adaptivePerformance:ll}=codex,My=class{init(){ll&&this.listenEvents()}listenEvents(){Ly.on(LZ.REQUEST_RESIZE_GAME,this.handleRequestResizeGame),window.phaser.renderer.once(bo.RENDER,this.handleBeginFrame),Ly.on(LZ.SCENE_LAUNCHED,this.handleAfterSceneLaunch)}handleBeginFrame=()=>{window.phaser.renderer.on(bo.POST_RENDER,this.lateUpdate),window.phaser.renderer.on(bo.PRE_RENDER,this.updateActualFPS)};handleAfterSceneLaunch=()=>{if(!ll)return;let e=W.getCurrentScene();e&&ll.trackingScene(e.scene.key)};handleRequestResizeGame=e=>{if(Kxe.isAdFullSizeShowing())return;let{forcePixelRatio:i}=e;MZ.isNumber(i)&&Ly.emit(we.REQUEST_VIEW_RESIZE,{forcePixelRatio:i})};lateUpdate=()=>{ll?.updatePostStepDeltaTime(window.phaser.loop.delta)};updateActualFPS=()=>{let e=window.phaser.loop.actualFps;MZ.isNumber(e)&&ll?.updateActualFPS(e)}},OZ=My;var{frameCapture:Zxe}=codex,Oy=class{async init(){}},DZ=Oy;var BZ={GLOBAL:"global-leaderboard-key",FRIENDS:"friends-leaderboard-key"},UZ={GLOBAL:"global-leaderboard-id",FRIENDS:"friends-leaderboard-id"};var{Configs:{Mockup:{Leaderboards:NZ,GameSDK:{Player:jxe}},Leaderboards:FZ},Utils:{Number:kZ}}=Ludex,{leaderboard:Ks}=codex,Dy=class{init(){this.handleWhenGameSDKStarted()}handleWhenGameSDKStarted=()=>{NZ.Enabled?this.setupLeaderboardsMockup():this.setupLeaderboards()};async setupLeaderboards(){this.setupLeaderboardByConfigs()}setupLeaderboardByConfigs(){let{LeaderboardList:e}=FZ;for(let i of e){let{Id:s,Name:r}=i;Ks.addLeaderboard({name:r,type:"global",autoSortRank:!0,leaderboardId:s})}}async setupLeaderboardsMockup(){this.setupMockGlobalLeaderboards(),this.setupMockFriendsLeaderboard()}async setupMockGlobalLeaderboards(){let{NumOfLeaders:e}=NZ,{LeaderboardList:i}=FZ;for(let s of i){let{Name:r,Id:n}=s;if(!r)continue;let a=await Ks.createLeaderboardAsync({_id:n,name:r,numberOfLeaders:kZ.random(e.Max-e.Min)+e.Min});Ks.addLeaderboard({name:r,type:"global",autoSortRank:!0,leaderboardId:a}),await Ks.requestLeaderboardAsync(r,10);let o=Ks.getLeaderboard(r);console.info("setupGlobalLeaderboard fetch new",o,o&&Object.keys(o.leaders).length),o=Ks.getLeaderboard(r),console.info("setupGlobalLeaderboard load more",o,o&&Object.keys(o.leaders).length)}}async setupMockFriendsLeaderboard(){let e=BZ.FRIENDS,i=UZ.FRIENDS,s=0,{ConnectedPlayers:r}=jxe;r.Enabled&&(s=kZ.random(r.NumOfPlayers-1)+1);let n=await Ks.createLeaderboardAsync({_id:i,name:e,numberOfLeaders:s});Ks.addLeaderboard({name:e,type:"friends",autoSortRank:!0,leaderboardId:n}),await Ks.requestLeaderboardAsync(e,10);let a=Ks.getLeaderboard(e);console.info("setupFriendsLeaderboard done",a)}},GZ=Dy;var{missions:$xe}=codex,ul=class{async init(){$xe.requestMissions()}};var By=class{init(){console.info("Plugins Manager: Initialized")}initFrameCapture(){new DZ().init()}initLeaderboards(){new GZ().init()}initMissions(){new ul().init()}initAdaptivePerformance(){new OZ().init()}},qZ=By;var Uy=E(Ep()),WZ=E(qe()),{event:cl,monitorError:Jxe}=codex,{Events:ud}=Ludex,cd={duration:300,color:{r:0,g:0,b:0}},Ny=class{sceneInfo;callbackSwitchScene=null;init(){this.listenEvents(),this.sceneInfo={sceneName:z.BOOT_SCENE,sceneData:{}},console.info("Scene Manager: Initialized")}listenEvents(){cl.on(ud.SWITCH_SCENE,this.switchScene),cl.on(ud.SCENE_LOADED,this.handleSceneLoaded),cl.on(ud.SCENE_LAUNCHED,this.handleSceneLaunched)}correctSceneName(e){let{sceneName:i}=e;return i===this.sceneInfo.sceneName?null:i===z.DASHBOARD_SCENE?z.GAME_SCENE:i}switchScene=async e=>{console.groupCollapsed("Scene Process Info");let{sceneData:i,transition:s}=e,r=this.correctSceneName(e);console.debug("Switching",r,i??{}),r&&(this.startScene({sceneName:r,sceneData:i,transition:s}),console.groupEnd())};sleepOtherScenes=e=>{let{scenes:i}=window.phaser.scene;for(let s of i)s.scene.isActive()&&s.scene.key!==e&&s.scene.key!==z.GLOBAL_SCENE&&s.scene.sleep()};async startScene(e){let{sceneName:i,sceneData:s,transition:r}=e,{sceneName:n}=this.sceneInfo;console.log("Start scene",i),console.log("Current scene",n);let{scene:a}=window.phaser;a.dump(),this.sceneInfo={sceneName:i,sceneData:s},r!==void 0&&(await this.fadeOutScene(n,r),window.phaser.scene.getScene(i).events.once(WZ.PRE_RENDER,()=>{this.resetFadeOutScene(n),this.fadeInScene(i,r)})),a.switch(n,i),cl.emit(we.DESTROY_SCREENS,{sceneKey:n}),a.dump(),W.setCurrentScene(i)}resetFadeOutScene(e){window.phaser.scene.getScene(e).cameras.main.fadeEffect.reset()}fadeInScene(e,i){let{duration:s=cd.duration,color:r=cd.color}=i,n=window.phaser.scene.getScene(e);return n.cameras.main.fadeIn(s,r.r,r.g,r.b),new Promise(a=>{n.cameras.main.once(Uy.Scene2D.Events.FADE_IN_COMPLETE,a)})}fadeOutScene(e,i){let{duration:s=cd.duration,color:r=cd.color}=i,n=window.phaser.scene.getScene(e);return n.cameras.main.fadeOut(s,r.r,r.g,r.b),new Promise(a=>{n.cameras.main.once(Uy.Scene2D.Events.FADE_OUT_COMPLETE,a)})}handleSceneLoaded=e=>{let{sceneName:i,sceneData:s}=this.sceneInfo;e.sceneName===i&&this.setSceneData(i,s??{})};handleSceneLaunched=e=>{let{sceneName:i,sceneData:s}=this.sceneInfo;e.sceneName===i&&(se.switchSceneTracking(),Jxe?.addMetadata({currentScene:i}),this.callbackSwitchScene?.({sceneName:i,sceneData:s}),this.sleepOtherScenes(i),cl.emit(ud.SCENE_RENDERED,{sceneName:i}))};onSwitchScene(e){this.callbackSwitchScene=e}setSceneData(e,i){if(!i)return;let s=window.phaser.scene.getScene(e),n={...s.data.get("data"),...i};s.data.set("data",n),console.debug("SceneManager.setSceneData",{sceneName:e,sceneData:n})}},YZ=Ny;var HZ=E(X()),ea=E(ie()),zZ=E(he()),Fy=class extends HZ.Container{payload;process;minProcess;maxProcess;progressBoxLeft;progressBoxBg;progressBoxRight;progressBarLeft;progressBarBg;progressBarRight;progressAnimation;constructor(e,i){super(e),this.payload=i;let s=i.width;this.setSize(s,39),this.process=0,this.minProcess=0,this.maxProcess=1,this.createProgressBox(),this.createProgressBar(),this.createContainer()}setProcess(e,i=!1){if(this.process=this.getCorrectValue(e),!this.scene||i){this.updateProcess();return}this.runProcessAnimation(e)}updateProcess(){let{displayHeight:e}=this.progressBarBg,i=this.getDisplayWidthByProcess(this.process);this.progressBarBg.setWorldSize(i,e);let{x:s}=this.progressBarBg;this.progressBarRight.setX(s+i)}getCorrectValue(e){let i=e;return isFinite(i)||(i=0),i<this.minProcess&&(i=this.minProcess),i>this.maxProcess&&(i=this.maxProcess),i}getDisplayWidthByProcess(e){let{width:i}=this;return(i-17)*e}getProcessByDisplayWidth(e){let{width:i}=this;return e/(i-17)}runProcessAnimation(e){this.progressAnimation?.remove(),this.progressAnimation=this.scene.add.tween({targets:[this.progressBarBg],duration:1e3,ease:zZ.Quadratic.InOut,props:{displayWidth:()=>{let i=this.getCorrectValue(e);return this.getDisplayWidthByProcess(i)}},onUpdate:()=>{let{x:i,displayWidth:s}=this.progressBarBg;this.progressBarRight.setX(i+s)},onComplete:()=>{this.updateProcess()}})}createProgressBox(){let{key:e,frames:i}=this.payload;this.progressBoxLeft=this.scene.make.image({key:e,frame:i.PROGRESS_BG_LEFT}),this.progressBoxLeft.setOrigin(0,.5),this.progressBoxLeft.setWorldSize(9,39),this.progressBoxRight=this.scene.make.image({key:e,frame:i.PROGRESS_BG_RIGHT}),this.progressBoxRight.setOrigin(0,.5),this.progressBoxRight.setWorldSize(9,39),this.progressBoxBg=this.scene.make.image({key:e,frame:i.PROGRESS_BG_MID}),this.progressBoxBg.setOrigin(0,.5),this.progressBoxBg.setWorldSize(9,39);let{displayHeight:s}=this.progressBoxBg,{displayWidth:r}=this,{displayWidth:n}=this.progressBoxLeft,{displayWidth:a}=this.progressBoxRight;this.progressBoxLeft.setWorldSize(n,s),this.progressBoxRight.setWorldSize(a,s),this.progressBoxBg.setWorldSize(r-(n+a),s),ea.Align.In.Center(this.progressBoxBg,this,0,0),ea.Align.In.LeftCenter(this.progressBoxLeft,this,0,0),ea.Align.In.RightCenter(this.progressBoxRight,this,0,0)}createProgressBar(){let{key:e,frames:i}=this.payload;this.progressBarLeft=this.scene.make.image({key:e,frame:i.PROGRESS_BAR_LEFT}),this.progressBarLeft.setOrigin(0,.5),this.progressBarLeft.setWorldSize(8.5,32),this.progressBarRight=this.scene.make.image({key:e,frame:i.PROGRESS_BAR_RIGHT}),this.progressBarRight.setOrigin(0,.5),this.progressBarRight.setWorldSize(8.5,32),this.progressBarBg=this.scene.make.image({key:e,frame:i.PROGRESS_BAR_MID}),this.progressBarBg.setOrigin(0,.5),this.progressBarBg.setWorldSize(8.5,32);let s=-2,r=-1.6;ea.Align.In.LeftCenter(this.progressBarBg,this,-7,r),ea.Align.In.LeftCenter(this.progressBarLeft,this,s,r),ea.Align.In.LeftCenter(this.progressBarRight,this,s,r),this.setProcess(0,!0)}createContainer(){this.add([this.progressBoxBg,this.progressBoxLeft,this.progressBoxRight,this.progressBarBg,this.progressBarLeft,this.progressBarRight]),this.scene.add.existing(this)}},VZ=Fy;var XZ=E(he()),KZ=E(ie()),{language:ky}=codex,{KEY:Qxe,FRAME:eCe}=T.DEFAULT,Gy=class extends VZ{loadingText;constructor(e,i){super(e,{key:Qxe,frames:eCe,width:i}),this.createLoadingText()}createLoadingText(){this.loadingText=P.buildText(`${ky.getText("LOADING").toUpperCase()}0%`,20).setDefaultStroke().setFixedWidth(13*20).setAlign("center").setHighQuality().setDefaultShadow({offsetY:12}).build(this.scene),this.add(this.loadingText),KZ.Align.In.Center(this.loadingText,this,0,-2)}updateProcess(){let{displayHeight:e}=this.progressBarBg,i=this.getDisplayWidthByProcess(this.process);this.progressBarBg.setWorldSize(i,e);let{x:s}=this.progressBarBg;if(this.progressBarRight.setX(s+i),this.loadingText){let r=Math.floor(this.getProcessByDisplayWidth(i)*100);this.loadingText.setText(`${ky.getText("LOADING").toUpperCase()}${r}%`)}}runProcessAnimation(e){this.progressAnimation?.stop(),this.progressAnimation?.remove(),this.progressAnimation=this.scene.add.tween({targets:[this.progressBarBg],duration:600,ease:XZ.Circular.InOut,props:{displayWidth:()=>{let i=this.getCorrectValue(e);return this.getDisplayWidthByProcess(i)}},onUpdate:()=>{let{x:i,displayWidth:s}=this.progressBarBg;this.progressBarRight.setX(i+s);let r=Math.floor(this.getProcessByDisplayWidth(s)*100);this.loadingText.setText(`${ky.getText("LOADING").toUpperCase()}${r}%`)},onComplete:()=>{this.updateProcess()}})}},ZZ=Gy;var tCe={SCREEN:200,POPUP:300,SPLASH:400,PRIORITY:999},At=tCe;var qy=E(ie()),jZ=E(ss()),{KEY:iCe,FRAME:sCe}=T.DEFAULT_8_BIT,Wy=class extends De{progressBar;constructor(e,i){super(e,i),this.background.setAlpha(.8),this.setDepth(At.SPLASH),this.createTitleIcon(),this.createProgressBar(),this.scene.game.scene.getScene(z.LOAD_SCENE).load.on(jZ.PROGRESS,r=>{this.progressBar.setProcess(r)})}open(e){super.open(e),this.progressBar.setProcess(0,!0),W.getGlobalScene()?.requestBackgroundMaskUpdate(O.LOADING_SCREEN,.8),this.scene.time.delayedCall(200,()=>{this.progressBar.setProcess(.2)})}close(){this.scene.time.delayedCall(600,()=>{let e=W.getGlobalScene();e?.requestBackgroundMaskUpdate(O.LOADING_SCREEN,0);let i=k.getScreen(O.BATTLE_SCREEN);i&&!i.visible&&e?.requestBackgroundMaskUpdate(O.BATTLE_SCREEN,0);let s=k.getScreen(O.LEADER_BOARD_SCREEN);s&&!s.visible&&e?.requestBackgroundMaskUpdate(O.LEADER_BOARD_SCREEN,0),this.progressBar.setProcess(1),super.close()})}createTitleIcon(){let e=this.scene.make.image({key:iCe,frame:sCe.ICON_TITLE});e.setWorldSize(213.5,157.5),qy.Align.In.Center(e,this,0,-150),this.add(e)}createProgressBar(){this.progressBar=new ZZ(this.scene,450),this.progressBar.setScale(.6),qy.Align.In.Center(this.progressBar,this),this.add(this.progressBar)}},$Z=Wy;var rCe={duration:300,ease:So,props:{scale:{from:1.2,to:1}}},pi=rCe;var dd=E(ie()),ej=E(he());var JZ=E(X()),Yy=class extends JZ.Container{constructor(e,i,s,r){let n=e.make.image(i);super(e,s,r,[n]),this.setSize(n.width,n.height),e.add.existing(this)}},QZ=Yy;var Hy=E(nt()),{Utils:{Signal:nCe}}=Ludex,{KEY:aCe,FRAME:oCe}=T.DEFAULT_8_BIT,zy=class extends De{notifyIcon$;loadingIcon$;messageText$;animController=new nCe.SignalController;closeTimerEvent$;constructor(e,i){super(e,i),this.notifyIcon$=this.addNotifyIcon$(),this.loadingIcon$=this.addLoadingIcon$(),this.messageText$=this.addMessageText$(),this.add([this.notifyIcon$,this.loadingIcon$,this.messageText$]),dd.Align.In.Center(this.loadingIcon$,this.zone,0,-40),dd.Align.In.Center(this.notifyIcon$,this.zone,0,-40),dd.Align.In.Center(this.messageText$,this.zone,0,40),this.setDepth(At.PRIORITY)}open(e){super.open(e);let{message:i="",duration:s=0,loading:r=!1,enableCloseOnTouch:n=!1}=e;this.setMessage$(i),this.setIcon$(r),this.closeTimerEvent$?.remove();let a=()=>{n&&this.scene.input.off(Hy.POINTER_DOWN,a),this.visible&&this.runCloseAnimation$()};n&&this.scene.input.once(Hy.POINTER_DOWN,a),s>0&&(this.closeTimerEvent$=this.scene.time.addEvent({delay:s,callback:a})),this.runOpenAnimation$()}addNotifyIcon$(){return new QZ(this.scene,{key:aCe,frame:oCe.ICON_ALERT})}addLoadingIcon$(){return new Hs(this.scene)}addMessageText$(){return P.buildText("",24).setDefaultStroke().setDefaultShadow({offsetX:0,offsetY:3}).setOrigin({x:.5,y:0}).setAlign("center").setWordWrap({width:this.zone.width-50,useAdvancedWrap:!0}).build(this.scene)}setMessage$(e){this.messageText$.setText(e)}setIcon$(e){this.loadingIcon$.setVisible(e),this.notifyIcon$.setVisible(!e)}runOpenAnimation$(){let e=this.animController.renew();this.background.setAlpha(0),this.animateBackgroundAlpha(.8),H.runTween(this.scene.tweens.add({...pi,targets:[this.loadingIcon$,this.notifyIcon$,this.messageText$],props:{scale:{from:.7,to:1},alpha:1}}),e)}runCloseAnimation$(){let e=this.animController.renew();this.animateBackgroundAlpha(0,200),H.runTween(this.scene.tweens.add({duration:300,targets:[this.loadingIcon$,this.notifyIcon$,this.messageText$],ease:ej.Cubic.Out,props:{scale:{from:1,to:.7},alpha:0},onComplete:()=>{k.closeScreen(this.name)}}),e)}},tj=zy;var Ao=E(he()),hCe={props:{alpha:{start:0,to:1,duration:500,ease:Ao.Cubic.Out},scale:{start:.8,to:1,duration:1e3,ease:Ao.Elastic.Out,easeParams:[.1,.45]},y:{start:0,to:0,duration:500,ease:Ao.Back.Out}},delay:0},He=hCe;var{KEY:lCe,FRAME:uCe}=T.DEFAULT_8_BIT,Vy=class extends fe{constructor(e){super(e,lCe,uCe.BUTTON_CLOSE,31.5,31.5),this.scene=e,this.setName("Close")}playSound(){q.playSound(J.CLOSE_CLICK,{volume:.3})}},Yt=Vy;var Jj=E(hb()),awe=`
precision mediump float;

uniform sampler2D uMainSampler;
// uniform vec2 uResolution; //khong co
uniform float uCameraZoom;

uniform vec2 iResolution;

uniform vec4 lightPosition;
uniform vec4 lightColor;
uniform float lightRadius;
uniform float lightAttenuation;

varying vec2 outTexCoord;
varying float outTintEffect;
varying vec4 outTint;

void main (void)
{
    vec4 pos = vec4(0.2, 0.3, 1.0, 200);

    // vec2 center = (lightPosition.xy + 1.0) * (iResolution.xy * 0.5);
    // vec2 center = lightPosition.xy
    float distToSurf = length(lightPosition.xy / uCameraZoom - gl_FragCoord.xy / uCameraZoom);
    float radius = 1.0 - distToSurf / lightRadius;
    /* if (distToSurf > 50.0) {
        gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);
        return; 
    } */
    /* if (radius > 0.5) {
        gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);
        return; 
    } */
    
    float intensity = smoothstep(0.0, 1.0, radius * lightAttenuation);
    /* if (intensity == 0.0) {
        gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);
        return;
    } */

    vec4 color = vec4(intensity, intensity, intensity, 0.0) * lightColor;
    gl_FragColor = vec4(color.rgb * lightColor.a, color.a);
}
`,lb=class extends Jj.SinglePipeline{static KEY="GlowLightPipeLine";constructor(e){super({game:e,fragShader:awe})}onRender(e,i){this.set1f("uCameraZoom",i.zoom)}},El=lb;var Qj=E(X()),e8=E(vr()),Tl=E(ES());var{KEY:owe,FRAME:hwe}=T.DEFAULT_8_BIT,ub=class extends Qj.Container{config;shaderSprite;isWebGl=!0;lightRadius=0;constructor(e,i){super(e),this.config={background:0,bottomRightCorner:221341,rightEdge:423092,bottomEdge:83583,mainTopColorGradient:732242,mainBotColorGradient:155294,shadowHeight:7,bgCornerStrokeWidth:2,topInnerCornerStrokeWidth:4,botInnerCornerStrokeWidth:4,rightInnerCornerStrokeWidth:4,lightX:0,lightY:0,...i},this.scene.game.canvas.getContext("webgl")||(this.isWebGl=!1),this.isWebGl&&!this.scene.game.renderer.pipelines.pipelines.has(El.KEY)&&this.scene.game.renderer.pipelines.add(El.KEY,new El(this.scene.game)),this.setDepth(B.POPUP),this.createGraphicsPopup(),this.createShaderSprite(),this.createLightEffect(),this.updateSize(),this.scene.add.existing(this)}updateSize(){let{width:e,height:i}=this.config;this.setWorldSize(e,i)}createGraphicsPopup(){let{x:e,y:i,width:s,height:r,background:n,bottomRightCorner:a,rightEdge:o,bottomEdge:h,mainBotColorGradient:l,mainTopColorGradient:c,shadowHeight:d,bgCornerStrokeWidth:f,topInnerCornerStrokeWidth:p,botInnerCornerStrokeWidth:m,rightInnerCornerStrokeWidth:v}=this.config,g=this.scene.make.graphics({}),S=new e8.Rectangle(e-s/2,i-r/2,s,r);g.fillStyle(0,.3),g.fillRoundedRect(S.left,S.bottom-10,S.width,10+d,{tl:0,tr:0,bl:12,br:12}),g.fillStyle(n),g.fillRoundedRect(S.left,S.top,S.width,S.height,{tl:8,tr:8,bl:12,br:12}),g.fillStyle(a),g.fillRoundedRect(S.left+f,S.bottom-50,S.width-f*2,50-f,{tl:0,tr:0,bl:30,br:8}),g.fillStyle(o),g.fillRoundedRect(S.left+f,S.top+f,S.width-f*2,S.height-f*2-m,{tl:8,tr:8,bl:30,br:12}),g.fillStyle(h),g.fillRoundedRect(S.left+f,S.bottom-50,S.width-f*2-v,50-f,{tl:8,tr:0,bl:8,br:3}),g.fillGradientStyle(c,c,l,l),g.fillRect(S.left+f,S.top+f+p+10,S.width-f*2-v,S.height-f*2-m-p-20),g.fillStyle(c),g.fillRoundedRect(S.left+f,S.top+f+p,S.width-f*2-v,10,{tl:8,tr:8,bl:0,br:0}),g.fillStyle(l),g.fillRoundedRect(S.left+f,S.bottom-f-m-10,S.width-f*2-v,7,{tl:0,tr:0,bl:3,br:0}),this.add(g)}createShaderSprite(){let{width:e,height:i}=this.config,s=this.scene.make.image({key:owe,frame:hwe.BLANK});s.setWorldSize(e,i),this.add(s),this.shaderSprite=s,this.shaderSprite.kill()}createLightEffect(){if(!this.isWebGl)return;let{width:e,mainTopColorGradient:i}=this.config;this.shaderSprite.revive(),this.shaderSprite.setPipeline(El.KEY);let s=(0,Tl.ColorToRGBA)(i),r=(0,Tl.ObjectToColor)({r:s.r,g:s.g,b:s.b,a:s.a});r.lighten(90);let n=(0,Tl.ColorToRGBA)(r.color),a=this.scene.game.canvas.getContext("webgl")?.drawingBufferWidth,o=this.scene.game.canvas.getContext("webgl")?.drawingBufferHeight;if(!a||typeof a!="number"||!o||typeof o!="number")return;this.lightRadius=e/1.2,this.recalculateLightPosition();let h=1,l=1,c=.4;this.shaderSprite.pipeline.set2f("iResolution",a,o),this.shaderSprite.pipeline.set4f("lightColor",n.r/255*h,n.g/255*h,n.b/255*h,c),this.shaderSprite.pipeline.set1f("lightRadius",this.lightRadius),this.shaderSprite.pipeline.set1f("lightAttenuation",l)}turnOffLight(){this.shaderSprite.kill(),this.shaderSprite.resetPipeline()}recalculateLightPosition(){if(!this.isWebGl||!this.shaderSprite.active||!(this.scene instanceof Ns))return;if(console.log("Pipeline debug:",{shaderSprite:this.shaderSprite,pipeline:this.shaderSprite.pipeline,pipelineType:typeof this.shaderSprite.pipeline,isNull:this.shaderSprite.pipeline===null,isUndefined:this.shaderSprite.pipeline===void 0}),!this.shaderSprite.pipeline){console.error("Pipeline is not available on shaderSprite");return}let{lightX:i,lightY:s}=this.config,{width:r,height:n}=I.getWorldSize(),a=this.scene.game.renderer,o=a.width||this.scene.game.canvas.getContext("webgl")?.drawingBufferWidth,h=a.height||this.scene.game.canvas.getContext("webgl")?.drawingBufferHeight;if(!o||typeof o!="number"||!h||typeof h!="number")return;let l=this.shaderSprite.getWorldPosition();let c=o*(r/2+l.x+i)/r,d=h*(n-(n/2+l.y+s))/n;try{this.shaderSprite.pipeline.set4f("lightPosition",c,d,1e3,this.lightRadius),console.log("lightX",c,"lightY",d,"graphicsWorldPos",l.x,l.y),this.shaderSprite.pipeline.set1f("lightRadius",this.lightRadius)}catch(f){console.error("Error setting pipeline uniforms:",f),console.log("Pipeline methods available:",Object.getOwnPropertyNames(this.shaderSprite.pipeline))}}},Ht=ub;var r8=E(ie()),{KEY:t8,FRAME:i8}=T.DEFAULT_8_BIT,{language:s8}=codex,cb=class extends fe{constructor(e){super(e,t8,i8.OFFLINE_REWARD_GREEN_BTN,128.5,45.5),this.createCoinIcon(),this.createText()}createCoinIcon(){let e=this.scene.make.image({key:t8,frame:i8.OFFLINE_REWARD_GOLD});e.setWorldSize(32.5,30.5),e.setPosition(-35,0),this.add(e)}createText(){let e=s8.getCurrentLocale(),i=15;switch(e){case"de":case"it":i=13;break}let s=P.buildText(s8.getText("COLLECT"),i).setDefaultStroke().setOrigin({x:.5,y:.65}).setFixedWidth(13*15).setAlign("center").setHighQuality().build(this.scene);r8.Align.In.RightCenter(s,this.button,0,0),s.setPosition(15,0),this.add(s)}},n8=cb;var a8=E(X()),{KEY:lwe,FRAME:uwe}=T.DEFAULT_8_BIT,db=class extends a8.Container{icon;text;constructor(e){super(e),this.createIcon(),this.createCoinText(),this.scene.add.existing(this)}createIcon(){let e=this.scene.make.image({key:lwe,frame:uwe.OFFLINE_REWARD_GOLDS});e.setWorldSize(55,39.5),e.setPosition(50,0),this.add(e),this.icon=e}createCoinText(){let e=P.buildText("+100 coins",35).setColor("#F0DB0F").setFixedWidth(455).setAlign("center").setDefaultStroke().setHighQuality().setDefaultShadow({offsetX:-8,offsetY:8}).build(this.scene);e.setPosition(-30,0),this.add(e),this.text=e}setText(e){this.text.setText(`+${e}`)}},o8=db;var h8=E(X());var{KEY:cwe,FRAME:dwe}=T.DEFAULT_8_BIT,{language:fwe}=codex,fb=class extends h8.Container{constructor(e){super(e),this.createRibbon(),this.createTitle(),this.scene.add.existing(this)}createRibbon(){let e=this.scene.make.image({key:cwe,frame:dwe.OFFLINE_REWARD_RIBBON});e.setWorldSize(247,43.5),this.add(e)}createTitle(){let e=P.buildText(fwe.getText("OFFLINE_COINS_REWARDS").toUpperCase(),15).applyScreenHeaderStyle().setFixedWidth(195).build(this.scene);e.setPosition(0,-4),this.add(e)}createUnderlineText(){let e=P.buildText("Get Free Coins!",12).setColor("#D5330F").setFixedWidth(130).setAlign("center").setHighQuality().build(this.scene);e.setPosition(0,5),this.add(e)}},l8=fb;var yd=E(X()),Ro=E(ve()),pb=class extends yd.Container{payload;constructor(e,i){super(e),this.payload=i,this.createGraphics(),this.scene.add.existing(this)}createGraphics(){let{lineNumber:e=16}=this.payload;for(let i=0;i<e;i++){let s=this.drawCardinalTriangle(),r=(0,Ro.DegToRad)(i*(360/e));s.setPosition(0,0),s.setRotation(r),this.scene.add.existing(s),this.add(s)}}drawCardinalTriangle(){let{color:e,radius:i,width:s}=this.payload,r=Ro.RND.between(i.min,i.max),n=new yd.Graphics(this.scene);n.clear();let a=[{x:0,y:0}],o=Ro.RND.between(s.min,s.max),h=(0,Ro.DegToRad)(o),l={x:r,y:r*Math.tan(h)};a.push(l);let c={x:r,y:r*Math.tan(h)*-1};a.push(c),n.lineStyle(1,16777215,0),n.beginPath(),n.moveTo(a[0].x,a[0].y);for(let d=1;d<a.length;d++)n.lineTo(a[d].x,a[d].y);return n.closePath(),n.strokePath(),n.fillGradientStyle(e,e,e,e,0,1,0,1),n.fillPath(),n}},bd=pb;var u8=E(X()),Ad=E(ve()),c8=E(he()),{KEY:yl,FRAME:bl}=T.DEFAULT_8_BIT,mb=class extends u8.Container{listParticle=[];backEffect;tween;backEffectTween;constructor(e){super(e),this.createBackEffect(),this.createTicketCoin(),this.createParticle(),this.createAnimation(),this.scene.add.existing(this)}createBackEffect(){let e=new bd(this.scene,{color:234748,width:{min:4,max:8},radius:{min:180,max:170},lineNumber:18});e.setPosition(0,110),this.add(e),this.backEffect=e}createTicketCoin(){let e=this.scene.make.image({key:yl,frame:bl.OFFLINE_REWARD_TICKET});e.setWorldSize(155.5,124.5),e.setPosition(0,110),this.add(e)}createParticle(){let e=this.scene.make.image({key:yl,frame:bl.OFFLINE_REWARD_PARTICLE_1});e.setWorldSize(23,23),e.setPosition(-102,100),this.add(e),this.listParticle.push(e),e=this.scene.make.image({key:yl,frame:bl.OFFLINE_REWARD_PARTICLE_1}),e.setWorldSize(23,23),e.setPosition(78,156),this.add(e),this.listParticle.push(e),e=this.scene.make.image({key:yl,frame:bl.OFFLINE_REWARD_PARTICLE_2}),e.setWorldSize(14.5,15),e.setPosition(-90,129),this.add(e),this.listParticle.push(e),e=this.scene.make.image({key:yl,frame:bl.OFFLINE_REWARD_PARTICLE_2}),e.setWorldSize(14.5,15),e.setPosition(100,110),this.add(e),this.listParticle.push(e),this.listParticle.push(e)}createAnimation(){let e=this.listParticle[0].scale;this.tween=this.scene.add.tween({paused:!0,targets:this.listParticle,duration:800,ease:c8.Cubic.Out,repeat:-1,yoyo:!0,delay:this.scene.tweens.stagger(50,{start:Math.random()*50+50}),props:{scale:{from:e,to:e*(0,Ad.FloatBetween)(.7,.9)}}}),this.backEffectTween=this.scene.add.tween({paused:!0,targets:this.backEffect,duration:1e6,ease:Ad.Linear,repeat:-1,props:{rotation:{start:0,to:180}}})}runAnimation(){this.tween.resume(),this.backEffectTween.resume()}stopAnimation(){this.tween.pause(),this.backEffectTween.pause()}},d8=mb;var v8=E(ie()),{KEY:f8,FRAME:p8}=T.DEFAULT_8_BIT,{language:m8}=codex,vb=class extends fe{constructor(e){super(e,f8,p8.OFFLINE_REWARD_YELLOW_BTN,128.5,45.5),this.createCoinIcon(),this.createText()}createCoinIcon(){let e=this.scene.make.image({key:f8,frame:p8.OFFLINE_REWARD_ADS});e.setWorldSize(32,30),e.setPosition(-40,-3),this.add(e)}createText(){let e=m8.getCurrentLocale(),i=15;switch(e){case"pt":case"es":i=12;break;case"de":case"it":i=13;break}let s=P.buildText(m8.getText("X2_COINS").toUpperCase(),i).setOrigin({x:.5,y:.65}).setFixedWidth(13*15).setAlign("center").setDefaultStroke().setHighQuality().build(this.scene);v8.Align.In.RightCenter(s,this.button,0,0),s.setPosition(15,0),this.add(s)}},g8=vb;var sa=E(ie()),S8=E(he()),{Plugins:{Ads:{Types:{REWARDED_VIDEO:pwe}}}}=Ludex,{Utils:{Signal:mwe}}=Ludex,gb=class extends De{rewardValue;closeBtn;collectButton;viewAdButton;coinIcon;contents;title;popup;screenAnimController=new mwe.SignalController;adsTimer;constructor(e,i){super(e,i),this.setName(i),this.setDepth(At.POPUP),this.background.setAlpha(.7),this.createPopup(),this.createTicketCoinIcon(),this.createCloseBtn(),this.createContents(),this.createTitle(),this.createCollectButton(),this.createViewAdsButton()}open=e=>{super.open(e),this.scene.scene.get(z.GAME_SCENE)instanceof oe&&k.listenResizeEventForCalculateLight(this),ae.isReadyAdShowable(pwe)?this.viewAdButton.setDisabled(!1):this.viewAdButton.setDisabled(!0);let s=this.getData("rewardValue");this.setRewardValue(this.calculateRewardCoins(s)),this.runOpenAnimation()};createPopup(){this.popup=new Ht(this.scene,{x:0,y:0,width:332,height:404.5,rightEdge:870778,bottomRightCorner:221341,topInnerCornerStrokeWidth:2,rightInnerCornerStrokeWidth:3,lightY:-80}),this.add(this.popup)}recalculateLightPosition(){this.popup&&this.popup.recalculateLightPosition()}createTicketCoinIcon(){let e=new d8(this.scene);sa.Align.In.TopCenter(e,this.popup,0,-30),this.add(e),this.coinIcon=e}createCloseBtn(){let e=new Yt(this.scene);e.onClick=this.handleClosePopup,sa.Align.In.TopRight(e,this.popup,10,10),this.popup.add(e),this.closeBtn=e}createContents(){let e=new o8(this.scene);sa.Align.In.Center(e,this.popup,0,60),this.add(e),this.contents=e}createTitle(){let e=new l8(this.scene);sa.Align.In.TopCenter(e,this.popup,0,-10),this.add(e),this.title=e}createCollectButton(){let e=new n8(this.scene);e.setName("Collect"),e.onClick=this.handleClosePopup,sa.Align.In.BottomCenter(e,this.popup,-70,-20),this.add(e),this.collectButton=e}createViewAdsButton(){let e=new g8(this.scene);e.setName("CollectX2"),e.onClick=this.handleShowRewardedVideoAd,sa.Align.In.BottomCenter(e,this.popup,70,-20),this.add(e),this.viewAdButton=e}handleClosePopup=()=>{this.runCloseAnimation(),this.rewardCoins(this.rewardValue)};handleShowRewardedVideoAd=async()=>{if(this.viewAdButton.setDisabled(!0),await ae.showRewardVideoAdAsync()){q.playSound(J.DAILY_REWARD);let i=this.rewardValue.clone();i.multiply(2),this.rewardCoins(i),this.runCloseAnimation()}this.viewAdButton.setDisabled(!1)};runOpenAnimation(){W.getGlobalScene()?.requestBackgroundMaskUpdate(O.OFFLINE_REWARD_SCREEN,this.background.alpha);let i=this.screenAnimController.renew();this.animateBackgroundAlpha(.7,200),this.runPopupEntrancesAnimation(i),this.runPopupContentEntrancesAnimation(100,400,i)}runCloseAnimation=()=>{let e=this.screenAnimController.renew();this.runExitsAnimation(0,200,e)};runPopupEntrancesAnimation(e){H.runTween(this.scene.tweens.add({...He,paused:!0,targets:[this.popup,this.title],onStart:()=>{this.popup.revive()}}),e)}runPopupContentEntrancesAnimation(e,i,s){this.coinIcon.runAnimation();let r=[this.collectButton,this.viewAdButton,this.contents],n=r.map(a=>a.alpha);r.forEach(a=>a.setAlpha(0)),H.runTween(this.scene.tweens.add({...pi,targets:r,duration:i,delay:this.scene.tweens.stagger(100,{start:e}),props:{scale:{getStart:a=>a.scale-.3,getEnd:a=>a.scale},alpha:{getStart:()=>0,getEnd:(a,o,h,l)=>n[l]}}}),s)}rewardCoins(e){let i=e;Se.inst.addCoin(i);let s=this.scene.scene.get(z.GAME_SCENE);s instanceof oe&&s.updateUI()}calculateRewardCoins(e){let i=e/60>24?24:e/60,s=this.getUnitPriceFromGameScene(),r=new be(L.BASE_UNIT_COIN),n=this.getMaxRewardUnitCount()*(i/24);return s.multiply(n),s.smallerThan(r)&&(s=r),s}getUnitPriceFromGameScene(){let e=this.scene.scene.get(z.GAME_SCENE);if(!(e instanceof oe))return new be(2);let{unitManager:i,coinManager:s}=e,r=i.getPlayerMeleeSpawnedUnitsCount(),n=i.getPlayerRangedSpawnedUnitsCount(),a=r>n?r:n;return s.getUnitPrice(a)}getMaxRewardUnitCount(){let i=de.getLevelProgress();return i<0&&(i=0),i++,i>=251?4.5:i>=151?6.5:i>=51?8.5:12.5}runExitsAnimation(e,i,s){this.collectButton.setDisabled(!0);let r=[this.coinIcon,this.contents,this.title,this.collectButton,this.viewAdButton];this.animateBackgroundAlpha(0,200),H.runTween(this.scene.tweens.add({paused:!0,targets:r,delay:e,duration:i,props:{alpha:{start:.7,from:.7,to:0}},ease:S8.Cubic.Out,onStart:()=>{this.popup.kill()},onUpdate:(n,a)=>{W.getGlobalScene()?.requestBackgroundMaskUpdate(O.OFFLINE_REWARD_SCREEN,a.alpha)},onComplete:()=>{this.scene.scene.get(z.GAME_SCENE)instanceof oe&&k.removeResizeEventForCalculateLight(this),k.closeScreen(this.name),this.collectButton.setDisabled(!1),this.coinIcon.stopAnimation()}}),s)}setRewardValue(e){this.rewardValue=e,this.contents.setText(e.toString())}},E8=gb;var T8=E(Fc()),vwe=(0,T8.default)(.55,.47,.43,.91),y8=vwe;var gwe={yoyo:!0,repeat:-1,duration:600,repeatDelay:50,ease:y8,easeParams:[0,.9],props:{scale:{from:1,to:1.2}}},xd=gwe;var d6=E(he()),f6=E(c6()),CRe={repeat:-1,yoyo:!0,duration:33,ease:d6.Sine.InOut},Db=class{posX;tween;constructor(e,i){let s={...CRe,...i,props:{x:i.shakeX??5,...i.props}};this.posX=typeof s.props.x=="number"?s.props.x:5,this.tween=e.tweens.add(s),this.tween?.on(f6.Events.TWEEN_REPEAT,this.handleSwitchPosition,this)}handleSwitchPosition(){this.posX=-this.posX,this.tween?.updateTo("x",-this.posX)}},Ud=Db;var Bb=class extends fe{paddingZone;showDebugZone;debugZone;constructor(e,i){let{key:s,frame:r,width:n,height:a,usePixelPerfect:o}=i;super(e,s,r,n,a,o);let{paddingZone:h=0,showDebugZone:l=!1}=i;this.paddingZone=h,this.showDebugZone=l}updateSize(){super.updateSize();let{width:e,height:i}=this,s=e+this.paddingZone,r=i+this.paddingZone;this.setSize(s,r),this.hitZone.setSize(s,r),this.showDebugZone&&(this.debugZone?.destroy(),this.debugZone=this.hitZone.drawDebugBox(10699282,.5),this.add(this.debugZone))}},Nd=Bb;var p6=E(X()),Ub=E(he()),m6=E(vr()),{KEY:wRe,FRAME:RRe}=T.EFFECTS,Nb=class extends p6.Container{emitZone;emitter;constructor(e){super(e),this.createEmitZone(),this.createEmitters(),this.scene.add.existing(this)}createEmitZone(){this.emitZone=new m6.Rectangle}createEmitters(){let e=1/I.getPixelRatio();this.emitter=this.scene.make.particles({key:wRe,config:{frame:RRe.FX_COMET,emitZone:{source:this.emitZone,type:"random"},deathZone:{source:this.emitZone,type:"onLeave"},timeScale:1,frequency:150,speedY:{min:-20,max:-60},alpha:{start:1,end:0,ease:Ub.Cubic.Out},scale:{start:e*1,end:0,ease:Ub.Cubic.Out},lifespan:{min:1500,max:2500}}})}run(e,i,s,r,n){this.stop(),this.emitZone.setSize(r,n),this.emitZone.setPosition(i-r/2,s-n/2),this.emitter.setQuantity(e),this.emitter.start()}stop(){this.emitter?.killAll(),this.emitter?.stop()}},v6=Nb;var g6=E(X()),S6=E(vr()),Fb=E(ve()),{KEY:PRe,FRAME:_Re}=T.DEFAULT_8_BIT,kb=class extends g6.Container{emitZone;emitter;constructor(e){super(e),this.createEmitZone(),this.scene.add.existing(this)}createEmitZone(){this.emitZone=new S6.Rectangle}createEmitters(){let e=1/I.getPixelRatio();this.emitter=this.scene.make.particles({key:PRe,config:{frame:_Re.UNIT_REWARD_PARTICLE,emitZone:{source:this.emitZone,type:"random"},timeScale:1,frequency:100,rotate:{min:0,max:90},alpha:{start:1,end:0,ease:Fb.Easing.Expo.Out},scale:{start:e*1,end:0,ease:Fb.Easing.Expo.Out},lifespan:{min:3e3,max:4500}}})}run(e,i,s,r,n,a=100){this.stop(),this.reset(),this.emitZone.setSize(r,n),this.emitZone.setPosition(i-r/2,s-n/2),this.emitter.setQuantity(e),this.emitter.setFrequency(a),this.emitter.start()}stop(){this.emitter?.killAll(),this.emitter?.stop()}reset(){this.createEmitters()}},E6=kb;var T6=E(X()),y6=E(vr()),Gb=E(he()),{KEY:IRe,FRAME:LRe}=T.DEFAULT_8_BIT,qb=class extends T6.Container{emitZone;emitter;constructor(e){super(e),this.createEmitZone(),this.createEmitters(),this.scene.add.existing(this)}createEmitZone(){this.emitZone=new y6.Rectangle}createEmitters(){let e=1/I.getPixelRatio();this.emitter=this.scene.make.particles({key:IRe,config:{frame:LRe.UNIT_REWARD_ELLIPSE_FX,emitZone:{source:this.emitZone,type:"random"},deathZone:{source:this.emitZone,type:"onLeave"},timeScale:1,frequency:150,speedY:{min:-20,max:-60},alpha:{start:1,end:0,ease:Gb.Cubic.Out},scale:{start:e*1,end:0,ease:Gb.Cubic.Out},lifespan:{min:1500,max:2500}}})}run(e,i,s,r,n){this.stop(),this.emitZone.setSize(r,n),this.emitZone.setPosition(i-r/2,s-n/2),this.emitter.setQuantity(e),this.emitter.start()}stop(){this.emitter?.killAll(),this.emitter?.stop()}},b6=qb;var A6=E(X());var x6=E(ve()),{Utils:{Signal:MRe}}=Ludex,{KEY:Wb,FRAME:Yb}=T.DEFAULT_8_BIT,Hb=class extends A6.Container{giftAdIcon;particleTweens=[];bubbleTwinkleUp;iconAttentionAnimController=new MRe.SignalController;constructor(e){super(e),this.createGlow(),this.createFx(),this.createCurrencyIcon(),this.updateSize(),this.createEllipses(),this.createParticles(),this.scene.add.existing(this)}createGlow(){let e=this.scene.make.image({key:Wb,frame:Yb.UNIT_REWARD_GLOW});e.setWorldSize(372.5,372.5),this.add(e)}createFx(){let e=this.scene.make.image({key:Wb,frame:Yb.UNIT_REWARD_FX});e.setWorldSize(375,234.5),this.add(e)}createCurrencyIcon(){this.giftAdIcon=this.scene.add.image(0,0,Wb,Yb.UNIT_REWARD_GIFT_AD),this.giftAdIcon.setWorldSize(168.5,168),this.giftAdIcon.setY(0),this.add(this.giftAdIcon)}updateSize(){let{displayWidth:e,displayHeight:i}=this.giftAdIcon;this.setSize(e,i)}createEllipses(){this.bubbleTwinkleUp=new b6(this.scene),this.bubbleTwinkleUp.setScale(1.5),this.add(this.bubbleTwinkleUp)}createParticles(){for(let e=0;e<4;e++){let i=new E6(this.scene);this.add(i),this.particleTweens.push(i)}}runLogoAttentionAnimation(e){let i=this.iconAttentionAnimController.renew();H.runTween(this.scene.tweens.add({...xd,paused:!0,targets:[this.giftAdIcon],delay:e,props:{scale:"+=0.05"}}),i);let{x:s,y:r,width:n,height:a}=this.giftAdIcon;this.bubbleTwinkleUp.run(1,s,r,n,a);for(let o of this.particleTweens){let h=(0,x6.Between)(1e3,2e3);o.run(1,0,0,n,a,h)}}stopAnimation(){for(let e of this.particleTweens)e.stop();this.iconAttentionAnimController.abort()}},C6=Hb;var zb=E(ie()),{KEY:w6,FRAME:R6}=T.DEFAULT_8_BIT,{language:ORe}=codex,Vb=class extends fe{constructor(e){super(e,w6,R6.BUTTON_GREEN_LONG,200,64),this.setName("ViewAd"),this.createIcon(),this.createViewText()}createIcon(){let e=this.scene.add.image(0,0,w6,R6.ICON_AD);e.setWorldSize(43.5,45.5),zb.Align.In.Center(e,this,-60,-5),this.add(e)}createViewText(){let e=P.buildText(ORe.getText("GET_NOW"),22).setDefaultStroke().setDefaultShadow({offsetX:-1.5,offsetY:1.5}).build(this.scene);zb.Align.In.Center(e,this,25,-5),this.add(e)}},P6=Vb;var un=E(ie()),_6=E(nt()),Zb=E(ve()),{KEY:Xb,FRAME:Kb}=T.DEFAULT_8_BIT,{Utils:{Valid:DRe,Signal:oa}}=Ludex,{language:BRe}=codex,jb=class extends De{rewardValue;hand;viewAdButton;skipButton;giftIcon;giftIconWhite;currencyText;giftAdComponent;popupContents;cometTwinkle;starTwinkleUp;sparksExplosive;contentFadeOutAnimController=new oa.SignalController;backgroundFadeInAnimController=new oa.SignalController;contentShowUpAnimController=new oa.SignalController;giftEntrancesAnimController=new oa.SignalController;giftAttentionAnimController=new oa.SignalController;giftShakeAnimController=new oa.SignalController;giftOpenAnimController=new oa.SignalController;adsTimer;constructor(e,i){super(e,i),this.setDepth(At.POPUP),this.background.setAlpha(0),this.createViewAdsButton(),this.createSkipButton(),this.createGiftAdIcon(),this.createCurrencyText(),this.createEffects(),this.createGiftIcon(),this.createHand(),this.createContentsGroup()}open=e=>{super.open(e),this.background.setAlpha(0),W.getGlobalScene()?.requestBackgroundMaskUpdate(O.UNIT_REWARD_SCREEN,this.background.alpha),this.setRewardValue(e?.unitType??"MELEE"),this.runOpenAnimation(),this.handleShowRewardedVideoAd()};handleClosePopup=()=>{this.runCloseAnimation()};handleShowRewardedVideoAd=async()=>{this.viewAdButton.setDisabled(!0),await ae.showRewardVideoAdAsync()&&(this.background.setAlpha(.8),W.getGlobalScene()?.requestBackgroundMaskUpdate(O.UNIT_REWARD_SCREEN,this.background.alpha),this.starTwinkleUp.stop(),q.playSound(J.DAILY_REWARD),this.popupContents.killGroup(),this.runTheGiftEntrancesAnimation(0,1500)),k.closeScreen(O.NOTIFY_SCREEN)};setTheGiftClickable(e){e?this.giftIcon.setInteractive():this.giftIcon.disableInteractive()}handleTheGiftClick=()=>{this.setTheGiftClickable(!1),this.logButtonEvent("OpenGift"),this.hand.stopAnimation(),this.hand.kill(),this.giftIconWhite.revive(),this.scene.tweens.killTweensOf(this.giftIcon),un.Align.In.Center(this.giftIconWhite,this.giftIcon),q.playSound(J.GIFT_CHARGE),Wt.vibrate(50),this.runShakeTheGift(),this.runOpenTheGift()};logButtonEvent(e){se.trackButtonClick(e)}runOpenAnimation(){this.revive(),this.hand.stopAnimation(),this.hand.kill(),this.popupContents.reviveGroup(),this.starTwinkleUp.stop(),this.runPopupContentEntrancesAnimation(100,400),this.runLogoAttentionAnimation(500)}runCloseAnimation=()=>{this.runExitsAnimation(0,200)};runBackgroundEntrancesAnimation(e,i){let s=this.backgroundFadeInAnimController.renew();H.runTween(this.scene.tweens.add({...$r,paused:!0,targets:this.background,delay:e,duration:i,props:{alpha:{start:0,to:.8}},onUpdate:(r,n)=>{W.getGlobalScene()?.requestBackgroundMaskUpdate(O.UNIT_REWARD_SCREEN,n.alpha)}}),s)}runPopupContentEntrancesAnimation(e,i){let s=this.contentShowUpAnimController.renew();H.runTween(this.scene.tweens.add({...pi,targets:this.popupContents.getChildren(),duration:i,delay:this.scene.tweens.stagger(100,{start:e}),props:{scale:{getStart:r=>r.scale-.3,getEnd:r=>r.scale},alpha:{start:0,from:0,to:1}}}),s)}runLogoAttentionAnimation(e){let{x:i,y:s,width:r,height:n}=this.giftAdComponent;this.starTwinkleUp.run(1,i,s,r,n),this.giftAdComponent.runLogoAttentionAnimation(e)}runTheGiftEntrancesAnimation(e,i){this.giftIcon.revive(),this.giftIcon.setAlpha(1),un.Align.In.TopRight(this.giftIcon,this.zone);let s=this.giftEntrancesAnimController.renew(),{x:r,y:n}=this.giftIcon,{x:a,y:o}=this.currencyText,h={x:r,y:n},l={x:a,y:o},c=1/I.getPixelRatio();H.runTween(fo(this.scene,{targets:this.giftIcon,delay:e,duration:i,curve:[[h.x,h.y],[h.x-80,h.y+80],[l.x,l.y]],onCurveUpdate:d=>{let p=d.x+Zb.RND.between(-40,40),m=d.y+Zb.RND.between(-40,40);this.cometTwinkle.explode(1,p,m)}}),s),H.runTween(this.scene.tweens.add({targets:this.giftIcon,delay:e,duration:i,props:{scale:{start:c*.5,to:c},angle:{start:20,to:0}},onComplete:()=>{q.playSound(J.GIFT_REVEAL);let d=1.5;this.starTwinkleUp.setScale(d);let{x:f,y:p,width:m,height:v}=this.giftIcon;this.starTwinkleUp.run(1,f,p,m/d,v/d),this.moveTo(this.starTwinkleUp,this.length-1),this.runTheGiftAttentionAnimation()}}),s)}runTheGiftAttentionAnimation(){let e=this.giftAttentionAnimController.renew();this.hand.revive(),this.hand.playAnimation(),un.Align.In.Center(this.hand,this.giftIcon,20,20),this.setTheGiftClickable(!0),H.runTween(this.scene.tweens.add({...xd,paused:!0,targets:this.giftIcon,props:{scale:"+=0.05"}}),e)}runShakeTheGift(){let e=this.giftShakeAnimController.renew();H.runTween(new Ud(this.scene,{targets:[this.giftIcon,this.giftIconWhite],duration:22}).tween,e)}runOpenTheGift(){let e=this.giftOpenAnimController.renew(),i=1/I.getPixelRatio();H.runTween(this.scene.tweens.add({...Vc,targets:[this.giftIcon,this.giftIconWhite],duration:1500,props:{alpha:0,scale:i},onUpdate:()=>{this.giftIconWhite.setAlpha(1)},onComplete:()=>{this.giftShakeAnimController.abort(),this.giftIcon.kill(),this.giftIconWhite.kill(),this.sparksExplosive.explode(100,this.giftIcon.x,this.giftIcon.y,230),q.playSound(J.GIFT_EXPLODE),this.rewardUnit(),this.scene.time.delayedCall(500,this.runCloseAnimation)}}),e)}rewardUnit(){se.logEarnUnitAnalytics(this.rewardValue,this.getRewardedUnitLevel());let e=W.getCurrentScene();e instanceof oe&&e.spawnUnit(this.rewardValue,!0,this.getRewardedUnitLevel())}getRewardedUnitLevel(){let e=de.getLevelProgress(),i=DRe.isNumber(e)?e+1:1,{BUYING_UNIT_LEVEL:s}=L,r=1;return s.forEach((n,a)=>{n<=i&&(r=a+1)}),r}runExitsAnimation(e,i){let s=this.contentFadeOutAnimController.renew();H.runTween(this.scene.tweens.add({...Mc,paused:!0,targets:this.popupContents.getChildren(),delay:e,duration:i,props:{alpha:{start:.8,to:0}},onComplete:()=>{W.getGlobalScene()?.requestBackgroundMaskUpdate(O.UNIT_REWARD_SCREEN,0),k.closeScreen(this.name),this.viewAdButton.setDisabled(!1),this.skipButton.setDisabled(!1)}}),s)}createHand(){this.hand=new zc(this.scene),this.add(this.hand)}createContentsGroup(){this.popupContents=this.scene.make.group({}),this.popupContents.addMultiple([this.giftAdComponent,this.currencyText])}createCurrencyText(){this.currencyText=P.buildText("WATCH_A_VIDEO",22).setAlign("center").build(this.scene),this.setRewardValue("MELEE"),this.add(this.currencyText)}setRewardValue(e){this.rewardValue=e,this.currencyText.setText(BRe.getText("WATCH_A_VIDEO")),un.Align.In.BottomCenter(this.currencyText,this.giftAdComponent,0,20)}createViewAdsButton(){this.viewAdButton=new P6(this.scene),this.viewAdButton.onClick=this.handleShowRewardedVideoAd,un.Align.In.Center(this.viewAdButton,this.zone,0,100),this.viewAdButton.kill()}createSkipButton(){this.skipButton=new Nd(this.scene,{key:Xb,frame:Kb.UNIT_REWARD_NO_THANKS_TEXT,width:123.5,height:18.5,paddingZone:50}),this.skipButton.setName("NoThanks"),this.skipButton.onClick=this.handleClosePopup,un.Align.In.BottomCenter(this.skipButton,this.viewAdButton,0,80),this.skipButton.kill()}createGiftAdIcon(){this.giftAdComponent=new C6(this.scene),un.Align.In.Center(this.giftAdComponent,this.zone,0,-80),this.add(this.giftAdComponent)}createGiftIcon(){this.giftIconWhite=this.scene.make.image({key:Xb,frame:Kb.UNIT_REWARD_GIFT_GLOW,visible:!1}),this.giftIconWhite.setWorldSize(168.5,168),this.giftIconWhite.setDepth(B.PRIORITY),this.add(this.giftIconWhite),this.giftIcon=this.scene.make.image({key:Xb,frame:Kb.UNIT_REWARD_GIFT,visible:!1}),this.giftIcon.setInteractive({useHandCursor:!0}),this.giftIcon.setWorldSize(168.5,168),this.giftIcon.on(_6.GAMEOBJECT_POINTER_DOWN,this.handleTheGiftClick),this.setTheGiftClickable(!1),this.add(this.giftIcon)}createEffects(){this.cometTwinkle=new xc(this.scene),this.starTwinkleUp=new v6(this.scene),this.sparksExplosive=new Cc(this.scene),this.add([this.cometTwinkle,this.starTwinkleUp,this.sparksExplosive])}},I6=jb;var L6=E(X()),M6=E(vr()),$b=E(he()),{KEY:URe,FRAME:NRe}=T.EFFECTS,Jb=class extends L6.Container{emitZone;emitter;constructor(e){super(e),this.createEmitZone(),this.scene.add.existing(this)}createEmitZone(){this.emitZone=new M6.Rectangle}createEmitters(){this.emitter=this.scene.add.particles(0,0,URe,{frame:NRe.FX_STAR_YELLOW,emitZone:{source:this.emitZone,type:"random"},timeScale:1,frequency:100,alpha:{start:1,end:0,ease:$b.Expo.Out},scale:{start:1,end:0,ease:$b.Expo.Out},lifespan:{min:800,max:1500}}),this.emitter.stop()}run(e,i,s,r,n,a=100){this.stop(),this.reset(),this.emitZone.setSize(r,n),this.emitZone.setPosition(i-r/2,s-n/2),this.emitter.setQuantity(e),this.emitter.setFrequency(a),this.emitter.start()}stop(){this.emitter?.killAll(),this.emitter?.stop()}reset(){this.createEmitters()}},O6=Jb;var j6=E(X()),e0=E(Io()),ha=E(ie()),Fd=E(ve()),{KEY:Qb}=T.UNITS,{KEY:cn,FRAME:dn}=T.DEFAULT_8_BIT,{language:FRe}=codex,{Utils:{Number:Z6,Signal:kRe}}=Ludex,t0=class extends j6.Container{glow;backEffect;bg;ribbon;healthContainer;healthText;atkContainer;atkText;unitName;unitFrame;particleTween=[];backEffectTween;onExitComplete;exitCurveAnimController=new kRe.SignalController;loading;payload;constructor(e){super(e),this.scene=e,this.setName("UnitCard"),this.createGlow(),this.createBackEffect(),this.createBg(),this.updateSize(),this.createRibbon(),this.createHealthContainer(),this.createAtkContainer(),this.createUnitName(),this.createUnitFrame(),this.createAnimation(),this.scene.add.existing(this)}createGlow(){let e=this.scene.make.image({key:cn,frame:dn.UNIT_UNLOCK_GLOW});e.setName("glow"),e.setWorldSize(340.5,349.5),this.add(e),this.glow=e}createBackEffect(){let e=new bd(this.scene,{color:234748,width:{min:4,max:8},radius:{min:180,max:170},lineNumber:18});e.setName("backEffect"),e.setPosition(0,0),this.add(e),this.backEffect=e}createBg(){let e=this.scene.make.image({key:cn,frame:dn.UNIT_UNLOCK_FRAME});e.setName("frame"),e.setWorldSize(207.5,292),this.add(e),this.bg=e}createRibbon(){let e=this.scene.make.image({key:cn,frame:dn.UNIT_UNLOCK_BG});e.setName("ribbon"),e.setWorldSize(204,34.5),this.add(e),ha.Align.In.TopCenter(e,this,-1,-4),this.ribbon=e}updateSize(){let{width:e,height:i}=this.bg;this.setSize(e,i)}createHealthContainer(){this.healthContainer=this.scene.make.container({}),this.healthContainer.setName("healthContainer");let e=this.scene.make.image({key:cn,frame:dn.UNIT_UNLOCK_BG_1});e.setName("health-bg"),e.setWorldSize(79.5,25),this.healthContainer.setSize(e.width,e.height);let i=this.scene.make.image({key:cn,frame:dn.UNIT_UNLOCK_ICON_HEART});i.setName("health-icon"),i.setWorldSize(21.5,19),ha.Align.In.LeftCenter(i,e,-10);let s=P.buildText("0",22).setDefaultStroke().setFixedWidth(13*22).setAlign("center").setHighQuality().build(this.scene);s.setPosition(15,0),this.healthText=s,this.healthContainer.add([e,i,s]),this.add(this.healthContainer),ha.Align.In.TopLeft(this.healthContainer,this,-15,-8)}createAtkContainer(){this.atkContainer=this.scene.make.container({}),this.atkContainer.setName("atkContainer");let e=this.scene.make.image({key:cn,frame:dn.UNIT_UNLOCK_BG_1});e.setName("atk-bg"),e.setWorldSize(79.5,25),this.atkContainer.setSize(e.width,e.height);let i=this.scene.make.image({key:cn,frame:dn.UNIT_UNLOCK_ICON_BATTLE});i.setName("atk-icon"),i.setWorldSize(20.5,18),ha.Align.In.LeftCenter(i,e,-10);let s=P.buildText("0",22).setDefaultStroke().setFixedWidth(13*22).setAlign("center").setHighQuality().build(this.scene);s.setPosition(15,0),this.atkText=s,this.atkContainer.add([e,i,s]),this.add(this.atkContainer),ha.Align.In.TopRight(this.atkContainer,this.ribbon,-15,-4)}createUnitName(){let e=P.buildText("Abcdefghjklmnopx",22).setFixedWidth(286).setAlign("center").setHighQuality().build(this.scene);this.unitName=e,this.add(e),ha.Align.In.BottomCenter(e,this,0,-21)}createUnitFrame(){this.loading=new Hs(this.scene),this.loading.setY(-10),this.add(this.loading);let e=this.scene.make.image({key:cn,frame:dn.BLANK});e.setName("unitFrame"),e.setWorldSize(200,200),e.setY(-9),this.add(e),e.kill(),this.unitFrame=e}createAnimation(){for(let e=0;e<4;e++){let i=new O6(this.scene);this.add(i),this.particleTween.push(i)}this.backEffectTween=this.scene.add.tween({paused:!0,targets:this.backEffect,duration:1e6,ease:Fd.Linear,repeat:-1,props:{rotation:{start:0,to:180}}})}runAnimation(){this.glow.revive(),this.backEffect.revive();let{width:e,height:i}=this;this.particleTween.forEach(s=>{let r=(0,Fd.Between)(1e3,2e3);s.run(1,0,0,e/2,i/2.5,r)}),this.backEffectTween.resume()}stopAnimation(){this.particleTween.forEach(e=>{e.stop()}),this.backEffectTween.pause()}runExitAnimation(){this.glow.kill(),this.backEffect.kill()}updateInfo(e){this.payload=e;let{name:i,health:s,atk:r,frame:n}=e;switch(this.unitFrame.kill(),this.loading.revive(),this.unitName.setText(i.toUpperCase()),FRe.getCurrentLocale()){case"ja":this.unitName.text.length>8&&this.unitName.setScale(8/this.unitName.text.length);break;default:this.unitName.text.length>15&&this.unitName.setScale(15/this.unitName.text.length);break}let o=Z6.toAbbreviatedString(s);this.healthText.setText(o);let h=Z6.toAbbreviatedString(r);this.atkText.setText(h),this.scene.textures.get(Qb).has(n)?this.setUnitFrame():this.scene.textures.on(e0.ADD,this.handleWaitAddTexture),this.unitFrame.setFrame(n)}handleWaitAddTexture=e=>{e===Qb&&(this.scene.textures.off(e0.ADD,this.handleWaitAddTexture),!(!this.visible&&!this.active)&&this.setUnitFrame())};setUnitFrame(){let{frame:e}=this.payload;this.unitFrame.revive(),this.loading.kill(),this.unitFrame.setTexture(Qb,e),this.unitFrame.setWorldSize(200,200)}},$6=t0;var kd=E(ie());var js=E(ie()),i0=class t{static _instance;static get inst(){return this._instance||(this._instance=new t),this._instance}static alignChildTopLeft(e,i,s=0,r=0){let n=i.x,a=i.y;js.Align.In.TopLeft(e,i,s+n,r+a)}static alignChildTopRight(e,i,s=0,r=0){let n=i.x,a=i.y;js.Align.In.TopRight(e,i,s+n,r+a)}static alignChildBottomLeft(e,i,s=0,r=0){let n=i.x,a=i.y;js.Align.In.BottomLeft(e,i,s-n,r-a)}static alignChildBottomRight(e,i,s=0,r=0){let n=i.x,a=i.y;js.Align.In.BottomRight(e,i,s-n,r-a)}static alignChildCenter(e,i,s=0,r=0){let n=i.x,a=i.y;js.Align.In.Center(e,i,s-n,r-a)}static alignChildLeftCenter(e,i,s=0,r=0){let n=i.x,a=i.y;js.Align.In.LeftCenter(e,i,s-n,r-a)}static alignChildRightCenter(e,i,s=0,r=0){let n=i.x,a=i.y;js.Align.In.RightCenter(e,i,s-n,r-a)}static alignChildTopCenter(e,i,s=0,r=0){let n=i.x,a=i.y;js.Align.In.TopCenter(e,i,s+n,r+a)}static alignChildBottomCenter(e,i,s=0,r=0){let n=i.x,a=i.y;js.Align.In.BottomCenter(e,i,s-n,r-a)}static alignChildrenContainer(e,i){let{width:s,height:r,x:n,y:a}=i,o=s!==void 0,h=r!==void 0;if(o){let l=n-s/2,c=s/(e.length+1);e.forEach((d,f)=>{d.setPosition(l+(f+1)*c,a)})}else if(h){let l=a-r/2,c=r/(e.length+1);e.forEach((d,f)=>{d.setPosition(n,l+(f+1)*c)})}}},wl=i0;var Lo=E(he()),{FRAME:J6}=T.UNITS,{KEY:GRe,FRAME:qRe}=T.DEFAULT_8_BIT,{language:Xe}=codex,{Utils:{Signal:WRe}}=Ludex,s0=class extends De{frameBg;popup;title;unitCard;closeBtn;isShowingAdBanner;showPopupAnimController=new WRe.SignalController;constructor(e,i){super(e,i),this.background.setAlpha(.7),this.setDepth(At.POPUP),this.createPopup(),this.createUnitCard(),this.createPopupTitle()}createPopup(){this.popup=this.scene.make.container({}),this.add(this.popup),this.popup.setName("popup");let e=307,i=386,s=new Ht(this.scene,{x:0,y:0,width:e,height:i,rightEdge:292019,topInnerCornerStrokeWidth:2,rightInnerCornerStrokeWidth:3,lightY:-80});s.setName("frame"),this.frameBg=s,this.popup.add(s),this.popup.setWorldSize(e,i),this.createCloseButton();let r=this.isShowingAdBanner?-50:0;kd.Align.In.Center(this.popup,this,0,r)}recalculateLightPosition(){this.frameBg&&this.frameBg.recalculateLightPosition()}createPopupTitle(){let e=this.scene.make.container({});e.setName("title");let i=this.scene.make.image({key:GRe,frame:qRe.RIBBON_GREEN});i.setWorldSize(239,65),e.add(i);let s=P.buildText(Xe.getText("NEW_CHARACTER").toUpperCase(),23).setFixedWidth(13*23).setAlign("center").setHighQuality().build(this.scene);s.setPosition(0,-5),e.add(s),kd.Align.In.TopCenter(e,this.popup,0,-28),this.add(e),this.title=e}createUnitCard(){this.unitCard=new $6(this.scene),this.add(this.unitCard);let e=this.isShowingAdBanner?-25:25;this.unitCard.setPosition(0,e)}updateInfo(){let e=this.scene.scene.get(z.GAME_SCENE);if(!(e instanceof oe))return;let{unitManager:i}=e;if(!i)return;let{latestUnitMergePayload:s}=i,{level:r,type:n}=s,a=i.getUnitDataForUnlockingScreen(),o="";if(n===L.MELEE_UNIT_TYPE&&(o=J6.UNLOCKED.MELEE[r]),n===L.RANGED_UNIT_TYPE&&(o=J6.UNLOCKED.RANGED[r]),o==="")return;this.unitCard.updateInfo({frame:o,atk:a.damage,health:a.health,name:this.translateUnitName(a.name)});let h=this.isShowingAdBanner?-50:0;this.popup.setY(h),kd.Align.In.TopCenter(this.title,this.popup,0,-28);let l=this.isShowingAdBanner?-25:25;this.unitCard.setAngle(0),this.unitCard.setPosition(0,l)}translateUnitName(e){switch(e){case"Rockthrower":return Xe.getText("ROCKTHROWER");case"Javelineer":return Xe.getText("JAVELINEER");case"Boomeranger":return Xe.getText("BOOMERANGER");case"Macer":return Xe.getText("MACER");case"Artemis":return Xe.getText("ARTEMIS");case"William":return Xe.getText("WILLIAM");case"Blanchette":return Xe.getText("BLANCHETTE");case"Phantom":return Xe.getText("PHANTOM");case"Oracle":return Xe.getText("ORACLE");case"Shaman":return Xe.getText("SHAMAN");case"Seraph":return Xe.getText("SERAPH");case"Velociraptor":return Xe.getText("VELOCIRAPTOR");case"Saurolophus":return Xe.getText("SAUROLOPHUS");case"Pachysaurus":return Xe.getText("PACHYSAURUS");case"Triceratops":return Xe.getText("TRICERATOPS");case"Stegosaurus":return Xe.getText("STEGOSAURUS");case"Ankylosaurus":return Xe.getText("ANKYLOSAURUS");case"Baroptiloraptor":return Xe.getText("BAROPTILORAPTOR");case"Tyrannosaurus":return Xe.getText("TYRANNOSAURUS");case"Dilophosaurus":return Xe.getText("DILOPHOSAURUS");case"Triceradonosaurus":return Xe.getText("TRICERADONOSAURUS");case"Spinosaurus Rex":return Xe.getText("SPINOSAURUS_REX");default:return e}}createCloseButton(){let e=new Yt(this.scene);e.setName("Close"),this.popup.add(e),wl.alignChildTopRight(e,this.popup,10,0),e.onClick=this.handleCloseScreen,this.closeBtn=e}open(){super.open(),W.getGlobalScene()?.requestBackgroundMaskUpdate(O.UNIT_UNLOCK_SCREEN,this.background.alpha);let i=this.scene.scene.get(z.GAME_SCENE);i instanceof oe&&k.listenResizeEventForCalculateLight(this),this.isShowingAdBanner=i?i.isBannerAdShowed:!0,this.playShowPopupAnimation(),this.updateInfo(),this.popup.revive(),this.title.revive(),this.background.revive(),this.unitCard.runAnimation()}close(){this.setBlockInputOutsideEnabled(!1),this.visible&&(this.popup.kill(),this.title.kill(),this.background.kill(),this.unitCard.onExitComplete=()=>{let e=this.scene.game.scene.getScene(z.GAME_SCENE);e instanceof oe&&(k.removeResizeEventForCalculateLight(this),e.uiManager.runUnitBtnAnim(),e.unitManager.enableDragOnPlayerUnits()),q.playSound(J.COIN_SPAWN_SOUND),super.close()},this.unitCard.runExitAnimation(),this.scene.scene.resume(z.GAME_SCENE))}handleCloseScreen=()=>{this.unitCard.stopAnimation(),W.getGlobalScene()?.requestBackgroundMaskUpdate(O.UNIT_UNLOCK_SCREEN,0),k.closeScreen(this.name)};playShowPopupAnimation(){let e=this.showPopupAnimController.renew();H.runTween(this.scene.tweens.add({...He,paused:!0,props:{alpha:{start:0,to:1,duration:500,ease:Lo.Cubic.Out},scale:{start:.8,to:1,duration:1e3,ease:Lo.Elastic.Out,easeParams:[.1,.45]},y:{getStart:i=>i.y,getEnd:i=>i.y,duration:500,ease:Lo.Back.Out}},targets:[this.popup,this.title,this.unitCard,this.closeBtn]}),e)}},Q6=s0;var e9=E(X()),Gd=E(qe()),fn=E(nt()),r0=class extends e9.Container{config;isEnable;maxHeight;isScrolling;boundTop;boundBottom;maskGraphics;objects;_value=0;velocity=0;isScrollingSmooth;lastScrollY;isScrollingBack;scrollingBackTo;lastScrollYCount=0;hitArea;onScrollEvents=[];get marginTop(){return this.config.marginTop}get marginBottom(){return this.config.marginBottom}get acceleration(){return this.config.acceleration}get maxScrollOver(){return this.config.maxScrollOver}get scrollSmooth(){return this.config.scrollSmooth}get scrollingBackRate(){return this.config.scrollingBackRate}constructor(e,i){super(e),this.config={marginTop:0,marginBottom:0,acceleration:1400,maxScrollOver:.15,scrollSmooth:40,scrollingBackRate:5,...i};let{width:s,height:r}=i;this.isEnable=!1,this.maxHeight=0,this.lastScrollY=new Array(3).fill(0),this.setSize(s,r),this.createGroup(),this.createInput(),this.createEvents(),this.scene.add.existing(this)}onScroll(e){this.onScrollEvents.push(e)}get value(){return this._value}set value(e){let i=e-this._value;this._value=e,this.updateObject(i)}gotoTop(){this.value=this.config.marginTop}reset(){this.maxHeight=0,this.isScrolling=!1,this.isScrollingBack=!1,this.isScrollingSmooth=!1,this.gotoTop(),this.setEnable(!1)}createDebug(){let e=this.drawDebugBox(16711680,.8);console.log(e?.x,e?.y,e?.displayWidth,e?.displayHeight)}setEnable(e){this.isEnable=e,e?this.setInteractive({draggable:!0,useHandCursor:!0}):this.disableInteractive()}addItem(e){this.addAt(e),this.objects.add(e);let{y:i,height:s}=e,r=i+s+this.marginBottom-this.height/2;this.maxHeight=Math.max(this.maxHeight,r,0),this.updateObjectVisible()}addItems(e){this.addAt(e),this.objects.addMultiple(e);let i=e.map(s=>s.y+s.height+this.marginBottom-this.height/2);this.maxHeight=Math.max(this.maxHeight,Math.max(...i),0),this.updateObjectVisible()}clearItem(){this.objects.clear(!0,!0),this.reset()}getChildren(){return this.objects.getChildren().filter(e=>e.active)}createBound(e,i,s,r){this.boundTop=this.scene.make.image({key:e,frame:i}),this.boundBottom=this.scene.make.image({key:e,frame:i}),this.boundTop.setTint(r),this.boundBottom.setTint(r),this.boundTop.setAlpha(1,1,0,0),this.boundBottom.setAlpha(0,0,1,1),this.boundTop.setDepth(B.PRIORITY),this.boundBottom.setDepth(B.PRIORITY);let n=this.width,a=s,{x:o,y:h}=this.getWorldPosition();this.boundTop.setDisplaySize(n,a),this.boundBottom.setDisplaySize(n,a),this.boundTop.setY(-this.displayHeight/2+a/2+h-this.y-1),this.boundBottom.setY(this.displayHeight/2-a/2+h-this.y+1),this.boundTop.setX(o-this.x),this.boundBottom.setX(o-this.x),this.add([this.boundTop,this.boundBottom])}createMask(){this.maskGraphics?.destroy(),this.maskGraphics=this.scene.make.graphics({fillStyle:{color:255,alpha:1}}),this.maskGraphics.setName("MaskGraphics");let e=this.width,i=this.height;this.maskGraphics.fillRoundedRect(0-e/2,0-i/2,e,i,0),this.setMask(this.maskGraphics.createGeometryMask()),this.scene.events.off(Gd.UPDATE,this.updateMask,this),this.scene.events.on(Gd.UPDATE,this.updateMask,this)}updateMask(){let{x:e,y:i}=this.getWorldPosition();this.maskGraphics.setPosition(e,i)}createGroup(){this.objects=this.scene.make.group({})}updateObject(e){this.objects.incY(e),this.updateObjectVisible()}updateObjectVisible(){let e=this.objects.getChildren();for(let i=0;i<e.length;i++){let s=e[i];s.y+s.height<-this.height/2||s.y-s.height>this.height/2?s.setVisible(!1):s.setVisible(!0)}}createInput(){this.setInteractive({draggable:!0,useHandCursor:!0}),this.on(fn.POINTER_WHEEL,this.onMouseScroll),this.on(fn.GAMEOBJECT_DRAG,this.onTouchScroll),this.on(fn.GAMEOBJECT_POINTER_DOWN,this.onTouchDown),this.scene.input.on(fn.POINTER_UP,this.onTouchEnd,this)}createEvents(){this.scene.events.on(Gd.UPDATE,this.update)}update=(e,i)=>{this.isScrollingSmooth&&this.velocity&&this.scrollingSmooth(i),this.isScrollingBack&&this.scrollingBack(i)};callOnScrollEvents(e,i){for(let s of this.onScrollEvents)s(this,e,i)}scrollingBack(e){let i=(this.scrollingBackTo-this.value)*e*this.scrollingBackRate/1e3;this.value+=i,Math.abs(this.scrollingBackTo-this.value)<.5&&(this.value=this.scrollingBackTo,this.stopScrollingBack()),this.callOnScrollEvents(this.value,i)}startScrollingBack(e){this.isScrollingBack=!0,this.scrollingBackTo=e}stopScrollingBack(){this.isScrollingBack=!1}scrollingSmooth(e){let i=this.velocity*e/1e3;this.value+=i;let s=Math.abs(this.velocity)/this.velocity;this.velocity-=s*this.acceleration*e/1e3,Math.abs(this.velocity)<this.acceleration*e/1e3&&this.stopScrollSmooth(),this.isReachTop()&&(this.startScrollingBack(this.marginTop),this.stopScrollSmooth()),this.isReachBottom()&&(this.startScrollingBack(-this.maxHeight),this.stopScrollSmooth()),this.callOnScrollEvents(this.value,i)}startScrollSmooth(e){this.isScrollingSmooth=!0,e&&(e*this.velocity>0?this.velocity+=e:this.velocity=e)}stopScrollSmooth(){this.isScrollingSmooth=!1,this.isScrolling=!1,this.velocity=0}isReachTop(){return this.value>this.marginTop}isReachBottom(){return-this.value>this.maxHeight}checkReachBound=()=>this.isReachTop()||this.isReachBottom();onMouseScroll=rd((e,i,s)=>{if(!this.isEnable)return;if(this.isScrolling=!0,this.checkReachBound()){this.lastScrollY=this.lastScrollY.map(()=>0),this.isScrolling=!1;return}this.stopScrollingBack(),this.startScrollSmooth(-s*this.scrollSmooth/15)},100,{isImmediate:!0,maxWait:100});onTouchScroll=e=>{if(!this.isEnable)return;this.velocity&&this.stopScrollSmooth(),this.stopScrollingBack(),this.isScrolling=!0;let i=I.getZoomRatio(),{position:s,prevPosition:r}=e,n=(s.y-r.y)/i,a=this.height*this.maxScrollOver,o=1;if(this.lastScrollY[++this.lastScrollYCount%this.lastScrollY.length]=n,this.isReachTop()&&n>=0){let c=(a-(this.value-this.marginTop))/a;o=Math.min(o,c)}if(this.isReachBottom()&&n<=0){let c=(a-(-this.maxHeight-this.value))/a;o=Math.min(o,c)}let h=n*o,l=this.maxScrollOver*this.height;this.value+h>this.marginTop+l?this.value=this.marginTop+l:this.value+h<-this.maxHeight-l?this.value=-this.maxHeight-l:this.value+=h,this.callOnScrollEvents(this.value,h)};onTouchDown=()=>{this.isEnable&&(this.velocity&&this.stopScrollSmooth(),this.stopScrollingBack())};onTouchEnd=()=>{if(this.isReachTop()&&(this.startScrollingBack(this.marginTop),this.stopScrollSmooth()),this.isReachBottom()&&(this.startScrollingBack(-this.maxHeight),this.stopScrollSmooth()),!this.isScrolling)return;let e=this.lastScrollY.reduce((i,s)=>i+s)/this.lastScrollY.length;this.startScrollSmooth(e*this.scrollSmooth),this.lastScrollY=this.lastScrollY.map(()=>0)}},t9=r0;var YRe=E(X());var la=class extends t9{classType;listConfigs;padding;startObjectIndex;endObjectIndex;listObjects;constructor(e,i){super(e,i),this.classType=i.classType,this.listConfigs=i.listConfigs,this.padding=i.padding?i.padding:0,this.objects.classType=this.classType,this.updateConfig(this.listConfigs)}reset(){super.reset(),this.killAndHideAll()}getChildren(){return this.listObjects.filter(e=>e?.active)}get objHeight(){let e=this.objects.getChildren();return e.length===0?(this.maxHeight=0,this.maxHeight):e[0].height}updateConfig(e){this.reset(),this.listConfigs=e,this.listObjects=new Array(e.length).fill(void 0),this.addObjectIndex(0,0);let i=this.getEndObjectIndex();this.addObjectIndex(1,i),this.startObjectIndex=this.getStartObjectIndex(),this.endObjectIndex=this.getEndObjectIndex(),this.updateMaxHeight(),this.value=this.marginTop}getConfig(){return this.listConfigs}killAndHideAll(){if(Array.isArray(this.listObjects))for(let e of this.listObjects)e!==void 0&&this.objects.killAndHide(e)}setItemPosition(e,i){let s=e.height;e.setPosition(0,s/2+(s+this.padding)*i-this.height/2)}updateMaxHeight(){return this.maxHeight=Math.max(this.listConfigs.length*(this.objHeight+this.padding)-this.padding+this.marginBottom-this.height,0),this.maxHeight}updateObject(e){this.objects.incY(e);let i=this.getStartObjectIndex(),s=this.getEndObjectIndex();i!==this.startObjectIndex&&(i>this.startObjectIndex?this.killObjectIndex(this.startObjectIndex,i-1):this.addObjectIndex(i,this.startObjectIndex-1),this.startObjectIndex=i),s!==this.endObjectIndex&&(s<this.endObjectIndex?this.killObjectIndex(s+1,this.endObjectIndex):this.addObjectIndex(this.endObjectIndex+1,s),this.endObjectIndex=s)}killObjectIndex(e,i){for(let s=e;s<=i;s++){let r=this.listObjects[s];r&&(this.objects.killAndHide(r),this.listObjects[s]=void 0)}}addObjectIndex(e,i){for(let s=e;s<=i;s++){let{padding:r,listConfigs:n}=this;if(s>=n.length)return;let a=this.objects.getFirstDead(!0),o=a.height,h=o/2+(o+r)*s+this.value-this.height/2;a.updateInfo(n[s]),a.setPosition(0,h),a.setActive(!0),a.setVisible(!0),this.addAt(a),this.listObjects[s]=a}}getStartObjectIndex(){let{objHeight:e,padding:i}=this;return Math.max(Math.floor((0-this.value)/(e+i)),0)}getEndObjectIndex(){let{objHeight:e,padding:i,listConfigs:s}=this,r=e+i;return Math.min(Math.floor((this.height-this.value)/r),s.length)}};var Mo=E(ie()),r9=E(X()),{KEY:i9,FRAME:Cr}=T.DEFAULT_8_BIT,{Utils:{Signal:s9}}=Ludex,n0=class extends r9.Container{avatar;rankIcon;rankText;username;score;scoreText;background;showPopUpAnimController=new s9.SignalController;showItemsAnimController=new s9.SignalController;payload;constructor(e,i){super(e),this.createBackground(),this.updateSize(),this.createRank(),this.createAvatar(),this.createUsername(),this.createScore(),i&&this.updateInfo(i),this.scene.add.existing(this)}updateInfo(e){this.payload={extraData:"",isHighlight:!1,...e},this.updateBackground(),this.updateAvatar(),this.updateRank(),this.updateUsername(),this.updateScore()}createBackground(){this.background=this.scene.make.image({key:i9,frame:Cr.LEADERBOARD_BG_DARK}),this.add(this.background),this.updateBackground()}updateBackground(){let{isHighlight:e=!1}=this.payload||{};e?(this.background.setFrame(Cr.LEADERBOARD_BG_LIGHT),this.background.setWorldSize(313.5,41)):(this.background.setFrame(Cr.LEADERBOARD_BG_DARK),this.background.setWorldSize(314.5,42))}updateSize(){let{width:e,height:i}=this.background;this.setSize(e,i)}createAvatar(){this.avatar=new $c(this.scene,{size:42,loadDelay:300}),this.add(this.avatar),Mo.Align.In.LeftCenter(this.avatar,this.rankIcon,-40)}updateAvatar(){let{playerId:e,photo:i}=this.payload;this.avatar.loadPhoto(e,i)}createRank(){this.createRankIcon(),this.createRankText()}updateRank(){let{rank:e=99}=this.payload||{};this.updateRankIcon(e),this.updateRankText(e)}getRankIconFrame(e){let i=null;switch(e){case 1:i=Cr.LEADERBOARD_RANK_GOLD;break;case 2:i=Cr.LEADERBOARD_RANK_SILVER;break;case 3:i=Cr.LEADERBOARD_RANK_COPPER;break}return i}createRankIcon(){this.rankIcon=this.scene.make.image({key:i9}),this.updateRankIcon(1),this.kill(),this.add(this.rankIcon),Mo.Align.In.LeftCenter(this.rankIcon,this)}updateRankIcon(e){let i=this.getRankIconFrame(e);if(!i){this.rankIcon.kill();return}this.rankIcon.revive(),this.rankIcon.setFrame(i),i===Cr.LEADERBOARD_RANK_GOLD&&this.rankIcon.setWorldSize(39,34.5),i===Cr.LEADERBOARD_RANK_SILVER&&this.rankIcon.setWorldSize(32.5,32),i===Cr.LEADERBOARD_RANK_COPPER&&this.rankIcon.setWorldSize(27,35.5)}createRankText(){this.rankText=P.buildText("0",16).setDefaultStroke().setHighQuality().build(this.scene),this.rankText.kill(),this.add(this.rankText),Mo.Align.In.Center(this.rankText,this.rankIcon,0,-1)}updateRankText(e){this.rankText.kill(),e>3&&this.rankText.revive(),this.rankText?.setText(`${e}`)}getShortName(e){let i=e.substring(0,7);return i.split(" ")[0]||i}createUsername(){this.username=P.buildText("Player",16).setFontStyle("bold").setHighQuality().build(this.scene),Mo.Align.In.LeftCenter(this.username,this.avatar,-53),this.add(this.username)}updateUsername(){let e=this.payload.name;this.username.setText(this.getShortName(e))}createScore(){this.score=this.scene.add.container(),this.scoreText=P.buildText("99999",16).setOrigin({x:1,y:.5}).setDefaultStroke().setHighQuality().build(this.scene),this.score.add(this.scoreText),this.add(this.score),Mo.Align.In.RightCenter(this.score,this,-10)}updateScore(){let{score:e="0"}=this.payload||{};this.scoreText.setText(`${e}`)}handleChallengeFriend=async()=>{};updateBattleProfiles(){}runShowPopUpAnimation(e,i){let s=this.showPopUpAnimController.renew();this.scene.tweens.killTweensOf(this),H.runTween(this.scene.tweens.add({...He,paused:!0,targets:this,delay:e,duration:i,props:{...He.props,y:{...He.props.y,start:this.y+70,to:this.y}}}),s)}runShowItemAnimation(e,i){let s=this.getAll(),r=this.showItemsAnimController.renew();this.scene.tweens.killTweensOf(s);let n=s.map(o=>o.scale),a=()=>{for(let o=0;o<s.length;o++){let h=s[o],l=n[o];h.setScale(l)}};r.once(a),H.runTween(this.scene.tweens.add({...ho,paused:!0,targets:s,duration:i,delay:this.scene.tweens.stagger(50,{start:e+50}),props:{...ho.props,scale:{...ho.props.scale,value:void 0,getStart:o=>o.scale*.8,getEnd:o=>o.scale}}}),r)}runShowUpAnimation(e=0,i=300){let s=e*100;this.runShowPopUpAnimation(s,i),this.runShowItemAnimation(s,i)}},n9=n0;var a9=E(X());var{Limit:HRe}=le.Leaderboards,{player:zRe,language:VRe}=codex,a0=class extends a9.Container{currentPlayerId;isUpdating;scroller;constructor(e){super(e),this.scene=e,this.currentPlayerId=zRe.getPlayerId(),this.isUpdating=!1,this.createReuseScroller(),this.scene.add.existing(this)}createReuseScroller(){this.scroller=new la(this.scene,{classType:n9,listConfigs:[],width:320,height:290,padding:10,marginTop:10,marginBottom:10}),this.scroller.createMask(),this.scroller.setPosition(0,0),this.add(this.scroller)}updateData(e){if(this.isUpdating)return;this.isUpdating=!0;let i=Object.values(e)||[];if(i.length<1){this.showLeaderboardIsEmpty();return}let s=i.sort((a,o)=>+o.score-+a.score),r=[],n=1;for(let a of s){if(r.length>=HRe)break;let{playerId:o,photo:h,score:l,name:c}=a;if(!o||!c)continue;let d=this.currentPlayerId===o,f={playerId:o,photo:h||U.AVATAR_DEFAULT.FILE,name:c,rank:n,score:l,isHighlight:d};r.push(f),n++}this.scroller.updateConfig(r),this.showLeaders()}removeLeaders(){this.scroller.updateConfig([])}getLeaders(){return this.scroller.getChildren()}showLeaders(){let e=this.getLeaders(),i=Math.min(e.length,6),s=300;for(let n=0;n<i;n++){let a=e[n];a&&(a.setVisible(!0),a.runShowUpAnimation(n,s))}let r=s+i*100+50*5;this.scene.time.delayedCall(r,()=>{let n=k.getScreen(O.LEADER_BOARD_SCREEN);this.isUpdating=!1,n.isSwitchable=!0,this.scroller.setEnable(!0)})}showLeaderboardIsEmpty(){let e=k.getScreen(O.LEADER_BOARD_SCREEN);this.isUpdating=!1,e.isSwitchable=!0,e.board.showMessage(!0,VRe.getText("LEADERBOARD_IS_EMPTY"))}},o9=a0;var h9=E(X());var Rl=E(ie()),{language:qd}=codex,o0=class extends h9.Container{constructor(e){super(e),this.createRankText(),this.createPhotoText(),this.createNameText(),this.createLevelText()}createRankText(){let e=P.buildText(qd.getText("RANK"),14).setOrigin({x:.2,y:.5}).build(this.scene);this.add(e),Rl.Align.In.Center(e,this,-138)}createPhotoText(){let e=P.buildText(qd.getText("PHOTO"),14).setOrigin({x:.2,y:.5}).build(this.scene);this.add(e),Rl.Align.In.Center(e,this,-94)}createNameText(){let e=P.buildText(qd.getText("NAME"),14).setOrigin({x:.2,y:.5}).build(this.scene);this.add(e),Rl.Align.In.Center(e,this,-45)}createLevelText(){let e=P.buildText(qd.getText("LEVEL"),14).setOrigin({x:.2,y:.5}).build(this.scene);this.add(e),Rl.Align.In.Center(e,this,135)}},l9=o0;var c9=E(X());var ji=E(ie()),{KEY:h0,FRAME:l0}=T.DEFAULT_8_BIT,{KEY:XRe,FRAME:KRe}=T.DEFAULT,{Utils:{Signal:ZRe}}=Ludex,{language:u9}=codex,u0=class extends c9.Container{background;titleText;titleRibbon;header;leaders;loading;message;challengeFriendsBtn;messageAnimController=new ZRe.SignalController;onClose;constructor(e){super(e),this.setName("Board"),this.createBackground(),this.createLoading(),this.createMessage(),this.createContents(),this.createCloseButton(),this.updateSize(),this.scene.add.existing(this)}updateSize(){let{width:e,height:i}=this.background;this.setSize(e,i)}showLoading(e){this.loading.setVisible(e),this.showMessage(!1)}showMessage(e,i){this.message.setVisible(e),i&&(this.message.setText(i),this.playMessageAnimation())}createBackground(){this.background=new Ht(this.scene,{x:0,y:0,width:332,height:404.5,topInnerCornerStrokeWidth:1,rightInnerCornerStrokeWidth:3,lightY:-80}),this.add(this.background),this.setSize(this.background.width,this.background.height)}recalculateLightPosition(){this.background&&this.background.recalculateLightPosition()}createLoading(){this.loading=new Hs(this.scene),this.loading.setTint(16777215),this.loading.setWorldSize(113,113),this.add(this.loading),ji.Align.In.Center(this.loading,this.background)}createMessage(){this.message=P.createText(this.scene,"",18),this.message.setTint(16777215),this.add(this.message),ji.Align.In.Center(this.message,this.background)}createContents(){this.createLeaders(),this.createTitle(),this.createHeader()}createLeaders(){this.leaders=new o9(this.scene),this.add(this.leaders),ji.Align.In.Center(this.leaders,this.background,0,30)}createTitle(){let e=this.scene.add.container();e.setName("title");let i=this.scene.make.image({key:XRe,frame:KRe.RIBBON_BLUE});i.setWorldSize(239,67);let s=P.createText(this.scene,u9.getText("LEADERBOARD"),22);ji.Align.In.Center(s,i,0,-10),e.add([i,s]),ji.Align.In.TopCenter(e,this.background,0,-25),this.add(e),this.titleText=s,this.titleRibbon=i}createHeader(){let e=this.scene.add.container(),i=this.scene.make.image({key:h0,frame:l0.LEADERBOARD_TAB_BG});i.setX(1),i.setWorldSize(329,29),this.header=new l9(this.scene),e.add([i,this.header]),this.add(e),ji.Align.In.TopCenter(this.header,e),ji.Align.In.Center(e,this.background,-1,-125)}createCloseButton(){let e=new Yt(this.scene);ji.Align.In.TopRight(e,this,10,10),this.add(e),e.onClick=this.handleOnCloseClick}createChallengeFriendsBtn(){this.challengeFriendsBtn=new fe(this.scene,h0,l0.BUTTON_GREEN,144,57),this.add(this.challengeFriendsBtn);let e=P.buildText(u9.getText("CHALLENGE_FRIENDS"),17).setAlign("center").setDefaultStroke().setPadding({left:10,right:10}).setDefaultShadow({offsetX:-10,offsetY:4}).setHighQuality().build(this.scene);this.challengeFriendsBtn.add(e),ji.Align.In.Center(e,this.challengeFriendsBtn,18,-3);let i=this.scene.make.image({key:h0,frame:l0.ICON_BATTLE});i.setOrigin(.5,.5),i.setWorldSize(34.5,31.5),this.challengeFriendsBtn.add(i),ji.Align.In.Center(i,this.challengeFriendsBtn,-45,-3),ji.Align.In.BottomCenter(this.challengeFriendsBtn,this.background,0,-15),this.challengeFriendsBtn.onClick=this.handleChallengeFriends}handleChallengeFriends=async()=>{};handleOnCloseClick=()=>{this.onClose&&this.onClose()};playMessageAnimation(){let e=this.messageAnimController.renew();H.runTween(new Ud(this.scene,{targets:this.message,duration:60,repeat:2}).tween,e)}},d9=u0;var c0=E(ie()),v9=E(he()),{Name:f9,Limit:p9}=le.Leaderboards,{Utils:{Signal:m9}}=Ludex,{language:jRe}=codex,$Re="friends",JRe="world",d0=class extends De{scene;board;tabId;offset;isSwitchable;showPopupAnimController=new m9.SignalController;fadeOutAnimController=new m9.SignalController;constructor(e,i){super(e,i),this.scene=e,this.background.setAlpha(.7),this.setDepth(At.POPUP),this.createBoard()}open(){super.open(),this.scene.scene.get(z.GAME_SCENE)instanceof oe&&k.listenResizeEventForCalculateLight(this),W.getGlobalScene()?.requestBackgroundMaskUpdate(O.LEADER_BOARD_SCREEN,this.background.alpha),this.runPopupAnimation(),this.isSwitchable=!1,this.selectWorldTab()}close(){super.close(),W.getGlobalScene()?.requestBackgroundMaskUpdate(O.LEADER_BOARD_SCREEN,0)}selectFriendTab(){this.tabId=$Re,this.offset=0,this.board.showLoading(!0),this.board.header.kill(),this.board.leaders.removeLeaders(),this.fetchLeaderboardData("friends")}selectWorldTab(){this.tabId=JRe,this.offset=0,this.board.showLoading(!0),this.board.header.kill(),this.board.leaders.removeLeaders(),this.fetchLeaderboardData("world")}createBoard(){this.board=new d9(this.scene),this.board.onClose=this.handleCloseClick,c0.Align.In.Center(this.board,this,0,-20),this.add(this.board);let e=jRe.getCurrentLocale(),i=22;switch(e){case"es":i=19;break}this.board.titleText.setFontSize(i),c0.Align.In.Center(this.board.titleText,this.board.titleRibbon,0,-10)}recalculateLightPosition(){this.board&&this.board.recalculateLightPosition()}handleCloseClick=()=>{this.runFadeOutAnimation()};async fetchLeaderboardData(e){console.info("\u{1F680} > fetchLeaderboardData",e);try{if(!f9||!("getLeaderboardAsync"in GameSDK.extra))return;let i=await GameSDK.extra.getLeaderboardAsync(f9),s=[];e==="world"?s=await i.getEntriesAsync(p9,0):s=await i.getConnectedPlayerEntriesAsync(p9,0);let r={};s.forEach(n=>{let{playerId:a,score:o,rank:h}=n,l=n.getPlayer(),c=l.getName(),d=l.getPhoto();r[a]={playerId:a,name:c,photo:d,score:o,rank:h}}),this.board.leaders.updateData(r)}catch(i){console.warn(i)}finally{this.isSwitchable=!0,this.board.showLoading(!1),this.board.header.revive()}}runPopupAnimation(){let e=this.showPopupAnimController.renew();H.runTween(this.scene.tweens.add({...He,paused:!0,targets:this.board}),e)}runFadeOutAnimation(){if(!this.visible)return;let e=this.fadeOutAnimController.renew();H.runTween(this.scene.tweens.add({paused:!0,targets:this.background,duration:200,ease:v9.Cubic.Out,props:{alpha:{start:.7,from:.7,to:0}},onActive:()=>{this.board.kill()},onUpdate:(i,s)=>{W.getGlobalScene()?.requestBackgroundMaskUpdate(O.LEADER_BOARD_SCREEN,s.alpha)},onComplete:()=>{this.board.revive(),this.scene.scene.get(z.GAME_SCENE)instanceof oe&&k.removeResizeEventForCalculateLight(this),this.background.setAlpha(.7),k.closeScreen(this.name)}}),e)}},g9=d0;var E9=E(X());var T9=E(nt()),f0=E(ie());var{KEY:QRe,FRAME:S9}=T.DEFAULT,p0=class extends E9.Container{icon;label;switch;hitZone;isSwitchOn;payload;constructor(e,i){super(e),this.payload=i,this.setName("SettingSwitch"),this.setWorldSize(180,45),this.createHitZone(),this.createIcon(),this.createLabel(),this.createSwitch()}set onClick(e){this.hitZone.removeAllListeners(),this.hitZone.setInteractive({useHandCursor:!0}),this.hitZone.on(T9.GAMEOBJECT_POINTER_DOWN,()=>{let i=!this.isSwitchOn;this.logButtonEvent(i),this.setSwitch(i),e(i),Wt.vibrate(50)})}setSwitch(e){e?(this.switch.setFrame(S9.SETTINGS_SWITCH_ON),this.switch.setWorldSize(37.5,22)):(this.switch.setFrame(S9.SETTINGS_SWITCH_OFF),this.switch.setWorldSize(37,21.5)),this.isSwitchOn=e}createIcon(){this.icon=this.scene.make.image({key:this.payload.iconKey,frame:this.payload.icon}),this.add(this.icon),f0.Align.In.LeftCenter(this.icon,this.hitZone,this.payload.iconLeftOffset)}createLabel(){let e=P.buildText(this.payload.label,15).setFixedWidth(100).setOrigin({x:0,y:.5}).setHighQuality().build(this.scene);e.setName("label"),this.add(e),e.setX(this.payload.localTextX),this.label=e}createSwitch(){this.switch=this.scene.make.image({key:QRe}),this.setSwitch(!1),f0.Align.In.RightCenter(this.switch,this,10),this.add(this.switch)}createHitZone(){let e=I.getPixelRatio();this.hitZone=this.scene.add.zone(0,0,180*e,45*e),this.add(this.hitZone)}logButtonEvent(e){let i=this.name;se.trackButtonClick(i)}setDisabled(e){e?(this.hitZone?.disableInteractive(),this.setAlpha(.5)):(this.hitZone?.setInteractive(),this.setAlpha(1))}},Pl=p0;var pn=E(ie()),b9=E(he()),{Utils:{Signal:ePe}}=Ludex,{KEY:tPe,FRAME:iPe}=T.DEFAULT,{KEY:Wd,FRAME:Yd}=T.DEFAULT_8_BIT,{player:Oo,language:ua}=codex,{Utils:{Device:y9}}=Ludex,m0=class extends De{popup;sound;music;vibration;speedUp;title;screenAnimController=new ePe.SignalController;constructor(e,i){super(e,i),this.scene=e,this.background.setAlpha(.7),this.createPopup(),this.createCloseButton(),this.createTitle(),this.createContent()}open(){super.open(),this.scene.scene.get(z.GAME_SCENE)instanceof oe&&k.listenResizeEventForCalculateLight(this),W.getGlobalScene()?.requestBackgroundMaskUpdate(O.SETTINGS_SCREEN,this.background.alpha),this.recalculateLightPosition(),this.runOpenAnimation();let s=!!Oo.getPlayerSetting("sound");this.sound.setSwitch(s);let r=!!Oo.getPlayerSetting("music");if(this.music.setSwitch(r),Wt.isSupportVibrateApi()&&!y9.isDesktop()){let a=Wt.isVibrateEnable();this.vibration.setSwitch(a)}else this.vibration.setSwitch(!1)}handleChangeSound=e=>{q.playSound(J.TURN_SWITCH),Oo.setSetting("sound",e)};handleChangeMusic=e=>{q.playSound(J.TURN_SWITCH),Oo.setSetting("music",e),e?q.playMusic():q.pauseMusic()};handleChangeVibration=e=>{q.playSound(J.TURN_SWITCH),Oo.setSetting("vibrate",e)};handleChangeSpeedUp=e=>{q.playSound(J.TURN_SWITCH),Oo.setSetting("speedUp",e)};handleClosePopup=()=>{let e=this.screenAnimController.renew();this.runFadeOutAnimation(e)};createPopup(){this.popup=new Ht(this.scene,{x:0,y:0,width:261.5,height:323,rightEdge:870778,topInnerCornerStrokeWidth:2,rightInnerCornerStrokeWidth:3,lightY:-40}),this.add(this.popup)}recalculateLightPosition(){this.popup&&this.popup.recalculateLightPosition()}createCloseButton(){let e=new Yt(this.scene);e.setName("button"),pn.Align.In.TopRight(e,this.popup,10,10),this.popup.add(e),e.onClick=this.handleClosePopup}createTitle(){let e=P.buildText(ua.getText("SETTINGS").toUpperCase(),22).applyScreenHeaderStyle().build(this.scene);e.setName("title"),this.add(e),pn.Align.In.TopCenter(e,this.popup,0,-13);let i=this.scene.make.image({key:tPe,frame:iPe.TITLE_LINE});i.setWorldSize(235,23),this.popup.add(i),pn.Align.In.BottomCenter(i,e,0,30),this.title=e}createContent(){this.createSoundSetting(),this.createMusicSetting(),this.createVibrationSetting(),Wt.isSupportVibrateApi()||(this.vibration.setSwitch(!1),this.vibration.setDisabled(!0))}createSoundSetting(){this.sound=new Pl(this.scene,{iconKey:Wd,icon:Yd.ICON_SOUND,iconLeftOffset:10,localTextX:-60,label:`${ua.getText("SOUND_FX").toUpperCase()}  `});let e=ua.getCurrentLocale(),i=15;switch(e){case"pt":case"it":i=13;break;case"es":i=11;break}this.sound.label.setFontSize(i),this.sound.setName("SettingSound"),this.add(this.sound),pn.Align.In.Center(this.sound,this.popup,0,-55),this.sound.onClick=this.handleChangeSound;let s=this.scene.make.graphics({});s.fillStyle(16777215,.1),s.fillRect(-104.5,-.5,209,1),s.setPosition(0,-19.5),this.popup.add(s)}createMusicSetting(){this.music=new Pl(this.scene,{iconKey:Wd,icon:Yd.ICON_MUSIC,iconLeftOffset:8,localTextX:-60,label:`${ua.getText("MUSIC").toUpperCase()}      `}),this.music.setName("SettingMusic"),this.add(this.music),pn.Align.In.Center(this.music,this.popup,0,15),this.music.onClick=this.handleChangeMusic;let e=this.scene.make.graphics({});e.fillStyle(16777215,.1),e.fillRect(-104.5,-.5,209,1),e.setPosition(0,45.5),this.popup.add(e)}createVibrationSetting(){this.vibration=new Pl(this.scene,{iconKey:Wd,icon:Yd.ICON_VIBRATION,iconLeftOffset:10,localTextX:-60,label:`${ua.getText("VIBRATION").toUpperCase()}`}),this.vibration.setName("SettingVibration"),this.add(this.vibration),pn.Align.In.Center(this.vibration,this.popup,0,85),Wt.isSupportVibrateApi()&&(this.vibration.onClick=this.handleChangeVibration)}createSpeedUpSetting(){this.speedUp=new Pl(this.scene,{iconKey:Wd,icon:Yd.ICON_QUICK_FIGHT,iconLeftOffset:8,localTextX:-60,label:`${ua.getText("QUICK_FIGHT").toUpperCase()}`});let e=ua.getCurrentLocale(),i=15;switch(e){case"ja":case"fr":i=13;break;case"de":i=11;break}this.speedUp.label.setFontSize(i),this.speedUp.setName("SettingSpeed"),this.add(this.speedUp),pn.Align.In.Center(this.speedUp,this.popup,0,85),this.speedUp.onClick=this.handleChangeSpeedUp}runOpenAnimation(){let e=this.screenAnimController.renew();this.animateBackgroundAlpha(.7,200),this.runPopupEntrancesAnimation(e),this.runPopupContentEntrancesAnimation(100,400,e)}runPopupEntrancesAnimation(e){H.runTween(this.scene.tweens.add({...He,paused:!0,targets:this.popup,onStart:()=>{this.popup.revive()}}),e)}runPopupContentEntrancesAnimation(e,i,s){let r=[this.title,this.sound,this.music];this.speedUp&&r.push(this.speedUp),this.vibration&&r.push(this.vibration);for(let a of r)a.setAlpha(0);let n=Wt.isSupportVibrateApi()&&!y9.isDesktop();n||(this.vibration.setDisabled(!0),this.vibration.setAlpha(0)),H.runTween(this.scene.tweens.add({...pi,targets:r,duration:i,delay:this.scene.tweens.stagger(100,{start:e}),props:{scale:{from:.7,to:1},alpha:{from:0,getEnd:a=>a===this.vibration&&!n?.5:1}}}),s)}runFadeOutAnimation(e){let i=[this.title,this.sound,this.music];this.speedUp&&i.push(this.speedUp),this.vibration&&i.push(this.vibration),this.animateBackgroundAlpha(0,200),H.runTween(this.scene.tweens.add({paused:!0,targets:i,duration:300,ease:b9.Cubic.Out,props:{alpha:{start:.7,from:.7,to:0}},onStart:()=>{this.popup.kill()},onUpdate:(s,r)=>{W.getGlobalScene()?.requestBackgroundMaskUpdate(O.SETTINGS_SCREEN,r.alpha)},onComplete:()=>{this.scene.scene.get(z.GAME_SCENE)instanceof oe&&k.removeResizeEventForCalculateLight(this),k.closeScreen(this.name)}}),e)}},Hd=m0;var C9=E(he()),Do=E(ie()),{Utils:{Signal:sPe}}=Ludex,{KEY:rPe,FRAME:nPe}=T.DEFAULT,{KEY:A9,FRAME:x9}=T.DEFAULT_8_BIT,{language:ca}=codex,v0=class extends De{popup;title;confirmBtn;cancelBtn;description;screenAnimController=new sPe.SignalController;constructor(e,i){super(e,i),this.scene=e,this.background.setAlpha(.7),this.createPopup(),this.createCloseButton(),this.createTitle(),this.createContent()}open(){super.open(),this.scene.scene.get(z.GAME_SCENE)instanceof oe&&k.listenResizeEventForCalculateLight(this),W.getGlobalScene()?.requestBackgroundMaskUpdate(O.RESET_DATA_SCREEN,this.background.alpha),this.runOpenAnimation()}handleClosePopup=()=>{let e=this.screenAnimController.renew();this.runFadeOutAnimation(e)};createPopup(){this.popup=new Ht(this.scene,{x:0,y:0,width:300,height:200,rightEdge:870778,topInnerCornerStrokeWidth:2,rightInnerCornerStrokeWidth:3,lightY:-40}),this.add(this.popup)}recalculateLightPosition(){this.popup&&this.popup.recalculateLightPosition()}createCloseButton(){let e=new Yt(this.scene);e.setName("button"),Do.Align.In.TopRight(e,this.popup,10,10),this.popup.add(e),e.onClick=this.handleClosePopup}createTitle(){let e=P.buildText(ca.getText("RESET_DATA"),22).setDefaultStroke().setFixedWidth(325).setAlign("center").setHighQuality().setDefaultShadow({offsetX:-8,offsetY:8}).build(this.scene);e.setName("title"),this.add(e),Do.Align.In.TopCenter(e,this.popup,0,-13);let i=this.scene.make.image({key:rPe,frame:nPe.TITLE_LINE});i.setWorldSize(235,23),this.popup.add(i),Do.Align.In.BottomCenter(i,e,0,30),this.title=e}createContent(){this.createDescription(),this.createConfirmButton(),this.createCancelButton()}createDescription(){let e=ca.getCurrentLocale(),i=17;switch(e){case"id":case"de":i=15;break}this.description=P.buildText(ca.getText("RESET_DESC"),i).setDefaultStroke().setWordWrap({width:275}).setAlign("center").build(this.scene),this.add(this.description),this.description.setPosition(0,-10)}createConfirmButton(){this.confirmBtn=new fe(this.scene,A9,x9.BUTTON_RED,108,43),this.confirmBtn.setName("confirmBtn");let e=ca.getCurrentLocale(),i=-5;switch(e){case"tr":i=-8;break}let s=P.buildText(ca.getText("YES"),20).setDefaultStroke().setDefaultShadow({offsetX:-1,offsetY:1.5}).build(this.scene);this.confirmBtn.add(s),s.setPosition(0,i),this.add(this.confirmBtn),Do.Align.In.Center(this.confirmBtn,this.popup,-70,60),this.confirmBtn.onClick=()=>{let r=this.scene.scene.get(z.GAME_SCENE);r instanceof oe&&r.resetLevel();let n=k.getScreen(O.SETTINGS_SCREEN);n instanceof Hd&&n.handleClosePopup(),this.handleClosePopup()}}createCancelButton(){this.cancelBtn=new fe(this.scene,A9,x9.BUTTON_GREEN,108,43),this.cancelBtn.setName("cancelBtn");let e=ca.getCurrentLocale(),i=-5;switch(e){case"tr":i=-8;break}let s=P.buildText(ca.getText("NO"),20).setDefaultStroke().setDefaultShadow({offsetX:-1,offsetY:1.5}).build(this.scene);this.cancelBtn.add(s),s.setPosition(0,i),this.add(this.cancelBtn),Do.Align.In.Center(this.cancelBtn,this.popup,70,60),this.cancelBtn.onClick=this.handleClosePopup}runOpenAnimation(){let e=this.screenAnimController.renew();this.animateBackgroundAlpha(.7,200),this.runPopupEntrancesAnimation(e),this.runPopupContentEntrancesAnimation(100,400,e)}runPopupEntrancesAnimation(e){H.runTween(this.scene.tweens.add({...He,paused:!0,targets:this.popup,onStart:()=>{this.popup.revive()}}),e)}runPopupContentEntrancesAnimation(e,i,s){let r=[this.title,this.description,this.confirmBtn,this.cancelBtn],n=r.map(a=>a.alpha);H.runTween(this.scene.tweens.add({...pi,targets:r,duration:i,delay:this.scene.tweens.stagger(100,{start:e}),props:{scale:{getStart:a=>a.scale-.3,getEnd:a=>a.scale},alpha:{getStart:a=>(a.setAlpha(0),0),getEnd:(a,o,h,l)=>n[l]}}}),s)}runFadeOutAnimation(e){let i=[this.title,this.description,this.confirmBtn,this.cancelBtn];this.animateBackgroundAlpha(0,200),H.runTween(this.scene.tweens.add({paused:!0,targets:i,duration:200,ease:C9.Cubic.Out,props:{alpha:{start:.7,from:.7,to:0}},onStart:()=>{this.popup.kill()},onUpdate:(s,r)=>{W.getGlobalScene()?.requestBackgroundMaskUpdate(O.RESET_DATA_SCREEN,r.alpha)},onComplete:()=>{this.scene.scene.get(z.GAME_SCENE)instanceof oe&&k.removeResizeEventForCalculateLight(this),k.closeScreen(this.name)}}),e)}},w9=v0;var Bo=E(ie()),_9=E(he()),{Utils:{Signal:aPe}}=Ludex,{KEY:oPe,FRAME:hPe}=T.DEFAULT,{KEY:R9,FRAME:P9}=T.DEFAULT_8_BIT,{language:mn}=codex,g0=class extends De{popup;title;confirmBtn;cancelBtn;description;screenAnimController=new aPe.SignalController;constructor(e,i){super(e,i),this.scene=e,this.background.setAlpha(.7),this.createPopup(),this.createCloseButton(),this.createTitle(),this.createContent()}open(){super.open(),this.scene.scene.get(z.GAME_SCENE)instanceof oe&&k.listenResizeEventForCalculateLight(this),W.getGlobalScene()?.requestBackgroundMaskUpdate(O.START_OVER_POPUP,this.background.alpha),this.updateDescription(),this.runOpenAnimation()}updateDescription(){de.getGameCompletedCount()<1?this.description.setText(mn.getText("START_OVER_DESC_2")):this.description.setText(mn.getText("START_OVER_DESC"))}handleClosePopup=()=>{let e=this.screenAnimController.renew();this.runFadeOutAnimation(e)};createPopup(){this.popup=new Ht(this.scene,{x:0,y:0,width:300,height:200,rightEdge:870778,topInnerCornerStrokeWidth:2,rightInnerCornerStrokeWidth:3,lightY:-40}),this.add(this.popup)}recalculateLightPosition(){this.popup&&this.popup.recalculateLightPosition()}createCloseButton(){let e=new Yt(this.scene);e.setName("button"),Bo.Align.In.TopRight(e,this.popup,10,10),this.popup.add(e),e.onClick=()=>{let i=this.scene.scene.get(z.GAME_SCENE);i instanceof oe&&i.stateManager.levelComplete(),this.handleClosePopup()}}createTitle(){let e=P.buildText(mn.getText("START_OVER_TITLE").toUpperCase(),22).setDefaultStroke().setFixedWidth(325).setAlign("center").setHighQuality().setDefaultShadow({offsetX:-8,offsetY:8}).build(this.scene);e.setName("title"),this.add(e),Bo.Align.In.TopCenter(e,this.popup,0,-13);let i=this.scene.make.image({key:oPe,frame:hPe.TITLE_LINE});i.setWorldSize(235,23),this.popup.add(i),Bo.Align.In.BottomCenter(i,e,0,30),this.title=e}createContent(){this.createDescription(),this.createConfirmButton(),this.createCancelButton()}createDescription(){this.description=P.buildText(mn.getText("START_OVER_DESC"),15).setDefaultStroke().setAlign("center").build(this.scene),this.add(this.description),this.description.setPosition(0,-10)}createConfirmButton(){this.confirmBtn=new fe(this.scene,R9,P9.BUTTON_RED,108,43),this.confirmBtn.setName("confirmBtn");let e=mn.getCurrentLocale(),i=-5;switch(e){case"tr":i=-8;break}let s=P.buildText(mn.getText("YES"),20).setDefaultStroke().setDefaultShadow({offsetX:-1,offsetY:1.5}).build(this.scene);this.confirmBtn.add(s),s.setPosition(0,i),this.add(this.confirmBtn),Bo.Align.In.Center(this.confirmBtn,this.popup,-70,60),this.confirmBtn.onClick=()=>{let r=this.scene.scene.get(z.GAME_SCENE);r instanceof oe&&r.resetLevel(!1),this.handleClosePopup()}}createCancelButton(){this.cancelBtn=new fe(this.scene,R9,P9.BUTTON_GREEN,108,43),this.cancelBtn.setName("cancelBtn");let e=mn.getCurrentLocale(),i=-5;switch(e){case"tr":i=-8;break}let s=P.buildText(mn.getText("NO"),20).setDefaultStroke().setDefaultShadow({offsetX:-1,offsetY:1.5}).build(this.scene);this.cancelBtn.add(s),s.setPosition(0,i),this.add(this.cancelBtn),Bo.Align.In.Center(this.cancelBtn,this.popup,70,60),this.cancelBtn.onClick=()=>{this.handleClosePopup()}}runOpenAnimation(){let e=this.screenAnimController.renew();this.animateBackgroundAlpha(.7,200),this.runPopupEntrancesAnimation(e),this.runPopupContentEntrancesAnimation(100,400,e)}runPopupEntrancesAnimation(e){H.runTween(this.scene.tweens.add({...He,paused:!0,targets:this.popup,onStart:()=>{this.popup.revive()}}),e)}runPopupContentEntrancesAnimation(e,i,s){let r=[this.title,this.description,this.confirmBtn,this.cancelBtn],n=r.map(a=>a.alpha);H.runTween(this.scene.tweens.add({...pi,targets:r,duration:i,delay:this.scene.tweens.stagger(100,{start:e}),props:{scale:{getStart:a=>a.scale-.3,getEnd:a=>a.scale},alpha:{getStart:a=>(a.setAlpha(0),0),getEnd:(a,o,h,l)=>n[l]}}}),s)}runFadeOutAnimation(e){let i=[this.title,this.description,this.confirmBtn,this.cancelBtn];this.animateBackgroundAlpha(0,200),H.runTween(this.scene.tweens.add({paused:!0,targets:i,duration:200,ease:_9.Cubic.Out,props:{alpha:{start:.7,from:.7,to:0}},onStart:()=>{this.popup.kill()},onUpdate:(s,r)=>{W.getGlobalScene()?.requestBackgroundMaskUpdate(O.START_OVER_POPUP,r.alpha)},onComplete:()=>{this.scene.scene.get(z.GAME_SCENE)instanceof oe&&k.removeResizeEventForCalculateLight(this),k.closeScreen(this.name)}}),e)}},I9=g0;var L9=E(he()),Uo=E(ie()),{Utils:{Signal:lPe}}=Ludex,{KEY:uPe,FRAME:cPe}=T.DEFAULT,{KEY:S0,FRAME:E0}=T.DEFAULT_8_BIT,{BossChallenge:dPe}=le.Powers,{language:wr}=codex,T0=class extends De{popup;title;bossLevelText;confirmBtn;adIcon;confirmBtnText;cancelBtn;isAccepted;adsTimer=null;description;screenAnimController=new lPe.SignalController;constructor(e,i){super(e,i),this.scene=e,this.background.setAlpha(.7),this.createPopup(),this.createCloseButton(),this.createTitle(),this.createContent()}open(){super.open(),this.isAccepted=!1,this.scene.scene.get(z.GAME_SCENE)instanceof oe&&k.listenResizeEventForCalculateLight(this),W.getGlobalScene()?.requestBackgroundMaskUpdate(O.BOSS_CHALLENGE_SCREEN,this.background.alpha),this.updateDescription(),this.runOpenAnimation()}updateDescription(){let e=de.getPlayerBossLevelProgress(),i=this.isBossChallengeAvailable(),s=i?"BOSS_CHALLENGE_DESC":"BOSS_CHALLENGE_AD";this.setAdMode(!i),this.description.setText(wr.getText(s,[`${e}`])),this.bossLevelText.setText(wr.getText("BOSS_LEVEL",[`${e}`]))}handleClosePopup=()=>{let e=this.screenAnimController.renew();this.runFadeOutAnimation(e)};createPopup(){this.popup=new Ht(this.scene,{x:0,y:0,width:350,height:200,rightEdge:870778,topInnerCornerStrokeWidth:2,rightInnerCornerStrokeWidth:3,lightY:-40}),this.add(this.popup)}recalculateLightPosition(){this.popup&&this.popup.recalculateLightPosition()}createCloseButton(){let e=new Yt(this.scene);e.setName("button"),Uo.Align.In.TopRight(e,this.popup,10,10),this.popup.add(e),e.onClick=()=>{this.handleClosePopup()}}createTitle(){let e=P.buildText(wr.getText("BOSS_CHALLENGE_TITLE").toUpperCase(),22).applyScreenHeaderStyle().build(this.scene);e.setName("title"),this.add(e),Uo.Align.In.TopCenter(e,this.popup,0,-10);let i=this.scene.make.image({key:uPe,frame:cPe.TITLE_LINE});i.setWorldSize(235,23),this.popup.add(i),Uo.Align.In.BottomCenter(i,e,0,30),this.title=e}createContent(){this.createBossLevelText(),this.createDescription(),this.createConfirmButton(),this.createCancelButton()}createBossLevelText(){this.bossLevelText=P.buildText(wr.getText("BOSS_LEVEL").toUpperCase(),18).setDefaultStroke().build(this.scene),this.bossLevelText.setAlign("center"),this.add(this.bossLevelText),this.bossLevelText.setPosition(0,-40)}createDescription(){this.description=P.buildText(wr.getText("START_OVER_DESC").toUpperCase(),15).setDefaultStroke().build(this.scene),this.description.setAlign("center"),this.add(this.description),this.description.setPosition(0,3)}createConfirmButton(){this.confirmBtn=new fe(this.scene,S0,E0.BUTTON_GREEN,108,43),this.confirmBtn.setName("confirmBtn"),this.confirmBtnText=P.buildText(wr.getText("YES").toUpperCase(),20).setDefaultStroke().setDefaultShadow({offsetX:-1,offsetY:1.5}).build(this.scene),this.adIcon=this.scene.make.image({key:S0,frame:E0.ICON_AD}),this.adIcon.setWorldSize(25.5,27),this.confirmBtn.add([this.adIcon,this.confirmBtnText]),this.adIcon.setPosition(-32,-3),this.add(this.confirmBtn),Uo.Align.In.Center(this.confirmBtn,this.popup,-70,60),this.confirmBtn.onClick=async()=>{let e=this.scene.scene.get(z.GAME_SCENE);if(this.isAccepted=!0,!this.isBossChallengeAvailable()){await this.handleShowRewardedVideoAd();return}this.handleClosePopup(),this.scene.time.delayedCall(200,()=>{e instanceof oe&&e.requestBossFight()})}}createCancelButton(){this.cancelBtn=new fe(this.scene,S0,E0.BUTTON_RED,108,43),this.cancelBtn.setName("cancelBtn");let e=wr.getCurrentLocale(),i=-5,s=20;switch(e){case"tr":i=-8;break;case"ja":s=18,i=-7;break;case"zh":s=18;break}let r=P.buildText(wr.getText("NO").toUpperCase(),s).setDefaultStroke().setDefaultShadow({offsetX:-1,offsetY:1.5}).build(this.scene);this.cancelBtn.add(r),r.setPosition(0,i),this.add(this.cancelBtn),Uo.Align.In.Center(this.cancelBtn,this.popup,70,60),this.cancelBtn.onClick=()=>{this.handleClosePopup()}}runOpenAnimation(){let e=this.screenAnimController.renew();this.animateBackgroundAlpha(.7,200),this.runPopupEntrancesAnimation(e),this.runPopupContentEntrancesAnimation(100,400,e)}runPopupEntrancesAnimation(e){H.runTween(this.scene.tweens.add({...He,paused:!0,targets:this.popup,onStart:()=>{this.popup.revive()}}),e)}runPopupContentEntrancesAnimation(e,i,s){let r=[this.title,this.bossLevelText,this.description,this.confirmBtn,this.cancelBtn];for(let n of r)n.setAlpha(0);H.runTween(this.scene.tweens.add({...pi,targets:r,duration:i,delay:this.scene.tweens.stagger(100,{start:e}),props:{scale:{from:.7,to:1},alpha:{from:0,to:1}}}),s)}runFadeOutAnimation(e){let i=[this.title,this.bossLevelText,this.description,this.confirmBtn,this.cancelBtn];this.animateBackgroundAlpha(0,200),H.runTween(this.scene.tweens.add({paused:!0,targets:i,duration:200,ease:L9.Cubic.Out,props:{alpha:{start:.7,from:.7,to:0}},onStart:()=>{this.popup.kill()},onUpdate:(s,r)=>{W.getGlobalScene()?.requestBackgroundMaskUpdate(O.BOSS_CHALLENGE_SCREEN,r.alpha)},onComplete:()=>{let s=this.scene.scene.get(z.GAME_SCENE);if(s instanceof oe){let{powerManager:r}=s;k.removeResizeEventForCalculateLight(this),this.isAccepted||r.updateTimers()}k.closeScreen(this.name)}}),e)}handleShowRewardedVideoAd=async()=>{if(this.confirmBtn.setDisabled(!0),this.cancelBtn.setDisabled(!0),await ae.showRewardVideoAdAsync()){this.handleClosePopup();let i=this.scene.scene.get(z.GAME_SCENE);this.scene.time.delayedCall(200,()=>{i instanceof oe&&i.requestBossFight()})}this.confirmBtn.setDisabled(!1),this.cancelBtn.setDisabled(!1)};isBossChallengeAvailable(){let e=de.getLastBossChallengeTime(),i=Date.now();return dPe.duration-(i-e)<=0}setAdMode(e){let i=wr.getCurrentLocale(),s=-5,r=15,n=20;switch(i){case"tr":s=-8;break;case"ja":n=18,s=-7;break;case"zh":n=18;break}e?(this.adIcon.setVisible(!0),this.confirmBtnText.setFontSize(20),this.confirmBtnText.setPosition(r,s)):(this.adIcon.setVisible(!1),this.confirmBtnText.setFontSize(n),this.confirmBtnText.setPosition(0,s))}},M9=T0;var B9=E(qe()),y0=E(ie()),{KEY:O9,FRAME:D9}=T.DEFAULT_8_BIT,{Plugins:{Ads:{Types:{REWARDED_VIDEO:fPe}}}}=Ludex,b0=class extends la{numOfCols;colPadding;sliderBg;sliderBar;minSliderY;maxSliderY;constructor(e,i){super(e,i),this.numOfCols=i.numOfCols?i.numOfCols:2,this.colPadding=i.colPadding?i.colPadding:0,this.createSlider(),this.updateConfig(i.listConfigs)}createSlider(){let e=this.scene.make.image({key:O9,frame:D9.UNIT_SCREEN_SLIDEBAR_BG});e.setName("sliderBg"),e.setWorldSize(6.5,255),y0.Align.In.RightCenter(e,this,-3,5),this.add(e),this.sliderBg=e;let i=this.scene.make.image({key:O9,frame:D9.UNIT_SCREEN_BAR});i.setName("sliderBar"),i.setWorldSize(3.5,41.5),y0.Align.In.TopCenter(i,this.sliderBg),this.add(i),this.sliderBar=i;let{y:s,displayHeight:r}=this.sliderBg;this.minSliderY=s-r/2+this.sliderBar.displayHeight/2+1.5,this.maxSliderY=this.minSliderY+this.sliderBg.displayHeight-this.sliderBar.displayHeight-1.5}createEvents(){super.createEvents(),this.scene.events.on(B9.UPDATE,()=>{let e=this.value-this.marginTop;this.value<-this.maxHeight?e=-this.maxHeight:this.value>0&&(e=0),e=-e;let i=e/(this.maxHeight+this.marginTop);this.sliderBar.setY(this.minSliderY+i*(this.maxSliderY-this.minSliderY))})}updateMaxHeight(){let e=Math.ceil(this.listConfigs.length/this.numOfCols);return this.maxHeight=Math.max(e*(this.objHeight+this.padding)-this.padding+this.marginBottom-this.height,0),this.maxHeight}addObjectIndex(e,i){for(let s=e;s<=i;s++){let{padding:r,listConfigs:n}=this;if(s>=n.length)return;let a=this.objects.getFirstDead(!0),o=a.height,h=Math.floor(s/this.numOfCols),l=s%this.numOfCols,c=o/2,d=(o+r)*h,f=this.height/2,p=c+d+this.value-f,m=a.width,v=m/2,S=-(this.numOfCols*(m+this.colPadding)-this.colPadding)/2+v+(m+this.colPadding)*l;a.updateInfo(n[s]),a.setPosition(S,p),a.setActive(!0),a.setVisible(!0),this.addAt(a),this.listObjects[s]=a}}getEndObjectIndex(){let{objHeight:e,padding:i,listConfigs:s}=this,r=e+i;return Math.min(this.numOfCols*Math.floor((this.height-this.value)/r)+(this.numOfCols-1),s.length)}updateListConfigMember(e,i,s){for(let n=0;n<this.listObjects.length;n++){let a=this.listConfigs[n],{unitType:o,originData:h,currentAdWatched:l}=a;if(!o||!h||l===void 0)continue;let{level:c}=h;if(c&&o===e&&c===i){a.currentAdWatched=s;break}}if(ae.isReadyAdShowable(fPe))return;let r=this.objects.getMatching("active",!0);for(let n of r)n.disableAds()}},U9=b0;var N9=E(ie()),{KEY:zd,FRAME:Vd}=T.DEFAULT_8_BIT,{language:No}=codex,A0=class extends fe{countText;adContainer;btnText;iconAd;iconCoin;constructor(e){super(e,zd,Vd.UNIT_SCREEN_AD_BUTTON,145,41),this.createText(),this.createAdCount()}createText(){let e=P.buildText(No.getText("FREE").toUpperCase(),20).setDefaultStroke().setDefaultShadow({offsetX:-3,offsetY:3}).build(this.scene);e.setY(-7),this.add(e),this.btnText=e}getBtnTextFontSize(e){let i=No.getCurrentLocale(),s=20;switch(e){case"notAvailable":switch(i){case"pt":s=17;break;case"id":s=18;break;case"de":case"it":case"tr":s=16;break}break}return i==="ja"&&(s=16),s}createAdCount(){let e=this.scene.make.container({}),i=this.scene.make.image({key:zd,frame:Vd.UNIT_SCREEN_AD_COUNT_BG});i.setWorldSize(68.5,17.5),e.setSize(68.5,17.5),e.add(i);let s=this.scene.make.image({key:zd,frame:Vd.UNIT_SCREEN_AD_ICON});s.setWorldSize(9,7.5),s.setX(-25),e.add(s),this.iconAd=s;let r=this.scene.make.image({key:zd,frame:Vd.UNIT_SCREEN_COIN_ICON});r.setWorldSize(12,11.5),r.setX(-25),e.add(r),this.iconCoin=r;let n=P.buildText("0/999",10).setOrigin({x:.5,y:.6}).build(this.scene);e.add(n),this.countText=n,N9.Align.In.BottomCenter(e,this),this.add(e),this.adContainer=e}setCountText(e,i){i===0?this.countText.setText(`${e.toString()}`):i===-1?this.countText.setText(""):this.countText.setText(`${e.toString()}/${i}`),i===0?this.setMode("buy"):i===-1?this.setMode("notAvailable"):typeof e=="number"&&e>=i?this.setMode("collect"):this.setMode("watch")}setMode(e){e==="watch"?(this.adContainer.revive(),this.iconAd.revive(),this.iconCoin.kill(),this.btnText.setText(No.getText("FREE"))):e==="collect"?(this.adContainer.kill(),this.btnText.setText(No.getText("COLLECT"))):e==="notAvailable"?(this.adContainer.kill(),this.btnText.setText(No.getText("UNAVAILABLE"))):(this.adContainer.revive(),this.iconAd.kill(),this.iconCoin.revive(),this.btnText.setText(No.getText("BUY"))),this.btnText.setFontSize(this.getBtnTextFontSize(e))}},F9=A0;var C0=E(Io()),fa=E(ie()),W9=E(X()),Xd=E(he()),{KEY:x0,FRAME:k9}=T.UNITS,{KEY:da,FRAME:Rr}=T.DEFAULT_8_BIT,{MaximumMeleeLevel:pPe,MaximumRangedLevel:mPe}=le,{MELEE_UNIT_TYPE:vPe,RANGED_UNIT_TYPE:gPe}=L,{language:G9}=codex,{Utils:{Signal:SPe,String:EPe,Number:q9},Plugins:{Ads:{Types:{REWARDED_VIDEO:TPe}}}}=Ludex,w0=class extends W9.Container{background;watchAdButton;titleText;lock;healthContainer;healthText;atkContainer;atkText;unitIcon;payload;showPopUpAnimController=new SPe.SignalController;loading;constructor(e,i){super(e),this.scene=e,this.createBackground(),this.createWatchAdButton(),this.updateSize(),this.createUnitIcon(),this.createTitleText(),this.createLock(),this.createHealthContainer(),this.createAtkContainer(),i&&this.updateInfo(i),this.scene.add.existing(this)}updateInfo(e){this.payload={isUnlock:!1,isCanBuy:!1,coinNeed:new be(0),...e},this.updateFrame(),this.updateTitle(),this.updateAdButton(),this.updateLock(),this.updateUnitIcon(),this.updateHealthContainer(),this.updateAtkContainer()}disableAds(){let{currentAdWatched:e,targetAdWatched:i}=this.payload;i>0&&e<i&&this.watchAdButton.setDisabled(!0)}runShowUpAnimation(e=0,i=300){let s=e*100;this.runShowPopUpAnimation(s,i),this.runShowItemAnimation(s,i)}runShowPopUpAnimation(e,i){let s=this.showPopUpAnimController.renew();this.scene.tweens.killTweensOf(this),H.runTween(this.scene.tweens.add({...He,paused:!0,targets:this,delay:e,duration:i,props:{...He.props,y:{...He.props.y,start:this.y+70,to:this.y}}}),s)}runShowItemAnimation(e,i){let s=[this.background,this.watchAdButton,this.titleText,this.lock,this.healthContainer,this.atkContainer];this.unitIcon.visible&&this.unitIcon.active&&s.push(this.unitIcon);let r=s.map(a=>a.alpha);s.forEach(a=>a.setAlpha(0));let n=s.map(a=>a.scale);this.scene.tweens.killTweensOf(s),this.scene.add.tween({targets:s,duration:i,delay:this.scene.tweens.stagger(50,{start:e+50}),props:{scale:{duration:1e3,getStart:(a,o,h,l)=>n[l]*.8,getEnd:(a,o,h,l)=>n[l],ease:Xd.Elastic.Out,easeParams:[.1,.45]},alpha:{duration:500,getStart:a=>(a.setAlpha(0),0),getEnd:(a,o,h,l)=>r[l],ease:Xd.Cubic.Out}},onStop:()=>{s.forEach((a,o)=>{a.setScale(n[o])})},onComplete:()=>{s.forEach((a,o)=>{a.setScale(n[o])})}})}createBackground(){this.background=this.scene.make.image({key:da,frame:Rr.UNIT_SCREEN_FRAME_1}),this.background.setWorldSize(145,205),this.background.setY(-20.5),this.add(this.background)}createWatchAdButton(){let e=new F9(this.scene);e.onClick=this.handleClickWatchAd,this.add(e),fa.Align.In.BottomCenter(e,this.background,0,41),this.watchAdButton=e}handleClickWatchAd=async()=>{let{currentAdWatched:e,targetAdWatched:i,updateDataCallback:s,unitType:r,originData:n,showAdsCallback:a,collectCallback:o}=this.payload,{level:h}=n;if(e>=i){let l=i===0;if(l||se.trackButtonClick(this.watchAdButton.name),!o(r,h,l))return;se.logEarnUnitAnalytics(r,h),this.payload.currentAdWatched=0,s(r,h,this.payload.currentAdWatched),this.updateAdButton();return}se.trackButtonClick(this.watchAdButton.name);try{if(!await a())return}catch{return}this.payload.currentAdWatched++,s(r,h,this.payload.currentAdWatched),this.updateAdButton()};updateSize(){let{width:e,height:i}=this.background;this.setSize(e,i+41)}createTitleText(){let e=P.buildText("Locked",15).setFixedWidth(195).setAlign("center").setHighQuality().build(this.scene);this.add(e),this.titleText=e}createLock(){let e=this.scene.make.image({key:da,frame:Rr.UNIT_SCREEN_ICON_LOCK});e.setWorldSize(21,28),this.add(e),this.lock=e}createHealthContainer(){this.healthContainer=this.scene.make.container({});let e=this.scene.make.image({key:da,frame:Rr.UNIT_SCREEN_BG});e.setWorldSize(56.5,18),this.add(e);let i=this.scene.make.image({key:da,frame:Rr.UNIT_SCREEN_ICON_HEART});i.setWorldSize(15,13.5),fa.Align.In.LeftCenter(i,e,-5);let s=P.buildText("0",13).setFixedWidth(13*13).setAlign("center").setHighQuality().build(this.scene);s.setPosition(10,0),this.healthText=s,this.healthContainer.add([e,i,s]),this.add(this.healthContainer),fa.Align.In.TopLeft(this.healthContainer,this.background,-35,-12)}createAtkContainer(){this.atkContainer=this.scene.make.container({});let e=this.scene.make.image({key:da,frame:Rr.UNIT_SCREEN_BG});this.add(e),e.setWorldSize(56.5,18);let i=this.scene.make.image({key:da,frame:Rr.UNIT_SCREEN_ICON_BATTLE});i.setWorldSize(14,13),fa.Align.In.LeftCenter(i,e,-5);let s=P.buildText("0",13).setFixedWidth(13*13).setAlign("center").setHighQuality().build(this.scene);s.setPosition(10,0),this.atkText=s,this.atkContainer.add([e,i,s]),this.add(this.atkContainer),fa.Align.In.TopRight(this.atkContainer,this.background,-35,-12)}createUnitIcon(){this.loading=new Hs(this.scene),this.loading.setY(-30),this.add(this.loading);let e=this.scene.make.image({key:da,frame:Rr.BLANK});e.setWorldSize(142,142),this.add(e),fa.Align.In.Center(e,this.background,0,-8),e.kill(),this.unitIcon=e}updateFrame(){let{isUnlock:e}=this.payload;e?(this.background.setFrame(Rr.UNIT_SCREEN_FRAME_1),this.background.setWorldSize(145,205)):(this.background.setFrame(Rr.UNIT_SCREEN_FRAME_LOCKED),this.background.setWorldSize(145,202.5))}updateTitle(){let{isUnlock:e}=this.payload;if(this.titleText.setScale(1),e){let{name:i}=this.payload.originData;switch(this.titleText.setText(i),this.titleText.setColor("#FFFFFF"),this.titleText.setPosition(0,58),G9.getCurrentLocale()){case"ja":this.titleText.text.length>8&&this.titleText.setScale(8/this.titleText.text.length);break;default:this.titleText.text.length>15&&this.titleText.setScale(15/this.titleText.text.length);break}}else{let i=G9.getText("LOCKED");this.titleText.setPosition(0,58),this.isUnitComingSoon()&&(i="Coming Soon",this.titleText.setPosition(0,58)),this.titleText.setText(i),this.titleText.setColor("#9AACBF")}}isUnitComingSoon(){let{originData:e,unitType:i}=this.payload,{level:s}=e;switch(i){case vPe:return s>pPe;case gPe:return s>mPe;default:return!0}}updateAdButton(){let{isUnlock:e,currentAdWatched:i,targetAdWatched:s,isUnitBoardFull:r,coinNeed:n,isCanBuy:a,unitType:o,originData:h}=this.payload,{level:l}=h,c=!1,d=this.scene.scene.get(z.GAME_SCENE);if(d instanceof oe&&(c=d.gameMode===ne.BATTLE),this.watchAdButton.setDisabled(!1),e)if(this.watchAdButton.setVisible(!0),s===0){let f=EPe.toCamelCase(o);this.watchAdButton.setName(`Buy${f}Unit`),this.watchAdButton.setCountText(n,s),(!a||r||c)&&this.watchAdButton.setDisabled(!0)}else if(s===-1)this.watchAdButton.setName(`NotAvailable${o}${l}Unit`),this.watchAdButton.setCountText(0,s),this.watchAdButton.setDisabled(!0);else{let f="BuyUnitByRewardedVideo";i>=s&&(f="CollectUnitByRewardedVideo"),this.watchAdButton.setName(f);let p=i??0;this.watchAdButton.setCountText(p,s),i>=s&&(r||c)&&this.watchAdButton.setDisabled(!0),i<s&&!ae.isReadyAdShowable(TPe)&&this.watchAdButton.setDisabled(!0)}else this.watchAdButton.setVisible(!1)}updateLock(){let{isUnlock:e}=this.payload;e?this.lock.setVisible(!1):(this.isUnitComingSoon()?this.lock.setPosition(-45,53):this.lock.setPosition(-57,25),this.lock.setVisible(!0))}updateUnitIcon(){let e=this.getUnitFrame();e!==""&&(this.scene.textures.get(x0).has(e)?this.setUnitFrame(e):this.scene.textures.on(C0.ADD,this.handleWaitAddTexture))}getUnitFrame(){let{isUnlock:e,unitType:i}=this.payload,{level:s}=this.payload.originData,r="UNLOCKED";e||(r="LOCKED");let n="";return i===L.MELEE_UNIT_TYPE&&(n=k9[r].MELEE[s]),i===L.RANGED_UNIT_TYPE&&(n=k9[r].RANGED[s]),n}handleWaitAddTexture=e=>{if(e!==x0||(this.scene.textures.off(C0.ADD,this.handleWaitAddTexture),!this.visible&&!this.active))return;let i=this.getUnitFrame();i!==""&&this.setUnitFrame(i)};setUnitFrame(e){this.unitIcon.revive(),this.loading.kill(),this.unitIcon.setTexture(x0,e),this.unitIcon.setWorldSize(142,142)}updateHealthContainer(){let{health:e}=this.payload.originData,i=q9.toAbbreviatedString(e);this.healthText.setText(i)}updateAtkContainer(){let{damage:e}=this.payload.originData,i=q9.toAbbreviatedString(e);this.atkText.setText(i)}},Y9=w0;var H9=E(X()),R0=class extends H9.Container{scroller;constructor(e){super(e),this.createScroller(),this.scene.add.existing(this)}createScroller(){this.scroller=new U9(this.scene,{classType:Y9,listConfigs:[],width:322,height:423.5-158,padding:10,marginTop:10,marginBottom:10,numOfCols:2,colPadding:5}),this.scroller.setName("scroller"),this.scroller.createMask(),this.scroller.setPosition(0,40),this.add(this.scroller)}updateData(e){e.length<1||(this.scroller.updateConfig(e),this.runAnimations())}updateListConfigMember(e,i,s){this.scroller.updateListConfigMember(e,i,s)}runAnimations(){let e=this.scroller.getChildren();if(e.length<1){let n=k.getScreen(O.UNITS_SCREEN);if(!(n instanceof _l))return;n.isSwitchable=!0;return}let i=Math.min(e.length,this.scroller.numOfCols*3),s=300;for(let n=0;n<i;n++){let a=e[n];a&&(a.setVisible(!0),a.runShowUpAnimation(n,s))}let r=s+i*100+50*5;this.scene.time.delayedCall(r,()=>{let n=k.getScreen(O.UNITS_SCREEN);n instanceof _l&&(n.isSwitchable=!0,this.scroller.setEnable(!0))})}},z9=R0;var V9=E(ie()),{KEY:yPe,FRAME:bPe}=T.DEFAULT_8_BIT,P0=class extends fe{focusFrame;text;constructor(e,i,s,r){super(e,i,s),this.createText(r),this.createFocus()}createText(e){let i=P.buildText(e,13).setDefaultStroke().setFixedWidth(169).setAlign("center").setHighQuality().setDefaultShadow({offsetY:2}).build(this.scene);this.add(i),this.text=i}createFocus(){let e=this.scene.make.image({key:yPe,frame:bPe.UNIT_SCREEN_TAB_FOCUS});e.setName("focus"),e.setWorldSize(57,3.5),e.setVisible(!1),V9.Align.In.Center(e,this,0,this.button.height),e.setPosition(0,13),this.add(e),this.focusFrame=e}turnOnFocus(){this.focusFrame.setVisible(!0),this.text.setColor("#FFFFFF")}turnOffFocus(){this.focusFrame.setVisible(!1),this.text.setColor("#72ABFA")}},_0=P0;var K9=E(X()),Kd=E(ie()),{KEY:I0,FRAME:L0}=T.DEFAULT_8_BIT,{language:X9}=codex,M0=class extends K9.Container{ribbon;dinosaursBtn;warriorsBtn;constructor(e){super(e),this.createRibbon(),this.createDinosaursBtn(),this.createWarriorsBtn()}selectTabDinosaurs(){this.dinosaursBtn.turnOnFocus(),this.warriorsBtn.turnOffFocus()}selectTabWarriors(){this.dinosaursBtn.turnOffFocus(),this.warriorsBtn.turnOnFocus()}createRibbon(){let e=this.scene.make.image({key:I0,frame:L0.UNIT_SCREEN_TAB_BG});e.setWorldSize(329,29),e.setName("ribbon"),Kd.Align.In.Center(e,this),this.add(e),this.ribbon=e}createDinosaursBtn(){let e=new _0(this.scene,I0,L0.BLANK,X9.getText("DINOSAURS").toUpperCase());e.button.setWorldSize(85,29),e.button.setVisible(!1),e.setName("DinosaursTab"),Kd.Align.In.Center(e,this.ribbon,-100,0),this.add(e),this.dinosaursBtn=e}createWarriorsBtn(){let e=new _0(this.scene,I0,L0.BLANK,X9.getText("WARRIORS").toUpperCase());e.button.setWorldSize(85,29),e.button.setVisible(!1),e.setName("WarriorsTab"),Kd.Align.In.Center(e,this.ribbon,0,0),this.add(e),this.warriorsBtn=e}},Z9=M0;var pa=E(ie()),j9=E(X()),{language:Ke}=codex,{KEY:APe,FRAME:xPe}=T.DEFAULT,O0=class extends j9.Container{popup;tabs;scrollerController;closeBtn;onClose;constructor(e){super(e),this.createPopup(),this.createPopupContents(),this.updateSize(),this.createCloseButton()}updateSize(){let{width:e,height:i}=this.popup;this.setSize(e,i)}createPopup(){this.popup=new Ht(this.scene,{x:0,y:0,width:332,height:399,rightEdge:283798,bottomRightCorner:215172,bottomEdge:76382,mainTopColorGradient:145525,mainBotColorGradient:145525,topInnerCornerStrokeWidth:1.3,rightInnerCornerStrokeWidth:3}),this.popup.turnOffLight(),this.add(this.popup),pa.Align.In.Center(this.popup,this)}recalculateLightPosition(){this.popup&&this.popup.recalculateLightPosition()}createPopupContents(){this.createTitle(),this.createScrollerController(),this.createNonInteractiveArea(),this.createTabs()}createTitle(){let e=this.scene.add.container();e.setName("title");let i=this.scene.make.image({key:APe,frame:xPe.RIBBON_BLUE});i.setWorldSize(239,67);let s=P.buildText(Ke.getText("CHARACTER_LIST").toUpperCase(),21).setFixedWidth(13*22).setAlign("center").setHighQuality().build(this.scene);pa.Align.In.Center(s,i,0,-10),e.add([i,s]),this.add(e),pa.Align.In.TopCenter(e,this.popup,0,-28)}createTabs(){this.tabs=new Z9(this.scene),this.tabs.setName("tabs"),this.add(this.tabs),pa.Align.In.TopCenter(this.tabs,this.popup,0,-85)}createScrollerController(){this.scrollerController=new z9(this.scene),this.add(this.scrollerController),pa.Align.In.Center(this.scrollerController,this.popup)}createNonInteractiveArea(){let e=0;I.isLandscape()&&(e=15);let i=40,s=322,r=423.5-158,n=this.scrollerController.y+i,a=r+50,o=this.scene.add.zone(0,0,s,a);o.setPosition(0,n-e-(r+(a-r)/2)),o.setInteractive(),this.add(o);let h=this.scene.add.zone(0,0,s,a);h.setPosition(0,n+e+(r+(a-r)/2)),h.setInteractive(),this.add(h)}createCloseButton(){this.closeBtn=new Yt(this.scene),pa.Align.In.TopRight(this.closeBtn,this,10,10),this.add(this.closeBtn),this.closeBtn.onClick=this.handleOnCloseClick}handleOnCloseClick=()=>{this.onClose&&this.onClose()};updateData(e){e.forEach(i=>{i.originData.name=this.translateUnitName(i.originData.name).toUpperCase()}),this.scrollerController.updateData(e)}translateUnitName(e){switch(e){case"Rockthrower":return Ke.getText("ROCKTHROWER");case"Javelineer":return Ke.getText("JAVELINEER");case"Boomeranger":return Ke.getText("BOOMERANGER");case"Macer":return Ke.getText("MACER");case"Artemis":return Ke.getText("ARTEMIS");case"William":return Ke.getText("WILLIAM");case"Blanchette":return Ke.getText("BLANCHETTE");case"Phantom":return Ke.getText("PHANTOM");case"Oracle":return Ke.getText("ORACLE");case"Shaman":return Ke.getText("SHAMAN");case"Seraph":return Ke.getText("SERAPH");case"Velociraptor":return Ke.getText("VELOCIRAPTOR");case"Saurolophus":return Ke.getText("SAUROLOPHUS");case"Pachysaurus":return Ke.getText("PACHYSAURUS");case"Triceratops":return Ke.getText("TRICERATOPS");case"Stegosaurus":return Ke.getText("STEGOSAURUS");case"Ankylosaurus":return Ke.getText("ANKYLOSAURUS");case"Baroptiloraptor":return Ke.getText("BAROPTILORAPTOR");case"Tyrannosaurus":return Ke.getText("TYRANNOSAURUS");case"Dilophosaurus":return Ke.getText("DILOPHOSAURUS");case"Triceradonosaurus":return Ke.getText("TRICERADONOSAURUS");case"Spinosaurus Rex":return Ke.getText("SPINOSAURUS_REX");default:return e}}updateListConfigMember(e,i,s){this.scrollerController.updateListConfigMember(e,i,s)}removeAllBlocks(){this.scrollerController.updateData([])}},$9=O0;var t7=E(ie()),i7=E(he()),{Utils:{Signal:J9}}=Ludex,{AD_WATCH_REQUIREMENT:Q9}=L,{MaximumMeleeLevel:e7,MaximumRangedLevel:CPe}=le,{player:wPe}=codex,D0=class extends De{unitPopup;isSwitchable;showPopupAnimController=new J9.SignalController;fadeOutAnimController=new J9.SignalController;adsTimer;isShowingAds;constructor(e,i){super(e,i),this.background.setAlpha(.7),this.setDepth(At.POPUP),this.createUnitPopup()}open(){super.open(),this.isShowingAds=!1,W.getGlobalScene()?.requestBackgroundMaskUpdate(O.UNITS_SCREEN,this.background.alpha),this.runPopupAnimation(),this.isSwitchable=!1,this.selectDinosaursTab()}selectDinosaursTab(){this.unitPopup.tabs.selectTabDinosaurs(),this.unitPopup.removeAllBlocks();let e=this.getDataOf(L.MELEE_UNIT_TYPE);this.unitPopup.updateData(e)}selectWarriorsTab(){this.unitPopup.tabs.selectTabWarriors(),this.unitPopup.removeAllBlocks();let e=this.getDataOf(L.RANGED_UNIT_TYPE);this.unitPopup.updateData(e)}recalculateLightPosition(){this.unitPopup&&this.unitPopup.recalculateLightPosition()}getDataOf(e){let i=[],s=this.scene.scene.get(z.GAME_SCENE),r=this.getAdWatchedCount(e),n=!0,a=1,o=!1;if(s instanceof oe&&(n=!(s.fieldManager.getRemainingAvailablePlacement()>0),a=s.getBuyingUnitLevel(),o=s.tutorialManager.isRunning()),e===L.MELEE_UNIT_TYPE){let h=de.getPlayerUnlockedMeleeLevel();(!h||typeof h!="number")&&(h=1);let l=Se.inst.getCoin(),c=new be(0),d=!0;if(s instanceof oe){let p=s.unitManager.getPlayerMeleeSpawnedUnitsCount();c=s.coinManager.getUnitPrice(p)}if(l.smallerThan(c)){let p=l.toString(),m=c.toString();p!==m&&(d=!1)}this.scene.cache.json.get("unitData").melee.forEach(p=>{i.push({originData:p,unitType:L.MELEE_UNIT_TYPE,isUnlock:p.level<=h,currentAdWatched:r[p.level-1],targetAdWatched:!o&&p.level>=a?Q9[p.level-1]:-1,isUnitBoardFull:n,isCanBuy:p.level===1&&d,coinNeed:c,updateDataCallback:this.updateListConfig,showAdsCallback:this.handleShowRewardedVideoAd,collectCallback:this.handleCollectUnit})})}else if(e===L.RANGED_UNIT_TYPE){let h=de.getPlayerUnlockedRangedLevel();(!h||typeof h!="number")&&(h=1);let l=Se.inst.getCoin(),c=new be(0),d=!0;if(s instanceof oe){let p=s.unitManager.getPlayerRangedSpawnedUnitsCount();c=s.coinManager.getUnitPrice(p)}if(l.smallerThan(c)){let p=l.toString(),m=c.toString();p!==m&&(d=!1)}this.scene.cache.json.get("unitData").ranged.forEach(p=>{i.push({originData:p,unitType:L.RANGED_UNIT_TYPE,isUnlock:p.level<=h,currentAdWatched:r[p.level-1],targetAdWatched:!o&&p.level>=a?Q9[p.level-1]:-1,isUnitBoardFull:n,isCanBuy:p.level===1&&d,coinNeed:c,updateDataCallback:this.updateListConfig,showAdsCallback:this.handleShowRewardedVideoAd,collectCallback:this.handleCollectUnit})})}else console.error("Unknown type: ",e);return i}getAdWatchedCount(e){let i=de.getPlayerAdWatchedCount(),s={},r=0;if(e===L.MELEE_UNIT_TYPE)s=i.MELEE,r=e7;else if(e===L.RANGED_UNIT_TYPE)s=i.RANGED,r=CPe;else{console.error("Unknown type: ",e);let a=[];for(let o=0;o<r;o++)a.push(0);return a}let n=[];for(let[a,o]of Object.entries(s)){let h=parseInt(a);if(h>r||h<1)break;n[h-1]=o}return n.forEach((a,o)=>{a===void 0&&(console.error("Undefined ad watched count for level: ",o+1),n[o]=0)}),n}createUnitPopup(){this.unitPopup=new $9(this.scene),this.unitPopup.setName("UnitPopup"),this.unitPopup.onClose=this.handleCloseScreen,t7.Align.In.Center(this.unitPopup,this,0,-20),this.add(this.unitPopup),this.unitPopup.tabs.dinosaursBtn.onClick=this.handleSelectDinosaursTab,this.unitPopup.tabs.warriorsBtn.onClick=this.handleSelectWarriorsTab}handleSelectDinosaursTab=()=>{this.isSwitchable&&(this.isSwitchable=!1,this.selectDinosaursTab())};handleSelectWarriorsTab=()=>{this.isSwitchable&&(this.isSwitchable=!1,this.selectWarriorsTab())};handleCloseScreen=()=>{this.runFadeOutAnimation()};runPopupAnimation(){let e=this.showPopupAnimController.renew();H.runTween(this.scene.tweens.add({...He,paused:!0,targets:this.unitPopup}),e)}runFadeOutAnimation(){let e=this.fadeOutAnimController.renew();H.runTween(this.scene.tweens.add({targets:this.background,duration:200,ease:i7.Cubic.Out,props:{alpha:{start:.7,from:.7,to:0}},onActive:()=>{this.unitPopup.kill()},onUpdate:(i,s)=>{W.getGlobalScene()?.requestBackgroundMaskUpdate(O.UNITS_SCREEN,s.alpha)},onComplete:()=>{this.unitPopup.revive(),this.background.setAlpha(.7),k.closeScreen(this.name)}}),e)}updateListConfig=(e,i,s)=>{let r={MELEE:{},RANGED:{}};try{r=this.mergeAndGetAdWatchedCountConfig(e,i,s)}catch(n){console.error(n)}wPe.setGameData({unitScreenAdWatchedCount:r}),this.unitPopup.updateListConfigMember(e,i,s)};mergeAndGetAdWatchedCountConfig(e,i,s){if(i===void 0||s===void 0)return{MELEE:{},RANGED:{}};if(e===L.MELEE_UNIT_TYPE&&i<=e7&&i>0)return{MELEE:{[i]:s},RANGED:{}};if(e===L.RANGED_UNIT_TYPE)return{MELEE:{},RANGED:{[i]:s}};throw Error(`Unknown type in Get Ad Watched Config: ${e}`)}handleShowRewardedVideoAd=async()=>{if(this.isShowingAds)return!1;let e=!1;return this.isShowingAds=!0,await ae.showRewardVideoAdAsync()&&(q.playSound(J.DAILY_REWARD),e=!0),this.isShowingAds=!1,e};handleCollectUnit=(e,i,s=!1)=>{let r=this.scene.scene.get(z.GAME_SCENE),n=!1;return r instanceof oe&&(e===L.MELEE_UNIT_TYPE?n=r.spawnUnit("MELEE",!0,i,s):n=r.spawnUnit("RANGED",!0,i,s)),this.handleCloseScreen(),n}},_l=D0;var s7=E(X()),r7=E(he()),{KEY:RPe,FRAME:PPe}=T.GAMEPLAY,B0=class extends s7.Container{emitter;constructor(e){super(e),this.createEmitters(),this.setActive(!1),this.setVisible(!1),this.scene.add.existing(this)}createEmitters(){let e=1/I.getPixelRatio();this.emitter=this.scene.make.particles({key:RPe,config:{frame:PPe.DASHBOARD_COINBAR_COIN,gravityY:160,angle:{min:-180,max:0},speed:{min:50,max:200},scale:{min:e*.8,max:e*.8},alpha:{start:1,end:0,ease:r7.Expo.In},lifespan:1500}}),this.add(this.emitter),this.emitter.stop()}explode(e,i,s){this.setActive(!0),this.setVisible(!0),this.emitter.explode(e,i,s)}kill(){super.kill(),this.emitter.stop()}revive(){super.revive(),this.emitter.start()}},n7=B0;var A7=E(X());var a7=E(mt());var{KEY:ma,FRAME:va}=T.EFFECTS,_Pe={CONFETTI_HEXAGON:{KEY:"confetti-hexagon-animation",TEXTURE:ma,PREFIX:va.FX_CONFETTI_HEXAGON,FRAME_RATE:8,END:5,ZERO_PAD:0},CONFETTI_STAR_X:{KEY:"confetti-star-x",TEXTURE:ma,PREFIX:va.ANIMATION_STAR_X,FRAME_RATE:4,END:4,ZERO_PAD:0},CONFETTI_STAR_Y:{KEY:"confetti-star-y",TEXTURE:ma,PREFIX:va.ANIMATION_STAR_Y,FRAME_RATE:4,END:4,ZERO_PAD:0},RIBBON_A:{KEY:"animation-ribbon-a",TEXTURE:ma,PREFIX:va.PREFIX_ANIMATION_RIBBON_CONFETTI_A,FRAME_RATE:16,END:3,ZERO_PAD:0},RIBBON_B:{KEY:"animation-ribbon-b",TEXTURE:ma,PREFIX:va.PREFIX_ANIMATION_RIBBON_CONFETTI_B,FRAME_RATE:16,END:4,ZERO_PAD:0},RIBBON_C:{KEY:"animation-ribbon-c",TEXTURE:ma,PREFIX:va.PREFIX_ANIMATION_RIBBON_CONFETTI_C,FRAME_RATE:16,END:4,ZERO_PAD:0},RIBBON_D:{KEY:"animation-ribbon-d",TEXTURE:ma,PREFIX:va.PREFIX_ANIMATION_RIBBON_CONFETTI_D,FRAME_RATE:16,END:4,ZERO_PAD:0}},ye=_Pe;var{KEY:IPe,TEXTURE:LPe,FRAME_RATE:MPe,END:OPe,PREFIX:DPe,ZERO_PAD:BPe}=ye.RIBBON_A,U0=class extends a7.Animation{constructor(e){let i={repeat:-1,frameRate:MPe,frames:e.generateFrameNames(LPe,{prefix:DPe,end:OPe,zeroPad:BPe,start:1}),yoyo:!0,showOnStart:!0};super(e,IPe,i)}},o7=U0;var h7=E(mt());var{KEY:UPe,TEXTURE:NPe,FRAME_RATE:FPe,END:kPe,PREFIX:GPe,ZERO_PAD:qPe}=ye.RIBBON_B,N0=class extends h7.Animation{constructor(e){let i={repeat:-1,frameRate:FPe,frames:e.generateFrameNames(NPe,{prefix:GPe,end:kPe,zeroPad:qPe,start:1}),yoyo:!0,showOnStart:!0};super(e,UPe,i)}},l7=N0;var u7=E(mt());var{KEY:WPe,TEXTURE:YPe,FRAME_RATE:HPe,END:zPe,PREFIX:VPe,ZERO_PAD:XPe}=ye.RIBBON_C,F0=class extends u7.Animation{constructor(e){let i={repeat:-1,frameRate:HPe,frames:e.generateFrameNames(YPe,{prefix:VPe,end:zPe,zeroPad:XPe,start:1}),yoyo:!0,showOnStart:!0};super(e,WPe,i)}},c7=F0;var d7=E(mt());var{KEY:KPe,TEXTURE:ZPe,FRAME_RATE:jPe,END:$Pe,PREFIX:JPe,ZERO_PAD:QPe}=ye.RIBBON_D,k0=class extends d7.Animation{constructor(e){let i={repeat:-1,frameRate:jPe,frames:e.generateFrameNames(ZPe,{prefix:JPe,end:$Pe,zeroPad:QPe,start:1}),yoyo:!0,showOnStart:!0};super(e,KPe,i)}},f7=k0;var p7=E(mt());var{KEY:e_e,TEXTURE:t_e,FRAME_RATE:i_e,END:s_e,PREFIX:r_e,ZERO_PAD:n_e}=ye.CONFETTI_STAR_X,G0=class extends p7.Animation{constructor(e){let i={repeat:-1,frameRate:i_e,frames:e.generateFrameNames(t_e,{prefix:r_e,end:s_e,zeroPad:n_e,start:1}),yoyo:!0,showOnStart:!0};super(e,e_e,i)}},m7=G0;var v7=E(mt());var{KEY:a_e,TEXTURE:o_e,FRAME_RATE:h_e,END:l_e,PREFIX:u_e,ZERO_PAD:c_e}=ye.CONFETTI_STAR_Y,q0=class extends v7.Animation{constructor(e){let i={repeat:-1,frameRate:h_e,frames:e.generateFrameNames(o_e,{prefix:u_e,end:l_e,zeroPad:c_e,start:1}),yoyo:!0,showOnStart:!0};super(e,a_e,i)}},g7=q0;var S7=E(X()),Fo=E(ve()),W0=class extends S7.Particles.Particle{ribbon;graphics;colorUse;lastChange;currentFrame;isYoyo;isGravityChanged;points;constructor(e){super(e);let{x:i,y:s}=this.emitter;this.points=new Array(10).fill(null).map(()=>({x:this.x+i,y:this.y+s})),this.isYoyo=!1,this.isGravityChanged=!1,this.lastChange=0,this.currentFrame=-1,this.createGraphics(),this.randomRibbonUsedWhenFall()}randomRibbonUsedWhenFall(){switch((0,Fo.Between)(0,3)){case 0:this.ribbon=this.scene.anims.get(ye.RIBBON_A.KEY);break;case 1:this.ribbon=this.scene.anims.get(ye.RIBBON_B.KEY);break;case 2:this.ribbon=this.scene.anims.get(ye.RIBBON_C.KEY);break;case 3:this.ribbon=this.scene.anims.get(ye.RIBBON_D.KEY);break;default:this.ribbon=this.scene.anims.get(ye.RIBBON_A.KEY);break}}setRibbonPosition(e,i){this.points.map(s=>{s.x=e,s.y=i})}createGraphics(){let e=[8443204,2928867,12013036,16376097,15285798];this.colorUse=e[(0,Fo.Between)(0,e.length-1)],this.graphics=this.scene.add.graphics({lineStyle:{width:3,color:this.colorUse}});let{x:i,y:s,depth:r}=this.emitter;this.graphics.setDepth(r),this.graphics.setPosition(i,s),this.emitter.parentContainer.add(this.graphics)}update(e,i,s){let r=super.update(e,i,s);return this.updateFrames(e),this.updatePoints(),this.updateGraphics(),this.updateGravity(),this.updateVelocity(),this.updateColor(),r}updateFrames(e){this.lastChange+=e,this.lastChange>=this.ribbon.msPerFrame&&(this.isYoyo?this.currentFrame--:this.currentFrame++,this.currentFrame<0&&(this.isYoyo=!1,this.currentFrame=1),this.currentFrame>=this.ribbon.frames.length&&(this.isYoyo=!0,this.currentFrame-=1),this.frame=this.ribbon.frames[this.currentFrame].frame,this.lastChange-=this.ribbon.msPerFrame)}updatePoints(){this.graphics.visible&&(this.points.shift(),this.points.push({x:this.x,y:this.y}))}updateGraphics(){if(this.graphics.visible){for(let e of this.points)if(e.y===0)return;this.graphics.clear(),this.graphics.strokePoints(this.points)}}updateGravity(){this.lifeCurrent>this.life-2e3||this.isGravityChanged||(this.isGravityChanged=!0,this.graphics.destroy(),this.emitter.setVisible(!0),this.emitter.setParticleGravity(0,45))}updateVelocity(){if(this.graphics.visible){if(this.lifeCurrent>this.life-1800){this.velocityX+=(0,Fo.Between)(-12,12);return}this.velocityX>0?this.velocityX+=(0,Fo.Between)(-10,6):this.velocityX+=(0,Fo.Between)(-6,10)}}updateColor(){this.graphics.visible||(this.tint=this.colorUse)}},E7=W0;var T7=E(X()),ko=E(ve()),Y0=class extends T7.Particles.Particle{isYoyo;isGravityChanged;lastChange;currentFrame;star;starX;starY;constructor(e){super(e),this.isYoyo=!1,this.isGravityChanged=!1,this.lastChange=0,this.currentFrame=-1,this.starX=this.scene.anims.get(ye.CONFETTI_STAR_X.KEY),this.starY=this.scene.anims.get(ye.CONFETTI_STAR_Y.KEY),this.star=this.starX}update(e,i,s){let r=super.update(e,i,s);return this.updateGravity(),this.updateVelocity(),this.updateFrameRate(),this.updateFrames(e),r}updateGravity(){this.lifeCurrent>this.life-2e3||this.isGravityChanged||(this.isGravityChanged=!0,this.emitter.setParticleGravity(0,15),this.emitter.setParticleSpeed(0))}updateVelocity(){this.lifeCurrent>this.life-2e3||(this.velocityX>0?this.velocityX+=(0,ko.Between)(-6,3):this.velocityX+=(0,ko.Between)(-3,6))}updateFrames(e){if(this.lastChange+=e,this.lastChange>=this.star.msPerFrame){let i=ko.RND.between(0,1);this.star=i>0?this.starX:this.starY,this.isYoyo?this.currentFrame--:this.currentFrame++,this.currentFrame<0&&(this.isYoyo=!1,this.currentFrame=1,this.emitter.setAlpha(1)),this.currentFrame>=this.star.frames.length&&(this.isYoyo=!0,this.currentFrame-=1,this.emitter.setAlpha(.8)),this.frame=this.star.frames[this.currentFrame].frame,this.lastChange-=this.star.msPerFrame}}updateFrameRate(){this.lifeCurrent<this.life-2e3?this.star.msPerFrame=150:this.star.msPerFrame=ko.RND.between(300,600)}},y7=Y0;var{KEY:Zd,FRAME:b7}=T.EFFECTS,H0=class extends A7.Container{emitterConfetti;emitterRibbons;ribbonConfig;confettiConfig;constructor(e){super(e),this.emitterRibbons=[],this.emitterConfetti=[],this.createConfigs(),this.createAnimations(),this.scene.add.existing(this)}createConfigs(){let e=[8443204,2928867,12013036,16376097,15285798];this.ribbonConfig={duration:100,visible:!1,timeScale:1.5,frame:b7.BLANK,particleBringToTop:!0,speedY:{min:-480,max:-560},gravityY:290,lifespan:{min:4e3,max:6e3},rotate:{start:0,end:360*5,random:!0},scale:{min:.6,max:1},particleClass:E7};let i=b7.PREFIX_ANIMATION_RIBBON_CONFETTI_A;this.confettiConfig={duration:100,delay:200,timeScale:2,tint:e,particleBringToTop:!0,frame:`${i}1`,speedY:{min:-460,max:-580},gravityY:280,lifespan:{min:5e3,max:8e3},rotate:{start:0,end:360*3},scale:{min:.6,max:1},particleClass:y7}}createAnimations(){if(!this.scene.anims.get(ye.CONFETTI_STAR_X.KEY)){let e=new m7(this.scene.anims);this.scene.anims.add(ye.CONFETTI_STAR_X.KEY,e)}if(!this.scene.anims.get(ye.CONFETTI_STAR_Y.KEY)){let e=new g7(this.scene.anims);this.scene.anims.add(ye.CONFETTI_STAR_Y.KEY,e)}if(!this.scene.anims.get(ye.RIBBON_A.KEY)){let e=new o7(this.scene.anims);this.scene.anims.add(ye.RIBBON_A.KEY,e)}if(!this.scene.anims.get(ye.RIBBON_B.KEY)){let e=new l7(this.scene.anims);this.scene.anims.add(ye.RIBBON_B.KEY,e)}if(!this.scene.anims.get(ye.RIBBON_C.KEY)){let e=new c7(this.scene.anims);this.scene.anims.add(ye.RIBBON_C.KEY,e)}if(!this.scene.anims.get(ye.RIBBON_D.KEY)){let e=new f7(this.scene.anims);this.scene.anims.add(ye.RIBBON_D.KEY,e)}}run(e,i,s,r){this.setPosition(e,i),this.width=s,this.height=r,this.createEmitters();for(let n of this.emitterConfetti)n.emitParticle(25);for(let n of this.emitterRibbons)n.emitParticle(20)}stop(){for(let e of this.emitterConfetti)e.killAll();for(let e of this.emitterRibbons)e.killAll();this.kill()}createEmitters(){this.emitterRibbons=[],this.emitterConfetti=[],this.createConfettiLeftEmitter(),this.createConfettiRightEmitter(),this.createRibbonLeftEmitter(),this.createRibbonRightEmitter()}createConfettiLeftEmitter(){let{height:e}=this,i=e/667*1.1,s={...this.confettiConfig,speedX:{min:5,max:90},speedY:{min:-460*i,max:-580*i},gravityY:280*i},r=this.scene.add.particles(0,0,Zd,s);this.add(r),this.emitterConfetti.push(r),r.stop()}createConfettiRightEmitter(){let{width:e,height:i}=this,s=i/667*1.1,r={...this.confettiConfig,speedX:{min:-5,max:-90},speedY:{min:-460*s,max:-580*s},gravityY:280*s},n=this.scene.add.particles(e,0,Zd,r);this.add(n),this.emitterConfetti.push(n),n.stop()}createRibbonLeftEmitter(){let{height:e}=this,i=e/667*1.1,s={...this.ribbonConfig,speedX:{min:20,max:80},speedY:{min:-480*i,max:-560*i},gravityY:290*i},r=this.scene.add.particles(0,0,Zd,s);this.add(r),this.emitterRibbons.push(r),r.stop()}createRibbonRightEmitter(){let{width:e,height:i}=this,s=i/667*1.1,r={...this.ribbonConfig,speedX:{min:-20,max:-80},speedY:{min:-480*s,max:-560*s},gravityY:290*s},n=this.scene.add.particles(e,0,Zd,r);this.add(n),this.emitterRibbons.push(n),n.stop()}killAllParticles(){this.emitterConfetti.forEach(e=>{e.forEachAlive(i=>{i.lifeCurrent=0},this)}),this.emitterRibbons.forEach(e=>{e.forEachAlive(i=>{i.lifeCurrent=0},this)})}},x7=H0;var C7=E(X());var jd=E(he()),{language:vn}=codex,{KEY:Go,FRAME:qo}=T.DEFAULT_8_BIT,{Utils:{Signal:d_e}}=Ludex,z0=class extends C7.Container{continueButton;coinText;getText;winContainer;loseContainer;postAdContinueAnimation;replayButton;postAdReplayAnimation;returnButton;postAdReturnAnimation;openAnimController=new d_e.SignalController;mode="NORMAL";constructor(e){super(e),this.setName("Footer"),this.createContinueButton(),this.createReplayButton(),this.createReturnButton(),this.scene.add.existing(this)}createContinueButton(){this.continueButton=new Nd(this.scene,{key:Go,frame:qo.RESULT_SCREEN_YELLOW_BUTTON,width:129,height:46}),this.continueButton.setName("Continue"),this.add(this.continueButton),this.createContinueWinContainer(),this.createContinueLoseContainer()}createContinueWinContainer(){let e=this.scene.make.container({});e.setSize(this.continueButton.width,this.continueButton.height),this.winContainer=e,this.continueButton.add(this.winContainer);let i=vn.getCurrentLocale(),s=18,r=-14;switch(i){case"ja":s=16,r=-12;break;case"zh":s=16,r=-12;break}this.getText=P.buildText(vn.getText("GET").toUpperCase(),s).setDefaultStroke().setDefaultShadow({offsetX:-2,offsetY:2}).build(this.scene),this.getText.setPosition(0,r),e.add(this.getText);let n=this.scene.make.image({key:Go,frame:qo.RESULT_SCREEN_SINGLE_COIN_ICON});n.setWorldSize(16,16),e.add(n),n.setPosition(-40,7);let a=P.buildText("0",18).setColor("#eecf00").setDefaultStroke().setDefaultShadow({offsetX:-2,offsetY:2}).build(this.scene);a.setPosition(0,5),e.add(a),this.coinText=a}createContinueLoseContainer(){let e=this.scene.make.container({});e.setSize(this.continueButton.width,this.continueButton.height),this.loseContainer=e,this.continueButton.add(this.loseContainer);let i=vn.getCurrentLocale(),s=20;switch(i){case"pt":s=18;break;case"de":s=18;break}let r=P.buildText(vn.getText("CLAIM").toUpperCase(),s).setDefaultStroke().setDefaultShadow({offsetX:-2,offsetY:2}).build(this.scene);r.setPosition(0,-5),e.add(r)}createReplayButton(){this.replayButton=new fe(this.scene,Go,qo.RESULT_SCREEN_GREEN_BUTTON,129,46),this.replayButton.setName("BattleReplay");let e=P.buildText(vn.getText("REPLAY").toUpperCase(),15).setDefaultStroke().setDefaultShadow({offsetX:-2,offsetY:2}).build(this.scene);e.setPosition(15,-5),this.replayButton.add(e);let i=this.scene.make.image({key:Go,frame:qo.ICON_REPLAY});i.setWorldSize(23.5,27.5),i.setPosition(-40,-3),this.replayButton.add(i),this.replayButton.setX(-70),this.add(this.replayButton)}createReturnButton(){this.returnButton=new fe(this.scene,Go,qo.RESULT_SCREEN_YELLOW_BUTTON,129,46),this.returnButton.setName("BackToSinglePlay");let e=P.buildText(vn.getText("BACK_TO_SINGLEPLAY").toUpperCase(),15).setDefaultStroke().setDefaultShadow({offsetX:-2,offsetY:2}).build(this.scene);e.setPosition(15,-5),this.returnButton.add(e);let i=this.scene.make.image({key:Go,frame:qo.ICON_BACK_TO});i.setWorldSize(28.5,20.5),i.setPosition(-45,-2),this.returnButton.add(i),this.returnButton.setX(70),this.add(this.returnButton)}set onClickContinueBtn(e){this.continueButton.onClick=e}set onClickReplayBtn(e){this.replayButton.onClick=e}set onClickReturnBtn(e){this.returnButton.onClick=e}setMode(e,i,s){this.continueButton.setY(0),this.continueButton.setScale(1),this.replayButton.setPosition(-70,0),this.replayButton.setScale(1),this.returnButton.setPosition(70,0),this.returnButton.setScale(1),e==="BATTLE"?(this.replayButton.revive(),this.returnButton.revive(),this.continueButton.kill()):(this.replayButton.kill(),this.returnButton.kill(),this.continueButton.revive(),s==="win"?(this.winContainer.revive(),this.loseContainer.kill(),this.coinText.setText(i.toString()),this.getText.setText(vn.getText("GET"))):(this.winContainer.kill(),this.loseContainer.revive(),this.getText.setText(vn.getText("CLAIM")))),this.mode=e}setCoinText(e){this.winContainer.revive(),this.loseContainer.kill(),this.coinText.setText(e)}runAnimation(e){if(this.mode!=="BATTLE")return;let i=this.openAnimController.renew();this.returnButton.setAlpha(0),this.replayButton.setAlpha(0),H.runTween(this.scene.tweens.add({...$r,paused:!0,targets:[this.replayButton,this.returnButton],delay:e,duration:400,props:{alpha:{from:0,to:1}},onComplete:()=>{this.returnButton.setAlpha(1),this.replayButton.setAlpha(1)}}),i)}runPostAnimation(e){if(this.mode==="BATTLE"){this.openAnimController.abort(),this.postAdReplayAnimation?.stop(),this.postAdReplayAnimation?.remove(),this.postAdReturnAnimation?.stop(),this.postAdReturnAnimation?.remove(),this.replayButton.setDisabled(!0),this.replayButton.setAlpha(1);let i=this.replayButton.x;this.postAdReplayAnimation=this.scene.tweens.add({targets:this.replayButton,duration:500,delay:e,y:{from:0,to:-70},x:{from:i,to:i-15},scale:{from:this.replayButton.scale,to:this.replayButton.scale*1.2},ease:jd.Quintic.Out,onComplete:()=>{this.replayButton.setDisabled(!1)}}),this.returnButton.setDisabled(!0),this.returnButton.setAlpha(1);let s=this.returnButton.x;this.postAdReturnAnimation=this.scene.tweens.add({targets:this.returnButton,duration:500,delay:e,y:{from:0,to:-70},x:{from:s,to:s+15},scale:{from:this.returnButton.scale,to:this.returnButton.scale*1.2},ease:jd.Quintic.Out,onComplete:()=>{this.returnButton.setDisabled(!1)}})}else{this.postAdContinueAnimation?.stop(),this.postAdContinueAnimation?.remove(),this.continueButton.setDisabled(!0),this.continueButton.setAlpha(1);let{scale:i}=this.continueButton;this.postAdContinueAnimation=this.scene.tweens.add({targets:this.continueButton,duration:500,delay:e,y:{from:0,to:-70},scale:{from:i,to:i*2},ease:jd.Quintic.Out,onComplete:()=>{this.continueButton.setDisabled(!1)}})}}},w7=z0;var _7=E(X());var V0=E(ve()),I7=E(ie()),{KEY:R7,FRAME:P7}=T.DEFAULT_8_BIT,X0=class extends _7.Container{wheelArrow;luckSpinMilestones;luckSpinRewards;spinningTween;constructor(e){super(e,0,0),this.createWheelBackground(),this.createWheelArrow(),this.scene.add.existing(this)}createWheelBackground(){let e=this.scene.make.image({key:R7,frame:P7.WHEEL_LUCKY_SPIN,origin:{x:.5,y:.5}});this.scene.add.existing(e),this.add(e),e.setPosition(0,-35),this.createText("x2",-53,-25),this.createText("x3",-6,-60),this.createText("x4",37,-50),this.createText("x5",55,-15)}createText(e,i,s){let r=P.buildText(e,22).setDefaultStroke().setDefaultShadow({offsetX:-1,offsetY:1}).build(this.scene);this.add(r),r.setPosition(i,s)}createWheelArrow(){this.wheelArrow=this.scene.make.image({key:R7,frame:P7.WHEEL_ARROW}),this.wheelArrow.setWorldSize(17,26),this.add(this.wheelArrow),I7.Align.In.Center(this.wheelArrow,this,0,-25),this.luckSpinMilestones=[-30,16,59],this.luckSpinRewards=[2,3,4,5]}startWheelSpinning(){this.spinningTween?.stop(),this.spinningTween?.remove();let e=k.getScreen(O.RESULT_SCREEN);e instanceof $d&&(this.spinningTween=this.scene.tweens.addCounter({from:(0,V0.DegToRad)(-90),to:(0,V0.DegToRad)(90),onUpdate:i=>{let s=i.getValue();this.wheelArrow.setRotation(s);let r=Math.sin(s)*29,n=Math.cos(s)*-29;this.wheelArrow.setPosition(r,n),e?.updateCoinText(this.getCurrentMultiplierResult())},yoyo:!0,duration:625,repeat:-1}))}stopWheelSpinning(){this.spinningTween?.stop()}getCurrentMultiplierResult(){for(let e=0;e<this.luckSpinMilestones.length;e++){let i=this.luckSpinMilestones[e];if(this.wheelArrow.angle<=i)return this.luckSpinRewards[e]}return this.luckSpinRewards[this.luckSpinRewards.length-1]}handleOnOpen(){this.startWheelSpinning()}handleOnClose(){this.stopWheelSpinning()}},L7=X0;var K0=E(qe()),Ii=E(ie()),Jd=E(ve()),Z0=E(he());var{Plugins:{Ads:{Types:{REWARDED_VIDEO:f_e}}},Configs:{Ads:{Enabled:p_e}},Utils:{Signal:m_e}}=Ludex,{language:$s}=codex,{KEY:v_e,FRAME:g_e}=T.DEFAULT_8_BIT,{KEY:Il,FRAME:Pr}=T.DEFAULT_8_BIT,{MULTIPLY_REWARD_BATTLE:S_e,MULTIPLY_REWARD_ROUND:E_e}=L,j0=class extends De{baseValue;rewardWheel;coinText;coinIcon;claimCoinText;claimText;resultText;levelCompletedText;ribbon;shineFx;collectButton;footerContainer;openAnimController=new m_e.SignalController;postAdCollectAnimation;fxSpinAnimation;fxScaleAnimation;coinTextAnimation;confettiAnimation;adsTimer;isRewardCollected;coinExplodeEffect;constructor(e,i){super(e,i),this.scene=e,this.background.setAlpha(.9),this.setDepth(At.SCREEN),this.createContent(),this.createEffect()}createEffect(){this.coinExplodeEffect=new n7(this.scene),this.coinExplodeEffect.setDepth(At.SCREEN+1),this.confettiAnimation=new x7(this.scene),this.confettiAnimation.setDepth(At.SCREEN+1)}open(e){super.open(e);let i=I.isLandscape();this.setScale(i?.83:1),this.background.setScale(i?1.2:1),W.getGlobalScene()?.requestBackgroundMaskUpdate(O.RESULT_SCREEN,this.background.alpha);let r=this.getData("coinRewarded");this.baseValue=r,this.updateScreen(),p_e?(this.collectButton.revive(),ae.isReadyAdShowable(f_e)?(this.collectButton.setDisabled(!1),this.collectButton.setAlpha(1)):(this.collectButton.setDisabled(!0),this.collectButton.setAlpha(.5)),this.rewardWheel.revive(),this.rewardWheel.handleOnOpen()):(this.collectButton.kill(),this.rewardWheel.kill()),this.runOpenAnimation()}closeScreen=()=>{this.stopShineFxTween(),this.rewardWheel.handleOnClose(),this.confettiAnimation.killAllParticles();let e=this.getData("result");if(!this.isRewardCollected){let s=this.scene.scene.get(z.GAME_SCENE);s instanceof oe&&e==="win"&&s.rewardWinCoin(1)}W.getGlobalScene()?.requestBackgroundMaskUpdate(O.RESULT_SCREEN,0),k.closeScreen(this.name),q.playSound(J.NEXT_ROUND_EFFECT)};updateScreen(){let e=this.baseValue.toString();this.coinText.setText(`+${e}`),this.isRewardCollected=!1,this.coinIcon.setPosition(this.coinText.displayWidth/2+10,this.coinIcon.y);let i=this.getData("mode"),s=this.getData("result");if(this.footerContainer.setMode(i,this.baseValue,s),s==="lose")this.resultText.setText($s.getText("FAILED")),this.ribbon.setFrame(Pr.RESULT_SCREEN_RIBBON_LOSE),this.shineFx.setFrame(Pr.RESULT_SCREEN_FX_LOSE),this.levelCompletedText.setText("");else if(s==="win"){this.runConfetti(),this.resultText.setText($s.getText("VICTORY")),this.ribbon.setFrame(Pr.RESULT_SCREEN_RIBBON_WIN),this.shineFx.setFrame(Pr.RESULT_SCREEN_FX_WIN);let r=E_e;if(this.scene instanceof oe){let{gameMode:n}=this.scene;n===ne.BATTLE&&(r=S_e)}this.levelCompletedText.setText(`${$s.getText("LEVEL_COMPLETED_BONUS_X").toUpperCase()}${r}`)}}runConfetti(){let{width:e,height:i}=I.getWorldSize();this.confettiAnimation.run(0,i/2,0,i*.9)}handleOnCollect=()=>{this.viewAdsReward()};viewAdsReward=async()=>{this.rewardWheel.handleOnClose(),await ae.showRewardVideoAdAsync()&&this.onWheelEnding()};onWheelEnding=()=>{this.runCoinTextAnimation();let e=this.rewardWheel.getCurrentMultiplierResult(),i=this.getData("result"),s=this.scene.scene.get(z.GAME_SCENE);i==="lose"?s.rewardLostCoin(e):i==="win"&&s.rewardWinCoin(e);let r=this.baseValue.clone();r.multiply(e),this.footerContainer.setCoinText(r.toString()),this.isRewardCollected=!0};createContent(){this.createCollectButton(),this.createFx(),this.createFooter(),this.createLevelCompleteText(),this.createGoldText(),this.createGoldIcon(),this.createEarnText(),this.createRibbon(),this.createRewardWheel()}createCollectButton(){let e=$s.getCurrentLocale();this.collectButton=new fe(this.scene,Il,Pr.RESULT_SCREEN_GREEN_BUTTON_RESULT,181,71),this.collectButton.setName("ClaimWithAds"),this.add(this.collectButton);let i=30,s=-18,r=13,n=10;switch(e){case"ru":i=20,s=-15,r=3;break;case"es":i=21;break;case"pt":i=25;break;case"ja":i=25,s=-20,n=8;break;case"zh":i=25,r=25,s=-13;break;case"tr":i=22,r=11;break;case"fr":i=20;break;case"id":i=25;break;case"de":i=18,r=6;break;case"it":i=23,r=8;break}let a=P.buildText(`${$s.getText("GET")} x5`,i).setDefaultStroke().setDefaultShadow({offsetX:-2,offsetY:3}).build(this.scene);this.claimText=a,this.collectButton.add(a),wl.alignChildCenter(a,this.collectButton,r,s);let o=this.scene.make.image({key:v_e,frame:g_e.ICON_AD});o.setWorldSize(25.5,27),this.collectButton.add(o),Ii.Align.In.Center(o,this.collectButton,-60,-5);let h=this.scene.make.image({key:Il,frame:Pr.RESULT_SCREEN_SINGLE_COIN_ICON});h.setWorldSize(16,16),this.collectButton.add(h),Ii.Align.In.Center(h,this.collectButton,-15,13),this.claimCoinText=P.buildText("0",17).setColor("#e4c701").setDefaultStroke().setDefaultShadow({offsetX:-2,offsetY:2}).build(this.scene),this.collectButton.add(this.claimCoinText),wl.alignChildCenter(this.claimCoinText,this.collectButton,22,n),Ii.Align.In.Center(this.collectButton,this,0,100),this.collectButton.onClick=this.handleOnCollect}createFooter(){this.footerContainer=new w7(this.scene),this.add(this.footerContainer),this.footerContainer.onClickContinueBtn=this.handleClickContinueBtn,this.footerContainer.onClickReplayBtn=this.handleClickReplayBtn,this.footerContainer.onClickReturnBtn=this.handleClickContinueBtn,Ii.Align.In.Center(this.footerContainer,this.collectButton,0,130)}handleClickContinueBtn=()=>{let e=this.scene.scene.get(z.GAME_SCENE),i=this.getData("result"),s=this.getData("mode");e.events.once(K0.RESUME,()=>{e instanceof oe&&(s===ne.NORMAL&&i==="lose"?e.replayRound():e.nextRound())}),this.closeScreen()};handleClickReplayBtn=()=>{let e=this.scene.scene.get(z.GAME_SCENE);e.events.once(K0.RESUME,()=>{e instanceof oe&&e.replayRound()}),this.closeScreen()};createLevelCompleteText(){this.levelCompletedText=P.buildText(`${$s.getText("LEVEL_COMPLETED_BONUS_X").toUpperCase()}5`,18).setColor("#eecf00").setDefaultStroke().setDefaultShadow({offsetX:-1,offsetY:1}).build(this.scene),this.add(this.levelCompletedText),Ii.Align.In.Center(this.levelCompletedText,this,0,-80),this.levelCompletedText.setScale(this.collectButton.scaleX,this.collectButton.scaleY)}createGoldIcon(){this.coinIcon=this.scene.make.image({key:Il,frame:Pr.RESULT_SCREEN_GOLD_ICON}),this.coinIcon.setWorldSize(55,39.5),this.add(this.coinIcon),Ii.Align.In.Center(this.coinIcon,this,this.coinText.displayWidth/2,-120)}createGoldText(){this.coinText=P.buildText("+0",32).setDefaultStroke().setDefaultShadow({offsetX:-2,offsetY:2}).build(this.scene),this.add(this.coinText),Ii.Align.In.Center(this.coinText,this,-20,-125)}createEarnText(){let e=P.buildText($s.getText("YOU_EARNED").toUpperCase(),18).setDefaultStroke().setDefaultShadow({offsetX:-3,offsetY:1}).build(this.scene);this.add(e),Ii.Align.In.Center(e,this,0,-180),e.setScale(this.collectButton.scaleX,this.collectButton.scaleY)}createFx(){this.shineFx=this.scene.make.image({key:Il,frame:Pr.RESULT_SCREEN_FX_WIN}),this.add(this.shineFx),this.shineFx.setWorldSize(375,407),Ii.Align.In.Center(this.shineFx,this,0,-120)}createRibbon(){let e=$s.getCurrentLocale(),i=-7;switch(e){case"ja":i=-10;break}this.ribbon=this.scene.make.image({key:Il,frame:Pr.RESULT_SCREEN_RIBBON_WIN}),this.add(this.ribbon),this.ribbon.setWorldSize(280,50),Ii.Align.In.Center(this.ribbon,this,2,-240),this.resultText=P.buildText($s.getText("VICTORY").toUpperCase(),24).setDefaultStroke().setDefaultShadow({offsetX:-3,offsetY:2}).build(this.scene),this.add(this.resultText),Ii.Align.In.Center(this.resultText,this.ribbon,3,i)}createRewardWheel(){this.rewardWheel=new L7(this.scene),this.add(this.rewardWheel),Ii.Align.In.Center(this.rewardWheel,this,0,40)}runOpenAnimation(){let e=this.openAnimController.renew();this.collectButton.setAlpha(1);let i=this.list.filter(r=>r!==this.background&&r!==this.footerContainer),s=i.map(r=>r.alpha);i.forEach(r=>r.setAlpha(0)),H.runTween(this.scene.tweens.add({...$r,paused:!0,targets:i,duration:400,props:{alpha:{getStart:()=>0,getEnd:(r,n,a,o)=>s[o]}},onComplete:()=>{this.runShineFxTween()}}),e),this.footerContainer.runAnimation(2500)}runShineFxTween(){let e=this.getData("result");this.fxSpinAnimation=this.scene.tweens.add({targets:this.shineFx,duration:e==="win"?2e4:4e4,ease:"Linear",repeat:-1,props:{rotation:{from:(0,Jd.DegToRad)(0),to:(0,Jd.DegToRad)(360)}},onStop:()=>{this.shineFx.rotation=(0,Jd.DegToRad)(0)}});let i=this.shineFx.scaleX,s=this.shineFx.scaleY;this.fxScaleAnimation=this.scene.tweens.add({targets:this.shineFx,duration:2e3,ease:Z0.Quadratic.Out,repeat:-1,yoyo:!0,props:{scaleX:{from:i,to:i*1.2},scaleY:{from:s,to:s*1.2}},onStop:()=>{this.shineFx.setScale(i,s)}})}stopShineFxTween(){this.fxSpinAnimation?.stop(),this.fxSpinAnimation?.remove(),this.fxScaleAnimation?.stop(),this.fxScaleAnimation?.remove()}runPostAdAnimation(){this.postAdCollectAnimation?.stop(),this.postAdCollectAnimation?.remove(),this.postAdCollectAnimation=this.scene.tweens.add({targets:this.collectButton,duration:500,alpha:{from:.5,to:0},ease:Z0.Quadratic.In}),this.footerContainer.runPostAnimation(500)}runCoinTextAnimation(){this.coinTextAnimation?.stop(),this.coinTextAnimation?.remove();let e=this.rewardWheel.getCurrentMultiplierResult(),i=this.baseValue.clone(),s=this.baseValue.clone();s.multiply(e);let r=s.clone();r.subtract(i),r.divide(10);let n=this.coinText.scaleX,a=this.coinText.scaleY;this.coinExplodeEffect.explode(12,this.coinIcon.x,this.coinIcon.y),this.coinTextAnimation=this.scene.tweens.addCounter({from:1,to:10,duration:150,onRepeat:()=>{i.add(r),this.coinText.setText(`+${i.toString()}`),this.coinIcon.setPosition(this.coinText.displayWidth/2+10,this.coinIcon.y)},onStart:()=>{q.playSound(J.COIN_INCREASE_REPEATEDLY_SOUND),this.coinText.setScale(n*1.1,a*1.1),this.coinIcon.setPosition(this.coinText.displayWidth/2+10,this.coinIcon.y),i.add(r),this.coinText.setText(`+${i.toString()}`),this.coinIcon.setPosition(this.coinText.displayWidth/2+10,this.coinIcon.y)},onComplete:()=>{this.coinText.setScale(n,a),this.coinIcon.setPosition(this.coinText.displayWidth/2+10,this.coinIcon.y)},onStop:()=>{this.coinText.setScale(n,a),this.coinIcon.setPosition(this.coinText.displayWidth/2+10,this.coinIcon.y)},repeat:9})}updateCoinText(e){let i=this.baseValue.clone();i.multiply(e),this.claimCoinText.setText(`${i.toString()}`),this.claimText.setText(`${$s.getText("GET").toUpperCase()} x${e}`)}},$d=j0;var T_e={[O.NOTIFY_SCREEN]:tj,[O.LOADING_SCREEN]:$Z,[O.RESULT_SCREEN]:$d,[O.UNIT_REWARD_SCREEN]:I6,[O.UNIT_UNLOCK_SCREEN]:Q6,[O.LEADER_BOARD_SCREEN]:g9,[O.OFFLINE_REWARD_SCREEN]:E8,[O.RESET_DATA_SCREEN]:w9,[O.START_OVER_POPUP]:I9,[O.BOSS_CHALLENGE_SCREEN]:M9,[O.UNITS_SCREEN]:_l,[O.SETTINGS_SCREEN]:Hd},M7=T_e;var B7=E(ie()),U7=E(X()),{Events:Wo,Utils:{Valid:O7,Object:y_e}}=Ludex,{event:ga,monitorError:D7}=codex,$0=class{screens={};screenOpenStack=[];init(){this.bindEventHandlers(),console.info("Screen Manager: Initialized")}bindEventHandlers(){ga.on(Wo.OPEN_SCREEN,this.handleOpenScreen),ga.on(Wo.CLOSE_SCREEN,this.handleCloseScreen),ga.on(we.DESTROY_SCREENS,this.destroyAllScreens)}handleOpenScreen=e=>{this.openScreen(e.screenName,e.screenData),this.screenOpenStack.push(e.screenName),W.pauseGameScene()};handleCloseScreen=e=>{this.closeScreen(e.screenName,!0),this.screenOpenStack=this.screenOpenStack.filter(i=>i!==e.screenName),!(this.screenOpenStack.length>0)&&W.resumeGameScene()};createScreen(e){let i=W.getGlobalScene();if(!i)throw new Error(`Create Screen: Invalid scene ${e}`);let{scenes:s}=this.screens[e],r=s[i.scene.key];if(r){this.setupScreen(i,r);return}let n=this.getScreenInstance(e);if(!n)throw new Error(`Create Screen: Invalid screen ${e}`);let a=new n(i,e);this.setupScreen(i,a)}setupScreen(e,i){let s=i.name;this.screens[s].scenes[e.scene.key]=i,k.addScreen(s,i),e.add.existing(i),y_e.hasOwn(e,"gameZone")&&O7.isObject(e.gameZone)&&e.gameZone instanceof U7.Zone&&B7.Align.In.Center(i,e.gameZone)}getScreenInstance(e){let i=M7[e];return i||null}prepareScreen(e){this.addScreen(e),this.createScreen(e)}addScreen(e){if(this.screens[e])return;let i=Object.keys(this.screens).length;this.screens[e]={name:e,order:i,scenes:{}}}getScreen(e){this.prepareScreen(e);let i=W.getGlobalScene();if(!i)throw new Error(`ScreenManager: Invalid scene ${e}`);let{scenes:s}=this.screens[e],r=s[i.scene.key];if(!r)throw new Error(`ScreenManager: Screen ${e} not ready`);return r}validateScreen(e){if(!O7.isString(e))throw new Error(`ScreenManager: Invalid screen name ${e}`)}async openScreen(e,i){this.validateScreen(e),await new Promise(r=>requestAnimationFrame(r));let s=this.getScreen(e);s.active||(console.debug("openScreen",e),this.showScreen(s,e,i))}async showScreen(e,i,s){let r={screenName:i,screenData:s};ga.emit(Wo.OPENING_SCREEN,r),e.open(s),this.updateAnalytics(i),ga.emit(Wo.OPENED_SCREEN,r)}async closeScreen(e,i=!1){this.validateScreen(e),await new Promise(r=>requestAnimationFrame(r));let s=this.getScreen(e);s.active&&(console.debug("closeScreen",e),ga.emit(Wo.CLOSING_SCREEN,{screenName:e}),s.close(),i&&this.updateAnalytics(e,!1),ga.emit(Wo.CLOSED_SCREEN,{screenName:e}))}updateAnalytics(e,i=!0){se.trackCurrentPage(e,i),i?D7?.addMetadata({currentScreen:e}):D7?.removeMetadata("currentScreen")}closeAllScreens(){for(let i in this.screens)this.closeScreen(i,!1)}destroyAllScreens=e=>{let{sceneKey:i}=e;if(i)for(let s in this.screens){let r=this.screens[s];if(!r)continue;let n=r.scenes[i];n&&(n.destroy(),delete r.scenes[i])}}},N7=$0;var{storage:b_e}=codex,J0=class{init(){console.info("Storage Manager: Initialized")}setupDefaultData(){this.setupTournamentData()}setupTournamentData(){b_e.addStorage("Tournament",{showResult:!1,previousScore:void 0})}},F7=J0;function A_e(t,e){let i=!1,s={};for(let r of t)for(let n of e)if(n.includes(r)){s[r]=!0,i=!0;break}return{loaded:s,hasLoaded:i}}var Q0=class{ready;constructor(){let e=Hi.instance.getPlayerLocale(),i=P.getGoogleFontFamilies(e);if(i.length===0){this.ready=Promise.resolve();return}this.ready=new Promise(s=>{let r=n=>{let{loaded:a,hasLoaded:o}=A_e(i,n.fontfaces.map(h=>h.family));o&&(i=i.filter(h=>!a[h]),i.length===0&&(document.fonts.removeEventListener("loadingdone",r),s()))};document.fonts.addEventListener("loadingdone",r)})}init(){console.info("Google Font Manager: Initialized")}},k7=Q0;var{Events:Ll,Plugins:{Analytics:{Events:Qd}},Utils:{Function:G7,Valid:x_e}}=Ludex,{context:C_e,event:Ml,analytics:ef,monitorError:eA}=codex,tA=class{coreManager$=new pZ;adsManager$=new fZ;sceneManager$=new YZ;matchManager$=new vZ;screenManager$=new N7;playerManager$=new gZ;storageManager$=new F7;pluginsManager$=new qZ;googleFontManager$=new k7;constructor(){window.isCustomRequestAnimationFrame=!1,console.groupEnd(),console.groupCollapsed("\u{1F4E6} Luder System"),console.info("Luder Initializing..."),this.initManagers$(),this.listenEvents$(),console.groupEnd()}initManagers$(){this.coreManager$.init(),this.adsManager$.init(),this.sceneManager$.init(),this.screenManager$.init(),this.matchManager$.init(),this.playerManager$.init(),this.storageManager$.init(),this.pluginsManager$.init(),this.googleFontManager$.init()}listenEvents$(){this.coreManager$.onCoreBoot(this.handleWhenCoreBoot$),this.coreManager$.onCoreStart(this.handleWhenCoreStart$),this.coreManager$.onCoreReady(this.handleWhenCoreReady$),this.sceneManager$.onSwitchScene(this.handleSwitchScene)}handleWhenCoreBoot$=()=>{this.coreManager$.requestStart()};handleWhenCoreStart$=()=>{this.playerManager$.setupDefaultGameData()};handleWhenCoreReady$=async()=>{await this.playerManager$.syncPlayerData(),this.matchManager$.setupDefaultMatchData(),this.storageManager$.setupDefaultData(),this.initPlugins$(),console.groupEnd(),Ml.catchUp(Ll.BUNDLE_READY,this.processPreStartGame$)};processPreStartGame$=()=>{ef.event(Qd.ENGINE_READY),Ml.catchUp(Ll.SCENE_LAUNCHED,this.processBootSceneLaunched$),this.runBootScene$()};processBootSceneLaunched$=async()=>{ef.event(Qd.LOAD_START),await Ml.waitTo(Ll.SCENE_LAUNCHED,15e3),await this.googleFontManager$.ready,window.phaser.isRunning||await this.waitGameResume$(),this.processStartGame$()};async waitGameResume$(){return new Promise(e=>{window.phaser.events.once(q7.RESUME,e)})}runBootScene$(){window.phaser.scene.start(z.BOOT_SCENE)}async processStartGame$(){console.groupEnd(),ef.event(Qd.LOAD_COMPLETE),await this.startGameAsync$(),Ml.catchUp(Ll.PLAYER_INFO_LOADED,this.startProcessContextData$),"subscribeBotAsync"in GameSDK.extra&&setTimeout(()=>{GameSDK.extra.subscribeBotAsync().catch(e=>{console.warn("subscribeBotAsync error",e)})},1e3)}handleSwitchScene=()=>{console.groupEnd()};async startGameAsync$(e=0){let i=GameSDK.startGameAsync(),[s,r]=await G7.handleAsync(i);try{let{width:n,height:a}=I.getCanvasSize();eA?.addMetadata({sceneSize:`${n}x${a}`})}catch{}if(r){if(e<=3){setTimeout(()=>{this.startGameAsync$(e+1)},1e3);return}eA?.sendException(r)}}startProcessContextData$=async()=>{ef.event(Qd.APP_READY),this.playerManager$.requestConnectedPlayers();let e=C_e.processContextData(),[i,s]=await G7.handleAsync(e);s&&(console.warn("startProcessContextData",s),eA?.sendException(s)),Ml.emit(Ll.GAME_READY)};initPlugins$(){this.pluginsManager$.initMissions(),this.pluginsManager$.initLeaderboards(),this.pluginsManager$.initFrameCapture(),this.pluginsManager$.initAdaptivePerformance()}};new tA;x_e.isDebugger()&&new EventSource("/esbuild").addEventListener("change",()=>location.reload());var u$=E(ie()),c$=E(X()),ue=E(X()),d$=E(l$());var{DesignSize:{Resolution:fIe}}=qr,gA=class{addKillRevive(){[ue.Container,ue.Image,ue.Sprite,ue.Graphics,ue.Text,ue.Zone,ue.Particles.ParticleEmitter,ue.NineSlice,c$.Rectangle].forEach(e=>{e.prototype.kill=this.kill,e.prototype.revive=this.revive})}addKillReviveGroup(){ue.Group.prototype.killGroup=this.killGroup,ue.Group.prototype.reviveGroup=this.reviveGroup}addSetFrame(){[ue.Image,ue.Sprite].forEach(e=>{e.prototype.oriSetFrame=e.prototype.setFrame,e.prototype.setFrame=this.setFrame})}addSetWorldSize(){[ue.Image,ue.Sprite,ue.Zone].forEach(e=>{e.prototype.setWorldSize=this.setWorldSize})}addSetWorldSizeForNineSlice(){[ue.NineSlice].forEach(e=>{e.prototype.setWorldSize=this.setWorldSizeForNineSlice})}addSetWorldSizeForContainer(){[ue.Container].forEach(e=>{e.prototype.setWorldSize=this.setWorldSizeForContainer})}addGetWorldPosition(){[ue.Container,ue.Image,ue.Sprite,ue.Graphics,ue.Text,ue.Zone].forEach(e=>{e.prototype.getWorldPosition=this.getWorldPosition})}addDrawDebugBox(){[ue.Container,ue.Image,ue.Sprite,ue.Graphics,ue.Text,ue.Zone].forEach(e=>{e.prototype.drawDebugBox=this.drawDebugBox})}addHighQuality(){[ue.Text].forEach(e=>{e.prototype.setHighQuality=this.setHighQuality})}kill(){this.setActive(!1),this.setVisible(!1)}revive(){this.setActive(!0),this.setVisible(!0)}killGroup(){let e=this.getChildren();for(let i of e)i.setActive(!1),i.setVisible(!1)}reviveGroup(){let e=this.getChildren();for(let i of e)i.setActive(!0),i.setVisible(!0)}setFrame(e,i=!0,s=!0){return this.oriSetFrame(e,i,s),this.__width=this.width,this.__height=this.height,this}setWorldSize(e,i){typeof this.__width!="number"&&(this.__width=this.width),typeof this.__height!="number"&&(this.__height=this.height);let s=I.getPixelRatio(),r=e||this.__width/s,n=i||this.__height/s;this.setSize(r,n),this.setDisplaySize(r,n)}setWorldSizeForContainer(e,i){typeof e!="number"||typeof i!="number"||(this.setSize(e,i),this.setDisplaySize(e,i))}setWorldSizeForNineSlice(e,i){this.__width||(this.__width=this.frame.width),this.__height||(this.__height=this.frame.height);let s=I.getPixelRatio(),r=e||this.__width/s,n=i||this.__height/s;this.leftWidth=this.leftWidth/s,this.rightWidth=this.rightWidth/s,this.topHeight=this.topHeight/s,this.bottomHeight=this.bottomHeight/s,this.setSize(r,n),this.setDisplaySize(r,n)}getWorldPosition(){let e=this.getWorldTransformMatrix(),{translateX:i,translateY:s}=e.decomposeMatrix();return{x:i,y:s}}drawDebugBox(e=65280,i=.2){let{width:s,height:r,depth:n,originX:a,originY:o}=this;if(!s||!r)throw new Error("Width and height are required in drawDebugBox");let h=this.scene.add.rectangle(0,0,s,r,e,i);return h.setName("Debug Box"),h.setDepth(n+1),this instanceof ue.Container&&this.add(h),this.parentContainer&&this.parentContainer.add(h),h.setOrigin(a,o),u$.Align.In.Center(h,this),h}setHighQuality(){return this.renderer instanceof d$.WebGL.WebGLRenderer?this.setResolution(fIe):this}},f$=gA;var Ree=E(yee());var{event:LMe}=codex,{Events:MMe}=Ludex,_A=class extends Ns{create(){super.create();try{LMe.catchUp(MMe.GAME_SDK_STARTED,this.processWhenGameSdkStarted),W.switchScene(z.LOAD_SCENE),this.scene.launch(z.GLOBAL_SCENE)}catch(e){console.warn("BootScene",e)}}processWhenGameSdkStarted=()=>{this.setupGameData()};setupGameData(){Se.inst.loadCoin()}},bee=_A;var mf=E(ss());var{MELEE_UNIT_TYPE:Aee,RANGED_UNIT_TYPE:xee,ALIEN_UNIT_TYPE:Cee}=L,{UNITS_SPINES:OMe}=T,{MaximumMeleeLevel:DMe,MaximumRangedLevel:BMe}=le,{player:Zo}=codex,{Utils:{Valid:UMe}}=Ludex,IA=class extends Ns{requestingSpines=[];requestingSprites=[];isLazyLoadRequesting;preload(){let e=this.getLevelJsonName();this.load.on(`filecomplete-json-${e}`,()=>{this.scene.wake(),this.loadEnemyUnits(e)}),this.load.json(e,`assets/json/${e}.json`),this.loadDefaultUnits(),this.loadPlayerUnits(),this.load.json("unitData","assets/json/unit-data.json"),this.load.json("bossData","assets/json/boss-data.json"),Hi.instance.loadPlayerLanguage(this),this.load.multiatlas({key:T.DEFAULT_8_BIT.KEY,atlasURL:T.DEFAULT_8_BIT.JSON,path:T.DEFAULT_8_BIT.PATH}),this.load.atlas({key:T.DEFAULT.KEY,atlasURL:T.DEFAULT.JSON,textureURL:T.DEFAULT.TEXTURE}),this.load.atlas({key:T.GAMEPLAY.KEY,atlasURL:T.GAMEPLAY.JSON,textureURL:T.GAMEPLAY.TEXTURE}),this.loadBackgroundByCurrentLevel(),this.load.multiatlas({key:T.EFFECTS.KEY,path:T.EFFECTS.PATH,atlasURL:T.EFFECTS.JSON}),this.load.spine(T.SPINE_EFFECTS.FX_MERGE.KEY,T.SPINE_EFFECTS.FX_MERGE.jsonPATH,T.SPINE_EFFECTS.FX_MERGE.atlasPATH)}create(){super.create(),this.setupGlobalScene$()}updateBackgroundElement(){let i=Zo.getGameData()?.level??0;if(!!1)return;let r=document.getElementById("background-image");if(!r)return;if(typeof i!="number"||i<0){r.src=U.BG_LANDSCAPE_TREE.FILE;return}let n=U.BG_LANDSCAPE_TREE.FILE;switch(Math.floor((i+1)/10)%5){case 0:n=U.BG_LANDSCAPE_TREE.FILE;break;case 1:n=U.BG_LANDSCAPE_DESERT.FILE;break;case 2:n=U.BG_LANDSCAPE_ICE.FILE;break;case 3:n=U.BG_LANDSCAPE_CRYSTAL.FILE;break;case 4:n=U.BG_LANDSCAPE_VOLCANO.FILE;break}r.src=n}setupGlobalScene$(){let e=W.getGlobalScene();!e||!(e instanceof no)||e.setup()}loadBackgroundByCurrentLevel(){let e=de.getLevelProgress();if(typeof e!="number"||e<0){this.loadAllBackgrounds();return}let i=Math.floor((e+1)/10)%5;I.isUsingLandscapeBackground()?(this.loadBackgroundImage(U.BG_LANDSCAPE_TREE.FILE,U.BG_LANDSCAPE_TREE.KEY),i===1?this.loadBackgroundImage(U.BG_LANDSCAPE_DESERT.FILE,U.BG_LANDSCAPE_DESERT.KEY):i===2?this.loadBackgroundImage(U.BG_LANDSCAPE_ICE.FILE,U.BG_LANDSCAPE_ICE.KEY):i===3?this.loadBackgroundImage(U.BG_LANDSCAPE_CRYSTAL.FILE,U.BG_LANDSCAPE_CRYSTAL.KEY):i===4&&this.loadBackgroundImage(U.BG_LANDSCAPE_VOLCANO.FILE,U.BG_LANDSCAPE_VOLCANO.KEY)):(this.load.image(U.BG_TREE.KEY,U.BG_TREE.FILE),i===1?this.load.image(U.BG_DESERT.KEY,U.BG_DESERT.FILE):i===2?this.load.image(U.BG_ICE.KEY,U.BG_ICE.FILE):i===3?this.load.image(U.BG_CRYSTAL.KEY,U.BG_CRYSTAL.FILE):i===4&&this.load.image(U.BG_VOLCANO.KEY,U.BG_VOLCANO.FILE))}getLevelJsonName(){let i=Zo.getGameData()?.level??0,r=Math.floor((i||0)/100)*100+1,n=r+99,a=(1e4+r).toString().substring(1),o=(1e4+n).toString().substring(1);return`levels-${a}-${o}`}loadDefaultUnits(){let e=this.getBuyingUnitLevel(),i=`m1-r1-m${e}-r${e}-0/0-0-0-0-0/0-0-0-0-0`;this.loadUnits("spine",i)}getBuyingUnitLevel(){let i=Zo.getGameData()?.level??0,s=UMe.isNumber(i)?i+1:1,{BUYING_UNIT_LEVEL:r}=L,n=1;for(let[a,o]of r.entries())o<=s&&(n=a+1);return n}loadPlayerUnits(){let e=de.getPlayerUnitData();if(!e||typeof e!="string"){this.loadAllUnits();return}let i=this.upgradePlayerUnits(e);Zo.setGameData({playerUnitData:i}),this.loadUnits("spine",i)}upgradePlayerUnits(e){let i=this.getPlayerUnitList(e),s=this.getBuyingUnitLevel(),r=[],n=[];for(let o=0;o<15;o++){let h=i[o],l=h[0];l!=="m"&&l!=="r"||parseInt(h.substring(1))>=s||(l==="m"?r.push(o):n.push(o))}for(let o=0;o<r.length;o++)i[r[o]]=`m${s}`;for(let o=0;o<n.length;o++)i[n[o]]=`r${s}`;let a=this.handleCannotMergeCase(i);return this.serializePlayerUnitData(a)}handleCannotMergeCase(e){if(this.isBoardCanBeMerged(e))return e;let i=this.getBuyingUnitLevel(),s=Number.MAX_SAFE_INTEGER,r=-1,n=Number.MAX_SAFE_INTEGER,a=-1,o=Number.MAX_SAFE_INTEGER,h=-1,l=Number.MAX_SAFE_INTEGER,c=-1,d=0;for(let f=0;f<e.length;f++){let p=e[f],m=p[0];if(m!=="m"&&m!=="r")continue;d++;let v=parseInt(p.substring(1));m==="m"?v<s?(n=s,a=r,s=v,r=f):v<n&&(n=v,a=f):v<o?(l=o,c=h,o=v,h=f):v<l&&(l=v,c=f)}return d===15&&r!==-1&&a!==-1&&(e[r]=e[a]),d===15&&h!==-1&&c!==-1&&(e[h]=e[c]),e}isBoardCanBeMerged(e){let i=new Map,s=new Map;e.forEach(h=>{let l=h[0];if(l!=="m"&&l!=="r")return;let c=parseInt(h.substring(1));switch(l){case"m":{let d=i.get(c);d?i.set(c,d+1):i.set(c,1);break}case"r":{let d=s.get(c);d?s.set(c,d+1):s.set(c,1);break}}});let n=Array.from(i,([h,l])=>({key:h,value:l})).some(h=>{let{key:l,value:c}=h;return c>1&&l+1<=DMe}),o=Array.from(s,([h,l])=>({key:h,value:l})).some(h=>{let{key:l,value:c}=h;return c>1&&l+1<=BMe});return n||o}getPlayerUnitList(e){let i=e.split("/"),s=[];return i.forEach(r=>{r.split("-").forEach(a=>{s.push(a)})}),s}serializePlayerUnitData(e){let i="",s=0;for(let r=0;r<3;r++){let n="";for(let a=0;a<5;a++)n+=e[s],s++,a!==4&&(n+="-");i+=n,r!==2&&(i+="/")}return i}loadEnemyUnits(e){let s=Zo.getGameData()?.level,r=typeof s=="number"?s:0,n=Math.floor(r/100)*100+1,a=r-n+1,h=this.cache.json.get(e).levels[a],l=`${h.enemy_row1}/${h.enemy_row2}/${h.enemy_row3}`;console.info("\u{1F680} > loadEnemyUnits",{jsonFileName:e,data:l}),this.loadUnits("spine",l)}loadUnits(e,i){let s=i.split("/"),r=[];for(let n of s){let a=n.split("-");for(let o of a){if(o==="0"||r.includes(o))continue;let h=Cee;if(o[0]==="m"?h=Aee:o[0]==="r"&&(h=xee),h===Cee)continue;let l=parseInt(o.substring(1));r.push(o),this.loadUnit(e,l,h)}}}loadUnit(e,i,s){let{MELEE:r,RANGED:n}=OMe,a=null;switch(s){case Aee:i>0&&i<=Object.keys(r).length&&(a=r[i]);break;case xee:i>0&&i<=Object.keys(n).length&&(a=n[i]);break}if(a){if(e==="spine"){if(this.requestingSpines.includes(a.KEY))return;this.requestingSpines.push(a.KEY),this.load.spine(a.KEY,a.jsonPATH,a.atlasPATH),this.isLazyLoadRequesting=!0}if(e==="sprite"){if(this.textures.exists(a.KEY)||this.requestingSprites.includes(a.KEY))return;this.requestingSprites.push(a.KEY),console.log("load sprite unit",a.KEY),this.load.multiatlas({key:a.KEY,atlasURL:a.JSON,path:a.PATH}),this.isLazyLoadRequesting=!0}}}lazyLoadResource(){this.isLazyLoadRequesting=!1,this.loadSounds(),this.loadAllUnits(),this.loadAvatarUnits(),this.loadAllBackgrounds(),this.isLazyLoadRequesting&&(this.scene.wake(),this.load.once(mf.COMPLETE,()=>{this.scene.sleep()}),this.load.start())}loadSounds(){this.cache.audio.exists(Es.BACKGROUND.KEY)||(this.load.once(`${mf.FILE_KEY_COMPLETE}audio-${Es.BACKGROUND.KEY}`,this.handleLoadMusicCompleted),this.load.audio(Es.BACKGROUND.KEY,Es.BACKGROUND.FILE),this.isLazyLoadRequesting=!0)}handleLoadMusicCompleted(){Zo.getPlayerSetting("music")&&(q.playMusic(),q.setVolumeMusic(.4))}loadAllUnits(){this.loadUnits("spine","m1-m2-m3-m4-m5/m6-m7-m8-m9-m10/m11-r1-r2-r3-r4-r5"),this.loadUnits("spine","r6-r7-r8-r9-r10/r11-0-0-0-0/0-0-0-0-0")}loadAvatarUnits(){this.textures.exists(T.UNITS.KEY)||(this.load.multiatlas({key:T.UNITS.KEY,atlasURL:T.UNITS.JSON,path:T.UNITS.PATH}),this.isLazyLoadRequesting=!0)}loadAllBackgrounds(){I.isUsingLandscapeBackground()?(this.textures.exists(U.BG_LANDSCAPE_TREE.KEY)||(this.loadBackgroundImage(U.BG_LANDSCAPE_TREE.FILE,U.BG_LANDSCAPE_TREE.KEY),this.isLazyLoadRequesting=!0),this.textures.exists(U.BG_LANDSCAPE_DESERT.KEY)||(this.loadBackgroundImage(U.BG_LANDSCAPE_DESERT.FILE,U.BG_LANDSCAPE_DESERT.KEY),this.isLazyLoadRequesting=!0),this.textures.exists(U.BG_LANDSCAPE_ICE.KEY)||(this.loadBackgroundImage(U.BG_LANDSCAPE_ICE.FILE,U.BG_LANDSCAPE_ICE.KEY),this.isLazyLoadRequesting=!0),this.textures.exists(U.BG_LANDSCAPE_VOLCANO.KEY)||(this.loadBackgroundImage(U.BG_LANDSCAPE_VOLCANO.FILE,U.BG_LANDSCAPE_VOLCANO.KEY),this.isLazyLoadRequesting=!0),this.textures.exists(U.BG_LANDSCAPE_CRYSTAL.KEY)||(this.loadBackgroundImage(U.BG_LANDSCAPE_CRYSTAL.FILE,U.BG_LANDSCAPE_CRYSTAL.KEY),this.isLazyLoadRequesting=!0)):(this.textures.exists(U.BG_TREE.KEY)||(this.load.image(U.BG_TREE.KEY,U.BG_TREE.FILE),this.isLazyLoadRequesting=!0),this.textures.exists(U.BG_DESERT.KEY)||(this.load.image(U.BG_DESERT.KEY,U.BG_DESERT.FILE),this.isLazyLoadRequesting=!0),this.textures.exists(U.BG_ICE.KEY)||(this.load.image(U.BG_ICE.KEY,U.BG_ICE.FILE),this.isLazyLoadRequesting=!0),this.textures.exists(U.BG_VOLCANO.KEY)||(this.load.image(U.BG_VOLCANO.KEY,U.BG_VOLCANO.FILE),this.isLazyLoadRequesting=!0),this.textures.exists(U.BG_CRYSTAL.KEY)||(this.load.image(U.BG_CRYSTAL.KEY,U.BG_CRYSTAL.FILE),this.isLazyLoadRequesting=!0))}async loadBackgroundImage(e,i){return new Promise((s,r)=>{let n=new Image;n.crossOrigin="use-credentials",n.onload=()=>{this.load.image(i,e),s()},n.onerror=()=>{console.error("Load image failed",e),r()},n.src=e})}},wee=IA;var LA=class extends Ree.default{async boot(){super.boot(),this.addExtraGameObjectMethods(),this.addPlugins(),this.addScenes(),this.initWorld()}addExtraGameObjectMethods(){let e=new f$;e.addKillRevive(),e.addKillReviveGroup(),e.addDrawDebugBox(),e.addSetFrame(),e.addSetWorldSize(),e.addSetWorldSizeForContainer(),e.addGetWorldPosition(),e.addHighQuality(),e.addSetWorldSizeForNineSlice()}addPlugins(){this.plugins.installScenePlugin("SpinePlugin",SpinePlugin,"spine")}addScenes(){this.scene.add(z.BOOT_SCENE,bee,!1),this.scene.add(z.LOAD_SCENE,wee,!1),this.scene.add(z.GAME_SCENE,Eo,!1),this.scene.add(z.GLOBAL_SCENE,no,!1)}initWorld(){I.init(this)}},Pee=LA;var _ee=E(Qi()),NMe=!("AudioContext"in window)&&!("webkitAudioContext"in window),FMe={parent:"GameDiv",type:_ee.WEBGL,autoMobilePipeline:!0,scale:{autoRound:!0},dom:{createContainer:!1},fps:{target:60,smoothStep:!0},loader:{maxParallelDownloads:6,crossOrigin:"no-cros"},input:{gamepad:!1,touch:{capture:!0},smoothFactor:1,activePointers:1,windowEvents:!1},audio:{noAudio:NMe},disablePreFX:!0,disablePostFX:!0,disableContextMenu:!0,render:{pixelArt:!1,antialias:!0,antialiasGL:!1,transparent:!1,desynchronized:!0,clearBeforeRender:!1,roundPixels:!1,defaultPipeline:"MultiPipeline",autoMobilePipeline:!1},plugins:{global:[]}},Iee=FMe;var{event:kMe}=codex,{Events:GMe}=Ludex,qMe=()=>{try{window.phaser=new Pee(Iee),window.phaser.device.os.iOS=!1,kMe.emit(GMe.BUNDLE_READY)}catch(t){console.error("Init Game Error",t)}};qMe();})();
/**
 * @author       Richard Davey <rich@phaser.io>
 * @copyright    2013-2025 Phaser Studio Inc.
 * @license      {@link https://opensource.org/licenses/MIT|MIT License}
 */
/**
 * @author       Richard Davey <rich@phaser.io>
 * @author       Angry Bytes (and contributors)
 * @copyright    2013-2025 Phaser Studio Inc.
 * @license      {@link https://opensource.org/licenses/MIT|MIT License}
 */
/**
 * @author       samme
 * @copyright    2021 Photon Storm Ltd.
 * @license      {@link https://opensource.org/licenses/MIT|MIT License}
 */
/**
 * @author       Jason Nicholls <nicholls.jason@gmail.com>
 * @copyright    2018 Photon Storm Ltd.
 * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
 */
/**
 * @author       samme
 * @copyright    2013-2025 Phaser Studio Inc.
 * @license      {@link https://opensource.org/licenses/MIT|MIT License}
 */
/**
 * @author       Richard Davey <rich@phaser.io>
 * @author       @samme
 * @copyright    2013-2025 Phaser Studio Inc.
 * @license      {@link https://opensource.org/licenses/MIT|MIT License}
 */
/**
 * @author       Richard Davey <rich@phaser.io>
 * @author       Felipe Alfonso <@bitnenfer>
 * @copyright    2013-2025 Phaser Studio Inc.
 * @license      {@link https://opensource.org/licenses/MIT|MIT License}
 */
/**
 * @author       Richard Davey <rich@phaser.io>
 * @author       Felipe Alfonso <@bitnenfer>
 * @author       Matthew Groves <@doormat>
 * @copyright    2013-2025 Phaser Studio Inc.
 * @license      {@link https://opensource.org/licenses/MIT|MIT License}
 */
/**
 * @author       Richard Davey <rich@phaser.io>
 * @author       samme <samme.npm@gmail.com>
 * @copyright    2013-2025 Phaser Studio Inc.
 * @license      {@link https://opensource.org/licenses/MIT|MIT License}
 */
/**
 * @author       Benjamin D. Richards <benjamindrichards@gmail.com>
 * @copyright    2013-2025 Phaser Studio Inc.
 * @license      {@link https://opensource.org/licenses/MIT|MIT License}
 */
/**
 * @author       pi-kei
 * @copyright    2013-2025 Phaser Studio Inc.
 * @license      {@link https://opensource.org/licenses/MIT|MIT License}
 */
/**
 * @author       Richard Davey <rich@phaser.io>
 * @author       Pavle Goloskokovic <pgoloskokovic@gmail.com> (http://prunegames.com)
 * @copyright    2013-2025 Phaser Studio Inc.
 * @license      {@link https://opensource.org/licenses/MIT|MIT License}
 */
/**
 * @author       Niklas von Hertzen (https://github.com/niklasvh/base64-arraybuffer)
 * @author       Richard Davey <rich@phaser.io>
 * @copyright    2013-2025 Phaser Studio Inc.
 * @license      {@link https://opensource.org/licenses/MIT|MIT License}
 */
//! lack of sprite of higher units level
//! Suppose on the board only have 2 melee and 1 ranged
//! can be call before real onDragEnd call
//! if 0, 0 is center of screen, need to be adjust
