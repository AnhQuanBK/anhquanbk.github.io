"use strict";(()=>{var mf=Object.create,sa=Object.defineProperty,Ih=Object.getOwnPropertyDescriptor,vf=Object.getOwnPropertyNames,Ef=Object.getPrototypeOf,yf=Object.prototype.hasOwnProperty,S=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Tf=(e,t,i,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of vf(t))!yf.call(e,n)&&n!==i&&sa(e,n,{get:()=>t[n],enumerable:!(s=Ih(t,n))||s.enumerable});return e},U=(e,t,i)=>(i=e!=null?mf(Ef(e)):{},Tf(t||!e||!e.__esModule?sa(i,"default",{value:e,enumerable:!0}):i,e)),ne=(e,t,i,s)=>{for(var n=s>1?void 0:s?Ih(t,i):t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(n=(s?o(t,i,n):o(n))||n);return s&&n&&sa(t,i,n),n},Sf=S(()=>{"use strict";Array.prototype.forEach||(Array.prototype.forEach=function(e){"use strict";if(this===void 0||this===null)throw new TypeError;var t=Object(this),i=t.length>>>0;if(typeof e!="function")throw new TypeError;for(var s=arguments.length>=2?arguments[1]:void 0,n=0;n<i;n++)n in t&&e.call(s,t[n],n,t)})}),Af=S(()=>{"use strict";Array.isArray||(Array.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"})}),xf=S(()=>{"use strict";window.console||(window.console={},window.console.log=window.console.assert=function(){},window.console.warn=window.console.assert=function(){})}),wf=S(()=>{"use strict";Math.trunc||(Math.trunc=function(e){return e<0?Math.ceil(e):Math.floor(e)})}),Rf=S(()=>{"use strict";(function(){if("performance"in window||(window.performance={}),Date.now=Date.now||function(){return new Date().getTime()},!("now"in window.performance)){var e=Date.now();performance.timing&&performance.timing.navigationStart&&(e=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-e}}})()}),Cf=S(()=>{"use strict";var e=Date.now(),t=["ms","moz","webkit","o"];for(i=0;i<t.length&&!window.requestAnimationFrame;i++)window.requestAnimationFrame=window[t[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[i]+"CancelAnimationFrame"]||window[t[i]+"CancelRequestAnimationFrame"];var i;window.requestAnimationFrame||(window.requestAnimationFrame=function(s){if(typeof s!="function")throw new TypeError(s+"is not a function");var n=Date.now(),r=16+e-n;return r<0&&(r=0),e=n,setTimeout(function(){e=Date.now(),s(performance.now())},r)}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(s){clearTimeout(s)})}),_f=S(()=>{"use strict";typeof window.Uint32Array!="function"&&typeof window.Uint32Array!="object"&&(e=function(t){var i=new Array;window[t]=function(s){if(typeof s=="number"){Array.call(this,s),this.length=s;for(var n=0;n<this.length;n++)this[n]=0}else{Array.call(this,s.length),this.length=s.length;for(var n=0;n<this.length;n++)this[n]=s[n]}},window[t].prototype=i,window[t].constructor=window[t]},e("Float32Array"),e("Uint32Array"),e("Uint16Array"),e("Int16Array"),e("ArrayBuffer"),e("Int8Array"),e("Uint8Array"));var e}),V=S((e,t)=>{"use strict";function i(h){return!!h.get&&typeof h.get=="function"||!!h.set&&typeof h.set=="function"}function s(h,l,c){var f=c?h[l]:Object.getOwnPropertyDescriptor(h,l);return!c&&f.value&&typeof f.value=="object"&&(f=f.value),f&&i(f)?(typeof f.enumerable>"u"&&(f.enumerable=!0),typeof f.configurable>"u"&&(f.configurable=!0),f):!1}function n(h,l){var c=Object.getOwnPropertyDescriptor(h,l);return c?(c.value&&typeof c.value=="object"&&(c=c.value),c.configurable===!1):!1}function r(h,l,c,f){for(var u in l)if(l.hasOwnProperty(u)){var p=s(l,u,c);if(p!==!1){var d=f||h;if(n(d.prototype,u)){if(a.ignoreFinals)continue;throw new Error("cannot override final property '"+u+"', set Class.ignoreFinals = true to skip")}Object.defineProperty(h.prototype,u,p)}else h.prototype[u]=l[u]}}function o(h,l){if(l){Array.isArray(l)||(l=[l]);for(var c=0;c<l.length;c++)r(h,l[c].prototype||l[c])}}function a(h){h||(h={});var l,c;if(h.initialize){if(typeof h.initialize!="function")throw new Error("initialize must be a function");l=h.initialize,delete h.initialize}else if(h.Extends){var f=h.Extends;l=function(){f.apply(this,arguments)}}else l=function(){};h.Extends?(l.prototype=Object.create(h.Extends.prototype),l.prototype.constructor=l,c=h.Extends,delete h.Extends):l.prototype.constructor=l;var u=null;return h.Mixins&&(u=h.Mixins,delete h.Mixins),o(l,u),r(l,h,!0,c),l}a.extend=r,a.mixin=o,a.ignoreFinals=!1,t.exports=a}),Xt=S((e,t)=>{"use strict";var i=function(s,n,r){return Math.max(n,Math.min(r,s))};t.exports=i}),bf=S((e,t)=>{"use strict";var i=Xt(),s=2,n={_alpha:1,_alphaTL:1,_alphaTR:1,_alphaBL:1,_alphaBR:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(r,o,a,h){return r===void 0&&(r=1),o===void 0?this.alpha=r:(this._alphaTL=i(r,0,1),this._alphaTR=i(o,0,1),this._alphaBL=i(a,0,1),this._alphaBR=i(h,0,1)),this},alpha:{get:function(){return this._alpha},set:function(r){var o=i(r,0,1);this._alpha=o,this._alphaTL=o,this._alphaTR=o,this._alphaBL=o,this._alphaBR=o,o===0?this.renderFlags&=~s:this.renderFlags|=s}},alphaTopLeft:{get:function(){return this._alphaTL},set:function(r){var o=i(r,0,1);this._alphaTL=o,o!==0&&(this.renderFlags|=s)}},alphaTopRight:{get:function(){return this._alphaTR},set:function(r){var o=i(r,0,1);this._alphaTR=o,o!==0&&(this.renderFlags|=s)}},alphaBottomLeft:{get:function(){return this._alphaBL},set:function(r){var o=i(r,0,1);this._alphaBL=o,o!==0&&(this.renderFlags|=s)}},alphaBottomRight:{get:function(){return this._alphaBR},set:function(r){var o=i(r,0,1);this._alphaBR=o,o!==0&&(this.renderFlags|=s)}}};t.exports=n}),Pf=S((e,t)=>{"use strict";var i=Xt(),s=2,n={_alpha:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(r){return r===void 0&&(r=1),this.alpha=r,this},alpha:{get:function(){return this._alpha},set:function(r){var o=i(r,0,1);this._alpha=o,o===0?this.renderFlags&=~s:this.renderFlags|=s}}};t.exports=n}),ms=S((e,t)=>{"use strict";t.exports={SKIP_CHECK:-1,NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,ERASE:17,SOURCE_IN:18,SOURCE_OUT:19,SOURCE_ATOP:20,DESTINATION_OVER:21,DESTINATION_IN:22,DESTINATION_OUT:23,DESTINATION_ATOP:24,LIGHTER:25,COPY:26,XOR:27}}),Lf=S((e,t)=>{"use strict";var i=ms(),s={_blendMode:i.NORMAL,blendMode:{get:function(){return this._blendMode},set:function(n){typeof n=="string"&&(n=i[n]),n|=0,n>=-1&&(this._blendMode=n)}},setBlendMode:function(n){return this.blendMode=n,this}};t.exports=s}),If=S((e,t)=>{"use strict";var i={width:0,height:0,displayWidth:{get:function(){return this.scaleX*this.width},set:function(s){this.scaleX=s/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(s){this.scaleY=s/this.height}},setSize:function(s,n){return this.width=s,this.height=n,this},setDisplaySize:function(s,n){return this.displayWidth=s,this.displayHeight=n,this}};t.exports=i}),Mf=S((e,t)=>{"use strict";var i={texture:null,frame:null,isCropped:!1,setCrop:function(s,n,r,o){if(s===void 0)this.isCropped=!1;else if(this.frame){if(typeof s=="number")this.frame.setCropUVs(this._crop,s,n,r,o,this.flipX,this.flipY);else{var a=s;this.frame.setCropUVs(this._crop,a.x,a.y,a.width,a.height,this.flipX,this.flipY)}this.isCropped=!0}return this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:!1,flipY:!1,cx:0,cy:0,cw:0,ch:0}}};t.exports=i}),na=S((e,t)=>{"use strict";var i=function(s){if(!Array.isArray(s)||!Array.isArray(s[0]))return!1;for(var n=s[0].length,r=1;r<s.length;r++)if(s[r].length!==n)return!1;return!0};t.exports=i}),Mh=S((e,t)=>{"use strict";var i=function(s,n,r,o){n===void 0&&(n=0),r===void 0&&(r=" "),o===void 0&&(o=3),s=s.toString();var a=0;if(n+1>=s.length)switch(o){case 1:s=new Array(n+1-s.length).join(r)+s;break;case 3:var h=Math.ceil((a=n-s.length)/2),l=a-h;s=new Array(l+1).join(r)+s+new Array(h+1).join(r);break;default:s=s+new Array(n+1-s.length).join(r);break}return s};t.exports=i}),Of=S((e,t)=>{"use strict";var i=Mh(),s=na(),n=function(r){var o="";if(!s(r))return o;for(var a=0;a<r.length;a++){for(var h=0;h<r[a].length;h++){var l=r[a][h].toString();l!=="undefined"?o+=i(l,2):o+="?",h<r[a].length-1&&(o+=" |")}if(a<r.length-1){o+=`
`;for(var c=0;c<r[a].length;c++)o+="---",c<r[a].length-1&&(o+="+");o+=`
`}}return o};t.exports=n}),Df=S((e,t)=>{"use strict";var i=function(s){return s.reverse()};t.exports=i}),kf=S((e,t)=>{"use strict";var i=function(s){for(var n=0;n<s.length;n++)s[n].reverse();return s};t.exports=i}),Oh=S((e,t)=>{"use strict";var i=function(s){for(var n=s.length,r=s[0].length,o=new Array(r),a=0;a<r;a++){o[a]=new Array(n);for(var h=n-1;h>-1;h--)o[a][h]=s[h][a]}return o};t.exports=i}),Un=S((e,t)=>{"use strict";var i=na(),s=Oh(),n=function(r,o){if(o===void 0&&(o=90),!i(r))return null;if(typeof o!="string"&&(o=(o%360+360)%360),o===90||o===-270||o==="rotateLeft")r=s(r),r.reverse();else if(o===-90||o===270||o==="rotateRight")r.reverse(),r=s(r);else if(Math.abs(o)===180||o==="rotate180"){for(var a=0;a<r.length;a++)r[a].reverse();r.reverse()}return r};t.exports=n}),Bf=S((e,t)=>{"use strict";var i=Un(),s=function(n){return i(n,180)};t.exports=s}),Nf=S((e,t)=>{"use strict";var i=Un(),s=function(n,r){r===void 0&&(r=1);for(var o=0;o<r;o++)n=i(n,90);return n};t.exports=s}),Uf=S((e,t)=>{"use strict";var i=Un(),s=function(n,r){r===void 0&&(r=1);for(var o=0;o<r;o++)n=i(n,-90);return n};t.exports=s}),ra=S((e,t)=>{"use strict";var i=function(s,n){n===void 0&&(n=1);for(var r=null,o=0;o<n;o++)r=s.shift(),s.push(r);return r};t.exports=i}),aa=S((e,t)=>{"use strict";var i=function(s,n){n===void 0&&(n=1);for(var r=null,o=0;o<n;o++)r=s.pop(),s.unshift(r);return r};t.exports=i}),Ff=S((e,t)=>{"use strict";var i=ra(),s=aa(),n=function(r,o,a){if(o===void 0&&(o=0),a===void 0&&(a=0),a!==0&&(a<0?i(r,Math.abs(a)):s(r,a)),o!==0)for(var h=0;h<r.length;h++){var l=r[h];o<0?i(l,Math.abs(o)):s(l,o)}return r};t.exports=n}),Gf=S((e,t)=>{"use strict";t.exports={CheckMatrix:na(),MatrixToString:Of(),ReverseColumns:Df(),ReverseRows:kf(),Rotate180:Bf(),RotateLeft:Nf(),RotateMatrix:Un(),RotateRight:Uf(),Translate:Ff(),TransposeMatrix:Oh()}}),Yf=S((e,t)=>{"use strict";var i=function(s,n,r,o,a){if(a===void 0&&(a=s),r>0){var h=r-s.length;if(h<=0)return null}if(!Array.isArray(n))return s.indexOf(n)===-1?(s.push(n),o&&o.call(a,n),n):null;for(var l=n.length-1;l>=0;)s.indexOf(n[l])!==-1&&n.splice(l,1),l--;if(l=n.length,l===0)return null;r>0&&l>h&&(n.splice(h),l=h);for(var c=0;c<l;c++){var f=n[c];s.push(f),o&&o.call(a,f)}return n};t.exports=i}),Hf=S((e,t)=>{"use strict";var i=function(s,n,r,o,a,h){if(r===void 0&&(r=0),h===void 0&&(h=s),o>0){var l=o-s.length;if(l<=0)return null}if(!Array.isArray(n))return s.indexOf(n)===-1?(s.splice(r,0,n),a&&a.call(h,n),n):null;for(var c=n.length-1;c>=0;)s.indexOf(n[c])!==-1&&n.pop(),c--;if(c=n.length,c===0)return null;o>0&&c>l&&(n.splice(l),c=l);for(var f=c-1;f>=0;f--){var u=n[f];s.splice(r,0,u),a&&a.call(h,u)}return n};t.exports=i}),Wf=S((e,t)=>{"use strict";var i=function(s,n){var r=s.indexOf(n);return r!==-1&&r<s.length&&(s.splice(r,1),s.push(n)),n};t.exports=i}),zi=S((e,t)=>{"use strict";var i=function(s,n,r,o){var a=s.length;if(n<0||n>=a||n>=r||r>a){if(o)throw new Error("Range Error: Values outside acceptable range");return!1}else return!0};t.exports=i}),zf=S((e,t)=>{"use strict";var i=zi(),s=function(n,r,o,a,h){a===void 0&&(a=0),h===void 0&&(h=n.length);var l=0;if(i(n,a,h))for(var c=a;c<h;c++){var f=n[c];f[r]===o&&l++}return l};t.exports=s}),Fn=S((e,t)=>{"use strict";var i=function(s,n,r){var o,a=[null];for(o=3;o<arguments.length;o++)a.push(arguments[o]);for(o=0;o<s.length;o++)a[0]=s[o],n.apply(r,a);return s};t.exports=i}),Vf=S((e,t)=>{"use strict";var i=zi(),s=function(n,r,o,a,h){if(a===void 0&&(a=0),h===void 0&&(h=n.length),i(n,a,h)){var l,c=[null];for(l=5;l<arguments.length;l++)c.push(arguments[l]);for(l=a;l<h;l++)c[0]=n[l],r.apply(o,c)}return n};t.exports=s}),Dh=S((e,t)=>{"use strict";var i=function(s,n,r){if(n.length){if(n.length===1)return n[0]}else return NaN;var o=1,a,h;if(r){if(s<n[0][r])return n[0];for(;n[o][r]<s;)o++}else for(;n[o]<s;)o++;return o>n.length&&(o=n.length),r?(a=n[o-1][r],h=n[o][r],h-s<=s-a?n[o]:n[o-1]):(a=n[o-1],h=n[o],h-s<=s-a?h:a)};t.exports=i}),kh=S((e,t)=>{"use strict";var i=function(s,n){n===void 0&&(n=[]);for(var r=0;r<s.length;r++)Array.isArray(s[r])?i(s[r],n):n.push(s[r]);return n};t.exports=i}),oa=S((e,t)=>{"use strict";var i=zi(),s=function(n,r,o,a,h){a===void 0&&(a=0),h===void 0&&(h=n.length);var l=[];if(i(n,a,h))for(var c=a;c<h;c++){var f=n[c];(!r||r&&o===void 0&&f.hasOwnProperty(r)||r&&o!==void 0&&f[r]===o)&&l.push(f)}return l};t.exports=s}),Bh=S((e,t)=>{"use strict";var i=zi(),s=function(n,r,o,a,h){if(a===void 0&&(a=0),h===void 0&&(h=n.length),a!==-1){if(i(n,a,h))for(var l=a;l<h;l++){var c=n[l];if(!r||r&&o===void 0&&c.hasOwnProperty(r)||r&&o!==void 0&&c[r]===o)return c}}else if(i(n,0,h))for(var l=h;l>=0;l--){var c=n[l];if(!r||r&&o===void 0&&c.hasOwnProperty(r)||r&&o!==void 0&&c[r]===o)return c}return null};t.exports=s}),Nh=S((e,t)=>{"use strict";var i=function(s,n,r){n===void 0&&(n=0),r===void 0&&(r=s.length);var o=n+Math.floor(Math.random()*r);return s[o]===void 0?null:s[o]};t.exports=i}),Xf=S((e,t)=>{"use strict";var i=function(s,n){var r=s.indexOf(n);if(r>0){var o=s[r-1],a=s.indexOf(o);s[r]=o,s[a]=n}return s};t.exports=i}),Kf=S((e,t)=>{"use strict";var i=function(s,n,r){var o=s.indexOf(n);if(o===-1||r<0||r>=s.length)throw new Error("Supplied index out of bounds");return o!==r&&(s.splice(o,1),s.splice(r,0,n)),n};t.exports=i}),jf=S((e,t)=>{"use strict";var i=function(s,n){var r=s.indexOf(n);if(r!==-1&&r<s.length-1){var o=s[r+1],a=s.indexOf(o);s[r]=o,s[a]=n}return s};t.exports=i}),Zf=S((e,t)=>{"use strict";var i=function(s,n,r){if(n===r)return s;var o=s.indexOf(n),a=s.indexOf(r);if(o<0||a<0)throw new Error("Supplied items must be elements of the same array");return o>a||(s.splice(o,1),a=s.indexOf(r),s.splice(a+1,0,n)),s};t.exports=i}),qf=S((e,t)=>{"use strict";var i=function(s,n,r){if(n===r)return s;var o=s.indexOf(n),a=s.indexOf(r);if(o<0||a<0)throw new Error("Supplied items must be elements of the same array");return o<a||(s.splice(o,1),a===0?s.unshift(n):s.splice(a,0,n)),s};t.exports=i}),Uh=S((e,t)=>{"use strict";var i=function(s,n,r,o){var a=[],h,l=!1;if((r||o)&&(l=!0,r||(r=""),o||(o="")),n<s)for(h=s;h>=n;h--)l?a.push(r+h.toString()+o):a.push(h);else for(h=s;h<=n;h++)l?a.push(r+h.toString()+o):a.push(h);return a};t.exports=i}),Qf=S((e,t)=>{"use strict";var i=function(s){return s>0?Math.ceil(s):Math.floor(s)};t.exports=i}),Jf=S((e,t)=>{"use strict";var i=Qf(),s=function(n,r,o){n===void 0&&(n=0),r===void 0&&(r=null),o===void 0&&(o=1),r===null&&(r=n,n=0);for(var a=[],h=Math.max(i((r-n)/(o||1)),0),l=0;l<h;l++)a.push(n),n+=o;return a};t.exports=s}),$f=S((e,t)=>{"use strict";function i(r,o,a){var h=r[o];r[o]=r[a],r[a]=h}function s(r,o){return r<o?-1:r>o?1:0}var n=function(r,o,a,h,l){for(a===void 0&&(a=0),h===void 0&&(h=r.length-1),l===void 0&&(l=s);h>a;){if(h-a>600){var c=h-a+1,f=o-a+1,u=Math.log(c),p=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*p*(c-p)/c)*(f-c/2<0?-1:1),g=Math.max(a,Math.floor(o-f*p/c+d)),m=Math.min(h,Math.floor(o+(c-f)*p/c+d));n(r,o,g,m,l)}var E=r[o],v=a,y=h;for(i(r,a,o),l(r[h],E)>0&&i(r,a,h);v<y;){for(i(r,v,y),v++,y--;l(r[v],E)<0;)v++;for(;l(r[y],E)>0;)y--}l(r[a],E)===0?i(r,a,y):(y++,i(r,y,h)),y<=o&&(a=y+1),o<=y&&(h=y-1)}};t.exports=n}),Mt=S((e,t)=>{"use strict";var i=function(s,n,r,o){if(!s&&!o||typeof s=="number")return r;if(s&&s.hasOwnProperty(n))return s[n];if(o&&o.hasOwnProperty(n))return o[n];if(n.indexOf(".")!==-1){for(var a=n.split("."),h=s,l=o,c=r,f=r,u=!0,p=!0,d=0;d<a.length;d++)h&&h.hasOwnProperty(a[d])?(c=h[a[d]],h=h[a[d]]):u=!1,l&&l.hasOwnProperty(a[d])?(f=l[a[d]],l=l[a[d]]):p=!1;return u?c:p?f:r}else return r};t.exports=i}),ha=S((e,t)=>{"use strict";var i=function(s){for(var n=s.length-1;n>0;n--){var r=Math.floor(Math.random()*(n+1)),o=s[n];s[n]=s[r],s[r]=o}return s};t.exports=i}),Fh=S((e,t)=>{"use strict";var i=Mt(),s=ha(),n=function(o,a,h){for(var l=[],c=0;c<o.length;c++)for(var f=0;f<a.length;f++)for(var u=0;u<h;u++)l.push({a:o[c],b:a[f]});return l},r=function(o,a,h){var l=i(h,"max",0),c=i(h,"qty",1),f=i(h,"random",!1),u=i(h,"randomB",!1),p=i(h,"repeat",0),d=i(h,"yoyo",!1),g=[];if(u&&s(a),p===-1)if(l===0)p=0;else{var m=o.length*a.length*c;d&&(m*=2),p=Math.ceil(l/m)}for(var E=0;E<=p;E++){var v=n(o,a,c);f&&s(v),g=g.concat(v),d&&(v.reverse(),g=g.concat(v))}return l&&g.splice(l),g};t.exports=r}),en=S((e,t)=>{"use strict";var i=function(s,n){if(!(n>=s.length)){for(var r=s.length-1,o=s[n],a=n;a<r;a++)s[a]=s[a+1];return s.length=r,o}};t.exports=i}),Pi=S((e,t)=>{"use strict";var i=en(),s=function(n,r,o,a){a===void 0&&(a=n);var h;if(!Array.isArray(r))return h=n.indexOf(r),h!==-1?(i(n,h),o&&o.call(a,r),r):null;for(var l=r.length-1,c=[];l>=0;){var f=r[l];h=n.indexOf(f),h!==-1&&(i(n,h),c.push(f),o&&o.call(a,f)),l--}return c};t.exports=s}),tm=S((e,t)=>{"use strict";var i=en(),s=function(n,r,o,a){if(a===void 0&&(a=n),r<0||r>n.length-1)throw new Error("Index out of bounds");var h=i(n,r);return o&&o.call(a,h),h};t.exports=s}),em=S((e,t)=>{"use strict";var i=zi(),s=function(n,r,o,a,h){if(r===void 0&&(r=0),o===void 0&&(o=n.length),h===void 0&&(h=n),i(n,r,o)){var l=o-r,c=n.splice(r,l);if(a)for(var f=0;f<c.length;f++){var u=c[f];a.call(h,u)}return c}else return[]};t.exports=s}),im=S((e,t)=>{"use strict";var i=en(),s=function(n,r,o){r===void 0&&(r=0),o===void 0&&(o=n.length);var a=r+Math.floor(Math.random()*o);return i(n,a)};t.exports=s}),sm=S((e,t)=>{"use strict";var i=function(s,n,r){var o=s.indexOf(n),a=s.indexOf(r);return o!==-1&&a===-1?(s[o]=r,!0):!1};t.exports=i}),nm=S((e,t)=>{"use strict";var i=function(s,n){var r=s.indexOf(n);return r!==-1&&r>0&&(s.splice(r,1),s.unshift(n)),n};t.exports=i}),rm=S((e,t)=>{"use strict";var i=zi(),s=function(n,r,o,a,h){if(a===void 0&&(a=0),h===void 0&&(h=n.length),i(n,a,h))for(var l=a;l<h;l++){var c=n[l];c.hasOwnProperty(r)&&(c[r]=o)}return n};t.exports=s}),Gh=S((e,t)=>{"use strict";var i=function(s){var n=/\D/g;return s.sort(function(r,o){return parseInt(r.replace(n,""),10)-parseInt(o.replace(n,""),10)}),s};t.exports=i}),sn=S((e,t)=>{"use strict";var i={android:!1,chromeOS:!1,cordova:!1,crosswalk:!1,desktop:!1,ejecta:!1,electron:!1,iOS:!1,iOSVersion:0,iPad:!1,iPhone:!1,kindle:!1,linux:!1,macOS:!1,node:!1,nodeWebkit:!1,pixelRatio:1,webApp:!1,windows:!1,windowsPhone:!1};function s(){if(typeof importScripts=="function")return i;var n=navigator.userAgent;/Windows/.test(n)?i.windows=!0:/Mac OS/.test(n)&&!/like Mac OS/.test(n)?navigator.maxTouchPoints&&navigator.maxTouchPoints>2?(i.iOS=!0,i.iPad=!0,navigator.appVersion.match(/Version\/(\d+)/),i.iOSVersion=parseInt(RegExp.$1,10)):i.macOS=!0:/Android/.test(n)?i.android=!0:/Linux/.test(n)?i.linux=!0:/iP[ao]d|iPhone/i.test(n)?(i.iOS=!0,navigator.appVersion.match(/OS (\d+)/),i.iOSVersion=parseInt(RegExp.$1,10),i.iPhone=n.toLowerCase().indexOf("iphone")!==-1,i.iPad=n.toLowerCase().indexOf("ipad")!==-1):/Kindle/.test(n)||/\bKF[A-Z][A-Z]+/.test(n)||/Silk.*Mobile Safari/.test(n)?i.kindle=!0:/CrOS/.test(n)&&(i.chromeOS=!0),(/Windows Phone/i.test(n)||/IEMobile/i.test(n))&&(i.android=!1,i.iOS=!1,i.macOS=!1,i.windows=!0,i.windowsPhone=!0);var r=/Silk/.test(n);return(i.windows||i.macOS||i.linux&&!r||i.chromeOS)&&(i.desktop=!0),(i.windowsPhone||/Windows NT/i.test(n)&&/Touch/i.test(n))&&(i.desktop=!1),navigator.standalone&&(i.webApp=!0),typeof importScripts!="function"&&(window.cordova!==void 0&&(i.cordova=!0),window.ejecta!==void 0&&(i.ejecta=!0)),typeof process<"u"&&process.versions&&process.versions.node&&(i.node=!0),i.node&&typeof process.versions=="object"&&(i.nodeWebkit=!!process.versions["node-webkit"],i.electron=!!process.versions.electron),/Crosswalk/.test(n)&&(i.crosswalk=!0),i.pixelRatio=window.devicePixelRatio||1,i}t.exports=s()}),Gn=S((e,t)=>{"use strict";var i=sn(),s={chrome:!1,chromeVersion:0,edge:!1,firefox:!1,firefoxVersion:0,ie:!1,ieVersion:0,mobileSafari:!1,opera:!1,safari:!1,safariVersion:0,silk:!1,trident:!1,tridentVersion:0,es2019:!1};function n(){var r=navigator.userAgent;return/Edg\/\d+/.test(r)?(s.edge=!0,s.es2019=!0):/OPR/.test(r)?(s.opera=!0,s.es2019=!0):/Chrome\/(\d+)/.test(r)&&!i.windowsPhone?(s.chrome=!0,s.chromeVersion=parseInt(RegExp.$1,10),s.es2019=s.chromeVersion>69):/Firefox\D+(\d+)/.test(r)?(s.firefox=!0,s.firefoxVersion=parseInt(RegExp.$1,10),s.es2019=s.firefoxVersion>10):/AppleWebKit\/(?!.*CriOS)/.test(r)&&i.iOS?(s.mobileSafari=!0,s.es2019=!0):/MSIE (\d+\.\d+);/.test(r)?(s.ie=!0,s.ieVersion=parseInt(RegExp.$1,10)):/Version\/(\d+\.\d+(\.\d+)?) Safari/.test(r)&&!i.windowsPhone?(s.safari=!0,s.safariVersion=parseInt(RegExp.$1,10),s.es2019=s.safariVersion>10):/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(r)&&(s.ie=!0,s.trident=!0,s.tridentVersion=parseInt(RegExp.$1,10),s.ieVersion=parseInt(RegExp.$3,10)),/Silk/.test(r)&&(s.silk=!0),s}t.exports=n()}),Yh=S((e,t)=>{"use strict";var i={DEFAULT:0,LINEAR:0,NEAREST:1};t.exports=i}),Ke=S((e,t)=>{"use strict";var i={VERSION:"3.88.2",LOG_VERSION:"v388",BlendModes:ms(),ScaleModes:Yh(),AUTO:0,CANVAS:1,WEBGL:2,HEADLESS:3,FOREVER:-1,NONE:4,UP:5,DOWN:6,LEFT:7,RIGHT:8};t.exports=i}),Hh=S((e,t)=>{"use strict";var i="",s=function(){var n=function(h){for(var l=["i","webkitI","msI","mozI","oI"],c=0;c<l.length;c++){var f=l[c]+"mageSmoothingEnabled";if(f in h)return f}return null},r=function(h){return i===""&&(i=n(h)),i&&(h[i]=!0),h},o=function(h){return i===""&&(i=n(h)),i&&(h[i]=!1),h},a=function(h){return i!==null?h[i]:null};return{disable:o,enable:r,getPrefix:n,isEnabled:a}};t.exports=s()}),Ne=S((e,t)=>{"use strict";var i=Ke(),s=Hh(),n=[],r=!1,o=function(){var a=function(m,E,v,y,T){E===void 0&&(E=1),v===void 0&&(v=1),y===void 0&&(y=i.CANVAS),T===void 0&&(T=!1);var A,x=c(y);return x===null?(x={parent:m,canvas:document.createElement("canvas"),type:y},y===i.CANVAS&&n.push(x),A=x.canvas):(x.parent=m,A=x.canvas),T&&(x.parent=A),A.width=E,A.height=v,r&&y===i.CANVAS&&s.disable(A.getContext("2d",{willReadFrequently:!1})),A},h=function(m,E,v){return a(m,E,v,i.CANVAS)},l=function(m,E,v){return a(m,E,v,i.WEBGL)},c=function(m){if(m===void 0&&(m=i.CANVAS),m===i.WEBGL)return null;for(var E=0;E<n.length;E++){var v=n[E];if(!v.parent&&v.type===m)return v}return null},f=function(m){var E=m instanceof HTMLCanvasElement;n.forEach(function(v){(E&&v.canvas===m||!E&&v.parent===m)&&(v.parent=null,v.canvas.width=1,v.canvas.height=1)})},u=function(){var m=0;return n.forEach(function(E){E.parent&&m++}),m},p=function(){return n.length-u()},d=function(){r=!0},g=function(){r=!1};return{create2D:h,create:a,createWebGL:l,disableSmoothing:d,enableSmoothing:g,first:c,free:p,pool:n,remove:f,total:u}};t.exports=o()}),la=S((e,t)=>{"use strict";var i=sn(),s=Gn(),n=Ne(),r={canvas:!1,canvasBitBltShift:null,file:!1,fileSystem:!1,getUserMedia:!0,littleEndian:!1,localStorage:!1,pointerLock:!1,stableSort:!1,support32bit:!1,vibration:!1,webGL:!1,worker:!1};function o(){var h=new ArrayBuffer(4),l=new Uint8Array(h),c=new Uint32Array(h);return l[0]=161,l[1]=178,l[2]=195,l[3]=212,c[0]===3569595041?!0:c[0]===2712847316?!1:null}function a(){if(typeof importScripts=="function")return r;r.canvas=!!window.CanvasRenderingContext2D;try{r.localStorage=!!localStorage.getItem}catch{r.localStorage=!1}r.file=!!window.File&&!!window.FileReader&&!!window.FileList&&!!window.Blob,r.fileSystem=!!window.requestFileSystem;var h=!1,l=function(){if(window.WebGLRenderingContext)try{var c=n.createWebGL(this),f=c.getContext("webgl")||c.getContext("experimental-webgl"),u=n.create2D(this),p=u.getContext("2d",{willReadFrequently:!0}),d=p.createImageData(1,1);return h=d.data instanceof Uint8ClampedArray,n.remove(c),n.remove(u),!!f}catch{return!1}return!1};return r.webGL=l(),r.worker=!!window.Worker,r.pointerLock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,r.getUserMedia=r.getUserMedia&&!!navigator.getUserMedia&&!!window.URL,s.firefox&&s.firefoxVersion<21&&(r.getUserMedia=!1),!i.iOS&&(s.ie||s.firefox||s.chrome)&&(r.canvasBitBltShift=!0),(s.safari||s.mobileSafari)&&(r.canvasBitBltShift=!1),navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate,navigator.vibrate&&(r.vibration=!0),typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint32Array<"u"&&(r.littleEndian=o()),r.support32bit=typeof ArrayBuffer<"u"&&typeof Uint8ClampedArray<"u"&&typeof Int32Array<"u"&&r.littleEndian!==null&&h,r}t.exports=a()}),am=S((e,t)=>{"use strict";var i=Gn(),s={gamepads:!1,mspointer:!1,touch:!1,wheelEvent:null};function n(){return typeof importScripts=="function"||(("ontouchstart"in document.documentElement||navigator.maxTouchPoints&&navigator.maxTouchPoints>=1)&&(s.touch=!0),(navigator.msPointerEnabled||navigator.pointerEnabled)&&(s.mspointer=!0),navigator.getGamepads&&(s.gamepads=!0),"onwheel"in window||i.ie&&"WheelEvent"in window?s.wheelEvent="wheel":"onmousewheel"in window?s.wheelEvent="mousewheel":i.firefox&&"MouseScrollEvent"in window&&(s.wheelEvent="DOMMouseScroll")),s}t.exports=n()}),om=S((e,t)=>{"use strict";var i=Gn(),s={flac:!1,aac:!1,audioData:!1,dolby:!1,m4a:!1,mp3:!1,ogg:!1,opus:!1,wav:!1,webAudio:!1,webm:!1};function n(){if(typeof importScripts=="function")return s;s.audioData=!!window.Audio,s.webAudio=!!(window.AudioContext||window.webkitAudioContext);var r=document.createElement("audio"),o=!!r.canPlayType;try{if(o){var a=function(c,f){var u=r.canPlayType("audio/"+c).replace(/^no$/,"");return f?!!(u||r.canPlayType("audio/"+f).replace(/^no$/,"")):!!u};if(s.ogg=a('ogg; codecs="vorbis"'),s.opus=a('ogg; codecs="opus"',"opus"),s.mp3=a("mpeg"),s.wav=a("wav"),s.m4a=a("x-m4a"),s.aac=a("aac"),s.flac=a("flac","x-flac"),s.webm=a('webm; codecs="vorbis"'),r.canPlayType('audio/mp4; codecs="ec-3"')!==""){if(i.edge)s.dolby=!0;else if(i.safari&&i.safariVersion>=9&&/Mac OS X (\d+)_(\d+)/.test(navigator.userAgent)){var h=parseInt(RegExp.$1,10),l=parseInt(RegExp.$2,10);(h===10&&l>=11||h>10)&&(s.dolby=!0)}}}}catch{}return s}t.exports=n()}),pt=S((e,t)=>{"use strict";var i=function(s,n,r){var o=typeof s;return!s||o==="number"||o==="string"?r:s.hasOwnProperty(n)&&s[n]!==void 0?s[n]:r};t.exports=i}),hm=S((e,t)=>{"use strict";var i=pt(),s={h264:!1,hls:!1,mp4:!1,m4v:!1,ogg:!1,vp9:!1,webm:!1,hasRequestVideoFrame:!1};function n(){if(typeof importScripts=="function")return s;var r=document.createElement("video"),o=!!r.canPlayType,a=/^no$/;try{o&&(r.canPlayType('video/ogg; codecs="theora"').replace(a,"")&&(s.ogg=!0),r.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(a,"")&&(s.h264=!0,s.mp4=!0),r.canPlayType("video/x-m4v").replace(a,"")&&(s.m4v=!0),r.canPlayType('video/webm; codecs="vp8, vorbis"').replace(a,"")&&(s.webm=!0),r.canPlayType('video/webm; codecs="vp9"').replace(a,"")&&(s.vp9=!0),r.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(a,"")&&(s.hls=!0))}catch{}return r.parentNode&&r.parentNode.removeChild(r),s.getVideoURL=function(h){Array.isArray(h)||(h=[h]);for(var l=0;l<h.length;l++){var c=i(h[l],"url",h[l]);if(c.indexOf("blob:")===0)return{url:c,type:""};var f;if(c.indexOf("data:")===0?f=c.split(",")[0].match(/\/(.*?);/):f=c.match(/\.([a-zA-Z0-9]+)($|\?)/),f=i(h[l],"type",f?f[1]:"").toLowerCase(),s[f])return{url:c,type:f}}return null},s}t.exports=n()}),lm=S((e,t)=>{"use strict";var i={available:!1,cancel:"",keyboard:!1,request:""};function s(){if(typeof importScripts=="function")return i;var n,r="Fullscreen",o="FullScreen",a=["request"+r,"request"+o,"webkitRequest"+r,"webkitRequest"+o,"msRequest"+r,"msRequest"+o,"mozRequest"+o,"mozRequest"+r];for(n=0;n<a.length;n++)if(document.documentElement[a[n]]){i.available=!0,i.request=a[n];break}var h=["cancel"+o,"exit"+r,"webkitCancel"+o,"webkitExit"+r,"msCancel"+o,"msExit"+r,"mozCancel"+o,"mozExit"+r];if(i.available){for(n=0;n<h.length;n++)if(document[h[n]]){i.cancel=h[n];break}}return window.Element&&Element.ALLOW_KEYBOARD_INPUT&&!/ Version\/5\.1(?:\.\d+)? Safari\//.test(navigator.userAgent)&&(i.keyboard=!0),Object.defineProperty(i,"active",{get:function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}}),i}t.exports=s()}),Yn=S((e,t)=>{"use strict";t.exports={os:sn(),browser:Gn(),features:la(),input:am(),audio:om(),video:hm(),fullscreen:lm()}}),Hn=S((e,t)=>{"use strict";var i=Yn();function s(a,h){return String(a).localeCompare(h)}function n(a,h){var l=a.length;if(l<=1)return a;for(var c=new Array(l),f=1;f<l;f*=2){r(a,h,f,c);var u=a;a=c,c=u}return a}function r(a,h,l,c){var f=a.length,u=0,p=l*2,d,g,m,E,v;for(d=0;d<f;d+=p)for(g=d+l,m=g+l,g>f&&(g=f),m>f&&(m=f),E=d,v=g;;)if(E<g&&v<m)h(a[E],a[v])<=0?c[u++]=a[E++]:c[u++]=a[v++];else if(E<g)c[u++]=a[E++];else if(v<m)c[u++]=a[v++];else break}var o=function(a,h){if(h===void 0&&(h=s),!a||a.length<2)return a;if(i.features.stableSort)return a.sort(h);var l=n(a,h);return l!==a&&r(l,null,a.length,a),a};t.exports=o}),um=S((e,t)=>{"use strict";var i=function(s,n,r){if(n===r)return s;var o=s.indexOf(n),a=s.indexOf(r);if(o<0||a<0)throw new Error("Supplied items must be elements of the same array");return s[o]=r,s[a]=n,s};t.exports=i}),ua=S((e,t)=>{"use strict";t.exports={Matrix:Gf(),Add:Yf(),AddAt:Hf(),BringToTop:Wf(),CountAllMatching:zf(),Each:Fn(),EachInRange:Vf(),FindClosestInSorted:Dh(),Flatten:kh(),GetAll:oa(),GetFirst:Bh(),GetRandom:Nh(),MoveDown:Xf(),MoveTo:Kf(),MoveUp:jf(),MoveAbove:Zf(),MoveBelow:qf(),NumberArray:Uh(),NumberArrayStep:Jf(),QuickSelect:$f(),Range:Fh(),Remove:Pi(),RemoveAt:tm(),RemoveBetween:em(),RemoveRandomElement:im(),Replace:sm(),RotateLeft:ra(),RotateRight:aa(),SafeRange:zi(),SendToBack:nm(),SetAll:rm(),Shuffle:ha(),SortByDigits:Gh(),SpliceOne:en(),StableSort:Hn(),Swap:um()}}),cm=S((e,t)=>{"use strict";var i=ua(),s={_depth:0,depth:{get:function(){return this._depth},set:function(n){this.displayList&&this.displayList.queueDepthSort(),this._depth=n}},setDepth:function(n){return n===void 0&&(n=0),this.depth=n,this},setToTop:function(){var n=this.getDisplayList();return n&&i.BringToTop(n,this),this},setToBack:function(){var n=this.getDisplayList();return n&&i.SendToBack(n,this),this},setAbove:function(n){var r=this.getDisplayList();return r&&n&&i.MoveAbove(r,this,n),this},setBelow:function(n){var r=this.getDisplayList();return r&&n&&i.MoveBelow(r,this,n),this}};t.exports=s}),dm=S((e,t)=>{"use strict";var i={flipX:!1,flipY:!1,toggleFlipX:function(){return this.flipX=!this.flipX,this},toggleFlipY:function(){return this.flipY=!this.flipY,this},setFlipX:function(s){return this.flipX=s,this},setFlipY:function(s){return this.flipY=s,this},setFlip:function(s,n){return this.flipX=s,this.flipY=n,this},resetFlip:function(){return this.flipX=!1,this.flipY=!1,this}};t.exports=i}),vs=S((e,t)=>{"use strict";var i=function(s,n,r){return s.width<=0||s.height<=0?!1:s.x<=n&&s.x+s.width>=n&&s.y<=r&&s.y+s.height>=r};t.exports=i}),Wn=S((e,t)=>{"use strict";var i=function(s){return 2*(s.width+s.height)};t.exports=i}),Es=S((e,t)=>{"use strict";var i={CIRCLE:0,ELLIPSE:1,LINE:2,POINT:3,POLYGON:4,RECTANGLE:5,TRIANGLE:6};t.exports=i}),$t=S((e,t)=>{"use strict";var i=V(),s=Es(),n=new i({initialize:function(r,o){r===void 0&&(r=0),o===void 0&&(o=r),this.type=s.POINT,this.x=r,this.y=o},setTo:function(r,o){return r===void 0&&(r=0),o===void 0&&(o=r),this.x=r,this.y=o,this}});t.exports=n}),ca=S((e,t)=>{"use strict";var i=Wn(),s=$t(),n=function(r,o,a){if(a===void 0&&(a=new s),o<=0||o>=1)return a.x=r.x,a.y=r.y,a;var h=i(r)*o;return o>.5?(h-=r.width+r.height,h<=r.width?(a.x=r.right-h,a.y=r.bottom):(a.x=r.x,a.y=r.bottom-(h-r.width))):h<=r.width?(a.x=r.x+h,a.y=r.y):(a.x=r.right,a.y=r.y+(h-r.width)),a};t.exports=n}),Wh=S((e,t)=>{"use strict";var i=ca(),s=Wn(),n=function(r,o,a,h){h===void 0&&(h=[]),!o&&a>0&&(o=s(r)/a);for(var l=0;l<o;l++){var c=l/o;h.push(i(r,c))}return h};t.exports=n}),pm=S((e,t)=>{"use strict";var i=$t(),s=function(n,r,o){return o===void 0&&(o=new i),o.x=n.x1+(n.x2-n.x1)*r,o.y=n.y1+(n.y2-n.y1)*r,o};t.exports=s}),gm=S((e,t)=>{"use strict";var i=function(s){return Math.sqrt((s.x2-s.x1)*(s.x2-s.x1)+(s.y2-s.y1)*(s.y2-s.y1))};t.exports=i}),zh=S((e,t)=>{"use strict";var i=gm(),s=$t(),n=function(r,o,a,h){h===void 0&&(h=[]),!o&&a>0&&(o=i(r)/a);for(var l=r.x1,c=r.y1,f=r.x2,u=r.y2,p=0;p<o;p++){var d=p/o,g=l+(f-l)*d,m=c+(u-c)*d;h.push(new s(g,m))}return h};t.exports=n}),Vh=S((e,t)=>{"use strict";var i=$t(),s=function(n,r){r===void 0&&(r=new i);var o=Math.random();return r.x=n.x1+o*(n.x2-n.x1),r.y=n.y1+o*(n.y2-n.y1),r};t.exports=s}),Xh=S((e,t)=>{"use strict";var i=function(s,n,r){return r===void 0&&(r=1e-4),Math.abs(s-n)<r};t.exports=i}),Ot=S((e,t)=>{"use strict";var i=V(),s=Xh(),n=new i({initialize:function(r,o){this.x=0,this.y=0,typeof r=="object"?(this.x=r.x||0,this.y=r.y||0):(o===void 0&&(o=r),this.x=r||0,this.y=o||0)},clone:function(){return new n(this.x,this.y)},copy:function(r){return this.x=r.x||0,this.y=r.y||0,this},setFromObject:function(r){return this.x=r.x||0,this.y=r.y||0,this},set:function(r,o){return o===void 0&&(o=r),this.x=r,this.y=o,this},setTo:function(r,o){return this.set(r,o)},setToPolar:function(r,o){return o==null&&(o=1),this.x=Math.cos(r)*o,this.y=Math.sin(r)*o,this},equals:function(r){return this.x===r.x&&this.y===r.y},fuzzyEquals:function(r,o){return s(this.x,r.x,o)&&s(this.y,r.y,o)},angle:function(){var r=Math.atan2(this.y,this.x);return r<0&&(r+=2*Math.PI),r},setAngle:function(r){return this.setToPolar(r,this.length())},add:function(r){return this.x+=r.x,this.y+=r.y,this},subtract:function(r){return this.x-=r.x,this.y-=r.y,this},multiply:function(r){return this.x*=r.x,this.y*=r.y,this},scale:function(r){return isFinite(r)?(this.x*=r,this.y*=r):(this.x=0,this.y=0),this},divide:function(r){return this.x/=r.x,this.y/=r.y,this},negate:function(){return this.x=-this.x,this.y=-this.y,this},distance:function(r){var o=r.x-this.x,a=r.y-this.y;return Math.sqrt(o*o+a*a)},distanceSq:function(r){var o=r.x-this.x,a=r.y-this.y;return o*o+a*a},length:function(){var r=this.x,o=this.y;return Math.sqrt(r*r+o*o)},setLength:function(r){return this.normalize().scale(r)},lengthSq:function(){var r=this.x,o=this.y;return r*r+o*o},normalize:function(){var r=this.x,o=this.y,a=r*r+o*o;return a>0&&(a=1/Math.sqrt(a),this.x=r*a,this.y=o*a),this},normalizeRightHand:function(){var r=this.x;return this.x=this.y*-1,this.y=r,this},normalizeLeftHand:function(){var r=this.x;return this.x=this.y,this.y=r*-1,this},dot:function(r){return this.x*r.x+this.y*r.y},cross:function(r){return this.x*r.y-this.y*r.x},lerp:function(r,o){o===void 0&&(o=0);var a=this.x,h=this.y;return this.x=a+o*(r.x-a),this.y=h+o*(r.y-h),this},transformMat3:function(r){var o=this.x,a=this.y,h=r.val;return this.x=h[0]*o+h[3]*a+h[6],this.y=h[1]*o+h[4]*a+h[7],this},transformMat4:function(r){var o=this.x,a=this.y,h=r.val;return this.x=h[0]*o+h[4]*a+h[12],this.y=h[1]*o+h[5]*a+h[13],this},reset:function(){return this.x=0,this.y=0,this},limit:function(r){var o=this.length();return o&&o>r&&this.scale(r/o),this},reflect:function(r){return r=r.clone().normalize(),this.subtract(r.scale(2*this.dot(r)))},mirror:function(r){return this.reflect(r).negate()},rotate:function(r){var o=Math.cos(r),a=Math.sin(r);return this.set(o*this.x-a*this.y,a*this.x+o*this.y)},project:function(r){var o=this.dot(r)/r.dot(r);return this.copy(r).scale(o)}});n.ZERO=new n,n.RIGHT=new n(1,0),n.LEFT=new n(-1,0),n.UP=new n(0,-1),n.DOWN=new n(0,1),n.ONE=new n(1,1),t.exports=n}),da=S((e,t)=>{"use strict";var i=V(),s=pm(),n=zh(),r=Es(),o=Vh(),a=Ot(),h=new i({initialize:function(l,c,f,u){l===void 0&&(l=0),c===void 0&&(c=0),f===void 0&&(f=0),u===void 0&&(u=0),this.type=r.LINE,this.x1=l,this.y1=c,this.x2=f,this.y2=u},getPoint:function(l,c){return s(this,l,c)},getPoints:function(l,c,f){return n(this,l,c,f)},getRandomPoint:function(l){return o(this,l)},setTo:function(l,c,f,u){return l===void 0&&(l=0),c===void 0&&(c=0),f===void 0&&(f=0),u===void 0&&(u=0),this.x1=l,this.y1=c,this.x2=f,this.y2=u,this},setFromObjects:function(l,c){return this.x1=l.x,this.y1=l.y,this.x2=c.x,this.y2=c.y,this},getPointA:function(l){return l===void 0&&(l=new a),l.set(this.x1,this.y1),l},getPointB:function(l){return l===void 0&&(l=new a),l.set(this.x2,this.y2),l},left:{get:function(){return Math.min(this.x1,this.x2)},set:function(l){this.x1<=this.x2?this.x1=l:this.x2=l}},right:{get:function(){return Math.max(this.x1,this.x2)},set:function(l){this.x1>this.x2?this.x1=l:this.x2=l}},top:{get:function(){return Math.min(this.y1,this.y2)},set:function(l){this.y1<=this.y2?this.y1=l:this.y2=l}},bottom:{get:function(){return Math.max(this.y1,this.y2)},set:function(l){this.y1>this.y2?this.y1=l:this.y2=l}}});t.exports=h}),pa=S((e,t)=>{"use strict";var i=$t(),s=function(n,r){return r===void 0&&(r=new i),r.x=n.x+Math.random()*n.width,r.y=n.y+Math.random()*n.height,r};t.exports=s}),zt=S((e,t)=>{"use strict";var i=V(),s=vs(),n=ca(),r=Wh(),o=Es(),a=da(),h=pa(),l=new i({initialize:function(c,f,u,p){c===void 0&&(c=0),f===void 0&&(f=0),u===void 0&&(u=0),p===void 0&&(p=0),this.type=o.RECTANGLE,this.x=c,this.y=f,this.width=u,this.height=p},contains:function(c,f){return s(this,c,f)},getPoint:function(c,f){return n(this,c,f)},getPoints:function(c,f,u){return r(this,c,f,u)},getRandomPoint:function(c){return h(this,c)},setTo:function(c,f,u,p){return this.x=c,this.y=f,this.width=u,this.height=p,this},setEmpty:function(){return this.setTo(0,0,0,0)},setPosition:function(c,f){return f===void 0&&(f=c),this.x=c,this.y=f,this},setSize:function(c,f){return f===void 0&&(f=c),this.width=c,this.height=f,this},isEmpty:function(){return this.width<=0||this.height<=0},getLineA:function(c){return c===void 0&&(c=new a),c.setTo(this.x,this.y,this.right,this.y),c},getLineB:function(c){return c===void 0&&(c=new a),c.setTo(this.right,this.y,this.right,this.bottom),c},getLineC:function(c){return c===void 0&&(c=new a),c.setTo(this.right,this.bottom,this.x,this.bottom),c},getLineD:function(c){return c===void 0&&(c=new a),c.setTo(this.x,this.bottom,this.x,this.y),c},left:{get:function(){return this.x},set:function(c){c>=this.right?this.width=0:this.width=this.right-c,this.x=c}},right:{get:function(){return this.x+this.width},set:function(c){c<=this.x?this.width=0:this.width=c-this.x}},top:{get:function(){return this.y},set:function(c){c>=this.bottom?this.height=0:this.height=this.bottom-c,this.y=c}},bottom:{get:function(){return this.y+this.height},set:function(c){c<=this.y?this.height=0:this.height=c-this.y}},centerX:{get:function(){return this.x+this.width/2},set:function(c){this.x=c-this.width/2}},centerY:{get:function(){return this.y+this.height/2},set:function(c){this.y=c-this.height/2}}});t.exports=l}),Kh=S((e,t)=>{"use strict";var i=function(s,n,r,o){var a=Math.cos(o),h=Math.sin(o),l=s.x-n,c=s.y-r;return s.x=l*a-c*h+n,s.y=l*h+c*a+r,s};t.exports=i}),fm=S((e,t)=>{"use strict";var i=zt(),s=Kh(),n=Ot(),r={prepareBoundsOutput:function(o,a){if(a===void 0&&(a=!1),this.rotation!==0&&s(o,this.x,this.y,this.rotation),a&&this.parentContainer){var h=this.parentContainer.getBoundsTransformMatrix();h.transformPoint(o.x,o.y,o)}return o},getCenter:function(o,a){return o===void 0&&(o=new n),o.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,o.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(o,a)},getTopLeft:function(o,a){return o||(o=new n),o.x=this.x-this.displayWidth*this.originX,o.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(o,a)},getTopCenter:function(o,a){return o||(o=new n),o.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,o.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(o,a)},getTopRight:function(o,a){return o||(o=new n),o.x=this.x-this.displayWidth*this.originX+this.displayWidth,o.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(o,a)},getLeftCenter:function(o,a){return o||(o=new n),o.x=this.x-this.displayWidth*this.originX,o.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(o,a)},getRightCenter:function(o,a){return o||(o=new n),o.x=this.x-this.displayWidth*this.originX+this.displayWidth,o.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(o,a)},getBottomLeft:function(o,a){return o||(o=new n),o.x=this.x-this.displayWidth*this.originX,o.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(o,a)},getBottomCenter:function(o,a){return o||(o=new n),o.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,o.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(o,a)},getBottomRight:function(o,a){return o||(o=new n),o.x=this.x-this.displayWidth*this.originX+this.displayWidth,o.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(o,a)},getBounds:function(o){o===void 0&&(o=new i);var a,h,l,c,f,u,p,d;if(this.parentContainer){var g=this.parentContainer.getBoundsTransformMatrix();this.getTopLeft(o),g.transformPoint(o.x,o.y,o),a=o.x,h=o.y,this.getTopRight(o),g.transformPoint(o.x,o.y,o),l=o.x,c=o.y,this.getBottomLeft(o),g.transformPoint(o.x,o.y,o),f=o.x,u=o.y,this.getBottomRight(o),g.transformPoint(o.x,o.y,o),p=o.x,d=o.y}else this.getTopLeft(o),a=o.x,h=o.y,this.getTopRight(o),l=o.x,c=o.y,this.getBottomLeft(o),f=o.x,u=o.y,this.getBottomRight(o),p=o.x,d=o.y;return o.x=Math.min(a,l,f,p),o.y=Math.min(h,c,u,d),o.width=Math.max(a,l,f,p)-o.x,o.height=Math.max(h,c,u,d)-o.y,o}};t.exports=r}),ae=S((e,t)=>{"use strict";var i={},s={},n={};n.register=function(r,o,a,h){h===void 0&&(h=!1),i[r]={plugin:o,mapping:a,custom:h}},n.registerCustom=function(r,o,a,h){s[r]={plugin:o,mapping:a,data:h}},n.hasCore=function(r){return i.hasOwnProperty(r)},n.hasCustom=function(r){return s.hasOwnProperty(r)},n.getCore=function(r){return i[r]},n.getCustom=function(r){return s[r]},n.getCustomClass=function(r){return s.hasOwnProperty(r)?s[r].plugin:null},n.remove=function(r){i.hasOwnProperty(r)&&delete i[r]},n.removeCustom=function(r){s.hasOwnProperty(r)&&delete s[r]},n.destroyCorePlugins=function(){for(var r in i)i.hasOwnProperty(r)&&delete i[r]},n.destroyCustomPlugins=function(){for(var r in s)s.hasOwnProperty(r)&&delete s[r]},t.exports=n}),mm=S((e,t)=>{"use strict";t.exports="addedtoscene"}),vm=S((e,t)=>{"use strict";t.exports="boot"}),Em=S((e,t)=>{"use strict";t.exports="create"}),ym=S((e,t)=>{"use strict";t.exports="destroy"}),Tm=S((e,t)=>{"use strict";t.exports="pause"}),Sm=S((e,t)=>{"use strict";t.exports="postupdate"}),Am=S((e,t)=>{"use strict";t.exports="prerender"}),xm=S((e,t)=>{"use strict";t.exports="preupdate"}),wm=S((e,t)=>{"use strict";t.exports="ready"}),Rm=S((e,t)=>{"use strict";t.exports="removedfromscene"}),Cm=S((e,t)=>{"use strict";t.exports="render"}),_m=S((e,t)=>{"use strict";t.exports="resume"}),bm=S((e,t)=>{"use strict";t.exports="shutdown"}),Pm=S((e,t)=>{"use strict";t.exports="sleep"}),Lm=S((e,t)=>{"use strict";t.exports="start"}),Im=S((e,t)=>{"use strict";t.exports="transitioncomplete"}),Mm=S((e,t)=>{"use strict";t.exports="transitioninit"}),Om=S((e,t)=>{"use strict";t.exports="transitionout"}),Dm=S((e,t)=>{"use strict";t.exports="transitionstart"}),km=S((e,t)=>{"use strict";t.exports="transitionwake"}),Bm=S((e,t)=>{"use strict";t.exports="update"}),Nm=S((e,t)=>{"use strict";t.exports="wake"}),Nt=S((e,t)=>{"use strict";t.exports={ADDED_TO_SCENE:mm(),BOOT:vm(),CREATE:Em(),DESTROY:ym(),PAUSE:Tm(),POST_UPDATE:Sm(),PRE_RENDER:Am(),PRE_UPDATE:xm(),READY:wm(),REMOVED_FROM_SCENE:Rm(),RENDER:Cm(),RESUME:_m(),SHUTDOWN:bm(),SLEEP:Pm(),START:Lm(),TRANSITION_COMPLETE:Im(),TRANSITION_INIT:Mm(),TRANSITION_OUT:Om(),TRANSITION_START:Dm(),TRANSITION_WAKE:km(),UPDATE:Bm(),WAKE:Nm()}}),jt=S((e,t)=>{"use strict";var i=V(),s=ae(),n=Nt(),r=new i({initialize:function(o){this.scene=o,this.systems=o.sys,this.events=o.sys.events,this.displayList,this.updateList,this.events.once(n.BOOT,this.boot,this),this.events.on(n.START,this.start,this)},boot:function(){this.displayList=this.systems.displayList,this.updateList=this.systems.updateList,this.events.once(n.DESTROY,this.destroy,this)},start:function(){this.events.once(n.SHUTDOWN,this.shutdown,this)},existing:function(o){return(o.renderCanvas||o.renderWebGL)&&this.displayList.add(o),o.preUpdate&&this.updateList.add(o),o},shutdown:function(){this.events.off(n.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(n.START,this.start,this),this.scene=null,this.systems=null,this.events=null,this.displayList=null,this.updateList=null}});r.register=function(o,a){r.prototype.hasOwnProperty(o)||(r.prototype[o]=a)},r.remove=function(o){r.prototype.hasOwnProperty(o)&&delete r.prototype[o]},s.register("GameObjectFactory",r,"add"),t.exports=r}),jh=S((e,t)=>{"use strict";var i=V(),s=jt(),n=new i({initialize:function(r,o,a,h,l,c){o||(o=r.sys.make.image({x:a,y:h,key:l,frame:c,add:!1})),this.bitmapMask=o,this.invertAlpha=!1,this.isStencil=!1},setBitmap:function(r){this.bitmapMask=r},preRenderWebGL:function(r,o,a){r.pipelines.BITMAPMASK_PIPELINE.beginMask(this,o,a)},postRenderWebGL:function(r,o,a){r.pipelines.BITMAPMASK_PIPELINE.endMask(this,o,a)},preRenderCanvas:function(){},postRenderCanvas:function(){},destroy:function(){this.bitmapMask=null}});s.register("bitmapMask",function(r,o,a,h,l){return new n(this.scene,r,o,a,h,l)}),t.exports=n}),Zh=S((e,t)=>{"use strict";var i=V(),s=new i({initialize:function(n,r){this.geometryMask=r,this.invertAlpha=!1,this.isStencil=!0,this.level=0},setShape:function(n){return this.geometryMask=n,this},setInvertAlpha:function(n){return n===void 0&&(n=!0),this.invertAlpha=n,this},preRenderWebGL:function(n,r,o){var a=n.gl;n.flush(),n.maskStack.length===0&&(a.enable(a.STENCIL_TEST),a.clear(a.STENCIL_BUFFER_BIT),n.maskCount=0),n.currentCameraMask.mask!==this&&(n.currentMask.mask=this),n.maskStack.push({mask:this,camera:o}),this.applyStencil(n,o,!0),n.maskCount++},applyStencil:function(n,r,o){var a=n.gl,h=this.geometryMask,l=n.maskCount,c=255;a.colorMask(!1,!1,!1,!1),o?(a.stencilFunc(a.EQUAL,l,c),a.stencilOp(a.KEEP,a.KEEP,a.INCR),l++):(a.stencilFunc(a.EQUAL,l+1,c),a.stencilOp(a.KEEP,a.KEEP,a.DECR)),this.level=l,h.renderWebGL(n,h,r),n.flush(),a.colorMask(!0,!0,!0,!0),a.stencilOp(a.KEEP,a.KEEP,a.KEEP),this.invertAlpha?a.stencilFunc(a.NOTEQUAL,l,c):a.stencilFunc(a.EQUAL,l,c)},postRenderWebGL:function(n){var r=n.gl;n.maskStack.pop(),n.maskCount--,n.flush();var o=n.currentMask;if(n.maskStack.length===0)o.mask=null,r.disable(r.STENCIL_TEST);else{var a=n.maskStack[n.maskStack.length-1];a.mask.applyStencil(n,a.camera,!1),n.currentCameraMask.mask!==a.mask?(o.mask=a.mask,o.camera=a.camera):o.mask=null}},preRenderCanvas:function(n,r,o){var a=this.geometryMask;n.currentContext.save(),a.renderCanvas(n,a,o,null,null,!0),n.currentContext.clip()},postRenderCanvas:function(n){n.currentContext.restore()},destroy:function(){this.geometryMask=null}});t.exports=s}),Um=S((e,t)=>{"use strict";var i=jh(),s=Zh(),n={mask:null,setMask:function(r){return this.mask=r,this},clearMask:function(r){return r===void 0&&(r=!1),r&&this.mask&&this.mask.destroy(),this.mask=null,this},createBitmapMask:function(r,o,a,h,l){return r===void 0&&(this.texture||this.shader||this.geom)&&(r=this),new i(this.scene,r,o,a,h,l)},createGeometryMask:function(r){return r===void 0&&(this.type==="Graphics"||this.geom)&&(r=this),new s(this.scene,r)}};t.exports=n}),Fm=S((e,t)=>{"use strict";var i={_originComponent:!0,originX:.5,originY:.5,_displayOriginX:0,_displayOriginY:0,displayOriginX:{get:function(){return this._displayOriginX},set:function(s){this._displayOriginX=s,this.originX=s/this.width}},displayOriginY:{get:function(){return this._displayOriginY},set:function(s){this._displayOriginY=s,this.originY=s/this.height}},setOrigin:function(s,n){return s===void 0&&(s=.5),n===void 0&&(n=s),this.originX=s,this.originY=n,this.updateDisplayOrigin()},setOriginFromFrame:function(){return!this.frame||!this.frame.customPivot?this.setOrigin():(this.originX=this.frame.pivotX,this.originY=this.frame.pivotY,this.updateDisplayOrigin())},setDisplayOrigin:function(s,n){return s===void 0&&(s=0),n===void 0&&(n=s),this.displayOriginX=s,this.displayOriginY=n,this},updateDisplayOrigin:function(){return this._displayOriginX=this.originX*this.width,this._displayOriginY=this.originY*this.height,this}};t.exports=i}),ga=S((e,t)=>{"use strict";var i=function(s){var n,r,o;if(typeof s!="object"||s===null)return s;n=Array.isArray(s)?[]:{};for(o in s)r=s[o],n[o]=i(r);return n};t.exports=i}),Gm=S((e,t)=>{"use strict";var i=ga(),s={defaultPipeline:null,pipeline:null,pipelineData:null,initPipeline:function(n){this.pipelineData={};var r=this.scene.sys.renderer;if(!r)return!1;var o=r.pipelines;if(o){n===void 0&&(n=o.default);var a=o.get(n);if(a)return this.defaultPipeline=a,this.pipeline=a,!0}return!1},setPipeline:function(n,r,o){var a=this.scene.sys.renderer;if(!a)return this;var h=a.pipelines;if(h){var l=h.get(n);l&&(this.pipeline=l),r&&(this.pipelineData=o?i(r):r)}return this},setPipelineData:function(n,r){var o=this.pipelineData;return r===void 0?delete o[n]:o[n]=r,this},resetPipeline:function(n){return n===void 0&&(n=!1),this.pipeline=this.defaultPipeline,n&&(this.pipelineData={}),this.pipeline!==null},getPipelineName:function(){return this.pipeline===null?null:this.pipeline.name}};t.exports=s}),Ym=S((e,t)=>{"use strict";var i=ga(),s=en(),n={hasPostPipeline:!1,postPipelines:null,postPipelineData:null,preFX:null,postFX:null,initPostPipeline:function(r){this.postPipelines=[],this.postPipelineData={}},setPostPipeline:function(r,o,a){var h=this.scene.sys.renderer;if(!h)return this;var l=h.pipelines;if(l){Array.isArray(r)||(r=[r]);for(var c=0;c<r.length;c++){var f=l.getPostPipeline(r[c],this,o);f&&this.postPipelines.push(f)}o&&(this.postPipelineData=a?i(o):o)}return this.hasPostPipeline=this.postPipelines.length>0,this},setPostPipelineData:function(r,o){var a=this.postPipelineData;return o===void 0?delete a[r]:a[r]=o,this},getPostPipeline:function(r){for(var o=typeof r=="string",a=this.postPipelines,h=[],l=0;l<a.length;l++){var c=a[l];(o&&c.name===r||!o&&c instanceof r)&&h.push(c)}return h.length===1?h[0]:h},resetPostPipeline:function(r){r===void 0&&(r=!1);for(var o=this.postPipelines,a=0;a<o.length;a++)o[a].destroy();this.postPipelines=[],this.hasPostPipeline=!1,r&&(this.postPipelineData={})},removePostPipeline:function(r){for(var o=typeof r=="string",a=this.postPipelines,h=a.length-1;h>=0;h--){var l=a[h];(o&&l.name===r||!o&&l===r)&&(l.destroy(),s(a,h))}return this.hasPostPipeline=this.postPipelines.length>0,this},clearFX:function(){return this.preFX&&this.preFX.clear(),this.postFX&&this.postFX.clear(),this}};t.exports=n}),Hm=S((e,t)=>{"use strict";var i={scrollFactorX:1,scrollFactorY:1,setScrollFactor:function(s,n){return n===void 0&&(n=s),this.scrollFactorX=s,this.scrollFactorY=n,this}};t.exports=i}),Wm=S((e,t)=>{"use strict";var i={_sizeComponent:!0,width:0,height:0,displayWidth:{get:function(){return Math.abs(this.scaleX*this.frame.realWidth)},set:function(s){this.scaleX=s/this.frame.realWidth}},displayHeight:{get:function(){return Math.abs(this.scaleY*this.frame.realHeight)},set:function(s){this.scaleY=s/this.frame.realHeight}},setSizeToFrame:function(s){s||(s=this.frame),this.width=s.realWidth,this.height=s.realHeight;var n=this.input;return n&&!n.customHitArea&&(n.hitArea.width=this.width,n.hitArea.height=this.height),this},setSize:function(s,n){return this.width=s,this.height=n,this},setDisplaySize:function(s,n){return this.displayWidth=s,this.displayHeight=n,this}};t.exports=i}),oe=S((e,t)=>{"use strict";var i=function(s){if(!s||typeof s!="object"||s.nodeType||s===s.window)return!1;try{if(s.constructor&&!{}.hasOwnProperty.call(s.constructor.prototype,"isPrototypeOf"))return!1}catch{return!1}return!0};t.exports=i}),Re=S((e,t)=>{"use strict";var i=oe(),s=function(){var n,r,o,a,h,l,c=arguments[0]||{},f=1,u=arguments.length,p=!1;for(typeof c=="boolean"&&(p=c,c=arguments[1]||{},f=2),u===f&&(c=this,--f);f<u;f++)if((n=arguments[f])!=null)for(r in n)o=c[r],a=n[r],c!==a&&(p&&a&&(i(a)||(h=Array.isArray(a)))?(h?(h=!1,l=o&&Array.isArray(o)?o:[]):l=o&&i(o)?o:{},c[r]=s(p,l,a)):a!==void 0&&(c[r]=a));return c};t.exports=s}),nn=S((e,t)=>{"use strict";var i=V(),s=Xt(),n=Re(),r=new i({initialize:function(o,a,h,l,c,f,u){this.texture=o,this.name=a,this.source=o.source[h],this.sourceIndex=h,this.cutX,this.cutY,this.cutWidth,this.cutHeight,this.x=0,this.y=0,this.width,this.height,this.halfWidth,this.halfHeight,this.centerX,this.centerY,this.pivotX=0,this.pivotY=0,this.customPivot=!1,this.rotated=!1,this.autoRound=-1,this.customData={},this.u0=0,this.v0=0,this.u1=0,this.v1=0,this.data={cut:{x:0,y:0,w:0,h:0,r:0,b:0},trim:!1,sourceSize:{w:0,h:0},spriteSourceSize:{x:0,y:0,w:0,h:0,r:0,b:0},radius:0,drawImage:{x:0,y:0,width:0,height:0},is3Slice:!1,scale9:!1,scale9Borders:{x:0,y:0,w:0,h:0}},this.setSize(f,u,l,c)},setCutPosition:function(o,a){return o===void 0&&(o=0),a===void 0&&(a=0),this.cutX=o,this.cutY=a,this.updateUVs()},setCutSize:function(o,a){return this.cutWidth=o,this.cutHeight=a,this.updateUVs()},setSize:function(o,a,h,l){h===void 0&&(h=0),l===void 0&&(l=0),this.setCutPosition(h,l),this.setCutSize(o,a),this.width=o,this.height=a,this.halfWidth=Math.floor(o*.5),this.halfHeight=Math.floor(a*.5),this.centerX=Math.floor(o/2),this.centerY=Math.floor(a/2);var c=this.data,f=c.cut;f.x=h,f.y=l,f.w=o,f.h=a,f.r=h+o,f.b=l+a,c.sourceSize.w=o,c.sourceSize.h=a,c.spriteSourceSize.w=o,c.spriteSourceSize.h=a,c.radius=.5*Math.sqrt(o*o+a*a);var u=c.drawImage;return u.x=h,u.y=l,u.width=o,u.height=a,this.updateUVs()},setTrim:function(o,a,h,l,c,f){var u=this.data,p=u.spriteSourceSize;return u.trim=!0,u.sourceSize.w=o,u.sourceSize.h=a,p.x=h,p.y=l,p.w=c,p.h=f,p.r=h+c,p.b=l+f,this.x=h,this.y=l,this.width=c,this.height=f,this.halfWidth=c*.5,this.halfHeight=f*.5,this.centerX=Math.floor(c/2),this.centerY=Math.floor(f/2),this.updateUVs()},setScale9:function(o,a,h,l){var c=this.data;return c.scale9=!0,c.is3Slice=a===0&&l===this.height,c.scale9Borders.x=o,c.scale9Borders.y=a,c.scale9Borders.w=h,c.scale9Borders.h=l,this},setCropUVs:function(o,a,h,l,c,f,u){var p=this.cutX,d=this.cutY,g=this.cutWidth,m=this.cutHeight,E=this.realWidth,v=this.realHeight;a=s(a,0,E),h=s(h,0,v),l=s(l,0,E-a),c=s(c,0,v-h);var y=p+a,T=d+h,A=l,x=c,_=this.data;if(_.trim){var b=_.spriteSourceSize;l=s(l,0,b.x+g-a),c=s(c,0,b.y+m-h);var M=a+l,w=h+c,R=!(b.r<a||b.b<h||b.x>M||b.y>w);if(R){var I=Math.max(b.x,a),O=Math.max(b.y,h),D=Math.min(b.r,M)-I,N=Math.min(b.b,w)-O;A=D,x=N,f?y=p+(g-(I-b.x)-D):y=p+(I-b.x),u?T=d+(m-(O-b.y)-N):T=d+(O-b.y),a=I,h=O,l=D,c=N}else y=0,T=0,A=0,x=0}else f&&(y=p+(g-a-l)),u&&(T=d+(m-h-c));var F=this.source.width,G=this.source.height;return o.u0=Math.max(0,y/F),o.v0=Math.max(0,T/G),o.u1=Math.min(1,(y+A)/F),o.v1=Math.min(1,(T+x)/G),o.x=a,o.y=h,o.cx=y,o.cy=T,o.cw=A,o.ch=x,o.width=l,o.height=c,o.flipX=f,o.flipY=u,o},updateCropUVs:function(o,a,h){return this.setCropUVs(o,o.x,o.y,o.width,o.height,a,h)},setUVs:function(o,a,h,l,c,f){var u=this.data.drawImage;return u.width=o,u.height=a,this.u0=h,this.v0=l,this.u1=c,this.v1=f,this},updateUVs:function(){var o=this.cutX,a=this.cutY,h=this.cutWidth,l=this.cutHeight,c=this.data.drawImage;c.width=h,c.height=l;var f=this.source.width,u=this.source.height;return this.u0=o/f,this.v0=a/u,this.u1=(o+h)/f,this.v1=(a+l)/u,this},updateUVsInverted:function(){var o=this.source.width,a=this.source.height;return this.u0=(this.cutX+this.cutHeight)/o,this.v0=this.cutY/a,this.u1=this.cutX/o,this.v1=(this.cutY+this.cutWidth)/a,this},clone:function(){var o=new r(this.texture,this.name,this.sourceIndex);return o.cutX=this.cutX,o.cutY=this.cutY,o.cutWidth=this.cutWidth,o.cutHeight=this.cutHeight,o.x=this.x,o.y=this.y,o.width=this.width,o.height=this.height,o.halfWidth=this.halfWidth,o.halfHeight=this.halfHeight,o.centerX=this.centerX,o.centerY=this.centerY,o.rotated=this.rotated,o.data=n(!0,o.data,this.data),o.updateUVs(),o},destroy:function(){this.texture=null,this.source=null,this.customData=null,this.data=null},glTexture:{get:function(){return this.source.glTexture}},realWidth:{get:function(){return this.data.sourceSize.w}},realHeight:{get:function(){return this.data.sourceSize.h}},radius:{get:function(){return this.data.radius}},trimmed:{get:function(){return this.data.trim}},scale9:{get:function(){return this.data.scale9}},is3Slice:{get:function(){return this.data.is3Slice}},canvasData:{get:function(){return this.data.drawImage}}});t.exports=r}),zm=S((e,t)=>{"use strict";var i=nn(),s=8,n={texture:null,frame:null,isCropped:!1,setTexture:function(r,o,a,h){return this.texture=this.scene.sys.textures.get(r),this.setFrame(o,a,h)},setFrame:function(r,o,a){return o===void 0&&(o=!0),a===void 0&&(a=!0),r instanceof i?(this.texture=this.scene.sys.textures.get(r.texture.key),this.frame=r):this.frame=this.texture.get(r),!this.frame.cutWidth||!this.frame.cutHeight?this.renderFlags&=~s:this.renderFlags|=s,this._sizeComponent&&o&&this.setSizeToFrame(),this._originComponent&&a&&(this.frame.customPivot?this.setOrigin(this.frame.pivotX,this.frame.pivotY):this.updateDisplayOrigin()),this}};t.exports=n}),Vm=S((e,t)=>{"use strict";var i=nn(),s=8,n={texture:null,frame:null,isCropped:!1,setCrop:function(r,o,a,h){if(r===void 0)this.isCropped=!1;else if(this.frame){if(typeof r=="number")this.frame.setCropUVs(this._crop,r,o,a,h,this.flipX,this.flipY);else{var l=r;this.frame.setCropUVs(this._crop,l.x,l.y,l.width,l.height,this.flipX,this.flipY)}this.isCropped=!0}return this},setTexture:function(r,o){return this.texture=this.scene.sys.textures.get(r),this.setFrame(o)},setFrame:function(r,o,a){return o===void 0&&(o=!0),a===void 0&&(a=!0),r instanceof i?(this.texture=this.scene.sys.textures.get(r.texture.key),this.frame=r):this.frame=this.texture.get(r),!this.frame.cutWidth||!this.frame.cutHeight?this.renderFlags&=~s:this.renderFlags|=s,this._sizeComponent&&o&&this.setSizeToFrame(),this._originComponent&&a&&(this.frame.customPivot?this.setOrigin(this.frame.pivotX,this.frame.pivotY):this.updateDisplayOrigin()),this.isCropped&&this.frame.updateCropUVs(this._crop,this.flipX,this.flipY),this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:!1,flipY:!1,cx:0,cy:0,cw:0,ch:0}}};t.exports=n}),Xm=S((e,t)=>{"use strict";var i={tintTopLeft:16777215,tintTopRight:16777215,tintBottomLeft:16777215,tintBottomRight:16777215,tintFill:!1,clearTint:function(){return this.setTint(16777215),this},setTint:function(s,n,r,o){return s===void 0&&(s=16777215),n===void 0&&(n=s,r=s,o=s),this.tintTopLeft=s,this.tintTopRight=n,this.tintBottomLeft=r,this.tintBottomRight=o,this.tintFill=!1,this},setTintFill:function(s,n,r,o){return this.setTint(s,n,r,o),this.tintFill=!0,this},tint:{get:function(){return this.tintTopLeft},set:function(s){this.setTint(s,s,s,s)}},isTinted:{get:function(){var s=16777215;return this.tintFill||this.tintTopLeft!==s||this.tintTopRight!==s||this.tintBottomLeft!==s||this.tintBottomRight!==s}}};t.exports=i}),fa=S((e,t)=>{"use strict";var i=function(s){var n={name:s.name,type:s.type,x:s.x,y:s.y,depth:s.depth,scale:{x:s.scaleX,y:s.scaleY},origin:{x:s.originX,y:s.originY},flipX:s.flipX,flipY:s.flipY,rotation:s.rotation,alpha:s.alpha,visible:s.visible,blendMode:s.blendMode,textureKey:"",frameKey:"",data:{}};return s.texture&&(n.textureKey=s.texture.key,n.frameKey=s.frame.name),n};t.exports=i}),he=S((e,t)=>{"use strict";var i={PI2:Math.PI*2,TAU:Math.PI*.5,EPSILON:1e-6,DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,RND:null,MIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER||-9007199254740991,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991};t.exports=i}),ui=S((e,t)=>{"use strict";var i=V(),s=he(),n=Ot(),r=new i({initialize:function(o,a,h,l,c,f){o===void 0&&(o=1),a===void 0&&(a=0),h===void 0&&(h=0),l===void 0&&(l=1),c===void 0&&(c=0),f===void 0&&(f=0),this.matrix=new Float32Array([o,a,h,l,c,f,0,0,1]),this.decomposedMatrix={translateX:0,translateY:0,scaleX:1,scaleY:1,rotation:0},this.quad=new Float32Array(8)},a:{get:function(){return this.matrix[0]},set:function(o){this.matrix[0]=o}},b:{get:function(){return this.matrix[1]},set:function(o){this.matrix[1]=o}},c:{get:function(){return this.matrix[2]},set:function(o){this.matrix[2]=o}},d:{get:function(){return this.matrix[3]},set:function(o){this.matrix[3]=o}},e:{get:function(){return this.matrix[4]},set:function(o){this.matrix[4]=o}},f:{get:function(){return this.matrix[5]},set:function(o){this.matrix[5]=o}},tx:{get:function(){return this.matrix[4]},set:function(o){this.matrix[4]=o}},ty:{get:function(){return this.matrix[5]},set:function(o){this.matrix[5]=o}},rotation:{get:function(){return Math.acos(this.a/this.scaleX)*(Math.atan(-this.c/this.a)<0?-1:1)}},rotationNormalized:{get:function(){var o=this.matrix,a=o[0],h=o[1],l=o[2],c=o[3];return a||h?h>0?Math.acos(a/this.scaleX):-Math.acos(a/this.scaleX):l||c?s.TAU-(c>0?Math.acos(-l/this.scaleY):-Math.acos(l/this.scaleY)):0}},scaleX:{get:function(){return Math.sqrt(this.a*this.a+this.b*this.b)}},scaleY:{get:function(){return Math.sqrt(this.c*this.c+this.d*this.d)}},loadIdentity:function(){var o=this.matrix;return o[0]=1,o[1]=0,o[2]=0,o[3]=1,o[4]=0,o[5]=0,this},translate:function(o,a){var h=this.matrix;return h[4]=h[0]*o+h[2]*a+h[4],h[5]=h[1]*o+h[3]*a+h[5],this},scale:function(o,a){var h=this.matrix;return h[0]*=o,h[1]*=o,h[2]*=a,h[3]*=a,this},rotate:function(o){var a=Math.sin(o),h=Math.cos(o),l=this.matrix,c=l[0],f=l[1],u=l[2],p=l[3];return l[0]=c*h+u*a,l[1]=f*h+p*a,l[2]=c*-a+u*h,l[3]=f*-a+p*h,this},multiply:function(o,a){var h=this.matrix,l=o.matrix,c=h[0],f=h[1],u=h[2],p=h[3],d=h[4],g=h[5],m=l[0],E=l[1],v=l[2],y=l[3],T=l[4],A=l[5],x=a===void 0?h:a.matrix;return x[0]=m*c+E*u,x[1]=m*f+E*p,x[2]=v*c+y*u,x[3]=v*f+y*p,x[4]=T*c+A*u+d,x[5]=T*f+A*p+g,x},multiplyWithOffset:function(o,a,h){var l=this.matrix,c=o.matrix,f=l[0],u=l[1],p=l[2],d=l[3],g=l[4],m=l[5],E=a*f+h*p+g,v=a*u+h*d+m,y=c[0],T=c[1],A=c[2],x=c[3],_=c[4],b=c[5];return l[0]=y*f+T*p,l[1]=y*u+T*d,l[2]=A*f+x*p,l[3]=A*u+x*d,l[4]=_*f+b*p+E,l[5]=_*u+b*d+v,this},transform:function(o,a,h,l,c,f){var u=this.matrix,p=u[0],d=u[1],g=u[2],m=u[3],E=u[4],v=u[5];return u[0]=o*p+a*g,u[1]=o*d+a*m,u[2]=h*p+l*g,u[3]=h*d+l*m,u[4]=c*p+f*g+E,u[5]=c*d+f*m+v,this},transformPoint:function(o,a,h){h===void 0&&(h={x:0,y:0});var l=this.matrix,c=l[0],f=l[1],u=l[2],p=l[3],d=l[4],g=l[5];return h.x=o*c+a*u+d,h.y=o*f+a*p+g,h},invert:function(){var o=this.matrix,a=o[0],h=o[1],l=o[2],c=o[3],f=o[4],u=o[5],p=a*c-h*l;return o[0]=c/p,o[1]=-h/p,o[2]=-l/p,o[3]=a/p,o[4]=(l*u-c*f)/p,o[5]=-(a*u-h*f)/p,this},copyFrom:function(o){var a=this.matrix;return a[0]=o.a,a[1]=o.b,a[2]=o.c,a[3]=o.d,a[4]=o.e,a[5]=o.f,this},copyFromArray:function(o){var a=this.matrix;return a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[3],a[4]=o[4],a[5]=o[5],this},copyToContext:function(o){var a=this.matrix;return o.transform(a[0],a[1],a[2],a[3],a[4],a[5]),o},setToContext:function(o){return o.setTransform(this.a,this.b,this.c,this.d,this.e,this.f),o},copyToArray:function(o){var a=this.matrix;return o===void 0?o=[a[0],a[1],a[2],a[3],a[4],a[5]]:(o[0]=a[0],o[1]=a[1],o[2]=a[2],o[3]=a[3],o[4]=a[4],o[5]=a[5]),o},setTransform:function(o,a,h,l,c,f){var u=this.matrix;return u[0]=o,u[1]=a,u[2]=h,u[3]=l,u[4]=c,u[5]=f,this},decomposeMatrix:function(){var o=this.decomposedMatrix,a=this.matrix,h=a[0],l=a[1],c=a[2],f=a[3],u=h*f-l*c;if(o.translateX=a[4],o.translateY=a[5],h||l){var p=Math.sqrt(h*h+l*l);o.rotation=l>0?Math.acos(h/p):-Math.acos(h/p),o.scaleX=p,o.scaleY=u/p}else if(c||f){var d=Math.sqrt(c*c+f*f);o.rotation=Math.PI*.5-(f>0?Math.acos(-c/d):-Math.acos(c/d)),o.scaleX=u/d,o.scaleY=d}else o.rotation=0,o.scaleX=0,o.scaleY=0;return o},applyITRS:function(o,a,h,l,c){var f=this.matrix,u=Math.sin(h),p=Math.cos(h);return f[4]=o,f[5]=a,f[0]=p*l,f[1]=u*l,f[2]=-u*c,f[3]=p*c,this},applyInverse:function(o,a,h){h===void 0&&(h=new n);var l=this.matrix,c=l[0],f=l[1],u=l[2],p=l[3],d=l[4],g=l[5],m=1/(c*p+u*-f);return h.x=p*m*o+-u*m*a+(g*u-d*p)*m,h.y=c*m*a+-f*m*o+(-g*c+d*f)*m,h},setQuad:function(o,a,h,l,c,f){c===void 0&&(c=!1),f===void 0&&(f=this.quad);var u=this.matrix,p=u[0],d=u[1],g=u[2],m=u[3],E=u[4],v=u[5],y=o*p+a*g+E,T=o*d+a*m+v,A=o*p+l*g+E,x=o*d+l*m+v,_=h*p+l*g+E,b=h*d+l*m+v,M=h*p+a*g+E,w=h*d+a*m+v;if(c){var R=Math.floor(y+.5),I=Math.floor(T+.5),O=R-y,D=I-T;f[0]=R,f[1]=I,f[2]=A+O,f[3]=x+D,f[4]=_+O,f[5]=b+D,f[6]=M+O,f[7]=w+D}else f[0]=y,f[1]=T,f[2]=A,f[3]=x,f[4]=_,f[5]=b,f[6]=M,f[7]=w;return f},getX:function(o,a){return o*this.a+a*this.c+this.e},getY:function(o,a){return o*this.b+a*this.d+this.f},getXRound:function(o,a,h){var l=this.getX(o,a);return h&&(l=Math.floor(l+.5)),l},getYRound:function(o,a,h){var l=this.getY(o,a);return h&&(l=Math.floor(l+.5)),l},getCSSMatrix:function(){var o=this.matrix;return"matrix("+o[0]+","+o[1]+","+o[2]+","+o[3]+","+o[4]+","+o[5]+")"},destroy:function(){this.matrix=null,this.quad=null,this.decomposedMatrix=null}});t.exports=r}),qh=S((e,t)=>{"use strict";var i=Ot(),s=function(n,r,o,a,h,l,c,f){f===void 0&&(f=new i);var u=Math.sin(h),p=Math.cos(h),d=p*l,g=u*l,m=-u*c,E=p*c,v=1/(d*E+m*-g);return f.x=E*v*n+-m*v*r+(a*m-o*E)*v,f.y=d*v*r+-g*v*n+(-a*d+o*g)*v,f};t.exports=s}),rn=S((e,t)=>{"use strict";var i=function(s,n,r){var o=r-n;return n+((s-n)%o+o)%o};t.exports=i}),Qh=S((e,t)=>{"use strict";var i=rn(),s=function(n){return i(n,-Math.PI,Math.PI)};t.exports=s}),Jh=S((e,t)=>{"use strict";var i=rn(),s=function(n){return i(n,-180,180)};t.exports=s}),Km=S((e,t)=>{"use strict";var i=he(),s=ui(),n=qh(),r=Qh(),o=Jh(),a=Ot(),h=4,l={hasTransformComponent:!0,_scaleX:1,_scaleY:1,_rotation:0,x:0,y:0,z:0,w:0,scale:{get:function(){return(this._scaleX+this._scaleY)/2},set:function(c){this._scaleX=c,this._scaleY=c,c===0?this.renderFlags&=~h:this.renderFlags|=h}},scaleX:{get:function(){return this._scaleX},set:function(c){this._scaleX=c,c===0?this.renderFlags&=~h:this._scaleY!==0&&(this.renderFlags|=h)}},scaleY:{get:function(){return this._scaleY},set:function(c){this._scaleY=c,c===0?this.renderFlags&=~h:this._scaleX!==0&&(this.renderFlags|=h)}},angle:{get:function(){return o(this._rotation*i.RAD_TO_DEG)},set:function(c){this.rotation=o(c)*i.DEG_TO_RAD}},rotation:{get:function(){return this._rotation},set:function(c){this._rotation=r(c)}},setPosition:function(c,f,u,p){return c===void 0&&(c=0),f===void 0&&(f=c),u===void 0&&(u=0),p===void 0&&(p=0),this.x=c,this.y=f,this.z=u,this.w=p,this},copyPosition:function(c){return c.x!==void 0&&(this.x=c.x),c.y!==void 0&&(this.y=c.y),c.z!==void 0&&(this.z=c.z),c.w!==void 0&&(this.w=c.w),this},setRandomPosition:function(c,f,u,p){return c===void 0&&(c=0),f===void 0&&(f=0),u===void 0&&(u=this.scene.sys.scale.width),p===void 0&&(p=this.scene.sys.scale.height),this.x=c+Math.random()*u,this.y=f+Math.random()*p,this},setRotation:function(c){return c===void 0&&(c=0),this.rotation=c,this},setAngle:function(c){return c===void 0&&(c=0),this.angle=c,this},setScale:function(c,f){return c===void 0&&(c=1),f===void 0&&(f=c),this.scaleX=c,this.scaleY=f,this},setX:function(c){return c===void 0&&(c=0),this.x=c,this},setY:function(c){return c===void 0&&(c=0),this.y=c,this},setZ:function(c){return c===void 0&&(c=0),this.z=c,this},setW:function(c){return c===void 0&&(c=0),this.w=c,this},getLocalTransformMatrix:function(c){return c===void 0&&(c=new s),c.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY)},getWorldTransformMatrix:function(c,f){c===void 0&&(c=new s);var u=this.parentContainer;if(!u)return this.getLocalTransformMatrix(c);var p=!1;for(f||(f=new s,p=!0),c.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY);u;)f.applyITRS(u.x,u.y,u._rotation,u._scaleX,u._scaleY),f.multiply(c,c),u=u.parentContainer;return p&&f.destroy(),c},getLocalPoint:function(c,f,u,p){u||(u=new a),p||(p=this.scene.sys.cameras.main);var d=p.scrollX,g=p.scrollY,m=c+d*this.scrollFactorX-d,E=f+g*this.scrollFactorY-g;return this.parentContainer?this.getWorldTransformMatrix().applyInverse(m,E,u):n(m,E,this.x,this.y,this.rotation,this.scaleX,this.scaleY,u),this._originComponent&&(u.x+=this._displayOriginX,u.y+=this._displayOriginY),u},getWorldPoint:function(c,f,u){c===void 0&&(c=new a);var p=this.parentContainer;if(!p)return c.x=this.x,c.y=this.y,c;var d=this.getWorldTransformMatrix(f,u);return c.x=d.tx,c.y=d.ty,c},getParentRotation:function(){for(var c=0,f=this.parentContainer;f;)c+=f.rotation,f=f.parentContainer;return c}};t.exports=l}),jm=S((e,t)=>{"use strict";var i=1,s={_visible:!0,visible:{get:function(){return this._visible},set:function(n){n?(this._visible=!0,this.renderFlags|=i):(this._visible=!1,this.renderFlags&=~i)}},setVisible:function(n){return this.visible=n,this}};t.exports=s}),me=S((e,t)=>{"use strict";t.exports={Alpha:bf(),AlphaSingle:Pf(),BlendMode:Lf(),ComputedSize:If(),Crop:Mf(),Depth:cm(),Flip:dm(),GetBounds:fm(),Mask:Um(),Origin:Fm(),Pipeline:Gm(),PostPipeline:Ym(),ScrollFactor:Hm(),Size:Wm(),Texture:zm(),TextureCrop:Vm(),Tint:Xm(),ToJSON:fa(),Transform:Km(),TransformMatrix:ui(),Visible:jm()}}),an=S((e,t)=>{"use strict";var i=he(),s=function(n){return n*i.DEG_TO_RAD};t.exports=s}),Wt=S((e,t)=>{"use strict";var i=Object.prototype.hasOwnProperty,s="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(s=!1));function r(l,c,f){this.fn=l,this.context=c,this.once=f||!1}function o(l,c,f,u,p){if(typeof f!="function")throw new TypeError("The listener must be a function");var d=new r(f,u||l,p),g=s?s+c:c;return l._events[g]?l._events[g].fn?l._events[g]=[l._events[g],d]:l._events[g].push(d):(l._events[g]=d,l._eventsCount++),l}function a(l,c){--l._eventsCount===0?l._events=new n:delete l._events[c]}function h(){this._events=new n,this._eventsCount=0}h.prototype.eventNames=function(){var l=[],c,f;if(this._eventsCount===0)return l;for(f in c=this._events)i.call(c,f)&&l.push(s?f.slice(1):f);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},h.prototype.listeners=function(l){var c=s?s+l:l,f=this._events[c];if(!f)return[];if(f.fn)return[f.fn];for(var u=0,p=f.length,d=new Array(p);u<p;u++)d[u]=f[u].fn;return d},h.prototype.listenerCount=function(l){var c=s?s+l:l,f=this._events[c];return f?f.fn?1:f.length:0},h.prototype.emit=function(l,c,f,u,p,d){var g=s?s+l:l;if(!this._events[g])return!1;var m=this._events[g],E=arguments.length,v,y;if(m.fn){switch(m.once&&this.removeListener(l,m.fn,void 0,!0),E){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,c),!0;case 3:return m.fn.call(m.context,c,f),!0;case 4:return m.fn.call(m.context,c,f,u),!0;case 5:return m.fn.call(m.context,c,f,u,p),!0;case 6:return m.fn.call(m.context,c,f,u,p,d),!0}for(y=1,v=new Array(E-1);y<E;y++)v[y-1]=arguments[y];m.fn.apply(m.context,v)}else{var T=m.length,A;for(y=0;y<T;y++)switch(m[y].once&&this.removeListener(l,m[y].fn,void 0,!0),E){case 1:m[y].fn.call(m[y].context);break;case 2:m[y].fn.call(m[y].context,c);break;case 3:m[y].fn.call(m[y].context,c,f);break;case 4:m[y].fn.call(m[y].context,c,f,u);break;default:if(!v)for(A=1,v=new Array(E-1);A<E;A++)v[A-1]=arguments[A];m[y].fn.apply(m[y].context,v)}}return!0},h.prototype.on=function(l,c,f){return o(this,l,c,f,!1)},h.prototype.once=function(l,c,f){return o(this,l,c,f,!0)},h.prototype.removeListener=function(l,c,f,u){var p=s?s+l:l;if(!this._events[p])return this;if(!c)return a(this,p),this;var d=this._events[p];if(d.fn)d.fn===c&&(!u||d.once)&&(!f||d.context===f)&&a(this,p);else{for(var g=0,m=[],E=d.length;g<E;g++)(d[g].fn!==c||u&&!d[g].once||f&&d[g].context!==f)&&m.push(d[g]);m.length?this._events[p]=m.length===1?m[0]:m:a(this,p)}return this},h.prototype.removeAllListeners=function(l){var c;return l?(c=s?s+l:l,this._events[c]&&a(this,c)):(this._events=new n,this._eventsCount=0),this},h.prototype.off=h.prototype.removeListener,h.prototype.addListener=h.prototype.on,h.prefixed=s,h.EventEmitter=h,typeof t<"u"&&(t.exports=h)}),Zm=S((e,t)=>{"use strict";t.exports="cameradestroy"}),qm=S((e,t)=>{"use strict";t.exports="camerafadeincomplete"}),Qm=S((e,t)=>{"use strict";t.exports="camerafadeinstart"}),Jm=S((e,t)=>{"use strict";t.exports="camerafadeoutcomplete"}),$m=S((e,t)=>{"use strict";t.exports="camerafadeoutstart"}),tv=S((e,t)=>{"use strict";t.exports="cameraflashcomplete"}),ev=S((e,t)=>{"use strict";t.exports="cameraflashstart"}),iv=S((e,t)=>{"use strict";t.exports="followupdate"}),sv=S((e,t)=>{"use strict";t.exports="camerapancomplete"}),nv=S((e,t)=>{"use strict";t.exports="camerapanstart"}),rv=S((e,t)=>{"use strict";t.exports="postrender"}),av=S((e,t)=>{"use strict";t.exports="prerender"}),ov=S((e,t)=>{"use strict";t.exports="camerarotatecomplete"}),hv=S((e,t)=>{"use strict";t.exports="camerarotatestart"}),lv=S((e,t)=>{"use strict";t.exports="camerashakecomplete"}),uv=S((e,t)=>{"use strict";t.exports="camerashakestart"}),cv=S((e,t)=>{"use strict";t.exports="camerazoomcomplete"}),dv=S((e,t)=>{"use strict";t.exports="camerazoomstart"}),je=S((e,t)=>{"use strict";t.exports={DESTROY:Zm(),FADE_IN_COMPLETE:qm(),FADE_IN_START:Qm(),FADE_OUT_COMPLETE:Jm(),FADE_OUT_START:$m(),FLASH_COMPLETE:tv(),FLASH_START:ev(),FOLLOW_UPDATE:iv(),PAN_COMPLETE:sv(),PAN_START:nv(),POST_RENDER:rv(),PRE_RENDER:av(),ROTATE_COMPLETE:ov(),ROTATE_START:hv(),SHAKE_COMPLETE:lv(),SHAKE_START:uv(),ZOOM_COMPLETE:cv(),ZOOM_START:dv()}}),ys=S((e,t)=>{"use strict";var i=function(s,n,r){return s<<16|n<<8|r};t.exports=i}),$h=S((e,t)=>{"use strict";var i=function(s,n,r,o){return o<<24|s<<16|n<<8|r};t.exports=i}),ma=S((e,t)=>{"use strict";var i=ys();function s(r,o,a,h){var l=(r+o*6)%6,c=Math.min(l,4-l,1);return Math.round(255*(h-h*a*Math.max(0,c)))}var n=function(r,o,a,h){o===void 0&&(o=1),a===void 0&&(a=1);var l=s(5,r,o,a),c=s(3,r,o,a),f=s(1,r,o,a);return h?h.setTo?h.setTo(l,c,f,h.alpha,!0):(h.r=l,h.g=c,h.b=f,h.color=i(l,c,f),h):{r:l,g:c,b:f,color:i(l,c,f)}};t.exports=n}),tl=S((e,t)=>{"use strict";var i=function(s,n,r,o){o===void 0&&(o={h:0,s:0,v:0}),s/=255,n/=255,r/=255;var a=Math.min(s,n,r),h=Math.max(s,n,r),l=h-a,c=0,f=h===0?0:l/h,u=h;return h!==a&&(h===s?c=(n-r)/l+(n<r?6:0):h===n?c=(r-s)/l+2:h===r&&(c=(s-n)/l+4),c/=6),o.hasOwnProperty("_h")?(o._h=c,o._s=f,o._v=u):(o.h=c,o.s=f,o.v=u),o};t.exports=i}),Ze=S((e,t)=>{"use strict";var i=V(),s=ys(),n=$h(),r=ma(),o=tl(),a=new i({initialize:function(h,l,c,f){h===void 0&&(h=0),l===void 0&&(l=0),c===void 0&&(c=0),f===void 0&&(f=255),this.r=0,this.g=0,this.b=0,this.a=255,this._h=0,this._s=0,this._v=0,this._locked=!1,this.gl=[0,0,0,1],this._color=0,this._color32=0,this._rgba="",this.setTo(h,l,c,f)},transparent:function(){return this._locked=!0,this.red=0,this.green=0,this.blue=0,this.alpha=0,this._locked=!1,this.update(!0)},setTo:function(h,l,c,f,u){return f===void 0&&(f=255),u===void 0&&(u=!0),this._locked=!0,this.red=h,this.green=l,this.blue=c,this.alpha=f,this._locked=!1,this.update(u)},setGLTo:function(h,l,c,f){return f===void 0&&(f=1),this._locked=!0,this.redGL=h,this.greenGL=l,this.blueGL=c,this.alphaGL=f,this._locked=!1,this.update(!0)},setFromRGB:function(h){return this._locked=!0,this.red=h.r,this.green=h.g,this.blue=h.b,h.hasOwnProperty("a")&&(this.alpha=h.a),this._locked=!1,this.update(!0)},setFromHSV:function(h,l,c){return r(h,l,c,this)},update:function(h){if(h===void 0&&(h=!1),this._locked)return this;var l=this.r,c=this.g,f=this.b,u=this.a;return this._color=s(l,c,f),this._color32=n(l,c,f,u),this._rgba="rgba("+l+","+c+","+f+","+u/255+")",h&&o(l,c,f,this),this},updateHSV:function(){var h=this.r,l=this.g,c=this.b;return o(h,l,c,this),this},clone:function(){return new a(this.r,this.g,this.b,this.a)},gray:function(h){return this.setTo(h,h,h)},random:function(h,l){h===void 0&&(h=0),l===void 0&&(l=255);var c=Math.floor(h+Math.random()*(l-h)),f=Math.floor(h+Math.random()*(l-h)),u=Math.floor(h+Math.random()*(l-h));return this.setTo(c,f,u)},randomGray:function(h,l){h===void 0&&(h=0),l===void 0&&(l=255);var c=Math.floor(h+Math.random()*(l-h));return this.setTo(c,c,c)},saturate:function(h){return this.s+=h/100,this},desaturate:function(h){return this.s-=h/100,this},lighten:function(h){return this.v+=h/100,this},darken:function(h){return this.v-=h/100,this},brighten:function(h){var l=this.r,c=this.g,f=this.b;return l=Math.max(0,Math.min(255,l-Math.round(255*-(h/100)))),c=Math.max(0,Math.min(255,c-Math.round(255*-(h/100)))),f=Math.max(0,Math.min(255,f-Math.round(255*-(h/100)))),this.setTo(l,c,f)},color:{get:function(){return this._color}},color32:{get:function(){return this._color32}},rgba:{get:function(){return this._rgba}},redGL:{get:function(){return this.gl[0]},set:function(h){this.gl[0]=Math.min(Math.abs(h),1),this.r=Math.floor(this.gl[0]*255),this.update(!0)}},greenGL:{get:function(){return this.gl[1]},set:function(h){this.gl[1]=Math.min(Math.abs(h),1),this.g=Math.floor(this.gl[1]*255),this.update(!0)}},blueGL:{get:function(){return this.gl[2]},set:function(h){this.gl[2]=Math.min(Math.abs(h),1),this.b=Math.floor(this.gl[2]*255),this.update(!0)}},alphaGL:{get:function(){return this.gl[3]},set:function(h){this.gl[3]=Math.min(Math.abs(h),1),this.a=Math.floor(this.gl[3]*255),this.update()}},red:{get:function(){return this.r},set:function(h){h=Math.floor(Math.abs(h)),this.r=Math.min(h,255),this.gl[0]=h/255,this.update(!0)}},green:{get:function(){return this.g},set:function(h){h=Math.floor(Math.abs(h)),this.g=Math.min(h,255),this.gl[1]=h/255,this.update(!0)}},blue:{get:function(){return this.b},set:function(h){h=Math.floor(Math.abs(h)),this.b=Math.min(h,255),this.gl[2]=h/255,this.update(!0)}},alpha:{get:function(){return this.a},set:function(h){h=Math.floor(Math.abs(h)),this.a=Math.min(h,255),this.gl[3]=h/255,this.update()}},h:{get:function(){return this._h},set:function(h){this._h=h,r(h,this._s,this._v,this)}},s:{get:function(){return this._s},set:function(h){this._s=h,r(this._h,h,this._v,this)}},v:{get:function(){return this._v},set:function(h){this._v=h,r(this._h,this._s,h,this)}}});t.exports=a}),el=S((e,t)=>{"use strict";var i=Ze(),s=function(n){var r=new i;n=n.replace(/^(?:#|0x)?([a-f\d])([a-f\d])([a-f\d])$/i,function(c,f,u,p){return f+f+u+u+p+p});var o=/^(?:#|0x)?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);if(o){var a=parseInt(o[1],16),h=parseInt(o[2],16),l=parseInt(o[3],16);r.setTo(a,h,l)}return r};t.exports=s}),va=S((e,t)=>{"use strict";var i=function(s){return s>16777215?{a:s>>>24,r:s>>16&255,g:s>>8&255,b:s&255}:{a:255,r:s>>16&255,g:s>>8&255,b:s&255}};t.exports=i}),il=S((e,t)=>{"use strict";var i=Ze(),s=va(),n=function(r){var o=s(r);return new i(o.r,o.g,o.b,o.a)};t.exports=n}),sl=S((e,t)=>{"use strict";var i=Ze(),s=function(n){return new i(n.r,n.g,n.b,n.a)};t.exports=s}),nl=S((e,t)=>{"use strict";var i=Ze(),s=function(n){var r=new i,o=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(n.toLowerCase());if(o){var a=parseInt(o[1],10),h=parseInt(o[2],10),l=parseInt(o[3],10),c=o[4]!==void 0?parseFloat(o[4]):1;r.setTo(a,h,l,c*255)}return r};t.exports=s}),Ea=S((e,t)=>{"use strict";var i=el(),s=il(),n=sl(),r=nl(),o=function(a){var h=typeof a;switch(h){case"string":return a.substr(0,3).toLowerCase()==="rgb"?r(a):i(a);case"number":return s(a);case"object":return n(a)}};t.exports=o}),ya=S((e,t)=>{"use strict";var i=V(),s=me(),n=an(),r=Wt(),o=je(),a=zt(),h=ui(),l=Ea(),c=Ot(),f=new i({Extends:r,Mixins:[s.AlphaSingle,s.Visible],initialize:function(u,p,d,g){u===void 0&&(u=0),p===void 0&&(p=0),d===void 0&&(d=0),g===void 0&&(g=0),r.call(this),this.scene,this.sceneManager,this.scaleManager,this.cameraManager,this.id=0,this.name="",this.roundPixels=!1,this.useBounds=!1,this.worldView=new a,this.dirty=!0,this._x=u,this._y=p,this._width=d,this._height=g,this._bounds=new a,this._scrollX=0,this._scrollY=0,this._zoomX=1,this._zoomY=1,this._rotation=0,this.matrix=new h,this.transparent=!0,this.backgroundColor=l("rgba(0,0,0,0)"),this.disableCull=!1,this.culledObjects=[],this.midPoint=new c(d/2,g/2),this.originX=.5,this.originY=.5,this._customViewport=!1,this.mask=null,this._maskCamera=null,this.renderList=[],this.isSceneCamera=!0,this.renderRoundPixels=!0},addToRenderList:function(u){this.renderList.push(u)},setOrigin:function(u,p){return u===void 0&&(u=.5),p===void 0&&(p=u),this.originX=u,this.originY=p,this},getScroll:function(u,p,d){d===void 0&&(d=new c);var g=this.width*.5,m=this.height*.5;return d.x=u-g,d.y=p-m,this.useBounds&&(d.x=this.clampX(d.x),d.y=this.clampY(d.y)),d},centerOnX:function(u){var p=this.width*.5;return this.midPoint.x=u,this.scrollX=u-p,this.useBounds&&(this.scrollX=this.clampX(this.scrollX)),this},centerOnY:function(u){var p=this.height*.5;return this.midPoint.y=u,this.scrollY=u-p,this.useBounds&&(this.scrollY=this.clampY(this.scrollY)),this},centerOn:function(u,p){return this.centerOnX(u),this.centerOnY(p),this},centerToBounds:function(){if(this.useBounds){var u=this._bounds,p=this.width*.5,d=this.height*.5;this.midPoint.set(u.centerX,u.centerY),this.scrollX=u.centerX-p,this.scrollY=u.centerY-d}return this},centerToSize:function(){return this.scrollX=this.width*.5,this.scrollY=this.height*.5,this},cull:function(u){if(this.disableCull)return u;var p=this.matrix.matrix,d=p[0],g=p[1],m=p[2],E=p[3],v=d*E-g*m;if(!v)return u;var y=p[4],T=p[5],A=this.scrollX,x=this.scrollY,_=this.width,b=this.height,M=this.y,w=M+b,R=this.x,I=R+_,O=this.culledObjects,D=u.length;v=1/v,O.length=0;for(var N=0;N<D;++N){var F=u[N];if(!F.hasOwnProperty("width")||F.parentContainer){O.push(F);continue}var G=F.width,L=F.height,C=F.x-A*F.scrollFactorX-G*F.originX,P=F.y-x*F.scrollFactorY-L*F.originY,k=C*d+P*m+y,B=C*g+P*E+T,Y=(C+G)*d+(P+L)*m+y,H=(C+G)*g+(P+L)*E+T;Y>R&&k<I&&H>M&&B<w&&O.push(F)}return O},getWorldPoint:function(u,p,d){d===void 0&&(d=new c);var g=this.matrix.matrix,m=g[0],E=g[1],v=g[2],y=g[3],T=g[4],A=g[5],x=m*y-E*v;if(!x)return d.x=u,d.y=p,d;x=1/x;var _=y*x,b=-E*x,M=-v*x,w=m*x,R=(v*A-y*T)*x,I=(E*T-m*A)*x,O=Math.cos(this.rotation),D=Math.sin(this.rotation),N=this.zoomX,F=this.zoomY,G=this.scrollX,L=this.scrollY,C=u+(G*O-L*D)*N,P=p+(G*D+L*O)*F;return d.x=C*_+P*M+R,d.y=C*b+P*w+I,d},ignore:function(u){var p=this.id;Array.isArray(u)||(u=[u]);for(var d=0;d<u.length;d++){var g=u[d];Array.isArray(g)?this.ignore(g):g.isParent?this.ignore(g.getChildren()):g.cameraFilter|=p}return this},clampX:function(u){var p=this._bounds,d=this.displayWidth,g=p.x+(d-this.width)/2,m=Math.max(g,g+p.width-d);return u<g?u=g:u>m&&(u=m),u},clampY:function(u){var p=this._bounds,d=this.displayHeight,g=p.y+(d-this.height)/2,m=Math.max(g,g+p.height-d);return u<g?u=g:u>m&&(u=m),u},removeBounds:function(){return this.useBounds=!1,this.dirty=!0,this._bounds.setEmpty(),this},setAngle:function(u){return u===void 0&&(u=0),this.rotation=n(u),this},setBackgroundColor:function(u){return u===void 0&&(u="rgba(0,0,0,0)"),this.backgroundColor=l(u),this.transparent=this.backgroundColor.alpha===0,this},setBounds:function(u,p,d,g,m){return m===void 0&&(m=!1),this._bounds.setTo(u,p,d,g),this.dirty=!0,this.useBounds=!0,m?this.centerToBounds():(this.scrollX=this.clampX(this.scrollX),this.scrollY=this.clampY(this.scrollY)),this},getBounds:function(u){u===void 0&&(u=new a);var p=this._bounds;return u.setTo(p.x,p.y,p.width,p.height),u},setName:function(u){return u===void 0&&(u=""),this.name=u,this},setPosition:function(u,p){return p===void 0&&(p=u),this.x=u,this.y=p,this},setRotation:function(u){return u===void 0&&(u=0),this.rotation=u,this},setRoundPixels:function(u){return this.roundPixels=u,this},setScene:function(u,p){p===void 0&&(p=!0),this.scene&&this._customViewport&&this.sceneManager.customViewports--,this.scene=u,this.isSceneCamera=p;var d=u.sys;return this.sceneManager=d.game.scene,this.scaleManager=d.scale,this.cameraManager=d.cameras,this.updateSystem(),this},setScroll:function(u,p){return p===void 0&&(p=u),this.scrollX=u,this.scrollY=p,this},setSize:function(u,p){return p===void 0&&(p=u),this.width=u,this.height=p,this},setViewport:function(u,p,d,g){return this.x=u,this.y=p,this.width=d,this.height=g,this},setZoom:function(u,p){return u===void 0&&(u=1),p===void 0&&(p=u),u===0&&(u=.001),p===0&&(p=.001),this.zoomX=u,this.zoomY=p,this},setMask:function(u,p){return p===void 0&&(p=!0),this.mask=u,this._maskCamera=p?this.cameraManager.default:this,this},clearMask:function(u){return u===void 0&&(u=!1),u&&this.mask&&this.mask.destroy(),this.mask=null,this},toJSON:function(){var u={name:this.name,x:this.x,y:this.y,width:this.width,height:this.height,zoom:this.zoom,rotation:this.rotation,roundPixels:this.roundPixels,scrollX:this.scrollX,scrollY:this.scrollY,backgroundColor:this.backgroundColor.rgba};return this.useBounds&&(u.bounds={x:this._bounds.x,y:this._bounds.y,width:this._bounds.width,height:this._bounds.height}),u},update:function(){},setIsSceneCamera:function(u){return this.isSceneCamera=u,this},updateSystem:function(){if(!(!this.scaleManager||!this.isSceneCamera)){var u=this._x!==0||this._y!==0||this.scaleManager.width!==this._width||this.scaleManager.height!==this._height,p=this.sceneManager;u&&!this._customViewport?p.customViewports++:!u&&this._customViewport&&p.customViewports--,this.dirty=!0,this._customViewport=u}},destroy:function(){this.emit(o.DESTROY,this),this.removeAllListeners(),this.matrix.destroy(),this.culledObjects=[],this._customViewport&&this.sceneManager.customViewports--,this.renderList=[],this._bounds=null,this.scene=null,this.scaleManager=null,this.sceneManager=null,this.cameraManager=null},x:{get:function(){return this._x},set:function(u){this._x=u,this.updateSystem()}},y:{get:function(){return this._y},set:function(u){this._y=u,this.updateSystem()}},width:{get:function(){return this._width},set:function(u){this._width=u,this.updateSystem()}},height:{get:function(){return this._height},set:function(u){this._height=u,this.updateSystem()}},scrollX:{get:function(){return this._scrollX},set:function(u){u!==this._scrollX&&(this._scrollX=u,this.dirty=!0)}},scrollY:{get:function(){return this._scrollY},set:function(u){u!==this._scrollY&&(this._scrollY=u,this.dirty=!0)}},zoom:{get:function(){return(this._zoomX+this._zoomY)/2},set:function(u){this._zoomX=u,this._zoomY=u,this.dirty=!0}},zoomX:{get:function(){return this._zoomX},set:function(u){this._zoomX=u,this.dirty=!0}},zoomY:{get:function(){return this._zoomY},set:function(u){this._zoomY=u,this.dirty=!0}},rotation:{get:function(){return this._rotation},set:function(u){this._rotation=u,this.dirty=!0}},centerX:{get:function(){return this.x+.5*this.width}},centerY:{get:function(){return this.y+.5*this.height}},displayWidth:{get:function(){return this.width/this.zoomX}},displayHeight:{get:function(){return this.height/this.zoomY}}});t.exports=f}),Ta=S((e,t)=>{"use strict";var i=function(s,n,r){return s.x=n-s.width/2,s.y=r-s.height/2,s};t.exports=i}),pv=S((e,t)=>{"use strict";var i=Xt(),s=V(),n=je(),r=new s({initialize:function(o){this.camera=o,this.isRunning=!1,this.isComplete=!1,this.direction=!0,this.duration=0,this.red=0,this.green=0,this.blue=0,this.alpha=0,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(o,a,h,l,c,f,u,p){if(o===void 0&&(o=!0),a===void 0&&(a=1e3),h===void 0&&(h=0),l===void 0&&(l=0),c===void 0&&(c=0),f===void 0&&(f=!1),u===void 0&&(u=null),p===void 0&&(p=this.camera.scene),!f&&this.isRunning)return this.camera;this.isRunning=!0,this.isComplete=!1,this.duration=a,this.direction=o,this.progress=0,this.red=h,this.green=l,this.blue=c,this.alpha=o?Number.MIN_VALUE:1,this._elapsed=0,this._onUpdate=u,this._onUpdateScope=p;var d=o?n.FADE_OUT_START:n.FADE_IN_START;return this.camera.emit(d,this.camera,this,a,h,l,c),this.camera},update:function(o,a){this.isRunning&&(this._elapsed+=a,this.progress=i(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration?this.alpha=this.direction?this.progress:1-this.progress:(this.alpha=this.direction?1:0,this.effectComplete()))},postRenderCanvas:function(o){if(!this.isRunning&&!this.isComplete)return!1;var a=this.camera;return o.fillStyle="rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")",o.fillRect(a.x,a.y,a.width,a.height),!0},postRenderWebGL:function(o,a){if(!this.isRunning&&!this.isComplete)return!1;var h=this.camera,l=this.red/255,c=this.green/255,f=this.blue/255;return o.drawFillRect(h.x,h.y,h.width,h.height,a(f,c,l,1),this.alpha),!0},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.isComplete=!0;var o=this.direction?n.FADE_OUT_COMPLETE:n.FADE_IN_COMPLETE;this.camera.emit(o,this.camera,this)},reset:function(){this.isRunning=!1,this.isComplete=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});t.exports=r}),gv=S((e,t)=>{"use strict";var i=Xt(),s=V(),n=je(),r=new s({initialize:function(o){this.camera=o,this.isRunning=!1,this.duration=0,this.red=0,this.green=0,this.blue=0,this.alpha=1,this.progress=0,this._elapsed=0,this._alpha,this._onUpdate,this._onUpdateScope},start:function(o,a,h,l,c,f,u){return o===void 0&&(o=250),a===void 0&&(a=255),h===void 0&&(h=255),l===void 0&&(l=255),c===void 0&&(c=!1),f===void 0&&(f=null),u===void 0&&(u=this.camera.scene),!c&&this.isRunning?this.camera:(this.isRunning=!0,this.duration=o,this.progress=0,this.red=a,this.green=h,this.blue=l,this._alpha=this.alpha,this._elapsed=0,this._onUpdate=f,this._onUpdateScope=u,this.camera.emit(n.FLASH_START,this.camera,this,o,a,h,l),this.camera)},update:function(o,a){this.isRunning&&(this._elapsed+=a,this.progress=i(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration?this.alpha=this._alpha*(1-this.progress):this.effectComplete())},postRenderCanvas:function(o){if(!this.isRunning)return!1;var a=this.camera;return o.fillStyle="rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")",o.fillRect(a.x,a.y,a.width,a.height),!0},postRenderWebGL:function(o,a){if(!this.isRunning)return!1;var h=this.camera,l=this.red/255,c=this.green/255,f=this.blue/255;return o.drawFillRect(h.x,h.y,h.width,h.height,a(f,c,l,1),this.alpha),!0},effectComplete:function(){this.alpha=this._alpha,this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(n.FLASH_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});t.exports=r}),fv=S((e,t)=>{"use strict";var i=function(s,n){return n===void 0&&(n=1.70158),s*s*((n+1)*s-n)};t.exports=i}),mv=S((e,t)=>{"use strict";var i=function(s,n){return n===void 0&&(n=1.70158),--s*s*((n+1)*s+n)+1};t.exports=i}),vv=S((e,t)=>{"use strict";var i=function(s,n){n===void 0&&(n=1.70158);var r=n*1.525;return(s*=2)<1?.5*(s*s*((r+1)*s-r)):.5*((s-=2)*s*((r+1)*s+r)+2)};t.exports=i}),rl=S((e,t)=>{"use strict";t.exports={In:fv(),Out:mv(),InOut:vv()}}),Ev=S((e,t)=>{"use strict";var i=function(s){return s=1-s,s<.36363636363636365?1-7.5625*s*s:s<.7272727272727273?1-(7.5625*(s-=.5454545454545454)*s+.75):s<.9090909090909091?1-(7.5625*(s-=.8181818181818182)*s+.9375):1-(7.5625*(s-=.9545454545454546)*s+.984375)};t.exports=i}),yv=S((e,t)=>{"use strict";var i=function(s){return s<.36363636363636365?7.5625*s*s:s<.7272727272727273?7.5625*(s-=.5454545454545454)*s+.75:s<.9090909090909091?7.5625*(s-=.8181818181818182)*s+.9375:7.5625*(s-=.9545454545454546)*s+.984375};t.exports=i}),Tv=S((e,t)=>{"use strict";var i=function(s){var n=!1;return s<.5?(s=1-s*2,n=!0):s=s*2-1,s<.36363636363636365?s=7.5625*s*s:s<.7272727272727273?s=7.5625*(s-=.5454545454545454)*s+.75:s<.9090909090909091?s=7.5625*(s-=.8181818181818182)*s+.9375:s=7.5625*(s-=.9545454545454546)*s+.984375,n?(1-s)*.5:s*.5+.5};t.exports=i}),al=S((e,t)=>{"use strict";t.exports={In:Ev(),Out:yv(),InOut:Tv()}}),Sv=S((e,t)=>{"use strict";var i=function(s){return 1-Math.sqrt(1-s*s)};t.exports=i}),Av=S((e,t)=>{"use strict";var i=function(s){return Math.sqrt(1- --s*s)};t.exports=i}),xv=S((e,t)=>{"use strict";var i=function(s){return(s*=2)<1?-.5*(Math.sqrt(1-s*s)-1):.5*(Math.sqrt(1-(s-=2)*s)+1)};t.exports=i}),ol=S((e,t)=>{"use strict";t.exports={In:Sv(),Out:Av(),InOut:xv()}}),wv=S((e,t)=>{"use strict";var i=function(s){return s*s*s};t.exports=i}),Rv=S((e,t)=>{"use strict";var i=function(s){return--s*s*s+1};t.exports=i}),Cv=S((e,t)=>{"use strict";var i=function(s){return(s*=2)<1?.5*s*s*s:.5*((s-=2)*s*s+2)};t.exports=i}),hl=S((e,t)=>{"use strict";t.exports={In:wv(),Out:Rv(),InOut:Cv()}}),_v=S((e,t)=>{"use strict";var i=function(s,n,r){if(n===void 0&&(n=.1),r===void 0&&(r=.1),s===0)return 0;if(s===1)return 1;var o=r/4;return n<1?n=1:o=r*Math.asin(1/n)/(2*Math.PI),-(n*Math.pow(2,10*(s-=1))*Math.sin((s-o)*(2*Math.PI)/r))};t.exports=i}),bv=S((e,t)=>{"use strict";var i=function(s,n,r){if(n===void 0&&(n=.1),r===void 0&&(r=.1),s===0)return 0;if(s===1)return 1;var o=r/4;return n<1?n=1:o=r*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*s)*Math.sin((s-o)*(2*Math.PI)/r)+1};t.exports=i}),Pv=S((e,t)=>{"use strict";var i=function(s,n,r){if(n===void 0&&(n=.1),r===void 0&&(r=.1),s===0)return 0;if(s===1)return 1;var o=r/4;return n<1?n=1:o=r*Math.asin(1/n)/(2*Math.PI),(s*=2)<1?-.5*(n*Math.pow(2,10*(s-=1))*Math.sin((s-o)*(2*Math.PI)/r)):n*Math.pow(2,-10*(s-=1))*Math.sin((s-o)*(2*Math.PI)/r)*.5+1};t.exports=i}),ll=S((e,t)=>{"use strict";t.exports={In:_v(),Out:bv(),InOut:Pv()}}),Lv=S((e,t)=>{"use strict";var i=function(s){return Math.pow(2,10*(s-1))-.001};t.exports=i}),Iv=S((e,t)=>{"use strict";var i=function(s){return 1-Math.pow(2,-10*s)};t.exports=i}),Mv=S((e,t)=>{"use strict";var i=function(s){return(s*=2)<1?.5*Math.pow(2,10*(s-1)):.5*(2-Math.pow(2,-10*(s-1)))};t.exports=i}),ul=S((e,t)=>{"use strict";t.exports={In:Lv(),Out:Iv(),InOut:Mv()}}),Ov=S((e,t)=>{"use strict";var i=function(s){return s};t.exports=i}),cl=S((e,t)=>{"use strict";t.exports=Ov()}),Dv=S((e,t)=>{"use strict";var i=function(s){return s*s};t.exports=i}),kv=S((e,t)=>{"use strict";var i=function(s){return s*(2-s)};t.exports=i}),Bv=S((e,t)=>{"use strict";var i=function(s){return(s*=2)<1?.5*s*s:-.5*(--s*(s-2)-1)};t.exports=i}),dl=S((e,t)=>{"use strict";t.exports={In:Dv(),Out:kv(),InOut:Bv()}}),Nv=S((e,t)=>{"use strict";var i=function(s){return s*s*s*s};t.exports=i}),Uv=S((e,t)=>{"use strict";var i=function(s){return 1- --s*s*s*s};t.exports=i}),Fv=S((e,t)=>{"use strict";var i=function(s){return(s*=2)<1?.5*s*s*s*s:-.5*((s-=2)*s*s*s-2)};t.exports=i}),pl=S((e,t)=>{"use strict";t.exports={In:Nv(),Out:Uv(),InOut:Fv()}}),Gv=S((e,t)=>{"use strict";var i=function(s){return s*s*s*s*s};t.exports=i}),Yv=S((e,t)=>{"use strict";var i=function(s){return--s*s*s*s*s+1};t.exports=i}),Hv=S((e,t)=>{"use strict";var i=function(s){return(s*=2)<1?.5*s*s*s*s*s:.5*((s-=2)*s*s*s*s+2)};t.exports=i}),gl=S((e,t)=>{"use strict";t.exports={In:Gv(),Out:Yv(),InOut:Hv()}}),Wv=S((e,t)=>{"use strict";var i=function(s){return s===0?0:s===1?1:1-Math.cos(s*Math.PI/2)};t.exports=i}),zv=S((e,t)=>{"use strict";var i=function(s){return s===0?0:s===1?1:Math.sin(s*Math.PI/2)};t.exports=i}),Vv=S((e,t)=>{"use strict";var i=function(s){return s===0?0:s===1?1:.5*(1-Math.cos(Math.PI*s))};t.exports=i}),fl=S((e,t)=>{"use strict";t.exports={In:Wv(),Out:zv(),InOut:Vv()}}),Xv=S((e,t)=>{"use strict";var i=function(s,n){return n===void 0&&(n=1),s<=0?0:s>=1?1:((n*s|0)+1)*(1/n)};t.exports=i}),ml=S((e,t)=>{"use strict";t.exports=Xv()}),zn=S((e,t)=>{"use strict";var i=rl(),s=al(),n=ol(),r=hl(),o=ll(),a=ul(),h=cl(),l=dl(),c=pl(),f=gl(),u=fl(),p=ml();t.exports={Power0:h,Power1:l.Out,Power2:r.Out,Power3:c.Out,Power4:f.Out,Linear:h,Quad:l.Out,Cubic:r.Out,Quart:c.Out,Quint:f.Out,Sine:u.Out,Expo:a.Out,Circ:n.Out,Elastic:o.Out,Back:i.Out,Bounce:s.Out,Stepped:p,"Quad.easeIn":l.In,"Cubic.easeIn":r.In,"Quart.easeIn":c.In,"Quint.easeIn":f.In,"Sine.easeIn":u.In,"Expo.easeIn":a.In,"Circ.easeIn":n.In,"Elastic.easeIn":o.In,"Back.easeIn":i.In,"Bounce.easeIn":s.In,"Quad.easeOut":l.Out,"Cubic.easeOut":r.Out,"Quart.easeOut":c.Out,"Quint.easeOut":f.Out,"Sine.easeOut":u.Out,"Expo.easeOut":a.Out,"Circ.easeOut":n.Out,"Elastic.easeOut":o.Out,"Back.easeOut":i.Out,"Bounce.easeOut":s.Out,"Quad.easeInOut":l.InOut,"Cubic.easeInOut":r.InOut,"Quart.easeInOut":c.InOut,"Quint.easeInOut":f.InOut,"Sine.easeInOut":u.InOut,"Expo.easeInOut":a.InOut,"Circ.easeInOut":n.InOut,"Elastic.easeInOut":o.InOut,"Back.easeInOut":i.InOut,"Bounce.easeInOut":s.InOut}}),Kv=S((e,t)=>{"use strict";var i=Xt(),s=V(),n=zn(),r=je(),o=Ot(),a=new s({initialize:function(h){this.camera=h,this.isRunning=!1,this.duration=0,this.source=new o,this.current=new o,this.destination=new o,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(h,l,c,f,u,p,d){c===void 0&&(c=1e3),f===void 0&&(f=n.Linear),u===void 0&&(u=!1),p===void 0&&(p=null),d===void 0&&(d=this.camera.scene);var g=this.camera;return!u&&this.isRunning||(this.isRunning=!0,this.duration=c,this.progress=0,this.source.set(g.scrollX,g.scrollY),this.destination.set(h,l),g.getScroll(h,l,this.current),typeof f=="string"&&n.hasOwnProperty(f)?this.ease=n[f]:typeof f=="function"&&(this.ease=f),this._elapsed=0,this._onUpdate=p,this._onUpdateScope=d,this.camera.emit(r.PAN_START,this.camera,this,c,h,l)),g},update:function(h,l){if(this.isRunning){this._elapsed+=l;var c=i(this._elapsed/this.duration,0,1);this.progress=c;var f=this.camera;if(this._elapsed<this.duration){var u=this.ease(c);f.getScroll(this.destination.x,this.destination.y,this.current);var p=this.source.x+(this.current.x-this.source.x)*u,d=this.source.y+(this.current.y-this.source.y)*u;f.setScroll(p,d),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,f,c,p,d)}else f.centerOn(this.destination.x,this.destination.y),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,f,c,f.scrollX,f.scrollY),this.effectComplete()}},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(r.PAN_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.source=null,this.destination=null}});t.exports=a}),jv=S((e,t)=>{"use strict";var i=Xt(),s=V(),n=je(),r=Ot(),o=new s({initialize:function(a){this.camera=a,this.isRunning=!1,this.duration=0,this.intensity=new r,this.progress=0,this._elapsed=0,this._offsetX=0,this._offsetY=0,this._onUpdate,this._onUpdateScope},start:function(a,h,l,c,f){return a===void 0&&(a=100),h===void 0&&(h=.05),l===void 0&&(l=!1),c===void 0&&(c=null),f===void 0&&(f=this.camera.scene),!l&&this.isRunning?this.camera:(this.isRunning=!0,this.duration=a,this.progress=0,typeof h=="number"?this.intensity.set(h):this.intensity.set(h.x,h.y),this._elapsed=0,this._offsetX=0,this._offsetY=0,this._onUpdate=c,this._onUpdateScope=f,this.camera.emit(n.SHAKE_START,this.camera,this,a,h),this.camera)},preRender:function(){this.isRunning&&this.camera.matrix.translate(this._offsetX,this._offsetY)},update:function(a,h){if(this.isRunning)if(this._elapsed+=h,this.progress=i(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration){var l=this.intensity,c=this.camera.width,f=this.camera.height,u=this.camera.zoom;this._offsetX=(Math.random()*l.x*c*2-l.x*c)*u,this._offsetY=(Math.random()*l.y*f*2-l.y*f)*u,this.camera.roundPixels&&(this._offsetX=Math.round(this._offsetX),this._offsetY=Math.round(this._offsetY))}else this.effectComplete()},effectComplete:function(){this._offsetX=0,this._offsetY=0,this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(n.SHAKE_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._offsetX=0,this._offsetY=0,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.intensity=null}});t.exports=o}),Zv=S((e,t)=>{"use strict";var i=Xt(),s=V(),n=je(),r=zn(),o=new s({initialize:function(a){this.camera=a,this.isRunning=!1,this.duration=0,this.source=0,this.current=0,this.destination=0,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope,this.clockwise=!0,this.shortestPath=!1},start:function(a,h,l,c,f,u,p){l===void 0&&(l=1e3),c===void 0&&(c=r.Linear),f===void 0&&(f=!1),u===void 0&&(u=null),p===void 0&&(p=this.camera.scene),h===void 0&&(h=!1),this.shortestPath=h;var d=a;a<0?(d=-1*a,this.clockwise=!1):this.clockwise=!0;var g=360*Math.PI/180;d=d-Math.floor(d/g)*g;var m=this.camera;if(!f&&this.isRunning)return m;if(this.isRunning=!0,this.duration=l,this.progress=0,this.source=m.rotation,this.destination=d,typeof c=="string"&&r.hasOwnProperty(c)?this.ease=r[c]:typeof c=="function"&&(this.ease=c),this._elapsed=0,this._onUpdate=u,this._onUpdateScope=p,this.shortestPath){var E=0,v=0;this.destination>this.source?E=Math.abs(this.destination-this.source):E=Math.abs(this.destination+g)-this.source,this.source>this.destination?v=Math.abs(this.source-this.destination):v=Math.abs(this.source+g)-this.destination,E<v?this.clockwise=!0:E>v&&(this.clockwise=!1)}return this.camera.emit(n.ROTATE_START,this.camera,this,l,d),m},update:function(a,h){if(this.isRunning){this._elapsed+=h;var l=i(this._elapsed/this.duration,0,1);this.progress=l;var c=this.camera;if(this._elapsed<this.duration){var f=this.ease(l);this.current=c.rotation;var u=0,p=360*Math.PI/180,d=this.destination,g=this.current;this.clockwise===!1&&(d=this.current,g=this.destination),d>=g?u=Math.abs(d-g):u=Math.abs(d+p)-g;var m=0;this.clockwise?m=c.rotation+u*f:m=c.rotation-u*f,c.rotation=m,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,c,l,m)}else c.rotation=this.destination,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,c,l,this.destination),this.effectComplete()}},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(n.ROTATE_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.source=null,this.destination=null}});t.exports=o}),qv=S((e,t)=>{"use strict";var i=Xt(),s=V(),n=zn(),r=je(),o=new s({initialize:function(a){this.camera=a,this.isRunning=!1,this.duration=0,this.source=1,this.destination=1,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(a,h,l,c,f,u){h===void 0&&(h=1e3),l===void 0&&(l=n.Linear),c===void 0&&(c=!1),f===void 0&&(f=null),u===void 0&&(u=this.camera.scene);var p=this.camera;return!c&&this.isRunning||(this.isRunning=!0,this.duration=h,this.progress=0,this.source=p.zoom,this.destination=a,typeof l=="string"&&n.hasOwnProperty(l)?this.ease=n[l]:typeof l=="function"&&(this.ease=l),this._elapsed=0,this._onUpdate=f,this._onUpdateScope=u,this.camera.emit(r.ZOOM_START,this.camera,this,h,a)),p},update:function(a,h){this.isRunning&&(this._elapsed+=h,this.progress=i(this._elapsed/this.duration,0,1),this._elapsed<this.duration?(this.camera.zoom=this.source+(this.destination-this.source)*this.ease(this.progress),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress,this.camera.zoom)):(this.camera.zoom=this.destination,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress,this.destination),this.effectComplete()))},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(r.ZOOM_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});t.exports=o}),Qv=S((e,t)=>{"use strict";t.exports={Fade:pv(),Flash:gv(),Pan:Kv(),Shake:jv(),RotateTo:Zv(),Zoom:qv()}}),Vn=S((e,t)=>{"use strict";var i=function(s,n,r){return(n-s)*r+s};t.exports=i}),Xn=S((e,t)=>{"use strict";var i=ya(),s=Ta(),n=Xt(),r=V(),o=me(),a=Qv(),h=je(),l=Vn(),c=zt(),f=Ot(),u=new r({Extends:i,Mixins:[o.PostPipeline],initialize:function(p,d,g,m){i.call(this,p,d,g,m),this.initPostPipeline(),this.inputEnabled=!0,this.fadeEffect=new a.Fade(this),this.lerp=new f(1,1),this.followOffset=new f,this.deadzone=null,this._follow=null},setDeadzone:function(p,d){if(p===void 0)this.deadzone=null;else{if(this.deadzone?(this.deadzone.width=p,this.deadzone.height=d):this.deadzone=new c(0,0,p,d),this._follow){var g=this.width/2,m=this.height/2,E=this._follow.x-this.followOffset.x,v=this._follow.y-this.followOffset.y;this.midPoint.set(E,v),this.scrollX=E-g,this.scrollY=v-m}s(this.deadzone,this.midPoint.x,this.midPoint.y)}return this},fadeIn:function(p,d,g,m,E,v){return this.fadeEffect.start(!1,p,d,g,m,!0,E,v)},fadeOut:function(p,d,g,m,E,v){return this.fadeEffect.start(!0,p,d,g,m,!0,E,v)},preRender:function(){this.renderList.length=0;var p=this.width,d=this.height,g=p*.5,m=d*.5,E=this.zoomX,v=this.zoomY,y=this.matrix;this.renderRoundPixels=this.roundPixels&&Number.isInteger(E)&&Number.isInteger(v);var T=p*this.originX,A=d*this.originY,x=this._follow,_=this.deadzone,b=this.scrollX,M=this.scrollY;_&&s(_,this.midPoint.x,this.midPoint.y);var w=!1;if(x){var R=this.lerp,I=x.x-this.followOffset.x,O=x.y-this.followOffset.y;_?(I<_.x?b=l(b,b-(_.x-I),R.x):I>_.right&&(b=l(b,b+(I-_.right),R.x)),O<_.y?M=l(M,M-(_.y-O),R.y):O>_.bottom&&(M=l(M,M+(O-_.bottom),R.y))):(b=l(b,I-T,R.x),M=l(M,O-A,R.y)),w=!0}this.roundPixels&&(b=Math.floor(b),M=Math.floor(M)),this.useBounds&&(b=this.clampX(b),M=this.clampY(M)),this.scrollX=b,this.scrollY=M;var D=b+g,N=M+m;this.midPoint.set(D,N);var F=Math.floor(p/E+.5),G=Math.floor(d/v+.5),L=Math.floor(D-F/2+.5),C=Math.floor(N-G/2+.5);this.worldView.setTo(L,C,F,G),y.applyITRS(Math.floor(this.x+T+.5),Math.floor(this.y+A+.5),this.rotation,E,v),y.translate(-T,-A),w&&this.emit(h.FOLLOW_UPDATE,this,x)},setLerp:function(p,d){return p===void 0&&(p=1),d===void 0&&(d=p),this.lerp.set(p,d),this},setFollowOffset:function(p,d){return p===void 0&&(p=0),d===void 0&&(d=0),this.followOffset.set(p,d),this},startFollow:function(p,d,g,m,E,v){d===void 0&&(d=!1),g===void 0&&(g=1),m===void 0&&(m=g),E===void 0&&(E=0),v===void 0&&(v=E),this._follow=p,this.roundPixels=d,g=n(g,0,1),m=n(m,0,1),this.lerp.set(g,m),this.followOffset.set(E,v);var y=this.width/2,T=this.height/2,A=p.x-E,x=p.y-v;return this.midPoint.set(A,x),this.scrollX=A-y,this.scrollY=x-T,this.useBounds&&(this.scrollX=this.clampX(this.scrollX),this.scrollY=this.clampY(this.scrollY)),this},stopFollow:function(){return this._follow=null,this},resetFX:function(){return this},update:function(p,d){this.visible&&this.fadeEffect.update(p,d)},destroy:function(){this.resetFX(),i.prototype.destroy.call(this),this._follow=null,this.deadzone=null}});t.exports=u}),Jv=S((e,t)=>{"use strict";t.exports="enterfullscreen"}),$v=S((e,t)=>{"use strict";t.exports="fullscreenfailed"}),t0=S((e,t)=>{"use strict";t.exports="fullscreenunsupported"}),e0=S((e,t)=>{"use strict";t.exports="leavefullscreen"}),i0=S((e,t)=>{"use strict";t.exports="orientationchange"}),s0=S((e,t)=>{"use strict";t.exports="resize"}),Sa=S((e,t)=>{"use strict";t.exports={ENTER_FULLSCREEN:Jv(),FULLSCREEN_FAILED:$v(),FULLSCREEN_UNSUPPORTED:t0(),LEAVE_FULLSCREEN:e0(),ORIENTATION_CHANGE:i0(),RESIZE:s0()}}),n0=S((e,t)=>{"use strict";var i=Xn(),s=V(),n=pt(),r=ae(),o=vs(),a=Sa(),h=Nt(),l=new s({initialize:function(c){this.scene=c,this.systems=c.sys,this.roundPixels=c.sys.game.config.roundPixels,this.cameras=[],this.main,this.default,c.sys.events.once(h.BOOT,this.boot,this),c.sys.events.on(h.START,this.start,this)},boot:function(){var c=this.systems;c.settings.cameras?this.fromJSON(c.settings.cameras):this.add(),this.main=this.cameras[0],this.default=new i(0,0,c.scale.width,c.scale.height).setScene(this.scene),c.game.scale.on(a.RESIZE,this.onResize,this),this.systems.events.once(h.DESTROY,this.destroy,this)},start:function(){if(!this.main){var c=this.systems;c.settings.cameras?this.fromJSON(c.settings.cameras):this.add(),this.main=this.cameras[0]}var f=this.systems.events;f.on(h.UPDATE,this.update,this),f.once(h.SHUTDOWN,this.shutdown,this)},add:function(c,f,u,p,d,g){c===void 0&&(c=0),f===void 0&&(f=0),u===void 0&&(u=this.scene.sys.scale.width),p===void 0&&(p=this.scene.sys.scale.height),d===void 0&&(d=!1),g===void 0&&(g="");var m=new i(c,f,u,p);return m.setName(g),m.setScene(this.scene),m.setRoundPixels(this.roundPixels),m.id=this.getNextID(),this.cameras.push(m),d&&(this.main=m),m},addExisting:function(c,f){f===void 0&&(f=!1);var u=this.cameras.indexOf(c);return u===-1?(c.id=this.getNextID(),c.setRoundPixels(this.roundPixels),this.cameras.push(c),f&&(this.main=c),c):null},getNextID:function(){for(var c=this.cameras,f=1,u=0;u<32;u++){for(var p=!1,d=0;d<c.length;d++){var g=c[d];if(g&&g.id===f){p=!0;continue}}if(p)f=f<<1;else return f}return 0},getTotal:function(c){c===void 0&&(c=!1);for(var f=0,u=this.cameras,p=0;p<u.length;p++){var d=u[p];(!c||c&&d.visible)&&f++}return f},fromJSON:function(c){Array.isArray(c)||(c=[c]);for(var f=this.scene.sys.scale.width,u=this.scene.sys.scale.height,p=0;p<c.length;p++){var d=c[p],g=n(d,"x",0),m=n(d,"y",0),E=n(d,"width",f),v=n(d,"height",u),y=this.add(g,m,E,v);y.name=n(d,"name",""),y.zoom=n(d,"zoom",1),y.rotation=n(d,"rotation",0),y.scrollX=n(d,"scrollX",0),y.scrollY=n(d,"scrollY",0),y.roundPixels=n(d,"roundPixels",!1),y.visible=n(d,"visible",!0);var T=n(d,"backgroundColor",!1);T&&y.setBackgroundColor(T);var A=n(d,"bounds",null);if(A){var x=n(A,"x",0),_=n(A,"y",0),b=n(A,"width",f),M=n(A,"height",u);y.setBounds(x,_,b,M)}}return this},getCamera:function(c){for(var f=this.cameras,u=0;u<f.length;u++)if(f[u].name===c)return f[u];return null},getCamerasBelowPointer:function(c){for(var f=this.cameras,u=c.x,p=c.y,d=[],g=0;g<f.length;g++){var m=f[g];m.visible&&m.inputEnabled&&o(m,u,p)&&d.unshift(m)}return d},remove:function(c,f){f===void 0&&(f=!0),Array.isArray(c)||(c=[c]);for(var u=0,p=this.cameras,d=0;d<c.length;d++){var g=p.indexOf(c[d]);g!==-1&&(f?p[g].destroy():p[g].renderList=[],p.splice(g,1),u++)}return!this.main&&p[0]&&(this.main=p[0]),u},render:function(c,f){for(var u=this.scene,p=this.cameras,d=0;d<p.length;d++){var g=p[d];if(g.visible&&g.alpha>0){g.preRender();var m=this.getVisibleChildren(f.getChildren(),g);c.render(u,m,g)}}},getVisibleChildren:function(c,f){return c.filter(function(u){return u.willRender(f)})},resetAll:function(){for(var c=0;c<this.cameras.length;c++)this.cameras[c].destroy();return this.cameras=[],this.main=this.add(),this.main},update:function(c,f){for(var u=0;u<this.cameras.length;u++)this.cameras[u].update(c,f)},onResize:function(c,f,u,p,d){for(var g=0;g<this.cameras.length;g++){var m=this.cameras[g];m._x===0&&m._y===0&&m._width===p&&m._height===d&&m.setSize(f.width,f.height)}},resize:function(c,f){for(var u=0;u<this.cameras.length;u++)this.cameras[u].setSize(c,f)},shutdown:function(){this.main=void 0;for(var c=0;c<this.cameras.length;c++)this.cameras[c].destroy();this.cameras=[];var f=this.systems.events;f.off(h.UPDATE,this.update,this),f.off(h.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.default.destroy(),this.systems.events.off(h.START,this.start,this),this.systems.events.off(h.DESTROY,this.destroy,this),this.systems.game.scale.off(a.RESIZE,this.onResize,this),this.scene=null,this.systems=null}});r.register("CameraManager",l,"cameras"),t.exports=l}),r0=S((e,t)=>{"use strict";t.exports={Camera:Xn(),BaseCamera:ya(),CameraManager:n0(),Events:je()}}),vl=S((e,t)=>{"use strict";t.exports={Scene2D:r0()}}),a0=S((e,t)=>{"use strict";var i=V(),s=Wt(),n=ae(),r=new i({Extends:s,initialize:function(){s.call(this)},shutdown:function(){this.removeAllListeners()},destroy:function(){this.removeAllListeners()}});n.register("EventEmitter",r,"events"),t.exports=r}),o0=S((e,t)=>{"use strict";t.exports={EventEmitter:a0()}}),Aa=S((e,t)=>{"use strict";var i={MOUSE_DOWN:0,MOUSE_MOVE:1,MOUSE_UP:2,TOUCH_START:3,TOUCH_MOVE:4,TOUCH_END:5,POINTER_LOCK_CHANGE:6,TOUCH_CANCEL:7,MOUSE_WHEEL:8};t.exports=i}),El=S((e,t)=>{"use strict";var i=function(s,n){return function(r,o,a,h){var l=s.getPixelAlpha(o,a,h.texture.key,h.frame.name);return l&&l>=n}};t.exports=i}),yl=S((e,t)=>{"use strict";var i=function(s,n,r){return{gameObject:s,enabled:!0,draggable:!1,dropZone:!1,cursor:!1,target:null,camera:null,hitArea:n,hitAreaCallback:r,hitAreaDebug:null,customHitArea:!1,localX:0,localY:0,dragState:0,dragStartX:0,dragStartY:0,dragStartXGlobal:0,dragStartYGlobal:0,dragStartCamera:null,dragX:0,dragY:0}};t.exports=i}),h0=S((e,t)=>{"use strict";t.exports="boot"}),l0=S((e,t)=>{"use strict";t.exports="destroy"}),u0=S((e,t)=>{"use strict";t.exports="dragend"}),c0=S((e,t)=>{"use strict";t.exports="dragenter"}),d0=S((e,t)=>{"use strict";t.exports="drag"}),p0=S((e,t)=>{"use strict";t.exports="dragleave"}),g0=S((e,t)=>{"use strict";t.exports="dragover"}),f0=S((e,t)=>{"use strict";t.exports="dragstart"}),m0=S((e,t)=>{"use strict";t.exports="drop"}),v0=S((e,t)=>{"use strict";t.exports="gameout"}),E0=S((e,t)=>{"use strict";t.exports="gameover"}),y0=S((e,t)=>{"use strict";t.exports="gameobjectdown"}),T0=S((e,t)=>{"use strict";t.exports="dragend"}),S0=S((e,t)=>{"use strict";t.exports="dragenter"}),A0=S((e,t)=>{"use strict";t.exports="drag"}),x0=S((e,t)=>{"use strict";t.exports="dragleave"}),w0=S((e,t)=>{"use strict";t.exports="dragover"}),R0=S((e,t)=>{"use strict";t.exports="dragstart"}),C0=S((e,t)=>{"use strict";t.exports="drop"}),_0=S((e,t)=>{"use strict";t.exports="gameobjectmove"}),b0=S((e,t)=>{"use strict";t.exports="gameobjectout"}),P0=S((e,t)=>{"use strict";t.exports="gameobjectover"}),L0=S((e,t)=>{"use strict";t.exports="pointerdown"}),I0=S((e,t)=>{"use strict";t.exports="pointermove"}),M0=S((e,t)=>{"use strict";t.exports="pointerout"}),O0=S((e,t)=>{"use strict";t.exports="pointerover"}),D0=S((e,t)=>{"use strict";t.exports="pointerup"}),k0=S((e,t)=>{"use strict";t.exports="wheel"}),B0=S((e,t)=>{"use strict";t.exports="gameobjectup"}),N0=S((e,t)=>{"use strict";t.exports="gameobjectwheel"}),U0=S((e,t)=>{"use strict";t.exports="boot"}),F0=S((e,t)=>{"use strict";t.exports="process"}),G0=S((e,t)=>{"use strict";t.exports="update"}),Y0=S((e,t)=>{"use strict";t.exports="pointerdown"}),H0=S((e,t)=>{"use strict";t.exports="pointerdownoutside"}),W0=S((e,t)=>{"use strict";t.exports="pointermove"}),z0=S((e,t)=>{"use strict";t.exports="pointerout"}),V0=S((e,t)=>{"use strict";t.exports="pointerover"}),X0=S((e,t)=>{"use strict";t.exports="pointerup"}),K0=S((e,t)=>{"use strict";t.exports="pointerupoutside"}),j0=S((e,t)=>{"use strict";t.exports="wheel"}),Z0=S((e,t)=>{"use strict";t.exports="pointerlockchange"}),q0=S((e,t)=>{"use strict";t.exports="preupdate"}),Q0=S((e,t)=>{"use strict";t.exports="shutdown"}),J0=S((e,t)=>{"use strict";t.exports="start"}),$0=S((e,t)=>{"use strict";t.exports="update"}),Zt=S((e,t)=>{"use strict";t.exports={BOOT:h0(),DESTROY:l0(),DRAG_END:u0(),DRAG_ENTER:c0(),DRAG:d0(),DRAG_LEAVE:p0(),DRAG_OVER:g0(),DRAG_START:f0(),DROP:m0(),GAME_OUT:v0(),GAME_OVER:E0(),GAMEOBJECT_DOWN:y0(),GAMEOBJECT_DRAG_END:T0(),GAMEOBJECT_DRAG_ENTER:S0(),GAMEOBJECT_DRAG:A0(),GAMEOBJECT_DRAG_LEAVE:x0(),GAMEOBJECT_DRAG_OVER:w0(),GAMEOBJECT_DRAG_START:R0(),GAMEOBJECT_DROP:C0(),GAMEOBJECT_MOVE:_0(),GAMEOBJECT_OUT:b0(),GAMEOBJECT_OVER:P0(),GAMEOBJECT_POINTER_DOWN:L0(),GAMEOBJECT_POINTER_MOVE:I0(),GAMEOBJECT_POINTER_OUT:M0(),GAMEOBJECT_POINTER_OVER:O0(),GAMEOBJECT_POINTER_UP:D0(),GAMEOBJECT_POINTER_WHEEL:k0(),GAMEOBJECT_UP:B0(),GAMEOBJECT_WHEEL:N0(),MANAGER_BOOT:U0(),MANAGER_PROCESS:F0(),MANAGER_UPDATE:G0(),POINTER_DOWN:Y0(),POINTER_DOWN_OUTSIDE:H0(),POINTER_MOVE:W0(),POINTER_OUT:z0(),POINTER_OVER:V0(),POINTER_UP:X0(),POINTER_UP_OUTSIDE:K0(),POINTER_WHEEL:j0(),POINTERLOCK_CHANGE:Z0(),PRE_UPDATE:q0(),SHUTDOWN:Q0(),START:J0(),UPDATE:$0()}}),tE=S((e,t)=>{"use strict";t.exports="blur"}),eE=S((e,t)=>{"use strict";t.exports="boot"}),iE=S((e,t)=>{"use strict";t.exports="contextlost"}),sE=S((e,t)=>{"use strict";t.exports="destroy"}),nE=S((e,t)=>{"use strict";t.exports="focus"}),rE=S((e,t)=>{"use strict";t.exports="hidden"}),aE=S((e,t)=>{"use strict";t.exports="pause"}),oE=S((e,t)=>{"use strict";t.exports="postrender"}),hE=S((e,t)=>{"use strict";t.exports="poststep"}),lE=S((e,t)=>{"use strict";t.exports="prerender"}),uE=S((e,t)=>{"use strict";t.exports="prestep"}),cE=S((e,t)=>{"use strict";t.exports="ready"}),dE=S((e,t)=>{"use strict";t.exports="resume"}),pE=S((e,t)=>{"use strict";t.exports="step"}),gE=S((e,t)=>{"use strict";t.exports="systemready"}),fE=S((e,t)=>{"use strict";t.exports="visible"}),Ce=S((e,t)=>{"use strict";t.exports={BLUR:tE(),BOOT:eE(),CONTEXT_LOST:iE(),DESTROY:sE(),FOCUS:nE(),HIDDEN:rE(),PAUSE:aE(),POST_RENDER:oE(),POST_STEP:hE(),PRE_RENDER:lE(),PRE_STEP:uE(),READY:cE(),RESUME:dE(),STEP:pE(),SYSTEM_READY:gE(),VISIBLE:fE()}}),Lt=S((e,t)=>{"use strict";var i=function(){};t.exports=i}),Tl=S((e,t)=>{"use strict";var i=V(),s=la(),n=Zt(),r=Lt(),o=new i({initialize:function(a){this.manager=a,this.preventDefaultDown=!0,this.preventDefaultUp=!0,this.preventDefaultMove=!0,this.preventDefaultWheel=!1,this.enabled=!1,this.target,this.locked=!1,this.onMouseMove=r,this.onMouseDown=r,this.onMouseUp=r,this.onMouseDownWindow=r,this.onMouseUpWindow=r,this.onMouseOver=r,this.onMouseOut=r,this.onMouseWheel=r,this.pointerLockChange=r,this.isTop=!0,a.events.once(n.MANAGER_BOOT,this.boot,this)},boot:function(){var a=this.manager.config;this.enabled=a.inputMouse,this.target=a.inputMouseEventTarget,this.passive=a.inputMousePassive,this.preventDefaultDown=a.inputMousePreventDefaultDown,this.preventDefaultUp=a.inputMousePreventDefaultUp,this.preventDefaultMove=a.inputMousePreventDefaultMove,this.preventDefaultWheel=a.inputMousePreventDefaultWheel,this.target?typeof this.target=="string"&&(this.target=document.getElementById(this.target)):this.target=this.manager.game.canvas,a.disableContextMenu&&this.disableContextMenu(),this.enabled&&this.target&&this.startListeners()},disableContextMenu:function(){return this.target.addEventListener("contextmenu",function(a){return a.preventDefault(),!1}),this},requestPointerLock:function(){if(s.pointerLock){var a=this.target;a.requestPointerLock=a.requestPointerLock||a.mozRequestPointerLock||a.webkitRequestPointerLock,a.requestPointerLock()}},releasePointerLock:function(){s.pointerLock&&(document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,document.exitPointerLock())},startListeners:function(){var a=this.target;if(a){var h=this,l=this.manager,c=l.canvas,f=window&&window.focus&&l.game.config.autoFocus;this.onMouseMove=function(p){!p.defaultPrevented&&h.enabled&&l&&l.enabled&&(l.onMouseMove(p),h.preventDefaultMove&&p.preventDefault())},this.onMouseDown=function(p){f&&window.focus(),!p.defaultPrevented&&h.enabled&&l&&l.enabled&&(l.onMouseDown(p),h.preventDefaultDown&&p.target===c&&p.preventDefault())},this.onMouseDownWindow=function(p){p.sourceCapabilities&&p.sourceCapabilities.firesTouchEvents||!p.defaultPrevented&&h.enabled&&l&&l.enabled&&p.target!==c&&l.onMouseDown(p)},this.onMouseUp=function(p){!p.defaultPrevented&&h.enabled&&l&&l.enabled&&(l.onMouseUp(p),h.preventDefaultUp&&p.target===c&&p.preventDefault())},this.onMouseUpWindow=function(p){p.sourceCapabilities&&p.sourceCapabilities.firesTouchEvents||!p.defaultPrevented&&h.enabled&&l&&l.enabled&&p.target!==c&&l.onMouseUp(p)},this.onMouseOver=function(p){!p.defaultPrevented&&h.enabled&&l&&l.enabled&&l.setCanvasOver(p)},this.onMouseOut=function(p){!p.defaultPrevented&&h.enabled&&l&&l.enabled&&l.setCanvasOut(p)},this.onMouseWheel=function(p){!p.defaultPrevented&&h.enabled&&l&&l.enabled&&l.onMouseWheel(p),h.preventDefaultWheel&&p.target===c&&p.preventDefault()};var u={passive:!0};if(a.addEventListener("mousemove",this.onMouseMove),a.addEventListener("mousedown",this.onMouseDown),a.addEventListener("mouseup",this.onMouseUp),a.addEventListener("mouseover",this.onMouseOver,u),a.addEventListener("mouseout",this.onMouseOut,u),this.preventDefaultWheel?a.addEventListener("wheel",this.onMouseWheel,{passive:!1}):a.addEventListener("wheel",this.onMouseWheel,u),window&&l.game.config.inputWindowEvents)try{window.top.addEventListener("mousedown",this.onMouseDownWindow,u),window.top.addEventListener("mouseup",this.onMouseUpWindow,u)}catch{window.addEventListener("mousedown",this.onMouseDownWindow,u),window.addEventListener("mouseup",this.onMouseUpWindow,u),this.isTop=!1}s.pointerLock&&(this.pointerLockChange=function(p){var d=h.target;h.locked=document.pointerLockElement===d||document.mozPointerLockElement===d||document.webkitPointerLockElement===d,l.onPointerLockChange(p)},document.addEventListener("pointerlockchange",this.pointerLockChange,!0),document.addEventListener("mozpointerlockchange",this.pointerLockChange,!0),document.addEventListener("webkitpointerlockchange",this.pointerLockChange,!0)),this.enabled=!0}},stopListeners:function(){var a=this.target;a.removeEventListener("mousemove",this.onMouseMove),a.removeEventListener("mousedown",this.onMouseDown),a.removeEventListener("mouseup",this.onMouseUp),a.removeEventListener("mouseover",this.onMouseOver),a.removeEventListener("mouseout",this.onMouseOut),window&&(a=this.isTop?window.top:window,a.removeEventListener("mousedown",this.onMouseDownWindow),a.removeEventListener("mouseup",this.onMouseUpWindow)),s.pointerLock&&(document.removeEventListener("pointerlockchange",this.pointerLockChange,!0),document.removeEventListener("mozpointerlockchange",this.pointerLockChange,!0),document.removeEventListener("webkitpointerlockchange",this.pointerLockChange,!0))},destroy:function(){this.stopListeners(),this.target=null,this.enabled=!1,this.manager=null}});t.exports=o}),Sl=S((e,t)=>{"use strict";var i=function(s,n,r,o){return Math.atan2(o-n,r-s)};t.exports=i}),Kn=S((e,t)=>{"use strict";var i=function(s,n,r,o){var a=s-r,h=n-o;return Math.sqrt(a*a+h*h)};t.exports=i}),Al=S((e,t)=>{"use strict";var i=function(s,n,r){return s<=n?0:s>=r?1:(s=(s-n)/(r-n),s*s*(3-2*s))};t.exports=i}),xl=S((e,t)=>{"use strict";var i=Al(),s=function(n,r,o){return r+(o-r)*i(n,0,1)};t.exports=s}),wl=S((e,t)=>{"use strict";var i=Sl(),s=V(),n=Kn(),r=Xh(),o=xl(),a=Ot(),h=sn(),l=new s({initialize:function(c,f){this.manager=c,this.id=f,this.event,this.downElement,this.upElement,this.camera=null,this.button=0,this.buttons=0,this.position=new a,this.prevPosition=new a,this.midPoint=new a(-1,-1),this.velocity=new a,this.angle=0,this.distance=0,this.smoothFactor=0,this.motionFactor=.2,this.worldX=0,this.worldY=0,this.moveTime=0,this.downX=0,this.downY=0,this.downTime=0,this.upX=0,this.upY=0,this.upTime=0,this.primaryDown=!1,this.isDown=!1,this.wasTouch=!1,this.wasCanceled=!1,this.movementX=0,this.movementY=0,this.identifier=0,this.pointerId=null,this.active=f===0,this.locked=!1,this.deltaX=0,this.deltaY=0,this.deltaZ=0},updateWorldPoint:function(c){var f=c.getWorldPoint(this.x,this.y);return this.worldX=f.x,this.worldY=f.y,this},positionToCamera:function(c,f){return c.getWorldPoint(this.x,this.y,f)},updateMotion:function(){var c=this.position.x,f=this.position.y,u=this.midPoint.x,p=this.midPoint.y;if(!(c===u&&f===p)){var d=o(this.motionFactor,u,c),g=o(this.motionFactor,p,f);r(d,c,.1)&&(d=c),r(g,f,.1)&&(g=f),this.midPoint.set(d,g);var m=c-d,E=f-g;this.velocity.set(m,E),this.angle=i(d,g,c,f),this.distance=Math.sqrt(m*m+E*E)}},up:function(c){"buttons"in c&&(this.buttons=c.buttons),this.event=c,this.button=c.button,this.upElement=c.target,this.manager.transformPointer(this,c.pageX,c.pageY,!1),c.button===0&&(this.primaryDown=!1,this.upX=this.x,this.upY=this.y),this.buttons===0&&(this.isDown=!1,this.upTime=c.timeStamp,this.wasTouch=!1)},down:function(c){"buttons"in c&&(this.buttons=c.buttons),this.event=c,this.button=c.button,this.downElement=c.target,this.manager.transformPointer(this,c.pageX,c.pageY,!1),c.button===0&&(this.primaryDown=!0,this.downX=this.x,this.downY=this.y),h.macOS&&c.ctrlKey&&(this.buttons=2,this.primaryDown=!1),this.isDown||(this.isDown=!0,this.downTime=c.timeStamp),this.wasTouch=!1},move:function(c){"buttons"in c&&(this.buttons=c.buttons),this.event=c,this.manager.transformPointer(this,c.pageX,c.pageY,!0),this.locked&&(this.movementX=c.movementX||c.mozMovementX||c.webkitMovementX||0,this.movementY=c.movementY||c.mozMovementY||c.webkitMovementY||0),this.moveTime=c.timeStamp,this.wasTouch=!1},wheel:function(c){"buttons"in c&&(this.buttons=c.buttons),this.event=c,this.manager.transformPointer(this,c.pageX,c.pageY,!1),this.deltaX=c.deltaX,this.deltaY=c.deltaY,this.deltaZ=c.deltaZ,this.wasTouch=!1},touchstart:function(c,f){c.pointerId&&(this.pointerId=c.pointerId),this.identifier=c.identifier,this.target=c.target,this.active=!0,this.buttons=1,this.event=f,this.downElement=c.target,this.manager.transformPointer(this,c.pageX,c.pageY,!1),this.primaryDown=!0,this.downX=this.x,this.downY=this.y,this.downTime=f.timeStamp,this.isDown=!0,this.wasTouch=!0,this.wasCanceled=!1,this.updateMotion()},touchmove:function(c,f){this.event=f,this.manager.transformPointer(this,c.pageX,c.pageY,!0),this.moveTime=f.timeStamp,this.wasTouch=!0,this.updateMotion()},touchend:function(c,f){this.buttons=0,this.event=f,this.upElement=c.target,this.manager.transformPointer(this,c.pageX,c.pageY,!1),this.primaryDown=!1,this.upX=this.x,this.upY=this.y,this.upTime=f.timeStamp,this.isDown=!1,this.wasTouch=!0,this.wasCanceled=!1,this.active=!1,this.updateMotion()},touchcancel:function(c,f){this.buttons=0,this.event=f,this.upElement=c.target,this.manager.transformPointer(this,c.pageX,c.pageY,!1),this.primaryDown=!1,this.upX=this.x,this.upY=this.y,this.upTime=f.timeStamp,this.isDown=!1,this.wasTouch=!0,this.wasCanceled=!0,this.active=!1},noButtonDown:function(){return this.buttons===0},leftButtonDown:function(){return!!(this.buttons&1)},rightButtonDown:function(){return!!(this.buttons&2)},middleButtonDown:function(){return!!(this.buttons&4)},backButtonDown:function(){return!!(this.buttons&8)},forwardButtonDown:function(){return!!(this.buttons&16)},leftButtonReleased:function(){return this.buttons===0?this.button===0&&!this.isDown:this.button===0},rightButtonReleased:function(){return this.buttons===0?this.button===2&&!this.isDown:this.button===2},middleButtonReleased:function(){return this.buttons===0?this.button===1&&!this.isDown:this.button===1},backButtonReleased:function(){return this.buttons===0?this.button===3&&!this.isDown:this.button===3},forwardButtonReleased:function(){return this.buttons===0?this.button===4&&!this.isDown:this.button===4},getDistance:function(){return this.isDown?n(this.downX,this.downY,this.x,this.y):n(this.downX,this.downY,this.upX,this.upY)},getDistanceX:function(){return this.isDown?Math.abs(this.downX-this.x):Math.abs(this.downX-this.upX)},getDistanceY:function(){return this.isDown?Math.abs(this.downY-this.y):Math.abs(this.downY-this.upY)},getDuration:function(){return this.isDown?this.manager.time-this.downTime:this.upTime-this.downTime},getAngle:function(){return this.isDown?i(this.downX,this.downY,this.x,this.y):i(this.downX,this.downY,this.upX,this.upY)},getInterpolatedPosition:function(c,f){c===void 0&&(c=10),f===void 0&&(f=[]);for(var u=this.prevPosition.x,p=this.prevPosition.y,d=this.position.x,g=this.position.y,m=0;m<c;m++){var E=1/c*m;f[m]={x:o(E,u,d),y:o(E,p,g)}}return f},reset:function(){this.event=null,this.downElement=null,this.upElement=null,this.button=0,this.buttons=0,this.position.set(0,0),this.prevPosition.set(0,0),this.midPoint.set(-1,-1),this.velocity.set(0,0),this.angle=0,this.distance=0,this.worldX=0,this.worldY=0,this.downX=0,this.downY=0,this.upX=0,this.upY=0,this.moveTime=0,this.upTime=0,this.downTime=0,this.primaryDown=!1,this.isDown=!1,this.wasTouch=!1,this.wasCanceled=!1,this.movementX=0,this.movementY=0,this.identifier=0,this.pointerId=null,this.deltaX=0,this.deltaY=0,this.deltaZ=0,this.active=this.id===0},destroy:function(){this.camera=null,this.manager=null,this.position=null},x:{get:function(){return this.position.x},set:function(c){this.position.x=c}},y:{get:function(){return this.position.y},set:function(c){this.position.y=c}},time:{get:function(){return this.event?this.event.timeStamp:0}}});t.exports=l}),Rl=S((e,t)=>{"use strict";var i=V(),s=Zt(),n=Lt(),r=new i({initialize:function(o){this.manager=o,this.capture=!0,this.enabled=!1,this.target,this.onTouchStart=n,this.onTouchStartWindow=n,this.onTouchMove=n,this.onTouchEnd=n,this.onTouchEndWindow=n,this.onTouchCancel=n,this.onTouchCancelWindow=n,this.isTop=!0,o.events.once(s.MANAGER_BOOT,this.boot,this)},boot:function(){var o=this.manager.config;this.enabled=o.inputTouch,this.target=o.inputTouchEventTarget,this.capture=o.inputTouchCapture,this.target?typeof this.target=="string"&&(this.target=document.getElementById(this.target)):this.target=this.manager.game.canvas,o.disableContextMenu&&this.disableContextMenu(),this.enabled&&this.target&&this.startListeners()},disableContextMenu:function(){return this.target.addEventListener("contextmenu",function(o){return o.preventDefault(),!1}),this},startListeners:function(){var o=this.target;if(o){var a=this,h=this.manager,l=h.canvas,c=window&&window.focus&&h.game.config.autoFocus;this.onTouchMove=function(d){!d.defaultPrevented&&a.enabled&&h&&h.enabled&&(h.onTouchMove(d),a.capture&&d.cancelable&&d.preventDefault())},this.onTouchStart=function(d){c&&window.focus(),!d.defaultPrevented&&a.enabled&&h&&h.enabled&&(h.onTouchStart(d),a.capture&&d.cancelable&&d.target===l&&d.preventDefault())},this.onTouchStartWindow=function(d){!d.defaultPrevented&&a.enabled&&h&&h.enabled&&d.target!==l&&h.onTouchStart(d)},this.onTouchEnd=function(d){!d.defaultPrevented&&a.enabled&&h&&h.enabled&&(h.onTouchEnd(d),a.capture&&d.cancelable&&d.target===l&&d.preventDefault())},this.onTouchEndWindow=function(d){!d.defaultPrevented&&a.enabled&&h&&h.enabled&&d.target!==l&&h.onTouchEnd(d)},this.onTouchCancel=function(d){!d.defaultPrevented&&a.enabled&&h&&h.enabled&&(h.onTouchCancel(d),a.capture&&d.preventDefault())},this.onTouchCancelWindow=function(d){!d.defaultPrevented&&a.enabled&&h&&h.enabled&&h.onTouchCancel(d)};var f=this.capture,u={passive:!0},p={passive:!1};if(o.addEventListener("touchstart",this.onTouchStart,f?p:u),o.addEventListener("touchmove",this.onTouchMove,f?p:u),o.addEventListener("touchend",this.onTouchEnd,f?p:u),o.addEventListener("touchcancel",this.onTouchCancel,f?p:u),window&&h.game.config.inputWindowEvents)try{window.top.addEventListener("touchstart",this.onTouchStartWindow,p),window.top.addEventListener("touchend",this.onTouchEndWindow,p),window.top.addEventListener("touchcancel",this.onTouchCancelWindow,p)}catch{window.addEventListener("touchstart",this.onTouchStartWindow,p),window.addEventListener("touchend",this.onTouchEndWindow,p),window.addEventListener("touchcancel",this.onTouchCancelWindow,p),this.isTop=!1}this.enabled=!0}},stopListeners:function(){var o=this.target;o.removeEventListener("touchstart",this.onTouchStart),o.removeEventListener("touchmove",this.onTouchMove),o.removeEventListener("touchend",this.onTouchEnd),o.removeEventListener("touchcancel",this.onTouchCancel),window&&(o=this.isTop?window.top:window,o.removeEventListener("touchstart",this.onTouchStartWindow),o.removeEventListener("touchend",this.onTouchEndWindow),o.removeEventListener("touchcancel",this.onTouchCancelWindow))},destroy:function(){this.stopListeners(),this.target=null,this.enabled=!1,this.manager=null}});t.exports=r}),Cl=S((e,t)=>{"use strict";var i=V(),s=Aa(),n=Wt(),r=Zt(),o=Ce(),a=Tl(),h=wl(),l=Rl(),c=ui(),f=qh(),u=new i({initialize:function(p,d){this.game=p,this.scaleManager,this.canvas,this.config=d,this.enabled=!0,this.events=new n,this.isOver=!0,this.defaultCursor="",this.keyboard=null,this.mouse=d.inputMouse?new a(this):null,this.touch=d.inputTouch?new l(this):null,this.pointers=[],this.pointersTotal=d.inputActivePointers;for(var g=0;g<=this.pointersTotal;g++){var m=new h(this,g);m.smoothFactor=d.inputSmoothFactor,this.pointers.push(m)}this.mousePointer=d.inputMouse?this.pointers[0]:null,this.activePointer=this.pointers[0],this.globalTopOnly=!0,this.time=0,this._tempPoint={x:0,y:0},this._tempHitTest=[],this._tempMatrix=new c,this._tempMatrix2=new c,this._tempSkip=!1,this.mousePointerContainer=[this.mousePointer],p.events.once(o.BOOT,this.boot,this)},boot:function(){var p=this.game,d=p.events;this.canvas=p.canvas,this.scaleManager=p.scale,this.events.emit(r.MANAGER_BOOT),d.on(o.PRE_RENDER,this.preRender,this),d.once(o.DESTROY,this.destroy,this)},setCanvasOver:function(p){this.isOver=!0,this.events.emit(r.GAME_OVER,p)},setCanvasOut:function(p){this.isOver=!1,this.events.emit(r.GAME_OUT,p)},preRender:function(){var p=this.game.loop.now,d=this.game.loop.delta,g=this.game.scene.getScenes(!0,!0);this.time=p,this.events.emit(r.MANAGER_UPDATE);for(var m=0;m<g.length;m++){var E=g[m];if(E.sys.input&&E.sys.input.updatePoll(p,d)&&this.globalTopOnly)return}},setDefaultCursor:function(p){this.defaultCursor=p,this.canvas.style.cursor!==p&&(this.canvas.style.cursor=p)},setCursor:function(p){p.cursor&&(this.canvas.style.cursor=p.cursor)},resetCursor:function(p,d){(d||p&&p.cursor)&&this.canvas&&(this.canvas.style.cursor=this.defaultCursor)},addPointer:function(p){p===void 0&&(p=1);var d=[];this.pointersTotal+p>10&&(p=10-this.pointersTotal);for(var g=0;g<p;g++){var m=this.pointers.length,E=new h(this,m);E.smoothFactor=this.config.inputSmoothFactor,this.pointers.push(E),this.pointersTotal++,d.push(E)}return d},updateInputPlugins:function(p,d){var g=this.game.scene.getScenes(!1,!0);this._tempSkip=!1;for(var m=0;m<g.length;m++){var E=g[m];if(E.sys.input){var v=E.sys.input.update(p,d);if(v&&this.globalTopOnly||this._tempSkip)return}}},onTouchStart:function(p){for(var d=this.pointers,g=[],m=0;m<p.changedTouches.length;m++)for(var E=p.changedTouches[m],v=1;v<d.length;v++){var y=d[v];if(!y.active){y.touchstart(E,p),this.activePointer=y,g.push(y);break}}this.updateInputPlugins(s.TOUCH_START,g)},onTouchMove:function(p){for(var d=this.pointers,g=[],m=0;m<p.changedTouches.length;m++)for(var E=p.changedTouches[m],v=1;v<d.length;v++){var y=d[v];if(y.active&&y.identifier===E.identifier){var T=document.elementFromPoint(E.clientX,E.clientY),A=T===this.canvas;!this.isOver&&A?this.setCanvasOver(p):this.isOver&&!A&&this.setCanvasOut(p),this.isOver&&(y.touchmove(E,p),this.activePointer=y,g.push(y));break}}this.updateInputPlugins(s.TOUCH_MOVE,g)},onTouchEnd:function(p){for(var d=this.pointers,g=[],m=0;m<p.changedTouches.length;m++)for(var E=p.changedTouches[m],v=1;v<d.length;v++){var y=d[v];if(y.active&&y.identifier===E.identifier){y.touchend(E,p),g.push(y);break}}this.updateInputPlugins(s.TOUCH_END,g)},onTouchCancel:function(p){for(var d=this.pointers,g=[],m=0;m<p.changedTouches.length;m++)for(var E=p.changedTouches[m],v=1;v<d.length;v++){var y=d[v];if(y.active&&y.identifier===E.identifier){y.touchcancel(E,p),g.push(y);break}}this.updateInputPlugins(s.TOUCH_CANCEL,g)},onMouseDown:function(p){var d=this.mousePointer;d.down(p),d.updateMotion(),this.activePointer=d,this.updateInputPlugins(s.MOUSE_DOWN,this.mousePointerContainer)},onMouseMove:function(p){var d=this.mousePointer;d.move(p),d.updateMotion(),this.activePointer=d,this.updateInputPlugins(s.MOUSE_MOVE,this.mousePointerContainer)},onMouseUp:function(p){var d=this.mousePointer;d.up(p),d.updateMotion(),this.activePointer=d,this.updateInputPlugins(s.MOUSE_UP,this.mousePointerContainer)},onMouseWheel:function(p){var d=this.mousePointer;d.wheel(p),this.activePointer=d,this.updateInputPlugins(s.MOUSE_WHEEL,this.mousePointerContainer)},onPointerLockChange:function(p){var d=this.mouse.locked;this.mousePointer.locked=d,this.events.emit(r.POINTERLOCK_CHANGE,p,d)},inputCandidate:function(p,d){var g=p.input;if(!g||!g.enabled||!p.willRender(d))return!1;var m=!0,E=p.parentContainer;if(E)do{if(!E.willRender(d)){m=!1;break}E=E.parentContainer}while(E);return m},hitTest:function(p,d,g,m){m===void 0&&(m=this._tempHitTest);var E=this._tempPoint,v=g.scrollX,y=g.scrollY;m.length=0;var T=p.x,A=p.y;g.getWorldPoint(T,A,E),p.worldX=E.x,p.worldY=E.y;for(var x={x:0,y:0},_=this._tempMatrix,b=this._tempMatrix2,M=0;M<d.length;M++){var w=d[M];if(this.inputCandidate(w,g)){var R=E.x+v*w.scrollFactorX-v,I=E.y+y*w.scrollFactorY-y;w.parentContainer?(w.getWorldTransformMatrix(_,b),_.applyInverse(R,I,x)):f(R,I,w.x,w.y,w.rotation,w.scaleX,w.scaleY,x),this.pointWithinHitArea(w,x.x,x.y)&&m.push(w)}}return m},pointWithinHitArea:function(p,d,g){d+=p.displayOriginX,g+=p.displayOriginY;var m=p.input;return m&&m.hitAreaCallback(m.hitArea,d,g,p)?(m.localX=d,m.localY=g,!0):!1},pointWithinInteractiveObject:function(p,d,g){return p.hitArea?(d+=p.gameObject.displayOriginX,g+=p.gameObject.displayOriginY,p.localX=d,p.localY=g,p.hitAreaCallback(p.hitArea,d,g,p)):!1},transformPointer:function(p,d,g,m){var E=p.position,v=p.prevPosition;v.x=E.x,v.y=E.y;var y=this.scaleManager.transformX(d),T=this.scaleManager.transformY(g),A=p.smoothFactor;!m||A===0?(E.x=y,E.y=T):(E.x=y*A+v.x*(1-A),E.y=T*A+v.y*(1-A))},destroy:function(){this.events.removeAllListeners(),this.game.events.off(o.PRE_RENDER),this.keyboard&&this.keyboard.destroy(),this.mouse&&this.mouse.destroy(),this.touch&&this.touch.destroy();for(var p=0;p<this.pointers.length;p++)this.pointers[p].destroy();this.pointers=[],this._tempHitTest=[],this._tempMatrix.destroy(),this.canvas=null,this.game=null}});t.exports=u}),_l=S((e,t)=>{"use strict";var i=Mt(),s={},n={};n.register=function(r,o,a,h,l){s[r]={plugin:o,mapping:a,settingsKey:h,configKey:l}},n.getPlugin=function(r){return s[r]},n.install=function(r){var o=r.scene.sys,a=o.settings.input,h=o.game.config;for(var l in s){var c=s[l].plugin,f=s[l].mapping,u=s[l].settingsKey,p=s[l].configKey;i(a,u,h[p])&&(r[f]=new c(r))}},n.remove=function(r){s.hasOwnProperty(r)&&delete s[r]},t.exports=n}),mE=S((e,t)=>{"use strict";var i=V(),s=Aa(),n=yl(),r=El(),o=Kn(),a=Zt(),h=Wt(),l=pt(),c=Es(),f=_l(),u=oe(),p=ae(),d=zt(),g=vs(),m=Nt(),E=new i({Extends:h,initialize:function(v){h.call(this),this.scene=v,this.systems=v.sys,this.settings=v.sys.settings,this.manager=v.sys.game.input,this.pluginEvents=new h,this.enabled=!0,this.displayList,this.cameras,f.install(this),this.mouse=this.manager.mouse,this.topOnly=!0,this.pollRate=-1,this._pollTimer=0;var y={cancelled:!1};this._eventContainer={stopPropagation:function(){y.cancelled=!0}},this._eventData=y,this.dragDistanceThreshold=0,this.dragTimeThreshold=0,this._temp=[],this._tempZones=[],this._list=[],this._pendingInsertion=[],this._pendingRemoval=[],this._draggable=[],this._drag={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[],10:[]},this._dragState=[],this._over={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[],10:[]},this._validTypes=["onDown","onUp","onOver","onOut","onMove","onDragStart","onDrag","onDragEnd","onDragEnter","onDragLeave","onDragOver","onDrop"],this._updatedThisFrame=!1,v.sys.events.once(m.BOOT,this.boot,this),v.sys.events.on(m.START,this.start,this)},boot:function(){this.cameras=this.systems.cameras,this.displayList=this.systems.displayList,this.systems.events.once(m.DESTROY,this.destroy,this),this.pluginEvents.emit(a.BOOT)},start:function(){var v=this.systems.events;v.on(m.TRANSITION_START,this.transitionIn,this),v.on(m.TRANSITION_OUT,this.transitionOut,this),v.on(m.TRANSITION_COMPLETE,this.transitionComplete,this),v.on(m.PRE_UPDATE,this.preUpdate,this),v.once(m.SHUTDOWN,this.shutdown,this),this.manager.events.on(a.GAME_OUT,this.onGameOut,this),this.manager.events.on(a.GAME_OVER,this.onGameOver,this),this.enabled=!0,this._dragState=[0,0,0,0,0,0,0,0,0,0],this.pluginEvents.emit(a.START)},onGameOver:function(v){this.isActive()&&this.emit(a.GAME_OVER,v.timeStamp,v)},onGameOut:function(v){this.isActive()&&this.emit(a.GAME_OUT,v.timeStamp,v)},preUpdate:function(){this.pluginEvents.emit(a.PRE_UPDATE);var v=this._pendingRemoval,y=this._pendingInsertion,T=v.length,A=y.length;if(!(T===0&&A===0)){for(var x=this._list,_=0;_<T;_++){var b=v[_],M=x.indexOf(b);M>-1&&(x.splice(M,1),this.clear(b,!0))}this._pendingRemoval.length=0,this._list=x.concat(y.splice(0))}},isActive:function(){return this.manager&&this.manager.enabled&&this.enabled&&this.scene.sys.canInput()},setCursor:function(v){this.manager&&this.manager.setCursor(v)},resetCursor:function(){this.manager&&this.manager.resetCursor(null,!0)},updatePoll:function(v,y){if(!this.isActive())return!1;if(this.pluginEvents.emit(a.UPDATE,v,y),this._updatedThisFrame)return this._updatedThisFrame=!1,!1;var T,A=this.manager,x=A.pointers;for(T=0;T<x.length;T++)x[T].updateMotion();if(this._list.length===0)return!1;var _=this.pollRate;if(_===-1)return!1;if(_>0)if(this._pollTimer-=y,this._pollTimer<0)this._pollTimer=this.pollRate;else return!1;var b=!1;for(T=0;T<x.length;T++){var M=0,w=x[T];this._tempZones=[],this._temp=this.hitTestPointer(w),this.sortGameObjects(this._temp,w),this.sortDropZones(this._tempZones),this.topOnly&&(this._temp.length&&this._temp.splice(1),this._tempZones.length&&this._tempZones.splice(1)),M+=this.processOverOutEvents(w),this.getDragState(w)===2&&this.processDragThresholdEvent(w,v),M>0&&(b=!0)}return b},update:function(v,y){if(!this.isActive())return!1;for(var T=!1,A=0;A<y.length;A++){var x=0,_=y[A];switch(this._tempZones=[],this._temp=this.hitTestPointer(_),this.sortGameObjects(this._temp,_),this.sortDropZones(this._tempZones),this.topOnly&&(this._temp.length&&this._temp.splice(1),this._tempZones.length&&this._tempZones.splice(1)),v){case s.MOUSE_DOWN:x+=this.processDragDownEvent(_),x+=this.processDownEvents(_),x+=this.processOverOutEvents(_);break;case s.MOUSE_UP:x+=this.processDragUpEvent(_),x+=this.processUpEvents(_),x+=this.processOverOutEvents(_);break;case s.TOUCH_START:x+=this.processDragDownEvent(_),x+=this.processDownEvents(_),x+=this.processOverEvents(_);break;case s.TOUCH_END:case s.TOUCH_CANCEL:x+=this.processDragUpEvent(_),x+=this.processUpEvents(_),x+=this.processOutEvents(_);break;case s.MOUSE_MOVE:case s.TOUCH_MOVE:x+=this.processDragMoveEvent(_),x+=this.processMoveEvents(_),x+=this.processOverOutEvents(_);break;case s.MOUSE_WHEEL:x+=this.processWheelEvent(_);break}x>0&&(T=!0)}return this._updatedThisFrame=!0,T},clear:function(v,y){y===void 0&&(y=!1),this.disable(v);var T=v.input;T&&(this.removeDebug(v),this.manager.resetCursor(T),T.gameObject=void 0,T.target=void 0,T.hitArea=void 0,T.hitAreaCallback=void 0,T.callbackContext=void 0,v.input=null),y||this.queueForRemoval(v);var A=this._draggable.indexOf(v);return A>-1&&this._draggable.splice(A,1),v},disable:function(v,y){y===void 0&&(y=!1);var T=v.input;T&&(T.enabled=!1,T.dragState=0);for(var A=this._drag,x=this._over,_=this.manager,b=0,M;b<_.pointers.length;b++)M=A[b].indexOf(v),M>-1&&A[b].splice(M,1),M=x[b].indexOf(v),M>-1&&x[b].splice(M,1);return y&&this.resetCursor(),this},enable:function(v,y,T,A){return A===void 0&&(A=!1),v.input?v.input.enabled=!0:this.setHitArea(v,y,T),v.input&&A&&!v.input.dropZone&&(v.input.dropZone=A),this},hitTestPointer:function(v){for(var y=this.cameras.getCamerasBelowPointer(v),T=0;T<y.length;T++){for(var A=y[T],x=this.manager.hitTest(v,this._list,A),_=0;_<x.length;_++){var b=x[_];b.input.dropZone&&this._tempZones.push(b)}if(x.length>0)return v.camera=A,x}return v.camera=y[0],[]},processDownEvents:function(v){var y=0,T=this._temp,A=this._eventData,x=this._eventContainer;A.cancelled=!1;for(var _=0;_<T.length;_++){var b=T[_];if(!(!b.input||!b.input.enabled)&&(y++,b.emit(a.GAMEOBJECT_POINTER_DOWN,v,b.input.localX,b.input.localY,x),A.cancelled||!this.isActive()||b.input&&b.input.enabled&&(this.emit(a.GAMEOBJECT_DOWN,v,b,x),A.cancelled||!this.isActive())))break}return!A.cancelled&&this.isActive()&&(v.downElement===this.manager.game.canvas?this.emit(a.POINTER_DOWN,v,T):this.emit(a.POINTER_DOWN_OUTSIDE,v)),y},getDragState:function(v){return this._dragState[v.id]},setDragState:function(v,y){this._dragState[v.id]=y},processDragThresholdEvent:function(v,y){var T=!1,A=this.dragTimeThreshold,x=this.dragDistanceThreshold;if((x>0&&o(v.x,v.y,v.downX,v.downY)>=x||A>0&&y>=v.downTime+A)&&(T=!0),T)return this.setDragState(v,3),this.processDragStartList(v)},processDragStartList:function(v){if(this.getDragState(v)!==3)return 0;var y=this._drag[v.id];y.length>1&&(y=y.slice(0));for(var T=0;T<y.length;T++){var A=y[T],x=A.input;x.dragState=2,x.dragStartX=A.x,x.dragStartY=A.y,x.dragStartXGlobal=v.worldX,x.dragStartYGlobal=v.worldY,x.dragStartCamera=v.camera,x.dragX=x.dragStartXGlobal-x.dragStartX,x.dragY=x.dragStartYGlobal-x.dragStartY,A.emit(a.GAMEOBJECT_DRAG_START,v,x.dragX,x.dragY),this.emit(a.DRAG_START,v,A)}return this.setDragState(v,4),y.length},processDragDownEvent:function(v){var y=this._temp;if(this._draggable.length===0||y.length===0||!v.primaryDown||this.getDragState(v)!==0)return 0;this.setDragState(v,1);for(var T=[],A=0;A<y.length;A++){var x=y[A];x.input.draggable&&x.input.dragState===0&&T.push(x)}return T.length===0?(this.setDragState(v,0),0):(T.length>1&&(this.sortGameObjects(T,v),this.topOnly&&T.splice(1)),this._drag[v.id]=T,this.dragDistanceThreshold===0&&this.dragTimeThreshold===0?(this.setDragState(v,3),this.processDragStartList(v)):(this.setDragState(v,2),0))},processDragMoveEvent:function(v){if(this.getDragState(v)===2&&this.processDragThresholdEvent(v,this.manager.game.loop.now),this.getDragState(v)!==4)return 0;var y=this._tempZones,T=this._drag[v.id];T.length>1&&(T=T.slice(0));for(var A=0;A<T.length;A++){var x=T[A],_=x.input,b=_.target;if(b){var M=y.indexOf(b);M===0?(x.emit(a.GAMEOBJECT_DRAG_OVER,v,b),this.emit(a.DRAG_OVER,v,x,b)):M>0?(x.emit(a.GAMEOBJECT_DRAG_LEAVE,v,b),this.emit(a.DRAG_LEAVE,v,x,b),_.target=y[0],b=_.target,x.emit(a.GAMEOBJECT_DRAG_ENTER,v,b),this.emit(a.DRAG_ENTER,v,x,b)):(x.emit(a.GAMEOBJECT_DRAG_LEAVE,v,b),this.emit(a.DRAG_LEAVE,v,x,b),y[0]?(_.target=y[0],b=_.target,x.emit(a.GAMEOBJECT_DRAG_ENTER,v,b),this.emit(a.DRAG_ENTER,v,x,b)):_.target=null)}else!b&&y[0]&&(_.target=y[0],b=_.target,x.emit(a.GAMEOBJECT_DRAG_ENTER,v,b),this.emit(a.DRAG_ENTER,v,x,b));var w,R,I=v.positionToCamera(_.dragStartCamera);if(!x.parentContainer)w=I.x-_.dragX,R=I.y-_.dragY;else{var O=I.x-_.dragStartXGlobal,D=I.y-_.dragStartYGlobal,N=x.getParentRotation(),F=O*Math.cos(N)+D*Math.sin(N),G=D*Math.cos(N)-O*Math.sin(N);F*=1/x.parentContainer.scaleX,G*=1/x.parentContainer.scaleY,w=F+_.dragStartX,R=G+_.dragStartY}x.emit(a.GAMEOBJECT_DRAG,v,w,R),this.emit(a.DRAG,v,x,w,R)}return T.length},processDragUpEvent:function(v){var y=this._drag[v.id];y.length>1&&(y=y.slice(0));for(var T=0;T<y.length;T++){var A=y[T],x=A.input;if(x&&x.dragState===2){x.dragState=0,x.dragX=x.localX-A.displayOriginX,x.dragY=x.localY-A.displayOriginY,x.dragStartCamera=null;var _=!1,b=x.target;b&&(A.emit(a.GAMEOBJECT_DROP,v,b),this.emit(a.DROP,v,A,b),x.target=null,_=!0),A.input&&A.input.enabled&&(A.emit(a.GAMEOBJECT_DRAG_END,v,x.dragX,x.dragY,_),this.emit(a.DRAG_END,v,A,_))}}return this.setDragState(v,0),y.splice(0),0},processMoveEvents:function(v){var y=0,T=this._temp,A=this._eventData,x=this._eventContainer;A.cancelled=!1;for(var _=0;_<T.length;_++){var b=T[_];if(!(!b.input||!b.input.enabled)&&(y++,b.emit(a.GAMEOBJECT_POINTER_MOVE,v,b.input.localX,b.input.localY,x),A.cancelled||!this.isActive()||b.input&&b.input.enabled&&(this.emit(a.GAMEOBJECT_MOVE,v,b,x),A.cancelled||!this.isActive()||this.topOnly)))break}return!A.cancelled&&this.isActive()&&this.emit(a.POINTER_MOVE,v,T),y},processWheelEvent:function(v){var y=0,T=this._temp,A=this._eventData,x=this._eventContainer;A.cancelled=!1;for(var _=v.deltaX,b=v.deltaY,M=v.deltaZ,w=0;w<T.length;w++){var R=T[w];if(!(!R.input||!R.input.enabled)&&(y++,R.emit(a.GAMEOBJECT_POINTER_WHEEL,v,_,b,M,x),A.cancelled||!this.isActive()||R.input&&R.input.enabled&&(this.emit(a.GAMEOBJECT_WHEEL,v,R,_,b,M,x),A.cancelled||!this.isActive())))break}return!A.cancelled&&this.isActive()&&this.emit(a.POINTER_WHEEL,v,T,_,b,M),y},processOverEvents:function(v){var y=this._temp,T=0,A=y.length,x=[];if(A>0){var _=this.manager,b=this._eventData,M=this._eventContainer;b.cancelled=!1;for(var w=0;w<A;w++){var R=y[w];if(!(!R.input||!R.input.enabled)&&(x.push(R),_.setCursor(R.input),R.emit(a.GAMEOBJECT_POINTER_OVER,v,R.input.localX,R.input.localY,M),T++,b.cancelled||!this.isActive()||R.input&&R.input.enabled&&(this.emit(a.GAMEOBJECT_OVER,v,R,M),b.cancelled||!this.isActive())))break}!b.cancelled&&this.isActive()&&this.emit(a.POINTER_OVER,v,x)}return this._over[v.id]=x,T},processOutEvents:function(v){var y=this._over[v.id],T=0,A=y.length;if(A>0){var x=this.manager,_=this._eventData,b=this._eventContainer;_.cancelled=!1,this.sortGameObjects(y,v);for(var M=0;M<A;M++){var w=y[M];if(w=y[M],!(!w.input||!w.input.enabled)&&(x.resetCursor(w.input),w.emit(a.GAMEOBJECT_POINTER_OUT,v,b),T++,_.cancelled||!this.isActive()||w.input&&w.input.enabled&&(this.emit(a.GAMEOBJECT_OUT,v,w,b),_.cancelled||!this.isActive())))break}!_.cancelled&&this.isActive()&&this.emit(a.POINTER_OUT,v,y),this._over[v.id]=[]}return T},processOverOutEvents:function(v){var y=this._temp,T,A,x=[],_=[],b=[],M=this._over[v.id],w=this._drag[v.id],R=this.manager;for(T=0;T<M.length;T++)A=M[T],y.indexOf(A)===-1&&w.indexOf(A)===-1?x.push(A):b.push(A);for(T=0;T<y.length;T++)A=y[T],M.indexOf(A)===-1&&_.push(A);var I=x.length,O=0,D=this._eventData,N=this._eventContainer;if(D.cancelled=!1,I>0){for(this.sortGameObjects(x,v),T=0;T<I&&(A=x[T],!(!(!A.input||!A.input.enabled)&&(R.resetCursor(A.input),A.emit(a.GAMEOBJECT_POINTER_OUT,v,N),O++,D.cancelled||!this.isActive()||A.input&&A.input.enabled&&(this.emit(a.GAMEOBJECT_OUT,v,A,N),D.cancelled||!this.isActive()))));T++);(!D.cancelled||this.isActive())&&this.emit(a.POINTER_OUT,v,x)}if(I=_.length,D.cancelled=!1,I>0){for(this.sortGameObjects(_,v),T=0;T<I&&(A=_[T],!(!(!A.input||!A.input.enabled)&&(R.setCursor(A.input),A.emit(a.GAMEOBJECT_POINTER_OVER,v,A.input.localX,A.input.localY,N),O++,D.cancelled||!this.isActive()||A.input&&A.input.enabled&&(this.emit(a.GAMEOBJECT_OVER,v,A,N),D.cancelled||!this.isActive()))));T++);!D.cancelled&&this.isActive()&&this.emit(a.POINTER_OVER,v,_)}return M=b.concat(_),this._over[v.id]=this.sortGameObjects(M,v),O},processUpEvents:function(v){var y=this._temp,T=this._eventData,A=this._eventContainer;T.cancelled=!1;for(var x=0;x<y.length;x++){var _=y[x];if(!(!_.input||!_.input.enabled)&&(_.emit(a.GAMEOBJECT_POINTER_UP,v,_.input.localX,_.input.localY,A),T.cancelled||!this.isActive()||_.input&&_.input.enabled&&(this.emit(a.GAMEOBJECT_UP,v,_,A),T.cancelled||!this.isActive())))break}return!T.cancelled&&this.isActive()&&(v.upElement===this.manager.game.canvas?this.emit(a.POINTER_UP,v,y):this.emit(a.POINTER_UP_OUTSIDE,v)),y.length},forceDownState:function(v,y){this.forceState(v,y,a.GAMEOBJECT_POINTER_DOWN,a.GAMEOBJECT_DOWN,!1)},forceUpState:function(v,y){this.forceState(v,y,a.GAMEOBJECT_POINTER_UP,a.GAMEOBJECT_UP,!1)},forceOverState:function(v,y){this.forceState(v,y,a.GAMEOBJECT_POINTER_OVER,a.GAMEOBJECT_OVER,!0)},forceOutState:function(v,y){this.forceState(v,y,a.GAMEOBJECT_POINTER_OUT,a.GAMEOBJECT_OUT,!1)},forceState:function(v,y,T,A,x){var _=this._eventData,b=this._eventContainer;_.cancelled=!1,y.input&&y.input.enabled&&(y.emit(T,v,y.input.localX,y.input.localY,b),x&&this.setCursor(y.input),!_.cancelled&&this.isActive()&&y.input&&y.input.enabled&&this.emit(A,v,y,b))},queueForInsertion:function(v){return this._pendingInsertion.indexOf(v)===-1&&this._list.indexOf(v)===-1&&this._pendingInsertion.push(v),this},queueForRemoval:function(v){return this._pendingRemoval.push(v),this},setDraggable:function(v,y){y===void 0&&(y=!0),Array.isArray(v)||(v=[v]);for(var T=0;T<v.length;T++){var A=v[T];A.input.draggable=y;var x=this._draggable.indexOf(A);y&&x===-1?this._draggable.push(A):!y&&x>-1&&this._draggable.splice(x,1)}return this},makePixelPerfect:function(v){v===void 0&&(v=1);var y=this.systems.textures;return r(y,v)},setHitArea:function(v,y,T){if(y===void 0)return this.setHitAreaFromTexture(v);Array.isArray(v)||(v=[v]);var A=!1,x=!1,_=!1,b=!1,M=!1,w=!0;if(u(y)&&Object.keys(y).length){var R=y,I=v.some(function(G){return G.hasOwnProperty("faces")});if(!I){y=l(R,"hitArea",null),T=l(R,"hitAreaCallback",null),M=l(R,"pixelPerfect",!1);var O=l(R,"alphaTolerance",1);M&&(y={},T=this.makePixelPerfect(O))}A=l(R,"draggable",!1),x=l(R,"dropZone",!1),_=l(R,"cursor",!1),b=l(R,"useHandCursor",!1),(!y||!T)&&(this.setHitAreaFromTexture(v),w=!1)}else typeof y=="function"&&!T&&(T=y,y={});for(var D=0;D<v.length;D++){var N=v[D];if(!(M&&N.type==="Container")){var F=N.input?N.input:n(N,y,T);F.customHitArea=w,F.dropZone=x,F.cursor=b?"pointer":_,N.input=F,A&&this.setDraggable(N),this.queueForInsertion(N)}}return this},setHitAreaFromTexture:function(v,y){y===void 0&&(y=g),Array.isArray(v)||(v=[v]);for(var T=0;T<v.length;T++){var A=v[T],x=A.frame,_=0,b=0;A.width?(_=A.width,b=A.height):x&&(_=x.realWidth,b=x.realHeight),!(A.type==="Container"&&(_===0||b===0))&&_!==0&&b!==0&&(A.input=n(A,new d(0,0,_,b),y),this.queueForInsertion(A))}return this},setHitAreaRectangle:function(v,y,T,A,x,_){_===void 0&&(_=g);var b=new d(y,T,A,x);return this.setHitArea(v,b,_)},enableDebug:function(v,y){y===void 0&&(y=65280);var T=v.input;if(!T||!T.hitArea)return this;var A=T.hitArea,x=A.type,_=T.hitAreaDebug,b=this.systems.add,M=this.systems.updateList;_&&(M.remove(_),_.destroy(),_=null);var w=0,R=0;switch(x){case c.CIRCLE:_=b.arc(0,0,A.radius),w=A.x-A.radius,R=A.y-A.radius;break;case c.ELLIPSE:_=b.ellipse(0,0,A.width,A.height),w=A.x-A.width/2,R=A.y-A.height/2;break;case c.LINE:_=b.line(0,0,A.x1,A.y1,A.x2,A.y2);break;case c.POLYGON:_=b.polygon(0,0,A.points);break;case c.RECTANGLE:_=b.rectangle(0,0,A.width,A.height),w=A.x,R=A.y;break;case c.TRIANGLE:_=b.triangle(0,0,A.x1,A.y1,A.x2,A.y2,A.x3,A.y3);break}return _&&(_.isFilled=!1,_.strokeColor=y,_.preUpdate=function(){_.setVisible(v.visible),_.setStrokeStyle(1/v.scale,_.strokeColor),_.setDisplayOrigin(v.displayOriginX,v.displayOriginY);var I=v.x,O=v.y,D=v.rotation,N=v.scaleX,F=v.scaleY;if(v.parentContainer){var G=v.getWorldTransformMatrix();I=G.tx,O=G.ty,D=G.rotation,N=G.scaleX,F=G.scaleY}_.setRotation(D),_.setScale(N,F),_.setPosition(I+w*N,O+R*F),_.setScrollFactor(v.scrollFactorX,v.scrollFactorY),_.setDepth(v.depth)},M.add(_),T.hitAreaDebug=_),this},removeDebug:function(v){var y=v.input;if(y&&y.hitAreaDebug){var T=y.hitAreaDebug;T.destroy(),y.hitAreaDebug=null}return this},setPollAlways:function(){return this.setPollRate(0)},setPollOnMove:function(){return this.setPollRate(-1)},setPollRate:function(v){return this.pollRate=v,this._pollTimer=0,this},setGlobalTopOnly:function(v){return this.manager.globalTopOnly=v,this},setTopOnly:function(v){return this.topOnly=v,this},sortGameObjects:function(v,y){if(v.length<2||!y.camera)return v;var T=y.camera.renderList;return v.sort(function(A,x){var _=Math.max(T.indexOf(A),0),b=Math.max(T.indexOf(x),0);return b-_})},sortDropZones:function(v){return v.length<2?v:(this.scene.sys.depthSort(),v.sort(this.sortDropZoneHandler.bind(this)))},sortDropZoneHandler:function(v,y){if(!v.parentContainer&&!y.parentContainer)return this.displayList.getIndex(y)-this.displayList.getIndex(v);if(v.parentContainer===y.parentContainer)return y.parentContainer.getIndex(y)-v.parentContainer.getIndex(v);if(v.parentContainer===y)return-1;if(y.parentContainer===v)return 1;for(var T=v.getIndexList(),A=y.getIndexList(),x=Math.min(T.length,A.length),_=0;_<x;_++){var b=T[_],M=A[_];if(b!==M)return M-b}return A.length-T.length},stopPropagation:function(){return this.manager._tempSkip=!0,this},addPointer:function(v){return this.manager.addPointer(v)},setDefaultCursor:function(v){return this.manager.setDefaultCursor(v),this},transitionIn:function(){this.enabled=this.settings.transitionAllowInput},transitionComplete:function(){this.settings.transitionAllowInput||(this.enabled=!0)},transitionOut:function(){this.enabled=this.settings.transitionAllowInput},shutdown:function(){this.pluginEvents.emit(a.SHUTDOWN),this._temp.length=0,this._list.length=0,this._draggable.length=0,this._pendingRemoval.length=0,this._pendingInsertion.length=0,this._dragState.length=0;for(var v=0;v<10;v++)this._drag[v]=[],this._over[v]=[];this.removeAllListeners();var y=this.manager;y.canvas.style.cursor=y.defaultCursor;var T=this.systems.events;T.off(m.TRANSITION_START,this.transitionIn,this),T.off(m.TRANSITION_OUT,this.transitionOut,this),T.off(m.TRANSITION_COMPLETE,this.transitionComplete,this),T.off(m.PRE_UPDATE,this.preUpdate,this),y.events.off(a.GAME_OUT,this.onGameOut,this),y.events.off(a.GAME_OVER,this.onGameOver,this),T.off(m.SHUTDOWN,this.shutdown,this)},resetPointers:function(){for(var v=this.manager.pointers,y=0;y<v.length;y++)v[y].reset()},destroy:function(){this.shutdown(),this.pluginEvents.emit(a.DESTROY),this.pluginEvents.removeAllListeners(),this.scene.sys.events.off(m.START,this.start,this),this.scene=null,this.cameras=null,this.manager=null,this.events=null,this.mouse=null},x:{get:function(){return this.manager.activePointer.x}},y:{get:function(){return this.manager.activePointer.y}},isOver:{get:function(){return this.manager.isOver}},mousePointer:{get:function(){return this.manager.mousePointer}},activePointer:{get:function(){return this.manager.activePointer}},pointer1:{get:function(){return this.manager.pointers[1]}},pointer2:{get:function(){return this.manager.pointers[2]}},pointer3:{get:function(){return this.manager.pointers[3]}},pointer4:{get:function(){return this.manager.pointers[4]}},pointer5:{get:function(){return this.manager.pointers[5]}},pointer6:{get:function(){return this.manager.pointers[6]}},pointer7:{get:function(){return this.manager.pointers[7]}},pointer8:{get:function(){return this.manager.pointers[8]}},pointer9:{get:function(){return this.manager.pointers[9]}},pointer10:{get:function(){return this.manager.pointers[10]}}});p.register("InputPlugin",E,"input"),t.exports=E}),vE=S((e,t)=>{"use strict";t.exports={MouseManager:Tl()}}),EE=S((e,t)=>{"use strict";t.exports={TouchManager:Rl()}}),yE=S((e,t)=>{"use strict";var i=Aa(),s=Re(),n={CreatePixelPerfectHandler:El(),CreateInteractiveObject:yl(),Events:Zt(),InputManager:Cl(),InputPlugin:mE(),InputPluginCache:_l(),Mouse:vE(),Pointer:wl(),Touch:EE()};n=s(!1,n,i),t.exports=n}),bl=S((e,t)=>{"use strict";var i=V(),s=pt(),n=new i({initialize:function(r){this.delay=0,this.repeat=0,this.repeatCount=0,this.loop=!1,this.callback,this.callbackScope,this.args,this.timeScale=1,this.startAt=0,this.elapsed=0,this.paused=!1,this.hasDispatched=!1,this.reset(r)},reset:function(r){if(this.delay=s(r,"delay",0),this.repeat=s(r,"repeat",0),this.loop=s(r,"loop",!1),this.callback=s(r,"callback",void 0),this.callbackScope=s(r,"callbackScope",this),this.args=s(r,"args",[]),this.timeScale=s(r,"timeScale",1),this.startAt=s(r,"startAt",0),this.paused=s(r,"paused",!1),this.elapsed=this.startAt,this.hasDispatched=!1,this.repeatCount=this.repeat===-1||this.loop?999999999999:this.repeat,this.delay<=0&&this.repeatCount>0)throw new Error("TimerEvent infinite loop created via zero delay");return this},getProgress:function(){return this.elapsed/this.delay},getOverallProgress:function(){if(this.repeat>0){var r=this.delay+this.delay*this.repeat,o=this.elapsed+this.delay*(this.repeat-this.repeatCount);return o/r}else return this.getProgress()},getRepeatCount:function(){return this.repeatCount},getElapsed:function(){return this.elapsed},getElapsedSeconds:function(){return this.elapsed*.001},getRemaining:function(){return this.delay-this.elapsed},getRemainingSeconds:function(){return this.getRemaining()*.001},getOverallRemaining:function(){return this.delay*(1+this.repeatCount)-this.elapsed},getOverallRemainingSeconds:function(){return this.getOverallRemaining()*.001},remove:function(r){r===void 0&&(r=!1),this.elapsed=this.delay,this.hasDispatched=!r,this.repeatCount=0},destroy:function(){this.callback=void 0,this.callbackScope=void 0,this.args=[]}});t.exports=n}),TE=S((e,t)=>{"use strict";var i=V(),s=ae(),n=Nt(),r=bl(),o=Pi(),a=new i({initialize:function(h){this.scene=h,this.systems=h.sys,this.now=0,this.startTime=0,this.timeScale=1,this.paused=!1,this._active=[],this._pendingInsertion=[],this._pendingRemoval=[],h.sys.events.once(n.BOOT,this.boot,this),h.sys.events.on(n.START,this.start,this)},boot:function(){this.now=this.systems.game.loop.time,this.systems.events.once(n.DESTROY,this.destroy,this)},start:function(){this.startTime=this.systems.game.loop.time;var h=this.systems.events;h.on(n.PRE_UPDATE,this.preUpdate,this),h.on(n.UPDATE,this.update,this),h.once(n.SHUTDOWN,this.shutdown,this)},addEvent:function(h){var l;if(h instanceof r){if(l=h,this.removeEvent(l),l.elapsed=l.startAt,l.hasDispatched=!1,l.repeatCount=l.repeat===-1||l.loop?999999999999:l.repeat,l.delay<=0&&l.repeatCount>0)throw new Error("TimerEvent infinite loop created via zero delay")}else l=new r(h);return this._pendingInsertion.push(l),l},delayedCall:function(h,l,c,f){return this.addEvent({delay:h,callback:l,args:c,callbackScope:f})},clearPendingEvents:function(){return this._pendingInsertion=[],this},removeEvent:function(h){Array.isArray(h)||(h=[h]);for(var l=0;l<h.length;l++){var c=h[l];o(this._pendingRemoval,c),o(this._pendingInsertion,c),o(this._active,c)}return this},removeAllEvents:function(){return this._pendingRemoval=this._pendingRemoval.concat(this._active),this},preUpdate:function(){var h=this._pendingRemoval.length,l=this._pendingInsertion.length;if(!(h===0&&l===0)){var c,f;for(c=0;c<h;c++){f=this._pendingRemoval[c];var u=this._active.indexOf(f);u>-1&&this._active.splice(u,1),f.destroy()}for(c=0;c<l;c++)f=this._pendingInsertion[c],this._active.push(f);this._pendingRemoval.length=0,this._pendingInsertion.length=0}},update:function(h,l){if(this.now=h,!this.paused){l*=this.timeScale;for(var c=0;c<this._active.length;c++){var f=this._active[c];if(!f.paused&&(f.elapsed+=l*f.timeScale,f.elapsed>=f.delay)){var u=f.elapsed-f.delay;if(f.elapsed=f.delay,!f.hasDispatched&&f.callback&&(f.hasDispatched=!0,f.callback.apply(f.callbackScope,f.args)),f.repeatCount>0){if(f.repeatCount--,u>=f.delay)for(;u>=f.delay&&f.repeatCount>0;)f.callback&&f.callback.apply(f.callbackScope,f.args),u-=f.delay,f.repeatCount--;f.elapsed=u,f.hasDispatched=!1}else f.hasDispatched&&this._pendingRemoval.push(f)}}}},shutdown:function(){var h;for(h=0;h<this._pendingInsertion.length;h++)this._pendingInsertion[h].destroy();for(h=0;h<this._active.length;h++)this._active[h].destroy();for(h=0;h<this._pendingRemoval.length;h++)this._pendingRemoval[h].destroy();this._active.length=0,this._pendingRemoval.length=0,this._pendingInsertion.length=0;var l=this.systems.events;l.off(n.PRE_UPDATE,this.preUpdate,this),l.off(n.UPDATE,this.update,this),l.off(n.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.scene.sys.events.off(n.START,this.start,this),this.scene=null,this.systems=null}});s.register("Clock",a,"time"),t.exports=a}),SE=S((e,t)=>{"use strict";t.exports="complete"}),Pl=S((e,t)=>{"use strict";t.exports={COMPLETE:SE()}}),AE=S((e,t)=>{"use strict";var i=V(),s=Wt(),n=jt(),r=pt(),o=Nt(),a=Pl(),h=new i({Extends:s,initialize:function(l,c){s.call(this),this.scene=l,this.systems=l.sys,this.elapsed=0,this.timeScale=1,this.paused=!0,this.complete=!1,this.totalComplete=0,this.loop=0,this.iteration=0,this.events=[];var f=this.systems.events;f.on(o.PRE_UPDATE,this.preUpdate,this),f.on(o.UPDATE,this.update,this),f.once(o.SHUTDOWN,this.destroy,this),c&&this.add(c)},preUpdate:function(l,c){this.paused||(this.elapsed+=c*this.timeScale)},update:function(){if(!(this.paused||this.complete)){var l,c=this.events,f=!1,u=this.systems,p;for(l=0;l<c.length;l++){var d=c[l];if(!d.complete&&d.time<=this.elapsed){if(d.complete=!0,this.totalComplete++,p=d.target?d.target:this,d.if&&!d.if.call(p,d))continue;if(d.once&&(f=!0),d.set&&d.target)for(var g in d.set)d.target[g]=d.set[g];this.iteration&&d.repeat++,d.loop&&d.repeat&&d.loop.call(p),d.tween&&(d.tweenInstance=u.tweens.add(d.tween)),d.sound&&(typeof d.sound=="string"?u.sound.play(d.sound):u.sound.play(d.sound.key,d.sound.config)),d.event&&this.emit(d.event,p),d.run&&d.run.call(p),d.stop&&this.stop()}}if(f)for(l=0;l<c.length;l++)c[l].complete&&c[l].once&&(c.splice(l,1),l--);this.totalComplete>=c.length&&(this.loop!==0&&(this.loop===-1||this.loop>this.iteration)?(this.iteration++,this.reset(!0)):this.complete=!0),this.complete&&this.emit(a.COMPLETE,this)}},play:function(l){return l===void 0&&(l=!0),this.paused=!1,this.complete=!1,this.totalComplete=0,l&&this.reset(),this},pause:function(){this.paused=!0;for(var l=this.events,c=0;c<l.length;c++){var f=l[c];f.tweenInstance&&(f.tweenInstance.paused=!0)}return this},repeat:function(l){return(l===void 0||l===!0)&&(l=-1),l===!1&&(l=0),this.loop=l,this},resume:function(){this.paused=!1;for(var l=this.events,c=0;c<l.length;c++){var f=l[c];f.tweenInstance&&(f.tweenInstance.paused=!1)}return this},stop:function(){return this.paused=!0,this.complete=!0,this},reset:function(l){l===void 0&&(l=!1),this.elapsed=0,l||(this.iteration=0);for(var c=this.events,f=0;f<c.length;f++){var u=c[f];u.complete=!1,l||(u.repeat=0),u.tweenInstance&&u.tweenInstance.stop()}return this.play(!1)},add:function(l){Array.isArray(l)||(l=[l]);var c=this.events,f=0;c.length>0&&(f=c[c.length-1].time);for(var u=0;u<l.length;u++){var p=l[u],d=r(p,"at",0),g=r(p,"in",null);g!==null&&(d=this.elapsed+g);var m=r(p,"from",null);m!==null&&(d=f+m),c.push({complete:!1,time:d,repeat:0,if:r(p,"if",null),run:r(p,"run",null),loop:r(p,"loop",null),event:r(p,"event",null),target:r(p,"target",null),set:r(p,"set",null),tween:r(p,"tween",null),sound:r(p,"sound",null),once:r(p,"once",!1),stop:r(p,"stop",!1)}),f=d}return this.complete=!1,this},clear:function(){for(var l=this.events,c=0;c<l.length;c++){var f=l[c];f.tweenInstance&&f.tweenInstance.stop()}return l=[],this.elapsed=0,this.paused=!0,this},isPlaying:function(){return!this.paused&&!this.complete},getProgress:function(){var l=Math.min(this.totalComplete,this.events.length);return l/this.events.length},destroy:function(){var l=this.systems.events;l.off(o.PRE_UPDATE,this.preUpdate,this),l.off(o.UPDATE,this.update,this),l.off(o.SHUTDOWN,this.destroy,this),this.clear(),this.scene=null,this.systems=null}});n.register("timeline",function(l){return new h(this.scene,l)}),t.exports=h}),xE=S((e,t)=>{"use strict";t.exports={Clock:TE(),Events:Pl(),Timeline:AE(),TimerEvent:bl()}}),wE=S((e,t)=>{"use strict";t.exports="changedata"}),RE=S((e,t)=>{"use strict";t.exports="changedata-"}),CE=S((e,t)=>{"use strict";t.exports="destroy"}),_E=S((e,t)=>{"use strict";t.exports="removedata"}),bE=S((e,t)=>{"use strict";t.exports="setdata"}),Ll=S((e,t)=>{"use strict";t.exports={CHANGE_DATA:wE(),CHANGE_DATA_KEY:RE(),DESTROY:CE(),REMOVE_DATA:_E(),SET_DATA:bE()}}),jn=S((e,t)=>{"use strict";var i=V(),s=Ll(),n=new i({initialize:function(r,o){this.parent=r,this.events=o,o||(this.events=r.events?r.events:r),this.list={},this.values={},this._frozen=!1,!r.hasOwnProperty("sys")&&this.events&&this.events.once(s.DESTROY,this.destroy,this)},get:function(r){var o=this.list;if(Array.isArray(r)){for(var a=[],h=0;h<r.length;h++)a.push(o[r[h]]);return a}else return o[r]},getAll:function(){var r={};for(var o in this.list)this.list.hasOwnProperty(o)&&(r[o]=this.list[o]);return r},query:function(r){var o={};for(var a in this.list)this.list.hasOwnProperty(a)&&a.match(r)&&(o[a]=this.list[a]);return o},set:function(r,o){if(this._frozen)return this;if(typeof r=="string")return this.setValue(r,o);for(var a in r)this.setValue(a,r[a]);return this},inc:function(r,o){if(this._frozen)return this;o===void 0&&(o=1);var a=this.get(r);return a===void 0&&(a=0),this.set(r,a+o),this},toggle:function(r){return this._frozen?this:(this.set(r,!this.get(r)),this)},setValue:function(r,o){if(this._frozen)return this;if(this.has(r))this.values[r]=o;else{var a=this,h=this.list,l=this.events,c=this.parent;Object.defineProperty(this.values,r,{enumerable:!0,configurable:!0,get:function(){return h[r]},set:function(f){if(!a._frozen){var u=h[r];h[r]=f,l.emit(s.CHANGE_DATA,c,r,f,u),l.emit(s.CHANGE_DATA_KEY+r,c,f,u)}}}),h[r]=o,l.emit(s.SET_DATA,c,r,o)}return this},each:function(r,o){for(var a=[this.parent,null,void 0],h=1;h<arguments.length;h++)a.push(arguments[h]);for(var l in this.list)a[1]=l,a[2]=this.list[l],r.apply(o,a);return this},merge:function(r,o){o===void 0&&(o=!0);for(var a in r)r.hasOwnProperty(a)&&(o||!o&&!this.has(a))&&this.setValue(a,r[a]);return this},remove:function(r){if(this._frozen)return this;if(Array.isArray(r))for(var o=0;o<r.length;o++)this.removeValue(r[o]);else return this.removeValue(r);return this},removeValue:function(r){if(this.has(r)){var o=this.list[r];delete this.list[r],delete this.values[r],this.events.emit(s.REMOVE_DATA,this.parent,r,o)}return this},pop:function(r){var o=void 0;return!this._frozen&&this.has(r)&&(o=this.list[r],delete this.list[r],delete this.values[r],this.events.emit(s.REMOVE_DATA,this.parent,r,o)),o},has:function(r){return this.list.hasOwnProperty(r)},setFreeze:function(r){return this._frozen=r,this},reset:function(){for(var r in this.list)delete this.list[r],delete this.values[r];return this._frozen=!1,this},destroy:function(){this.reset(),this.events.off(s.CHANGE_DATA),this.events.off(s.SET_DATA),this.events.off(s.REMOVE_DATA),this.parent=null},freeze:{get:function(){return this._frozen},set:function(r){this._frozen=!!r}},count:{get:function(){var r=0;for(var o in this.list)this.list[o]!==void 0&&r++;return r}}});t.exports=n}),PE=S((e,t)=>{"use strict";var i=V(),s=jn(),n=ae(),r=Nt(),o=new i({Extends:s,initialize:function(a){s.call(this,a,a.sys.events),this.scene=a,this.systems=a.sys,a.sys.events.once(r.BOOT,this.boot,this),a.sys.events.on(r.START,this.start,this)},boot:function(){this.events=this.systems.events,this.events.once(r.DESTROY,this.destroy,this)},start:function(){this.events.once(r.SHUTDOWN,this.shutdown,this)},shutdown:function(){this.systems.events.off(r.SHUTDOWN,this.shutdown,this)},destroy:function(){s.prototype.destroy.call(this),this.events.off(r.START,this.start,this),this.scene=null,this.systems=null}});n.register("DataManagerPlugin",o,"data"),t.exports=o}),LE=S((e,t)=>{"use strict";t.exports={DataManager:jn(),DataManagerPlugin:PE(),Events:Ll()}}),Zn=S((e,t)=>{"use strict";var i={PENDING:0,INIT:1,START:2,LOADING:3,CREATING:4,RUNNING:5,PAUSED:6,SLEEPING:7,SHUTDOWN:8,DESTROYED:9};t.exports=i}),Il=S((e,t)=>{"use strict";var i=pt(),s=function(n){var r=n.plugins.getDefaultScenePlugins(),o=i(n.settings,"plugins",!1);return Array.isArray(o)?o:r||[]};t.exports=s}),IE=S((e,t)=>{"use strict";t.exports="addfile"}),ME=S((e,t)=>{"use strict";t.exports="complete"}),OE=S((e,t)=>{"use strict";t.exports="filecomplete"}),DE=S((e,t)=>{"use strict";t.exports="filecomplete-"}),kE=S((e,t)=>{"use strict";t.exports="loaderror"}),BE=S((e,t)=>{"use strict";t.exports="load"}),NE=S((e,t)=>{"use strict";t.exports="fileprogress"}),UE=S((e,t)=>{"use strict";t.exports="postprocess"}),FE=S((e,t)=>{"use strict";t.exports="progress"}),GE=S((e,t)=>{"use strict";t.exports="start"}),ci=S((e,t)=>{"use strict";t.exports={ADD:IE(),COMPLETE:ME(),FILE_COMPLETE:OE(),FILE_KEY_COMPLETE:DE(),FILE_LOAD_ERROR:kE(),FILE_LOAD:BE(),FILE_PROGRESS:NE(),POST_PROCESS:UE(),PROGRESS:FE(),START:GE()}}),Ml=S((e,t)=>{"use strict";var i={Global:["game","anims","cache","plugins","registry","scale","sound","textures","renderer"],CoreScene:["EventEmitter","CameraManager","GameObjectCreator","GameObjectFactory","ScenePlugin","DisplayList","UpdateList"],DefaultScene:["Clock","DataManagerPlugin","InputPlugin","Loader","TweenManager","LightsPlugin"]};t.exports=i}),Ol=S((e,t)=>{"use strict";var i=function(s){return s&&s[0].toUpperCase()+s.slice(1)};t.exports=i}),YE=S((e,t)=>{"use strict";var i=pt(),s=Ol(),n=function(r){var o=r.game.config.defaultPhysicsSystem,a=i(r.settings,"physics",!1);if(!(!o&&!a)){var h=[];if(o&&h.push(s(o+"Physics")),a)for(var l in a)l=s(l.concat("Physics")),h.indexOf(l)===-1&&h.push(l);return h}};t.exports=n}),qn=S((e,t)=>{"use strict";var i=function(s){var n={};for(var r in s)Array.isArray(s[r])?n[r]=s[r].slice(0):n[r]=s[r];return n};t.exports=i}),HE=S((e,t)=>{"use strict";var i=qn(),s=function(n,r){var o=i(n);for(var a in r)o.hasOwnProperty(a)||(o[a]=r[a]);return o};t.exports=s}),WE=S((e,t)=>{"use strict";var i={game:"game",renderer:"renderer",anims:"anims",cache:"cache",plugins:"plugins",registry:"registry",scale:"scale",sound:"sound",textures:"textures",events:"events",cameras:"cameras",add:"add",make:"make",scenePlugin:"scene",displayList:"children",lights:"lights",data:"data",input:"input",load:"load",time:"time",tweens:"tweens",arcadePhysics:"physics",impactPhysics:"impact",matterPhysics:"matter"};t.exports=i}),Dl=S((e,t)=>{"use strict";var i=Zn(),s=Mt(),n=HE(),r=WE(),o={create:function(a){return typeof a=="string"?a={key:a}:a===void 0&&(a={}),{status:i.PENDING,key:s(a,"key",""),active:s(a,"active",!1),visible:s(a,"visible",!0),isBooted:!1,isTransition:!1,transitionFrom:null,transitionDuration:0,transitionAllowInput:!0,data:{},pack:s(a,"pack",!1),cameras:s(a,"cameras",null),map:s(a,"map",n(r,s(a,"mapAdd",{}))),physics:s(a,"physics",{}),loader:s(a,"loader",{}),plugins:s(a,"plugins",!1),input:s(a,"input",{})}}};t.exports=o}),xa=S((e,t)=>{"use strict";var i=V(),s=Zn(),n=Ml(),r=Nt(),o=YE(),a=Il(),h=Lt(),l=Dl(),c=new i({initialize:function(f,u){this.scene=f,this.game,this.renderer,this.config=u,this.settings=l.create(u),this.canvas,this.context,this.anims,this.cache,this.plugins,this.registry,this.scale,this.sound,this.textures,this.add,this.cameras,this.displayList,this.events,this.make,this.scenePlugin,this.updateList,this.sceneUpdate=h},init:function(f){this.settings.status=s.INIT,this.sceneUpdate=h,this.game=f,this.renderer=f.renderer,this.canvas=f.canvas,this.context=f.context;var u=f.plugins;this.plugins=u,u.addToScene(this,n.Global,[n.CoreScene,a(this),o(this)]),this.events.emit(r.BOOT,this),this.settings.isBooted=!0},step:function(f,u){var p=this.events;p.emit(r.PRE_UPDATE,f,u),p.emit(r.UPDATE,f,u),this.sceneUpdate.call(this.scene,f,u),p.emit(r.POST_UPDATE,f,u)},render:function(f){var u=this.displayList;u.depthSort(),this.events.emit(r.PRE_RENDER,f),this.cameras.render(f,u),this.events.emit(r.RENDER,f)},queueDepthSort:function(){this.displayList.queueDepthSort()},depthSort:function(){this.displayList.depthSort()},pause:function(f){var u=this.settings,p=this.getStatus();return p!==s.CREATING&&p!==s.RUNNING||this.settings.active&&(u.status=s.PAUSED,u.active=!1,this.events.emit(r.PAUSE,this,f)),this},resume:function(f){var u=this.events,p=this.settings;return this.settings.active||(p.status=s.RUNNING,p.active=!0,u.emit(r.RESUME,this,f)),this},sleep:function(f){var u=this.settings,p=this.getStatus();return p!==s.CREATING&&p!==s.RUNNING||(u.status=s.SLEEPING,u.active=!1,u.visible=!1,this.events.emit(r.SLEEP,this,f)),this},wake:function(f){var u=this.events,p=this.settings;return p.status=s.RUNNING,p.active=!0,p.visible=!0,u.emit(r.WAKE,this,f),p.isTransition&&u.emit(r.TRANSITION_WAKE,p.transitionFrom,p.transitionDuration),this},getData:function(){return this.settings.data},getStatus:function(){return this.settings.status},canInput:function(){var f=this.settings.status;return f>s.PENDING&&f<=s.RUNNING},isSleeping:function(){return this.settings.status===s.SLEEPING},isActive:function(){return this.settings.status===s.RUNNING},isPaused:function(){return this.settings.status===s.PAUSED},isTransitioning:function(){return this.settings.isTransition||this.scenePlugin._target!==null},isTransitionOut:function(){return this.scenePlugin._target!==null&&this.scenePlugin._duration>0},isTransitionIn:function(){return this.settings.isTransition},isVisible:function(){return this.settings.visible},setVisible:function(f){return this.settings.visible=f,this},setActive:function(f,u){return f?this.resume(u):this.pause(u)},start:function(f){var u=this.events,p=this.settings;f&&(p.data=f),p.status=s.START,p.active=!0,p.visible=!0,u.emit(r.START,this),u.emit(r.READY,this,f)},shutdown:function(f){var u=this.events,p=this.settings;u.off(r.TRANSITION_INIT),u.off(r.TRANSITION_START),u.off(r.TRANSITION_COMPLETE),u.off(r.TRANSITION_OUT),p.status=s.SHUTDOWN,p.active=!1,p.visible=!1,u.emit(r.SHUTDOWN,this,f)},destroy:function(){var f=this.events,u=this.settings;u.status=s.DESTROYED,u.active=!1,u.visible=!1,f.emit(r.DESTROY,this),f.removeAllListeners();for(var p=["scene","game","anims","cache","plugins","registry","sound","textures","add","camera","displayList","events","make","scenePlugin","updateList"],d=0;d<p.length;d++)this[p[d]]=null}});t.exports=c}),kl=S((e,t)=>{"use strict";var i=V(),s=xa(),n=new i({initialize:function(r){this.sys=new s(this,r),this.game,this.anims,this.cache,this.registry,this.sound,this.textures,this.events,this.cameras,this.add,this.make,this.scene,this.children,this.lights,this.data,this.input,this.load,this.time,this.tweens,this.physics,this.matter,this.scale,this.plugins,this.renderer},update:function(){}});t.exports=n}),Bl=S((e,t)=>{"use strict";var i=V(),s=Zn(),n=Nt(),r=Ce(),o=Mt(),a=ci(),h=Lt(),l=kl(),c=xa(),f=new i({initialize:function(u,p){if(this.game=u,this.keys={},this.scenes=[],this._pending=[],this._start=[],this._queue=[],this._data={},this.isProcessing=!1,this.isBooted=!1,this.customViewports=0,this.systemScene,p){Array.isArray(p)||(p=[p]);for(var d=0;d<p.length;d++)this._pending.push({key:"default",scene:p[d],autoStart:d===0,data:{}})}u.events.once(r.READY,this.bootQueue,this)},bootQueue:function(){if(!this.isBooted){this.systemScene=this.createSceneFromInstance("__SYSTEM",new l),this.game.events.emit(r.SYSTEM_READY,this.systemScene,this);var u,p,d,g;for(u=0;u<this._pending.length;u++){p=this._pending[u],d=p.key,g=p.scene;var m;g instanceof l?m=this.createSceneFromInstance(d,g):typeof g=="object"?m=this.createSceneFromObject(d,g):typeof g=="function"&&(m=this.createSceneFromFunction(d,g)),d=m.sys.settings.key,this.keys[d]=m,this.scenes.push(m),this._data[d]&&(m.sys.settings.data=this._data[d].data,this._data[d].autoStart&&(p.autoStart=!0)),(p.autoStart||m.sys.settings.active)&&this._start.push(d)}for(this._pending.length=0,this._data={},this.isBooted=!0,u=0;u<this._start.length;u++)p=this._start[u],this.start(p);this._start.length=0}},processQueue:function(){var u=this._pending.length,p=this._queue.length;if(!(u===0&&p===0)){var d,g;if(u){for(d=0;d<u;d++)g=this._pending[d],this.add(g.key,g.scene,g.autoStart,g.data);for(d=0;d<this._start.length;d++)g=this._start[d],this.start(g);this._start.length=0,this._pending.length=0}for(d=0;d<this._queue.length;d++)g=this._queue[d],this[g.op](g.keyA,g.keyB,g.data);this._queue.length=0}},add:function(u,p,d,g){if(d===void 0&&(d=!1),g===void 0&&(g={}),this.isProcessing||!this.isBooted)return this._pending.push({key:u,scene:p,autoStart:d,data:g}),this.isBooted||(this._data[u]={data:g}),null;u=this.getKey(u,p);var m;return p instanceof l?m=this.createSceneFromInstance(u,p):typeof p=="object"?(p.key=u,m=this.createSceneFromObject(u,p)):typeof p=="function"&&(m=this.createSceneFromFunction(u,p)),m.sys.settings.data=g,u=m.sys.settings.key,this.keys[u]=m,this.scenes.push(m),(d||m.sys.settings.active)&&(this._pending.length?this._start.push(u):this.start(u)),m},remove:function(u){if(this.isProcessing)return this.queueOp("remove",u);var p=this.getScene(u);if(!p||p.sys.isTransitioning())return this;var d=this.scenes.indexOf(p),g=p.sys.settings.key;return d>-1&&(delete this.keys[g],this.scenes.splice(d,1),this._start.indexOf(g)>-1&&(d=this._start.indexOf(g),this._start.splice(d,1)),p.sys.destroy()),this},bootScene:function(u){var p=u.sys,d=p.settings;p.sceneUpdate=h,u.init&&(u.init.call(u,d.data),d.status=s.INIT,d.isTransition&&p.events.emit(n.TRANSITION_INIT,d.transitionFrom,d.transitionDuration));var g;p.load&&(g=p.load,g.reset()),g&&u.preload?(u.preload.call(u),d.status=s.LOADING,g.once(a.COMPLETE,this.loadComplete,this),g.start()):this.create(u)},loadComplete:function(u){this.create(u.scene)},payloadComplete:function(u){this.bootScene(u.scene)},update:function(u,p){this.processQueue(),this.isProcessing=!0;for(var d=this.scenes.length-1;d>=0;d--){var g=this.scenes[d].sys;g.settings.status>s.START&&g.settings.status<=s.RUNNING&&g.step(u,p),g.scenePlugin&&g.scenePlugin._target&&g.scenePlugin.step(u,p)}},render:function(u){for(var p=0;p<this.scenes.length;p++){var d=this.scenes[p].sys;d.settings.visible&&d.settings.status>=s.LOADING&&d.settings.status<s.SLEEPING&&d.render(u)}this.isProcessing=!1},create:function(u){var p=u.sys,d=p.settings;u.create&&(d.status=s.CREATING,u.create.call(u,d.data),d.status===s.DESTROYED)||(d.isTransition&&p.events.emit(n.TRANSITION_START,d.transitionFrom,d.transitionDuration),u.update&&(p.sceneUpdate=u.update),d.status=s.RUNNING,p.events.emit(n.CREATE,u))},createSceneFromFunction:function(u,p){var d=new p;if(d instanceof l){var g=d.sys.settings.key;if(g!==""&&(u=g),this.keys.hasOwnProperty(u))throw new Error("Cannot add Scene with duplicate key: "+u);return this.createSceneFromInstance(u,d)}else return d.sys=new c(d),d.sys.settings.key=u,d.sys.init(this.game),d},createSceneFromInstance:function(u,p){var d=p.sys.settings.key;return d===""&&(p.sys.settings.key=u),p.sys.init(this.game),p},createSceneFromObject:function(u,p){var d=new l(p),g=d.sys.settings.key;g!==""?u=g:d.sys.settings.key=u,d.sys.init(this.game);for(var m=["init","preload","create","update","render"],E=0;E<m.length;E++){var v=o(p,m[E],null);v&&(d[m[E]]=v)}if(p.hasOwnProperty("extend")){for(var y in p.extend)if(p.extend.hasOwnProperty(y)){var T=p.extend[y];y==="data"&&d.hasOwnProperty("data")&&typeof T=="object"?d.data.merge(T):y!=="sys"&&(d[y]=T)}}return d},getKey:function(u,p){if(u||(u="default"),typeof p=="function")return u;if(p instanceof l?u=p.sys.settings.key:typeof p=="object"&&p.hasOwnProperty("key")&&(u=p.key),this.keys.hasOwnProperty(u))throw new Error("Cannot add Scene with duplicate key: "+u);return u},getScenes:function(u,p){u===void 0&&(u=!0),p===void 0&&(p=!1);for(var d=[],g=this.scenes,m=0;m<g.length;m++){var E=g[m];E&&(!u||u&&E.sys.isActive())&&d.push(E)}return p?d.reverse():d},getScene:function(u){if(typeof u=="string"){if(this.keys[u])return this.keys[u]}else for(var p=0;p<this.scenes.length;p++)if(u===this.scenes[p])return u;return null},isActive:function(u){var p=this.getScene(u);return p?p.sys.isActive():null},isPaused:function(u){var p=this.getScene(u);return p?p.sys.isPaused():null},isVisible:function(u){var p=this.getScene(u);return p?p.sys.isVisible():null},isSleeping:function(u){var p=this.getScene(u);return p?p.sys.isSleeping():null},pause:function(u,p){var d=this.getScene(u);return d&&d.sys.pause(p),this},resume:function(u,p){var d=this.getScene(u);return d&&d.sys.resume(p),this},sleep:function(u,p){var d=this.getScene(u);return d&&!d.sys.isTransitioning()&&d.sys.sleep(p),this},wake:function(u,p){var d=this.getScene(u);return d&&d.sys.wake(p),this},run:function(u,p){var d=this.getScene(u);if(!d){for(var g=0;g<this._pending.length;g++)if(this._pending[g].key===u){this.queueOp("start",u,p);break}return this}d.sys.isSleeping()?d.sys.wake(p):d.sys.isPaused()?d.sys.resume(p):this.start(u,p)},start:function(u,p){if(!this.isBooted)return this._data[u]={autoStart:!0,data:p},this;var d=this.getScene(u);if(!d)return this;var g=d.sys,m=g.settings.status;if(m>=s.START&&m<=s.CREATING)return this;if(m>=s.RUNNING&&m<=s.SLEEPING)g.shutdown(),g.sceneUpdate=h,g.start(p);else{g.sceneUpdate=h,g.start(p);var E;if(g.load&&(E=g.load),E&&g.settings.hasOwnProperty("pack")&&(E.reset(),E.addPack({payload:g.settings.pack})))return g.settings.status=s.LOADING,E.once(a.COMPLETE,this.payloadComplete,this),E.start(),this}return this.bootScene(d),this},stop:function(u,p){var d=this.getScene(u);if(d&&!d.sys.isTransitioning()&&d.sys.settings.status!==s.SHUTDOWN){var g=d.sys.load;g&&(g.off(a.COMPLETE,this.loadComplete,this),g.off(a.COMPLETE,this.payloadComplete,this)),d.sys.shutdown(p)}return this},switch:function(u,p,d){var g=this.getScene(u),m=this.getScene(p);return g&&m&&g!==m&&(this.sleep(u),this.isSleeping(p)?this.wake(p,d):this.start(p,d)),this},getAt:function(u){return this.scenes[u]},getIndex:function(u){var p=this.getScene(u);return this.scenes.indexOf(p)},bringToTop:function(u){if(this.isProcessing)return this.queueOp("bringToTop",u);var p=this.getIndex(u),d=this.scenes;if(p!==-1&&p<d.length){var g=this.getScene(u);d.splice(p,1),d.push(g)}return this},sendToBack:function(u){if(this.isProcessing)return this.queueOp("sendToBack",u);var p=this.getIndex(u);if(p!==-1&&p>0){var d=this.getScene(u);this.scenes.splice(p,1),this.scenes.unshift(d)}return this},moveDown:function(u){if(this.isProcessing)return this.queueOp("moveDown",u);var p=this.getIndex(u);if(p>0){var d=p-1,g=this.getScene(u),m=this.getAt(d);this.scenes[p]=m,this.scenes[d]=g}return this},moveUp:function(u){if(this.isProcessing)return this.queueOp("moveUp",u);var p=this.getIndex(u);if(p<this.scenes.length-1){var d=p+1,g=this.getScene(u),m=this.getAt(d);this.scenes[p]=m,this.scenes[d]=g}return this},moveAbove:function(u,p){if(u===p)return this;if(this.isProcessing)return this.queueOp("moveAbove",u,p);var d=this.getIndex(u),g=this.getIndex(p);if(d!==-1&&g!==-1&&g<d){var m=this.getAt(g);this.scenes.splice(g,1),this.scenes.splice(d+(g>d),0,m)}return this},moveBelow:function(u,p){if(u===p)return this;if(this.isProcessing)return this.queueOp("moveBelow",u,p);var d=this.getIndex(u),g=this.getIndex(p);if(d!==-1&&g!==-1&&g>d){var m=this.getAt(g);this.scenes.splice(g,1),d===0?this.scenes.unshift(m):this.scenes.splice(d-(g<d),0,m)}return this},queueOp:function(u,p,d,g){return this._queue.push({op:u,keyA:p,keyB:d,data:g}),this},swapPosition:function(u,p){if(u===p)return this;if(this.isProcessing)return this.queueOp("swapPosition",u,p);var d=this.getIndex(u),g=this.getIndex(p);if(d!==g&&d!==-1&&g!==-1){var m=this.getAt(d);this.scenes[d]=this.scenes[g],this.scenes[g]=m}return this},dump:function(){for(var u=[],p=["pending","init","start","loading","creating","running","paused","sleeping","shutdown","destroyed"],d=0;d<this.scenes.length;d++){var g=this.scenes[d].sys,m=g.settings.visible&&(g.settings.status===s.RUNNING||g.settings.status===s.PAUSED)?"[*] ":"[-] ";m+=g.settings.key+" ("+p[g.settings.status]+")",u.push(m)}},destroy:function(){for(var u=0;u<this.scenes.length;u++){var p=this.scenes[u].sys;p.destroy()}this.systemScene.sys.destroy(),this.update=h,this.scenes=[],this._pending=[],this._start=[],this._queue=[],this.game=null,this.systemScene=null}});t.exports=f}),zE=S((e,t)=>{"use strict";var i=Xt(),s=V(),n=Nt(),r=pt(),o=ae(),a=new s({initialize:function(h){this.scene=h,this.systems=h.sys,this.settings=h.sys.settings,this.key=h.sys.settings.key,this.manager=h.sys.game.scene,this.transitionProgress=0,this._elapsed=0,this._target=null,this._duration=0,this._onUpdate,this._onUpdateScope,this._willSleep=!1,this._willRemove=!1,h.sys.events.once(n.BOOT,this.boot,this),h.sys.events.on(n.START,this.pluginStart,this)},boot:function(){this.systems.events.once(n.DESTROY,this.destroy,this)},pluginStart:function(){this._target=null,this.systems.events.once(n.SHUTDOWN,this.shutdown,this)},start:function(h,l){return h===void 0&&(h=this.key),this.manager.queueOp("stop",this.key),this.manager.queueOp("start",h,l),this},restart:function(h){var l=this.key;return this.manager.queueOp("stop",l),this.manager.queueOp("start",l,h),this},transition:function(h){h===void 0&&(h={});var l=r(h,"target",!1),c=this.manager.getScene(l);if(!l||!this.checkValidTransition(c))return!1;var f=r(h,"duration",1e3);this._elapsed=0,this._target=c,this._duration=f,this._willSleep=r(h,"sleep",!1),this._willRemove=r(h,"remove",!1);var u=r(h,"onUpdate",null);u&&(this._onUpdate=u,this._onUpdateScope=r(h,"onUpdateScope",this.scene));var p=r(h,"allowInput",!1);this.settings.transitionAllowInput=p;var d=c.sys.settings;d.isTransition=!0,d.transitionFrom=this.scene,d.transitionDuration=f,d.transitionAllowInput=p,r(h,"moveAbove",!1)?this.manager.moveAbove(this.key,l):r(h,"moveBelow",!1)&&this.manager.moveBelow(this.key,l),c.sys.isSleeping()?c.sys.wake(r(h,"data")):this.manager.start(l,r(h,"data"));var g=r(h,"onStart",null),m=r(h,"onStartScope",this.scene);return g&&g.call(m,this.scene,c,f),this.systems.events.emit(n.TRANSITION_OUT,c,f),!0},checkValidTransition:function(h){return!(!h||h.sys.isActive()||h.sys.isTransitioning()||h===this.scene||this.systems.isTransitioning())},step:function(h,l){this._elapsed+=l,this.transitionProgress=i(this._elapsed/this._duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.transitionProgress),this._elapsed>=this._duration&&this.transitionComplete()},transitionComplete:function(){var h=this._target.sys,l=this._target.sys.settings;h.events.emit(n.TRANSITION_COMPLETE,this.scene),l.isTransition=!1,l.transitionFrom=null,this._duration=0,this._target=null,this._onUpdate=null,this._onUpdateScope=null,this._willRemove?this.manager.remove(this.key):this._willSleep?this.systems.sleep():this.manager.stop(this.key)},add:function(h,l,c,f){return this.manager.add(h,l,c,f)},launch:function(h,l){return h&&h!==this.key&&this.manager.queueOp("start",h,l),this},run:function(h,l){return h&&h!==this.key&&this.manager.queueOp("run",h,l),this},pause:function(h,l){return h===void 0&&(h=this.key),this.manager.queueOp("pause",h,l),this},resume:function(h,l){return h===void 0&&(h=this.key),this.manager.queueOp("resume",h,l),this},sleep:function(h,l){return h===void 0&&(h=this.key),this.manager.queueOp("sleep",h,l),this},wake:function(h,l){return h===void 0&&(h=this.key),this.manager.queueOp("wake",h,l),this},switch:function(h,l){return h!==this.key&&this.manager.queueOp("switch",this.key,h,l),this},stop:function(h,l){return h===void 0&&(h=this.key),this.manager.queueOp("stop",h,l),this},setActive:function(h,l,c){l===void 0&&(l=this.key);var f=this.manager.getScene(l);return f&&f.sys.setActive(h,c),this},setVisible:function(h,l){l===void 0&&(l=this.key);var c=this.manager.getScene(l);return c&&c.sys.setVisible(h),this},isSleeping:function(h){return h===void 0&&(h=this.key),this.manager.isSleeping(h)},isActive:function(h){return h===void 0&&(h=this.key),this.manager.isActive(h)},isPaused:function(h){return h===void 0&&(h=this.key),this.manager.isPaused(h)},isVisible:function(h){return h===void 0&&(h=this.key),this.manager.isVisible(h)},swapPosition:function(h,l){return l===void 0&&(l=this.key),h!==l&&this.manager.swapPosition(h,l),this},moveAbove:function(h,l){return l===void 0&&(l=this.key),h!==l&&this.manager.moveAbove(h,l),this},moveBelow:function(h,l){return l===void 0&&(l=this.key),h!==l&&this.manager.moveBelow(h,l),this},remove:function(h){return h===void 0&&(h=this.key),this.manager.remove(h),this},moveUp:function(h){return h===void 0&&(h=this.key),this.manager.moveUp(h),this},moveDown:function(h){return h===void 0&&(h=this.key),this.manager.moveDown(h),this},bringToTop:function(h){return h===void 0&&(h=this.key),this.manager.bringToTop(h),this},sendToBack:function(h){return h===void 0&&(h=this.key),this.manager.sendToBack(h),this},get:function(h){return this.manager.getScene(h)},getStatus:function(h){var l=this.manager.getScene(h);if(l)return l.sys.getStatus()},getIndex:function(h){return h===void 0&&(h=this.key),this.manager.getIndex(h)},shutdown:function(){var h=this.systems.events;h.off(n.SHUTDOWN,this.shutdown,this),h.off(n.TRANSITION_OUT)},destroy:function(){this.shutdown(),this.scene.sys.events.off(n.START,this.start,this),this.scene=null,this.systems=null,this.settings=null,this.manager=null}});o.register("ScenePlugin",a,"scenePlugin"),t.exports=a}),VE=S((e,t)=>{"use strict";var i=Zn(),s=Re(),n={GetScenePlugins:Il(),SceneManager:Bl(),ScenePlugin:zE(),Settings:Dl(),Systems:xa()};n=s(!1,n,i),t.exports=n}),XE=S((e,t)=>{"use strict";t.exports="active"}),KE=S((e,t)=>{"use strict";t.exports="complete"}),jE=S((e,t)=>{"use strict";t.exports="loop"}),ZE=S((e,t)=>{"use strict";t.exports="pause"}),qE=S((e,t)=>{"use strict";t.exports="resume"}),QE=S((e,t)=>{"use strict";t.exports="repeat"}),JE=S((e,t)=>{"use strict";t.exports="start"}),$E=S((e,t)=>{"use strict";t.exports="stop"}),ty=S((e,t)=>{"use strict";t.exports="update"}),ey=S((e,t)=>{"use strict";t.exports="yoyo"}),Ue=S((e,t)=>{"use strict";t.exports={TWEEN_ACTIVE:XE(),TWEEN_COMPLETE:KE(),TWEEN_LOOP:jE(),TWEEN_PAUSE:ZE(),TWEEN_RESUME:qE(),TWEEN_REPEAT:QE(),TWEEN_START:JE(),TWEEN_STOP:$E(),TWEEN_UPDATE:ty(),TWEEN_YOYO:ey()}}),iy=S((e,t)=>{"use strict";t.exports="addedtoscene"}),sy=S((e,t)=>{"use strict";t.exports="destroy"}),ny=S((e,t)=>{"use strict";t.exports="removedfromscene"}),ry=S((e,t)=>{"use strict";t.exports="complete"}),ay=S((e,t)=>{"use strict";t.exports="created"}),oy=S((e,t)=>{"use strict";t.exports="error"}),hy=S((e,t)=>{"use strict";t.exports="locked"}),ly=S((e,t)=>{"use strict";t.exports="loop"}),uy=S((e,t)=>{"use strict";t.exports="metadata"}),cy=S((e,t)=>{"use strict";t.exports="play"}),dy=S((e,t)=>{"use strict";t.exports="playing"}),py=S((e,t)=>{"use strict";t.exports="seeked"}),gy=S((e,t)=>{"use strict";t.exports="seeking"}),fy=S((e,t)=>{"use strict";t.exports="stalled"}),my=S((e,t)=>{"use strict";t.exports="stop"}),vy=S((e,t)=>{"use strict";t.exports="textureready"}),Ey=S((e,t)=>{"use strict";t.exports="unlocked"}),yy=S((e,t)=>{"use strict";t.exports="unsupported"}),Vi=S((e,t)=>{"use strict";t.exports={ADDED_TO_SCENE:iy(),DESTROY:sy(),REMOVED_FROM_SCENE:ny(),VIDEO_COMPLETE:ry(),VIDEO_CREATED:ay(),VIDEO_ERROR:oy(),VIDEO_LOCKED:hy(),VIDEO_LOOP:ly(),VIDEO_METADATA:uy(),VIDEO_PLAY:cy(),VIDEO_PLAYING:dy(),VIDEO_SEEKED:py(),VIDEO_SEEKING:gy(),VIDEO_STALLED:fy(),VIDEO_STOP:my(),VIDEO_TEXTURE:vy(),VIDEO_UNLOCKED:Ey(),VIDEO_UNSUPPORTED:yy()}}),Nl=S((e,t)=>{"use strict";var i=ua(),s=V(),n=Lt(),r=Hn(),o=new s({initialize:function(a){this.parent=a,this.list=[],this.position=0,this.addCallback=n,this.removeCallback=n,this._sortKey=""},add:function(a,h){return h?i.Add(this.list,a):i.Add(this.list,a,0,this.addCallback,this)},addAt:function(a,h,l){return l?i.AddAt(this.list,a,h):i.AddAt(this.list,a,h,0,this.addCallback,this)},getAt:function(a){return this.list[a]},getIndex:function(a){return this.list.indexOf(a)},sort:function(a,h){return a?(h===void 0&&(h=function(l,c){return l[a]-c[a]}),r(this.list,h),this):this},getByName:function(a){return i.GetFirst(this.list,"name",a)},getRandom:function(a,h){return i.GetRandom(this.list,a,h)},getFirst:function(a,h,l,c){return i.GetFirst(this.list,a,h,l,c)},getAll:function(a,h,l,c){return i.GetAll(this.list,a,h,l,c)},count:function(a,h){return i.CountAllMatching(this.list,a,h)},swap:function(a,h){i.Swap(this.list,a,h)},moveTo:function(a,h){return i.MoveTo(this.list,a,h)},moveAbove:function(a,h){return i.MoveAbove(this.list,a,h)},moveBelow:function(a,h){return i.MoveBelow(this.list,a,h)},remove:function(a,h){return h?i.Remove(this.list,a):i.Remove(this.list,a,this.removeCallback,this)},removeAt:function(a,h){return h?i.RemoveAt(this.list,a):i.RemoveAt(this.list,a,this.removeCallback,this)},removeBetween:function(a,h,l){return l?i.RemoveBetween(this.list,a,h):i.RemoveBetween(this.list,a,h,this.removeCallback,this)},removeAll:function(a){for(var h=this.list.length;h--;)this.remove(this.list[h],a);return this},bringToTop:function(a){return i.BringToTop(this.list,a)},sendToBack:function(a){return i.SendToBack(this.list,a)},moveUp:function(a){return i.MoveUp(this.list,a),a},moveDown:function(a){return i.MoveDown(this.list,a),a},reverse:function(){return this.list.reverse(),this},shuffle:function(){return i.Shuffle(this.list),this},replace:function(a,h){return i.Replace(this.list,a,h)},exists:function(a){return this.list.indexOf(a)>-1},setAll:function(a,h,l,c){return i.SetAll(this.list,a,h,l,c),this},each:function(a,h){for(var l=[null],c=2;c<arguments.length;c++)l.push(arguments[c]);for(c=0;c<this.list.length;c++)l[0]=this.list[c],a.apply(h,l)},shutdown:function(){this.removeAll(),this.list=[]},destroy:function(){this.removeAll(),this.parent=null,this.addCallback=null,this.removeCallback=null},length:{get:function(){return this.list.length}},first:{get:function(){return this.position=0,this.list.length>0?this.list[0]:null}},last:{get:function(){return this.list.length>0?(this.position=this.list.length-1,this.list[this.position]):null}},next:{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}},previous:{get:function(){return this.position>0?(this.position--,this.list[this.position]):null}}});t.exports=o}),Ty=S((e,t)=>{"use strict";var i=V(),s=Nl(),n=ae(),r=Vi(),o=Nt(),a=Hn(),h=new i({Extends:s,initialize:function(l){s.call(this,l),this.sortChildrenFlag=!1,this.scene=l,this.systems=l.sys,this.events=l.sys.events,this.addCallback=this.addChildCallback,this.removeCallback=this.removeChildCallback,this.events.once(o.BOOT,this.boot,this),this.events.on(o.START,this.start,this)},boot:function(){this.events.once(o.DESTROY,this.destroy,this)},addChildCallback:function(l){l.displayList&&l.displayList!==this&&l.removeFromDisplayList(),l.parentContainer&&l.parentContainer.remove(l),l.displayList||(this.queueDepthSort(),l.displayList=this,l.emit(r.ADDED_TO_SCENE,l,this.scene),this.events.emit(o.ADDED_TO_SCENE,l,this.scene))},removeChildCallback:function(l){this.queueDepthSort(),l.displayList=null,l.emit(r.REMOVED_FROM_SCENE,l,this.scene),this.events.emit(o.REMOVED_FROM_SCENE,l,this.scene)},start:function(){this.events.once(o.SHUTDOWN,this.shutdown,this)},queueDepthSort:function(){this.sortChildrenFlag=!0},depthSort:function(){this.sortChildrenFlag&&(a(this.list,this.sortByDepth),this.sortChildrenFlag=!1)},sortByDepth:function(l,c){return l._depth-c._depth},getChildren:function(){return this.list},shutdown:function(){for(var l=this.list,c=l.length;c--;)l[c].destroy(!0);l.length=0,this.events.off(o.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(o.START,this.start,this),this.scene=null,this.systems=null,this.events=null}});n.register("DisplayList",h,"displayList"),t.exports=h}),ve=S((e,t)=>{"use strict";var i=V(),s=ae(),n=Nt(),r=new i({initialize:function(o){this.scene=o,this.systems=o.sys,this.events=o.sys.events,this.displayList,this.updateList,this.events.once(n.BOOT,this.boot,this),this.events.on(n.START,this.start,this)},boot:function(){this.displayList=this.systems.displayList,this.updateList=this.systems.updateList,this.events.once(n.DESTROY,this.destroy,this)},start:function(){this.events.once(n.SHUTDOWN,this.shutdown,this)},shutdown:function(){this.events.off(n.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(n.START,this.start,this),this.scene=null,this.systems=null,this.events=null,this.displayList=null,this.updateList=null}});r.register=function(o,a){r.prototype.hasOwnProperty(o)||(r.prototype[o]=a)},r.remove=function(o){r.prototype.hasOwnProperty(o)&&delete r.prototype[o]},s.register("GameObjectCreator",r,"make"),t.exports=r}),Sy=S((e,t)=>{"use strict";t.exports="add"}),Ay=S((e,t)=>{"use strict";t.exports="remove"}),xy=S((e,t)=>{"use strict";t.exports={PROCESS_QUEUE_ADD:Sy(),PROCESS_QUEUE_REMOVE:Ay()}}),wy=S((e,t)=>{"use strict";var i=V(),s=Wt(),n=xy(),r=new i({Extends:s,initialize:function(){s.call(this),this._pending=[],this._active=[],this._destroy=[],this._toProcess=0,this.checkQueue=!1},isActive:function(o){return this._active.indexOf(o)>-1},isPending:function(o){return this._toProcess>0&&this._pending.indexOf(o)>-1},isDestroying:function(o){return this._destroy.indexOf(o)>-1},add:function(o){return this.checkQueue&&this.isActive(o)&&!this.isDestroying(o)||this.isPending(o)||(this._pending.push(o),this._toProcess++),o},remove:function(o){if(this.isPending(o)){var a=this._pending,h=a.indexOf(o);h!==-1&&a.splice(h,1)}else this.isActive(o)&&(this._destroy.push(o),this._toProcess++);return o},removeAll:function(){for(var o=this._active,a=this._destroy,h=o.length;h--;)a.push(o[h]),this._toProcess++;return this},update:function(){if(this._toProcess===0)return this._active;var o=this._destroy,a=this._active,h,l;for(h=0;h<o.length;h++){l=o[h];var c=a.indexOf(l);c!==-1&&(a.splice(c,1),this.emit(n.PROCESS_QUEUE_REMOVE,l))}for(o.length=0,o=this._pending,h=0;h<o.length;h++)l=o[h],(!this.checkQueue||this.checkQueue&&a.indexOf(l)===-1)&&(a.push(l),this.emit(n.PROCESS_QUEUE_ADD,l));return o.length=0,this._toProcess=0,a},getActive:function(){return this._active},length:{get:function(){return this._active.length}},destroy:function(){this._toProcess=0,this._pending=[],this._active=[],this._destroy=[]}});t.exports=r}),Ry=S((e,t)=>{"use strict";var i=V(),s=wy(),n=ae(),r=Nt(),o=new i({Extends:s,initialize:function(a){s.call(this),this.checkQueue=!0,this.scene=a,this.systems=a.sys,a.sys.events.once(r.BOOT,this.boot,this),a.sys.events.on(r.START,this.start,this)},boot:function(){this.systems.events.once(r.DESTROY,this.destroy,this)},start:function(){var a=this.systems.events;a.on(r.PRE_UPDATE,this.update,this),a.on(r.UPDATE,this.sceneUpdate,this),a.once(r.SHUTDOWN,this.shutdown,this)},sceneUpdate:function(a,h){for(var l=this._active,c=l.length,f=0;f<c;f++){var u=l[f];u.active&&u.preUpdate.call(u,a,h)}},shutdown:function(){for(var a=this._active.length;a--;)this._active[a].destroy(!0);for(a=this._pending.length;a--;)this._pending[a].destroy(!0);for(a=this._destroy.length;a--;)this._destroy[a].destroy(!0);this._toProcess=0,this._pending=[],this._active=[],this._destroy=[],this.removeAllListeners();var h=this.systems.events;h.off(r.PRE_UPDATE,this.update,this),h.off(r.UPDATE,this.sceneUpdate,this),h.off(r.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.systems.events.off(r.START,this.start,this),this.scene=null,this.systems=null}});n.register("UpdateList",o,"updateList"),t.exports=o}),Xi=S((e,t)=>{"use strict";var i=ui(),s=new i,n=new i,r=new i,o={camera:s,sprite:n,calc:r},a=function(h,l,c){var f=s,u=n,p=r;return u.applyITRS(h.x,h.y,h.rotation,h.scaleX,h.scaleY),f.copyFrom(l.matrix),c?(f.multiplyWithOffset(c,-l.scrollX*h.scrollFactorX,-l.scrollY*h.scrollFactorY),u.e=h.x,u.f=h.y):(u.e-=l.scrollX*h.scrollFactorX,u.f-=l.scrollY*h.scrollFactorY),f.multiply(u,p),o};t.exports=a}),Cy=S((e,t)=>{"use strict";var i=function(s,n){return Math.atan2(n.y-s.y,n.x-s.x)};t.exports=i}),_y=S((e,t)=>{"use strict";var i=function(s,n){return Math.atan2(n.x-s.x,n.y-s.y)};t.exports=i}),by=S((e,t)=>{"use strict";var i=function(s,n,r,o){return Math.atan2(r-s,o-n)};t.exports=i}),Py=S((e,t)=>{"use strict";var i=he(),s=function(n){return n>Math.PI&&(n-=i.PI2),Math.abs(((n+i.TAU)%i.PI2-i.PI2)%i.PI2)};t.exports=s}),Ul=S((e,t)=>{"use strict";var i=function(s){return s=s%(2*Math.PI),s>=0?s:s+2*Math.PI};t.exports=i}),on=S((e,t)=>{"use strict";var i=function(s,n){return Math.random()*(n-s)+s};t.exports=i}),Ly=S((e,t)=>{"use strict";var i=on(),s=function(){return i(-Math.PI,Math.PI)};t.exports=s}),Iy=S((e,t)=>{"use strict";var i=on(),s=function(){return i(-180,180)};t.exports=s}),My=S((e,t)=>{"use strict";var i=Ul(),s=function(n){return i(n+Math.PI)};t.exports=s}),Oy=S((e,t)=>{"use strict";var i=he(),s=function(n,r,o){return o===void 0&&(o=.05),n===r||(Math.abs(r-n)<=o||Math.abs(r-n)>=i.PI2-o?n=r:(Math.abs(r-n)>Math.PI&&(r<n?r+=i.PI2:r-=i.PI2),r>n?n+=o:r<n&&(n-=o))),n};t.exports=s}),Dy=S((e,t)=>{"use strict";var i=function(s,n){var r=n-s;if(r===0)return 0;var o=Math.floor((r- -180)/360);return r-o*360};t.exports=i}),ky=S((e,t)=>{"use strict";t.exports={Between:Sl(),BetweenPoints:Cy(),BetweenPointsY:_y(),BetweenY:by(),CounterClockwise:Py(),Normalize:Ul(),Random:Ly(),RandomDegrees:Iy(),Reverse:My(),RotateTo:Oy(),ShortestBetween:Dy(),Wrap:Qh(),WrapDegrees:Jh()}}),Fl=S((e,t)=>{"use strict";var i=function(s,n){var r=s.x-n.x,o=s.y-n.y;return Math.sqrt(r*r+o*o)};t.exports=i}),By=S((e,t)=>{"use strict";var i=function(s,n){var r=s.x-n.x,o=s.y-n.y;return r*r+o*o};t.exports=i}),Ny=S((e,t)=>{"use strict";var i=function(s,n,r,o){return Math.max(Math.abs(s-r),Math.abs(n-o))};t.exports=i}),Uy=S((e,t)=>{"use strict";var i=function(s,n,r,o,a){return a===void 0&&(a=2),Math.sqrt(Math.pow(r-s,a)+Math.pow(o-n,a))};t.exports=i}),Fy=S((e,t)=>{"use strict";var i=function(s,n,r,o){return Math.abs(s-r)+Math.abs(n-o)};t.exports=i}),Gy=S((e,t)=>{"use strict";var i=function(s,n,r,o){var a=s-r,h=n-o;return a*a+h*h};t.exports=i}),Yy=S((e,t)=>{"use strict";t.exports={Between:Kn(),BetweenPoints:Fl(),BetweenPointsSquared:By(),Chebyshev:Ny(),Power:Uy(),Snake:Fy(),Squared:Gy()}}),ft=S((e,t)=>{"use strict";t.exports={Back:rl(),Bounce:al(),Circular:ol(),Cubic:hl(),Elastic:ll(),Expo:ul(),Linear:cl(),Quadratic:dl(),Quartic:pl(),Quintic:gl(),Sine:fl(),Stepped:ml()}}),Hy=S((e,t)=>{"use strict";var i=function(s){if(s===0)return 1;for(var n=s;--s;)n*=s;return n};t.exports=i}),Wy=S((e,t)=>{"use strict";var i=Hy(),s=function(n,r){return i(n)/i(r)/i(n-r)};t.exports=s}),Gl=S((e,t)=>{"use strict";var i=Wy(),s=function(n,r){for(var o=0,a=n.length-1,h=0;h<=a;h++)o+=Math.pow(1-r,a-h)*Math.pow(r,h)*n[h]*i(a,h);return o};t.exports=s}),Yl=S((e,t)=>{"use strict";var i=function(s,n,r,o,a){var h=(o-n)*.5,l=(a-r)*.5,c=s*s,f=s*c;return(2*r-2*o+h+l)*f+(-3*r+3*o-2*h-l)*c+h*s+r};t.exports=i}),Hl=S((e,t)=>{"use strict";var i=Yl(),s=function(n,r){var o=n.length-1,a=o*r,h=Math.floor(a);return n[0]===n[o]?(r<0&&(h=Math.floor(a=o*(1+r))),i(a-h,n[(h-1+o)%o],n[h],n[(h+1)%o],n[(h+2)%o])):r<0?n[0]-(i(-a,n[0],n[0],n[1],n[1])-n[0]):r>1?n[o]-(i(a-o,n[o],n[o],n[o-1],n[o-1])-n[o]):i(a-h,n[h?h-1:0],n[h],n[o<h+1?o:h+1],n[o<h+2?o:h+2])};t.exports=s}),Wl=S((e,t)=>{"use strict";function i(a,h){var l=1-a;return l*l*l*h}function s(a,h){var l=1-a;return 3*l*l*a*h}function n(a,h){return 3*(1-a)*a*a*h}function r(a,h){return a*a*a*h}var o=function(a,h,l,c,f){return i(a,h)+s(a,l)+n(a,c)+r(a,f)};t.exports=o}),zl=S((e,t)=>{"use strict";var i=Vn(),s=function(n,r){var o=n.length-1,a=o*r,h=Math.floor(a);return r<0?i(n[0],n[1],a):r>1?i(n[o],n[o-1],o-a):i(n[h],n[h+1>o?o:h+1],a-h)};t.exports=s}),Vl=S((e,t)=>{"use strict";function i(o,a){var h=1-o;return h*h*a}function s(o,a){return 2*(1-o)*o*a}function n(o,a){return o*o*a}var r=function(o,a,h,l){return i(o,a)+s(o,h)+n(o,l)};t.exports=r}),Xl=S((e,t)=>{"use strict";var i=function(s,n,r){return s=Math.max(0,Math.min(1,(s-n)/(r-n))),s*s*s*(s*(s*6-15)+10)};t.exports=i}),zy=S((e,t)=>{"use strict";var i=Xl(),s=function(n,r,o){return r+(o-r)*i(n,0,1)};t.exports=s}),Vy=S((e,t)=>{"use strict";t.exports={Bezier:Gl(),CatmullRom:Hl(),CubicBezier:Wl(),Linear:zl(),QuadraticBezier:Vl(),SmoothStep:xl(),SmootherStep:zy()}}),Xy=S((e,t)=>{"use strict";var i=V(),s=new i({initialize:function(n){n===void 0&&(n=[(Date.now()*Math.random()).toString()]),this.c=1,this.s0=0,this.s1=0,this.s2=0,this.n=0,this.signs=[-1,1],n&&this.init(n)},rnd:function(){var n=2091639*this.s0+this.c*23283064365386963e-26;return this.c=n|0,this.s0=this.s1,this.s1=this.s2,this.s2=n-this.c,this.s2},hash:function(n){var r,o=this.n;n=n.toString();for(var a=0;a<n.length;a++)o+=n.charCodeAt(a),r=.02519603282416938*o,o=r>>>0,r-=o,r*=o,o=r>>>0,r-=o,o+=r*4294967296;return this.n=o,(o>>>0)*23283064365386963e-26},init:function(n){typeof n=="string"?this.state(n):this.sow(n)},sow:function(n){if(this.n=4022871197,this.s0=this.hash(" "),this.s1=this.hash(" "),this.s2=this.hash(" "),this.c=1,!!n)for(var r=0;r<n.length&&n[r]!=null;r++){var o=n[r];this.s0-=this.hash(o),this.s0+=~~(this.s0<0),this.s1-=this.hash(o),this.s1+=~~(this.s1<0),this.s2-=this.hash(o),this.s2+=~~(this.s2<0)}},integer:function(){return this.rnd()*4294967296},frac:function(){return this.rnd()+(this.rnd()*2097152|0)*11102230246251565e-32},real:function(){return this.integer()+this.frac()},integerInRange:function(n,r){return Math.floor(this.realInRange(0,r-n+1)+n)},between:function(n,r){return Math.floor(this.realInRange(0,r-n+1)+n)},realInRange:function(n,r){return this.frac()*(r-n)+n},normal:function(){return 1-2*this.frac()},uuid:function(){var n="",r="";for(r=n="";n++<36;r+=~n%5|n*3&4?(n^15?8^this.frac()*(n^20?16:4):4).toString(16):"-");return r},pick:function(n){return n[this.integerInRange(0,n.length-1)]},sign:function(){return this.pick(this.signs)},weightedPick:function(n){return n[~~(Math.pow(this.frac(),2)*(n.length-.5)+.5)]},timestamp:function(n,r){return this.realInRange(n||9466848e5,r||1577862e6)},angle:function(){return this.integerInRange(-180,180)},rotation:function(){return this.realInRange(-3.1415926,3.1415926)},state:function(n){return typeof n=="string"&&n.match(/^!rnd/)&&(n=n.split(","),this.c=parseFloat(n[1]),this.s0=parseFloat(n[2]),this.s1=parseFloat(n[3]),this.s2=parseFloat(n[4])),["!rnd",this.c,this.s0,this.s1,this.s2].join(",")},shuffle:function(n){for(var r=n.length-1,o=r;o>0;o--){var a=Math.floor(this.frac()*(o+1)),h=n[a];n[a]=n[o],n[o]=h}return n}});t.exports=s}),Ts=S((e,t)=>{"use strict";var i=function(s,n){return Math.floor(Math.random()*(n-s+1)+s)};t.exports=i}),Ky=S((e,t)=>{"use strict";var i=function(s,n,r){return Math.max(s-n,r)};t.exports=i}),Kl=S((e,t)=>{"use strict";var i=he(),s=function(n){return n*i.RAD_TO_DEG};t.exports=s}),jy=S((e,t)=>{"use strict";var i=function(s,n){n===void 0&&(n=1);var r=Math.random()*2*Math.PI;return s.x=Math.cos(r)*n,s.y=Math.sin(r)*n,s};t.exports=i}),wa=S((e,t)=>{"use strict";var i=function(s,n,r,o,a){var h=o+Math.atan2(s.y-r,s.x-n);return s.x=n+a*Math.cos(h),s.y=r+a*Math.sin(h),s};t.exports=i}),jl=S((e,t)=>{"use strict";var i=V(),s=new i({initialize:function(n,r,o){this.x=0,this.y=0,this.z=0,typeof n=="object"?(this.x=n.x||0,this.y=n.y||0,this.z=n.z||0):(this.x=n||0,this.y=r||0,this.z=o||0)},up:function(){return this.x=0,this.y=1,this.z=0,this},min:function(n){return this.x=Math.min(this.x,n.x),this.y=Math.min(this.y,n.y),this.z=Math.min(this.z,n.z),this},max:function(n){return this.x=Math.max(this.x,n.x),this.y=Math.max(this.y,n.y),this.z=Math.max(this.z,n.z),this},clone:function(){return new s(this.x,this.y,this.z)},addVectors:function(n,r){return this.x=n.x+r.x,this.y=n.y+r.y,this.z=n.z+r.z,this},subVectors:function(n,r){return this.x=n.x-r.x,this.y=n.y-r.y,this.z=n.z-r.z,this},crossVectors:function(n,r){var o=n.x,a=n.y,h=n.z,l=r.x,c=r.y,f=r.z;return this.x=a*f-h*c,this.y=h*l-o*f,this.z=o*c-a*l,this},equals:function(n){return this.x===n.x&&this.y===n.y&&this.z===n.z},copy:function(n){return this.x=n.x,this.y=n.y,this.z=n.z||0,this},set:function(n,r,o){return typeof n=="object"?(this.x=n.x||0,this.y=n.y||0,this.z=n.z||0):(this.x=n||0,this.y=r||0,this.z=o||0),this},setFromMatrixPosition:function(n){return this.fromArray(n.val,12)},setFromMatrixColumn:function(n,r){return this.fromArray(n.val,r*4)},fromArray:function(n,r){return r===void 0&&(r=0),this.x=n[r],this.y=n[r+1],this.z=n[r+2],this},add:function(n){return this.x+=n.x,this.y+=n.y,this.z+=n.z||0,this},addScalar:function(n){return this.x+=n,this.y+=n,this.z+=n,this},addScale:function(n,r){return this.x+=n.x*r,this.y+=n.y*r,this.z+=n.z*r||0,this},subtract:function(n){return this.x-=n.x,this.y-=n.y,this.z-=n.z||0,this},multiply:function(n){return this.x*=n.x,this.y*=n.y,this.z*=n.z||1,this},scale:function(n){return isFinite(n)?(this.x*=n,this.y*=n,this.z*=n):(this.x=0,this.y=0,this.z=0),this},divide:function(n){return this.x/=n.x,this.y/=n.y,this.z/=n.z||1,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},distance:function(n){var r=n.x-this.x,o=n.y-this.y,a=n.z-this.z||0;return Math.sqrt(r*r+o*o+a*a)},distanceSq:function(n){var r=n.x-this.x,o=n.y-this.y,a=n.z-this.z||0;return r*r+o*o+a*a},length:function(){var n=this.x,r=this.y,o=this.z;return Math.sqrt(n*n+r*r+o*o)},lengthSq:function(){var n=this.x,r=this.y,o=this.z;return n*n+r*r+o*o},normalize:function(){var n=this.x,r=this.y,o=this.z,a=n*n+r*r+o*o;return a>0&&(a=1/Math.sqrt(a),this.x=n*a,this.y=r*a,this.z=o*a),this},dot:function(n){return this.x*n.x+this.y*n.y+this.z*n.z},cross:function(n){var r=this.x,o=this.y,a=this.z,h=n.x,l=n.y,c=n.z;return this.x=o*c-a*l,this.y=a*h-r*c,this.z=r*l-o*h,this},lerp:function(n,r){r===void 0&&(r=0);var o=this.x,a=this.y,h=this.z;return this.x=o+r*(n.x-o),this.y=a+r*(n.y-a),this.z=h+r*(n.z-h),this},applyMatrix3:function(n){var r=this.x,o=this.y,a=this.z,h=n.val;return this.x=h[0]*r+h[3]*o+h[6]*a,this.y=h[1]*r+h[4]*o+h[7]*a,this.z=h[2]*r+h[5]*o+h[8]*a,this},applyMatrix4:function(n){var r=this.x,o=this.y,a=this.z,h=n.val,l=1/(h[3]*r+h[7]*o+h[11]*a+h[15]);return this.x=(h[0]*r+h[4]*o+h[8]*a+h[12])*l,this.y=(h[1]*r+h[5]*o+h[9]*a+h[13])*l,this.z=(h[2]*r+h[6]*o+h[10]*a+h[14])*l,this},transformMat3:function(n){var r=this.x,o=this.y,a=this.z,h=n.val;return this.x=r*h[0]+o*h[3]+a*h[6],this.y=r*h[1]+o*h[4]+a*h[7],this.z=r*h[2]+o*h[5]+a*h[8],this},transformMat4:function(n){var r=this.x,o=this.y,a=this.z,h=n.val;return this.x=h[0]*r+h[4]*o+h[8]*a+h[12],this.y=h[1]*r+h[5]*o+h[9]*a+h[13],this.z=h[2]*r+h[6]*o+h[10]*a+h[14],this},transformCoordinates:function(n){var r=this.x,o=this.y,a=this.z,h=n.val,l=r*h[0]+o*h[4]+a*h[8]+h[12],c=r*h[1]+o*h[5]+a*h[9]+h[13],f=r*h[2]+o*h[6]+a*h[10]+h[14],u=r*h[3]+o*h[7]+a*h[11]+h[15];return this.x=l/u,this.y=c/u,this.z=f/u,this},transformQuat:function(n){var r=this.x,o=this.y,a=this.z,h=n.x,l=n.y,c=n.z,f=n.w,u=f*r+l*a-c*o,p=f*o+c*r-h*a,d=f*a+h*o-l*r,g=-h*r-l*o-c*a;return this.x=u*f+g*-h+p*-c-d*-l,this.y=p*f+g*-l+d*-h-u*-c,this.z=d*f+g*-c+u*-l-p*-h,this},project:function(n){var r=this.x,o=this.y,a=this.z,h=n.val,l=h[0],c=h[1],f=h[2],u=h[3],p=h[4],d=h[5],g=h[6],m=h[7],E=h[8],v=h[9],y=h[10],T=h[11],A=h[12],x=h[13],_=h[14],b=h[15],M=1/(r*u+o*m+a*T+b);return this.x=(r*l+o*p+a*E+A)*M,this.y=(r*c+o*d+a*v+x)*M,this.z=(r*f+o*g+a*y+_)*M,this},projectViewMatrix:function(n,r){return this.applyMatrix4(n).applyMatrix4(r)},unprojectViewMatrix:function(n,r){return this.applyMatrix4(n).applyMatrix4(r)},unproject:function(n,r){var o=n.x,a=n.y,h=n.z,l=n.w,c=this.x-o,f=l-this.y-1-a,u=this.z;return this.x=2*c/h-1,this.y=2*f/l-1,this.z=2*u-1,this.project(r)},reset:function(){return this.x=0,this.y=0,this.z=0,this}});s.ZERO=new s,s.RIGHT=new s(1,0,0),s.LEFT=new s(-1,0,0),s.UP=new s(0,-1,0),s.DOWN=new s(0,1,0),s.FORWARD=new s(0,0,1),s.BACK=new s(0,0,-1),s.ONE=new s(1,1,1),t.exports=s}),Ra=S((e,t)=>{"use strict";var i=V(),s=jl(),n=1e-6,r=new i({initialize:function(f){this.val=new Float32Array(16),f?this.copy(f):this.identity()},clone:function(){return new r(this)},set:function(f){return this.copy(f)},setValues:function(f,u,p,d,g,m,E,v,y,T,A,x,_,b,M,w){var R=this.val;return R[0]=f,R[1]=u,R[2]=p,R[3]=d,R[4]=g,R[5]=m,R[6]=E,R[7]=v,R[8]=y,R[9]=T,R[10]=A,R[11]=x,R[12]=_,R[13]=b,R[14]=M,R[15]=w,this},copy:function(f){var u=f.val;return this.setValues(u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7],u[8],u[9],u[10],u[11],u[12],u[13],u[14],u[15])},fromArray:function(f){return this.setValues(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8],f[9],f[10],f[11],f[12],f[13],f[14],f[15])},zero:function(){return this.setValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)},transform:function(f,u,p){var d=o.fromQuat(p),g=d.val,m=u.x,E=u.y,v=u.z;return this.setValues(g[0]*m,g[1]*m,g[2]*m,0,g[4]*E,g[5]*E,g[6]*E,0,g[8]*v,g[9]*v,g[10]*v,0,f.x,f.y,f.z,1)},xyz:function(f,u,p){this.identity();var d=this.val;return d[12]=f,d[13]=u,d[14]=p,this},scaling:function(f,u,p){this.zero();var d=this.val;return d[0]=f,d[5]=u,d[10]=p,d[15]=1,this},identity:function(){return this.setValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},transpose:function(){var f=this.val,u=f[1],p=f[2],d=f[3],g=f[6],m=f[7],E=f[11];return f[1]=f[4],f[2]=f[8],f[3]=f[12],f[4]=u,f[6]=f[9],f[7]=f[13],f[8]=p,f[9]=g,f[11]=f[14],f[12]=d,f[13]=m,f[14]=E,this},getInverse:function(f){return this.copy(f),this.invert()},invert:function(){var f=this.val,u=f[0],p=f[1],d=f[2],g=f[3],m=f[4],E=f[5],v=f[6],y=f[7],T=f[8],A=f[9],x=f[10],_=f[11],b=f[12],M=f[13],w=f[14],R=f[15],I=u*E-p*m,O=u*v-d*m,D=u*y-g*m,N=p*v-d*E,F=p*y-g*E,G=d*y-g*v,L=T*M-A*b,C=T*w-x*b,P=T*R-_*b,k=A*w-x*M,B=A*R-_*M,Y=x*R-_*w,H=I*Y-O*B+D*k+N*P-F*C+G*L;return H?(H=1/H,this.setValues((E*Y-v*B+y*k)*H,(d*B-p*Y-g*k)*H,(M*G-w*F+R*N)*H,(x*F-A*G-_*N)*H,(v*P-m*Y-y*C)*H,(u*Y-d*P+g*C)*H,(w*D-b*G-R*O)*H,(T*G-x*D+_*O)*H,(m*B-E*P+y*L)*H,(p*P-u*B-g*L)*H,(b*F-M*D+R*I)*H,(A*D-T*F-_*I)*H,(E*C-m*k-v*L)*H,(u*k-p*C+d*L)*H,(M*O-b*N-w*I)*H,(T*N-A*O+x*I)*H)):this},adjoint:function(){var f=this.val,u=f[0],p=f[1],d=f[2],g=f[3],m=f[4],E=f[5],v=f[6],y=f[7],T=f[8],A=f[9],x=f[10],_=f[11],b=f[12],M=f[13],w=f[14],R=f[15];return this.setValues(E*(x*R-_*w)-A*(v*R-y*w)+M*(v*_-y*x),-(p*(x*R-_*w)-A*(d*R-g*w)+M*(d*_-g*x)),p*(v*R-y*w)-E*(d*R-g*w)+M*(d*y-g*v),-(p*(v*_-y*x)-E*(d*_-g*x)+A*(d*y-g*v)),-(m*(x*R-_*w)-T*(v*R-y*w)+b*(v*_-y*x)),u*(x*R-_*w)-T*(d*R-g*w)+b*(d*_-g*x),-(u*(v*R-y*w)-m*(d*R-g*w)+b*(d*y-g*v)),u*(v*_-y*x)-m*(d*_-g*x)+T*(d*y-g*v),m*(A*R-_*M)-T*(E*R-y*M)+b*(E*_-y*A),-(u*(A*R-_*M)-T*(p*R-g*M)+b*(p*_-g*A)),u*(E*R-y*M)-m*(p*R-g*M)+b*(p*y-g*E),-(u*(E*_-y*A)-m*(p*_-g*A)+T*(p*y-g*E)),-(m*(A*w-x*M)-T*(E*w-v*M)+b*(E*x-v*A)),u*(A*w-x*M)-T*(p*w-d*M)+b*(p*x-d*A),-(u*(E*w-v*M)-m*(p*w-d*M)+b*(p*v-d*E)),u*(E*x-v*A)-m*(p*x-d*A)+T*(p*v-d*E))},determinant:function(){var f=this.val,u=f[0],p=f[1],d=f[2],g=f[3],m=f[4],E=f[5],v=f[6],y=f[7],T=f[8],A=f[9],x=f[10],_=f[11],b=f[12],M=f[13],w=f[14],R=f[15],I=u*E-p*m,O=u*v-d*m,D=u*y-g*m,N=p*v-d*E,F=p*y-g*E,G=d*y-g*v,L=T*M-A*b,C=T*w-x*b,P=T*R-_*b,k=A*w-x*M,B=A*R-_*M,Y=x*R-_*w;return I*Y-O*B+D*k+N*P-F*C+G*L},multiply:function(f){var u=this.val,p=u[0],d=u[1],g=u[2],m=u[3],E=u[4],v=u[5],y=u[6],T=u[7],A=u[8],x=u[9],_=u[10],b=u[11],M=u[12],w=u[13],R=u[14],I=u[15],O=f.val,D=O[0],N=O[1],F=O[2],G=O[3];return u[0]=D*p+N*E+F*A+G*M,u[1]=D*d+N*v+F*x+G*w,u[2]=D*g+N*y+F*_+G*R,u[3]=D*m+N*T+F*b+G*I,D=O[4],N=O[5],F=O[6],G=O[7],u[4]=D*p+N*E+F*A+G*M,u[5]=D*d+N*v+F*x+G*w,u[6]=D*g+N*y+F*_+G*R,u[7]=D*m+N*T+F*b+G*I,D=O[8],N=O[9],F=O[10],G=O[11],u[8]=D*p+N*E+F*A+G*M,u[9]=D*d+N*v+F*x+G*w,u[10]=D*g+N*y+F*_+G*R,u[11]=D*m+N*T+F*b+G*I,D=O[12],N=O[13],F=O[14],G=O[15],u[12]=D*p+N*E+F*A+G*M,u[13]=D*d+N*v+F*x+G*w,u[14]=D*g+N*y+F*_+G*R,u[15]=D*m+N*T+F*b+G*I,this},multiplyLocal:function(f){var u=this.val,p=f.val;return this.setValues(u[0]*p[0]+u[1]*p[4]+u[2]*p[8]+u[3]*p[12],u[0]*p[1]+u[1]*p[5]+u[2]*p[9]+u[3]*p[13],u[0]*p[2]+u[1]*p[6]+u[2]*p[10]+u[3]*p[14],u[0]*p[3]+u[1]*p[7]+u[2]*p[11]+u[3]*p[15],u[4]*p[0]+u[5]*p[4]+u[6]*p[8]+u[7]*p[12],u[4]*p[1]+u[5]*p[5]+u[6]*p[9]+u[7]*p[13],u[4]*p[2]+u[5]*p[6]+u[6]*p[10]+u[7]*p[14],u[4]*p[3]+u[5]*p[7]+u[6]*p[11]+u[7]*p[15],u[8]*p[0]+u[9]*p[4]+u[10]*p[8]+u[11]*p[12],u[8]*p[1]+u[9]*p[5]+u[10]*p[9]+u[11]*p[13],u[8]*p[2]+u[9]*p[6]+u[10]*p[10]+u[11]*p[14],u[8]*p[3]+u[9]*p[7]+u[10]*p[11]+u[11]*p[15],u[12]*p[0]+u[13]*p[4]+u[14]*p[8]+u[15]*p[12],u[12]*p[1]+u[13]*p[5]+u[14]*p[9]+u[15]*p[13],u[12]*p[2]+u[13]*p[6]+u[14]*p[10]+u[15]*p[14],u[12]*p[3]+u[13]*p[7]+u[14]*p[11]+u[15]*p[15])},premultiply:function(f){return this.multiplyMatrices(f,this)},multiplyMatrices:function(f,u){var p=f.val,d=u.val,g=p[0],m=p[4],E=p[8],v=p[12],y=p[1],T=p[5],A=p[9],x=p[13],_=p[2],b=p[6],M=p[10],w=p[14],R=p[3],I=p[7],O=p[11],D=p[15],N=d[0],F=d[4],G=d[8],L=d[12],C=d[1],P=d[5],k=d[9],B=d[13],Y=d[2],H=d[6],z=d[10],K=d[14],X=d[3],et=d[7],J=d[11],st=d[15];return this.setValues(g*N+m*C+E*Y+v*X,y*N+T*C+A*Y+x*X,_*N+b*C+M*Y+w*X,R*N+I*C+O*Y+D*X,g*F+m*P+E*H+v*et,y*F+T*P+A*H+x*et,_*F+b*P+M*H+w*et,R*F+I*P+O*H+D*et,g*G+m*k+E*z+v*J,y*G+T*k+A*z+x*J,_*G+b*k+M*z+w*J,R*G+I*k+O*z+D*J,g*L+m*B+E*K+v*st,y*L+T*B+A*K+x*st,_*L+b*B+M*K+w*st,R*L+I*B+O*K+D*st)},translate:function(f){return this.translateXYZ(f.x,f.y,f.z)},translateXYZ:function(f,u,p){var d=this.val;return d[12]=d[0]*f+d[4]*u+d[8]*p+d[12],d[13]=d[1]*f+d[5]*u+d[9]*p+d[13],d[14]=d[2]*f+d[6]*u+d[10]*p+d[14],d[15]=d[3]*f+d[7]*u+d[11]*p+d[15],this},scale:function(f){return this.scaleXYZ(f.x,f.y,f.z)},scaleXYZ:function(f,u,p){var d=this.val;return d[0]=d[0]*f,d[1]=d[1]*f,d[2]=d[2]*f,d[3]=d[3]*f,d[4]=d[4]*u,d[5]=d[5]*u,d[6]=d[6]*u,d[7]=d[7]*u,d[8]=d[8]*p,d[9]=d[9]*p,d[10]=d[10]*p,d[11]=d[11]*p,this},makeRotationAxis:function(f,u){var p=Math.cos(u),d=Math.sin(u),g=1-p,m=f.x,E=f.y,v=f.z,y=g*m,T=g*E;return this.setValues(y*m+p,y*E-d*v,y*v+d*E,0,y*E+d*v,T*E+p,T*v-d*m,0,y*v-d*E,T*v+d*m,g*v*v+p,0,0,0,0,1)},rotate:function(f,u){var p=this.val,d=u.x,g=u.y,m=u.z,E=Math.sqrt(d*d+g*g+m*m);if(Math.abs(E)<n)return this;E=1/E,d*=E,g*=E,m*=E;var v=Math.sin(f),y=Math.cos(f),T=1-y,A=p[0],x=p[1],_=p[2],b=p[3],M=p[4],w=p[5],R=p[6],I=p[7],O=p[8],D=p[9],N=p[10],F=p[11],G=p[12],L=p[13],C=p[14],P=p[15],k=d*d*T+y,B=g*d*T+m*v,Y=m*d*T-g*v,H=d*g*T-m*v,z=g*g*T+y,K=m*g*T+d*v,X=d*m*T+g*v,et=g*m*T-d*v,J=m*m*T+y;return this.setValues(A*k+M*B+O*Y,x*k+w*B+D*Y,_*k+R*B+N*Y,b*k+I*B+F*Y,A*H+M*z+O*K,x*H+w*z+D*K,_*H+R*z+N*K,b*H+I*z+F*K,A*X+M*et+O*J,x*X+w*et+D*J,_*X+R*et+N*J,b*X+I*et+F*J,G,L,C,P)},rotateX:function(f){var u=this.val,p=Math.sin(f),d=Math.cos(f),g=u[4],m=u[5],E=u[6],v=u[7],y=u[8],T=u[9],A=u[10],x=u[11];return u[4]=g*d+y*p,u[5]=m*d+T*p,u[6]=E*d+A*p,u[7]=v*d+x*p,u[8]=y*d-g*p,u[9]=T*d-m*p,u[10]=A*d-E*p,u[11]=x*d-v*p,this},rotateY:function(f){var u=this.val,p=Math.sin(f),d=Math.cos(f),g=u[0],m=u[1],E=u[2],v=u[3],y=u[8],T=u[9],A=u[10],x=u[11];return u[0]=g*d-y*p,u[1]=m*d-T*p,u[2]=E*d-A*p,u[3]=v*d-x*p,u[8]=g*p+y*d,u[9]=m*p+T*d,u[10]=E*p+A*d,u[11]=v*p+x*d,this},rotateZ:function(f){var u=this.val,p=Math.sin(f),d=Math.cos(f),g=u[0],m=u[1],E=u[2],v=u[3],y=u[4],T=u[5],A=u[6],x=u[7];return u[0]=g*d+y*p,u[1]=m*d+T*p,u[2]=E*d+A*p,u[3]=v*d+x*p,u[4]=y*d-g*p,u[5]=T*d-m*p,u[6]=A*d-E*p,u[7]=x*d-v*p,this},fromRotationTranslation:function(f,u){var p=f.x,d=f.y,g=f.z,m=f.w,E=p+p,v=d+d,y=g+g,T=p*E,A=p*v,x=p*y,_=d*v,b=d*y,M=g*y,w=m*E,R=m*v,I=m*y;return this.setValues(1-(_+M),A+I,x-R,0,A-I,1-(T+M),b+w,0,x+R,b-w,1-(T+_),0,u.x,u.y,u.z,1)},fromQuat:function(f){var u=f.x,p=f.y,d=f.z,g=f.w,m=u+u,E=p+p,v=d+d,y=u*m,T=u*E,A=u*v,x=p*E,_=p*v,b=d*v,M=g*m,w=g*E,R=g*v;return this.setValues(1-(x+b),T+R,A-w,0,T-R,1-(y+b),_+M,0,A+w,_-M,1-(y+x),0,0,0,0,1)},frustum:function(f,u,p,d,g,m){var E=1/(u-f),v=1/(d-p),y=1/(g-m);return this.setValues(g*2*E,0,0,0,0,g*2*v,0,0,(u+f)*E,(d+p)*v,(m+g)*y,-1,0,0,m*g*2*y,0)},perspective:function(f,u,p,d){var g=1/Math.tan(f/2),m=1/(p-d);return this.setValues(g/u,0,0,0,0,g,0,0,0,0,(d+p)*m,-1,0,0,2*d*p*m,0)},perspectiveLH:function(f,u,p,d){return this.setValues(2*p/f,0,0,0,0,2*p/u,0,0,0,0,-d/(p-d),1,0,0,p*d/(p-d),0)},ortho:function(f,u,p,d,g,m){var E=f-u,v=p-d,y=g-m;return E=E===0?E:1/E,v=v===0?v:1/v,y=y===0?y:1/y,this.setValues(-2*E,0,0,0,0,-2*v,0,0,0,0,2*y,0,(f+u)*E,(d+p)*v,(m+g)*y,1)},lookAtRH:function(f,u,p){var d=this.val;return c.subVectors(f,u),c.lengthSq()===0&&(c.z=1),c.normalize(),h.crossVectors(p,c),h.lengthSq()===0&&(Math.abs(p.z)===1?c.x+=1e-4:c.z+=1e-4,c.normalize(),h.crossVectors(p,c)),h.normalize(),l.crossVectors(c,h),d[0]=h.x,d[1]=h.y,d[2]=h.z,d[4]=l.x,d[5]=l.y,d[6]=l.z,d[8]=c.x,d[9]=c.y,d[10]=c.z,this},lookAt:function(f,u,p){var d=f.x,g=f.y,m=f.z,E=p.x,v=p.y,y=p.z,T=u.x,A=u.y,x=u.z;if(Math.abs(d-T)<n&&Math.abs(g-A)<n&&Math.abs(m-x)<n)return this.identity();var _=d-T,b=g-A,M=m-x,w=1/Math.sqrt(_*_+b*b+M*M);_*=w,b*=w,M*=w;var R=v*M-y*b,I=y*_-E*M,O=E*b-v*_;w=Math.sqrt(R*R+I*I+O*O),w?(w=1/w,R*=w,I*=w,O*=w):(R=0,I=0,O=0);var D=b*O-M*I,N=M*R-_*O,F=_*I-b*R;return w=Math.sqrt(D*D+N*N+F*F),w?(w=1/w,D*=w,N*=w,F*=w):(D=0,N=0,F=0),this.setValues(R,D,_,0,I,N,b,0,O,F,M,0,-(R*d+I*g+O*m),-(D*d+N*g+F*m),-(_*d+b*g+M*m),1)},yawPitchRoll:function(f,u,p){this.zero(),o.zero(),a.zero();var d=this.val,g=o.val,m=a.val,E=Math.sin(p),v=Math.cos(p);return d[10]=1,d[15]=1,d[0]=v,d[1]=E,d[4]=-E,d[5]=v,E=Math.sin(u),v=Math.cos(u),g[0]=1,g[15]=1,g[5]=v,g[10]=v,g[9]=-E,g[6]=E,E=Math.sin(f),v=Math.cos(f),m[5]=1,m[15]=1,m[0]=v,m[2]=-E,m[8]=E,m[10]=v,this.multiplyLocal(o),this.multiplyLocal(a),this},setWorldMatrix:function(f,u,p,d,g){return this.yawPitchRoll(f.y,f.x,f.z),o.scaling(p.x,p.y,p.z),a.xyz(u.x,u.y,u.z),this.multiplyLocal(o),this.multiplyLocal(a),d&&this.multiplyLocal(d),g&&this.multiplyLocal(g),this},multiplyToMat4:function(f,u){var p=this.val,d=f.val,g=p[0],m=p[1],E=p[2],v=p[3],y=p[4],T=p[5],A=p[6],x=p[7],_=p[8],b=p[9],M=p[10],w=p[11],R=p[12],I=p[13],O=p[14],D=p[15],N=d[0],F=d[1],G=d[2],L=d[3],C=d[4],P=d[5],k=d[6],B=d[7],Y=d[8],H=d[9],z=d[10],K=d[11],X=d[12],et=d[13],J=d[14],st=d[15];return u.setValues(N*g+F*y+G*_+L*R,F*m+F*T+G*b+L*I,G*E+F*A+G*M+L*O,L*v+F*x+G*w+L*D,C*g+P*y+k*_+B*R,C*m+P*T+k*b+B*I,C*E+P*A+k*M+B*O,C*v+P*x+k*w+B*D,Y*g+H*y+z*_+K*R,Y*m+H*T+z*b+K*I,Y*E+H*A+z*M+K*O,Y*v+H*x+z*w+K*D,X*g+et*y+J*_+st*R,X*m+et*T+J*b+st*I,X*E+et*A+J*M+st*O,X*v+et*x+J*w+st*D)},fromRotationXYTranslation:function(f,u,p){var d=u.x,g=u.y,m=u.z,E=Math.sin(f.x),v=Math.cos(f.x),y=Math.sin(f.y),T=Math.cos(f.y),A=d,x=g,_=m,b=-E,M=0-b*y,w=0-v*y,R=b*T,I=v*T;return p||(A=T*d+y*m,x=M*d+v*g+R*m,_=w*d+E*g+I*m),this.setValues(T,M,w,0,0,v,E,0,y,R,I,0,A,x,_,1)},getMaxScaleOnAxis:function(){var f=this.val,u=f[0]*f[0]+f[1]*f[1]+f[2]*f[2],p=f[4]*f[4]+f[5]*f[5]+f[6]*f[6],d=f[8]*f[8]+f[9]*f[9]+f[10]*f[10];return Math.sqrt(Math.max(u,p,d))}}),o=new r,a=new r,h=new s,l=new s,c=new s;t.exports=r}),yt=S((e,t)=>{"use strict";var i=he(),s=Re(),n={Angle:ky(),Distance:Yy(),Easing:ft(),Interpolation:Vy(),RandomDataGenerator:Xy(),Between:Ts(),Clamp:Xt(),DegToRad:an(),FloatBetween:on(),Linear:Vn(),MinSub:Ky(),RadToDeg:Kl(),RandomXY:jy(),RotateAroundDistance:wa(),Vector2:Ot(),Matrix4:Ra()};n=s(!1,n,i),t.exports=n}),Ee=S((e,t)=>{"use strict";var i=yt(),s=Mt(),n=function(r,o,a){var h=s(r,o,null);if(h===null)return a;if(Array.isArray(h))return i.RND.pick(h);if(typeof h=="object"){if(h.hasOwnProperty("randInt"))return i.RND.integerInRange(h.randInt[0],h.randInt[1]);if(h.hasOwnProperty("randFloat"))return i.RND.realInRange(h.randFloat[0],h.randFloat[1])}else if(typeof h=="function")return h(o);return h};t.exports=n}),Ki=S((e,t)=>{"use strict";var i=ms(),s=Ee(),n=function(r,o,a){o.x=s(a,"x",0),o.y=s(a,"y",0),o.depth=s(a,"depth",0),o.flipX=s(a,"flipX",!1),o.flipY=s(a,"flipY",!1);var h=s(a,"scale",null);typeof h=="number"?o.setScale(h):h!==null&&(o.scaleX=s(h,"x",1),o.scaleY=s(h,"y",1));var l=s(a,"scrollFactor",null);typeof l=="number"?o.setScrollFactor(l):l!==null&&(o.scrollFactorX=s(l,"x",1),o.scrollFactorY=s(l,"y",1)),o.rotation=s(a,"rotation",0);var c=s(a,"angle",null);c!==null&&(o.angle=c),o.alpha=s(a,"alpha",1);var f=s(a,"origin",null);if(typeof f=="number")o.setOrigin(f);else if(f!==null){var u=s(f,"x",.5),p=s(f,"y",.5);o.setOrigin(u,p)}o.blendMode=s(a,"blendMode",i.NORMAL),o.visible=s(a,"visible",!0);var d=s(a,"add",!0);return d&&r.sys.displayList.add(o),o.preUpdate&&r.sys.updateList.add(o),o};t.exports=n}),Fe=S((e,t)=>{"use strict";var i=V(),s=fa(),n=jn(),r=Wt(),o=Vi(),a=Nt(),h=new i({Extends:r,initialize:function(l,c){r.call(this),this.scene=l,this.displayList=null,this.type=c,this.state=0,this.parentContainer=null,this.name="",this.active=!0,this.tabIndex=-1,this.data=null,this.renderFlags=15,this.cameraFilter=0,this.input=null,this.body=null,this.ignoreDestroy=!1,this.on(o.ADDED_TO_SCENE,this.addedToScene,this),this.on(o.REMOVED_FROM_SCENE,this.removedFromScene,this),l.sys.queueDepthSort()},setActive:function(l){return this.active=l,this},setName:function(l){return this.name=l,this},setState:function(l){return this.state=l,this},setDataEnabled:function(){return this.data||(this.data=new n(this)),this},setData:function(l,c){return this.data||(this.data=new n(this)),this.data.set(l,c),this},incData:function(l,c){return this.data||(this.data=new n(this)),this.data.inc(l,c),this},toggleData:function(l){return this.data||(this.data=new n(this)),this.data.toggle(l),this},getData:function(l){return this.data||(this.data=new n(this)),this.data.get(l)},setInteractive:function(l,c,f){return this.scene.sys.input.enable(this,l,c,f),this},disableInteractive:function(l){return l===void 0&&(l=!1),this.scene.sys.input.disable(this,l),this},removeInteractive:function(l){return l===void 0&&(l=!1),this.scene.sys.input.clear(this),l&&this.scene.sys.input.resetCursor(),this.input=void 0,this},addedToScene:function(){},removedFromScene:function(){},update:function(){},toJSON:function(){return s(this)},willRender:function(l){var c=this.displayList&&this.displayList.active?this.displayList.willRender(l):!0;return!(!c||h.RENDER_MASK!==this.renderFlags||this.cameraFilter!==0&&this.cameraFilter&l.id)},getIndexList:function(){for(var l=this,c=this.parentContainer,f=[];c&&(f.unshift(c.getIndex(l)),l=c,c.parentContainer);)c=c.parentContainer;return this.displayList?f.unshift(this.displayList.getIndex(l)):f.unshift(this.scene.sys.displayList.getIndex(l)),f},addToDisplayList:function(l){return l===void 0&&(l=this.scene.sys.displayList),this.displayList&&this.displayList!==l&&this.removeFromDisplayList(),l.exists(this)||(this.displayList=l,l.add(this,!0),l.queueDepthSort(),this.emit(o.ADDED_TO_SCENE,this,this.scene),l.events.emit(a.ADDED_TO_SCENE,this,this.scene)),this},addToUpdateList:function(){return this.scene&&this.preUpdate&&this.scene.sys.updateList.add(this),this},removeFromDisplayList:function(){var l=this.displayList||this.scene.sys.displayList;return l&&l.exists(this)&&(l.remove(this,!0),l.queueDepthSort(),this.displayList=null,this.emit(o.REMOVED_FROM_SCENE,this,this.scene),l.events.emit(a.REMOVED_FROM_SCENE,this,this.scene)),this},removeFromUpdateList:function(){return this.scene&&this.preUpdate&&this.scene.sys.updateList.remove(this),this},getDisplayList:function(){var l=null;return this.parentContainer?l=this.parentContainer.list:this.displayList&&(l=this.displayList.list),l},destroy:function(l){!this.scene||this.ignoreDestroy||(l===void 0&&(l=!1),this.preDestroy&&this.preDestroy.call(this),this.emit(o.DESTROY,this,l),this.removeAllListeners(),this.postPipelines&&this.resetPostPipeline(!0),this.removeFromDisplayList(),this.removeFromUpdateList(),this.input&&(this.scene.sys.input.clear(this),this.input=void 0),this.data&&(this.data.destroy(),this.data=void 0),this.body&&(this.body.destroy(),this.body=void 0),this.preFX&&(this.preFX.destroy(),this.preFX=void 0),this.postFX&&(this.postFX.destroy(),this.postFX=void 0),this.active=!1,this.visible=!1,this.scene=void 0,this.parentContainer=void 0)}});h.RENDER_MASK=15,t.exports=h}),Zy=S((e,t)=>{"use strict";var i=function(s,n,r,o){r.addToRenderList(n);var a=n.list,h=a.length;if(h!==0){var l=n.localTransform;o?(l.loadIdentity(),l.multiply(o),l.translate(n.x,n.y),l.rotate(n.rotation),l.scale(n.scaleX,n.scaleY)):l.applyITRS(n.x,n.y,n.rotation,n.scaleX,n.scaleY),s.pipelines.preBatch(n);var c=n.blendMode!==-1;c||s.setBlendMode(0);for(var f=n.alpha,u=n.scrollFactorX,p=n.scrollFactorY,d=0;d<h;d++){var g=a[d];if(g.willRender(r)){var m,E,v,y;if(g.alphaTopLeft!==void 0)m=g.alphaTopLeft,E=g.alphaTopRight,v=g.alphaBottomLeft,y=g.alphaBottomRight;else{var T=g.alpha;m=T,E=T,v=T,y=T}var A=g.scrollFactorX,x=g.scrollFactorY;!c&&g.blendMode!==s.currentBlendMode&&s.setBlendMode(g.blendMode);var _=g.mask;_&&_.preRenderWebGL(s,g,r);var b=g.type;b!==s.currentType&&(s.newType=!0,s.currentType=b),s.nextTypeMatch=d<h-1?a[d+1].type===s.currentType:!1,g.setScrollFactor(A*u,x*p),g.setAlpha(m*f,E*f,v*f,y*f),g.renderWebGL(s,g,r,l,n),g.setAlpha(m,E,v,y),g.setScrollFactor(A,x),_&&_.postRenderWebGL(s,r),s.newType=!1}}s.pipelines.postBatch(n)}};t.exports=i}),qy=S((e,t)=>{"use strict";var i=Lt(),s=i,n=i;s=Zy(),t.exports={renderWebGL:s,renderCanvas:n}}),Zl=S((e,t)=>{"use strict";var i=zt(),s=function(n,r,o){o===void 0&&(o=new i);var a=Math.min(n.x,r.x),h=Math.min(n.y,r.y),l=Math.max(n.right,r.right)-a,c=Math.max(n.bottom,r.bottom)-h;return o.setTo(a,h,l,c)};t.exports=s}),Ca=S((e,t)=>{"use strict";var i=ua(),s=ms(),n=V(),r=me(),o=Vi(),a=Fe(),h=zt(),l=qy(),c=Zl(),f=Ot(),u=new r.TransformMatrix,p=new n({Extends:a,Mixins:[r.AlphaSingle,r.BlendMode,r.ComputedSize,r.Depth,r.Mask,r.PostPipeline,r.Transform,r.Visible,l],initialize:function(d,g,m,E){a.call(this,d,"Container"),this.list=[],this.exclusive=!0,this.maxSize=-1,this.position=0,this.localTransform=new r.TransformMatrix,this._sortKey="",this._sysEvents=d.sys.events,this.scrollFactorX=1,this.scrollFactorY=1,this.initPostPipeline(),this.setPosition(g,m),this.setBlendMode(s.SKIP_CHECK),E&&this.add(E)},originX:{get:function(){return .5}},originY:{get:function(){return .5}},displayOriginX:{get:function(){return this.width*.5}},displayOriginY:{get:function(){return this.height*.5}},setExclusive:function(d){return d===void 0&&(d=!0),this.exclusive=d,this},getBounds:function(d){if(d===void 0&&(d=new h),d.setTo(this.x,this.y,0,0),this.parentContainer){var g=this.parentContainer.getBoundsTransformMatrix(),m=g.transformPoint(this.x,this.y);d.setTo(m.x,m.y,0,0)}if(this.list.length>0){var E=this.list,v=new h,y=!1;d.setEmpty();for(var T=0;T<E.length;T++){var A=E[T];A.getBounds&&(A.getBounds(v),y?c(v,d,d):(d.setTo(v.x,v.y,v.width,v.height),y=!0))}}return d},addHandler:function(d){d.once(o.DESTROY,this.onChildDestroyed,this),this.exclusive&&(d.parentContainer&&d.parentContainer.remove(d),d.parentContainer=this,d.removeFromDisplayList(),d.addedToScene())},removeHandler:function(d){d.off(o.DESTROY,this.remove,this),this.exclusive&&(d.parentContainer=null,d.removedFromScene(),d.addToDisplayList())},pointToContainer:function(d,g){g===void 0&&(g=new f),this.parentContainer?this.parentContainer.pointToContainer(d,g):(g.x=d.x,g.y=d.y);var m=u;return m.applyITRS(this.x,this.y,this.rotation,this.scaleX,this.scaleY),m.invert(),m.transformPoint(d.x,d.y,g),g},getBoundsTransformMatrix:function(){return this.getWorldTransformMatrix(u,this.localTransform)},add:function(d){return i.Add(this.list,d,this.maxSize,this.addHandler,this),this},addAt:function(d,g){return i.AddAt(this.list,d,g,this.maxSize,this.addHandler,this),this},getAt:function(d){return this.list[d]},getIndex:function(d){return this.list.indexOf(d)},sort:function(d,g){return d?(g===void 0&&(g=function(m,E){return m[d]-E[d]}),i.StableSort(this.list,g),this):this},getByName:function(d){return i.GetFirst(this.list,"name",d)},getRandom:function(d,g){return i.GetRandom(this.list,d,g)},getFirst:function(d,g,m,E){return i.GetFirst(this.list,d,g,m,E)},getAll:function(d,g,m,E){return i.GetAll(this.list,d,g,m,E)},count:function(d,g,m,E){return i.CountAllMatching(this.list,d,g,m,E)},swap:function(d,g){return i.Swap(this.list,d,g),this},moveTo:function(d,g){return i.MoveTo(this.list,d,g),this},moveAbove:function(d,g){return i.MoveAbove(this.list,d,g),this},moveBelow:function(d,g){return i.MoveBelow(this.list,d,g),this},remove:function(d,g){var m=i.Remove(this.list,d,this.removeHandler,this);if(g&&m){Array.isArray(m)||(m=[m]);for(var E=0;E<m.length;E++)m[E].destroy()}return this},removeAt:function(d,g){var m=i.RemoveAt(this.list,d,this.removeHandler,this);return g&&m&&m.destroy(),this},removeBetween:function(d,g,m){var E=i.RemoveBetween(this.list,d,g,this.removeHandler,this);if(m)for(var v=0;v<E.length;v++)E[v].destroy();return this},removeAll:function(d){var g=this.list;if(d){for(var m=0;m<g.length;m++)g[m]&&g[m].scene&&(g[m].off(o.DESTROY,this.onChildDestroyed,this),g[m].destroy());this.list=[]}else i.RemoveBetween(g,0,g.length,this.removeHandler,this);return this},bringToTop:function(d){return i.BringToTop(this.list,d),this},sendToBack:function(d){return i.SendToBack(this.list,d),this},moveUp:function(d){return i.MoveUp(this.list,d),this},moveDown:function(d){return i.MoveDown(this.list,d),this},reverse:function(){return this.list.reverse(),this},shuffle:function(){return i.Shuffle(this.list),this},replace:function(d,g,m){var E=i.Replace(this.list,d,g);return E&&(this.addHandler(g),this.removeHandler(d),m&&d.destroy()),this},exists:function(d){return this.list.indexOf(d)>-1},setAll:function(d,g,m,E){return i.SetAll(this.list,d,g,m,E),this},each:function(d,g){var m=[null],E,v=this.list.slice(),y=v.length;for(E=2;E<arguments.length;E++)m.push(arguments[E]);for(E=0;E<y;E++)m[0]=v[E],d.apply(g,m);return this},iterate:function(d,g){var m=[null],E;for(E=2;E<arguments.length;E++)m.push(arguments[E]);for(E=0;E<this.list.length;E++)m[0]=this.list[E],d.apply(g,m);return this},setScrollFactor:function(d,g,m){return g===void 0&&(g=d),m===void 0&&(m=!1),this.scrollFactorX=d,this.scrollFactorY=g,m&&(i.SetAll(this.list,"scrollFactorX",d),i.SetAll(this.list,"scrollFactorY",g)),this},length:{get:function(){return this.list.length}},first:{get:function(){return this.position=0,this.list.length>0?this.list[0]:null}},last:{get:function(){return this.list.length>0?(this.position=this.list.length-1,this.list[this.position]):null}},next:{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}},previous:{get:function(){return this.position>0?(this.position--,this.list[this.position]):null}},preDestroy:function(){this.removeAll(!!this.exclusive),this.localTransform.destroy(),this.list=[]},onChildDestroyed:function(d){i.Remove(this.list,d),this.exclusive&&(d.parentContainer=null,d.removedFromScene())}});t.exports=p}),Qy=S((e,t)=>{"use strict";var i=Xi(),s=function(n,r,o,a){n.pipelines.clear();var h=i(r,o,a).calc;r.render.call(r,n,o,h),n.pipelines.rebind()};t.exports=s}),Jy=S((e,t)=>{"use strict";var i=Lt(),s=i,n=i;s=Qy(),t.exports={renderWebGL:s,renderCanvas:n}}),ql=S((e,t)=>{"use strict";var i=V(),s=me(),n=Fe(),r=Jy(),o=new i({Extends:n,Mixins:[s.Alpha,s.BlendMode,s.Depth,s.Flip,s.Origin,s.ScrollFactor,s.Size,s.Texture,s.Tint,s.Transform,s.Visible,r],initialize:function(a){n.call(this,a,"Extern")},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},preUpdate:function(){},render:function(){}});t.exports=o}),_a=S((e,t)=>{"use strict";t.exports={ARC:0,BEGIN_PATH:1,CLOSE_PATH:2,FILL_RECT:3,LINE_TO:4,MOVE_TO:5,LINE_STYLE:6,FILL_STYLE:7,FILL_PATH:8,STROKE_PATH:9,FILL_TRIANGLE:10,STROKE_TRIANGLE:11,SAVE:14,RESTORE:15,TRANSLATE:16,SCALE:17,ROTATE:18,GRADIENT_FILL_STYLE:21,GRADIENT_LINE_STYLE:22}}),_e=S((e,t)=>{"use strict";t.exports={getTintFromFloats:function(i,s,n,r){var o=(i*255|0)&255,a=(s*255|0)&255,h=(n*255|0)&255,l=(r*255|0)&255;return(l<<24|o<<16|a<<8|h)>>>0},getTintAppendFloatAlpha:function(i,s){var n=(s*255|0)&255;return(n<<24|i)>>>0},getTintAppendFloatAlphaAndSwap:function(i,s){var n=(i>>16|0)&255,r=(i>>8|0)&255,o=(i|0)&255,a=(s*255|0)&255;return(a<<24|o<<16|r<<8|n)>>>0},getFloatsFromUintRGB:function(i){var s=(i>>16|0)&255,n=(i>>8|0)&255,r=(i|0)&255;return[s/255,n/255,r/255]},checkShaderMax:function(i,s){var n=Math.min(16,i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS));return!s||s===-1?n:Math.min(n,s)},parseFragmentShaderMaxTextures:function(i,s){if(!i)return"";for(var n="",r=0;r<s;r++)r>0&&(n+=`
	else `),r<s-1&&(n+="if (outTexId < "+r+".5)"),n+=`
	{`,n+=`
		texture = texture2D(uMainSampler[`+r+"], outTexCoord);",n+=`
	}`;return i=i.replace(/%count%/gi,s.toString()),i.replace(/%forloop%/gi,n)},setGlowQuality:function(i,s,n,r){return n===void 0&&(n=s.config.glowFXQuality),r===void 0&&(r=s.config.glowFXDistance),i=i.replace(/__SIZE__/gi,(1/n/r).toFixed(7)),i=i.replace(/__DIST__/gi,r.toFixed(0)+".0"),i}}}),$y=S((e,t)=>{"use strict";var i=_a(),s=Xi(),n=ui(),r=_e(),o=function(f,u,p){this.x=f,this.y=u,this.width=p},a=function(f,u,p){this.points=[],this.pointsLength=1,this.points[0]=new o(f,u,p)},h=[],l=new n,c=function(f,u,p,d){if(u.commandBuffer.length!==0){p.addToRenderList(u);var g=f.pipelines.set(u.pipeline,u);f.pipelines.preBatch(u);for(var m=s(u,p,d).calc,E=l.loadIdentity(),v=u.commandBuffer,y=p.alpha*u.alpha,T=1,A=g.fillTint,x=g.strokeTint,_=0,b=0,M=0,w=.01,R=Math.PI*2,I,O=[],D=0,N=!0,F=null,G=r.getTintAppendFloatAlpha,L=0;L<v.length;L++)switch(I=v[L],I){case i.BEGIN_PATH:{O.length=0,F=null,N=!0;break}case i.CLOSE_PATH:{N=!1,F&&F.points.length&&F.points.push(F.points[0]);break}case i.FILL_PATH:{for(D=0;D<O.length;D++)g.batchFillPath(O[D].points,E,m);break}case i.STROKE_PATH:{for(D=0;D<O.length;D++)g.batchStrokePath(O[D].points,T,N,E,m);break}case i.LINE_STYLE:{T=v[++L];var C=v[++L],P=v[++L]*y,k=G(C,P);x.TL=k,x.TR=k,x.BL=k,x.BR=k;break}case i.FILL_STYLE:{var B=v[++L],Y=v[++L]*y,H=G(B,Y);A.TL=H,A.TR=H,A.BL=H,A.BR=H;break}case i.GRADIENT_FILL_STYLE:{var z=v[++L]*y,K=v[++L]*y,X=v[++L]*y,et=v[++L]*y;A.TL=G(v[++L],z),A.TR=G(v[++L],K),A.BL=G(v[++L],X),A.BR=G(v[++L],et);break}case i.GRADIENT_LINE_STYLE:{T=v[++L];var J=v[++L]*y;x.TL=G(v[++L],J),x.TR=G(v[++L],J),x.BL=G(v[++L],J),x.BR=G(v[++L],J);break}case i.ARC:{var st=0,q=v[++L],ht=v[++L],Pt=v[++L],Bt=v[++L],Ct=v[++L],Vt=v[++L],lt=v[++L];for(Ct-=Bt,Vt?Ct<-R?Ct=-R:Ct>0&&(Ct=-R+Ct%R):Ct>R?Ct=R:Ct<0&&(Ct=R+Ct%R),F===null&&(F=new a(q+Math.cos(Bt)*Pt,ht+Math.sin(Bt)*Pt,T),O.push(F),st+=w);st<1+lt;)M=Ct*st+Bt,_=q+Math.cos(M)*Pt,b=ht+Math.sin(M)*Pt,F.points.push(new o(_,b,T)),st+=w;M=Ct+Bt,_=q+Math.cos(M)*Pt,b=ht+Math.sin(M)*Pt,F.points.push(new o(_,b,T));break}case i.FILL_RECT:{g.batchFillRect(v[++L],v[++L],v[++L],v[++L],E,m);break}case i.FILL_TRIANGLE:{g.batchFillTriangle(v[++L],v[++L],v[++L],v[++L],v[++L],v[++L],E,m);break}case i.STROKE_TRIANGLE:{g.batchStrokeTriangle(v[++L],v[++L],v[++L],v[++L],v[++L],v[++L],T,E,m);break}case i.LINE_TO:{F!==null?F.points.push(new o(v[++L],v[++L],T)):(F=new a(v[++L],v[++L],T),O.push(F));break}case i.MOVE_TO:{F=new a(v[++L],v[++L],T),O.push(F);break}case i.SAVE:{h.push(E.copyToArray());break}case i.RESTORE:{E.copyFromArray(h.pop());break}case i.TRANSLATE:{q=v[++L],ht=v[++L],E.translate(q,ht);break}case i.SCALE:{q=v[++L],ht=v[++L],E.scale(q,ht);break}case i.ROTATE:{E.rotate(v[++L]);break}}f.pipelines.postBatch(u)}};t.exports=c}),tT=S((e,t)=>{"use strict";var i=Xi(),s=function(n,r,o,a,h){var l=a.alpha*o.alpha;if(l<=0)return!1;var c=i(o,a,h).calc;return r.globalCompositeOperation=n.blendModes[o.blendMode],r.globalAlpha=l,r.save(),c.setToContext(r),r.imageSmoothingEnabled=o.frame?!o.frame.source.scaleMode:n.antialias,!0};t.exports=s}),eT=S((e,t)=>{"use strict";var i=_a(),s=tT(),n=function(r,o,a,h,l,c){var f=o.commandBuffer,u=f.length,p=l||r.currentContext;if(!(u===0||!s(r,p,o,a,h))){a.addToRenderList(o);var d=1,g=1,m=0,E=0,v=1,y=0,T=0,A=0;p.beginPath();for(var x=0;x<u;++x){var _=f[x];switch(_){case i.ARC:p.arc(f[x+1],f[x+2],f[x+3],f[x+4],f[x+5],f[x+6]),x+=7;break;case i.LINE_STYLE:v=f[x+1],m=f[x+2],d=f[x+3],y=(m&16711680)>>>16,T=(m&65280)>>>8,A=m&255,p.strokeStyle="rgba("+y+","+T+","+A+","+d+")",p.lineWidth=v,x+=3;break;case i.FILL_STYLE:E=f[x+1],g=f[x+2],y=(E&16711680)>>>16,T=(E&65280)>>>8,A=E&255,p.fillStyle="rgba("+y+","+T+","+A+","+g+")",x+=2;break;case i.BEGIN_PATH:p.beginPath();break;case i.CLOSE_PATH:p.closePath();break;case i.FILL_PATH:c||p.fill();break;case i.STROKE_PATH:c||p.stroke();break;case i.FILL_RECT:c?p.rect(f[x+1],f[x+2],f[x+3],f[x+4]):p.fillRect(f[x+1],f[x+2],f[x+3],f[x+4]),x+=4;break;case i.FILL_TRIANGLE:p.beginPath(),p.moveTo(f[x+1],f[x+2]),p.lineTo(f[x+3],f[x+4]),p.lineTo(f[x+5],f[x+6]),p.closePath(),c||p.fill(),x+=6;break;case i.STROKE_TRIANGLE:p.beginPath(),p.moveTo(f[x+1],f[x+2]),p.lineTo(f[x+3],f[x+4]),p.lineTo(f[x+5],f[x+6]),p.closePath(),c||p.stroke(),x+=6;break;case i.LINE_TO:p.lineTo(f[x+1],f[x+2]),x+=2;break;case i.MOVE_TO:p.moveTo(f[x+1],f[x+2]),x+=2;break;case i.LINE_FX_TO:p.lineTo(f[x+1],f[x+2]),x+=5;break;case i.MOVE_FX_TO:p.moveTo(f[x+1],f[x+2]),x+=5;break;case i.SAVE:p.save();break;case i.RESTORE:p.restore();break;case i.TRANSLATE:p.translate(f[x+1],f[x+2]),x+=2;break;case i.SCALE:p.scale(f[x+1],f[x+2]),x+=2;break;case i.ROTATE:p.rotate(f[x+1]),x+=1;break;case i.GRADIENT_FILL_STYLE:x+=5;break;case i.GRADIENT_LINE_STYLE:x+=6;break}}p.restore()}};t.exports=n}),iT=S((e,t)=>{"use strict";var i=Lt(),s=i,n=i;s=$y(),n=eT(),t.exports={renderWebGL:s,renderCanvas:n}}),ba=S((e,t)=>{"use strict";var i=ya(),s=V(),n=_a(),r=me(),o=Fe(),a=pt(),h=Mt(),l=he(),c=iT(),f=new s({Extends:o,Mixins:[r.AlphaSingle,r.BlendMode,r.Depth,r.Mask,r.Pipeline,r.PostPipeline,r.Transform,r.Visible,r.ScrollFactor,c],initialize:function(u,p){var d=h(p,"x",0),g=h(p,"y",0);o.call(this,u,"Graphics"),this.setPosition(d,g),this.initPipeline(),this.initPostPipeline(),this.displayOriginX=0,this.displayOriginY=0,this.commandBuffer=[],this.defaultFillColor=-1,this.defaultFillAlpha=1,this.defaultStrokeWidth=1,this.defaultStrokeColor=-1,this.defaultStrokeAlpha=1,this._lineWidth=1,this.lineStyle(1,0,0),this.fillStyle(0,0),this.setDefaultStyles(p)},setDefaultStyles:function(u){return h(u,"lineStyle",null)&&(this.defaultStrokeWidth=h(u,"lineStyle.width",1),this.defaultStrokeColor=h(u,"lineStyle.color",16777215),this.defaultStrokeAlpha=h(u,"lineStyle.alpha",1),this.lineStyle(this.defaultStrokeWidth,this.defaultStrokeColor,this.defaultStrokeAlpha)),h(u,"fillStyle",null)&&(this.defaultFillColor=h(u,"fillStyle.color",16777215),this.defaultFillAlpha=h(u,"fillStyle.alpha",1),this.fillStyle(this.defaultFillColor,this.defaultFillAlpha)),this},lineStyle:function(u,p,d){return d===void 0&&(d=1),this.commandBuffer.push(n.LINE_STYLE,u,p,d),this._lineWidth=u,this},fillStyle:function(u,p){return p===void 0&&(p=1),this.commandBuffer.push(n.FILL_STYLE,u,p),this},fillGradientStyle:function(u,p,d,g,m,E,v,y){return m===void 0&&(m=1),E===void 0&&(E=m),v===void 0&&(v=m),y===void 0&&(y=m),this.commandBuffer.push(n.GRADIENT_FILL_STYLE,m,E,v,y,u,p,d,g),this},lineGradientStyle:function(u,p,d,g,m,E){return E===void 0&&(E=1),this.commandBuffer.push(n.GRADIENT_LINE_STYLE,u,E,p,d,g,m),this},beginPath:function(){return this.commandBuffer.push(n.BEGIN_PATH),this},closePath:function(){return this.commandBuffer.push(n.CLOSE_PATH),this},fillPath:function(){return this.commandBuffer.push(n.FILL_PATH),this},fill:function(){return this.commandBuffer.push(n.FILL_PATH),this},strokePath:function(){return this.commandBuffer.push(n.STROKE_PATH),this},stroke:function(){return this.commandBuffer.push(n.STROKE_PATH),this},fillCircleShape:function(u){return this.fillCircle(u.x,u.y,u.radius)},strokeCircleShape:function(u){return this.strokeCircle(u.x,u.y,u.radius)},fillCircle:function(u,p,d){return this.beginPath(),this.arc(u,p,d,0,l.PI2),this.fillPath(),this},strokeCircle:function(u,p,d){return this.beginPath(),this.arc(u,p,d,0,l.PI2),this.strokePath(),this},fillRectShape:function(u){return this.fillRect(u.x,u.y,u.width,u.height)},strokeRectShape:function(u){return this.strokeRect(u.x,u.y,u.width,u.height)},fillRect:function(u,p,d,g){return this.commandBuffer.push(n.FILL_RECT,u,p,d,g),this},strokeRect:function(u,p,d,g){var m=this._lineWidth/2,E=u-m,v=u+m;return this.beginPath(),this.moveTo(u,p),this.lineTo(u,p+g),this.strokePath(),this.beginPath(),this.moveTo(u+d,p),this.lineTo(u+d,p+g),this.strokePath(),this.beginPath(),this.moveTo(E,p),this.lineTo(v+d,p),this.strokePath(),this.beginPath(),this.moveTo(E,p+g),this.lineTo(v+d,p+g),this.strokePath(),this},fillRoundedRect:function(u,p,d,g,m){m===void 0&&(m=20);var E=m,v=m,y=m,T=m;typeof m!="number"&&(E=a(m,"tl",20),v=a(m,"tr",20),y=a(m,"bl",20),T=a(m,"br",20));var A=E>=0,x=v>=0,_=y>=0,b=T>=0;return E=Math.abs(E),v=Math.abs(v),y=Math.abs(y),T=Math.abs(T),this.beginPath(),this.moveTo(u+E,p),this.lineTo(u+d-v,p),x?this.arc(u+d-v,p+v,v,-l.TAU,0):this.arc(u+d,p,v,Math.PI,l.TAU,!0),this.lineTo(u+d,p+g-T),b?this.arc(u+d-T,p+g-T,T,0,l.TAU):this.arc(u+d,p+g,T,-l.TAU,Math.PI,!0),this.lineTo(u+y,p+g),_?this.arc(u+y,p+g-y,y,l.TAU,Math.PI):this.arc(u,p+g,y,0,-l.TAU,!0),this.lineTo(u,p+E),A?this.arc(u+E,p+E,E,-Math.PI,-l.TAU):this.arc(u,p,E,l.TAU,0,!0),this.fillPath(),this},strokeRoundedRect:function(u,p,d,g,m){m===void 0&&(m=20);var E=m,v=m,y=m,T=m,A=Math.min(d,g)/2;typeof m!="number"&&(E=a(m,"tl",20),v=a(m,"tr",20),y=a(m,"bl",20),T=a(m,"br",20));var x=E>=0,_=v>=0,b=y>=0,M=T>=0;return E=Math.min(Math.abs(E),A),v=Math.min(Math.abs(v),A),y=Math.min(Math.abs(y),A),T=Math.min(Math.abs(T),A),this.beginPath(),this.moveTo(u+E,p),this.lineTo(u+d-v,p),this.moveTo(u+d-v,p),_?this.arc(u+d-v,p+v,v,-l.TAU,0):this.arc(u+d,p,v,Math.PI,l.TAU,!0),this.lineTo(u+d,p+g-T),this.moveTo(u+d,p+g-T),M?this.arc(u+d-T,p+g-T,T,0,l.TAU):this.arc(u+d,p+g,T,-l.TAU,Math.PI,!0),this.lineTo(u+y,p+g),this.moveTo(u+y,p+g),b?this.arc(u+y,p+g-y,y,l.TAU,Math.PI):this.arc(u,p+g,y,0,-l.TAU,!0),this.lineTo(u,p+E),this.moveTo(u,p+E),x?this.arc(u+E,p+E,E,-Math.PI,-l.TAU):this.arc(u,p,E,l.TAU,0,!0),this.strokePath(),this},fillPointShape:function(u,p){return this.fillPoint(u.x,u.y,p)},fillPoint:function(u,p,d){return!d||d<1?d=1:(u-=d/2,p-=d/2),this.commandBuffer.push(n.FILL_RECT,u,p,d,d),this},fillTriangleShape:function(u){return this.fillTriangle(u.x1,u.y1,u.x2,u.y2,u.x3,u.y3)},strokeTriangleShape:function(u){return this.strokeTriangle(u.x1,u.y1,u.x2,u.y2,u.x3,u.y3)},fillTriangle:function(u,p,d,g,m,E){return this.commandBuffer.push(n.FILL_TRIANGLE,u,p,d,g,m,E),this},strokeTriangle:function(u,p,d,g,m,E){return this.commandBuffer.push(n.STROKE_TRIANGLE,u,p,d,g,m,E),this},strokeLineShape:function(u){return this.lineBetween(u.x1,u.y1,u.x2,u.y2)},lineBetween:function(u,p,d,g){return this.beginPath(),this.moveTo(u,p),this.lineTo(d,g),this.strokePath(),this},lineTo:function(u,p){return this.commandBuffer.push(n.LINE_TO,u,p),this},moveTo:function(u,p){return this.commandBuffer.push(n.MOVE_TO,u,p),this},strokePoints:function(u,p,d,g){p===void 0&&(p=!1),d===void 0&&(d=!1),g===void 0&&(g=u.length),this.beginPath(),this.moveTo(u[0].x,u[0].y);for(var m=1;m<g;m++)this.lineTo(u[m].x,u[m].y);return p&&this.lineTo(u[0].x,u[0].y),d&&this.closePath(),this.strokePath(),this},fillPoints:function(u,p,d,g){p===void 0&&(p=!1),d===void 0&&(d=!1),g===void 0&&(g=u.length),this.beginPath(),this.moveTo(u[0].x,u[0].y);for(var m=1;m<g;m++)this.lineTo(u[m].x,u[m].y);return p&&this.lineTo(u[0].x,u[0].y),d&&this.closePath(),this.fillPath(),this},strokeEllipseShape:function(u,p){p===void 0&&(p=32);var d=u.getPoints(p);return this.strokePoints(d,!0)},arc:function(u,p,d,g,m,E,v){return E===void 0&&(E=!1),v===void 0&&(v=0),this.commandBuffer.push(n.ARC,u,p,d,g,m,E,v),this},slice:function(u,p,d,g,m,E,v){return E===void 0&&(E=!1),v===void 0&&(v=0),this.commandBuffer.push(n.BEGIN_PATH),this.commandBuffer.push(n.MOVE_TO,u,p),this.commandBuffer.push(n.ARC,u,p,d,g,m,E,v),this.commandBuffer.push(n.CLOSE_PATH),this},save:function(){return this.commandBuffer.push(n.SAVE),this},restore:function(){return this.commandBuffer.push(n.RESTORE),this},translateCanvas:function(u,p){return this.commandBuffer.push(n.TRANSLATE,u,p),this},scaleCanvas:function(u,p){return this.commandBuffer.push(n.SCALE,u,p),this},rotateCanvas:function(u){return this.commandBuffer.push(n.ROTATE,u),this},clear:function(){return this.commandBuffer.length=0,this.defaultFillColor>-1&&this.fillStyle(this.defaultFillColor,this.defaultFillAlpha),this.defaultStrokeColor>-1&&this.lineStyle(this.defaultStrokeWidth,this.defaultStrokeColor,this.defaultStrokeAlpha),this},generateTexture:function(u,p,d){var g=this.scene.sys,m=g.game.renderer;p===void 0&&(p=g.scale.width),d===void 0&&(d=g.scale.height),f.TargetCamera.setScene(this.scene),f.TargetCamera.setViewport(0,0,p,d),f.TargetCamera.scrollX=this.x,f.TargetCamera.scrollY=this.y;var E,v,y={willReadFrequently:!0};if(typeof u=="string")if(g.textures.exists(u)){E=g.textures.get(u);var T=E.getSourceImage();T instanceof HTMLCanvasElement&&(v=T.getContext("2d",y))}else E=g.textures.createCanvas(u,p,d),v=E.getSourceImage().getContext("2d",y);else u instanceof HTMLCanvasElement&&(v=u.getContext("2d",y));return v&&(this.renderCanvas(m,this,f.TargetCamera,null,v,!1),E&&E.refresh()),this},preDestroy:function(){this.commandBuffer=[]}});f.TargetCamera=new i,t.exports=f}),Qn=S((e,t)=>{"use strict";var i={TOP_LEFT:0,TOP_CENTER:1,TOP_RIGHT:2,LEFT_TOP:3,LEFT_CENTER:4,LEFT_BOTTOM:5,CENTER:6,RIGHT_TOP:7,RIGHT_CENTER:8,RIGHT_BOTTOM:9,BOTTOM_LEFT:10,BOTTOM_CENTER:11,BOTTOM_RIGHT:12};t.exports=i}),qe=S((e,t)=>{"use strict";var i=function(s){return s.y+s.height-s.height*s.originY};t.exports=i}),Ss=S((e,t)=>{"use strict";var i=function(s){return s.x-s.width*s.originX+s.width*.5};t.exports=i}),As=S((e,t)=>{"use strict";var i=function(s,n){var r=s.width*s.originX;return s.x=n+r-s.width*.5,s};t.exports=i}),di=S((e,t)=>{"use strict";var i=function(s,n){return s.y=n+s.height*s.originY,s};t.exports=i}),Ql=S((e,t)=>{"use strict";var i=qe(),s=Ss(),n=As(),r=di(),o=function(a,h,l,c){return l===void 0&&(l=0),c===void 0&&(c=0),n(a,s(h)+l),r(a,i(h)+c),a};t.exports=o}),Qe=S((e,t)=>{"use strict";var i=function(s){return s.x-s.width*s.originX};t.exports=i}),pi=S((e,t)=>{"use strict";var i=function(s,n){return s.x=n+s.width*s.originX,s};t.exports=i}),Jl=S((e,t)=>{"use strict";var i=qe(),s=Qe(),n=pi(),r=di(),o=function(a,h,l,c){return l===void 0&&(l=0),c===void 0&&(c=0),n(a,s(h)-l),r(a,i(h)+c),a};t.exports=o}),Je=S((e,t)=>{"use strict";var i=function(s){return s.x+s.width-s.width*s.originX};t.exports=i}),gi=S((e,t)=>{"use strict";var i=function(s,n){return s.x=n-s.width+s.width*s.originX,s};t.exports=i}),$l=S((e,t)=>{"use strict";var i=qe(),s=Je(),n=gi(),r=di(),o=function(a,h,l,c){return l===void 0&&(l=0),c===void 0&&(c=0),n(a,s(h)+l),r(a,i(h)+c),a};t.exports=o}),fi=S((e,t)=>{"use strict";var i=function(s,n){return s.y=n-s.height+s.height*s.originY,s};t.exports=i}),tu=S((e,t)=>{"use strict";var i=qe(),s=Qe(),n=fi(),r=gi(),o=function(a,h,l,c){return l===void 0&&(l=0),c===void 0&&(c=0),r(a,s(h)-l),n(a,i(h)+c),a};t.exports=o}),xs=S((e,t)=>{"use strict";var i=function(s){return s.y-s.height*s.originY+s.height*.5};t.exports=i}),ws=S((e,t)=>{"use strict";var i=function(s,n){var r=s.height*s.originY;return s.y=n+r-s.height*.5,s};t.exports=i}),eu=S((e,t)=>{"use strict";var i=xs(),s=Qe(),n=ws(),r=gi(),o=function(a,h,l,c){return l===void 0&&(l=0),c===void 0&&(c=0),r(a,s(h)-l),n(a,i(h)+c),a};t.exports=o}),$e=S((e,t)=>{"use strict";var i=function(s){return s.y-s.height*s.originY};t.exports=i}),iu=S((e,t)=>{"use strict";var i=Qe(),s=$e(),n=gi(),r=di(),o=function(a,h,l,c){return l===void 0&&(l=0),c===void 0&&(c=0),n(a,i(h)-l),r(a,s(h)-c),a};t.exports=o}),su=S((e,t)=>{"use strict";var i=qe(),s=Je(),n=fi(),r=pi(),o=function(a,h,l,c){return l===void 0&&(l=0),c===void 0&&(c=0),r(a,s(h)+l),n(a,i(h)+c),a};t.exports=o}),nu=S((e,t)=>{"use strict";var i=xs(),s=Je(),n=ws(),r=pi(),o=function(a,h,l,c){return l===void 0&&(l=0),c===void 0&&(c=0),r(a,s(h)+l),n(a,i(h)+c),a};t.exports=o}),ru=S((e,t)=>{"use strict";var i=Je(),s=$e(),n=pi(),r=di(),o=function(a,h,l,c){return l===void 0&&(l=0),c===void 0&&(c=0),n(a,i(h)+l),r(a,s(h)-c),a};t.exports=o}),au=S((e,t)=>{"use strict";var i=Ss(),s=$e(),n=fi(),r=As(),o=function(a,h,l,c){return l===void 0&&(l=0),c===void 0&&(c=0),r(a,i(h)+l),n(a,s(h)-c),a};t.exports=o}),ou=S((e,t)=>{"use strict";var i=Qe(),s=$e(),n=fi(),r=pi(),o=function(a,h,l,c){return l===void 0&&(l=0),c===void 0&&(c=0),r(a,i(h)-l),n(a,s(h)-c),a};t.exports=o}),hu=S((e,t)=>{"use strict";var i=Je(),s=$e(),n=fi(),r=gi(),o=function(a,h,l,c){return l===void 0&&(l=0),c===void 0&&(c=0),r(a,i(h)+l),n(a,s(h)-c),a};t.exports=o}),lu=S((e,t)=>{"use strict";var i=Qn(),s=[];s[i.BOTTOM_CENTER]=Ql(),s[i.BOTTOM_LEFT]=Jl(),s[i.BOTTOM_RIGHT]=$l(),s[i.LEFT_BOTTOM]=tu(),s[i.LEFT_CENTER]=eu(),s[i.LEFT_TOP]=iu(),s[i.RIGHT_BOTTOM]=su(),s[i.RIGHT_CENTER]=nu(),s[i.RIGHT_TOP]=ru(),s[i.TOP_CENTER]=au(),s[i.TOP_LEFT]=ou(),s[i.TOP_RIGHT]=hu();var n=function(r,o,a,h,l){return s[a](r,o,h,l)};t.exports=n}),sT=S((e,t)=>{"use strict";var i=lu(),s=function(n,r,o,a){for(var h=n[0],l=1;l<n.length;l++){var c=n[l];i(c,h,r,o,a),h=c}return n};t.exports=s}),ti=S((e,t)=>{"use strict";var i=function(s,n,r,o,a,h){o===void 0&&(o=0),a===void 0&&(a=0),h===void 0&&(h=1);var l,c=0,f=s.length;if(h===1)for(l=a;l<f;l++)s[l][n]+=r+c*o,c++;else for(l=a;l>=0;l--)s[l][n]+=r+c*o,c++;return s};t.exports=i}),nT=S((e,t)=>{"use strict";var i=ti(),s=function(n,r,o,a,h){return i(n,"angle",r,o,a,h)};t.exports=s}),rT=S((e,t)=>{"use strict";var i=function(s,n,r){for(var o=0;o<s.length;o++){var a=s[o];n.call(r,a)}return s};t.exports=i}),aT=S((e,t)=>{"use strict";var i=function(s,n,r){r===void 0&&(r=0);for(var o=r;o<s.length;o++){var a=s[o],h=!0;for(var l in n)a[l]!==n[l]&&(h=!1);if(h)return a}return null};t.exports=i}),oT=S((e,t)=>{"use strict";var i=function(s,n,r){r===void 0&&(r=0);for(var o=s.length-1;o>=r;o--){var a=s[o],h=!0;for(var l in n)a[l]!==n[l]&&(h=!1);if(h)return a}return null};t.exports=i}),uu=S((e,t)=>{"use strict";var i=qe(),s=Ss(),n=fi(),r=As(),o=function(a,h,l,c){return l===void 0&&(l=0),c===void 0&&(c=0),r(a,s(h)+l),n(a,i(h)+c),a};t.exports=o}),cu=S((e,t)=>{"use strict";var i=qe(),s=Qe(),n=fi(),r=pi(),o=function(a,h,l,c){return l===void 0&&(l=0),c===void 0&&(c=0),r(a,s(h)-l),n(a,i(h)+c),a};t.exports=o}),du=S((e,t)=>{"use strict";var i=qe(),s=Je(),n=fi(),r=gi(),o=function(a,h,l,c){return l===void 0&&(l=0),c===void 0&&(c=0),r(a,s(h)+l),n(a,i(h)+c),a};t.exports=o}),pu=S((e,t)=>{"use strict";var i=As(),s=ws(),n=function(r,o,a){return i(r,o),s(r,a)};t.exports=n}),gu=S((e,t)=>{"use strict";var i=pu(),s=Ss(),n=xs(),r=function(o,a,h,l){return h===void 0&&(h=0),l===void 0&&(l=0),i(o,s(a)+h,n(a)+l),o};t.exports=r}),fu=S((e,t)=>{"use strict";var i=xs(),s=Qe(),n=ws(),r=pi(),o=function(a,h,l,c){return l===void 0&&(l=0),c===void 0&&(c=0),r(a,s(h)-l),n(a,i(h)+c),a};t.exports=o}),mu=S((e,t)=>{"use strict";var i=xs(),s=Je(),n=ws(),r=gi(),o=function(a,h,l,c){return l===void 0&&(l=0),c===void 0&&(c=0),r(a,s(h)+l),n(a,i(h)+c),a};t.exports=o}),vu=S((e,t)=>{"use strict";var i=Ss(),s=$e(),n=As(),r=di(),o=function(a,h,l,c){return l===void 0&&(l=0),c===void 0&&(c=0),n(a,i(h)+l),r(a,s(h)-c),a};t.exports=o}),Eu=S((e,t)=>{"use strict";var i=Qe(),s=$e(),n=pi(),r=di(),o=function(a,h,l,c){return l===void 0&&(l=0),c===void 0&&(c=0),n(a,i(h)-l),r(a,s(h)-c),a};t.exports=o}),yu=S((e,t)=>{"use strict";var i=Je(),s=$e(),n=gi(),r=di(),o=function(a,h,l,c){return l===void 0&&(l=0),c===void 0&&(c=0),n(a,i(h)+l),r(a,s(h)-c),a};t.exports=o}),Tu=S((e,t)=>{"use strict";var i=Qn(),s=[];s[i.BOTTOM_CENTER]=uu(),s[i.BOTTOM_LEFT]=cu(),s[i.BOTTOM_RIGHT]=du(),s[i.CENTER]=gu(),s[i.LEFT_CENTER]=fu(),s[i.RIGHT_CENTER]=mu(),s[i.TOP_CENTER]=vu(),s[i.TOP_LEFT]=Eu(),s[i.TOP_RIGHT]=yu(),s[i.LEFT_BOTTOM]=s[i.BOTTOM_LEFT],s[i.LEFT_TOP]=s[i.TOP_LEFT],s[i.RIGHT_BOTTOM]=s[i.BOTTOM_RIGHT],s[i.RIGHT_TOP]=s[i.TOP_RIGHT];var n=function(r,o,a,h,l){return s[a](r,o,h,l)};t.exports=n}),hn=S((e,t)=>{"use strict";var i=function(s,n,r){if(s.radius>0&&n>=s.left&&n<=s.right&&r>=s.top&&r<=s.bottom){var o=(s.x-n)*(s.x-n),a=(s.y-r)*(s.y-r);return o+a<=s.radius*s.radius}else return!1};t.exports=i}),Pa=S((e,t)=>{"use strict";var i=$t(),s=function(n,r,o){return o===void 0&&(o=new i),o.x=n.x+n.radius*Math.cos(r),o.y=n.y+n.radius*Math.sin(r),o};t.exports=s}),Su=S((e,t)=>{"use strict";var i=Xt(),s=function(n,r,o){return n=i(n,0,1),(o-r)*n+r};t.exports=s}),Au=S((e,t)=>{"use strict";var i=Pa(),s=Su(),n=he(),r=$t(),o=function(a,h,l){l===void 0&&(l=new r);var c=s(h,0,n.PI2);return i(a,c,l)};t.exports=o}),xu=S((e,t)=>{"use strict";var i=function(s){return 2*(Math.PI*s.radius)};t.exports=i}),wu=S((e,t)=>{"use strict";var i=xu(),s=Pa(),n=Su(),r=he(),o=function(a,h,l,c){c===void 0&&(c=[]),!h&&l>0&&(h=i(a)/l);for(var f=0;f<h;f++){var u=n(f/h,0,r.PI2);c.push(s(a,u))}return c};t.exports=o}),La=S((e,t)=>{"use strict";var i=$t(),s=function(n,r){r===void 0&&(r=new i);var o=2*Math.PI*Math.random(),a=Math.random()+Math.random(),h=a>1?2-a:a,l=h*Math.cos(o),c=h*Math.sin(o);return r.x=n.x+l*n.radius,r.y=n.y+c*n.radius,r};t.exports=s}),Ia=S((e,t)=>{"use strict";var i=V(),s=hn(),n=Au(),r=wu(),o=Es(),a=La(),h=new i({initialize:function(l,c,f){l===void 0&&(l=0),c===void 0&&(c=0),f===void 0&&(f=0),this.type=o.CIRCLE,this.x=l,this.y=c,this._radius=f,this._diameter=f*2},contains:function(l,c){return s(this,l,c)},getPoint:function(l,c){return n(this,l,c)},getPoints:function(l,c,f){return r(this,l,c,f)},getRandomPoint:function(l){return a(this,l)},setTo:function(l,c,f){return this.x=l,this.y=c,this._radius=f,this._diameter=f*2,this},setEmpty:function(){return this._radius=0,this._diameter=0,this},setPosition:function(l,c){return c===void 0&&(c=l),this.x=l,this.y=c,this},isEmpty:function(){return this._radius<=0},radius:{get:function(){return this._radius},set:function(l){this._radius=l,this._diameter=l*2}},diameter:{get:function(){return this._diameter},set:function(l){this._diameter=l,this._radius=l*.5}},left:{get:function(){return this.x-this._radius},set:function(l){this.x=l+this._radius}},right:{get:function(){return this.x+this._radius},set:function(l){this.x=l-this._radius}},top:{get:function(){return this.y-this._radius},set:function(l){this.y=l+this._radius}},bottom:{get:function(){return this.y+this._radius},set:function(l){this.y=l-this._radius}}});t.exports=h}),Jn=S((e,t)=>{"use strict";var i=ms(),s=Ia(),n=hn(),r=V(),o=me(),a=Fe(),h=zt(),l=vs(),c=new r({Extends:a,Mixins:[o.Depth,o.GetBounds,o.Origin,o.Transform,o.ScrollFactor,o.Visible],initialize:function(f,u,p,d,g){d===void 0&&(d=1),g===void 0&&(g=d),a.call(this,f,"Zone"),this.setPosition(u,p),this.width=d,this.height=g,this.blendMode=i.NORMAL,this.updateDisplayOrigin()},displayWidth:{get:function(){return this.scaleX*this.width},set:function(f){this.scaleX=f/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(f){this.scaleY=f/this.height}},setSize:function(f,u,p){p===void 0&&(p=!0),this.width=f,this.height=u,this.updateDisplayOrigin();var d=this.input;return p&&d&&!d.customHitArea&&(d.hitArea.width=f,d.hitArea.height=u),this},setDisplaySize:function(f,u){return this.displayWidth=f,this.displayHeight=u,this},setCircleDropZone:function(f){return this.setDropZone(new s(0,0,f),n)},setRectangleDropZone:function(f,u){return this.setDropZone(new h(0,0,f,u),l)},setDropZone:function(f,u){return this.input||this.setInteractive(f,u,!0),this},setAlpha:function(){},setBlendMode:function(){},renderCanvas:function(f,u,p){p.addToRenderList(u)},renderWebGL:function(f,u,p){p.addToRenderList(u)}});t.exports=c}),hT=S((e,t)=>{"use strict";var i=Tu(),s=Qn(),n=pt(),r=Lt(),o=Jn(),a=new o({sys:{queueDepthSort:r,events:{once:r}}},0,0,1,1).setOrigin(0,0),h=function(l,c){c===void 0&&(c={});var f=c.hasOwnProperty("width"),u=c.hasOwnProperty("height"),p=n(c,"width",-1),d=n(c,"height",-1),g=n(c,"cellWidth",1),m=n(c,"cellHeight",g),E=n(c,"position",s.TOP_LEFT),v=n(c,"x",0),y=n(c,"y",0),T=0,A=0,x=p*g,_=d*m;a.setPosition(v,y),a.setSize(g,m);for(var b=0;b<l.length;b++)if(i(l[b],a,E),f&&p===-1)a.x+=g;else if(u&&d===-1)a.y+=m;else if(u&&!f){if(A+=m,a.y+=m,A===_&&(A=0,T+=g,a.y=y,a.x+=g,T===x))break}else if(T+=g,a.x+=g,T===x&&(T=0,A+=m,a.x=v,a.y+=m,A===_))break;return l};t.exports=h}),lT=S((e,t)=>{"use strict";var i=ti(),s=function(n,r,o,a,h){return i(n,"alpha",r,o,a,h)};t.exports=s}),uT=S((e,t)=>{"use strict";var i=ti(),s=function(n,r,o,a,h){return i(n,"x",r,o,a,h)};t.exports=s}),cT=S((e,t)=>{"use strict";var i=ti(),s=function(n,r,o,a,h,l,c){return o==null&&(o=r),i(n,"x",r,a,l,c),i(n,"y",o,h,l,c)};t.exports=s}),dT=S((e,t)=>{"use strict";var i=ti(),s=function(n,r,o,a,h){return i(n,"y",r,o,a,h)};t.exports=s}),pT=S((e,t)=>{"use strict";var i=function(s,n,r,o){r===void 0&&(r=0),o===void 0&&(o=6.28);for(var a=r,h=(o-r)/s.length,l=n.x,c=n.y,f=n.radius,u=0;u<s.length;u++)s[u].x=l+f*Math.cos(a),s[u].y=c+f*Math.sin(a),a+=h;return s};t.exports=i}),gT=S((e,t)=>{"use strict";var i=function(s,n,r,o){r===void 0&&(r=0),o===void 0&&(o=6.28);for(var a=r,h=(o-r)/s.length,l=n.width/2,c=n.height/2,f=0;f<s.length;f++)s[f].x=n.x+l*Math.cos(a),s[f].y=n.y+c*Math.sin(a),a+=h;return s};t.exports=i}),ji=S((e,t)=>{"use strict";var i=zn(),s=Ol(),n=function(r,o){var a=i.Power0;if(typeof r=="string")if(i.hasOwnProperty(r))a=i[r];else{var h="";if(r.indexOf(".")){h=r.substring(r.indexOf(".")+1);var l=h.toLowerCase();l==="in"?h="easeIn":l==="out"?h="easeOut":l==="inout"&&(h="easeInOut")}r=s(r.substring(0,r.indexOf(".")+1)+h),i.hasOwnProperty(r)&&(a=i[r])}else typeof r=="function"&&(a=r);if(!o)return a;var c=o.slice(0);return c.unshift(0),function(f){return c[0]=f,a.apply(this,c)}};t.exports=n}),fT=S((e,t)=>{"use strict";var i=Fl(),s=ji(),n=$t(),r=function(o,a,h,l,c){l===void 0&&(l=0),c===void 0&&(c=[]);var f=[],u=o.x1,p=o.y1,d=o.x2-u,g=o.y2-p,m=s(a,c),E,v,y=h-1;for(E=0;E<y;E++)v=m(E/y),f.push(new n(u+d*v,p+g*v));if(v=m(1),f.push(new n(u+d*v,p+g*v)),l>0){var T=f[0],A=[T];for(E=1;E<f.length-1;E++){var x=f[E];i(T,x)>=l&&(A.push(x),T=x)}var _=f[f.length-1];return i(T,_)<l&&A.pop(),A.push(_),A}else return f};t.exports=r}),mT=S((e,t)=>{"use strict";var i=zh(),s=fT(),n=function(r,o,a){var h;a?h=s(o,a,r.length):h=i(o,r.length);for(var l=0;l<r.length;l++){var c=r[l],f=h[l];c.x=f.x,c.y=f.y}return r};t.exports=n}),Ru=S((e,t)=>{"use strict";var i=Wn(),s=$t(),n=function(r,o,a,h){if(h===void 0&&(h=[]),!o&&!a)return h;o?a=Math.round(i(r)/o):o=i(r)/a;for(var l=r.x,c=r.y,f=0,u=0;u<a;u++)switch(h.push(new s(l,c)),f){case 0:l+=o,l>=r.right&&(f=1,c+=l-r.right,l=r.right);break;case 1:c+=o,c>=r.bottom&&(f=2,l-=c-r.bottom,c=r.bottom);break;case 2:l-=o,l<=r.left&&(f=3,c-=r.left-l,l=r.left);break;case 3:c-=o,c<=r.top&&(f=0,c=r.top);break}return h};t.exports=n}),vT=S((e,t)=>{"use strict";var i=Ru(),s=ra(),n=aa(),r=function(o,a,h){h===void 0&&(h=0);var l=i(a,!1,o.length);h>0?s(l,h):h<0&&n(l,Math.abs(h));for(var c=0;c<o.length;c++)o[c].x=l[c].x,o[c].y=l[c].y;return o};t.exports=r}),ET=S((e,t)=>{"use strict";var i=function(s,n,r){n===void 0&&(n=1),r===void 0&&(r=[]);var o=Math.round(s.x1),a=Math.round(s.y1),h=Math.round(s.x2),l=Math.round(s.y2),c=Math.abs(h-o),f=Math.abs(l-a),u=o<h?1:-1,p=a<l?1:-1,d=c-f;r.push({x:o,y:a});for(var g=1;!(o===h&&a===l);){var m=d<<1;m>-f&&(d-=f,o+=u),m<c&&(d+=c,a+=p),g%n===0&&r.push({x:o,y:a}),g++}return r};t.exports=i}),yT=S((e,t)=>{"use strict";var i=ET(),s=function(n,r,o){var a=i({x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2},o),h=i({x1:r.x2,y1:r.y2,x2:r.x3,y2:r.y3},o),l=i({x1:r.x3,y1:r.y3,x2:r.x1,y2:r.y1},o);a.pop(),h.pop(),l.pop(),a=a.concat(h,l);for(var c=a.length/n.length,f=0,u=0;u<n.length;u++){var p=n[u],d=a[Math.floor(f)];p.x=d.x,p.y=d.y,f+=c}return n};t.exports=s}),TT=S((e,t)=>{"use strict";var i=function(s,n,r){for(var o=0;o<s.length;o++){var a=s[o];a.anims&&a.anims.play(n,r)}return s};t.exports=i}),te=S((e,t)=>{"use strict";var i=function(s,n,r,o,a,h){o===void 0&&(o=0),a===void 0&&(a=0),h===void 0&&(h=1);var l,c=0,f=s.length;if(h===1)for(l=a;l<f;l++)s[l][n]=r+c*o,c++;else for(l=a;l>=0;l--)s[l][n]=r+c*o,c++;return s};t.exports=i}),ST=S((e,t)=>{"use strict";var i=La(),s=function(n,r){for(var o=0;o<n.length;o++)i(r,n[o]);return n};t.exports=s}),AT=S((e,t)=>{"use strict";var i=$t(),s=function(n,r){r===void 0&&(r=new i);var o=Math.random()*Math.PI*2,a=Math.sqrt(Math.random());return r.x=n.x+a*Math.cos(o)*n.width/2,r.y=n.y+a*Math.sin(o)*n.height/2,r};t.exports=s}),xT=S((e,t)=>{"use strict";var i=AT(),s=function(n,r){for(var o=0;o<n.length;o++)i(r,n[o]);return n};t.exports=s}),wT=S((e,t)=>{"use strict";var i=Vh(),s=function(n,r){for(var o=0;o<n.length;o++)i(r,n[o]);return n};t.exports=s}),RT=S((e,t)=>{"use strict";var i=pa(),s=function(n,r){for(var o=0;o<n.length;o++)i(r,n[o]);return n};t.exports=s}),CT=S((e,t)=>{"use strict";var i=$t(),s=function(n,r){r===void 0&&(r=new i);var o=n.x2-n.x1,a=n.y2-n.y1,h=n.x3-n.x1,l=n.y3-n.y1,c=Math.random(),f=Math.random();return c+f>=1&&(c=1-c,f=1-f),r.x=n.x1+(o*c+h*f),r.y=n.y1+(a*c+l*f),r};t.exports=s}),_T=S((e,t)=>{"use strict";var i=CT(),s=function(n,r){for(var o=0;o<n.length;o++)i(r,n[o]);return n};t.exports=s}),bT=S((e,t)=>{"use strict";var i=ti(),s=function(n,r,o,a,h){return i(n,"rotation",r,o,a,h)};t.exports=s}),PT=S((e,t)=>{"use strict";var i=wa(),s=Kn(),n=function(r,o,a){for(var h=o.x,l=o.y,c=0;c<r.length;c++){var f=r[c];i(f,h,l,a,Math.max(1,s(f.x,f.y,h,l)))}return r};t.exports=n}),LT=S((e,t)=>{"use strict";var i=wa(),s=function(n,r,o,a){var h=r.x,l=r.y;if(a===0)return n;for(var c=0;c<n.length;c++)i(n[c],h,l,o,a);return n};t.exports=s}),IT=S((e,t)=>{"use strict";var i=ti(),s=function(n,r,o,a,h){return i(n,"scaleX",r,o,a,h)};t.exports=s}),MT=S((e,t)=>{"use strict";var i=ti(),s=function(n,r,o,a,h,l,c){return o==null&&(o=r),i(n,"scaleX",r,a,l,c),i(n,"scaleY",o,h,l,c)};t.exports=s}),OT=S((e,t)=>{"use strict";var i=ti(),s=function(n,r,o,a,h){return i(n,"scaleY",r,o,a,h)};t.exports=s}),DT=S((e,t)=>{"use strict";var i=te(),s=function(n,r,o,a,h){return i(n,"alpha",r,o,a,h)};t.exports=s}),kT=S((e,t)=>{"use strict";var i=te(),s=function(n,r,o,a){return i(n,"blendMode",r,0,o,a)};t.exports=s}),BT=S((e,t)=>{"use strict";var i=te(),s=function(n,r,o,a,h){return i(n,"depth",r,o,a,h)};t.exports=s}),NT=S((e,t)=>{"use strict";var i=function(s,n,r){for(var o=0;o<s.length;o++)s[o].setInteractive(n,r);return s};t.exports=i}),UT=S((e,t)=>{"use strict";var i=te(),s=function(n,r,o,a,h,l,c){return o==null&&(o=r),i(n,"originX",r,a,l,c),i(n,"originY",o,h,l,c),n.forEach(function(f){f.updateDisplayOrigin()}),n};t.exports=s}),FT=S((e,t)=>{"use strict";var i=te(),s=function(n,r,o,a,h){return i(n,"rotation",r,o,a,h)};t.exports=s}),GT=S((e,t)=>{"use strict";var i=te(),s=function(n,r,o,a,h,l,c){return o==null&&(o=r),i(n,"scaleX",r,a,l,c),i(n,"scaleY",o,h,l,c)};t.exports=s}),YT=S((e,t)=>{"use strict";var i=te(),s=function(n,r,o,a,h){return i(n,"scaleX",r,o,a,h)};t.exports=s}),HT=S((e,t)=>{"use strict";var i=te(),s=function(n,r,o,a,h){return i(n,"scaleY",r,o,a,h)};t.exports=s}),WT=S((e,t)=>{"use strict";var i=te(),s=function(n,r,o,a,h,l,c){return o==null&&(o=r),i(n,"scrollFactorX",r,a,l,c),i(n,"scrollFactorY",o,h,l,c)};t.exports=s}),zT=S((e,t)=>{"use strict";var i=te(),s=function(n,r,o,a,h){return i(n,"scrollFactorX",r,o,a,h)};t.exports=s}),VT=S((e,t)=>{"use strict";var i=te(),s=function(n,r,o,a,h){return i(n,"scrollFactorY",r,o,a,h)};t.exports=s}),XT=S((e,t)=>{"use strict";var i=function(s,n,r,o,a){for(var h=0;h<s.length;h++)s[h].setTint(n,r,o,a);return s};t.exports=i}),KT=S((e,t)=>{"use strict";var i=te(),s=function(n,r,o,a){return i(n,"visible",r,0,o,a)};t.exports=s}),jT=S((e,t)=>{"use strict";var i=te(),s=function(n,r,o,a,h){return i(n,"x",r,o,a,h)};t.exports=s}),ZT=S((e,t)=>{"use strict";var i=te(),s=function(n,r,o,a,h,l,c){return o==null&&(o=r),i(n,"x",r,a,l,c),i(n,"y",o,h,l,c)};t.exports=s}),qT=S((e,t)=>{"use strict";var i=te(),s=function(n,r,o,a,h){return i(n,"y",r,o,a,h)};t.exports=s}),QT=S((e,t)=>{"use strict";var i=Ot(),s=function(n,r,o,a,h){a===void 0&&(a=0),h===void 0&&(h=new i);var l,c,f=n.length;if(f===1)l=n[0].x,c=n[0].y,n[0].x=r,n[0].y=o;else{var u=1,p=0;a===0&&(p=f-1,u=f-2),l=n[p].x,c=n[p].y,n[p].x=r,n[p].y=o;for(var d=0;d<f;d++)if(!(u>=f||u===-1)){var g=n[u],m=g.x,E=g.y;g.x=l,g.y=c,l=m,c=E,a===0?u--:u++}}return h.x=l,h.y=c,h};t.exports=s}),JT=S((e,t)=>{"use strict";var i=ha(),s=function(n){return i(n)};t.exports=s}),$T=S((e,t)=>{"use strict";var i=Xl(),s=function(n,r,o,a,h){h===void 0&&(h=!1);var l=Math.abs(a-o)/n.length,c;if(h)for(c=0;c<n.length;c++)n[c][r]+=i(c*l,o,a);else for(c=0;c<n.length;c++)n[c][r]=i(c*l,o,a);return n};t.exports=s}),tS=S((e,t)=>{"use strict";var i=Al(),s=function(n,r,o,a,h){h===void 0&&(h=!1);var l=Math.abs(a-o)/n.length,c;if(h)for(c=0;c<n.length;c++)n[c][r]+=i(c*l,o,a);else for(c=0;c<n.length;c++)n[c][r]=i(c*l,o,a);return n};t.exports=s}),eS=S((e,t)=>{"use strict";var i=function(s,n,r,o,a){if(a===void 0&&(a=!1),s.length===0)return s;if(s.length===1)return a?s[0][n]+=(o+r)/2:s[0][n]=(o+r)/2,s;var h=Math.abs(o-r)/(s.length-1),l;if(a)for(l=0;l<s.length;l++)s[l][n]+=l*h+r;else for(l=0;l<s.length;l++)s[l][n]=l*h+r;return s};t.exports=i}),iS=S((e,t)=>{"use strict";var i=function(s){for(var n=0;n<s.length;n++)s[n].visible=!s[n].visible;return s};t.exports=i}),sS=S((e,t)=>{"use strict";var i=rn(),s=function(n,r,o){o===void 0&&(o=0);for(var a=0;a<n.length;a++){var h=n[a];h.x=i(h.x,r.left-o,r.right+o),h.y=i(h.y,r.top-o,r.bottom+o)}return n};t.exports=s}),nS=S((e,t)=>{"use strict";t.exports={AlignTo:sT(),Angle:nT(),Call:rT(),GetFirst:aT(),GetLast:oT(),GridAlign:hT(),IncAlpha:lT(),IncX:uT(),IncXY:cT(),IncY:dT(),PlaceOnCircle:pT(),PlaceOnEllipse:gT(),PlaceOnLine:mT(),PlaceOnRectangle:vT(),PlaceOnTriangle:yT(),PlayAnimation:TT(),PropertyValueInc:ti(),PropertyValueSet:te(),RandomCircle:ST(),RandomEllipse:xT(),RandomLine:wT(),RandomRectangle:RT(),RandomTriangle:_T(),Rotate:bT(),RotateAround:PT(),RotateAroundDistance:LT(),ScaleX:IT(),ScaleXY:MT(),ScaleY:OT(),SetAlpha:DT(),SetBlendMode:kT(),SetDepth:BT(),SetHitArea:NT(),SetOrigin:UT(),SetRotation:FT(),SetScale:GT(),SetScaleX:YT(),SetScaleY:HT(),SetScrollFactor:WT(),SetScrollFactorX:zT(),SetScrollFactorY:VT(),SetTint:XT(),SetVisible:KT(),SetX:jT(),SetXY:ZT(),SetY:qT(),ShiftPosition:QT(),Shuffle:JT(),SmootherStep:$T(),SmoothStep:tS(),Spread:eS(),ToggleVisible:iS(),WrapInRectangle:sS()}}),Cu=S((e,t)=>{"use strict";var i=function(s,n){return s.hasOwnProperty(n)};t.exports=i}),_u=S((e,t)=>{"use strict";var i=V(),s=new i({initialize:function(n){if(this.entries=[],Array.isArray(n))for(var r=0;r<n.length;r++)this.set(n[r])},set:function(n){return this.entries.indexOf(n)===-1&&this.entries.push(n),this},get:function(n,r){for(var o=0;o<this.entries.length;o++){var a=this.entries[o];if(a[n]===r)return a}},getArray:function(){return this.entries.slice(0)},delete:function(n){var r=this.entries.indexOf(n);return r>-1&&this.entries.splice(r,1),this},dump:function(){for(var n=0;n<this.entries.length;n++)var r=this.entries[n]},each:function(n,r){var o,a=this.entries.slice(),h=a.length;if(r)for(o=0;o<h&&n.call(r,a[o],o)!==!1;o++);else for(o=0;o<h&&n(a[o],o)!==!1;o++);return this},iterate:function(n,r){var o,a=this.entries.length;if(r)for(o=0;o<a&&n.call(r,this.entries[o],o)!==!1;o++);else for(o=0;o<a&&n(this.entries[o],o)!==!1;o++);return this},iterateLocal:function(n){var r,o=[];for(r=1;r<arguments.length;r++)o.push(arguments[r]);var a=this.entries.length;for(r=0;r<a;r++){var h=this.entries[r];h[n].apply(h,o)}return this},clear:function(){return this.entries.length=0,this},contains:function(n){return this.entries.indexOf(n)>-1},union:function(n){var r=new s;return n.entries.forEach(function(o){r.set(o)}),this.entries.forEach(function(o){r.set(o)}),r},intersect:function(n){var r=new s;return this.entries.forEach(function(o){n.contains(o)&&r.set(o)}),r},difference:function(n){var r=new s;return this.entries.forEach(function(o){n.contains(o)||r.set(o)}),r},size:{get:function(){return this.entries.length},set:function(n){return n<this.entries.length?this.entries.length=n:this.entries.length}}});t.exports=s}),rS=S((e,t)=>{"use strict";t.exports="add"}),aS=S((e,t)=>{"use strict";t.exports="animationcomplete"}),oS=S((e,t)=>{"use strict";t.exports="animationcomplete-"}),hS=S((e,t)=>{"use strict";t.exports="animationrepeat"}),lS=S((e,t)=>{"use strict";t.exports="animationrestart"}),uS=S((e,t)=>{"use strict";t.exports="animationstart"}),cS=S((e,t)=>{"use strict";t.exports="animationstop"}),dS=S((e,t)=>{"use strict";t.exports="animationupdate"}),pS=S((e,t)=>{"use strict";t.exports="pauseall"}),gS=S((e,t)=>{"use strict";t.exports="remove"}),fS=S((e,t)=>{"use strict";t.exports="resumeall"}),mi=S((e,t)=>{"use strict";t.exports={ADD_ANIMATION:rS(),ANIMATION_COMPLETE:aS(),ANIMATION_COMPLETE_KEY:oS(),ANIMATION_REPEAT:hS(),ANIMATION_RESTART:lS(),ANIMATION_START:uS(),ANIMATION_STOP:cS(),ANIMATION_UPDATE:dS(),PAUSE_ALL:pS(),REMOVE_ANIMATION:gS(),RESUME_ALL:fS()}}),bu=S((e,t)=>{"use strict";var i=V(),s=new i({initialize:function(n,r,o,a,h){h===void 0&&(h=!1),this.textureKey=n,this.textureFrame=r,this.index=o,this.frame=a,this.isFirst=!1,this.isLast=!1,this.prevFrame=null,this.nextFrame=null,this.duration=0,this.progress=0,this.isKeyFrame=h},toJSON:function(){return{key:this.textureKey,frame:this.textureFrame,duration:this.duration,keyframe:this.isKeyFrame}},destroy:function(){this.frame=void 0}});t.exports=s}),Ma=S((e,t)=>{"use strict";var i=Xt(),s=V(),n=mi(),r=Dh(),o=bu(),a=Mt(),h=Gh(),l=new s({initialize:function(c,f,u){this.manager=c,this.key=f,this.type="frame",this.frames=this.getFrames(c.textureManager,a(u,"frames",[]),a(u,"defaultTextureKey",null),a(u,"sortFrames",!0)),this.frameRate=a(u,"frameRate",null),this.duration=a(u,"duration",null),this.msPerFrame,this.skipMissedFrames=a(u,"skipMissedFrames",!0),this.delay=a(u,"delay",0),this.repeat=a(u,"repeat",0),this.repeatDelay=a(u,"repeatDelay",0),this.yoyo=a(u,"yoyo",!1),this.showBeforeDelay=a(u,"showBeforeDelay",!1),this.showOnStart=a(u,"showOnStart",!1),this.hideOnComplete=a(u,"hideOnComplete",!1),this.randomFrame=a(u,"randomFrame",!1),this.paused=!1,this.calculateDuration(this,this.getTotalFrames(),this.duration,this.frameRate),this.manager.on&&(this.manager.on(n.PAUSE_ALL,this.pause,this),this.manager.on(n.RESUME_ALL,this.resume,this))},getTotalFrames:function(){return this.frames.length},calculateDuration:function(c,f,u,p){u===null&&p===null?(c.frameRate=24,c.duration=24/f*1e3):u&&p===null?(c.duration=u,c.frameRate=f/(u/1e3)):(c.frameRate=p,c.duration=f/p*1e3),c.msPerFrame=1e3/c.frameRate},addFrame:function(c){return this.addFrameAt(this.frames.length,c)},addFrameAt:function(c,f){var u=this.getFrames(this.manager.textureManager,f);if(u.length>0){if(c===0)this.frames=u.concat(this.frames);else if(c===this.frames.length)this.frames=this.frames.concat(u);else{var p=this.frames.slice(0,c),d=this.frames.slice(c);this.frames=p.concat(u,d)}this.updateFrameSequence()}return this},checkFrame:function(c){return c>=0&&c<this.frames.length},getFirstTick:function(c){c.accumulator=0,c.nextTick=c.msPerFrame||c.currentFrame.duration},getFrameAt:function(c){return this.frames[c]},getFrames:function(c,f,u,p){p===void 0&&(p=!0);var d=[],g,m,E=1,v,y;if(typeof f=="string"){if(y=f,!c.exists(y))return d;var T=c.get(y),A=T.getFrameNames();p&&h(A),f=[],A.forEach(function(R){f.push({key:y,frame:R})})}if(!Array.isArray(f)||f.length===0)return d;for(v=0;v<f.length;v++){var x=f[v],_=a(x,"key",u);if(_){var b=a(x,"frame",0),M=c.getFrame(_,b);M&&(m=new o(_,b,E,M),m.duration=a(x,"duration",0),m.isFirst=!g,g&&(g.nextFrame=m,m.prevFrame=g),d.push(m),g=m,E++)}}if(d.length>0){m.isLast=!0,m.nextFrame=d[0],d[0].prevFrame=m;var w=1/(d.length-1);for(v=0;v<d.length;v++)d[v].progress=v*w}return d},getNextTick:function(c){c.accumulator-=c.nextTick,c.nextTick=c.msPerFrame||c.currentFrame.duration},getFrameByProgress:function(c){return c=i(c,0,1),r(c,this.frames,"progress")},nextFrame:function(c){var f=c.currentFrame;f.isLast?c.yoyo?this.handleYoyoFrame(c,!1):c.repeatCounter>0?c.inReverse&&c.forward?c.forward=!1:this.repeatAnimation(c):c.complete():this.updateAndGetNextTick(c,f.nextFrame)},handleYoyoFrame:function(c,f){if(f||(f=!1),c.inReverse===!f&&c.repeatCounter>0){(c.repeatDelay===0||c.pendingRepeat)&&(c.forward=f),this.repeatAnimation(c);return}if(c.inReverse!==f&&c.repeatCounter===0){c.complete();return}c.forward=f;var u=f?c.currentFrame.nextFrame:c.currentFrame.prevFrame;this.updateAndGetNextTick(c,u)},getLastFrame:function(){return this.frames[this.frames.length-1]},previousFrame:function(c){var f=c.currentFrame;f.isFirst?c.yoyo?this.handleYoyoFrame(c,!0):c.repeatCounter>0?c.inReverse&&!c.forward?this.repeatAnimation(c):(c.forward=!0,this.repeatAnimation(c)):c.complete():this.updateAndGetNextTick(c,f.prevFrame)},updateAndGetNextTick:function(c,f){c.setCurrentFrame(f),this.getNextTick(c)},removeFrame:function(c){var f=this.frames.indexOf(c);return f!==-1&&this.removeFrameAt(f),this},removeFrameAt:function(c){return this.frames.splice(c,1),this.updateFrameSequence(),this},repeatAnimation:function(c){if(c._pendingStop===2){if(c._pendingStopValue===0)return c.stop();c._pendingStopValue--}c.repeatDelay>0&&!c.pendingRepeat?(c.pendingRepeat=!0,c.accumulator-=c.nextTick,c.nextTick+=c.repeatDelay):(c.repeatCounter--,c.forward?c.setCurrentFrame(c.currentFrame.nextFrame):c.setCurrentFrame(c.currentFrame.prevFrame),c.isPlaying&&(this.getNextTick(c),c.handleRepeat()))},toJSON:function(){var c={key:this.key,type:this.type,frames:[],frameRate:this.frameRate,duration:this.duration,skipMissedFrames:this.skipMissedFrames,delay:this.delay,repeat:this.repeat,repeatDelay:this.repeatDelay,yoyo:this.yoyo,showBeforeDelay:this.showBeforeDelay,showOnStart:this.showOnStart,randomFrame:this.randomFrame,hideOnComplete:this.hideOnComplete};return this.frames.forEach(function(f){c.frames.push(f.toJSON())}),c},updateFrameSequence:function(){for(var c=this.frames.length,f=1/(c-1),u,p=0;p<c;p++)u=this.frames[p],u.index=p+1,u.isFirst=!1,u.isLast=!1,u.progress=p*f,p===0?(u.isFirst=!0,c===1?(u.isLast=!0,u.nextFrame=u,u.prevFrame=u):(u.isLast=!1,u.prevFrame=this.frames[c-1],u.nextFrame=this.frames[p+1])):p===c-1&&c>1?(u.isLast=!0,u.prevFrame=this.frames[c-2],u.nextFrame=this.frames[0]):c>1&&(u.prevFrame=this.frames[p-1],u.nextFrame=this.frames[p+1]);return this},pause:function(){return this.paused=!0,this},resume:function(){return this.paused=!1,this},destroy:function(){this.manager.off&&(this.manager.off(n.PAUSE_ALL,this.pause,this),this.manager.off(n.RESUME_ALL,this.resume,this)),this.manager.remove(this.key);for(var c=0;c<this.frames.length;c++)this.frames[c].destroy();this.frames=[],this.manager=null}});t.exports=l}),$n=S((e,t)=>{"use strict";var i=V(),s=new i({initialize:function(n){this.entries={},this.size=0,this.setAll(n)},setAll:function(n){if(Array.isArray(n))for(var r=0;r<n.length;r++)this.set(n[r][0],n[r][1]);return this},set:function(n,r){return this.has(n)||this.size++,this.entries[n]=r,this},get:function(n){if(this.has(n))return this.entries[n]},getArray:function(){var n=[],r=this.entries;for(var o in r)n.push(r[o]);return n},has:function(n){return this.entries.hasOwnProperty(n)},delete:function(n){return this.has(n)&&(delete this.entries[n],this.size--),this},clear:function(){return Object.keys(this.entries).forEach(function(n){delete this.entries[n]},this),this.size=0,this},keys:function(){return Object.keys(this.entries)},values:function(){var n=[],r=this.entries;for(var o in r)n.push(r[o]);return n},dump:function(){var n=this.entries;for(var r in n);},each:function(n){var r=this.entries;for(var o in r)if(n(o,r[o])===!1)break;return this},contains:function(n){var r=this.entries;for(var o in r)if(r[o]===n)return!0;return!1},merge:function(n,r){r===void 0&&(r=!1);var o=this.entries,a=n.entries;for(var h in a)o.hasOwnProperty(h)&&r?o[h]=a[h]:this.set(h,a[h]);return this}});t.exports=s}),Oa=S((e,t)=>{"use strict";var i=Ma(),s=Ts(),n=V(),r=$n(),o=mi(),a=pt(),h=new n({initialize:function(l){this.parent=l,this.animationManager=l.scene.sys.anims,this.animationManager.on(o.REMOVE_ANIMATION,this.globalRemove,this),this.textureManager=this.animationManager.textureManager,this.anims=null,this.isPlaying=!1,this.hasStarted=!1,this.currentAnim=null,this.currentFrame=null,this.nextAnim=null,this.nextAnimsQueue=[],this.timeScale=1,this.frameRate=0,this.duration=0,this.msPerFrame=0,this.skipMissedFrames=!0,this.randomFrame=!1,this.delay=0,this.repeat=0,this.repeatDelay=0,this.yoyo=!1,this.showBeforeDelay=!1,this.showOnStart=!1,this.hideOnComplete=!1,this.forward=!0,this.inReverse=!1,this.accumulator=0,this.nextTick=0,this.delayCounter=0,this.repeatCounter=0,this.pendingRepeat=!1,this._paused=!1,this._wasPlaying=!1,this._pendingStop=0,this._pendingStopValue},chain:function(l){var c=this.parent;if(l===void 0)return this.nextAnimsQueue.length=0,this.nextAnim=null,c;Array.isArray(l)||(l=[l]);for(var f=0;f<l.length;f++){var u=l[f];this.nextAnim?this.nextAnimsQueue.push(u):this.nextAnim=u}return this.parent},getName:function(){return this.currentAnim?this.currentAnim.key:""},getFrameName:function(){return this.currentFrame?this.currentFrame.textureFrame:""},load:function(l){this.isPlaying&&this.stop();var c=this.animationManager,f=typeof l=="string"?l:a(l,"key",null),u=this.exists(f)?this.get(f):c.get(f);if(u){this.currentAnim=u;var p=u.getTotalFrames(),d=a(l,"frameRate",u.frameRate),g=a(l,"duration",u.duration);u.calculateDuration(this,p,g,d),this.delay=a(l,"delay",u.delay),this.repeat=a(l,"repeat",u.repeat),this.repeatDelay=a(l,"repeatDelay",u.repeatDelay),this.yoyo=a(l,"yoyo",u.yoyo),this.showBeforeDelay=a(l,"showBeforeDelay",u.showBeforeDelay),this.showOnStart=a(l,"showOnStart",u.showOnStart),this.hideOnComplete=a(l,"hideOnComplete",u.hideOnComplete),this.skipMissedFrames=a(l,"skipMissedFrames",u.skipMissedFrames),this.randomFrame=a(l,"randomFrame",u.randomFrame),this.timeScale=a(l,"timeScale",this.timeScale);var m=a(l,"startFrame",0);m>p&&(m=0),this.randomFrame&&(m=s(0,p-1));var E=u.frames[m];m===0&&!this.forward&&(E=u.getLastFrame()),this.currentFrame=E}return this.parent},pause:function(l){return this._paused||(this._paused=!0,this._wasPlaying=this.isPlaying,this.isPlaying=!1),l!==void 0&&this.setCurrentFrame(l),this.parent},resume:function(l){return this._paused&&(this._paused=!1,this.isPlaying=this._wasPlaying),l!==void 0&&this.setCurrentFrame(l),this.parent},playAfterDelay:function(l,c){if(!this.isPlaying)this.delayCounter=c,this.play(l,!0);else{var f=this.nextAnim,u=this.nextAnimsQueue;f&&u.unshift(f),this.nextAnim=l,this._pendingStop=1,this._pendingStopValue=c}return this.parent},playAfterRepeat:function(l,c){if(c===void 0&&(c=1),!this.isPlaying)this.play(l);else{var f=this.nextAnim,u=this.nextAnimsQueue;f&&u.unshift(f),this.repeatCounter!==-1&&c>this.repeatCounter&&(c=this.repeatCounter),this.nextAnim=l,this._pendingStop=2,this._pendingStopValue=c}return this.parent},play:function(l,c){c===void 0&&(c=!1);var f=this.currentAnim,u=this.parent,p=typeof l=="string"?l:l.key;if(c&&this.isPlaying&&f.key===p)return u;if(f&&this.isPlaying){var d=this.animationManager.getMix(f.key,l);if(d>0)return this.playAfterDelay(l,d)}return this.forward=!0,this.inReverse=!1,this._paused=!1,this._wasPlaying=!0,this.startAnimation(l)},playReverse:function(l,c){c===void 0&&(c=!1);var f=typeof l=="string"?l:l.key;return c&&this.isPlaying&&this.currentAnim.key===f?this.parent:(this.forward=!1,this.inReverse=!0,this._paused=!1,this._wasPlaying=!0,this.startAnimation(l))},startAnimation:function(l){this.load(l);var c=this.currentAnim,f=this.parent;return c&&(this.repeatCounter=this.repeat===-1?Number.MAX_VALUE:this.repeat,c.getFirstTick(this),this.isPlaying=!0,this.pendingRepeat=!1,this.hasStarted=!1,this._pendingStop=0,this._pendingStopValue=0,this._paused=!1,this.delayCounter+=this.delay,this.delayCounter===0?this.handleStart():this.showBeforeDelay&&this.setCurrentFrame(this.currentFrame)),f},handleStart:function(){this.showOnStart&&this.parent.setVisible(!0),this.setCurrentFrame(this.currentFrame),this.hasStarted=!0,this.emitEvents(o.ANIMATION_START)},handleRepeat:function(){this.pendingRepeat=!1,this.emitEvents(o.ANIMATION_REPEAT)},handleStop:function(){this._pendingStop=0,this.isPlaying=!1,this.emitEvents(o.ANIMATION_STOP)},handleComplete:function(){this._pendingStop=0,this.isPlaying=!1,this.hideOnComplete&&this.parent.setVisible(!1),this.emitEvents(o.ANIMATION_COMPLETE,o.ANIMATION_COMPLETE_KEY)},emitEvents:function(l,c){var f=this.currentAnim;if(f){var u=this.currentFrame,p=this.parent,d=u.textureFrame;p.emit(l,f,u,p,d),c&&p.emit(c+f.key,f,u,p,d)}},reverse:function(){return this.isPlaying&&(this.inReverse=!this.inReverse,this.forward=!this.forward),this.parent},getProgress:function(){var l=this.currentFrame;if(!l)return 0;var c=l.progress;return this.inReverse&&(c*=-1),c},setProgress:function(l){return this.forward||(l=1-l),this.setCurrentFrame(this.currentAnim.getFrameByProgress(l)),this.parent},setRepeat:function(l){return this.repeatCounter=l===-1?Number.MAX_VALUE:l,this.parent},globalRemove:function(l,c){c===void 0&&(c=this.currentAnim),this.isPlaying&&c.key===this.currentAnim.key&&(this.stop(),this.setCurrentFrame(this.currentAnim.frames[0]))},restart:function(l,c){l===void 0&&(l=!1),c===void 0&&(c=!1);var f=this.currentAnim,u=this.parent;return f?(c&&(this.repeatCounter=this.repeat===-1?Number.MAX_VALUE:this.repeat),f.getFirstTick(this),this.emitEvents(o.ANIMATION_RESTART),this.isPlaying=!0,this.pendingRepeat=!1,this.hasStarted=!l,this._pendingStop=0,this._pendingStopValue=0,this._paused=!1,this.setCurrentFrame(f.frames[0]),this.parent):u},complete:function(){if(this._pendingStop=0,this.isPlaying=!1,this.currentAnim&&this.handleComplete(),this.nextAnim){var l=this.nextAnim;this.nextAnim=this.nextAnimsQueue.length>0?this.nextAnimsQueue.shift():null,this.play(l)}return this.parent},stop:function(){if(this._pendingStop=0,this.isPlaying=!1,this.delayCounter=0,this.currentAnim&&this.handleStop(),this.nextAnim){var l=this.nextAnim;this.nextAnim=this.nextAnimsQueue.shift(),this.play(l)}return this.parent},stopAfterDelay:function(l){return this._pendingStop=1,this._pendingStopValue=l,this.parent},stopAfterRepeat:function(l){return l===void 0&&(l=1),this.repeatCounter!==-1&&l>this.repeatCounter&&(l=this.repeatCounter),this._pendingStop=2,this._pendingStopValue=l,this.parent},stopOnFrame:function(l){return this._pendingStop=3,this._pendingStopValue=l,this.parent},getTotalFrames:function(){return this.currentAnim?this.currentAnim.getTotalFrames():0},update:function(l,c){var f=this.currentAnim;if(!(!this.isPlaying||!f||f.paused)){if(this.accumulator+=c*this.timeScale*this.animationManager.globalTimeScale,this._pendingStop===1&&(this._pendingStopValue-=c,this._pendingStopValue<=0))return this.stop();if(!this.hasStarted)this.accumulator>=this.delayCounter&&(this.accumulator-=this.delayCounter,this.handleStart());else if(this.accumulator>=this.nextTick&&(this.forward?f.nextFrame(this):f.previousFrame(this),this.isPlaying&&this._pendingStop===0&&this.skipMissedFrames&&this.accumulator>this.nextTick)){var u=0;do this.forward?f.nextFrame(this):f.previousFrame(this),u++;while(this.isPlaying&&this.accumulator>this.nextTick&&u<60)}}},setCurrentFrame:function(l){var c=this.parent;return this.currentFrame=l,c.texture=l.frame.texture,c.frame=l.frame,c.isCropped&&c.frame.updateCropUVs(c._crop,c.flipX,c.flipY),l.setAlpha&&(c.alpha=l.alpha),c.setSizeToFrame(),c._originComponent&&(l.frame.customPivot?c.setOrigin(l.frame.pivotX,l.frame.pivotY):c.updateDisplayOrigin()),this.isPlaying&&this.hasStarted&&(this.emitEvents(o.ANIMATION_UPDATE),this._pendingStop===3&&this._pendingStopValue===l&&this.stop()),c},nextFrame:function(){return this.currentAnim&&this.currentAnim.nextFrame(this),this.parent},previousFrame:function(){return this.currentAnim&&this.currentAnim.previousFrame(this),this.parent},get:function(l){return this.anims?this.anims.get(l):null},exists:function(l){return this.anims?this.anims.has(l):!1},create:function(l){var c=l.key,f=!1;return c&&(f=this.get(c),f||(f=new i(this,c,l),this.anims||(this.anims=new r),this.anims.set(c,f))),f},createFromAseprite:function(l,c){return this.animationManager.createFromAseprite(l,c,this.parent)},generateFrameNames:function(l,c){return this.animationManager.generateFrameNames(l,c)},generateFrameNumbers:function(l,c){return this.animationManager.generateFrameNumbers(l,c)},remove:function(l){var c=this.get(l);return c&&(this.currentAnim===c&&this.stop(),this.anims.delete(l)),c},destroy:function(){this.animationManager.off(o.REMOVE_ANIMATION,this.globalRemove,this),this.anims&&this.anims.clear(),this.animationManager=null,this.parent=null,this.nextAnim=null,this.nextAnimsQueue.length=0,this.currentAnim=null,this.currentFrame=null},isPaused:{get:function(){return this._paused}}});t.exports=h}),mS=S((e,t)=>{"use strict";var i=function(s,n,r,o){r.addToRenderList(n),n.pipeline.batchSprite(n,r,o)};t.exports=i}),vS=S((e,t)=>{"use strict";var i=Lt(),s=i,n=i;s=mS(),t.exports={renderWebGL:s,renderCanvas:n}}),tr=S((e,t)=>{"use strict";var i=Oa(),s=V(),n=me(),r=Fe(),o=vS(),a=new s({Extends:r,Mixins:[n.Alpha,n.BlendMode,n.Depth,n.Flip,n.GetBounds,n.Mask,n.Origin,n.Pipeline,n.PostPipeline,n.ScrollFactor,n.Size,n.TextureCrop,n.Tint,n.Transform,n.Visible,o],initialize:function(h,l,c,f,u){r.call(this,h,"Sprite"),this._crop=this.resetCropObject(),this.anims=new i(this),this.setTexture(f,u),this.setPosition(l,c),this.setSizeToFrame(),this.setOriginFromFrame(),this.initPipeline(),this.initPostPipeline(!0)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},preUpdate:function(h,l){this.anims.update(h,l)},play:function(h,l){return this.anims.play(h,l)},playReverse:function(h,l){return this.anims.playReverse(h,l)},playAfterDelay:function(h,l){return this.anims.playAfterDelay(h,l)},playAfterRepeat:function(h,l){return this.anims.playAfterRepeat(h,l)},chain:function(h){return this.anims.chain(h)},stop:function(){return this.anims.stop()},stopAfterDelay:function(h){return this.anims.stopAfterDelay(h)},stopAfterRepeat:function(h){return this.anims.stopAfterRepeat(h)},stopOnFrame:function(h){return this.anims.stopOnFrame(h)},toJSON:function(){return n.ToJSON(this)},preDestroy:function(){this.anims.destroy(),this.anims=void 0}});t.exports=a}),Da=S((e,t)=>{"use strict";var i=nS(),s=V(),n=Vi(),r=Wt(),o=oa(),a=pt(),h=Mt(),l=Cu(),c=oe(),f=Fh(),u=_u(),p=tr(),d=new s({Extends:r,initialize:function(g,m,E){r.call(this),E?m&&!Array.isArray(m)&&(m=[m]):Array.isArray(m)?c(m[0])&&(E=m,m=null):c(m)&&(E=m,m=null),this.scene=g,this.children=new u,this.isParent=!0,this.type="Group",this.classType=a(E,"classType",p),this.name=a(E,"name",""),this.active=a(E,"active",!0),this.maxSize=a(E,"maxSize",-1),this.defaultKey=a(E,"defaultKey",null),this.defaultFrame=a(E,"defaultFrame",null),this.runChildUpdate=a(E,"runChildUpdate",!1),this.createCallback=a(E,"createCallback",null),this.removeCallback=a(E,"removeCallback",null),this.createMultipleCallback=a(E,"createMultipleCallback",null),this.internalCreateCallback=a(E,"internalCreateCallback",null),this.internalRemoveCallback=a(E,"internalRemoveCallback",null),m&&this.addMultiple(m),E&&this.createMultiple(E),this.on(n.ADDED_TO_SCENE,this.addedToScene,this),this.on(n.REMOVED_FROM_SCENE,this.removedFromScene,this)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},create:function(g,m,E,v,y,T){if(g===void 0&&(g=0),m===void 0&&(m=0),E===void 0&&(E=this.defaultKey),v===void 0&&(v=this.defaultFrame),y===void 0&&(y=!0),T===void 0&&(T=!0),this.isFull())return null;var A=new this.classType(this.scene,g,m,E,v);return A.addToDisplayList(this.scene.sys.displayList),A.addToUpdateList(),A.visible=y,A.setActive(T),this.add(A),A},createMultiple:function(g){if(this.isFull())return[];Array.isArray(g)||(g=[g]);var m=[];if(g[0].key)for(var E=0;E<g.length;E++){var v=this.createFromConfig(g[E]);m=m.concat(v)}return m},createFromConfig:function(g){if(this.isFull())return[];this.classType=a(g,"classType",this.classType);var m=a(g,"key",void 0),E=a(g,"frame",null),v=a(g,"visible",!0),y=a(g,"active",!0),T=[];if(m===void 0)return T;Array.isArray(m)||(m=[m]),Array.isArray(E)||(E=[E]);var A=a(g,"repeat",0),x=a(g,"randomKey",!1),_=a(g,"randomFrame",!1),b=a(g,"yoyo",!1),M=a(g,"quantity",!1),w=a(g,"frameQuantity",1),R=a(g,"max",0),I=f(m,E,{max:R,qty:M||w,random:x,randomB:_,repeat:A,yoyo:b});g.createCallback&&(this.createCallback=g.createCallback),g.removeCallback&&(this.removeCallback=g.removeCallback),g.internalCreateCallback&&(this.internalCreateCallback=g.internalCreateCallback),g.internalRemoveCallback&&(this.internalRemoveCallback=g.internalRemoveCallback);for(var O=0;O<I.length;O++){var D=this.create(0,0,I[O].a,I[O].b,v,y);if(!D)break;T.push(D)}if(l(g,"setXY")){var N=h(g,"setXY.x",0),F=h(g,"setXY.y",0),G=h(g,"setXY.stepX",0),L=h(g,"setXY.stepY",0);i.SetXY(T,N,F,G,L)}if(l(g,"setRotation")){var C=h(g,"setRotation.value",0),P=h(g,"setRotation.step",0);i.SetRotation(T,C,P)}if(l(g,"setScale")){var k=h(g,"setScale.x",1),B=h(g,"setScale.y",k),Y=h(g,"setScale.stepX",0),H=h(g,"setScale.stepY",0);i.SetScale(T,k,B,Y,H)}if(l(g,"setOrigin")){var z=h(g,"setOrigin.x",.5),K=h(g,"setOrigin.y",z),X=h(g,"setOrigin.stepX",0),et=h(g,"setOrigin.stepY",0);i.SetOrigin(T,z,K,X,et)}if(l(g,"setAlpha")){var J=h(g,"setAlpha.value",1),st=h(g,"setAlpha.step",0);i.SetAlpha(T,J,st)}if(l(g,"setDepth")){var q=h(g,"setDepth.value",0),ht=h(g,"setDepth.step",0);i.SetDepth(T,q,ht)}if(l(g,"setScrollFactor")){var Pt=h(g,"setScrollFactor.x",1),Bt=h(g,"setScrollFactor.y",Pt),Ct=h(g,"setScrollFactor.stepX",0),Vt=h(g,"setScrollFactor.stepY",0);i.SetScrollFactor(T,Pt,Bt,Ct,Vt)}var lt=a(g,"hitArea",null),vt=a(g,"hitAreaCallback",null);lt&&i.SetHitArea(T,lt,vt);var gs=a(g,"gridAlign",!1);return gs&&i.GridAlign(T,gs),this.createMultipleCallback&&this.createMultipleCallback.call(this,T),T},preUpdate:function(g,m){if(!(!this.runChildUpdate||this.children.size===0))for(var E=this.children.entries.slice(),v=0;v<E.length;v++){var y=E[v];y.active&&y.update(g,m)}},add:function(g,m){return m===void 0&&(m=!1),this.isFull()?this:(this.children.set(g),this.internalCreateCallback&&this.internalCreateCallback.call(this,g),this.createCallback&&this.createCallback.call(this,g),m&&(g.addToDisplayList(this.scene.sys.displayList),g.addToUpdateList()),g.on(n.DESTROY,this.remove,this),this)},addMultiple:function(g,m){if(m===void 0&&(m=!1),Array.isArray(g))for(var E=0;E<g.length;E++)this.add(g[E],m);return this},remove:function(g,m,E){return m===void 0&&(m=!1),E===void 0&&(E=!1),this.children.contains(g)?(this.children.delete(g),this.internalRemoveCallback&&this.internalRemoveCallback.call(this,g),this.removeCallback&&this.removeCallback.call(this,g),g.off(n.DESTROY,this.remove,this),E?g.destroy():m&&(g.removeFromDisplayList(),g.removeFromUpdateList()),this):this},clear:function(g,m){g===void 0&&(g=!1),m===void 0&&(m=!1);for(var E=this.children,v=0;v<E.size;v++){var y=E.entries[v];y.off(n.DESTROY,this.remove,this),m?y.destroy():g&&(y.removeFromDisplayList(),y.removeFromUpdateList())}return this.children.clear(),this},contains:function(g){return this.children.contains(g)},getChildren:function(){return this.children.entries},getLength:function(){return this.children.size},getMatching:function(g,m,E,v){return o(this.children.entries,g,m,E,v)},getFirst:function(g,m,E,v,y,T,A){return this.getHandler(!0,1,g,m,E,v,y,T,A)},getFirstNth:function(g,m,E,v,y,T,A,x){return this.getHandler(!0,g,m,E,v,y,T,A,x)},getLast:function(g,m,E,v,y,T,A){return this.getHandler(!1,1,g,m,E,v,y,T,A)},getLastNth:function(g,m,E,v,y,T,A,x){return this.getHandler(!1,g,m,E,v,y,T,A,x)},getHandler:function(g,m,E,v,y,T,A,x,_){E===void 0&&(E=!1),v===void 0&&(v=!1);var b,M,w=0,R=this.children.entries;if(g)for(M=0;M<R.length;M++)if(b=R[M],b.active===E){if(w++,w===m)break}else b=null;else for(M=R.length-1;M>=0;M--)if(b=R[M],b.active===E){if(w++,w===m)break}else b=null;return b?(typeof y=="number"&&(b.x=y),typeof T=="number"&&(b.y=T),b):v?this.create(y,T,A,x,_):null},get:function(g,m,E,v,y){return this.getFirst(!1,!0,g,m,E,v,y)},getFirstAlive:function(g,m,E,v,y,T){return this.getFirst(!0,g,m,E,v,y,T)},getFirstDead:function(g,m,E,v,y,T){return this.getFirst(!1,g,m,E,v,y,T)},playAnimation:function(g,m){return i.PlayAnimation(this.children.entries,g,m),this},isFull:function(){return this.maxSize===-1?!1:this.children.size>=this.maxSize},countActive:function(g){g===void 0&&(g=!0);for(var m=0,E=0;E<this.children.size;E++)this.children.entries[E].active===g&&m++;return m},getTotalUsed:function(){return this.countActive()},getTotalFree:function(){var g=this.getTotalUsed(),m=this.maxSize===-1?999999999999:this.maxSize;return m-g},setActive:function(g){return this.active=g,this},setName:function(g){return this.name=g,this},propertyValueSet:function(g,m,E,v,y){return i.PropertyValueSet(this.children.entries,g,m,E,v,y),this},propertyValueInc:function(g,m,E,v,y){return i.PropertyValueInc(this.children.entries,g,m,E,v,y),this},setX:function(g,m){return i.SetX(this.children.entries,g,m),this},setY:function(g,m){return i.SetY(this.children.entries,g,m),this},setXY:function(g,m,E,v){return i.SetXY(this.children.entries,g,m,E,v),this},incX:function(g,m){return i.IncX(this.children.entries,g,m),this},incY:function(g,m){return i.IncY(this.children.entries,g,m),this},incXY:function(g,m,E,v){return i.IncXY(this.children.entries,g,m,E,v),this},shiftPosition:function(g,m,E){return i.ShiftPosition(this.children.entries,g,m,E),this},angle:function(g,m){return i.Angle(this.children.entries,g,m),this},rotate:function(g,m){return i.Rotate(this.children.entries,g,m),this},rotateAround:function(g,m){return i.RotateAround(this.children.entries,g,m),this},rotateAroundDistance:function(g,m,E){return i.RotateAroundDistance(this.children.entries,g,m,E),this},setAlpha:function(g,m){return i.SetAlpha(this.children.entries,g,m),this},setTint:function(g,m,E,v){return i.SetTint(this.children.entries,g,m,E,v),this},setOrigin:function(g,m,E,v){return i.SetOrigin(this.children.entries,g,m,E,v),this},scaleX:function(g,m){return i.ScaleX(this.children.entries,g,m),this},scaleY:function(g,m){return i.ScaleY(this.children.entries,g,m),this},scaleXY:function(g,m,E,v){return i.ScaleXY(this.children.entries,g,m,E,v),this},setDepth:function(g,m){return i.SetDepth(this.children.entries,g,m),this},setBlendMode:function(g){return i.SetBlendMode(this.children.entries,g),this},setHitArea:function(g,m){return i.SetHitArea(this.children.entries,g,m),this},shuffle:function(){return i.Shuffle(this.children.entries),this},kill:function(g){this.children.contains(g)&&g.setActive(!1)},killAndHide:function(g){this.children.contains(g)&&(g.setActive(!1),g.setVisible(!1))},setVisible:function(g,m,E){return i.SetVisible(this.children.entries,g,m,E),this},toggleVisible:function(){return i.ToggleVisible(this.children.entries),this},destroy:function(g,m){g===void 0&&(g=!1),m===void 0&&(m=!1),!(!this.scene||this.ignoreDestroy)&&(this.emit(n.DESTROY,this),this.removeAllListeners(),this.scene.sys.updateList.remove(this),this.clear(m,g),this.scene=void 0,this.children=void 0)}});t.exports=d}),ES=S((e,t)=>{"use strict";var i=function(s,n,r,o){r.addToRenderList(n),this.pipeline.batchSprite(n,r,o)};t.exports=i}),yS=S((e,t)=>{"use strict";var i=Lt(),s=i,n=i;s=ES(),t.exports={renderWebGL:s,renderCanvas:n}}),er=S((e,t)=>{"use strict";var i=V(),s=me(),n=Fe(),r=yS(),o=new i({Extends:n,Mixins:[s.Alpha,s.BlendMode,s.Depth,s.Flip,s.GetBounds,s.Mask,s.Origin,s.Pipeline,s.PostPipeline,s.ScrollFactor,s.Size,s.TextureCrop,s.Tint,s.Transform,s.Visible,r],initialize:function(a,h,l,c,f){n.call(this,a,"Image"),this._crop=this.resetCropObject(),this.setTexture(c,f),this.setPosition(h,l),this.setSizeToFrame(),this.setOriginFromFrame(),this.initPipeline(),this.initPostPipeline(!0)}});t.exports=o}),ir=S((e,t)=>{"use strict";var i=Gl(),s=Hl(),n=zl(),r={bezier:i,catmull:s,catmullrom:s,linear:n},o=function(a){if(a===null)return null;var h=r.linear;return typeof a=="string"?r.hasOwnProperty(a)&&(h=r[a]):typeof a=="function"&&(h=a),h};t.exports=o}),TS=S((e,t)=>{"use strict";var i=function(s,n,r,o){return r===void 0&&(r=0),n===0?s:(s-=r,s=n*Math.round(s/n),o?(r+s)/n:r+s)};t.exports=i}),ka=S((e,t)=>{"use strict";var i=Ts(),s=Xt(),n=V(),r=on(),o=ji(),a=pt(),h=ir(),l=TS(),c=rn(),f=new n({initialize:function(u,p,d){d===void 0&&(d=!1),this.propertyKey=u,this.propertyValue=p,this.defaultValue=p,this.steps=0,this.counter=0,this.yoyo=!1,this.direction=0,this.start=0,this.current=0,this.end=0,this.ease=null,this.interpolation=null,this.emitOnly=d,this.onEmit=this.defaultEmit,this.onUpdate=this.defaultUpdate,this.active=!0,this.method=0,this._onEmit,this._onUpdate},loadConfig:function(u,p){u===void 0&&(u={}),p&&(this.propertyKey=p),this.propertyValue=a(u,this.propertyKey,this.defaultValue),this.method=this.getMethod(),this.setMethods(),this.emitOnly&&(this.onUpdate=this.defaultUpdate)},toJSON:function(){return JSON.stringify(this.propertyValue)},onChange:function(u){var p;switch(this.method){case 1:case 3:case 8:p=u;break;case 2:this.propertyValue.indexOf(u)>=0&&(p=u);break;case 4:var d=(this.end-this.start)/this.steps;p=l(u,d),this.counter=p;break;case 5:case 6:case 7:p=s(u,this.start,this.end);break;case 9:p=this.start[0];break}return this.current=p,this},getMethod:function(){var u=this.propertyValue;if(u===null)return 0;var p=typeof u;if(p==="number")return 1;if(Array.isArray(u))return 2;if(p==="function")return 3;if(p==="object"){if(this.hasBoth(u,"start","end"))return this.has(u,"steps")?4:5;if(this.hasBoth(u,"min","max"))return 6;if(this.has(u,"random"))return 7;if(this.hasEither(u,"onEmit","onUpdate"))return 8;if(this.hasEither(u,"values","interpolation"))return 9}return 0},setMethods:function(){var u=this.propertyValue,p=u,d=this.defaultEmit,g=this.defaultUpdate;switch(this.method){case 1:d=this.staticValueEmit;break;case 2:d=this.randomStaticValueEmit,p=u[0];break;case 3:this._onEmit=u,d=this.proxyEmit,p=this.defaultValue;break;case 4:this.start=u.start,this.end=u.end,this.steps=u.steps,this.counter=this.start,this.yoyo=this.has(u,"yoyo")?u.yoyo:!1,this.direction=0,d=this.steppedEmit,p=this.start;break;case 5:this.start=u.start,this.end=u.end;var m=this.has(u,"ease")?u.ease:"Linear";this.ease=o(m,u.easeParams),d=this.has(u,"random")&&u.random?this.randomRangedValueEmit:this.easedValueEmit,g=this.easeValueUpdate,p=this.start;break;case 6:this.start=u.min,this.end=u.max,d=this.has(u,"int")&&u.int?this.randomRangedIntEmit:this.randomRangedValueEmit,p=this.start;break;case 7:var E=u.random;Array.isArray(E)&&(this.start=E[0],this.end=E[1]),d=this.randomRangedIntEmit,p=this.start;break;case 8:this._onEmit=this.has(u,"onEmit")?u.onEmit:this.defaultEmit,this._onUpdate=this.has(u,"onUpdate")?u.onUpdate:this.defaultUpdate,d=this.proxyEmit,g=this.proxyUpdate,p=this.defaultValue;break;case 9:this.start=u.values;var v=this.has(u,"ease")?u.ease:"Linear";this.ease=o(v,u.easeParams),this.interpolation=h(u.interpolation),d=this.easedValueEmit,g=this.easeValueUpdate,p=this.start[0];break}return this.onEmit=d,this.onUpdate=g,this.current=p,this},has:function(u,p){return u.hasOwnProperty(p)},hasBoth:function(u,p,d){return u.hasOwnProperty(p)&&u.hasOwnProperty(d)},hasEither:function(u,p,d){return u.hasOwnProperty(p)||u.hasOwnProperty(d)},defaultEmit:function(){return this.defaultValue},defaultUpdate:function(u,p,d,g){return g},proxyEmit:function(u,p,d){var g=this._onEmit(u,p,d);return this.current=g,g},proxyUpdate:function(u,p,d,g){var m=this._onUpdate(u,p,d,g);return this.current=m,m},staticValueEmit:function(){return this.current},staticValueUpdate:function(){return this.current},randomStaticValueEmit:function(){var u=Math.floor(Math.random()*this.propertyValue.length);return this.current=this.propertyValue[u],this.current},randomRangedValueEmit:function(u,p){var d=r(this.start,this.end);return u&&u.data[p]&&(u.data[p].min=d,u.data[p].max=this.end),this.current=d,d},randomRangedIntEmit:function(u,p){var d=i(this.start,this.end);return u&&u.data[p]&&(u.data[p].min=d,u.data[p].max=this.end),this.current=d,d},steppedEmit:function(){var u=this.counter,p=u,d=(this.end-this.start)/this.steps;if(this.yoyo){var g;this.direction===0?(p+=d,p>=this.end&&(g=p-this.end,p=this.end-g,this.direction=1)):(p-=d,p<=this.start&&(g=this.start-p,p=this.start+g,this.direction=0)),this.counter=p}else this.counter=c(p+d,this.start,this.end);return this.current=u,u},easedValueEmit:function(u,p){if(u&&u.data[p]){var d=u.data[p];d.min=this.start,d.max=this.end}return this.current=this.start,this.start},easeValueUpdate:function(u,p,d){var g=u.data[p],m,E=this.ease(d);return this.interpolation?m=this.interpolation(this.start,E):m=(g.max-g.min)*E+g.min,this.current=m,m},destroy:function(){this.propertyValue=null,this.defaultValue=null,this.ease=null,this.interpolation=null,this._onEmit=null,this._onUpdate=null}});t.exports=f}),Pu=S((e,t)=>{"use strict";var i=V(),s=ka(),n=ys(),r=ji(),o=ir(),a=va(),h=new i({Extends:s,initialize:function(l){s.call(this,l,null,!1),this.active=!1,this.easeName="Linear",this.r=[],this.g=[],this.b=[]},getMethod:function(){return this.propertyValue===null?0:9},setMethods:function(){var l=this.propertyValue,c=l,f=this.defaultEmit,u=this.defaultUpdate;if(this.method===9){this.start=l[0],this.ease=r("Linear"),this.interpolation=o("linear"),f=this.easedValueEmit,u=this.easeValueUpdate,c=l[0],this.active=!0;for(var p=0;p<l.length;p++){var d=a(l[p]);this.r.push(d.r),this.g.push(d.g),this.b.push(d.b)}}return this.onEmit=f,this.onUpdate=u,this.current=c,this},setEase:function(l){this.easeName=l,this.ease=r(l)},easedValueEmit:function(){return this.current=this.start,this.start},easeValueUpdate:function(l,c,f){var u=this.ease(f),p=this.interpolation(this.r,u),d=this.interpolation(this.g,u),g=this.interpolation(this.b,u),m=n(p,d,g);return this.current=m,m}});t.exports=h}),SS=S((e,t)=>{"use strict";t.exports="complete"}),AS=S((e,t)=>{"use strict";t.exports="deathzone"}),xS=S((e,t)=>{"use strict";t.exports="explode"}),wS=S((e,t)=>{"use strict";t.exports="start"}),RS=S((e,t)=>{"use strict";t.exports="stop"}),Lu=S((e,t)=>{"use strict";t.exports={COMPLETE:SS(),DEATH_ZONE:AS(),EXPLODE:xS(),START:wS(),STOP:RS()}}),Ba=S((e,t)=>{"use strict";var i=V(),s=new i({initialize:function(n,r,o){n===void 0&&(n=0),r===void 0&&(r=0),o===void 0&&(o=!0),this.emitter,this.x=n,this.y=r,this.active=o},update:function(){},destroy:function(){this.emitter=null}});t.exports=s}),Iu=S((e,t)=>{"use strict";var i=V(),s=pt(),n=Ba(),r=new i({Extends:n,initialize:function(o,a,h,l,c){if(typeof o=="object"){var f=o;o=s(f,"x",0),a=s(f,"y",0),h=s(f,"power",0),l=s(f,"epsilon",100),c=s(f,"gravity",50)}else o===void 0&&(o=0),a===void 0&&(a=0),h===void 0&&(h=0),l===void 0&&(l=100),c===void 0&&(c=50);n.call(this,o,a,!0),this._gravity=c,this._power=h*c,this._epsilon=l*l},update:function(o,a){var h=this.x-o.x,l=this.y-o.y,c=h*h+l*l;if(c!==0){var f=Math.sqrt(c);c<this._epsilon&&(c=this._epsilon);var u=this._power*a/(c*f)*100;o.velocityX+=h*u,o.velocityY+=l*u}},epsilon:{get:function(){return Math.sqrt(this._epsilon)},set:function(o){this._epsilon=o*o}},power:{get:function(){return this._power/this._gravity},set:function(o){this._power=o*this._gravity}},gravity:{get:function(){return this._gravity},set:function(o){var a=this.power;this._gravity=o,this.power=a}}});t.exports=r}),Mu=S((e,t)=>{"use strict";var i=Oa(),s=Xt(),n=V(),r=an(),o=zt(),a=Kh(),h=Ot(),l=new n({initialize:function(c){this.emitter=c,this.texture=null,this.frame=null,this.x=0,this.y=0,this.worldPosition=new h,this.velocityX=0,this.velocityY=0,this.accelerationX=0,this.accelerationY=0,this.maxVelocityX=1e4,this.maxVelocityY=1e4,this.bounce=0,this.scaleX=1,this.scaleY=1,this.alpha=1,this.angle=0,this.rotation=0,this.tint=16777215,this.life=1e3,this.lifeCurrent=1e3,this.delayCurrent=0,this.holdCurrent=0,this.lifeT=0,this.data={tint:{min:16777215,max:16777215},alpha:{min:1,max:1},rotate:{min:0,max:0},scaleX:{min:1,max:1},scaleY:{min:1,max:1},x:{min:0,max:0},y:{min:0,max:0},accelerationX:{min:0,max:0},accelerationY:{min:0,max:0},maxVelocityX:{min:0,max:0},maxVelocityY:{min:0,max:0},moveToX:{min:0,max:0},moveToY:{min:0,max:0},bounce:{min:0,max:0}},this.isCropped=!1,this.scene=c.scene,this.anims=null,this.emitter.anims.length>0&&(this.anims=new i(this)),this.bounds=new o},emit:function(c,f,u,p,d,g){return this.emitter.emit(c,f,u,p,d,g)},isAlive:function(){return this.lifeCurrent>0},kill:function(){this.lifeCurrent=0},setPosition:function(c,f){c===void 0&&(c=0),f===void 0&&(f=0),this.x=c,this.y=f},fire:function(c,f){var u=this.emitter,p=u.ops,d=u.getAnim();if(d?this.anims.play(d):(this.frame=u.getFrame(),this.texture=this.frame.texture),!this.frame)throw new Error("Particle has no texture frame");if(u.getEmitZone(this),c===void 0?this.x+=p.x.onEmit(this,"x"):p.x.steps>0?this.x+=c+p.x.onEmit(this,"x"):this.x+=c,f===void 0?this.y+=p.y.onEmit(this,"y"):p.y.steps>0?this.y+=f+p.y.onEmit(this,"y"):this.y+=f,this.life=p.lifespan.onEmit(this,"lifespan"),this.lifeCurrent=this.life,this.lifeT=0,this.delayCurrent=p.delay.onEmit(this,"delay"),this.holdCurrent=p.hold.onEmit(this,"hold"),this.scaleX=p.scaleX.onEmit(this,"scaleX"),this.scaleY=p.scaleY.active?p.scaleY.onEmit(this,"scaleY"):this.scaleX,this.angle=p.rotate.onEmit(this,"rotate"),this.rotation=r(this.angle),u.worldMatrix.transformPoint(this.x,this.y,this.worldPosition),this.delayCurrent===0&&u.getDeathZone(this))return this.lifeCurrent=0,!1;var g=p.speedX.onEmit(this,"speedX"),m=p.speedY.active?p.speedY.onEmit(this,"speedY"):g;if(u.radial){var E=r(p.angle.onEmit(this,"angle"));this.velocityX=Math.cos(E)*Math.abs(g),this.velocityY=Math.sin(E)*Math.abs(m)}else if(u.moveTo){var v=p.moveToX.onEmit(this,"moveToX"),y=p.moveToY.onEmit(this,"moveToY"),T=this.life/1e3;this.velocityX=(v-this.x)/T,this.velocityY=(y-this.y)/T}else this.velocityX=g,this.velocityY=m;return u.acceleration&&(this.accelerationX=p.accelerationX.onEmit(this,"accelerationX"),this.accelerationY=p.accelerationY.onEmit(this,"accelerationY")),this.maxVelocityX=p.maxVelocityX.onEmit(this,"maxVelocityX"),this.maxVelocityY=p.maxVelocityY.onEmit(this,"maxVelocityY"),this.bounce=p.bounce.onEmit(this,"bounce"),this.alpha=p.alpha.onEmit(this,"alpha"),p.color.active?this.tint=p.color.onEmit(this,"tint"):this.tint=p.tint.onEmit(this,"tint"),!0},update:function(c,f,u){if(this.lifeCurrent<=0)return this.holdCurrent>0?(this.holdCurrent-=c,this.holdCurrent<=0):!0;if(this.delayCurrent>0)return this.delayCurrent-=c,!1;this.anims&&this.anims.update(0,c);var p=this.emitter,d=p.ops,g=1-this.lifeCurrent/this.life;if(this.lifeT=g,this.x=d.x.onUpdate(this,"x",g,this.x),this.y=d.y.onUpdate(this,"y",g,this.y),p.moveTo){var m=d.moveToX.onUpdate(this,"moveToX",g,p.moveToX),E=d.moveToY.onUpdate(this,"moveToY",g,p.moveToY),v=this.lifeCurrent/1e3;this.velocityX=(m-this.x)/v,this.velocityY=(E-this.y)/v}return this.computeVelocity(p,c,f,u,g),this.scaleX=d.scaleX.onUpdate(this,"scaleX",g,this.scaleX),d.scaleY.active?this.scaleY=d.scaleY.onUpdate(this,"scaleY",g,this.scaleY):this.scaleY=this.scaleX,this.angle=d.rotate.onUpdate(this,"rotate",g,this.angle),this.rotation=r(this.angle),p.getDeathZone(this)?(this.lifeCurrent=0,!0):(this.alpha=s(d.alpha.onUpdate(this,"alpha",g,this.alpha),0,1),d.color.active?this.tint=d.color.onUpdate(this,"color",g,this.tint):this.tint=d.tint.onUpdate(this,"tint",g,this.tint),this.lifeCurrent-=c,this.lifeCurrent<=0&&this.holdCurrent<=0)},computeVelocity:function(c,f,u,p,d){var g=c.ops,m=this.velocityX,E=this.velocityY,v=g.accelerationX.onUpdate(this,"accelerationX",d,this.accelerationX),y=g.accelerationY.onUpdate(this,"accelerationY",d,this.accelerationY),T=g.maxVelocityX.onUpdate(this,"maxVelocityX",d,this.maxVelocityX),A=g.maxVelocityY.onUpdate(this,"maxVelocityY",d,this.maxVelocityY);this.bounce=g.bounce.onUpdate(this,"bounce",d,this.bounce),m+=c.gravityX*u+v*u,E+=c.gravityY*u+y*u,m=s(m,-T,T),E=s(E,-A,A),this.velocityX=m,this.velocityY=E,this.x+=m*u,this.y+=E*u,c.worldMatrix.transformPoint(this.x,this.y,this.worldPosition);for(var x=0;x<p.length;x++){var _=p[x];_.active&&_.update(this,f,u,d)}},setSizeToFrame:function(){},getBounds:function(c){c===void 0&&(c=this.emitter.getWorldTransformMatrix());var f=Math.abs(c.scaleX)*this.scaleX,u=Math.abs(c.scaleY)*this.scaleY,p=this.x,d=this.y,g=this.rotation,m=this.frame.width*f/2,E=this.frame.height*u/2,v=this.bounds,y=new h(p-m,d-E),T=new h(p+m,d-E),A=new h(p-m,d+E),x=new h(p+m,d+E);return g!==0&&(a(y,p,d,g),a(T,p,d,g),a(A,p,d,g),a(x,p,d,g)),c.transformPoint(y.x,y.y,y),c.transformPoint(T.x,T.y,T),c.transformPoint(A.x,A.y,A),c.transformPoint(x.x,x.y,x),v.x=Math.min(y.x,T.x,A.x,x.x),v.y=Math.min(y.y,T.y,A.y,x.y),v.width=Math.max(y.x,T.x,A.x,x.x)-v.x,v.height=Math.max(y.y,T.y,A.y,x.y)-v.y,v},destroy:function(){this.anims&&this.anims.destroy(),this.anims=null,this.emitter=null,this.texture=null,this.frame=null,this.scene=null}});t.exports=l}),Ou=S((e,t)=>{"use strict";var i=V(),s=Ba(),n=zt(),r=new i({Extends:s,initialize:function(o,a,h,l,c,f,u,p){c===void 0&&(c=!0),f===void 0&&(f=!0),u===void 0&&(u=!0),p===void 0&&(p=!0),s.call(this,o,a,!0),this.bounds=new n(o,a,h,l),this.collideLeft=c,this.collideRight=f,this.collideTop=u,this.collideBottom=p},update:function(o){var a=this.bounds,h=-o.bounce,l=o.worldPosition;l.x<a.x&&this.collideLeft?(o.x+=a.x-l.x,o.velocityX*=h):l.x>a.right&&this.collideRight&&(o.x-=l.x-a.right,o.velocityX*=h),l.y<a.y&&this.collideTop?(o.y+=a.y-l.y,o.velocityY*=h):l.y>a.bottom&&this.collideBottom&&(o.y-=l.y-a.bottom,o.velocityY*=h)}});t.exports=r}),Du=S((e,t)=>{"use strict";var i=function(s,n){return n.setTo(s.x,s.y,s.width,s.height)};t.exports=i}),ku=S((e,t)=>{"use strict";var i=V(),s=new i({initialize:function(n,r){this.source=n,this.killOnEnter=r},willKill:function(n){var r=n.worldPosition,o=this.source.contains(r.x,r.y);return o&&this.killOnEnter||!o&&!this.killOnEnter}});t.exports=s}),Bu=S((e,t)=>{"use strict";var i=V(),s=new i({initialize:function(n,r,o,a,h,l){a===void 0&&(a=!1),h===void 0&&(h=!0),l===void 0&&(l=-1),this.source=n,this.points=[],this.quantity=r,this.stepRate=o,this.yoyo=a,this.counter=-1,this.seamless=h,this._length=0,this._direction=0,this.total=l,this.updateSource()},updateSource:function(){if(this.points=this.source.getPoints(this.quantity,this.stepRate),this.seamless){var n=this.points[0],r=this.points[this.points.length-1];n.x===r.x&&n.y===r.y&&this.points.pop()}var o=this._length;return this._length=this.points.length,this._length<o&&this.counter>this._length&&(this.counter=this._length-1),this},changeSource:function(n){return this.source=n,this.updateSource()},getPoint:function(n){this._direction===0?(this.counter++,this.counter>=this._length&&(this.yoyo?(this._direction=1,this.counter=this._length-1):this.counter=0)):(this.counter--,this.counter===-1&&(this.yoyo?(this._direction=0,this.counter=0):this.counter=this._length-1));var r=this.points[this.counter];r&&(n.x=r.x,n.y=r.y)}});t.exports=s}),CS=S((e,t)=>{"use strict";var i=function(s,n){for(var r=0;r<n.length;r++)if(s.hasOwnProperty(n[r]))return!0;return!1};t.exports=i}),Nu=S((e,t)=>{"use strict";var i=Ta(),s=function(n,r,o){var a=n.centerX,h=n.centerY;return n.setSize(n.width+r*2,n.height+o*2),i(n,a,h)};t.exports=s}),Uu=S((e,t)=>{"use strict";var i=function(s,n){var r=Math.min(s.x,n.x),o=Math.max(s.right,n.right);s.x=r,s.width=o-r;var a=Math.min(s.y,n.y),h=Math.max(s.bottom,n.bottom);return s.y=a,s.height=h-a,s};t.exports=i}),Na=S((e,t)=>{"use strict";var i=qn(),s=function(n,r){var o=i(n);for(var a in r)o.hasOwnProperty(a)&&(o[a]=r[a]);return o};t.exports=s}),Fu=S((e,t)=>{"use strict";var i=V(),s=Ot(),n=new i({initialize:function(r){this.source=r,this._tempVec=new s,this.total=-1},getPoint:function(r){var o=this._tempVec;this.source.getRandomPoint(o),r.x=o.x,r.y=o.y}});t.exports=n}),Ua=S((e,t)=>{"use strict";var i=function(s,n){return s.width<=0||s.height<=0||n.width<=0||n.height<=0?!1:!(s.right<n.x||s.bottom<n.y||s.x>n.right||s.y>n.bottom)};t.exports=i}),_S=S((e,t)=>{"use strict";var i=Ua(),s=ui(),n=_e(),r=new s,o=new s,a=new s,h=new s,l=function(c,f,u,p){var d=c.pipelines.set(f.pipeline),g=r,m=o,E=a,v=h;p?(v.loadIdentity(),v.multiply(p),v.translate(f.x,f.y),v.rotate(f.rotation),v.scale(f.scaleX,f.scaleY)):v.applyITRS(f.x,f.y,f.rotation,f.scaleX,f.scaleY);var y=n.getTintAppendFloatAlpha,T=u.alpha,A=f.alpha;c.pipelines.preBatch(f);var x=f.alive,_=x.length,b=f.viewBounds;if(!(_===0||b&&!i(b,u.worldView))){f.sortCallback&&f.depthSort(),u.addToRenderList(f),g.copyFrom(u.matrix),g.multiplyWithOffset(v,-u.scrollX*f.scrollFactorX,-u.scrollY*f.scrollFactorY),c.setBlendMode(f.blendMode),f.mask&&(f.mask.preRenderWebGL(c,f,u),c.pipelines.set(f.pipeline));for(var M=f.tintFill,w,R,I=0;I<_;I++){var O=x[I],D=O.alpha*A*T;if(!(D<=0||O.scaleX===0||O.scaleY===0)){E.applyITRS(O.x,O.y,O.rotation,O.scaleX,O.scaleY),E.e=O.x,E.f=O.y,g.multiply(E,m);var N=O.frame;N.glTexture!==R&&(R=N.glTexture,w=d.setGameObject(f,N));var F=-N.halfWidth,G=-N.halfHeight,L=m.setQuad(F,G,F+N.width,G+N.height),C=y(O.tint,D);d.shouldFlush(6)&&(d.flush(),w=d.setGameObject(f,N)),d.batchQuad(f,L[0],L[1],L[2],L[3],L[4],L[5],L[6],L[7],N.u0,N.v0,N.u1,N.v1,C,C,C,C,M,R,w)}}f.mask&&f.mask.postRenderWebGL(c,u),c.pipelines.postBatch(f)}};t.exports=l}),bS=S((e,t)=>{"use strict";var i=Lt(),s=i,n=i;s=_S(),t.exports={renderWebGL:s,renderCanvas:n}}),Fa=S((e,t)=>{"use strict";var i=V(),s=me(),n=fa(),r=Du(),o=ku(),a=Bu(),h=Pu(),l=ka(),c=Lu(),f=Fe(),u=pt(),p=Nh(),d=Iu(),g=CS(),m=Cu(),E=Nu(),v=Nl(),y=Uu(),T=Na(),A=Mu(),x=Ou(),_=Fu(),b=zt(),M=Ua(),w=Pi(),R=bS(),I=Hn(),O=ui(),D=Ot(),N=rn(),F=["active","advance","blendMode","colorEase","deathCallback","deathCallbackScope","duration","emitCallback","emitCallbackScope","follow","frequency","gravityX","gravityY","maxAliveParticles","maxParticles","name","emitting","particleBringToTop","particleClass","radial","sortCallback","sortOrderAsc","sortProperty","stopAfter","tintFill","timeScale","trackVisible","visible"],G=["accelerationX","accelerationY","alpha","angle","bounce","color","delay","hold","lifespan","maxVelocityX","maxVelocityY","moveToX","moveToY","quantity","rotate","scaleX","scaleY","speedX","speedY","tint","x","y"],L=new i({Extends:f,Mixins:[s.AlphaSingle,s.BlendMode,s.Depth,s.Mask,s.Pipeline,s.PostPipeline,s.ScrollFactor,s.Texture,s.Transform,s.Visible,R],initialize:function(C,P,k,B,Y){f.call(this,C,"ParticleEmitter"),this.particleClass=A,this.config=null,this.ops={accelerationX:new l("accelerationX",0),accelerationY:new l("accelerationY",0),alpha:new l("alpha",1),angle:new l("angle",{min:0,max:360},!0),bounce:new l("bounce",0),color:new h("color"),delay:new l("delay",0,!0),hold:new l("hold",0,!0),lifespan:new l("lifespan",1e3,!0),maxVelocityX:new l("maxVelocityX",1e4),maxVelocityY:new l("maxVelocityY",1e4),moveToX:new l("moveToX",0),moveToY:new l("moveToY",0),quantity:new l("quantity",1,!0),rotate:new l("rotate",0),scaleX:new l("scaleX",1),scaleY:new l("scaleY",1),speedX:new l("speedX",0,!0),speedY:new l("speedY",0,!0),tint:new l("tint",16777215),x:new l("x",0),y:new l("y",0)},this.radial=!0,this.gravityX=0,this.gravityY=0,this.acceleration=!1,this.moveTo=!1,this.emitCallback=null,this.emitCallbackScope=null,this.deathCallback=null,this.deathCallbackScope=null,this.maxParticles=0,this.maxAliveParticles=0,this.stopAfter=0,this.duration=0,this.frequency=0,this.emitting=!0,this.particleBringToTop=!0,this.timeScale=1,this.emitZones=[],this.deathZones=[],this.viewBounds=null,this.follow=null,this.followOffset=new D,this.trackVisible=!1,this.frames=[],this.randomFrame=!0,this.frameQuantity=1,this.anims=[],this.randomAnim=!0,this.animQuantity=1,this.dead=[],this.alive=[],this.counters=new Float32Array(10),this.skipping=!1,this.worldMatrix=new O,this.sortProperty="",this.sortOrderAsc=!0,this.sortCallback=this.depthSortCallback,this.processors=new v(this),this.tintFill=!1,this.initPipeline(),this.initPostPipeline(),this.setPosition(P,k),this.setTexture(B),Y&&this.setConfig(Y)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},setConfig:function(C){if(!C)return this;this.config=C;var P=0,k="",B=this.ops;for(P=0;P<G.length;P++)k=G[P],B[k].loadConfig(C);for(P=0;P<F.length;P++)k=F[P],m(C,k)&&(this[k]=u(C,k));if(this.acceleration=this.accelerationX!==0||this.accelerationY!==0,this.moveTo=this.moveToX!==0&&this.moveToY!==0,m(C,"speed")&&(B.speedX.loadConfig(C,"speed"),B.speedY.active=!1),(g(C,["speedX","speedY"])||this.moveTo)&&(this.radial=!1),m(C,"scale")&&(B.scaleX.loadConfig(C,"scale"),B.scaleY.active=!1),m(C,"callbackScope")){var Y=u(C,"callbackScope",null);this.emitCallbackScope=Y,this.deathCallbackScope=Y}if(m(C,"emitZone")&&this.addEmitZone(C.emitZone),m(C,"deathZone")&&this.addDeathZone(C.deathZone),m(C,"bounds")){var H=this.addParticleBounds(C.bounds);H.collideLeft=u(C,"collideLeft",!0),H.collideRight=u(C,"collideRight",!0),H.collideTop=u(C,"collideTop",!0),H.collideBottom=u(C,"collideBottom",!0)}return m(C,"followOffset")&&this.followOffset.setFromObject(u(C,"followOffset",0)),m(C,"texture")&&this.setTexture(C.texture),m(C,"frame")?this.setEmitterFrame(C.frame):m(C,"anim")&&this.setAnim(C.anim),m(C,"reserve")&&this.reserve(C.reserve),m(C,"advance")&&this.fastForward(C.advance),this.resetCounters(this.frequency,this.emitting),this.emitting&&this.emit(c.START,this),this},updateConfig:function(C){return C&&(this.config?this.setConfig(T(this.config,C)):this.setConfig(C)),this},toJSON:function(){var C=n(this),P=0,k="";for(P=0;P<F.length;P++)k=F[P],C[k]=this[k];var B=this.ops;for(P=0;P<G.length;P++)k=G[P],B[k]&&(C[k]=B[k].toJSON());return B.speedY.active||(delete C.speedX,C.speed=B.speedX.toJSON()),this.scaleX===this.scaleY&&(delete C.scaleX,delete C.scaleY,C.scale=B.scaleX.toJSON()),C},resetCounters:function(C,P){var k=this.counters;k.fill(0),k[0]=C,P&&(k[5]=1)},startFollow:function(C,P,k,B){return P===void 0&&(P=0),k===void 0&&(k=0),B===void 0&&(B=!1),this.follow=C,this.followOffset.set(P,k),this.trackVisible=B,this},stopFollow:function(){return this.follow=null,this.followOffset.set(0,0),this.trackVisible=!1,this},getFrame:function(){var C=this.frames,P=C.length,k;return P===1?k=C[0]:this.randomFrame?k=p(C):(k=C[this.currentFrame],this.frameCounter++,this.frameCounter===this.frameQuantity&&(this.frameCounter=0,this.currentFrame++,this.currentFrame===P&&(this.currentFrame=0))),this.texture.get(k)},setEmitterFrame:function(C,P,k){P===void 0&&(P=!0),k===void 0&&(k=1),this.randomFrame=P,this.frameQuantity=k,this.currentFrame=0;var B=typeof C;if(this.frames.length=0,Array.isArray(C))this.frames=this.frames.concat(C);else if(B==="string"||B==="number")this.frames.push(C);else if(B==="object"){var Y=C;C=u(Y,"frames",null),C&&(this.frames=this.frames.concat(C));var H=u(Y,"cycle",!1);this.randomFrame=!H,this.frameQuantity=u(Y,"quantity",k)}return this.frames.length===1&&(this.frameQuantity=1,this.randomFrame=!1),this},getAnim:function(){var C=this.anims,P=C.length;if(P===0)return null;if(P===1)return C[0];if(this.randomAnim)return p(C);var k=C[this.currentAnim];return this.animCounter++,this.animCounter>=this.animQuantity&&(this.animCounter=0,this.currentAnim=N(this.currentAnim+1,0,P)),k},setAnim:function(C,P,k){P===void 0&&(P=!0),k===void 0&&(k=1),this.randomAnim=P,this.animQuantity=k,this.currentAnim=0;var B=typeof C;if(this.anims.length=0,Array.isArray(C))this.anims=this.anims.concat(C);else if(B==="string")this.anims.push(C);else if(B==="object"){var Y=C;C=u(Y,"anims",null),C&&(this.anims=this.anims.concat(C));var H=u(Y,"cycle",!1);this.randomAnim=!H,this.animQuantity=u(Y,"quantity",k)}return this.anims.length===1&&(this.animQuantity=1,this.randomAnim=!1),this},setRadial:function(C){return C===void 0&&(C=!0),this.radial=C,this},addParticleBounds:function(C,P,k,B,Y,H,z,K){if(typeof C=="object"){var X=C;C=X.x,P=X.y,k=m(X,"w")?X.w:X.width,B=m(X,"h")?X.h:X.height}return this.addParticleProcessor(new x(C,P,k,B,Y,H,z,K))},setParticleSpeed:function(C,P){return P===void 0&&(P=C),this.ops.speedX.onChange(C),C===P?this.ops.speedY.active=!1:this.ops.speedY.onChange(P),this.radial=!0,this},setParticleScale:function(C,P){return C===void 0&&(C=1),P===void 0&&(P=C),this.ops.scaleX.onChange(C),this.ops.scaleY.onChange(P),this},setParticleGravity:function(C,P){return this.gravityX=C,this.gravityY=P,this},setParticleAlpha:function(C){return this.ops.alpha.onChange(C),this},setParticleTint:function(C){return this.ops.tint.onChange(C),this},setEmitterAngle:function(C){return this.ops.angle.onChange(C),this},setParticleLifespan:function(C){return this.ops.lifespan.onChange(C),this},setQuantity:function(C){return this.quantity=C,this},setFrequency:function(C,P){return this.frequency=C,this.flowCounter=C>0?C:0,P&&(this.quantity=P),this},addDeathZone:function(C){Array.isArray(C)||(C=[C]);for(var P,k=[],B=0;B<C.length;B++)if(P=C[B],P instanceof o)k.push(P);else if(typeof P.contains=="function")P=new o(P,!0),k.push(P);else{var Y=u(P,"type","onEnter"),H=u(P,"source",null);if(H&&typeof H.contains=="function"){var z=Y==="onEnter";P=new o(H,z),k.push(P)}}return this.deathZones=this.deathZones.concat(k),k},removeDeathZone:function(C){return w(this.deathZones,C),this},clearDeathZones:function(){return this.deathZones.length=0,this},addEmitZone:function(C){Array.isArray(C)||(C=[C]);for(var P,k=[],B=0;B<C.length;B++)if(P=C[B],P instanceof _||P instanceof a)k.push(P);else{var Y=u(P,"source",null);if(Y){var H=u(P,"type","random");if(H==="random"&&typeof Y.getRandomPoint=="function")P=new _(Y),k.push(P);else if(H==="edge"&&typeof Y.getPoints=="function"){var z=u(P,"quantity",1),K=u(P,"stepRate",0),X=u(P,"yoyo",!1),et=u(P,"seamless",!0),J=u(P,"total",-1);P=new a(Y,z,K,X,et,J),k.push(P)}}}return this.emitZones=this.emitZones.concat(k),k},removeEmitZone:function(C){return w(this.emitZones,C),this.zoneIndex=0,this},clearEmitZones:function(){return this.emitZones.length=0,this.zoneIndex=0,this},getEmitZone:function(C){var P=this.emitZones,k=P.length;if(k!==0){var B=P[this.zoneIndex];B.getPoint(C),B.total>-1&&(this.zoneTotal++,this.zoneTotal===B.total&&(this.zoneTotal=0,this.zoneIndex++,this.zoneIndex===k&&(this.zoneIndex=0)))}},getDeathZone:function(C){for(var P=this.deathZones,k=0;k<P.length;k++){var B=P[k];if(B.willKill(C))return this.emit(c.DEATH_ZONE,this,C,B),!0}return!1},setEmitZone:function(C){var P;return isFinite(C)?P=C:P=this.emitZones.indexOf(C),P>=0&&(this.zoneIndex=P),this},addParticleProcessor:function(C){return this.processors.exists(C)||(C.emitter&&C.emitter.removeParticleProcessor(C),this.processors.add(C),C.emitter=this),C},removeParticleProcessor:function(C){return this.processors.exists(C)&&(this.processors.remove(C,!0),C.emitter=null),C},getProcessors:function(){return this.processors.getAll("active",!0)},createGravityWell:function(C){return this.addParticleProcessor(new d(C))},reserve:function(C){var P=this.dead;if(this.maxParticles>0){var k=this.getParticleCount();k+C>this.maxParticles&&(C=this.maxParticles-(k+C))}for(var B=0;B<C;B++)P.push(new this.particleClass(this));return this},getAliveParticleCount:function(){return this.alive.length},getDeadParticleCount:function(){return this.dead.length},getParticleCount:function(){return this.getAliveParticleCount()+this.getDeadParticleCount()},atLimit:function(){return this.maxParticles>0&&this.getParticleCount()>=this.maxParticles?!0:this.maxAliveParticles>0&&this.getAliveParticleCount()>=this.maxAliveParticles},onParticleEmit:function(C,P){return C===void 0?(this.emitCallback=null,this.emitCallbackScope=null):typeof C=="function"&&(this.emitCallback=C,P&&(this.emitCallbackScope=P)),this},onParticleDeath:function(C,P){return C===void 0?(this.deathCallback=null,this.deathCallbackScope=null):typeof C=="function"&&(this.deathCallback=C,P&&(this.deathCallbackScope=P)),this},killAll:function(){for(var C=this.dead,P=this.alive;P.length>0;)C.push(P.pop());return this},forEachAlive:function(C,P){for(var k=this.alive,B=k.length,Y=0;Y<B;Y++)C.call(P,k[Y],this);return this},forEachDead:function(C,P){for(var k=this.dead,B=k.length,Y=0;Y<B;Y++)C.call(P,k[Y],this);return this},start:function(C,P){return C===void 0&&(C=0),this.emitting||(C>0&&this.fastForward(C),this.emitting=!0,this.resetCounters(this.frequency,!0),P!==void 0&&(this.duration=Math.abs(P)),this.emit(c.START,this)),this},stop:function(C){return C===void 0&&(C=!1),this.emitting&&(this.emitting=!1,C&&this.killAll(),this.emit(c.STOP,this)),this},pause:function(){return this.active=!1,this},resume:function(){return this.active=!0,this},setSortProperty:function(C,P){return C===void 0&&(C=""),P===void 0&&(P=this.true),this.sortProperty=C,this.sortOrderAsc=P,this.sortCallback=this.depthSortCallback,this},setSortCallback:function(C){return this.sortProperty!==""?C=this.depthSortCallback:C=null,this.sortCallback=C,this},depthSort:function(){return I(this.alive,this.sortCallback.bind(this)),this},depthSortCallback:function(C,P){var k=this.sortProperty;return this.sortOrderAsc?C[k]-P[k]:P[k]-C[k]},flow:function(C,P,k){return P===void 0&&(P=1),this.emitting=!1,this.frequency=C,this.quantity=P,k!==void 0&&(this.stopAfter=k),this.start()},explode:function(C,P,k){this.frequency=-1,this.resetCounters(-1,!0);var B=this.emitParticle(C,P,k);return this.emit(c.EXPLODE,this,B),B},emitParticleAt:function(C,P,k){return this.emitParticle(k,C,P)},emitParticle:function(C,P,k){if(!this.atLimit()){C===void 0&&(C=this.ops.quantity.onEmit());for(var B=this.dead,Y=this.stopAfter,H=this.follow?this.follow.x+this.followOffset.x:P,z=this.follow?this.follow.y+this.followOffset.y:k,K=0;K<C;K++){var X=B.pop();if(X||(X=new this.particleClass(this)),X.fire(H,z)?(this.particleBringToTop?this.alive.push(X):this.alive.unshift(X),this.emitCallback&&this.emitCallback.call(this.emitCallbackScope,X,this)):this.dead.push(X),Y>0&&(this.stopCounter++,this.stopCounter>=Y)||this.atLimit())break}return X}},fastForward:function(C,P){P===void 0&&(P=1e3/60);var k=0;for(this.skipping=!0;k<Math.abs(C);)this.preUpdate(0,P),k+=P;return this.skipping=!1,this},preUpdate:function(C,P){P*=this.timeScale;var k=P/1e3;this.trackVisible&&(this.visible=this.follow.visible),this.getWorldTransformMatrix(this.worldMatrix);var B=this.getProcessors(),Y=this.alive,H=this.dead,z=0,K=[],X=Y.length;for(z=0;z<X;z++){var et=Y[z];et.update(P,k,B)&&K.push({index:z,particle:et})}if(X=K.length,X>0){var J=this.deathCallback,st=this.deathCallbackScope;for(z=X-1;z>=0;z--){var q=K[z];Y.splice(q.index,1),H.push(q.particle),J&&J.call(st,q.particle),q.particle.setPosition()}}if(!this.emitting&&!this.skipping){this.completeFlag===1&&Y.length===0&&(this.completeFlag=0,this.emit(c.COMPLETE,this));return}if(this.frequency===0)this.emitParticle();else if(this.frequency>0)for(this.flowCounter-=P;this.flowCounter<=0;)this.emitParticle(),this.flowCounter+=this.frequency;this.skipping||(this.duration>0&&(this.elapsed+=P,this.elapsed>=this.duration&&this.stop()),this.stopAfter>0&&this.stopCounter>=this.stopAfter&&this.stop())},overlap:function(C){for(var P=this.getWorldTransformMatrix(),k=this.alive,B=k.length,Y=[],H=0;H<B;H++){var z=k[H];M(C,z.getBounds(P))&&Y.push(z)}return Y},getBounds:function(C,P,k,B){C===void 0&&(C=0),P===void 0&&(P=0),k===void 0&&(k=1e3/60),B===void 0&&(B=new b);var Y=this.getWorldTransformMatrix(),H,z,K=this.alive,X=!1;if(B.setTo(0,0,0,0),P>0){var et=0;for(this.skipping=!0;et<Math.abs(P);){for(this.preUpdate(0,k),H=0;H<K.length;H++)z=K[H].getBounds(Y),X?y(B,z):(X=!0,r(z,B));et+=k}this.skipping=!1}else for(H=0;H<K.length;H++)z=K[H].getBounds(Y),X?y(B,z):(X=!0,r(z,B));return C>0&&E(B,C,C),B},createEmitter:function(){throw new Error("createEmitter removed. See ParticleEmitter docs for info")},particleX:{get:function(){return this.ops.x.current},set:function(C){this.ops.x.onChange(C)}},particleY:{get:function(){return this.ops.y.current},set:function(C){this.ops.y.onChange(C)}},accelerationX:{get:function(){return this.ops.accelerationX.current},set:function(C){this.ops.accelerationX.onChange(C)}},accelerationY:{get:function(){return this.ops.accelerationY.current},set:function(C){this.ops.accelerationY.onChange(C)}},maxVelocityX:{get:function(){return this.ops.maxVelocityX.current},set:function(C){this.ops.maxVelocityX.onChange(C)}},maxVelocityY:{get:function(){return this.ops.maxVelocityY.current},set:function(C){this.ops.maxVelocityY.onChange(C)}},speed:{get:function(){return this.ops.speedX.current},set:function(C){this.ops.speedX.onChange(C),this.ops.speedY.onChange(C)}},speedX:{get:function(){return this.ops.speedX.current},set:function(C){this.ops.speedX.onChange(C)}},speedY:{get:function(){return this.ops.speedY.current},set:function(C){this.ops.speedY.onChange(C)}},moveToX:{get:function(){return this.ops.moveToX.current},set:function(C){this.ops.moveToX.onChange(C)}},moveToY:{get:function(){return this.ops.moveToY.current},set:function(C){this.ops.moveToY.onChange(C)}},bounce:{get:function(){return this.ops.bounce.current},set:function(C){this.ops.bounce.onChange(C)}},particleScaleX:{get:function(){return this.ops.scaleX.current},set:function(C){this.ops.scaleX.onChange(C)}},particleScaleY:{get:function(){return this.ops.scaleY.current},set:function(C){this.ops.scaleY.onChange(C)}},particleColor:{get:function(){return this.ops.color.current},set:function(C){this.ops.color.onChange(C)}},colorEase:{get:function(){return this.ops.color.easeName},set:function(C){this.ops.color.setEase(C)}},particleTint:{get:function(){return this.ops.tint.current},set:function(C){this.ops.tint.onChange(C)}},particleAlpha:{get:function(){return this.ops.alpha.current},set:function(C){this.ops.alpha.onChange(C)}},lifespan:{get:function(){return this.ops.lifespan.current},set:function(C){this.ops.lifespan.onChange(C)}},particleAngle:{get:function(){return this.ops.angle.current},set:function(C){this.ops.angle.onChange(C)}},particleRotate:{get:function(){return this.ops.rotate.current},set:function(C){this.ops.rotate.onChange(C)}},quantity:{get:function(){return this.ops.quantity.current},set:function(C){this.ops.quantity.onChange(C)}},delay:{get:function(){return this.ops.delay.current},set:function(C){this.ops.delay.onChange(C)}},hold:{get:function(){return this.ops.hold.current},set:function(C){this.ops.hold.onChange(C)}},flowCounter:{get:function(){return this.counters[0]},set:function(C){this.counters[0]=C}},frameCounter:{get:function(){return this.counters[1]},set:function(C){this.counters[1]=C}},animCounter:{get:function(){return this.counters[2]},set:function(C){this.counters[2]=C}},elapsed:{get:function(){return this.counters[3]},set:function(C){this.counters[3]=C}},stopCounter:{get:function(){return this.counters[4]},set:function(C){this.counters[4]=C}},completeFlag:{get:function(){return this.counters[5]},set:function(C){this.counters[5]=C}},zoneIndex:{get:function(){return this.counters[6]},set:function(C){this.counters[6]=C}},zoneTotal:{get:function(){return this.counters[7]},set:function(C){this.counters[7]=C}},currentFrame:{get:function(){return this.counters[8]},set:function(C){this.counters[8]=C}},currentAnim:{get:function(){return this.counters[9]},set:function(C){this.counters[9]=C}},preDestroy:function(){this.texture=null,this.frames=null,this.anims=null,this.emitCallback=null,this.emitCallbackScope=null,this.deathCallback=null,this.deathCallbackScope=null,this.emitZones=null,this.deathZones=null,this.bounds=null,this.follow=null,this.counters=null;var C,P=this.ops;for(C=0;C<G.length;C++){var k=G[C];P[k].destroy()}for(C=0;C<this.alive.length;C++)this.alive[C].destroy();for(C=0;C<this.dead.length;C++)this.dead[C].destroy();this.ops=null,this.alive=[],this.dead=[],this.worldMatrix.destroy()}});t.exports=L}),PS=S((e,t)=>{"use strict";t.exports={DeathZone:ku(),EdgeZone:Bu(),RandomZone:Fu()}}),LS=S((e,t)=>{"use strict";t.exports={EmitterColorOp:Pu(),EmitterOp:ka(),Events:Lu(),GravityWell:Iu(),Particle:Mu(),ParticleBounds:Ou(),ParticleEmitter:Fa(),ParticleProcessor:Ba(),Zones:PS()}}),Ga=S((e,t)=>{"use strict";var i=function(s,n){var r;if(n)typeof n=="string"?r=document.getElementById(n):typeof n=="object"&&n.nodeType===1&&(r=n);else if(s.parentElement||n===null)return s;return r||(r=document.body),r.appendChild(s),s};t.exports=i}),Gu=S((e,t)=>{"use strict";var i=function(s,n,r){var o=s.canvas,a=s.context,h=s.style,l=[],c=0,f=r.length;h.maxLines>0&&h.maxLines<r.length&&(f=h.maxLines),h.syncFont(o,a);for(var u=s.letterSpacing,p=0;p<f;p++){var d=h.strokeThickness;if(u===0)d+=a.measureText(r[p]).width;else{for(var g=r[p],m=0;m<g.length;m++)d+=a.measureText(g[m]).width;g.length>1&&(d+=u*(g.length-1))}h.wordWrap&&(d-=a.measureText(" ").width),l[p]=Math.ceil(d),c=Math.max(c,l[p])}var E=n.fontSize+h.strokeThickness,v=E*f,y=s.lineSpacing;return f>1&&(v+=y*(f-1)),{width:c,height:v,lines:f,lineWidths:l,lineSpacing:y,lineHeight:E}};t.exports=i}),IS=S((e,t)=>{"use strict";var i=function(s){s.parentNode&&s.parentNode.removeChild(s)};t.exports=i}),MS=S((e,t)=>{"use strict";var i=_e(),s=function(n,r,o,a){if(!(r.width===0||r.height===0)){o.addToRenderList(r);var h=r.frame,l=h.width,c=h.height,f=i.getTintAppendFloatAlpha,u=n.pipelines.set(r.pipeline,r),p=u.setTexture2D(h.glTexture,r);u.batchTexture(r,h.glTexture,l,c,r.x,r.y,l/r.style.resolution,c/r.style.resolution,r.scaleX,r.scaleY,r.rotation,r.flipX,r.flipY,r.scrollFactorX,r.scrollFactorY,r.displayOriginX,r.displayOriginY,0,0,l,c,f(r.tintTopLeft,o.alpha*r._alphaTL),f(r.tintTopRight,o.alpha*r._alphaTR),f(r.tintBottomLeft,o.alpha*r._alphaBL),f(r.tintBottomRight,o.alpha*r._alphaBR),r.tintFill,0,0,o,a,!1,p)}};t.exports=s}),OS=S((e,t)=>{"use strict";var i=Lt(),s=i,n=i;s=MS(),t.exports={renderWebGL:s,renderCanvas:n}}),Yu=S((e,t)=>{"use strict";var i=Ne(),s=function(n){var r=i.create(this),o=r.getContext("2d",{willReadFrequently:!0});n.syncFont(r,o);var a=o.measureText(n.testString);if("actualBoundingBoxAscent"in a){var h=a.actualBoundingBoxAscent,l=a.actualBoundingBoxDescent;return i.remove(r),{ascent:h,descent:l,fontSize:h+l}}var c=Math.ceil(a.width*n.baselineX),f=c,u=2*f;f=f*n.baselineY|0,r.width=c,r.height=u,o.fillStyle="#f00",o.fillRect(0,0,c,u),o.font=n._font,o.textBaseline="alphabetic",o.fillStyle="#000",o.fillText(n.testString,0,f);var p={ascent:0,descent:0,fontSize:0},d=o.getImageData(0,0,c,u);if(!d)return p.ascent=f,p.descent=f+6,p.fontSize=p.ascent+p.descent,i.remove(r),p;var g=d.data,m=g.length,E=c*4,v,y,T=0,A=!1;for(v=0;v<f;v++){for(y=0;y<E;y+=4)if(g[T+y]!==255){A=!0;break}if(!A)T+=E;else break}for(p.ascent=f-v,T=m-E,A=!1,v=u;v>f;v--){for(y=0;y<E;y+=4)if(g[T+y]!==255){A=!0;break}if(!A)T-=E;else break}return p.descent=v-f,p.fontSize=p.ascent+p.descent,i.remove(r),p};t.exports=s}),Hu=S((e,t)=>{"use strict";var i=V(),s=Ee(),n=Mt(),r=Yu(),o={fontFamily:["fontFamily","Courier"],fontSize:["fontSize","16px"],fontStyle:["fontStyle",""],backgroundColor:["backgroundColor",null],color:["color","#fff"],stroke:["stroke","#fff"],strokeThickness:["strokeThickness",0],shadowOffsetX:["shadow.offsetX",0],shadowOffsetY:["shadow.offsetY",0],shadowColor:["shadow.color","#000"],shadowBlur:["shadow.blur",0],shadowStroke:["shadow.stroke",!1],shadowFill:["shadow.fill",!1],align:["align","left"],maxLines:["maxLines",0],fixedWidth:["fixedWidth",0],fixedHeight:["fixedHeight",0],resolution:["resolution",0],rtl:["rtl",!1],testString:["testString","|M\xC3\u2030qgy"],baselineX:["baselineX",1.2],baselineY:["baselineY",1.4],wordWrapWidth:["wordWrap.width",null],wordWrapCallback:["wordWrap.callback",null],wordWrapCallbackScope:["wordWrap.callbackScope",null],wordWrapUseAdvanced:["wordWrap.useAdvancedWrap",!1]},a=new i({initialize:function(h,l){this.parent=h,this.fontFamily,this.fontSize,this.fontStyle,this.backgroundColor,this.color,this.stroke,this.strokeThickness,this.shadowOffsetX,this.shadowOffsetY,this.shadowColor,this.shadowBlur,this.shadowStroke,this.shadowFill,this.align,this.maxLines,this.fixedWidth,this.fixedHeight,this.resolution,this.rtl,this.testString,this.baselineX,this.baselineY,this.wordWrapWidth,this.wordWrapCallback,this.wordWrapCallbackScope,this.wordWrapUseAdvanced,this._font,this.setStyle(l,!1,!0)},setStyle:function(h,l,c){l===void 0&&(l=!0),c===void 0&&(c=!1);for(var f in o){var u=c?o[f][1]:this[f];f==="wordWrapCallback"||f==="wordWrapCallbackScope"?this[f]=n(h,o[f][0],u):h&&f==="fontSize"&&typeof h.fontSize=="number"?this[f]=h.fontSize.toString()+"px":this[f]=s(h,o[f][0],u)}var p=n(h,"font",null);p!==null&&this.setFont(p,!1),this._font=[this.fontStyle,this.fontSize,this.fontFamily].join(" ").trim();var d=n(h,"fill",null);d!==null&&(this.color=d);var g=n(h,"metrics",!1);return g?this.metrics={ascent:n(g,"ascent",0),descent:n(g,"descent",0),fontSize:n(g,"fontSize",0)}:(l||!this.metrics)&&(this.metrics=r(this)),l?this.parent.updateText():this.parent},syncFont:function(h,l){l.font=this._font},syncStyle:function(h,l){l.textBaseline="alphabetic",l.fillStyle=this.color,l.strokeStyle=this.stroke,l.lineWidth=this.strokeThickness,l.lineCap="round",l.lineJoin="round"},syncShadow:function(h,l){l?(h.shadowOffsetX=this.shadowOffsetX,h.shadowOffsetY=this.shadowOffsetY,h.shadowColor=this.shadowColor,h.shadowBlur=this.shadowBlur):(h.shadowOffsetX=0,h.shadowOffsetY=0,h.shadowColor=0,h.shadowBlur=0)},update:function(h){return h&&(this._font=[this.fontStyle,this.fontSize,this.fontFamily].join(" ").trim(),this.metrics=r(this)),this.parent.updateText()},setFont:function(h,l){l===void 0&&(l=!0);var c=h,f="",u="";if(typeof h!="string")c=n(h,"fontFamily","Courier"),f=n(h,"fontSize","16px"),u=n(h,"fontStyle","");else{var p=h.split(" "),d=0;u=p.length>2?p[d++]:"",f=p[d++]||"16px",c=p[d++]||"Courier"}return(c!==this.fontFamily||f!==this.fontSize||u!==this.fontStyle)&&(this.fontFamily=c,this.fontSize=f,this.fontStyle=u,l&&this.update(!0)),this.parent},setFontFamily:function(h){return this.fontFamily!==h&&(this.fontFamily=h,this.update(!0)),this.parent},setFontStyle:function(h){return this.fontStyle!==h&&(this.fontStyle=h,this.update(!0)),this.parent},setFontSize:function(h){return typeof h=="number"&&(h=h.toString()+"px"),this.fontSize!==h&&(this.fontSize=h,this.update(!0)),this.parent},setTestString:function(h){return this.testString=h,this.update(!0)},setFixedSize:function(h,l){return this.fixedWidth=h,this.fixedHeight=l,h&&(this.parent.width=h),l&&(this.parent.height=l),this.update(!1)},setBackgroundColor:function(h){return this.backgroundColor=h,this.update(!1)},setFill:function(h){return this.color=h,this.update(!1)},setColor:function(h){return this.color=h,this.update(!1)},setResolution:function(h){return this.resolution=h,this.update(!1)},setStroke:function(h,l){return l===void 0&&(l=this.strokeThickness),h===void 0&&this.strokeThickness!==0?(this.strokeThickness=0,this.update(!0)):(this.stroke!==h||this.strokeThickness!==l)&&(this.stroke=h,this.strokeThickness=l,this.update(!0)),this.parent},setShadow:function(h,l,c,f,u,p){return h===void 0&&(h=0),l===void 0&&(l=0),c===void 0&&(c="#000"),f===void 0&&(f=0),u===void 0&&(u=!1),p===void 0&&(p=!0),this.shadowOffsetX=h,this.shadowOffsetY=l,this.shadowColor=c,this.shadowBlur=f,this.shadowStroke=u,this.shadowFill=p,this.update(!1)},setShadowOffset:function(h,l){return h===void 0&&(h=0),l===void 0&&(l=h),this.shadowOffsetX=h,this.shadowOffsetY=l,this.update(!1)},setShadowColor:function(h){return h===void 0&&(h="#000"),this.shadowColor=h,this.update(!1)},setShadowBlur:function(h){return h===void 0&&(h=0),this.shadowBlur=h,this.update(!1)},setShadowStroke:function(h){return this.shadowStroke=h,this.update(!1)},setShadowFill:function(h){return this.shadowFill=h,this.update(!1)},setWordWrapWidth:function(h,l){return l===void 0&&(l=!1),this.wordWrapWidth=h,this.wordWrapUseAdvanced=l,this.update(!1)},setWordWrapCallback:function(h,l){return l===void 0&&(l=null),this.wordWrapCallback=h,this.wordWrapCallbackScope=l,this.update(!1)},setAlign:function(h){return h===void 0&&(h="left"),this.align=h,this.update(!1)},setMaxLines:function(h){return h===void 0&&(h=0),this.maxLines=h,this.update(!1)},getTextMetrics:function(){var h=this.metrics;return{ascent:h.ascent,descent:h.descent,fontSize:h.fontSize}},toJSON:function(){var h={};for(var l in o)h[l]=this[l];return h.metrics=this.getTextMetrics(),h},destroy:function(){this.parent=void 0}});t.exports=a}),DS=S((e,t)=>{"use strict";var i=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){var n=Math.random()*16|0,r=s==="x"?n:n&3|8;return r.toString(16)})};t.exports=i}),kS=S((e,t)=>{"use strict";var i=Ke(),s=[],n={},r={},o=function(){var a=function(u){var p=u.scene,d=c();if(d===null){d={key:u.key,texture:p.textures.addCanvas(null,u.canvas,!0),text:u,dirty:!0};var g=d.texture.source[0];g._originRedrawGlTexture=g.redrawGlTexture,g._container=d,g.redrawGlTexture=function(){var m=this._textObject;if(m!=null){var E=this._container;E!=null&&(this._originRedrawGlTexture(),m.dirty=!0,E.dirty=!0,m.updateTexture())}},s.push(d)}n[u.key]=d,r[u.key]=!0,u.texture=d.texture,u.frame=d.texture.get(),d.text=u,d.key=u.key,d.texture.source[0]._textObject=u},h=function(u){if(r[u.key]=!0,n[u.key]!==void 0){var p=n[u.key];u.texture=p.texture,u.frame=p.texture.get(),p.texture.source[0]._textObject=u}else a(u);return n[u.key]},l=function(){for(var u=0;u<s.length;u++){var p=s[u];p.text!==null&&(p.text.texture=null,p.text.frame=null,p.text.dirty=!0,p.dirty=!0,p.key="",p.text=null)}n={},this.poolByKey=n},c=function(){for(var u=0;u<s.length;u++){var p=s[u];if(p.key==="")return p}return null},f=function(u){return n[u]};return{create:a,use:h,pool:s,poolByKey:n,clear:l,getContainer:f}};t.exports=o()}),Ya=S((e,t)=>{"use strict";var i=Ga(),s=Ne(),n=V(),r=me(),o=Fe(),a=Gu(),h=Mt(),l=IS(),c=OS(),f=Hu(),u=DS(),p=kS(),d=new n({Extends:o,Mixins:[r.Alpha,r.BlendMode,r.ComputedSize,r.Crop,r.Depth,r.Flip,r.GetBounds,r.Mask,r.Origin,r.Pipeline,r.PostPipeline,r.ScrollFactor,r.Tint,r.Transform,r.Visible,c],initialize:function(g,m,E,v,y){m===void 0&&(m=0),E===void 0&&(E=0),o.call(this,g,"Text"),this.key=u(),this.renderer=g.sys.renderer,this.setPosition(m,E),this.setOrigin(0,0),this.initPipeline(),this.initPostPipeline(!0),this.canvas=s.create(this),this.context=this.canvas.getContext("2d",{willReadFrequently:!0}),this.style=new f(this,y),this.autoRound=!0,this.splitRegExp=/(?:\r\n|\r|\n)/,this._text=void 0,this.padding={left:0,right:0,top:0,bottom:0},this.width=1,this.height=1,this.lineSpacing=0,this.letterSpacing=0,this.dirty=!0,this.style.resolution===0&&(this.style.resolution=1),this._crop=this.resetCropObject(),this._textureKey=u(),this.reuseTexture=!1,this.texture=g.sys.textures.addCanvas(this._textureKey,this.canvas),this.frame=this.texture.get(),this.frame.source.resolution=this.style.resolution,this.renderer&&this.renderer.gl&&(this.renderer.deleteTexture(this.frame.source.glTexture),this.frame.source.glTexture=null),this.initRTL(),this.setText(v),y&&y.padding&&this.setPadding(y.padding),y&&y.lineSpacing&&this.setLineSpacing(y.lineSpacing),y&&y.letterSpacing&&this.setLetterSpacing(y.letterSpacing)},initRTL:function(){this.style.rtl&&(i(this.canvas,this.scene.sys.canvas),this.originX=1)},runWordWrap:function(g){var m=this.style;if(m.wordWrapCallback){var E=m.wordWrapCallback.call(m.wordWrapCallbackScope,g,this);return Array.isArray(E)&&(E=E.join(`
`)),E}else return m.wordWrapWidth?m.wordWrapUseAdvanced?this.advancedWordWrap(g,this.context,this.style.wordWrapWidth):this.basicWordWrap(g,this.context,this.style.wordWrapWidth):g},advancedWordWrap:function(g,m,E){for(var v="",y=g.replace(/ +/gi," ").split(this.splitRegExp),T=y.length,A=0;A<T;A++){var x=y[A],_="";x=x.replace(/^ *|\s*$/gi,"");var b=x.length*this.letterSpacing,M=m.measureText(x).width+b;if(M<E){v+=x+`
`;continue}for(var w=E,R=x.split(" "),I=0;I<R.length;I++){var O=R[I],D=O+" ",N=D.length*this.letterSpacing,F=m.measureText(D).width+N;if(F>w){if(I===0){for(var G=D;G.length;){G=G.slice(0,-1);var L=G.length*this.letterSpacing;if(F=m.measureText(G).width+L,F<=w)break}if(!G.length)throw new Error("wordWrapWidth < a single character");var C=O.substr(G.length);R[I]=C,_+=G}var P=R[I].length?I:I+1,k=R.slice(P).join(" ").replace(/[ \n]*$/gi,"");y.splice(A+1,0,k),T=y.length;break}else _+=D,w-=F}v+=_.replace(/[ \n]*$/gi,"")+`
`}return v=v.replace(/[\s|\n]*$/gi,""),v},basicWordWrap:function(g,m,E){for(var v="",y=g.split(this.splitRegExp),T=y.length-1,A=m.measureText(" ").width,x=0;x<=T;x++){for(var _=E,b=y[x].split(" "),M=b.length-1,w=0;w<=M;w++){var R=b[w],I=R.length*this.letterSpacing,O=m.measureText(R).width+I,D=O;w<M&&(D+=A),D>_&&w>0&&(v+=`
`,_=E),v+=R,w<M?(v+=" ",_-=D):_-=O}x<T&&(v+=`
`)}return v},getWrappedText:function(g){g===void 0&&(g=this._text),this.style.syncFont(this.canvas,this.context);var m=this.runWordWrap(g);return m.split(this.splitRegExp)},setText:function(g){return!g&&g!==0&&(g=""),Array.isArray(g)&&(g=g.join(`
`)),g!==this._text&&(this._text=g.toString(),this.dirty=!0,this.updateText()),this},appendText:function(g,m){m===void 0&&(m=!0),!g&&g!==0&&(g=""),Array.isArray(g)&&(g=g.join(`
`)),g=g.toString();var E=this._text.concat(m?`
`+g:g);return E!==this._text&&(this._text=E,this.dirty=!0,this.updateText()),this},setStyle:function(g){return this.style.setStyle(g)},setFont:function(g){return this.style.setFont(g)},setFontFamily:function(g){return this.style.setFontFamily(g)},setFontSize:function(g){return this.style.setFontSize(g)},setFontStyle:function(g){return this.style.setFontStyle(g)},setFixedSize:function(g,m){return this.style.setFixedSize(g,m)},setBackgroundColor:function(g){return this.style.setBackgroundColor(g)},setFill:function(g){return this.style.setFill(g)},setColor:function(g){return this.style.setColor(g)},setStroke:function(g,m){return this.style.setStroke(g,m)},setShadow:function(g,m,E,v,y,T){return this.style.setShadow(g,m,E,v,y,T)},setShadowOffset:function(g,m){return this.style.setShadowOffset(g,m)},setShadowColor:function(g){return this.style.setShadowColor(g)},setShadowBlur:function(g){return this.style.setShadowBlur(g)},setShadowStroke:function(g){return this.style.setShadowStroke(g)},setShadowFill:function(g){return this.style.setShadowFill(g)},setWordWrapWidth:function(g,m){return this.style.setWordWrapWidth(g,m)},setWordWrapCallback:function(g,m){return this.style.setWordWrapCallback(g,m)},setAlign:function(g){return this.style.setAlign(g)},setResolution:function(g){return this.style.setResolution(g)},setLineSpacing:function(g){return this.lineSpacing=g,this.dirty=!0,this.updateText()},setLetterSpacing:function(g){return this.letterSpacing=g,this.dirty=!0,this.updateText()},setPadding:function(g,m,E,v){if(typeof g=="object"){var y=g,T=h(y,"x",null);T!==null?(g=T,E=T):(g=h(y,"left",0),E=h(y,"right",g));var A=h(y,"y",null);A!==null?(m=A,v=A):(m=h(y,"top",0),v=h(y,"bottom",m))}else g===void 0&&(g=0),m===void 0&&(m=g),E===void 0&&(E=g),v===void 0&&(v=m);return this.padding.left=g,this.padding.top=m,this.padding.right=E,this.padding.bottom=v,this.updateText()},setMaxLines:function(g){return this.style.setMaxLines(g)},setRTL:function(g){g===void 0&&(g=!0);var m=this.style;return m.rtl===g?this:(m.rtl=g,g?(this.canvas.dir="rtl",this.context.direction="rtl",this.canvas.style.display="none",i(this.canvas,this.scene.sys.canvas)):(this.canvas.dir="ltr",this.context.direction="ltr"),m.align==="left"?m.align="right":m.align==="right"&&(m.align="left"),this)},updateText:function(){var g=this.canvas,m=this.context,E=this.style,v=E.resolution,y=E.metrics;E.syncFont(g,m);var T=this._text;(E.wordWrapWidth||E.wordWrapCallback)&&(T=this.runWordWrap(this._text));var A=T.split(this.splitRegExp),x=a(this,y,A),_=this.padding,b;E.fixedWidth===0?(this.width=x.width+_.left+_.right,b=x.width):(this.width=E.fixedWidth,b=this.width-_.left-_.right,b<x.width&&(b=x.width)),E.fixedHeight===0?this.height=x.height+_.top+_.bottom:this.height=E.fixedHeight,this.updateDisplayOrigin(),this.lines=A,this.textSize=x,this.textWidth=b,this.dirty=!0;var M=this.input;M&&!M.customHitArea&&(M.hitArea.width=this.width,M.hitArea.height=this.height);var w=p.getContainer(this.key);return w&&(w.dirty=!0),(!this.reuseTexture||!w)&&this.drawTextCanvas(),this},getTextMetrics:function(){return this.style.getTextMetrics()},text:{get:function(){return this._text},set:function(g){this.setText(g)}},toJSON:function(){var g=r.ToJSON(this),m={autoRound:this.autoRound,text:this._text,style:this.style.toJSON(),padding:{left:this.padding.left,right:this.padding.right,top:this.padding.top,bottom:this.padding.bottom}};return g.data=m,g},preDestroy:function(){if(l(this.canvas),this.reuseTexture){var g=p.getContainer(this.key);g&&(g.text=null,g.key="",g.dirty=!0)}else{s.remove(this.canvas);var m=this.texture;m&&m.destroy()}},drawTextCanvas:function(){var g=this.reuseTexture?p.use(this):null;if(g&&!g.dirty&&!this.dirty)return this;if(!this.lines)return this;var m=this.canvas,E=this.context,v=this.style,y=v.metrics,T=this.textSize,A=this.textWidth,x=this.padding,_=this.lines,b=this.width,M=this.height;b*=v.resolution,M*=v.resolution,b=Math.max(b,1),M=Math.max(M,1),m.width!==b||m.height!==M?(m.width=b,m.height=M,this.frame.setSize(b,M),v.syncFont(m,E),v.rtl&&(E.direction="rtl")):E.clearRect(0,0,b,M),E.save(),E.scale(v.resolution,v.resolution),v.backgroundColor&&(E.fillStyle=v.backgroundColor,E.fillRect(0,0,b,M)),v.syncStyle(m,E),E.translate(x.left,x.top);for(var w,R,I=0;I<T.lines;I++){if(w=v.strokeThickness/2,R=v.strokeThickness/2+I*T.lineHeight+y.ascent,I>0&&(R+=T.lineSpacing*I),v.rtl)w=b-w-x.left-x.right;else if(v.align==="right")w+=A-T.lineWidths[I];else if(v.align==="center")w+=(A-T.lineWidths[I])/2;else if(v.align==="justify"){var O=.85;if(T.lineWidths[I]/T.width>=O){var D=T.width-T.lineWidths[I],N=E.measureText(" ").width,F=_[I].trim(),G=F.split(" ");D+=(_[I].length-F.length)*N;for(var L=Math.floor(D/N),C=0;L>0;)G[C]+=" ",C=(C+1)%(G.length-1||1),--L;_[I]=G.join(" ")}}this.autoRound&&(w=Math.round(w),R=Math.round(R));var P=this.letterSpacing;if(v.strokeThickness&&P===0&&(v.syncShadow(E,v.shadowStroke),E.strokeText(_[I],w,R)),v.color)if(v.syncShadow(E,v.shadowFill),P!==0)for(var k=0,B=_[I].split(""),Y=0;Y<B.length;Y++)v.strokeThickness&&(v.syncShadow(E,v.shadowStroke),E.strokeText(B[Y],w+k,R),v.syncShadow(E,v.shadowFill)),E.fillText(B[Y],w+k,R),k+=E.measureText(B[Y]).width+P;else E.fillText(_[I],w,R)}return E.restore(),this.renderer&&this.renderer.gl&&(this.frame.source.glTexture=this.renderer.canvasToTexture(m,this.frame.source.glTexture,!0)),this.dirty=!1,g&&(g.dirty=!1),this},setObjectKey:function(g){return this.key=g,p.use(this),this.reuseTexture=!0,this}});t.exports=d}),Wu=S((e,t)=>{"use strict";var i=V(),s=me(),n=Fe(),r=da(),o=new i({Extends:n,Mixins:[s.AlphaSingle,s.BlendMode,s.Depth,s.GetBounds,s.Mask,s.Origin,s.Pipeline,s.PostPipeline,s.ScrollFactor,s.Transform,s.Visible],initialize:function(a,h,l){h===void 0&&(h="Shape"),n.call(this,a,h),this.geom=l,this.pathData=[],this.pathIndexes=[],this.fillColor=16777215,this.fillAlpha=1,this.strokeColor=16777215,this.strokeAlpha=1,this.lineWidth=1,this.isFilled=!1,this.isStroked=!1,this.closePath=!0,this._tempLine=new r,this.width=0,this.height=0,this.initPipeline(),this.initPostPipeline()},setFillStyle:function(a,h){return h===void 0&&(h=1),a===void 0?this.isFilled=!1:(this.fillColor=a,this.fillAlpha=h,this.isFilled=!0),this},setStrokeStyle:function(a,h,l){return l===void 0&&(l=1),a===void 0?this.isStroked=!1:(this.lineWidth=a,this.strokeColor=h,this.strokeAlpha=l,this.isStroked=!0),this},setClosePath:function(a){return this.closePath=a,this},setSize:function(a,h){return this.width=a,this.height=h,this},setDisplaySize:function(a,h){return this.displayWidth=a,this.displayHeight=h,this},preDestroy:function(){this.geom=null,this._tempLine=null,this.pathData=[],this.pathIndexes=[]},displayWidth:{get:function(){return this.scaleX*this.width},set:function(a){this.scaleX=a/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(a){this.scaleY=a/this.height}}});t.exports=o}),BS=S((e,t)=>{"use strict";var i=Xi(),s=_e(),n=function(r,o,a,h){a.addToRenderList(o);var l=r.pipelines.set(o.pipeline),c=i(o,a,h);l.calcMatrix.copyFrom(c.calc);var f=o._displayOriginX,u=o._displayOriginY,p=a.alpha*o.alpha;if(r.pipelines.preBatch(o),o.isStroked){var d=l.strokeTint,g=s.getTintAppendFloatAlpha(o.strokeColor,o.strokeAlpha*p);d.TL=g,d.TR=g,d.BL=g,d.BR=g,l.batchLine(o.geom.x1-f,o.geom.y1-u,o.geom.x2-f,o.geom.y2-u,o._startWidth/2,o._endWidth/2,1,0,!1,c.sprite,c.camera)}r.pipelines.postBatch(o)};t.exports=n}),NS=S((e,t)=>{"use strict";var i=Lt(),s=i,n=i;s=BS(),t.exports={renderWebGL:s,renderCanvas:n}}),zu=S((e,t)=>{"use strict";var i=V(),s=Wu(),n=da(),r=NS(),o=new i({Extends:s,Mixins:[r],initialize:function(a,h,l,c,f,u,p,d,g){h===void 0&&(h=0),l===void 0&&(l=0),c===void 0&&(c=0),f===void 0&&(f=0),u===void 0&&(u=128),p===void 0&&(p=0),s.call(this,a,"Line",new n(c,f,u,p));var m=Math.max(1,this.geom.right-this.geom.left),E=Math.max(1,this.geom.bottom-this.geom.top);this.lineWidth=1,this._startWidth=1,this._endWidth=1,this.setPosition(h,l),this.setSize(m,E),d!==void 0&&this.setStrokeStyle(1,d,g),this.updateDisplayOrigin()},setLineWidth:function(a,h){return h===void 0&&(h=a),this._startWidth=a,this._endWidth=h,this.lineWidth=a,this},setTo:function(a,h,l,c){return this.geom.setTo(a,h,l,c),this}});t.exports=o}),US=S((e,t)=>{"use strict";var i=_e(),s=function(n,r,o,a,h){var l=n.strokeTint,c=i.getTintAppendFloatAlpha(r.strokeColor,r.strokeAlpha*o);l.TL=c,l.TR=c,l.BL=c,l.BR=c;var f=r.pathData,u=f.length-1,p=r.lineWidth,d=p/2,g=f[0]-a,m=f[1]-h;r.closePath||(u-=2);for(var E=2;E<u;E+=2){var v=f[E]-a,y=f[E+1]-h;n.batchLine(g,m,v,y,d,d,p,E-2,r.closePath?E===u-1:!1),g=v,m=y}};t.exports=s}),FS=S((e,t)=>{"use strict";var i=Xi(),s=US(),n=_e(),r=function(o,a,h,l){h.addToRenderList(a);var c=o.pipelines.set(a.pipeline),f=i(a,h,l);c.calcMatrix.copyFrom(f.calc);var u=a._displayOriginX,p=a._displayOriginY,d=h.alpha*a.alpha;if(o.pipelines.preBatch(a),a.isFilled){var g=c.fillTint,m=n.getTintAppendFloatAlpha(a.fillColor,a.fillAlpha*d);g.TL=m,g.TR=m,g.BL=m,g.BR=m,c.batchFillRect(-u,-p,a.width,a.height)}a.isStroked&&s(c,a,d,u,p),o.pipelines.postBatch(a)};t.exports=r}),GS=S((e,t)=>{"use strict";var i=Lt(),s=i,n=i;s=FS(),t.exports={renderWebGL:s,renderCanvas:n}}),Vu=S((e,t)=>{"use strict";var i=V(),s=zt(),n=Wu(),r=GS(),o=new i({Extends:n,Mixins:[r],initialize:function(a,h,l,c,f,u,p){h===void 0&&(h=0),l===void 0&&(l=0),c===void 0&&(c=128),f===void 0&&(f=128),n.call(this,a,"Rectangle",new s(0,0,c,f)),this.setPosition(h,l),this.setSize(c,f),u!==void 0&&this.setFillStyle(u,p),this.updateDisplayOrigin(),this.updateData()},setSize:function(a,h){this.width=a,this.height=h,this.geom.setSize(a,h),this.updateData(),this.updateDisplayOrigin();var l=this.input;return l&&!l.customHitArea&&(l.hitArea.width=a,l.hitArea.height=h),this},updateData:function(){var a=[],h=this.geom,l=this._tempLine;return h.getLineA(l),a.push(l.x1,l.y1,l.x2,l.y2),h.getLineB(l),a.push(l.x2,l.y2),h.getLineC(l),a.push(l.x2,l.y2),h.getLineD(l),a.push(l.x2,l.y2),this.pathData=a,this}});t.exports=o}),YS=S(()=>{"use strict";var e=Ca(),t=jt();t.register("container",function(i,s,n){return this.displayList.add(new e(this.scene,i,s,n))})}),HS=S(()=>{"use strict";var e=ql(),t=jt();t.register("extern",function(){var i=new e(this.scene);return this.displayList.add(i),i})}),WS=S(()=>{"use strict";var e=ba(),t=jt();t.register("graphics",function(i){return this.displayList.add(new e(this.scene,i))})}),zS=S(()=>{"use strict";var e=Da(),t=jt();t.register("group",function(i,s){return this.updateList.add(new e(this.scene,i,s))})}),VS=S(()=>{"use strict";var e=er(),t=jt();t.register("image",function(i,s,n,r){return this.displayList.add(new e(this.scene,i,s,n,r))})}),XS=S(()=>{"use strict";var e=jt(),t=Fa();e.register("particles",function(i,s,n,r){return this.displayList.add(new t(this.scene,i,s,n,r))})}),KS=S(()=>{"use strict";var e=jt(),t=tr();e.register("sprite",function(i,s,n,r){return this.displayList.add(new t(this.scene,i,s,n,r))})}),jS=S(()=>{"use strict";var e=Ya(),t=jt();t.register("text",function(i,s,n,r){return this.displayList.add(new e(this.scene,i,s,n,r))})}),ZS=S(()=>{"use strict";var e=Jn(),t=jt();t.register("zone",function(i,s,n,r){return this.displayList.add(new e(this.scene,i,s,n,r))})}),qS=S(()=>{"use strict";var e=jt(),t=zu();e.register("line",function(i,s,n,r,o,a,h,l){return this.displayList.add(new t(this.scene,i,s,n,r,o,a,h,l))})}),QS=S(()=>{"use strict";var e=jt(),t=Vu();e.register("rectangle",function(i,s,n,r,o,a){return this.displayList.add(new t(this.scene,i,s,n,r,o,a))})}),JS=S(()=>{"use strict";var e=Ki(),t=Ca(),i=ve(),s=Ee(),n=pt();i.register("container",function(r,o){r===void 0&&(r={});var a=s(r,"x",0),h=s(r,"y",0),l=n(r,"children",null),c=new t(this.scene,a,h,l);return o!==void 0&&(r.add=o),e(this.scene,c,r),c})}),$S=S(()=>{"use strict";var e=ve(),t=ba();e.register("graphics",function(i,s){i===void 0&&(i={}),s!==void 0&&(i.add=s);var n=new t(this.scene,i);return i.add&&this.scene.sys.displayList.add(n),n})}),tA=S(()=>{"use strict";var e=ve(),t=Da();e.register("group",function(i){return new t(this.scene,null,i)})}),eA=S(()=>{"use strict";var e=Ki(),t=ve(),i=Ee(),s=er();t.register("image",function(n,r){n===void 0&&(n={});var o=i(n,"key",null),a=i(n,"frame",null),h=new s(this.scene,0,0,o,a);return r!==void 0&&(n.add=r),e(this.scene,h,n),h})}),iA=S(()=>{"use strict";var e=Ki(),t=ve(),i=Ee(),s=pt(),n=Fa();t.register("particles",function(r,o){r===void 0&&(r={});var a=i(r,"key",null),h=s(r,"config",null),l=new n(this.scene,0,0,a);return o!==void 0&&(r.add=o),e(this.scene,l,r),h&&l.setConfig(h),l})}),sA=S((e,t)=>{"use strict";var i=Ee(),s=function(n,r){var o=i(r,"anims",null);if(o===null)return n;if(typeof o=="string")n.anims.play(o);else if(typeof o=="object"){var a=n.anims,h=i(o,"key",void 0);if(h){var l=i(o,"startFrame",void 0),c=i(o,"delay",0),f=i(o,"repeat",0),u=i(o,"repeatDelay",0),p=i(o,"yoyo",!1),d=i(o,"play",!1),g=i(o,"delayedPlay",0),m={key:h,delay:c,repeat:f,repeatDelay:u,yoyo:p,startFrame:l};d?a.play(m):g>0?a.playAfterDelay(m,g):a.load(m)}}return n};t.exports=s}),nA=S(()=>{"use strict";var e=Ki(),t=sA(),i=ve(),s=Ee(),n=tr();i.register("sprite",function(r,o){r===void 0&&(r={});var a=s(r,"key",null),h=s(r,"frame",null),l=new n(this.scene,0,0,a,h);return o!==void 0&&(r.add=o),e(this.scene,l,r),t(l,r),l})}),rA=S(()=>{"use strict";var e=Ki(),t=ve(),i=Ee(),s=Ya();t.register("text",function(n,r){n===void 0&&(n={});var o=i(n,"text",""),a=i(n,"style",null),h=i(n,"padding",null);h!==null&&(a.padding=h);var l=new s(this.scene,0,0,o,a);return r!==void 0&&(n.add=r),e(this.scene,l,n),l.autoRound=i(n,"autoRound",!0),l.resolution=i(n,"resolution",1),l})}),aA=S(()=>{"use strict";var e=ve(),t=Ee(),i=Jn();e.register("zone",function(s){var n=t(s,"x",0),r=t(s,"y",0),o=t(s,"width",1),a=t(s,"height",o);return new i(this.scene,n,r,o,a)})}),oA=S((e,t)=>{"use strict";var i=Xi(),s=_e(),n=function(r,o,a,h){var l=o.vertices,c=l.length;if(c!==0){a.addToRenderList(o);var f=r.pipelines.set(o.pipeline,o),u=i(o,a,h,!1).calc;r.pipelines.preBatch(o);var p=f.setGameObject(o),d=f.vertexViewF32,g=f.vertexViewU32,m=f.vertexCount*f.currentShader.vertexComponentCount-1,E=a.roundPixels,v=o.tintFill,y=a.alpha*o.alpha,T=s.getTintAppendFloatAlpha(o.tint,y),A=f.vertexAvailable(),x=-1;A<c&&(x=A);for(var _=0;_<c;_++){var b=l[_];_===x&&(f.flush(),p=f.setGameObject(o),m=0),d[++m]=u.getXRound(b.vx,b.vy,E),d[++m]=u.getYRound(b.vx,b.vy,E),d[++m]=b.u,d[++m]=b.v,d[++m]=p,d[++m]=v,g[++m]=T,f.vertexCount++,f.currentBatch.count=f.vertexCount-f.currentBatch.start}r.pipelines.postBatch(o)}};t.exports=n}),hA=S((e,t)=>{"use strict";var i=Lt(),s=i,n=i;s=oA(),t.exports={renderWebGL:s,renderCanvas:n}}),lA=S((e,t)=>{"use strict";var i=V(),s=_e(),n=jl(),r=new i({Extends:n,initialize:function(o,a,h,l,c,f,u,p,d,g){f===void 0&&(f=16777215),u===void 0&&(u=1),p===void 0&&(p=0),d===void 0&&(d=0),g===void 0&&(g=0),n.call(this,o,a,h),this.vx=0,this.vy=0,this.vz=0,this.nx=p,this.ny=d,this.nz=g,this.u=l,this.v=c,this.color=f,this.alpha=u,this.tx=0,this.ty=0,this.ta=0,this.tu=l,this.tv=c},setUVs:function(o,a){return this.u=o,this.v=a,this.tu=o,this.tv=a,this},scrollUV:function(o,a){return this.tu+=o,this.tv+=a,this},scaleUV:function(o,a){return this.tu=this.u*o,this.tv=this.v*a,this},transformCoordinatesLocal:function(o,a,h,l){var c=this.x,f=this.y,u=this.z,p=o.val,d=c*p[0]+f*p[4]+u*p[8]+p[12],g=c*p[1]+f*p[5]+u*p[9]+p[13],m=c*p[2]+f*p[6]+u*p[10]+p[14],E=c*p[3]+f*p[7]+u*p[11]+p[15];this.vx=d/E*a,this.vy=-(g/E)*h,l<=0?this.vz=m/E:this.vz=-(m/E)},resize:function(o,a,h,l,c,f){return this.x=o,this.y=a,this.vx=this.x*h,this.vy=-this.y*l,this.vz=0,c<.5?this.vx+=h*(.5-c):c>.5&&(this.vx-=h*(c-.5)),f<.5?this.vy+=l*(.5-f):f>.5&&(this.vy-=l*(f-.5)),this},update:function(o,a,h,l,c,f,u,p){var d=this.vx*o+this.vy*h+c,g=this.vx*a+this.vy*l+f;return u&&(d=Math.round(d),g=Math.round(g)),this.tx=d,this.ty=g,this.ta=this.alpha*p,this},load:function(o,a,h,l,c){return o[++h]=this.tx,o[++h]=this.ty,o[++h]=this.tu,o[++h]=this.tv,o[++h]=l,o[++h]=c,a[++h]=s.getTintAppendFloatAlpha(this.color,this.ta),h}});t.exports=r}),Ha=S((e,t)=>{"use strict";var i=V(),s=me(),n=Fe(),r=hA(),o=lA(),a=new i({Extends:n,Mixins:[s.AlphaSingle,s.BlendMode,s.Depth,s.GetBounds,s.Mask,s.Origin,s.Pipeline,s.PostPipeline,s.ScrollFactor,s.Texture,s.Transform,s.Visible,r],initialize:function(h,l,c,f,u,p,d,g,m,E,v){n.call(this,h,"NineSlice"),this._width,this._height,this._originX=.5,this._originY=.5,this._sizeComponent=!0,this.vertices=[],this.leftWidth,this.rightWidth,this.topHeight,this.bottomHeight,this.tint=16777215,this.tintFill=!1;var y=h.textures.getFrame(f,u);this.is3Slice=!E&&!v,y&&y.scale9&&(this.is3Slice=y.is3Slice);for(var T=this.is3Slice?18:54,A=0;A<T;A++)this.vertices.push(new o);this.setPosition(l,c),this.setTexture(f,u),this.setSlices(p,d,g,m,E,v,!1),this.updateDisplayOrigin(),this.initPipeline(),this.initPostPipeline()},setSlices:function(h,l,c,f,u,p,d){c===void 0&&(c=10),f===void 0&&(f=10),u===void 0&&(u=0),p===void 0&&(p=0),d===void 0&&(d=!1);var g=this.frame,m=!1;if(this.is3Slice&&d&&u!==0&&p!==0&&(m=!0),!m){if(g&&g.scale9&&!d){var E=g.data.scale9Borders,v=E.x,y=E.y;c=v,f=g.width-E.w-v,u=y,p=g.height-E.h-y,h===void 0&&(h=g.width),l===void 0&&(l=g.height)}else h===void 0&&(h=256),l===void 0&&(l=256);this._width=h,this._height=l,this.leftWidth=c,this.rightWidth=f,this.topHeight=u,this.bottomHeight=p,this.is3Slice&&(l=g.height,this._height=l,this.topHeight=l,this.bottomHeight=0),this.updateVertices(),this.updateUVs()}return this},updateUVs:function(){var h=this.leftWidth,l=this.rightWidth,c=this.topHeight,f=this.bottomHeight,u=this.frame.width,p=this.frame.height;this.updateQuadUVs(0,0,0,h/u,c/p),this.updateQuadUVs(6,h/u,0,1-l/u,c/p),this.updateQuadUVs(12,1-l/u,0,1,c/p),this.is3Slice||(this.updateQuadUVs(18,0,c/p,h/u,1-f/p),this.updateQuadUVs(24,h/u,c/p,1-l/u,1-f/p),this.updateQuadUVs(30,1-l/u,c/p,1,1-f/p),this.updateQuadUVs(36,0,1-f/p,h/u,1),this.updateQuadUVs(42,h/u,1-f/p,1-l/u,1),this.updateQuadUVs(48,1-l/u,1-f/p,1,1))},updateVertices:function(){var h=this.leftWidth,l=this.rightWidth,c=this.topHeight,f=this.bottomHeight,u=this.width,p=this.height;this.updateQuad(0,-.5,.5,-.5+h/u,.5-c/p),this.updateQuad(6,-.5+h/u,.5,.5-l/u,.5-c/p),this.updateQuad(12,.5-l/u,.5,.5,.5-c/p),this.is3Slice||(this.updateQuad(18,-.5,.5-c/p,-.5+h/u,-.5+f/p),this.updateQuad(24,-.5+h/u,.5-c/p,.5-l/u,-.5+f/p),this.updateQuad(30,.5-l/u,.5-c/p,.5,-.5+f/p),this.updateQuad(36,-.5,-.5+f/p,-.5+h/u,-.5),this.updateQuad(42,-.5+h/u,-.5+f/p,.5-l/u,-.5),this.updateQuad(48,.5-l/u,-.5+f/p,.5,-.5))},updateQuad:function(h,l,c,f,u){var p=this.width,d=this.height,g=this.originX,m=this.originY,E=this.vertices;E[h+0].resize(l,c,p,d,g,m),E[h+1].resize(l,u,p,d,g,m),E[h+2].resize(f,c,p,d,g,m),E[h+3].resize(l,u,p,d,g,m),E[h+4].resize(f,u,p,d,g,m),E[h+5].resize(f,c,p,d,g,m)},updateQuadUVs:function(h,l,c,f,u){var p=this.vertices,d=this.frame,g=d.u0,m=d.v0,E=d.u1,v=d.v1;if(g!==0||E!==1){var y=E-g;l=g+l*y,f=g+f*y}if(m!==0||v!==1){var T=v-m;c=m+c*T,u=m+u*T}p[h+0].setUVs(l,c),p[h+1].setUVs(l,u),p[h+2].setUVs(f,c),p[h+3].setUVs(l,u),p[h+4].setUVs(f,u),p[h+5].setUVs(f,c)},clearTint:function(){return this.setTint(16777215),this},setTint:function(h){return h===void 0&&(h=16777215),this.tint=h,this.tintFill=!1,this},setTintFill:function(h){return this.setTint(h),this.tintFill=!0,this},isTinted:{get:function(){return this.tint!==16777215}},width:{get:function(){return this._width},set:function(h){this._width=Math.max(h,this.leftWidth+this.rightWidth),this.updateVertices()}},height:{get:function(){return this._height},set:function(h){this.is3Slice||(this._height=Math.max(h,this.topHeight+this.bottomHeight),this.updateVertices())}},displayWidth:{get:function(){return this.scaleX*this.width},set:function(h){this.scaleX=h/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(h){this.scaleY=h/this.height}},setSize:function(h,l){this.width=h,this.height=l,this.updateDisplayOrigin();var c=this.input;return c&&!c.customHitArea&&(c.hitArea.width=this.width,c.hitArea.height=this.height),this},setDisplaySize:function(h,l){return this.displayWidth=h,this.displayHeight=l,this},originX:{get:function(){return this._originX},set:function(h){this._originX=h,this.updateVertices()}},originY:{get:function(){return this._originY},set:function(h){this._originY=h,this.updateVertices()}},setOrigin:function(h,l){return h===void 0&&(h=.5),l===void 0&&(l=h),this._originX=h,this._originY=l,this.updateVertices(),this.updateDisplayOrigin()},setSizeToFrame:function(){if(this.is3Slice){var h=this.frame.height;this._height=h,this.topHeight=h,this.bottomHeight=0}return this.updateUVs(),this},preDestroy:function(){this.vertices=[]}});t.exports=a}),uA=S(()=>{"use strict";var e=Ha(),t=jt();t.register("nineslice",function(i,s,n,r,o,a,h,l,c,f){return this.displayList.add(new e(this.scene,i,s,n,r,o,a,h,l,c,f))})}),cA=S(()=>{"use strict";var e=Ki(),t=ve(),i=Ee(),s=Mt(),n=Ha();t.register("nineslice",function(r,o){r===void 0&&(r={});var a=i(r,"key",null),h=i(r,"frame",null),l=s(r,"width",256),c=s(r,"height",256),f=s(r,"leftWidth",10),u=s(r,"rightWidth",10),p=s(r,"topHeight",0),d=s(r,"bottomHeight",0),g=new n(this.scene,0,0,a,h,l,c,f,u,p,d);return o!==void 0&&(r.add=o),e(this.scene,g,r),g})}),it=S((e,t)=>{"use strict";var i={Events:Vi(),DisplayList:Ty(),GameObjectCreator:ve(),GameObjectFactory:jt(),UpdateList:Ry(),Components:me(),GetCalcMatrix:Xi(),BuildGameObject:Ki(),GameObject:Fe(),Container:Ca(),Extern:ql(),Graphics:ba(),Group:Da(),Image:er(),Particles:LS(),Sprite:tr(),Text:Ya(),GetTextSize:Gu(),MeasureText:Yu(),TextStyle:Hu(),Zone:Jn(),Line:zu(),Rectangle:Vu(),Factories:{Container:YS(),Extern:HS(),Graphics:WS(),Group:zS(),Image:VS(),Particles:XS(),Sprite:KS(),Text:jS(),Zone:ZS(),Line:qS(),Rectangle:QS()},Creators:{Container:JS(),Graphics:$S(),Group:tA(),Image:eA(),Particles:iA(),Sprite:nA(),Text:rA(),Zone:aA()}};i.NineSlice=Ha(),i.Factories.NineSlice=uA(),i.Creators.NineSlice=cA(),t.exports=i}),dA=S((e,t)=>{"use strict";t.exports={BottomCenter:uu(),BottomLeft:cu(),BottomRight:du(),Center:gu(),LeftCenter:fu(),QuickSet:Tu(),RightCenter:mu(),TopCenter:vu(),TopLeft:Eu(),TopRight:yu()}}),pA=S((e,t)=>{"use strict";t.exports={BottomCenter:Ql(),BottomLeft:Jl(),BottomRight:$l(),LeftBottom:tu(),LeftCenter:eu(),LeftTop:iu(),QuickSet:lu(),RightBottom:su(),RightCenter:nu(),RightTop:ru(),TopCenter:au(),TopLeft:ou(),TopRight:hu()}}),gA=S((e,t)=>{"use strict";var i=Qn(),s=Re(),n={In:dA(),To:pA()};n=s(!1,n,i),t.exports=n}),fA=S((e,t)=>{"use strict";var i=qe(),s=Qe(),n=Je(),r=$e(),o=zt(),a=function(h,l){l===void 0&&(l=new o);var c=s(h),f=r(h);return l.x=c,l.y=f,l.width=n(h)-c,l.height=i(h)-f,l};t.exports=a}),mA=S((e,t)=>{"use strict";var i=function(s){return s.width*s.originX};t.exports=i}),vA=S((e,t)=>{"use strict";var i=function(s){return s.height*s.originY};t.exports=i}),EA=S((e,t)=>{"use strict";t.exports={CenterOn:pu(),GetBottom:qe(),GetBounds:fA(),GetCenterX:Ss(),GetCenterY:xs(),GetLeft:Qe(),GetOffsetX:mA(),GetOffsetY:vA(),GetRight:Je(),GetTop:$e(),SetBottom:fi(),SetCenterX:As(),SetCenterY:ws(),SetLeft:pi(),SetRight:gi(),SetTop:di()}}),yA=S((e,t)=>{"use strict";var i={setCrisp:function(s){var n=["optimizeSpeed","-moz-crisp-edges","-o-crisp-edges","-webkit-optimize-contrast","optimize-contrast","crisp-edges","pixelated"];return n.forEach(function(r){s.style["image-rendering"]=r}),s.style.msInterpolationMode="nearest-neighbor",s},setBicubic:function(s){return s.style["image-rendering"]="auto",s.style.msInterpolationMode="bicubic",s}};t.exports=i}),TA=S((e,t)=>{"use strict";var i=function(s,n){return n===void 0&&(n="none"),s.style.msTouchAction=n,s.style["ms-touch-action"]=n,s.style["touch-action"]=n,s};t.exports=i}),SA=S((e,t)=>{"use strict";var i=function(s,n){n===void 0&&(n="none");var r=["-webkit-","-khtml-","-moz-","-ms-",""];return r.forEach(function(o){s.style[o+"user-select"]=n}),s.style["-webkit-touch-callout"]=n,s.style["-webkit-tap-highlight-color"]="rgba(0, 0, 0, 0)",s};t.exports=i}),AA=S((e,t)=>{"use strict";t.exports={CanvasInterpolation:yA(),CanvasPool:Ne(),Smoothing:Hh(),TouchAction:TA(),UserSelect:SA()}}),xA=S((e,t)=>{"use strict";t.exports={BitmapMask:jh(),GeometryMask:Zh()}}),dt=S((e,t)=>{"use strict";t.exports={Align:gA(),Bounds:EA(),Canvas:AA(),Masks:xA()}}),vi=S((e,t)=>{"use strict";var i={LOADER_IDLE:0,LOADER_LOADING:1,LOADER_PROCESSING:2,LOADER_COMPLETE:3,LOADER_SHUTDOWN:4,LOADER_DESTROYED:5,FILE_PENDING:10,FILE_LOADING:11,FILE_LOADED:12,FILE_FAILED:13,FILE_PROCESSING:14,FILE_ERRORED:16,FILE_COMPLETE:17,FILE_DESTROYED:18,FILE_POPULATED:19,FILE_PENDING_DESTROY:20};t.exports=i}),Ge=S((e,t)=>{"use strict";var i={},s={install:function(n){for(var r in i)n[r]=i[r]},register:function(n,r){i[n]=r},destroy:function(){i={}}};t.exports=s}),sr=S((e,t)=>{"use strict";var i=function(s,n){return s.url?s.url.match(/^(?:blob:|data:|capacitor:\/\/|http:\/\/|https:\/\/|\/\/)/)?s.url:n+s.url:!1};t.exports=i}),nr=S((e,t)=>{"use strict";var i=function(s,n,r,o,a,h){return s===void 0&&(s=""),n===void 0&&(n=!0),r===void 0&&(r=""),o===void 0&&(o=""),a===void 0&&(a=0),h===void 0&&(h=!1),{responseType:s,async:n,user:r,password:o,timeout:a,headers:void 0,header:void 0,headerValue:void 0,requestedWith:!1,overrideMimeType:void 0,withCredentials:h}};t.exports=i}),Wa=S((e,t)=>{"use strict";var i=Re(),s=nr(),n=function(r,o){var a=r===void 0?s():i({},r);if(o)for(var h in o)o[h]!==void 0&&(a[h]=o[h]);return a};t.exports=n}),Xu=S((e,t)=>{"use strict";var i=Wa(),s=function(n,r){var o=i(r,n.xhrSettings);if(n.base64){var a=n.url.split(";base64,").pop()||n.url.split(",").pop(),h={responseText:atob(a)};n.onBase64Load(h);return}var l=new XMLHttpRequest;if(l.open("GET",n.src,o.async,o.user,o.password),l.responseType=n.xhrSettings.responseType,l.timeout=o.timeout,o.headers)for(var c in o.headers)l.setRequestHeader(c,o.headers[c]);return o.header&&o.headerValue&&l.setRequestHeader(o.header,o.headerValue),o.requestedWith&&l.setRequestHeader("X-Requested-With",o.requestedWith),o.overrideMimeType&&l.overrideMimeType(o.overrideMimeType),o.withCredentials&&(l.withCredentials=!0),l.onload=n.onLoad.bind(n,l),l.onerror=n.onError.bind(n,l),l.onprogress=n.onProgress.bind(n),l.ontimeout=n.onError.bind(n,l),l.send(),l};t.exports=s}),Rs=S((e,t)=>{"use strict";var i=V(),s=vi(),n=ci(),r=pt(),o=sr(),a=Wa(),h=Xu(),l=nr(),c=new i({initialize:function(f,u){if(this.loader=f,this.cache=r(u,"cache",!1),this.type=r(u,"type",!1),!this.type)throw new Error("Invalid File type: "+this.type);this.key=r(u,"key",!1);var p=this.key;if(f.prefix&&f.prefix!==""&&(this.key=f.prefix+p),!this.key)throw new Error("Invalid File key: "+this.key);var d=r(u,"url");d===void 0?d=f.path+p+"."+r(u,"extension",""):typeof d=="string"&&!d.match(/^(?:blob:|data:|capacitor:\/\/|http:\/\/|https:\/\/|\/\/)/)&&(d=f.path+d),this.url=d,this.src="",this.xhrSettings=l(r(u,"responseType",void 0)),r(u,"xhrSettings",!1)&&(this.xhrSettings=a(this.xhrSettings,r(u,"xhrSettings",{}))),this.xhrLoader=null,this.state=typeof this.url=="function"?s.FILE_POPULATED:s.FILE_PENDING,this.bytesTotal=0,this.bytesLoaded=-1,this.percentComplete=-1,this.crossOrigin=void 0,this.data=void 0,this.config=r(u,"config",{}),this.multiFile,this.linkFile,this.base64=typeof d=="string"&&d.indexOf("data:")===0,this.retryAttempts=r(u,"maxRetries",f.maxRetries)},setLink:function(f){this.linkFile=f,f.linkFile=this},resetXHR:function(){this.xhrLoader&&(this.xhrLoader.onload=void 0,this.xhrLoader.onerror=void 0,this.xhrLoader.onprogress=void 0)},load:function(){if(this.state===s.FILE_POPULATED)this.loader.nextFile(this,!0);else{if(this.state=s.FILE_LOADING,this.src=o(this,this.loader.baseURL),!this.src)throw new Error("URL Error in File: "+this.key+" from: "+this.url);this.src.indexOf("data:")===0&&(this.base64=!0),this.xhrLoader=h(this,this.loader.xhr)}},onLoad:function(f,u){var p=f.responseURL&&this.loader.localSchemes.some(function(m){return f.responseURL.indexOf(m)===0}),d=p&&u.target.status===0,g=!(u.target&&u.target.status!==200)||d;f.readyState===4&&f.status>=400&&f.status<=599&&(g=!1),this.state=s.FILE_LOADED,this.resetXHR(),this.loader.nextFile(this,g)},onBase64Load:function(f){this.xhrLoader=f,this.state=s.FILE_LOADED,this.percentComplete=1,this.loader.emit(n.FILE_PROGRESS,this,this.percentComplete),this.loader.nextFile(this,!0)},onError:function(){this.resetXHR(),this.retryAttempts>0?(this.retryAttempts--,this.load()):this.loader.nextFile(this,!1)},onProgress:function(f){f.lengthComputable&&(this.bytesLoaded=f.loaded,this.bytesTotal=f.total,this.percentComplete=Math.min(this.bytesLoaded/this.bytesTotal,1),this.loader.emit(n.FILE_PROGRESS,this,this.percentComplete))},onProcess:function(){this.state=s.FILE_PROCESSING,this.onProcessComplete()},onProcessComplete:function(){this.state=s.FILE_COMPLETE,this.multiFile&&this.multiFile.onFileComplete(this),this.loader.fileProcessComplete(this)},onProcessError:function(){this.state=s.FILE_ERRORED,this.multiFile&&this.multiFile.onFileFailed(this),this.loader.fileProcessComplete(this)},hasCacheConflict:function(){return this.cache&&this.cache.exists(this.key)},addToCache:function(){this.cache&&this.data&&this.cache.add(this.key,this.data)},pendingDestroy:function(f){if(this.state!==s.FILE_PENDING_DESTROY){f===void 0&&(f=this.data);var u=this.key,p=this.type;this.loader.emit(n.FILE_COMPLETE,u,p,f),this.loader.emit(n.FILE_KEY_COMPLETE+p+"-"+u,u,p,f),this.loader.flagForRemoval(this),this.state=s.FILE_PENDING_DESTROY}},destroy:function(){this.loader=null,this.cache=null,this.xhrSettings=null,this.multiFile=null,this.linkFile=null,this.data=null}});c.createObjectURL=function(f,u,p){if(typeof URL=="function")f.src=URL.createObjectURL(u);else{var d=new FileReader;d.onload=function(){f.removeAttribute("crossOrigin"),f.src="data:"+(u.type||p)+";base64,"+d.result.split(",")[1]},d.onerror=f.onerror,d.readAsDataURL(u)}},c.revokeObjectURL=function(f){typeof URL=="function"&&URL.revokeObjectURL(f.src)},t.exports=c}),ln=S((e,t)=>{"use strict";var i=V(),s=vi(),n=Rs(),r=Ge(),o=pt(),a=oe(),h=sr(),l=new i({Extends:n,initialize:function c(f,u,p,d,g){var m="png",E;if(a(u)){var v=u;u=o(v,"key"),p=o(v,"url"),E=o(v,"normalMap"),d=o(v,"xhrSettings"),m=o(v,"extension",m),g=o(v,"frameConfig")}Array.isArray(p)&&(E=p[1],p=p[0]);var y={type:"image",cache:f.textureManager,extension:m,responseType:"blob",key:u,url:p,xhrSettings:d,config:g};if(n.call(this,f,y),E){var T=new c(f,this.key,E,d,g);T.type="normalMap",this.setLink(T),f.addFile(T)}this.useImageElementLoad=f.imageLoadType==="HTMLImageElement"||this.base64,this.useImageElementLoad&&(this.load=this.loadImage,this.onProcess=this.onProcessImage)},onProcess:function(){this.state=s.FILE_PROCESSING,this.data=new Image,this.data.crossOrigin=this.crossOrigin;var c=this;this.data.onload=function(){n.revokeObjectURL(c.data),c.onProcessComplete()},this.data.onerror=function(){n.revokeObjectURL(c.data),c.onProcessError()},n.createObjectURL(this.data,this.xhrLoader.response,"image/png")},onProcessImage:function(){var c=this.state;this.state=s.FILE_PROCESSING,c===s.FILE_LOADED?this.onProcessComplete():this.onProcessError()},loadImage:function(){this.state=s.FILE_LOADING,this.src=h(this,this.loader.baseURL),this.data=new Image,this.data.crossOrigin=this.crossOrigin;var c=this;this.data.onload=function(){c.state=s.FILE_LOADED,c.loader.nextFile(c,!0)},this.data.onerror=function(){c.loader.nextFile(c,!1)},this.data.src=this.src},addToCache:function(){var c=this.linkFile;c?c.state>=s.FILE_COMPLETE&&(c.type==="spritesheet"?c.addToCache():this.type==="normalMap"?this.cache.addImage(this.key,c.data,this.data):this.cache.addImage(this.key,this.data,c.data)):this.cache.addImage(this.key,this.data)}});r.register("image",function(c,f,u){if(Array.isArray(c))for(var p=0;p<c.length;p++)this.addFile(new l(this,c[p]));else this.addFile(new l(this,c,f,u));return this}),t.exports=l}),za=S((e,t)=>{"use strict";var i=V(),s=vi(),n=Rs(),r=Ge(),o=pt(),a=Mt(),h=oe(),l=new i({Extends:n,initialize:function(c,f,u,p,d){var g="json";if(h(f)){var m=f;f=o(m,"key"),u=o(m,"url"),p=o(m,"xhrSettings"),g=o(m,"extension",g),d=o(m,"dataKey",d)}var E={type:"json",cache:c.cacheManager.json,extension:g,responseType:"text",key:f,url:u,xhrSettings:p,config:d};n.call(this,c,E),h(u)&&(d?this.data=a(u,d):this.data=u,this.state=s.FILE_POPULATED)},onProcess:function(){if(this.state!==s.FILE_POPULATED){this.state=s.FILE_PROCESSING;try{var c=JSON.parse(this.xhrLoader.responseText)}catch(u){throw this.onProcessError(),u}var f=this.config;typeof f=="string"?this.data=a(c,f,c):this.data=c}this.onProcessComplete()}});r.register("json",function(c,f,u,p){if(Array.isArray(c))for(var d=0;d<c.length;d++)this.addFile(new l(this,c[d]));else this.addFile(new l(this,c,f,p,u));return this}),t.exports=l}),rr=S((e,t)=>{"use strict";var i=V(),s=vi(),n=ci(),r=new i({initialize:function(o,a,h,l){var c=[];l.forEach(function(p){p&&c.push(p)}),this.loader=o,this.type=a,this.key=h;var f=this.key;o.prefix&&o.prefix!==""&&(this.key=o.prefix+f),this.multiKeyIndex=o.multiKeyIndex++,this.files=c,this.state=s.FILE_PENDING,this.complete=!1,this.pending=c.length,this.failed=0,this.config={},this.baseURL=o.baseURL,this.path=o.path,this.prefix=o.prefix;for(var u=0;u<c.length;u++)c[u].multiFile=this},isReadyToProcess:function(){return this.pending===0&&this.failed===0&&!this.complete},addToMultiFile:function(o){return this.files.push(o),o.multiFile=this,this.pending++,this.complete=!1,this},onFileComplete:function(o){var a=this.files.indexOf(o);a!==-1&&this.pending--},onFileFailed:function(o){var a=this.files.indexOf(o);a!==-1&&this.failed++},pendingDestroy:function(){if(this.state!==s.FILE_PENDING_DESTROY){var o=this.key,a=this.type;this.loader.emit(n.FILE_COMPLETE,o,a),this.loader.emit(n.FILE_KEY_COMPLETE+a+"-"+o,o,a),this.loader.flagForRemoval(this);for(var h=0;h<this.files.length;h++)this.files[h].pendingDestroy();this.state=s.FILE_PENDING_DESTROY}},destroy:function(){this.loader=null,this.files=null,this.config=null}});t.exports=r}),wA=S((e,t)=>{"use strict";var i=V(),s=Ge(),n=pt(),r=ln(),o=oe(),a=za(),h=rr(),l=new i({Extends:h,initialize:function(c,f,u,p,d,g){var m,E;if(o(f)){var v=f;f=n(v,"key"),m=new r(c,{key:f,url:n(v,"textureURL"),extension:n(v,"textureExtension","png"),normalMap:n(v,"normalMap"),xhrSettings:n(v,"textureXhrSettings")}),E=new a(c,{key:f,url:n(v,"atlasURL"),extension:n(v,"atlasExtension","json"),xhrSettings:n(v,"atlasXhrSettings")})}else m=new r(c,f,u,d),E=new a(c,f,p,g);m.linkFile?h.call(this,c,"atlasjson",f,[m,E,m.linkFile]):h.call(this,c,"atlasjson",f,[m,E])},addToCache:function(){if(this.isReadyToProcess()){var c=this.files[0],f=this.files[1],u=this.files[2]?this.files[2].data:null;this.loader.textureManager.addAtlas(c.key,c.data,f.data,u),this.complete=!0}}});s.register("atlas",function(c,f,u,p,d){var g;if(Array.isArray(c))for(var m=0;m<c.length;m++)g=new l(this,c[m]),this.addFile(g.files);else g=new l(this,c,f,u,p,d),this.addFile(g.files);return this}),t.exports=l}),RA=S((e,t)=>{"use strict";var i=V(),s=ci(),n=Rs(),r=pt(),o=sr(),a=oe(),h=new i({Extends:n,initialize:function(l,c,f,u){if(a(c)){var p=c;c=r(p,"key"),u=r(p,"config",u)}var d={type:"audio",cache:l.cacheManager.audio,extension:f.type,key:c,url:f.url,config:u};n.call(this,l,d),this.locked="ontouchstart"in window,this.loaded=!1,this.filesLoaded=0,this.filesTotal=0},onLoad:function(){this.loaded||(this.loaded=!0,this.loader.nextFile(this,!0))},onError:function(){for(var l=0;l<this.data.length;l++){var c=this.data[l];c.oncanplaythrough=null,c.onerror=null}this.loader.nextFile(this,!1)},onProgress:function(l){var c=l.target;c.oncanplaythrough=null,c.onerror=null,this.filesLoaded++,this.percentComplete=Math.min(this.filesLoaded/this.filesTotal,1),this.loader.emit(s.FILE_PROGRESS,this,this.percentComplete),this.filesLoaded===this.filesTotal&&this.onLoad()},load:function(){this.data=[];var l=this.config&&this.config.instances||1;this.filesTotal=l,this.filesLoaded=0,this.percentComplete=0;for(var c=0;c<l;c++){var f=new Audio;f.dataset||(f.dataset={}),f.dataset.name=this.key+("0"+c).slice(-2),f.dataset.used="false",this.locked?f.dataset.locked="true":(f.dataset.locked="false",f.preload="auto",f.oncanplaythrough=this.onProgress.bind(this),f.onerror=this.onError.bind(this)),this.data.push(f)}for(c=0;c<this.data.length;c++)f=this.data[c],f.src=o(this,this.loader.baseURL),this.locked||f.load();this.locked&&setTimeout(this.onLoad.bind(this))}});t.exports=h}),CA=S((e,t)=>{"use strict";var i=V(),s=vi(),n=Rs(),r=Ge(),o=pt(),a=RA(),h=oe(),l=new i({Extends:n,initialize:function(c,f,u,p,d){if(h(f)){var g=f;f=o(g,"key"),p=o(g,"xhrSettings"),d=o(g,"context",d)}var m={type:"audio",cache:c.cacheManager.audio,extension:u.type,responseType:"arraybuffer",key:f,url:u.url,xhrSettings:p,config:{context:d}};n.call(this,c,m)},onProcess:function(){this.state=s.FILE_PROCESSING;var c=this;this.config.context.decodeAudioData(this.xhrLoader.response,function(f){c.data=f,c.onProcessComplete()},function(f){c.onProcessError()}),this.config.context=null}});l.create=function(c,f,u,p,d){var g=c.systems.game,m=g.config.audio,E=g.device.audio;h(f)&&(u=o(f,"url",[]),p=o(f,"config",{}));var v=l.getAudioURL(g,u);return v?E.webAudio&&!m.disableWebAudio?new l(c,f,v,d,g.sound.context):new a(c,f,v,p):null},l.getAudioURL=function(c,f){Array.isArray(f)||(f=[f]);for(var u=0;u<f.length;u++){var p=o(f[u],"url",f[u]);if(p.indexOf("blob:")===0||p.indexOf("data:")===0)return{url:p,type:""};var d=p.match(/\.([a-zA-Z0-9]+)($|\?)/);if(d=o(f[u],"type",d?d[1]:"").toLowerCase(),c.device.audio[d])return{url:p,type:d}}return null},r.register("audio",function(c,f,u,p){var d=this.systems.game,g=d.config.audio,m=d.device.audio;if(g.noAudio||!m.webAudio&&!m.audioData)return this;var E;if(Array.isArray(c))for(var v=0;v<c.length;v++)E=l.create(this,c[v]),E&&this.addFile(E);else E=l.create(this,c,f,u,p),E&&this.addFile(E);return this}),t.exports=l}),_A=S((e,t)=>{"use strict";function i(n,r){return parseInt(n.getAttribute(r),10)}var s=function(n,r,o,a,h){o===void 0&&(o=0),a===void 0&&(a=0);var l=r.cutX,c=r.cutY,f=r.source.width,u=r.source.height,p=r.sourceIndex,d={},g=n.getElementsByTagName("info")[0],m=n.getElementsByTagName("common")[0];d.font=g.getAttribute("face"),d.size=i(g,"size"),d.lineHeight=i(m,"lineHeight")+a,d.chars={};var E=n.getElementsByTagName("char"),v=r!==void 0&&r.trimmed;if(v)var y=r.height,T=r.width;for(var A=0;A<E.length;A++){var x=E[A],_=i(x,"id"),b=String.fromCharCode(_),M=i(x,"x"),w=i(x,"y"),R=i(x,"width"),I=i(x,"height");v&&(M<T&&(T=M),w<y&&(y=w)),v&&y!==0&&T!==0&&(M-=r.x,w-=r.y);var O=(l+M)/f,D=(c+w)/u,N=(l+M+R)/f,F=(c+w+I)/u;if(d.chars[_]={x:M,y:w,width:R,height:I,centerX:Math.floor(R/2),centerY:Math.floor(I/2),xOffset:i(x,"xoffset"),yOffset:i(x,"yoffset"),xAdvance:i(x,"xadvance")+o,data:{},kerning:{},u0:O,v0:D,u1:N,v1:F},h&&R!==0&&I!==0){var G=h.add(b,p,M,w,R,I);G&&G.setUVs(R,I,O,D,N,F)}}var L=n.getElementsByTagName("kerning");for(A=0;A<L.length;A++){var C=L[A],P=i(C,"first"),k=i(C,"second"),B=i(C,"amount");d.chars[k].kerning[P]=B}return d};t.exports=s}),bA=S((e,t)=>{"use strict";var i=function(s){var n="";try{if(window.DOMParser){var r=new DOMParser;n=r.parseFromString(s,"text/xml")}else n=new ActiveXObject("Microsoft.XMLDOM"),n.loadXML(s)}catch{n=null}return!n||!n.documentElement||n.getElementsByTagName("parsererror").length?null:n};t.exports=i}),PA=S((e,t)=>{"use strict";var i=V(),s=vi(),n=Rs(),r=Ge(),o=pt(),a=oe(),h=bA(),l=new i({Extends:n,initialize:function(c,f,u,p){var d="xml";if(a(f)){var g=f;f=o(g,"key"),u=o(g,"url"),p=o(g,"xhrSettings"),d=o(g,"extension",d)}var m={type:"xml",cache:c.cacheManager.xml,extension:d,responseType:"text",key:f,url:u,xhrSettings:p};n.call(this,c,m)},onProcess:function(){this.state=s.FILE_PROCESSING,this.data=h(this.xhrLoader.responseText),this.data?this.onProcessComplete():this.onProcessError()}});r.register("xml",function(c,f,u){if(Array.isArray(c))for(var p=0;p<c.length;p++)this.addFile(new l(this,c[p]));else this.addFile(new l(this,c,f,u));return this}),t.exports=l}),LA=S((e,t)=>{"use strict";var i=V(),s=Ge(),n=pt(),r=ln(),o=oe(),a=rr(),h=_A(),l=PA(),c=new i({Extends:a,initialize:function(f,u,p,d,g,m){var E,v;if(o(u)){var y=u;u=n(y,"key"),E=new r(f,{key:u,url:n(y,"textureURL"),extension:n(y,"textureExtension","png"),normalMap:n(y,"normalMap"),xhrSettings:n(y,"textureXhrSettings")}),v=new l(f,{key:u,url:n(y,"fontDataURL"),extension:n(y,"fontDataExtension","xml"),xhrSettings:n(y,"fontDataXhrSettings")})}else E=new r(f,u,p,g),v=new l(f,u,d,m);E.linkFile?a.call(this,f,"bitmapfont",u,[E,v,E.linkFile]):a.call(this,f,"bitmapfont",u,[E,v])},addToCache:function(){if(this.isReadyToProcess()){var f=this.files[0],u=this.files[1];f.addToCache();var p=f.cache.get(f.key),d=h(u.data,f.cache.getFrame(f.key),0,0,p);this.loader.cacheManager.bitmapFont.add(f.key,{data:d,texture:f.key,frame:null}),this.complete=!0}}});s.register("bitmapFont",function(f,u,p,d,g){var m;if(Array.isArray(f))for(var E=0;E<f.length;E++)m=new c(this,f[E]),this.addFile(m.files);else m=new c(this,f,u,p,d,g),this.addFile(m.files);return this}),t.exports=c}),IA=S((e,t)=>{"use strict";var i=V(),s=Ge(),n=pt(),r=ln(),o=oe(),a=za(),h=rr(),l=new i({Extends:h,initialize:function(c,f,u,p,d,g,m){if(o(f)){var E=f;f=n(E,"key"),n(E,"url",!1)?u=n(E,"url"):u=n(E,"atlasURL"),g=n(E,"xhrSettings"),p=n(E,"path"),d=n(E,"baseURL"),m=n(E,"textureXhrSettings")}var v=new a(c,f,u,g);h.call(this,c,"multiatlas",f,[v]),this.config.path=p,this.config.baseURL=d,this.config.textureXhrSettings=m},onFileComplete:function(c){var f=this.files.indexOf(c);if(f!==-1&&(this.pending--,c.type==="json"&&c.data.hasOwnProperty("textures"))){var u=c.data.textures,p=this.config,d=this.loader,g=d.baseURL,m=d.path,E=d.prefix,v=n(p,"baseURL",this.baseURL),y=n(p,"path",this.path),T=n(p,"prefix",this.prefix),A=n(p,"textureXhrSettings");d.setBaseURL(v),d.setPath(y),d.setPrefix(T);for(var x=0;x<u.length;x++){var _=u[x].image,b="MA"+this.multiKeyIndex+"_"+_,M=new r(d,b,_,A);if(this.addToMultiFile(M),d.addFile(M),u[x].normalMap){var w=new r(d,b,u[x].normalMap,A);w.type="normalMap",M.setLink(w),this.addToMultiFile(w),d.addFile(w)}}d.setBaseURL(g),d.setPath(m),d.setPrefix(E)}},addToCache:function(){if(this.isReadyToProcess()){for(var c=this.files[0],f=[],u=[],p=[],d=1;d<this.files.length;d++){var g=this.files[d];if(g.type!=="normalMap")for(var m=g.key.indexOf("_"),E=g.key.substr(m+1),v=g.data,y=0;y<c.data.textures.length;y++){var T=c.data.textures[y];if(T.image===E){u.push(v),f.push(T),g.linkFile&&p.push(g.linkFile.data);break}}}p.length===0&&(p=void 0),this.loader.textureManager.addAtlasJSONArray(this.key,u,f,p),this.complete=!0}}});s.register("multiatlas",function(c,f,u,p,d){var g;if(Array.isArray(c))for(var m=0;m<c.length;m++)g=new l(this,c[m]),this.addFile(g.files);else g=new l(this,c,f,u,p,d),this.addFile(g.files);return this}),t.exports=l}),MA=S((e,t)=>{"use strict";var i=V(),s=vi(),n=Ge(),r=ln(),o=new i({Extends:r,initialize:function(a,h,l,c,f){r.call(this,a,h,l,f,c),this.type="spritesheet"},addToCache:function(){var a=this.linkFile;a?a.state>=s.FILE_COMPLETE&&(this.type==="normalMap"?this.cache.addSpriteSheet(this.key,a.data,this.config,this.data):this.cache.addSpriteSheet(this.key,this.data,this.config,a.data)):this.cache.addSpriteSheet(this.key,this.data,this.config)}});n.register("spritesheet",function(a,h,l,c){if(Array.isArray(a))for(var f=0;f<a.length;f++)this.addFile(new o(this,a[f]));else this.addFile(new o(this,a,h,l,c));return this}),t.exports=o}),OA=S((e,t)=>{"use strict";t.exports={AtlasJSONFile:wA(),AudioFile:CA(),BitmapFontFile:LA(),ImageFile:ln(),JSONFile:za(),MultiAtlasFile:IA(),SpriteSheetFile:MA()}}),DA=S((e,t)=>{"use strict";var i=V(),s=vi(),n=_u(),r=Wt(),o=ci(),a=Ge(),h=pt(),l=Mt(),c=oe(),f=ae(),u=Nt(),p=nr(),d=new i({Extends:r,initialize:function(g){r.call(this);var m=g.sys.game.config,E=g.sys.settings.loader;this.scene=g,this.systems=g.sys,this.cacheManager=g.sys.cache,this.textureManager=g.sys.textures,this.sceneManager=g.sys.game.scene,a.install(this),this.prefix="",this.path="",this.baseURL="",this.setBaseURL(h(E,"baseURL",m.loaderBaseURL)),this.setPath(h(E,"path",m.loaderPath)),this.setPrefix(h(E,"prefix",m.loaderPrefix)),this.maxParallelDownloads=h(E,"maxParallelDownloads",m.loaderMaxParallelDownloads),this.xhr=p(h(E,"responseType",m.loaderResponseType),h(E,"async",m.loaderAsync),h(E,"user",m.loaderUser),h(E,"password",m.loaderPassword),h(E,"timeout",m.loaderTimeout),h(E,"withCredentials",m.loaderWithCredentials)),this.crossOrigin=h(E,"crossOrigin",m.loaderCrossOrigin),this.imageLoadType=h(E,"imageLoadType",m.loaderImageLoadType),this.localSchemes=h(E,"localScheme",m.loaderLocalScheme),this.totalToLoad=0,this.progress=0,this.list=new n,this.inflight=new n,this.queue=new n,this._deleteQueue=new n,this.totalFailed=0,this.totalComplete=0,this.state=s.LOADER_IDLE,this.multiKeyIndex=0,this.maxRetries=h(E,"maxRetries",m.loaderMaxRetries),g.sys.events.once(u.BOOT,this.boot,this),g.sys.events.on(u.START,this.pluginStart,this)},boot:function(){this.systems.events.once(u.DESTROY,this.destroy,this)},pluginStart:function(){this.systems.events.once(u.SHUTDOWN,this.shutdown,this)},setBaseURL:function(g){return g===void 0&&(g=""),g!==""&&g.substr(-1)!=="/"&&(g=g.concat("/")),this.baseURL=g,this},setPath:function(g){return g===void 0&&(g=""),g!==""&&g.substr(-1)!=="/"&&(g=g.concat("/")),this.path=g,this},setPrefix:function(g){return g===void 0&&(g=""),this.prefix=g,this},setCORS:function(g){return this.crossOrigin=g,this},addFile:function(g){Array.isArray(g)||(g=[g]);for(var m=0;m<g.length;m++){var E=g[m];this.keyExists(E)||(this.list.set(E),this.emit(o.ADD,E.key,E.type,this,E),this.isLoading()&&(this.totalToLoad++,this.updateProgress()))}},keyExists:function(g){var m=g.hasCacheConflict();return m||this.list.iterate(function(E){if(E.type===g.type&&E.key===g.key)return m=!0,!1}),!m&&this.isLoading()&&(this.inflight.iterate(function(E){if(E.type===g.type&&E.key===g.key)return m=!0,!1}),this.queue.iterate(function(E){if(E.type===g.type&&E.key===g.key)return m=!0,!1})),m},addPack:function(g,m){if(typeof m=="string"){var E=l(g,m);E&&(g={packKey:E})}var v=0,y=this.baseURL,T=this.path,A=this.prefix;for(var x in g)if(Object.prototype.hasOwnProperty.call(g,x)){var _=g[x],b=h(_,"baseURL",y),M=h(_,"path",T),w=h(_,"prefix",A),R=h(_,"files",null),I=h(_,"defaultType","void");if(Array.isArray(R)){this.setBaseURL(b),this.setPath(M),this.setPrefix(w);for(var O=0;O<R.length;O++){var D=R[O],N=D.hasOwnProperty("type")?D.type:I;this[N]&&(this[N](D),v++)}}}return this.setBaseURL(y),this.setPath(T),this.setPrefix(A),v>0},removePack:function(g,m){var E=this.systems.anims,v=this.cacheManager,y=this.textureManager,T={animation:"json",aseprite:"json",audio:"audio",audioSprite:"audio",binary:"binary",bitmapFont:"bitmapFont",css:null,glsl:"shader",html:"html",json:"json",obj:"obj",plugin:null,scenePlugin:null,script:null,spine:"json",text:"text",tilemapCSV:"tilemap",tilemapImpact:"tilemap",tilemapTiledJSON:"tilemap",video:"video",xml:"xml"},A;if(c(g))A=g;else if(A=v.json.get(g),!A)return;m&&(A={_:A[m]});for(var x in A){var _=A[x],b=h(_,"prefix",""),M=h(_,"files"),w=h(_,"defaultType");if(Array.isArray(M))for(var R=0;R<M.length;R++){var I=M[R],O=I.hasOwnProperty("type")?I.type:w;if(O){var D=b+I.key;if(O==="animation"&&E.remove(D),!((O==="aseprite"||O==="atlas"||O==="atlasXML"||O==="htmlTexture"||O==="image"||O==="multiatlas"||O==="spritesheet"||O==="svg"||O==="texture"||O==="unityAtlas")&&(y.remove(D),!T[O]))){if(O==="pack"){this.removePack(D,I.dataKey);continue}if(O==="spine"){var N=v.custom.spine.get(D);if(!N)continue;var F=N.prefix===void 0?"":N.prefix;v.custom.spine.remove(D);var G=v.custom.spineTextures.get(D);if(!G)continue;v.custom.spineTextures.remove(D);for(var L=0;L<G.pages.length;L++){var C=G.pages[L],P=F+C.name,k=D+":"+P;y.exists(k)?y.remove(k):y.remove(P)}}var B=T[O];if(B!==null&&B){var Y=v[B];Y.remove(D)}}}}}},isLoading:function(){return this.state===s.LOADER_LOADING||this.state===s.LOADER_PROCESSING},isReady:function(){return this.state===s.LOADER_IDLE||this.state===s.LOADER_COMPLETE},start:function(){this.isReady()&&(this.progress=0,this.totalFailed=0,this.totalComplete=0,this.totalToLoad=this.list.size,this.emit(o.START,this),this.list.size===0?this.loadComplete():(this.state=s.LOADER_LOADING,this.inflight.clear(),this.queue.clear(),this.updateProgress(),this.checkLoadQueue(),this.systems.events.on(u.UPDATE,this.update,this)))},updateProgress:function(){this.progress=1-(this.list.size+this.inflight.size)/this.totalToLoad,this.emit(o.PROGRESS,this.progress)},update:function(){this.state===s.LOADER_LOADING&&this.list.size>0&&this.inflight.size<this.maxParallelDownloads&&this.checkLoadQueue()},checkLoadQueue:function(){this.list.each(function(g){if((g.state===s.FILE_POPULATED||g.state===s.FILE_PENDING&&this.inflight.size<this.maxParallelDownloads)&&(this.inflight.set(g),this.list.delete(g),g.crossOrigin||(g.crossOrigin=this.crossOrigin),g.load()),this.inflight.size===this.maxParallelDownloads)return!1},this)},nextFile:function(g,m){this.inflight&&(this.inflight.delete(g),this.updateProgress(),m?(this.totalComplete++,this.queue.set(g),this.emit(o.FILE_LOAD,g),g.onProcess()):(this.totalFailed++,this._deleteQueue.set(g),this.emit(o.FILE_LOAD_ERROR,g),this.fileProcessComplete(g)))},fileProcessComplete:function(g){!this.scene||!this.systems||!this.systems.game||this.systems.game.pendingDestroy||(g.state===s.FILE_ERRORED?g.multiFile&&g.multiFile.onFileFailed(g):g.state===s.FILE_COMPLETE&&(g.multiFile?g.multiFile.isReadyToProcess()&&(g.multiFile.addToCache(),g.multiFile.pendingDestroy()):(g.addToCache(),g.pendingDestroy())),this.queue.delete(g),this.list.size===0&&this.inflight.size===0&&this.queue.size===0&&this.loadComplete())},loadComplete:function(){this.emit(o.POST_PROCESS,this),this.list.clear(),this.inflight.clear(),this.queue.clear(),this.progress=1,this.state=s.LOADER_COMPLETE,this.systems.events.off(u.UPDATE,this.update,this),this._deleteQueue.iterateLocal("destroy"),this._deleteQueue.clear(),this.emit(o.COMPLETE,this,this.totalComplete,this.totalFailed)},flagForRemoval:function(g){this._deleteQueue.set(g)},saveJSON:function(g,m){return this.save(JSON.stringify(g),m)},save:function(g,m,E){m===void 0&&(m="file.json"),E===void 0&&(E="application/json");var v=new Blob([g],{type:E}),y=URL.createObjectURL(v),T=document.createElement("a");return T.download=m,T.textContent="Download "+m,T.href=y,T.click(),this},reset:function(){this.list.clear(),this.inflight.clear(),this.queue.clear();var g=this.systems.game.config,m=this.systems.settings.loader;this.setBaseURL(h(m,"baseURL",g.loaderBaseURL)),this.setPath(h(m,"path",g.loaderPath)),this.setPrefix(h(m,"prefix",g.loaderPrefix)),this.state=s.LOADER_IDLE},shutdown:function(){this.reset(),this.state=s.LOADER_SHUTDOWN,this.removeAllListeners(),this.systems.events.off(u.UPDATE,this.update,this),this.systems.events.off(u.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.state=s.LOADER_DESTROYED,this.systems.events.off(u.UPDATE,this.update,this),this.systems.events.off(u.START,this.pluginStart,this),this.list=null,this.inflight=null,this.queue=null,this.scene=null,this.systems=null,this.textureManager=null,this.cacheManager=null,this.sceneManager=null}});f.register("Loader",d,"load"),t.exports=d}),Ku=S((e,t)=>{"use strict";var i=vi(),s=Re(),n={Events:ci(),FileTypes:OA(),File:Rs(),FileTypesManager:Ge(),GetURL:sr(),LoaderPlugin:DA(),MergeXHRSettings:Wa(),MultiFile:rr(),XHRLoader:Xu(),XHRSettings:nr()};n=s(!1,n,i),t.exports=n}),ju=S((e,t)=>{"use strict";var i=Ma(),s=V(),n=$n(),r=Wt(),o=mi(),a=Ce(),h=pt(),l=Mt(),c=he(),f=Uh(),u=Mh(),p=new s({Extends:r,initialize:function(d){r.call(this),this.game=d,this.textureManager=null,this.globalTimeScale=1,this.anims=new n,this.mixes=new n,this.paused=!1,this.name="AnimationManager",d.events.once(a.BOOT,this.boot,this)},boot:function(){this.textureManager=this.game.textures,this.game.events.once(a.DESTROY,this.destroy,this)},addMix:function(d,g,m){var E=this.anims,v=this.mixes,y=typeof d=="string"?d:d.key,T=typeof g=="string"?g:g.key;if(E.has(y)&&E.has(T)){var A=v.get(y);A||(A={}),A[T]=m,v.set(y,A)}return this},removeMix:function(d,g){var m=this.mixes,E=typeof d=="string"?d:d.key,v=m.get(E);if(v)if(g){var y=typeof g=="string"?g:g.key;v.hasOwnProperty(y)&&delete v[y]}else g||m.delete(E);return this},getMix:function(d,g){var m=this.mixes,E=typeof d=="string"?d:d.key,v=typeof g=="string"?g:g.key,y=m.get(E);return y&&y.hasOwnProperty(v)?y[v]:0},add:function(d,g){return this.anims.has(d)?this:(g.key=d,this.anims.set(d,g),this.emit(o.ADD_ANIMATION,d,g),this)},exists:function(d){return this.anims.has(d)},createFromAseprite:function(d,g,m){var E=[],v=this.game.cache.json.get(d);if(!v)return E;var y=this,T=l(v,"meta",null),A=l(v,"frames",null);if(T&&A){var x=l(T,"frameTags",[]);x.forEach(function(_){var b=[],M=h(_,"name",null),w=h(_,"from",0),R=h(_,"to",0),I=h(_,"direction","forward");if(M&&(!g||g&&g.indexOf(M)>-1)){for(var O=0,D=w;D<=R;D++){var N=D.toString(),F=A[N];if(F){var G=h(F,"duration",c.MAX_SAFE_INTEGER);b.push({key:d,frame:N,duration:G}),O+=G}}I==="reverse"&&(b=b.reverse());var L={key:M,frames:b,duration:O,yoyo:I==="pingpong"},C;m?m.anims&&(C=m.anims.create(L)):C=y.create(L),C&&E.push(C)}})}return E},create:function(d){var g=d.key,m=!1;return g&&(m=this.get(g),m||(m=new i(this,g,d),this.anims.set(g,m),this.emit(o.ADD_ANIMATION,g,m))),m},fromJSON:function(d,g){g===void 0&&(g=!1),g&&this.anims.clear(),typeof d=="string"&&(d=JSON.parse(d));var m=[];if(d.hasOwnProperty("anims")&&Array.isArray(d.anims)){for(var E=0;E<d.anims.length;E++)m.push(this.create(d.anims[E]));d.hasOwnProperty("globalTimeScale")&&(this.globalTimeScale=d.globalTimeScale)}else d.hasOwnProperty("key")&&d.type==="frame"&&m.push(this.create(d));return m},generateFrameNames:function(d,g){var m=l(g,"prefix",""),E=l(g,"start",0),v=l(g,"end",0),y=l(g,"suffix",""),T=l(g,"zeroPad",0),A=l(g,"outputArray",[]),x=l(g,"frames",!1);if(!this.textureManager.exists(d))return A;var _=this.textureManager.get(d);if(!_)return A;var b;if(g)for(x||(x=f(E,v)),b=0;b<x.length;b++){var M=m+u(x[b],T,"0",1)+y;_.has(M)&&A.push({key:d,frame:M})}else for(x=_.getFrameNames(),b=0;b<x.length;b++)A.push({key:d,frame:x[b]});return A},generateFrameNumbers:function(d,g){var m=l(g,"start",0),E=l(g,"end",-1),v=l(g,"first",!1),y=l(g,"outputArray",[]),T=l(g,"frames",!1);if(!this.textureManager.exists(d))return y;var A=this.textureManager.get(d);if(!A)return y;v&&A.has(v)&&y.push({key:d,frame:v}),T||(E===-1&&(E=A.frameTotal-2),T=f(m,E));for(var x=0;x<T.length;x++){var _=T[x];A.has(_)&&y.push({key:d,frame:_})}return y},get:function(d){return this.anims.get(d)},getAnimsFromTexture:function(d){for(var g=this.textureManager.get(d),m=g.key,E=this.anims.getArray(),v=[],y=0;y<E.length;y++)for(var T=E[y],A=T.frames,x=0;x<A.length;x++)if(A[x].textureKey===m){v.push(T.key);break}return v},pauseAll:function(){return this.paused||(this.paused=!0,this.emit(o.PAUSE_ALL)),this},play:function(d,g){Array.isArray(g)||(g=[g]);for(var m=0;m<g.length;m++)g[m].anims.play(d);return this},staggerPlay:function(d,g,m,E){m===void 0&&(m=0),E===void 0&&(E=!0),Array.isArray(g)||(g=[g]);var v=g.length;E||v--;for(var y=0;y<g.length;y++){var T=m<0?Math.abs(m)*(v-y):m*y;g[y].anims.playAfterDelay(d,T)}return this},remove:function(d){var g=this.get(d);return g&&(this.emit(o.REMOVE_ANIMATION,d,g),this.anims.delete(d),this.removeMix(d)),g},resumeAll:function(){return this.paused&&(this.paused=!1,this.emit(o.RESUME_ALL)),this},toJSON:function(d){var g={anims:[],globalTimeScale:this.globalTimeScale};return d!==void 0&&d!==""?g.anims.push(this.anims.get(d).toJSON()):this.anims.each(function(m,E){g.anims.push(E.toJSON())}),g},destroy:function(){this.anims.clear(),this.mixes.clear(),this.textureManager=null,this.game=null}});t.exports=p}),qt=S((e,t)=>{"use strict";t.exports={Animation:Ma(),AnimationFrame:bu(),AnimationManager:ju(),AnimationState:Oa(),Events:mi()}}),Zu=S((e,t)=>{"use strict";var i=zt(),s=he(),n=function(r,o){if(o===void 0&&(o=new i),r.length===0)return o;for(var a=Number.MAX_VALUE,h=Number.MAX_VALUE,l=s.MIN_SAFE_INTEGER,c=s.MIN_SAFE_INTEGER,f,u,p,d=0;d<r.length;d++)f=r[d],Array.isArray(f)?(u=f[0],p=f[1]):(u=f.x,p=f.y),a=Math.min(a,u),h=Math.min(h,p),l=Math.max(l,u),c=Math.max(c,p);return o.x=a,o.y=h,o.width=l-a,o.height=c-h,o};t.exports=n}),ar=S((e,t)=>{"use strict";var i=V(),s=Zu(),n=zt(),r=Ot(),o=new i({initialize:function(a){this.type=a,this.defaultDivisions=5,this.arcLengthDivisions=100,this.cacheArcLengths=[],this.needsUpdate=!0,this.active=!0,this._tmpVec2A=new r,this._tmpVec2B=new r},draw:function(a,h){return h===void 0&&(h=32),a.strokePoints(this.getPoints(h))},getBounds:function(a,h){a||(a=new n),h===void 0&&(h=16);var l=this.getLength();h>l&&(h=l/2);var c=Math.max(1,Math.round(l/h));return s(this.getSpacedPoints(c),a)},getDistancePoints:function(a){var h=this.getLength(),l=Math.max(1,h/a);return this.getSpacedPoints(l)},getEndPoint:function(a){return a===void 0&&(a=new r),this.getPointAt(1,a)},getLength:function(){var a=this.getLengths();return a[a.length-1]},getLengths:function(a){if(a===void 0&&(a=this.arcLengthDivisions),this.cacheArcLengths.length===a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var h=[],l,c=this.getPoint(0,this._tmpVec2A),f=0;h.push(0);for(var u=1;u<=a;u++)l=this.getPoint(u/a,this._tmpVec2B),f+=l.distance(c),h.push(f),c.copy(l);return this.cacheArcLengths=h,h},getPointAt:function(a,h){var l=this.getUtoTmapping(a);return this.getPoint(l,h)},getPoints:function(a,h,l){l===void 0&&(l=[]),a||(h?a=this.getLength()/h:a=this.defaultDivisions);for(var c=0;c<=a;c++)l.push(this.getPoint(c/a));return l},getRandomPoint:function(a){return a===void 0&&(a=new r),this.getPoint(Math.random(),a)},getSpacedPoints:function(a,h,l){l===void 0&&(l=[]),a||(h?a=this.getLength()/h:a=this.defaultDivisions);for(var c=0;c<=a;c++){var f=this.getUtoTmapping(c/a,null,a);l.push(this.getPoint(f))}return l},getStartPoint:function(a){return a===void 0&&(a=new r),this.getPointAt(0,a)},getTangent:function(a,h){h===void 0&&(h=new r);var l=1e-4,c=a-l,f=a+l;return c<0&&(c=0),f>1&&(f=1),this.getPoint(c,this._tmpVec2A),this.getPoint(f,h),h.subtract(this._tmpVec2A).normalize()},getTangentAt:function(a,h){var l=this.getUtoTmapping(a);return this.getTangent(l,h)},getTFromDistance:function(a,h){return a<=0?0:this.getUtoTmapping(0,a,h)},getUtoTmapping:function(a,h,l){var c=this.getLengths(l),f=0,u=c.length,p;h?p=Math.min(h,c[u-1]):p=a*c[u-1];for(var d=0,g=u-1,m;d<=g;)if(f=Math.floor(d+(g-d)/2),m=c[f]-p,m<0)d=f+1;else if(m>0)g=f-1;else{g=f;break}if(f=g,c[f]===p)return f/(u-1);var E=c[f],v=c[f+1],y=v-E,T=(p-E)/y;return(f+T)/(u-1)},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()}});t.exports=o}),kA=S((e,t)=>{"use strict";var i=V(),s=Wl(),n=ar(),r=Ot(),o=new i({Extends:n,initialize:function(a,h,l,c){n.call(this,"CubicBezierCurve"),Array.isArray(a)&&(c=new r(a[6],a[7]),l=new r(a[4],a[5]),h=new r(a[2],a[3]),a=new r(a[0],a[1])),this.p0=a,this.p1=h,this.p2=l,this.p3=c},getStartPoint:function(a){return a===void 0&&(a=new r),a.copy(this.p0)},getResolution:function(a){return a},getPoint:function(a,h){h===void 0&&(h=new r);var l=this.p0,c=this.p1,f=this.p2,u=this.p3;return h.set(s(a,l.x,c.x,f.x,u.x),s(a,l.y,c.y,f.y,u.y))},draw:function(a,h){h===void 0&&(h=32);var l=this.getPoints(h);a.beginPath(),a.moveTo(this.p0.x,this.p0.y);for(var c=1;c<l.length;c++)a.lineTo(l[c].x,l[c].y);return a.strokePath(),a},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y,this.p2.x,this.p2.y,this.p3.x,this.p3.y]}}});o.fromJSON=function(a){var h=a.points,l=new r(h[0],h[1]),c=new r(h[2],h[3]),f=new r(h[4],h[5]),u=new r(h[6],h[7]);return new o(l,c,f,u)},t.exports=o}),BA=S((e,t)=>{"use strict";var i=V(),s=ar(),n=an(),r=Mt(),o=Kl(),a=Ot(),h=new i({Extends:s,initialize:function(l,c,f,u,p,d,g,m){if(typeof l=="object"){var E=l;l=r(E,"x",0),c=r(E,"y",0),f=r(E,"xRadius",0),u=r(E,"yRadius",f),p=r(E,"startAngle",0),d=r(E,"endAngle",360),g=r(E,"clockwise",!1),m=r(E,"rotation",0)}else u===void 0&&(u=f),p===void 0&&(p=0),d===void 0&&(d=360),g===void 0&&(g=!1),m===void 0&&(m=0);s.call(this,"EllipseCurve"),this.p0=new a(l,c),this._xRadius=f,this._yRadius=u,this._startAngle=n(p),this._endAngle=n(d),this._clockwise=g,this._rotation=n(m)},getStartPoint:function(l){return l===void 0&&(l=new a),this.getPoint(0,l)},getResolution:function(l){return l*2},getPoint:function(l,c){c===void 0&&(c=new a);for(var f=Math.PI*2,u=this._endAngle-this._startAngle,p=Math.abs(u)<Number.EPSILON;u<0;)u+=f;for(;u>f;)u-=f;u<Number.EPSILON&&(p?u=0:u=f),this._clockwise&&!p&&(u===f?u=-f:u=u-f);var d=this._startAngle+l*u,g=this.p0.x+this._xRadius*Math.cos(d),m=this.p0.y+this._yRadius*Math.sin(d);if(this._rotation!==0){var E=Math.cos(this._rotation),v=Math.sin(this._rotation),y=g-this.p0.x,T=m-this.p0.y;g=y*E-T*v+this.p0.x,m=y*v+T*E+this.p0.y}return c.set(g,m)},setXRadius:function(l){return this.xRadius=l,this},setYRadius:function(l){return this.yRadius=l,this},setWidth:function(l){return this.xRadius=l/2,this},setHeight:function(l){return this.yRadius=l/2,this},setStartAngle:function(l){return this.startAngle=l,this},setEndAngle:function(l){return this.endAngle=l,this},setClockwise:function(l){return this.clockwise=l,this},setRotation:function(l){return this.rotation=l,this},x:{get:function(){return this.p0.x},set:function(l){this.p0.x=l}},y:{get:function(){return this.p0.y},set:function(l){this.p0.y=l}},xRadius:{get:function(){return this._xRadius},set:function(l){this._xRadius=l}},yRadius:{get:function(){return this._yRadius},set:function(l){this._yRadius=l}},startAngle:{get:function(){return o(this._startAngle)},set:function(l){this._startAngle=n(l)}},endAngle:{get:function(){return o(this._endAngle)},set:function(l){this._endAngle=n(l)}},clockwise:{get:function(){return this._clockwise},set:function(l){this._clockwise=l}},angle:{get:function(){return o(this._rotation)},set:function(l){this._rotation=n(l)}},rotation:{get:function(){return this._rotation},set:function(l){this._rotation=l}},toJSON:function(){return{type:this.type,x:this.p0.x,y:this.p0.y,xRadius:this._xRadius,yRadius:this._yRadius,startAngle:o(this._startAngle),endAngle:o(this._endAngle),clockwise:this._clockwise,rotation:o(this._rotation)}}});h.fromJSON=function(l){return new h(l)},t.exports=h}),NA=S((e,t)=>{"use strict";var i=V(),s=ar(),n=Vl(),r=Ot(),o=new i({Extends:s,initialize:function(a,h,l){s.call(this,"QuadraticBezierCurve"),Array.isArray(a)&&(l=new r(a[4],a[5]),h=new r(a[2],a[3]),a=new r(a[0],a[1])),this.p0=a,this.p1=h,this.p2=l},getStartPoint:function(a){return a===void 0&&(a=new r),a.copy(this.p0)},getResolution:function(a){return a},getPoint:function(a,h){h===void 0&&(h=new r);var l=this.p0,c=this.p1,f=this.p2;return h.set(n(a,l.x,c.x,f.x),n(a,l.y,c.y,f.y))},draw:function(a,h){h===void 0&&(h=32);var l=this.getPoints(h);a.beginPath(),a.moveTo(this.p0.x,this.p0.y);for(var c=1;c<l.length;c++)a.lineTo(l[c].x,l[c].y);return a.strokePath(),a},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y,this.p2.x,this.p2.y]}}});o.fromJSON=function(a){var h=a.points,l=new r(h[0],h[1]),c=new r(h[2],h[3]),f=new r(h[4],h[5]);return new o(l,c,f)},t.exports=o}),UA=S((e,t)=>{"use strict";var i=Yl(),s=V(),n=ar(),r=Ot(),o=new s({Extends:n,initialize:function(a){a===void 0&&(a=[]),n.call(this,"SplineCurve"),this.points=[],this.addPoints(a)},addPoints:function(a){for(var h=0;h<a.length;h++){var l=new r;typeof a[h]=="number"?(l.x=a[h],l.y=a[h+1],h++):Array.isArray(a[h])?(l.x=a[h][0],l.y=a[h][1]):(l.x=a[h].x,l.y=a[h].y),this.points.push(l)}return this},addPoint:function(a,h){var l=new r(a,h);return this.points.push(l),l},getStartPoint:function(a){return a===void 0&&(a=new r),a.copy(this.points[0])},getResolution:function(a){return a*this.points.length},getPoint:function(a,h){h===void 0&&(h=new r);var l=this.points,c=(l.length-1)*a,f=Math.floor(c),u=c-f,p=l[f===0?f:f-1],d=l[f],g=l[f>l.length-2?l.length-1:f+1],m=l[f>l.length-3?l.length-1:f+2];return h.set(i(u,p.x,d.x,g.x,m.x),i(u,p.y,d.y,g.y,m.y))},toJSON:function(){for(var a=[],h=0;h<this.points.length;h++)a.push(this.points[h].x),a.push(this.points[h].y);return{type:this.type,points:a}}});o.fromJSON=function(a){return new o(a.points)},t.exports=o}),Va=S((e,t)=>{"use strict";t.exports={CubicBezier:kA(),Ellipse:BA(),QuadraticBezier:NA(),Spline:UA()}}),FA=S((e,t)=>{"use strict";var i=function(s){return s.radius>0?Math.PI*s.radius*s.radius:0};t.exports=i}),GA=S((e,t)=>{"use strict";var i=Ia(),s=function(n){return new i(n.x,n.y,n.radius)};t.exports=s}),YA=S((e,t)=>{"use strict";var i=hn(),s=function(n,r){return i(n,r.x,r.y)};t.exports=s}),HA=S((e,t)=>{"use strict";var i=hn(),s=function(n,r){return i(n,r.x,r.y)&&i(n,r.right,r.y)&&i(n,r.x,r.bottom)&&i(n,r.right,r.bottom)};t.exports=s}),WA=S((e,t)=>{"use strict";var i=function(s,n){return n.setTo(s.x,s.y,s.radius)};t.exports=i}),zA=S((e,t)=>{"use strict";var i=function(s,n){return s.x===n.x&&s.y===n.y&&s.radius===n.radius};t.exports=i}),VA=S((e,t)=>{"use strict";var i=zt(),s=function(n,r){return r===void 0&&(r=new i),r.x=n.left,r.y=n.top,r.width=n.diameter,r.height=n.diameter,r};t.exports=s}),XA=S((e,t)=>{"use strict";var i=function(s,n,r){return s.x+=n,s.y+=r,s};t.exports=i}),KA=S((e,t)=>{"use strict";var i=function(s,n){return s.x+=n.x,s.y+=n.y,s};t.exports=i}),jA=S((e,t)=>{"use strict";var i=Ia();i.Area=FA(),i.Circumference=xu(),i.CircumferencePoint=Pa(),i.Clone=GA(),i.Contains=hn(),i.ContainsPoint=YA(),i.ContainsRect=HA(),i.CopyFrom=WA(),i.Equals=zA(),i.GetBounds=VA(),i.GetPoint=Au(),i.GetPoints=wu(),i.Offset=XA(),i.OffsetPoint=KA(),i.Random=La(),t.exports=i}),ZA=S((e,t)=>{"use strict";var i=function(s){return s.width*s.height};t.exports=i}),qA=S((e,t)=>{"use strict";var i=function(s){return s.x=Math.ceil(s.x),s.y=Math.ceil(s.y),s};t.exports=i}),QA=S((e,t)=>{"use strict";var i=function(s){return s.x=Math.ceil(s.x),s.y=Math.ceil(s.y),s.width=Math.ceil(s.width),s.height=Math.ceil(s.height),s};t.exports=i}),JA=S((e,t)=>{"use strict";var i=zt(),s=function(n){return new i(n.x,n.y,n.width,n.height)};t.exports=s}),$A=S((e,t)=>{"use strict";var i=vs(),s=function(n,r){return i(n,r.x,r.y)};t.exports=s}),qu=S((e,t)=>{"use strict";var i=function(s,n){return n.width*n.height>s.width*s.height?!1:n.x>s.x&&n.x<s.right&&n.right>s.x&&n.right<s.right&&n.y>s.y&&n.y<s.bottom&&n.bottom>s.y&&n.bottom<s.bottom};t.exports=i}),tx=S((e,t)=>{"use strict";var i=function(s,n){return n===void 0&&(n=[]),n.push({x:s.x,y:s.y}),n.push({x:s.right,y:s.y}),n.push({x:s.right,y:s.bottom}),n.push({x:s.x,y:s.bottom}),n};t.exports=i}),ex=S((e,t)=>{"use strict";var i=function(s,n){return s.x===n.x&&s.y===n.y&&s.width===n.width&&s.height===n.height};t.exports=i}),Xa=S((e,t)=>{"use strict";var i=function(s){return s.height===0?NaN:s.width/s.height};t.exports=i}),ix=S((e,t)=>{"use strict";var i=Xa(),s=function(n,r){var o=i(n);return o<i(r)?n.setSize(r.height*o,r.height):n.setSize(r.width,r.width/o),n.setPosition(r.centerX-n.width/2,r.centerY-n.height/2)};t.exports=s}),sx=S((e,t)=>{"use strict";var i=Xa(),s=function(n,r){var o=i(n);return o>i(r)?n.setSize(r.height*o,r.height):n.setSize(r.width,r.width/o),n.setPosition(r.centerX-n.width/2,r.centerY-n.height/2)};t.exports=s}),nx=S((e,t)=>{"use strict";var i=function(s){return s.x=Math.floor(s.x),s.y=Math.floor(s.y),s};t.exports=i}),rx=S((e,t)=>{"use strict";var i=function(s){return s.x=Math.floor(s.x),s.y=Math.floor(s.y),s.width=Math.floor(s.width),s.height=Math.floor(s.height),s};t.exports=i}),ax=S((e,t)=>{"use strict";var i=zt(),s=function(n,r,o,a,h){return h===void 0&&(h=new i),h.setTo(Math.min(n,o),Math.min(r,a),Math.abs(n-o),Math.abs(r-a))};t.exports=s}),ox=S((e,t)=>{"use strict";var i=$t(),s=function(n,r){return r===void 0&&(r=new i),r.x=n.centerX,r.y=n.centerY,r};t.exports=s}),hx=S((e,t)=>{"use strict";var i=$t(),s=function(n,r){return r===void 0&&(r=new i),r.x=n.width,r.y=n.height,r};t.exports=s}),lx=S((e,t)=>{"use strict";var i=zt(),s=Ua(),n=function(r,o,a){return a===void 0&&(a=new i),s(r,o)?(a.x=Math.max(r.x,o.x),a.y=Math.max(r.y,o.y),a.width=Math.min(r.right,o.right)-a.x,a.height=Math.min(r.bottom,o.bottom)-a.y):a.setEmpty(),a};t.exports=n}),ux=S((e,t)=>{"use strict";var i=function(s,n){for(var r=s.x,o=s.right,a=s.y,h=s.bottom,l=0;l<n.length;l++)r=Math.min(r,n[l].x),o=Math.max(o,n[l].x),a=Math.min(a,n[l].y),h=Math.max(h,n[l].y);return s.x=r,s.y=a,s.width=o-r,s.height=h-a,s};t.exports=i}),cx=S((e,t)=>{"use strict";var i=function(s,n,r){var o=Math.min(s.x,n),a=Math.max(s.right,n);s.x=o,s.width=a-o;var h=Math.min(s.y,r),l=Math.max(s.bottom,r);return s.y=h,s.height=l-h,s};t.exports=i}),dx=S((e,t)=>{"use strict";var i=function(s,n,r){return s.x+=n,s.y+=r,s};t.exports=i}),px=S((e,t)=>{"use strict";var i=function(s,n){return s.x+=n.x,s.y+=n.y,s};t.exports=i}),gx=S((e,t)=>{"use strict";var i=function(s,n){return s.x<n.right&&s.right>n.x&&s.y<n.bottom&&s.bottom>n.y};t.exports=i}),fx=S((e,t)=>{"use strict";var i=$t(),s=an(),n=function(r,o,a){a===void 0&&(a=new i),o=s(o);var h=Math.sin(o),l=Math.cos(o),c=l>0?r.width/2:r.width/-2,f=h>0?r.height/2:r.height/-2;return Math.abs(c*h)<Math.abs(f*l)?f=c*h/l:c=f*l/h,a.x=c+r.centerX,a.y=f+r.centerY,a};t.exports=n}),mx=S((e,t)=>{"use strict";var i=Ts(),s=qu(),n=$t(),r=function(o,a,h){if(h===void 0&&(h=new n),s(o,a))switch(i(0,3)){case 0:h.x=o.x+Math.random()*(a.right-o.x),h.y=o.y+Math.random()*(a.top-o.y);break;case 1:h.x=a.x+Math.random()*(o.right-a.x),h.y=a.bottom+Math.random()*(o.bottom-a.bottom);break;case 2:h.x=o.x+Math.random()*(a.x-o.x),h.y=a.y+Math.random()*(o.bottom-a.y);break;case 3:h.x=a.right+Math.random()*(o.right-a.right),h.y=o.y+Math.random()*(a.bottom-o.y);break}return h};t.exports=r}),vx=S((e,t)=>{"use strict";var i=function(s,n){return s.width===n.width&&s.height===n.height};t.exports=i}),Ex=S((e,t)=>{"use strict";var i=function(s,n,r){return r===void 0&&(r=n),s.width*=n,s.height*=r,s};t.exports=i}),yx=S((e,t)=>{"use strict";var i=zt();i.Area=ZA(),i.Ceil=qA(),i.CeilAll=QA(),i.CenterOn=Ta(),i.Clone=JA(),i.Contains=vs(),i.ContainsPoint=$A(),i.ContainsRect=qu(),i.CopyFrom=Du(),i.Decompose=tx(),i.Equals=ex(),i.FitInside=ix(),i.FitOutside=sx(),i.Floor=nx(),i.FloorAll=rx(),i.FromPoints=Zu(),i.FromXY=ax(),i.GetAspectRatio=Xa(),i.GetCenter=ox(),i.GetPoint=ca(),i.GetPoints=Wh(),i.GetSize=hx(),i.Inflate=Nu(),i.Intersection=lx(),i.MarchingAnts=Ru(),i.MergePoints=ux(),i.MergeRect=Uu(),i.MergeXY=cx(),i.Offset=dx(),i.OffsetPoint=px(),i.Overlaps=gx(),i.Perimeter=Wn(),i.PerimeterPoint=fx(),i.Random=pa(),i.RandomOutside=mx(),i.SameDimensions=vx(),i.Scale=Ex(),i.Union=Zl(),t.exports=i}),Li=S((e,t)=>{"use strict";var i=Es(),s=Re(),n={Circle:jA(),Rectangle:yx()};n=s(!1,n,i),t.exports=n}),Tx=S((e,t)=>{"use strict";var i=ys(),s=function(n){n===void 0&&(n=1024);var r=[],o=255,a,h=255,l=0,c=0;for(a=0;a<=o;a++)r.push({r:h,g:a,b:c,color:i(h,a,c)});for(l=255,a=o;a>=0;a--)r.push({r:a,g:l,b:c,color:i(a,l,c)});for(h=0,a=0;a<=o;a++,l--)r.push({r:h,g:l,b:a,color:i(h,l,a)});for(l=0,c=255,a=0;a<=o;a++,c--,h++)r.push({r:h,g:l,b:c,color:i(h,l,c)});if(n===1024)return r;var f=[],u=0,p=1024/n;for(a=0;a<n;a++)f.push(r[Math.floor(u)]),u+=p;return f};t.exports=s}),Sx=S((e,t)=>{"use strict";var i=function(s){var n={r:s>>16&255,g:s>>8&255,b:s&255,a:255};return s>16777215&&(n.a=s>>>24),n};t.exports=i}),Qu=S((e,t)=>{"use strict";var i=function(s){var n=s.toString(16);return n.length===1?"0"+n:n};t.exports=i}),Ju=S((e,t)=>{"use strict";var i=function(s,n,r){return r<0&&(r+=1),r>1&&(r-=1),r<.16666666666666666?s+(n-s)*6*r:r<.5?n:r<.6666666666666666?s+(n-s)*(.6666666666666666-r)*6:s};t.exports=i}),Ax=S((e,t)=>{"use strict";var i=Ze(),s=Ju(),n=function(r,o,a){var h=a,l=a,c=a;if(o!==0){var f=a<.5?a*(1+o):a+o-a*o,u=2*a-f;h=s(u,f,r+1/3),l=s(u,f,r),c=s(u,f,r-1/3)}var p=new i;return p.setGLTo(h,l,c,1)};t.exports=n}),xx=S((e,t)=>{"use strict";var i=ma(),s=function(n,r){n===void 0&&(n=1),r===void 0&&(r=1);for(var o=[],a=0;a<=359;a++)o.push(i(a/359,n,r));return o};t.exports=s}),wx=S((e,t)=>{"use strict";var i=Vn(),s=ys(),n=function(a,h,l,c,f,u,p,d){p===void 0&&(p=100),d===void 0&&(d=0);var g=d/p,m=i(a,c,g),E=i(h,f,g),v=i(l,u,g);return{r:m,g:E,b:v,a:255,color:s(m,E,v)}},r=function(a,h,l,c){return l===void 0&&(l=100),c===void 0&&(c=0),n(a.r,a.g,a.b,h.r,h.g,h.b,l,c)},o=function(a,h,l,c,f,u){return f===void 0&&(f=100),u===void 0&&(u=0),n(a.r,a.g,a.b,h,l,c,f,u)};t.exports={RGBWithRGB:n,ColorWithRGB:o,ColorWithColor:r}}),Rx=S((e,t)=>{"use strict";var i=Ts(),s=Ze(),n=function(r,o){return r===void 0&&(r=0),o===void 0&&(o=255),new s(i(r,o),i(r,o),i(r,o))};t.exports=n}),Cx=S((e,t)=>{"use strict";var i=Qu(),s=function(n,r,o,a,h){return a===void 0&&(a=255),h===void 0&&(h="#"),h==="#"?"#"+((1<<24)+(n<<16)+(r<<8)+o).toString(16).slice(1,7):"0x"+i(a)+i(n)+i(r)+i(o)};t.exports=s}),$u=S((e,t)=>{"use strict";var i=Ze();i.ColorSpectrum=Tx(),i.ColorToRGBA=Sx(),i.ComponentToHex=Qu(),i.GetColor=ys(),i.GetColor32=$h(),i.HexStringToColor=el(),i.HSLToColor=Ax(),i.HSVColorWheel=xx(),i.HSVToRGB=ma(),i.HueToComponent=Ju(),i.IntegerToColor=il(),i.IntegerToRGB=va(),i.Interpolate=wx(),i.ObjectToColor=sl(),i.RandomRGB=Rx(),i.RGBStringToColor=nl(),i.RGBToHSV=tl(),i.RGBToString=Cx(),i.ValueToColor=Ea(),t.exports=i}),Ka=S((e,t)=>{var i=4,s=.001,n=1e-7,r=10,o=11,a=1/(o-1),h=typeof Float32Array=="function";function l(E,v){return 1-3*v+3*E}function c(E,v){return 3*v-6*E}function f(E){return 3*E}function u(E,v,y){return((l(v,y)*E+c(v,y))*E+f(v))*E}function p(E,v,y){return 3*l(v,y)*E*E+2*c(v,y)*E+f(v)}function d(E,v,y,T,A){var x,_,b=0;do _=v+(y-v)/2,x=u(_,T,A)-E,x>0?y=_:v=_;while(Math.abs(x)>n&&++b<r);return _}function g(E,v,y,T){for(var A=0;A<i;++A){var x=p(v,y,T);if(x===0)return v;var _=u(v,y,T)-E;v-=_/x}return v}function m(E){return E}t.exports=function(E,v,y,T){if(!(0<=E&&E<=1&&0<=y&&y<=1))throw new Error("bezier x values must be in [0, 1] range");if(E===v&&y===T)return m;for(var A=h?new Float32Array(o):new Array(o),x=0;x<o;++x)A[x]=u(x*a,E,y);function _(b){for(var M=0,w=1,R=o-1;w!==R&&A[w]<=b;++w)M+=a;--w;var I=(b-A[w])/(A[w+1]-A[w]),O=M+I*a,D=p(O,E,y);return D>=s?g(b,O,E,y):D===0?O:d(b,M,M+a,E,y)}return function(b){return b===0?0:b===1?1:u(_(b),v,T)}}}),_x=S((e,t)=>{"use strict";t.exports="losewebgl"}),bx=S((e,t)=>{"use strict";t.exports="postrender"}),Px=S((e,t)=>{"use strict";t.exports="prerender"}),Lx=S((e,t)=>{"use strict";t.exports="render"}),Ix=S((e,t)=>{"use strict";t.exports="resize"}),Mx=S((e,t)=>{"use strict";t.exports="restorewebgl"}),un=S((e,t)=>{"use strict";t.exports={LOSE_WEBGL:_x(),POST_RENDER:bx(),PRE_RENDER:Px(),RENDER:Lx(),RESIZE:Ix(),RESTORE_WEBGL:Mx()}}),cn=S((e,t)=>{"use strict";var i={BYTE:{enum:5120,size:1},UNSIGNED_BYTE:{enum:5121,size:1},SHORT:{enum:5122,size:2},UNSIGNED_SHORT:{enum:5123,size:2},INT:{enum:5124,size:4},UNSIGNED_INT:{enum:5125,size:4},FLOAT:{enum:5126,size:4}};t.exports=i}),or=S((e,t)=>{"use strict";var i={BITMAPMASK_PIPELINE:"BitmapMaskPipeline",LIGHT_PIPELINE:"Light2D",POINTLIGHT_PIPELINE:"PointLightPipeline",SINGLE_PIPELINE:"SinglePipeline",MULTI_PIPELINE:"MultiPipeline",ROPE_PIPELINE:"RopePipeline",GRAPHICS_PIPELINE:"GraphicsPipeline",POSTFX_PIPELINE:"PostFXPipeline",UTILITY_PIPELINE:"UtilityPipeline",MOBILE_PIPELINE:"MobilePipeline",FX_PIPELINE:"FxPipeline"};t.exports=i}),Ox=S((e,t)=>{"use strict";var i=function(s,n,r,o){return r===void 0&&(r=0),n===0?s:(s-=r,s=n*Math.ceil(s/n),o?(r+s)/n:r+s)};t.exports=i}),Dx=S((e,t)=>{"use strict";t.exports=["#define SHADER_NAME PHASER_BITMAP_MASK_FS","precision mediump float;","uniform vec2 uResolution;","uniform sampler2D uMainSampler;","uniform sampler2D uMaskSampler;","uniform bool uInvertMaskAlpha;","void main ()","{","    vec2 uv = gl_FragCoord.xy / uResolution;","    vec4 mainColor = texture2D(uMainSampler, uv);","    vec4 maskColor = texture2D(uMaskSampler, uv);","    if (!uInvertMaskAlpha)","    {","        mainColor *= maskColor.a;","    }","    else","    {","        mainColor *= (1.0 - maskColor.a);","    }","    gl_FragColor = mainColor;","}"].join(`
`)}),kx=S((e,t)=>{"use strict";t.exports=["#define SHADER_NAME PHASER_BITMAP_MASK_VS","precision mediump float;","attribute vec2 inPosition;","void main ()","{","    gl_Position = vec4(inPosition, 0.0, 1.0);","}"].join(`
`)}),Bx=S((e,t)=>{"use strict";t.exports="pipelineafterflush"}),Nx=S((e,t)=>{"use strict";t.exports="pipelinebeforeflush"}),Ux=S((e,t)=>{"use strict";t.exports="pipelinebind"}),Fx=S((e,t)=>{"use strict";t.exports="pipelineboot"}),Gx=S((e,t)=>{"use strict";t.exports="pipelinedestroy"}),Yx=S((e,t)=>{"use strict";t.exports="pipelinerebind"}),Hx=S((e,t)=>{"use strict";t.exports="pipelineresize"}),tc=S((e,t)=>{"use strict";t.exports={AFTER_FLUSH:Bx(),BEFORE_FLUSH:Nx(),BIND:Ux(),BOOT:Fx(),DESTROY:Gx(),REBIND:Yx(),RESIZE:Hx()}}),hr=S((e,t)=>{"use strict";var i=V(),s=un(),n=new i({initialize:function(r,o,a,h,l,c,f,u,p){h===void 0&&(h=1),l===void 0&&(l=0),c===void 0&&(c=!0),f===void 0&&(f=!1),u===void 0&&(u=!0),p===void 0&&(p=!0),this.renderer=r,this.framebuffer=null,this.texture=null,this.width=0,this.height=0,this.scale=h,this.minFilter=l,this.autoClear=c,this.autoResize=!0,this.hasDepthBuffer=u,this.forceClamp=p,this.init(o,a),f?this.renderer.on(s.RESIZE,this.resize,this):this.autoResize=!1},init:function(r,o){var a=this.renderer;try{this.texture=a.createTextureFromSource(null,r,o,this.minFilter,this.forceClamp),this.framebuffer=a.createFramebuffer(r,o,this.texture,this.hasDepthBuffer)}catch{this.texture=null,this.framebuffer=null}this.width=r,this.height=o},setAutoResize:function(r){return r&&!this.autoResize?(this.renderer.on(s.RESIZE,this.resize,this),this.autoResize=!0):!r&&this.autoResize&&(this.renderer.off(s.RESIZE,this.resize,this),this.autoResize=!1),this},resize:function(r,o){try{if(this.autoResize&&this.willResize(r,o)){var a=this.renderer;a.deleteFramebuffer(this.framebuffer),a.deleteTexture(this.texture),this.texture=a.createTextureFromSource(null,r,o,this.minFilter,this.forceClamp),this.framebuffer=a.createFramebuffer(r,o,this.texture,this.hasDepthBuffer),this.width=r,this.height=o}}catch{}finally{return this}},willResize:function(r,o){return typeof r!="number"||typeof o!="number"?!1:(r=Math.round(r*this.scale),o=Math.round(o*this.scale),r=Math.max(r,1),o=Math.max(o,1),r!==this.width||o!==this.height)},bind:function(r,o,a){r===void 0&&(r=!1);var h=this.renderer;if(r&&h.flush(),o&&a&&this.resize(o,a),h.pushFramebuffer(this.framebuffer,!1,!1),r&&this.adjustViewport(),this.autoClear){var l=this.renderer.gl;l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT)}h.clearStencilMask()},adjustViewport:function(){var r=this.renderer.gl;r.viewport(0,0,this.width,this.height),r.disable(r.SCISSOR_TEST)},clear:function(r,o,a,h){var l=this.renderer,c=l.gl;l.pushFramebuffer(this.framebuffer),r!==void 0&&o!==void 0&&a!==void 0&&h!==void 0?(c.enable(c.SCISSOR_TEST),c.scissor(r,o,a,h)):c.disable(c.SCISSOR_TEST),c.clearColor(0,0,0,0),c.clear(c.COLOR_BUFFER_BIT),l.popFramebuffer(),l.resetScissor()},unbind:function(r){r===void 0&&(r=!1);var o=this.renderer;return r&&o.flush(),o.popFramebuffer()},destroy:function(){var r=this.renderer;r.off(s.RESIZE,this.resize,this),r.deleteFramebuffer(this.framebuffer),r.deleteTexture(this.texture),this.renderer=null,this.framebuffer=null,this.texture=null}});t.exports=n}),Wx=S((e,t)=>{"use strict";var i=V(),s=Fn(),n=pt(),r=cn(),o=new i({initialize:function(a,h,l,c,f){this.pipeline=a,this.name=h,this.renderer=a.renderer,this.gl=this.renderer.gl,this.fragSrc=c,this.vertSrc=l,this.program=this.renderer.createProgram(l,c),this.attributes,this.vertexComponentCount=0,this.vertexSize=0,this.uniforms={},this.createAttributes(f),this.createUniforms()},createAttributes:function(a){var h=0,l=0,c=[];this.vertexComponentCount=0;for(var f=0;f<a.length;f++){var u=a[f],p=u.name,d=n(u,"size",1),g=n(u,"type",r.FLOAT),m=g.enum,E=g.size,v=!!u.normalized;c.push({name:p,size:d,type:m,normalized:v,offset:l,enabled:!1,location:-1}),E===4?h+=d:h++,l+=d*E}this.vertexSize=l,this.vertexComponentCount=h,this.attributes=c},bind:function(a,h){return a===void 0&&(a=!1),h===void 0&&(h=!1),h&&this.pipeline.flush(),this.renderer.setProgram(this.program),a&&this.setAttribPointers(),this},rebind:function(){return this.renderer.setProgram(this.program),this.setAttribPointers(!0),this},setAttribPointers:function(a){a===void 0&&(a=!1);for(var h=this.gl,l=this.renderer,c=this.vertexSize,f=this.attributes,u=this.program,p=0;p<f.length;p++){var d=f[p],g=d.size,m=d.type,E=d.offset,v=d.enabled,y=d.location,T=!!d.normalized;if(a){y!==-1&&l.deleteAttribLocation(y);var A=this.renderer.createAttribLocation(u,d.name);A.webGLAttribLocation>=0?(h.enableVertexAttribArray(A.webGLAttribLocation),h.vertexAttribPointer(A.webGLAttribLocation,g,m,T,c,E),d.enabled=!0,d.location=A):A.webGLAttribLocation!==-1&&h.disableVertexAttribArray(A.webGLAttribLocation)}else v?h.vertexAttribPointer(y.webGLAttribLocation,g,m,T,c,E):!v&&y!==-1&&y.webGLAttribLocation>-1&&(h.disableVertexAttribArray(y.webGLAttribLocation),d.location=-1)}return this},createUniforms:function(){var a=this.gl,h=this.program,l=this.uniforms,c,f,u,p=a.getProgramParameter(h.webGLProgram,a.ACTIVE_UNIFORMS);for(c=0;c<p;c++){var d=a.getActiveUniform(h.webGLProgram,c);if(d){f=d.name,u=this.renderer.createUniformLocation(h,f),u!==null&&(l[f]={name:f,location:u,setter:null,value1:null,value2:null,value3:null,value4:null});var g=f.indexOf("[");g>0&&(f=f.substr(0,g),l.hasOwnProperty(f)||(u=this.renderer.createUniformLocation(h,f),u!==null&&(l[f]={name:f,location:u,setter:null,value1:null,value2:null,value3:null,value4:null})))}}return this},syncUniforms:function(){var a=this.gl;this.renderer.setProgram(this.program);for(var h in this.uniforms){var l=this.uniforms[h];l.setter&&l.setter.call(a,l.location.webGLUniformLocation,l.value1,l.value2,l.value3,l.value4)}},hasUniform:function(a){return this.uniforms.hasOwnProperty(a)},resetUniform:function(a){var h=this.uniforms[a];return h&&(h.value1=null,h.value2=null,h.value3=null,h.value4=null),this},setUniform1:function(a,h,l,c){var f=this.uniforms[h];return f?((c||f.value1!==l)&&(f.setter||(f.setter=a),f.value1=l,this.renderer.setProgram(this.program),a.call(this.gl,f.location.webGLUniformLocation,l),this.pipeline.currentShader=this),this):this},setUniform2:function(a,h,l,c,f){var u=this.uniforms[h];return u?((f||u.value1!==l||u.value2!==c)&&(u.setter||(u.setter=a),u.value1=l,u.value2=c,this.renderer.setProgram(this.program),a.call(this.gl,u.location.webGLUniformLocation,l,c),this.pipeline.currentShader=this),this):this},setUniform3:function(a,h,l,c,f,u){var p=this.uniforms[h];return p?((u||p.value1!==l||p.value2!==c||p.value3!==f)&&(p.setter||(p.setter=a),p.value1=l,p.value2=c,p.value3=f,this.renderer.setProgram(this.program),a.call(this.gl,p.location.webGLUniformLocation,l,c,f),this.pipeline.currentShader=this),this):this},setUniform4:function(a,h,l,c,f,u,p){var d=this.uniforms[h];return d?((p||d.value1!==l||d.value2!==c||d.value3!==f||d.value4!==u)&&(d.setter||(d.setter=a),d.value1=l,d.value2=c,d.value3=f,d.value4=u,this.renderer.setProgram(this.program),a.call(this.gl,d.location.webGLUniformLocation,l,c,f,u),this.pipeline.currentShader=this),this):this},setBoolean:function(a,h){return this.setUniform1(this.gl.uniform1i,a,Number(h))},set1f:function(a,h){return this.setUniform1(this.gl.uniform1f,a,h)},set2f:function(a,h,l){return this.setUniform2(this.gl.uniform2f,a,h,l)},set3f:function(a,h,l,c){return this.setUniform3(this.gl.uniform3f,a,h,l,c)},set4f:function(a,h,l,c,f){return this.setUniform4(this.gl.uniform4f,a,h,l,c,f)},set1fv:function(a,h){return this.setUniform1(this.gl.uniform1fv,a,h,!0)},set2fv:function(a,h){return this.setUniform1(this.gl.uniform2fv,a,h,!0)},set3fv:function(a,h){return this.setUniform1(this.gl.uniform3fv,a,h,!0)},set4fv:function(a,h){return this.setUniform1(this.gl.uniform4fv,a,h,!0)},set1iv:function(a,h){return this.setUniform1(this.gl.uniform1iv,a,h,!0)},set2iv:function(a,h){return this.setUniform1(this.gl.uniform2iv,a,h,!0)},set3iv:function(a,h){return this.setUniform1(this.gl.uniform3iv,a,h,!0)},set4iv:function(a,h){return this.setUniform1(this.gl.uniform4iv,a,h,!0)},set1i:function(a,h){return this.setUniform1(this.gl.uniform1i,a,h)},set2i:function(a,h,l){return this.setUniform2(this.gl.uniform2i,a,h,l)},set3i:function(a,h,l,c){return this.setUniform3(this.gl.uniform3i,a,h,l,c)},set4i:function(a,h,l,c,f){return this.setUniform4(this.gl.uniform4i,a,h,l,c,f)},setMatrix2fv:function(a,h,l){return this.setUniform2(this.gl.uniformMatrix2fv,a,h,l,!0)},setMatrix3fv:function(a,h,l){return this.setUniform2(this.gl.uniformMatrix3fv,a,h,l,!0)},setMatrix4fv:function(a,h,l){return this.setUniform2(this.gl.uniformMatrix4fv,a,h,l,!0)},createProgram:function(a,h){return a===void 0&&(a=this.vertSrc),h===void 0&&(h=this.fragSrc),this.program&&this.renderer.deleteProgram(this.program),this.vertSrc=a,this.fragSrc=h,this.program=this.renderer.createProgram(a,h),this.createUniforms(),this.rebind()},destroy:function(){var a=this.renderer;s(this.uniforms,function(h){a.deleteUniformLocation(h.location)}),this.uniforms=null,s(this.attributes,function(h){a.deleteAttribLocation(h.location)}),this.attributes=null,a.deleteProgram(this.program),this.pipeline=null,this.renderer=null,this.gl=null,this.program=null}});t.exports=o}),dn=S((e,t)=>{"use strict";var i=V(),s=ga(),n=Wt(),r=tc(),o=pt(),a=Ra(),h=un(),l=hr(),c=_e(),f=Wx(),u=new i({Extends:n,initialize:function(p){n.call(this);var d=p.game,g=d.renderer,m=g.gl;this.name=o(p,"name","WebGLPipeline"),this.game=d,this.renderer=g,this.manager,this.gl=m,this.view=d.canvas,this.width=0,this.height=0,this.vertexCount=0,this.vertexCapacity=0,this.vertexData,this.vertexBuffer,this.activeBuffer,this.topology=o(p,"topology",m.TRIANGLES),this.bytes,this.vertexViewF32,this.vertexViewU32,this.active=!0,this.forceZero=o(p,"forceZero",!1),this.hasBooted=!1,this.isPostFX=!1,this.isPreFX=!1,this.renderTargets=[],this.currentRenderTarget,this.shaders=[],this.currentShader,this.projectionMatrix,this.projectionWidth=0,this.projectionHeight=0,this.config=p,this.glReset=!1,this.batch=[],this.currentBatch=null,this.currentTexture=null,this.currentUnit=0,this.activeTextures=[],this.resizeUniform=o(p,"resizeUniform","")},boot:function(){var p,d=this.gl,g=this.config,m=this.renderer;this.isPostFX||(this.projectionMatrix=new a().identity());var E=this.renderTargets,v=o(g,"renderTarget",!1);typeof v=="boolean"&&v&&(v=1);var y=m.width,T=m.height;if(typeof v=="number")for(p=0;p<v;p++)E.push(new l(m,y,T,1,0,!0));else if(Array.isArray(v))for(p=0;p<v.length;p++){var A=o(v[p],"scale",1),x=o(v[p],"minFilter",0),_=o(v[p],"autoClear",1),b=o(v[p],"autoResize",!1),M=o(v[p],"width",null),w=o(v[p],"height",M);M?E.push(new l(m,M,w,1,x,_,b)):E.push(new l(m,y,T,A,x,_,b))}E.length&&(this.currentRenderTarget=E[0]),this.setShadersFromConfig(g);var R=this.shaders,I=0;for(p=0;p<R.length;p++)R[p].vertexSize>I&&(I=R[p].vertexSize);var O=o(g,"batchSize",m.config.batchSize);this.vertexCapacity=O*6;var D=new ArrayBuffer(this.vertexCapacity*I);this.vertexData=D,this.bytes=new Uint8Array(D),this.vertexViewF32=new Float32Array(D),this.vertexViewU32=new Uint32Array(D);var N=o(g,"vertices",null);for(N?(this.vertexViewF32.set(N),this.vertexBuffer=m.createVertexBuffer(D,d.STATIC_DRAW)):this.vertexBuffer=m.createVertexBuffer(D.byteLength,d.DYNAMIC_DRAW),this.setVertexBuffer(),p=R.length-1;p>=0;p--)R[p].rebind();this.hasBooted=!0,m.on(h.RESIZE,this.resize,this),m.on(h.PRE_RENDER,this.onPreRender,this),m.on(h.RENDER,this.onRender,this),m.on(h.POST_RENDER,this.onPostRender,this),this.emit(r.BOOT,this),this.onBoot()},onBoot:function(){},onResize:function(){},setShader:function(p,d,g){var m=this.renderer;if(p!==this.currentShader||m.currentProgram!==this.currentShader.program){this.flush();var E=this.setVertexBuffer(g);E&&!d&&(d=!0),p.bind(d,!1),this.currentShader=p}return this},getShaderByName:function(p){for(var d=this.shaders,g=0;g<d.length;g++)if(d[g].name===p)return d[g]},setShadersFromConfig:function(p){var d,g=this.shaders,m=this.renderer;for(d=0;d<g.length;d++)g[d].destroy();var E="vertShader",v="fragShader",y="attributes",T=o(p,E,null),A=c.parseFragmentShaderMaxTextures(o(p,v,null),m.maxTextures),x=o(p,y,null),_=o(p,"shaders",[]),b=_.length;if(b===0)T&&A&&(this.shaders=[new f(this,"default",T,A,s(x))]);else{var M=[];for(d=0;d<b;d++){var w=_[d],R,I,O,D;if(typeof w=="string"?(R="default",I=T,O=c.parseFragmentShaderMaxTextures(w,m.maxTextures),D=x):(R=o(w,"name","default"),I=o(w,E,T),O=c.parseFragmentShaderMaxTextures(o(w,v,A),m.maxTextures),D=o(w,y,x)),R==="default"){var N=O.split(`
`),F=N[0].trim();F.indexOf("#define SHADER_NAME")>-1&&(R=F.substring(20))}I&&O&&M.push(new f(this,R,I,O,s(D)))}this.shaders=M}return this.shaders.length===0||(this.currentShader=this.shaders[0]),this},createBatch:function(p){return this.currentBatch={start:this.vertexCount,count:0,texture:[p],unit:0,maxUnit:0},this.currentUnit=0,this.currentTexture=p,this.batch.push(this.currentBatch),0},addTextureToBatch:function(p){var d=this.currentBatch;d&&(d.texture.push(p),d.unit++,d.maxUnit++)},pushBatch:function(p){if(!this.currentBatch||this.forceZero&&p!==this.currentTexture)return this.createBatch(p);if(p===this.currentTexture)return this.currentUnit;var d=this.currentBatch,g=d.texture.indexOf(p);return g===-1?d.texture.length===this.renderer.maxTextures?this.createBatch(p):(d.unit++,d.maxUnit++,d.texture.push(p),this.currentUnit=d.unit,this.currentTexture=p,d.unit):(this.currentUnit=g,this.currentTexture=p,g)},setGameObject:function(p,d){return d===void 0&&(d=p.frame),this.pushBatch(d.source.glTexture)},shouldFlush:function(p){return p===void 0&&(p=0),this.vertexCount+p>this.vertexCapacity},vertexAvailable:function(){return this.vertexCapacity-this.vertexCount},resize:function(p,d){(p!==this.width||d!==this.height)&&this.flush(),this.width=p,this.height=d;for(var g=this.renderTargets,m=0;m<g.length;m++)g[m].resize(p,d);return this.setProjectionMatrix(p,d),this.resizeUniform&&this.set2f(this.resizeUniform,p,d),this.emit(r.RESIZE,p,d,this),this.onResize(p,d),this},setProjectionMatrix:function(p,d){var g=this.projectionMatrix;if(!g)return this;this.projectionWidth=p,this.projectionHeight=d,g.ortho(0,p,d,0,-1e3,1e3);for(var m=this.shaders,E="uProjectionMatrix",v=0;v<m.length;v++){var y=m[v];y.hasUniform(E)&&(y.resetUniform(E),y.setMatrix4fv(E,!1,g.val,y))}return this},flipProjectionMatrix:function(p){p===void 0&&(p=!0);var d=this.projectionMatrix;if(!d)return this;var g=this.projectionWidth,m=this.projectionHeight;p?d.ortho(0,g,0,m,-1e3,1e3):d.ortho(0,g,m,0,-1e3,1e3),this.setMatrix4fv("uProjectionMatrix",!1,d.val)},updateProjectionMatrix:function(){if(this.projectionMatrix){var p=this.renderer.projectionWidth,d=this.renderer.projectionHeight;(this.projectionWidth!==p||this.projectionHeight!==d)&&this.setProjectionMatrix(p,d)}},bind:function(p){if(p===void 0&&(p=this.currentShader),this.glReset)return this.rebind(p);var d=!1,g=this.gl;return g.getParameter(g.ARRAY_BUFFER_BINDING)!==this.vertexBuffer&&(g.bindBuffer(g.ARRAY_BUFFER,this.vertexBuffer.webGLBuffer),this.activeBuffer=this.vertexBuffer,d=!0),p.bind(d),this.currentShader=p,this.activeTextures.length=0,this.emit(r.BIND,this,p),this.onActive(p),this},rebind:function(p){this.activeBuffer=null,this.setVertexBuffer();for(var d=this.shaders,g=d.length-1;g>=0;g--){var m=d[g].rebind();(!p||m===p)&&(this.currentShader=m)}return this.activeTextures.length=0,this.emit(r.REBIND,this.currentShader),this.onActive(this.currentShader),this.onRebind(),this.glReset=!1,this},restoreContext:function(){var p=this.shaders,d=!!this.vertexBuffer;this.activeBuffer=null,this.activeTextures.length=0,this.batch.length=0,this.currentBatch=null,this.currentTexture=null,this.currentUnit=0,d&&this.setVertexBuffer();for(var g=0;g<p.length;g++){var m=p[g];m.syncUniforms(),d&&m.rebind()}},setVertexBuffer:function(p){if(p===void 0&&(p=this.vertexBuffer),p!==this.activeBuffer){var d=this.gl;return this.gl.bindBuffer(d.ARRAY_BUFFER,p.webGLBuffer),this.activeBuffer=p,!0}return!1},preBatch:function(p){return this.currentRenderTarget&&this.currentRenderTarget.bind(),this.onPreBatch(p),this},postBatch:function(p){return this.onDraw(this.currentRenderTarget),this.onPostBatch(p),this},onDraw:function(){},unbind:function(){this.currentRenderTarget&&this.currentRenderTarget.unbind()},flush:function(p){if(p===void 0&&(p=!1),this.vertexCount>0){this.emit(r.BEFORE_FLUSH,this,p),this.onBeforeFlush(p);var d=this.gl,g=this.vertexCount,m=this.currentShader.vertexSize,E=this.topology;if(this.active){this.setVertexBuffer(),g===this.vertexCapacity?d.bufferData(d.ARRAY_BUFFER,this.vertexData,d.DYNAMIC_DRAW):d.bufferSubData(d.ARRAY_BUFFER,0,this.bytes.subarray(0,g*m));var v,y,T,A=this.batch,x=this.activeTextures;if(this.forceZero)for(x[0]||d.activeTexture(d.TEXTURE0),v=0;v<A.length;v++)y=A[v],T=y.texture[0],x[0]!==T&&(d.bindTexture(d.TEXTURE_2D,T.webGLTexture),x[0]=T),d.drawArrays(E,y.start,y.count);else for(v=0;v<A.length;v++){y=A[v];for(var _=0;_<=y.maxUnit;_++)T=y.texture[_],x[_]!==T&&(d.activeTexture(d.TEXTURE0+_),d.bindTexture(d.TEXTURE_2D,T.webGLTexture),x[_]=T);d.drawArrays(E,y.start,y.count)}}this.vertexCount=0,this.batch.length=0,this.currentBatch=null,this.currentTexture=null,this.currentUnit=0,this.emit(r.AFTER_FLUSH,this,p),this.onAfterFlush(p)}return this},onActive:function(){},onBind:function(){},onRebind:function(){},onBatch:function(){},onPreBatch:function(){},onPostBatch:function(){},onPreRender:function(){},onRender:function(){},onPostRender:function(){},onBeforeFlush:function(){},onAfterFlush:function(){},batchVert:function(p,d,g,m,E,v,y){var T=this.vertexViewF32,A=this.vertexViewU32,x=this.vertexCount*this.currentShader.vertexComponentCount-1;T[++x]=p,T[++x]=d,T[++x]=g,T[++x]=m,T[++x]=E,T[++x]=v,A[++x]=y,this.vertexCount++,this.currentBatch.count=this.vertexCount-this.currentBatch.start},batchQuad:function(p,d,g,m,E,v,y,T,A,x,_,b,M,w,R,I,O,D,N,F){F===void 0&&(F=this.currentUnit);var G=!1;this.shouldFlush(6)&&(this.flush(),G=!0),this.currentBatch||(F=this.setTexture2D(N));var L=this.vertexViewF32,C=this.vertexViewU32,P=this.vertexCount*this.currentShader.vertexComponentCount-1;return L[++P]=d,L[++P]=g,L[++P]=x,L[++P]=_,L[++P]=F,L[++P]=D,C[++P]=w,L[++P]=m,L[++P]=E,L[++P]=x,L[++P]=M,L[++P]=F,L[++P]=D,C[++P]=I,L[++P]=v,L[++P]=y,L[++P]=b,L[++P]=M,L[++P]=F,L[++P]=D,C[++P]=O,L[++P]=d,L[++P]=g,L[++P]=x,L[++P]=_,L[++P]=F,L[++P]=D,C[++P]=w,L[++P]=v,L[++P]=y,L[++P]=b,L[++P]=M,L[++P]=F,L[++P]=D,C[++P]=O,L[++P]=T,L[++P]=A,L[++P]=b,L[++P]=_,L[++P]=F,L[++P]=D,C[++P]=R,this.vertexCount+=6,this.currentBatch.count=this.vertexCount-this.currentBatch.start,this.onBatch(p),G},batchTri:function(p,d,g,m,E,v,y,T,A,x,_,b,M,w,R,I,O){O===void 0&&(O=this.currentUnit);var D=!1;this.shouldFlush(3)&&(this.flush(),D=!0),this.currentBatch||(O=this.setTexture2D(I));var N=this.vertexViewF32,F=this.vertexViewU32,G=this.vertexCount*this.currentShader.vertexComponentCount-1;return N[++G]=d,N[++G]=g,N[++G]=T,N[++G]=A,N[++G]=O,N[++G]=R,F[++G]=b,N[++G]=m,N[++G]=E,N[++G]=T,N[++G]=_,N[++G]=O,N[++G]=R,F[++G]=M,N[++G]=v,N[++G]=y,N[++G]=x,N[++G]=_,N[++G]=O,N[++G]=R,F[++G]=w,this.vertexCount+=3,this.currentBatch.count=this.vertexCount-this.currentBatch.start,this.onBatch(p),D},drawFillRect:function(p,d,g,m,E,v,y,T){y===void 0&&(y=this.renderer.whiteTexture),T===void 0&&(T=!0),p=Math.floor(p),d=Math.floor(d);var A=Math.floor(p+g),x=Math.floor(d+m),_=this.setTexture2D(y),b=c.getTintAppendFloatAlphaAndSwap(E,v),M=0,w=0,R=1,I=1;T&&(w=1,I=0),this.batchQuad(null,p,d,p,x,A,x,A,d,M,w,R,I,b,b,b,b,0,y,_)},setTexture2D:function(p){return p===void 0&&(p=this.renderer.whiteTexture),this.pushBatch(p)},bindTexture:function(p,d){d===void 0&&(d=0);var g=this.gl;return g.activeTexture(g.TEXTURE0+d),g.bindTexture(g.TEXTURE_2D,p.webGLTexture),this},bindRenderTarget:function(p,d){return this.bindTexture(p.texture,d)},setTime:function(p,d){return this.set1f(p,this.game.loop.getDuration(),d),this},setBoolean:function(p,d,g){return g===void 0&&(g=this.currentShader),g.setBoolean(p,d),this},set1f:function(p,d,g){return g===void 0&&(g=this.currentShader),g.set1f(p,d),this},set2f:function(p,d,g,m){return m===void 0&&(m=this.currentShader),m.set2f(p,d,g),this},set3f:function(p,d,g,m,E){return E===void 0&&(E=this.currentShader),E.set3f(p,d,g,m),this},set4f:function(p,d,g,m,E,v){return v===void 0&&(v=this.currentShader),v.set4f(p,d,g,m,E),this},set1fv:function(p,d,g){return g===void 0&&(g=this.currentShader),g.set1fv(p,d),this},set2fv:function(p,d,g){return g===void 0&&(g=this.currentShader),g.set2fv(p,d),this},set3fv:function(p,d,g){return g===void 0&&(g=this.currentShader),g.set3fv(p,d),this},set4fv:function(p,d,g){return g===void 0&&(g=this.currentShader),g.set4fv(p,d),this},set1iv:function(p,d,g){return g===void 0&&(g=this.currentShader),g.set1iv(p,d),this},set2iv:function(p,d,g){return g===void 0&&(g=this.currentShader),g.set2iv(p,d),this},set3iv:function(p,d,g){return g===void 0&&(g=this.currentShader),g.set3iv(p,d),this},set4iv:function(p,d,g){return g===void 0&&(g=this.currentShader),g.set4iv(p,d),this},set1i:function(p,d,g){return g===void 0&&(g=this.currentShader),g.set1i(p,d),this},set2i:function(p,d,g,m){return m===void 0&&(m=this.currentShader),m.set2i(p,d,g),this},set3i:function(p,d,g,m,E){return E===void 0&&(E=this.currentShader),E.set3i(p,d,g,m),this},set4i:function(p,d,g,m,E,v){return v===void 0&&(v=this.currentShader),v.set4i(p,d,g,m,E),this},setMatrix2fv:function(p,d,g,m){return m===void 0&&(m=this.currentShader),m.setMatrix2fv(p,d,g),this},setMatrix3fv:function(p,d,g,m){return m===void 0&&(m=this.currentShader),m.setMatrix3fv(p,d,g),this},setMatrix4fv:function(p,d,g,m){return m===void 0&&(m=this.currentShader),m.setMatrix4fv(p,d,g),this},destroy:function(){this.emit(r.DESTROY,this);var p,d=this.shaders;for(p=0;p<d.length;p++)d[p].destroy();var g=this.renderTargets;for(p=0;p<g.length;p++)g[p].destroy();var m=this.renderer;return m.deleteBuffer(this.vertexBuffer),m.off(h.RESIZE,this.resize,this),m.off(h.PRE_RENDER,this.onPreRender,this),m.off(h.RENDER,this.onRender,this),m.off(h.POST_RENDER,this.onPostRender,this),this.removeAllListeners(),this.game=null,this.renderer=null,this.manager=null,this.gl=null,this.view=null,this.shaders=null,this.renderTargets=null,this.bytes=null,this.vertexViewF32=null,this.vertexViewU32=null,this.vertexData=null,this.vertexBuffer=null,this.currentShader=null,this.currentRenderTarget=null,this.activeTextures=null,this}});t.exports=u}),ec=S((e,t)=>{"use strict";var i=V(),s=pt(),n=Dx(),r=kx(),o=cn(),a=dn(),h=new i({Extends:a,initialize:function(l){l.fragShader=s(l,"fragShader",n),l.vertShader=s(l,"vertShader",r),l.batchSize=s(l,"batchSize",1),l.vertices=s(l,"vertices",[-1,1,-1,-7,7,1]),l.attributes=s(l,"attributes",[{name:"inPosition",size:2,type:o.FLOAT}]),a.call(this,l)},boot:function(){a.prototype.boot.call(this),this.set1i("uMainSampler",0),this.set1i("uMaskSampler",1)},resize:function(l,c){a.prototype.resize.call(this,l,c),this.set2f("uResolution",l,c)},beginMask:function(l,c,f){this.renderer.beginBitmapMask(l,f)},endMask:function(l,c,f){var u=this.gl,p=this.renderer,d=l.bitmapMask;d&&u&&(p.drawBitmapMask(d,c,this),f&&this.set2f("uResolution",f.width,f.height),this.set1i("uInvertMaskAlpha",l.invertAlpha),u.drawArrays(this.topology,0,3),f&&this.set2f("uResolution",this.width,this.height),u.bindTexture(u.TEXTURE_2D,null))}});t.exports=h}),zx=S((e,t)=>{"use strict";function i(L,C,P){P=P||2;var k=C&&C.length,B=k?C[0]*P:L.length,Y=s(L,0,B,P,!0),H=[];if(!Y||Y.next===Y.prev)return H;var z,K,X,et,J,st,q;if(k&&(Y=c(L,C,Y,P)),L.length>80*P){z=X=L[0],K=et=L[1];for(var ht=P;ht<B;ht+=P)J=L[ht],st=L[ht+1],J<z&&(z=J),st<K&&(K=st),J>X&&(X=J),st>et&&(et=st);q=Math.max(X-z,et-K),q=q!==0?32767/q:0}return r(Y,H,P,z,K,q,0),H}function s(L,C,P,k,B){var Y,H;if(B===G(L,C,P,k)>0)for(Y=C;Y<P;Y+=k)H=D(Y,L[Y],L[Y+1],H);else for(Y=P-k;Y>=C;Y-=k)H=D(Y,L[Y],L[Y+1],H);return H&&x(H,H.next)&&(N(H),H=H.next),H}function n(L,C){if(!L)return L;C||(C=L);var P=L,k;do if(k=!1,!P.steiner&&(x(P,P.next)||A(P.prev,P,P.next)===0)){if(N(P),P=C=P.prev,P===P.next)break;k=!0}else P=P.next;while(k||P!==C);return C}function r(L,C,P,k,B,Y,H){if(L){!H&&Y&&g(L,k,B,Y);for(var z=L,K,X;L.prev!==L.next;){if(K=L.prev,X=L.next,Y?a(L,k,B,Y):o(L)){C.push(K.i/P|0),C.push(L.i/P|0),C.push(X.i/P|0),N(L),L=X.next,z=X.next;continue}if(L=X,L===z){H?H===1?(L=h(n(L),C,P),r(L,C,P,k,B,Y,2)):H===2&&l(L,C,P,k,B,Y):r(n(L),C,P,k,B,Y,1);break}}}}function o(L){var C=L.prev,P=L,k=L.next;if(A(C,P,k)>=0)return!1;for(var B=C.x,Y=P.x,H=k.x,z=C.y,K=P.y,X=k.y,et=B<Y?B<H?B:H:Y<H?Y:H,J=z<K?z<X?z:X:K<X?K:X,st=B>Y?B>H?B:H:Y>H?Y:H,q=z>K?z>X?z:X:K>X?K:X,ht=k.next;ht!==C;){if(ht.x>=et&&ht.x<=st&&ht.y>=J&&ht.y<=q&&y(B,z,Y,K,H,X,ht.x,ht.y)&&A(ht.prev,ht,ht.next)>=0)return!1;ht=ht.next}return!0}function a(L,C,P,k){var B=L.prev,Y=L,H=L.next;if(A(B,Y,H)>=0)return!1;for(var z=B.x,K=Y.x,X=H.x,et=B.y,J=Y.y,st=H.y,q=z<K?z<X?z:X:K<X?K:X,ht=et<J?et<st?et:st:J<st?J:st,Pt=z>K?z>X?z:X:K>X?K:X,Bt=et>J?et>st?et:st:J>st?J:st,Ct=E(q,ht,C,P,k),Vt=E(Pt,Bt,C,P,k),lt=L.prevZ,vt=L.nextZ;lt&&lt.z>=Ct&&vt&&vt.z<=Vt;){if(lt.x>=q&&lt.x<=Pt&&lt.y>=ht&&lt.y<=Bt&&lt!==B&&lt!==H&&y(z,et,K,J,X,st,lt.x,lt.y)&&A(lt.prev,lt,lt.next)>=0||(lt=lt.prevZ,vt.x>=q&&vt.x<=Pt&&vt.y>=ht&&vt.y<=Bt&&vt!==B&&vt!==H&&y(z,et,K,J,X,st,vt.x,vt.y)&&A(vt.prev,vt,vt.next)>=0))return!1;vt=vt.nextZ}for(;lt&&lt.z>=Ct;){if(lt.x>=q&&lt.x<=Pt&&lt.y>=ht&&lt.y<=Bt&&lt!==B&&lt!==H&&y(z,et,K,J,X,st,lt.x,lt.y)&&A(lt.prev,lt,lt.next)>=0)return!1;lt=lt.prevZ}for(;vt&&vt.z<=Vt;){if(vt.x>=q&&vt.x<=Pt&&vt.y>=ht&&vt.y<=Bt&&vt!==B&&vt!==H&&y(z,et,K,J,X,st,vt.x,vt.y)&&A(vt.prev,vt,vt.next)>=0)return!1;vt=vt.nextZ}return!0}function h(L,C,P){var k=L;do{var B=k.prev,Y=k.next.next;!x(B,Y)&&_(B,k,k.next,Y)&&R(B,Y)&&R(Y,B)&&(C.push(B.i/P|0),C.push(k.i/P|0),C.push(Y.i/P|0),N(k),N(k.next),k=L=Y),k=k.next}while(k!==L);return n(k)}function l(L,C,P,k,B,Y){var H=L;do{for(var z=H.next.next;z!==H.prev;){if(H.i!==z.i&&T(H,z)){var K=O(H,z);H=n(H,H.next),K=n(K,K.next),r(H,C,P,k,B,Y,0),r(K,C,P,k,B,Y,0);return}z=z.next}H=H.next}while(H!==L)}function c(L,C,P,k){var B=[],Y,H,z,K,X;for(Y=0,H=C.length;Y<H;Y++)z=C[Y]*k,K=Y<H-1?C[Y+1]*k:L.length,X=s(L,z,K,k,!1),X===X.next&&(X.steiner=!0),B.push(v(X));for(B.sort(f),Y=0;Y<B.length;Y++)P=u(B[Y],P);return P}function f(L,C){return L.x-C.x}function u(L,C){var P=p(L,C);if(!P)return C;var k=O(P,L);return n(k,k.next),n(P,P.next)}function p(L,C){var P=C,k=L.x,B=L.y,Y=-1/0,H;do{if(B<=P.y&&B>=P.next.y&&P.next.y!==P.y){var z=P.x+(B-P.y)*(P.next.x-P.x)/(P.next.y-P.y);if(z<=k&&z>Y&&(Y=z,H=P.x<P.next.x?P:P.next,z===k))return H}P=P.next}while(P!==C);if(!H)return null;var K=H,X=H.x,et=H.y,J=1/0,st;P=H;do k>=P.x&&P.x>=X&&k!==P.x&&y(B<et?k:Y,B,X,et,B<et?Y:k,B,P.x,P.y)&&(st=Math.abs(B-P.y)/(k-P.x),R(P,L)&&(st<J||st===J&&(P.x>H.x||P.x===H.x&&d(H,P)))&&(H=P,J=st)),P=P.next;while(P!==K);return H}function d(L,C){return A(L.prev,L,C.prev)<0&&A(C.next,L,L.next)<0}function g(L,C,P,k){var B=L;do B.z===0&&(B.z=E(B.x,B.y,C,P,k)),B.prevZ=B.prev,B.nextZ=B.next,B=B.next;while(B!==L);B.prevZ.nextZ=null,B.prevZ=null,m(B)}function m(L){var C,P,k,B,Y,H,z,K,X=1;do{for(P=L,L=null,Y=null,H=0;P;){for(H++,k=P,z=0,C=0;C<X&&(z++,k=k.nextZ,!!k);C++);for(K=X;z>0||K>0&&k;)z!==0&&(K===0||!k||P.z<=k.z)?(B=P,P=P.nextZ,z--):(B=k,k=k.nextZ,K--),Y?Y.nextZ=B:L=B,B.prevZ=Y,Y=B;P=k}Y.nextZ=null,X*=2}while(H>1);return L}function E(L,C,P,k,B){return L=(L-P)*B|0,C=(C-k)*B|0,L=(L|L<<8)&16711935,L=(L|L<<4)&252645135,L=(L|L<<2)&858993459,L=(L|L<<1)&1431655765,C=(C|C<<8)&16711935,C=(C|C<<4)&252645135,C=(C|C<<2)&858993459,C=(C|C<<1)&1431655765,L|C<<1}function v(L){var C=L,P=L;do(C.x<P.x||C.x===P.x&&C.y<P.y)&&(P=C),C=C.next;while(C!==L);return P}function y(L,C,P,k,B,Y,H,z){return(B-H)*(C-z)>=(L-H)*(Y-z)&&(L-H)*(k-z)>=(P-H)*(C-z)&&(P-H)*(Y-z)>=(B-H)*(k-z)}function T(L,C){return L.next.i!==C.i&&L.prev.i!==C.i&&!w(L,C)&&(R(L,C)&&R(C,L)&&I(L,C)&&(A(L.prev,L,C.prev)||A(L,C.prev,C))||x(L,C)&&A(L.prev,L,L.next)>0&&A(C.prev,C,C.next)>0)}function A(L,C,P){return(C.y-L.y)*(P.x-C.x)-(C.x-L.x)*(P.y-C.y)}function x(L,C){return L.x===C.x&&L.y===C.y}function _(L,C,P,k){var B=M(A(L,C,P)),Y=M(A(L,C,k)),H=M(A(P,k,L)),z=M(A(P,k,C));return!!(B!==Y&&H!==z||B===0&&b(L,P,C)||Y===0&&b(L,k,C)||H===0&&b(P,L,k)||z===0&&b(P,C,k))}function b(L,C,P){return C.x<=Math.max(L.x,P.x)&&C.x>=Math.min(L.x,P.x)&&C.y<=Math.max(L.y,P.y)&&C.y>=Math.min(L.y,P.y)}function M(L){return L>0?1:L<0?-1:0}function w(L,C){var P=L;do{if(P.i!==L.i&&P.next.i!==L.i&&P.i!==C.i&&P.next.i!==C.i&&_(P,P.next,L,C))return!0;P=P.next}while(P!==L);return!1}function R(L,C){return A(L.prev,L,L.next)<0?A(L,C,L.next)>=0&&A(L,L.prev,C)>=0:A(L,C,L.prev)<0||A(L,L.next,C)<0}function I(L,C){var P=L,k=!1,B=(L.x+C.x)/2,Y=(L.y+C.y)/2;do P.y>Y!=P.next.y>Y&&P.next.y!==P.y&&B<(P.next.x-P.x)*(Y-P.y)/(P.next.y-P.y)+P.x&&(k=!k),P=P.next;while(P!==L);return k}function O(L,C){var P=new F(L.i,L.x,L.y),k=new F(C.i,C.x,C.y),B=L.next,Y=C.prev;return L.next=C,C.prev=L,P.next=B,B.prev=P,k.next=P,P.prev=k,Y.next=k,k.prev=Y,k}function D(L,C,P,k){var B=new F(L,C,P);return k?(B.next=k.next,B.prev=k,k.next.prev=B,k.next=B):(B.prev=B,B.next=B),B}function N(L){L.next.prev=L.prev,L.prev.next=L.next,L.prevZ&&(L.prevZ.nextZ=L.nextZ),L.nextZ&&(L.nextZ.prevZ=L.prevZ)}function F(L,C,P){this.i=L,this.x=C,this.y=P,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}i.deviation=function(L,C,P,k){var B=C&&C.length,Y=B?C[0]*P:L.length,H=Math.abs(G(L,0,Y,P));if(B)for(var z=0,K=C.length;z<K;z++){var X=C[z]*P,et=z<K-1?C[z+1]*P:L.length;H-=Math.abs(G(L,X,et,P))}var J=0;for(z=0;z<k.length;z+=3){var st=k[z]*P,q=k[z+1]*P,ht=k[z+2]*P;J+=Math.abs((L[st]-L[ht])*(L[q+1]-L[st+1])-(L[st]-L[q])*(L[ht+1]-L[st+1]))}return H===0&&J===0?0:Math.abs((J-H)/H)};function G(L,C,P,k){for(var B=0,Y=C,H=P-k;Y<P;Y+=k)B+=(L[H]-L[Y])*(L[Y+1]+L[H+1]),H=Y;return B}i.flatten=function(L){for(var C=L[0][0].length,P={vertices:[],holes:[],dimensions:C},k=0,B=0;B<L.length;B++){for(var Y=0;Y<L[B].length;Y++)for(var H=0;H<C;H++)P.vertices.push(L[B][Y][H]);B>0&&(k+=L[B-1].length,P.holes.push(k))}return P},t.exports=i}),Vx=S((e,t)=>{"use strict";t.exports=["#define SHADER_NAME PHASER_MULTI_FS","#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","uniform sampler2D uMainSampler[%count%];","varying vec2 outTexCoord;","varying float outTexId;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    vec4 texture;","    %forloop%","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","    vec4 color = texture * texel;","    if (outTintEffect == 1.0)","    {","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        color = texel;","    }","    gl_FragColor = color;","}"].join(`
`)}),Xx=S((e,t)=>{"use strict";t.exports=["#define SHADER_NAME PHASER_MULTI_VS","precision mediump float;","uniform mat4 uProjectionMatrix;","uniform vec2 uResolution;","attribute vec2 inPosition;","attribute vec2 inTexCoord;","attribute float inTexId;","attribute float inTintEffect;","attribute vec4 inTint;","varying vec2 outTexCoord;","varying float outTexId;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","    outTexCoord = inTexCoord;","    outTexId = inTexId;","    outTint = inTint;","    outTintEffect = inTintEffect;","}"].join(`
`)}),lr=S((e,t)=>{"use strict";var i=V(),s=zx(),n=pt(),r=Vx(),o=Xx(),a=ui(),h=_e(),l=cn(),c=dn(),f=new i({Extends:c,initialize:function(u){var p=u.game.renderer,d=n(u,"fragShader",r);u.fragShader=h.parseFragmentShaderMaxTextures(d,p.maxTextures),u.vertShader=n(u,"vertShader",o),u.attributes=n(u,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2},{name:"inTexId"},{name:"inTintEffect"},{name:"inTint",size:4,type:l.UNSIGNED_BYTE,normalized:!0}]),u.resizeUniform="uResolution",c.call(this,u),this._tempMatrix1=new a,this._tempMatrix2=new a,this._tempMatrix3=new a,this.calcMatrix=new a,this.tempTriangle=[{x:0,y:0,width:0},{x:0,y:0,width:0},{x:0,y:0,width:0},{x:0,y:0,width:0}],this.strokeTint={TL:0,TR:0,BL:0,BR:0},this.fillTint={TL:0,TR:0,BL:0,BR:0},this.currentFrame={u0:0,v0:0,u1:1,v1:1},this.firstQuad=[0,0,0,0,0],this.prevQuad=[0,0,0,0,0],this.polygonCache=[]},boot:function(){c.prototype.boot.call(this);var u=this.renderer;this.set1iv("uMainSampler",u.textureIndexes),this.set2f("uResolution",u.width,u.height)},batchSprite:function(u,p,d){this.manager.set(this,u);var g=this._tempMatrix1,m=this._tempMatrix2,E=this._tempMatrix3,v=u.frame,y=v.glTexture,T=v.u0,A=v.v0,x=v.u1,_=v.v1,b=v.x,M=v.y,w=v.cutWidth,R=v.cutHeight,I=v.customPivot,O=u.displayOriginX,D=u.displayOriginY,N=-O+b,F=-D+M;if(u.isCropped){var G=u._crop;(G.flipX!==u.flipX||G.flipY!==u.flipY)&&v.updateCropUVs(G,u.flipX,u.flipY),T=G.u0,A=G.v0,x=G.u1,_=G.v1,w=G.width,R=G.height,b=G.x,M=G.y,N=-O+b,F=-D+M}var L=1,C=1;u.flipX&&(I||(N+=-v.realWidth+O*2),L=-1),u.flipY&&(I||(F+=-v.realHeight+D*2),C=-1);var P=u.x,k=u.y;p.roundPixels&&(P=Math.floor(P),k=Math.floor(k)),m.applyITRS(P,k,u.rotation,u.scaleX*L,u.scaleY*C),g.copyFrom(p.matrix),d?(g.multiplyWithOffset(d,-p.scrollX*u.scrollFactorX,-p.scrollY*u.scrollFactorY),m.e=P,m.f=k):(m.e-=p.scrollX*u.scrollFactorX,m.f-=p.scrollY*u.scrollFactorY),g.multiply(m,E);var B=E.setQuad(N,F,N+w,F+R,p.renderRoundPixels),Y=h.getTintAppendFloatAlpha,H=p.alpha,z=Y(u.tintTopLeft,H*u._alphaTL),K=Y(u.tintTopRight,H*u._alphaTR),X=Y(u.tintBottomLeft,H*u._alphaBL),et=Y(u.tintBottomRight,H*u._alphaBR);this.shouldFlush(6)&&this.flush();var J=this.setGameObject(u,v);this.manager.preBatch(u),this.batchQuad(u,B[0],B[1],B[2],B[3],B[4],B[5],B[6],B[7],T,A,x,_,z,K,X,et,u.tintFill,y,J),this.manager.postBatch(u)},batchTexture:function(u,p,d,g,m,E,v,y,T,A,x,_,b,M,w,R,I,O,D,N,F,G,L,C,P,k,B,Y,H,z,K,X,et){et===void 0&&(et=!1),this.manager.set(this,u);var J=this._tempMatrix1,st=this._tempMatrix2,q=this._tempMatrix3,ht=O/d+B,Pt=D/g+Y,Bt=(O+N)/d+B,Ct=(D+F)/g+Y,Vt=v,lt=y,vt=-R,gs=-I;if(u.isCropped){var $s=u._crop,ta=$s.width,ea=$s.height;Vt=ta,lt=ea,v=ta,y=ea,O=$s.x,D=$s.y;var bh=O,Ph=D;_&&(bh=N-$s.x-ta),b&&(Ph=F-$s.y-ea),ht=bh/d+B,Pt=Ph/g+Y,Bt=(bh+ta)/d+B,Ct=(Ph+ea)/g+Y,vt=-R+O,gs=-I+D}b=b^(!K&&p.isRenderTexture?1:0),_&&(Vt*=-1,vt+=v),b&&(lt*=-1,gs+=y),H.roundPixels&&(m=Math.floor(m),E=Math.floor(E)),st.applyITRS(m,E,x,T,A),J.copyFrom(H.matrix),z?(J.multiplyWithOffset(z,-H.scrollX*M,-H.scrollY*w),st.e=m,st.f=E):(st.e-=H.scrollX*M,st.f-=H.scrollY*w),J.multiply(st,q);var Wi=q.setQuad(vt,gs,vt+Vt,gs+lt,H.renderRoundPixels);X==null&&(X=this.setTexture2D(p)),u&&!et&&this.manager.preBatch(u),this.batchQuad(u,Wi[0],Wi[1],Wi[2],Wi[3],Wi[4],Wi[5],Wi[6],Wi[7],ht,Pt,Bt,Ct,G,L,C,P,k,p,X),u&&!et&&this.manager.postBatch(u)},batchTextureFrame:function(u,p,d,g,m,E,v){this.manager.set(this);var y=this._tempMatrix1.copyFrom(E),T=this._tempMatrix2;v?y.multiply(v,T):T=y;var A=T.setQuad(p,d,p+u.width,d+u.height),x=this.setTexture2D(u.source.glTexture);g=h.getTintAppendFloatAlpha(g,m),this.batchQuad(null,A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],u.u0,u.v0,u.u1,u.v1,g,g,g,g,0,u.glTexture,x)},batchFillRect:function(u,p,d,g,m,E){this.renderer.pipelines.set(this);var v=this.calcMatrix;E&&E.multiply(m,v);var y=v.setQuad(u,p,u+d,p+g),T=this.fillTint;this.batchQuad(null,y[0],y[1],y[2],y[3],y[4],y[5],y[6],y[7],0,0,1,1,T.TL,T.TR,T.BL,T.BR,2)},batchFillTriangle:function(u,p,d,g,m,E,v,y){this.renderer.pipelines.set(this);var T=this.calcMatrix;y&&y.multiply(v,T);var A=T.getX(u,p),x=T.getY(u,p),_=T.getX(d,g),b=T.getY(d,g),M=T.getX(m,E),w=T.getY(m,E),R=this.fillTint;this.batchTri(null,A,x,_,b,M,w,0,0,1,1,R.TL,R.TR,R.BL,2)},batchStrokeTriangle:function(u,p,d,g,m,E,v,y,T){var A=this.tempTriangle;A[0].x=u,A[0].y=p,A[0].width=v,A[1].x=d,A[1].y=g,A[1].width=v,A[2].x=m,A[2].y=E,A[2].width=v,A[3].x=u,A[3].y=p,A[3].width=v,this.batchStrokePath(A,v,!1,y,T)},batchFillPath:function(u,p,d){this.renderer.pipelines.set(this);var g=this.calcMatrix;d&&d.multiply(p,g);for(var m=u.length,E=this.polygonCache,v,y,T=this.fillTint.TL,A=this.fillTint.TR,x=this.fillTint.BL,_=0;_<m;++_)y=u[_],E.push(y.x,y.y);v=s(E),m=v.length;for(var b=0;b<m;b+=3){var M=v[b+0]*2,w=v[b+1]*2,R=v[b+2]*2,I=E[M+0],O=E[M+1],D=E[w+0],N=E[w+1],F=E[R+0],G=E[R+1],L=g.getX(I,O),C=g.getY(I,O),P=g.getX(D,N),k=g.getY(D,N),B=g.getX(F,G),Y=g.getY(F,G);this.batchTri(null,L,C,P,k,B,Y,0,0,1,1,T,A,x,2)}E.length=0},batchStrokePath:function(u,p,d,g,m){this.renderer.pipelines.set(this),this.prevQuad[4]=0,this.firstQuad[4]=0;for(var E=u.length-1,v=0;v<E;v++){var y=u[v],T=u[v+1];this.batchLine(y.x,y.y,T.x,T.y,y.width/2,T.width/2,p,v,!d&&v===E-1,g,m)}},batchLine:function(u,p,d,g,m,E,v,y,T,A,x){this.renderer.pipelines.set(this);var _=this.calcMatrix;x&&x.multiply(A,_);var b=d-u,M=g-p,w=Math.sqrt(b*b+M*M);if(w!==0){var R=m*(g-p)/w,I=m*(u-d)/w,O=E*(g-p)/w,D=E*(u-d)/w,N=d-O,F=g-D,G=u-R,L=p-I,C=d+O,P=g+D,k=u+R,B=p+I,Y=_.getX(N,F),H=_.getY(N,F),z=_.getX(G,L),K=_.getY(G,L),X=_.getX(C,P),et=_.getY(C,P),J=_.getX(k,B),st=_.getY(k,B),q=this.strokeTint,ht=q.TL,Pt=q.TR,Bt=q.BL,Ct=q.BR;if(this.batchQuad(null,J,st,z,K,Y,H,X,et,0,0,1,1,ht,Pt,Bt,Ct,2),!(v<=2)){var Vt=this.prevQuad,lt=this.firstQuad;y>0&&Vt[4]?this.batchQuad(null,J,st,z,K,Vt[0],Vt[1],Vt[2],Vt[3],0,0,1,1,ht,Pt,Bt,Ct,2):(lt[0]=J,lt[1]=st,lt[2]=z,lt[3]=K,lt[4]=1),T&&lt[4]?this.batchQuad(null,Y,H,X,et,lt[0],lt[1],lt[2],lt[3],0,0,1,1,ht,Pt,Bt,Ct,2):(Vt[0]=Y,Vt[1]=H,Vt[2]=X,Vt[3]=et,Vt[4]=1)}}},destroy:function(){return this._tempMatrix1.destroy(),this._tempMatrix2.destroy(),this._tempMatrix3.destroy(),this._tempMatrix1=null,this._tempMatrix1=null,this._tempMatrix1=null,c.prototype.destroy.call(this),this}});t.exports=f}),ic=S((e,t)=>{"use strict";t.exports=["#define SHADER_NAME PHASER_SINGLE_FS","#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","    vec4 color = texture * texel;","    if (outTintEffect == 1.0)","    {","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        color = texel;","    }","    gl_FragColor = color;","}"].join(`
`)}),sc=S((e,t)=>{"use strict";t.exports=["#define SHADER_NAME PHASER_SINGLE_VS","precision mediump float;","uniform mat4 uProjectionMatrix;","uniform vec2 uResolution;","attribute vec2 inPosition;","attribute vec2 inTexCoord;","attribute float inTexId;","attribute float inTintEffect;","attribute vec4 inTint;","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","    outTexCoord = inTexCoord;","    outTint = inTint;","    outTintEffect = inTintEffect;","}"].join(`
`)}),nc=S((e,t)=>{"use strict";var i=V(),s=pt(),n=lr(),r=ic(),o=sc(),a=cn(),h=dn(),l=new i({Extends:n,initialize:function(c){c.fragShader=s(c,"fragShader",r),c.vertShader=s(c,"vertShader",o),c.attributes=s(c,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2},{name:"inTexId"},{name:"inTintEffect"},{name:"inTint",size:4,type:a.UNSIGNED_BYTE,normalized:!0}]),c.forceZero=!0,c.resizeUniform="uResolution",n.call(this,c)},boot:function(){h.prototype.boot.call(this);var c=this.renderer;this.set1i("uMainSampler",0),this.set2f("uResolution",c.width,c.height)}});t.exports=l}),rc=S((e,t)=>{"use strict";var i=V(),s=pt(),n=lr(),r=ic(),o=sc(),a=dn(),h=new i({Extends:n,initialize:function(l){l.fragShader=s(l,"fragShader",r),l.vertShader=s(l,"vertShader",o),l.forceZero=!0,n.call(this,l)},boot:function(){a.prototype.boot.call(this);var l=this.renderer;this.set1i("uMainSampler",0),this.set2f("uResolution",l.width,l.height)}});t.exports=h}),ac=S((e,t)=>{"use strict";var i=V(),s=or(),n=$n(),r=Yn(),o=pt(),a=Ox(),h=ec(),l=nc(),c=lr(),f=rc(),u=Fn(),p=Pi(),d=new i({initialize:function(g){this.game=g.game,this.renderer=g,this.classes=new n([[s.MULTI_PIPELINE,c],[s.BITMAPMASK_PIPELINE,h],[s.SINGLE_PIPELINE,f],[s.MOBILE_PIPELINE,l]]),this.postPipelineClasses=new n,this.pipelines=new n,this.postPipelineInstances=[],this.default=null,this.current=null,this.previous=null,this.MULTI_PIPELINE=null,this.BITMAPMASK_PIPELINE=null,this.UTILITY_PIPELINE=null,this.MOBILE_PIPELINE=null,this.FX_PIPELINE=null,this.fullFrame1,this.fullFrame2,this.halfFrame1,this.halfFrame2,this.renderTargets=[],this.maxDimension=0,this.frameInc=32,this.targetIndex=0},boot:function(g,m,E){this.frameInc=Math.floor(o(g,"frameInc",32));var v,y,T=this,A=this.game;if(this.classes.each(function(_,b){v=T.add(_,new b({game:A})),_===s.UTILITY_PIPELINE&&(T.UTILITY_PIPELINE=v,T.fullFrame1=v.fullFrame1,T.fullFrame2=v.fullFrame2,T.halfFrame1=v.halfFrame1,T.halfFrame2=v.halfFrame2)}),this.MULTI_PIPELINE=this.get(s.MULTI_PIPELINE),this.BITMAPMASK_PIPELINE=this.get(s.BITMAPMASK_PIPELINE),this.MOBILE_PIPELINE=this.get(s.MOBILE_PIPELINE),g)for(y in g){var x=g[y];v=new x(A),v.name=y,v.isPostFX?this.postPipelineClasses.set(y,x):this.has(y)||(this.classes.set(y,x),this.add(y,v))}this.default=this.get(m),E&&!r.os.desktop&&(this.default=this.MOBILE_PIPELINE)},setDefaultPipeline:function(g){var m=this.get(g);return m&&(this.default=m),m},add:function(g,m){if(!m.isPostFX){var E=this.pipelines,v=this.renderer;return E.has(g)||(m.name=g,m.manager=this,E.set(g,m)),m.hasBooted||m.boot(),v.width!==0&&v.height!==0&&!m.isPreFX&&m.resize(v.width,v.height),m}},addPostPipeline:function(g,m){this.postPipelineClasses.has(g)||this.postPipelineClasses.set(g,m)},flush:function(){this.current&&this.current.flush()},has:function(g){var m=this.pipelines;return typeof g=="string"?m.has(g):!!m.contains(g)},get:function(g){var m=this.pipelines;if(typeof g=="string")return m.get(g);if(m.contains(g))return g},getPostPipeline:function(g,m,E){var v=this.postPipelineClasses,y,T="",A=typeof g;if(A==="string"||A==="number"?(y=v.get(g),T=g):A==="function"?(v.contains(g)&&(y=g),T=g.name):A==="object"&&(y=v.get(g.name),T=g.name),y){var x=new y(this.game,E);return x.name=T,m&&(x.gameObject=m),this.postPipelineInstances.push(x),x}},removePostPipeline:function(g){p(this.postPipelineInstances,g)},remove:function(g,m,E){m===void 0&&(m=!0),E===void 0&&(E=!0),this.pipelines.delete(g),m&&this.classes.delete(g),E&&this.postPipelineClasses.delete(g)},set:function(g,m,E){if(!g.isPostFX)return this.isCurrent(g,E)||(this.flush(),this.current&&this.current.unbind(),this.current=g,g.bind(E)),g.updateProjectionMatrix(),g.onBind(m),g},preBatch:function(g){if(g.hasPostPipeline){this.flush();for(var m=g.postPipelines,E=m.length-1;E>=0;E--){var v=m[E];v.active&&v.preBatch(g)}}},postBatch:function(g){if(g.hasPostPipeline){this.flush();for(var m=g.postPipelines,E=0;E<m.length;E++){var v=m[E];v.active&&v.postBatch(g)}}},preBatchCamera:function(g){if(g.hasPostPipeline){this.flush();for(var m=g.postPipelines,E=m.length-1;E>=0;E--){var v=m[E];v.active&&v.preBatch(g)}}},postBatchCamera:function(g){if(g.hasPostPipeline){this.flush();for(var m=g.postPipelines,E=0;E<m.length;E++){var v=m[E];v.active&&v.postBatch(g)}}},isCurrent:function(g,m){var E=this.renderer,v=this.current;return v&&!m&&(m=v.currentShader),!(v!==g||m.program!==E.currentProgram)},copyFrame:function(g,m,E,v,y){return this.setUtility(this.UTILITY_PIPELINE.copyShader).copyFrame(g,m,E,v,y),this},copyToGame:function(g){return this.setUtility(this.UTILITY_PIPELINE.copyShader).copyToGame(g),this},drawFrame:function(g,m,E,v){return this.setUtility(this.UTILITY_PIPELINE.colorMatrixShader).drawFrame(g,m,E,v),this},blendFrames:function(g,m,E,v,y){return this.setUtility(this.UTILITY_PIPELINE.linearShader).blendFrames(g,m,E,v,y),this},blendFramesAdditive:function(g,m,E,v,y){return this.setUtility(this.UTILITY_PIPELINE.addShader).blendFramesAdditive(g,m,E,v,y),this},clearFrame:function(g,m){return this.UTILITY_PIPELINE.clearFrame(g,m),this},blitFrame:function(g,m,E,v,y,T){return this.setUtility(this.UTILITY_PIPELINE.copyShader).blitFrame(g,m,E,v,y,T),this},copyFrameRect:function(g,m,E,v,y,T,A,x){return this.UTILITY_PIPELINE.copyFrameRect(g,m,E,v,y,T,A,x),this},forceZero:function(){return this.current&&this.current.forceZero},setMulti:function(){return this.set(this.MULTI_PIPELINE)},setUtility:function(g){return this.UTILITY_PIPELINE.bind(g)},setFX:function(){return this.set(this.FX_PIPELINE)},restoreContext:function(){this.rebind(),this.pipelines.each(function(g,m){m.restoreContext()}),u(this.postPipelineInstances,function(g){g.restoreContext()})},rebind:function(g){g===void 0&&this.previous&&(g=this.previous);var m=this.renderer,E=m.gl;E.disable(E.DEPTH_TEST),E.disable(E.CULL_FACE),m.hasActiveStencilMask()?E.clear(E.DEPTH_BUFFER_BIT):(E.disable(E.STENCIL_TEST),E.clear(E.DEPTH_BUFFER_BIT|E.STENCIL_BUFFER_BIT)),E.viewport(0,0,m.width,m.height),m.currentProgram=null,m.setBlendMode(0,!0);var v=m.vaoExtension;v&&v.bindVertexArrayOES(null);var y=this.pipelines.entries;for(var T in y)y[T].glReset=!0;g&&(this.current=g,g.rebind())},clear:function(){var g=this.renderer;this.flush(),this.current?(this.current.unbind(),this.previous=this.current,this.current=null):this.previous=null,g.currentProgram=null,g.setBlendMode(0,!0);var m=g.vaoExtension;m&&m.bindVertexArrayOES(null)},getRenderTarget:function(g){var m=this.renderTargets,E=3;if(g>this.maxDimension)return this.targetIndex=m.length-E,m[this.targetIndex];var v=(a(g,this.frameInc,0,!0)-1)*E;return this.targetIndex=v,m[v]},getSwapRenderTarget:function(){return this.renderTargets[this.targetIndex+1]},getAltSwapRenderTarget:function(){return this.renderTargets[this.targetIndex+2]},destroy:function(){this.flush(),this.classes.clear(),this.postPipelineClasses.clear(),this.pipelines.clear(),this.renderer=null,this.game=null,this.classes=null,this.postPipelineClasses=null,this.pipelines=null,this.default=null,this.current=null,this.previous=null}});t.exports=d}),oc=S((e,t)=>{"use strict";var i=or(),s=Re(),n={BitmapMaskPipeline:ec(),Events:tc(),MobilePipeline:nc(),MultiPipeline:lr(),SinglePipeline:rc()};n=s(!1,n,i),t.exports=n}),ur=S((e,t)=>{"use strict";var i=function(s,n){return s>0&&(s&s-1)===0&&n>0&&(n&n-1)===0};t.exports=i}),Kx=S((e,t)=>{"use strict";t.exports="addtexture"}),jx=S((e,t)=>{"use strict";t.exports="addtexture-"}),Zx=S((e,t)=>{"use strict";t.exports="onerror"}),qx=S((e,t)=>{"use strict";t.exports="onload"}),Qx=S((e,t)=>{"use strict";t.exports="ready"}),Jx=S((e,t)=>{"use strict";t.exports="removetexture"}),$x=S((e,t)=>{"use strict";t.exports="removetexture-"}),pn=S((e,t)=>{"use strict";t.exports={ADD:Kx(),ADD_KEY:jx(),ERROR:Zx(),LOAD:qx(),READY:Qx(),REMOVE:Jx(),REMOVE_KEY:$x()}}),tw=S((e,t)=>{"use strict";var i=Ne(),s=Ze(),n=pt(),r=function(o,a){var h=o,l=n(a,"callback"),c=n(a,"type","image/png"),f=n(a,"encoder",.92),u=Math.abs(Math.round(n(a,"x",0))),p=Math.abs(Math.round(n(a,"y",0))),d=n(a,"getPixel",!1),g=n(a,"isFramebuffer",!1),m=g?n(a,"bufferWidth",1):h.drawingBufferWidth,E=g?n(a,"bufferHeight",1):h.drawingBufferHeight;if(d){var v=new Uint8Array(4),y=g?p:E-p;h.readPixels(u,y,1,1,h.RGBA,h.UNSIGNED_BYTE,v),l.call(null,new s(v[0],v[1],v[2],v[3]))}else{var T=Math.floor(n(a,"width",m)),A=Math.floor(n(a,"height",E)),x=T*A*4,_=new Uint8Array(x);h.readPixels(u,E-p-A,T,A,h.RGBA,h.UNSIGNED_BYTE,_);for(var b=i.createWebGL(this,T,A),M=b.getContext("2d",{willReadFrequently:!0}),w=M.getImageData(0,0,T,A),R=w.data,I=0;I<A;I++)for(var O=0;O<T;O++){var D=((A-I-1)*T+O)*4,N=g?x-(I*T+(T-O))*4:(I*T+O)*4;R[N+0]=_[D+0],R[N+1]=_[D+1],R[N+2]=_[D+2],R[N+3]=_[D+3]}M.putImageData(w,0,0);var F=new Image;F.onerror=function(){l.call(null),i.remove(b)},F.onload=function(){l.call(null,F),i.remove(b)},F.src=b.toDataURL(c,f)}};t.exports=r}),hc=S((e,t)=>{"use strict";var i=V(),s=new i({initialize:function(n,r,o,a){this.webGLBuffer=null,this.gl=n,this.initialDataOrSize=r,this.bufferType=o,this.bufferUsage=a,this.createResource()},createResource:function(){if(this.initialDataOrSize!==null){var n=this.gl;if(!n.isContextLost()){var r=this.bufferType,o=n.createBuffer();this.webGLBuffer=o,n.bindBuffer(r,this.webGLBuffer),n.bufferData(r,this.initialDataOrSize,this.bufferUsage),n.bindBuffer(r,null)}}},destroy:function(){var n=this.gl;n.isContextLost()||n.deleteBuffer(this.webGLBuffer),this.webGLBuffer=null,this.initialDataOrSize=null,this.gl=null}});t.exports=s}),lc=S((e,t)=>{"use strict";var i=V(),s=new i({initialize:function(n,r,o){this.webGLProgram=null,this.gl=n,this.vertexSource=r,this.fragmentSource=o,this.createResource()},createResource:function(){var n=this.gl;if(!n.isContextLost()){var r=n.createProgram(),o=n.createShader(n.VERTEX_SHADER),a=n.createShader(n.FRAGMENT_SHADER);n.shaderSource(o,this.vertexSource),n.shaderSource(a,this.fragmentSource),n.compileShader(o),n.compileShader(a);var h=`Shader failed:
`;if(!n.getShaderParameter(o,n.COMPILE_STATUS))throw new Error("Vertex "+h+n.getShaderInfoLog(o));if(!n.getShaderParameter(a,n.COMPILE_STATUS))throw new Error("Fragment "+h+n.getShaderInfoLog(a));if(n.attachShader(r,o),n.attachShader(r,a),n.linkProgram(r),!n.getProgramParameter(r,n.LINK_STATUS))throw new Error("Link "+h+n.getProgramInfoLog(r));n.useProgram(r),this.webGLProgram=r}},destroy:function(){this.webGLProgram&&(this.gl.isContextLost()||this.gl.deleteProgram(this.webGLProgram),this.webGLProgram=null,this.gl=null)}});t.exports=s}),ja=S((e,t)=>{"use strict";var i=V(),s=ur(),n=new i({initialize:function(r,o,a,h,l,c,f,u,p,d,g,m,E){this.webGLTexture=null,this.isRenderTexture=!1,this.gl=r,this.mipLevel=o,this.minFilter=a,this.magFilter=h,this.wrapT=l,this.wrapS=c,this.format=f,this.pixels=u,this.width=p,this.height=d,this.pma=g??!0,this.forceSize=!!m,this.flipY=!!E,this.__SPECTOR_Metadata={},this.createResource()},createResource:function(){var r=this.gl;if(!r.isContextLost()){if(this.pixels instanceof n){this.webGLTexture=this.pixels.webGLTexture;return}var o=r.createTexture();o.__SPECTOR_Metadata=this.__SPECTOR_Metadata,this.webGLTexture=o,this._processTexture()}},update:function(r,o,a,h,l,c,f,u,p){if(!(o===0||a===0)){this.pixels=r,this.width=o,this.height=a,this.flipY=h,this.wrapS=l,this.wrapT=c,this.minFilter=f,this.magFilter=u,this.format=p;var d=this.gl;d.isContextLost()||this._processTexture()}},_processTexture:function(){var r=this.gl;r.activeTexture(r.TEXTURE0);var o=r.getParameter(r.TEXTURE_BINDING_2D);r.bindTexture(r.TEXTURE_2D,this.webGLTexture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,this.minFilter),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,this.magFilter),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,this.wrapS),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,this.wrapT),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.pma),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,this.flipY);var a=this.pixels,h=this.mipLevel,l=this.width,c=this.height,f=this.format,u=!1;if(a==null)r.texImage2D(r.TEXTURE_2D,h,f,l,c,0,f,r.UNSIGNED_BYTE,null),u=s(l,c);else if(a.compressed){l=a.width,c=a.height,u=a.generateMipmap;for(var p=0;p<a.mipmaps.length;p++)r.compressedTexImage2D(r.TEXTURE_2D,p,a.internalFormat,a.mipmaps[p].width,a.mipmaps[p].height,0,a.mipmaps[p].data)}else a instanceof Uint8Array?(r.texImage2D(r.TEXTURE_2D,h,f,l,c,0,f,r.UNSIGNED_BYTE,a),u=s(l,c)):(this.forceSize||(l=a.width,c=a.height),r.texImage2D(r.TEXTURE_2D,h,f,f,r.UNSIGNED_BYTE,a),u=s(l,c));u&&r.generateMipmap(r.TEXTURE_2D),o?r.bindTexture(r.TEXTURE_2D,o):r.bindTexture(r.TEXTURE_2D,null)},spectorMetadata:{get:function(){return this.__SPECTOR_Metadata},set:function(r){this.__SPECTOR_Metadata=r,this.gl.isContextLost()||(this.webGLTexture.__SPECTOR_Metadata=r)}},destroy:function(){this.webGLTexture!==null&&(this.gl.isContextLost()||this.pixels instanceof n||this.gl.deleteTexture(this.webGLTexture),this.pixels=null,this.webGLTexture=null,this.gl=null)}});t.exports=n}),uc=S((e,t)=>{"use strict";var i=V(),s={36054:"Incomplete Attachment",36055:"Missing Attachment",36057:"Incomplete Dimensions",36061:"Framebuffer Unsupported"},n=new i({initialize:function(r,o,a,h,l){this.webGLFramebuffer=null,this.gl=r,this.width=o,this.height=a,this.renderTexture=h,this.addDepthStencilBuffer=!!l,this.createResource()},createResource:function(){var r=this.gl;if(!r.isContextLost()){var o=this.renderTexture,a=0,h=r.createFramebuffer();if(this.webGLFramebuffer=h,r.bindFramebuffer(r.FRAMEBUFFER,h),o.isRenderTexture=!0,o.isAlphaPremultiplied=!1,r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,o.webGLTexture,0),a=r.checkFramebufferStatus(r.FRAMEBUFFER),a!==r.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer status: "+(s[a]||a));if(this.addDepthStencilBuffer){var l=r.createRenderbuffer();r.bindRenderbuffer(r.RENDERBUFFER,l),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,this.width,this.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,l)}r.bindFramebuffer(r.FRAMEBUFFER,null)}},destroy:function(){if(this.webGLFramebuffer!==null){var r=this.gl;if(!r.isContextLost()){r.bindFramebuffer(r.FRAMEBUFFER,this.webGLFramebuffer);var o=r.getFramebufferAttachmentParameter(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);o!==null&&(r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,null,0),r.deleteTexture(o));var a=r.getFramebufferAttachmentParameter(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);a!==null&&r.deleteRenderbuffer(a),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteFramebuffer(this.webGLFramebuffer)}this.renderTexture=null,this.webGLFramebuffer=null,this.gl=null}}});t.exports=n}),cc=S((e,t)=>{"use strict";var i=V(),s=new i({initialize:function(n,r,o){this.webGLAttribLocation=-1,this.gl=n,this.program=r,this.name=o,this.createResource()},createResource:function(){if(this.program.webGLProgram===null){this.webGLAttribLocation=-1;return}var n=this.gl;n.isContextLost()||(this.webGLAttribLocation=n.getAttribLocation(this.program.webGLProgram,this.name))},destroy:function(){this.gl=null,this.program=null,this.name=null,this.webGLAttribLocation=-1}});t.exports=s}),dc=S((e,t)=>{"use strict";var i=V(),s=new i({initialize:function(n,r,o){this.webGLUniformLocation=null,this.gl=n,this.program=r,this.name=o,this.createResource()},createResource:function(){if(this.program.webGLProgram===null){this.webGLUniformLocation=null;return}var n=this.gl;n.isContextLost()||(this.webGLUniformLocation=n.getUniformLocation(this.program.webGLProgram,this.name))},destroy:function(){this.gl=null,this.program=null,this.name=null,this.webGLUniformLocation=null}});t.exports=s}),pc=S((e,t)=>{"use strict";var i=Fn(),s=Pi(),n=je(),r=V(),o=Ke(),a=Wt(),h=un(),l=ur(),c=Ra(),f=Lt(),u=ac(),p=hr(),d=Sa(),g=pn(),m=_e(),E=tw(),v=hc(),y=lc(),T=ja(),A=uc(),x=cc(),_=dc(),b=!1,M=new r({Extends:a,initialize:function(w){a.call(this);var R=w.config,I={alpha:R.transparent,desynchronized:R.desynchronized,depth:!0,antialias:R.antialiasGL,premultipliedAlpha:R.premultipliedAlpha,stencil:!0,failIfMajorPerformanceCaveat:R.failIfMajorPerformanceCaveat,powerPreference:R.powerPreference,preserveDrawingBuffer:R.preserveDrawingBuffer,willReadFrequently:!1};this.config={clearBeforeRender:R.clearBeforeRender,antialias:R.antialias,backgroundColor:R.backgroundColor,contextCreation:I,roundPixels:R.roundPixels,maxTextures:R.maxTextures,maxTextureSize:R.maxTextureSize,batchSize:R.batchSize,maxLights:R.maxLights,mipmapFilter:R.mipmapFilter},this.game=w,this.type=o.WEBGL,this.pipelines=null,this.width=0,this.height=0,this.canvas=w.canvas,this.blendModes=[],this.contextLost=!1,this.snapshotState={x:0,y:0,width:1,height:1,getPixel:!1,callback:null,type:"image/png",encoder:.92,isFramebuffer:!1,bufferWidth:0,bufferHeight:0},this.maxTextures=0,this.textureIndexes,this.glBufferWrappers=[],this.glProgramWrappers=[],this.glTextureWrappers=[],this.glFramebufferWrappers=[],this.glAttribLocationWrappers=[],this.glUniformLocationWrappers=[],this.currentFramebuffer=null,this.fboStack=[],this.currentProgram=null,this.currentBlendMode=1/0,this.currentScissorEnabled=!1,this.currentScissor=null,this.scissorStack=[],this.contextLostHandler=f,this.contextRestoredHandler=f,this.previousContextLostHandler=f,this.previousContextRestoredHandler=f,this.gl=null,this.supportedExtensions=null,this.instancedArraysExtension=null,this.vaoExtension=null,this.extensions={},this.glFormats,this.compression,this.drawingBufferHeight=0,this.blankTexture=null,this.normalTexture=null,this.whiteTexture=null,this.maskCount=0,this.maskStack=[],this.currentMask={mask:null,camera:null},this.currentCameraMask={mask:null,camera:null},this.glFuncMap=null,this.currentType="",this.newType=!1,this.nextTypeMatch=!1,this.finalType=!1,this.mipmapFilter=null,this.defaultScissor=[0,0,0,0],this.isBooted=!1,this.renderTarget=null,this.projectionMatrix,this.projectionWidth=0,this.projectionHeight=0,this.maskSource=null,this.maskTarget=null,this.spector=null,this._debugCapture=!1,this.init(this.config)},init:function(w){var R,I=this.game,O=this.canvas,D=w.backgroundColor;if(I.config.context?R=I.config.context:R=O.getContext("webgl",w.contextCreation)||O.getContext("experimental-webgl",w.contextCreation),!R||R.isContextLost())throw this.contextLost=!0,new Error("WebGL unsupported");this.gl=R,this.setExtensions(),this.setContextHandlers(),I.context=R;for(var N=0;N<=27;N++)this.blendModes.push({func:[R.ONE,R.ONE_MINUS_SRC_ALPHA],equation:R.FUNC_ADD});this.blendModes[1].func=[R.ONE,R.DST_ALPHA],this.blendModes[2].func=[R.DST_COLOR,R.ONE_MINUS_SRC_ALPHA],this.blendModes[3].func=[R.ONE,R.ONE_MINUS_SRC_COLOR],this.blendModes[17]={func:[R.ZERO,R.ONE_MINUS_SRC_ALPHA],equation:R.FUNC_REVERSE_SUBTRACT},this.glFormats=[R.BYTE,R.SHORT,R.UNSIGNED_BYTE,R.UNSIGNED_SHORT,R.FLOAT],this.glFuncMap={mat2:{func:R.uniformMatrix2fv,length:1,matrix:!0},mat3:{func:R.uniformMatrix3fv,length:1,matrix:!0},mat4:{func:R.uniformMatrix4fv,length:1,matrix:!0},"1f":{func:R.uniform1f,length:1},"1fv":{func:R.uniform1fv,length:1},"1i":{func:R.uniform1i,length:1},"1iv":{func:R.uniform1iv,length:1},"2f":{func:R.uniform2f,length:2},"2fv":{func:R.uniform2fv,length:1},"2i":{func:R.uniform2i,length:2},"2iv":{func:R.uniform2iv,length:1},"3f":{func:R.uniform3f,length:3},"3fv":{func:R.uniform3fv,length:1},"3i":{func:R.uniform3i,length:3},"3iv":{func:R.uniform3iv,length:1},"4f":{func:R.uniform4f,length:4},"4fv":{func:R.uniform4fv,length:1},"4i":{func:R.uniform4i,length:4},"4iv":{func:R.uniform4iv,length:1}},(!w.maxTextures||w.maxTextures===-1)&&(w.maxTextures=R.getParameter(R.MAX_TEXTURE_IMAGE_UNITS)),w.maxTextureSize||(w.maxTextureSize=R.getParameter(R.MAX_TEXTURE_SIZE)),this.compression=this.getCompressedTextures(),R.disable(R.DEPTH_TEST),R.disable(R.CULL_FACE),R.enable(R.BLEND),R.clearColor(D.redGL,D.greenGL,D.blueGL,D.alphaGL),R.clear(R.COLOR_BUFFER_BIT);var F=["NEAREST","LINEAR","NEAREST_MIPMAP_NEAREST","LINEAR_MIPMAP_NEAREST","NEAREST_MIPMAP_LINEAR","LINEAR_MIPMAP_LINEAR"];return F.indexOf(w.mipmapFilter)!==-1&&(this.mipmapFilter=R[w.mipmapFilter]),this.maxTextures=m.checkShaderMax(R,w.maxTextures),this.textureIndexes=[],this.createTemporaryTextures(),this.pipelines=new u(this),this.setBlendMode(o.BlendModes.NORMAL),this.projectionMatrix=new c().identity(),I.textures.once(g.READY,this.boot,this),this},boot:function(){var w=this.game,R=this.pipelines,I=w.scale.baseSize,O=I.width,D=I.height;this.width=O,this.height=D,this.isBooted=!0,this.renderTarget=new p(this,O,D,1,0,!0,!0),this.maskTarget=new p(this,O,D,1,0,!0,!0),this.maskSource=new p(this,O,D,1,0,!0,!0);var N=w.config;R.boot(N.pipeline,N.defaultPipeline,N.autoMobilePipeline),this.blankTexture=w.textures.getFrame("__DEFAULT").glTexture,this.normalTexture=w.textures.getFrame("__NORMAL").glTexture,this.whiteTexture=w.textures.getFrame("__WHITE").glTexture;var F=this.gl;F.bindFramebuffer(F.FRAMEBUFFER,null),F.enable(F.SCISSOR_TEST),w.scale.on(d.RESIZE,this.onResize,this),this.resize(O,D)},setExtensions:function(){var w=this.gl,R=w.getSupportedExtensions();this.supportedExtensions=R;var I="ANGLE_instanced_arrays";this.instancedArraysExtension=R.indexOf(I)>-1?w.getExtension(I):null;var O="OES_vertex_array_object";this.vaoExtension=R.indexOf(O)>-1?w.getExtension(O):null},setContextHandlers:function(w,R){this.previousContextLostHandler&&this.canvas.removeEventListener("webglcontextlost",this.previousContextLostHandler,!1),this.previousContextRestoredHandler&&this.canvas.removeEventListener("webglcontextlost",this.previousContextRestoredHandler,!1),typeof w=="function"?this.contextLostHandler=w.bind(this):this.contextLostHandler=this.dispatchContextLost.bind(this),typeof R=="function"?this.contextRestoredHandler=R.bind(this):this.contextRestoredHandler=this.dispatchContextRestored.bind(this),this.canvas.addEventListener("webglcontextlost",this.contextLostHandler,!1),this.canvas.addEventListener("webglcontextrestored",this.contextRestoredHandler,!1),this.previousContextLostHandler=this.contextLostHandler,this.previousContextRestoredHandler=this.contextRestoredHandler},dispatchContextLost:function(w){this.contextLost=!0,this.emit(h.LOSE_WEBGL,this),w.preventDefault()},dispatchContextRestored:function(w){var R=this.gl;if(!R.isContextLost()){this.currentProgram=null,this.currentFramebuffer=null,this.setBlendMode(o.BlendModes.NORMAL),R.disable(R.BLEND),R.disable(R.DEPTH_TEST),R.enable(R.CULL_FACE),this.compression=this.getCompressedTextures();var I=function(O){O.createResource()};i(this.glTextureWrappers,I),i(this.glBufferWrappers,I),i(this.glFramebufferWrappers,I),i(this.glProgramWrappers,I),i(this.glAttribLocationWrappers,I),i(this.glUniformLocationWrappers,I),this.createTemporaryTextures(),this.pipelines.restoreContext(),this.resize(this.game.scale.baseSize.width,this.game.scale.baseSize.height),this.setExtensions(),this.contextLost=!1,this.emit(h.RESTORE_WEBGL,this),w.preventDefault()}},createTemporaryTextures:function(){for(var w=this.gl,R=0;R<this.maxTextures;R++){var I=w.createTexture();w.activeTexture(w.TEXTURE0+R),w.bindTexture(w.TEXTURE_2D,I),w.texImage2D(w.TEXTURE_2D,0,w.RGBA,1,1,0,w.RGBA,w.UNSIGNED_BYTE,new Uint8Array([0,0,255,255])),this.textureIndexes.push(R)}},captureFrame:function(w,R){w===void 0&&(w=!1),R===void 0&&(R=!1),b&&this.spector&&!this._debugCapture&&(this.spector.captureCanvas(this.canvas,0,w,R),this._debugCapture=!0)},captureNextFrame:function(){b&&this.spector&&!this._debugCapture&&(this._debugCapture=!0,this.spector.captureNextFrame(this.canvas))},getFps:function(){if(b&&this.spector)return this.spector.getFps()},log:function(){if(b&&this.spector){var w=Array.prototype.slice.call(arguments).join(" ");return this.spector.log(w)}},startCapture:function(w,R,I){w===void 0&&(w=0),R===void 0&&(R=!1),I===void 0&&(I=!1),b&&this.spector&&!this._debugCapture&&(this.spector.startCapture(this.canvas,w,R,I),this._debugCapture=!0)},stopCapture:function(){if(b&&this.spector&&this._debugCapture)return this.spector.stopCapture()},onCapture:function(w){if(b){var R=this.spector.getResultUI();R.display(w),this._debugCapture=!1}},onResize:function(w,R){(R.width!==this.width||R.height!==this.height)&&this.resize(R.width,R.height)},beginCapture:function(w,R){w===void 0&&(w=this.width),R===void 0&&(R=this.height),this.renderTarget.bind(!0,w,R),this.setProjectionMatrix(w,R)},endCapture:function(){return this.renderTarget.unbind(!0),this.resetProjectionMatrix(),this.renderTarget},resize:function(w,R){var I=this.gl;return this.width=w,this.height=R,this.setProjectionMatrix(w,R),I.viewport(0,0,w,R),this.drawingBufferHeight=I.drawingBufferHeight,I.scissor(0,I.drawingBufferHeight-R,w,R),this.defaultScissor[2]=w,this.defaultScissor[3]=R,this.emit(h.RESIZE,w,R),this},getCompressedTextures:function(){var w="WEBGL_compressed_texture_",R="WEBKIT_"+w,I="EXT_texture_compression_",O=function(N,F){var G=N.getExtension(w+F)||N.getExtension(R+F)||N.getExtension(I+F);if(G){var L={};for(var C in G)L[G[C]]=C;return L}},D=this.gl;return{ETC:O(D,"etc"),ETC1:O(D,"etc1"),ATC:O(D,"atc"),ASTC:O(D,"astc"),BPTC:O(D,"bptc"),RGTC:O(D,"rgtc"),PVRTC:O(D,"pvrtc"),S3TC:O(D,"s3tc"),S3TCSRGB:O(D,"s3tc_srgb"),IMG:!0}},getCompressedTextureName:function(w,R){var I=this.compression[w.toUpperCase()];if(R in I)return I[R]},supportsCompressedTexture:function(w,R){var I=this.compression[w.toUpperCase()];return I?R?R in I:!0:!1},getAspectRatio:function(){return this.width/this.height},setProjectionMatrix:function(w,R){return(w!==this.projectionWidth||R!==this.projectionHeight)&&(this.projectionWidth=w,this.projectionHeight=R,this.projectionMatrix.ortho(0,w,R,0,-1e3,1e3)),this},resetProjectionMatrix:function(){return this.setProjectionMatrix(this.width,this.height)},hasExtension:function(w){return this.supportedExtensions?this.supportedExtensions.indexOf(w):!1},getExtension:function(w){return this.hasExtension(w)?(w in this.extensions||(this.extensions[w]=this.gl.getExtension(w)),this.extensions[w]):null},flush:function(){this.pipelines.flush()},pushScissor:function(w,R,I,O,D){D===void 0&&(D=this.drawingBufferHeight);var N=this.scissorStack,F=[w,R,I,O];return N.push(F),this.setScissor(w,R,I,O,D),this.currentScissor=F,F},setScissor:function(w,R,I,O,D){D===void 0&&(D=this.drawingBufferHeight);var N=this.gl,F=this.currentScissor,G=I>0&&O>0;if(F&&G){var L=F[0],C=F[1],P=F[2],k=F[3];G=L!==w||C!==R||P!==I||k!==O}G&&(this.flush(),N.scissor(w,D-R-O,I,O))},resetScissor:function(){var w=this.gl;w.enable(w.SCISSOR_TEST);var R=this.currentScissor;if(R){var I=R[0],O=R[1],D=R[2],N=R[3];D>0&&N>0&&w.scissor(I,this.drawingBufferHeight-O-N,D,N)}},popScissor:function(){var w=this.scissorStack;w.pop();var R=w[w.length-1];R&&this.setScissor(R[0],R[1],R[2],R[3]),this.currentScissor=R},hasActiveStencilMask:function(){var w=this.currentMask.mask,R=this.currentCameraMask.mask;return w&&w.isStencil||R&&R.isStencil},resetViewport:function(){var w=this.gl;w.viewport(0,0,this.width,this.height),this.drawingBufferHeight=w.drawingBufferHeight},setBlendMode:function(w,R){R===void 0&&(R=!1);var I=this.gl,O=this.blendModes[w];return R||w!==o.BlendModes.SKIP_CHECK&&this.currentBlendMode!==w?(this.flush(),I.enable(I.BLEND),I.blendEquation(O.equation),O.func.length>2?I.blendFuncSeparate(O.func[0],O.func[1],O.func[2],O.func[3]):I.blendFunc(O.func[0],O.func[1]),this.currentBlendMode=w,!0):!1},addBlendMode:function(w,R){var I=this.blendModes.push({func:w,equation:R});return I-1},updateBlendMode:function(w,R,I){return this.blendModes[w]&&(this.blendModes[w].func=R,I&&(this.blendModes[w].equation=I)),this},removeBlendMode:function(w){return w>17&&this.blendModes[w]&&this.blendModes.splice(w,1),this},pushFramebuffer:function(w,R,I,O,D){return w===this.currentFramebuffer?this:(this.fboStack.push(w),this.setFramebuffer(w,R,I,O,D))},setFramebuffer:function(w,R,I,O,D){if(R===void 0&&(R=!1),I===void 0&&(I=!0),O===void 0&&(O=null),D===void 0&&(D=!1),w===this.currentFramebuffer)return this;var N=this.gl,F=this.width,G=this.height;return w&&w.renderTexture&&I?(F=w.renderTexture.width,G=w.renderTexture.height):this.flush(),w?N.bindFramebuffer(N.FRAMEBUFFER,w.webGLFramebuffer):N.bindFramebuffer(N.FRAMEBUFFER,null),I&&N.viewport(0,0,F,G),O&&N.framebufferTexture2D(N.FRAMEBUFFER,N.COLOR_ATTACHMENT0,N.TEXTURE_2D,O.webGLTexture,0),D&&(N.clearColor(0,0,0,0),N.clear(N.COLOR_BUFFER_BIT)),R&&(w?(this.drawingBufferHeight=G,this.pushScissor(0,0,F,G)):(this.drawingBufferHeight=this.height,this.popScissor())),this.currentFramebuffer=w,this},popFramebuffer:function(w,R){w===void 0&&(w=!1),R===void 0&&(R=!0);var I=this.fboStack;I.pop();var O=I[I.length-1];return O||(O=null),this.setFramebuffer(O,w,R),O},restoreFramebuffer:function(w,R){w===void 0&&(w=!1),R===void 0&&(R=!0);var I=this.fboStack,O=I[I.length-1];O||(O=null),this.currentFramebuffer=null,this.setFramebuffer(O,w,R)},setProgram:function(w){return w!==this.currentProgram?(this.flush(),this.gl.useProgram(w.webGLProgram),this.currentProgram=w,!0):!1},resetProgram:function(){return this.gl.useProgram(this.currentProgram.webGLProgramWrapper),this},createTextureFromSource:function(w,R,I,O,D){D===void 0&&(D=!1);var N=this.gl,F=N.NEAREST,G=N.NEAREST,L=N.CLAMP_TO_EDGE,C=null;R=w?w.width:R,I=w?w.height:I;var P=l(R,I);if(P&&!D&&(L=N.REPEAT),O===o.ScaleModes.LINEAR&&this.config.antialias){var k=w&&w.compressed,B=!k&&P||k&&w.mipmaps.length>1;F=this.mipmapFilter&&B?this.mipmapFilter:N.LINEAR,G=N.LINEAR}return!w&&typeof R=="number"&&typeof I=="number"?C=this.createTexture2D(0,F,G,L,L,N.RGBA,null,R,I):C=this.createTexture2D(0,F,G,L,L,N.RGBA,w),C},createTexture2D:function(w,R,I,O,D,N,F,G,L,C,P,k){typeof G!="number"&&(G=F?F.width:1),typeof L!="number"&&(L=F?F.height:1);var B=new T(this.gl,w,R,I,O,D,N,F,G,L,C,P,k);return this.glTextureWrappers.push(B),B},createFramebuffer:function(w,R,I,O){this.currentFramebuffer=null;var D=new A(this.gl,w,R,I,O);return this.glFramebufferWrappers.push(D),D},beginBitmapMask:function(w,R){var I=this.gl;I&&(this.flush(),this.maskTarget.bind(!0),this.currentCameraMask.mask!==w&&(this.currentMask.mask=w,this.currentMask.camera=R))},drawBitmapMask:function(w,R,I){this.flush(),this.maskSource.bind(),this.setBlendMode(0,!0),w.renderWebGL(this,w,R),this.maskSource.unbind(!0),this.maskTarget.unbind();var O=this.gl,D=this.getCurrentStencilMask();D?(O.enable(O.STENCIL_TEST),D.mask.applyStencil(this,D.camera,!0)):this.currentMask.mask=null,this.pipelines.set(I),O.activeTexture(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,this.maskTarget.texture.webGLTexture),O.activeTexture(O.TEXTURE1),O.bindTexture(O.TEXTURE_2D,this.maskSource.texture.webGLTexture)},createProgram:function(w,R){var I=new y(this.gl,w,R);return this.glProgramWrappers.push(I),I},createVertexBuffer:function(w,R){var I=this.gl,O=new v(I,w,I.ARRAY_BUFFER,R);return this.glBufferWrappers.push(O),O},createAttribLocation:function(w,R){var I=new x(this.gl,w,R);return this.glAttribLocationWrappers.push(I),I},createUniformLocation:function(w,R){var I=new _(this.gl,w,R);return this.glUniformLocationWrappers.push(I),I},createIndexBuffer:function(w,R){var I=this.gl,O=new v(I,w,I.ELEMENT_ARRAY_BUFFER,R);return this.glBufferWrappers.push(O),O},deleteTexture:function(w){if(w)return s(this.glTextureWrappers,w),w.destroy(),this},deleteFramebuffer:function(w){return w?(s(this.fboStack,w),s(this.glFramebufferWrappers,w),w.destroy(),this):this},deleteProgram:function(w){return w&&(s(this.glProgramWrappers,w),w.destroy()),this},deleteAttribLocation:function(w){return w&&(s(this.glAttribLocationWrappers,w),w.destroy()),this},deleteUniformLocation:function(w){return w&&(s(this.glUniformLocationWrappers,w),w.destroy()),this},deleteBuffer:function(w){return w?(s(this.glBufferWrappers,w),w.destroy(),this):this},preRenderCamera:function(w){var R=w.x,I=w.y,O=w.width,D=w.height,N=w.backgroundColor;if(w.emit(n.PRE_RENDER,w),this.pipelines.preBatchCamera(w),this.pushScissor(R,I,O,D),w.mask&&(this.currentCameraMask.mask=w.mask,this.currentCameraMask.camera=w._maskCamera,w.mask.preRenderWebGL(this,w,w._maskCamera)),N.alphaGL>0){var F=this.pipelines.setMulti();F.drawFillRect(R,I,O,D,m.getTintFromFloats(N.blueGL,N.greenGL,N.redGL,1),N.alphaGL)}},getCurrentStencilMask:function(){var w=null,R=this.maskStack,I=this.currentCameraMask;return R.length>0?w=R[R.length-1]:I.mask&&I.mask.isStencil&&(w=I),w},postRenderCamera:function(w){var R=w.fadeEffect;if(R.isRunning||R.isComplete){var I=this.pipelines.setMulti();R.postRenderWebGL(I,m.getTintFromFloats)}w.dirty=!1,this.popScissor(),w.mask&&(this.currentCameraMask.mask=null,w.mask.postRenderWebGL(this,w._maskCamera)),this.pipelines.postBatchCamera(w),w.emit(n.POST_RENDER,w)},preRender:function(){if(!this.contextLost){var w=this.gl;if(w.bindFramebuffer(w.FRAMEBUFFER,null),this.emit(h.PRE_RENDER_CLEAR),this.config.clearBeforeRender){var R=this.config.backgroundColor;w.clearColor(R.redGL,R.greenGL,R.blueGL,R.alphaGL),w.clear(w.COLOR_BUFFER_BIT|w.DEPTH_BUFFER_BIT|w.STENCIL_BUFFER_BIT)}w.enable(w.SCISSOR_TEST),this.currentScissor=this.defaultScissor,this.scissorStack.length=0,this.scissorStack.push(this.currentScissor),this.game.scene.customViewports&&w.scissor(0,this.drawingBufferHeight-this.height,this.width,this.height),this.currentMask.mask=null,this.currentCameraMask.mask=null,this.maskStack.length=0,this.emit(h.PRE_RENDER)}},render:function(w,R,I){if(!this.contextLost){var O=R.length;if(this.emit(h.RENDER,w,I),this.preRenderCamera(I),O===0){this.setBlendMode(o.BlendModes.NORMAL),this.postRenderCamera(I);return}this.currentType="";for(var D=this.currentMask,N=0;N<O;N++){this.finalType=N===O-1;var F=R[N],G=F.mask;D=this.currentMask,D.mask&&D.mask!==G&&D.mask.postRenderWebGL(this,D.camera),G&&D.mask!==G&&G.preRenderWebGL(this,F,I),F.blendMode!==this.currentBlendMode&&this.setBlendMode(F.blendMode);var L=F.type;L!==this.currentType&&(this.newType=!0,this.currentType=L),this.finalType?this.nextTypeMatch=!1:this.nextTypeMatch=R[N+1].type===this.currentType,F.renderWebGL(this,F,I),this.newType=!1}D=this.currentMask,D.mask&&D.mask.postRenderWebGL(this,D.camera),this.setBlendMode(o.BlendModes.NORMAL),this.postRenderCamera(I)}},postRender:function(){if(!this.contextLost){this.flush(),this.emit(h.POST_RENDER);var w=this.snapshotState;w.callback&&(E(this.gl,w),w.callback=null)}},clearStencilMask:function(){this.gl.disable(this.gl.STENCIL_TEST)},restoreStencilMask:function(){var w=this.gl,R=this.getCurrentStencilMask();if(R){var I=R.mask;w.enable(w.STENCIL_TEST),I.invertAlpha?w.stencilFunc(w.NOTEQUAL,I.level,255):w.stencilFunc(w.EQUAL,I.level,255)}},snapshot:function(w,R,I){return this.snapshotArea(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight,w,R,I)},snapshotArea:function(w,R,I,O,D,N,F){var G=this.snapshotState;return G.callback=D,G.type=N,G.encoder=F,G.getPixel=!1,G.x=w,G.y=R,G.width=I,G.height=O,this},snapshotPixel:function(w,R,I){return this.snapshotArea(w,R,1,1,I),this.snapshotState.getPixel=!0,this},snapshotFramebuffer:function(w,R,I,O,D,N,F,G,L,C,P){D===void 0&&(D=!1),N===void 0&&(N=0),F===void 0&&(F=0),G===void 0&&(G=R),L===void 0&&(L=I),C==="pixel"&&(D=!0,C="image/png");var k=this.currentFramebuffer;this.snapshotArea(N,F,G,L,O,C,P);var B=this.snapshotState;return B.getPixel=D,B.isFramebuffer=!0,B.bufferWidth=R,B.bufferHeight=I,B.width=Math.min(B.width,R),B.height=Math.min(B.height,I),this.setFramebuffer(w),E(this.gl,B),this.setFramebuffer(k),B.callback=null,B.isFramebuffer=!1,this},canvasToTexture:function(w,R,I,O){I===void 0&&(I=!1),O===void 0&&(O=!1);var D=this.gl,N=D.NEAREST,F=D.NEAREST,G=w.width,L=w.height,C=D.CLAMP_TO_EDGE,P=l(G,L);return!I&&P&&(C=D.REPEAT),this.config.antialias&&(N=P&&this.mipmapFilter?this.mipmapFilter:D.LINEAR,F=D.LINEAR),R?(R.update(w,G,L,O,C,C,N,F,R.format),R):this.createTexture2D(0,N,F,C,C,D.RGBA,w,G,L,!0,!1,O)},createCanvasTexture:function(w,R,I){return R===void 0&&(R=!1),I===void 0&&(I=!1),this.canvasToTexture(w,null,R,I)},updateCanvasTexture:function(w,R,I,O){return I===void 0&&(I=!1),O===void 0&&(O=!1),this.canvasToTexture(w,R,O,I)},videoToTexture:function(w,R,I,O){I===void 0&&(I=!1),O===void 0&&(O=!1);var D=this.gl,N=D.NEAREST,F=D.NEAREST,G=w.videoWidth,L=w.videoHeight,C=D.CLAMP_TO_EDGE,P=l(G,L);return!I&&P&&(C=D.REPEAT),this.config.antialias&&(N=P&&this.mipmapFilter?this.mipmapFilter:D.LINEAR,F=D.LINEAR),R?(R.update(w,G,L,O,C,C,N,F,R.format),R):this.createTexture2D(0,N,F,C,C,D.RGBA,w,G,L,!0,!0,O)},createVideoTexture:function(w,R,I){return R===void 0&&(R=!1),I===void 0&&(I=!1),this.videoToTexture(w,null,R,I)},updateVideoTexture:function(w,R,I,O){return I===void 0&&(I=!1),O===void 0&&(O=!1),this.videoToTexture(w,R,O,I)},createUint8ArrayTexture:function(w,R,I){var O=this.gl,D=O.NEAREST,N=O.NEAREST,F=O.CLAMP_TO_EDGE,G=l(R,I);return G&&(F=O.REPEAT),this.createTexture2D(0,D,N,F,F,O.RGBA,w,R,I)},setTextureFilter:function(w,R){var I=this.gl,O=R===0?I.LINEAR:I.NEAREST;I.activeTexture(I.TEXTURE0);var D=I.getParameter(I.TEXTURE_BINDING_2D);return I.bindTexture(I.TEXTURE_2D,w.webGLTexture),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MIN_FILTER,O),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MAG_FILTER,O),w.minFilter=O,w.magFilter=O,D&&I.bindTexture(I.TEXTURE_2D,D),this},getMaxTextureSize:function(){return this.config.maxTextureSize},destroy:function(){this.canvas.removeEventListener("webglcontextlost",this.contextLostHandler,!1),this.canvas.removeEventListener("webglcontextrestored",this.contextRestoredHandler,!1);var w=function(R){R.destroy()};i(this.glAttribLocationWrappers,w),i(this.glBufferWrappers,w),i(this.glFramebufferWrappers,w),i(this.glProgramWrappers,w),i(this.glTextureWrappers,w),i(this.glUniformLocationWrappers,w),this.maskTarget.destroy(),this.maskSource.destroy(),this.pipelines.destroy(),this.removeAllListeners(),this.fboStack=[],this.maskStack=[],this.extensions={},this.textureIndexes=[],this.gl=null,this.game=null,this.canvas=null,this.contextLost=!0,this.currentMask=null,this.currentCameraMask=null,b&&(this.spector=null)}});t.exports=M}),ew=S((e,t)=>{"use strict";var i={WebGLAttribLocationWrapper:cc(),WebGLBufferWrapper:hc(),WebGLProgramWrapper:lc(),WebGLTextureWrapper:ja(),WebGLFramebufferWrapper:uc(),WebGLUniformLocationWrapper:dc()};t.exports=i}),iw=S((e,t)=>{"use strict";var i=cn(),s=Re(),n={PipelineManager:ac(),Pipelines:oc(),RenderTarget:hr(),WebGLPipeline:dn(),WebGLRenderer:pc(),Wrappers:ew()};n=s(!1,n,i),t.exports=n}),Cs=S((e,t)=>{"use strict";t.exports={Events:un()},t.exports.WebGL=iw()}),gn=S((e,t)=>{"use strict";var i={CREATED:0,DELAY:2,PENDING_RENDER:4,PLAYING_FORWARD:5,PLAYING_BACKWARD:6,HOLD_DELAY:7,REPEAT_DELAY:8,COMPLETE:9,PENDING:20,ACTIVE:21,LOOP_DELAY:22,COMPLETE_DELAY:23,START_DELAY:24,PENDING_REMOVE:25,REMOVED:26,FINISHED:27,DESTROYED:28,MAX:999999999999};t.exports=i}),cr=S((e,t)=>{"use strict";var i=function(s,n,r){return s&&s.hasOwnProperty(n)?s[n]:r};t.exports=i}),Za=S((e,t)=>{"use strict";var i=function(s,n,r){var o;if(s.hasOwnProperty(n)){var a=typeof s[n];a==="function"?o=function(h,l,c,f,u,p){return s[n](h,l,c,f,u,p)}:o=function(){return s[n]}}else typeof r=="function"?o=r:o=function(){return r};return o};t.exports=i}),sw=S((e,t)=>{"use strict";t.exports=["callbackScope","completeDelay","delay","duration","ease","easeParams","flipX","flipY","hold","interpolation","loop","loopDelay","onActive","onActiveParams","onComplete","onCompleteParams","onLoop","onLoopParams","onPause","onPauseParams","onRepeat","onRepeatParams","onResume","onResumeParams","onStart","onStartParams","onStop","onStopParams","onUpdate","onUpdateParams","onYoyo","onYoyoParams","paused","persist","props","repeat","repeatDelay","targets","yoyo"]}),gc=S((e,t)=>{"use strict";var i=sw(),s=function(n){var r,o=[];if(n.hasOwnProperty("props"))for(r in n.props)r.substring(0,1)!=="_"&&o.push({key:r,value:n.props[r]});else for(r in n)i.indexOf(r)===-1&&r.substring(0,1)!=="_"&&o.push({key:r,value:n[r]});return o};t.exports=s}),qa=S((e,t)=>{"use strict";var i=Mt(),s=function(n){var r=i(n,"targets",null);return r===null||(typeof r=="function"&&(r=r.call()),Array.isArray(r)||(r=[r])),r};t.exports=s}),Qa=S((e,t)=>{"use strict";var i=Ts(),s=on();function n(l){return!!l.getActive&&typeof l.getActive=="function"}function r(l){return!!l.getStart&&typeof l.getStart=="function"}function o(l){return!!l.getEnd&&typeof l.getEnd=="function"}function a(l){return r(l)||o(l)||n(l)}var h=function(l,c){var f,u=function(D,N,F){return F},p=function(D,N,F){return F},d=null,g=typeof c;if(g==="number")u=function(){return c};else if(Array.isArray(c))p=function(){return c[0]},u=function(){return c[c.length-1]};else if(g==="string"){var m=c.toLowerCase(),E=m.substring(0,6)==="random",v=m.substring(0,3)==="int";if(E||v){var y=m.indexOf("("),T=m.indexOf(")"),A=m.indexOf(",");if(y&&T&&A){var x=parseFloat(m.substring(y+1,A)),_=parseFloat(m.substring(A+1,T));E?u=function(){return s(x,_)}:u=function(){return i(x,_)}}else throw new Error("invalid random() format")}else{m=m[0];var b=parseFloat(c.substr(2));switch(m){case"+":u=function(D,N,F){return F+b};break;case"-":u=function(D,N,F){return F-b};break;case"*":u=function(D,N,F){return F*b};break;case"/":u=function(D,N,F){return F/b};break;default:u=function(){return parseFloat(c)}}}}else if(g==="function")u=c;else if(g==="object")if(a(c))n(c)&&(d=c.getActive),o(c)&&(u=c.getEnd),r(c)&&(p=c.getStart);else if(c.hasOwnProperty("value"))f=h(l,c.value);else{var M=c.hasOwnProperty("to"),w=c.hasOwnProperty("from"),R=c.hasOwnProperty("start");if(M&&(w||R)){if(f=h(l,c.to),R){var I=h(l,c.start);f.getActive=I.getEnd}if(w){var O=h(l,c.from);f.getStart=O.getEnd}}}return f||(f={getActive:d,getEnd:u,getStart:p}),f};t.exports=h}),_s=S((e,t)=>{"use strict";var i=V(),s=Wt(),n=Ue(),r=gn(),o=new i({Extends:s,initialize:function(a){s.call(this),this.parent=a,this.data=[],this.totalData=0,this.startDelay=0,this.hasStarted=!1,this.timeScale=1,this.loop=0,this.loopDelay=0,this.loopCounter=0,this.completeDelay=0,this.countdown=0,this.state=r.PENDING,this.paused=!1,this.callbacks={onActive:null,onComplete:null,onLoop:null,onPause:null,onRepeat:null,onResume:null,onStart:null,onStop:null,onUpdate:null,onYoyo:null},this.callbackScope,this.persist=!1},setTimeScale:function(a){return this.timeScale=a,this},getTimeScale:function(){return this.timeScale},isPlaying:function(){return!this.paused&&this.isActive()},isPaused:function(){return this.paused},pause:function(){return this.paused||(this.paused=!0,this.dispatchEvent(n.TWEEN_PAUSE,"onPause")),this},resume:function(){return this.paused&&(this.paused=!1,this.dispatchEvent(n.TWEEN_RESUME,"onResume")),this},makeActive:function(){this.parent.makeActive(this),this.dispatchEvent(n.TWEEN_ACTIVE,"onActive")},onCompleteHandler:function(){this.setPendingRemoveState(),this.dispatchEvent(n.TWEEN_COMPLETE,"onComplete")},complete:function(a){return a===void 0&&(a=0),a?(this.setCompleteDelayState(),this.countdown=a):this.onCompleteHandler(),this},completeAfterLoop:function(a){return a===void 0&&(a=0),this.loopCounter>a&&(this.loopCounter=a),this},remove:function(){return this.parent&&this.parent.remove(this),this},stop:function(){return this.parent&&!this.isRemoved()&&!this.isPendingRemove()&&!this.isDestroyed()&&(this.dispatchEvent(n.TWEEN_STOP,"onStop"),this.setPendingRemoveState()),this},updateLoopCountdown:function(a){this.countdown-=a,this.countdown<=0&&(this.setActiveState(),this.dispatchEvent(n.TWEEN_LOOP,"onLoop"))},updateStartCountdown:function(a){return this.countdown-=a,this.countdown<=0&&(this.hasStarted=!0,this.setActiveState(),this.dispatchEvent(n.TWEEN_START,"onStart"),a=0),a},updateCompleteDelay:function(a){this.countdown-=a,this.countdown<=0&&this.onCompleteHandler()},setCallback:function(a,h,l){return l===void 0&&(l=[]),this.callbacks.hasOwnProperty(a)&&(this.callbacks[a]={func:h,params:l}),this},setPendingState:function(){this.state=r.PENDING},setActiveState:function(){this.state=r.ACTIVE,this.hasStarted=!1},setLoopDelayState:function(){this.state=r.LOOP_DELAY},setCompleteDelayState:function(){this.state=r.COMPLETE_DELAY},setStartDelayState:function(){this.state=r.START_DELAY,this.countdown=this.startDelay,this.hasStarted=!1},setPendingRemoveState:function(){this.state=r.PENDING_REMOVE},setRemovedState:function(){this.state=r.REMOVED},setFinishedState:function(){this.state=r.FINISHED},setDestroyedState:function(){this.state=r.DESTROYED},isPending:function(){return this.state===r.PENDING},isActive:function(){return this.state===r.ACTIVE},isLoopDelayed:function(){return this.state===r.LOOP_DELAY},isCompleteDelayed:function(){return this.state===r.COMPLETE_DELAY},isStartDelayed:function(){return this.state===r.START_DELAY},isPendingRemove:function(){return this.state===r.PENDING_REMOVE},isRemoved:function(){return this.state===r.REMOVED},isFinished:function(){return this.state===r.FINISHED},isDestroyed:function(){return this.state===r.DESTROYED},destroy:function(){this.data&&this.data.forEach(function(a){a.destroy()}),this.removeAllListeners(),this.callbacks=null,this.data=null,this.parent=null,this.setDestroyedState()}});o.TYPES=["onActive","onComplete","onLoop","onPause","onRepeat","onResume","onStart","onStop","onUpdate","onYoyo"],t.exports=o}),fc=S((e,t)=>{"use strict";var i={targets:null,delay:0,duration:1e3,ease:"Power0",easeParams:null,hold:0,repeat:0,repeatDelay:0,yoyo:!1,flipX:!1,flipY:!1,persist:!1,interpolation:null};t.exports=i}),mc=S((e,t)=>{"use strict";var i=V(),s=Ue(),n=gn(),r=new i({initialize:function(o,a,h,l,c,f,u,p,d,g){this.tween=o,this.targetIndex=a,this.duration=l<=0?.01:l,this.totalDuration=0,this.delay=0,this.getDelay=h,this.yoyo=c,this.hold=f,this.repeat=u,this.repeatDelay=p,this.repeatCounter=0,this.flipX=d,this.flipY=g,this.progress=0,this.elapsed=0,this.state=0,this.isCountdown=!1},getTarget:function(){return this.tween.targets[this.targetIndex]},setTargetValue:function(o){o===void 0&&(o=this.current),this.tween.targets[this.targetIndex][this.key]=o},setCreatedState:function(){this.state=n.CREATED,this.isCountdown=!1},setDelayState:function(){this.state=n.DELAY,this.isCountdown=!0},setPendingRenderState:function(){this.state=n.PENDING_RENDER,this.isCountdown=!1},setPlayingForwardState:function(){this.state=n.PLAYING_FORWARD,this.isCountdown=!1},setPlayingBackwardState:function(){this.state=n.PLAYING_BACKWARD,this.isCountdown=!1},setHoldState:function(){this.state=n.HOLD_DELAY,this.isCountdown=!0},setRepeatState:function(){this.state=n.REPEAT_DELAY,this.isCountdown=!0},setCompleteState:function(){this.state=n.COMPLETE,this.isCountdown=!1},isCreated:function(){return this.state===n.CREATED},isDelayed:function(){return this.state===n.DELAY},isPendingRender:function(){return this.state===n.PENDING_RENDER},isPlayingForward:function(){return this.state===n.PLAYING_FORWARD},isPlayingBackward:function(){return this.state===n.PLAYING_BACKWARD},isHolding:function(){return this.state===n.HOLD_DELAY},isRepeating:function(){return this.state===n.REPEAT_DELAY},isComplete:function(){return this.state===n.COMPLETE},setStateFromEnd:function(o){this.yoyo?this.onRepeat(o,!0,!0):this.repeatCounter>0?this.onRepeat(o,!0,!1):this.setCompleteState()},setStateFromStart:function(o){this.repeatCounter>0?this.onRepeat(o,!1):this.setCompleteState()},reset:function(){var o=this.tween,a=o.totalTargets,h=this.targetIndex,l=o.targets[h],c=this.key;this.progress=0,this.elapsed=0,this.delay=this.getDelay(l,c,0,h,a,o),this.repeatCounter=this.repeat===-1?n.MAX:this.repeat,this.setPendingRenderState();var f=this.duration+this.hold;this.yoyo&&(f+=this.duration);var u=f+this.repeatDelay;this.totalDuration=this.delay+f,this.repeat===-1?(this.totalDuration+=u*n.MAX,o.isInfinite=!0):this.repeat>0&&(this.totalDuration+=u*this.repeat),this.totalDuration>o.duration&&(o.duration=this.totalDuration),this.delay<o.startDelay&&(o.startDelay=this.delay),this.delay>0&&(this.elapsed=this.delay,this.setDelayState())},onRepeat:function(o,a,h){var l=this.tween,c=l.totalTargets,f=this.targetIndex,u=l.targets[f],p=this.key,d=p!=="texture";if(this.elapsed=o,this.progress=o/this.duration,this.flipX&&u.toggleFlipX(),this.flipY&&u.toggleFlipY(),d&&(a||h)&&(this.start=this.getStartValue(u,p,this.start,f,c,l)),h){this.setPlayingBackwardState(),this.dispatchEvent(s.TWEEN_YOYO,"onYoyo");return}this.repeatCounter--,d&&(this.end=this.getEndValue(u,p,this.start,f,c,l)),this.repeatDelay>0?(this.elapsed=this.repeatDelay-o,d&&(this.current=this.start,u[p]=this.current),this.setRepeatState()):(this.setPlayingForwardState(),this.dispatchEvent(s.TWEEN_REPEAT,"onRepeat"))},destroy:function(){this.tween=null,this.getDelay=null,this.setCompleteState()}});t.exports=r}),vc=S((e,t)=>{"use strict";var i=mc(),s=Xt(),n=V(),r=Ue(),o=new n({Extends:i,initialize:function(a,h,l,c,f,u,p,d,g,m,E,v,y,T,A,x,_){i.call(this,a,h,d,g,m,E,v,y,T,A),this.key=l,this.getActiveValue=u,this.getEndValue=c,this.getStartValue=f,this.ease=p,this.start=0,this.previous=0,this.current=0,this.end=0,this.interpolation=x,this.interpolationData=_},reset:function(a){i.prototype.reset.call(this);var h=this.tween.targets[this.targetIndex],l=this.key;a&&(h[l]=this.start),this.start=0,this.previous=0,this.current=0,this.end=0,this.getActiveValue&&(h[l]=this.getActiveValue(h,l,0))},update:function(a){var h=this.tween,l=h.totalTargets,c=this.targetIndex,f=h.targets[c],u=this.key;if(!f)return this.setCompleteState(),!1;if(this.isCountdown&&(this.elapsed-=a,this.elapsed<=0&&(this.elapsed=0,a=0,this.isDelayed()?this.setPendingRenderState():this.isRepeating()?(this.setPlayingForwardState(),this.dispatchEvent(r.TWEEN_REPEAT,"onRepeat")):this.isHolding()&&this.setStateFromEnd(0))),this.isPendingRender())return this.start=this.getStartValue(f,u,f[u],c,l,h),this.end=this.getEndValue(f,u,this.start,c,l,h),this.current=this.start,f[u]=this.start,this.setPlayingForwardState(),!0;var p=this.isPlayingForward(),d=this.isPlayingBackward();if(p||d){var g=this.elapsed,m=this.duration,E=0,v=!1;g+=a,g>=m?(E=g-m,g=m,v=!0):g<0&&(g=0);var y=s(g/m,0,1);this.elapsed=g,this.progress=y,this.previous=this.current,p||(y=1-y);var T=this.ease(y);this.interpolation?this.current=this.interpolation(this.interpolationData,T):this.current=this.start+(this.end-this.start)*T,f[u]=this.current,v&&(p?(h.isNumberTween&&(this.current=this.end,f[u]=this.current),this.hold>0?(this.elapsed=this.hold,this.setHoldState()):this.setStateFromEnd(E)):(h.isNumberTween&&(this.current=this.start,f[u]=this.current),this.setStateFromStart(E))),this.dispatchEvent(r.TWEEN_UPDATE,"onUpdate")}return!this.isComplete()},dispatchEvent:function(a,h){var l=this.tween;if(!l.isSeeking){var c=l.targets[this.targetIndex],f=this.key,u=this.current,p=this.previous;l.emit(a,l,f,c,u,p);var d=l.callbacks[h];d&&d.func.apply(l.callbackScope,[l,c,f,u,p].concat(d.params))}},destroy:function(){i.prototype.destroy.call(this),this.getActiveValue=null,this.getEndValue=null,this.getStartValue=null,this.ease=null}});t.exports=o}),Ec=S((e,t)=>{"use strict";var i=mc(),s=Xt(),n=V(),r=Ue(),o=new n({Extends:i,initialize:function(a,h,l,c,f,u,p,d,g,m,E){i.call(this,a,h,f,u,!1,p,d,g,m,E),this.key="texture",this.startTexture=null,this.endTexture=l,this.startFrame=null,this.endFrame=c,this.yoyo=d!==0},reset:function(a){i.prototype.reset.call(this);var h=this.tween.targets[this.targetIndex];this.startTexture||(this.startTexture=h.texture.key,this.startFrame=h.frame.name),a&&h.setTexture(this.startTexture,this.startFrame)},update:function(a){var h=this.tween,l=this.targetIndex,c=h.targets[l];if(!c)return this.setCompleteState(),!1;if(this.isCountdown&&(this.elapsed-=a,this.elapsed<=0&&(this.elapsed=0,a=0,this.isDelayed()?this.setPendingRenderState():this.isRepeating()?(this.setPlayingForwardState(),this.dispatchEvent(r.TWEEN_REPEAT,"onRepeat")):this.isHolding()&&this.setStateFromEnd(0))),this.isPendingRender())return this.startTexture&&c.setTexture(this.startTexture,this.startFrame),this.setPlayingForwardState(),!0;var f=this.isPlayingForward(),u=this.isPlayingBackward();if(f||u){var p=this.elapsed,d=this.duration,g=0,m=!1;p+=a,p>=d?(g=p-d,p=d,m=!0):p<0&&(p=0);var E=s(p/d,0,1);this.elapsed=p,this.progress=E,m&&(f?(c.setTexture(this.endTexture,this.endFrame),this.hold>0?(this.elapsed=this.hold,this.setHoldState()):this.setStateFromEnd(g)):(c.setTexture(this.startTexture,this.startFrame),this.setStateFromStart(g))),this.dispatchEvent(r.TWEEN_UPDATE,"onUpdate")}return!this.isComplete()},dispatchEvent:function(a,h){var l=this.tween;if(!l.isSeeking){var c=l.targets[this.targetIndex],f=this.key;l.emit(a,l,f,c);var u=l.callbacks[h];u&&u.func.apply(l.callbackScope,[l,c,f].concat(u.params))}},destroy:function(){i.prototype.destroy.call(this),this.startTexture=null,this.endTexture=null,this.startFrame=null,this.endFrame=null}});t.exports=o}),dr=S((e,t)=>{"use strict";var i=_s(),s=V(),n=Ue(),r=ve(),o=jt(),a=he(),h=gn(),l=vc(),c=Ec(),f=new s({Extends:i,initialize:function(u,p){i.call(this,u),this.targets=p,this.totalTargets=p.length,this.isSeeking=!1,this.isInfinite=!1,this.elapsed=0,this.totalElapsed=0,this.duration=0,this.progress=0,this.totalDuration=0,this.totalProgress=0,this.isNumberTween=!1},add:function(u,p,d,g,m,E,v,y,T,A,x,_,b,M,w,R){var I=new l(this,u,p,d,g,m,E,v,y,T,A,x,_,b,M,w,R);return this.totalData=this.data.push(I),I},addFrame:function(u,p,d,g,m,E,v,y,T,A){var x=new c(this,u,p,d,g,m,E,v,y,T,A);return this.totalData=this.data.push(x),x},getValue:function(u){u===void 0&&(u=0);var p=null;return this.data&&(p=this.data[u].current),p},hasTarget:function(u){return this.targets&&this.targets.indexOf(u)!==-1},updateTo:function(u,p,d){if(d===void 0&&(d=!1),u!=="texture")for(var g=0;g<this.totalData;g++){var m=this.data[g];m.key===u&&(m.isPlayingForward()||m.isPlayingBackward())&&(m.end=p,d&&(m.start=m.current))}return this},restart:function(){switch(this.state){case h.REMOVED:case h.FINISHED:this.seek(),this.parent.makeActive(this);break;case h.PENDING:case h.PENDING_REMOVE:this.parent.reset(this);break;case h.DESTROYED:break;default:this.seek();break}return this.paused=!1,this.hasStarted=!1,this},nextState:function(){if(this.loopCounter>0)this.elapsed=0,this.progress=0,this.loopCounter--,this.initTweenData(!0),this.loopDelay>0?(this.countdown=this.loopDelay,this.setLoopDelayState()):(this.setActiveState(),this.dispatchEvent(n.TWEEN_LOOP,"onLoop"));else if(this.completeDelay>0)this.countdown=this.completeDelay,this.setCompleteDelayState();else return this.onCompleteHandler(),!0;return!1},onCompleteHandler:function(){this.progress=1,this.totalProgress=1,i.prototype.onCompleteHandler.call(this)},play:function(){return this.isDestroyed()?this:((this.isPendingRemove()||this.isFinished())&&this.seek(),this.paused=!1,this.setActiveState(),this)},seek:function(u,p,d){if(u===void 0&&(u=0),p===void 0&&(p=16.6),d===void 0&&(d=!1),this.isDestroyed())return this;d||(this.isSeeking=!0),this.reset(!0),this.initTweenData(!0),this.setActiveState(),this.dispatchEvent(n.TWEEN_ACTIVE,"onActive");var g=this.paused;if(this.paused=!1,u>0){for(var m=Math.floor(u/p),E=u-m*p,v=0;v<m;v++)this.update(p);E>0&&this.update(E)}return this.paused=g,this.isSeeking=!1,this},initTweenData:function(u){u===void 0&&(u=!1),this.duration=0,this.startDelay=a.MAX_SAFE_INTEGER;for(var p=this.data,d=0;d<this.totalData;d++)p[d].reset(u);this.duration=Math.max(this.duration,.01);var g=this.duration,m=this.completeDelay,E=this.loopCounter,v=this.loopDelay;E>0?this.totalDuration=g+m+(g+v)*E:this.totalDuration=g+m},reset:function(u){return u===void 0&&(u=!1),this.elapsed=0,this.totalElapsed=0,this.progress=0,this.totalProgress=0,this.loopCounter=this.loop,this.loop===-1&&(this.isInfinite=!0,this.loopCounter=h.MAX),u||(this.initTweenData(),this.setActiveState(),this.dispatchEvent(n.TWEEN_ACTIVE,"onActive")),this},update:function(u){if(this.isPendingRemove()||this.isDestroyed())return this.persist?(this.setFinishedState(),!1):!0;if(this.paused||this.isFinished())return!1;if(u*=this.timeScale*this.parent.timeScale,this.isLoopDelayed())return this.updateLoopCountdown(u),!1;if(this.isCompleteDelayed())return this.updateCompleteDelay(u),!1;this.hasStarted||(this.startDelay-=u,this.startDelay<=0&&(this.hasStarted=!0,this.dispatchEvent(n.TWEEN_START,"onStart"),u=0));var p=!1;if(this.isActive())for(var d=this.data,g=0;g<this.totalData;g++)d[g].update(u)&&(p=!0);this.elapsed+=u,this.progress=Math.min(this.elapsed/this.duration,1),this.totalElapsed+=u,this.totalProgress=Math.min(this.totalElapsed/this.totalDuration,1),p||this.nextState();var m=this.isPendingRemove();return m&&this.persist&&(this.setFinishedState(),m=!1),m},forward:function(u){return this.update(u),this},rewind:function(u){return this.update(-u),this},dispatchEvent:function(u,p){if(!this.isSeeking){if(this.emit(u,this,this.targets),!this.callbacks)return;var d=this.callbacks[p];d&&d.func.apply(this.callbackScope,[this,this.targets].concat(d.params))}},destroy:function(){i.prototype.destroy.call(this),this.targets=null}});o.register("tween",function(u){return this.scene.sys.tweens.add(u)}),r.register("tween",function(u){return this.scene.sys.tweens.create(u)}),t.exports=f}),yc=S((e,t)=>{"use strict";var i=_s(),s=fc(),n=Ee(),r=cr(),o=ji(),a=pt(),h=Za(),l=Mt(),c=Qa(),f=Na(),u=dr(),p=function(d,g,m){if(g instanceof u)return g.parent=d,g;m===void 0?m=s:m=f(s,m);var E=a(g,"from",0),v=a(g,"to",1),y=[{value:E}],T=a(g,"delay",m.delay),A=a(g,"easeParams",m.easeParams),x=a(g,"ease",m.ease),_=c("value",v),b=new u(d,y),M=b.add(0,"value",_.getEnd,_.getStart,_.getActive,o(a(g,"ease",x),a(g,"easeParams",A)),h(g,"delay",T),a(g,"duration",m.duration),r(g,"yoyo",m.yoyo),a(g,"hold",m.hold),a(g,"repeat",m.repeat),a(g,"repeatDelay",m.repeatDelay),!1,!1);M.start=E,M.current=E,b.completeDelay=n(g,"completeDelay",0),b.loop=Math.round(n(g,"loop",0)),b.loopDelay=Math.round(n(g,"loopDelay",0)),b.paused=r(g,"paused",!1),b.persist=r(g,"persist",!1),b.isNumberTween=!0,b.callbackScope=l(g,"callbackScope",b);for(var w=i.TYPES,R=0;R<w.length;R++){var I=w[R],O=l(g,I,!1);if(O){var D=l(g,I+"Params",[]);b.setCallback(I,O,D)}}return b};t.exports=p}),Tc=S((e,t)=>{"use strict";var i=ji(),s=Mt(),n=he(),r=function(o,a){a===void 0&&(a={});var h,l=s(a,"start",0),c=s(a,"ease",null),f=s(a,"grid",null),u=s(a,"from",0),p=u==="first",d=u==="center",g=u==="last",m=typeof u=="number",E=Array.isArray(o),v=parseFloat(E?o[0]:o),y=E?parseFloat(o[1]):0,T=Math.max(v,y);if(E&&(l+=v),f){var A=f[0],x=f[1],_=0,b=0,M=0,w=0,R=[];g?(_=A-1,b=x-1):m?(_=u%A,b=Math.floor(u/A)):d&&(_=(A-1)/2,b=(x-1)/2);for(var I=n.MIN_SAFE_INTEGER,O=0;O<x;O++){R[O]=[];for(var D=0;D<A;D++){M=_-D,w=b-O;var N=Math.sqrt(M*M+w*w);N>I&&(I=N),R[O][D]=N}}}var F=c?i(c):null;return f?h=function(G,L,C,P){var k=0,B=P%A,Y=Math.floor(P/A);B>=0&&B<A&&Y>=0&&Y<x&&(k=R[Y][B]);var H;if(E){var z=y-v;F?H=k/I*z*F(k/I):H=k/I*z}else F?H=k*v*F(k/I):H=k*v;return H+l}:h=function(G,L,C,P,k){k--;var B;p?B=P:d?B=Math.abs(k/2-P):g?B=k-P:m&&(B=Math.abs(u-P));var Y;if(E){var H;d?H=(y-v)/k*(B*2):H=(y-v)/k*B,F?Y=H*F(B/k):Y=H}else F?Y=k*T*F(B/k):Y=B*v;return Y+l},h};t.exports=r}),Ja=S((e,t)=>{"use strict";var i=_s(),s=fc(),n=Ee(),r=cr(),o=ji(),a=pt(),h=ir(),l=Za(),c=gc(),f=qa(),u=Mt(),p=Qa(),d=Na(),g=dr(),m=function(E,v,y){if(v instanceof g)return v.parent=E,v;y===void 0?y=s:y=d(s,y);var T=f(v);!T&&y.targets&&(T=y.targets);for(var A=c(v),x=a(v,"delay",y.delay),_=a(v,"duration",y.duration),b=a(v,"easeParams",y.easeParams),M=a(v,"ease",y.ease),w=a(v,"hold",y.hold),R=a(v,"repeat",y.repeat),I=a(v,"repeatDelay",y.repeatDelay),O=r(v,"yoyo",y.yoyo),D=r(v,"flipX",y.flipX),N=r(v,"flipY",y.flipY),F=a(v,"interpolation",y.interpolation),G=function(et,J,st,q){if(st==="texture"){var ht=q,Pt=void 0;Array.isArray(q)?(ht=q[0],Pt=q[1]):q.hasOwnProperty("value")?(ht=q.value,Array.isArray(q.value)?(ht=q.value[0],Pt=q.value[1]):typeof q.value=="string"&&(ht=q.value)):typeof q=="string"&&(ht=q),et.addFrame(J,ht,Pt,l(q,"delay",x),a(q,"duration",_),a(q,"hold",w),a(q,"repeat",R),a(q,"repeatDelay",I),r(q,"flipX",D),r(q,"flipY",N))}else{var Bt=p(st,q),Ct=h(a(q,"interpolation",F));et.add(J,st,Bt.getEnd,Bt.getStart,Bt.getActive,o(a(q,"ease",M),a(q,"easeParams",b)),l(q,"delay",x),a(q,"duration",_),r(q,"yoyo",O),a(q,"hold",w),a(q,"repeat",R),a(q,"repeatDelay",I),r(q,"flipX",D),r(q,"flipY",N),Ct,Ct?q:null)}},L=new g(E,T),C=0;C<A.length;C++)for(var P=A[C].key,k=A[C].value,B=0;B<T.length;B++)P==="scale"&&!T[B].hasOwnProperty("scale")?(G(L,B,"scaleX",k),G(L,B,"scaleY",k)):G(L,B,P,k);L.completeDelay=n(v,"completeDelay",0),L.loop=Math.round(n(v,"loop",0)),L.loopDelay=Math.round(n(v,"loopDelay",0)),L.paused=r(v,"paused",!1),L.persist=r(v,"persist",!1),L.callbackScope=a(v,"callbackScope",L);for(var Y=i.TYPES,H=0;H<Y.length;H++){var z=Y[H],K=u(v,z,!1);if(K){var X=u(v,z+"Params",[]);L.setCallback(z,K,X)}}return L};t.exports=m}),nw=S((e,t)=>{"use strict";t.exports={GetBoolean:cr(),GetEaseFunction:ji(),GetInterpolationFunction:ir(),GetNewValue:Za(),GetProps:gc(),GetTargets:qa(),GetValueOp:Qa(),NumberTweenBuilder:yc(),StaggerBuilder:Tc(),TweenBuilder:Ja()}}),$a=S((e,t)=>{"use strict";var i=Pi(),s=_s(),n=V(),r=Ue(),o=ve(),a=jt(),h=gn(),l=new n({Extends:s,initialize:function(c){s.call(this,c),this.currentTween=null,this.currentIndex=0},init:function(){return this.loopCounter=this.loop===-1?h.MAX:this.loop,this.setCurrentTween(0),this.startDelay>0&&!this.isStartDelayed()?this.setStartDelayState():this.setActiveState(),this},add:function(c){var f=this.parent.create(c);Array.isArray(f)||(f=[f]);for(var u=this.data,p=0;p<f.length;p++){var d=f[p];d.parent=this,u.push(d.reset())}return this.totalData=u.length,this},remove:function(c){return i(this.data,c),c.setRemovedState(),c===this.currentTween&&this.nextTween(),this.totalData=this.data.length,this},hasTarget:function(c){for(var f=this.data,u=0;u<this.totalData;u++)if(f[u].hasTarget(c))return!0;return!1},restart:function(){return this.isDestroyed()?this:(this.isRemoved()&&this.parent.makeActive(this),this.resetTweens(),this.paused=!1,this.init())},reset:function(c){return c.seek(),c.setActiveState(),this},makeActive:function(c){return c.reset(),c.setActiveState(),this},nextState:function(){if(this.loopCounter>0)this.loopCounter--,this.resetTweens(),this.loopDelay>0?(this.countdown=this.loopDelay,this.setLoopDelayState()):(this.setActiveState(),this.dispatchEvent(r.TWEEN_LOOP,"onLoop"));else if(this.completeDelay>0)this.countdown=this.completeDelay,this.setCompleteDelayState();else return this.onCompleteHandler(),!0;return!1},play:function(){return this.isDestroyed()?this:((this.isPendingRemove()||this.isPending())&&this.resetTweens(),this.paused=!1,this.startDelay>0&&!this.isStartDelayed()?this.setStartDelayState():this.setActiveState(),this)},resetTweens:function(){for(var c=this.data,f=this.totalData,u=0;u<f;u++)c[u].reset(!1);this.setCurrentTween(0)},update:function(c){if(this.isPendingRemove()||this.isDestroyed())return!0;if(this.isFinished()||this.paused)return!1;if(c*=this.parent.timeScale,this.isLoopDelayed())return this.updateLoopCountdown(c),!1;if(this.isCompleteDelayed())return this.updateCompleteDelay(c),!1;this.hasStarted||(this.startDelay-=c,this.startDelay<=0&&(this.hasStarted=!0,this.dispatchEvent(r.TWEEN_START,"onStart"),c=0));var f=!1;return this.isActive()&&this.currentTween&&(this.currentTween.update(c)&&this.nextTween()&&this.nextState(),f=this.isPendingRemove(),f&&this.persist&&(this.setFinishedState(),f=!1)),f},nextTween:function(){return this.currentIndex++,this.currentIndex===this.totalData?!0:(this.setCurrentTween(this.currentIndex),!1)},setCurrentTween:function(c){this.currentIndex=c,this.currentTween=this.data[c],this.currentTween.setActiveState()},dispatchEvent:function(c,f){this.emit(c,this);var u=this.callbacks[f];u&&u.func.apply(this.callbackScope,[this].concat(u.params))},destroy:function(){s.prototype.destroy.call(this),this.currentTween=null}});a.register("tweenchain",function(c){return this.scene.sys.tweens.chain(c)}),o.register("tweenchain",function(c){return this.scene.sys.tweens.create(c)}),t.exports=l}),rw=S((e,t)=>{"use strict";var i=_s(),s=Ee(),n=cr(),r=qa(),o=Mt(),a=Ja(),h=$a(),l=function(c,f){if(f instanceof h)return f.parent=c,f;var u=new h(c);u.startDelay=o(f,"delay",0),u.completeDelay=s(f,"completeDelay",0),u.loop=Math.round(s(f,"loop",o(f,"repeat",0))),u.loopDelay=Math.round(s(f,"loopDelay",o(f,"repeatDelay",0))),u.paused=n(f,"paused",!1),u.persist=n(f,"persist",!1),u.callbackScope=o(f,"callbackScope",u);var p,d=i.TYPES;for(p=0;p<d.length;p++){var g=d[p],m=o(f,g,!1);if(m){var E=o(f,g+"Params",[]);u.setCallback(g,m,E)}}var v=o(f,"tweens",null);if(Array.isArray(v)){var y=[],T=r(f),A=void 0;for(T&&(A={targets:T}),p=0;p<v.length;p++)y.push(a(u,v[p],A));u.add(y)}return u};t.exports=l}),aw=S((e,t)=>{"use strict";var i=Pi(),s=V(),n=kh(),r=yc(),o=ae(),a=Nt(),h=Tc(),l=dr(),c=Ja(),f=$a(),u=rw(),p=new s({initialize:function(d){this.scene=d,this.events=d.sys.events,this.timeScale=1,this.paused=!1,this.processing=!1,this.tweens=[],this.time=0,this.startTime=0,this.nextTime=0,this.prevTime=0,this.maxLag=500,this.lagSkip=33,this.gap=1e3/240,this.events.once(a.BOOT,this.boot,this),this.events.on(a.START,this.start,this)},boot:function(){this.events.once(a.DESTROY,this.destroy,this)},start:function(){this.timeScale=1,this.paused=!1,this.startTime=Date.now(),this.prevTime=this.startTime,this.nextTime=this.gap,this.events.on(a.UPDATE,this.update,this),this.events.once(a.SHUTDOWN,this.shutdown,this)},create:function(d){Array.isArray(d)||(d=[d]);for(var g=[],m=0;m<d.length;m++){var E=d[m];E instanceof l||E instanceof f?g.push(E):Array.isArray(E.tweens)?g.push(u(this,E)):g.push(c(this,E))}return g.length===1?g[0]:g},add:function(d){var g=d,m=this.tweens;return g instanceof l||g instanceof f||(Array.isArray(g.tweens)?g=u(this,g):g=c(this,g)),m.push(g.reset()),g},addMultiple:function(d){for(var g,m=[],E=this.tweens,v=0;v<d.length;v++)g=d[v],g instanceof l||g instanceof f||(Array.isArray(g.tweens)?g=u(this,g):g=c(this,g)),E.push(g.reset()),m.push(g);return m},chain:function(d){var g=u(this,d);return this.tweens.push(g.init()),g},getChainedTweens:function(d){return d.getChainedTweens()},has:function(d){return this.tweens.indexOf(d)>-1},existing:function(d){return this.has(d)||this.tweens.push(d.reset()),this},addCounter:function(d){var g=r(this,d);return this.tweens.push(g.reset()),g},stagger:function(d,g){return h(d,g)},setLagSmooth:function(d,g){return d===void 0&&(d=1/1e-8),g===void 0&&(g=0),this.maxLag=d,this.lagSkip=Math.min(g,this.maxLag),this},setFps:function(d){return d===void 0&&(d=240),this.gap=1e3/d,this.nextTime=this.time*1e3+this.gap,this},getDelta:function(d){var g=Date.now()-this.prevTime;g>this.maxLag&&(this.startTime+=g-this.lagSkip),this.prevTime+=g;var m=this.prevTime-this.startTime,E=m-this.nextTime,v=m-this.time*1e3;return E>0||d?(m/=1e3,this.time=m,this.nextTime+=E+(E>=this.gap?4:this.gap-E)):v=0,v},tick:function(){return this.step(!0),this},update:function(){this.paused||this.step(!1)},step:function(d){d===void 0&&(d=!1);var g=this.getDelta(d);if(!(g<=0)){this.processing=!0;var m,E,v=[],y=this.tweens;for(m=0;m<y.length;m++)E=y[m],E.update(g)&&v.push(E);var T=v.length;if(T&&y.length>0){for(m=0;m<T;m++){E=v[m];var A=y.indexOf(E);A>-1&&(E.isPendingRemove()||E.isDestroyed())&&(y.splice(A,1),E.destroy())}v.length=0}this.processing=!1}},remove:function(d){return this.processing?d.setPendingRemoveState():(i(this.tweens,d),d.setRemovedState()),this},reset:function(d){return this.existing(d),d.seek(),d.setActiveState(),this},makeActive:function(d){return this.existing(d),d.setActiveState(),this},each:function(d,g){var m,E=[null];for(m=1;m<arguments.length;m++)E.push(arguments[m]);return this.tweens.forEach(function(v){E[0]=v,d.apply(g,E)}),this},getTweens:function(){return this.tweens.slice()},getTweensOf:function(d){var g=[],m=this.tweens;Array.isArray(d)?d=n(d):d=[d];for(var E=d.length,v=0;v<m.length;v++)for(var y=m[v],T=0;T<E;T++)!y.isDestroyed()&&y.hasTarget(d[T])&&g.push(y);return g},getGlobalTimeScale:function(){return this.timeScale},setGlobalTimeScale:function(d){return this.timeScale=d,this},isTweening:function(d){for(var g=this.tweens,m,E=0;E<g.length;E++)if(m=g[E],m.isPlaying()&&m.hasTarget(d))return!0;return!1},killAll:function(){for(var d=this.processing?this.getTweens():this.tweens,g=0;g<d.length;g++)d[g].destroy();return this.processing||(d.length=0),this},killTweensOf:function(d){for(var g=this.getTweensOf(d),m=0;m<g.length;m++)g[m].destroy();return this},pauseAll:function(){return this.paused=!0,this},resumeAll:function(){return this.paused=!1,this},shutdown:function(){this.killAll(),this.tweens=[],this.events.off(a.UPDATE,this.update,this),this.events.off(a.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(a.START,this.start,this),this.scene=null,this.events=null}});o.register("TweenManager",p,"tweens"),t.exports=p}),ow=S((e,t)=>{"use strict";var i={States:gn(),Builders:nw(),Events:Ue(),TweenManager:aw(),Tween:dr(),TweenData:vc(),TweenFrameData:Ec(),BaseTween:_s(),TweenChain:$a()};t.exports=i}),hw=S((e,t)=>{"use strict";t.exports="add"}),lw=S((e,t)=>{"use strict";t.exports="remove"}),uw=S((e,t)=>{"use strict";t.exports={ADD:hw(),REMOVE:lw()}}),cw=S((e,t)=>{"use strict";var i=V(),s=$n(),n=Wt(),r=uw(),o=new i({initialize:function(){this.entries=new s,this.events=new n},add:function(a,h){return this.entries.set(a,h),this.events.emit(r.ADD,this,a,h),this},has:function(a){return this.entries.has(a)},exists:function(a){return this.entries.has(a)},get:function(a){return this.entries.get(a)},remove:function(a){var h=this.get(a);return h&&(this.entries.delete(a),this.events.emit(r.REMOVE,this,a,h.data)),this},getKeys:function(){return this.entries.keys()},destroy:function(){this.entries.clear(),this.events.removeAllListeners(),this.entries=null,this.events=null}});t.exports=o}),dw=S((e,t)=>{"use strict";var i=cw(),s=V(),n=Ce(),r=new s({initialize:function(o){this.game=o,this.binary=new i,this.bitmapFont=new i,this.json=new i,this.physics=new i,this.shader=new i,this.audio=new i,this.video=new i,this.text=new i,this.html=new i,this.obj=new i,this.tilemap=new i,this.xml=new i,this.custom={},this.game.events.once(n.DESTROY,this.destroy,this)},addCustom:function(o){return this.custom.hasOwnProperty(o)||(this.custom[o]=new i),this.custom[o]},destroy:function(){for(var o=["binary","bitmapFont","json","physics","shader","audio","video","text","html","obj","tilemap","xml"],a=0;a<o.length;a++)this[o[a]].destroy(),this[o[a]]=null;for(var h in this.custom)this.custom[h].destroy();this.custom=null,this.game=null}});t.exports=r}),pw=S((e,t)=>{"use strict";var i=V(),s=Ke(),n=Ml(),r=Yn(),o=pt(),a=Mt(),h=oe(),l=Lt(),c=yt(),f=or(),u=Ea(),p=new i({initialize:function(d){d===void 0&&(d={});var g=["#ff0000","#ffff00","#00ff00","#00ffff","#000000"],m="#ffffff",E=a(d,"scale",null);this.width=a(E,"width",1024,d),this.height=a(E,"height",768,d),this.zoom=a(E,"zoom",1,d),this.parent=a(E,"parent",void 0,d),this.scaleMode=a(E,E?"mode":"scaleMode",0,d),this.expandParent=a(E,"expandParent",!0,d),this.autoRound=a(E,"autoRound",!1,d),this.autoCenter=a(E,"autoCenter",0,d),this.resizeInterval=a(E,"resizeInterval",500,d),this.fullscreenTarget=a(E,"fullscreenTarget",null,d),this.minWidth=a(E,"min.width",0,d),this.maxWidth=a(E,"max.width",0,d),this.minHeight=a(E,"min.height",0,d),this.maxHeight=a(E,"max.height",0,d),this.snapWidth=a(E,"snap.width",0,d),this.snapHeight=a(E,"snap.height",0,d),this.renderType=a(d,"type",s.AUTO),this.canvas=a(d,"canvas",null),this.context=a(d,"context",null),this.canvasStyle=a(d,"canvasStyle",null),this.customEnvironment=a(d,"customEnvironment",!1),this.sceneConfig=a(d,"scene",null),this.seed=a(d,"seed",[(Date.now()*Math.random()).toString()]),c.RND=new c.RandomDataGenerator(this.seed),this.gameTitle=a(d,"title",""),this.gameURL=a(d,"url","https://phaser.io/"+s.LOG_VERSION),this.gameVersion=a(d,"version",""),this.autoFocus=a(d,"autoFocus",!0),this.stableSort=a(d,"stableSort",-1),this.stableSort===-1&&(this.stableSort=r.browser.es2019?1:0),r.features.stableSort=this.stableSort,this.domCreateContainer=a(d,"dom.createContainer",!1),this.domPointerEvents=a(d,"dom.pointerEvents","none"),this.inputKeyboard=a(d,"input.keyboard",!0),this.inputKeyboardEventTarget=a(d,"input.keyboard.target",window),this.inputKeyboardCapture=a(d,"input.keyboard.capture",[]),this.inputMouse=a(d,"input.mouse",!0),this.inputMouseEventTarget=a(d,"input.mouse.target",null),this.inputMousePreventDefaultDown=a(d,"input.mouse.preventDefaultDown",!0),this.inputMousePreventDefaultUp=a(d,"input.mouse.preventDefaultUp",!0),this.inputMousePreventDefaultMove=a(d,"input.mouse.preventDefaultMove",!0),this.inputMousePreventDefaultWheel=a(d,"input.mouse.preventDefaultWheel",!0),this.inputTouch=a(d,"input.touch",r.input.touch),this.inputTouchEventTarget=a(d,"input.touch.target",null),this.inputTouchCapture=a(d,"input.touch.capture",!0),this.inputActivePointers=a(d,"input.activePointers",1),this.inputSmoothFactor=a(d,"input.smoothFactor",0),this.inputWindowEvents=a(d,"input.windowEvents",!0),this.inputGamepad=a(d,"input.gamepad",!1),this.inputGamepadEventTarget=a(d,"input.gamepad.target",window),this.disableContextMenu=a(d,"disableContextMenu",!1),this.audio=a(d,"audio",{}),this.hideBanner=a(d,"banner",null)===!1,this.hidePhaser=a(d,"banner.hidePhaser",!1),this.bannerTextColor=a(d,"banner.text",m),this.bannerBackgroundColor=a(d,"banner.background",g),this.gameTitle===""&&this.hidePhaser&&(this.hideBanner=!0),this.fps=a(d,"fps",null),this.disablePreFX=a(d,"disablePreFX",!1),this.disablePostFX=a(d,"disablePostFX",!1);var v=a(d,"render",null);this.pipeline=a(v,"pipeline",null,d),this.autoMobilePipeline=a(v,"autoMobilePipeline",!0,d),this.defaultPipeline=a(v,"defaultPipeline",f.MULTI_PIPELINE,d),this.antialias=a(v,"antialias",!0,d),this.antialiasGL=a(v,"antialiasGL",!0,d),this.mipmapFilter=a(v,"mipmapFilter","",d),this.desynchronized=a(v,"desynchronized",!1,d),this.roundPixels=a(v,"roundPixels",!1,d),this.pixelArt=a(v,"pixelArt",this.zoom!==1,d),this.pixelArt&&(this.antialias=!1,this.antialiasGL=!1,this.roundPixels=!0),this.transparent=a(v,"transparent",!1,d),this.clearBeforeRender=a(v,"clearBeforeRender",!0,d),this.preserveDrawingBuffer=a(v,"preserveDrawingBuffer",!1,d),this.premultipliedAlpha=a(v,"premultipliedAlpha",!0,d),this.failIfMajorPerformanceCaveat=a(v,"failIfMajorPerformanceCaveat",!1,d),this.powerPreference=a(v,"powerPreference","default",d),this.batchSize=a(v,"batchSize",4096,d),this.maxTextures=a(v,"maxTextures",-1,d),this.maxLights=a(v,"maxLights",10,d);var y=a(d,"backgroundColor",0);this.backgroundColor=u(y),this.transparent&&(this.backgroundColor=u(0),this.backgroundColor.alpha=0),this.preBoot=a(d,"callbacks.preBoot",l),this.postBoot=a(d,"callbacks.postBoot",l),this.physics=a(d,"physics",{}),this.defaultPhysicsSystem=a(this.physics,"default",!1),this.loaderBaseURL=a(d,"loader.baseURL",""),this.loaderPath=a(d,"loader.path",""),this.loaderMaxParallelDownloads=a(d,"loader.maxParallelDownloads",r.os.android?6:32),this.loaderCrossOrigin=a(d,"loader.crossOrigin",void 0),this.loaderResponseType=a(d,"loader.responseType",""),this.loaderAsync=a(d,"loader.async",!0),this.loaderUser=a(d,"loader.user",""),this.loaderPassword=a(d,"loader.password",""),this.loaderTimeout=a(d,"loader.timeout",0),this.loaderMaxRetries=a(d,"loader.maxRetries",2),this.loaderWithCredentials=a(d,"loader.withCredentials",!1),this.loaderImageLoadType=a(d,"loader.imageLoadType","XHR"),this.loaderLocalScheme=a(d,"loader.localScheme",["file://","capacitor://"]),this.glowFXQuality=a(d,"fx.glow.quality",.1),this.glowFXDistance=a(d,"fx.glow.distance",10),this.installGlobalPlugins=[],this.installScenePlugins=[];var T=a(d,"plugins",null),A=n.DefaultScene;T&&(Array.isArray(T)?this.defaultPlugins=T:h(T)&&(this.installGlobalPlugins=o(T,"global",[]),this.installScenePlugins=o(T,"scene",[]),Array.isArray(T.default)?A=T.default:Array.isArray(T.defaultMerge)&&(A=A.concat(T.defaultMerge)))),this.defaultPlugins=A;var x="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAg";this.defaultImage=a(d,"images.default",x+"AQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAABVJREFUeF7NwIEAAAAAgKD9qdeocAMAoAABm3DkcAAAAABJRU5ErkJggg=="),this.missingImage=a(d,"images.missing",x+"CAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg=="),this.whiteImage=a(d,"images.white","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAIAAAAmkwkpAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABdJREFUeNpi/P//PwMMMDEgAdwcgAADAJZuAwXJYZOzAAAAAElFTkSuQmCC"),window&&(window.FORCE_WEBGL?this.renderType=s.WEBGL:window.FORCE_CANVAS&&(this.renderType=s.CANVAS))}});t.exports=p}),gw=S((e,t)=>{"use strict";var i=Ga(),s=function(n){var r=n.config;if(!(!r.parent||!r.domCreateContainer)){var o=document.createElement("div");o.style.cssText=["display: block;","width: "+n.scale.width+"px;","height: "+n.scale.height+"px;","padding: 0; margin: 0;","position: absolute;","overflow: hidden;","pointer-events: "+r.domPointerEvents+";","transform: scale(1);","transform-origin: left top;"].join(" "),n.domContainer=o,i(o,r.parent)}};t.exports=s}),fw=S((e,t)=>{"use strict";var i=Ne(),s=Ke(),n=la(),r=function(o){var a=o.config;if((a.customEnvironment||a.canvas)&&a.renderType===s.AUTO)throw new Error("Must set explicit renderType in custom environment");if(!a.customEnvironment&&!a.canvas&&a.renderType!==s.HEADLESS)if(a.renderType===s.AUTO&&(a.renderType=n.webGL?s.WEBGL:s.CANVAS),a.renderType===s.WEBGL){if(!n.webGL)throw new Error("Cannot create WebGL context, aborting.")}else if(a.renderType===s.CANVAS){if(!n.canvas)throw new Error("Cannot create Canvas context, aborting.")}else throw new Error("Unknown value for renderer type: "+a.renderType);a.antialias||i.disableSmoothing();var h=o.scale.baseSize,l=h.width,c=h.height;if(a.canvas?(o.canvas=a.canvas,o.canvas.width=l,o.canvas.height=c):o.canvas=i.create(o,l,c,a.renderType),a.canvasStyle&&(o.canvas.style=a.canvasStyle),a.renderType!==s.HEADLESS){var f,u;u=pc(),a.renderType=s.WEBGL,o.renderer=new u(o)}};t.exports=r}),mw=S((e,t)=>{"use strict";var i=sn(),s=function(n){if(document.readyState==="complete"||document.readyState==="interactive"){n();return}var r=function(){document.removeEventListener("deviceready",r,!0),document.removeEventListener("DOMContentLoaded",r,!0),window.removeEventListener("load",r,!0),n()};document.body?i.cordova?document.addEventListener("deviceready",r,!1):(document.addEventListener("DOMContentLoaded",r,!0),window.addEventListener("load",r,!0)):window.setTimeout(r,20)};t.exports=s}),vw=S((e,t)=>{"use strict";var i=V(),s=Ce(),n=Wt(),r=Ge(),o=ve(),a=jt(),h=pt(),l=ae(),c=Pi(),f=Ke(),u=new i({Extends:n,initialize:function(p){n.call(this),this.game=p,this.plugins=[],this.scenePlugins=[],this._pendingGlobal=[],this._pendingScene=[],p.isBooted||p.config.renderType===f.HEADLESS?this.boot():p.events.once(s.BOOT,this.boot,this)},boot:function(){var p,d,g,m,E,v,y,T=this.game.config,A=T.installGlobalPlugins;for(A=A.concat(this._pendingGlobal),p=0;p<A.length;p++)d=A[p],g=h(d,"key",null),m=h(d,"plugin",null),E=h(d,"start",!1),v=h(d,"mapping",null),y=h(d,"data",null),g&&m&&this.install(g,m,E,v,y);for(A=T.installScenePlugins,A=A.concat(this._pendingScene),p=0;p<A.length;p++)d=A[p],g=h(d,"key",null),m=h(d,"plugin",null),v=h(d,"mapping",null),g&&m&&this.installScenePlugin(g,m,v);this._pendingGlobal=[],this._pendingScene=[],this.game.events.once(s.DESTROY,this.destroy,this)},addToScene:function(p,d,g){var m,E,v,y=this.game,T=p.scene,A=p.settings.map,x=p.settings.isBooted;for(m=0;m<d.length;m++)E=d[m],y[E]?(p[E]=y[E],A.hasOwnProperty(E)&&(T[A[E]]=p[E])):E==="game"&&A.hasOwnProperty(E)&&(T[A[E]]=y);for(var _=0;_<g.length;_++)for(v=g[_],m=0;m<v.length;m++)if(E=v[m],!!l.hasCore(E)){var b=l.getCore(E),M=b.mapping,w=new b.plugin(T,this,M);p[M]=w,b.custom?T[M]=w:A.hasOwnProperty(M)&&(T[A[M]]=w),x&&w.boot()}for(v=this.plugins,m=0;m<v.length;m++){var R=v[m];R.mapping&&(T[R.mapping]=R.plugin)}},getDefaultScenePlugins:function(){var p=this.game.config.defaultPlugins;return p=p.concat(this.scenePlugins),p},installScenePlugin:function(p,d,g,m,E){if(E===void 0&&(E=!1),typeof d=="function"){if(l.hasCore(p)||l.register(p,d,g,!0),this.scenePlugins.indexOf(p)===-1)this.scenePlugins.push(p);else if(!E&&l.hasCore(p))return;if(m){var v=new d(m,this,p);m.sys[p]=v,g&&g!==""&&(m[g]=v),v.boot()}}},install:function(p,d,g,m,E){if(g===void 0&&(g=!1),m===void 0&&(m=null),E===void 0&&(E=null),typeof d!="function"||l.hasCustom(p))return null;if(m!==null&&(g=!0),!this.game.isBooted)this._pendingGlobal.push({key:p,plugin:d,start:g,mapping:m,data:E});else if(l.registerCustom(p,d,m,E),g)return this.start(p);return null},getIndex:function(p){for(var d=this.plugins,g=0;g<d.length;g++){var m=d[g];if(m.key===p)return g}return-1},getEntry:function(p){var d=this.getIndex(p);if(d!==-1)return this.plugins[d]},isActive:function(p){var d=this.getEntry(p);return d&&d.active},start:function(p,d){d===void 0&&(d=p);var g=this.getEntry(d);return g&&!g.active?(g.active=!0,g.plugin.start()):g||(g=this.createEntry(p,d)),g?g.plugin:null},createEntry:function(p,d){var g=l.getCustom(p);if(g){var m=new g.plugin(this);g={key:d,plugin:m,active:!0,mapping:g.mapping,data:g.data},this.plugins.push(g),m.init(g.data),m.start()}return g},stop:function(p){var d=this.getEntry(p);return d&&d.active&&(d.active=!1,d.plugin.stop()),this},get:function(p,d){d===void 0&&(d=!0);var g=this.getEntry(p);if(g)return g.plugin;var m=this.getClass(p);return m&&d?(g=this.createEntry(p,p),g?g.plugin:null):m||null},getClass:function(p){return l.getCustomClass(p)},removeGlobalPlugin:function(p){var d=this.getEntry(p);d&&c(this.plugins,d),l.removeCustom(p)},removeScenePlugin:function(p){c(this.scenePlugins,p),l.remove(p)},registerGameObject:function(p,d,g){return d&&a.register(p,d),g&&o.register(p,g),this},removeGameObject:function(p,d,g){return d===void 0&&(d=!0),g===void 0&&(g=!0),d&&a.remove(p),g&&o.remove(p),this},registerFileType:function(p,d,g){r.register(p,d),g&&g.sys.load&&(g.sys.load[p]=d)},destroy:function(){for(var p=0;p<this.plugins.length;p++)this.plugins[p].plugin.destroy();l.destroyCustomPlugins(),this.game.noReturn&&l.destroyCorePlugins(),this.game=null,this.plugins=[],this.scenePlugins=[]}});t.exports=u}),Ew=S((e,t)=>{"use strict";t.exports={NO_CENTER:0,CENTER_BOTH:1,CENTER_HORIZONTALLY:2,CENTER_VERTICALLY:3}}),yw=S((e,t)=>{"use strict";t.exports={LANDSCAPE:"landscape-primary",LANDSCAPE_SECONDARY:"landscape-secondary",PORTRAIT:"portrait-primary",PORTRAIT_SECONDARY:"portrait-secondary"}}),Tw=S((e,t)=>{"use strict";t.exports={NONE:0,WIDTH_CONTROLS_HEIGHT:1,HEIGHT_CONTROLS_WIDTH:2,FIT:3,ENVELOP:4,RESIZE:5,EXPAND:6}}),Sw=S((e,t)=>{"use strict";t.exports={NO_ZOOM:1,ZOOM_2X:2,ZOOM_4X:4,MAX_ZOOM:-1}}),Sc=S((e,t)=>{"use strict";var i={CENTER:Ew(),ORIENTATION:yw(),SCALE_MODE:Tw(),ZOOM:Sw()};t.exports=i}),Aw=S((e,t)=>{"use strict";var i=function(s){if(!s)return window.innerHeight;var n=Math.abs(window.orientation),r={w:0,h:0},o=document.createElement("div");return o.setAttribute("style","position: fixed; height: 100vh; width: 0; top: 0"),document.documentElement.appendChild(o),r.w=n===90?o.offsetHeight:window.innerWidth,r.h=n===90?window.innerWidth:o.offsetHeight,document.documentElement.removeChild(o),o=null,Math.abs(window.orientation)!==90?r.h:r.w};t.exports=i}),xw=S((e,t)=>{"use strict";var i=function(s){var n;return s!==""&&(typeof s=="string"?n=document.getElementById(s):s&&s.nodeType===1&&(n=s)),n||(n=document.body),n};t.exports=i}),ww=S((e,t)=>{"use strict";var i=Sc(),s=function(n,r){var o=window.screen,a=o?o.orientation||o.mozOrientation||o.msOrientation:!1;if(a&&typeof a.type=="string")return a.type;if(typeof a=="string")return a;if(typeof window.orientation=="number")return window.orientation===0||window.orientation===180?i.ORIENTATION.PORTRAIT:i.ORIENTATION.LANDSCAPE;if(window.matchMedia){if(window.matchMedia("(orientation: portrait)").matches)return i.ORIENTATION.PORTRAIT;if(window.matchMedia("(orientation: landscape)").matches)return i.ORIENTATION.LANDSCAPE}else return r>n?i.ORIENTATION.PORTRAIT:i.ORIENTATION.LANDSCAPE};t.exports=s}),Ac=S((e,t)=>{"use strict";var i=function(s,n,r,o){return r===void 0&&(r=0),n===0?s:(s-=r,s=n*Math.floor(s/n),o?(r+s)/n:r+s)};t.exports=i}),Rw=S((e,t)=>{"use strict";var i=Xt(),s=V(),n=Ac(),r=Ot(),o=new s({initialize:function(a,h,l,c){a===void 0&&(a=0),h===void 0&&(h=a),l===void 0&&(l=0),c===void 0&&(c=null),this._width=a,this._height=h,this._parent=c,this.aspectMode=l,this.aspectRatio=h===0?1:a/h,this.minWidth=0,this.minHeight=0,this.maxWidth=Number.MAX_VALUE,this.maxHeight=Number.MAX_VALUE,this.snapTo=new r},setAspectMode:function(a){return a===void 0&&(a=0),this.aspectMode=a,this.setSize(this._width,this._height)},setSnap:function(a,h){return a===void 0&&(a=0),h===void 0&&(h=a),this.snapTo.set(a,h),this.setSize(this._width,this._height)},setParent:function(a){return this._parent=a,this.setSize(this._width,this._height)},setMin:function(a,h){return a===void 0&&(a=0),h===void 0&&(h=a),this.minWidth=i(a,0,this.maxWidth),this.minHeight=i(h,0,this.maxHeight),this.setSize(this._width,this._height)},setMax:function(a,h){return a===void 0&&(a=Number.MAX_VALUE),h===void 0&&(h=a),this.maxWidth=i(a,this.minWidth,Number.MAX_VALUE),this.maxHeight=i(h,this.minHeight,Number.MAX_VALUE),this.setSize(this._width,this._height)},setSize:function(a,h){switch(a===void 0&&(a=0),h===void 0&&(h=a),this.aspectMode){case o.NONE:this._width=this.getNewWidth(n(a,this.snapTo.x)),this._height=this.getNewHeight(n(h,this.snapTo.y)),this.aspectRatio=this._height===0?1:this._width/this._height;break;case o.WIDTH_CONTROLS_HEIGHT:this._width=this.getNewWidth(n(a,this.snapTo.x)),this._height=this.getNewHeight(this._width*(1/this.aspectRatio),!1);break;case o.HEIGHT_CONTROLS_WIDTH:this._height=this.getNewHeight(n(h,this.snapTo.y)),this._width=this.getNewWidth(this._height*this.aspectRatio,!1);break;case o.FIT:this.constrain(a,h,!0);break;case o.ENVELOP:this.constrain(a,h,!1);break}return this},setAspectRatio:function(a){return this.aspectRatio=a,this.setSize(this._width,this._height)},resize:function(a,h){return this._width=this.getNewWidth(n(a,this.snapTo.x)),this._height=this.getNewHeight(n(h,this.snapTo.y)),this.aspectRatio=this._height===0?1:this._width/this._height,this},getNewWidth:function(a,h){return h===void 0&&(h=!0),a=i(a,this.minWidth,this.maxWidth),h&&this._parent&&a>this._parent.width&&(a=Math.max(this.minWidth,this._parent.width)),a},getNewHeight:function(a,h){return h===void 0&&(h=!0),a=i(a,this.minHeight,this.maxHeight),h&&this._parent&&a>this._parent.height&&(a=Math.max(this.minHeight,this._parent.height)),a},constrain:function(a,h,l){a===void 0&&(a=0),h===void 0&&(h=a),l===void 0&&(l=!0),a=this.getNewWidth(a),h=this.getNewHeight(h);var c=this.snapTo,f=h===0?1:a/h;return l&&this.aspectRatio>f||!l&&this.aspectRatio<f?(a=n(a,c.x),h=a/this.aspectRatio,c.y>0&&(h=n(h,c.y),a=h*this.aspectRatio)):(l&&this.aspectRatio<f||!l&&this.aspectRatio>f)&&(h=n(h,c.y),a=h*this.aspectRatio,c.x>0&&(a=n(a,c.x),h=a*(1/this.aspectRatio))),this._width=a,this._height=h,this},fitTo:function(a,h){return this.constrain(a,h,!0)},envelop:function(a,h){return this.constrain(a,h,!1)},setWidth:function(a){return this.setSize(a,this._height)},setHeight:function(a){return this.setSize(this._width,a)},toString:function(){return"[{ Size (width="+this._width+" height="+this._height+" aspectRatio="+this.aspectRatio+" aspectMode="+this.aspectMode+") }]"},setCSS:function(a){a&&a.style&&(a.style.width=this._width+"px",a.style.height=this._height+"px")},copy:function(a){return a.setAspectMode(this.aspectMode),a.aspectRatio=this.aspectRatio,a.setSize(this.width,this.height)},destroy:function(){this._parent=null,this.snapTo=null},width:{get:function(){return this._width},set:function(a){this.setSize(a,this._height)}},height:{get:function(){return this._height},set:function(a){this.setSize(this._width,a)}}});o.NONE=0,o.WIDTH_CONTROLS_HEIGHT=1,o.HEIGHT_CONTROLS_WIDTH=2,o.FIT=3,o.ENVELOP=4,t.exports=o}),Cw=S((e,t)=>{"use strict";var i=Sc(),s=V(),n=Wt(),r=Sa(),o=Ce(),a=Aw(),h=xw(),l=ww(),c=Lt(),f=zt(),u=Rw(),p=Ac(),d=Ot(),g=Xn(),m=new s({Extends:n,initialize:function(E){n.call(this),this.game=E,this.canvas,this.canvasBounds=new f,this.parent=null,this.parentIsWindow=!1,this.parentSize=new u,this.gameSize=new u,this.baseSize=new u,this.displaySize=new u,this.scaleMode=i.SCALE_MODE.NONE,this.zoom=1,this._resetZoom=!1,this.displayScale=new d(1,1),this.autoRound=!1,this.autoCenter=i.CENTER.NO_CENTER,this.orientation=i.ORIENTATION.LANDSCAPE,this.fullscreen,this.fullscreenTarget=null,this._createdFullscreenTarget=!1,this.dirty=!1,this.resizeInterval=500,this._lastCheck=0,this._checkOrientation=!1,this.domlisteners={orientationChange:c,windowResize:c,fullScreenChange:c,fullScreenError:c}},preBoot:function(){this.parseConfig(this.game.config),this.game.events.once(o.BOOT,this.boot,this)},boot:function(){var E=this.game;this.canvas=E.canvas,this.fullscreen=E.device.fullscreen;var v=this.scaleMode;v!==i.SCALE_MODE.RESIZE&&v!==i.SCALE_MODE.EXPAND&&this.displaySize.setAspectMode(v),v===i.SCALE_MODE.NONE?this.resize(this.width,this.height):(this.getParentBounds(),this.parentSize.width>0&&this.parentSize.height>0&&this.displaySize.setParent(this.parentSize),this.refresh()),E.events.on(o.PRE_STEP,this.step,this),E.events.once(o.READY,this.refresh,this),E.events.once(o.DESTROY,this.destroy,this),this.startListeners()},parseConfig:function(E){this.getParent(E),this.getParentBounds();var v=E.width,y=E.height,T=E.scaleMode,A=E.zoom,x=E.autoRound;if(typeof v=="string")if(v.substr(-1)!=="%")v=parseInt(v,10);else{var _=this.parentSize.width;_===0&&(_=window.innerWidth);var b=parseInt(v,10)/100;v=Math.floor(_*b)}if(typeof y=="string")if(y.substr(-1)!=="%")y=parseInt(y,10);else{var M=this.parentSize.height;M===0&&(M=window.innerHeight);var w=parseInt(y,10)/100;y=Math.floor(M*w)}this.scaleMode=T,this.autoRound=x,this.autoCenter=E.autoCenter,this.resizeInterval=E.resizeInterval,x&&(v=Math.floor(v),y=Math.floor(y)),this.gameSize.setSize(v,y),A===i.ZOOM.MAX_ZOOM&&(A=this.getMaxZoom()),this.zoom=A,A!==1&&(this._resetZoom=!0),this.baseSize.setSize(v,y),x&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),E.minWidth>0&&this.displaySize.setMin(E.minWidth*A,E.minHeight*A),E.maxWidth>0&&this.displaySize.setMax(E.maxWidth*A,E.maxHeight*A),this.displaySize.setSize(v,y),(E.snapWidth>0||E.snapHeight>0)&&this.displaySize.setSnap(E.snapWidth,E.snapHeight),this.orientation=l(v,y)},getParent:function(E){var v=E.parent;if(v!==null){if(this.parent=h(v),this.parentIsWindow=this.parent===document.body,E.expandParent&&E.scaleMode!==i.SCALE_MODE.NONE){var y=this.parent.getBoundingClientRect();(this.parentIsWindow||y.height===0)&&(document.documentElement.style.height="100%",document.body.style.height="100%",y=this.parent.getBoundingClientRect(),!this.parentIsWindow&&y.height===0&&(this.parent.style.overflow="hidden",this.parent.style.width="100%",this.parent.style.height="100%"))}E.fullscreenTarget&&!this.fullscreenTarget&&(this.fullscreenTarget=h(E.fullscreenTarget))}},getParentBounds:function(){if(!this.parent)return!1;var E=this.parentSize,v=this.parent.getBoundingClientRect(),y=v.width,T=v.height;if(E.width!==y||E.height!==T)return E.setSize(y,T),!0;if(this.canvas){var A=this.canvasBounds,x=this.canvas.getBoundingClientRect();if(x.x!==A.x||x.y!==A.y)return!0}return!1},lockOrientation:function(E){var v=screen.lockOrientation||screen.mozLockOrientation||screen.msLockOrientation;return v?v.call(screen,E):!1},setParentSize:function(E,v){return this.parentSize.setSize(E,v),this.refresh()},setGameSize:function(E,v){var y=this.autoRound;y&&(E=Math.floor(E),v=Math.floor(v));var T=this.width,A=this.height;return this.gameSize.resize(E,v),this.baseSize.resize(E,v),y&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),this.displaySize.setAspectRatio(E/v),this.canvas.width=this.baseSize.width,this.canvas.height=this.baseSize.height,this.refresh(T,A)},resize:function(E,v){var y=this.zoom,T=this.autoRound;T&&(E=Math.floor(E),v=Math.floor(v));var A=this.width,x=this.height;this.gameSize.resize(E,v),this.baseSize.resize(E,v),T&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),this.displaySize.setSize(E*y,v*y),this.canvas.width=this.baseSize.width,this.canvas.height=this.baseSize.height;var _=this.canvas.style,b=E*y,M=v*y;return T&&(b=Math.floor(b),M=Math.floor(M)),(b!==E||M!==v)&&(_.width=b+"px",_.height=M+"px"),this.refresh(A,x)},setZoom:function(E){return this.zoom=E,this._resetZoom=!0,this.refresh()},setMaxZoom:function(){return this.zoom=this.getMaxZoom(),this._resetZoom=!0,this.refresh()},setSnap:function(E,v){return E===void 0&&(E=0),v===void 0&&(v=E),this.displaySize.setSnap(E,v),this.refresh()},refresh:function(E,v){E===void 0&&(E=this.width),v===void 0&&(v=this.height),this.updateScale(),this.updateBounds(),this.updateOrientation(),this.displayScale.set(this.baseSize.width/this.canvasBounds.width,this.baseSize.height/this.canvasBounds.height);var y=this.game.domContainer;if(y){this.baseSize.setCSS(y);var T=this.canvas.style,A=y.style;A.transform="scale("+this.displaySize.width/this.baseSize.width+","+this.displaySize.height/this.baseSize.height+")",A.marginLeft=T.marginLeft,A.marginTop=T.marginTop}return this.emit(r.RESIZE,this.gameSize,this.baseSize,this.displaySize,E,v),this},updateOrientation:function(){if(this._checkOrientation){this._checkOrientation=!1;var E=l(this.width,this.height);E!==this.orientation&&(this.orientation=E,this.emit(r.ORIENTATION_CHANGE,E))}},updateScale:function(){var E=this.canvas.style,v=this.gameSize.width,y=this.gameSize.height,T,A,x=this.zoom,_=this.autoRound;if(this.scaleMode===i.SCALE_MODE.NONE)this.displaySize.setSize(v*x,y*x),T=this.displaySize.width,A=this.displaySize.height,_&&(T=Math.floor(T),A=Math.floor(A)),this._resetZoom&&(E.width=T+"px",E.height=A+"px",this._resetZoom=!1);else if(this.scaleMode===i.SCALE_MODE.RESIZE)this.displaySize.setSize(this.parentSize.width,this.parentSize.height),this.gameSize.setSize(this.displaySize.width,this.displaySize.height),this.baseSize.setSize(this.displaySize.width,this.displaySize.height),T=this.displaySize.width,A=this.displaySize.height,_&&(T=Math.floor(T),A=Math.floor(A)),this.canvas.width=T,this.canvas.height=A;else if(this.scaleMode===i.SCALE_MODE.EXPAND){var b=this.game.config.width,M=this.game.config.height;this.displaySize.setSize(this.parentSize.width,this.parentSize.height),T=this.displaySize.width,A=this.displaySize.height,_&&(T=Math.floor(T),A=Math.floor(A)),E.width=T+"px",E.height=A+"px";var w=this.parentSize.width/b,R=this.parentSize.height/M;w<R&&w!==0?this.baseSize.setSize(b,this.parentSize.height/w):R!==0&&this.baseSize.setSize(this.displaySize.width/R,M),this.gameSize.setSize(this.baseSize.width,this.baseSize.height),T=this.baseSize.width,A=this.baseSize.height,_&&(T=Math.floor(T),A=Math.floor(A)),this.canvas.width=T,this.canvas.height=A}else this.displaySize.setSize(this.parentSize.width,this.parentSize.height),T=this.displaySize.width,A=this.displaySize.height,_&&(T=Math.floor(T),A=Math.floor(A)),E.width=T+"px",E.height=A+"px";this.getParentBounds(),this.updateCenter()},getMaxZoom:function(){var E=p(this.parentSize.width,this.gameSize.width,0,!0),v=p(this.parentSize.height,this.gameSize.height,0,!0);return Math.max(Math.min(E,v),1)},updateCenter:function(){var E=this.autoCenter;if(E!==i.CENTER.NO_CENTER){var v=this.canvas,y=v.style,T=v.getBoundingClientRect(),A=T.width,x=T.height,_=Math.floor((this.parentSize.width-A)/2),b=Math.floor((this.parentSize.height-x)/2);E===i.CENTER.CENTER_HORIZONTALLY?b=0:E===i.CENTER.CENTER_VERTICALLY&&(_=0),y.marginLeft=_+"px",y.marginTop=b+"px"}},updateBounds:function(){var E=this.canvasBounds,v=this.canvas.getBoundingClientRect();E.x=v.left+(window.pageXOffset||0)-(document.documentElement.clientLeft||0),E.y=v.top+(window.pageYOffset||0)-(document.documentElement.clientTop||0),E.width=v.width,E.height=v.height},transformX:function(E){return(E-this.canvasBounds.left)*this.displayScale.x},transformY:function(E){return(E-this.canvasBounds.top)*this.displayScale.y},startFullscreen:function(E){E===void 0&&(E={navigationUI:"hide"});var v=this.fullscreen;if(!v.available){this.emit(r.FULLSCREEN_UNSUPPORTED);return}if(!v.active){var y=this.getFullscreenTarget();v.keyboard?y[v.request](Element.ALLOW_KEYBOARD_INPUT):y[v.request](E)}},fullscreenSuccessHandler:function(){this.getParentBounds(),this.refresh(),this.emit(r.ENTER_FULLSCREEN)},fullscreenErrorHandler:function(E){this.removeFullscreenTarget(),this.emit(r.FULLSCREEN_FAILED,E)},getFullscreenTarget:function(){if(!this.fullscreenTarget){var E=document.createElement("div");E.style.margin="0",E.style.padding="0",E.style.width="100%",E.style.height="100%",this.fullscreenTarget=E,this._createdFullscreenTarget=!0}if(this._createdFullscreenTarget){var v=this.canvas.parentNode;v.insertBefore(this.fullscreenTarget,this.canvas),this.fullscreenTarget.appendChild(this.canvas)}return this.fullscreenTarget},removeFullscreenTarget:function(){if(this._createdFullscreenTarget){var E=this.fullscreenTarget;if(E&&E.parentNode){var v=E.parentNode;v.insertBefore(this.canvas,E),v.removeChild(E)}}},stopFullscreen:function(){var E=this.fullscreen;if(!E.available)return this.emit(r.FULLSCREEN_UNSUPPORTED),!1;E.active&&document[E.cancel](),this.removeFullscreenTarget()},leaveFullScreenSuccessHandler:function(){this.getParentBounds(),this.emit(r.LEAVE_FULLSCREEN),this.refresh()},toggleFullscreen:function(E){this.fullscreen.active?this.stopFullscreen():this.startFullscreen(E)},startListeners:function(){var E=this,v=this.domlisteners;if(v.orientationChange=function(){E.updateBounds(),E._checkOrientation=!0,E.dirty=!0,E.refresh()},v.windowResize=function(){E.updateBounds(),E.dirty=!0},screen.orientation&&screen.orientation.addEventListener?screen.orientation.addEventListener("change",v.orientationChange,!1):window.addEventListener("orientationchange",v.orientationChange,!1),window.addEventListener("resize",v.windowResize,!1),this.fullscreen.available){v.fullScreenChange=function(T){return E.onFullScreenChange(T)},v.fullScreenError=function(T){return E.onFullScreenError(T)};var y=["webkit","moz",""];y.forEach(function(T){document.addEventListener(T+"fullscreenchange",v.fullScreenChange,!1),document.addEventListener(T+"fullscreenerror",v.fullScreenError,!1)}),document.addEventListener("MSFullscreenChange",v.fullScreenChange,!1),document.addEventListener("MSFullscreenError",v.fullScreenError,!1)}},onFullScreenChange:function(){document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement||document.mozFullScreenElement?this.fullscreenSuccessHandler():(this.stopFullscreen(),this.leaveFullScreenSuccessHandler())},onFullScreenError:function(){this.removeFullscreenTarget()},getViewPort:function(E,v){E instanceof g||(v=E,E=void 0),v===void 0&&(v=new f);var y=this.baseSize,T=this.parentSize,A=this.canvasBounds,x=this.displayScale,_=A.x>=0?0:-(A.x*x.x),b=A.y>=0?0:-(A.y*x.y),M;T.width>=A.width?M=y.width:M=y.width-(A.width-T.width)*x.x;var w;return T.height>=A.height?w=y.height:w=y.height-(A.height-T.height)*x.y,v.setTo(_,b,M,w),E&&(v.width/=E.zoomX,v.height/=E.zoomY,v.centerX=E.centerX+E.scrollX,v.centerY=E.centerY+E.scrollY),v},step:function(E,v){this.parent&&(this._lastCheck+=v,(this.dirty||this._lastCheck>this.resizeInterval)&&(this.getParentBounds()&&this.refresh(),this.dirty=!1,this._lastCheck=0))},stopListeners:function(){var E=this.domlisteners;screen.orientation&&screen.orientation.addEventListener?screen.orientation.removeEventListener("change",E.orientationChange,!1):window.removeEventListener("orientationchange",E.orientationChange,!1),window.removeEventListener("resize",E.windowResize,!1);var v=["webkit","moz",""];v.forEach(function(y){document.removeEventListener(y+"fullscreenchange",E.fullScreenChange,!1),document.removeEventListener(y+"fullscreenerror",E.fullScreenError,!1)}),document.removeEventListener("MSFullscreenChange",E.fullScreenChange,!1),document.removeEventListener("MSFullscreenError",E.fullScreenError,!1)},destroy:function(){this.removeAllListeners(),this.stopListeners(),this.game=null,this.canvas=null,this.canvasBounds=null,this.parent=null,this.fullscreenTarget=null,this.parentSize.destroy(),this.gameSize.destroy(),this.baseSize.destroy(),this.displaySize.destroy()},isFullscreen:{get:function(){return this.fullscreen.active}},width:{get:function(){return this.gameSize.width}},height:{get:function(){return this.gameSize.height}},isPortrait:{get:function(){return this.orientation===i.ORIENTATION.PORTRAIT}},isLandscape:{get:function(){return this.orientation===i.ORIENTATION.LANDSCAPE}},isGamePortrait:{get:function(){return this.height>this.width}},isGameLandscape:{get:function(){return this.width>this.height}}});t.exports=m}),_w=S((e,t)=>{"use strict";var i=Ne(),s=V(),n=ur(),r=Yh(),o=ja(),a=new s({initialize:function(h,l,c,f,u){u===void 0&&(u=!1);var p=h.manager.game;this.renderer=p.renderer,this.texture=h,this.source=l,this.image=l.compressed?null:l,this.compressionAlgorithm=l.compressed?l.format:null,this.resolution=1,this.width=c||l.naturalWidth||l.videoWidth||l.width||0,this.height=f||l.naturalHeight||l.videoHeight||l.height||0,this.scaleMode=r.DEFAULT,this.isCanvas=l instanceof HTMLCanvasElement,this.isVideo=window.hasOwnProperty("HTMLVideoElement")&&l instanceof HTMLVideoElement,this.isRenderTexture=l.type==="RenderTexture"||l.type==="DynamicTexture",this.isGLTexture=l instanceof o,this.isPowerOf2=n(this.width,this.height),this.glTexture=null,this.flipY=u,this.init(p)},init:function(h){var l=this.renderer;if(l){var c=this.source;if(l.gl){var f=this.image,u=this.flipY,p=this.width,d=this.height,g=this.scaleMode;this.isCanvas?this.glTexture=l.createCanvasTexture(f,!1,u):this.isVideo?this.glTexture=l.createVideoTexture(f,!1,u):this.isRenderTexture?this.glTexture=l.createTextureFromSource(null,p,d,g):this.isGLTexture?this.glTexture=c:this.compressionAlgorithm?this.glTexture=l.createTextureFromSource(c,void 0,void 0,g):c instanceof Uint8Array?this.glTexture=l.createUint8ArrayTexture(c,p,d,g):this.glTexture=l.createTextureFromSource(f,p,d,g)}else this.isRenderTexture&&(this.image=c.canvas)}h.config.antialias||this.setFilter(1)},setFilter:function(h){this.renderer&&this.renderer.gl&&this.renderer.setTextureFilter(this.glTexture,h),this.scaleMode=h},setFlipY:function(h){return h===void 0&&(h=!0),h===this.flipY?this:(this.flipY=h,this.update(),this)},update:function(){var h=this.renderer,l=this.image,c=this.flipY,f=h.gl;f&&this.isCanvas?h.updateCanvasTexture(l,this.glTexture,c):f&&this.isVideo&&h.updateVideoTexture(l,this.glTexture,c)},destroy:function(){this.glTexture&&this.renderer.deleteTexture(this.glTexture),this.isCanvas&&i.remove(this.image),this.renderer=null,this.texture=null,this.source=null,this.image=null,this.glTexture=null}});t.exports=a}),to=S((e,t)=>{"use strict";var i=V(),s=nn(),n=_w(),r=new i({initialize:function(o,a,h,l,c){Array.isArray(h)||(h=[h]),this.manager=o,this.key=a,this.source=[],this.dataSource=[],this.frames={},this.customData={},this.firstFrame="__BASE",this.frameTotal=0;for(var f=0;f<h.length;f++)this.source.push(new n(this,h[f],l,c))},add:function(o,a,h,l,c,f){if(this.has(o))return null;var u=new s(this,o,a,h,l,c,f);return this.frames[o]=u,this.firstFrame==="__BASE"&&(this.firstFrame=o),this.frameTotal++,u},remove:function(o){if(this.has(o)){var a=this.get(o);return a.destroy(),delete this.frames[o],!0}return!1},has:function(o){return this.frames.hasOwnProperty(o)},get:function(o){o||(o=this.firstFrame);var a=this.frames[o];return a||(a=this.frames[this.firstFrame]),a},getTextureSourceIndex:function(o){for(var a=0;a<this.source.length;a++)if(this.source[a]===o)return a;return-1},getFramesFromTextureSource:function(o,a){a===void 0&&(a=!1);var h=[];for(var l in this.frames)if(!(l==="__BASE"&&!a)){var c=this.frames[l];c.sourceIndex===o&&h.push(c)}return h},getFrameBounds:function(o){o===void 0&&(o=0);for(var a=this.getFramesFromTextureSource(o,!0),h=a[0],l=h.cutX,c=h.cutY,f=h.cutX+h.cutWidth,u=h.cutY+h.cutHeight,p=1;p<a.length;p++){var d=a[p];d.cutX<l&&(l=d.cutX),d.cutY<c&&(c=d.cutY),d.cutX+d.cutWidth>f&&(f=d.cutX+d.cutWidth),d.cutY+d.cutHeight>u&&(u=d.cutY+d.cutHeight)}return{x:l,y:c,width:f-l,height:u-c}},getFrameNames:function(o){o===void 0&&(o=!1);var a=Object.keys(this.frames);if(!o){var h=a.indexOf("__BASE");h!==-1&&a.splice(h,1)}return a},getSourceImage:function(o){(o==null||this.frameTotal===1)&&(o="__BASE");var a=this.frames[o];return a?a.source.image:this.frames.__BASE.source.image},getDataSourceImage:function(o){(o==null||this.frameTotal===1)&&(o="__BASE");var a=this.frames[o],h;return a?h=a.sourceIndex:h=this.frames.__BASE.sourceIndex,this.dataSource[h].image},setDataSource:function(o){Array.isArray(o)||(o=[o]);for(var a=0;a<o.length;a++){var h=this.source[a];this.dataSource.push(new n(this,o[a],h.width,h.height))}},setFilter:function(o){var a;for(a=0;a<this.source.length;a++)this.source[a].setFilter(o);for(a=0;a<this.dataSource.length;a++)this.dataSource[a].setFilter(o)},destroy:function(){var o,a=this.source,h=this.dataSource;for(o=0;o<a.length;o++)a[o]&&a[o].destroy();for(o=0;o<h.length;o++)h[o]&&h[o].destroy();for(var l in this.frames){var c=this.frames[l];c&&c.destroy()}this.source=[],this.dataSource=[],this.frames={},this.manager.removeKey(this.key),this.manager=null}});t.exports=r}),bw=S((e,t)=>{"use strict";var i=V(),s=Xt(),n=Ze(),r=Ke(),o=ur(),a=to(),h=new i({Extends:a,initialize:function(l,c,f,u,p){a.call(this,l,c,f,u,p),this.add("__BASE",0,0,0,u,p),this._source=this.frames.__BASE.source,this.canvas=this._source.image,this.context=this.canvas.getContext("2d",{willReadFrequently:!0}),this.width=u,this.height=p,this.imageData=this.context.getImageData(0,0,u,p),this.data=null,this.imageData&&(this.data=this.imageData.data),this.pixels=null,this.buffer,this.data&&(this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data)},update:function(){return this.imageData=this.context.getImageData(0,0,this.width,this.height),this.data=this.imageData.data,this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data,this.manager.game.config.renderType===r.WEBGL&&this.refresh(),this},draw:function(l,c,f,u){return u===void 0&&(u=!0),this.context.drawImage(f,l,c),u&&this.update(),this},drawFrame:function(l,c,f,u,p){f===void 0&&(f=0),u===void 0&&(u=0),p===void 0&&(p=!0);var d=this.manager.getFrame(l,c);if(d){var g=d.canvasData,m=d.cutWidth,E=d.cutHeight,v=d.source.resolution;this.context.drawImage(d.source.image,g.x,g.y,m,E,f,u,m/v,E/v),p&&this.update()}return this},setPixel:function(l,c,f,u,p,d){d===void 0&&(d=255),l=Math.abs(Math.floor(l)),c=Math.abs(Math.floor(c));var g=this.getIndex(l,c);if(g>-1){var m=this.context.getImageData(l,c,1,1);m.data[0]=f,m.data[1]=u,m.data[2]=p,m.data[3]=d,this.context.putImageData(m,l,c)}return this},putData:function(l,c,f,u,p,d,g){return u===void 0&&(u=0),p===void 0&&(p=0),d===void 0&&(d=l.width),g===void 0&&(g=l.height),this.context.putImageData(l,c,f,u,p,d,g),this},getData:function(l,c,f,u){l=s(Math.floor(l),0,this.width-1),c=s(Math.floor(c),0,this.height-1),f=s(f,1,this.width-l),u=s(u,1,this.height-c);var p=this.context.getImageData(l,c,f,u);return p},getPixel:function(l,c,f){f||(f=new n);var u=this.getIndex(l,c);if(u>-1){var p=this.data,d=p[u+0],g=p[u+1],m=p[u+2],E=p[u+3];f.setTo(d,g,m,E)}return f},getPixels:function(l,c,f,u){l===void 0&&(l=0),c===void 0&&(c=0),f===void 0&&(f=this.width),u===void 0&&(u=f),l=Math.abs(Math.round(l)),c=Math.abs(Math.round(c));for(var p=s(l,0,this.width),d=s(l+f,0,this.width),g=s(c,0,this.height),m=s(c+u,0,this.height),E=new n,v=[],y=g;y<m;y++){for(var T=[],A=p;A<d;A++)E=this.getPixel(A,y,E),T.push({x:A,y,color:E.color,alpha:E.alphaGL});v.push(T)}return v},getIndex:function(l,c){return l=Math.abs(Math.round(l)),c=Math.abs(Math.round(c)),l<this.width&&c<this.height?(l+c*this.width)*4:-1},refresh:function(){return this._source.update(),this},getCanvas:function(){return this.canvas},getContext:function(){return this.context},clear:function(l,c,f,u,p){return l===void 0&&(l=0),c===void 0&&(c=0),f===void 0&&(f=this.width),u===void 0&&(u=this.height),p===void 0&&(p=!0),this.context.clearRect(l,c,f,u),p&&this.update(),this},setSize:function(l,c){return c===void 0&&(c=l),(l!==this.width||c!==this.height)&&(this.canvas.width=l,this.canvas.height=c,this._source.width=l,this._source.height=c,this._source.isPowerOf2=o(l,c),this.frames.__BASE.setSize(l,c,0,0),this.width=l,this.height=c,this.refresh()),this},destroy:function(){a.prototype.destroy.call(this),this._source=null,this.canvas=null,this.context=null,this.imageData=null,this.data=null,this.pixels=null,this.buffer=null}});t.exports=h}),Pw=S((e,t)=>{"use strict";var i=ms(),s=Xn(),n=Ne(),r=V(),o=Ke(),a=nn(),h=pt(),l=or(),c=hr(),f=to(),u=_e(),p=new r({Extends:f,initialize:function(d,g,m,E,v){m===void 0&&(m=256),E===void 0&&(E=256),v===void 0&&(v=!0),this.type="DynamicTexture";var y=d.game.renderer,T=y&&y.type===o.CANVAS,A=T?n.create2D(this,m,E):[this];f.call(this,d,g,A,m,E),this.add("__BASE",0,0,0,m,E),this.renderer=y,this.width=-1,this.height=-1,this.isDrawing=!1,this.canvas=T?A:null,this.context=T?A.getContext("2d",{willReadFrequently:!0}):null,this.dirty=!1,this.isSpriteTexture=!0,this._eraseMode=!1,this.camera=new s(0,0,m,E).setScene(d.game.scene.systemScene,!1),this.renderTarget=T?null:new c(y,m,E,1,0,!1,!1,!0,!1),this.pipeline=T?null:y.pipelines.get(l.SINGLE_PIPELINE),this.setSize(m,E,v)},setSize:function(d,g,m){g===void 0&&(g=d),m===void 0&&(m=!0),m&&(d=Math.floor(d),g=Math.floor(g),d%2!==0&&d++,g%2!==0&&g++);var E=this.get(),v=E.source;if(d!==this.width||g!==this.height){this.canvas&&(this.canvas.width=d,this.canvas.height=g);var y=this.renderTarget;y&&(y.willResize(d,g)&&y.resize(d,g),y.texture!==v.glTexture&&this.renderer.deleteTexture(v.glTexture),this.setFromRenderTarget()),this.camera.setSize(d,g),v.width=d,v.height=g,E.setSize(d,g),this.width=d,this.height=g}else{var T=this.getSourceImage();E.cutX+d>T.width&&(d=T.width-E.cutX),E.cutY+g>T.height&&(g=T.height-E.cutY),E.setSize(d,g,E.cutX,E.cutY)}return this},setFromRenderTarget:function(){var d=this.get(),g=d.source,m=this.renderTarget;return g.isRenderTexture=!0,g.isGLTexture=!0,g.glTexture=m.texture,this},setIsSpriteTexture:function(d){return this.isSpriteTexture=d,this},fill:function(d,g,m,E,v,y){var T=this.camera,A=this.renderer;g===void 0&&(g=1),m===void 0&&(m=0),E===void 0&&(E=0),v===void 0&&(v=this.width),y===void 0&&(y=this.height);var x=d>>16&255,_=d>>8&255,b=d&255,M=this.renderTarget;if(T.preRender(),M){M.bind(!0);var w=this.pipeline.manager.set(this.pipeline),R=A.width/M.width,I=A.height/M.height,O=M.height-(E+y);w.drawFillRect(m*R,O*I,v*R,y*I,u.getTintFromFloats(b/255,_/255,x/255,1),g),M.unbind(!0)}else{var D=this.context;A.setContext(D),D.globalCompositeOperation="source-over",D.fillStyle="rgba("+x+","+_+","+b+","+g+")",D.fillRect(m,E,v,y),A.setContext()}return this.dirty=!0,this},clear:function(d,g,m,E){if(this.dirty){var v=this.context,y=this.renderTarget;y?y.clear(d,g,m,E):v&&(d!==void 0&&g!==void 0&&m!==void 0&&E!==void 0?v.clearRect(d,g,m,E):(v.save(),v.setTransform(1,0,0,1,0,0),v.clearRect(0,0,this.width,this.height),v.restore())),this.dirty=!1}return this},stamp:function(d,g,m,E,v){m===void 0&&(m=0),E===void 0&&(E=0);var y=h(v,"alpha",1),T=h(v,"tint",16777215),A=h(v,"angle",0),x=h(v,"rotation",0),_=h(v,"scale",1),b=h(v,"scaleX",_),M=h(v,"scaleY",_),w=h(v,"originX",.5),R=h(v,"originY",.5),I=h(v,"blendMode",0),O=h(v,"erase",!1),D=h(v,"skipBatch",!1),N=this.manager.resetStamp(y,T);return N.setAngle(0),A!==0?N.setAngle(A):x!==0&&N.setRotation(x),N.setScale(b,M),N.setTexture(d,g),N.setOrigin(w,R),N.setBlendMode(I),O&&(this._eraseMode=!0),D?this.batchGameObject(N,m,E):this.draw(N,m,E),O&&(this._eraseMode=!1),this},erase:function(d,g,m){return this._eraseMode=!0,this.draw(d,g,m),this._eraseMode=!1,this},draw:function(d,g,m,E,v){return this.beginDraw(),this.batchDraw(d,g,m,E,v),this.endDraw(),this},drawFrame:function(d,g,m,E,v,y){return this.beginDraw(),this.batchDrawFrame(d,g,m,E,v,y),this.endDraw(),this},repeat:function(d,g,m,E,v,y,T,A,x){if(m===void 0&&(m=0),E===void 0&&(E=0),v===void 0&&(v=this.width),y===void 0&&(y=this.height),T===void 0&&(T=1),A===void 0&&(A=16777215),x===void 0&&(x=!1),d instanceof a?g=d:g=this.manager.getFrame(d,g),!g)return this;var _=this.manager.resetStamp(T,A);_.setFrame(g),_.setOrigin(0);var b=g.width,M=g.height;v=Math.floor(v),y=Math.floor(y);var w=Math.ceil(v/b),R=Math.ceil(y/M),I=w*b-v,O=R*M-y;I>0&&(I=b-I),O>0&&(O=M-O),m<0&&(w+=Math.ceil(Math.abs(m)/b)),E<0&&(R+=Math.ceil(Math.abs(E)/M));var D=m,N=E,F=!1,G=this.manager.stampCrop.setTo(0,0,b,M);x||this.beginDraw();for(var L=0;L<R;L++){if(N+M<0){N+=M;continue}for(var C=0;C<w;C++){if(F=!1,D+b<0){D+=b;continue}else D<0&&(F=!0,G.width=b+D,G.x=b-G.width);N<0&&(F=!0,G.height=M+N,G.y=M-G.height),I>0&&C===w-1&&(F=!0,G.width=I),O>0&&L===R-1&&(F=!0,G.height=O),F&&_.setCrop(G),this.batchGameObject(_,D,N),_.isCropped=!1,G.setTo(0,0,b,M),D+=b}D=m,N+=M}return x||this.endDraw(),this},beginDraw:function(){if(!this.isDrawing){var d=this.camera,g=this.renderer,m=this.renderTarget;d.preRender(),m?g.beginCapture(m.width,m.height):g.setContext(this.context),this.isDrawing=!0}return this},batchDraw:function(d,g,m,E,v){return Array.isArray(d)||(d=[d]),this.batchList(d,g,m,E,v),this},batchDrawFrame:function(d,g,m,E,v,y){m===void 0&&(m=0),E===void 0&&(E=0),v===void 0&&(v=1),y===void 0&&(y=16777215);var T=this.manager.getFrame(d,g);return T&&(this.renderTarget?this.pipeline.batchTextureFrame(T,m,E,y,v,this.camera.matrix,null):this.batchTextureFrame(T,m,E,v,y)),this},endDraw:function(d){if(d===void 0&&(d=this._eraseMode),this.isDrawing){var g=this.renderer,m=this.renderTarget;if(m){var E=g.endCapture(),v=g.pipelines.setUtility();v.blitFrame(E,m,1,!1,!1,d,this.isSpriteTexture),g.resetScissor(),g.resetViewport()}else g.setContext();this.dirty=!0,this.isDrawing=!1}return this},batchList:function(d,g,m,E,v){var y=d.length;if(y!==0)for(var T=0;T<y;T++){var A=d[T];!A||A===this||(A.renderWebGL||A.renderCanvas?this.batchGameObject(A,g,m):A.isParent||A.list?this.batchGroup(A.getChildren(),g,m):typeof A=="string"?this.batchTextureFrameKey(A,null,g,m,E,v):A instanceof a?this.batchTextureFrame(A,g,m,E,v):Array.isArray(A)&&this.batchList(A,g,m,E,v))}},batchGroup:function(d,g,m){g===void 0&&(g=0),m===void 0&&(m=0);for(var E=0;E<d.length;E++){var v=d[E];v.willRender(this.camera)&&this.batchGameObject(v,v.x+g,v.y+m)}},batchGameObject:function(d,g,m){g===void 0&&(g=d.x),m===void 0&&(m=d.y);var E=d.x,v=d.y,y=this.camera,T=this.renderer,A=this._eraseMode,x=d.mask;if(d.setPosition(g,m),this.canvas){if(A){var _=d.blendMode;d.blendMode=i.ERASE}x&&x.preRenderCanvas(T,d,y),d.renderCanvas(T,d,y,null),x&&x.postRenderCanvas(T,d,y),A&&(d.blendMode=_)}else T&&(x&&x.preRenderWebGL(T,d,y),A||T.setBlendMode(d.blendMode),d.renderWebGL(T,d,y),x&&x.postRenderWebGL(T,y,this.renderTarget));d.setPosition(E,v)},batchTextureFrameKey:function(d,g,m,E,v,y){var T=this.manager.getFrame(d,g);T&&this.batchTextureFrame(T,m,E,v,y)},batchTextureFrame:function(d,g,m,E,v){g===void 0&&(g=0),m===void 0&&(m=0),E===void 0&&(E=1),v===void 0&&(v=16777215);var y=this.camera.matrix,T=this.renderTarget;if(T)this.pipeline.batchTextureFrame(d,g,m,v,E,y,null);else{var A=this.context,x=d.canvasData,_=d.source.image;A.save(),A.globalCompositeOperation=this._eraseMode?"destination-out":"source-over",A.globalAlpha=E,y.setToContext(A),x.width>0&&x.height>0&&A.drawImage(_,x.x,x.y,x.width,x.height,g,m,x.width,x.height),A.restore()}},snapshotArea:function(d,g,m,E,v,y,T){return this.renderTarget?this.renderer.snapshotFramebuffer(this.renderTarget.framebuffer,this.width,this.height,v,!1,d,g,m,E,y,T):this.renderer.snapshotCanvas(this.canvas,v,!1,d,g,m,E,y,T),this},snapshot:function(d,g,m){return this.snapshotArea(0,0,this.width,this.height,d,g,m)},snapshotPixel:function(d,g,m){return this.snapshotArea(d,g,1,1,m,"pixel")},getWebGLTexture:function(){if(this.renderTarget)return this.renderTarget.texture},renderWebGL:function(d,g,m,E){var v=this.manager.resetStamp();v.setTexture(this),v.setOrigin(0),v.renderWebGL(d,v,m,E)},renderCanvas:function(){},destroy:function(){var d=this.manager.stamp;d&&d.texture===this&&this.manager.resetStamp(),f.prototype.destroy.call(this),n.remove(this.canvas),this.renderTarget&&this.renderTarget.destroy(),this.camera.destroy(),this.canvas=null,this.context=null,this.renderer=null}});t.exports=p}),Lw=S((e,t)=>{"use strict";t.exports={0:"#000",1:"#9D9D9D",2:"#FFF",3:"#BE2633",4:"#E06F8B",5:"#493C2B",6:"#A46422",7:"#EB8931",8:"#F7E26B",9:"#2F484E",A:"#44891A",B:"#A3CE27",C:"#1B2632",D:"#005784",E:"#31A2F2",F:"#B2DCEF"}}),Iw=S((e,t)=>{"use strict";var i=Lw(),s=Ne(),n=Mt(),r=function(o){var a=n(o,"data",[]),h=n(o,"canvas",null),l=n(o,"palette",i),c=n(o,"pixelWidth",1),f=n(o,"pixelHeight",c),u=n(o,"resizeCanvas",!0),p=n(o,"clearCanvas",!0),d=n(o,"preRender",null),g=n(o,"postRender",null),m=Math.floor(Math.abs(a[0].length*c)),E=Math.floor(Math.abs(a.length*f));h||(h=s.create2D(this,m,E),u=!1,p=!1),u&&(h.width=m,h.height=E);var v=h.getContext("2d",{willReadFrequently:!0});p&&v.clearRect(0,0,m,E),d&&d(h,v);for(var y=0;y<a.length;y++)for(var T=a[y],A=0;A<T.length;A++){var x=T[A];x!=="."&&x!==" "&&(v.fillStyle=l[x],v.fillRect(A*c,y*f,c,f))}return g&&g(h,v),h};t.exports=r}),Mw=S((e,t)=>{"use strict";var i=function(s,n){var r=s.source[n];return s.add("__BASE",n,0,0,r.width,r.height),s};t.exports=i}),Ow=S((e,t)=>{"use strict";var i=function(s,n){var r=s.source[n];return s.add("__BASE",n,0,0,r.width,r.height),s};t.exports=i}),Dw=S((e,t)=>{"use strict";var i=qn(),s=function(n,r,o){if(!(!o.frames&&!o.textures)){var a=n.source[r];n.add("__BASE",r,0,0,a.width,a.height);for(var h=Array.isArray(o.textures)?o.textures[r].frames:o.frames,l,c=0;c<h.length;c++){var f=h[c];if(l=n.add(f.filename,r,f.frame.x,f.frame.y,f.frame.w,f.frame.h),!!l){f.trimmed&&l.setTrim(f.sourceSize.w,f.sourceSize.h,f.spriteSourceSize.x,f.spriteSourceSize.y,f.spriteSourceSize.w,f.spriteSourceSize.h),f.rotated&&(l.rotated=!0,l.updateUVsInverted());var u=f.anchor||f.pivot;u&&(l.customPivot=!0,l.pivotX=u.x,l.pivotY=u.y),f.scale9Borders&&l.setScale9(f.scale9Borders.x,f.scale9Borders.y,f.scale9Borders.w,f.scale9Borders.h),l.customData=i(f)}}for(var p in o)p!=="frames"&&(Array.isArray(o[p])?n.customData[p]=o[p].slice(0):n.customData[p]=o[p]);return n}};t.exports=s}),kw=S((e,t)=>{"use strict";var i=pt(),s=function(n,r,o,a,h,l,c){var f=i(c,"frameWidth",null),u=i(c,"frameHeight",f);if(f===null)throw new Error("TextureManager.SpriteSheet: Invalid frameWidth given.");var p=n.source[r];n.add("__BASE",r,0,0,p.width,p.height);var d=i(c,"startFrame",0),g=i(c,"endFrame",-1),m=i(c,"margin",0),E=i(c,"spacing",0),v=Math.floor((h-m+E)/(f+E)),y=Math.floor((l-m+E)/(u+E)),T=v*y;(d>T||d<-T)&&(d=0),d<0&&(d=T+d),(g===-1||g>T||g<d)&&(g=T);for(var A=m,x=m,_=0,b=0,M=0,w=0;w<T;w++){_=0,b=0;var R=A+f,I=x+u;R>h&&(_=R-h),I>l&&(b=I-l),w>=d&&w<=g&&(n.add(M,r,o+A,a+x,f-_,u-b),M++),A+=f+E,A+f>h&&(A=m,x+=u+E)}return n};t.exports=s}),Bw=S((e,t)=>{"use strict";var i=pt(),s=function(n,r,o){var a=i(o,"frameWidth",null),h=i(o,"frameHeight",a);if(!a)throw new Error("TextureManager.SpriteSheetFromAtlas: Invalid frameWidth given.");var l=n.source[0];n.add("__BASE",0,0,0,l.width,l.height);var c=i(o,"startFrame",0),f=i(o,"endFrame",-1),u=i(o,"margin",0),p=i(o,"spacing",0),d=r.cutX,g=r.cutY,m=r.cutWidth,E=r.cutHeight,v=r.realWidth,y=r.realHeight,T=Math.floor((v-u+p)/(a+p)),A=Math.floor((y-u+p)/(h+p)),x=T*A,_=r.x,b=a-_,M=a-(v-m-_),w=r.y,R=h-w,I=h-(y-E-w);(c>x||c<-x)&&(c=0),c<0&&(c=x+c),f!==-1&&(x=c+(f+1));for(var O,D=u,N=u,F=0,G=0,L=0;L<A;L++){for(var C=L===0,P=L===A-1,k=0;k<T;k++){var B=k===0,Y=k===T-1;if(O=n.add(F,G,d+D,g+N,a,h),B||C||Y||P){var H=B?_:0,z=C?w:0,K=0,X=0;B&&(K+=a-b),Y&&(K+=a-M),C&&(X+=h-R),P&&(X+=h-I);var et=a-K,J=h-X;O.cutWidth=et,O.cutHeight=J,O.setTrim(a,h,H,z,et,J)}D+=p,B?D+=b:Y?D+=M:D+=a,F++}D=u,N+=p,C?N+=R:P?N+=I:N+=h}return n};t.exports=s}),Nw=S((e,t)=>{"use strict";t.exports={Canvas:Mw(),Image:Ow(),JSONArray:Dw(),SpriteSheet:kw(),SpriteSheetFromAtlas:Bw()}}),Uw=S((e,t)=>{"use strict";var i=Ne(),s=bw(),n=V(),r=Ze(),o=Ke(),a=Pw(),h=Wt(),l=pn(),c=nn(),f=Ce(),u=Iw(),p=Mt(),d=er(),g=oe(),m=Nw(),E=zt(),v=to(),y=new n({Extends:h,initialize:function(T){h.call(this),this.game=T,this.name="TextureManager",this.list={},this._tempCanvas=i.create2D(this),this._tempContext=this._tempCanvas.getContext("2d",{willReadFrequently:!0}),this._pending=0,this.stamp,this.stampCrop=new E,this.silentWarnings=!1,T.events.once(f.BOOT,this.boot,this)},boot:function(){this._pending=3,this.on(l.LOAD,this.updatePending,this),this.on(l.ERROR,this.updatePending,this);var T=this.game.config;T.defaultImage!==null&&this.addBase64("__DEFAULT",T.defaultImage),T.missingImage!==null&&this.addBase64("__MISSING",T.missingImage),T.whiteImage!==null&&this.addBase64("__WHITE",T.whiteImage),this.game.renderer&&this.game.renderer.gl&&this.addUint8Array("__NORMAL",new Uint8Array([127,127,255,255]),1,1),this.game.events.once(f.DESTROY,this.destroy,this),this.game.events.once(f.SYSTEM_READY,function(A){this.stamp=new d(A).setOrigin(0)},this)},updatePending:function(){this._pending--,this._pending===0&&(this.off(l.LOAD),this.off(l.ERROR),this.emit(l.READY))},checkKey:function(T){return!T||typeof T!="string"||this.exists(T)?(this.silentWarnings,!1):!0},remove:function(T){if(typeof T=="string")if(this.exists(T))T=this.get(T);else return this.silentWarnings,this;var A=T.key;return this.list.hasOwnProperty(A)&&(T.destroy(),this.emit(l.REMOVE,A),this.emit(l.REMOVE_KEY+A)),this},removeKey:function(T){return this.list.hasOwnProperty(T)&&delete this.list[T],this},addBase64:function(T,A){if(this.checkKey(T)){var x=this,_=new Image;_.onerror=function(){x.emit(l.ERROR,T)},_.onload=function(){var b=x.create(T,_);b&&(m.Image(b,0),x.emit(l.ADD,T,b),x.emit(l.ADD_KEY+T,b),x.emit(l.LOAD,T,b))},_.src=A}return this},getBase64:function(T,A,x,_){x===void 0&&(x="image/png"),_===void 0&&(_=.92);var b="",M=this.getFrame(T,A);if(M&&(M.source.isRenderTexture||M.source.isGLTexture))this.silentWarnings;else if(M){var w=M.canvasData,R=i.create2D(this,w.width,w.height),I=R.getContext("2d",{willReadFrequently:!0});w.width>0&&w.height>0&&I.drawImage(M.source.image,w.x,w.y,w.width,w.height,0,0,w.width,w.height),b=R.toDataURL(x,_),i.remove(R)}return b},addImage:function(T,A,x){var _=null;return this.checkKey(T)&&(_=this.create(T,A),m.Image(_,0),x&&_.setDataSource(x),this.emit(l.ADD,T,_),this.emit(l.ADD_KEY+T,_)),_},addGLTexture:function(T,A){var x=null;if(this.checkKey(T)){var _=A.width,b=A.height;x=this.create(T,A,_,b),x.add("__BASE",0,0,0,_,b),this.emit(l.ADD,T,x),this.emit(l.ADD_KEY+T,x)}return x},addCompressedTexture:function(T,A,x){var _=null;if(this.checkKey(T)){if(_=this.create(T,A),_.add("__BASE",0,0,0,A.width,A.height),x){var b=function(w,R,I){Array.isArray(I.textures)||Array.isArray(I.frames)?m.JSONArray(w,R,I):m.JSONHash(w,R,I)};if(Array.isArray(x))for(var M=0;M<x.length;M++)b(_,M,x[M]);else b(_,0,x)}this.emit(l.ADD,T,_),this.emit(l.ADD_KEY+T,_)}return _},addRenderTexture:function(T,A){var x=null;return this.checkKey(T)&&(x=this.create(T,A),x.add("__BASE",0,0,0,A.width,A.height),this.emit(l.ADD,T,x),this.emit(l.ADD_KEY+T,x)),x},generate:function(T,A){if(this.checkKey(T)){var x=i.create(this,1,1);return A.canvas=x,u(A),this.addCanvas(T,x)}else return null},createCanvas:function(T,A,x){if(A===void 0&&(A=256),x===void 0&&(x=256),this.checkKey(T)){var _=i.create(this,A,x,o.CANVAS,!0);return this.addCanvas(T,_)}return null},addCanvas:function(T,A,x){x===void 0&&(x=!1);var _=null;return x?_=new s(this,T,A,A.width,A.height):this.checkKey(T)&&(_=new s(this,T,A,A.width,A.height),this.list[T]=_,this.emit(l.ADD,T,_),this.emit(l.ADD_KEY+T,_)),_},addDynamicTexture:function(T,A,x){var _=null;return typeof T=="string"&&!this.exists(T)?_=new a(this,T,A,x):(_=T,T=_.key),this.checkKey(T)?(this.list[T]=_,this.emit(l.ADD,T,_),this.emit(l.ADD_KEY+T,_)):_=null,_},addAtlas:function(T,A,x,_){return Array.isArray(x.textures)||Array.isArray(x.frames)?this.addAtlasJSONArray(T,A,x,_):this.addAtlasJSONHash(T,A,x,_)},addAtlasJSONArray:function(T,A,x,_){var b=null;if(A instanceof v?(T=A.key,b=A):this.checkKey(T)&&(b=this.create(T,A)),b){if(Array.isArray(x))for(var M=x.length===1,w=0;w<b.source.length;w++){var R=M?x[0]:x[w];m.JSONArray(b,w,R)}else m.JSONArray(b,0,x);_&&b.setDataSource(_),this.emit(l.ADD,T,b),this.emit(l.ADD_KEY+T,b)}return b},addAtlasJSONHash:function(T,A,x,_){var b=null;if(A instanceof v?(T=A.key,b=A):this.checkKey(T)&&(b=this.create(T,A)),b){if(Array.isArray(x))for(var M=0;M<x.length;M++)m.JSONHash(b,M,x[M]);else m.JSONHash(b,0,x);_&&b.setDataSource(_),this.emit(l.ADD,T,b),this.emit(l.ADD_KEY+T,b)}return b},addAtlasXML:function(T,A,x,_){var b=null;return A instanceof v?(T=A.key,b=A):this.checkKey(T)&&(b=this.create(T,A)),b&&(m.AtlasXML(b,0,x),_&&b.setDataSource(_),this.emit(l.ADD,T,b),this.emit(l.ADD_KEY+T,b)),b},addUnityAtlas:function(T,A,x,_){var b=null;return A instanceof v?(T=A.key,b=A):this.checkKey(T)&&(b=this.create(T,A)),b&&(m.UnityYAML(b,0,x),_&&b.setDataSource(_),this.emit(l.ADD,T,b),this.emit(l.ADD_KEY+T,b)),b},addSpriteSheet:function(T,A,x,_){var b=null;if(A instanceof v?(T=A.key,b=A):this.checkKey(T)&&(b=this.create(T,A)),b){var M=b.source[0].width,w=b.source[0].height;m.SpriteSheet(b,0,0,0,M,w,x),_&&b.setDataSource(_),this.emit(l.ADD,T,b),this.emit(l.ADD_KEY+T,b)}return b},addSpriteSheetFromAtlas:function(T,A){if(!this.checkKey(T))return null;var x=p(A,"atlas",null),_=p(A,"frame",null);if(!(!x||!_)){var b=this.get(x),M=b.get(_);if(M){var w=M.source.image;w||(w=M.source.glTexture);var R=this.create(T,w);return M.trimmed?m.SpriteSheetFromAtlas(R,M,A):m.SpriteSheet(R,0,M.cutX,M.cutY,M.cutWidth,M.cutHeight,A),this.emit(l.ADD,T,R),this.emit(l.ADD_KEY+T,R),R}}},addUint8Array:function(T,A,x,_){if(!this.checkKey(T)||A.length/4!==x*_)return null;var b=this.create(T,A,x,_);return b.add("__BASE",0,0,0,x,_),this.emit(l.ADD,T,b),this.emit(l.ADD_KEY+T,b),b},create:function(T,A,x,_){var b=null;return this.checkKey(T)&&(b=new v(this,T,A,x,_),this.list[T]=b),b},exists:function(T){return this.list.hasOwnProperty(T)},get:function(T){return T===void 0&&(T="__DEFAULT"),this.list[T]?this.list[T]:T instanceof v?T:T instanceof c?T.texture:this.list.__MISSING},cloneFrame:function(T,A){if(this.list[T])return this.list[T].get(A).clone()},getFrame:function(T,A){if(this.list[T])return this.list[T].get(A)},parseFrame:function(T){if(T){if(typeof T=="string")return this.getFrame(T);if(Array.isArray(T)&&T.length===2)return this.getFrame(T[0],T[1]);if(g(T))return this.getFrame(T.key,T.frame);if(T instanceof v)return T.get();if(T instanceof c)return T}else return},getTextureKeys:function(){var T=[];for(var A in this.list)A!=="__DEFAULT"&&A!=="__MISSING"&&A!=="__WHITE"&&A!=="__NORMAL"&&T.push(A);return T},getPixel:function(T,A,x,_){var b=this.getFrame(x,_);if(b){T-=b.x,A-=b.y;var M=b.data.cut;if(T+=M.x,A+=M.y,T>=M.x&&T<M.r&&A>=M.y&&A<M.b){var w=this._tempContext;w.clearRect(0,0,1,1),w.drawImage(b.source.image,T,A,1,1,0,0,1,1);var R=w.getImageData(0,0,1,1);return new r(R.data[0],R.data[1],R.data[2],R.data[3])}}return null},getPixelAlpha:function(T,A,x,_){var b=this.getFrame(x,_);if(b){T-=b.x,A-=b.y;var M=b.data.cut;if(T+=M.x,A+=M.y,T>=M.x&&T<M.r&&A>=M.y&&A<M.b){var w=this._tempContext;w.clearRect(0,0,1,1),w.drawImage(b.source.image,T,A,1,1,0,0,1,1);var R=w.getImageData(0,0,1,1);return R.data[3]}}return null},setTexture:function(T,A,x){return this.list[A]&&(T.texture=this.list[A],T.frame=T.texture.get(x)),T},renameTexture:function(T,A){var x=this.get(T);return x&&T!==A?(x.key=A,this.list[A]=x,delete this.list[T],!0):!1},each:function(T,A){for(var x=[null],_=1;_<arguments.length;_++)x.push(arguments[_]);for(var b in this.list)x[0]=this.list[b],T.apply(A,x)},resetStamp:function(T,A){T===void 0&&(T=1),A===void 0&&(A=16777215);var x=this.stamp;return x.setCrop(),x.setPosition(0),x.setAngle(0),x.setScale(1),x.setAlpha(T),x.setTint(A),x.setTexture("__WHITE"),x},destroy:function(){for(var T in this.list)this.list[T].destroy();this.list={},this.stamp.destroy(),this.game=null,this.stamp=null,i.remove(this._tempCanvas)}});t.exports=y}),Fw=S((e,t)=>{"use strict";var i=V(),s=Lt(),n=new i({initialize:function(){this.isRunning=!1,this.callback=s,this.isSetTimeOut=!1,this.timeOutID=null,this.delay=0;var r=this;this.step=function o(a){r.callback(a),r.isRunning&&(r.timeOutID=window.requestAnimationFrame(o))},this.stepTimeout=function o(){r.isRunning&&(r.timeOutID=window.setTimeout(o,r.delay)),r.callback(window.performance.now())}},start:function(r,o,a){this.isRunning||(this.callback=r,this.isSetTimeOut=o,this.delay=a,this.isRunning=!0,this.timeOutID=o?window.setTimeout(this.stepTimeout,0):window.requestAnimationFrame(this.step))},stop:function(){this.isRunning=!1,this.isSetTimeOut?clearTimeout(this.timeOutID):window.cancelAnimationFrame(this.timeOutID)},destroy:function(){this.stop(),this.callback=s}});t.exports=n}),Gw=S((e,t)=>{"use strict";var i=V(),s=Mt(),n=Lt(),r=Fw(),o=new i({initialize:function(a,h){this.game=a,this.raf=new r,this.started=!1,this.running=!1,this.minFps=s(h,"min",5),this.targetFps=s(h,"target",60),this.fpsLimit=s(h,"limit",0),this.hasFpsLimit=this.fpsLimit>0,this._limitRate=this.hasFpsLimit?1e3/this.fpsLimit:0,this._min=1e3/this.minFps,this._target=1e3/this.targetFps,this.actualFps=this.targetFps,this.nextFpsUpdate=0,this.framesThisSecond=0,this.callback=n,this.forceSetTimeOut=s(h,"forceSetTimeOut",!1),this.time=0,this.startTime=0,this.lastTime=0,this.frame=0,this.inFocus=!0,this.pauseDuration=0,this._pauseTime=0,this._coolDown=0,this.delta=0,this.deltaIndex=0,this.deltaHistory=[],this.deltaSmoothingMax=s(h,"deltaHistory",10),this.panicMax=s(h,"panicMax",120),this.rawDelta=0,this.now=0,this.smoothStep=s(h,"smoothStep",!0)},blur:function(){this.inFocus=!1},focus:function(){this.inFocus=!0,this.resetDelta()},pause:function(){this._pauseTime=window.performance.now()},resume:function(){this.resetDelta(),this.pauseDuration=this.time-this._pauseTime,this.startTime+=this.pauseDuration},resetDelta:function(){var a=window.performance.now();this.time=a,this.lastTime=a,this.nextFpsUpdate=a+1e3,this.framesThisSecond=0;for(var h=0;h<this.deltaSmoothingMax;h++)this.deltaHistory[h]=Math.min(this._target,this.deltaHistory[h]);this.delta=0,this.deltaIndex=0,this._coolDown=this.panicMax},start:function(a){if(this.started)return this;this.started=!0,this.running=!0;for(var h=0;h<this.deltaSmoothingMax;h++)this.deltaHistory[h]=this._target;this.resetDelta(),this.startTime=window.performance.now(),this.callback=a;var l=this.hasFpsLimit?this.stepLimitFPS.bind(this):this.step.bind(this);this.raf.start(l,this.forceSetTimeOut,this._target)},smoothDelta:function(a){var h=this.deltaIndex,l=this.deltaHistory,c=this.deltaSmoothingMax;(this._coolDown>0||!this.inFocus)&&(this._coolDown--,a=Math.min(a,this._target)),a>this._min&&(a=l[h],a=Math.min(a,this._min)),l[h]=a,this.deltaIndex++,this.deltaIndex>=c&&(this.deltaIndex=0);for(var f=0,u=0;u<c;u++)f+=l[u];return f/=c,f},updateFPS:function(a){this.actualFps=.25*this.framesThisSecond+.75*this.actualFps,this.nextFpsUpdate=a+1e3,this.framesThisSecond=0},stepLimitFPS:function(a){this.now=a;var h=Math.max(0,a-this.lastTime);this.rawDelta=h,this.time+=this.rawDelta,this.smoothStep&&(h=this.smoothDelta(h)),this.delta+=h,a>=this.nextFpsUpdate&&this.updateFPS(a),this.framesThisSecond++,this.delta>=this._limitRate&&(this.callback(a,this.delta),this.delta=0),this.lastTime=a,this.frame++},step:function(a){this.now=a;var h=Math.max(0,a-this.lastTime);this.rawDelta=h,this.time+=this.rawDelta,this.smoothStep&&(h=this.smoothDelta(h)),this.delta=h,a>=this.nextFpsUpdate&&this.updateFPS(a),this.framesThisSecond++,this.callback(a,h),this.lastTime=a,this.frame++},tick:function(){var a=window.performance.now();this.hasFpsLimit?this.stepLimitFPS(a):this.step(a)},sleep:function(){this.running&&(this.raf.stop(),this.running=!1)},wake:function(a){a===void 0&&(a=!1);var h=window.performance.now();if(!this.running){a&&(this.startTime+=-this.lastTime+(this.lastTime+h));var l=this.hasFpsLimit?this.stepLimitFPS.bind(this):this.step.bind(this);this.raf.start(l,this.forceSetTimeOut,this._target),this.running=!0,this.nextFpsUpdate=h+1e3,this.framesThisSecond=0,this.fpsLimitTriggered=!1,this.tick()}},getDuration:function(){return Math.round(this.lastTime-this.startTime)/1e3},getDurationMS:function(){return Math.round(this.lastTime-this.startTime)},stop:function(){return this.running=!1,this.started=!1,this.raf.stop(),this},destroy:function(){this.stop(),this.raf.destroy(),this.raf=null,this.game=null,this.callback=null}});t.exports=o}),Yw=S((e,t)=>{"use strict";var i=Ce(),s=function(n){var r,o=n.events;if(document.hidden!==void 0)r="visibilitychange";else{var a=["webkit","moz","ms"];a.forEach(function(l){document[l+"Hidden"]!==void 0&&(document.hidden=function(){return document[l+"Hidden"]},r=l+"visibilitychange")})}var h=function(l){document.hidden||l.type==="pause"?o.emit(i.HIDDEN):o.emit(i.VISIBLE)};r&&document.addEventListener(r,h,!1),window.onblur=function(){o.emit(i.BLUR)},window.onfocus=function(){o.emit(i.FOCUS)},window.focus&&n.config.autoFocus&&window.focus()};t.exports=s}),Hw=S((e,t)=>{"use strict";t.exports="complete"}),Ww=S((e,t)=>{"use strict";t.exports="decoded"}),zw=S((e,t)=>{"use strict";t.exports="decodedall"}),Vw=S((e,t)=>{"use strict";t.exports="destroy"}),Xw=S((e,t)=>{"use strict";t.exports="detune"}),Kw=S((e,t)=>{"use strict";t.exports="detune"}),jw=S((e,t)=>{"use strict";t.exports="mute"}),Zw=S((e,t)=>{"use strict";t.exports="rate"}),qw=S((e,t)=>{"use strict";t.exports="volume"}),Qw=S((e,t)=>{"use strict";t.exports="loop"}),Jw=S((e,t)=>{"use strict";t.exports="looped"}),$w=S((e,t)=>{"use strict";t.exports="mute"}),t1=S((e,t)=>{"use strict";t.exports="pan"}),e1=S((e,t)=>{"use strict";t.exports="pauseall"}),i1=S((e,t)=>{"use strict";t.exports="pause"}),s1=S((e,t)=>{"use strict";t.exports="play"}),n1=S((e,t)=>{"use strict";t.exports="rate"}),r1=S((e,t)=>{"use strict";t.exports="resumeall"}),a1=S((e,t)=>{"use strict";t.exports="resume"}),o1=S((e,t)=>{"use strict";t.exports="seek"}),h1=S((e,t)=>{"use strict";t.exports="stopall"}),l1=S((e,t)=>{"use strict";t.exports="stop"}),u1=S((e,t)=>{"use strict";t.exports="unlocked"}),c1=S((e,t)=>{"use strict";t.exports="volume"}),pr=S((e,t)=>{"use strict";t.exports={COMPLETE:Hw(),DECODED:Ww(),DECODED_ALL:zw(),DESTROY:Vw(),DETUNE:Xw(),GLOBAL_DETUNE:Kw(),GLOBAL_MUTE:jw(),GLOBAL_RATE:Zw(),GLOBAL_VOLUME:qw(),LOOP:Qw(),LOOPED:Jw(),MUTE:$w(),PAN:t1(),PAUSE_ALL:e1(),PAUSE:i1(),PLAY:s1(),RATE:n1(),RESUME_ALL:r1(),RESUME:a1(),SEEK:o1(),STOP_ALL:h1(),STOP:l1(),UNLOCKED:u1(),VOLUME:c1()}}),xc=S((e,t)=>{"use strict";var i=V(),s=qn(),n=Wt(),r=pr(),o=Ce(),a=oa(),h=Bh(),l=Lt(),c=Ot(),f=new i({Extends:n,initialize:function(u){n.call(this),this.game=u,this.jsonCache=u.cache.json,this.sounds=[],this.mute=!1,this.volume=1,this.pauseOnBlur=!0,this._rate=1,this._detune=0,this.locked=this.locked||!1,this.unlocked=!1,this.gameLostFocus=!1,this.listenerPosition=new c;var p=u.events;p.on(o.BLUR,this.onGameBlur,this),p.on(o.FOCUS,this.onGameFocus,this),p.on(o.PRE_STEP,this.update,this),p.once(o.DESTROY,this.destroy,this)},add:l,addAudioSprite:function(u,p){p===void 0&&(p={});var d=this.add(u,p);d.spritemap=this.jsonCache.get(u).spritemap;for(var g in d.spritemap)if(d.spritemap.hasOwnProperty(g)){var m=s(p),E=d.spritemap[g];m.loop=E.hasOwnProperty("loop")?E.loop:!1,d.addMarker({name:g,start:E.start,duration:E.end-E.start,config:m})}return d},get:function(u){return h(this.sounds,"key",u)},getAll:function(u){return u?a(this.sounds,"key",u):a(this.sounds)},getAllPlaying:function(){return a(this.sounds,"isPlaying",!0)},play:function(u,p){var d=this.add(u);return d.once(r.COMPLETE,d.destroy,d),p?p.name?(d.addMarker(p),d.play(p.name)):d.play(p):d.play()},playAudioSprite:function(u,p,d){var g=this.addAudioSprite(u);return g.once(r.COMPLETE,g.destroy,g),g.play(p,d)},remove:function(u){var p=this.sounds.indexOf(u);return p!==-1?(u.destroy(),this.sounds.splice(p,1),!0):!1},removeAll:function(){this.sounds.forEach(function(u){u.destroy()}),this.sounds.length=0},removeByKey:function(u){for(var p=0,d=this.sounds.length-1;d>=0;d--){var g=this.sounds[d];g.key===u&&(g.destroy(),this.sounds.splice(d,1),p++)}return p},pauseAll:function(){this.forEachActiveSound(function(u){u.pause()}),this.emit(r.PAUSE_ALL,this)},resumeAll:function(){this.forEachActiveSound(function(u){u.resume()}),this.emit(r.RESUME_ALL,this)},setListenerPosition:l,stopAll:function(){this.forEachActiveSound(function(u){u.stop()}),this.emit(r.STOP_ALL,this)},stopByKey:function(u){var p=0;return this.getAll(u).forEach(function(d){d.stop()&&p++}),p},isPlaying:function(u){var p=this.sounds,d=p.length-1,g;if(u===void 0){for(;d>=0;d--)if(g=this.sounds[d],g.isPlaying)return!0}else for(;d>=0;d--)if(g=this.sounds[d],g.key===u&&g.isPlaying)return!0;return!1},unlock:l,onBlur:l,onFocus:l,onGameBlur:function(){this.gameLostFocus=!0,this.pauseOnBlur&&this.onBlur()},onGameFocus:function(){this.gameLostFocus=!1,this.pauseOnBlur&&this.onFocus()},update:function(u,p){this.unlocked&&(this.unlocked=!1,this.locked=!1,this.emit(r.UNLOCKED,this));for(var d=this.sounds.length-1;d>=0;d--)this.sounds[d].pendingRemove&&this.sounds.splice(d,1);this.sounds.forEach(function(g){g.update(u,p)})},destroy:function(){this.game.events.off(o.BLUR,this.onGameBlur,this),this.game.events.off(o.FOCUS,this.onGameFocus,this),this.game.events.off(o.PRE_STEP,this.update,this),this.removeAllListeners(),this.removeAll(),this.sounds.length=0,this.sounds=null,this.listenerPosition=null,this.game=null},forEachActiveSound:function(u,p){var d=this;this.sounds.forEach(function(g,m){g&&!g.pendingRemove&&u.call(p||d,g,m,d.sounds)})},setRate:function(u){return this.rate=u,this},rate:{get:function(){return this._rate},set:function(u){this._rate=u,this.forEachActiveSound(function(p){p.calculateRate()}),this.emit(r.GLOBAL_RATE,this,u)}},setDetune:function(u){return this.detune=u,this},detune:{get:function(){return this._detune},set:function(u){this._detune=u,this.forEachActiveSound(function(p){p.calculateRate()}),this.emit(r.GLOBAL_DETUNE,this,u)}}});t.exports=f}),wc=S((e,t)=>{"use strict";var i=V(),s=Wt(),n=pr(),r=Re(),o=Lt(),a=new i({Extends:s,initialize:function(h,l,c){s.call(this),this.manager=h,this.key=l,this.isPlaying=!1,this.isPaused=!1,this.totalRate=1,this.duration=this.duration||0,this.totalDuration=this.totalDuration||0,this.config={mute:!1,volume:1,rate:1,detune:0,seek:0,loop:!1,delay:0,pan:0},this.currentConfig=this.config,this.config=r(this.config,c),this.markers={},this.currentMarker=null,this.pendingRemove=!1},addMarker:function(h){return!h||!h.name||typeof h.name!="string"||this.markers[h.name]?!1:(h=r(!0,{name:"",start:0,duration:this.totalDuration-(h.start||0),config:{mute:!1,volume:1,rate:1,detune:0,seek:0,loop:!1,delay:0,pan:0}},h),this.markers[h.name]=h,!0)},updateMarker:function(h){return!h||!h.name||typeof h.name!="string"||!this.markers[h.name]?!1:(this.markers[h.name]=r(!0,this.markers[h.name],h),!0)},removeMarker:function(h){var l=this.markers[h];return l?(this.markers[h]=null,l):null},play:function(h,l){if(h===void 0&&(h=""),typeof h=="object"&&(l=h,h=""),typeof h!="string")return!1;if(!h)this.currentMarker=null,this.currentConfig=this.config,this.duration=this.totalDuration;else{if(!this.markers[h])return!1;this.currentMarker=this.markers[h],this.currentConfig=this.currentMarker.config,this.duration=this.currentMarker.duration}return this.resetConfig(),this.currentConfig=r(this.currentConfig,l),this.isPlaying=!0,this.isPaused=!1,!0},pause:function(){return this.isPaused||!this.isPlaying?!1:(this.isPlaying=!1,this.isPaused=!0,!0)},resume:function(){return!this.isPaused||this.isPlaying?!1:(this.isPlaying=!0,this.isPaused=!1,!0)},stop:function(){return!this.isPaused&&!this.isPlaying?!1:(this.isPlaying=!1,this.isPaused=!1,this.resetConfig(),!0)},applyConfig:function(){this.mute=this.currentConfig.mute,this.volume=this.currentConfig.volume,this.rate=this.currentConfig.rate,this.detune=this.currentConfig.detune,this.loop=this.currentConfig.loop,this.pan=this.currentConfig.pan},resetConfig:function(){this.currentConfig.seek=0,this.currentConfig.delay=0},update:o,calculateRate:function(){var h=1.0005777895065548,l=this.currentConfig.detune+this.manager.detune,c=Math.pow(h,l);this.totalRate=this.currentConfig.rate*this.manager.rate*c},destroy:function(){this.pendingRemove||(this.stop(),this.emit(n.DESTROY,this),this.removeAllListeners(),this.pendingRemove=!0,this.manager=null,this.config=null,this.currentConfig=null,this.markers=null,this.currentMarker=null)}});t.exports=a}),d1=S((e,t)=>{"use strict";var i=wc(),s=V(),n=Wt(),r=Re(),o=Lt(),a=function(){return!1},h=function(){return null},l=function(){return this},c=new s({Extends:n,initialize:function(f,u,p){p===void 0&&(p={}),n.call(this),this.manager=f,this.key=u,this.isPlaying=!1,this.isPaused=!1,this.totalRate=1,this.duration=0,this.totalDuration=0,this.config=r({mute:!1,volume:1,rate:1,detune:0,seek:0,loop:!1,delay:0,pan:0},p),this.currentConfig=this.config,this.mute=!1,this.volume=1,this.rate=1,this.detune=0,this.seek=0,this.loop=!1,this.pan=0,this.markers={},this.currentMarker=null,this.pendingRemove=!1},addMarker:a,updateMarker:a,removeMarker:h,play:a,pause:a,resume:a,stop:a,setMute:l,setVolume:l,setRate:l,setDetune:l,setSeek:l,setLoop:l,setPan:l,applyConfig:h,resetConfig:h,update:o,calculateRate:h,destroy:function(){i.prototype.destroy.call(this)}});t.exports=c}),p1=S((e,t)=>{"use strict";var i=xc(),s=V(),n=Wt(),r=d1(),o=Lt(),a=new s({Extends:n,initialize:function(h){n.call(this),this.game=h,this.sounds=[],this.mute=!1,this.volume=1,this.rate=1,this.detune=0,this.pauseOnBlur=!0,this.locked=!1},add:function(h,l){var c=new r(this,h,l);return this.sounds.push(c),c},addAudioSprite:function(h,l){var c=this.add(h,l);return c.spritemap={},c},get:function(h){return i.prototype.get.call(this,h)},getAll:function(h){return i.prototype.getAll.call(this,h)},play:function(h,l){return!1},playAudioSprite:function(h,l,c){return!1},remove:function(h){return i.prototype.remove.call(this,h)},removeAll:function(){return i.prototype.removeAll.call(this)},removeByKey:function(h){return i.prototype.removeByKey.call(this,h)},stopByKey:function(h){return i.prototype.stopByKey.call(this,h)},onBlur:o,onFocus:o,onGameBlur:o,onGameFocus:o,pauseAll:o,resumeAll:o,stopAll:o,update:o,setRate:o,setDetune:o,setMute:o,setVolume:o,unlock:o,forEachActiveSound:function(h,l){i.prototype.forEachActiveSound.call(this,h,l)},destroy:function(){i.prototype.destroy.call(this)}});t.exports=a}),g1=S((e,t)=>{"use strict";var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=new Uint8Array(256);for(n=0;n<i.length;n++)s[i.charCodeAt(n)]=n;var n,r=function(o){o=o.substr(o.indexOf(",")+1);var a=o.length,h=a*.75,l=0,c,f,u,p;o[a-1]==="="&&(h--,o[a-2]==="="&&h--);for(var d=new ArrayBuffer(h),g=new Uint8Array(d),m=0;m<a;m+=4)c=s[o.charCodeAt(m)],f=s[o.charCodeAt(m+1)],u=s[o.charCodeAt(m+2)],p=s[o.charCodeAt(m+3)],g[l++]=c<<2|f>>4,g[l++]=(f&15)<<4|u>>2,g[l++]=(u&3)<<6|p&63;return d};t.exports=r}),f1=S((e,t)=>{"use strict";var i=wc(),s=V(),n=pr(),r=pt(),o=new s({Extends:i,initialize:function(a,h,l){if(l===void 0&&(l={}),this.audioBuffer=a.game.cache.audio.get(h),!this.audioBuffer)throw new Error('Audio key "'+h+'" not found in cache');this.source=null,this.loopSource=null,this.muteNode=a.context.createGain(),this.volumeNode=a.context.createGain(),this.pannerNode=null,this.spatialNode=null,this.spatialSource=null,this.playTime=0,this.startTime=0,this.loopTime=0,this.rateUpdates=[],this.hasEnded=!1,this.hasLooped=!1,this.muteNode.connect(this.volumeNode),a.context.createPanner&&(this.spatialNode=a.context.createPanner(),this.volumeNode.connect(this.spatialNode)),a.context.createStereoPanner?(this.pannerNode=a.context.createStereoPanner(),a.context.createPanner?this.spatialNode.connect(this.pannerNode):this.volumeNode.connect(this.pannerNode),this.pannerNode.connect(a.destination)):a.context.createPanner?this.spatialNode.connect(a.destination):this.volumeNode.connect(a.destination),this.duration=this.audioBuffer.duration,this.totalDuration=this.audioBuffer.duration,i.call(this,a,h,l)},play:function(a,h){return i.prototype.play.call(this,a,h)?(this.stopAndRemoveBufferSource(),this.createAndStartBufferSource(),this.emit(n.PLAY,this),!0):!1},pause:function(){return this.manager.context.currentTime<this.startTime||!i.prototype.pause.call(this)?!1:(this.currentConfig.seek=this.getCurrentTime(),this.stopAndRemoveBufferSource(),this.emit(n.PAUSE,this),!0)},resume:function(){return this.manager.context.currentTime<this.startTime||!i.prototype.resume.call(this)?!1:(this.createAndStartBufferSource(),this.emit(n.RESUME,this),!0)},stop:function(){return i.prototype.stop.call(this)?(this.stopAndRemoveBufferSource(),this.emit(n.STOP,this),!0):!1},createAndStartBufferSource:function(){var a=this.currentConfig.seek,h=this.currentConfig.delay,l=this.manager.context.currentTime+h,c=(this.currentMarker?this.currentMarker.start:0)+a,f=this.duration-a;this.playTime=l-a,this.startTime=l,this.source=this.createBufferSource(),this.applyConfig(),this.source.start(Math.max(0,l),Math.max(0,c),Math.max(0,f)),this.resetConfig()},createAndStartLoopBufferSource:function(){var a=this.getLoopTime(),h=this.currentMarker?this.currentMarker.start:0,l=this.duration;this.loopTime=a,this.loopSource=this.createBufferSource(),this.loopSource.playbackRate.setValueAtTime(this.totalRate,0),this.loopSource.start(Math.max(0,a),Math.max(0,h),Math.max(0,l))},createBufferSource:function(){var a=this,h=this.manager.context.createBufferSource();return h.buffer=this.audioBuffer,h.connect(this.muteNode),h.onended=function(l){var c=l.target;(c===a.source||c===a.loopSource)&&(a.currentConfig.loop?a.hasLooped=!0:a.hasEnded=!0)},h},stopAndRemoveBufferSource:function(){if(this.source){var a=this.source;this.source=null,a.stop(),a.disconnect()}this.playTime=0,this.startTime=0,this.hasEnded=!1,this.stopAndRemoveLoopBufferSource()},stopAndRemoveLoopBufferSource:function(){this.loopSource&&(this.loopSource.stop(),this.loopSource.disconnect(),this.loopSource=null),this.loopTime=0},applyConfig:function(){this.rateUpdates.length=0,this.rateUpdates.push({time:0,rate:1});var a=this.currentConfig.source;if(a&&this.manager.context.createPanner){var h=this.spatialNode;h.panningModel=r(a,"panningModel","equalpower"),h.distanceModel=r(a,"distanceModel","inverse"),h.orientationX.value=r(a,"orientationX",0),h.orientationY.value=r(a,"orientationY",0),h.orientationZ.value=r(a,"orientationZ",-1),h.refDistance=r(a,"refDistance",1),h.maxDistance=r(a,"maxDistance",1e4),h.rolloffFactor=r(a,"rolloffFactor",1),h.coneInnerAngle=r(a,"coneInnerAngle",360),h.coneOuterAngle=r(a,"coneOuterAngle",0),h.coneOuterGain=r(a,"coneOuterGain",0),this.spatialSource=r(a,"follow",null),this.spatialSource||(h.positionX.value=r(a,"x",0),h.positionY.value=r(a,"y",0),h.positionZ.value=r(a,"z",0))}i.prototype.applyConfig.call(this)},x:{get:function(){return this.spatialNode?this.spatialNode.positionX:0},set:function(a){this.spatialNode&&(this.spatialNode.positionX.value=a)}},y:{get:function(){return this.spatialNode?this.spatialNode.positionY:0},set:function(a){this.spatialNode&&(this.spatialNode.positionY.value=a)}},update:function(){if(this.isPlaying&&this.spatialSource){var a=r(this.spatialSource,"x",null),h=r(this.spatialSource,"y",null);a&&a!==this._spatialx&&(this._spatialx=this.spatialNode.positionX.value=a),h&&h!==this._spatialy&&(this._spatialy=this.spatialNode.positionY.value=h)}this.hasEnded?(i.prototype.stop.call(this),this.stopAndRemoveBufferSource(),this.emit(n.COMPLETE,this)):this.hasLooped&&(this.hasLooped=!1,this.source=this.loopSource,this.loopSource=null,this.playTime=this.startTime=this.loopTime,this.rateUpdates.length=0,this.rateUpdates.push({time:0,rate:this.totalRate}),this.createAndStartLoopBufferSource(),this.emit(n.LOOPED,this))},destroy:function(){this.pendingRemove||(i.prototype.destroy.call(this),this.audioBuffer=null,this.stopAndRemoveBufferSource(),this.muteNode.disconnect(),this.muteNode=null,this.volumeNode.disconnect(),this.volumeNode=null,this.pannerNode&&(this.pannerNode.disconnect(),this.pannerNode=null),this.spatialNode&&(this.spatialNode.disconnect(),this.spatialNode=null,this.spatialSource=null),this.rateUpdates.length=0,this.rateUpdates=null)},calculateRate:function(){i.prototype.calculateRate.call(this);var a=this.manager.context.currentTime;this.source&&typeof this.totalRate=="number"&&this.source.playbackRate.setValueAtTime(this.totalRate,a),this.isPlaying&&(this.rateUpdates.push({time:Math.max(this.startTime,a)-this.playTime,rate:this.totalRate}),this.loopSource&&(this.stopAndRemoveLoopBufferSource(),this.createAndStartLoopBufferSource()))},getCurrentTime:function(){for(var a=0,h=0;h<this.rateUpdates.length;h++){var l=0;h<this.rateUpdates.length-1?l=this.rateUpdates[h+1].time:l=this.manager.context.currentTime-this.playTime,a+=(l-this.rateUpdates[h].time)*this.rateUpdates[h].rate}return a},getLoopTime:function(){for(var a=0,h=0;h<this.rateUpdates.length-1;h++)a+=(this.rateUpdates[h+1].time-this.rateUpdates[h].time)*this.rateUpdates[h].rate;var l=this.rateUpdates[this.rateUpdates.length-1];return this.playTime+l.time+(this.duration-a)/l.rate},rate:{get:function(){return this.currentConfig.rate},set:function(a){this.currentConfig.rate=a,this.calculateRate(),this.emit(n.RATE,this,a)}},setRate:function(a){return this.rate=a,this},detune:{get:function(){return this.currentConfig.detune},set:function(a){this.currentConfig.detune=a,this.calculateRate(),this.emit(n.DETUNE,this,a)}},setDetune:function(a){return this.detune=a,this},mute:{get:function(){return this.muteNode.gain.value===0},set:function(a){this.currentConfig.mute=a,this.muteNode.gain.setValueAtTime(a?0:1,0),this.emit(n.MUTE,this,a)}},setMute:function(a){return this.mute=a,this},volume:{get:function(){return this.volumeNode.gain.value},set:function(a){this.currentConfig.volume=a,this.volumeNode.gain.setValueAtTime(a,0),this.emit(n.VOLUME,this,a)}},setVolume:function(a){return this.volume=a,this},seek:{get:function(){return this.isPlaying?this.manager.context.currentTime<this.startTime?this.startTime-this.playTime:this.getCurrentTime():this.isPaused?this.currentConfig.seek:0},set:function(a){this.manager.context.currentTime<this.startTime||(this.isPlaying||this.isPaused)&&(a=Math.min(Math.max(0,a),this.duration),this.currentConfig.seek=a,this.isPlaying&&(this.stopAndRemoveBufferSource(),this.createAndStartBufferSource()),this.emit(n.SEEK,this,a))}},setSeek:function(a){return this.seek=a,this},loop:{get:function(){return this.currentConfig.loop},set:function(a){this.currentConfig.loop=a,this.isPlaying&&(this.stopAndRemoveLoopBufferSource(),a&&this.createAndStartLoopBufferSource()),this.emit(n.LOOP,this,a)}},setLoop:function(a){return this.loop=a,this},pan:{get:function(){return this.pannerNode?this.pannerNode.pan.value:0},set:function(a){this.currentConfig.pan=a,this.pannerNode&&this.pannerNode.pan.setValueAtTime(a,this.manager.context.currentTime),this.emit(n.PAN,this,a)}},setPan:function(a){return this.pan=a,this}});t.exports=o}),m1=S((e,t)=>{"use strict";var i=g1(),s=xc(),n=V(),r=pr(),o=Ce(),a=f1(),h=pt(),l=new n({Extends:s,initialize:function(c){this.context=this.createAudioContext(c),this.masterMuteNode=this.context.createGain(),this.masterVolumeNode=this.context.createGain(),this.masterMuteNode.connect(this.masterVolumeNode),this.masterVolumeNode.connect(this.context.destination),this.destination=this.masterMuteNode,this.locked=this.context.state==="suspended",s.call(this,c),this.locked&&(c.isBooted?this.unlock():c.events.once(o.BOOT,this.unlock,this)),c.events.on(o.VISIBLE,this.onGameVisible,this)},onGameVisible:function(){var c=this.context;window.setTimeout(function(){c&&(c.suspend(),c.resume())},100)},createAudioContext:function(c){var f=c.config.audio;if(f.context)return f.context.resume(),f.context;if(window.hasOwnProperty("AudioContext"))return new AudioContext;if(window.hasOwnProperty("webkitAudioContext"))return new window.webkitAudioContext},setAudioContext:function(c){return this.context&&this.context.close(),this.masterMuteNode&&this.masterMuteNode.disconnect(),this.masterVolumeNode&&this.masterVolumeNode.disconnect(),this.context=c,this.masterMuteNode=c.createGain(),this.masterVolumeNode=c.createGain(),this.masterMuteNode.connect(this.masterVolumeNode),this.masterVolumeNode.connect(c.destination),this.destination=this.masterMuteNode,this},add:function(c,f){var u=new a(this,c,f);return this.sounds.push(u),u},decodeAudio:function(c,f){var u;Array.isArray(c)?u=c:u=[{key:c,data:f}];for(var p=this.game.cache.audio,d=u.length,g=0;g<u.length;g++){var m=u[g],E=m.key,v=m.data;typeof v=="string"&&(v=i(v));var y=function(A,x){p.add(A,x),this.emit(r.DECODED,A),d--,d===0&&this.emit(r.DECODED_ALL)}.bind(this,E),T=function(A,x){d--,d===0&&this.emit(r.DECODED_ALL)}.bind(this,E);this.context.decodeAudioData(v,y,T)}},setListenerPosition:function(c,f){return c===void 0&&(c=this.game.scale.width/2),f===void 0&&(f=this.game.scale.height/2),this.listenerPosition.set(c,f),this},unlock:function(){var c=this,f=document.body,u=function p(){if(c.context&&f){var d=f.removeEventListener.bind(f);c.context.resume().then(function(){d("touchstart",p),d("touchend",p),d("mousedown",p),d("mouseup",p),d("keydown",p),c.unlocked=!0},function(){d("touchstart",p),d("touchend",p),d("mousedown",p),d("mouseup",p),d("keydown",p)})}};f&&(f.addEventListener("touchstart",u,!1),f.addEventListener("touchend",u,!1),f.addEventListener("mousedown",u,!1),f.addEventListener("mouseup",u,!1),f.addEventListener("keydown",u,!1))},onBlur:function(){this.locked||this.context.suspend()},onFocus:function(){var c=this.context;c&&!this.locked&&(c.state==="suspended"||c.state==="interrupted")&&c.resume()},update:function(c,f){var u=this.context.listener;if(u&&u.positionX!==void 0){var p=h(this.listenerPosition,"x",null),d=h(this.listenerPosition,"y",null);p&&p!==this._spatialx&&(this._spatialx=u.positionX.value=p),d&&d!==this._spatialy&&(this._spatialy=u.positionY.value=d)}s.prototype.update.call(this,c,f),this.gameLostFocus||this.onFocus()},destroy:function(){if(this.destination=null,this.masterVolumeNode.disconnect(),this.masterVolumeNode=null,this.masterMuteNode.disconnect(),this.masterMuteNode=null,this.game.config.audio.context)this.context.suspend();else{var c=this;this.context.close().then(function(){c.context=null})}this.game.events.off(o.VISIBLE,this.onGameVisible,this),s.prototype.destroy.call(this)},setMute:function(c){return this.mute=c,this},mute:{get:function(){return this.masterMuteNode.gain.value===0},set:function(c){this.masterMuteNode.gain.setValueAtTime(c?0:1,0),this.emit(r.GLOBAL_MUTE,this,c)}},setVolume:function(c){return this.volume=c,this},volume:{get:function(){return this.masterVolumeNode.gain.value},set:function(c){this.masterVolumeNode.gain.setValueAtTime(c,0),this.emit(r.GLOBAL_VOLUME,this,c)}}});t.exports=l}),v1=S((e,t)=>{"use strict";var i=p1(),s=m1(),n={create:function(r){var o=r.config.audio,a=r.device.audio;return o.noAudio||!a.webAudio&&!a.audioData?new i(r):a.webAudio&&!o.disableWebAudio?new s(r):new i(r)}};t.exports=n}),E1=S((e,t)=>{"use strict";var i=Ga(),s=ju(),n=dw(),r=Ne(),o=V(),a=pw(),h=gw(),l=fw(),c=jn(),f=Yn(),u=mw(),p=Wt(),d=Ce(),g=Cl(),m=ae(),E=vw(),v=Cw(),y=Bl(),T=pn(),A=Uw(),x=Gw(),_=Yw();b=v1();var b,M=new o({initialize:function(w){this.config=new a(w),this.renderer=null,this.domContainer=null,this.canvas=null,this.context=null,this.isBooted=!1,this.isRunning=!1,this.events=new p,this.anims=new s(this),this.textures=new A(this),this.cache=new n(this),this.registry=new c(this,new p),this.input=new g(this,this.config),this.scene=new y(this,this.config.sceneConfig),this.device=f,this.scale=new v(this,this.config),this.sound=null,this.sound=b.create(this),this.loop=new x(this,this.config.fps),this.plugins=new E(this,this.config),this.pendingDestroy=!1,this.removeCanvas=!1,this.noReturn=!1,this.hasFocus=!1,this.isPaused=!1,u(this.boot.bind(this))},boot:function(){m.hasCore("EventEmitter")&&(this.isBooted=!0,this.config.preBoot(this),this.scale.preBoot(),l(this),h(this),i(this.canvas,this.config.parent),this.textures.once(T.READY,this.texturesReady,this),this.events.emit(d.BOOT))},texturesReady:function(){this.events.emit(d.READY),this.start()},start:function(){this.isRunning=!0,this.config.postBoot(this),this.renderer?this.loop.start(this.step.bind(this)):this.loop.start(this.headlessStep.bind(this)),_(this);var w=this.events;w.on(d.HIDDEN,this.onHidden,this),w.on(d.VISIBLE,this.onVisible,this),w.on(d.BLUR,this.onBlur,this),w.on(d.FOCUS,this.onFocus,this)},step:function(w,R){if(this.pendingDestroy)return this.runDestroy();if(!this.isPaused){var I=this.events;I.emit(d.PRE_STEP,w,R),I.emit(d.STEP,w,R),this.scene.update(w,R),I.emit(d.POST_STEP,w,R);var O=this.renderer;O.preRender(),I.emit(d.PRE_RENDER,O,w,R),this.scene.render(O),O.postRender(),I.emit(d.POST_RENDER,O,w,R)}},headlessStep:function(w,R){if(this.pendingDestroy)return this.runDestroy();if(!this.isPaused){var I=this.events;I.emit(d.PRE_STEP,w,R),I.emit(d.STEP,w,R),this.scene.update(w,R),I.emit(d.POST_STEP,w,R),this.scene.isProcessing=!1,I.emit(d.PRE_RENDER,null,w,R),I.emit(d.POST_RENDER,null,w,R)}},onHidden:function(){this.loop.pause(),this.events.emit(d.PAUSE)},pause:function(){var w=this.isPaused;this.isPaused=!0,w||this.events.emit(d.PAUSE)},onVisible:function(){this.loop.resume(),this.events.emit(d.RESUME,this.loop.pauseDuration)},resume:function(){var w=this.isPaused;this.isPaused=!1,w&&this.events.emit(d.RESUME,0)},onBlur:function(){this.hasFocus=!1,this.loop.blur()},onFocus:function(){this.hasFocus=!0,this.loop.focus()},getFrame:function(){return this.loop.frame},getTime:function(){return this.loop.now},destroy:function(w,R){R===void 0&&(R=!1),this.pendingDestroy=!0,this.removeCanvas=w,this.noReturn=R},runDestroy:function(){this.scene.destroy(),this.events.emit(d.DESTROY),this.events.removeAllListeners(),this.renderer&&this.renderer.destroy(),this.removeCanvas&&this.canvas&&(r.remove(this.canvas),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)),this.domContainer&&this.domContainer.parentNode&&this.domContainer.parentNode.removeChild(this.domContainer),this.loop.destroy(),this.pendingDestroy=!1}});t.exports=M});Sf(),Af(),xf(),wf(),Rf(),Cf(),_f();var U5=U(vl()),F5=U(o0()),G5=U(yE()),Y5=U(xE()),H5=U(LE()),W5=U(VE()),y1={BOOT_SCENE:"BootScene",LOAD_SCENE:"LoadScene",GAME_SCENE:"GameScene",GLOBAL_SCENE:"GlobalScene",TEST_LAYOUT_SCENE:"TestLayoutScene",DASHBOARD_SCENE:"DashboardScene"},ct=y1,T1={VIEW_RESIZED:"view-resized",REQUEST_VIEW_RESIZE:"request-view-resize",LAYOUT_CHANGED:"layout-changed",PRELOAD_LANGUAGE:"preload-language",CHOOSE_LANGUAGE:"choose-language",LOCALIZE_APPLIED:"localize-applied",COINS_CHANGED:"coins-changed",DESTROY_SCREENS:"destroy-screens"},Qt=T1,S1={Layout:{Portrait:"portrait",Landscape:"landscape"},DesignSize:{Portrait:{WIDTH:750,HEIGHT:1334},Landscape:{WIDTH:1920,HEIGHT:1080},Resolution:2,DesignScale:{Portrait:1,Landscape:1}},AcceptPortraitRatio:.72,PRIMARY_LAYOUT:"auto",FULL_PORTRAIT_SIZE:!0,FULL_LANDSCAPE_SIZE:!0},gr=S1,{event:eo}=codex,{Utils:{Browser:Rc,Function:A1,Device:x1}}=Ludex,{AcceptPortraitRatio:w1,DesignSize:{Portrait:Cc,Landscape:_c,Resolution:io,DesignScale:bc},FULL_PORTRAIT_SIZE:R1,FULL_LANDSCAPE_SIZE:C1}=gr,_1=class tn{game;static _instance;layoutMode;static get inst(){return this._instance||(this._instance=new tn),this._instance}static init(t){this.inst.game=t,t.canvas.id="GameCanvas",this.inst.listenEvents(),eo.emit(Qt.REQUEST_VIEW_RESIZE)}listenEvents(){new ResizeObserver(this.handleBodyResize).observe(window.document.body),eo.on(Qt.REQUEST_VIEW_RESIZE,this.resizeGame)}handleBodyResize=A1.debounce(()=>{this.resizeGame()},300);resizeGame=t=>{let{width:i,height:s}=tn.getWorldSize(),{width:n,height:r}=tn.getCanvasSize(),o=tn.getWorldScale();this.game.scale.resize(n,r),this.game.scale.setZoom(o);let a=tn.isLandscape()?"landscape":"portrait",h=!this.layoutMode||this.layoutMode===a?Qt.VIEW_RESIZED:Qt.LAYOUT_CHANGED;eo.emit(h,{width:i,height:s}),this.layoutMode=a};static dump(){let t=this.getPixelRatio(),i=this.getZoomRatio(),s=this.getWorldScale(),n=this.isFullPortrait(),r=this.isFullLandscape(),{width:o,height:a}=this.getWorldSize(),{width:h,height:l}=this.getDesignSize(),{width:c,height:f}=this.getScreenSize(),{width:u,height:p}=this.getCanvasSize()}static isLandscape(){return this.getScreenRatio()>w1}static isFullPortrait(){return!this.isLandscape()&&R1}static isFullLandscape(){return this.isLandscape()&&C1}static getZoomRatio(){let{width:t}=this.getCanvasSize(),{width:i}=this.getWorldSize();return t/i}static getWorldScale(){let{width:t,height:i}=this.getCanvasSize(),{width:s,height:n}=this.getScreenSize(),r=(s/t).toFixed(3),o=(n/i).toFixed(3);return Math.min(+r,+o)}static getDesignSize(){let t=Cc.WIDTH,i=Cc.HEIGHT;this.isLandscape()&&(t=_c.WIDTH,i=_c.HEIGHT);let s=this.isLandscape()?bc.Landscape:bc.Portrait,n=t/io*s,r=i/io*s;return{width:n,height:r}}static getWorldSize(){return this.isLandscape()?this.getWorldSizeLandscape():this.getWorldSizePortrait()}static getWorldSizePortrait(){let{width:t,height:i}=this.getDesignSize(),s=t,n=i,r=this.getDesignRatio(),o=this.getScreenRatio();return(o>r||this.isFullPortrait())&&(n=s/o),{width:s,height:n}}static getWorldSizeLandscape(){let{width:t,height:i}=this.getDesignSize(),{width:s,height:n}=this.getScreenSize(),r=t,o=i,a=this.getPixelRatio();if(!this.isFullLandscape())return{width:r,height:o};let{width:h}=this.calculateCanvasSizeForFullLandscape(),l=h/r;r=s*a/l,o=n*a/l;let c=r/o;return o<i&&(o=i,r=i*c),{width:r,height:o}}static calculateCanvasSizeForFullLandscape(){let{width:t,height:i}=this.getScreenSize(),s=this.getPixelRatio(),n=t*s,r=i*s,o=this.getDesignRatio(),a=this.getScreenRatio();return a>o?r=n/a:n=r*a,{width:n,height:r}}static getScreenSize(){let t=Rc.getScreenWidth(),i=Rc.getScreenHeight();return{width:t,height:i}}static getCanvasSize(){let{width:t,height:i}=this.getScreenSize(),s=this.getPixelRatio(),n=t*s,r=i*s;if(this.isFullLandscape()||this.isFullPortrait())return{width:n,height:r};let{width:o,height:a}=this.getWorldSize(),h=t/o,l=i/a,c=Math.min(h,l);return n=o*c*s,r=a*c*s,{width:n,height:r}}static getPixelRatio(){return Math.ceil(Math.min(x1.pixelRatio(),io))}static toPixelSize(t){let i=this.getPixelRatio();return Math.round(t*i)}static toDisplaySize(t){let i=this.getPixelRatio();return Math.round(t/i)}static getSizeForBackgroundMask(t){let{width:i,height:s}=this.getWorldSize();if(!t)return{width:i,height:s};let{width:n,height:r}=t,o=n||i,a=r||s,h=i/o,l=s/a;return{width:i*h,height:s*l}}static getDesignRatio(){let{width:t,height:i}=this.getDesignSize();return t/i}static getScreenRatio(){let{width:t,height:i}=this.getScreenSize();return t/i}static isGameWorldSmallerRatio(t){let{width:i,height:s}=this.getWorldSize();return i/s<=t}static isUsingLandscapeBackground(){let{width:t,height:i}=this.getWorldSize();return t/i>.796}},$=_1,b1=U(Ce()),P1={UNITS_SCREEN:"UNITS_SCREEN",READY_SCREEN:"READY_SCREEN",NOTIFY_SCREEN:"NOTIFY_SCREEN",RESULT_SCREEN:"RESULT_SCREEN",BATTLE_SCREEN:"BATTLE_SCREEN",LOADING_SCREEN:"LOADING_SCREEN",SETTINGS_SCREEN:"SETTINGS_SCREEN",UNIT_REWARD_SCREEN:"UNIT_REWARD_SCREEN",UNIT_UNLOCK_SCREEN:"UNIT_UNLOCK_SCREEN",LEADER_BOARD_SCREEN:"LEADER_BOARD_SCREEN",BATTLE_RESULT_SCREEN:"BATTLE_RESULT_SCREEN",OFFLINE_REWARD_SCREEN:"OFFLINE_REWARD_SCREEN",FREE_GOLD_REWARD_SCREEN:"FREE_GOLD_REWARD_SCREEN",CHALLENGE_SPLASH_SCREEN:"CHALLENGE_SPLASH_SCREEN",RESET_DATA_SCREEN:"RESET_DATA_SCREEN",START_OVER_POPUP:"START_OVER_POPUP",BOSS_CHALLENGE_SCREEN:"BOSS_CHALLENGE_SCREEN"},tt=P1,fr=U(Ue()),gt=class{static runTween(e,t){if(t===void 0){e.hasStarted?e.restart():e.play();return}if(t.aborted){e.stop();return}let i=()=>e.stop(),s=()=>t.off(i);t.once(i),e.once(fr.TWEEN_COMPLETE,s),e.once(fr.TWEEN_STOP,s),e.hasStarted?e.restart():e.play()}static runTweenAsync(e){return new Promise(t=>{e.off(fr.TWEEN_COMPLETE,t),e.once(fr.TWEEN_COMPLETE,t),e.hasStarted?e.restart():e.play()})}},L1=U(it()),I1=U(ft()),M1={duration:600,ease:I1.Cubic.Out,props:{alpha:{start:0,from:0,to:1}}},mr=M1,O1=U(yt()),{event:vr}=codex,{Utils:{Valid:D1}}=Ludex,k1=class extends L1.Container{zone;background;L;async animateBackgroundAlpha(e,t=400){this.scene&&(this.L?.remove(),this.L=this.scene.tweens.add({...mr,targets:[this.background],props:{alpha:(0,O1.Clamp)(e,.01,1)},duration:t,paused:!0,onComplete:()=>{this.background.setAlpha(e)}}),await gt.runTweenAsync(this.L))}constructor(e,t){super(e),this.setName(t);let{width:i,height:s}=$.getWorldSize();this.setWorldSize(i,s),this.V(),this.X(),this.registerEvents(),this.kill()}registerEvents(){vr.on(Qt.VIEW_RESIZED,this.p),vr.on(Qt.LAYOUT_CHANGED,this.p)}unregisterEvents(){vr.off(Qt.VIEW_RESIZED,this.p),vr.off(Qt.LAYOUT_CHANGED,this.p)}destroy(){this.unregisterEvents(),super.destroy()}open(e){this.revive(),D1.isObject(e)&&(this.setDataEnabled(),this.setData(e)),this.scene.children.bringToTop(this),this.p()}close(){this.kill()}incY(e){this.y+=e,this.background.y-=e}incX(e){this.x+=e,this.background.x-=e}incScale(e){this.scale+=e,this.background.scale-=e^e*(100/e)}V(){this.zone=this.scene.add.zone(0,0,0,0),this.zone.setWorldSize(this.width,this.height),this.zone.setInteractive(),this.add(this.zone)}X(){let e="screen-background";if(!this.scene.textures.exists(e)){let t=this.width+2,i=this.height+2,s=this.scene.add.graphics();s.fillStyle(0,1),s.fillRect(0,0,t,i),s.generateTexture(e,t,i),s.destroy()}this.background=this.scene.add.image(0,0,e),this.background.setWorldSize(this.width,this.height),this.add(this.background)}p=()=>{let{width:e,height:t}=$.getWorldSize();this.setWorldSize(e,t),this.zone.setSize(this.width,this.height),this.background.setWorldSize(this.width,this.height)};setBlockInputOutsideEnabled(e){this.scene.input.setTopOnly(e)}recalculateLightPosition(){}},ye=k1,B1=(e,t,i)=>{if(t&&i){let n=nt.getCurrentScene();if(!n)return;let r=n.children.getAll(),o=!0;for(let a of r)!(a instanceof ye)||a===i||a.visible&&(o=!1);if(!o)return}let s=document.getElementById("background-mask");s&&(s.style.backgroundColor=`rgba(0, 0, 0, ${e})`)},Pc=B1,N1=class{backgroundAlphaList;constructor(){this.backgroundAlphaList=[]}requestBackgroundMaskUpdate(e,t){let i=this.backgroundAlphaList.findIndex(s=>s.screenName===e);if(e===tt.CHALLENGE_SPLASH_SCREEN){let s=this.backgroundAlphaList.find(n=>n.screenName===tt.LOADING_SCREEN);if(s&&s.alpha!==0){this.handleChallengeSplashScreenCase();return}}i===-1?this.backgroundAlphaList.push({alpha:t,screenName:e}):this.backgroundAlphaList[i].alpha=t,this.updateBackgroundMask()}handleChallengeSplashScreenCase(){let e=this.backgroundAlphaList.findIndex(i=>i.screenName===tt.CHALLENGE_SPLASH_SCREEN),t=this.backgroundAlphaList.find(i=>i.screenName===tt.LOADING_SCREEN);t&&t.alpha!==0&&(e===-1?this.backgroundAlphaList.push({alpha:0,screenName:tt.CHALLENGE_SPLASH_SCREEN}):this.backgroundAlphaList[e].alpha=0)}updateBackgroundMask(){if(this.backgroundAlphaList.length===0){Pc(0);return}let e=1;this.backgroundAlphaList.forEach(t=>{e*=1-t.alpha}),Pc(1-e)}},U1=N1,F1=U(dt()),G1=U(Zt()),Y1=U(it()),H1=class extends Y1.Zone{constructor(e,t,i){super(e,0,0,t,i),this.setWorldSize(t,i)}},Lc=U(dt()),W1=U(kl()),fn=U(Nt()),{Events:Er,Utils:{Valid:yr}}=Ludex,{event:bs}=codex,z1=class extends W1.default{unsubscribeList;gameZone;background;handleResize=e=>{if(!this.background||!this.gameZone)return;let{width:t,height:i}=e;this.gameZone.setWorldSize(t,i),this.background.setWorldSize(t,i),this.scaleGame(),Lc.Align.In.Center(this.background,this.gameZone)};constructor(){super({visible:!1})}create(){bs.emit(Er.SCENE_LOADED,{sceneName:this.scene.key}),this.createGameZone(),this.scaleGame(),bs.on(Qt.VIEW_RESIZED,this.handleResize),bs.on(Qt.LAYOUT_CHANGED,this.handleResize),this.events.once(fn.RENDER,()=>{bs.emit(Er.SCENE_LAUNCHED,{sceneName:this.scene.key})}),this.events.on(fn.WAKE,this.handleSceneRendered),this.events.on(fn.RESUME,this.handleSceneRendered),this.events.on(fn.ADDED_TO_SCENE,e=>{"setWorldSize"in e&&yr.isFunction(e.setWorldSize)&&e.setWorldSize(),"setHighQuality"in e&&yr.isFunction(e.setHighQuality)&&e.setHighQuality()})}handleSceneRendered=()=>{bs.emit(Er.SCENE_RENDERED,{sceneName:this.scene.key}),this.events.once(fn.RENDER,()=>{bs.emit(Er.SCENE_LAUNCHED,{sceneName:this.scene.key})})};scaleGame(){let e=this.getCamera("main"),t=$.getZoomRatio();e.setZoom(t),e.startFollow(this.gameZone)}createGameZone(){let{width:e,height:t}=$.getWorldSize();this.gameZone=new H1(this,e,t)}getCamera(e){return e==="main"?this.cameras.main:this.cameras.getCamera(e)}createMask(e=1){this.getCamera("main").setBackgroundColor(`rgba(0, 0, 0, ${e})`)}fontSize(e){return e/1}createBackground(e,t,i,s){this.background?(this.background.setTexture(e),t&&this.background.setFrame(t)):this.background=this.make.image({key:e,frame:t}),this.background.setName(e);let{width:n,height:r}=this.gameZone;this.background.setWorldSize(n,r),yr.isNumber(i)&&this.background.setAlpha(i),yr.isNumber(s)&&this.background.setTint(s),Lc.Align.In.Center(this.background,this.gameZone)}},mn=z1,V1={FIELD_BACKGROUND:0,BACKGROUND:1,FIREWORKS:5,FIELD_SQUARE:10,FIELD_SQUARE_RECT:11,MANAGER_BASE_DEPTH:20,ENCOURAGING:31,MESSAGE:33,POPUP:40,DEPTH_ON_DRAG:70,UNIT_HP_BAR:71,DMG_POPUP_NUMBER:80,BUTTON:90,ITEM:91,EFFECT:95,PRIORITY:100,TUTORIAL_OBJECT:101,DEBUG:110,ON_TOP:1e4},rt=V1,{Utils:{Device:X1}}=Ludex,le=Math.ceil(Math.min(X1.pixelRatio(),2)),K1={DEFAULT_8_BIT:{KEY:"default-8bit-resources",PATH:`./assets/textures/${le}x/`,JSON:`./assets/textures/${le}x/default-8bit-resources.json`,FRAME:{BLANK:"blank",CHALLENGE_BACK_EFFECT:"challenge-screen/back-effect",CHALLENGE_FX:"challenge-screen/fx",CHALLENGE_GLOW:"challenge-screen/glow",CHALLENGE_GRADE_BLUE:"challenge-screen/grade-blue",CHALLENGE_GRADE_RED:"challenge-screen/grade-red",CHALLENGE_ICON_ENERGY:"challenge-screen/icon-energy",CHALLENGE_SHAPE:"challenge-screen/shape",CHALLENGE_VS:"challenge-screen/vs",RESULT_SCREEN_FX_WIN:"result-screen/win-fx",RESULT_SCREEN_FX_LOSE:"result-screen/lose-fx",RESULT_SCREEN_GOLD_ICON:"result-screen/golds",RESULT_SCREEN_GREEN_BUTTON:"result-screen/green-button",RESULT_SCREEN_SINGLE_COIN_ICON:"result-screen/mini-gold",RESULT_SCREEN_LEVEL_COMPLETE_TEXT:"result-screen/level-complete",RESULT_SCREEN_CONTINUE_TEXT:"result-screen/continue",RESULT_SCREEN_WIN_TEXT:"result-screen/victory",RESULT_SCREEN_CLAIM_TEXT:"result-screen/claim",RESULT_SCREEN_EARN_TEXT:"result-screen/you-earned",RESULT_SCREEN_RIBBON_WIN:"result-screen/ribbon-green",RESULT_SCREEN_RIBBON_LOSE:"result-screen/ribbon-red",RESULT_SCREEN_YELLOW_BUTTON:"result-screen/yellow-button",RESULT_SCREEN_GREEN_BUTTON_RESULT:"result-screen/green-button-result",UNIT_UNLOCK_GLOW:"unit-unlock/glow",UNIT_UNLOCK_BG:"unit-unlock/bg",UNIT_UNLOCK_BG_1:"unit-unlock/bg-1",UNIT_UNLOCK_FRAME:"unit-unlock/frame",UNIT_UNLOCK_ICON_BATTLE:"unit-unlock/icon-battle",UNIT_UNLOCK_ICON_HEART:"unit-unlock/icon-heart",UNIT_UNLOCK_ROTATE:"unit-unlock/rotate",UNIT_REWARD_ELLIPSE_FX:"unit-reward/ellipse-fx",UNIT_REWARD_FX:"unit-reward/fx",UNIT_REWARD_GLOW:"unit-reward/glow",UNIT_REWARD_GIFT:"unit-reward/gift",UNIT_REWARD_GIFT_GLOW:"unit-reward/gift-glow",UNIT_REWARD_NO_THANKS_TEXT:"unit-reward/no-thanks-text",UNIT_REWARD_GIFT_AD:"unit-reward/gift-ad",UNIT_REWARD_PARTICLE:"unit-reward/particle",TEXT_LOADING:"loading",PRELOADER:"preloader/dual-ring",LEADERBOARD_BG_DARK:"leaderboards/bg-dark",LEADERBOARD_BG_LIGHT:"leaderboards/bg-light",LEADERBOARD_BG_LOSE:"leaderboards/bg-lose",LEADERBOARD_BG_WIN:"leaderboards/bg-win",LEADERBOARD_TAB_BG:"leaderboards/tab-bg",LEADERBOARD_TAB_LINE:"leaderboards/tab-focus",LEADERBOARD_AVATAR:"leaderboards/avatar",LEADERBOARD_RANK_GOLD:"leaderboards/rank-gold",LEADERBOARD_RANK_SILVER:"leaderboards/rank-silver",LEADERBOARD_RANK_COPPER:"leaderboards/rank-copper",LEADERBOARD_BUTTON_GREEN:"leaderboards/green-button",RIBBON_GREEN:"ribbon/green",ICON_AD:"icons/ad-icon",ICON_VIBRATION:"icons/vib",ICON_MUSIC:"icons/music",ICON_SOUND:"icons/sound",ICON_SHARE:"icons/share",ICON_BATTLE:"icons/battle",ICON_TITLE:"icons/title",ICON_ALERT:"icons/alert",ICON_BACK_TO:"icons/back-to",ICON_REPLAY:"icons/replay",ICON_QUICK_FIGHT:"icons/quick-fight",BUTTON_CLOSE:"buttons/close",BUTTON_GREEN:"buttons/green",BUTTON_GREEN_LONG:"buttons/green-long",BUTTON_RED:"buttons/red",OFFLINE_REWARD_ADS:"offline-reward/ads",OFFLINE_REWARD_CLOSE_BTN:"offline-reward/close-btn",OFFLINE_REWARD_GOLD:"offline-reward/gold",OFFLINE_REWARD_GOLDS:"offline-reward/golds",OFFLINE_REWARD_GREEN_BTN:"offline-reward/green-btn",OFFLINE_REWARD_PARTICLE_1:"offline-reward/particle-1",OFFLINE_REWARD_PARTICLE_2:"offline-reward/particle-2",OFFLINE_REWARD_RIBBON:"offline-reward/ribbon",OFFLINE_REWARD_TICKET:"offline-reward/ticket",OFFLINE_REWARD_YELLOW_BTN:"offline-reward/yellow-btn",UNIT_SCREEN_AD_BUTTON:"unit-screen/ad-button",UNIT_SCREEN_AD_COUNT_BG:"unit-screen/ad-count-bg",UNIT_SCREEN_AD_ICON:"unit-screen/ad-icon",UNIT_SCREEN_BAR:"unit-screen/bar",UNIT_SCREEN_BG:"unit-screen/bg",UNIT_SCREEN_COIN_ICON:"unit-screen/coin-icon",UNIT_SCREEN_FRAME_1:"unit-screen/frame-1",UNIT_SCREEN_FRAME_LOCKED:"unit-screen/frame-locked",UNIT_SCREEN_ICON_BATTLE:"unit-screen/icon-battle",UNIT_SCREEN_ICON_HEART:"unit-screen/icon-heart",UNIT_SCREEN_ICON_LOCK:"unit-screen/icon-lock",UNIT_SCREEN_SLIDEBAR_BG:"unit-screen/slidebar-bg",UNIT_SCREEN_TAB_BG:"unit-screen/tab-bg",UNIT_SCREEN_TAB_FOCUS:"unit-screen/tab-focus",WHEEL_ARROW:"reward-wheel/arrow",WHEEL_LUCKY_SPIN:"reward-wheel/lucky-spin"}},DEFAULT:{KEY:"default-resources",TEXTURE:`./assets/textures/${le}x/default-resources.png`,JSON:`./assets/textures/${le}x/default-resources.json`,FRAME:{BLANK:"blank",RIBBON_BLUE:"ribbon/blue",PROGRESS_BAR_MID:"progress/bar-mid",PROGRESS_BG_LEFT:"progress/bg-left",PROGRESS_BG_MID:"progress/bg-mid",PROGRESS_BG_RIGHT:"progress/bg-right",PROGRESS_BAR_LEFT:"progress/bar-left",PROGRESS_BAR_RIGHT:"progress/bar-right",SETTINGS_SWITCH_ON:"settings/switch-on",SETTINGS_SWITCH_OFF:"settings/switch-off",TITLE_LINE:"settings/title-line",DASHBOARD_UNITBAR_BOTTOM_BG:"dashboard/unitbar-bottom-bg"}},EFFECTS:{KEY:"effects-resources",PATH:`./assets/textures/${le}x/`,JSON:`./assets/textures/${le}x/effects-resources.json`,FRAME:{BLANK:"blank",FX_COMET:"comet",FX_SPARK:"spark",FX_CIRCLE:"circle",FX_CIRCLE_LIGHT:"circle-light",FX_GLOW_LIGHT:"glow-light",FX_GLOW_SMALL:"glow-small",FX_STAR_WHITE:"star-white",FX_STAR_YELLOW:"star-yellow",FX_WHITE_GLOW:"white-glow",FX_CONFETTI_SMALL_1:"confetti/small-1",FX_CONFETTI_SMALL_2:"confetti/small-2",FX_CONFETTI_SMALL_3:"confetti/small-3",FX_CONFETTI_SMALL_4:"confetti/small-4",FX_CONFETTI_HEXAGON:"confetti/hexagon-",FX_FIREWORKS_SMALL:"fireworks/small",FX_FIREWORKS_BIG_0:"fireworks/big-explosive-0",FX_FIREWORKS_BIG_1:"fireworks/big-explosive-1",FX_FIREWORKS_SOAR_LINE:"fireworks/soar-line",FX_FIREWORKS_SOAR_CIRCLE:"fireworks/soar-circle",ANIMATION_STAR_X:"star-x/star-",ANIMATION_STAR_Y:"star-y/star-",PREFIX_ANIMATION_RIBBON_CONFETTI_A:"ribbon/falling-confetti/confetti-a/confetti-a-",PREFIX_ANIMATION_RIBBON_CONFETTI_B:"ribbon/falling-confetti/confetti-b/confetti-b-",PREFIX_ANIMATION_RIBBON_CONFETTI_C:"ribbon/falling-confetti/confetti-c/confetti-c-",PREFIX_ANIMATION_RIBBON_CONFETTI_D:"ribbon/falling-confetti/confetti-d/confetti-d-"}},ANIMATION_SCENE:{KEY:"effects-resources",PATH:`./assets/textures/${le}x/`,JSON:`./assets/textures/${le}x/animation-scene-resources.json`,FRAME:{BLANK:"blank",COIN:"coins/coin",COIN_SMALL:"coins/coin-small",COIN_SMALL_GREY:"coins/coin-small-grey",ANIMATION_STAR_X:"star-x/star-",ANIMATION_STAR_Y:"star-y/star-",FX_SPARK_YELLOW:"yellow-spark",FX_CONFETTI_RIBBON:"ribbon/ribbon",PREFIX_ANIMATION_RIBBON_CONFETTI_A:"ribbon/falling-confetti/confetti-a/confetti-a-",PREFIX_ANIMATION_RIBBON_CONFETTI_B:"ribbon/falling-confetti/confetti-b/confetti-b-",PREFIX_ANIMATION_RIBBON_CONFETTI_C:"ribbon/falling-confetti/confetti-c/confetti-c-",PREFIX_ANIMATION_RIBBON_CONFETTI_D:"ribbon/falling-confetti/confetti-d/confetti-d-"}},GAMEPLAY:{KEY:"gameplay-resources",TEXTURE:`./assets/textures/${le}x/gameplay-resources.png`,JSON:`./assets/textures/${le}x/gameplay-resources.json`,FRAME:{BLANK:"blank",GUIDE_HAND:"hand-guide/hand",GUIDE_ARROW_START:"hand-guide/arrow-start",GUIDE_ARROW_END:"hand-guide/arrow-end",GUIDE_ARROW_MIDDLE:"hand-guide/arrow-middle",HP_BAR_BG:"hp-bar/bg",TOOL_RESET:"dev-tool/reset",TOOL_EDIT:"dev-tool/edit",TOOL_ATTACK:"dev-tool/attack",TOOL_UNIT:"dev-tool/unit",ROCK:"projectiles/rock",JAVELIN:"projectiles/javelin",BOOMERANG:"projectiles/boomerang",MACE:"projectiles/mace",ARROW_1:"projectiles/arrow-1",ARROW_2:"projectiles/arrow-2",BOLT_1:"projectiles/bolt-1",BOLT_2:"projectiles/bolt-2",FIRE_RING:"projectiles/fire-ring",BLUE_FIRE:"projectiles/blue-fire",GREEN_FIRE:"projectiles/level11/green-fire-1",GREEN_FIRE_PREFIX:"projectiles/level11/green-fire-",DASHBOARD_AD_ICON:"dashboard/ad-icon",DASHBOARD_FREE_GOLD:"dashboard/btn-free-gold",DASHBOARD_FREE_GOLD_OFF:"dashboard/btn-free-gold-off",DASHBOARD_FREE_GOLD_GLOW:"dashboard/btn-free-gold-glow",DASHBOARD_COINBAR_COIN:"dashboard/coin-bar-coin",DASHBOARD_COINBAR_BG:"dashboard/coin-bar-bg",DASHBOARD_MINI_COIN:"dashboard/coin-mini",DASHBOARD_UNIT_LIST:"dashboard/btn-unit-list",DASHBOARD_UNITBAR_BG:"dashboard/unitbar-bg",DASHBOARD_UNITBAR_STAMPS:"dashboard/unitbar-stamps",DASHBOARD_UNITBAR_ARCHER:"dashboard/unitbar-archer",DASHBOARD_UNITBAR_DINO:"dashboard/unitbar-dino",DASHBOARD_START_BTN:"dashboard/btn-start",DASHBOARD_SETTINGS_BTN:"dashboard/btn-settings",DASHBOARD_LEADERBOARD_BTN:"dashboard/btn-leaderboard",DASHBOARD_BATTLE_BTN:"dashboard/btn-battle",DASHBOARD_SPEED_BTN_OFF:"dashboard/btn-speed-off",DASHBOARD_SPEED_BTN_ON:"dashboard/btn-speed-on",DASHBOARD_HPBAR_BG:"dashboard/bar/bg",DASHBOARD_HPBAR_FRONT:"dashboard/bar/bg-front",DASHBOARD_HPBAR_RED_LEFT:"dashboard/bar/red-bar/bar-left",DASHBOARD_HPBAR_RED_RIGHT:"dashboard/bar/red-bar/bar-right",DASHBOARD_HPBAR_RED_MID:"dashboard/bar/red-bar/bar-mid",DASHBOARD_HPBAR_RED:"dashboard/bar/red-bar/full-bar",DASHBOARD_HPBAR_RED_HEART:"dashboard/bar/red-bar/icon-heart-red",DASHBOARD_HPBAR_BLUE_LEFT:"dashboard/bar/blue-bar/bar-left",DASHBOARD_HPBAR_BLUE_RIGHT:"dashboard/bar/blue-bar/bar-right",DASHBOARD_HPBAR_BLUE_MID:"dashboard/bar/blue-bar/bar-mid",DASHBOARD_HPBAR_BLUE:"dashboard/bar/blue-bar/full-bar",DASHBOARD_HPBAR_BLUE_HEART:"dashboard/bar/blue-bar/icon-heart-blue",DASHBOARD_BATTLE_BUTTON_GREEN:"dashboard/btn-battle-green",DASHBOARD_BATTLE_ICON:"dashboard/icon-battle",DASHBOARD_MESSAGE_ICON:"dashboard/icon-message",DASHBOARD_AVATAR_FRAME_BLUE:"dashboard/avatar-frame-blue",DASHBOARD_AVATAR_FRAME_RED:"dashboard/avatar-frame-red",DASHBOARD_VS:"dashboard/vs",DASHBOARD_UNITBAR_BG_LANDSCAPE:"dashboard/unitbar-bg-landscape",DASHBOARD_AD_ICON_LANDSCAPE:"dashboard/ad-icon-landscape",DASHBOARD_START_BTN_LANDSCAPE:"dashboard/btn-start-landscape",DASHBOARD_BOSS_BTN:"dashboard/btn-boss-on",DASHBOARD_BOSS_BTN_OFF:"dashboard/btn-boss-off",PURPLE_EFFECT:"effect-text/purple-effect",EFFECT_WIN_GLOW:"effect-text/win/glow",EFFECT_WIN_SHAPE_ABOVE:"effect-text/win/shape-above",EFFECT_WIN_SHAPE_BELOW:"effect-text/win/shape-below",EFFECT_LOSE_GLOW:"effect-text/lose/glow",EFFECT_LOSE_SHAPE_ABOVE:"effect-text/lose/shape-above",EFFECT_LOSE_SHAPE_BELOW:"effect-text/lose/shape-below"}},UNITS:{KEY:"units-resources",PATH:`./assets/textures/${le}x/`,JSON:`./assets/textures/${le}x/units-resources.json`,FRAME:{DINO_MALE_DOUX_PREFIX:"dino/male/doux/doux-",DINO_MALE_KIRA_PREFIX:"dino/male/kira/kira-",DINO_MALE_LOKI_PREFIX:"dino/male/loki/loki-",DINO_MALE_MORT_PREFIX:"dino/male/mort/mort-",DINO_MALE_NICO_PREFIX:"dino/male/nico/nico-",DINO_MALE_OLAF_PREFIX:"dino/male/olaf/olaf-",DINO_MALE_TARD_PREFIX:"dino/male/tard/tard-",DINO_MALE_VITA_PREFIX:"dino/male/vita/vita-",DINO_FEMALE_DOUX_PREFIX:"dino/female/doux/doux-",DINO_FEMALE_KIRA_PREFIX:"dino/female/kira/kira-",DINO_FEMALE_LOKI_PREFIX:"dino/female/loki/loki-",DINO_FEMALE_MORT_PREFIX:"dino/female/mort/mort-",DINO_FEMALE_NICO_PREFIX:"dino/female/nico/nico-",DINO_FEMALE_OLAF_PREFIX:"dino/female/olaf/olaf-",DINO_FEMALE_TARD_PREFIX:"dino/female/tard/tard-",DINO_FEMALE_VITA_PREFIX:"dino/female/vita/vita-",LOCKED:{MELEE:{1:"dino-locked/lv01-velociraptor",2:"dino-locked/lv02-saurolophus",3:"dino-locked/lv03-pachysaurus",4:"dino-locked/lv04-triceratops",5:"dino-locked/lv05-stegosaurus",6:"dino-locked/lv06-ankylosaurus",7:"dino-locked/lv07-baroptiloraptor",8:"dino-locked/lv08-tyrannosaurus",9:"dino-locked/lv09-dilophosaurus",10:"dino-locked/lv10-triceradonosaurus",11:"dino-locked/lv11-spinosaurus-rex"},RANGED:{1:"warriors-locked/lv01-rockthrower",2:"warriors-locked/lv02-javelineer",3:"warriors-locked/lv03-boomeranger",4:"warriors-locked/lv04-macer",5:"warriors-locked/lv05-artemis",6:"warriors-locked/lv06-william",7:"warriors-locked/lv07-blanchette",8:"warriors-locked/lv08-phantom",9:"warriors-locked/lv09-oracle",10:"warriors-locked/lv10-shaman",11:"warriors-locked/lv11-seraph"}},UNLOCKED:{MELEE:{1:"dino-unlocked/lv01-velociraptor",2:"dino-unlocked/lv02-saurolophus",3:"dino-unlocked/lv03-pachysaurus",4:"dino-unlocked/lv04-triceratops",5:"dino-unlocked/lv05-stegosaurus",6:"dino-unlocked/lv06-ankylosaurus",7:"dino-unlocked/lv07-baroptiloraptor",8:"dino-unlocked/lv08-tyrannosaurus",9:"dino-unlocked/lv09-dilophosaurus",10:"dino-unlocked/lv10-triceradonosaurus",11:"dino-unlocked/lv11-spinosaurus-rex"},RANGED:{1:"warriors-unlocked/lv01-rockthrower",2:"warriors-unlocked/lv02-javelineer",3:"warriors-unlocked/lv03-boomeranger",4:"warriors-unlocked/lv04-macer",5:"warriors-unlocked/lv05-artemis",6:"warriors-unlocked/lv06-william",7:"warriors-unlocked/lv07-blanchette",8:"warriors-unlocked/lv08-phantom",9:"warriors-unlocked/lv09-oracle",10:"warriors-unlocked/lv10-shaman",11:"warriors-unlocked/lv11-seraph"}}}},UNITS_SPRITES:{KEY:"units-sprite-resources",PATH:`./assets/textures/${le}x/`,JSON:`./assets/textures/${le}x/units-sprite-resources.json`,FRAME:{MELEE:{1:{MAIN_TEXTURE:"melee-1/idle/idle-00",ATTACK_PREFIX:"melee-1/attack/attack-",DIE_PREFIX:"melee-1/die/die-",IDLE_PREFIX:"melee-1/idle/idle-",RUN_PREFIX:"melee-1/run/run-"}},RANGED:{1:{MAIN_TEXTURE:"ranged-1/idle/idle-00",ATTACK_PREFIX:"ranged-1/attack/attack-",DIE_PREFIX:"ranged-1/die/die-",IDLE_PREFIX:"ranged-1/idle/idle-"}}}},UNITS_SPINES:{MELEE:{1:{KEY:"velociraptor-spine",jsonPATH:"./assets/spines/units/melee-1/velociraptor.json",atlasPATH:"./assets/spines/units/melee-1/velociraptor.atlas"},2:{KEY:"saurolophus-spine",jsonPATH:"./assets/spines/units/melee-2/saurolophus.json",atlasPATH:"./assets/spines/units/melee-2/saurolophus.atlas"},3:{KEY:"pachysaurus-spine",jsonPATH:"./assets/spines/units/melee-3/pachysaurus.json",atlasPATH:"./assets/spines/units/melee-3/pachysaurus.atlas"},4:{KEY:"triceratops-spine",jsonPATH:"./assets/spines/units/melee-4/triceratops.json",atlasPATH:"./assets/spines/units/melee-4/triceratops.atlas"},5:{KEY:"stegosaurus-spine",jsonPATH:"./assets/spines/units/melee-5/stegosaurus.json",atlasPATH:"./assets/spines/units/melee-5/stegosaurus.atlas"},6:{KEY:"ankyntrosaurus-spine",jsonPATH:"./assets/spines/units/melee-6/ankyntrosaurus.json",atlasPATH:"./assets/spines/units/melee-6/ankyntrosaurus.atlas"},7:{KEY:"baroptiloraptor-spine",jsonPATH:"./assets/spines/units/melee-7/baroptiloraptor.json",atlasPATH:"./assets/spines/units/melee-7/baroptiloraptor.atlas"},8:{KEY:"tyrannosaurus-spine",jsonPATH:"./assets/spines/units/melee-8/tyrannosaurus.json",atlasPATH:"./assets/spines/units/melee-8/tyrannosaurus.atlas"},9:{KEY:"dilophosaurus-spine",jsonPATH:"./assets/spines/units/melee-9/dilophosaurus.json",atlasPATH:"./assets/spines/units/melee-9/dilophosaurus.atlas"},10:{KEY:"triceradonosaurus-spine",jsonPATH:"./assets/spines/units/melee-10/triceradonosaurus.json",atlasPATH:"./assets/spines/units/melee-10/triceradonosaurus.atlas"},11:{KEY:"spinosaurus-rex-spine",jsonPATH:"./assets/spines/units/melee-11/spinosaurus-rex.json",atlasPATH:"./assets/spines/units/melee-11/spinosaurus-rex.atlas"}},RANGED:{1:{KEY:"rockthrower-spine",jsonPATH:"./assets/spines/units/ranged-1/rockthrower.json",atlasPATH:"./assets/spines/units/ranged-1/rockthrower.atlas"},2:{KEY:"javelineer-spine",jsonPATH:"./assets/spines/units/ranged-2/javelineer.json",atlasPATH:"./assets/spines/units/ranged-2/javelineer.atlas"},3:{KEY:"boomeranger-spine",jsonPATH:"./assets/spines/units/ranged-3/boomeranger.json",atlasPATH:"./assets/spines/units/ranged-3/boomeranger.atlas"},4:{KEY:"macer-spine",jsonPATH:"./assets/spines/units/ranged-4/macer.json",atlasPATH:"./assets/spines/units/ranged-4/macer.atlas"},5:{KEY:"artemis-spine",jsonPATH:"./assets/spines/units/ranged-5/artemis.json",atlasPATH:"./assets/spines/units/ranged-5/artemis.atlas"},6:{KEY:"william-spine",jsonPATH:"./assets/spines/units/ranged-6/william.json",atlasPATH:"./assets/spines/units/ranged-6/william.atlas"},7:{KEY:"blanchette-spine",jsonPATH:"./assets/spines/units/ranged-7/blanchette.json",atlasPATH:"./assets/spines/units/ranged-7/blanchette.atlas"},8:{KEY:"phantom-spine",jsonPATH:"./assets/spines/units/ranged-8/phantom.json",atlasPATH:"./assets/spines/units/ranged-8/phantom.atlas"},9:{KEY:"oracle-spine",jsonPATH:"./assets/spines/units/ranged-9/oracle.json",atlasPATH:"./assets/spines/units/ranged-9/oracle.atlas"},10:{KEY:"shaman-spine",jsonPATH:"./assets/spines/units/ranged-10/shaman.json",atlasPATH:"./assets/spines/units/ranged-10/shaman.atlas"},11:{KEY:"seraph-spine",jsonPATH:"./assets/spines/units/ranged-11/seraph.json",atlasPATH:"./assets/spines/units/ranged-11/seraph.atlas"}}},SPINE_EFFECTS:{FX_MERGE:{KEY:"fx-merge-spine",jsonPATH:"./assets/spines/effects/merge/fx_merge.json",atlasPATH:"./assets/spines/effects/merge/fx_merge.atlas"}}},W=K1,j1="Lilita One",Z1={tr:"Baloo 2",ja:"M PLUS 1p",en:"Lilita One"},q1={tr:"Baloo 2",ja:"M PLUS 1p",en:"Lilita One"},Q1={en:"assets/json/language/en.json",ru:"assets/json/language/ru.json",ja:"assets/json/language/ja.json",zh:"assets/json/language/zh.json",pt:"assets/json/language/pt.json",es:"assets/json/language/es.json",tr:"assets/json/language/tr.json",fr:"assets/json/language/fr.json",id:"assets/json/language/id.json",de:"assets/json/language/de.json",it:"assets/json/language/it.json"},Ic=Q1,J1=U(Ku()),{Utils:{Array:so,Function:$1}}=Ludex,{language:Ei}=codex,Mc=Object.keys(Ic),Ye="en";function tR(e){return e.reduce((t,i)=>(i.status==="fulfilled"?t.successes.push(i.value):t.failures.push(i.reason),t),{successes:[],failures:[]})}function Oc(e){return so.search(Mc,t=>t===e)!==void 0}var no=class extends Error{locales;constructor(...e){super(`Failed to load languages: ${e.join(", ")}`),this.name="LanguageLoadingError",this.locales=e}},Ps=class tf{static inst;constructor(){}static get instance(){return this.inst||(this.inst=new tf),this.inst}async loadAllLanguages(t){let i=await this.loadLanguages(t,Mc),{successes:s,failures:n}=i;for(let{locale:r,data:o}of s)Ei.add(r,o);if(n.length>0){let r=n.flatMap(o=>o.locales);throw new no(...r)}}async loadPlayerLanguage(t){let i=Ei.getPlayerLanguage();if(!Oc(i)||i===Ye){let{successes:o,failures:a}=await this.loadLanguages(t,[Ye]);if(a.length>0)throw a[0];let{data:h}=o[0];Ei.add(Ye,h,!0),Ei.choose(Ye);return}let{successes:s}=await this.loadLanguages(t,[Ye,i]),n=so.search(s,o=>o.locale===Ye),r=so.search(s,o=>o.locale===i);if(!n)throw new no(Ye);Ei.add(Ye,n.data,!0),Ei.choose(Ye),r&&(Ei.add(i,r.data),Ei.choose(i))}async loadLanguages(t,i){let s=i.map(r=>this.queueLanguage(t,r));t.load.start();let n=await $1.allSettled(s);return tR(n)}queueLanguage(t,i){let s=t.cache.json.get(i);return s?Promise.resolve({locale:i,data:s}):new Promise((n,r)=>{let o=(p,d,g)=>{f(g)},a=p=>{p instanceof J1.FileTypes.JSONFile&&p.key===i&&u(new no(i))},h=()=>{t.load.json(i,Ic[i])},l=()=>{t.load.once(`filecomplete-json-${i}`,o),t.load.on("loaderror",a)},c=()=>{t.load.off(`filecomplete-json-${i}`,o),t.load.off("loaderror",a)},f=p=>{c(),n({locale:i,data:p})},u=p=>{c(),r(p)};l(),h()})}getPlayerLocale(){let t=Ei.getPlayerLanguage();return!Oc(t)||t===Ye?Ye:t}},eR=1,Zi=18,Tr={CLIP:"clip",ELLIPSIS:"ellipsis"},ro=class ef{static getLocaleFont(t){return Z1[t]??j1}static getGoogleFontFamilies(t){return[q1[t]??'"Lilita One"']}static getModSize(t,i=eR){return t*i}static createText(t,i,s=Zi){let n=Ps.instance.getPlayerLocale(),r=this.getLocaleFont(n);return t.make.text({text:i,padding:{left:2,right:2,top:1,bottom:1},origin:{x:.5,y:.5},style:{fontSize:`${s}px`,fontStyle:"500",fontFamily:r}})}static buildText(t,i=Zi){return new iR(t,i)}static createStrokeText(t,i,s=Zi){return this.createText(t,i,s).setStroke("#000000",2)}static createUnderlineText(t,i,s=Zi){if(!i)return this.createText(t,"",s);let n=this.createText(t,"_",s),r=this.getUnderscoreWidth(n),o=this.getTextWidthForUnderscore(n,i),a=Math.ceil(o/r),h=-(s*.9);return n.setLineSpacing(h),n.setText(`${i}
${"_".repeat(a)}`),n}static getUnderscoreWidth(t){t.setText("_".repeat(5));let{left:i=0,right:s=0}=t.padding;return(t.getBounds().width-i-s)/5}static getTextWidthForUnderscore(t,i){t.setText(i);let{left:s=0,right:n=0}=t.padding;return t.getBounds().width-s-n}static applyShadow(t,i="#000000",s=0,n=3,r=.5){return t.setShadow(s,n,i,r)}static calcStrokeWidth(t,i=1){let{fontSize:s}=t.style,n=Zi;return typeof s=="string"&&(n=+s.replace("px","")),n*.2*i}static calcStrokeWidthSimple(t,i=1){return t*.2*i}static setTruncateOverflow(t,i,s=Tr.ELLIPSIS){return t.setWordWrapWidth(i).setWordWrapCallback(ef.applyTruncate(s))}static applyTruncate=(t=Tr.ELLIPSIS)=>(i,s)=>{let{wordWrapWidth:n}=s.style,r=n??0,o=s.context,a=t===Tr.CLIP?"":"...";if(o.measureText(i).width<=r)return i;let h=i;for(;o.measureText(`${h}${a}`).width>r;)h=h.slice(0,-1);return`${h}${a}`}},iR=class{config;postCreateActions=[];constructor(e,t=Zi){let i=Ps.instance.getPlayerLocale(),s=ro.getLocaleFont(i);this.config={text:e,padding:{left:2,right:2,top:1,bottom:1},origin:{x:.5,y:.5},style:{fontSize:`${t}px`,fontStyle:"500",fontFamily:s}}}build(e){let t=e.make.text(this.config);for(let i of this.postCreateActions)i(t);return this.postCreateActions=[],t}getConfig(){return this.config}addPostCreateAction(e){return this.postCreateActions.push(e),this}setDefaultStroke(){return this.setStrokeColor("#000000"),this.setStrokeThickness(2),this}setFloatCoinStroke(){return this.setStrokeColor("#000000"),this.setStrokeThickness(1),this}setDefaultShadow(e={}){let t=this.getConfig();return this.setShadow({...t.style?.shadow,offsetX:0,offsetY:0,fill:!0,stroke:!0,color:"#000000",blur:0,...e}),this}applyScreenHeaderStyle(){this.setDefaultStroke();let e=this.getConfig();return this.setShadow({...e.style?.shadow,offsetX:-4,offsetY:4,fill:!0,stroke:!0}),this.setFixedWidth(13*25),this.setAlign("center"),this.setHighQuality(),this}setText(e){return this.config={...this.config,text:e},this}setStyle(e){return this.config={...this.config,style:e},this}setFont(e){return this.config={...this.config,style:{...this.config.style,font:e}},this}setFontFamily(e){return this.config={...this.config,style:{...this.config.style,fontFamily:e}},this}setFontSize(e){return this.config={...this.config,style:{...this.config.style,fontSize:e}},this}setFontStyle(e){return this.config={...this.config,style:{...this.config.style,fontStyle:e}},this}setFixedWidth(e){return this.config={...this.config,style:{...this.config.style,fixedWidth:e}},this}setFixedHeight(e){return this.config={...this.config,style:{...this.config.style,fixedHeight:e}},this}setBackgroundColor(e){return this.config={...this.config,style:{...this.config.style,backgroundColor:e}},this}setColor(e){return this.config={...this.config,style:{...this.config.style,color:e}},this}setStrokeColor(e){return this.config={...this.config,style:{...this.config.style,stroke:e}},this}setStrokeThickness(e){return this.config={...this.config,style:{...this.config.style,strokeThickness:e}},this}setShadow(e){return this.config={...this.config,style:{...this.config.style,shadow:e}},this}setWordWrap(e){return this.config={...this.config,style:{...this.config.style,wordWrap:e}},this}setTruncateOverflow(e,t=Tr.ELLIPSIS){return this.config={...this.config,style:{...this.config.style,wordWrap:{...this.config.style?.wordWrap,width:e,callback:ro.applyTruncate(t)}}},this}setAlign(e){return this.config={...this.config,style:{...this.config.style,align:e}},this}setResolution(e){return this.config={...this.config,style:{...this.config.style,resolution:e}},this}setHighQuality(){return this.setResolution(gr.DesignSize.Resolution)}setLineSpacing(e){return this.config={...this.config,style:{...this.config.style,lineSpacing:e}},this}setLetterSpacing(e){return this.config={...this.config,style:{...this.config.style,letterSpacing:e}},this}setPadding(e){return this.config={...this.config,padding:e},this}setMaxLines(e){return this.config={...this.config,style:{...this.config.style,maxLines:e}},this}setRTL(e){return this.config={...this.config,style:{...this.config.style,rtl:e}},this}setAlpha(e){return this.config={...this.config,alpha:e},this}setDepth(e){return this.config={...this.config,depth:e},this}setFlipX(e){return this.config={...this.config,flipX:e},this}setFlipY(e){return this.config={...this.config,flipY:e},this}setOrigin(e){return this.config={...this.config,origin:e},this}setScrollFactor(e){return this.config={...this.config,scrollFactor:e},this}setRotation(e){return this.config={...this.config,rotation:e},this}setAngle(e){return this.config={...this.config,angle:e},this}setScale(e){return this.config={...this.config,scale:e},this}setX(e){return this.config={...this.config,x:e},this}setY(e){return this.config={...this.config,y:e},this}setVisible(e){return this.config={...this.config,visible:e},this}setTint(e,t,i,s){return this.addPostCreateAction(n=>n.setTint(e,t,i,s)),this}static calcStrokeWidth(e,t=1){return(s=>s*.2*t)(typeof e=="number"?e:typeof e=="string"?parseFloat(e.replace("px","")):Zi)}},Z=ro,sR=U(dt()),nR=U(it()),rR=U(Zt()),Dc=U(Nt()),{Utils:{Valid:aR}}=Ludex,{KEY:oR,FRAME:hR}=W.DEFAULT,lR=class extends nR.Container{fps=0;fpsString="FPS: %1";fpsText;background;zone;lastUpdate;constructor(e){super(e,0,0),this.createFps(),this.createInputZone(),this.setDepth(rt.DEBUG),this.scene.add.existing(this),aR.isDebugger()?this.enable():this.disable()}update=e=>{if(e-this.lastUpdate<800)return;this.lastUpdate=e;let t=Math.floor(this.scene.game.loop.actualFps);this.setFps(t)};setFps(e){this.fps=e;let t=this.fpsString.replace("%1",e.toString());this.fpsText.setText(t)}createFps(){this.background=this.scene.make.image({key:oR,frame:hR.BLANK}),this.background.setTint(32768),this.background.setAlpha(.5),this.background.setWorldSize(50,20),this.fpsText=Z.createText(this.scene,this.fpsString,10),this.fpsText.setName("FPS Meter"),sR.Align.In.Center(this.fpsText,this.background,4),this.add([this.background,this.fpsText])}createInputZone(){let{width:e,height:t}=this.background;this.zone=this.scene.make.zone({width:e,height:t}),this.add(this.zone),this.zone.setInteractive({useHandCursor:!0}),this.zone.on(rR.GAMEOBJECT_POINTER_DOWN,this.handleShowFps)}handleShowFps=()=>{this.fpsText.visible?this.disable():this.enable()};disable(){this.fpsText.setVisible(!1),this.background.setVisible(!1),this.scene.events.off(Dc.UPDATE,this.update)}enable(){this.fpsText.setVisible(!0),this.background.setVisible(!0),this.scene.events.on(Dc.UPDATE,this.update)}},uR=lR,{ads:cR,event:Sr}=codex,{Events:kc}=Ludex,dR=class extends mn{S;I;init(){this.O(),this.I=new U1,this.M()}M(){Sr.on("hideFPS",this.K),Sr.on("showFPS",this.j),this.Z()}Z(){Sr.on(kc.VISIBILITY_HIDDEN,this.muteAudio),Sr.on(kc.VISIBILITY_VISIBLE,this.unmuteAudio)}muteAudio=()=>{ut.muteAudio(!0),this.input.once(G1.POINTER_DOWN,this.unmuteAudio)};unmuteAudio=async()=>{if(!cR.isAdFullSizeShowing()&&(ut.muteAudio(!1),"context"in window.phaser.sound))try{await window.phaser.sound.context.suspend(),await window.phaser.sound.context.resume()}catch{}};setup(){this.scene.isActive()&&(this.q(),this.O())}q(){this.S=new uR(this),F1.Align.In.TopLeft(this.S,this.gameZone,-20,-10)}K=()=>{this.S?.kill()};j=()=>{this.S?.revive()};O(){this.scene.bringToTop(this)}requestBackgroundMaskUpdate(e,t){this.I.requestBackgroundMaskUpdate(e,t)}recalculateBackgroundMask(){this.I.updateBackgroundMask()}},pR=dR,ao=pR,gR={NORMAL:"NORMAL",BATTLE:"BATTLE",TUTORIAL:"TUTORIAL",BOSS:"BOSS"},Tt=gR,fR={StartLevel:1,StartCoins:6,DelayFinishGame:1700,HintWaitTime:5e3,Powers:{FreeCoins:{enable:!0,duration:12e4},SpeedUp:{enable:!0,modifier:2},BossChallenge:{enable:!0,duration:6e5}},MaxLevel:1598,MaxBossLevel:11,MaximumMeleeLevel:11,MaximumRangedLevel:11,CheaterIds:[],ChallengeFriends:{activePerLevel:2,maxActiveCount:1},Tutorial:{ForceUseTutorial:!1,NumberOfTutorial:{GuideOne:1,GuideTwo:1,GuidePrevent:-1,GuideThree:1}},Leaderboards:{Name:null,UseMock:!1,Prefix:"leaderboards",LeaderboardId:"62f5bc51b2198c615726a9a1",Limit:50,MockOptions:{PlayerEntryIndex:-1}}},Ut=fR,mR=U(it()),vR=U(ft()),{KEY:oo,FRAME:ho}=W.GAMEPLAY,ER=class extends mR.Container{arrowStart;arrowEnd;arrowMiddle;expandTween;constructor(e){super(e),this.name="AdjustableArrow",this.addArrowStart(),this.addArrowEnd(),this.addArrowMiddle(),this.setDepth(rt.EFFECT),this.scene.add.existing(this)}addArrowStart(){this.arrowStart=this.scene.make.image({key:oo,frame:ho.GUIDE_ARROW_START,origin:{x:0,y:.5}}),this.arrowStart.setWorldSize(20,26),this.add(this.arrowStart)}addArrowEnd(){this.arrowEnd=this.scene.make.image({key:oo,frame:ho.GUIDE_ARROW_END,origin:{x:1,y:.5}}),this.arrowEnd.setWorldSize(4,13),this.add(this.arrowEnd)}addArrowMiddle(){this.arrowMiddle=this.scene.make.image({key:oo,frame:ho.GUIDE_ARROW_MIDDLE,origin:{x:.5,y:.5}}),this.arrowMiddle.setWorldSize(1,13),this.add(this.arrowMiddle)}changeArrowLength(e){let t=e-this.arrowStart.width-this.arrowEnd.width;this.arrowMiddle.setWorldSize(t,this.arrowMiddle.height),this.arrowEnd.setPosition(-t/2,0),this.arrowStart.setPosition(t/2,0)}runArrowExpandTween(e,t,i){let s=i-this.arrowStart.width-this.arrowEnd.width;this.arrowEnd.setPosition(-s/2,0),this.arrowStart.setPosition(-s/2,0),this.arrowMiddle.setWorldSize(0,this.arrowMiddle.height),this.expandTween=this.scene.tweens.addCounter({from:0,to:100,duration:e,completeDelay:t,ease:vR.Cubic.Out,onUpdate:n=>{let r=n.getValue(),o=s*r/100;this.arrowMiddle.setWorldSize(o,this.arrowMiddle.height);let a=-s/2+o/2;this.arrowMiddle.setPosition(a,0);let h=-s/2+o;this.arrowStart.setPosition(h,0)},onComplete:()=>{this.setAlpha(0)},onStop:()=>{this.setAlpha(0)}})}killExpandTween(){this.expandTween?.stop()}},yR=ER,TR=U(it()),lo=U(ft()),{KEY:SR,FRAME:AR}=W.GAMEPLAY,xR=class extends TR.Container{hand;arrow;toGlobalX=0;toGlobalY=0;constructor(e){super(e),this.name="DragTutorialHand",this.addHand(),this.addArrow(),this.bringToTop(this.hand),this.scene.add.existing(this)}addHand(){this.hand=this.scene.make.image({key:SR,frame:AR.GUIDE_HAND,origin:{x:0,y:0}}),this.hand.setWorldSize(65.5,55.5),this.add(this.hand)}addArrow(){this.arrow=new yR(this.scene),this.arrow.setAlpha(0)}setTarget(e,t){this.toGlobalX=e,this.toGlobalY=t}playAnimation(e=0,t=800){let i=1/$.getPixelRatio();this.hand.angle=0;let s=this.toGlobalX-this.x,n=this.toGlobalY-this.y,r=this.x+s/2,o=this.y+n/2,a=Math.sqrt(s*s+n*n)*.8;this.arrow.setPosition(r,o),this.arrow.rotation=Math.atan2(n,s),this.arrow.setAlpha(0),this.arrow.killExpandTween(),this.hand.setPosition(0,0),this.hand.setAlpha(1),this.scene?.tweens.add({delay:e,targets:this.arrow,ease:lo.Cubic.Out,onStart:()=>{this.arrow.runArrowExpandTween(1200,200,a)},props:{alpha:{start:0,value:.5,duration:200}}}),this.scene?.tweens.add({delay:e,targets:[this.hand],ease:lo.Cubic.Out,props:{alpha:{start:0,value:1,duration:200},x:{from:0,to:s,duration:1200},y:{from:0,to:n,duration:1200}},onComplete:()=>{this.scene?.tweens.add({targets:[this.hand],delay:200,duration:200,completeDelay:200,ease:lo.Cubic.Out,props:{alpha:0},onComplete:()=>{this.hand.x=0,this.hand.y=0,this.hand.scale=i,this.playAnimation(e,t)}})}})}stopAnimation(){this.scene.tweens.killTweensOf(this.hand),this.scene.tweens.killTweensOf(this.arrow)}kill(){this.arrow.kill(),super.kill()}revive(){this.arrow.revive(),super.revive()}destroy(e){this.arrow.destroy(e),super.destroy(e)}preDestroy(){this.scene.tweens.killTweensOf(this.hand),this.scene.tweens.killTweensOf(this.arrow)}},Bc=xR,wR={STATUS:{READY:"ready",RUNNING:"running",STOPPED:"stopped"}},Ii=wR,{STATUS:Ls}=Ii,ue=class{R;scene;constructor(e){this.scene=e}init(){this.setState(Ls.READY)}start(){this.isRunning()||this.setState(Ls.RUNNING)}stop(){this.isRunning()&&this.setState(Ls.STOPPED)}setState(e){this.R=e}isReady(){return this.R===Ls.READY}isRunning(){return this.R===Ls.RUNNING}isStopped(){return this.R===Ls.STOPPED}},Is=U(Zt()),{HintWaitTime:RR}=Ut,CR=class extends ue{scene;hand;autoTimeEvent;isDragging=!1;constructor(e){super(e),this.scene=e,this.createHand()}init(){super.init()}start(){this.isRunning()||(super.start(),this.listenEvent(),this.startAutoHint())}stop(){this.isRunning()&&(super.stop(),this.isDragging=!1,this.stopListenEvent(),this.stopAutoHint())}createHand(){this.hand=new Bc(this.scene),this.hand.kill(),this.hand.setDepth(rt.PRIORITY)}startAutoHint(){this.autoTimeEvent=this.scene.time.delayedCall(RR,this.handleAutomaticallyHint)}handleAutomaticallyHint=()=>{let{unitManager:e}=this.scene,t=e.getSameCoupleUnits();if(!t){this.startAutoHint();return}this.hand.stopAnimation(),this.hand.revive(),this.hand.setPosition(t.unit1.x,t.unit1.y),this.hand.setTarget(t.unit2.x,t.unit2.y),this.hand.playAnimation(500)};listenEvent(){this.scene.input.on(Is.POINTER_DOWN,this.handlePlayerInteract),this.scene.input.on(Is.DRAG_START,this.handlePlayerDragging),this.scene.input.on(Is.DRAG_END,this.handlePlayerEndDrag)}stopListenEvent(){this.scene.input.off(Is.POINTER_DOWN,this.handlePlayerInteract),this.scene.input.off(Is.DRAG_START,this.handlePlayerDragging),this.scene.input.off(Is.DRAG_END,this.handlePlayerEndDrag)}handlePlayerDragging=()=>{this.isDragging||(this.isDragging=!0,this.stopAutoHint())};handlePlayerEndDrag=()=>{this.isDragging=!1,this.startAutoHint()};handlePlayerInteract=()=>{this.stopAutoHint(),!this.isDragging&&this.startAutoHint()};stopAutoHint(){this.hand.kill(),this.hand.stopAnimation(),this.autoTimeEvent?.remove()}},_R=CR,{KEY:be,FRAME:Pe}=W.UNITS_SPRITES,{KEY:bR,FRAME:PR}=W.GAMEPLAY,ei={END:2,START:0,EVENT:5,DISPOSE:3,COMPLETE:4,INTERRUPT:1},mt={MELEE:{RUN:"run",DIE:"die",IDLE:"idle",ATTACK:"attack",CUSTOM_EVENTS:{FINISHED_ATTACKING:"finished_attacking"}},RANGED:{DIE:"die",IDLE:"idle",ATTACK:"attack",ATTACK_ABOVE:"attack_above",ATTACK_BELOW:"attack_below",CUSTOM_EVENTS:{FINISHED_ATTACKING:"finished_attacking"}}},Ar={GREEN_FIRE:{KEY:"confetti-hexagon-animation",TEXTURE:bR,PREFIX:PR.GREEN_FIRE_PREFIX,FRAME_RATE:30,START:1,END:3,ZERO_PAD:0}},Kt={MELEE:{1:{ATTACK:{KEY:"velociraptor-attack",TEXTURE:be,PREFIX:Pe.MELEE[1].ATTACK_PREFIX,FRAME_RATE:30,EVENT_FRAME:9,START:0,END:20,ZERO_PAD:2},DIE:{KEY:"velociraptor-die",TEXTURE:be,PREFIX:Pe.MELEE[1].DIE_PREFIX,FRAME_RATE:20,START:0,END:19,ZERO_PAD:2},IDLE:{KEY:"velociraptor-idle",TEXTURE:be,PREFIX:Pe.MELEE[1].IDLE_PREFIX,FRAME_RATE:30,START:0,END:39,ZERO_PAD:2},RUN:{KEY:"velociraptor-move",TEXTURE:be,PREFIX:Pe.MELEE[1].RUN_PREFIX,FRAME_RATE:40,START:0,END:20,ZERO_PAD:2}}},RANGED:{1:{ATTACK_ABOVE:{KEY:"rockthrower-attack",TEXTURE:be,PREFIX:Pe.RANGED[1].ATTACK_PREFIX,FRAME_RATE:30,EVENT_FRAME:16,START:0,END:29,ZERO_PAD:2},ATTACK_BELOW:{KEY:"rockthrower-attack",TEXTURE:be,PREFIX:Pe.RANGED[1].ATTACK_PREFIX,FRAME_RATE:30,EVENT_FRAME:16,START:0,END:29,ZERO_PAD:2},DIE:{KEY:"rockthrower-die",TEXTURE:be,PREFIX:Pe.RANGED[1].DIE_PREFIX,FRAME_RATE:24,START:0,END:23,ZERO_PAD:2},IDLE:{KEY:"rockthrower-idle",TEXTURE:be,PREFIX:Pe.RANGED[1].IDLE_PREFIX,FRAME_RATE:24,START:0,END:23,ZERO_PAD:2}}},ALIEN:{1:{ATTACK:{KEY:"velociraptor-attack",TEXTURE:be,PREFIX:Pe.MELEE[1].ATTACK_PREFIX,FRAME_RATE:30,START:0,END:29,ZERO_PAD:2},DIE:{KEY:"velociraptor-die",TEXTURE:be,PREFIX:Pe.MELEE[1].DIE_PREFIX,FRAME_RATE:20,START:0,END:19,ZERO_PAD:2},IDLE:{KEY:"velociraptor-idle",TEXTURE:be,PREFIX:Pe.MELEE[1].IDLE_PREFIX,FRAME_RATE:40,START:0,END:39,ZERO_PAD:2},RUN:{KEY:"velociraptor-move",TEXTURE:be,PREFIX:Pe.MELEE[1].RUN_PREFIX,FRAME_RATE:25,START:0,END:24,ZERO_PAD:2}}}},LR=U(qt()),{KEY:IR,TEXTURE:MR,FRAME_RATE:OR,START:DR,END:kR,PREFIX:BR,ZERO_PAD:NR}=Kt.ALIEN[1].ATTACK,UR=class extends LR.Animation{constructor(e){let t={repeat:-1,frameRate:OR,frames:e.generateFrameNames(MR,{prefix:BR,start:DR,end:kR,zeroPad:NR}),showOnStart:!0,hideOnComplete:!0,skipMissedFrames:!0};super(e,IR,t)}},FR=UR,GR=U(qt()),{KEY:YR,TEXTURE:HR,FRAME_RATE:WR,START:zR,END:VR,PREFIX:XR,ZERO_PAD:KR}=Kt.ALIEN[1].DIE,jR=class extends GR.Animation{constructor(e){let t={repeat:0,frameRate:WR,frames:e.generateFrameNames(HR,{prefix:XR,start:zR,end:VR,zeroPad:KR}),showOnStart:!0,hideOnComplete:!1,skipMissedFrames:!0};super(e,YR,t)}},ZR=jR,qR=U(qt()),{KEY:QR,TEXTURE:JR,FRAME_RATE:$R,START:tC,END:eC,PREFIX:iC,ZERO_PAD:sC}=Kt.ALIEN[1].IDLE,nC=class extends qR.Animation{constructor(e){let t={repeat:-1,frameRate:$R,frames:e.generateFrameNames(JR,{prefix:iC,start:tC,end:eC,zeroPad:sC}),showOnStart:!0,hideOnComplete:!0,skipMissedFrames:!0};super(e,QR,t)}},rC=nC,aC=U(qt()),{KEY:oC,TEXTURE:hC,FRAME_RATE:lC,START:uC,END:cC,PREFIX:dC,ZERO_PAD:pC}=Kt.ALIEN[1].RUN,gC=class extends aC.Animation{constructor(e){let t={repeat:-1,frameRate:lC,frames:e.generateFrameNames(hC,{prefix:dC,start:uC,end:cC,zeroPad:pC}),showOnStart:!0,hideOnComplete:!0,skipMissedFrames:!0};super(e,oC,t)}},fC=gC,mC=U(qt()),{KEY:vC,TEXTURE:EC,FRAME_RATE:yC,START:TC,END:SC,PREFIX:AC,ZERO_PAD:xC}=Kt.MELEE[1].ATTACK,wC=class extends mC.Animation{constructor(e){let t={repeat:-1,frameRate:yC,frames:e.generateFrameNames(EC,{prefix:AC,start:TC,end:SC,zeroPad:xC}),showOnStart:!0,hideOnComplete:!1,skipMissedFrames:!0};super(e,vC,t)}},RC=wC,CC=U(qt()),{KEY:_C,TEXTURE:bC,FRAME_RATE:PC,START:LC,END:IC,PREFIX:MC,ZERO_PAD:OC}=Kt.MELEE[1].DIE,DC=class extends CC.Animation{constructor(e){let t={repeat:0,frameRate:PC,frames:e.generateFrameNames(bC,{prefix:MC,start:LC,end:IC,zeroPad:OC}),showOnStart:!0,hideOnComplete:!1,skipMissedFrames:!0};super(e,_C,t)}},kC=DC,BC=U(qt()),{KEY:NC,TEXTURE:UC,FRAME_RATE:FC,START:GC,END:YC,PREFIX:HC,ZERO_PAD:WC}=Kt.MELEE[1].IDLE,zC=class extends BC.Animation{constructor(e){let t={repeat:-1,frameRate:FC,frames:e.generateFrameNames(UC,{prefix:HC,start:GC,end:YC,zeroPad:WC}),showOnStart:!0,hideOnComplete:!0,skipMissedFrames:!0};super(e,NC,t)}},VC=zC,XC=U(qt()),{KEY:KC,TEXTURE:jC,FRAME_RATE:ZC,START:qC,END:QC,PREFIX:JC,ZERO_PAD:$C}=Kt.MELEE[1].RUN,t_=class extends XC.Animation{constructor(e){let t={repeat:-1,frameRate:ZC,frames:e.generateFrameNames(jC,{prefix:JC,start:qC,end:QC,zeroPad:$C}),showOnStart:!0,hideOnComplete:!0,skipMissedFrames:!0};super(e,KC,t)}},e_=t_,i_=U(qt()),{KEY:s_,TEXTURE:n_,FRAME_RATE:r_,START:a_,END:o_,PREFIX:h_,ZERO_PAD:l_}=Ar.GREEN_FIRE,u_=class extends i_.Animation{constructor(e){let t={repeat:-1,frameRate:r_,frames:e.generateFrameNames(n_,{prefix:h_,start:a_,end:o_,zeroPad:l_}),showOnStart:!0,hideOnComplete:!1,skipMissedFrames:!0};super(e,s_,t)}},c_=u_,d_=U(qt()),{KEY:p_,TEXTURE:g_,FRAME_RATE:f_,START:m_,END:v_,PREFIX:E_,ZERO_PAD:y_}=Kt.RANGED[1].ATTACK_ABOVE,T_=class extends d_.Animation{constructor(e){let t={repeat:-1,frameRate:f_,frames:e.generateFrameNames(g_,{prefix:E_,start:m_,end:v_,zeroPad:y_}),showOnStart:!0,hideOnComplete:!1,skipMissedFrames:!0};super(e,p_,t)}},S_=T_,A_=U(qt()),{KEY:x_,TEXTURE:w_,FRAME_RATE:R_,START:C_,END:__,PREFIX:b_,ZERO_PAD:P_}=Kt.RANGED[1].DIE,L_=class extends A_.Animation{constructor(e){let t={repeat:0,frameRate:R_,frames:e.generateFrameNames(w_,{prefix:b_,start:C_,end:__,zeroPad:P_}),showOnStart:!0,hideOnComplete:!1,skipMissedFrames:!0};super(e,x_,t)}},I_=L_,M_=U(qt()),{KEY:O_,TEXTURE:D_,FRAME_RATE:k_,START:B_,END:N_,PREFIX:U_,ZERO_PAD:F_}=Kt.RANGED[1].IDLE,G_=class extends M_.Animation{constructor(e){let t={repeat:-1,frameRate:k_,frames:e.generateFrameNames(D_,{prefix:U_,start:B_,end:N_,zeroPad:F_}),showOnStart:!0,hideOnComplete:!0,skipMissedFrames:!0};super(e,O_,t)}},Y_=G_,H_=class extends ue{scene;constructor(e){super(e),this.scene=e}addLevel11ProjectileAnimation(){if(!this.scene.anims.exists(Ar.GREEN_FIRE.KEY)){let e=new c_(this.scene.anims);this.scene.anims.add(Ar.GREEN_FIRE.KEY,e)}}addAlienAnimation(){let{ATTACK:e,DIE:t,IDLE:i}=Kt.ALIEN[1];if(!this.scene.anims.exists(i.KEY)){let s=new rC(this.scene.anims);this.scene.anims.add(i.KEY,s)}if(!this.scene.anims.exists(e.KEY)){let s=new fC(this.scene.anims);this.scene.anims.add(e.KEY,s)}if(!this.scene.anims.exists(i.KEY)){let s=new FR(this.scene.anims);this.scene.anims.add(i.KEY,s)}if(!this.scene.anims.exists(t.KEY)){let s=new ZR(this.scene.anims);this.scene.anims.add(t.KEY,s)}}addMeleeLevel1Animation(){let{ATTACK:e,DIE:t,IDLE:i,RUN:s}=Kt.MELEE[1];if(!this.scene.anims.exists(e.KEY)){let n=new RC(this.scene.anims);this.scene.anims.add(e.KEY,n)}if(!this.scene.anims.exists(t.KEY)){let n=new kC(this.scene.anims);this.scene.anims.add(t.KEY,n)}if(!this.scene.anims.exists(i.KEY)){let n=new VC(this.scene.anims);this.scene.anims.add(i.KEY,n)}if(!this.scene.anims.exists(s.KEY)){let n=new e_(this.scene.anims);this.scene.anims.add(s.KEY,n)}}addRangedLevel1Animation(){let{ATTACK_ABOVE:e,DIE:t,IDLE:i}=Kt.RANGED[1];if(!this.scene.anims.exists(e.KEY)){let s=new S_(this.scene.anims);this.scene.anims.add(e.KEY,s)}if(!this.scene.anims.exists(t.KEY)){let s=new I_(this.scene.anims);this.scene.anims.add(t.KEY,s)}if(!this.scene.anims.exists(i.KEY)){let s=new Y_(this.scene.anims);this.scene.anims.add(i.KEY,s)}}checkIfAnimationIsAdded(e){return this.scene.anims.exists(e)}addMeleeUnitAnimationBasedOnLevel(e){switch(e){case 1:this.addMeleeLevel1Animation();break;default:this.addAlienAnimation()}}addRangedUnitAnimationBasedOnLevel(e){switch(e){case 1:this.addRangedLevel1Animation();break;default:this.addAlienAnimation()}}},W_=H_,z_=class fs{baseValue;suffix;constructor(t,i,s){this.suffix=i||0,this.baseValue=Math.floor(t),!s&&(this.initValue(),this.refactorValue())}initValue(){if(this.suffix===0&&this.baseValue>=1e3){let t=this.baseValue.toString(),i=t.length-1;this.suffix=Math.floor(i/3);let s=i%3;this.suffix>=2&&(this.baseValue=parseInt(t.substring(0,4+s)));return}this.baseValue*=1e3}refactorValue(){if(this.baseValue=Math.floor(this.baseValue),this.baseValue>=1e6){this.baseValue=Math.floor(this.baseValue/1e3),this.suffix++;return}if(this.baseValue===0){this.suffix=0;return}if(this.baseValue<1e3&&this.suffix>0){this.baseValue*=1e3,this.suffix--;return}}add(t,i){let s=typeof t=="number"?new fs(t,i,!0):t;if(s.baseValue<0){this.subtract(new fs(s.baseValue*-1,s.suffix,!0));return}if(!(this.suffix-s.suffix>=2)){if(s.suffix-this.suffix>=2){this.baseValue=s.baseValue,this.suffix=s.suffix;return}if(this.suffix===s.suffix)this.baseValue+=s.baseValue;else{this.suffix=this.suffix>s.suffix?this.suffix:s.suffix;let n=this.suffix>s.suffix?this.baseValue:s.baseValue,r=this.suffix>s.suffix?s:this;this.baseValue=n+Math.floor(r.baseValue/1e3)}this.refactorValue()}}subtract(t,i){let s=typeof t=="number"?new fs(t,i,!0):t;if(s.suffix>this.suffix){this.baseValue=0,this.suffix=0;return}if(s.baseValue>this.baseValue&&s.suffix===this.suffix){this.baseValue=0,this.suffix=0;return}this.suffix-s.suffix>=2||(this.baseValue-=Math.floor(s.baseValue/Math.pow(1e3,this.suffix-s.suffix)),this.refactorValue())}multiply(t){if(typeof t=="number"&&t<1e3){this.baseValue*=t,this.refactorValue();return}let i=typeof t=="number"?new fs(t):t;this.suffix+=i.suffix,this.baseValue*=Math.floor(i.baseValue/1e3),this.refactorValue()}divide(t){if(typeof t=="number"&&t<1e3){this.baseValue/=t,this.refactorValue();return}let i=typeof t=="number"?new fs(t):t;this.suffix-=i.suffix,this.baseValue/=Math.floor(i.baseValue/1e3),this.refactorValue()}clone(){return new fs(this.baseValue,this.suffix,!0)}biggerThan(t){return this.suffix>t.suffix?!0:this.suffix<t.suffix?!1:this.baseValue>t.baseValue}smallerThan(t){return this.suffix<t.suffix?!0:this.suffix>t.suffix?!1:this.baseValue<t.baseValue}toString(){return`${Math.floor(this.baseValue/1e3)}${this.generateTextSuffix()}`}generateTextSuffix(){switch(this.suffix){case 0:return"";case 1:return"K";case 2:return"M";case 3:return"B";case 4:return"T";default:{let t=this.suffix-5,i=Math.floor(t/26),s=t%26,n=String.fromCharCode(i+65),r=String.fromCharCode(s+65);return`${n}${r}`}}}},Dt=z_,V_={MELEE_UNIT_TYPE:"melee",RANGED_UNIT_TYPE:"ranged",ALIEN_UNIT_TYPE:"alien",MELEE_ATTACK_RANGE:40,MELEE_MOVEMENT_SPEED:100,MELEE_ATTACK_INTERVAL:800,RANGED_ATTACK_INTERVAL:1100,RANGED_PROJECTILE_SPEED:600,BASE_UNIT_COIN:2,UNIT_COIN_SCALE:1.6,COINS_PER_ATTACK:1,ATTACK_COIN_SCALE:1.6,ATTACK_COIN_BOSS_MULTIPLIER:3,MULTIPLY_REWARD_ROUND:6,MULTIPLY_REWARD_BATTLE:2,UNIT_SIZE_SCALE:1,UNIT_PRICE_CUSTOM_MODIFIER:[[1,1],[3,5],[10,2],[25,1.5],[40,1.5]],ATTACK_CUSTOM_MODIFIER:[[1,1],[9,2],[30,1.2]],AD_WATCH_REQUIREMENT:[0,1,2,3,4,5,7,9,12,15,20],BUYING_UNIT_LEVEL:[1,51,151,251]},Q=V_,X_={playerUnitData:"0-0-0-0-0/0-0-0-0-0/0-0-m1-0-0",level:0,coins:0,gameCompletedCount:0,meleeUnlockedUnitLevel:0,rangedUnlockedUnitLevel:0,bossLevelProgress:0,finalBossDefeated:!1,lastBossChallengeTime:0,isEligibleForReset:!1,coinBaseValue:1e4,coinSuffixValue:0,freeCoinsLastUsedTime:0,offlineRewardLastCheck:0,unitScreenAdWatchedCount:{MELEE:{},RANGED:{}}},uo=X_,{player:Mi}=codex,{MaxBossLevel:Nc,MaximumMeleeLevel:K_,MaximumRangedLevel:j_}=Ut,{Utils:{Valid:Uc}}=Ludex,Z_=class sf{static _instance;static get inst(){return this._instance||(this._instance=new sf),this._instance}static getLevelProgress(){let t=Mi.getGameData()?.level;return!Uc.isNumber(t)||t<0?0:t}static getPlayerUnitData(){let t=Mi.getGameData()?.playerUnitData;return!t||t===""?null:t}static getPlayerUnlockedMeleeLevel(){return Mi.getGameData()?.meleeUnlockedUnitLevel??1}static getPlayerUnlockedRangedLevel(){return Mi.getGameData()?.rangedUnlockedUnitLevel??1}static getPlayerAdWatchedCount(){let t=uo.unitScreenAdWatchedCount;return Mi.getGameData()?.unitScreenAdWatchedCount??t}static getPlayerBossLevelProgress(){let t=Mi.getGameData()?.bossLevelProgress;return!Uc.isNumber(t)||t<1?1:t>Nc?Nc:t+1}static getLastBossChallengeTime(){return Mi.getGameData()?.lastBossChallengeTime??0}static getGameCompletedCount(){return Mi.getGameData()?.gameCompletedCount??0}static getBuyingUnitLevel(){let t=this.getLevelProgress()+1,{BUYING_UNIT_LEVEL:i}=Q,s=1;for(let[n,r]of i.entries())r<=t&&(s=n+1);return s}static upgradePlayerUnits(t){let i=this.getPlayerUnitList(t),s=this.getBuyingUnitLevel(),n=[],r=[];for(let a=0;a<15;a++){let h=i[a],l=h[0];l!=="m"&&l!=="r"||parseInt(h.substring(1))>=s||(l==="m"?n.push(a):r.push(a))}for(let a of n)i[a]=`m${s}`;for(let a of r)i[a]=`r${s}`;let o=this.handleCannotMergeCase(i);return this.serializePlayerUnitData(o)}static getPlayerUnitList(t){let i=t.split("/"),s=[];for(let n of i){let r=n.split("-");for(let o of r)s.push(o)}return s}static handleCannotMergeCase(t){if(this.isBoardCanBeMerged(t))return t;let i=Number.MAX_SAFE_INTEGER,s=-1,n=Number.MAX_SAFE_INTEGER,r=-1,o=Number.MAX_SAFE_INTEGER,a=-1,h=Number.MAX_SAFE_INTEGER,l=-1,c=0;for(let f=0;f<t.length;f++){let u=t[f],p=u[0];if(p!=="m"&&p!=="r")continue;c++;let d=parseInt(u.substring(1));p==="m"?d<i?(n=i,r=s,i=d,s=f):d<n&&(n=d,r=f):d<o?(h=o,l=a,o=d,a=f):d<h&&(h=d,l=f)}return c===15&&s!==-1&&r!==-1&&(t[s]=t[r]),c===15&&a!==-1&&l!==-1&&(t[a]=t[l]),t}static isBoardCanBeMerged(t){let i=new Map,s=new Map;for(let o of t){let a=o[0];if(a!=="m"&&a!=="r")continue;let h=parseInt(o.substring(1));switch(a){case"m":{let l=i.get(h);l?i.set(h,l+1):i.set(h,1);break}case"r":{let l=s.get(h);l?s.set(h,l+1):s.set(h,1);break}}}let n=Array.from(i,([o,a])=>({key:o,value:a})).some(o=>{let{key:a,value:h}=o;return h>1&&a+1<=K_}),r=Array.from(s,([o,a])=>({key:o,value:a})).some(o=>{let{key:a,value:h}=o;return h>1&&a+1<=j_});return n||r}static serializePlayerUnitData(t){let i="",s=0;for(let n=0;n<3;n++){let r="";for(let o=0;o<5;o++)r+=t[s],s++,o!==4&&(r+="-");i+=r,n!==2&&(i+="/")}return i}},At=Z_,{player:z5}=codex,{Utils:{Valid:V5}}=Ludex,{MULTIPLY_REWARD_ROUND:q_,UNIT_COIN_SCALE:co,BASE_UNIT_COIN:Q_,COINS_PER_ATTACK:J_,ATTACK_COIN_SCALE:po,ATTACK_COIN_BOSS_MULTIPLIER:$_,MULTIPLY_REWARD_BATTLE:tb}=Q,eb=class extends ue{scene;unitModifier;currentUnitModifier;attackModifier;currentAttackModifier;totalCoinsByAttack;isPostGame=!1;constructor(e){super(e),this.scene=e,this.initModifier()}initModifier(){this.unitModifier=new Dt(1),this.attackModifier=new Dt(1),this.currentUnitModifier=new Dt(1)}init(){super.init(),this.totalCoinsByAttack=new Dt(0),this.checkForPostGame()}getUnitPrice(e){let t=e||0,i=2**(this.scene.getBuyingUnitLevel()-1),s=new Dt(Q_),n=s.clone();return n.multiply(t),n.multiply(i),n.multiply(this.unitModifier),n.biggerThan(s)?n:s}getUnitAttackBaseCoin(e){let t=(e.level-1)*.75+J_;return e.unitType===Q.RANGED_UNIT_TYPE&&this.isPostGame&&(t*=.75),t}getAttackCoinByUnit(e,t){let i=this.getUnitAttackBaseCoin(e),s=this.attackModifier.clone();s.multiply(i);let n=t.currentHp,r=e.attackPower;return n<r&&(s.multiply(n),s.divide(r)),s.biggerThan(new Dt(1))?s:new Dt(1)}setUnitModifier(e,t=1){if(e<=50){let i=co**e;this.currentUnitModifier=new Dt(1),this.currentUnitModifier.multiply(i)}else{let i=co**50,s=Math.floor(e/50),n=e%50;this.currentUnitModifier=new Dt(1);for(let o=0;o<s;o++)this.currentUnitModifier.multiply(i);let r=co**n;this.currentUnitModifier.multiply(r)}this.currentUnitModifier.multiply(t),this.unitModifier=this.currentUnitModifier}getUnitModifier(){return this.unitModifier}setAttackModifier(e,t=1){if(e<=50){let i=po**e;this.currentAttackModifier=new Dt(1),this.currentAttackModifier.multiply(i)}else{let i=po**50,s=Math.floor(e/50),n=e%50;this.currentAttackModifier=new Dt(1);for(let o=0;o<s;o++)this.currentAttackModifier.multiply(i),this.currentAttackModifier.multiply(1.5);let r=po**n;this.currentAttackModifier.multiply(r)}this.currentAttackModifier.multiply(t),this.scene.gameMode===Tt.BOSS&&this.currentAttackModifier.multiply($_),this.attackModifier=this.currentAttackModifier}getAttackModifier(){return this.attackModifier}addCoinsByAttack(e){this.totalCoinsByAttack.add(e)}getTotalCoinsByAttack(){return this.totalCoinsByAttack.clone()}getRewardCoinsByAttackCoins(){let{gameMode:e}=this.scene,t=this.totalCoinsByAttack.clone();return t.multiply(q_),e===Tt.BATTLE&&t.multiply(tb),t}checkForPostGame(){let e=At.getGameCompletedCount();this.isPostGame=e>0}},ib=eb,{UNIT_PRICE_CUSTOM_MODIFIER:go,ATTACK_CUSTOM_MODIFIER:Fc}=Q,{Utils:{Valid:qi,Browser:Le}}=Ludex,sb=class extends ue{scene;currentGameMode;unitLevelsUpdated;customUnitModifier;attackLevelsUpdated;customAttackModifier;constructor(e){super(e),this.scene=e,this.intData()}intData(){this.currentGameMode=Tt.NORMAL,this.unitLevelsUpdated=[!1],this.customUnitModifier=0,this.attackLevelsUpdated=[!1],this.customAttackModifier=0,this.initDataToolDev()}init(){let{levelManager:e}=this.scene;(this.scene.gameMode!==this.currentGameMode||e.isInLevelBuilderLevel())&&(this.currentGameMode=this.scene.gameMode,this.unitLevelsUpdated=[!1],this.customUnitModifier=0,this.attackLevelsUpdated=[!1],this.customAttackModifier=0)}initDataToolDev(){if(qi.isDebugger()){if(!Le.getLocalStorage("DevCustomUnitMod")){let e={};go.forEach(t=>{e[t[0]]=t[1]}),Le.writeLocalStorage("DevCustomUnitMod",e)}if(!Le.getLocalStorage("DevCustomAttackMod")){let e={};Fc.forEach(t=>{e[t[0]]=t[1]}),Le.writeLocalStorage("DevCustomAttackMod",e)}}}addCustomUnitModifier(e){this.customUnitModifier+=e}updateCustomUnitModifierByLevel(e){if(this.updateCustomUnitModSuccessByDevTool(e))return;for(let i=0;i<go.length;i++){let s=go[i],n=s[0],r=s[1];if(n>e)break;this.unitLevelsUpdated[n]||(this.addCustomUnitModifier(r),this.unitLevelsUpdated[n]=!0)}let{coinManager:t}=this.scene;t.setUnitModifier(e,this.customUnitModifier)}updateCustomUnitModSuccessByDevTool(e){if(!qi.isDebugger())return!1;let t=Le.getLocalStorage("DevCustomUnitMod");if(!qi.isObject(t))return!1;let i=0;for(let[r,o]of Object.entries(t)){let a=parseInt(r),h=o;if(a>e)break;a===e&&(i=h),this.unitLevelsUpdated[a]||(this.addCustomUnitModifier(h),this.unitLevelsUpdated[a]=!0)}let{coinManager:s,devToolManager:n}=this.scene;return s.setUnitModifier(e,this.customUnitModifier),n.setCurrentUnitModText(i,s.getUnitModifier()),!0}editCurrentLevelUnitMod(e){let{levelManager:t}=this.scene,i=t.getCurrentLevelId(),s=Le.getLocalStorage("DevCustomUnitMod");if(qi.isObject(s)){let r=s[i];this.customUnitModifier=this.customUnitModifier-r+e,Le.writeLocalStorage("DevCustomUnitMod",{[i]:e})}else this.addCustomUnitModifier(e),this.unitLevelsUpdated[i]=!0,Le.writeLocalStorage("DevCustomUnitMod",{[i]:e});let{coinManager:n}=this.scene;return n.setUnitModifier(i,this.customUnitModifier),n.getUnitModifier()}addCustomAttackModifier(e){this.customAttackModifier+=e}updateCustomAttackModifierByLevel(e){if(this.updateCustomAttackModSuccessByDevTool(e))return;for(let i of Fc){let s=i[0],n=i[1];if(s>e)break;this.attackLevelsUpdated[s]||(this.addCustomAttackModifier(n),this.attackLevelsUpdated[s]=!0)}let{coinManager:t}=this.scene;t.setAttackModifier(e,this.customAttackModifier)}updateCustomAttackModSuccessByDevTool(e){if(!qi.isDebugger())return!1;let t=Le.getLocalStorage("DevCustomAttackMod");if(!qi.isObject(t))return!1;let i=0;for(let[r,o]of Object.entries(t)){let a=parseInt(r),h=o;if(a>e)break;a===e&&(i=h),this.attackLevelsUpdated[a]||(this.addCustomAttackModifier(h),this.attackLevelsUpdated[a]=!0)}let{coinManager:s,devToolManager:n}=this.scene;return s.setAttackModifier(e,this.customAttackModifier),n.setCurrentAttackModText(i,s.getAttackModifier()),!0}editCurrentLevelAttackMod(e){let{levelManager:t}=this.scene,i=t.getCurrentLevelId(),s=Le.getLocalStorage("DevCustomAttackMod");if(qi.isObject(s)){let r=s[i];this.customAttackModifier=this.customAttackModifier-r+e,Le.writeLocalStorage("DevCustomAttackMod",{[i]:e})}else this.addCustomAttackModifier(e),this.attackLevelsUpdated[i]=!0,Le.writeLocalStorage("DevCustomAttackMod",{[i]:e});let{coinManager:n}=this.scene;return n.setAttackModifier(i,this.customAttackModifier),n.getAttackModifier()}},nb=sb,Gc=U(ft()),rb={props:{alpha:{duration:500,value:{start:0,from:0,to:1},ease:Gc.Cubic.Out},scale:{duration:1e3,value:{start:.8,from:.8,to:1},ease:Gc.Elastic.Out,easeParams:[.1,.45]}}},xr=rb,ab=U(Va()),ob=U(yt()),hb=U(ft()),lb={duration:1e3,ease:hb.Quadratic.InOut};function fo(e,t){let i={...lb,...t},{targets:s,curve:n,onCurveUpdate:r,...o}=i,a=new ab.Spline(n),h=Array.isArray(s)?s:[s],l=new ob.Vector2,c=f=>{a.getPoint(f.getValue(),l);for(let u of h)u.setPosition(l.x,l.y),r?.(u)};return e.tweens.addCounter({...o,onUpdate:c})}var ub={CONGRATULATION:"congratulation",DAILY_REWARD:"daily_reward",DIAMONDS_DROP:"diamonds_drop",DIAMONDS_EAT:"diamonds_eat",FIREWORKS_BIG:"fireworks_big",FIREWORKS_SOAR:"fireworks_soar",FIREWORKS_SMALL:"fireworks_small",GEM_DROP:"gem_drop",GAME_OVER_SCENE:"game_over_scene",MISSION_COMPLETED:"mission_completed",MISSION_REWARD:"mission_reward",MOVE_WRONG:"move_wrong",START_LEVEL:"start_level",POPUP_OFF:"popup_off",POPUP_SHOW:"popup_show",SCORE_COUNTER:"score_counter",START_GAME:"start_game",YOU_LOSE:"you_lose",YOU_WIN:"you_win",NEXT_ROUND_EFFECT:"next-round-effect",LOSE_SOUND:"lose-sound",THUNDER_SOUND:"thunder-sound",CLOSE_CLICK:"close-click",BUTTON_CLICK:"button-click",UNIT_DRAG_END:"drag-unit-end",UNIT_DRAG_START:"drag-unit-start",START_BATTLE:"start-battle",MELEE_ATTACK:"melee-attack",ARROW_SHOOT:"arrow-shoot",UNIT_DAMAGED:"unit-damaged",UNIT_MERGE:"unit-merge",WIN_BATTLE:"win-battle",TURN_SWITCH:"turn-switch",UNIT_UNLOCK:"unit-unlock",COIN_SPAWN_SOUND:"coin-spawn",COIN_INCREASE_REPEATEDLY_SOUND:"coin-increase-repeatedly",GIFT_CHARGE:"gift-charge",GIFT_EXPLODE:"gift-explode",GIFT_REVEAL:"gift-reveal"},Et=ub,cb=U(it()),db=U(Li()),Yc=U(ft()),{KEY:pb,FRAME:gb}=W.EFFECTS,fb=class extends cb.Container{emitZone;emitter;constructor(e){super(e),this.createEmitZone(),this.scene.add.existing(this)}createEmitZone(){this.emitZone=new db.Rectangle}createEmitters(){this.emitter=this.scene.add.particles(0,0,pb,{frame:gb.FX_COMET,emitZone:{source:this.emitZone,type:"random"},speed:20,timeScale:1,frequency:100,alpha:{start:1,end:0,ease:Yc.Expo.Out},scale:{start:2,end:.1,ease:Yc.Expo.Out},lifespan:2666}),this.add(this.emitter),this.emitter.stop()}run(e,t,i,s,n){this.stop(),this.reset(),this.emitZone.setSize(s,n),this.emitZone.setPosition(t-s/2,i-n/2),this.emitter.setQuantity(e),this.emitter.start()}explode(e,t,i){this.emitter||this.reset(),this.emitter.explode(e,t,i)}stop(){this.emitter?.killAll(),this.emitter?.stop()}reset(){this.createEmitters()}},Hc=fb,mb=U(it()),vb=U(Li()),Eb=U(ft()),{KEY:yb,FRAME:Tb}=W.EFFECTS,Sb=class extends mb.Container{deathZone;emitter;constructor(e){super(e),this.createDeathZone(),this.createEmitters(),this.setActive(!1),this.setVisible(!1),this.scene.add.existing(this)}createDeathZone(){this.deathZone=new vb.Circle}createEmitters(){this.emitter=this.scene.add.particles(0,0,yb,{frame:Tb.FX_SPARK,speed:{min:10,max:1200},scale:{start:1.33,end:0},alpha:{start:1,end:0,ease:Eb.Expo.Out},deathZone:{source:this.deathZone,type:"onLeave"},lifespan:3e3}),this.add(this.emitter),this.emitter.stop()}explode(e,t,i,s){this.setActive(!0),this.setVisible(!0),this.deathZone.radius=s,this.deathZone.setPosition(t,i),this.emitter.explode(e,t,i)}stop(){this.emitter.forEachAlive(e=>{e.lifeCurrent=0},this)}},Wc=Sb,mo=U(it()),Ie=U(dt()),Oi=U(yt()),zc=U(ft()),Ms=U(ft()),{FX_MERGE:Ab}=W.SPINE_EFFECTS,{KEY:Di,FRAME:ki}=W.GAMEPLAY,{language:vo}=codex,{Utils:{Signal:Vc}}=Ludex,xb=class extends ue{scene;textObjects;activeTextObjects;mergeEffect;isRewardAnimRunning=!1;rewardUnitCurveAnimController=new Vc.SignalController;sample;starTail;fullContainer;fullTextAnimController=new Vc.SignalController;resultWinAnimationResetFunc=null;resultLoseAnimationResetFunc=null;sparkExplosive;constructor(e){super(e),this.scene=e,this.createMergeEffect(),this.createTextObjects(),this.createCurveAnimation(),this.createFullText(),this.createResultWinEffect(),this.createResultLoseEffect()}stop(){this.isRunning()&&(super.stop(),this.stopMergeEffect(),this.stopTextEffect(),this.resetFullFloatText())}playMergeEffect(e){let{x:t,y:i}=e.getWorldPosition();this.mergeEffect.setActive(!0),this.mergeEffect.setVisible(!0),this.mergeEffect.setPosition(t,i);let s=this.mergeEffect.getAnimationList();this.mergeEffect.play(s[0],!1,!1),ut.playSound(Et.UNIT_MERGE,{volume:.5})}createMergeEffect(){this.mergeEffect=this.scene.add.spine(0,0,Ab.KEY,"animation"),this.mergeEffect.setName("MergeEffect"),this.mergeEffect.setDepth(rt.EFFECT),this.mergeEffect.setScale(.5,.5),this.mergeEffect.setActive(!1),this.mergeEffect.setVisible(!1)}stopMergeEffect(){this.mergeEffect.setActive(!1),this.mergeEffect.setVisible(!1)}createTextObjects(){this.textObjects=this.scene.add.group({runChildUpdate:!1}),this.activeTextObjects=this.scene.add.group({runChildUpdate:!1})}getTextEffectObject(){return this.textObjects.getMatching("active",!1)[0]||this.createTextEffect()}createTextEffect(){let e=Z.buildText("",18).setDepth(rt.DMG_POPUP_NUMBER).setFloatCoinStroke().build(this.scene);return this.textObjects.add(e),e}hideAllTextEffects(){this.textObjects.getChildren().forEach(e=>{e instanceof mo.Text&&e.active&&e.visible&&(this.activeTextObjects.add(e),e.kill())})}showAllTextEffects(){this.activeTextObjects.getChildren().forEach(e=>{e instanceof mo.Text&&e.revive()}),this.activeTextObjects.clear()}stopTextEffect(){this.textObjects.getChildren().forEach(e=>{e instanceof mo.Text&&(e.kill(),e.setAlpha(1),this.scene.tweens.killTweensOf(e))})}createCurveAnimation(){this.sample=this.scene.make.image({key:Di,frame:ki.BLANK}),this.sample.setVisible(!1);let e=new Hc(this.scene);e.setDepth(rt.EFFECT),this.starTail=e}runCurveAnimation(e,t,i,s){let n={x:e,y:t},r={x:i,y:s},o=100;gt.runTween(fo(this.scene,{targets:this.sample,duration:1e3,curve:[[n.x,n.y],[n.x-Oi.RND.between(-o,o),n.y+Oi.RND.between(-140,-100)],[r.x,r.y]],onComplete:()=>{this.runSparksExplosive(i,s)},onCurveUpdate:a=>{let h=a.x+Oi.RND.between(-16,16),l=a.y+Oi.RND.between(-16,16);this.starTail.explode(1,h,l)}}))}runCurveAnimationRewardUnit(e,t,i,s,n){let r={x:e,y:t},o={x:i.x,y:i.y},a=n||1,h=100,l=()=>{this.isRewardAnimRunning=!1;let{unitManager:f}=this.scene;s==="MELEE"&&f.createPlayerMelee(i.rowId,i.colId,a),s==="RANGED"&&f.createPlayerArcher(i.rowId,i.colId,a),this.scene.updateUI()},c=this.rewardUnitCurveAnimController.renew();gt.runTween(fo(this.scene,{targets:this.sample,duration:1e3,curve:[[r.x,r.y],[r.x-Oi.RND.between(-h,h),r.y+Oi.RND.between(-140,-100)],[o.x,o.y]],onStart:()=>{this.isRewardAnimRunning=!0},onComplete:()=>{this.runSparksExplosive(o.x,o.y),l()},onStop:()=>{l()},onCurveUpdate:f=>{if(!this.isRewardAnimRunning)return;let u=16,p=f.x+Oi.RND.between(-u,u),d=f.y+Oi.RND.between(-u,u);this.starTail.explode(1,p,d)}}),c)}runSparksExplosive=(e,t)=>{let i=this.scene;this.sparkExplosive=new Wc(i),this.sparkExplosive.setDepth(rt.EFFECT),this.sparkExplosive.explode(100,e,t,50)};createFullText(){this.fullContainer=this.scene.add.container(0,0),this.fullContainer.setDepth(rt.EFFECT);let e=this.scene.make.image({key:Di,frame:ki.PURPLE_EFFECT});e.setWorldSize(263.5,79.5),this.fullContainer.add(e);let t=Z.buildText(vo.getText("FULL"),25).setHighQuality().build(this.scene);Ie.Align.In.Center(t,e,-3,-5),this.fullContainer.add(t),this.fullContainer.kill(),Ie.Align.In.Center(this.fullContainer,this.scene.gameZone,0,30)}playFullFloatText(){let e=this.fullTextAnimController.renew();gt.runTween(this.scene.tweens.add({...xr,paused:!0,targets:this.fullContainer,onStart:()=>{this.fullContainer.revive()},onComplete:()=>{this.scene.tweens.add({targets:this.fullContainer,duration:300,delay:200,alpha:0})}}),e)}resetFullFloatText(){this.fullTextAnimController.abort()}createResultWinEffect(){let e=this.scene.add.container(0,0);e.setDepth(rt.EFFECT);let t=this.scene.make.image({key:Di,frame:ki.EFFECT_WIN_GLOW});t.setWorldSize(276.5,58.5),e.add(t);let i=Z.buildText(vo.getText("WIN"),25).setHighQuality().build(this.scene);Ie.Align.In.Center(i,t),e.add(i);let s=this.scene.make.image({key:Di,frame:ki.EFFECT_WIN_SHAPE_ABOVE});s.setWorldSize(87.5,18.5),e.add(s),Ie.Align.In.TopCenter(s,t,0,5);let n=this.scene.make.image({key:Di,frame:ki.EFFECT_WIN_SHAPE_BELOW});n.setWorldSize(147,23.5),e.add(n),Ie.Align.In.BottomCenter(n,t,0,8),e.kill(),$.isLandscape()?Ie.Align.In.Center(e,this.scene.gameZone,0,-20):Ie.Align.In.Center(e,this.scene.gameZone,0,-80),this.resultWinAnimationResetFunc=()=>{this.scene.tweens.add({paused:!0,targets:[e],onActive:()=>{e.revive(),e.setAlpha(1),e.setScale(1),t.setAlpha(0),i.setAlpha(0),s.setAlpha(0),n.setAlpha(0),this.scene.add.tween({targets:[t,i],duration:400,alpha:{start:0,to:1},ease:zc.Quadratic.In}),this.scene.add.tween({targets:[s,n],duration:300,alpha:{start:0,to:1}}),this.scene.add.tween({targets:[s],duration:300,delay:200,y:{start:-10,to:-25},ease:Ms.Cubic.InOut}),this.scene.add.tween({targets:[n],duration:300,delay:200,y:{start:10,to:25},ease:Ms.Cubic.InOut}),this.scene.add.tween({targets:[e],duration:600,delay:1e3,scale:{from:1,to:1.2},ease:Ms.Cubic.InOut}),this.scene.tweens.add({targets:[e],duration:300,delay:1300,alpha:0})}})}}playResultWinAnimation(){this.resultWinAnimationResetFunc?.call(this)}createResultLoseEffect(){let e=this.scene.add.container(0,0);e.setDepth(rt.EFFECT);let t=this.scene.make.image({key:Di,frame:ki.EFFECT_LOSE_GLOW});t.setWorldSize(253.5,55),e.add(t);let i=Z.buildText(vo.getText("LOSE"),25).setHighQuality().build(this.scene);Ie.Align.In.Center(i,t),e.add(i);let s=this.scene.make.image({key:Di,frame:ki.EFFECT_LOSE_SHAPE_ABOVE});s.setWorldSize(86,22.5),e.add(s),Ie.Align.In.TopCenter(s,t,0,5);let n=this.scene.make.image({key:Di,frame:ki.EFFECT_LOSE_SHAPE_BELOW});n.setWorldSize(126.5,25.5),e.add(n),Ie.Align.In.BottomCenter(n,t,0,8),e.kill(),$.isLandscape()?Ie.Align.In.Center(e,this.scene.gameZone,0,-20):Ie.Align.In.Center(e,this.scene.gameZone,0,-80),this.resultLoseAnimationResetFunc=()=>{this.scene.tweens.add({paused:!0,targets:[e],onActive:()=>{e.revive(),e.setAlpha(1),e.setScale(1),t.setAlpha(0),i.setAlpha(0),s.setAlpha(0),n.setAlpha(0),this.scene.add.tween({targets:[t,i],duration:400,alpha:{start:0,to:1},ease:zc.Quadratic.In}),this.scene.add.tween({targets:[s,n],duration:300,alpha:{start:0,to:1}}),this.scene.add.tween({targets:[s],duration:300,delay:200,y:{start:-10,to:-25},ease:Ms.Cubic.InOut}),this.scene.add.tween({targets:[n],duration:300,delay:200,y:{start:10,to:25},ease:Ms.Cubic.InOut}),this.scene.add.tween({targets:[e],duration:600,delay:1e3,scale:{from:1,to:.8},ease:Ms.Cubic.InOut}),this.scene.tweens.add({targets:[e],duration:300,delay:1300,alpha:0})}})}}playResultLoseAnimation(){this.resultLoseAnimationResetFunc?.call(this)}isRewardCurveAnimationRunning(){return this.isRewardAnimRunning}stopRewardCurveAnimation(){this.isRewardAnimRunning&&(this.rewardUnitCurveAnimController.abort(),this.starTail?.stop(),this.sparkExplosive?.stop())}},wb=xb,{Utils:{Device:Rb}}=Ludex,ii=Math.ceil(Math.min(Rb.pixelRatio(),2)),Cb={AVATAR_DEFAULT:{KEY:"avatar-default",FILE:"./assets/images/others/avatar-default.png",CONFIG:{}},BG_DESERT:{KEY:"background_desert",FILE:`./assets/images/${ii}x/bg_desert.jpg`,CONFIG:{}},BG_ICE:{KEY:"background_ice",FILE:`./assets/images/${ii}x/bg_ice.jpg`,CONFIG:{}},BG_TREE:{KEY:"background_tree",FILE:`./assets/images/${ii}x/bg_tree.jpg`,CONFIG:{}},BG_VOLCANO:{KEY:"background_volcano",FILE:`./assets/images/${ii}x/bg_volcano.jpg`,CONFIG:{}},BG_CRYSTAL:{KEY:"background_crystal",FILE:`./assets/images/${ii}x/bg_crystal.jpg`,CONFIG:{}},BG_LANDSCAPE_DESERT:{KEY:"background_landscape_desert",FILE:`./assets/images/${ii}x/bg_landscape_desert.jpg`,CONFIG:{}},BG_LANDSCAPE_ICE:{KEY:"background_landscape_ice",FILE:`./assets/images/${ii}x/bg_landscape_ice.jpg`,CONFIG:{}},BG_LANDSCAPE_TREE:{KEY:"background_landscape_tree",FILE:`./assets/images/${ii}x/bg_landscape_tree.jpg`,CONFIG:{}},BG_LANDSCAPE_VOLCANO:{KEY:"background_landscape_volcano",FILE:`./assets/images/${ii}x/bg_landscape_volcano.jpg`,CONFIG:{}},BG_LANDSCAPE_CRYSTAL:{KEY:"background_landscape_crystal",FILE:`./assets/images/${ii}x/bg_landscape_crystal.jpg`,CONFIG:{}}},j=Cb,_b=U(it()),bb=class extends _b.Container{placementArea;areaRect;scene;rowId;colId;isTaken;constructor(e,t,i,s){super(e,t,i),this.scene=e,this.createAreaRect(s),this.createPlacementArea(s),this.addEventListener(),this.scene.add.existing(this),this.setDepth(rt.FIELD_SQUARE)}createPlacementArea(e){let t=$.getPixelRatio();this.placementArea=this.scene.add.zone(0,0,e*t,e*t),this.add(this.placementArea)}createAreaRect(e){this.areaRect=this.scene.add.rectangle(0,0,e,e,16368767,1),this.add(this.areaRect),this.areaRect.setDepth(rt.FIELD_SQUARE_RECT)}updateAreaRect(e){this.areaRect.setFillStyle(e)}setSquarePosition(e,t){this.rowId=e,this.colId=t,this.isTaken=!1}setTaken(e){this.isTaken=e}addEventListener(){this.placementArea.setInteractive({useHandCursor:!0})}},Xc=bb,Pb=[{KEY_PORTRAIT:j.BG_TREE.KEY,KEY_LANDSCAPE:j.BG_LANDSCAPE_TREE.KEY,BG_EXTENSION_COLOR:8102725,SQUARE_COLOR:11452994,SQUARE_HIGHT_LIGHT_COLOR:9692964,SQUARE_HIGHT_LIGHT_BORDER_COLOR:14089889},{KEY_PORTRAIT:j.BG_DESERT.KEY,KEY_LANDSCAPE:j.BG_LANDSCAPE_DESERT.KEY,BG_EXTENSION_COLOR:16761714,SQUARE_COLOR:16368767,SQUARE_HIGHT_LIGHT_COLOR:16766227,SQUARE_HIGHT_LIGHT_BORDER_COLOR:16773290},{KEY_PORTRAIT:j.BG_ICE.KEY,KEY_LANDSCAPE:j.BG_LANDSCAPE_ICE.KEY,BG_EXTENSION_COLOR:15330021,SQUARE_COLOR:13952244,SQUARE_HIGHT_LIGHT_COLOR:6402815,SQUARE_HIGHT_LIGHT_BORDER_COLOR:16777215},{KEY_PORTRAIT:j.BG_CRYSTAL.KEY,KEY_LANDSCAPE:j.BG_LANDSCAPE_CRYSTAL.KEY,BG_EXTENSION_COLOR:3224690,SQUARE_COLOR:5792413,SQUARE_HIGHT_LIGHT_COLOR:6195962,SQUARE_HIGHT_LIGHT_BORDER_COLOR:11848191},{KEY_PORTRAIT:j.BG_VOLCANO.KEY,KEY_LANDSCAPE:j.BG_LANDSCAPE_VOLCANO.KEY,BG_EXTENSION_COLOR:13383207,SQUARE_COLOR:7886462,SQUARE_HIGHT_LIGHT_COLOR:12016072,SQUARE_HIGHT_LIGHT_BORDER_COLOR:15310583}],Eo=Pb,{STATUS:Lb}=Ii,{player:Ib}=codex,Mb={PORTRAIT:{x:30.5,y:158},LANDSCAPE:{x:323,y:55}},Ob={PORTRAIT:{x:30.5,y:-246},LANDSCAPE:{x:323,y:-77}},Db=50,kb=class extends ue{scene;fieldBackground;playerPlacementSquares;enemyPlacementSquares;firstHightLineZone;secondHightLineZone;fieldBackgroundExtension;playerSquareOffsetX;playerSquareOffsetY;enemySquareOffsetX;enemySquareOffsetY;constructor(e){super(e),this.scene=e,this.enemyPlacementSquares=[],this.playerPlacementSquares=[],this.updateSquareOffset(),this.createBattlefield(),this.createHightLineZone()}updateSquareOffset(){let e=$.isUsingLandscapeBackground(),{PORTRAIT:t,LANDSCAPE:i}=Ob,{PORTRAIT:s,LANDSCAPE:n}=Mb;this.playerSquareOffsetX=t.x,this.playerSquareOffsetY=t.y,this.enemySquareOffsetX=s.x,this.enemySquareOffsetY=s.y,e&&(this.playerSquareOffsetX=i.x,this.playerSquareOffsetY=i.y,this.enemySquareOffsetX=n.x,this.enemySquareOffsetY=n.y)}init(){super.init(),this.updateField(),this.resetPlacementSquareStatus()}start(){this.isRunning()||(this.showPlacementSquares(),this.setState(Lb.RUNNING))}updateField(){let e=this.getCurrentLevel(),t=this.getBgData(e);this.updateFieldBackground(t),this.updatePlacementSquares(t),this.updateHightLightSquares(t)}getCurrentLevel(){let{currentLevelData:e=null}=this.scene.levelManager;return e?e.level_id:Ib.getGameData()?.level??1}getBgData(e){let t=Math.floor(e/10)%Object.keys(Eo).length,i=Eo[t],s=$.isUsingLandscapeBackground()?i.KEY_LANDSCAPE:i.KEY_PORTRAIT;return this.scene.textures.exists(s)?i:Eo[0]}updateFieldBackground(e){let t=$.isUsingLandscapeBackground()?e.KEY_LANDSCAPE:e.KEY_PORTRAIT;this.fieldBackground.setTexture(t),this.fieldBackgroundExtension.setFillStyle(e.BG_EXTENSION_COLOR)}updatePlacementSquares(e){this.playerPlacementSquares.forEach(t=>{t.updateAreaRect(e.SQUARE_COLOR)}),this.enemyPlacementSquares.forEach(t=>{t.updateAreaRect(e.SQUARE_COLOR)})}updateHightLightSquares(e){this.firstHightLineZone.setFillStyle(e.SQUARE_HIGHT_LIGHT_COLOR),this.firstHightLineZone.setStrokeStyle(2,e.SQUARE_HIGHT_LIGHT_BORDER_COLOR),this.secondHightLineZone.setFillStyle(e.SQUARE_HIGHT_LIGHT_COLOR),this.secondHightLineZone.setStrokeStyle(2,e.SQUARE_HIGHT_LIGHT_BORDER_COLOR)}createHightLineZone(){let{displayWidth:e,scale:t}=this.fieldBackground,i=t*$.getPixelRatio(),s={x:this.enemySquareOffsetX*i,y:this.enemySquareOffsetY*i},n=e-s.x*2;this.firstHightLineZone=this.scene.add.rectangle(0,0,n/5,n/5,16777215,1),this.firstHightLineZone.setStrokeStyle(2,16776960),this.firstHightLineZone.setDepth(rt.FIELD_SQUARE_RECT),this.firstHightLineZone.kill(),this.secondHightLineZone=this.scene.add.rectangle(0,0,n/5,n/5,16777215,1),this.secondHightLineZone.setStrokeStyle(2,16776960),this.secondHightLineZone.setDepth(rt.FIELD_SQUARE),this.secondHightLineZone.kill()}createBattlefield(){let e=this.getCurrentLevel(),t=this.getBgData(e);this.createFieldBackground(t),this.createPlacementSquares(t)}createFieldBackground(e){let t=$.isUsingLandscapeBackground()?e.KEY_LANDSCAPE:e.KEY_PORTRAIT;this.createBackground(t),this.handleBackgroundTopOffset(),this.createBackgroundExtension(e.BG_EXTENSION_COLOR)}createBackground(e){let{width:t}=$.getWorldSize(),i=$.getPixelRatio();this.fieldBackground=this.scene.make.image({key:e,origin:{x:.5,y:1}}),this.fieldBackground.setScale(t/this.fieldBackground.width/i),this.fieldBackground.setDepth(rt.FIELD_BACKGROUND)}handleBackgroundTopOffset(){let{height:e}=$.getWorldSize(),t=this.enemySquareOffsetY-(this.fieldBackground.displayHeight-e),i=Db-t;if(i<=-e/10&&(i=-e/10),$.isUsingLandscapeBackground()){this.handleBackgroundLandscapeSize(),this.fieldBackground.setPosition(0,e/2);return}this.fieldBackground.setPosition(0,e/2+i)}handleBackgroundLandscapeSize(){let{height:e}=$.getWorldSize(),{width:t,height:i}=$.getDesignSize(),s=e/i;this.fieldBackground.setWorldSize(t*s,i*s)}createBackgroundExtension(e){let{width:t,height:i}=$.getWorldSize(),s=this.fieldBackground.getBottomLeft();this.fieldBackgroundExtension=this.scene.add.rectangle(s.x,s.y,t,i,e),this.fieldBackgroundExtension.setOrigin(0,0)}createPlacementSquares(e){this.createPlayerPlacementSquares(e.SQUARE_COLOR),this.createEnemyPlacementSquares(e.SQUARE_COLOR)}createEnemyPlacementSquares(e){let{displayWidth:t,scaleX:i,scaleY:s}=this.fieldBackground,n=$.getPixelRatio(),r=i*n,o=s*n,a={x:this.enemySquareOffsetX*r,y:this.enemySquareOffsetY*r},h={x:this.enemySquareOffsetX*o,y:this.enemySquareOffsetY*o},{x:l,y:c}=a,{x:f,y:u}=h,p=t-l*2,d=t-f*2,g=p<d?p:d,m={x:p<d?a.x:h.x,y:Math.abs(c)<Math.abs(u)?c:u},E=this.fieldBackground.getTopLeft();E.x+=m.x,E.y+=m.y;let v=1;for(let y=0;y<3;y++)for(let T=0;T<5;T++){let A=new Xc(this.scene,E.x+T*g/5+g/10,E.y+y*g/5+g/10,g/5);A.updateAreaRect(e),A.setSquarePosition(y+1,T+1),A.setAlpha(v),v=v===1?0:1,this.enemyPlacementSquares.push(A)}}createPlayerPlacementSquares(e){let{displayWidth:t,scaleX:i,scaleY:s}=this.fieldBackground,n=$.getPixelRatio(),r=i*n,o=s*n,a={x:this.playerSquareOffsetX*r,y:this.playerSquareOffsetY*r},h={x:this.playerSquareOffsetX*o,y:this.playerSquareOffsetY*o},{x:l,y:c}=a,{x:f,y:u}=h,p=t-l*2,d=t-f*2,g=p<d?p:d,m={x:p<d?a.x:h.x,y:Math.abs(c)<Math.abs(u)?c:u},E=this.fieldBackground.getBottomLeft();E.x+=m.x,E.y+=m.y;let v=1;for(let y=0;y<3;y++)for(let T=0;T<5;T++){let A=new Xc(this.scene,E.x+T*g/5+g/10,E.y-y*g/5-g/10,g/5);A.updateAreaRect(e),A.setSquarePosition(3-y,T+1),A.setAlpha(v),v=v===1?0:1,this.playerPlacementSquares.push(A)}}hidePlacementSquares(){this.playerPlacementSquares.forEach(e=>e.kill()),this.enemyPlacementSquares.forEach(e=>e.kill())}showPlacementSquares(){this.playerPlacementSquares.forEach(e=>e.revive()),this.enemyPlacementSquares.forEach(e=>e.revive())}getPlayerPlacementSquare(e,t){return this.playerPlacementSquares.filter(i=>i.rowId===e&&i.colId===t)[0]}getEnemyPlacementSquare(e,t){return this.enemyPlacementSquares.filter(i=>i.rowId===e&&i.colId===t)[0]}getSquareBasedOnPosition(e,t){for(let i=0;i<this.playerPlacementSquares.length;i++){let s=this.playerPlacementSquares[i];if(s.placementArea.getBounds().contains(e,t))return s}return null}getSquareBasedOnIndex(e,t){for(let i=0;i<this.playerPlacementSquares.length;i++){let s=this.playerPlacementSquares[i];if(s.rowId===e&&s.colId===t)return s}return null}tryGettingAvailablePlacement(e,t){let i=this.getSquareBasedOnIndex(e,t);return i&&!i.isTaken?i:null}getAvailablePlacement(){let e=null;for(let t of this.playerPlacementSquares)if(!t.isTaken)return e=t,e;return e}resetPlacementSquareStatus(){for(let e of this.playerPlacementSquares)e.isTaken=!1}getRemainingAvailablePlacement(){return this.playerPlacementSquares.filter(e=>!e.isTaken).length}updateBackgroundElement(e){if(!$.isUsingLandscapeBackground())return;let t=document.getElementById("background-image");if(!t)return;let i=At.getLevelProgress();if(typeof i!="number"||i<0){t.src=j.BG_LANDSCAPE_TREE.FILE;return}let s=j.BG_LANDSCAPE_TREE.FILE;switch(Math.floor((i+1)/10)%5){case 0:s=j.BG_LANDSCAPE_TREE.FILE;break;case 1:s=j.BG_LANDSCAPE_DESERT.FILE;break;case 2:s=j.BG_LANDSCAPE_ICE.FILE;break;case 3:s=j.BG_LANDSCAPE_CRYSTAL.FILE;break;case 4:s=j.BG_LANDSCAPE_VOLCANO.FILE;break}t.onload=()=>{this.updateFieldBackground(e),this.updatePlacementSquares(e),this.updateHightLightSquares(e),t.onload=()=>{}},t.src=s}},Bb=kb,yo=new Dt(0,0,!0),Nb=class nf{static _instance;coin=yo;static get inst(){return this._instance||(this._instance=new nf),this._instance}getCoin(){return this.coin}setCoin(t,i){let s=typeof t=="number"?new Dt(t,i,!0):t;this.coin=s.clone(),this.saveCoin(),this.emitCoinChanged()}addCoin(t,i){let s=this.coin.clone();if(typeof t=="number"){let n=t;s.add(n,i)}else{let n=t;s.add(n)}this.coin=s,this.saveCoin(),this.emitCoinChanged()}removeCoin(t,i){let s=this.coin.clone();if(typeof t=="number"){let n=t;s.subtract(n,i)}else{let n=t;s.subtract(n)}s.smallerThan(yo)&&(this.coin=yo),this.coin=s,this.saveCoin(),this.emitCoinChanged()}saveCoin(){let{player:t}=codex;t.setGameData({coinBaseValue:this.coin.baseValue,coinSuffixValue:this.coin.suffix})}loadCoin(){let{player:t}=codex,i=t.getGameData(),s=i?.coinBaseValue??0,n=i?.coinSuffixValue??0;this.coin=new Dt(s,n,!0)}emitCoinChanged(){let{event:t}=codex;t.emit(Qt.COINS_CHANGED)}},_t=Nb,{STATUS:Ub}=Ii,{MELEE_UNIT_TYPE:Qi,RANGED_UNIT_TYPE:Os}=Q,{player:Kc}=codex,{Utils:{Valid:X5,Object:Fb}}=Ludex,Gb=class extends ue{scene;playerLevel;currentLevelId;currentLevelData;enemyData;playerData;constructor(e){super(e),this.scene=e}init(){let{gameMode:e}=this.scene;this.enemyData=[],(e===Tt.NORMAL||e===Tt.BOSS)&&(this.updatePlayerLevel(),this.loadLevel()),Tt.BATTLE}start(){this.isRunning()||this.setState(Ub.RUNNING)}setCurrentLevelId(e){this.currentLevelId=e}updatePlayerLevel(){let e=At.getLevelProgress();this.playerLevel=e}loadLevel(){try{if(this.scene.game.cache.json.exists("level-builder-json")){this.loadLevelBuilderLevel();return}this.setCurrentLevelId(this.playerLevel?this.playerLevel+1:1);let e=this.playerLevel?this.playerLevel:0,t=Math.floor(e/100)*100+1,i=t+99,s=(1e4+t).toString().substring(1),n=(1e4+i).toString().substring(1),r=this.scene.cache.json.get(`levels-${s}-${n}`),o=this.currentLevelId-t;o>=r.levels.length&&this.setCurrentLevelId(r.levels.length-1),this.currentLevelData=r.levels[o],this.scene.gameMode===Tt.BOSS?this.createBossEnemyData():this.createNormalEnemyData()}catch{}}createNormalEnemyData(){this.currentLevelData.enemy_row1.split("-").forEach((e,t)=>{if(e!=="0"){let i=e.charAt(0)==="m"?Qi:Os,s=parseInt(e.substring(1)),n=1,r=t+1;this.enemyData.push({type:i,level:s,positionRow:n,positionColumn:r})}}),this.currentLevelData.enemy_row2.split("-").forEach((e,t)=>{if(e!=="0"){let i=e.charAt(0)==="m"?Qi:Os,s=parseInt(e.substring(1)),n=2,r=t+1;this.enemyData.push({type:i,level:s,positionRow:n,positionColumn:r})}}),this.currentLevelData.enemy_row3.split("-").forEach((e,t)=>{if(e!=="0"){let i=e.charAt(0)==="m"?Qi:Os,s=parseInt(e.substring(1)),n=3,r=t+1;this.enemyData.push({type:i,level:s,positionRow:n,positionColumn:r})}})}createBossEnemyData(){let e=this.getPlayerBossLevel();this.enemyData.push({type:Qi,level:e,positionRow:2,positionColumn:3,isBoss:!0})}loadLevelBuilderLevel(){let e=this.scene.cache.json.get("level-builder-json");this.currentLevelId=e.level_id;try{this.currentLevelData=e}catch{}this.createData()}createData(){this.createNormalEnemyData(),this.createPlayerData()}createPlayerData(){this.playerData=[];let e=this.currentLevelData;e&&(_t.inst.setCoin(e.coins.baseValue,e.coins.suffix),e.player_row1.split("-").forEach((t,i)=>{if(t!=="0"){let s=t.charAt(0)==="m"?Qi:Os,n=parseInt(t.substring(1)),r=1,o=i+1;this.playerData.push({type:s,level:n,positionRow:r,positionColumn:o})}}),e.player_row2.split("-").forEach((t,i)=>{if(t!=="0"){let s=t.charAt(0)==="m"?Qi:Os,n=parseInt(t.substring(1)),r=2,o=i+1;this.playerData.push({type:s,level:n,positionRow:r,positionColumn:o})}}),e.player_row3.split("-").forEach((t,i)=>{if(t!=="0"){let s=t.charAt(0)==="m"?Qi:Os,n=parseInt(t.substring(1)),r=3,o=i+1;this.playerData.push({type:s,level:n,positionRow:r,positionColumn:o})}}))}isInLevelBuilderLevel(){return this.scene.gameMode!==Tt.NORMAL?!1:Fb.hasOwn(this.currentLevelData,"player_row1")}updateHighestCurrentLevel(){this.isInLevelBuilderLevel()||this.playerLevel<this.currentLevelId&&Kc.setGameData({level:this.currentLevelId})}updateHighestCurrentBossLevel(){let e=this.getPlayerBossLevel();e&&Kc.setGameData({bossLevelProgress:e})}getCurrentLevelId(){return this.currentLevelId}getModifierLevel(){let{gameMode:e}=this.scene;if(e===Tt.NORMAL||e===Tt.BOSS)return this.currentLevelId;let t=At.getLevelProgress();return Math.min(this.currentLevelId,t+1)}getPlayerLevel(){return this.isInLevelBuilderLevel()?this.currentLevelId:At.getLevelProgress()}getPlayerBossLevel(){return At.getPlayerBossLevelProgress()}loadAllLevels(){this.scene.cache.json.get("levels").levels.forEach((e,t)=>{this.currentLevelData=e,this.createNormalEnemyData()})}},Yb=Gb,Hb={FREE_COINS:{ID:"free-coins"},SPEED_UP:{ID:"speed-up"},BOSS_CHALLENGE:{ID:"boss-challenge"}},To=Hb,{STATUS:jc}=Ii,{enable:Wb}=Ut.Powers.FreeCoins,{enable:K5}=Ut.Powers.SpeedUp,{player:j5}=codex,zb=class extends ue{scene;items={};readyStateItems={};playingStateItems={};itemActive;isSpeedUp;constructor(e){super(e),this.scene=e,this.isSpeedUp=!1,this.createItems()}init(){this.setState(jc.READY),this.deactivateItems();let{objects:e}=this.scene.layoutManager;e.freeCoinsItem.startCountdown()}stop(){this.isRunning()&&(this.deactivateItems(),this.setState(jc.STOPPED))}activeItem=e=>{this.isRunning()&&this.items[e]&&(this.deactivateItems(),this.itemActive=e,this.items[e].activeItem())};deactivateItem=e=>{this.items[e]&&(this.itemActive="",this.items[e].deactivateItem())};deactivateItems(){for(let e in this.items)this.deactivateItem(e)}createItems(){this.createFreeCoinsButton()}createFreeCoinsButton(){if(!Wb)return;let{objects:e}=this.scene.layoutManager;this.items[To.FREE_COINS.ID]=e.freeCoinsItem}getAllItems(){return Object.values(this.items)}getItemsForReadyState(){return Object.values(this.readyStateItems)}getItemsForPlayingState(){return Object.values(this.playingStateItems)}isGameSpeedUp(){return this.isSpeedUp||!1}forceReturnToNormalSpeed(){this.scene.unitManager.resetSpeedAllUnits()}checkForSpeedSetting(){}syncSpeedSetting(){}updateTimers(){let{freeCoinsItem:e}=this.scene.layoutManager.objects;e.disableItem(),e.startCountdown()}},Vb=zb,Xb=U(it()),{UNIT_SIZE_SCALE:Zc}=Q,Kb=class extends ue{scene;isDirtyDepth;spineUnits=[];spineContainer;constructor(e){super(e),this.scene=e,this.isDirtyDepth=!1,this.spineUnits=[],this.spineContainer=this.scene.add.spineContainer(0,0),this.spineContainer.setDepth(rt.MANAGER_BASE_DEPTH)}init(){super.init(),this.spineUnits=[],this.spineContainer.removeAll()}update(e){this.isRunning()&&(this.spineUnits.forEach(t=>{let i=t.getSpineDisplay();if(!i)return;i.depth!==t.depth&&(i.setDepth(t.depth),this.isDirtyDepth=!0);let{x:s,y:n}=t.getWorldPosition();i.setPosition(s,n+25)}),e&&this.isDirtyDepth&&this.sortSpineContainerByDepth())}sortSpineContainerByDepth(){this.spineContainer.sort("depth",(e,t)=>e.depth-t.depth)}sortSpineContainerByName(){this.spineContainer.sort("name",(e,t)=>e.name.localeCompare(t.name))}sortSpineContainerByLevel(){this.spineContainer.sort("level",(e,t)=>e.level-t.level)}addSpines(e){if(this.isRunning())for(let t of e){if(this.spineUnits.some(s=>s===t))continue;let i=t.getSpineDisplay();i&&(i instanceof Xb.Sprite||(i.level=t.level,t.display.setSpineScale(Zc*.5,Zc*.5),this.spineUnits.push(t),this.spineContainer.add(i)))}}removeSpine(e){let t=e.getSpineDisplay();t&&(this.spineUnits=this.spineUnits.filter(i=>i!==e),this.spineContainer.remove(t,!1))}bringToTopOnDrag(e){let t=e.getSpineDisplay();t&&this.spineContainer.bringToTop(t)}hideAllSpines(){this.spineContainer.setActive(!1),this.spineContainer.setVisible(!1)}showAllSpines(){this.spineContainer.setActive(!0),this.spineContainer.setVisible(!0)}},jb=Kb,Zb=class{scene;constructor(e){this.scene=e}},Ds=Zb,qb=class extends Ds{constructor(e){super(e),this.scene.stopManager(),ut.setVolumeMusic(0,!0)}ready(){}play(){}levelComplete(){}levelFail(){}levelLoading(){let e=new $i(this.scene);this.scene.stateManager.changeStateTo(e)}quit(){}update(){}},vn=qb,{event:qc}=codex,{Events:Qc}=Ludex,Qb=class rf{static screens={};static _instance;static timeoutEvent;static get inst(){return this._instance||(this._instance=new rf),this._instance}static addScreen(t,i){this.screens[t]=i}static getScreen(t){return this.screens[t]||null}static openScreen(t,i){qc.emit(Qc.OPEN_SCREEN,{screenName:t,screenData:i})}static closeScreen(t){qc.emit(Qc.CLOSE_SCREEN,{screenName:t})}static showLoadingScreen(){this.openScreen(tt.LOADING_SCREEN)}static closeLoadingScreen(){this.closeScreen(tt.LOADING_SCREEN)}static showNotificationScreen(t){this.openScreen(tt.NOTIFY_SCREEN,t)}static closeNotificationScreen(){this.closeScreen(tt.NOTIFY_SCREEN)}static showLoadingNotificationScreen(){this.openScreen(tt.NOTIFY_SCREEN,{message:"Loading",loading:!0,enableCloseOnTouch:!1})}static listenResizeEventForCalculateLight(t){window.addEventListener("resize",()=>this.updateLightPosition(t))}static removeResizeEventForCalculateLight(t){window.removeEventListener("resize",()=>this.updateLightPosition(t))}static updateLightPosition=t=>{this.timeoutEvent&&clearTimeout(this.timeoutEvent),this.timeoutEvent=setTimeout(()=>{t.recalculateLightPosition()},500)}},ot=Qb,Jb=class extends Error{code;constructor(e,t){super(t),this.code=e}},$b=Jb,tP=class extends $b{playerId;tournamentId;constructor(e,t){super("PLAYER_HAS_TOURNAMENT","Player has a tournament"),this.playerId=e,this.tournamentId=t}},eP=class af{static _instance;static get inst(){return this._instance||(this._instance=new af),this._instance}static get isShareAvailable(){let t="shareAsync"in GameSDK.extra,i=GameSDK.getSDKName()==="Ludex";return t||i}static get isInviteAvailable(){let t="inviteAsync"in GameSDK.extra,i=GameSDK.getSDKName()==="Ludex";return t||i}},iP=eP,{missions:ks,storage:En,player:Jc}=codex,sP=class ia{static _instance;static finishedMissionCountTracker=null;static get inst(){return this._instance||(this._instance=new ia),this._instance}static addGameMissions(){this.removeDefaultMissions();let t=this.filterExistingMissions();for(let i of t)this.addMission(i)}static removeDefaultMissions(){ks.removeMission("finish-level")}static filterExistingMissions(){return[]}static getAllMissions(){let t=En.getStorageData("missions","tasks")??[];return this.Q(t)}static Q(t){let i=["finish-level"],{isInviteAvailable:s,isShareAvailable:n}=iP;s||i.push("invite-friend-1","invite-friend-weekly"),n||i.push("share-score-1");let r=[];for(let o of t)i.includes(o.id)||r.push(o);return r}static getAllProcessLogs(){let t=En.getStorageData("missions","process")??{};return delete t["finish-level"],t}static getGenericExpirationTime(){let t=this.getAllMissions();if(t.length===0)return-1;let i=t[0],{expirationTime:s,duration:n}=i;return s||Date.now()+n}static getMissionById(t){return this.getAllMissions().find(i=>i.id===t)}static getProcessLogById(t){return this.getAllProcessLogs()[t]}static addMission(t){ks.addMission(t)}static removeMission(t){ks.removeMission(t)}static addMissionProgress(t,i,s){ks.addMissionValue({id:t,type:i,value:s});let n=this.checkForFinishedMissions(),r={isMissionFinished:!1};return this.finishedMissionCountTracker=n,r}static setMissionRewardClaimed(t){ks.setMissionRewardClaimed(t)}static addFinishLevelMissionProgress(t){return this.addMissionProgress("finish-level","level",t)}static addMatchPairsMissionProgress(t){return this.addMissionProgress("match-pairs","pairs",t)}static addUseBombDefuseMissionProgress(t){return this.addMissionProgress("bomb-defuse","defuse",t)}static addUseRocketMissionProgress(t){return this.addMissionProgress("rocket","rocket",t)}static addUseShuffleMissionProgress(t){return this.addMissionProgress("shuffle","shuffle",t)}static addUseHintMissionProgress(t){return this.addMissionProgress("hint","hint",t)}static addInviteFriendMissionProgress(t){return this.addMissionProgress("invite-friend","invite",t)}static addShareScoreMissionProgress(t){return this.addMissionProgress("share-score","share",t)}static addJoinTournamentMissionProgress(t){return this.addMissionProgress("join-tournament","tournament",t)}static resetMissions(){ia.resetProcessLog(),ia.resetPlayerMissionProcess(),En.setStorageData("missions","tasks",[]),ks.requestMissions(),this.addDefaultMissions()}static resetProcessLog(){let t=this.getAllProcessLogs(),i=Object.keys(t);for(let s of i){let n=t[s],{require:r}=n,o=Object.keys(r);for(let a of o)r[a]=0;n.rewarded=!1}}static resetPlayerMissionProcess(){let t=Jc.getPlayerDataByKey("missionsData");if(!t)return;let{process:i}=t,s=Object.keys(i);for(let n of s){let r=i[n],{require:o}=r,a=Object.keys(o);for(let h of a)o[h]=0;r.rewarded=!1}Jc.setPlayerDataByName("missionsData",{process:i})}static addDefaultMissions(){}static getMissionProgressIcon(t){return""}static checkForClaimableMissions(){let t=this.getAllMissions(),i=this.getAllProcessLogs(),s=0;for(let n of t){if(n.expirationTime&&n.expirationTime<Date.now())continue;let r=i[n.id];if(r.rewarded)continue;let o=r.require,a=Object.keys(o);for(let h of a){let l=o[h],c=n.require[h];!c||l<c||s++}}return s}static checkForFinishedMissions(){let t=this.getAllMissions(),i=this.getAllProcessLogs(),s=0;for(let n of t){if(n.expirationTime&&n.expirationTime<Date.now())continue;let r=i[n.id];if(r.rewarded){s++;continue}let o=r.require,a=Object.keys(o);for(let h of a){let l=o[h],c=n.require[h];!c||l<c||s++}}return s}static initializeFinishedMissionCount(){let t=this.checkForFinishedMissions();this.finishedMissionCountTracker=t}static reduceAllMissionExpirationTime(){let t=this.getAllMissions();for(let i of t)i.expirationTime&&(i.expirationTime=i.expirationTime-1e3*60*60*24*2);En.setStorageData("missions","tasks",t),En.updateToWebStorage("missions")}},wr=sP,{Match:{Modes:yn},Utils:{Object:nP,Valid:He,String:$c,Decorator:kt,Function:Bs,Time:rP},Plugins:{Analytics:{Events:aP}}}=Ludex,{match:ee,player:ce,leaderboard:oP,analytics:hP}=codex,yi=()=>{ot.showLoadingNotificationScreen()},lP=async()=>{await rP.sleepAsync(0),ot.closeNotificationScreen()},We=e=>{if(lP(),e instanceof Error){let t="Something went wrong";He.isDebugger()&&(t=e.message),ot.showNotificationScreen({message:t,duration:3e3})}},ie=class bi{static _instance;static get inst(){return this._instance||(this._instance=new bi),this._instance}static isMatchActive(){let t=this.getMatchState(),{status:i}=t;return i==="active"}static isMatchFinished(){let t=this.getMatchState(),{status:i}=t;return i==="finished"}static isSingleMode(){return this.getMatchMode()===yn.SINGLE}static isChallengeMode(){return this.getMatchMode()===yn.CHALLENGE_FRIEND}static isTournamentMode(){return this.getMatchMode()===yn.TOURNAMENT}static isPlayerFinished(){let t=this.getMatchState(),{profiles:i={}}=t,s=ce.getPlayerId(),n=i[s];return n?n.finished??!1:!1}static getMatchPlayerScore(){let t=this.getMatchState(),{profiles:i={}}=t,s=ce.getPlayerId();return i[s]?.score??0}static getMatchMode(){let t=this.getMatchState();return He.isString(t.mode)?t.mode:null}static getMatchState(){let t=ee.getMatchState();if(!t)throw new Error("Match state not found");return t}static getMatchCustomData(){let t=this.getMatchState();return He.isObject(t.customData)?t.customData:null}static async setProfileMatchDataAsync(t){await ee.handler.setProfileData(t)}static async setMatchCustomDataAsync(t){await ee.handler.setMatchCustomData(t)}static async fetchMatchCustomDataAsync(){await ee.handler.getMatchCustomData()}static async setLeaderboardScoreAsync(t){await ee.handler.setLeaderboardScore(t)}static getMatchLevel(){let{level:t=2}=this.getMatchCustomData()??{};return t}static async startSingleModeAsync(){let t=ce.getPlayerId(),i=At.getLevelProgress();return await ee.strategy.start.processAsync({matchId:"local",playerId:t,gameMode:yn.SINGLE,extraData:{level:i}}),!0}static async finishSingleModeAsync(){return await ee.strategy.finish.processAsync({setPlayerBestScore:!0,postGlobalLeaderboard:!0}),!0}static async autoChallengeModeAsync(){let t=await this.continueChallengeModeAsync();return!!(t||(ot.closeNotificationScreen(),t=await this.startChallengeRandomOpponentAsync(),t)||(ot.closeNotificationScreen(),t=await this.startChallengeChooseOpponentAsync(),t)||(ot.closeNotificationScreen(),t=await this.joinChallengeModeAsync(),t))}static async startChallengeRandomOpponentAsync(){let t=ce.getConnectedPlayerIds(10,0),i=Math.floor(Math.random()*t.length),s=t[i];return!He.isString(s)||He.isEmpty(s)?!1:(wr.addInviteFriendMissionProgress(1),this.startChallengeModeAsync(s))}static async startChallengeChooseOpponentAsync(){let t=ce.getPlayerId(),i=At.getLevelProgress(),s=Math.max(i,2),n=ee.context.choose.processAsync({playerId:t,fallbackSingleMode:!1,extraData:{level:s}}),[r,o]=await Bs.handleAsync(n);if(this.inst.isUserInputError(o))return!1;if(o)throw o;return wr.addInviteFriendMissionProgress(1),!0}static async startChallengeModeAsync(t){let i=ce.getPlayerId(),s=At.getLevelProgress(),n=Math.max(s,2),r=ee.challenge.friend.processAsync({playerId:i,opponentId:t,extraData:{level:n}}),[o,a]=await Bs.handleAsync(r);if(this.inst.isUserInputError(a))return!1;if(a)throw a;return!0}static async joinChallengeModeAsync(){let{id:t,customData:i}=bi.getMatchState(),{playerId:s,opponentId:n}=i;if(!He.isString(t))throw new Error("Invalid match id");if(!He.isString(s))throw new Error("Invalid player id");if(!He.isString(n))throw new Error("Invalid opponent id");let r=ee.challenge.join.processAsync({matchId:t,playerId:s,opponentId:n}),[o,a]=await Bs.handleAsync(r);if(this.inst.isUserInputError(a))return!1;if(a)throw a;return wr.addInviteFriendMissionProgress(1),!0}static async continueChallengeModeAsync(){let{id:t,customData:i}=bi.getMatchState(),{playerId:s,opponentId:n}=i;if(!He.isString(t))throw new Error("Invalid match id");if(!He.isString(s))throw new Error("Invalid player id");if(!He.isString(n))throw new Error("Invalid opponent id");let r=GameSDK.context.getID();if(!r)throw new Error("Cannot get contextId");let o=ee.challenge.continue.processAsync({matchId:t,contextId:r,playerId:s,opponentId:n}),[a,h]=await Bs.handleAsync(o);if(this.inst.isUserInputError(h))return!1;if(h)throw h;return wr.addInviteFriendMissionProgress(1),!0}static async finishChallengeModeAsync(){let t=this.getMatchLevel();return await ee.challenge.finish.processAsync({extraData:{level:t}}),!0}static async joinTournamentAsync(t,i){let s=ce.getPlayerId();await this.setMatchCustomDataAsync({playerId:s,level:i,contextId:"SOLO"});let n=ee.tournament.join.processAsync({tournamentId:t,playerId:s}),[r,o]=await Bs.handleAsync(n);if(!o)return!0;if(this.inst.isUserInputError(o))return!1;throw o}static async continueTournamentAsync(){let t=ce.getPlayerId(),i=GameSDK.context.getID();return await ee.tournament.continue.processAsync({playerId:t,contextId:i}),!0}static async finishTournamentAsync(){let t=ce.getPlayerId(),i=ce.getBestScore();return await ee.tournament.finish.processAsync({playerId:t,bestScore:i}),!0}static async createTournamentAsync(){let t=!1,i=(await this.inst.getTournamentsAsync()).find(n=>{let r=JSON.parse(n.getPayload());return n.getTournamentType()==="DEFAULT"&&r.playerId===ce.getPlayerId()});if(i)throw new tP(ce.getPlayerId(),i.getID());let s=this.inst.createTournamentPayload();try{await ee.tournament.create.processAsync(s);let{leaderboardId:n}=s;oP.addLeaderboard({name:n,type:"tournament",autoSortRank:!0,leaderboardId:n}),t=!0}catch{}return t}static async shareTournamentAsync(t){let[i,s]=await Bs.handleAsync(GameSDK.tournament.shareAsync({score:t})),n=!s;if(hP.event(aP.TOURNAMENT_SHARE,{success:n}),n)return!0;if(this.inst.isUserInputError(s))return!1;throw s}async getTournamentsAsync(){try{return await GameSDK.tournament.getTournamentsAsync()}catch{return[]}}createTournamentPayload(){let t=$c.generateObjectId(),i=ce.getPlayerId(),s=bi.getMatchState(),{profiles:n={}}=s;return{score:n[i]?.score??0,playerId:i,mode:yn.TOURNAMENT,name:this.createTournamentName(),leaderboardId:t,payload:{playerId:i,leaderboardId:t}}}createTournamentName(){let t=ce.getPlayer(),{name:i=null}=t;if(i){let s=i.substring(0,7),n=`${s.split(" ")[0]||s}'s Tournament`;return`${$c.removeDiacritics(n)}`}return"Tournament"}isUserInputError(t){return t?!!(t instanceof Error&&(["dismissed","closed","refused"].some(i=>t.message.indexOf(i)!==-1)||nP.hasOwn(t,"code")&&t.code==="USER_INPUT")):!1}static async handleMatchStart(){let t=bi.isSingleMode()&&bi.isMatchFinished();(!bi.getMatchMode()||t)&&await bi.startSingleModeAsync()}};ne([kt.tryCatch()],ie,"setProfileMatchDataAsync",1),ne([kt.tryCatch()],ie,"setMatchCustomDataAsync",1),ne([kt.tryCatch()],ie,"fetchMatchCustomDataAsync",1),ne([kt.tryCatch()],ie,"setLeaderboardScoreAsync",1),ne([kt.tryCatch(We),kt.preStart(yi)],ie,"startSingleModeAsync",1),ne([kt.tryCatch(We)],ie,"finishSingleModeAsync",1),ne([kt.tryCatch(We)],ie,"autoChallengeModeAsync",1),ne([kt.tryCatch(We),kt.preStart(yi)],ie,"startChallengeChooseOpponentAsync",1),ne([kt.tryCatch(We),kt.preStart(yi)],ie,"startChallengeModeAsync",1),ne([kt.tryCatch(We),kt.preStart(yi)],ie,"joinChallengeModeAsync",1),ne([kt.tryCatch(We),kt.preStart(yi)],ie,"continueChallengeModeAsync",1),ne([kt.tryCatch(We),kt.preStart(yi)],ie,"finishChallengeModeAsync",1),ne([kt.tryCatch(We),kt.preStart(yi)],ie,"joinTournamentAsync",1),ne([kt.tryCatch(We),kt.preStart(yi)],ie,"continueTournamentAsync",1),ne([kt.tryCatch(We),kt.preStart(yi)],ie,"finishTournamentAsync",1);var uP=ie,Ti=uP,{Utils:{Array:td,String:So},Plugins:{Analytics:{Events:Ji}}}=Ludex,Rr={BOSS_START:"boss_start",BOSS_END:"boss_end",TUTORIAL_STEP:"tutorial_step",EARN_UNIT:"earn_unit"},{analytics:Te}=codex,cP=[tt.LOADING_SCREEN,tt.NOTIFY_SCREEN],dP=class of{static _instance;static get inst(){return this._instance||(this._instance=new of),this._instance}static trackingPages=[];static trackCurrentPage(t,i){if(td.has(cP,t)||!i&&!td.has(this.trackingPages,t))return;this.trackingPages=this.trackingPages.filter(n=>n!==t),i&&this.trackingPages.push(t);let s=this.getCurrentPage();Te.pageview(s)}static switchSceneTracking(){this.trackingPages=[];let t=this.getCurrentPage();Te.pageview(t)}static getCurrentPage(){return this.trackingPages.length>0?this.trackingPages[this.trackingPages.length-1]||"Unknown Page":nt.getCurrentScene()?.scene.key||"Unknown Page"}static trackButtonClick(t){let i=this.getCurrentPage();Te.event(Ji.BUTTON_CLICK,{screen_name:i,button_name:t})}static trackItemUsage(t,i){Te.event(Ji.USE_ITEM,{active:i,item_name:t})}static logLevelStartAnalytics(){let{mode:t,customData:{level:i=1}}=Ti.getMatchState();Te.event(Ji.LEVEL_START,{level:i,level_name:`Level ${i.toString().padStart(5,"0")}`,game_mode:t?So.toUpperCamelCase(t):void 0})}static logLevelCompleteAnalytics(t){let{mode:i,customData:{level:s=1}}=Ti.getMatchState();Te.event(Ji.LEVEL_END,{level:s,score:0,success:!0,played_time:t,level_name:`Level ${s.toString().padStart(5,"0")}`,game_mode:i?So.toUpperCamelCase(i):void 0})}static logLevelFailAnalytics(t){let{mode:i,customData:{level:s=1}}=Ti.getMatchState();Te.event(Ji.LEVEL_END,{level:s,score:0,success:!1,played_time:t,level_name:`Level ${s.toString().padStart(5,"0")}`,game_mode:i?So.toUpperCamelCase(i):void 0})}static logBossStartAnalytics(t,i){Te.event(Rr.BOSS_START,{boss_level:t,current_level:`Level ${i.toString().padStart(5,"0")}`})}static logBossEndAnalytics(t,i,s){Te.event(Rr.BOSS_END,{boss_level:t,current_level:`Level ${i.toString().padStart(5,"0")}`,success:s})}static logEarnUnitAnalytics(t,i){Te.event(Rr.EARN_UNIT,{value:`${t.toLowerCase()}-lv${i}`})}static trackTutorialBegin(){Te.event(Ji.TUTORIAL_BEGIN)}static trackTutorialStep(t){Te.event(Rr.TUTORIAL_STEP,{step:t})}static trackTutorialComplete(){Te.event(Ji.TUTORIAL_COMPLETE)}},xt=dP,{DelayFinishGame:Ao}=Ut,{Plugins:{Ads:{Types:{INTERSTITIAL:pP}}}}=Ludex,gP=class extends Ds{constructor(e){super(e);let{gameMode:t,levelManager:i,tutorialManager:s,powerManager:n}=this.scene,r=i.getCurrentLevelId(),o=this.scene.getPlayedTimeSeconds();n.forceReturnToNormalSpeed(),t===Tt.BOSS&&xt.logBossEndAnalytics(i.getPlayerBossLevel(),r,!1),t===Tt.NORMAL&&xt.logLevelFailAnalytics(o),ut.playSound(Et.LOSE_SOUND),this.scene.effectManger.playResultLoseAnimation(),wt.hideBannerAds(),this.scene.isBannerAdShowed=!1,this.handleMatchEnd(),s.isRunning()?this.handleTutorialCase():this.openResultScreen()}handleMatchEnd(){Ti.isSingleMode()&&Ti.finishSingleModeAsync()}openResultScreen(){let{gameMode:e}=this.scene,t=this.scene.coinManager.getTotalCoinsByAttack();this.scene.time.delayedCall(Ao,async()=>{this.scene.stopManager(),wt.isReadyAdShowable(pP)&&await wt.showInterstitialAdAsync(),ot.openScreen(tt.RESULT_SCREEN,{result:"lose",gameMode:e,coinRewarded:t})})}handleTutorialCase(){let{levelManager:e,coinManager:t,gameMode:i}=this.scene,s=e.getCurrentLevelId(),n=t.getTotalCoinsByAttack(),r=s===1?Ao*1.5:Ao;this.scene.time.delayedCall(r,async()=>{if(this.scene.stopManager(),s===1){_t.inst.addCoin(n),this.scene.prepareRound();return}ot.openScreen(tt.RESULT_SCREEN,{result:"lose",gameMode:i,coinRewarded:n})})}ready(){let e=new Cr(this.scene);this.scene.stateManager.changeStateTo(e)}play(){}levelFail(){}levelComplete(){}levelLoading(){let e=new $i(this.scene);this.scene.stateManager.changeStateTo(e)}quit(){let e=new vn(this.scene);this.scene.stateManager.changeStateTo(e)}update(){}},ed=gP,fP=class extends Ds{isLevelOver;constructor(e){super(e),this.isLevelOver=!1;let{fieldManager:t,unitManager:i,uiManager:s,spineManager:n,tutorialManager:r,effectManger:o,powerManager:a}=this.scene;this.scene.accessibilityManager.stop(),t.hidePlacementSquares(),n.sortSpineContainerByName(),o.stopRewardCurveAnimation(),i.savePlayerUnits(),i.setReadyAllUnits(),i.runChildUpdateGroups(!0),i.disableDragOnPlayerUnits(),s.showUIForPlayingState(),a.checkForSpeedSetting(),this.scene.isBannerAdShowed===!1&&!r.isRunning()&&(this.scene.isBannerAdShowed=!0,wt.showBannerAds()),ut.setVolumeMusic(.04,!0)}ready(){let e=new Cr(this.scene);this.scene.stateManager.changeStateTo(e)}play(){}levelFail(){let e=new ed(this.scene);this.scene.stateManager.changeStateTo(e)}levelComplete(){let e=new ad(this.scene);this.scene.stateManager.changeStateTo(e)}levelLoading(){let e=new $i(this.scene);this.scene.stateManager.changeStateTo(e)}quit(){let e=new vn(this.scene);this.scene.stateManager.changeStateTo(e)}update(){if(this.isLevelOver)return;let{uiManager:e,spineManager:t}=this.scene,i=e.getCurrentEnemyHp()<=0,s=e.getCurrentPlayerHp()<=0;if(i){this.scene.gameOver("win"),this.isLevelOver=!0;return}if(s&&!i){this.scene.gameOver("lose"),this.isLevelOver=!0;return}t.update(!1)}},id=fP,{Utils:{Device:mP}}=Ludex,vP=class hf extends Ds{constructor(t){super(t);let{uiManager:i,unitManager:s,coinManager:n,spineManager:r,levelManager:o,tutorialManager:a,difficultyManager:h,powerManager:l,gameMode:c}=this.scene;this.scene.initManager(),this.scene.startManager();let f=$.isGameWorldSmallerRatio(.575)||this.scene.gameMode===Tt.BATTLE;!mP.isDesktop()&&f&&!a.isRunning()?(this.scene.isBannerAdShowed=!0,wt.showBannerAds()):this.scene.isBannerAdShowed=!1;let u=s.getPlayerUnits(),p=s.getEnemyUnits();r.addSpines([...p,...u]),s.enableDragOnPlayerUnits(),s.runChildUpdateGroups(!0);let d=o.getCurrentLevelId(),g=o.getModifierLevel(),m=o.getPlayerLevel();n.setUnitModifier(m),n.setAttackModifier(g),h.updateCustomUnitModifierByLevel(m),h.updateCustomAttackModifierByLevel(g),c===Tt.NORMAL&&this.scene.time.delayedCall(1e3,()=>{}),ot.closeLoadingScreen(),this.scene.gameMode===Tt.BATTLE||(this.scene.gameMode===Tt.BOSS?(s.hideAllUnits(),this.scene.time.delayedCall(450,()=>{ut.setVolumeMusic(.4,!0),i.showUIForReadyState(),this.scene.updateUI()})):(ut.setVolumeMusic(.4,!0),i.showUIForReadyState(),this.scene.updateUI())),a.showTutorial(),l.syncSpeedSetting(),this.scene.handleStartOverFlow(),this.logLevelStart()}logLevelStart(){let{levelManager:t}=this.scene,i=this.scene.gameMode===Tt.BOSS,s=t.getCurrentLevelId();if(i){xt.logBossStartAnalytics(t.getPlayerBossLevel(),s);return}xt.logLevelStartAnalytics()}ready(){if(this.scene.gameMode!==Tt.BOSS)return;let t=new hf(this.scene);this.scene.stateManager.changeStateTo(t)}play(){let t=new id(this.scene);this.scene.stateManager.changeStateTo(t)}levelFail(){}levelComplete(){}levelLoading(){let t=new $i(this.scene);this.scene.stateManager.changeStateTo(t)}quit(){let t=new vn(this.scene);this.scene.stateManager.changeStateTo(t)}update(){this.scene.spineManager.update(!0)}},Cr=vP,EP={BACKGROUND:{KEY:"background_music",FILE:"./assets/music/bg_music.mp3"},EFFECTS_FILES:{"start-game-sound":"./assets/sounds/start-game-sound.mp3","next-round-effect":"./assets/sounds/next-round-effect.mp3","lose-sound":"./assets/sounds/lose-sound.mp3","thunder-sound":"./assets/sounds/thunder-sound.mp3","close-click":"./assets/sounds/close-click.mp3","button-click":"./assets/sounds/button-click.mp3","drag-unit-end":"./assets/sounds/drag-unit-end.mp3","drag-unit-start":"./assets/sounds/drag-unit-start.mp3","start-battle":"./assets/sounds/start-battle.mp3","melee-attack":"./assets/sounds/melee-attack.mp3","arrow-shoot":"./assets/sounds/arrow-shoot.mp3","win-battle":"./assets/sounds/win-battle.mp3","unit-damaged":"./assets/sounds/unit-damaged.mp3","unit-merge":"./assets/sounds/unit-merge.mp3","turn-switch":"./assets/sounds/turn-switch.mp3","unit-unlock":"./assets/sounds/unit-unlock.mp3","coin-spawn":"./assets/sounds/coin-spawn.mp3","coin-increase-repeatedly":"./assets/sounds/coin-increase-repeatedly.mp3","gift-charge":"./assets/sounds/gift-charge.mp3","gift-explode":"./assets/sounds/gift-explode.mp3","gift-reveal":"./assets/sounds/gift-reveal.mp3"}},Bi=EP,sd=U(ci()),{player:yP}=codex,{UNITS_SPINES:TP}=W,{MELEE_UNIT_TYPE:xo,RANGED_UNIT_TYPE:wo,ALIEN_UNIT_TYPE:nd}=Q,{MaximumMeleeLevel:SP,MaximumRangedLevel:AP}=Ut,xP=class lf{static _instance;static isResourceRequested=!1;static requestingSpines=[];static get inst(){return this._instance||(this._instance=new lf),this._instance}static runGameResourceBackgroundLoadFlow(){if(this.isResourceRequested)return;this.isResourceRequested=!0;let t=nt.getGlobalScene();t&&(this.loadSounds(),this.loadAllUnits(),this.loadAvatarUnits(),this.loadAllBackgrounds(),t.load.start())}static loadLevelJsonByLevel(t,i){let s=this.getLevelJsonKey(t),n=nt.getGlobalScene();return!n||n.cache.json.exists(s)?!1:(i&&n.load.once(`${sd.FILE_KEY_COMPLETE}json-${s}`,i),n.load.json(s,`assets/json/${s}.json`),n.load.start(),!0)}static loadSounds(){let t=nt.getGlobalScene();t&&(t.cache.audio.exists(Bi.BACKGROUND.KEY)||(t.load.once(`${sd.FILE_KEY_COMPLETE}audio-${Bi.BACKGROUND.KEY}`,()=>{yP.getPlayerSetting("music")&&(ut.playMusic(),ut.setVolumeMusic(.4))}),t.load.audio(Bi.BACKGROUND.KEY,Bi.BACKGROUND.FILE)))}static loadAllUnits(){if(!nt.getGlobalScene())return;let t=At.getPlayerUnlockedMeleeLevel(),i=At.getPlayerUnlockedRangedLevel();for(let s=t;s<=SP;s++)this.loadUnit(s,xo);for(let s=i;s<=AP;s++)this.loadUnit(s,wo)}static loadAvatarUnits(){let t=nt.getGlobalScene();t&&(t.textures.exists(W.UNITS.KEY)||t.load.multiatlas({key:W.UNITS.KEY,atlasURL:W.UNITS.JSON,path:W.UNITS.PATH}))}static loadAllBackgrounds(){let t=$.isUsingLandscapeBackground(),i=nt.getGlobalScene();if(!i)return;let s=(r,o)=>{i.textures.exists(r)||this.loadBackgroundImage(o,r)},n=(r,o)=>{i.textures.exists(r)||i.load.image(r,o)};if(t){s(j.BG_LANDSCAPE_TREE.KEY,j.BG_LANDSCAPE_TREE.FILE),s(j.BG_LANDSCAPE_DESERT.KEY,j.BG_LANDSCAPE_DESERT.FILE),s(j.BG_LANDSCAPE_ICE.KEY,j.BG_LANDSCAPE_ICE.FILE),s(j.BG_LANDSCAPE_VOLCANO.KEY,j.BG_LANDSCAPE_VOLCANO.FILE),s(j.BG_LANDSCAPE_CRYSTAL.KEY,j.BG_LANDSCAPE_CRYSTAL.FILE);return}n(j.BG_TREE.KEY,j.BG_TREE.FILE),n(j.BG_DESERT.KEY,j.BG_DESERT.FILE),n(j.BG_ICE.KEY,j.BG_ICE.FILE),n(j.BG_VOLCANO.KEY,j.BG_VOLCANO.FILE),n(j.BG_CRYSTAL.KEY,j.BG_CRYSTAL.FILE)}static loadUnits(t){let i=t.split("/"),s=[];for(let n of i){let r=n.split("-");for(let o of r){if(o==="0"||s.includes(o))continue;let a=nd;if(o[0]==="m"&&(a=xo),o[0]==="r"&&(a=wo),a===nd)continue;let h=parseInt(o.substring(1));s.push(o),this.loadUnit(h,a)}}}static loadUnit(t,i){let s=nt.getGlobalScene();if(!s)return;let{MELEE:n,RANGED:r}=TP,o=null;switch(i){case xo:t>0&&t<=Object.keys(n).length&&(o=n[t]);break;case wo:t>0&&t<=Object.keys(r).length&&(o=r[t]);break}o&&(this.requestingSpines.includes(o.KEY)||(this.requestingSpines.push(o.KEY),s.load.spine(o.KEY,o.jsonPATH,o.atlasPATH)))}static async loadBackgroundImage(t,i){let s=nt.getGlobalScene();if(s)return new Promise((n,r)=>{let o=new Image;o.crossOrigin="use-credentials",o.onload=()=>{s.load.image(i,t),n()},o.onerror=()=>{r()},o.src=t})}static getLevelJsonKey(t){let i=Math.floor(t/100)*100+1,s=i+99,n=(1e4+i).toString().substring(1),r=(1e4+s).toString().substring(1);return`levels-${n}-${r}`}},Ro=xP,{player:wP}=codex,RP=class extends Ds{constructor(e){super(e),this.run()}async run(){let{uiManager:e,layoutManager:t}=this.scene;this.scene.initGameMode(),t.layout.alignUI(),e.showUIForLevelLoadingState(),this.autoUpgradeUnitData();let i=At.getLevelProgress();Ro.loadLevelJsonByLevel(i,this.handleLoadComplete)?ot.showLoadingScreen():this.scene.time.delayedCall(0,this.handleLoadComplete)}autoUpgradeUnitData(){let e=At.getPlayerUnitData();if(!e||typeof e!="string")return;let t=At.upgradePlayerUnits(e);t!==e&&wP.setGameData({playerUnitData:t})}handleLoadComplete=()=>{this.scene.prepareRound(),Ro.runGameResourceBackgroundLoadFlow(),this.reloadNextLevelJson()};reloadNextLevelJson(){let e=At.getLevelProgress()+1;e%100===0&&Ro.loadLevelJsonByLevel(e)}ready(){let e=new Cr(this.scene);this.scene.stateManager.changeStateTo(e)}play(){}levelFail(){}levelComplete(){}levelLoading(){}quit(){let e=new vn(this.scene);this.scene.stateManager.changeStateTo(e)}update(){}},$i=RP,{DelayFinishGame:rd,MaxLevel:CP}=Ut,{Plugins:{Ads:{Types:{INTERSTITIAL:_P}}}}=Ludex,{player:bP}=codex,PP=class extends Ds{constructor(e){super(e);let{gameMode:t,levelManager:i,tutorialManager:s,powerManager:n}=this.scene;n.forceReturnToNormalSpeed();let r=i.getCurrentLevelId(),o=r>=CP,a=this.scene.getPlayedTimeSeconds();t===Tt.NORMAL&&!o&&(i.updateHighestCurrentLevel(),this.scene.updateLevelToLeaderboard(r),xt.logLevelCompleteAnalytics(a)),t===Tt.BOSS&&(xt.logBossEndAnalytics(i.getPlayerBossLevel(),r,!0),i.updateHighestCurrentBossLevel()),ut.playSound(Et.WIN_BATTLE),this.scene.effectManger.playResultWinAnimation(),o&&this.setPlayerEligibleForReset(),wt.hideBannerAds(),this.scene.isBannerAdShowed=!1,this.handleMatchEnd(),s.isRunning()?this.handleTutorialCase():this.openResultScreen()}handleMatchEnd(){Ti.isSingleMode()&&Ti.finishSingleModeAsync()}openResultScreen(){let{coinManager:e,gameMode:t}=this.scene,i=e.getRewardCoinsByAttackCoins(),s=rd;this.scene.time.delayedCall(s,async()=>{this.scene.stopManager(),wt.isReadyAdShowable(_P)&&await wt.showInterstitialAdAsync(),ot.openScreen(tt.RESULT_SCREEN,{result:"win",gameMode:t,coinRewarded:i})})}handleTutorialCase(){let{levelManager:e,coinManager:t,gameMode:i}=this.scene;e.getCurrentLevelId()===1&&xt.trackTutorialStep(5);let s=t.getRewardCoinsByAttackCoins();this.scene.time.delayedCall(rd,async()=>{this.scene.stopManager(),ot.openScreen(tt.RESULT_SCREEN,{result:"win",gameMode:i,coinRewarded:s})})}setPlayerEligibleForReset(){bP.setGameData({isEligibleForReset:!0})}ready(){}play(){}levelFail(){}levelComplete(){}levelLoading(){let e=new $i(this.scene);this.scene.stateManager.changeStateTo(e)}quit(){let e=new vn(this.scene);this.scene.stateManager.changeStateTo(e)}update(){}},ad=PP,LP=class{scene;currentState;constructor(e){this.scene=e}init(){this.currentState||(this.currentState=new $i(this.scene)),this.currentState.levelLoading()}changeStateTo(e){this.currentState=e}isInReadyState(){return this.currentState instanceof Cr}isInPlayingState(){return this.currentState instanceof id}isInLevelLoadingState(){return this.currentState instanceof $i}isInLevelFailState(){return this.currentState instanceof ed}isInLevelCompleteState(){return this.currentState instanceof ad}ready(){this.currentState.ready()}play(){this.currentState.play()}levelFail(){this.currentState.levelFail()}levelComplete(){this.currentState.levelComplete()}levelLoading(){this.currentState.levelLoading()}quit(){this.currentState.quit()}update(){this.currentState.update()}},IP=LP,MP=U(ft()),OP={duration:600,ease:MP.Quadratic.Out,props:{alpha:{start:1,from:1,to:0}}},od=OP,DP=U(it()),kP=U(Zt()),BP=U(dt()),NP=class extends DP.Container{scene;id;isActive;isDisabled;zone;icon;constructor(e,t,i,s,n,r){super(e),this.id=t,this.scene=e,this.createIcon(i,s,n,r),this.setWorldSize(n,r),this.createInput(),this.setDepth(rt.ITEM),this.scene.add.existing(this)}activeItem=()=>{if(this.isActive===!0||this.isDisabled===!0)return;this.isActive=!0,this.icon.setTint(2927998);let{powerManager:e}=this.scene;e.isStopped()||(ut.playSound(Et.BUTTON_CLICK),this.activeLogic())};deactivateItem=()=>{if(this.isActive===!1)return;this.isActive=!1,this.icon.setTint(3487029);let{powerManager:e}=this.scene;e.isStopped()||this.deactivateLogic()};enableItem(){this.isDisabled!==!1&&(this.icon.setAlpha(1),this.isDisabled=!1)}disableItem(){this.isDisabled!==!0&&(this.deactivateItem(),this.icon.setAlpha(.4),this.isDisabled=!0)}createIcon(e,t,i,s){this.icon=this.scene.make.image({key:e,frame:t},!1),this.icon.setWorldSize(i,s),this.add(this.icon)}createInput(){let{displayWidth:e,displayHeight:t}=this.icon;this.zone=this.scene.make.zone({width:e,height:t}),this.add(this.zone),BP.Align.In.Center(this.zone,this.icon),this.zone.setInteractive({useHandCursor:!0}),this.zone.on(kP.GAMEOBJECT_POINTER_UP,this.handleOnClick)}handleOnClick=()=>{this.logItemEvent();let{powerManager:e}=this.scene;e.activeItem(this.id)};logItemEvent(){xt.trackButtonClick(this.name),xt.trackItemUsage(this.id,this.isActive)}},hd=NP,UP=U(dt()),{KEY:Co,FRAME:_o}=W.GAMEPLAY,{ID:FP}=To.SPEED_UP,{player:ld,language:ud}=codex,GP=class extends hd{scene;isSpeedUp;speedText;constructor(e){super(e,FP,Co,_o.DASHBOARD_SPEED_BTN_OFF,34,38.5),this.scene=e,this.isSpeedUp=!1,this.setName("SpeedUpItem"),this.createSpeedText()}enableItem(){this.isDisabled!==!1&&(this.isDisabled=!1,this.zone.setInteractive())}activeItem=()=>{if(this.isActive===!0||this.isDisabled===!0)return;this.isActive=!0;let{powerManager:e}=this.scene;e.isStopped()||(ut.playSound(Et.BUTTON_CLICK),this.activeLogic())};activeLogic(){let{stateManager:e}=this.scene;!e.isInPlayingState()&&!e.isInReadyState()||(this.isSpeedUp?this.returnToNormalSpeed():this.speedUpGameplay())}disableItem(){this.isDisabled!==!0&&(this.zone.disableInteractive(),this.isDisabled=!0)}deactivateItem=()=>{if(this.isActive===!1)return;this.isActive=!1;let{powerManager:e}=this.scene;e.isStopped()||this.deactivateLogic()};deactivateLogic(){}speedUpGameplay(){this.icon.setTexture(Co,_o.DASHBOARD_SPEED_BTN_ON),this.isSpeedUp=!0,ld.setSetting("speedUp",!0);let{stateManager:e}=this.scene;e.isInPlayingState()&&this.scene.unitManager.speedUpAllUnits()}returnToNormalSpeed(){this.icon.setTexture(Co,_o.DASHBOARD_SPEED_BTN_OFF),this.isSpeedUp=!1,ld.setSetting("speedUp",!1);let{stateManager:e}=this.scene;e.isInPlayingState()&&this.scene.unitManager.resetSpeedAllUnits()}createSpeedText(){let e=ud.getCurrentLocale(),t=11;if(!$.isLandscape())switch(e){case"ru":case"ja":t=7;break;case"pt":case"es":case"it":t=9;break}this.speedText=Z.buildText(ud.getText("SPEED").toUpperCase(),t).setDefaultStroke().build(this.scene),this.add(this.speedText),this.bringToTop(this.speedText);let i=$.isLandscape()?15:-2;UP.Align.In.BottomCenter(this.speedText,this.icon,0,i)}},cd=GP,YP=U(ft()),{MaximumMeleeLevel:dd,MaximumRangedLevel:pd}=Ut,{Utils:{Valid:HP,Signal:WP}}=Ludex,{event:zP}=codex,VP=class extends ue{scene;hideUIAnimController=new WP.SignalController;constructor(e){super(e),this.scene=e,this.initUILogic()}start(){this.isRunning()||(super.start(),this.updateUIData())}updateUIData=()=>{this.updateCoinBar(),this.updateUnitBarUI(),this.updateTotalHpBar()};initUILogic(){let{layoutManager:e,devToolManager:t}=this.scene,{objects:i}=e;i.startButton.onClick=this.startFight,i.settingsButton.onClick=()=>{ot.openScreen(tt.SETTINGS_SCREEN)},HP.isDebugger()&&(i.resetLevelButton.onClick=this.scene.resetLevel,i.selectLevelButton.onClick=t.handleShowLoadMapInput,i.currentUnitModButton.onClick=t.handleShowModUnitInput,i.currentAttackModButton.onClick=t.handleShowModAttackInput),zP.on(Qt.COINS_CHANGED,this.updateWhenReceivedCoin)}updateWhenReceivedCoin=()=>{let{tutorialManager:e,layoutManager:t}=this.scene,i=_t.inst.getCoin();t.objects.coinBar.setCoins(i),e.isRunning()?e.reupdateGuideUI():this.updateUnitBarUI()};updateCoinBar(){let{layoutManager:e}=this.scene,{objects:t}=e,i=_t.inst.getCoin();t.coinBar.setCoins(i)}updateUnitBarUI(){let{unitManager:e,coinManager:t,layoutManager:i}=this.scene,s=_t.inst.getCoin(),{objects:n}=i,r=e.getPlayerMeleeSpawnedUnitsCount(),o=t.getUnitPrice(r);n.unitBar.setMeleePrice(o);let a=s.toString(),h=o.toString();n.unitBar.enableMeleeBlock();let l=o.biggerThan(s)&&a!==h;n.unitBar.setMeleeAdsMode(l);let c=e.getPlayerRangedSpawnedUnitsCount(),f=t.getUnitPrice(c);n.unitBar.setRangedPrice(f);let u=f.toString();n.unitBar.enableRangedBlock();let p=f.biggerThan(s)&&a!==u;n.unitBar.setRangedAdsMode(p),this.handleLastSquareCase()}handleLastSquareCase(){let{fieldManager:e,unitManager:t,layoutManager:i}=this.scene;if(e.getRemainingAvailablePlacement()!==1)return;let{objects:s}=i,n=t.getLowestLevelPlayerMeleeUnit(),r=t.getLowestLevelPlayerRangedUnit();n===dd&&r!==pd&&s.unitBar.disableMeleeBlock(),r===pd&&n!==dd&&s.unitBar.disableRangedBlock()}updateTotalHpBar(){let{layoutManager:e}=this.scene,{objects:t}=e;t.totalHpBar.setAlpha(1),t.totalHpBar.updateCurrentHp()}setTotalHpBar(e,t){let{objects:i}=this.scene.layoutManager;t?i.totalHpBar.updatePlayerHpUIByMinus(e):i.totalHpBar.updateEnemyHpUIByMinus(e)}startFight=()=>{let{objects:e}=this.scene.layoutManager,t=this.getAllPowerItems(),i=[...t,e.unitBar,e.levelBar,e.startButton,e.battleLevelBar],s=t.findIndex(r=>r instanceof cd);s!==-1&&i.splice(s,1);let n=this.hideUIAnimController.renew();gt.runTween(this.scene.tweens.add({...od,paused:!0,targets:i,duration:300,onActive:()=>{this.scene.input.enabled=!1},ease:YP.Circular.Out,onComplete:()=>{for(let r of i)r.setAlpha(1);for(let r of t)r instanceof cd||r.disableItem();this.scene.startRound(),this.scene.input.enabled=!0}}),n)};getCurrentEnemyHp(){let{objects:e}=this.scene.layoutManager;return e.totalHpBar.getCurrentEnemyHp()}getCurrentPlayerHp(){let{objects:e}=this.scene.layoutManager;return e.totalHpBar.getCurrentPlayerHp()}getAllPowerItems(){return this.scene.powerManager.getAllItems()}disableUnitBlocks(){let{objects:e}=this.scene.layoutManager;e.unitBar.disableUnitBlocks()}disableAdsUnitBlocks(){let{objects:e}=this.scene.layoutManager;e.unitBar.disableAdsForBlocks()}enableStartButton(){let{objects:e}=this.scene.layoutManager;e.startButton.setDisabled(!1)}isStartButtonDisabled(){let{objects:e}=this.scene.layoutManager;return e.startButton.isDisabled}runUnitBtnAnim(){let{objects:e}=this.scene.layoutManager}showUIForLevelLoadingState(){let{groups:e}=this.scene.layoutManager;e.allUI.killGroup(),e.levelLoadingStateUI.reviveGroup()}showUIForReadyState(){let{gameMode:e}=this.scene,{levelManager:t,layoutManager:i}=this.scene,{groups:s,objects:n}=i;if(s.allUI.killGroup(),e===Tt.NORMAL||e===Tt.BOSS){let r=t.getCurrentLevelId();n.levelBar.setLevel(r),s.normalPlayingStateUI.killGroup(),e===Tt.BOSS?s.bossReadyStateUI.reviveGroup():s.normalReadyStateUI.reviveGroup()}this.updateUIData()}showUIForPlayingState(){let{gameMode:e,layoutManager:t}=this.scene,{groups:i}=t;(e===Tt.NORMAL||e===Tt.BOSS)&&(e===Tt.BOSS?i.bossReadyStateUI.killGroup():i.normalReadyStateUI.killGroup(),i.normalPlayingStateUI.reviveGroup()),e===Tt.BATTLE&&(i.battleReadyStateUI.killGroup(),i.battlePlayingStateUI.reviveGroup()),this.updateUIData()}showUIForGuide1(){let{layoutManager:e}=this.scene,{groups:t,objects:i}=e;t.allUI.killGroup(),t.guideStateUI.reviveGroup(),i.unitBar.kill()}showUIForGuide2(e){let{layoutManager:t}=this.scene,{groups:i,objects:s}=t;s.unitBar.killBg(),e===1?(i.allUI.killGroup(),i.guideStateUI.reviveGroup(),s.startButton.kill(),this.updateCoinBar(),this.updateUnitBarUI(),s.unitBar.killMeleeBlock(),s.unitBar.setDepth(rt.TUTORIAL_OBJECT)):e===2?(s.unitBar.reviveMeleeBlock(),s.unitBar.kill(),s.unitBar.setDepth(rt.BUTTON)):e===3&&(i.allUI.killGroup(),i.guideStateUI.reviveGroup(),s.unitBar.kill(),s.startButton.revive())}showUIForGuidePrevent(){let{layoutManager:e}=this.scene,{groups:t,objects:i}=e;t.allUI.killGroup(),t.guideStateUI.reviveGroup(),i.unitBar.kill()}showUIForGuide3(e){let{layoutManager:t}=this.scene,{groups:i,objects:s}=t;if(s.unitBar.killBg(),e===1){let{accessibilityManager:n}=this.scene;n.stop(),i.allUI.killGroup(),i.guideStateUI.reviveGroup(),s.startButton.kill(),this.updateCoinBar(),this.updateUnitBarUI(),s.unitBar.killRangedBlock(),s.unitBar.setDepth(rt.TUTORIAL_OBJECT)}else if(e===2){let{accessibilityManager:n}=this.scene;n.stop(),i.allUI.killGroup(),i.guideStateUI.reviveGroup(),s.startButton.kill(),s.unitBar.reviveRangedBlock(),s.unitBar.kill(),s.unitBar.setDepth(rt.BUTTON)}else e===3&&(i.allUI.killGroup(),i.guideStateUI.reviveGroup(),s.unitBar.kill(),s.startButton.revive())}addOnceCallbackForMeleeBlock(e){let{objects:t}=this.scene.layoutManager;t.unitBar.addOnceClickEventForMeleeBlock(e)}addOnceCallbackForRangedBlock(e){let{objects:t}=this.scene.layoutManager;t.unitBar.addOnceClickEventForRangedBlock(e)}addOnceCallbackForStartBtn(e){let{objects:t}=this.scene.layoutManager;t.startButton.onClick=e}getMeleeBlockWorldPosition(){let e=this.getMeleeBlockConfig();return{x:e.worldX,y:e.worldY}}getRangedBlockWorldPosition(){let e=this.getRangedBlockConfig();return{x:e.worldX,y:e.worldY}}getMeleeBlockConfig(){let{objects:e}=this.scene.layoutManager;return e.unitBar.getMeleeBlockConfig()}getRangedBlockConfig(){let{objects:e}=this.scene.layoutManager;return e.unitBar.getRangedBlockConfig()}getStartBtnWorldPosition(){let{objects:e}=this.scene.layoutManager;return e.startButton.getWorldPosition()}},XP=VP,KP=class extends Error{constructor(){super("NoUnitFound"),this.name="NoUnitFound"}},se=KP,{Utils:{Browser:jP}}=Ludex,{player:ZP}=codex,qP=class uf{static _instance;static vibrationProfiles={default:[100]};static get inst(){return this._instance||(this._instance=new uf),this._instance}static addVibrationProfile(t,i){this.vibrationProfiles[t]=i}static vibrate(t){this.isVibrateEnable()&&this.handleVibrate(t)}static vibrateUsingProfile(t){if(!this.isVibrateEnable())return;let i=this.vibrationProfiles[t];i||(i=this.vibrationProfiles.default),this.handleVibrate(i)}static handleVibrate(t){if(!jP.vibrate(t)&&"performHapticFeedbackAsync"in GameSDK.extra){this.useFBInstantHapticFeedback(t);return}}static async useFBInstantHapticFeedback(t){if(!("performHapticFeedbackAsync"in GameSDK.extra))return;let{Time:i}=Ludex.Utils,s=async()=>{try{"performHapticFeedbackAsync"in GameSDK.extra&&await GameSDK.extra.performHapticFeedbackAsync()}catch{}};if(Array.isArray(t)){for(let n=0;n<t.length;n++){let r=t[n];n%2===0&&await s(),await i.sleepAsync(r)}return}await s()}static isVibrateEnable(){return this.isSupportVibrateApi()?!!ZP.getPlayerSetting("vibrate"):!1}static isSupportVibrateApi(){let t="vibrate"in window.navigator;if(t)try{window.navigator.vibrate(0)}catch{return!1}return t}},si=qP,QP={PREPARE:"prepare",READY:"ready",MOVING_TO_TARGET:"movingToTarget",PREPARE_TO_ATTACK:"prepareToAttack",ATTACKING:"attacking",FINISHED_ATTACKING:"finishedAttacking",KILLED:"killed"},Ft=QP,ts=U(yt()),JP=class{unit;attackSpots;attackTarget;beingAttackedByMelee;beingAttackedByRanged;attackSpotPairings;constructor(e){this.unit=e,this.attackSpots=[],this.attackSpotPairings=[]}reset(){this.resetAttackSpots(),this.resetAttackTarget(),this.beingAttackedByMelee=null,this.beingAttackedByRanged=null}createAttackSpots(){let{x:e,y:t}=this.unit,{MELEE_ATTACK_RANGE:i}=Q;for(let s=0;s<=8;s++)if(s===0){let n=new ts.Vector2(e+i,t),r=new ts.Vector2(e-i,t);this.attackSpots.push({location:n,occupiedUnit:null}),this.attackSpots.push({location:r,occupiedUnit:null});let o=this.attackSpots.length-1;this.attackSpotPairings.push({a:o-1,b:o})}else{let n=(0,ts.DegToRad)(s*20/4),r=new ts.Vector2(e+i*Math.cos(n),t+i*Math.sin(n)),o=new ts.Vector2(e-i*Math.cos(n),t+i*Math.sin(n)),a=new ts.Vector2(e+i*Math.cos(n),t-i*Math.sin(n)),h=new ts.Vector2(e-i*Math.cos(n),t-i*Math.sin(n));this.attackSpots.push({location:r,occupiedUnit:null}),this.attackSpots.push({location:o,occupiedUnit:null}),this.attackSpots.push({location:a,occupiedUnit:null}),this.attackSpots.push({location:h,occupiedUnit:null});let l=this.attackSpots.length-1;this.attackSpotPairings.push({a:l-3,b:l}),this.attackSpotPairings.push({a:l-2,b:l-1})}}assignAttackingUnit(e){if(this.attackTarget===e){let o=-1;for(let[a,h]of e.attackController.attackSpots.entries())if(h.occupiedUnit===this.unit&&o===-1){o=a;break}if(o!==-1){let a=this.attackSpotPairings.find(h=>h.a===o||h.b===o);if(a){let h=a.a===o?a.b:a.a;return this.attackSpots[h]}}}let t,i=this.attackSpots.filter(o=>{let a=o.occupiedUnit===null||o.occupiedUnit===e,h=!0;o.occupiedUnit===e&&(t=o);let{gameZone:l}=this.unit.scene;return this.unit.x<l.displayWidth/5&&(h=o.location.x>this.unit.x),this.unit.x>l.displayWidth-l.displayWidth/5&&(h=o.location.x<this.unit.x),a&&h});if(i.length===0)return null;let{x:s,y:n}=e,r=i.reduce((o,a)=>{let{x:h,y:l}=a.location,{x:c,y:f}=o.location,u=Math.sqrt((h-s)**2+(l-n)**2),p=Math.sqrt((c-s)**2+(f-n)**2);return u<p?a:o},i[0]);return t&&t!==r&&(t.occupiedUnit=null),r.occupiedUnit=e,r}clearAttackingUnit(e){for(let t of this.attackSpots)t.occupiedUnit===e&&(t.occupiedUnit=null)}moveAttackSpotMelee(e,t){for(let i of this.attackSpots){let{x:s,y:n}=i.location;i.location.set(s+e,n+t)}}checkForInvalidOccupiedUnits(){for(let e of this.attackSpots)e.occupiedUnit?.isKilled()&&(e.occupiedUnit=null)}resetAttackSpots(){this.attackSpots=[],this.createAttackSpots()}resetAttackSpotOfUnit(e){for(let t of this.attackSpots)t.occupiedUnit===e&&(t.occupiedUnit=null)}getAttackTarget(){return this.attackTarget}setAttackTarget(e){this.attackTarget=e}notifyTargetAttacked(e){e.unitType===Q.MELEE_UNIT_TYPE?this.beingAttackedByMelee=e:e.unitType===Q.RANGED_UNIT_TYPE&&(this.beingAttackedByRanged=e)}resetAttackTarget(){this.attackTarget=null}},$P=JP,{MANAGER_BASE_DEPTH:gd}=rt,tL=class{unit;scene;constructor(e){this.unit=e,this.scene=e.scene}calculateDepth(){let{y:e,currentLocation:t=null}=this.unit,{height:i}=this.scene.fieldManager.firstHightLineZone,s=e+i/4,n=0;t&&this.unit.isInPrepareMode()&&(n=t.colId);let{fieldBackground:r}=this.scene.fieldManager,o=r.getTopLeft().y,a=r.displayHeight/100,h=-n;return gd+(Math.floor((s-o)/a)+h)*.4}setDepthOnDeath(){this.unit.isDepthDirty=!1;let e=this.calculateDepth()-.2;this.unit.setDepth(e)}getProjectileDepth(){return gd+41}},eL=tL,iL=class{unit;scene;constructor(e){this.unit=e,this.scene=e.scene}getAttackTarget(){let{unitType:e}=this.unit;switch(e){case Q.MELEE_UNIT_TYPE:return this.getAttackTargetForMeleeUnit();case Q.RANGED_UNIT_TYPE:return this.getAttackTargetForRangedUnit();default:return null}}getAttackTargetForMeleeUnit(){let{x:e,y:t,isPlayer:i}=this.unit;if(this.unit.isKilled())return null;let{enemyUnits:s,playerUnits:n}=this.scene.unitManager,r=(i?s:n).getChildren().filter(u=>u instanceof at?!u.isKilled():!1);switch(r.length){case 0:return null;case 1:return r[0];default:break}let o=1e4,a=r.sort((u,p)=>{let{x:d,y:g}=u,{x:m,y:E}=p,v=Math.sqrt(Math.pow(d-e,2)+Math.pow(g-t,2)),y=Math.sqrt(Math.pow(m-e,2)+Math.pow(E-t,2));return o=Math.min(o,v),o=Math.min(o,y),v-y}),h=[a[0]];for(let u=1;u<a.length;u++){let p=a[u],{x:d,y:g}=p;if(Math.sqrt(Math.pow(d-e,2)+Math.pow(g-t,2))!==o)break;h.push(p)}switch(h.length){case 1:return h[0];default:break}let l=h[0].currentHp,c=h.sort((u,p)=>(l=Math.min(l,u.currentHp),l=Math.min(l,p.currentHp),u.currentHp-p.currentHp)),f=[c[0]];for(let u=1;u<c.length;u++){let p=c[u];if(p.currentHp!==l)break;f.push(p)}switch(f.length){case 1:return f[0];default:break}return f.sort((u,p)=>p.attackPower-u.attackPower)[0]}getAttackTargetForRangedUnit(){let{x:e,y:t,isPlayer:i}=this.unit;if(this.unit.isKilled())return null;let{enemyUnits:s,playerUnits:n}=this.scene.unitManager,r=(i?s:n).getChildren().filter(u=>u instanceof at?!u.isKilled():!1);switch(r.length){case 0:return null;case 1:return r[0];default:break}let o=1e4,a=r.sort((u,p)=>{let{x:d,y:g}=u,{x:m,y:E}=p,v=Math.sqrt(Math.pow(d-e,2)+Math.pow(g-t,2)),y=Math.sqrt(Math.pow(m-e,2)+Math.pow(E-t,2));return o=Math.min(o,v),o=Math.min(o,y),v-y}),h=[a[0]];for(let u=1;u<a.length;u++){let p=a[u],{x:d,y:g}=p;if(Math.sqrt(Math.pow(d-e,2)+Math.pow(g-t,2))!==o)break;h.push(p)}switch(h.length){case 1:return h[0];default:break}let l=h[0].currentHp,c=h.sort((u,p)=>(l=Math.min(l,u.currentHp),l=Math.min(l,p.currentHp),u.currentHp-p.currentHp)),f=[c[0]];for(let u=1;u<c.length;u++){let p=c[u];if(p.currentHp!==l)break;f.push(p)}switch(f.length){case 1:return f[0];default:break}return f.sort((u,p)=>u.attackPower-p.attackPower)[0]}},bo=iL,sL=U($u()),nL=class{unit;scene;tween;constructor(e){this.unit=e,this.scene=e.scene}createTween(){this.tween?.remove(),this.tween=this.scene.tweens.addCounter({from:0,to:100,duration:200,onStart:()=>{this.unit.display.clearTint()},onUpdate:e=>{let t=e.getValue(),i=Math.floor(255/100*t),s=Math.floor(255/100*t),n=(0,sL.GetColor)(255,s,i);this.unit.display.setTint(n)},onComplete:()=>{this.unit.display.clearTint()}})}run(){this.createTween()}stop(){this.tween?.remove(),this.unit.display.clearTint()}},rL=nL,aL=U(Ka()),oL=(0,aL.default)(0,1.9,.42,1.9),hL=oL,lL=U(yt()),Po=U(ft()),uL=class{unit;scene;currentTotalNumber;constructor(e){this.unit=e,this.scene=e.scene,this.currentTotalNumber=new Dt(0)}increaseNumberStack(e){this.currentTotalNumber.baseValue===0&&this.scene.time.delayedCall(150,this.handleShowEffect),this.currentTotalNumber.add(e)}handleShowEffect=()=>{this.createFloatingText(this.currentTotalNumber),this.currentTotalNumber=new Dt(0)};createFloatingText(e){let t=this.getText(e),{effectManger:i}=this.scene,s=i.getTextEffectObject();s.revive(),s.setText(t),s.setFontSize(14),s.setPosition(this.unit.x,this.unit.y),this.scene.add.tween({targets:s,props:{alpha:{from:0,duration:100,ease:Po.Expo.Out,to:1}},onComplete:()=>{let{displayHeight:n}=this.unit.display;s.setTint(16753920);let r=this.unit.display.isSpine()?this.unit.y-n/2:this.unit.y,o=lL.RND.between(-1,1)<0?this.unit.x-50:this.unit.x+50;this.scene.add.tween({targets:s,props:{alpha:{from:1,duration:300,ease:Po.Expo.Out,to:0,delay:700},x:{from:this.unit.x,duration:1e3,ease:Po.Linear,to:o},y:{from:r,duration:1e3,ease:hL,to:r-15}},onComplete:()=>{s.setAlpha(1),s.kill()}})}})}getText(e){return`${e.toString()}`}},cL=uL,dL=class extends cL{handleShowEffect=()=>{this.createFloatingText(this.currentTotalNumber),_t.inst.addCoin(this.currentTotalNumber);let e=_t.inst.getCoin(),{objects:t}=this.scene.layoutManager;t.coinBar.setCoins(e),this.currentTotalNumber=new Dt(0)};getText(e){return`$${e.toString()}`}},pL=dL,gL=U(ft()),fL=class{unit;scene;tween;constructor(e){this.unit=e,this.scene=e.scene}createTween(){if(this.tween?.remove(),!this.unit.isKilled())return;let e=this.unit.getCurrentDisplay();e&&(this.tween=this.scene.tweens.add({targets:[e],delay:200,duration:300,ease:gL.Quintic.InOut,props:{alpha:{start:1,from:1,to:0}},onStart:()=>{this.unit.active||this.stop()},onComplete:()=>{this.unit.kill()}}))}play(){this.createTween()}stop(){this.tween?.remove();let e=this.unit.getCurrentDisplay();this.scene.tweens.killTweensOf(e),e.setAlpha(0)}},mL=fL,vL=class{unit;coinsEffect;damagedEffect;dieEffect;constructor(e){this.unit=e,this.createCoinsEffect(),this.createDamagedEffect(),this.createDieEffect()}createCoinsEffect(){this.coinsEffect=new pL(this.unit)}createDamagedEffect(){this.damagedEffect=new rL(this.unit)}createDieEffect(){this.dieEffect=new mL(this.unit)}runDamagedEffect(){this.damagedEffect.run()}stopDamageEffect(){this.damagedEffect.stop()}runDieEffect(){this.dieEffect.play()}stopDieEffect(){this.dieEffect.stop()}increaseCoinEffectStack(e){this.coinsEffect.increaseNumberStack(e)}},EL=vL,yL=U(it()),{KEY:fd,FRAME:md}=W.GAMEPLAY,TL=class extends yL.Container{bg;frame;defaultHp;currentHp;color;hpLength;hpHeight;constructor(e,t){super(e),this.defaultHp=100,this.currentHp=100,this.hpLength=30,this.hpHeight=4,this.color=t,this.createHealthBar(),this.scene.add.existing(this)}createHealthBar(){let e=this.scene.make.image({key:fd,frame:md.HP_BAR_BG,origin:{x:0,y:.5}}),t=.5,i=this.hpLength+t*2,s=this.hpHeight+t*2;e.setWorldSize(i,s),e.setX(-i/2),this.add(e),this.bg=e;let n=this.scene.make.image({key:fd,frame:md.HP_BAR_BG,origin:{x:0,y:.5}});n.setWorldSize(this.hpLength,this.hpHeight),n.setX(-this.hpLength/2),this.add(n),this.frame=n}setInitHp(e){this.defaultHp=e,this.currentHp=e,this.updateFrameUI()}getCurrentHp(){return this.currentHp}updateCurrentHpUI(e){let t=Math.max(e,0);this.currentHp=t,this.updateFrameUI()}updateHpUIByMinus(e){this.currentHp-=e,this.currentHp<0&&(this.currentHp=0),this.updateFrameUI()}updateFrameUI(){this.frame.setWorldSize(this.currentHp/this.defaultHp*this.hpLength,this.hpHeight),this.frame.setTintFill(this.color)}changeHpColor(e){let t=e?39423:15466524;this.frame.setTintFill(t),this.color=t}},vd=TL,SL=class{unit;hpBar;spineOffset;constructor(e){this.unit=e,this.createHpBar()}createHpBar(){let{scene:e,isPlayer:t}=this.unit,i=t?39423:15466524;this.hpBar=new vd(e,i),this.updatePositionHpBar(),this.hpBar.setDepth(rt.UNIT_HP_BAR)}destroyHpBar(){this.hpBar.destroy()}updatePositionHpBar(){this.spineOffset||(this.spineOffset=this.unit.display.displayHeight-20);let{x:e,y:t}=this.unit.getWorldPosition();this.hpBar.setPosition(e,t-this.spineOffset)}setInitHp(e){this.hpBar.setInitHp(e)}updateCurrentHpUI(e){this.hpBar.updateCurrentHpUI(e)}reviveHpBar(){this.hpBar.revive()}killHpBar(){this.hpBar.kill()}changeHpColor(e){this.hpBar.changeHpColor(e)}update(){this.updatePositionHpBar()}},AL=SL,xL=U(it()),Ns=U(mi()),{UNIT_SIZE_SCALE:_r}=Q,{modifier:wL}=Ut.Powers.SpeedUp,RL={end:()=>{},start:()=>{},event:(e,t)=>{},dispose:()=>{},complete:()=>{},interrupt:()=>{}},CL=class extends xL.Container{scene;unit;config;spine;spineScale;isUseSpine;sprite;spriteEvent;isFlipX;constructor(e,t){super(e.scene),this.unit=e,this.scene=e.scene,this.config=t,this.isUseSpine=t.useSpine,this.isFlipX=!1,this.initDisplay(),this.scaleDisplay(),this.y+=20}initDisplay(){let{spine:e,sprite:t,useSpine:i}=this.config;i?(this.createSpine(e.key,e.spineConfig),this.spine.setVisible(!0),this.spine.setActive(!0)):t&&(this.createSprite(t.key,t.frame,t.displayWidth,t.displayHeight),this.sprite.revive())}scaleDisplay(){if(this.spine){let{displayWidth:e,displayHeight:t}=this.spine;this.setSize(e,t)}else if(this.sprite){let{displayWidth:e,displayHeight:t}=this.sprite;this.setSize(e,t)}}createSprite(e,t,i,s){this.sprite=this.scene.add.sprite(0,0,e,t),this.sprite.setOrigin(.5,1),this.sprite.setDisplaySize(i*_r,s*_r),this.add(this.sprite),this.sprite.kill()}createSpine(e,t,i=!1){if(this.spine=this.scene.add.spine(0,0,e,t.animation,t.loop),this.setSpineScale(.5*_r,.5*_r),this.spine.setName(e),this.add(this.spine),i){let{spineManager:s}=this.scene;s.addSpines([this.unit])}this.spine.setVisible(!1),this.spine.setActive(!1)}setSpineScale(e,t){this.spine&&(this.spine.scaleX===e&&this.spine.scaleY===t||(this.spineScale=t,this.spine.setScale(e,t)))}getSpineScale(){return this.spineScale}isSpine(){return this.isUseSpine}getCurrentDisplay(){return this.isUseSpine?this.spine:this.sprite}getSpineDisplay(){return this.spine}getSpriteDisplay(){return this.sprite}play(e,t,i=!1,s=!0,n=!0){if(this.setUseSpine(n),this.isUseSpine)this.spine.play(t,i,s);else{let r=this.sprite.visible;this.sprite.play({key:e,repeat:i?-1:0},s),this.sprite.setVisible(r)}}setUseSpine(e){if(this.isUseSpine!==e){if(this.isUseSpine=e,e){if(!this.spine){let{key:t,spineConfig:i}=this.config.spine;this.createSpine(t,i,!0)}}else if(!this.sprite&&this.config.sprite){let{key:t,frame:i,displayWidth:s,displayHeight:n}=this.config.sprite;this.createSprite(t,i,s,n)}e?(this.sprite.removeAllListeners(),this.spriteEvent?.remove()):this.spine.state.clearListeners(),this.setFlipX(this.isFlipX),e?(this.spine.setVisible(!0),this.spine.setActive(!0),this.sprite.kill()):(this.spine.setVisible(!1),this.spine.setActive(!1),this.sprite.revive())}}setAnimationTimeScale(e){let t=this.unit.scene.powerManager.isGameSpeedUp()?wL:1;this.isUseSpine?this.spine.timeScale=e*t:this.sprite.anims.timeScale=e*t}getAnimationTimeScale(){return this.isUseSpine?this.spine.timeScale:this.sprite.anims.timeScale}setFlipX(e){if(this.isUseSpine){if(e&&this.spine.scaleX<0||!e&&this.spine.scaleX>0)return;this.setSpineScale(e?-this.spineScale:this.spineScale,this.spineScale)}else this.sprite.setFlipX(e);this.isFlipX=e}isFaceLeft(){return this.isUseSpine?this.spine.scaleX<0:this.sprite.flipX}setTint(e){try{this.isUseSpine?this.spine.setColor(e):this.sprite.setTint(e)}catch{}}clearTint(){try{this.spine&&this.spine.setColor(),this.sprite&&this.sprite.clearTint()}catch{}}getSpineAnimationAttackingTime(){if(!this.spine)return 0;let e=null,{unitType:t,isPlayer:i}=this.unit,{MELEE:s,RANGED:n}=mt;switch(t){case Q.MELEE_UNIT_TYPE:e=this.spine.findAnimation(s.ATTACK);break;case Q.RANGED_UNIT_TYPE:e=this.spine.findAnimation(i?n.ATTACK_BELOW:n.ATTACK_ABOVE),e||(e=this.spine.findAnimation(n.ATTACK));break;default:return 0}return e.duration*1e3}addAnimEventListener(e,t,i=!0){if(this.isUseSpine){i&&this.spine.state.clearListeners();let s=this.getEventNameForSpine(e);this.addSpineEventListener(s,t)}else{let s=this.getEventNameForSprite(e);if(typeof s=="string")i&&this.sprite.off(s),this.sprite.on(s,t);else{if(!i)return;let{timeScale:n,msPerFrame:r}=this.sprite.anims;this.spriteEvent?.remove();let o=s*r/n;this.spriteEvent=this.scene.time.delayedCall(o,t)}}}changeCurrentSpriteEventTime(){return this.isUseSpine||!this.spriteEvent?!1:(this.spriteEvent.timeScale=3,!0)}getEventNameForSprite(e){let{START:t,DISPOSE:i,INTERRUPT:s}=ei,{unitType:n,level:r}=this.unit;switch(e){case i:case s:return Ns.ANIMATION_STOP;case t:return Ns.ANIMATION_START;case mt[n.toUpperCase()].CUSTOM_EVENTS.FINISHED_ATTACKING:{let o=Kt[n.toUpperCase()][r].ATTACK.EVENT_FRAME;return o||(o=0),o}default:return Ns.ANIMATION_COMPLETE}}getEventNameForSpine(e){switch(e){case Ns.ANIMATION_START:return ei.START;case Ns.ANIMATION_STOP:return ei.DISPOSE;case Ns.ANIMATION_COMPLETE:return ei.COMPLETE;default:return e}}addSpineEventListener(e,t){let i={...RL};switch(e){case ei.END:i.end=()=>{t()};break;case ei.START:i.start=()=>{t()};break;case ei.EVENT:i.event=()=>{t()};break;case ei.DISPOSE:i.dispose=()=>{t()};break;case ei.COMPLETE:i.complete=()=>{this.spine.state.removeListener(i),t()};break;case ei.INTERRUPT:i.interrupt=()=>{t()};break;default:i.event=(s,n)=>{n.data.name===e&&t()};break}this.spine.state.addListener(i)}runFadeInAnimation(){let e=this.isUseSpine?this.spine:this.sprite;this.scene.add.tween({targets:e,duration:200,props:{alpha:{getStart:()=>0,getEnd:()=>1}}})}},_L=CL,bL=class extends bo{getFirstPriorityRatio(e,t){return t===0?0:e/t}getSecondPriorityRatio(e,t){return t===0?0:e/t}getAttackTargetForMeleeUnit(){let{x:e,y:t,isPlayer:i,attackPower:s,currentHp:n}=this.unit;if(this.unit.isKilled())return null;let{enemyUnits:r,playerUnits:o}=this.scene.unitManager,a=(i?r:o).getChildren().filter(d=>d instanceof at?!d.isKilled():!1);switch(a.length){case 0:return null;case 1:return a[0];default:break}let h=1e4,l=a.sort((d,g)=>{let{x:m,y:E}=d,{x:v,y}=g,T=Math.sqrt((m-e)**2+(E-t)**2),A=Math.sqrt((v-e)**2+(y-t)**2);return h=Math.min(h,T),h=Math.min(h,A),T-A}),c=[l[0]];for(let d=1;d<l.length;d++){let g=l[d],{x:m,y:E}=g;if(Math.sqrt(Math.pow(m-e,2)+Math.pow(E-t,2))!==h)break;c.push(g)}switch(c.length){case 1:return c[0];default:break}let f=this.getFirstPriorityRatio(s,c[0].currentHp),u=c.sort((d,g)=>{let m=this.getFirstPriorityRatio(s,d.currentHp),E=this.getFirstPriorityRatio(s,g.currentHp);return f=Math.max(f,m),f=Math.max(f,E),E-m}),p=[u[0]];for(let d=1;d<u.length;d++){let g=u[d];if(this.getFirstPriorityRatio(s,g.currentHp)!==f)break;p.push(g)}switch(p.length){case 1:return p[0];default:break}return p.sort((d,g)=>{let m=this.getSecondPriorityRatio(d.attackPower,n);return this.getSecondPriorityRatio(g.attackPower,n)-m})[0]}getAttackTargetForRangedUnit(){let{isPlayer:e}=this.unit;if(this.unit.isKilled())return null;let{enemyUnits:t,playerUnits:i}=this.scene.unitManager,s=(e?t:i).getChildren().filter(n=>n instanceof at?!n.isKilled():!1);switch(s.length){case 0:return null;case 1:return s[0];default:break}switch(s.sort((n,r)=>{let o=n.attackPower,a=Math.sqrt((n.x-this.unit.x)**2+(n.y-this.unit.y)**2),h=r.attackPower,l=Math.sqrt((r.x-this.unit.x)**2+(r.y-this.unit.y)**2);return h/l-o/a}).length){case 0:return null;default:return s[0]}}},PL=bL,Lo=U(yt()),Us=U(Zt()),LL=U(it()),IL=U(Cs()),{DEPTH_ON_DRAG:ML}=rt,OL=class extends LL.Container{isDebug=!1;scene;display;dragZone;attackEvent;status;unitName;level;actions;hp;attackPower;attackInterval;unitType;uiController;depthController;attackController;targetController;effectController;currentLocation;isPlayer;lastDragPosition;lastWorldPosition;originalUnitData;isDepthDirty;isPositionDirty;constructor(e,t,i,s,n,r){super(e,t,i),this.scene=e,this.createDragZone(),this.createDisplay(r),this.hp=0,this.level=0,this.attackPower=0,this.isDepthDirty=!1,this.isPositionDirty=!0,this.unitType="base",this.isPlayer=s,this.uiController=new AL(this),this.depthController=new eL(this),this.attackController=new $P(this),this.targetController=new bo(this),this.effectController=new EL(this),this.setUnitData(n),this.isPlayer&&this.addEventListener(),this.createActions(),this.actions.prepare(),this.scene.add.existing(this)}createDisplay(e){this.display=new _L(this,e),this.add(this.display)}createDragZone(){let{fieldManager:e}=this.scene;if(!e)return;let{x:t,y:i}=this.getDragZoneSize();this.dragZone=this.scene.add.zone(0,0,t,i),this.add(this.dragZone)}getDragZoneSize(){let{fieldManager:e}=this.scene;if(!e)return new Lo.Vector2(0,0);let{width:t,height:i}=e.getPlayerPlacementSquare(1,1).areaRect,s=t*.95/this.scale,n=i*.95/this.scale;return new Lo.Vector2(s,n)}addEventListener(){this.dragZone.setInteractive({draggable:!0,useHandCursor:!0}),this.dragZone.on(Us.GAMEOBJECT_DRAG_START,this.onDragStart),this.dragZone.on(Us.GAMEOBJECT_DRAG_END,this.onDragEnd),this.dragZone.on(Us.GAMEOBJECT_DRAG,this.onDrag)}addOnceEvent(e,t){this.dragZone.once(e,t)}removeOnceEvent(e,t){this.dragZone.off(e,t)}updatePositionHpBar(){this.uiController.updatePositionHpBar()}removeEventListener(){this.dragZone.off(Us.GAMEOBJECT_DRAG_START,this.onDragStart),this.dragZone.off(Us.GAMEOBJECT_DRAG_END,this.onDragEnd),this.dragZone.off(Us.GAMEOBJECT_DRAG,this.onDrag),this.dragZone.disableInteractive()}startEventListener(){this.removeEventListener(),this.addEventListener()}setDefaultHp(e){let{playerIsCheater:t,opponentIsCheater:i}=window.clientInformation||{},s=e;this.level>1&&(t&&this.isPlayer&&(s/=2),i&&!this.isPlayer&&(s/=2)),this.hp=s,this.uiController.setInitHp(s)}get currentHp(){return this.hp}canbeAttacked(){if(this.isFinishedAttacking())throw new Error("Unit is finished attacking");if(this.isKilled())throw new Error("Unit is killed");let e=this.attackController.getAttackTarget();if(!e||e?.isKilled())throw new Error("No attack target")}attack=()=>{try{if(this.canbeAttacked(),!this.isPreparingToAttack()&&!this.isAttacking())return;this.actions.attack();let e=this.attackController.getAttackTarget();if(!e)throw new Error("No attack target");if(e.isKilled())throw new Error("Attack target is killed");let t=this.scene.powerManager.isGameSpeedUp()?.5:1;this.attackEvent=this.scene.time.delayedCall(this.attackInterval*t,this.attack)}catch{this.attackEvent?.destroy(),this.actions.ready()}};modifyCurrentAttackEvent(){if(!this.attackEvent||this.attackEvent.getProgress()===1||this.isKilled())return;let e=this.attackEvent.getRemaining();if(e===0)return;let t=this.scene.powerManager.isGameSpeedUp()?.5:2;this.attackEvent.reset({delay:e*t,callback:this.attack})}takeDamage(e){if(this.hp<=0)return;let{coinManager:t,uiManager:i}=this.scene;if(!this.isPlayer){let r=t.getAttackCoinByUnit(e,this);t.addCoinsByAttack(r),this.effectController.increaseCoinEffectStack(r)}let s=this.hp,n=this.getCorrectAttackPower(e);if(this.hp-=n,this.hp<0&&(this.hp=0),this.uiController.updateCurrentHpUI(this.hp),i.setTotalHpBar(s-this.hp,this.isPlayer),ut.playSound(Et.UNIT_DAMAGED,{volume:.2+Math.random()*.8}),si.vibrate(50),this.hp<=0){this.actions.die();return}this.effectController.runDamagedEffect()}getCorrectAttackPower(e){let{playerIsCheater:t,opponentIsCheater:i}=window.clientInformation||{},{attackPower:s}=e;return t&&this.level>1&&(this.isPlayer?s*=1*e.level:s/=2*this.level),i&&(this.isPlayer?s/=10*this.level:s*=20*e.level),s}onDragStart=()=>{let{firstHightLineZone:e}=this.scene.fieldManager;e.revive(),e.setPosition(this.x,this.y),this.lastDragPosition=new Lo.Vector2(this.x,this.y),this.setDepthOnDrag();let{spineManager:t}=this.scene;t.bringToTopOnDrag(this),ut.playSound(Et.UNIT_DRAG_START)};onDragEnd=()=>{let{unitManager:e,fieldManager:t}=this.scene,{firstHightLineZone:i,secondHightLineZone:s}=t;i.kill(),s.kill(),this.isDepthDirty=!0;let n=t.getSquareBasedOnPosition(this.lastDragPosition.x,this.lastDragPosition.y);if(!n||n===this.currentLocation){this.assignUnitToSquare(this.currentLocation.rowId,this.currentLocation.colId,this.isPlayer),e.resetAttackSpots(this),ut.playSound(Et.UNIT_DRAG_END);return}let r=e.getUnitBasedOnPosition(n.rowId,n.colId);if(!r){this.assignUnitToSquare(n.rowId,n.colId,this.isPlayer),e.resetAttackSpots(this),ut.playSound(Et.UNIT_DRAG_END);return}let o=r.unitType===this.unitType,a=r.level===this.level;if(!o||!a){this.swapUnitPosition(r),this.isDepthDirty=!0,r.isDepthDirty=!0,ut.playSound(Et.UNIT_DRAG_END);return}this.scene.renderer.once(IL.default.Events.PRE_RENDER,()=>{this.tryMergeUnit(r)})};tryMergeUnit(e){let{unitManager:t}=this.scene;t.mergeUnits(this,e)?this.currentLocation&&this.currentLocation.setTaken(!1):(this.assignUnitToSquare(this.currentLocation.rowId,this.currentLocation.colId,this.isPlayer),ut.playSound(Et.UNIT_DRAG_END))}getLastDragPos(){return this.lastDragPosition}dragUnitOnto(e,t){let{unitManager:i,fieldManager:s}=this.scene;this.isDepthDirty=!0;let n=s.getSquareBasedOnIndex(e,t);if(!n||n===this.currentLocation){this.assignUnitToSquare(this.currentLocation.rowId,this.currentLocation.colId,this.isPlayer),i.resetAttackSpots(this);return}let r=i.getUnitBasedOnPosition(n.rowId,n.colId);if(!r){this.assignUnitToSquare(n.rowId,n.colId,this.isPlayer),i.resetAttackSpots(this);return}let o=r.unitType===this.unitType,a=r.level===this.level;if(!o||!a){this.swapUnitPosition(r),this.isDepthDirty=!0,r.isDepthDirty=!0;return}i.mergeUnits(this,r)?this.currentLocation&&this.currentLocation.setTaken(!1):this.assignUnitToSquare(this.currentLocation.rowId,this.currentLocation.colId,this.isPlayer)}onDrag=e=>{let{worldX:t,worldY:i,wasTouch:s}=e,{height:n}=this.scene.fieldManager.firstHightLineZone,r=s?n*.8:n/4,o=s?n*.55:0;this.setPosition(t,i-r),this.lastDragPosition.x=t,this.lastDragPosition.y=i-o;let{fieldManager:a}=this.scene,h=a.getSquareBasedOnPosition(this.lastDragPosition.x,this.lastDragPosition.y),{secondHightLineZone:l}=this.scene.fieldManager;if(!h||h===this.currentLocation){l.kill();return}l.revive(),l.setPosition(h.x,h.y),l.isStroked=!1;let c=this.scene.unitManager.getUnitBasedOnPosition(h.rowId,h.colId);c&&c.unitName===this.unitName&&(l.isStroked=!0)};findTarget(){if(this.isKilled())return;let e=this.targetController.getAttackTarget();e&&this.attackController.setAttackTarget(e)}setUnitData(e){let{health:t,attackSpeed:i,damage:s,name:n,level:r}=e;this.setDefaultHp(t),this.attackInterval=i,this.attackPower=s,this.unitName=n,this.level=r,this.originalUnitData=e}assignUnitToSquare(e,t,i){e===0&&t===0&&!this.isPlayer&&(this.isDebug=!0);let{fieldManager:s}=this.scene,n=i?s.getPlayerPlacementSquare(e,t):s.getEnemyPlacementSquare(e,t);this.currentLocation&&this.currentLocation.setTaken(!1),this.setPosition(n.x,n.y),n.setTaken(!0),this.currentLocation=n,this.attackController.resetAttackSpots()}spawnUnitOnSquare(e,t,i){let{fieldManager:s}=this.scene,n=i?s.getPlayerPlacementSquare(e,t):s.getEnemyPlacementSquare(e,t);this.setPosition(n.x,n.y),n.setTaken(!0),this.currentLocation=n,this.attackController.resetAttackSpots()}summonMinionOnSquare(e,t,i=!1){let{fieldManager:s}=this.scene,n=i?s.getPlayerPlacementSquare(e,t):s.getEnemyPlacementSquare(e,t);this.setPosition(n.x,n.y),this.currentLocation=n,this.attackController.resetAttackSpots()}swapUnitPosition(e){let t=e.currentLocation,i=this.currentLocation;e.setPosition(i.x,i.y),this.setPosition(t.x,t.y);let{unitManager:s}=this.scene;s.resetAttackSpots(this),s.resetAttackSpots(e),e.currentLocation=i,this.currentLocation=t}setDepthOnDrag(){this.setDepth(ML)}calcDepth(){if(this.isKilled())return;let e=this.depthController.calculateDepth();e&&this.depth!==e&&this.setDepth(e)}requestAttackPosition(e){return this.attackController.assignAttackingUnit(e)}getCurrentDisplay(){return this.display.getCurrentDisplay()}getSpineDisplay(){return this.display.getSpineDisplay()}reuseUnitOnReady(){this.setActive(!0),this.isDepthDirty=!0,this.assignUnitToSquare(this.currentLocation.rowId,this.currentLocation.colId,this.isPlayer),this.setDefaultHp(this.originalUnitData.health),this.uiController.updateCurrentHpUI(this.hp),this.actions.prepare(),this.setVisible(!0)}reuseUnitFromPool(e){this.setActive(!0),this.isDepthDirty=!0,this.isPlayer!==e&&(this.uiController.changeHpColor(e),this.isPlayer=e),this.uiController.reviveHpBar();let t=this.getSpineDisplay();e?this.startEventListener():this.removeEventListener(),this.setDefaultHp(this.originalUnitData.health),this.uiController.updateCurrentHpUI(this.hp),this.actions.prepare(),t&&t.setVisible(!0),this.setVisible(!0)}handleRemoveFromScene(){this.uiController.killHpBar(),this.attackController.resetAttackSpots(),this.effectController.stopDamageEffect(),this.effectController.stopDieEffect(),this.removeEventListener(),this.setStatus(Ft.KILLED),this.attackEvent?.remove(),this.currentLocation&&this.currentLocation.setTaken(!1);let e=this.getSpineDisplay();if(e){let{spineManager:t}=this.scene;t.removeSpine(this),e.setVisible(!1)}this.kill()}setStatus(e){this.status=e}getStatus(){return this.status}getWorldPosition(){return this.isPositionDirty=!1,this.lastWorldPosition=super.getWorldPosition(),this.lastWorldPosition}setPosition(e,t,i,s){return super.setPosition(e,t,i,s),this.isPositionDirty=!0,this}restoreUnitDisplay(){this.getCurrentDisplay().setAlpha(1)}isInPrepareMode(){return this.status===Ft.PREPARE}isReady(){return this.status===Ft.READY}isMovingToTarget(){return this.status===Ft.MOVING_TO_TARGET}isPreparingToAttack(){return this.status===Ft.PREPARE_TO_ATTACK}isAttacking(){return this.status===Ft.ATTACKING}isKilled(){return this.status===Ft.KILLED}isFinishedAttacking(){return this.status===Ft.FINISHED_ATTACKING}update(e,t){this.isDepthDirty&&(this.calcDepth(),this.isDepthDirty=!1),this.scene.stateManager.isInPlayingState()&&this.uiController.update()}setScale(e){super.setScale(e);let{x:t,y:i}=this.getDragZoneSize();return this.dragZone.setWorldSize(t,i),this}runFadeInAnimation(){this.display.runFadeInAnimation()}setTargetControllerToDefault(){this.targetController=new bo(this)}setTaretControllerToPostGame(){this.targetController=new PL(this)}},at=OL,{KEY:DL,FRAME:kL}=W.UNITS_SPRITES,{KEY:BL}=W.UNITS_SPINES.MELEE[1],NL=class extends at{constructor(e,t){super(e,0,0,t,{level:100,id:"alien",name:"Warlock",health:1,damage:1,attackSpeed:1},{spine:{key:BL,spineConfig:{animation:mt.MELEE.IDLE,loop:!0}},sprite:{key:DL,frame:kL.MELEE[1].MAIN_TEXTURE,displayWidth:86.5,displayHeight:68},useSpine:!0}),this.level=1,this.unitName="Alien Lv.100",this.attackPower=1,this.setDefaultHp(999999)}createActions(){throw new Error("Method not implemented.")}findTarget(){throw new Error("Method not implemented.")}},es=NL,UL=class{unit;dieCommand;moveCommand;readyCommand;attackCommand;prepareCommand;constructor(e){this.unit=e,this.addDieCommand(),this.addMoveCommand(),this.addReadyCommand(),this.addAttackCommand(),this.addPrepareCommand()}prepare(){this.prepareCommand.execute()}ready(){this.unit.isKilled()||this.readyCommand.execute()}move(){this.unit.isKilled()||this.moveCommand.execute()}attack(){this.unit.isKilled()||this.attackCommand.execute()}die(){this.unit.isKilled()||this.dieCommand.execute()}},Ed=UL,FL=class{unit;constructor(e){this.unit=e}},GL=FL,YL=class extends GL{payload;constructor(e,t){super(e),this.payload=t}execute(){let{spriteAnimKey:e,spineAnimKey:t,status:i}=this.payload;this.unit.setStatus(i),this.unit.display.play(e,t,!0,!0),this.unit.display.setAnimationTimeScale(.5+Math.random())}},ni=YL,HL=U(mi()),WL=class extends ni{execute(){let{spriteAnimKey:e,spineAnimKey:t,status:i}=this.payload;this.unit.setStatus(i),this.unit.display.play(e,t,!1),this.unit.display.setAnimationTimeScale(1),this.unit.display.addAnimEventListener(mt.MELEE.CUSTOM_EVENTS.FINISHED_ATTACKING,this.handleAttacked),ut.playSound(Et.MELEE_ATTACK,{volume:.5});let s=this.unit.attackController.getAttackTarget();s&&this.unit.display.setFlipX(s.x<=this.unit.x)}handleAttacked=()=>{if(this.unit.isKilled())return;let e=this.unit.attackController.getAttackTarget();if(e){if(e.isKilled()){this.unit.display.addAnimEventListener(HL.ANIMATION_COMPLETE,this.handleFinishedAttacking);return}e.takeDamage(this.unit),e.attackController.notifyTargetAttacked(this.unit)}};handleFinishedAttacking=()=>{this.unit.setStatus(Ft.FINISHED_ATTACKING)}},zL=WL,VL=U(mi()),XL=class extends ni{execute(){let{spriteAnimKey:e,spineAnimKey:t,status:i}=this.payload;this.unit.setStatus(i),this.unit.attackEvent?.remove(),this.unit.uiController.killHpBar(),this.unit.depthController.setDepthOnDeath(),this.unit.effectController.stopDamageEffect(),this.unit.display.play(e,t,!1,!0),this.unit.display.setAnimationTimeScale(1),this.unit.display.addAnimEventListener(VL.ANIMATION_COMPLETE,this.handleAnimationComplete)}handleAnimationComplete=()=>{this.unit.effectController.runDieEffect()}},KL=XL,jL=class extends ni{execute(){let{spriteAnimKey:e,spineAnimKey:t,status:i}=this.payload,s=this.unit.attackController.getAttackTarget();s&&(this.unit.isDepthDirty=!0,this.unit.getStatus()!==i&&(this.unit.setStatus(i),this.unit.display.play(e,t,!0),this.unit.display.setAnimationTimeScale(.5+Math.random())),this.unit.display.setFlipX(s.x<this.unit.x))}},ZL=jL,qL=class extends ni{execute(){let{spriteAnimKey:e,spineAnimKey:t,status:i}=this.payload;this.unit.revive(),this.unit.setStatus(i),this.unit.isDepthDirty=!0,this.unit.uiController.killHpBar(),this.unit.effectController.stopDieEffect(),this.unit.restoreUnitDisplay(),this.unit.display.setFlipX(!1),this.unit.display.play(e,t,!0,!0),this.unit.display.setAnimationTimeScale(.5+Math.random()),this.unit.attackController.reset()}},QL=qL,JL=class extends ni{execute(){let{spriteAnimKey:e,spineAnimKey:t,status:i}=this.payload;this.unit.setStatus(i),this.unit.uiController.reviveHpBar(),this.unit.display.play(e,t,!0,!0),this.unit.display.setAnimationTimeScale(.5+Math.random())}},$L=JL,tI=class extends Ed{addAttackCommand(){this.attackCommand=new zL(this.unit,{status:Ft.ATTACKING,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("ATTACK"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("ATTACK")})}addReadyCommand(){this.readyCommand=new $L(this.unit,{status:Ft.READY,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("IDLE"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("IDLE")})}addMoveCommand(){this.moveCommand=new ZL(this.unit,{status:Ft.MOVING_TO_TARGET,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("RUN"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("RUN")})}addDieCommand(){this.dieCommand=new KL(this.unit,{status:Ft.KILLED,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("DIE"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("DIE")})}addPrepareCommand(){this.prepareCommand=new QL(this.unit,{status:Ft.PREPARE,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("IDLE"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("IDLE")})}getSpriteAnimKeyByUnitLevel(e){try{let{level:t}=this.unit,i=t;return i>=2&&(i=1),Kt.MELEE[i][e].KEY}catch{return Kt.ALIEN[1].IDLE.KEY}}getSpineAnimKeyByUnitLevel(e){let t=mt.MELEE[e];if(!t)throw new Error(`Can't find spine animation ${e}`);return t}},eI=tI,br=U(yt()),{modifier:iI}=Ut.Powers.SpeedUp,sI=class extends at{movementSpeed;savedApproachXOffset;savedApproachYOffset;constructor(e,t,i,s,n,r){super(e,t,i,s,n,r),this.unitType=Q.MELEE_UNIT_TYPE,this.movementSpeed=Q.MELEE_MOVEMENT_SPEED,this.attackInterval=Q.MELEE_ATTACK_INTERVAL;let o=this.display.getSpineAnimationAttackingTime();this.attackInterval<o&&(this.attackInterval=o),this.savedApproachXOffset=null,this.savedApproachYOffset=null}createActions(){this.actions=new eI(this)}moveToAttackPosition(e){if(this.isKilled())return;let t=this.attackController.getAttackTarget();if(!t||t?.isKilled())return;let i=t.requestAttackPosition(this);i&&(this.isDepthDirty=!0,this.executeMovement(e,i.location))}executeMovement(e,t){let{x:i,y:s}=this,n=this.scene.powerManager.isGameSpeedUp()?this.movementSpeed*iI:this.movementSpeed,r=n/1e3*e,o=br.Distance.Between(i,s,t.x,t.y),a=t.x-i,h=t.y-s,l=a!==0?a/o*n/1e3*e:0,c=h!==0?h/o*n/1e3*e:0;if(br.Distance.Between(i+l,s+c,t.x,t.y)<=r){this.setPosition(i+l,s+c),this.setStatus(Ft.PREPARE_TO_ATTACK),this.attackController.moveAttackSpotMelee(t.x-i,t.y-s);return}this.display.setFlipX(l<0),this.setPosition(i+l,s+c),this.attackController.moveAttackSpotMelee(l,c)}moveToTarget(e){this.moveToAttackPosition(e)}determineCounteringEnemy(){let{beingAttackedByMelee:e,beingAttackedByRanged:t}=this.attackController,i=this.attackController.getAttackTarget();if(i?.isKilled()&&(i=null),e&&!e.isKilled())return this.attackController.setAttackTarget(e),i?.attackController.resetAttackSpotOfUnit(this),!0;if(t&&!t.isKilled()){let s=br.Distance.Between(this.x,this.y,t.x,t.y),n=i?br.Distance.Between(this.x,this.y,i.x,i.y):1e4;if(s<n)return this.attackController.setAttackTarget(t),i?.attackController.resetAttackSpotOfUnit(this),!0}return!1}setUnitData(e){super.setUnitData(e),this.unitType=Q.MELEE_UNIT_TYPE}update(e,t){if(super.update(e,t),this.isKilled()||!this.scene.stateManager.isInPlayingState())return;let i=this.attackController.getAttackTarget();if(this.isReady()){(!i||i.isKilled())&&this.findTarget(),i&&this.actions.move();return}if(this.isMovingToTarget()){let s=this.determineCounteringEnemy();if(this.moveToTarget(t),s)return;if(i?.isKilled()){this.attackController.resetAttackTarget(),this.actions.ready();return}return}if(this.isPreparingToAttack()){if(i?.isKilled()){this.actions.ready();return}this.attack();return}this.isFinishedAttacking()&&(this.savedApproachXOffset=null,this.savedApproachYOffset=null,this.actions.ready())}},de=sI,nI={SUMMON_MINIONS:"summon-minions",SUMMON_RANGED_MINIONS:"summon-ranged-minions",SUMMON_AMBUSH:"summon-ambush"},Si=nI,rI=class extends de{isBoss;availableSkills;constructor(e,t,i,s,n,r){super(e,t,i,s,n,r),this.isBoss=!0,this.availableSkills={SummonMinions:!1,SummonRangedMinions:!1,SummonAmbush:!1}}triggerSummonMinions(){this.scene.events.emit(Si.SUMMON_MINIONS,this.level)}triggerSummonRangedMinions(){this.scene.events.emit(Si.SUMMON_RANGED_MINIONS,this.level)}triggerSummonAmbush(){this.scene.events.emit(Si.SUMMON_AMBUSH,this.level)}update(e,t){if(super.update(e,t),this.isKilled()||!this.scene.stateManager.isInPlayingState())return;let i=this.attackController.getAttackTarget();if(this.availableSkills.SummonMinions&&this.currentHp<=this.originalUnitData.health*.5&&(this.availableSkills.SummonMinions=!1,this.triggerSummonMinions()),this.availableSkills.SummonRangedMinions&&this.currentHp<=this.originalUnitData.health*.25&&(this.availableSkills.SummonRangedMinions=!1,this.triggerSummonRangedMinions()),this.availableSkills.SummonAmbush&&this.currentHp<=this.originalUnitData.health*.1&&(this.availableSkills.SummonAmbush=!1,this.triggerSummonAmbush()),this.isReady()){(!i||i.isKilled())&&this.findTarget(),i&&this.actions.move();return}if(this.isMovingToTarget()){let s=this.determineCounteringEnemy();if(this.moveToTarget(t),s)return;if(i?.isKilled()){this.attackController.resetAttackTarget(),this.actions.ready();return}return}if(this.isPreparingToAttack()){if(i?.isKilled()){this.actions.ready();return}this.attack();return}this.isFinishedAttacking()&&(this.savedApproachXOffset=null,this.savedApproachYOffset=null,this.actions.ready())}},Se=rI,{KEY:aI}=W.UNITS_SPINES.MELEE[10],oI=class extends Se{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:aI,spineConfig:{animation:mt.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!0}}reuseUnitFromPool(e){super.reuseUnitFromPool(e),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!0}}reuseUnitOnReady(){super.reuseUnitOnReady(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!0}}},hI=oI,{KEY:lI}=W.UNITS_SPINES.MELEE[11],uI=class extends Se{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:lI,spineConfig:{animation:mt.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!0}}reuseUnitFromPool(e){super.reuseUnitFromPool(e),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!0}}reuseUnitOnReady(){super.reuseUnitOnReady(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!0}}},cI=uI,{KEY:dI,FRAME:pI}=W.UNITS_SPRITES,{KEY:gI}=W.UNITS_SPINES.MELEE[1],fI=class extends Se{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:gI,spineConfig:{animation:mt.MELEE.IDLE,loop:!0}},sprite:{key:dI,frame:pI.MELEE[1].MAIN_TEXTURE,displayWidth:86.5,displayHeight:68},useSpine:!0})}},mI=fI,{KEY:vI}=W.UNITS_SPINES.MELEE[2],EI=class extends Se{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:vI,spineConfig:{animation:mt.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!1,SummonAmbush:!1}}reuseUnitFromPool(e){super.reuseUnitFromPool(e),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!1,SummonAmbush:!1}}reuseUnitOnReady(){super.reuseUnitOnReady(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!1,SummonAmbush:!1}}},yI=EI,{KEY:TI}=W.UNITS_SPINES.MELEE[3],SI=class extends Se{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:TI,spineConfig:{animation:mt.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!1,SummonAmbush:!1}}reuseUnitFromPool(e){super.reuseUnitFromPool(e),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!1,SummonAmbush:!1}}reuseUnitOnReady(){super.reuseUnitOnReady(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!1,SummonAmbush:!1}}},AI=SI,{KEY:xI}=W.UNITS_SPINES.MELEE[4],wI=class extends Se{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:xI,spineConfig:{animation:mt.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!1}}reuseUnitFromPool(e){super.reuseUnitFromPool(e),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!1}}reuseUnitOnReady(){super.reuseUnitOnReady(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!1}}},RI=wI,{KEY:CI}=W.UNITS_SPINES.MELEE[5],_I=class extends Se{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:CI,spineConfig:{animation:mt.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!1}}reuseUnitFromPool(e){super.reuseUnitFromPool(e),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!1}}reuseUnitOnReady(){super.reuseUnitOnReady(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!1}}},bI=_I,{KEY:PI}=W.UNITS_SPINES.MELEE[6],LI=class extends Se{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:PI,spineConfig:{animation:mt.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!1}}reuseUnitFromPool(e){super.reuseUnitFromPool(e),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!1}}reuseUnitOnReady(){super.reuseUnitOnReady(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!1}}},II=LI,{KEY:MI}=W.UNITS_SPINES.MELEE[7],OI=class extends Se{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:MI,spineConfig:{animation:mt.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!1}}reuseUnitFromPool(e){super.reuseUnitFromPool(e),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!1}}reuseUnitOnReady(){super.reuseUnitOnReady(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!1}}},DI=OI,{KEY:kI}=W.UNITS_SPINES.MELEE[8],BI=class extends Se{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:kI,spineConfig:{animation:mt.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!0}}reuseUnitFromPool(e){super.reuseUnitFromPool(e),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!0}}reuseUnitOnReady(){super.reuseUnitOnReady(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!0}}},NI=BI,{KEY:UI}=W.UNITS_SPINES.MELEE[9],FI=class extends Se{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:UI,spineConfig:{animation:mt.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!0}}reuseUnitFromPool(e){super.reuseUnitFromPool(e),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!0}}reuseUnitOnReady(){super.reuseUnitOnReady(),this.availableSkills={SummonMinions:!0,SummonRangedMinions:!0,SummonAmbush:!0}}},GI=FI,{KEY:YI}=W.UNITS_SPINES.MELEE[10],HI=class extends de{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:YI,spineConfig:{animation:mt.MELEE.IDLE,loop:!0}},useSpine:!0})}},yd=HI,{KEY:WI}=W.UNITS_SPINES.MELEE[11],zI=class extends de{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:WI,spineConfig:{animation:mt.MELEE.IDLE,loop:!0}},useSpine:!0})}},Td=zI,{KEY:VI,FRAME:XI}=W.UNITS_SPRITES,{KEY:KI}=W.UNITS_SPINES.MELEE[1],jI=class extends de{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:KI,spineConfig:{animation:mt.MELEE.IDLE,loop:!0}},sprite:{key:VI,frame:XI.MELEE[1].MAIN_TEXTURE,displayWidth:86.5,displayHeight:68},useSpine:!0})}},Sd=jI,{KEY:ZI}=W.UNITS_SPINES.MELEE[2],qI=class extends de{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:ZI,spineConfig:{animation:mt.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar()}},Ad=qI,{KEY:QI}=W.UNITS_SPINES.MELEE[3],JI=class extends de{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:QI,spineConfig:{animation:mt.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar()}},xd=JI,{KEY:$I}=W.UNITS_SPINES.MELEE[4],tM=class extends de{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:$I,spineConfig:{animation:mt.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar()}},wd=tM,{KEY:eM}=W.UNITS_SPINES.MELEE[5],iM=class extends de{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:eM,spineConfig:{animation:mt.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar()}},Rd=iM,{KEY:sM}=W.UNITS_SPINES.MELEE[6],nM=class extends de{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:sM,spineConfig:{animation:mt.MELEE.IDLE,loop:!0}},useSpine:!0}),this.updatePositionHpBar()}},Cd=nM,{KEY:rM}=W.UNITS_SPINES.MELEE[7],aM=class extends de{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:rM,spineConfig:{animation:mt.MELEE.IDLE,loop:!0}},useSpine:!0})}},_d=aM,{KEY:oM}=W.UNITS_SPINES.MELEE[8],hM=class extends de{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:oM,spineConfig:{animation:mt.MELEE.IDLE,loop:!0}},useSpine:!0})}},bd=hM,{KEY:lM}=W.UNITS_SPINES.MELEE[9],uM=class extends de{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:lM,spineConfig:{animation:mt.MELEE.IDLE,loop:!0}},useSpine:!0})}},Pd=uM,Ld=U(it()),cM=class{scene;numOfPlayerSpawnedUnits;resourcePool;bossResourcePool;constructor(e){this.scene=e,this.resourcePool=new Ld.Group(this.scene,{runChildUpdate:!1}),this.bossResourcePool=new Ld.Group(this.scene,{runChildUpdate:!1})}init(){this.numOfPlayerSpawnedUnits=0}returnToPool(e){if(e instanceof Se){this.bossResourcePool.add(e);return}this.resourcePool.add(e)}getPlayerSpawnedUnitsCount(){return this.numOfPlayerSpawnedUnits}setSpawnedUnits(e){this.numOfPlayerSpawnedUnits=e}},Id=cM,dM=class extends Id{requestUnitByLevel(e,t,i=!1){let s=this.getUnitFromResourcePoolByLevel(e);return s?(t&&!i&&(this.numOfPlayerSpawnedUnits+=Math.pow(2,e-1)),s.reuseUnitFromPool(t),this.scene.add.existing(s),s):(s=this.createUnitByLevel(e,t,i),s)}requestUnitById(e,t,i=!1){let s=this.getUnitFromResourcePoolById(e);return s?(t&&!i&&(this.numOfPlayerSpawnedUnits+=Math.pow(2,s.level-1)),s.reuseUnitFromPool(t),this.scene.add.existing(s),s):(s=this.createUnitById(e,t,i),s)}requestBossByLevel(e){let t=this.getUnitFromBossResoucePool(e);return t?(t.reuseUnitFromPool(!1),this.scene.add.existing(t),t):(t=this.createBossUnitByLevel(e),t)}createBossUnitByLevel(e){let t,i=this.getBossDataByLevel(e);switch(e){case 2:t=new yI(this.scene,!1,i);break;case 3:t=new AI(this.scene,!1,i);break;case 4:t=new RI(this.scene,!1,i);break;case 5:t=new bI(this.scene,!1,i);break;case 6:t=new II(this.scene,!1,i);break;case 7:t=new DI(this.scene,!1,i);break;case 8:t=new NI(this.scene,!1,i);break;case 9:t=new GI(this.scene,!1,i);break;case 10:t=new hI(this.scene,!1,i);break;case 11:t=new cI(this.scene,!1,i);break;default:t=new mI(this.scene,!1,i);break}return t}createUnitByLevel(e,t,i=!1){let s,n=this.getUnitDataByLevel(e);switch(e){case 1:s=new Sd(this.scene,t,n);break;case 2:s=new Ad(this.scene,t,n);break;case 3:s=new xd(this.scene,t,n);break;case 4:s=new wd(this.scene,t,n);break;case 5:s=new Rd(this.scene,t,n);break;case 6:s=new Cd(this.scene,t,n);break;case 7:s=new _d(this.scene,t,n);break;case 8:s=new bd(this.scene,t,n);break;case 9:s=new Pd(this.scene,t,n);break;case 10:s=new yd(this.scene,t,n);break;case 11:s=new Td(this.scene,t,n);break;default:return new es(this.scene,t)}return t&&!i&&(this.numOfPlayerSpawnedUnits+=Math.pow(2,e-1)),s}createUnitById(e,t,i=!1){let s,n=this.getUnitDataById(e);if(!n)return new es(this.scene,t);switch(e){case"velociraptor":s=new Sd(this.scene,t,n);break;case"saurolophus":s=new Ad(this.scene,t,n);break;case"pachysaurus":s=new xd(this.scene,t,n);break;case"triceratops":s=new wd(this.scene,t,n);break;case"stegosaurus":s=new Rd(this.scene,t,n);break;case"ankylosaurus":s=new Cd(this.scene,t,n);break;case"baroptiloraptor":s=new _d(this.scene,t,n);break;case"tyrannosaurus":s=new bd(this.scene,t,n);break;case"dilophosaurus":s=new Pd(this.scene,t,n);break;case"triceradonosaurus":s=new yd(this.scene,t,n);break;case"spinosaurus-rex":s=new Td(this.scene,t,n);break;default:return new es(this.scene,t)}return t&&!i&&(this.numOfPlayerSpawnedUnits+=Math.pow(2,n.level-1)),s}getUnitDataByLevel(e){return this.scene.cache.json.get("unitData").melee[e-1]}getUnitDataById(e){return this.scene.cache.json.get("unitData").melee.find(t=>t.id===e)}getBossDataByLevel(e){return this.scene.cache.json.get("bossData").melee[e-1]}getUnitFromResourcePoolByLevel(e){let t=this.resourcePool.getChildren().find(i=>i instanceof de?i.level===e:!1);if(t instanceof at)return this.resourcePool.remove(t),t}getUnitFromBossResoucePool(e){let t=this.bossResourcePool.getChildren().find(i=>i instanceof Se?i.level===e:!1);if(t instanceof at)return this.bossResourcePool.remove(t),t}getUnitFromResourcePoolById(e){let t=this.resourcePool.getChildren().find(i=>{if(!(i instanceof de))return!1;let{originalUnitData:s}=i;return s.id===e});if(t instanceof at)return this.resourcePool.remove(t),t}},pM=dM,Md=U(it()),Od=U(yt()),{KEY:gM,FRAME:fM}=W.GAMEPLAY,{modifier:mM}=Ut.Powers.SpeedUp,vM=class extends Md.Sprite{scene;target;attacker;speed;heightOffset;upwardDirectionOffset;downwardDirectionOffset;constructor(e,t){let{attacker:i,target:s,speed:n,frame:r}=t,o=r||fM.BLANK;super(e,i.x,i.y,gM,o),this.setDisplaySize(5,5),this.scene=e,this.speed=n||Q.RANGED_PROJECTILE_SPEED,this.target=s,this.attacker=i,this.heightOffset=0;let a=this.target.display;a instanceof Md.Sprite||(this.heightOffset=a.displayHeight*.4),this.rotation=Od.Angle.Between(this.x,this.y,s.x,s.y-this.heightOffset);let{depthController:h}=this.attacker;this.setDepth(h.getProjectileDepth()),this.scene.add.existing(this)}update(e,t){let i=this.scene.powerManager.isGameSpeedUp()?this.speed*mM:this.speed,s=i/1e3*t,n=Od.Distance.Between(this.x,this.y,this.target.x,this.target.y-this.heightOffset);if(n<s){this.target.takeDamage(this.attacker),this.scene.unitManager.rangedProjectiles.remove(this,!0);return}let r=this.target.x-this.x,o=this.target.y-this.heightOffset-this.y,a=r/n*i/1e3*t,h=o/n*i/1e3*t;this.setPosition(this.x+a,this.y+h)}},Me=vM,Dd=U(yt()),{FRAME:EM}=W.GAMEPLAY,{UNIT_SIZE_SCALE:yM}=Q,TM=class extends Me{constructor(e,t){t.frame=EM.ROCK,super(e,t),this.setOrigin(.5,.5);let i=yM;this.setDisplaySize(7.5*i,6.5*i),this.upwardDirectionOffset=new Dd.Vector2(0,-10),this.downwardDirectionOffset=new Dd.Vector2(0,-10);let s=this.downwardDirectionOffset.x,n=this.downwardDirectionOffset.y;this.attacker.y>this.target.y&&(s=this.upwardDirectionOffset.x,n=this.upwardDirectionOffset.y),this.setPosition(this.attacker.x+s,this.attacker.y+n)}},SM=TM,Io=U(yt()),{FRAME:AM}=W.GAMEPLAY,{UNIT_SIZE_SCALE:xM}=Q,wM=class extends Me{constructor(e,t){t.frame=AM.JAVELIN,super(e,t),this.setOrigin(1,.5);let i=xM;this.setDisplaySize(67*i,3.5*i),this.upwardDirectionOffset=new Io.Vector2(0,-20),this.downwardDirectionOffset=new Io.Vector2(10,0);let s=this.downwardDirectionOffset.x,n=this.downwardDirectionOffset.y;this.attacker.y>this.target.y&&(s=this.upwardDirectionOffset.x,n=this.upwardDirectionOffset.y),this.attacker.display.isFaceLeft()&&(s=-s);let r=this.attacker.x+s,o=this.attacker.y+n;this.rotation=Io.Angle.Between(r,o,this.target.x,this.target.y-this.heightOffset);let a=this.displayWidth*Math.cos(this.rotation),h=this.displayWidth*Math.sin(this.rotation);this.setPosition(r+a,o+h)}},RM=wM,kd=U(yt()),{FRAME:CM}=W.GAMEPLAY,{UNIT_SIZE_SCALE:_M}=Q,bM=class extends Me{isGoToLeft;constructor(e,t){t.frame=CM.BOOMERANG,super(e,t),this.setOrigin(.5,.5);let i=_M;this.setDisplaySize(12*i,27.5*i),this.upwardDirectionOffset=new kd.Vector2(0,-20),this.downwardDirectionOffset=new kd.Vector2(0,-20);let s=this.downwardDirectionOffset.x,n=this.downwardDirectionOffset.y;this.attacker.y>this.target.y&&(s=this.upwardDirectionOffset.x,n=this.upwardDirectionOffset.y),this.setPosition(this.attacker.x+s,this.attacker.y+n),this.isGoToLeft=this.attacker.display.isFaceLeft()}update(e,t){this.isGoToLeft?this.angle-=t*1.5:this.angle+=t*1.5,super.update(e,t)}},PM=bM,Bd=U(yt()),{FRAME:LM}=W.GAMEPLAY,{UNIT_SIZE_SCALE:IM}=Q,MM=class extends Me{isGoToLeft;constructor(e,t){t.frame=LM.MACE,super(e,t),this.setOrigin(.4,.4);let i=IM;this.setDisplaySize(36.5*i,14.5*i),this.upwardDirectionOffset=new Bd.Vector2(20,-40),this.downwardDirectionOffset=new Bd.Vector2(10,0);let s=this.downwardDirectionOffset.x,n=this.downwardDirectionOffset.y;this.attacker.y>this.target.y&&(s=this.upwardDirectionOffset.x,n=this.upwardDirectionOffset.y),this.attacker.display.isFaceLeft()&&(s=-s),this.setPosition(this.attacker.x+s,this.attacker.y+n),this.isGoToLeft=this.attacker.display.isFaceLeft()}update(e,t){this.isGoToLeft?this.angle-=t*.9:this.angle+=t*.9,super.update(e,t)}},OM=MM,Mo=U(yt()),{FRAME:DM}=W.GAMEPLAY,{UNIT_SIZE_SCALE:kM}=Q,BM=class extends Me{constructor(e,t){t.frame=DM.ARROW_1,super(e,t),this.setOrigin(1,.5);let i=kM;this.setDisplaySize(38.5*i,10*i),this.upwardDirectionOffset=new Mo.Vector2(5,-10),this.downwardDirectionOffset=new Mo.Vector2(5,-8);let s=this.downwardDirectionOffset.x,n=this.downwardDirectionOffset.y;this.attacker.y>this.target.y&&(s=this.upwardDirectionOffset.x,n=this.upwardDirectionOffset.y),this.attacker.display.isFaceLeft()&&(s=-s);let r=this.attacker.x+s,o=this.attacker.y+n;this.rotation=Mo.Angle.Between(r,o,this.target.x,this.target.y-this.heightOffset);let a=this.displayWidth*Math.cos(this.rotation),h=this.displayWidth*Math.sin(this.rotation);this.setPosition(r+a,o+h)}},NM=BM,Oo=U(yt()),{FRAME:UM}=W.GAMEPLAY,{UNIT_SIZE_SCALE:FM}=Q,GM=class extends Me{constructor(e,t){t.frame=UM.ARROW_2,super(e,t),this.setOrigin(1,.5);let i=FM;this.setDisplaySize(37*i,11*i),this.upwardDirectionOffset=new Oo.Vector2(15,-15),this.downwardDirectionOffset=new Oo.Vector2(15,-15);let s=this.downwardDirectionOffset.x,n=this.downwardDirectionOffset.y;this.attacker.y>this.target.y&&(s=this.upwardDirectionOffset.x,n=this.upwardDirectionOffset.y),this.attacker.display.isFaceLeft()&&(s=-s);let r=this.attacker.x+s,o=this.attacker.y+n;this.rotation=Oo.Angle.Between(r,o,this.target.x,this.target.y-this.heightOffset);let a=this.displayWidth*Math.cos(this.rotation),h=this.displayWidth*Math.sin(this.rotation);this.setPosition(r+a,o+h)}},YM=GM,Do=U(yt()),{FRAME:HM}=W.GAMEPLAY,{UNIT_SIZE_SCALE:WM}=Q,zM=class extends Me{constructor(e,t){t.frame=HM.BOLT_1,super(e,t),this.setOrigin(1,.5);let i=WM;this.setDisplaySize(38*i,6*i),this.upwardDirectionOffset=new Do.Vector2(20,-30),this.downwardDirectionOffset=new Do.Vector2(20,12);let s=this.downwardDirectionOffset.x,n=this.downwardDirectionOffset.y;this.attacker.y>this.target.y&&(s=this.upwardDirectionOffset.x,n=this.upwardDirectionOffset.y),this.attacker.display.isFaceLeft()&&(s=-s);let r=this.attacker.x+s,o=this.attacker.y+n;this.rotation=Do.Angle.Between(r,o,this.target.x,this.target.y-this.heightOffset);let a=this.displayWidth*Math.cos(this.rotation),h=this.displayWidth*Math.sin(this.rotation);this.setPosition(r+a,o+h)}},VM=zM,ko=U(yt()),{FRAME:XM}=W.GAMEPLAY,{UNIT_SIZE_SCALE:KM}=Q,jM=class extends Me{constructor(e,t){t.frame=XM.BOLT_2,super(e,t),this.setOrigin(1,.5);let i=KM;this.setDisplaySize(46*i,9.5*i),this.upwardDirectionOffset=new ko.Vector2(20,-40),this.downwardDirectionOffset=new ko.Vector2(20,10);let s=this.downwardDirectionOffset.x,n=this.downwardDirectionOffset.y;this.attacker.y>this.target.y&&(s=this.upwardDirectionOffset.x,n=this.upwardDirectionOffset.y),this.attacker.display.isFaceLeft()&&(s=-s);let r=this.attacker.x+s,o=this.attacker.y+n;this.rotation=ko.Angle.Between(r,o,this.target.x,this.target.y-this.heightOffset);let a=this.displayWidth*Math.cos(this.rotation),h=this.displayWidth*Math.sin(this.rotation);this.setPosition(r+a,o+h)}},ZM=jM,Nd=U(yt()),{FRAME:qM}=W.GAMEPLAY,{UNIT_SIZE_SCALE:QM}=Q,JM=class extends Me{isGoToLeft;constructor(e,t){t.frame=qM.FIRE_RING,super(e,t),this.setOrigin(.5,.5);let i=QM;this.setDisplaySize(34.5*i,36*i),this.upwardDirectionOffset=new Nd.Vector2(20,-40),this.downwardDirectionOffset=new Nd.Vector2(20,0);let s=this.downwardDirectionOffset.x,n=this.downwardDirectionOffset.y;this.attacker.y>this.target.y&&(s=this.upwardDirectionOffset.x,n=this.upwardDirectionOffset.y),this.attacker.display.isFaceLeft()&&(s=-s),this.setPosition(this.attacker.x+s,this.attacker.y+n),this.isGoToLeft=this.attacker.display.isFaceLeft()}update(e,t){this.isGoToLeft?this.angle-=t*.9:this.angle+=t*.9,super.update(e,t)}},$M=JM,Bo=U(yt()),{FRAME:tO}=W.GAMEPLAY,{UNIT_SIZE_SCALE:eO}=Q,iO=class extends Me{constructor(e,t){t.frame=tO.BLUE_FIRE,super(e,t),this.setOrigin(1,.5);let i=eO;this.setDisplaySize(70.5*i,33.5*i),this.upwardDirectionOffset=new Bo.Vector2(40,-60),this.downwardDirectionOffset=new Bo.Vector2(50,35);let s=this.downwardDirectionOffset.x,n=this.downwardDirectionOffset.y;this.attacker.y>this.target.y&&(s=this.upwardDirectionOffset.x,n=this.upwardDirectionOffset.y),this.attacker.display.isFaceLeft()&&(s=-s);let r=this.attacker.x+s,o=this.attacker.y+n;this.rotation=Bo.Angle.Between(r,o,this.target.x,this.target.y-this.heightOffset);let a=this.displayWidth*Math.cos(this.rotation),h=this.displayWidth*Math.sin(this.rotation);this.setPosition(r+a,o+h)}},sO=iO,Ud=U(yt()),{FRAME:nO}=W.GAMEPLAY,{UNIT_SIZE_SCALE:rO}=Q,aO=class extends Me{constructor(e,t){t.frame=nO.GREEN_FIRE,super(e,t),this.setOrigin(1,.5);let i=rO;this.setDisplaySize(50*i,50*i),this.upwardDirectionOffset=new Ud.Vector2(30,-70),this.downwardDirectionOffset=new Ud.Vector2(40,0);let s=this.downwardDirectionOffset.x,n=this.downwardDirectionOffset.y;this.attacker.y>this.target.y&&(s=this.upwardDirectionOffset.x,n=this.upwardDirectionOffset.y),this.attacker.display.isFaceLeft()&&(s=-s),this.setPosition(this.attacker.x+s,this.attacker.y+n);let{animationManager:r}=this.scene;r.addLevel11ProjectileAnimation(),this.play(Ar.GREEN_FIRE.KEY,!0)}},oO=aO,hO=class{unit;scene;constructor(e){this.unit=e,this.scene=e.scene}createProjectile(e){let{level:t,speed:i,target:s}=e,n={attacker:this.unit,target:s,speed:i},r;switch(t){case 1:r=new SM(this.unit.scene,n);break;case 2:r=new RM(this.unit.scene,n);break;case 3:r=new PM(this.unit.scene,n);break;case 4:r=new OM(this.unit.scene,n);break;case 5:r=new NM(this.unit.scene,n);break;case 6:r=new YM(this.unit.scene,n);break;case 7:r=new VM(this.unit.scene,n);break;case 8:r=new ZM(this.unit.scene,n);break;case 9:r=new $M(this.unit.scene,n);break;case 10:r=new sO(this.unit.scene,n);break;case 11:r=new oO(this.unit.scene,n);break;default:r=new Me(this.unit.scene,n)}let{unitManager:o}=this.scene;o.rangedProjectiles.add(r)}},lO=hO,uO=U(mi()),cO=class extends ni{unit;spriteBelowAnimKey;spineBelowAnimKey;constructor(e,t){super(e,{spineAnimKey:t.spineAboveAnimKey,spriteAnimKey:t.spriteAboveAnimKey,status:t.status}),this.spriteBelowAnimKey=t.spriteBelowAnimKey,this.spineBelowAnimKey=t.spineBelowAnimKey,this.unit=e}execute(){let{spriteAnimKey:e,spineAnimKey:t,status:i}=this.payload,s=this.unit.attackController.getAttackTarget();if(!s){this.unit.setStatus(Ft.FINISHED_ATTACKING);return}this.unit.setStatus(i),this.unit.display.setAnimationTimeScale(1),this.unit.y>s.y?this.unit.display.play(this.spriteBelowAnimKey,this.spineBelowAnimKey,!1):this.unit.display.play(e,t,!1),this.unit.display.addAnimEventListener(mt.RANGED.CUSTOM_EVENTS.FINISHED_ATTACKING,this.handleAttacked),this.unit.display.setFlipX(s.x<=this.unit.x)}handleAttacked=()=>{if(this.unit.isKilled())return;let e=this.unit.attackController.getAttackTarget();e&&(e.isKilled()&&this.unit.display.addAnimEventListener(uO.ANIMATION_COMPLETE,this.handleFinishedAttacking),this.unit.projectileController.createProjectile({level:this.unit.level,target:e}),ut.playSound(Et.ARROW_SHOOT,{volume:.5}))};handleFinishedAttacking=()=>{this.unit.setStatus(Ft.FINISHED_ATTACKING)}},dO=cO,pO=U(mi()),gO=class extends ni{execute(){let{spriteAnimKey:e,spineAnimKey:t,status:i}=this.payload;this.unit.setStatus(i),this.unit.attackEvent?.remove(),this.unit.uiController.killHpBar(),this.unit.depthController.setDepthOnDeath(),this.unit.effectController.stopDamageEffect(),this.unit.display.setAnimationTimeScale(1),this.unit.display.play(e,t,!1,!0),this.unit.display.addAnimEventListener(pO.ANIMATION_COMPLETE,this.handleAnimationComplete)}handleAnimationComplete=()=>{this.unit.effectController.runDieEffect()}},fO=gO,mO=class extends ni{execute(){let{spriteAnimKey:e,spineAnimKey:t,status:i}=this.payload;this.unit.revive(),this.unit.setStatus(i),this.unit.isDepthDirty=!0,this.unit.uiController.killHpBar(),this.unit.effectController.stopDieEffect(),this.unit.restoreUnitDisplay(),this.unit.display.setFlipX(!1),this.unit.display.play(e,t,!0,!0),this.unit.display.setAnimationTimeScale(.5+Math.random()),this.unit.attackController.reset()}},vO=mO,EO=class extends ni{execute(){let{spriteAnimKey:e,spineAnimKey:t,status:i}=this.payload;this.unit.setStatus(i),this.unit.uiController.reviveHpBar(),this.unit.display.play(e,t,!0,!0),this.unit.display.setAnimationTimeScale(.5+Math.random())}},yO=EO,TO=class extends Ed{unit;constructor(e){super(e),this.unit=e}addAttackCommand(){this.attackCommand=new dO(this.unit,{status:Ft.ATTACKING,spriteAboveAnimKey:this.getSpriteAnimKeyByUnitLevel("ATTACK_ABOVE"),spriteBelowAnimKey:this.getSpriteAnimKeyByUnitLevel("ATTACK_BELOW"),spineAboveAnimKey:this.getSpineAnimKeyByUnitLevel("ATTACK_ABOVE"),spineBelowAnimKey:this.getSpineAnimKeyByUnitLevel("ATTACK_BELOW")})}addReadyCommand(){this.readyCommand=new yO(this.unit,{status:Ft.READY,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("IDLE"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("IDLE")})}addMoveCommand(){this.moveCommand=new ni(this.unit,{status:Ft.MOVING_TO_TARGET,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("IDLE"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("IDLE")})}addDieCommand(){this.dieCommand=new fO(this.unit,{status:Ft.KILLED,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("DIE"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("DIE")})}addPrepareCommand(){this.prepareCommand=new vO(this.unit,{status:Ft.PREPARE,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("IDLE"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("IDLE")})}resetRangedAttackAnimation(){this.addAttackCommand()}getSpriteAnimKeyByUnitLevel(e){try{let{level:t}=this.unit,i=t;return i>=2&&(i=1),Kt.RANGED[i][e].KEY}catch{return Kt.ALIEN[1].IDLE.KEY}}getSpineAnimKeyByUnitLevel(e){let t=mt.RANGED[e];if(!t)throw new Error(`Can't find spine animation ${e}`);return t}},Fd=TO,SO=class extends at{projectileColor;projectileSpeed;projectileController;constructor(e,t,i,s,n,r){super(e,t,i,s,n,r),this.projectileController=new lO(this),this.unitType=Q.RANGED_UNIT_TYPE,this.attackInterval=Q.RANGED_ATTACK_INTERVAL;let o=this.display.getSpineAnimationAttackingTime();this.attackInterval<o&&(this.attackInterval=o),this.projectileSpeed=Q.RANGED_PROJECTILE_SPEED}createActions(){this.actions=new Fd(this)}determineCounteringEnemy(){let{beingAttackedByMelee:e,beingAttackedByRanged:t}=this.attackController,i=this.attackController.getAttackTarget();return i?.isKilled()&&(i=null),e&&!e.isKilled()?(this.attackController.setAttackTarget(e),!0):t&&!t.isKilled()?(this.attackController.setAttackTarget(t),!0):!1}setUnitData(e){super.setUnitData(e),this.unitType=Q.RANGED_UNIT_TYPE}update(e,t){if(super.update(e,t),this.isKilled()||!this.scene.stateManager.isInPlayingState())return;let i=this.attackController.getAttackTarget();if(this.isReady()){!this.determineCounteringEnemy()&&(!i||i.isKilled())&&this.findTarget(),i&&this.setStatus(Ft.PREPARE_TO_ATTACK);return}if(this.isPreparingToAttack()){if(i?.isKilled()){this.actions.ready();return}this.attack();return}this.isAttacking()&&i?.isKilled()&&this.display.getAnimationTimeScale()!==3&&(this.display.setAnimationTimeScale(3),this.display.changeCurrentSpriteEventTime()),this.isFinishedAttacking()&&this.actions.ready()}reuseUnitFromPool(e){super.reuseUnitFromPool(e);let t=this.actions;t instanceof Fd&&t.resetRangedAttackAnimation()}},Ae=SO,{KEY:AO}=W.UNITS_SPINES.RANGED[10],xO=class extends Ae{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:AO,spineConfig:{animation:mt.RANGED.IDLE,loop:!0}},useSpine:!0})}},Gd=xO,{KEY:wO}=W.UNITS_SPINES.RANGED[11],RO=class extends Ae{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:wO,spineConfig:{animation:mt.RANGED.IDLE,loop:!0}},useSpine:!0})}},Yd=RO,{KEY:CO,FRAME:_O}=W.UNITS_SPRITES,{KEY:bO}=W.UNITS_SPINES.RANGED[1],PO=class extends Ae{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:bO,spineConfig:{animation:mt.RANGED.IDLE,loop:!0}},sprite:{key:CO,frame:_O.RANGED[1].MAIN_TEXTURE,displayWidth:55,displayHeight:73},useSpine:!0})}},Hd=PO,{KEY:LO}=W.UNITS_SPINES.RANGED[2],IO=class extends Ae{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:LO,spineConfig:{animation:mt.RANGED.IDLE,loop:!0}},useSpine:!0})}},Wd=IO,{KEY:MO}=W.UNITS_SPINES.RANGED[3],OO=class extends Ae{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:MO,spineConfig:{animation:mt.RANGED.IDLE,loop:!0}},useSpine:!0})}},zd=OO,{KEY:DO}=W.UNITS_SPINES.RANGED[4],kO=class extends Ae{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:DO,spineConfig:{animation:mt.RANGED.IDLE,loop:!0}},useSpine:!0})}},Vd=kO,{KEY:BO}=W.UNITS_SPINES.RANGED[5],NO=class extends Ae{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:BO,spineConfig:{animation:mt.RANGED.IDLE,loop:!0}},useSpine:!0})}},Xd=NO,{KEY:UO}=W.UNITS_SPINES.RANGED[6],FO=class extends Ae{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:UO,spineConfig:{animation:mt.RANGED.IDLE,loop:!0}},useSpine:!0})}},Kd=FO,{KEY:GO}=W.UNITS_SPINES.RANGED[7],YO=class extends Ae{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:GO,spineConfig:{animation:mt.RANGED.IDLE,loop:!0}},useSpine:!0})}},jd=YO,{KEY:HO}=W.UNITS_SPINES.RANGED[8],WO=class extends Ae{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:HO,spineConfig:{animation:mt.RANGED.IDLE,loop:!0}},useSpine:!0})}},Zd=WO,{KEY:zO}=W.UNITS_SPINES.RANGED[9],VO=class extends Ae{constructor(e,t,i){super(e,0,0,t,i,{spine:{key:zO,spineConfig:{animation:mt.RANGED.IDLE,loop:!0}},useSpine:!0})}},qd=VO,XO=class extends Id{requestUnitByLevel(e,t,i=!1){let s=this.getUnitFromResourcePoolByLevel(e);return s?(t&&!i&&(this.numOfPlayerSpawnedUnits+=Math.pow(2,e-1)),s.reuseUnitFromPool(t),this.scene.add.existing(s),s):(s=this.createUnitByLevel(e,t,i),s)}requestUnitById(e,t,i=!1){let s=this.getUnitFromResourcePoolById(e);return s?(t&&!i&&(this.numOfPlayerSpawnedUnits+=Math.pow(2,s.level-1)),s.reuseUnitFromPool(t),this.scene.add.existing(s),s):(s=this.createUnitById(e,t,i),s)}requestBossByLevel(e){return new es(this.scene,!1)}createUnitByLevel(e,t,i=!1){let s,n=this.getUnitDataByLevel(e);switch(e){case 1:s=new Hd(this.scene,t,n);break;case 2:s=new Wd(this.scene,t,n);break;case 3:s=new zd(this.scene,t,n);break;case 4:s=new Vd(this.scene,t,n);break;case 5:s=new Xd(this.scene,t,n);break;case 6:s=new Kd(this.scene,t,n);break;case 7:s=new jd(this.scene,t,n);break;case 8:s=new Zd(this.scene,t,n);break;case 9:s=new qd(this.scene,t,n);break;case 10:s=new Gd(this.scene,t,n);break;case 11:s=new Yd(this.scene,t,n);break;default:return new es(this.scene,t)}return t&&!i&&(this.numOfPlayerSpawnedUnits+=Math.pow(2,e-1)),s}createUnitById(e,t,i=!1){let s,n=this.getUnitDataById(e);if(!n)return new es(this.scene,t);switch(e){case"rockthrower":s=new Hd(this.scene,t,n);break;case"javelineer":s=new Wd(this.scene,t,n);break;case"boomeranger":s=new zd(this.scene,t,n);break;case"macer":s=new Vd(this.scene,t,n);break;case"artemis":s=new Xd(this.scene,t,n);break;case"william":s=new Kd(this.scene,t,n);break;case"blanchette":s=new jd(this.scene,t,n);break;case"phantom":s=new Zd(this.scene,t,n);break;case"oracle":s=new qd(this.scene,t,n);break;case"shaman":s=new Gd(this.scene,t,n);break;case"seraph":s=new Yd(this.scene,t,n);break;default:return new es(this.scene,t)}return t&&!i&&(this.numOfPlayerSpawnedUnits+=Math.pow(2,n.level-1)),s}getUnitDataByLevel(e){return this.scene.cache.json.get("unitData").ranged[e-1]}getUnitDataById(e){return this.scene.cache.json.get("unitData").ranged.find(t=>t.id===e)}getUnitFromResourcePoolByLevel(e){let t=this.resourcePool.getChildren().find(i=>i instanceof Ae?i.level===e:!1);if(t instanceof at)return this.resourcePool.remove(t),t}getUnitFromResourcePoolById(e){let t=this.resourcePool.getChildren().find(i=>{if(!(i instanceof Ae))return!1;let{originalUnitData:s}=i;return s.id===e});if(t instanceof at)return this.resourcePool.remove(t),t}getUnitFromBossResoucePool(e){}},KO=XO,No=U(ft()),Uo=U(Cs()),{STATUS:Qd}=Ii,{MELEE_UNIT_TYPE:re,RANGED_UNIT_TYPE:Oe,ALIEN_UNIT_TYPE:Jd}=Q,{MaximumMeleeLevel:Fo,MaximumRangedLevel:Go}=Ut,{modifier:Tn}=Ut.Powers.SpeedUp,{player:is}=codex,{Utils:{Valid:jO}}=Ludex,ZO=class extends ue{scene;meleeSpawnPool;rangedSpawnPool;isPostGame;playerUnits;enemyUnits;rangedProjectiles;latestUnitMergePayload;constructor(e){super(e),this.scene=e,this.latestUnitMergePayload={level:1,type:"melee"},this.createFactories(),this.createUnitGroups()}init(){super.init(),this.initSpawnPools(),this.emptyEnemyUnits(),this.emptyPlayerUnits(),this.emptyProjectiles()}start(){this.isRunning()||(this.listenEvents(),this.createEnemyUnits(),this.checkForPostGame(),this.createPlayerUnitsNormal(),this.calculatePlayerTotalUnitsUsed(),this.setState(Qd.RUNNING))}stop(){this.isRunning()&&(this.stopDieEffectOfAllUnits(),this.setReadyAllUnits(),this.removeAttackEventsOfAllUnits(),this.hideAllUnits(),this.disableDragOnPlayerUnits(),this.runChildUpdateGroups(!1),this.setState(Qd.STOPPED))}listenEvents(){this.scene.events.off(Si.SUMMON_MINIONS,this.handleBossSummonMinions),this.scene.events.on(Si.SUMMON_MINIONS,this.handleBossSummonMinions),this.scene.events.off(Si.SUMMON_RANGED_MINIONS,this.handleBossSummonRangedMinions),this.scene.events.on(Si.SUMMON_RANGED_MINIONS,this.handleBossSummonRangedMinions),this.scene.events.off(Si.SUMMON_AMBUSH,this.handleBossSummonAmbush),this.scene.events.on(Si.SUMMON_AMBUSH,this.handleBossSummonAmbush)}createFactories(){this.meleeSpawnPool=new pM(this.scene),this.rangedSpawnPool=new KO(this.scene)}createUnitGroups(){this.enemyUnits=this.scene.add.group(),this.playerUnits=this.scene.add.group(),this.rangedProjectiles=this.scene.add.group()}runChildUpdateGroups(e){this.enemyUnits.runChildUpdate=e,this.playerUnits.runChildUpdate=e,this.rangedProjectiles.runChildUpdate=e}initSpawnPools(){this.meleeSpawnPool.init(),this.rangedSpawnPool.init()}emptyEnemyUnits(){this.enemyUnits.getChildren().forEach(e=>{if(!(e instanceof at))return;e.handleRemoveFromScene();let{unitType:t}=e;t===re&&this.meleeSpawnPool.returnToPool(e),t===Oe&&this.rangedSpawnPool.returnToPool(e)}),this.enemyUnits.clear(!0,!1)}emptyPlayerUnits(){this.playerUnits.getChildren().forEach(e=>{if(!(e instanceof at))return;e.handleRemoveFromScene();let{unitType:t}=e;t===re&&this.meleeSpawnPool.returnToPool(e),t===Oe&&this.rangedSpawnPool.returnToPool(e)}),this.playerUnits.clear(!0,!1)}emptyProjectiles(){this.rangedProjectiles.clear(!0,!0)}getPlayerUnits(){return this.playerUnits.getChildren()}getEnemyUnits(){return this.enemyUnits.getChildren()}getTotalPlayerUnitsHp(){let e=0;return this.playerUnits.getChildren().forEach(t=>{t instanceof at&&(e+=t.currentHp)}),e}getTotalEnemyUnitsHp(){let e=0;return this.enemyUnits.getChildren().forEach(t=>{t instanceof at&&(e+=t.currentHp)}),e}getPlayerMeleeSpawnedUnitsCount(){return this.meleeSpawnPool.getPlayerSpawnedUnitsCount()}getPlayerRangedSpawnedUnitsCount(){return this.rangedSpawnPool.getPlayerSpawnedUnitsCount()}createPlayerArcher(e,t,i=1){if(!this.isRunning())return;let{fieldManager:s,spineManager:n}=this.scene,r=s.getRemainingAvailablePlacement()===1,o=this.checkIfBoardCanBeMerged(),a=this.getLowestLevelPlayerRangedUnit(),h=r&&!o&&a>i?a:i,l=this.createUnit({level:h,isPlayer:!0,unitType:Oe});l.spawnUnitOnSquare(e,t,!0),n.addSpines([l]),this.resetAttackSpots(l),this.playerUnits.add(l)}createPlayerMelee(e,t,i=1){if(!this.isRunning())return;let{fieldManager:s,spineManager:n}=this.scene,r=s.getRemainingAvailablePlacement()===1,o=this.checkIfBoardCanBeMerged(),a=this.getLowestLevelPlayerMeleeUnit(),h=r&&!o&&a>i?a:i,l=this.createUnit({level:h,isPlayer:!0,unitType:re});l.spawnUnitOnSquare(e,t,!0),n.addSpines([l]),this.resetAttackSpots(l),this.playerUnits.add(l)}createEnemyUnits(){let{levelManager:e}=this.scene;e.enemyData.forEach(t=>{let i;t.isBoss?i=this.createBossUnit(t.level):i=this.createUnit({level:t.level,isPlayer:!1,unitType:t.type==="melee"?re:Oe}),i.spawnUnitOnSquare(t.positionRow,t.positionColumn,!1),i.actions.prepare(),this.resetAttackSpots(i),this.enemyUnits.add(i)})}createPlayerUnitsNormal(){this.playerUnits.getLength()===0?this.loadPlayerUnits():this.reusePlayerUnits();let{uiManager:e}=this.scene;this.playerUnits.getLength()>0&&e.enableStartButton()}createPlayerUnitsLevelBuilder(){let{levelManager:e}=this.scene;e.playerData.forEach(t=>{let i=this.createUnit({level:t.level,isPlayer:!0,unitType:t.type==="melee"?re:Oe});i.spawnUnitOnSquare(t.positionRow,t.positionColumn,!0),this.resetAttackSpots(i),this.playerUnits.add(i)})}stopDieEffectOfAllUnits(){this.enemyUnits.getChildren().forEach(e=>{e instanceof at&&e.effectController.stopDieEffect()}),this.playerUnits.getChildren().forEach(e=>{e instanceof at&&e.effectController.stopDieEffect()})}setReadyAllUnits(){let e=this.playerUnits.getChildren();e.sort((i,s)=>{if(!(i instanceof at)||!(s instanceof at))throw new se;let{currentLocation:{rowId:n,colId:r}}=i,{currentLocation:{rowId:o,colId:a}}=s;return n===o?r-a:n-o}),e.forEach(i=>{if(!(i instanceof at))throw new se;i.isDepthDirty=!0,i.actions.ready()});let t=this.enemyUnits.getChildren();t.sort((i,s)=>{if(!(i instanceof at)||!(s instanceof at))throw new se;let{currentLocation:{rowId:n,colId:r}}=i,{currentLocation:{rowId:o,colId:a}}=s;return n===o?r-a:o-n}),t.forEach(i=>{if(!(i instanceof at))throw new se;i.isDepthDirty=!0,i.actions.ready()})}removeAttackEventsOfAllUnits(){this.enemyUnits.getChildren().forEach(e=>{e instanceof at&&e.attackEvent?.remove()}),this.playerUnits.getChildren().forEach(e=>{e instanceof at&&e.attackEvent?.remove()})}getUnitBasedOnPosition(e,t){let i=null;return this.playerUnits.getChildren().forEach(s=>{if(!(s instanceof at))throw new se;s.currentLocation.rowId===e&&s.currentLocation.colId===t&&(i=s)}),i}mergeUnits(e,t){let{effectManger:i}=this.scene,s=e.level+1,n=e.unitType,r=t.currentLocation;if(s>(n===re?Fo:Go))return!1;let o=this.createUnit({level:s,unitType:n,isPlayer:!0,isMerged:!0});if(!o)return!1;i.playMergeEffect(t),si.vibrate(50),e.handleRemoveFromScene(),t.handleRemoveFromScene(),n===re&&(this.meleeSpawnPool.returnToPool(e),this.meleeSpawnPool.returnToPool(t),this.playerUnits.remove(e,!0,!1),this.playerUnits.remove(t,!0,!1)),n===Oe&&(this.rangedSpawnPool.returnToPool(e),this.rangedSpawnPool.returnToPool(t),this.playerUnits.remove(e,!0,!1),this.playerUnits.remove(t,!0,!1)),this.latestUnitMergePayload={type:n,level:s},o.spawnUnitOnSquare(r.rowId,r.colId,!0),this.playerUnits.add(o),this.resetAttackSpots(o);let{uiManager:a,spineManager:h}=this.scene;h.addSpines([o]),a.updateUIData(),this.savePlayerUnits();let l=this.checkIfNewUnitIsUnlocked(s,n);return!0}checkIfNewUnitIsUnlocked(e,t){let i=is.getGameData();if(t===Q.MELEE_UNIT_TYPE){let s=i?.meleeUnlockedUnitLevel??0;if(!s||typeof s!="number")return is.setGameData({meleeUnlockedUnitLevel:e}),!0;if(e>s)return is.setGameData({meleeUnlockedUnitLevel:e}),!0}if(t===Q.RANGED_UNIT_TYPE){let s=i?.rangedUnlockedUnitLevel??0;if(!s||typeof s!="number")return is.setGameData({rangedUnlockedUnitLevel:e}),!0;if(e>s)return is.setGameData({rangedUnlockedUnitLevel:e}),!0}return!1}reusePlayerUnits(){let e=this.playerUnits.getChildren();for(let t of e){if(!(t instanceof at))throw new se;t.reuseUnitOnReady(),this.resetAttackSpots(t)}}loadPlayerUnits(){let e=is.getGameData()?.playerUnitData??"";!e||typeof e!="string"||e.split("/").forEach((t,i)=>{t.split("-").forEach((s,n)=>{if(s==="0")return;let r=Jd;if(s[0].startsWith("m")?r=re:s[0].startsWith("r")&&(r=Oe),r===Jd)return;let o=this.createUnit({level:parseInt(s.substring(1)),isPlayer:!0,unitType:s[0].startsWith("m")?re:Oe});o.spawnUnitOnSquare(i+1,n+1,!0),this.resetAttackSpots(o),this.playerUnits.add(o)})})}checkIfBoardCanBeMerged(){let e=this.playerUnits.getChildren(),t=new Map,i=new Map;for(let r of e){if(!(r instanceof at))continue;let{level:o,unitType:a}=r;switch(a){case re:{let h=t.get(o);h?t.set(o,h+1):t.set(o,1);break}case Oe:{let h=i.get(o);h?i.set(o,h+1):i.set(o,1);break}}}let s=Array.from(t,([r,o])=>({key:r,value:o})).some(r=>{let{key:o,value:a}=r;return a>1&&o+1<=Fo}),n=Array.from(i,([r,o])=>({key:r,value:o})).some(r=>{let{key:o,value:a}=r;return a>1&&o+1<=Go});return s||n}createUnit(e){let{id:t,level:i,unitType:s,isPlayer:n,isMerged:r}=e,{fieldBackground:o}=this.scene.fieldManager,a=o.scale*$.getPixelRatio();switch(s){case Q.MELEE_UNIT_TYPE:if(t){let h=this.meleeSpawnPool.requestUnitById(t,n,r);return h.setScale(a),this.setTargetControllerForUnit(h),h}if(i){let h=this.meleeSpawnPool.requestUnitByLevel(i,n,r);return h.setScale(a),this.setTargetControllerForUnit(h),h}return this.meleeSpawnPool.requestUnitByLevel(-1,n,r);case Q.RANGED_UNIT_TYPE:if(t){let h=this.rangedSpawnPool.requestUnitById(t,n,r);return h.setScale(a),this.setTargetControllerForUnit(h),h}if(i){let h=this.rangedSpawnPool.requestUnitByLevel(i,n,r);return h.setScale(a),this.setTargetControllerForUnit(h),h}return this.rangedSpawnPool.requestUnitByLevel(-1,n,r);default:return this.meleeSpawnPool.requestUnitByLevel(-1,n,r)}}createBossUnit(e){let{fieldBackground:t}=this.scene.fieldManager,i=t.scale*$.getPixelRatio()*1.7,s=this.meleeSpawnPool.requestBossByLevel(e);return s.setScale(i),this.setTargetControllerForUnit(s),s}preparePlayerUnits(){let e=this.playerUnits.getChildren();for(let t of e){if(!(t instanceof at))throw new se;t.actions.prepare()}}enableDragOnPlayerUnits(){let e=this.playerUnits.getChildren();for(let t of e)t instanceof at&&t.startEventListener()}disableDragOnPlayerUnits(){let e=this.playerUnits.getChildren();for(let t of e)t instanceof at&&t.removeEventListener()}serializePlayerUnitData(){let e=this.playerUnits.getChildren();e.sort((s,n)=>{if(!(s instanceof at)||!(n instanceof at))throw new se;let{currentLocation:{rowId:r,colId:o}}=s,{currentLocation:{rowId:a,colId:h}}=n;return r===a?o-h:r-a});let t="",i=0;for(let s=0;s<3;s++){let n="";for(let r=0;r<5;r++){let o=i>=e.length?null:e[i];if(o instanceof at){let{rowId:a,colId:h}=o.currentLocation;if(a===s+1&&h===r+1){let l=this.createUnitDataForSaving(o);n+=l,i++}else n+="0"}else n+="0";r!==4&&(n+="-")}t+=n,s!==2&&(t+="/")}return t}createUnitDataForSaving(e){if(!e)return"0";let{unitType:t,level:i}=e;return`${t===re?"m":"r"}${i}`}savePlayerUnits(){this.scene.levelManager.isInLevelBuilderLevel()||this.scene.updateUnitData()}calculatePlayerTotalUnitsUsed(){let e=this.playerUnits.getChildren(),t=0,i=0;for(let s of e){if(!(s instanceof at))throw new se;if(s.unitType===re){let n=2**(s.level-1);t+=n}if(s.unitType===Oe){let n=2**(s.level-1);i+=n}}this.meleeSpawnPool.setSpawnedUnits(t),this.rangedSpawnPool.setSpawnedUnits(i)}getLowestLevelPlayerMeleeUnit(){let e=this.playerUnits.getChildren().filter(t=>{if(!(t instanceof at))throw new se;return t.unitType===re});return e.length===0?1:e.reduce((t,i)=>{if(!(i instanceof at))throw new se;return!t||!(t instanceof at)||i.level<t.level?i:t}).level}getLowestLevelPlayerRangedUnit(){let e=this.playerUnits.getChildren().filter(t=>{if(!(t instanceof at))throw new se;return t.unitType===Oe});return e.length===0?1:e.reduce((t,i)=>{if(!(i instanceof at))throw new se;return!t||!(t instanceof at)||i.level<t.level?i:t}).level}getUnitDataForUnlockingScreen(){let{level:e,type:t}=this.latestUnitMergePayload;return t===Q.MELEE_UNIT_TYPE?this.meleeSpawnPool.getUnitDataByLevel(e):this.rangedSpawnPool.getUnitDataByLevel(e)}resetAttackSpots(e){e.attackController.resetAttackSpots()}hideAllUnits(){let e=this.enemyUnits.getChildren();for(let i of e)i instanceof at&&(i.kill(),i.uiController.killHpBar());let t=this.playerUnits.getChildren();for(let i of t)i instanceof at&&(i.kill(),i.uiController.killHpBar())}hideAllProjectiles(){this.rangedProjectiles.killGroup()}showAllProjectiles(){this.rangedProjectiles.reviveGroup()}showAllAliveUnits(){let e=this.enemyUnits.getChildren();for(let i of e)i instanceof at&&(i.isKilled()||(i.revive(),this.scene.stateManager.isInPlayingState()||i.runFadeInAnimation()));let t=this.playerUnits.getChildren();for(let i of t)i instanceof at&&(i.isKilled()||(i.revive(),this.scene.stateManager.isInPlayingState()||i.runFadeInAnimation()))}showAllHpBarUnits(){let e=this.enemyUnits.getChildren();for(let i of e)i instanceof at&&(i.isKilled()||i.uiController.reviveHpBar());let t=this.playerUnits.getChildren();for(let i of t)i instanceof at&&(i.isKilled()||i.uiController.reviveHpBar())}getSameCoupleUnits(){let e=new Map,t=this.playerUnits.getChildren();for(let i of t){if(!(i instanceof at))throw new se;let{level:s,unitType:n}=i;if(n===Q.MELEE_UNIT_TYPE&&s>=Fo||n===Q.RANGED_UNIT_TYPE&&s>=Go)continue;let r=`${s}${n}`,o=e.get(r);if(o)return{unit1:o,unit2:i};e.set(r,i)}return null}getFirstMeleeUnit(){let e=this.playerUnits.getChildren();for(let t=0;t<e.length;t++){let i=e[t];if(!(i instanceof at))throw new se;let{unitType:s}=i;if(s===Q.MELEE_UNIT_TYPE)return i}return null}getFirstRangedUnit(){let e=this.playerUnits.getChildren();for(let t=0;t<e.length;t++){let i=e[t];if(!(i instanceof at))throw new se;let{unitType:s}=i;if(s===Q.RANGED_UNIT_TYPE)return i}return null}speedUpAllUnits(){this.scene.powerManager.isSpeedUp=!0;let e=this.enemyUnits.getChildren();for(let i of e)i instanceof at&&(i.display.setAnimationTimeScale(Tn),i.modifyCurrentAttackEvent());let t=this.playerUnits.getChildren();for(let i of t)i instanceof at&&(i.display.setAnimationTimeScale(Tn),i.modifyCurrentAttackEvent())}resetSpeedAllUnits(){this.scene.powerManager.isSpeedUp=!1;let e=this.enemyUnits.getChildren();for(let i of e)i instanceof at&&(i.display.setAnimationTimeScale(1),i.modifyCurrentAttackEvent());let t=this.playerUnits.getChildren();for(let i of t)i instanceof at&&(i.display.setAnimationTimeScale(1),i.modifyCurrentAttackEvent())}checkForPostGame(){let e=is.getGameData()?.gameCompletedCount??0;if(!jO.isNumber(e)){this.isPostGame=!1;return}this.isPostGame=e>0}setTargetControllerForUnit(e){this.isPostGame?e.setTaretControllerToPostGame():e.setTargetControllerToDefault()}handleBossSummonMinions=e=>{this.scene.stateManager.isInPlayingState()&&this.scene.renderer.once(Uo.default.Events.PRE_RENDER,()=>{let t=[{x:1,y:1},{x:1,y:5},{x:3,y:1},{x:3,y:5}],i=[];for(let n=0;n<4;n++){let r=t[n],o=this.createUnit({level:e>1?e-1:1,isPlayer:!1,unitType:re});o.summonMinionOnSquare(r.x,r.y),this.enemyUnits.add(o),this.scene.uiManager.setTotalHpBar(-o.currentHp,!1),i.push(o)}let{isSpeedUp:s}=this.scene.powerManager;this.scene.tweens.add({targets:i,alpha:{from:0,to:1},duration:s?250:500,ease:No.Sine.Out,onComplete:()=>{if(this.setReadyAllUnits(),!!this.scene.powerManager.isSpeedUp)for(let n of i)n.display.setAnimationTimeScale(Tn),n.modifyCurrentAttackEvent()}})})};handleBossSummonRangedMinions=e=>{this.scene.stateManager.isInPlayingState()&&this.scene.renderer.once(Uo.default.Events.PRE_RENDER,()=>{let t=[{x:1,y:1},{x:1,y:5},{x:3,y:1},{x:3,y:5}],i=[];for(let n=0;n<2;n++){let r=t[n],o=this.createUnit({level:e>1?e-1:1,isPlayer:!1,unitType:Oe});o.summonMinionOnSquare(r.x,r.y),this.enemyUnits.add(o),this.scene.uiManager.setTotalHpBar(-o.currentHp,!1),i.push(o)}let{isSpeedUp:s}=this.scene.powerManager;this.scene.tweens.add({targets:i,alpha:{from:0,to:1},duration:s?250:500,ease:No.Sine.Out,onComplete:()=>{if(this.setReadyAllUnits(),!!this.scene.powerManager.isSpeedUp)for(let n of i)n.display.setAnimationTimeScale(Tn),n.modifyCurrentAttackEvent()}})})};handleBossSummonAmbush=e=>{this.scene.stateManager.isInPlayingState()&&this.scene.renderer.once(Uo.default.Events.PRE_RENDER,()=>{let t=[{x:1,y:1},{x:1,y:5},{x:3,y:1},{x:3,y:5}],i=[];for(let n=0;n<2;n++){let r=t[n],o=this.createUnit({level:e>3?e-3:3,isPlayer:!1,unitType:re});o.summonMinionOnSquare(r.x,r.y,!0),this.enemyUnits.add(o),this.scene.uiManager.setTotalHpBar(-o.currentHp,!1),i.push(o)}let{isSpeedUp:s}=this.scene.powerManager;this.scene.tweens.add({targets:i,alpha:{from:0,to:1},duration:s?250:500,ease:No.Sine.Out,onComplete:()=>{if(this.setReadyAllUnits(),!!this.scene.powerManager.isSpeedUp)for(let n of i)n.display.setAnimationTimeScale(Tn),n.modifyCurrentAttackEvent()}})})}},qO=ZO,QO=U(it()),$d=U(ft()),{KEY:JO,FRAME:$O}=W.GAMEPLAY,tD=class extends QO.Container{hand;constructor(e){super(e),this.name="TapTutorialHand",this.addHand(),this.scene.add.existing(this)}addHand(){this.hand=this.scene.make.image({key:JO,frame:$O.GUIDE_HAND,origin:{x:.5,y:.5}}),this.hand.setWorldSize(65.5,55.5),this.setSize(65.5,55.5),this.add(this.hand)}playAnimation(e=0,t=800){let i=1/$.getPixelRatio();this.hand.angle=30,this.scene?.tweens.add({delay:e,targets:[this.hand],ease:$d.Cubic.Out,props:{alpha:{start:0,value:1,duration:200},scale:{duration:400,start:i*1.6,to:i*1.2},angle:{from:30,value:0,duration:400}},onComplete:()=>{this.scene?.tweens.add({targets:[this.hand],delay:200,duration:200,ease:$d.Cubic.Out,props:{alpha:0},onComplete:()=>{this.hand.x=0,this.hand.y=0,this.hand.scale=i,this.playAnimation(t)}})}})}stopAnimation(){this.scene.tweens.killTweensOf(this.hand)}preDestroy(){this.scene.tweens.killTweensOf(this.hand)}},tp=tD,xe={GUIDE_ONE:"GuideOne",GUIDE_TWO:"GuideTwo",GUIDE_PREVENT:"GuidePrevent",GUIDE_THREE:"GuideThree"},eD=class{manager;constructor(e){this.manager=e}setup(){this.startGuide()}startGuide=()=>{let{uiManager:e}=this.manager.scene;this.manager.scene.time.delayedCall(500,()=>{xt.trackTutorialStep(1)}),e.showUIForGuide1();let t=e.getStartBtnWorldPosition();this.showTapHand(t.x,t.y),e.addOnceCallbackForStartBtn(this.closeTutorial)};showTapHand(e,t){let{tapHand:i}=this.manager;i.setDepth(rt.ON_TOP),i.setPosition(e+i.width/2,t+i.height/2),i.revive(),i.stopAnimation(),i.playAnimation(300)}closeTutorial=()=>{let{uiManager:e}=this.manager.scene;this.manager.stopTutorial(),e.startFight()}},iD=eD,Fs=U(Zt()),{Plugins:{Analytics:{Events:Z5}}}=Ludex,sD=class{manager;currentStep;targetUnit1;targetUnit2;wrongUnit;constructor(e){this.manager=e,this.currentStep=0}setup(){this.startGuide()}startGuide=()=>{let{uiManager:e,unitManager:t}=this.manager.scene,i=t.getPlayerUnits(),s=i.length,n=!1;for(let o of i)if(o.level===2){n=!0;break}if(s===2&&n){this.showStep3();return}if(s>=3){this.handleOnClick();return}this.currentStep=1,this.manager.scene.giveEnoughCoins("MELEE"),e.showUIForGuide3(1);let r=e.getMeleeBlockConfig();this.createHighlightItem(r),this.showTapHand(r.worldX,r.worldY),xt.trackTutorialStep(6),e.addOnceCallbackForMeleeBlock(this.handleOnClick),this.manager.scene.input.setTopOnly(!0)};createHighlightItem(e){let{worldX:t,worldY:i,width:s,height:n}=e,r=20;this.manager.createMask(t-s/2-r,i-n/2-r,s+r*2,n+r*2)}handleOnClick=()=>{let{uiManager:e,unitManager:t}=this.manager.scene;this.currentStep=2,this.manager.scene.input.setTopOnly(!1),this.manager.background.kill(),nt.getGlobalScene()?.requestBackgroundMaskUpdate("TutorialManager",0),e.showUIForGuide3(2),this.manager.tapHand.stopAnimation(),this.manager.tapHand.kill(),xt.trackTutorialStep(7);let i=t.getSameCoupleUnits(),s=t.getFirstRangedUnit();if(!i||!s){this.showStep3();return}this.targetUnit1=i.unit2,this.targetUnit2=i.unit1,this.wrongUnit=s,this.createHint()};createHint(){let{x:e,y:t}=this.targetUnit1.getWorldPosition(),{x:i,y:s}=this.targetUnit2.getWorldPosition();this.createHandAt(e,t,i,s),this.createEvents()}createEvents(){this.targetUnit1.addOnceEvent(Fs.GAMEOBJECT_DRAG_END,this.handleOnDragEnd),this.targetUnit2.addOnceEvent(Fs.GAMEOBJECT_DRAG_END,this.handleOnDragEnd),this.wrongUnit.addOnceEvent(Fs.GAMEOBJECT_DRAG_END,this.handleOnDragEnd)}createHandAt(e,t,i,s){this.manager.hand.setDepth(rt.ON_TOP),this.manager.hand.setPosition(e,t),this.manager.hand.revive(),this.manager.hand.setTarget(i,s),this.manager.hand.stopAnimation(),this.manager.hand.playAnimation(300)}handleOnDragEnd=()=>{if(this.manager.hand.kill(),this.targetUnit1.removeOnceEvent(Fs.GAMEOBJECT_DRAG_END,this.handleOnDragEnd),this.targetUnit2.removeOnceEvent(Fs.GAMEOBJECT_DRAG_END,this.handleOnDragEnd),this.wrongUnit.removeOnceEvent(Fs.GAMEOBJECT_DRAG_END,this.handleOnDragEnd),this.targetUnit1.isKilled()||this.targetUnit2.isKilled()){xt.trackTutorialStep(8),this.showStep3();return}this.createHint()};showStep3(){let{uiManager:e}=this.manager.scene;this.currentStep=3,e.showUIForGuide3(3);let t=e.getStartBtnWorldPosition();this.showTapHand(t.x,t.y),xt.trackTutorialStep(9),e.addOnceCallbackForStartBtn(this.closeTutorial)}showTapHand(e,t){let{tapHand:i}=this.manager;i.setDepth(rt.ON_TOP),i.setPosition(e+i.width/2,t+i.height/2),i.revive(),i.stopAnimation(),i.playAnimation(300)}closeTutorial=()=>{xt.trackTutorialStep(10),this.manager.scene.time.delayedCall(500,()=>{xt.trackTutorialComplete()});let{uiManager:e}=this.manager.scene;this.currentStep=0,this.manager.stopTutorial(),e.startFight()};reupdateUI(){let{uiManager:e}=this.manager.scene;this.currentStep!==0&&e.showUIForGuide3(this.currentStep)}},nD=sD,ep=U(Zt()),rD=class{manager;currentStep;guideUnit;targetSquare;constructor(e){this.manager=e,this.currentStep=0}setup(){this.startGuide()}startGuide=()=>{let{uiManager:e,unitManager:t}=this.manager.scene;if(t.getPlayerUnits().length===2){this.showStep3();return}this.currentStep=1,this.manager.scene.giveEnoughCoins("RANGED"),e.showUIForGuide2(1);let i=e.getRangedBlockConfig();this.createHighlightItem(i),this.showTapHand(i.worldX,i.worldY),xt.trackTutorialStep(2),e.addOnceCallbackForRangedBlock(this.handleOnClickRangedBlock),this.manager.scene.input.setTopOnly(!0)};createHighlightItem(e){let{worldX:t,worldY:i,width:s,height:n}=e,r=20;this.manager.createMask(t-s/2-r,i-n/2-r,s+r*2,n+r*2)}handleOnClickRangedBlock=()=>{let{uiManager:e,unitManager:t,fieldManager:i}=this.manager.scene;this.currentStep=2,this.manager.scene.input.setTopOnly(!1),this.manager.background.kill(),nt.getGlobalScene()?.requestBackgroundMaskUpdate("TutorialManager",0),e.showUIForGuide2(2),this.manager.tapHand.stopAnimation(),this.manager.tapHand.kill(),xt.trackTutorialStep(3);let s=t.getFirstMeleeUnit(),n=i.getSquareBasedOnIndex(1,3);if(!n||!s)throw new Error("Guide fail due to target square or unit null");if(this.guideUnit=s,this.targetSquare=n,this.guideUnit.currentLocation===this.targetSquare){this.showStep3();return}this.createHint()};handleOnDragEnd=()=>{let{unitManager:e}=this.manager.scene;this.manager.hand.kill(),e.getPlayerUnits().forEach(i=>{i.removeOnceEvent(ep.GAMEOBJECT_DRAG_END,this.handleOnDragEnd)});let t=this.guideUnit.getLastDragPos();t&&(t.y<268||t.y>458||t.x<29||t.x>346)&&this.guideUnit.dragUnitOnto(1,3),this.showStep3()};showStep3(){let{uiManager:e}=this.manager.scene;this.currentStep=3,e.showUIForGuide2(3);let t=e.getStartBtnWorldPosition();this.showTapHand(t.x,t.y),xt.trackTutorialStep(4),e.addOnceCallbackForStartBtn(this.closeTutorial)}createHint(){let{unitManager:e}=this.manager.scene,{x:t,y:i}=this.guideUnit.getWorldPosition(),{x:s,y:n}=this.targetSquare.getWorldPosition();this.createHandAt(t,i,s,n),e.getPlayerUnits().forEach(r=>{r.addOnceEvent(ep.GAMEOBJECT_DRAG_END,this.handleOnDragEnd)})}createHandAt(e,t,i,s){this.manager.hand.setDepth(rt.ON_TOP),this.manager.hand.setPosition(e,t),this.manager.hand.revive(),this.manager.hand.setTarget(i,s),this.manager.hand.stopAnimation(),this.manager.hand.playAnimation(300)}showTapHand(e,t){let{tapHand:i}=this.manager;i.setDepth(rt.ON_TOP),i.setPosition(e+i.width/2,t+i.height/2),i.revive(),i.stopAnimation(),i.playAnimation(300)}closeTutorial=()=>{this.currentStep=0;let{uiManager:e}=this.manager.scene;e.startFight(),this.manager.stopTutorial()};reupdateUI(){let{uiManager:e}=this.manager.scene;this.currentStep!==0&&e.showUIForGuide2(this.currentStep)}},aD=rD,oD=class{manager;constructor(e){this.manager=e}setup(){this.startGuide()}startGuide=()=>{let{uiManager:e}=this.manager.scene;e.showUIForGuidePrevent();let t=e.getStartBtnWorldPosition();this.showTapHand(t.x,t.y),e.addOnceCallbackForStartBtn(this.closeTutorial)};showTapHand(e,t){let{tapHand:i}=this.manager;i.setDepth(rt.ON_TOP),i.setPosition(e+i.width/2,t+i.height/2),i.revive(),i.stopAnimation(),i.playAnimation(300)}closeTutorial=()=>{let{uiManager:e}=this.manager.scene;this.manager.stopTutorial(),e.startFight()};reupdateUI(){let{uiManager:e}=this.manager.scene;e.showUIForGuidePrevent()}},hD=oD,lD=U(dt()),uD=U(ft()),{Utils:{Valid:cD}}=Ludex,{player:q5}=codex,{STATUS:Yo}=Ii,{Tutorial:Ho}=Ut,{KEY:dD,FRAME:pD}=W.DEFAULT,gD=class extends ue{scene;tutorialId;lastTutorialId;tutorialsDisplayed;isAnalyticFirstSent=!0;hand;tapHand;background;maskGraphics;tutOne;tutTwo;tutPrevent;tutThree;constructor(e){super(e),this.scene=e,this.createHand(),this.createTapHand(),this.createBackground(),this.initTutorialData()}getLastTutorialId(){return this.lastTutorialId}initTutorialData(){this.tutorialId="",this.lastTutorialId="",this.tutorialsDisplayed=[]}init(){this.hand.kill(),this.tapHand.kill(),this.background.kill(),this.setState(Yo.READY)}start(){if(!this.isRunning()){if(this.isNothingToDisplay()){nt.getGlobalScene()?.requestBackgroundMaskUpdate("TutorialManager",0);return}this.setState(Yo.RUNNING)}}stop(){this.isRunning()&&(this.scene.tweens.killTweensOf([this.hand,this.tapHand,this.background]),nt.getGlobalScene()?.requestBackgroundMaskUpdate("TutorialManager",0),this.setState(Yo.STOPPED))}displayCount(e){return this.tutorialsDisplayed.filter(t=>t===e).length}hasDisplayedEnough(e){if(!Object.prototype.hasOwnProperty.call(Ho.NumberOfTutorial,e))return!0;let t=Ho.NumberOfTutorial[e];return cD.isNumber(t)?t===-1?!1:this.displayCount(e)>=t:!0}isNothingToDisplay(){let e=this.scene.levelManager.getCurrentLevelId(),t=At.getGameCompletedCount()>0;return this.scene.gameMode===Tt.BATTLE||e>=3||t?!0:Object.keys(Ho.NumberOfTutorial).filter(i=>!this.hasDisplayedEnough(i)).length<1}showTutorial(){if(!this.isRunning())return;this.isAnalyticFirstSent&&(xt.trackTutorialBegin(),this.isAnalyticFirstSent=!1);let{unitManager:e}=this.scene,t=this.scene.levelManager.getCurrentLevelId();if(t===1){if(e.getPlayerUnits().length===1&&!this.hasDisplayedEnough(xe.GUIDE_ONE)){this.startTutorial(xe.GUIDE_ONE);return}if(!this.hasDisplayedEnough(xe.GUIDE_TWO)){this.startTutorial(xe.GUIDE_TWO);return}this.startTutorial(xe.GUIDE_PREVENT)}else t===2&&this.startTutorial(xe.GUIDE_THREE)}startTutorial=e=>{if(!this.isRunning())return!1;if(this.isNothingToDisplay())return this.stop(),!1;if(this.hasDisplayedEnough(e))return!1;switch(this.background.kill(),nt.getGlobalScene()?.requestBackgroundMaskUpdate("TutorialManager",0),e){case xe.GUIDE_ONE:this.tutOne=new iD(this),this.tutOne.setup();break;case xe.GUIDE_TWO:this.tutTwo=new aD(this),this.tutTwo.setup();break;case xe.GUIDE_PREVENT:this.tutPrevent=new hD(this),this.tutPrevent.setup();break;case xe.GUIDE_THREE:this.tutThree=new nD(this),this.tutThree.setup();break;default:return!1}return this.isRunning()?(this.tutorialId=e,this.lastTutorialId=e,this.tutorialsDisplayed.push(this.tutorialId),!0):!1};reupdateGuideUI(){this.tutorialId!==""&&(this.tutorialId===xe.GUIDE_TWO?this.tutTwo.reupdateUI():this.tutorialId===xe.GUIDE_PREVENT?this.tutPrevent.reupdateUI():this.tutorialId===xe.GUIDE_THREE&&this.tutThree.reupdateUI())}stopTutorial(){this.tutorialId="",this.hand.kill(),this.tapHand.kill(),this.background.kill(),nt.getGlobalScene()?.requestBackgroundMaskUpdate("TutorialManager",0)}createHand(){this.hand=new Bc(this.scene),this.hand.kill(),this.hand.setDepth(rt.PRIORITY)}createTapHand(){this.tapHand=new tp(this.scene),this.tapHand.kill(),this.tapHand.setDepth(rt.PRIORITY)}createBackground(){this.background=this.scene.make.image({key:dD,frame:pD.BLANK}),this.background.setInteractive(),this.scene.input.setTopOnly(!1),this.background.setTint(0),this.background.setAlpha(.8),nt.getGlobalScene()?.requestBackgroundMaskUpdate("TutorialManager",.8),this.background.setDepth(rt.PRIORITY);let{displayWidth:e,displayHeight:t}=this.scene.gameZone,i=e+100,s=t+100;this.background.setDisplaySize(i,s),lD.Align.In.Center(this.background,this.scene.gameZone)}createMask(e,t,i,s,n=10){this.maskGraphics?.destroy(),this.maskGraphics=this.scene.make.graphics({fillStyle:{color:16711680,alpha:1}}),this.maskGraphics.setName("MaskGraphics"),this.maskGraphics.fillRoundedRect(e,t,i,s,n),this.background.setActive(!0),this.background.setVisible(!0),this.background.clearMask(!0),this.background.setMask(this.maskGraphics.createGeometryMask()),this.background.mask.invertAlpha=!0,this.runShowMaskAnimation()}createMultiMask(e){this.maskGraphics?.destroy(),this.maskGraphics=this.scene.make.graphics({fillStyle:{color:16711680,alpha:1}}),this.maskGraphics.setName("MaskGraphics"),e.forEach(t=>{this.maskGraphics.fillRoundedRect(t.x,t.y,t.width,t.height,t.radius)}),this.background.setVisible(!0),this.background.setActive(!0),this.background.clearMask(!0),this.background.setMask(this.maskGraphics.createGeometryMask()),this.background.mask.invertAlpha=!0,this.runShowMaskAnimation()}runShowMaskAnimation(){let e=[this.background];this.background.setAlpha(0),nt.getGlobalScene()?.requestBackgroundMaskUpdate("TutorialManager",0),this.scene.tweens.killTweensOf(e),this.scene.tweens.add({targets:e,duration:300,ease:uD.Quadratic.Out,props:{alpha:{from:0,to:.8}},onUpdate:(t,i)=>{nt.getGlobalScene()?.requestBackgroundMaskUpdate("TutorialManager",i.alpha)}})}},fD=gD,mD=U(Ka()),vD=(0,mD.default)(.48,1.57,.6,.83),Wo=vD,ED={duration:400,ease:Wo,props:{scale:"-=0.1"}},ip=ED,yD={targets:[],duration:400,ease:Wo,props:{scale:"+=0.1"}},sp=yD,TD=U(it()),SD=U(Vi()),Gs=U(Zt()),np=U(Nt()),AD=U(Ue()),xD=class extends TD.Container{useSound=!0;isClicked=!1;disabledFlag=!1;scaleUp=1;scaleDown=.985;button;upAnimation;downAnimation;isUsePixelPerfect=!1;hitArea;hitZone;hitSoundEffectKey=Et.BUTTON_CLICK;scaleDownPress;constructor(e,t,i,s,n,r=!1){super(e),this.isUsePixelPerfect=r,this.setDepth(rt.BUTTON),this.createButton(t,i,s,n),this.updateSize(),this.listenEvents(),this.scene.add.existing(this)}listenEvents(){this.scene.events.on(np.SLEEP,this.handleSceneSleep),this.once(SD.DESTROY,this.handelObjectDestroy)}handelObjectDestroy=()=>{this.scene&&this.scene.events.off(np.SLEEP,this.handleSceneSleep)};handleSceneSleep=()=>{this.scene&&this.scene.tweens.killTweensOf(this)};set onClick(e){this.hitArea?.off(Gs.GAMEOBJECT_POINTER_DOWN),this.hitArea?.off(Gs.GAMEOBJECT_POINTER_UP),this.hitArea?.off(Gs.GAMEOBJECT_POINTER_OUT),this.isUsePixelPerfect?(this.hitArea=this.button,this.hitArea.setInteractive({useHandCursor:!0,pixelPerfect:!0})):(this.hitArea=this.hitZone,this.updateSize(),this.hitArea.setInteractive({useHandCursor:!0})),this.hitArea.on(Gs.GAMEOBJECT_POINTER_DOWN,this.handlePointerDown),this.hitArea.on(Gs.GAMEOBJECT_POINTER_UP,this.handleOnClick(e)),this.hitArea.on(Gs.GAMEOBJECT_POINTER_OUT,this.handlePointerOut)}get isUsePixelPerFect(){return this.isUsePixelPerfect}getTargetScaleUp(){return this.scaleUp}getTargetScaleDown(){return this.scaleDown}setTargetScaleUp(e){this.scaleUp=e}setTargetScaleDown(e){this.scaleDown=e}handlePointerDown=()=>{this.isClicked||this.upAnimation?.isPlaying()||(this.isClicked=!0,this.runDownAnimation())};handleOnClick=e=>()=>{this.isClicked&&(this.upAnimation?.isPlaying()||(this.isClicked=!1,this.runUpAnimation(),this.upAnimation?.once(AD.TWEEN_COMPLETE,()=>{xt.trackButtonClick(this.name),this.processCallback(e)})))};handlePointerOut=()=>{this.isClicked&&(this.upAnimation?.isPlaying()||(this.isClicked=!1,this.runUpAnimation()))};processCallback(e){this.upAnimation?.stop(),this.downAnimation?.stop(),this.scene?.tweens.killTweensOf(this),this.setScale(this.scaleUp),e()}setDisabled(e){e?(this.setAlpha(.5),this.hitArea?.disableInteractive()):(this.setAlpha(1),this.hitArea?.setInteractive()),this.disabledFlag=e}get isDisabled(){return this.disabledFlag}createButton(e,t,i,s){this.button=this.scene.add.image(0,0,e,t),i&&s&&this.button.setWorldSize(i,s);let{displayWidth:n,displayHeight:r}=this.button;this.hitZone=this.scene.make.zone({width:n,height:r}),this.add([this.button,this.hitZone])}updateSize(){let{width:e,height:t}=this.button,i=10,s=e/100*10,n=t/100*10,r=s<i?s:i,o=n<i?n:i;this.setSize(e+r,t+o),this.hitZone.setSize(e+r,t+o)}runDownAnimation(){this.useSound&&ut.playSound(this.hitSoundEffectKey),this.downAnimation?.remove(),this.downAnimation=this.scene.tweens.add({...ip,targets:[this],duration:150,props:{scale:this.scaleDown},onUpdate:()=>{this.hitZone.scale=1/this.scale}}),gt.runTween(this.downAnimation)}runUpAnimation(){this.upAnimation?.remove(),this.upAnimation=this.scene.tweens.add({...sp,targets:[this],duration:150,props:{scale:this.scaleUp},onUpdate:()=>{this.hitZone.scale=1/this.scale}}),gt.runTween(this.upAnimation)}setButtonHitSoundEffect(e){this.hitSoundEffectKey=e}setScale(e,t){super.setScale(e,t);let i=e??1,s=(i+(t??i))/2;return this.scaleUp=s,this.scaleDown=s*.985,this}},Gt=xD,wD=U(dt()),RD=U(ft()),{KEY:rp,FRAME:zo}=W.GAMEPLAY,{language:Vo}=codex,CD=class extends Gt{text;constructor(e){super(e,rp,zo.DASHBOARD_START_BTN,159,63),this.setName("StartFight"),this.createText(),this.runUpAnimation()}createText(){let e=Vo.getCurrentLocale(),t=22,i=-6;switch(e){case"pt":case"es":case"ja":case"de":case"id":t=20;break;case"tr":t=20,i=-8;break;case"it":t=18}let s=Z.buildText(Vo.getText("START_FIGHT"),t).setDefaultShadow({offsetY:6}).setDefaultStroke().build(this.scene);this.add(s),wD.Align.In.Center(s,this,0,i),this.text=s}changeToDesktopFrame(){let e=Vo.getCurrentLocale(),t=15;switch(e){case"pt":case"ja":case"de":case"id":case"tr":t=13;break;case"es":case"it":t=12;break}this.button.setFrame(zo.DASHBOARD_START_BTN_LANDSCAPE),this.updateSize(),this.text.setFontSize(t),this.text.setX(15);let i=this.scene.make.image({key:rp,frame:zo.DASHBOARD_BATTLE_ICON});i.setWorldSize(26.5,23.5),i.setPosition(-45,-3),this.add(i)}setDisabled(e){super.setDisabled(e),e||this.runUpAnimation()}runUpAnimation(){this.upAnimation?.destroy(),this.upAnimation=this.scene.tweens.chain({targets:this,tweens:[{...sp,targets:[this],duration:150,props:{scale:this.scaleUp},onUpdate:()=>{this.hitZone.scale=1/this.scale}},{targets:this,yoyo:!0,repeat:-1,duration:180,ease:RD.Sine.InOut,props:{scale:{from:1,to:.95}}}]}),gt.runTween(this.upAnimation)}handleOnClick=e=>()=>{this.isClicked&&(this.isClicked=!1,xt.trackButtonClick(this.name),this.processCallback(e))};handlePointerDown=()=>{this.isClicked||(this.isClicked=!0,this.runDownAnimation())};updateSize(){let{width:e,height:t}=this.button,i=$.getPixelRatio(),s=10,n=e/100*10,r=t/100*10,o=n<s?n:s,a=r<s?r:s,h=(e+o)/i,l=(t+a)/i;this.setWorldSize(h,l),this.hitZone.setWorldSize(h,l)}},_D=CD,bD=U(it()),{KEY:PD,FRAME:LD}=W.EFFECTS,ID=class extends bD.Container{emitter;constructor(e){super(e),this.scene=e,this.createEmitters(),this.setActive(!1),this.setVisible(!1),this.scene.add.existing(this)}createEmitters(){this.emitter=this.scene.add.particles(0,0,PD,{frame:LD.FX_STAR_YELLOW,alpha:{start:1,end:.8},speed:{min:50,max:150},scale:{start:.4,end:.7},lifespan:{min:600,max:1500},emitting:!0}),this.add(this.emitter)}explode(e,t,i){this.setActive(!0),this.setVisible(!0),this.emitter.explode(e,t,i)}},MD=ID,OD=U(it()),{KEY:DD,FRAME:kD}=W.EFFECTS,BD=class extends OD.Container{emitter;constructor(e){super(e),this.scene=e,this.createEmitters(),this.setActive(!1),this.setVisible(!1)}createEmitters(){this.emitter=this.scene.add.particles(0,0,DD,{frame:kD.FX_COMET,alpha:{start:1,end:.8},speed:{min:40,max:80},scale:{start:.4,end:.7},lifespan:{min:400,max:600}}),this.add(this.emitter),this.emitter.stop()}explode(e,t,i){this.revive(),this.setPosition(t,i),this.emitter.explode(e)}},ND=BD,ap=U(it()),De=U(yt()),UD=U(Va()),FD=U(Ue()),{KEY:GD,FRAME:YD}=W.GAMEPLAY,HD=class extends ap.Container{coinGroup;containerGroup;startsExplosive;startsExplosiveSmall;startsExplosiveSmallTimer;gravity=300;constructor(e){super(e),this.setVisible(!0),this.coinGroup=this.scene.add.group({defaultKey:GD,defaultFrame:YD.DASHBOARD_COINBAR_COIN}),this.containerGroup=this.scene.add.group({classType:ap.Container}),this.startsExplosive=new MD(e),this.startsExplosive.setDepth(rt.ON_TOP+1),this.startsExplosiveSmall=new ND(e),this.startsExplosiveSmall.setDepth(rt.ON_TOP+1),this.scene.add.existing(this)}createConfigOne(e,t,i){let s=e/300,n=new De.Vector2(0,0),r=new De.Vector2(0,-e),o=i?-1:1,a=De.RND.between(-90,90),h=a<0?1:(300-Math.abs(a))/300,l=(a+90)/180*180*h*s,c=De.RND.between(20,l+20),f=new De.Vector2(1,0);f.setAngle(a*Math.PI/180);let u=De.RND.between(-Math.abs(a)-15,-Math.abs(a)+15),p=c*(100-Math.abs(a))/100*s,d=De.RND.between(p*.2,p),g=new De.Vector2(1,0);g.setAngle(u*Math.PI/180);let m=o*f.x*c,E=f.y*c,v=o*g.x*d,y=g.y*d-e,T=new De.Vector2(m,E),A=new De.Vector2(v,y),x=new UD.CubicBezier(n,T,A,r),_=De.RND.between(1500+c*3,2e3+c*3),b=this.coinGroup.get(0,0);return b.revive(),b.setRotation(-t.rotation),b.setWorldSize(24,22),t.add(b),{from:0,to:1,duration:_,ease:"Sine.In",onUpdate:M=>{let w=x.getPointAt(M.getValue());b.setPosition(w.x,w.y)},onComplete:M=>{if(b.kill(),M.totalProgress<1||(ut.playSound(Et.DIAMONDS_EAT),this.startsExplosiveSmallTimer&&!this.startsExplosiveSmallTimer.hasDispatched))return;this.startsExplosiveSmallTimer=this.scene.time.delayedCall(100,()=>null);let w=b.getWorldPosition();this.startsExplosiveSmall.explode(10,w.x,w.y)}}}explode(e,t,i,s,n){if(e<=0)return[];this.startsExplosive.explode(30,t,i);let r=new De.Vector2(s-t,n-i),o=r.length(),a=this.containerGroup.get(t,i);a.setRotation(r.angle()+Math.PI/2),a.revive(),this.add(a);let h,l=0,c=[];for(let u=0;u<e;u++){let p=this.createConfigOne(o,a,u%2===0),d=this.scene.tweens.addCounter(p);c.push(d),p.duration>l&&(l=p.duration,h=d)}let f=()=>{for(let u of c)u.complete();this.startsExplosive.emitter.killAll(),this.startsExplosiveSmall.emitter.killAll(),a.kill()};return h?.once(FD.TWEEN_COMPLETE,()=>{a.kill(),this.scene.events.off("sleep",f)}),this.scene.events.once("sleep",f),c}},WD=HD,ze=U(yt()),zD=U(Va()),VD=class extends WD{createConfigOne(e,t,i){let s=e/300,n=new ze.Vector2(0,0),r=new ze.Vector2(0,-e),o=i?-1:1,a=ze.RND.between(-90,90),h=a<0?1:(300-Math.abs(a))/300,l=(a+90)/180*180*h*s,c=ze.RND.between(20,l+20),f=new ze.Vector2(1,0);f.setAngle(a*Math.PI/180);let u=ze.RND.between(-Math.abs(a)-15,-Math.abs(a)+15),p=c*(100-Math.abs(a))/100*s,d=ze.RND.between(p*.2,p),g=new ze.Vector2(1,0);g.setAngle(u*Math.PI/180);let m=o*f.x*c,E=f.y*c,v=o*g.x*d,y=g.y*d-e,T=new ze.Vector2(m,E),A=new ze.Vector2(v,y),x=new zD.CubicBezier(n,T,A,r),_=ze.RND.between(750+c*3,1e3+c*3),b=this.coinGroup.get(0,0);return b.revive(),b.setRotation(-t.rotation),b.setWorldSize(24,22),t.add(b),{from:0,to:1,duration:_,ease:"Sine.In",onUpdate:M=>{let w=x.getPointAt(M.getValue());b.setPosition(w.x,w.y)},onComplete:M=>{if(b.kill(),M.totalProgress<1||(ut.playSound(Et.DIAMONDS_EAT),this.startsExplosiveSmallTimer&&!this.startsExplosiveSmallTimer.hasDispatched))return;this.startsExplosiveSmallTimer=this.scene.time.delayedCall(100,()=>null);let w=b.getWorldPosition();this.startsExplosiveSmall.explode(10,w.x,w.y)}}}},XD=VD,KD=U(it()),jD=U(Li()),ZD=U(it()),op=U(yt()),qD=class extends ZD.Particles.Particle{scale;update(e,t,i){let s=super.update(e,t,i);return this.updateScale(),this.updateVelocity(),s}setScale(e){this.scale=(0,op.FloatBetween)(e.min,e.max)}easeInCubic(e){return e*e*e}updateScale(){let e=this.easeInCubic(1-this.lifeT);this.scaleX=this.scale*Math.sin(e*Math.PI),this.scaleY=this.scale*Math.sin(e*Math.PI)}updateVelocity(){this.velocityX+=(0,op.Between)(-1,1)}},QD=qD,{KEY:JD,FRAME:$D}=W.EFFECTS,tk=class extends KD.Container{emitZone;emitter;constructor(e){super(e),this.scene=e,this.createEmitZone(),this.createEmitters(),this.scene.add.existing(this)}createEmitZone(){this.emitZone=new jD.Rectangle}createEmitters(){let e=1/$.getPixelRatio();this.emitter=this.scene.add.particles(0,0,JD,{frame:$D.FX_STAR_YELLOW,emitZone:{source:this.emitZone,type:"random"},frequency:200,speedX:{min:-1,max:1},speedY:{min:-9,max:-13},lifespan:{min:1e3,max:1500},scale:{min:.01,max:.015},emitCallback:t=>{t.setScale({min:e,max:e})},particleClass:QD}),this.add(this.emitter)}run(e,t,i,s,n){this.stop(),this.reset(),this.emitZone.setSize(s,n),this.setPosition(t-s/2,i-n/2),this.setSize(s,n),this.emitter.setQuantity(e),this.emitter.start()}stop(){this.emitter?.killAll(),this.emitter?.stop(),this.emitter?.destroy()}reset(){this.createEmitters()}},ek=tk,Xo=U(dt()),ik=U(ft()),sk=U(Ue()),{KEY:hp,FRAME:Pr}=W.GAMEPLAY,{ID:nk}=To.FREE_COINS,{duration:rk}=Ut.Powers.FreeCoins,{language:lp,player:Ko}=codex,ak=class extends hd{scene;lastUsedTime;collectText;remainingTimeText;glowEffect;timer;moveTween;sparkleEffect;remainingTime;originalX;originalY;constructor(e){super(e,nk,hp,Pr.DASHBOARD_FREE_GOLD,47,50),this.scene=e,this.setName("FreeCoinsItem"),this.createGlowEffect(),this.createCollectText(),this.createRemainingTimeText(),this.createSparkleEffect()}playSound(){ut.playSound(Et.COIN_SPAWN_SOUND)}createRemainingTimeText(){this.remainingTimeText=Z.buildText("00:00",13).setDefaultStroke().build(this.scene),this.remainingTimeText.setVisible(!1),this.add(this.remainingTimeText),this.bringToTop(this.remainingTimeText),Xo.Align.In.BottomCenter(this.remainingTimeText,this.icon,0,-2)}createCollectText(){let e=11;switch(lp.getCurrentLocale()){case"es":case"pt":e=10;break;case"de":case"it":e=9;break}this.collectText=Z.buildText(lp.getText("COLLECT").toUpperCase(),e).setDefaultStroke().build(this.scene),this.collectText.setVisible(!1),this.add(this.collectText),this.bringToTop(this.collectText),Xo.Align.In.BottomCenter(this.collectText,this.icon,0,-2)}createGlowEffect(){this.glowEffect=this.scene.add.image(0,0,hp,Pr.DASHBOARD_FREE_GOLD_GLOW),this.glowEffect.setOrigin(0,0),this.glowEffect.setVisible(!1),this.glowEffect.setWorldSize(127.5,124.8),this.add(this.glowEffect),this.moveDown(this.glowEffect),this.moveUp(this.icon),Xo.Align.In.Center(this.glowEffect,this,1,0)}createSparkleEffect(){this.sparkleEffect=new ek(this.scene),this.sparkleEffect.setDepth(rt.ON_TOP)}enableItem(){this.visible&&this.isDisabled!==!1&&(this.isDisabled=!1,this.zone.setInteractive(),this.setAvailable(!0))}activeItem=()=>{if(this.isActive===!0||this.isDisabled===!0)return;this.isActive=!0;let{powerManager:e}=this.scene;e.isStopped()||(ut.playSound(Et.BUTTON_CLICK),this.activeLogic())};activeLogic(){this.rewardCoins()}disableItem(){this.isDisabled!==!0&&(this.zone.disableInteractive(),this.setAvailable(!1),this.isDisabled=!0)}deactivateItem=()=>{if(this.isActive===!1)return;this.isActive=!1;let{powerManager:e}=this.scene;e.isStopped()||this.deactivateLogic()};deactivateLogic(){this.stopTimer()}startCountdown(){if(this.stopTimer(),this.initRemainingWaitTime(),this.remainingTime===0){this.setAvailable(!0),this.enableItem();return}this.startTimer()}startTimer(){this.setRemainingTime(this.remainingTime),this.disableItem(),this.timer=this.scene.time.addEvent({delay:1e3,callback:this.timerCallback,loop:!0})}timerCallback=()=>{this.scene.scene.isPaused()||(this.remainingTime<2e3?(this.remainingTime=0,this.setRemainingTime(0),this.enableItem(),this.stopTimer()):(this.remainingTime-=1e3,this.setRemainingTime(this.remainingTime),this.disableItem()))};stopTimer(){this.timer?.remove()}initRemainingWaitTime(){if(!this.lastUsedTime){let i=Ko.getGameData()?.freeCoinsLastUsedTime??-1;this.lastUsedTime=typeof i=="number"?i:-1}if(this.lastUsedTime<0){this.remainingTime=0;return}let e=Date.now(),t=rk-(e-this.lastUsedTime);this.remainingTime=t>0?t:0}rewardCoins=()=>{let e=Date.now(),t=Ko.getGameData();Ko.setGameData({...t,freeCoinsLastUsedTime:e}),this.lastUsedTime=e;let{layoutManager:i,powerManager:s}=this.scene,n=this.calculateRewardCoins(),r=new XD(this.scene),{x:o,y:a}=i.objects.coinBar;r.setDepth(rt.ON_TOP);let h=r.explode(10,this.x,this.y,o,a);for(let l of h)l.once(sk.TWEEN_COMPLETE,()=>{let c=n.clone();c.divide(10),_t.inst.addCoin(c),this.scene.updateUI()});this.scene.time.delayedCall(600,()=>{ut.playSound(Et.COIN_INCREASE_REPEATEDLY_SOUND)}),s.updateTimers()};getUnitLevelModifier(){let e=this.scene.getBuyingUnitLevel(),t=1;switch(e){case 1:t=6;break;case 2:t=4;break;case 3:t=2;break;default:break}return t+.5}calculateRewardCoins(){let{unitManager:e,coinManager:t}=this.scene,i=e.getPlayerMeleeSpawnedUnitsCount(),s=e.getPlayerRangedSpawnedUnitsCount(),n=t.getUnitPrice(i),r=t.getUnitPrice(s),o=this.getUnitLevelModifier(),a=r.biggerThan(n)?r:n;return a.multiply(o),a}setAvailable(e){this.collectText.setVisible(e),this.remainingTimeText.setVisible(!e),this.glowEffect.setVisible(e),this.icon.setFrame(e?Pr.DASHBOARD_FREE_GOLD:Pr.DASHBOARD_FREE_GOLD_OFF),e?(this.setVisible(!0),this.runMoveTween()):(this.stopMoveTween(),this.sparkleEffect.stop())}setRemainingTime(e){let t=Math.floor(e/1e3),i=Math.floor(t/60),s=t%60,n=s<10?`0${s}`:s.toString();this.remainingTimeText.setText(`${i}:${n}`)}runMoveTween(){this.stopMoveTween();let e=-2;this.moveTween=this.scene.tweens.add({targets:[this],duration:500,repeat:-1,ease:ik.Sine.InOut,props:{y:"-=2"},onStart:()=>{let t=this.scene.levelManager.currentLevelId<3;if(!this.originalX||!this.originalY){if(t)return;this.originalX=this.x,this.originalY=this.y}this.setPosition(this.originalX,this.originalY)},onStop:()=>{this.setPosition(this.originalX,this.originalY)},onRepeat:()=>{e=-e,this.moveTween.updateTo("y",this.originalY+e,!0),this.moveTween.data[0].duration=1e3}})}stopMoveTween(){this.moveTween?.stop(),this.moveTween?.remove()}setVisible(e){return e||this.sparkleEffect.stop(),e&&this.remainingTime<1e3&&this.sparkleEffect.run(1,this.x,this.y-2.5,this.width,this.height+5),super.setVisible(e)}},ok=ak,hk=U(it()),{KEY:lk,FRAME:uk}=W.DEFAULT_8_BIT,ck=class extends hk.Image{anim;constructor(e){super(e,0,0,lk,uk.PRELOADER),this.runAnimation(),this.scene.add.existing(this)}runAnimation(){this.anim=this.scene.tweens.add({targets:this,props:{angle:{from:0,to:360}},duration:1200,repeat:-1})}setVisible(e){return super.setVisible(e),e?this.runAnimation():(this.anim.stop(),this.scene.tweens.remove(this.anim)),this}},Sn=ck,dk=U(it()),pk=U(dt()),up=U(ci()),gk=U(Vi()),{KEY:fk,FRAME:mk}=W.DEFAULT_8_BIT,vk=class extends dk.Container{payload;loading;photo;avtFrame;loadPhotoTimer;constructor(e,t){super(e),this.scene.add.existing(this),this.payload=t;let{size:i}=this.payload;this.setSize(i,i),this.createLoading(),this.createPhoto(),this.createFrame(),this.addDefaultListeners()}loadPhoto(e,t){if(this.payload.id=e,this.payload.url=t,this.loadPhotoTimer?.remove(),!e||!t){this.setPhoto(j.AVATAR_DEFAULT.KEY);return}let i=this.scene.textures.get(e);if(i&&i.key===e){this.handleLoadComplete(e);return}this.showLoading(!0);let{loadDelay:s=0}=this.payload||{};this.loadPhotoTimer=this.scene.time.delayedCall(s,this.handleLoadPhotoAfterDelay(e,t))}handleLoadPhotoAfterDelay=(e,t)=>()=>{let i=this.scene.textures.get(e);if(i&&i.key===e){this.handleLoadComplete(e);return}this.scene.load.once(`filecomplete-image-${e}`,this.handleLoadComplete),this.scene.load.image(e,t),this.scene.load.start()};addDefaultListeners(){this.scene.load.on(up.FILE_LOAD_ERROR,this.handleLoadPhotoFailed),this.on(gk.DESTROY,()=>{this.loadPhotoTimer?.remove(),this.scene.load.off(up.FILE_LOAD_ERROR,this.handleLoadPhotoFailed)})}handleLoadComplete=e=>{if(!this.scene)return;let{id:t}=this.payload;if(!t||t!==e)return;let i=`${t}_bordered_100`,s=this.scene.textures.get(i);if(s&&s.key===i){this.setPhoto(s.key);return}this.showLoading(!1)};handleLoadPhotoFailed=e=>{e.key===this.payload.id&&this.setDefaultAvatar(e.key)};setDefaultAvatar(e){this.loadPhoto(e,j.AVATAR_DEFAULT.FILE)}createLoading(){this.loading=new Sn(this.scene),this.loading.setWorldSize(this.width*.75,this.height*.75),this.loading.setVisible(!1),this.add(this.loading)}createPhoto(){this.photo=this.scene.make.image({x:0,y:0,origin:{x:.5,y:.5},visible:!1}),this.add(this.photo)}createFrame(){this.avtFrame=this.scene.make.image({key:fk,frame:mk.LEADERBOARD_AVATAR}),this.avtFrame.setWorldSize(34,38),this.add(this.avtFrame)}showLoading(e){this.photo.setVisible(!e),this.loading.setVisible(e)}setPhoto(e){this.showLoading(!1),this.photo.setTexture(e),this.photo.setFrame(0);let{size:t}=this.payload,i=t-10;this.photo.setWorldSize(i,i),pk.Align.In.Center(this.photo,this.avtFrame,0,-2)}},cp=vk,Ek=class extends cp{constructor(e){super(e,{size:38}),this.avtFrame.kill()}handleLoadComplete=e=>{if(!this.scene)return;let{id:t}=this.payload;if(!t||t!==e)return;let i=t,s=this.scene.textures.get(i);if(s&&s.key===i){this.setPhoto(s.key);return}this.setPhoto(j.AVATAR_DEFAULT.KEY)}},yk=Ek,Tk=U(it()),{KEY:Sk,FRAME:dp}=W.GAMEPLAY,Ak=class extends Tk.Container{bg;avatar;level;constructor(e,t){super(e),this.setName("PlayerCard"),this.createAvatar(),this.createFrame(t),this.updateSize(),this.createLevelText(),this.scene.add.existing(this)}updateData(e){let{playerId:t,playerPhoto:i,playerLevel:s}=e;this.level.setText(`Lv. ${s}`),this.avatar.loadPhoto(t,i)}createFrame(e){let t=e?dp.DASHBOARD_AVATAR_FRAME_BLUE:dp.DASHBOARD_AVATAR_FRAME_RED,i=this.scene.make.image({key:Sk,frame:t});i.setName("bg"),i.setWorldSize(35.5,48.5),this.add(i),this.bg=i}updateSize(){this.setSize(this.bg.displayWidth,this.bg.displayHeight)}createAvatar(){let e=new yk(this.scene);e.setName("avatar"),e.setPosition(0,-4),this.add(e),this.avatar=e}createLevelText(){let e=Z.createText(this.scene,"Lv. 1",8);e.setPosition(0,14),this.add(e),this.level=e}},pp=Ak,xk=U(it()),{KEY:wk,FRAME:Rk}=W.GAMEPLAY,Ck=class extends xk.Container{playerFrame;opponentFrame;VS;constructor(e){super(e),this.createPlayerFrame(),this.createOpponentFrame(),this.createVS(),this.setDepth(rt.BUTTON),this.scene.add.existing(this)}createPlayerFrame(){this.playerFrame=new pp(this.scene,!0),this.playerFrame.setName("playerFrame"),this.add(this.playerFrame),this.playerFrame.setPosition(28,0)}createOpponentFrame(){this.opponentFrame=new pp(this.scene,!1),this.opponentFrame.setName("opponentFrame"),this.add(this.opponentFrame),this.opponentFrame.setPosition(-28,0)}createVS(){this.VS=this.scene.make.image({key:wk,frame:Rk.DASHBOARD_VS}),this.VS.setWorldSize(17,14),this.VS.setName("VS"),this.add(this.VS)}updateData(e,t){e&&this.playerFrame.updateData(e),t&&this.opponentFrame.updateData(t)}changeToDesktopFrame(){this.playerFrame.setPosition(200/this.scale,60/this.scale),this.opponentFrame.setPosition(-200/this.scale,-225/this.scale),this.VS.kill()}},_k=Ck,bk=U(it()),gp=U(dt()),{KEY:fp,FRAME:mp}=W.GAMEPLAY,{language:Pk}=codex,Lk=class extends bk.Container{bar;coinText;constructor(e){super(e),this.createBar(),this.createText(),this.createCoinIcon(),this.setDepth(rt.BUTTON),this.scene.add.existing(this)}createBar(){this.bar=this.scene.make.image({key:fp,frame:mp.DASHBOARD_COINBAR_BG}),this.add(this.bar)}createCoinIcon(){let e=this.scene.make.image({key:fp,frame:mp.DASHBOARD_COINBAR_COIN});this.add(e),gp.Align.In.RightCenter(e,this,55,0)}createText(){let e=Pk.getCurrentLocale(),t=17;switch(e){case"tr":t=19;break}this.coinText=Z.createText(this.scene,"0",t),this.add(this.coinText),gp.Align.In.Center(this.coinText,this.bar,-5,0)}setCoins(e){this.coinText.setText(`${e.toString()}`)}},Ik=Lk,Mk=U(it()),{MaxLevel:Ok}=Ut,{language:vp}=codex,Dk=class extends Mk.Container{text;constructor(e){super(e),this.createText(),this.setDepth(rt.BUTTON),this.scene.add.existing(this)}createText(){this.text=Z.buildText("").setDefaultShadow({offsetY:3}).setDefaultStroke().build(this.scene),this.add(this.text)}setLevel(e){let t=nt.getCurrentScene();if(t instanceof Zo&&t.gameMode===Tt.BOSS){let s=t.levelManager.getPlayerBossLevel();this.text.setText(vp.getText("BOSS_LEVEL",[`${s}`]).toUpperCase());return}let i=At.getGameCompletedCount();this.text.setText(`${vp.getText("LEVEL").toUpperCase()} ${e+i*Ok}`)}},kk=Dk,{KEY:Lr,FRAME:Ir}=W.GAMEPLAY,Bk=class extends vd{front;iconImage;constructor(e){super(e,0),this.updateHealthBar(),this.setFrameSize(94.5,11.5),this.createIconImage()}updateHealthBar(){this.bg.setTexture(Lr),this.bg.setFrame(Ir.DASHBOARD_HPBAR_BG),this.frame.setTexture(Lr),this.frame.setFrame(Ir.DASHBOARD_HPBAR_RED),this.frame.setOrigin(1,.5),this.frame.setX(0);let e=this.scene.make.image({key:Lr,frame:Ir.DASHBOARD_HPBAR_FRONT,origin:{x:0,y:.5}});e.setWorldSize(this.hpLength,this.hpHeight),e.setX(-this.hpLength/2),this.add(e),this.front=e}createIconImage(){this.iconImage=this.scene.add.image(0,0,Lr,Ir.DASHBOARD_HPBAR_RED_HEART),this.iconImage.setWorldSize(20,19),this.iconImage.setX(-this.hpLength/2-this.iconImage.displayWidth/2+8),this.iconImage.setAngle(90),this.add(this.iconImage)}setFrameSize(e,t){this.hpLength=e,this.hpHeight=t,this.bg.setWorldSize(this.hpLength,this.hpHeight),this.bg.setX(-this.hpLength/2),this.front.setWorldSize(this.hpLength,this.hpHeight),this.front.setX(-this.hpLength/2),this.updateFrameUI(),this.frame.setX((-this.hpLength+2)/2)}updateFrameUI(){let e=this.currentHp/this.defaultHp*(-this.hpLength+2),t=Math.abs(e)>1?e:1;this.frame.setWorldSize(t,this.hpHeight-1)}},Ep=Bk,{FRAME:yp}=W.GAMEPLAY,Nk=class extends Ep{updateHealthBar(){super.updateHealthBar(),this.frame.setFrame(yp.DASHBOARD_HPBAR_BLUE)}createIconImage(){super.createIconImage(),this.iconImage.setFrame(yp.DASHBOARD_HPBAR_BLUE_HEART)}},Uk=Nk,Fk=U(it()),Gk=class extends Fk.Container{scene;playerHpBar;enemyHpBar;constructor(e){super(e),this.scene=e,this.setDepth(rt.BUTTON),this.createPlayerHpBar(),this.createEnemyHpBar(),this.setSize(300,200),this.init(),this.scene.add.existing(this)}init(){this.enemyHpBar.setInitHp(1),this.playerHpBar.setInitHp(1)}createPlayerHpBar(){this.playerHpBar=new Uk(this.scene),this.playerHpBar.setAngle(-90),this.playerHpBar.setPosition(175,50),this.add(this.playerHpBar)}createEnemyHpBar(){this.enemyHpBar=new Ep(this.scene),this.enemyHpBar.setAngle(-90),this.enemyHpBar.setPosition(-175,-160),this.add(this.enemyHpBar)}updateCurrentHp(){this.updateCurrentEnemyHp(),this.updateCurrentPlayerHp()}updateCurrentPlayerHp(){let e=this.scene.unitManager.getTotalPlayerUnitsHp();this.playerHpBar.setInitHp(e)}updatePlayerHpUIByMinus(e){this.playerHpBar.updateHpUIByMinus(e)}getCurrentPlayerHp(){return this.playerHpBar.getCurrentHp()}updateCurrentEnemyHp(){let e=this.scene.unitManager.getTotalEnemyUnitsHp();this.enemyHpBar.setInitHp(e)}updateEnemyHpUIByMinus(e){this.enemyHpBar.updateHpUIByMinus(e)}getCurrentEnemyHp(){return this.enemyHpBar.getCurrentHp()}},Yk=Gk,Hk=U(it()),Ys=U(dt()),Tp=U(Zt()),{KEY:An,FRAME:Ai}=W.GAMEPLAY,{language:ss}=codex,Wk=class extends Hk.Container{isDisable=!1;block;clickZone;adsBanner;unitImage;priceText;coinIcon;stampText;stampBanner;adsMode=!1;constructor(e,t,i){super(e),this.createBlock(),this.createZone(),this.updateSize(),this.createUnitImage(t),this.createPriceText(i),this.createMiniCoinIcon(),this.createAdsBanner()}updateSize(){let{displayWidth:e,displayHeight:t}=this.block;this.setSize(e,t)}createBlock(){this.block=this.scene.add.image(0,0,An,Ai.DASHBOARD_UNITBAR_BG),this.block.setWorldSize(71,77),this.add(this.block)}createZone(){let e=this.block.displayWidth,t=39/1.7,i=$.isLandscape()?0:t,s=this.block.displayHeight+i,n=.5-i/s/2;this.clickZone=this.scene.add.zone(0,0,e,s),this.clickZone.setOrigin(.5,n),this.add(this.clickZone)}getStampTextFontSize(){switch(ss.getCurrentLocale()){case"pt":case"es":case"ja":case"zh":case"fr":case"id":case"de":case"it":return 12;case"tr":return 14;default:return 16}}getAdsTextFontSize(){switch(ss.getCurrentLocale()){case"pt":case"es":case"tr":case"ja":case"zh":case"fr":case"id":case"it":return 12;default:return 11}}createStampsBanner(){if(this.stampText)return;let e=this.scene.make.container({});this.stampBanner=e;let t=this.scene.make.image({key:An,frame:Ai.DASHBOARD_UNITBAR_STAMPS});t.setWorldSize(64,39),e.setSize(64,39),e.add(t);let i=Z.buildText(ss.getText("BUY").toUpperCase(),this.getStampTextFontSize()).setDefaultStroke().setDefaultShadow({offsetY:2}).build(this.scene);i.setY(-2),e.add(i),this.stampText=i,Ys.Align.In.BottomCenter(e,this.block,0,26),this.add(e)}createAdsBanner(){let e=this.scene.make.image({key:An,frame:Ai.DASHBOARD_AD_ICON});e.setOrigin(1,0),e.setDisplaySize(33,33),e.setPosition(this.block.x+this.block.displayWidth/2,this.block.y-this.block.displayHeight/2),this.add(e),e.kill(),this.adsBanner=e}createUnitImage(e){if(this.unitImage=this.scene.add.image(0,0,An),e===Q.MELEE_UNIT_TYPE){let t=Ai.DASHBOARD_UNITBAR_DINO;this.unitImage.setFrame(t),this.unitImage.setDisplaySize(49,37.5)}else{let t=Ai.DASHBOARD_UNITBAR_ARCHER;this.unitImage.setFrame(t),this.unitImage.setDisplaySize(35,43)}Ys.Align.In.Center(this.unitImage,this.block,0,-10),this.add(this.unitImage)}createPriceText(e){let t=ss.getCurrentLocale(),i=18;switch(t){case"tr":i=16;break}this.priceText=Z.buildText(e.toString(),15).setDefaultStroke().build(this.scene),Ys.Align.In.Center(this.priceText,this.block,8,i),this.add(this.priceText)}createMiniCoinIcon(){let e=this.scene.make.image({key:An,frame:Ai.DASHBOARD_MINI_COIN});this.add(e),e.setDisplaySize(12.5,13.5),Ys.Align.In.Center(e,this,-22,20),this.coinIcon=e}setImage(e){this.unitImage.setTexture(e)}setPrice(e){let t=e.toString();this.priceText.setText(`${t}`)}set onClick(e){this.clickZone.setInteractive({useHandCursor:!0}),this.clickZone.on(Tp.GAMEOBJECT_POINTER_DOWN,()=>{this.logButtonEvent(),e(),si.vibrate(50)})}set onceClick(e){this.clickZone.setInteractive({useHandCursor:!0}),this.clickZone.once(Tp.GAMEOBJECT_POINTER_DOWN,()=>{this.logButtonEvent(),e()})}setAdsMode(e){this.adsMode=e,this.adsBanner.setVisible(e),this.priceText.setVisible(!e),this.coinIcon.setVisible(!e);let t=this.block.frame.name===Ai.DASHBOARD_UNITBAR_BG_LANDSCAPE;if(e)this.stampText&&(this.stampText.setFontSize(this.getAdsTextFontSize()),this.stampText.setText(ss.getText("FREE").toUpperCase())),Ys.Align.In.Center(this.unitImage,this.block,0,0);else{this.stampText&&(this.stampText.setFontSize(this.getStampTextFontSize()),this.stampText.setText(ss.getText("BUY").toUpperCase()));let i=t?-6:-10;Ys.Align.In.Center(this.unitImage,this.block,0,i)}}setDisabled(e){e!==this.isDisable&&(this.setAlpha(e?.5:1),this.isDisable=e)}isDisabled(){return this.isDisable}logButtonEvent(){let e=this.name;xt.trackButtonClick(e)}changeToDesktopFrame(){let e=ss.getCurrentLocale(),t=7.5;switch(e){case"tr":t=5.5;break}this.block.setFrame(Ai.DASHBOARD_UNITBAR_BG_LANDSCAPE),this.clickZone.setSize(this.block.displayWidth,this.block.displayHeight),this.adsBanner.setFrame(Ai.DASHBOARD_AD_ICON_LANDSCAPE),this.adsBanner.setPosition(this.block.x+this.block.displayWidth/2,this.block.y-this.block.displayHeight/2);let i=1/$.getPixelRatio();this.unitImage.setOrigin(.5,.45),this.unitImage.setScale(i/2),this.priceText.setFontSize(10),this.priceText.setPosition(8,t),this.coinIcon.setPosition(-15,8),this.coinIcon.setScale(i/1.2),this.updateSize(),this.stampBanner&&this.stampBanner.kill()}},Sp=Wk,zk=U(it()),Ap=U(Cs()),{Plugins:{Ads:{Types:{REWARDED_VIDEO:Mr}}}}=Ludex,Vk=class extends zk.Container{scene;bg;meleeBlock;rangedBlock;adChangeMeleeTimer;adChangeRangedTimer;constructor(e){super(e),this.scene=e,this.createBg(),this.createMeleeBlock(),this.createRangedBlock(),this.setDepth(rt.BUTTON),this.scene.add.existing(this)}createStampsBanner(){this.meleeBlock.createStampsBanner(),this.rangedBlock.createStampsBanner()}setMeleePrice(e){this.meleeBlock.setPrice(e)}setRangedPrice(e){this.rangedBlock.setPrice(e)}createBg(){this.bg=this.scene.make.image({key:W.DEFAULT.KEY,frame:W.DEFAULT.FRAME.DASHBOARD_UNITBAR_BOTTOM_BG}),this.bg.setWorldSize(375,195),this.bg.setY(52),this.add(this.bg)}getGapFromContainerCenterToBottomBg(){return this.bg.y+this.bg.displayHeight/2}isBgHigherBottom(){let{height:e}=$.getWorldSize();return this.bg.getWorldPosition().y+this.bg.displayHeight/2<e/2}createMeleeBlock(){this.meleeBlock=new Sp(this.scene,Q.MELEE_UNIT_TYPE,999),this.meleeBlock.setName("BuyMeleeUnit"),this.meleeBlock.setPosition(39,0),this.add(this.meleeBlock),this.meleeBlock.onClick=this.buyMeleeUnit}buyMeleeUnit=()=>{let{effectManger:e}=this.scene;this.checkIfFullBoard()&&e.playFullFloatText(),!e.isRewardCurveAnimationRunning()&&(this.meleeBlock.isDisable||this.scene.renderer.once(Ap.default.Events.PRE_RENDER,()=>{this.scene.handleSpawnMelee()}))};buyRangedUnit=()=>{let{effectManger:e}=this.scene;this.checkIfFullBoard()&&(e.playFullFloatText(),this.rangedBlock.setName("BuyRangedUnit"),this.rangedBlock.setAdsMode(!1)),!e.isRewardCurveAnimationRunning()&&(this.rangedBlock.isDisable||this.scene.renderer.once(Ap.default.Events.PRE_RENDER,()=>{this.scene.handleSpawnRanged()}))};createRangedBlock(){this.rangedBlock=new Sp(this.scene,Q.RANGED_UNIT_TYPE,999),this.meleeBlock.setName("BuyRangedUnit"),this.rangedBlock.setPosition(-39,0),this.add(this.rangedBlock),this.rangedBlock.onClick=this.buyRangedUnit}setMeleeAdsMode(e){if(e&&this.scene.tutorialManager.isRunning()){this.disableMeleeBlock();return}let t=this.adChangeMeleeTimer&&this.adChangeMeleeTimer.getProgress()<1,{adsMode:i}=this.meleeBlock;if(e){if(e===i){wt.isReadyAdShowable(Mr)||this.disableMeleeBlock();return}if(this.disableMeleeBlock(),t)return;this.adChangeMeleeTimer=this.scene.time.delayedCall(2e3,()=>{if(this.meleeBlock){let s=wt.isReadyAdShowable(Mr),n=this.delayedAdMeleePriceCheck();if(this.checkIfFullBoard()||!s){this.disableMeleeBlock(),this.meleeBlock.setName("BuyMeleeUnit"),this.meleeBlock.setAdsMode(!1);return}else this.enableMeleeBlock();if(!n){this.meleeBlock.setAdsMode(!1);return}this.meleeBlock.setName("ViewAdMeleeUnit"),this.meleeBlock.setAdsMode(!0)}});return}this.adChangeMeleeTimer?.destroy(),this.enableMeleeBlock(),this.meleeBlock.setName("BuyMeleeUnit"),this.meleeBlock.setAdsMode(e)}disableMeleeBlock(){this.meleeBlock.setDisabled(!0)}enableMeleeBlock(){this.meleeBlock.setDisabled(!1)}killMeleeBlock(){this.meleeBlock.kill()}reviveMeleeBlock(){this.meleeBlock.revive()}setRangedAdsMode(e){if(e&&this.scene.tutorialManager.isRunning()){this.disableRangedBlock();return}let t=this.adChangeRangedTimer&&this.adChangeRangedTimer.getProgress()<1,{adsMode:i}=this.rangedBlock;if(e){if(e===i){wt.isReadyAdShowable(Mr)||this.disableRangedBlock();return}if(this.disableRangedBlock(),e&&t)return;this.adChangeRangedTimer=this.scene.time.delayedCall(2e3,()=>{if(this.rangedBlock){let s=wt.isReadyAdShowable(Mr),n=this.delayedAdRangedPriceCheck();if(this.checkIfFullBoard()||!s){this.disableRangedBlock(),this.rangedBlock.setName("BuyRangedUnit"),this.rangedBlock.setAdsMode(!1);return}else this.enableRangedBlock();if(!n){this.rangedBlock.setAdsMode(!1);return}this.rangedBlock.setName("ViewAdRangedUnit"),this.rangedBlock.setAdsMode(!0)}});return}this.adChangeRangedTimer?.destroy(),this.enableRangedBlock(),this.rangedBlock.setName("BuyRangedUnit"),this.rangedBlock.setAdsMode(e)}checkIfFullBoard(){let{fieldManager:e}=this.scene;return e.getRemainingAvailablePlacement()===0}delayedAdMeleePriceCheck(){let{unitManager:e,coinManager:t}=this.scene,i=_t.inst.getCoin(),s=e.getPlayerMeleeSpawnedUnitsCount(),n=t.getUnitPrice(s),r=i.toString(),o=n.toString();return n.biggerThan(i)&&r!==o}delayedAdRangedPriceCheck(){let{unitManager:e,coinManager:t}=this.scene,i=_t.inst.getCoin(),s=e.getPlayerRangedSpawnedUnitsCount(),n=t.getUnitPrice(s),r=i.toString(),o=n.toString();return n.biggerThan(i)&&r!==o}disableRangedBlock(){this.rangedBlock.setDisabled(!0)}enableRangedBlock(){this.rangedBlock.setDisabled(!1)}killRangedBlock(){this.rangedBlock.kill()}reviveRangedBlock(){this.rangedBlock.revive()}disableUnitBlocks(){this.meleeBlock.setDisabled(!0),this.rangedBlock.setDisabled(!0)}disableAdsForBlocks(){this.meleeBlock.setName("BuyMeleeUnit"),this.rangedBlock.setName("BuyRangedUnit"),this.meleeBlock.setAdsMode(!1),this.rangedBlock.setAdsMode(!1)}addOnceClickEventForMeleeBlock(e){this.meleeBlock.onceClick=e}addOnceClickEventForRangedBlock(e){this.rangedBlock.onceClick=e}getMeleeBlockConfig(){let{x:e,y:t}=this.meleeBlock.getWorldPosition(),{width:i,height:s}=this.meleeBlock,n=$.isLandscape()?0:10;return{worldX:e,worldY:t+n,width:i*this.scaleX,height:s*this.scaleY}}getRangedBlockConfig(){let{x:e,y:t}=this.rangedBlock.getWorldPosition(),{width:i,height:s}=this.rangedBlock,n=$.isLandscape()?0:10;return{worldX:e,worldY:t+n,width:i*this.scaleX,height:s*this.scaleY}}killBg(){this.bg.kill()}reviveBg(){this.bg.revive()}changeToDesktopFrame(){this.bg.kill(),this.rangedBlock.changeToDesktopFrame(),this.meleeBlock.changeToDesktopFrame(),this.meleeBlock.setPosition(36,0),this.rangedBlock.setPosition(-36,0)}},Xk=Vk,Kk=class{scene;group;constructor(e){this.scene=e,this.createGroup()}getAll(){return this.group.getChildren()}createGroup(){this.group=this.scene.add.group()}},jk=Kk,{KEY:xn,FRAME:wn}=W.GAMEPLAY,Zk=class extends jk{scene;coinBar;unitBar;levelBar;totalHpBar;startButton;settingsButton;battleLevelBar;freeCoinsItem;unitModButton;resetLevelButton;selectLevelButton;currentUnitModText;currentUnitModButton;currentAttackModText;currentAttackModButton;constructor(e){super(e),this.scene=e,this.createObjects()}getAll(){return this.group.getChildren()}createObjects(){this.createCoinBar(),this.createUnitBar(),this.createLevelBar(),this.createTotalHpBar(),this.createStartButton(),this.createBattleLevelBar(),this.createSettingsButton(),this.createFreeCoinsItem(),this.createDevTools()}createCoinBar(){this.coinBar=new Ik(this.scene),this.group.add(this.coinBar)}createUnitBar(){this.unitBar=new Xk(this.scene),this.group.add(this.unitBar)}createLevelBar(){this.levelBar=new kk(this.scene),this.group.add(this.levelBar)}createTotalHpBar(){this.totalHpBar=new Yk(this.scene),this.group.add(this.totalHpBar)}createStartButton(){this.startButton=new _D(this.scene),this.group.add(this.startButton)}createBattleLevelBar(){this.battleLevelBar=new _k(this.scene),this.group.add(this.battleLevelBar)}createSettingsButton(){this.settingsButton=new Gt(this.scene,xn,wn.DASHBOARD_SETTINGS_BTN,32.5,39),this.group.add(this.settingsButton),this.settingsButton.setName("Settings")}createFreeCoinsItem(){this.freeCoinsItem=new ok(this.scene),this.group.add(this.freeCoinsItem)}createDevTools(){Ludex.Utils.Valid.isDebugger()&&(this.createResetLevelButton(),this.createSelectLevelButton(),this.createUnitModButton(),this.createAttackModButton())}createResetLevelButton(){this.resetLevelButton=new Gt(this.scene,xn,wn.TOOL_RESET,40,35),this.group.add(this.resetLevelButton),this.resetLevelButton.setName("Reset")}createSelectLevelButton(){this.selectLevelButton=new Gt(this.scene,xn,wn.TOOL_EDIT,40,40),this.group.add(this.selectLevelButton),this.selectLevelButton.setName("Select"),this.selectLevelButton.setAngle(90)}createUnitModButton(){this.currentUnitModButton=new Gt(this.scene,xn,wn.TOOL_UNIT,40,38.5),this.group.add(this.currentUnitModButton),this.currentUnitModButton.setName("UnitMod"),this.currentUnitModText=Z.buildText("0",18).setOrigin({x:0,y:.5}).build(this.scene),this.currentUnitModText.x=20,this.currentUnitModButton.add(this.currentUnitModText)}createAttackModButton(){this.currentAttackModButton=new Gt(this.scene,xn,wn.TOOL_ATTACK,40,40),this.group.add(this.currentAttackModButton),this.currentAttackModButton.setName("UnitMod"),this.currentAttackModText=Z.buildText("0",18).setOrigin({x:0,y:.5}).build(this.scene),this.currentAttackModText.x=20,this.currentAttackModButton.add(this.currentAttackModText)}},qk=Zk,Qk=class{scene;objects;allUI;groups;constructor(e){this.scene=e,this.objects=null,this.createGroups()}setUIObjects(e){this.objects=e,this.allUI.addMultiple(this.objects.getAll())}createGroups(){this.groups={},this.allUI=this.scene.add.group(),this.groups.allUI=this.allUI}},Jk=Qk,pe=U(dt()),{Utils:{Valid:xp}}=Ludex,$k=class extends Jk{scene;uiZone;guideStateUI;battleReadyStateUI;normalReadyStateUI;levelLoadingStateUI;battlePlayingStateUI;normalPlayingStateUI;bossReadyStateUI;constructor(e){super(e),this.scene=e;let{height:t}=$.getWorldSize(),i=$.getPixelRatio();this.uiZone=this.scene.add.zone(0,0,400*i,t*i),pe.Align.In.Center(this.uiZone,this.scene.gameZone)}setUIObjects(e){super.setUIObjects(e),this.updateDepthGroups(),this.addUIObjectsToGroups()}alignUI(){this.alignMainUI(),this.alignItems(),this.alignDevTools()}alignMainUI(){if(this.objects===null)return;let{gameZone:e,fieldManager:t}=this.scene,{coinBar:i,levelBar:s,battleLevelBar:n,settingsButton:r,unitBar:o,totalHpBar:a,startButton:h}=this.objects;pe.Align.In.TopRight(i,e,-60,-25),pe.Align.In.TopCenter(s,e,0,-22),pe.Align.In.TopCenter(n,e,10,-27),pe.Align.In.TopLeft(r,e,-5,-2);let{y:l,scaleY:c}=t.fieldBackground,{height:f}=$.getWorldSize(),u=$.getPixelRatio(),p=0;$.isLandscape()||o.createStampsBanner(),o.reviveBg(),o.x=p,a.x=p,h.x=p;let d=l-f/2;a.y=d;let g=255;if(o.y=d-g*c*u,o.isBgHigherBottom()){let v=o.getGapFromContainerCenterToBottomBg();o.y=f/2-v}h.y=o.y-72;let m=$.isLandscape(),E=e.displayHeight-(o.y+70)<wt.getBannerHeight();!m&&E&&this.changeUnitBarForBannerAds()}alignItems(){if(this.objects===null)return;let{gameZone:e}=this.scene,{freeCoinsItem:t,unitBar:i}=this.objects;pe.Align.In.TopRight(t,e,-15,-45);let s=$.isLandscape(),n=e.displayHeight-(i.y+70)<wt.getBannerHeight();!s&&n&&this.changeItemAlignForBannerAds()}alignDevTools(){if(this.objects===null||!xp.isDebugger())return;let{gameZone:e}=this.scene,{selectLevelButton:t,resetLevelButton:i,currentUnitModButton:s,currentAttackModButton:n}=this.objects;pe.Align.In.BottomRight(t,e,0,-80),pe.Align.In.BottomRight(i,e,-50,-80),pe.Align.In.BottomLeft(s,e,0,-150),pe.Align.In.BottomLeft(n,e,0,-100)}createGroups(){super.createGroups(),this.guideStateUI=this.scene.add.group(),this.battleReadyStateUI=this.scene.add.group(),this.normalReadyStateUI=this.scene.add.group(),this.levelLoadingStateUI=this.scene.add.group(),this.battlePlayingStateUI=this.scene.add.group(),this.normalPlayingStateUI=this.scene.add.group(),this.bossReadyStateUI=this.scene.add.group(),this.groups.guideStateUI=this.guideStateUI,this.groups.battleReadyStateUI=this.battleReadyStateUI,this.groups.normalReadyStateUI=this.normalReadyStateUI,this.groups.levelLoadingStateUI=this.levelLoadingStateUI,this.groups.battlePlayingStateUI=this.battlePlayingStateUI,this.groups.normalPlayingStateUI=this.normalPlayingStateUI,this.groups.bossReadyStateUI=this.bossReadyStateUI}updateDepthGroups(){this.allUI.setDepth(rt.BUTTON),this.groups.guideStateUI.setDepth(rt.BUTTON),this.groups.levelLoadingStateUI.setDepth(rt.BUTTON),this.groups.normalReadyStateUI.setDepth(rt.BUTTON),this.groups.battleReadyStateUI.setDepth(rt.BUTTON),this.groups.normalPlayingStateUI.setDepth(rt.BUTTON),this.groups.battlePlayingStateUI.setDepth(rt.BUTTON),this.groups.bossReadyStateUI.setDepth(rt.BUTTON)}addUIObjectsToGroups(){this.objects!==null&&(this.addObjectForGuideState(),this.addObjectsToLoadingState(),this.addObjectsForReadyState(),this.addObjectsForPlayingState())}addObjectForGuideState(){this.objects!==null&&this.groups.guideStateUI.addMultiple([this.objects.unitBar,this.objects.coinBar,this.objects.levelBar,this.objects.totalHpBar,this.objects.startButton,this.objects.settingsButton])}addObjectsToLoadingState(){this.objects!==null&&this.groups.levelLoadingStateUI.addMultiple([this.objects.coinBar,this.objects.totalHpBar,this.objects.freeCoinsItem,this.objects.settingsButton])}addObjectsForReadyState(){this.objects!==null&&(this.groups.normalReadyStateUI.addMultiple([this.objects.coinBar,this.objects.unitBar,this.objects.levelBar,this.objects.totalHpBar,this.objects.startButton,this.objects.freeCoinsItem,this.objects.settingsButton]),this.groups.bossReadyStateUI.addMultiple([this.objects.coinBar,this.objects.unitBar,this.objects.levelBar,this.objects.totalHpBar,this.objects.startButton,this.objects.freeCoinsItem,this.objects.settingsButton]),xp.isDebugger()&&this.groups.normalReadyStateUI.addMultiple([this.objects.resetLevelButton,this.objects.selectLevelButton,this.objects.currentUnitModButton,this.objects.currentAttackModButton]),this.groups.battleReadyStateUI.addMultiple([this.objects.coinBar,this.objects.totalHpBar,this.objects.startButton,this.objects.freeCoinsItem,this.objects.battleLevelBar,this.objects.settingsButton]))}addObjectsForPlayingState(){this.objects!==null&&(this.groups.normalPlayingStateUI.addMultiple([this.objects.coinBar,this.objects.totalHpBar,this.objects.settingsButton]),this.groups.battlePlayingStateUI.addMultiple([this.objects.coinBar,this.objects.totalHpBar,this.objects.settingsButton]))}changeUnitBarForBannerAds(){if(!this.objects)return;let{unitBar:e,startButton:t}=this.objects,{tutorialManager:i}=this.scene,s=wt.getBannerHeight();e.changeToDesktopFrame(),pe.Align.In.BottomCenter(e,this.uiZone,-90,-30-s),t.changeToDesktopFrame(),i.isNothingToDisplay()?pe.Align.In.BottomCenter(t,this.uiZone,55,-7-s):pe.Align.In.BottomCenter(t,this.uiZone,0,-7-s)}changeItemAlignForBannerAds(){if(this.objects===null)return;let{gameZone:e}=this.scene,{freeCoinsItem:t}=this.objects;pe.Align.In.TopRight(t,e,-15,-45)}},wp=$k,ke=U(dt()),{Utils:{Device:tB,Valid:eB}}=Ludex,iB=class extends wp{alignUI(){super.alignUI()}alignMainUI(){if(this.objects===null)return;let{coinBar:e,levelBar:t,settingsButton:i,unitBar:s,startButton:n,totalHpBar:r}=this.objects,{tutorialManager:o,gameZone:a}=this.scene;e.setScale(.75),ke.Align.In.TopRight(e,this.uiZone,-80,-18),t.setScale(.75),ke.Align.In.TopCenter(t,this.uiZone,0,-18),i.setScale(.75),ke.Align.In.TopLeft(i,this.uiZone,-40,3),s.changeToDesktopFrame(),ke.Align.In.BottomCenter(s,this.uiZone,-90,-30);let h=tB.isMobile(),l=$.isLandscape(),c=a.displayHeight-(s.y+12)<wt.getBannerHeight();h&&l&&c&&wt.hideBannerAds(),n.changeToDesktopFrame(),o.isNothingToDisplay()?ke.Align.In.BottomCenter(n,this.uiZone,55,-7):ke.Align.In.BottomCenter(n,this.uiZone,0,-7),r.playerHpBar.setScale(.75),r.playerHpBar.setPosition(190,125),r.enemyHpBar.setScale(.75),r.enemyHpBar.setPosition(-190,-160),ke.Align.In.Center(r,this.uiZone,0,0)}alignItems(){if(this.objects===null)return;let{freeCoinsItem:e,startButton:t}=this.objects;e.setScale(.75),ke.Align.In.RightCenter(e,t,e.width,-2)}alignDevTools(){if(this.objects===null||!eB.isDebugger())return;let{selectLevelButton:e,resetLevelButton:t,currentUnitModButton:i,currentAttackModButton:s}=this.objects;ke.Align.In.LeftCenter(e,this.uiZone,150,-50),ke.Align.In.LeftCenter(t,this.uiZone,150,10),ke.Align.In.LeftCenter(i,this.uiZone,150,60),ke.Align.In.LeftCenter(s,this.uiZone,150,120)}},sB=iB,{STATUS:jo}=Ii,nB=class extends ue{scene;layout;objects;constructor(e){super(e),this.scene=e,this.createObjects(),this.createLayouts()}init(){this.initUILogic(),this.layout.alignUI(),this.setState(jo.READY)}start(){this.isRunning()||(this.updateUIState(),this.setState(jo.RUNNING))}stop(){this.isRunning()&&this.setState(jo.STOPPED)}handleResize=()=>{this.layout.alignUI()};handleLayoutChange=()=>{this.createLayouts(),this.layout.setUIObjects(this.objects),this.layout.alignUI()}},rB=nB,{event:Rp}=codex,aB=class extends rB{scene;constructor(e){super(e),this.scene=e,this.registerEvents()}registerEvents(){Rp.on(Qt.VIEW_RESIZED,this.handleResize),Rp.on(Qt.LAYOUT_CHANGED,this.handleLayoutChange)}createObjects(){this.objects=new qk(this.scene)}createLayouts(){$.isLandscape()?this.layout=new sB(this.scene):this.layout=new wp(this.scene),this.layout.setUIObjects(this.objects)}get groups(){return this.layout.groups}initUILogic(){}updateUIState(){}},oB=aB,{STATUS:hB}=Ii,{MaxLevel:Cp}=Ut,{Utils:{Valid:_p}}=Ludex,lB=class extends ue{scene;loadMapInput;unitModifierInput;attackModifierInput;constructor(e){super(e),this.scene=e,this.createDevTools()}start(){this.isRunning()||_p.isDebugger()&&this.setState(hB.RUNNING)}createDevTools(){_p.isDebugger()&&(this.createLoadMapInput(),this.createUnitModifierInput(),this.createAttackModifierInput())}createLoadMapInput(){this.loadMapInput=this.createInput("input-level","level-id","load-level-id","Load level",this.handleStartLoadMapById)}createUnitModifierInput(){this.unitModifierInput=this.createInput("input-level","unit-mod","edit-unit-mod","Set Unit Price Modifier",this.handleEditUnitModifier)}createAttackModifierInput(){this.attackModifierInput=this.createInput("input-level","attack-mod","edit-attack-mod","Set Attack Coin Modifier",this.handleEditAttackModifier)}createInput(e,t,i,s,n){let r=document.createElement("div");return r.id=e,r.style.height="100vh",r.style.width="calc(100vw - 100px)",r.style.padding="50px",r.style.display="flex",r.style.flexFlow="column",r.style.position="absolute",r.style.justifyContent="center",r.style.backgroundColor="#000000cc",r.innerHTML=`<input id=${t} style="height: 50px;text-align: center;font-size: 30px;"></input><input type="button" id=${i} value=${s} style="height:40px">`,document.body.appendChild(r),document.getElementById(i)?.addEventListener("click",n),r.style.display="none",r}handleStartLoadMapById=()=>{try{this.loadMapInput.style.display="none";let e=document.getElementById("level-id");if(!e)return;let t=JSON.parse(e.value),i=parseInt(t)>Cp?Cp:parseInt(t);this.scene.selectLevel(i)}catch{}};handleEditUnitModifier=()=>{try{this.unitModifierInput.style.display="none";let e=document.getElementById("unit-mod");if(!e)return;let t=JSON.parse(e.value),i=parseInt(t),{difficultyManager:s,uiManager:n}=this.scene,r=s.editCurrentLevelUnitMod(i);this.setCurrentUnitModText(t,r),n.updateUIData()}catch{}};setCurrentUnitModText(e,t){let{objects:i}=this.scene.layoutManager;i.currentUnitModText.setText(`C: ${e*100}%
T: ${t.toString()}%`)}handleEditAttackModifier=()=>{try{this.attackModifierInput.style.display="none";let e=document.getElementById("attack-mod");if(!e)return;let t=JSON.parse(e.value),i=parseInt(t),{difficultyManager:s,uiManager:n}=this.scene,r=s.editCurrentLevelAttackMod(i);this.setCurrentAttackModText(t,r),n.updateUIData()}catch{}};setCurrentAttackModText(e,t){let{objects:i}=this.scene.layoutManager;i.currentAttackModText.setText(`C: ${e}%
T: ${t.toString()}%`)}handleShowLoadMapInput=()=>{this.loadMapInput.style.display="flex"};handleShowModUnitInput=()=>{this.unitModifierInput.style.display="flex"};handleShowModAttackInput=()=>{this.attackModifierInput.style.display="flex"}},uB=lB,cB={gameData:uo,dailyRewardedData:{logDays:[],firstReward:0,lastReward:0}},bp=cB;function Pp(e,t,i){var s,n,r;t===void 0&&(t=50),i===void 0&&(i={});var o=(s=i.isImmediate)!=null&&s,a=(n=i.callback)!=null&&n,h=i.maxWait,l=Date.now(),c=[];function f(){if(h!==void 0){var p=Date.now()-l;if(p+t>=h)return h-p}return t}var u=function(){var p=[].slice.call(arguments),d=this;return new Promise(function(g,m){var E=o&&r===void 0;if(r!==void 0&&clearTimeout(r),r=setTimeout(function(){if(r=void 0,l=Date.now(),!o){var y=e.apply(d,p);a&&a(y),c.forEach(function(T){return(0,T.resolve)(y)}),c=[]}},f()),E){var v=e.apply(d,p);return a&&a(v),g(v)}c.push({resolve:g,reject:m})})};return u.cancel=function(p){r!==void 0&&clearTimeout(r),c.forEach(function(d){return(0,d.reject)(p)}),c=[]},u}var Rn=U(Nt()),{player:ri,monitorError:dB}=codex,{Utils:{Valid:Lp}}=Ludex,pB=class extends mn{uiManager;unitManager;coinManager;fieldManager;levelManager;powerManager;stateManager;spineManager;effectManger;layoutManager;devToolManager;tutorialManager;animationManager;difficultyManager;accessibilityManager;gameMode;levelStartAt;levelEndAt;isBannerAdShowed;isStartOverPopupShowed;isBossFightRequested;preload(){this.events.on(Rn.WAKE,this.run),this.events.on(Rn.CREATE,this.run),this.events.on(Rn.SLEEP,this.quit),this.events.on(Rn.PAUSE,this.handlePauseScene),this.events.on(Rn.RESUME,this.handleResumeScene)}handlePauseScene=()=>{this.unitManager.hideAllUnits(),this.unitManager.hideAllProjectiles(),this.spineManager.hideAllSpines(),this.effectManger.hideAllTextEffects()};handleResumeScene=()=>{this.stateManager.isInLevelLoadingState()||this.unitManager.showAllAliveUnits(),this.stateManager.isInPlayingState()&&this.unitManager.showAllHpBarUnits(),this.unitManager.showAllProjectiles(),this.spineManager.showAllSpines(),this.effectManger.showAllTextEffects(),this.powerManager.syncSpeedSetting()};create(){super.create(),this.createManager(),this.levelStartAt=0,this.levelEndAt=0,this.isBannerAdShowed=!1,this.isStartOverPopupShowed=!1}createManager(){this.layoutManager=new oB(this),this.coinManager=new ib(this),this.unitManager=new qO(this),this.levelManager=new Yb(this),this.fieldManager=new Bb(this),this.powerManager=new Vb(this),this.stateManager=new IP(this),this.spineManager=new jb(this),this.effectManger=new wb(this),this.devToolManager=new uB(this),this.tutorialManager=new fD(this),this.animationManager=new W_(this),this.difficultyManager=new nb(this),this.accessibilityManager=new _R(this),this.uiManager=new XP(this)}initManager(){this.uiManager.init(),this.unitManager.init(),this.coinManager.init(),this.levelManager.init(),this.fieldManager.init(),this.spineManager.init(),this.effectManger.init(),this.powerManager.init(),this.devToolManager.init(),this.tutorialManager.init(),this.difficultyManager.init(),this.accessibilityManager.init(),this.layoutManager.init()}startManager(){this.coinManager.start(),this.unitManager.start(),this.levelManager.start(),this.fieldManager.start(),this.effectManger.start(),this.powerManager.start(),this.devToolManager.start(),this.tutorialManager.start(),this.difficultyManager.start(),this.accessibilityManager.start(),this.uiManager.start(),this.uiManager.start(),this.layoutManager.start()}stopManager(){this.uiManager.stop(),this.levelManager.stop(),this.coinManager.stop(),this.fieldManager.stop(),this.unitManager.stop(),this.spineManager.stop(),this.effectManger.stop(),this.powerManager.stop(),this.devToolManager.stop(),this.tutorialManager.stop(),this.difficultyManager.stop(),this.accessibilityManager.stop(),this.layoutManager.stop()}handleSpawnRanged=()=>{if(!this.stateManager.isInReadyState())return;let e=_t.inst.getCoin(),t=this.unitManager.getPlayerRangedSpawnedUnitsCount(),i=this.coinManager.getUnitPrice(t),s=this.getBuyingUnitLevel();if(e.smallerThan(i)){let r=e.toString(),o=i.toString();if(r!==o){ot.openScreen(tt.UNIT_REWARD_SCREEN,{type:"RANGED"});return}i=e}let n=this.fieldManager.getAvailablePlacement();n&&(_t.inst.removeCoin(i),this.unitManager.createPlayerArcher(n.rowId,n.colId,s),this.fieldManager.getRemainingAvailablePlacement()===0&&this.effectManger.playFullFloatText(),this.updateUI(),this.unitManager.savePlayerUnits(),ut.playSound(Et.BUTTON_CLICK))};handleSpawnMelee=()=>{if(!this.stateManager.isInReadyState())return;let e=this.unitManager.getPlayerMeleeSpawnedUnitsCount(),t=this.coinManager.getUnitPrice(e),i=this.getBuyingUnitLevel(),s=_t.inst.getCoin();if(s.smallerThan(t)){let r=s.toString(),o=t.toString();if(r!==o){ot.openScreen(tt.UNIT_REWARD_SCREEN,{type:"MELEE"});return}t=s}let n=this.fieldManager.getAvailablePlacement();n&&(_t.inst.removeCoin(t),this.unitManager.createPlayerMelee(n.rowId,n.colId,i),this.fieldManager.getRemainingAvailablePlacement()===0&&this.effectManger.playFullFloatText(),this.updateUI(),this.unitManager.savePlayerUnits(),ut.playSound(Et.BUTTON_CLICK))};canSpawnUnit(e,t=!1){if(!this.stateManager.isInReadyState()||!this.fieldManager.getAvailablePlacement())return!1;if(t){let i=_t.inst.getCoin(),s=0;e==="MELEE"?s=this.unitManager.getPlayerMeleeSpawnedUnitsCount():s=this.unitManager.getPlayerRangedSpawnedUnitsCount();let n=this.coinManager.getUnitPrice(s);if(i.smallerThan(n)){let r=i.toString(),o=n.toString();if(r!==o)return!1}}return!0}spawnUnit(e,t=!0,i=1,s=!1){if(!this.stateManager.isInReadyState())throw new Error("GameScene is not in ready state");let n=this.fieldManager.getAvailablePlacement();if(!n)throw new Error("No available placement");if(s){let o=_t.inst.getCoin(),a=0;e==="MELEE"?a=this.unitManager.getPlayerMeleeSpawnedUnitsCount():a=this.unitManager.getPlayerRangedSpawnedUnitsCount();let h=this.coinManager.getUnitPrice(a);if(o.smallerThan(h)){let l=o.toString(),c=h.toString();if(l!==c)throw new Error("Not enough coins");h=o}_t.inst.removeCoin(h)}let r;t?(e==="MELEE"?r=this.uiManager.getMeleeBlockWorldPosition():r=this.uiManager.getRangedBlockWorldPosition(),this.effectManger.runCurveAnimationRewardUnit(r.x,r.y,n,e,i)):e==="MELEE"?this.unitManager.createPlayerMelee(n.rowId,n.colId,i):this.unitManager.createPlayerArcher(n.rowId,n.colId,i),this.updateUI(),this.unitManager.savePlayerUnits()}getBuyingUnitLevel(){let{currentLevelId:e}=this.levelManager,{BUYING_UNIT_LEVEL:t}=Q,i=1;return t.forEach((s,n)=>{s<=e&&(i=n+1)}),i}giveEnoughCoins(e){let t=0,i=new Dt(0);e==="MELEE"?(t=this.unitManager.getPlayerMeleeSpawnedUnitsCount(),i=this.coinManager.getUnitPrice(t)):(t=this.unitManager.getPlayerRangedSpawnedUnitsCount(),i=this.coinManager.getUnitPrice(t));let s=_t.inst.getCoin();s.smallerThan(i)&&(i.subtract(s),_t.inst.addCoin(i))}updateUI(){this.uiManager.updateUIData(),this.fieldManager.getRemainingAvailablePlacement()===0&&(this.uiManager.disableUnitBlocks(),this.uiManager.disableAdsUnitBlocks()),this.uiManager.isStartButtonDisabled()&&this.uiManager.enableStartButton()}run=()=>{this.stateManager.init(),Ps.instance.loadAllLanguages(this).catch(e=>{dB?.sendException(e)})};quit=()=>{this.stateManager.quit()};prepareRound=async()=>{this.levelStartAt=Date.now(),await Ti.handleMatchStart(),this.stateManager.ready()};restartScene=()=>{this.stateManager.init()};startRound=()=>{this.stateManager.play(),ut.playSound(Et.START_BATTLE)};replayRound=async()=>{this.unitManager.hideAllUnits(),this.layoutManager.objects.freeCoinsItem.revive(),this.stateManager.ready(),this.unitManager.showAllAliveUnits()};requestBossFight=()=>{this.unitManager.hideAllUnits(),this.stopManager(),this.gameMode=Tt.BOSS;let e=Date.now(),t=ri.getGameData();ri.setGameData({...t,lastBossChallengeTime:e}),this.replayRound(),this.powerManager.updateTimers()};nextRound=()=>{this.unitManager.hideAllUnits(),this.stateManager.levelLoading()};gameOver(e){this.unitManager.setReadyAllUnits(),this.levelEndAt=Date.now(),e==="win"?this.stateManager.levelComplete():this.stateManager.levelFail()}handleStartOverFlow(){if(this.isStartOverPopupShowed)return;let e=ri.getGameData()?.isEligibleForReset??!1;Lp.isBoolean(e)&&e&&(this.isStartOverPopupShowed=!0,ot.openScreen(tt.START_OVER_POPUP))}rewardLostCoin(e){let t=this.coinManager.getTotalCoinsByAttack();t.multiply(e),_t.inst.addCoin(t)}rewardWinCoin(e){let t=this.coinManager.getRewardCoinsByAttackCoins();t.multiply(e),_t.inst.addCoin(t)}updateLevelToLeaderboard(e){}update(){this.stateManager.update()}resetLevel=async(e=!0)=>{let t=bp,{gameData:i}=t,s=ri.getGameData(),n=s?.gameCompletedCount??0;Lp.isNumber(n)?n++:n=1,e&&(n=0),await ri.setGameData({...i,gameCompletedCount:n}),_t.inst.setCoin(new Dt(s?.coinBaseValue??0,s?.coinSuffixValue??0,!0)),this.coinManager.initModifier(),this.difficultyManager.intData(),this.levelManager.setCurrentLevelId(1),this.tutorialManager.initTutorialData(),this.resetGameplay()};selectLevel=e=>{let t=ri.getGameData();ri.setGameData({...t,level:e-1}),this.coinManager.initModifier(),this.difficultyManager.intData(),this.levelManager.setCurrentLevelId(e-1),this.resetGameplay()};resetGameplay(){this.unitManager.initSpawnPools(),this.unitManager.emptyPlayerUnits(),this.uiManager.updateUIData(),this.stateManager.quit(),this.stateManager.levelLoading()}setOfflineRewardsToMax(){ri.setGameData({offlineRewardLastCheck:Date.now()-24*60*60*1e3})}initGameMode(){this.gameMode=Tt.NORMAL}updateUnitData=Pp(()=>{let e=ri.getGameData();ri.setGameData({...e,playerUnitData:this.unitManager.serializePlayerUnitData()})},2e3);isChallengeMode(){return Ti.isChallengeMode()}isContextChallenge(){return!1}getPlayedTimeSeconds(){return Math.floor((this.levelEndAt-this.levelStartAt)/1e3)}},Zo=pB,St=Zo,{event:gB}=codex,{Events:fB}=Ludex,mB={duration:200,color:{r:164,g:90,b:48}},vB=class cf{currentScene=null;static _instance;static get inst(){return this._instance||(this._instance=new cf),this._instance}static setCurrentScene(t){let i=window.phaser.scene.getScene(t);this.inst.currentScene=i}static getCurrentScene(){let{currentScene:t}=this.inst;return t?.scene.isSleeping()?window.phaser.scene.getScenes(!0).find(i=>!i.scene.isSleeping())??null:t}static switchScene(t,i,s){gB.emit(fB.SWITCH_SCENE,{sceneName:t,sceneData:i,transition:s})}static async switchToGameScene(t){let{score:i=0}=t??{};this.switchScene(ct.GAME_SCENE,{score:i},mB)}static getGlobalScene(){let t=window.phaser.scene.getScene(ct.GLOBAL_SCENE);return!t||!(t instanceof ao)?null:t}static getGameScene(){let t=window.phaser.scene.getScene(ct.GAME_SCENE);return!t||!(t instanceof St)?null:t}static pauseGameScene(){window.phaser.scene.pause(ct.GAME_SCENE)}static resumeGameScene(){window.phaser.scene.resume(ct.GAME_SCENE)}},nt=vB,EB=U(Ku()),{Plugins:{Audio:{BaseAudioPlayer:yB}}}=Ludex,TB=class extends yB{audioSource;constructor(e,t){super(e),this.audioSource=t}play(e){if(e){let{volume:t=1,loop:i=!1}=e;this.audioSource.volume=t,this.audioSource.loop=i}this.audioSource.play()}pause(){this.audioSource.pause()}resume(){this.audioSource.isPaused&&this.audioSource.play()}stop(){this.audioSource.stop()}setVolume(e){this.audioSource.volume=e}getVolume(){return this.audioSource.volume}getAudioSource(){return this.audioSource}},SB=TB,{Plugins:{Audio:{BaseChannelManager:AB}},Utils:{Array:xB}}=Ludex,Ip=class extends AB{game;players;constructor(e,t){super(t),this.game=e,this.players={}}playing(e){let t=this.players[e];if(!t)return!1;for(let i of t)if(i.getAudioSource().isPlaying)return!0;return!1}async onLoadAudio(e,t){try{return this.isCached(e)||await this.loadAudio(e),this.getPlayer(e,t?.allowMultiple)}catch{return null}}playWithRealConfig(e,t){if(t&&!this.isPlayable(t.checkList))return;let i=this.getVolume()*(t?.volume??1);e.play({...t,volume:i})}loadAudio(e){let t;if(e===Bi.BACKGROUND.KEY&&(t=ut.getMusicPath()),t||(t=Bi.EFFECTS_FILES[e]??void 0),!!t)return new Promise((i,s)=>{let n=nt.getCurrentScene();if(!n){s(new Error("No scene found"));return}n.load.audio(e,t),n.load.on(`${EB.Events.FILE_KEY_COMPLETE}audio-${e}`,i),n.load.start()})}isPlayable(e=[]){if(e.length===0)return!0;let t=Object.keys(this.players);for(let i of t){if(!xB.has(e,i))continue;let s=this.players[i];for(let n of s)if(n.getAudioSource().isPlaying)return!1}return!0}isCached(e){let t=this.players[e];return t&&t.length>0||this.game.cache.audio.exists(e)}getPlayer(e,t=!1){let i=this.players[e];if(!i||i.length===0)return this.createPlayer(e);if(!t)return i[0];for(let n of i)if(!n.getAudioSource().isPlaying)return n;let s=`-${i.length}`;return this.createPlayer(e,s)}createPlayer(e,t=""){let i=this.game.sound.add(e),s=new SB(`${e}${t}`,i),n=this.players[e]??[];return n.push(s),this.players[e]=n,s}},{audio:ai}=codex,wB=class df{static _instance;channels={};static get inst(){return this._instance||(this._instance=new df),this._instance}static playing(t){try{return this.inst.playing(t)}catch{return!1}}static async play(t,i){try{return await this.inst.play(t,i)}catch{}}static pause(t){try{this.inst.pause(t)}catch{}}static resume(t){try{this.inst.resume(t)}catch{}}static stop(t){try{this.inst.stop(t)}catch{}}static stopAll(){try{this.inst.stopAll()}catch{}}static mute(){try{this.inst.mute()}catch{}}static unmute(){try{this.inst.unmute()}catch{}}static setVolume(t){try{this.inst.setVolume(t)}catch{}}static getVolume(){try{return this.inst.getVolume()}catch{return 0}}getCurrentChannel(){let t=nt.getCurrentScene()?.scene.key??void 0;if(t===void 0)throw new Error("AudioManager.getCurrentChannelId: No scene found");if(this.channels[t])return this.channels[t];let i=new Ip(window.phaser,t);return ai.addChannel(i),this.channels[t]=i,i}playing(t){return this.getCurrentChannel().playing(t)}play(t,i){let s=this.getCurrentChannel().getId();return ai.play(t,i,s)}pause(t){let i=this.getCurrentChannel().getId();ai.pause(t,i)}resume(t){let i=this.getCurrentChannel().getId();ai.resume(t,i)}stop(t){let i=this.getCurrentChannel().getId();ai.stop(t,i)}stopAll(){let t=this.getCurrentChannel().getId();ai.stopAll(t)}mute(){let t=this.getCurrentChannel().getId();ai.mute(t)}unmute(){let t=this.getCurrentChannel().getId();ai.unmute(t)}setVolume(t){let i=this.getCurrentChannel().getId();ai.setVolume(t,i)}getVolume(){let t=this.getCurrentChannel().getId();return ai.getVolume(t)}},RB=class pf{musicChannel;static get inst(){return this._instance||(this._instance=new pf),this._instance}constructor(){this.musicChannel=new Ip(window.phaser,"music");let{audio:t}=codex;t.addChannel(this.musicChannel)}static playing(t){try{return this.inst.playing(t)}catch{return!1}}static async play(t,i){try{return await this.inst.play(t,i)}catch{}}static pause(t){try{this.inst.pause(t)}catch{}}static resume(t){try{this.inst.resume(t)}catch{}}static stop(t){try{this.inst.stop(t)}catch{}}static stopAll(){try{this.inst.stopAll()}catch{}}static mute(){try{this.inst.mute()}catch{}}static unmute(){try{this.inst.unmute()}catch{}}static setVolume(t){try{this.inst.setVolume(t)}catch{}}static getVolume(){try{return this.inst.getVolume()}catch{return 0}}getCurrentChannel(){return this.musicChannel}playing(t){return this.musicChannel.playing(t)}play(t,i){let{audio:s}=codex;return s.play(t,i,"music")}pause(t){let{audio:i}=codex;i.pause(t,"music")}resume(t){let{audio:i}=codex;i.resume(t,"music")}stop(t){let{audio:i}=codex;i.stop(t,"music")}stopAll(){let{audio:t}=codex;t.stopAll("music")}mute(){let{audio:t}=codex;t.mute("music")}unmute(){let{audio:t}=codex;t.unmute("music")}setVolume(t){let{audio:i}=codex;i.setVolume(t,"music")}getVolume(){let{audio:t}=codex;return t.getVolume("music")}},CB=RB,_B=U(ft()),{player:Mp}=codex,bB=class gf{static _instance;static musicKey;static volumeTween;static get inst(){return this._instance||(this._instance=new gf,this.k()),this._instance}static k(){this.musicKey||(this.musicKey="bg_music.mp3")}get sound(){return wB}get music(){return CB}static muteAudio(t){this.muteMusic(t),this.muteSound(t)}static async playSound(t,i){if(!(!this.inst.sound||!(Mp.getPlayerSetting("sound")??!0)))return this.inst.sound.play(t,i)}static pauseSound(t){this.inst.sound&&this.inst.sound.pause(t)}static resumeSound(t){this.inst.sound&&this.inst.sound.resume(t)}static stopSound(t){this.inst.sound&&this.inst.sound.stop(t)}static stopAllSounds(){this.inst.sound&&this.inst.sound.stopAll()}static muteSound(t){this.inst.sound&&(t?this.inst.sound.mute():this.inst.sound.unmute())}static getMusicKey(){return Bi.BACKGROUND.KEY}static getMusicPath(){return this.musicKey||this.k(),this.musicKey}static getAllMusicKeys(){return[Bi.BACKGROUND.KEY]}static playMusic(t,i=!1){if(!this.inst.music||!(Mp.getPlayerSetting("music")??!0))return;let s=t??this.getMusicKey();if(!s)return;let n=this.inst.music.playing(s);!i&&n||(this.stopOtherMusic(s),this.inst.music.play(s,{loop:!0}))}static stopOtherMusic(t){if(this.inst.music)for(let i of this.getAllMusicKeys())i!==t&&this.inst.music.stop(i)}static pauseMusic(){if(!this.inst.music)return;let t=this.getMusicKey();if(t)this.inst.music.pause(t);else for(let i of this.getAllMusicKeys())this.inst.music.pause(i)}static muteMusic(t){this.inst.music&&(t?this.inst.music.mute():this.inst.music.unmute())}static async turnOffMusic(){await this.setVolumeMusic(0)}static getVolumeMusic(){return this.inst.music?.getVolume()??0}static async setVolumeMusic(t,i=!1){if(!this.inst.music)return;this.volumeTween?.isPlaying()&&this.volumeTween?.stop();let s=this.inst.music.getVolume();if(s===t)return;if(!i){this.inst.music?.setVolume(t);return}let n=nt.getGlobalScene();if(!n){this.inst.music.setVolume(t);return}let r=n.tweens.addCounter({from:1,to:1e3,duration:1e3,ease:_B.Sine.Out,onUpdate:o=>{let a=(t-s)*o.getValue()/1e3;this.inst.music.setVolume(s+a)},onComplete:()=>{this.inst.music.setVolume(t)}});this.volumeTween=r,r.play()}},ut=bB,{Configs:{Ads:{Enabled:Ve,InterstitialAdOptions:PB,RewardedVideoAdOptions:LB,RewardedInterstitialAdOptions:IB,BannerDisplayAdOptions:qo},Gameplay:{StartAdAtLevel:Op}},Plugins:{Ads:{Types:we,Status:Or}},Utils:{Array:Hs,Function:MB}}=Ludex,{ads:ge,player:OB}=codex,DB={MAX_BOTTOM_BANNER_RATIO:1/6},kB=class Lh{static _instance;isAvoidBannerShowed=!1;static get inst(){return this._instance||(this._instance=new Lh),this._instance}static async preloadAds(){this.preloadAdsByType(we.INTERSTITIAL),this.preloadAdsByType(we.REWARDED_VIDEO),this.preloadAdsByType(we.REWARDED_INTERSTITIAL)}static isServiceDegraded(){return ge.isServiceDegraded()}static preloadAdsByType(t,i){if(!Ve)return;let s=ge.getAdsByType(t);for(let n of s)i&&n.placementId!==i||n.instance.status===Or.FILLED||ge.loadAdAsync(t,n.placementId).catch(()=>{})}static setAvoidBannerShowed(t){this.inst.isAvoidBannerShowed=t}static showBannerAds(){if(!(!Ve||(OB.getGameData()?.level??1)<Op)&&!this.inst.isAvoidBannerShowed)for(let{PlacementId:t,Position:i,BannerHeight:s}of qo){if(i==="bottom"){let{height:n}=$.getWorldSize(),r=$.toPixelSize(n*DB.MAX_BOTTOM_BANNER_RATIO);if(s>r){ge.hideBannerAdAsync(t).catch(o=>{});continue}}ge.showBannerAdAsync(t).catch(n=>{})}}static hideBannerAds(){Ve&&ge.getAdsByType(we.BANNER).forEach(t=>{t.instance.status!==Or.IDLE&&this.hideBannerAd(t.placementId)})}static showBannerAd(t){Ve&&(this.inst.isAvoidBannerShowed||ge.showBannerAdAsync(t).catch(i=>{}))}static hideBannerAd(t){Ve&&ge.hideBannerAdAsync(t).catch(i=>{})}static getBannerHeight(){if(!Ve)return 0;let t=qo.find(({Position:s})=>s==="bottom"),i=$.getPixelRatio()/$.getZoomRatio();return ge.getBannerHeight(t?.PlacementId||"",i,!0)||0}getAdReady(t,i){if(!Ve)return null;if(i){if(ge.getAdStatus(t,i)===Or.FILLED)return i}else{let s=ge.getAdsByType(t);for(let n of s)if(n.instance.status===Or.FILLED)return n.placementId}return null}getPlacementIdByService(t,i){if(!i)return!1;switch(t){case we.BANNER:return Hs.search(qo,s=>s.AdService===i)?.PlacementId||!1;case we.INTERSTITIAL:return Hs.search(PB,s=>s.AdService===i)?.PlacementId||!1;case we.REWARDED_VIDEO:return Hs.search(LB,s=>s.AdService===i)?.PlacementId||!1;case we.REWARDED_INTERSTITIAL:return Hs.search(IB,s=>s.AdService===i)?.PlacementId||!1;default:return!1}}getAdIdByPayload(t,i){let{adService:s,placementId:n}=i||{};return this.getPlacementIdByService(t,s)||n}static isReadyAdShowable(t,i){if(!Ve)return!1;let s=this.inst.getAdReady(t,i);return s?ge.canShowAd(t,s):!1}getAdErrorMessage(t,i){switch(t){case we.REWARDED_VIDEO:case we.REWARDED_INTERSTITIAL:return this.isUserCancelledAdError(i)?`Sorry, no rewards!
 You have cancelled the ad.`:"No ads to display.";default:return null}}async showAdWithType(t,i){let{placementId:s,includeSDK:n,excludeSDK:r,forceLoad:o,adService:a,timeout:h=15e3}=i||{};if(!this.canbeShowInSDK(n,r))return!1;let l=this.getAdIdByPayload(t,i),c=!1,f=!1;try{if(ut.muteAudio(!0),o){ot.showLoadingNotificationScreen();let u=await MB.timeOut(ge.loadAdAsync(t,l),h);if(u.status==="timeout")throw new Error(`AdsUtils.loadAdAsync: Timed out after ${u.duration}ms.`)}for(;!c;)try{let u=this.getAdReady(t,l);if(!u)return!1;l=u,await ge.showAdAsync(t,l),c=!0}catch(u){if(a||this.isUserCancelledAdError(u)||this.isRequestAdTimeoutError(u))throw u;l=void 0,c=!1,f=!0}return!0}catch(u){f=!0;let p=this.getAdErrorMessage(t,u);return p&&ot.showNotificationScreen({message:p,duration:2e3,enableCloseOnTouch:!0}),!1}finally{ut.muteAudio(!1),o&&ot.closeLoadingScreen(),f&&(l=s),Lh.preloadAdsByType(t,l)}}static async showInterstitialAdAsync(t){if(!Ve)return!1;let{forLevel:i,contextType:s,forceLoad:n}=t||{};if(i&&Op>=i)return!1;s&&(window.GoogleAds?.setInterstitialType(s),window.TranssionH5Ads?.setInterstitialType(s));let r=n;return GameSDK.getSDKName()==="MsGames"&&(r=!0),this.inst.showAdWithType(we.INTERSTITIAL,{...t,forceLoad:r})}static async showRewardVideoAdAsync(t){if(!Ve)return!1;let{contextType:i}=t||{};return i&&(window.GoogleAds?.setRewardType(i),window.TranssionH5Ads?.setRewardType(i)),this.inst.showAdWithType(we.REWARDED_VIDEO,{...t,forceLoad:!0})}static async showRewardedInterstitialAdAsync(t){if(!Ve)return!1;let{contextType:i}=t||{};return i&&(window.GoogleAds?.setRewardType(i),window.TranssionH5Ads?.setRewardType(i)),this.inst.showAdWithType(we.REWARDED_INTERSTITIAL,{...t,forceLoad:!0})}canbeShowInSDK(t=[],i=[]){let s=GameSDK.getSDKName();return!(i?.length&&Hs.has(i,s)||t?.length&&!Hs.has(t,s))}isUserCancelledAdError(t){return t instanceof Object&&"code"in t&&t.code==="USER_INPUT"}isRequestAdTimeoutError(t){return t instanceof Object&&"code"in t&&t.code==="SHOW_ADS_TIMEOUT"}},wt=kB,{Events:Qo,Configs:{Ads:{Enabled:BB,PreloadAds:NB,ShowAdOnLoad:UB,BannerDisplayAdOptions:FB},Gameplay:{StartAdAtLevel:GB}},Utils:{Time:Jo}}=Ludex,{phaser:Dp}=window,{event:Dr}=codex,YB=class{currentLayout="";init(){this.listenEvents()}listenEvents(){Dr.on(Qt.LAYOUT_CHANGED,this.handleLayoutChanged),Dr.catchUp(Qo.GAME_READY,this.processPreloadAds),Dr.catchUp(Qo.GAME_READY,this.processShowBannerAds),Dr.catchUp(Qo.GAME_SDK_READY,this.processShowFirstInterstitialAd)}processShowBannerAds=async()=>{At.getLevelProgress()<GB||(await Jo.sleepAsync(1500),wt.showBannerAds())};processPreloadAds=async()=>{NB&&(await Jo.sleepAsync(6*1e3),wt.preloadAds())};processShowFirstInterstitialAd=async()=>{if(!BB)return;let{Enabled:e,DelaySeconds:t}=UB;if(!e)return;t>0&&await Jo.sleepAsync(t*1e3);let i=GameSDK.getSDKName()==="Yandex";i&&Dp.loop.pause();try{await wt.showInterstitialAdAsync({forceLoad:!0,contextType:"preroll"})}catch{}i&&Dp.loop.resume()};handleLayoutChanged=e=>{if(this.currentLayout!==e){if(this.currentLayout=e,e===gr.Layout.Landscape){this.processShowBannerAds();return}FB.forEach(({PlacementId:t,Position:i})=>{i==="bottom"||i==="top"?wt.showBannerAd(t):wt.hideBannerAd(t)})}}},HB=YB,{Events:kr}=Ludex,{event:Br}=codex,WB=class{init(){}requestStart(){Br.emit(kr.REQUEST_CORE_START)}onCoreBoot(e){Br.catchUp(kr.CORE_BOOTING,e)}onCoreStart(e){Br.catchUp(kr.CORE_STARTING,e)}onCoreReady(e){Br.catchUp(kr.CORE_READY,e)}},zB=WB,VB={level:1},XB=VB,{player:KB,storage:jB}=codex,ZB=class{init(){}setupDefaultMatchData(){this.setupMatchCustomData()}setupMatchCustomData(){let e=KB.getGameData()?.level??1;jB.setStorageData("match","customData",{...XB,level:e})}},qB=ZB,{Utils:{Valid:bt,Browser:QB},Dtos:{Player:Jt}}=Ludex,{player:Nr}=codex,JB=class{init(){}setupDefaultGameData(){Jt.Data.addDefaultData(bp),Jt.GameData.addDefaultData(uo),Jt.GameData.addValidateFunction("playerUnitData",e=>{if(!bt.isString(e))throw new Error(`playerUnitData ${e} is invalid`)}),Jt.GameData.addValidateFunction("gameCompletedCount",e=>{if(!bt.isNumber(e)||e<0)throw new Error(`gameCompletedCount ${e} is invalid`)}),Jt.GameData.addValidateFunction("meleeUnlockedUnitLevel",e=>{if(!bt.isNumber(e)||e<0)throw new Error(`meleeUnlockedUnitLevel ${e} is invalid`)}),Jt.GameData.addValidateFunction("rangedUnlockedUnitLevel",e=>{if(!bt.isNumber(e)||e<0)throw new Error(`rangedUnlockedUnitLevel ${e} is invalid`)}),Jt.GameData.addValidateFunction("bossLevelProgress",e=>{if(!bt.isNumber(e)||e<0)throw new Error(`bossLevelProgress ${e} is invalid`)}),Jt.GameData.addValidateFunction("finalBossDefeated",e=>{if(!bt.isBoolean(e))throw new Error(`finalBossDefeated ${e} is invalid`)}),Jt.GameData.addValidateFunction("lastBossChallengeTime",e=>{if(!bt.isNumber(e)||e<0)throw new Error(`lastBossChallengeTime ${e} is invalid`)}),Jt.GameData.addValidateFunction("isEligibleForReset",e=>{if(!bt.isBoolean(e))throw new Error(`isEligibleForReset ${e} is invalid`)}),Jt.GameData.addValidateFunction("coinBaseValue",e=>{if(!bt.isNumber(e)||e<0)throw new Error(`coinBaseValue ${e} is invalid`)}),Jt.GameData.addValidateFunction("coinSuffixValue",e=>{if(!bt.isNumber(e)||e<0)throw new Error(`coinSuffixValue ${e} is invalid`)}),Jt.GameData.addValidateFunction("freeCoinsLastUsedTime",e=>{if(!bt.isNumber(e)||e<0)throw new Error(`freeCoinsLastUsedTime ${e} is invalid`)}),Jt.GameData.addValidateFunction("offlineRewardLastCheck",e=>{if(!bt.isNumber(e)||e<0)throw new Error(`offlineRewardLastCheck ${e} is invalid`)}),Jt.GameData.addValidateFunction("unitScreenAdWatchedCount",e=>{if(!bt.isObject(e))throw new Error(`unitScreenAdWatchedCount ${e} is invalid`)}),Jt.GameData.addValidateFunction("level",e=>{if(!bt.isNumber(e)||e<0)throw new Error(`level ${e} is invalid`)}),Jt.GameData.addValidateFunction("levelProgress",e=>{if(!bt.isNumber(e)||e<0)throw new Error(`levelProgress ${e} is invalid`)})}async syncPlayerData(){let e={},t=await this.J(),i=await this.$(),{playerLevelProgress:s}=t??{},{level:n=1}=Nr.getGameData()??{},r={playerLevelProgress:s};i||(e.isFirstLogin=!1),bt.isEmpty(t)||(e.gameData={},bt.isNumber(s)&&s>n&&(e.gameData.level=s)),!bt.isEmpty(e)&&!bt.isEmpty(e.gameData)&&(e.oldData=r,Nr.setPlayerData(e)),this.tt(),this.disableSpeedUpSettings()}requestConnectedPlayers(){Nr.requestConnectedPlayers().catch(e=>{})}async J(){let{gameData:e={}}=await GameSDK.player.getDataAsync(["gameData"]),t={playerLevelProgress:1};if("getCoreserData"in GameSDK.extra){let i=GameSDK.extra.getCoreserData(),{playerData:s}=i,n=this.et(s);if(n)return n}return bt.isEmpty(e)?t:e}async $(e){let{isFirstLogin:t=!1}=await GameSDK.player.getDataAsync(["isFirstLogin"]);if(!t)return!1;if(!bt.isObject(e)||!("userGuideDisplays"in e)||!bt.isNumber(e.userGuideDisplays))return!0;let{userGuideDisplays:i}=e;return i===0}et(e){if(!bt.isObject(e)||!("gameData"in e)||!bt.isObject(e.gameData))return null;let{gameData:t}=e;return{playerLevelProgress:this.st(t)}}st(e){if("levelProgress"in e&&bt.isNumber(e.levelProgress)){let{levelProgress:t}=e;return Math.max(t,1)}return 1}tt(){if(!("getCoreserData"in GameSDK.extra))return;let{playerInfo:e}=GameSDK.extra.getCoreserData();if(!e||!bt.isString(e)||!window.GameName)return;let t=`${window.GameName.replace(/ /g,"-")}_PlayerInfo`;QB.writeLocalStorage(t,{playerId:e})}disableSpeedUpSettings(){Nr.setSetting("speedUp",!1)}},$B=JB,$o=U(un()),{Events:kp,Utils:{Valid:Bp}}=Ludex,{ads:tN,event:th,adaptivePerformance:Cn}=codex,eN=class{init(){Cn&&this.listenEvents()}listenEvents(){th.on(kp.REQUEST_RESIZE_GAME,this.handleRequestResizeGame),window.phaser.renderer.once($o.RENDER,this.handleBeginFrame),th.on(kp.SCENE_LAUNCHED,this.handleAfterSceneLaunch)}handleBeginFrame=()=>{window.phaser.renderer.on($o.POST_RENDER,this.lateUpdate),window.phaser.renderer.on($o.PRE_RENDER,this.updateActualFPS)};handleAfterSceneLaunch=()=>{if(!Cn)return;let e=nt.getCurrentScene();e&&Cn.trackingScene(e.scene.key)};handleRequestResizeGame=e=>{if(tN.isAdFullSizeShowing())return;let{forcePixelRatio:t}=e;Bp.isNumber(t)&&th.emit(Qt.REQUEST_VIEW_RESIZE,{forcePixelRatio:t})};lateUpdate=()=>{Cn?.updatePostStepDeltaTime(window.phaser.loop.delta)};updateActualFPS=()=>{let e=window.phaser.loop.actualFps;Bp.isNumber(e)&&Cn?.updateActualFPS(e)}},iN=eN,{frameCapture:Q5}=codex,sN=class{async init(){}},nN=sN,rN={GLOBAL:"global-leaderboard-key",FRIENDS:"friends-leaderboard-key"},aN={GLOBAL:"global-leaderboard-id",FRIENDS:"friends-leaderboard-id"},{Configs:{Mockup:{Leaderboards:Np,GameSDK:{Player:oN}},Leaderboards:Up},Utils:{Number:Fp}}=Ludex,{leaderboard:oi}=codex,hN=class{init(){this.handleWhenGameSDKStarted()}handleWhenGameSDKStarted=()=>{Np.Enabled?this.setupLeaderboardsMockup():this.setupLeaderboards()};async setupLeaderboards(){this.setupLeaderboardByConfigs()}setupLeaderboardByConfigs(){let{LeaderboardList:e}=Up;for(let t of e){let{Id:i,Name:s}=t;oi.addLeaderboard({name:s,type:"global",autoSortRank:!0,leaderboardId:i})}}async setupLeaderboardsMockup(){this.setupMockGlobalLeaderboards(),this.setupMockFriendsLeaderboard()}async setupMockGlobalLeaderboards(){let{NumOfLeaders:e}=Np,{LeaderboardList:t}=Up;for(let i of t){let{Name:s,Id:n}=i;if(!s)continue;let r=await oi.createLeaderboardAsync({_id:n,name:s,numberOfLeaders:Fp.random(e.Max-e.Min)+e.Min});oi.addLeaderboard({name:s,type:"global",autoSortRank:!0,leaderboardId:r}),await oi.requestLeaderboardAsync(s,10);let o=oi.getLeaderboard(s);o=oi.getLeaderboard(s)}}async setupMockFriendsLeaderboard(){let e=rN.FRIENDS,t=aN.FRIENDS,i=0,{ConnectedPlayers:s}=oN;s.Enabled&&(i=Fp.random(s.NumOfPlayers-1)+1);let n=await oi.createLeaderboardAsync({_id:t,name:e,numberOfLeaders:i});oi.addLeaderboard({name:e,type:"friends",autoSortRank:!0,leaderboardId:n}),await oi.requestLeaderboardAsync(e,10);let r=oi.getLeaderboard(e)}},lN=hN,{missions:uN}=codex,cN=class{async init(){uN.requestMissions()}},dN=class{init(){}initFrameCapture(){new nN().init()}initLeaderboards(){new lN().init()}initMissions(){new cN().init()}initAdaptivePerformance(){new iN().init()}},pN=dN,Gp=U(vl()),gN=U(Nt()),{event:_n,monitorError:fN}=codex,{Events:Ur}=Ludex,Fr={duration:300,color:{r:0,g:0,b:0}},mN=class{sceneInfo;callbackSwitchScene=null;init(){this.listenEvents(),this.sceneInfo={sceneName:ct.BOOT_SCENE,sceneData:{}}}listenEvents(){_n.on(Ur.SWITCH_SCENE,this.switchScene),_n.on(Ur.SCENE_LOADED,this.handleSceneLoaded),_n.on(Ur.SCENE_LAUNCHED,this.handleSceneLaunched)}correctSceneName(e){let{sceneName:t}=e;return t===this.sceneInfo.sceneName?null:t===ct.DASHBOARD_SCENE?ct.GAME_SCENE:t}switchScene=async e=>{let{sceneData:t,transition:i}=e,s=this.correctSceneName(e);s&&this.startScene({sceneName:s,sceneData:t,transition:i})};sleepOtherScenes=e=>{let{scenes:t}=window.phaser.scene;for(let i of t)i.scene.isActive()&&i.scene.key!==e&&i.scene.key!==ct.GLOBAL_SCENE&&i.scene.sleep()};async startScene(e){let{sceneName:t,sceneData:i,transition:s}=e,{sceneName:n}=this.sceneInfo,{scene:r}=window.phaser;r.dump(),this.sceneInfo={sceneName:t,sceneData:i},s!==void 0&&(await this.fadeOutScene(n,s),window.phaser.scene.getScene(t).events.once(gN.PRE_RENDER,()=>{this.resetFadeOutScene(n),this.fadeInScene(t,s)})),r.switch(n,t),_n.emit(Qt.DESTROY_SCREENS,{sceneKey:n}),r.dump(),nt.setCurrentScene(t)}resetFadeOutScene(e){window.phaser.scene.getScene(e).cameras.main.fadeEffect.reset()}fadeInScene(e,t){let{duration:i=Fr.duration,color:s=Fr.color}=t,n=window.phaser.scene.getScene(e);return n.cameras.main.fadeIn(i,s.r,s.g,s.b),new Promise(r=>{n.cameras.main.once(Gp.Scene2D.Events.FADE_IN_COMPLETE,r)})}fadeOutScene(e,t){let{duration:i=Fr.duration,color:s=Fr.color}=t,n=window.phaser.scene.getScene(e);return n.cameras.main.fadeOut(i,s.r,s.g,s.b),new Promise(r=>{n.cameras.main.once(Gp.Scene2D.Events.FADE_OUT_COMPLETE,r)})}handleSceneLoaded=e=>{let{sceneName:t,sceneData:i}=this.sceneInfo;e.sceneName===t&&this.setSceneData(t,i??{})};handleSceneLaunched=e=>{let{sceneName:t,sceneData:i}=this.sceneInfo;e.sceneName===t&&(xt.switchSceneTracking(),fN?.addMetadata({currentScene:t}),this.callbackSwitchScene?.({sceneName:t,sceneData:i}),this.sleepOtherScenes(t),_n.emit(Ur.SCENE_RENDERED,{sceneName:t}))};onSwitchScene(e){this.callbackSwitchScene=e}setSceneData(e,t){if(!t)return;let i=window.phaser.scene.getScene(e),s={...i.data.get("data"),...t};i.data.set("data",s)}},vN=mN,EN=U(it()),Ws=U(dt()),yN=U(ft()),TN=class extends EN.Container{payload;process;minProcess;maxProcess;progressBoxLeft;progressBoxBg;progressBoxRight;progressBarLeft;progressBarBg;progressBarRight;progressAnimation;constructor(e,t){super(e),this.payload=t;let i=t.width;this.setSize(i,39),this.process=0,this.minProcess=0,this.maxProcess=1,this.createProgressBox(),this.createProgressBar(),this.createContainer()}setProcess(e,t=!1){if(this.process=this.getCorrectValue(e),!this.scene||t){this.updateProcess();return}this.runProcessAnimation(e)}updateProcess(){let{displayHeight:e}=this.progressBarBg,t=this.getDisplayWidthByProcess(this.process);this.progressBarBg.setWorldSize(t,e);let{x:i}=this.progressBarBg;this.progressBarRight.setX(i+t)}getCorrectValue(e){let t=e;return isFinite(t)||(t=0),t<this.minProcess&&(t=this.minProcess),t>this.maxProcess&&(t=this.maxProcess),t}getDisplayWidthByProcess(e){let{width:t}=this;return(t-17)*e}getProcessByDisplayWidth(e){let{width:t}=this;return e/(t-17)}runProcessAnimation(e){this.progressAnimation?.remove(),this.progressAnimation=this.scene.add.tween({targets:[this.progressBarBg],duration:1e3,ease:yN.Quadratic.InOut,props:{displayWidth:()=>{let t=this.getCorrectValue(e);return this.getDisplayWidthByProcess(t)}},onUpdate:()=>{let{x:t,displayWidth:i}=this.progressBarBg;this.progressBarRight.setX(t+i)},onComplete:()=>{this.updateProcess()}})}createProgressBox(){let{key:e,frames:t}=this.payload;this.progressBoxLeft=this.scene.make.image({key:e,frame:t.PROGRESS_BG_LEFT}),this.progressBoxLeft.setOrigin(0,.5),this.progressBoxLeft.setWorldSize(9,39),this.progressBoxRight=this.scene.make.image({key:e,frame:t.PROGRESS_BG_RIGHT}),this.progressBoxRight.setOrigin(0,.5),this.progressBoxRight.setWorldSize(9,39),this.progressBoxBg=this.scene.make.image({key:e,frame:t.PROGRESS_BG_MID}),this.progressBoxBg.setOrigin(0,.5),this.progressBoxBg.setWorldSize(9,39);let{displayHeight:i}=this.progressBoxBg,{displayWidth:s}=this,{displayWidth:n}=this.progressBoxLeft,{displayWidth:r}=this.progressBoxRight;this.progressBoxLeft.setWorldSize(n,i),this.progressBoxRight.setWorldSize(r,i),this.progressBoxBg.setWorldSize(s-(n+r),i),Ws.Align.In.Center(this.progressBoxBg,this,0,0),Ws.Align.In.LeftCenter(this.progressBoxLeft,this,0,0),Ws.Align.In.RightCenter(this.progressBoxRight,this,0,0)}createProgressBar(){let{key:e,frames:t}=this.payload;this.progressBarLeft=this.scene.make.image({key:e,frame:t.PROGRESS_BAR_LEFT}),this.progressBarLeft.setOrigin(0,.5),this.progressBarLeft.setWorldSize(8.5,32),this.progressBarRight=this.scene.make.image({key:e,frame:t.PROGRESS_BAR_RIGHT}),this.progressBarRight.setOrigin(0,.5),this.progressBarRight.setWorldSize(8.5,32),this.progressBarBg=this.scene.make.image({key:e,frame:t.PROGRESS_BAR_MID}),this.progressBarBg.setOrigin(0,.5),this.progressBarBg.setWorldSize(8.5,32);let i=-2,s=-1.6;Ws.Align.In.LeftCenter(this.progressBarBg,this,-7,s),Ws.Align.In.LeftCenter(this.progressBarLeft,this,i,s),Ws.Align.In.LeftCenter(this.progressBarRight,this,i,s),this.setProcess(0,!0)}createContainer(){this.add([this.progressBoxBg,this.progressBoxLeft,this.progressBoxRight,this.progressBarBg,this.progressBarLeft,this.progressBarRight]),this.scene.add.existing(this)}},SN=TN,AN=U(ft()),xN=U(dt()),{language:eh}=codex,{KEY:wN,FRAME:RN}=W.DEFAULT,CN=class extends SN{loadingText;constructor(e,t){super(e,{key:wN,frames:RN,width:t}),this.createLoadingText()}createLoadingText(){this.loadingText=Z.buildText(`${eh.getText("LOADING").toUpperCase()}0%`,20).setDefaultStroke().setFixedWidth(13*20).setAlign("center").setHighQuality().setDefaultShadow({offsetY:12}).build(this.scene),this.add(this.loadingText),xN.Align.In.Center(this.loadingText,this,0,-2)}updateProcess(){let{displayHeight:e}=this.progressBarBg,t=this.getDisplayWidthByProcess(this.process);this.progressBarBg.setWorldSize(t,e);let{x:i}=this.progressBarBg;if(this.progressBarRight.setX(i+t),this.loadingText){let s=Math.floor(this.getProcessByDisplayWidth(t)*100);this.loadingText.setText(`${eh.getText("LOADING").toUpperCase()}${s}%`)}}runProcessAnimation(e){this.progressAnimation?.stop(),this.progressAnimation?.remove(),this.progressAnimation=this.scene.add.tween({targets:[this.progressBarBg],duration:600,ease:AN.Circular.InOut,props:{displayWidth:()=>{let t=this.getCorrectValue(e);return this.getDisplayWidthByProcess(t)}},onUpdate:()=>{let{x:t,displayWidth:i}=this.progressBarBg;this.progressBarRight.setX(t+i);let s=Math.floor(this.getProcessByDisplayWidth(i)*100);this.loadingText.setText(`${eh.getText("LOADING").toUpperCase()}${s}%`)},onComplete:()=>{this.updateProcess()}})}},_N=CN,bN={SCREEN:200,POPUP:300,SPLASH:400,PRIORITY:999},hi=bN,Yp=U(dt()),PN=U(ci()),{KEY:LN,FRAME:IN}=W.DEFAULT_8_BIT,MN=class extends ye{progressBar;constructor(e,t){super(e,t),this.background.setAlpha(.8),this.setDepth(hi.SPLASH),this.createTitleIcon(),this.createProgressBar(),this.scene.game.scene.getScene(ct.LOAD_SCENE).load.on(PN.PROGRESS,i=>{this.progressBar.setProcess(i)})}open(e){super.open(e),this.progressBar.setProcess(0,!0),nt.getGlobalScene()?.requestBackgroundMaskUpdate(tt.LOADING_SCREEN,.8),this.scene.time.delayedCall(200,()=>{this.progressBar.setProcess(.2)})}close(){this.scene.time.delayedCall(600,()=>{let e=nt.getGlobalScene();e?.requestBackgroundMaskUpdate(tt.LOADING_SCREEN,0);let t=ot.getScreen(tt.BATTLE_SCREEN);t&&!t.visible&&e?.requestBackgroundMaskUpdate(tt.BATTLE_SCREEN,0);let i=ot.getScreen(tt.LEADER_BOARD_SCREEN);i&&!i.visible&&e?.requestBackgroundMaskUpdate(tt.LEADER_BOARD_SCREEN,0),this.progressBar.setProcess(1),super.close()})}createTitleIcon(){let e=this.scene.make.image({key:LN,frame:IN.ICON_TITLE});e.setWorldSize(213.5,157.5),Yp.Align.In.Center(e,this,0,-150),this.add(e)}createProgressBar(){this.progressBar=new _N(this.scene,450),this.progressBar.setScale(.6),Yp.Align.In.Center(this.progressBar,this),this.add(this.progressBar)}},ON=MN,DN={duration:300,ease:Wo,props:{scale:{from:1.2,to:1}}},ns=DN,ih=U(dt()),kN=U(ft()),BN=U(it()),NN=class extends BN.Container{constructor(e,t,i,s){let n=e.make.image(t);super(e,i,s,[n]),this.setSize(n.width,n.height),e.add.existing(this)}},UN=NN,Hp=U(Zt()),{Utils:{Signal:FN}}=Ludex,{KEY:GN,FRAME:YN}=W.DEFAULT_8_BIT,HN=class extends ye{t;o;l;animController=new FN.SignalController;N;constructor(e,t){super(e,t),this.t=this.nt(),this.o=this.rt(),this.l=this.at(),this.add([this.t,this.o,this.l]),ih.Align.In.Center(this.o,this.zone,0,-40),ih.Align.In.Center(this.t,this.zone,0,-40),ih.Align.In.Center(this.l,this.zone,0,40),this.setDepth(hi.PRIORITY)}open(e){super.open(e);let{message:t="",duration:i=0,loading:s=!1,enableCloseOnTouch:n=!1}=e;this.ot(t),this.ht(s),this.N?.remove();let r=()=>{n&&this.scene.input.off(Hp.POINTER_DOWN,r),this.visible&&this.lt()};n&&this.scene.input.once(Hp.POINTER_DOWN,r),i>0&&(this.N=this.scene.time.addEvent({delay:i,callback:r})),this.ut()}nt(){return new UN(this.scene,{key:GN,frame:YN.ICON_ALERT})}rt(){return new Sn(this.scene)}at(){return Z.buildText("",24).setDefaultStroke().setDefaultShadow({offsetX:0,offsetY:3}).setOrigin({x:.5,y:0}).setAlign("center").setWordWrap({width:this.zone.width-50,useAdvancedWrap:!0}).build(this.scene)}ot(e){this.l.setText(e)}ht(e){this.o.setVisible(e),this.t.setVisible(!e)}ut(){let e=this.animController.renew();this.background.setAlpha(0),this.animateBackgroundAlpha(.8),gt.runTween(this.scene.tweens.add({...ns,targets:[this.o,this.t,this.l],props:{scale:{from:.7,to:1},alpha:1}}),e)}lt(){let e=this.animController.renew();this.animateBackgroundAlpha(0,200),gt.runTween(this.scene.tweens.add({duration:300,targets:[this.o,this.t,this.l],ease:kN.Cubic.Out,props:{scale:{from:1,to:.7},alpha:0},onComplete:()=>{ot.closeScreen(this.name)}}),e)}},WN=HN,sh=U(ft()),zN={props:{alpha:{start:0,to:1,duration:500,ease:sh.Cubic.Out},scale:{start:.8,to:1,duration:1e3,ease:sh.Elastic.Out,easeParams:[.1,.45]},y:{start:0,to:0,duration:500,ease:sh.Back.Out}},delay:0},fe=zN,{KEY:VN,FRAME:XN}=W.DEFAULT_8_BIT,KN=class extends Gt{constructor(e){super(e,VN,XN.BUTTON_CLOSE,31.5,31.5),this.scene=e,this.setName("Close")}playSound(){ut.playSound(Et.CLOSE_CLICK,{volume:.3})}},Ni=KN,jN=U(oc()),ZN=`
precision mediump float;

uniform sampler2D uMainSampler;
// uniform vec2 uResolution; //khong co
uniform float uCameraZoom;

uniform vec2 iResolution;

uniform vec4 lightPosition;
uniform vec4 lightColor;
uniform float lightRadius;
uniform float lightAttenuation;

varying vec2 outTexCoord;
varying float outTintEffect;
varying vec4 outTint;

void main (void)
{
    vec4 pos = vec4(0.2, 0.3, 1.0, 200);

    // vec2 center = (lightPosition.xy + 1.0) * (iResolution.xy * 0.5);
    // vec2 center = lightPosition.xy
    float distToSurf = length(lightPosition.xy / uCameraZoom - gl_FragCoord.xy / uCameraZoom);
    float radius = 1.0 - distToSurf / lightRadius;
    /* if (distToSurf > 50.0) {
        gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);
        return; 
    } */
    /* if (radius > 0.5) {
        gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);
        return; 
    } */
    
    float intensity = smoothstep(0.0, 1.0, radius * lightAttenuation);
    /* if (intensity == 0.0) {
        gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);
        return;
    } */

    vec4 color = vec4(intensity, intensity, intensity, 0.0) * lightColor;
    gl_FragColor = vec4(color.rgb * lightColor.a, color.a);
}
`,qN=class extends jN.SinglePipeline{static KEY="GlowLightPipeLine";constructor(e){super({game:e,fragShader:ZN})}onRender(e,t){this.set1f("uCameraZoom",t.zoom)}},Gr=qN,QN=U(it()),JN=U(Li()),nh=U($u()),{KEY:$N,FRAME:tU}=W.DEFAULT_8_BIT,eU=class extends QN.Container{config;shaderSprite;isWebGl=!0;lightRadius=0;constructor(e,t){super(e),this.config={background:0,bottomRightCorner:221341,rightEdge:423092,bottomEdge:83583,mainTopColorGradient:732242,mainBotColorGradient:155294,shadowHeight:7,bgCornerStrokeWidth:2,topInnerCornerStrokeWidth:4,botInnerCornerStrokeWidth:4,rightInnerCornerStrokeWidth:4,lightX:0,lightY:0,...t},this.scene.game.canvas.getContext("webgl")||(this.isWebGl=!1),this.isWebGl&&!this.scene.game.renderer.pipelines.pipelines.has(Gr.KEY)&&this.scene.game.renderer.pipelines.add(Gr.KEY,new Gr(this.scene.game)),this.setDepth(rt.POPUP),this.createGraphicsPopup(),this.createShaderSprite(),this.createLightEffect(),this.updateSize(),this.scene.add.existing(this)}updateSize(){let{width:e,height:t}=this.config;this.setWorldSize(e,t)}createGraphicsPopup(){let{x:e,y:t,width:i,height:s,background:n,bottomRightCorner:r,rightEdge:o,bottomEdge:a,mainBotColorGradient:h,mainTopColorGradient:l,shadowHeight:c,bgCornerStrokeWidth:f,topInnerCornerStrokeWidth:u,botInnerCornerStrokeWidth:p,rightInnerCornerStrokeWidth:d}=this.config,g=this.scene.make.graphics({}),m=new JN.Rectangle(e-i/2,t-s/2,i,s);g.fillStyle(0,.3),g.fillRoundedRect(m.left,m.bottom-10,m.width,10+c,{tl:0,tr:0,bl:12,br:12}),g.fillStyle(n),g.fillRoundedRect(m.left,m.top,m.width,m.height,{tl:8,tr:8,bl:12,br:12}),g.fillStyle(r),g.fillRoundedRect(m.left+f,m.bottom-50,m.width-f*2,50-f,{tl:0,tr:0,bl:30,br:8}),g.fillStyle(o),g.fillRoundedRect(m.left+f,m.top+f,m.width-f*2,m.height-f*2-p,{tl:8,tr:8,bl:30,br:12}),g.fillStyle(a),g.fillRoundedRect(m.left+f,m.bottom-50,m.width-f*2-d,50-f,{tl:8,tr:0,bl:8,br:3}),g.fillGradientStyle(l,l,h,h),g.fillRect(m.left+f,m.top+f+u+10,m.width-f*2-d,m.height-f*2-p-u-20),g.fillStyle(l),g.fillRoundedRect(m.left+f,m.top+f+u,m.width-f*2-d,10,{tl:8,tr:8,bl:0,br:0}),g.fillStyle(h),g.fillRoundedRect(m.left+f,m.bottom-f-p-10,m.width-f*2-d,7,{tl:0,tr:0,bl:3,br:0}),this.add(g)}createShaderSprite(){let{width:e,height:t}=this.config,i=this.scene.make.image({key:$N,frame:tU.BLANK});i.setWorldSize(e,t),this.add(i),this.shaderSprite=i,this.shaderSprite.kill()}createLightEffect(){if(!this.isWebGl)return;let{width:e,mainTopColorGradient:t}=this.config;this.shaderSprite.revive(),this.shaderSprite.setPipeline(Gr.KEY);let i=(0,nh.ColorToRGBA)(t),s=(0,nh.ObjectToColor)({r:i.r,g:i.g,b:i.b,a:i.a});s.lighten(90);let n=(0,nh.ColorToRGBA)(s.color),r=this.scene.game.canvas.getContext("webgl")?.drawingBufferWidth,o=this.scene.game.canvas.getContext("webgl")?.drawingBufferHeight;if(!r||typeof r!="number"||!o||typeof o!="number")return;this.lightRadius=e/1.2,this.recalculateLightPosition();let a=1;this.shaderSprite.pipeline.set2f("iResolution",r,o),this.shaderSprite.pipeline.set4f("lightColor",n.r/255*a,n.g/255*a,n.b/255*a,.4),this.shaderSprite.pipeline.set1f("lightRadius",this.lightRadius),this.shaderSprite.pipeline.set1f("lightAttenuation",1)}turnOffLight(){this.shaderSprite.kill(),this.shaderSprite.resetPipeline()}recalculateLightPosition(){if(!this.isWebGl||!this.shaderSprite.active||!(this.scene instanceof mn)||!this.shaderSprite.pipeline)return;let{lightX:e,lightY:t}=this.config,{width:i,height:s}=$.getWorldSize(),n=this.scene.game.renderer,r=n.width||this.scene.game.canvas.getContext("webgl")?.drawingBufferWidth,o=n.height||this.scene.game.canvas.getContext("webgl")?.drawingBufferHeight;if(!r||typeof r!="number"||!o||typeof o!="number")return;let a=this.shaderSprite.getWorldPosition(),h=r*(i/2+a.x+e)/i,l=o*(s-(s/2+a.y+t))/s;try{this.shaderSprite.pipeline.set4f("lightPosition",h,l,1e3,this.lightRadius),this.shaderSprite.pipeline.set1f("lightRadius",this.lightRadius)}catch{}}},Ui=eU,iU=U(dt()),{KEY:Wp,FRAME:zp}=W.DEFAULT_8_BIT,{language:Vp}=codex,sU=class extends Gt{constructor(e){super(e,Wp,zp.OFFLINE_REWARD_GREEN_BTN,128.5,45.5),this.createCoinIcon(),this.createText()}createCoinIcon(){let e=this.scene.make.image({key:Wp,frame:zp.OFFLINE_REWARD_GOLD});e.setWorldSize(32.5,30.5),e.setPosition(-35,0),this.add(e)}createText(){let e=Vp.getCurrentLocale(),t=15;switch(e){case"de":case"it":t=13;break}let i=Z.buildText(Vp.getText("COLLECT"),t).setDefaultStroke().setOrigin({x:.5,y:.65}).setFixedWidth(13*15).setAlign("center").setHighQuality().build(this.scene);iU.Align.In.RightCenter(i,this.button,0,0),i.setPosition(15,0),this.add(i)}},nU=sU,rU=U(it()),{KEY:aU,FRAME:oU}=W.DEFAULT_8_BIT,hU=class extends rU.Container{icon;text;constructor(e){super(e),this.createIcon(),this.createCoinText(),this.scene.add.existing(this)}createIcon(){let e=this.scene.make.image({key:aU,frame:oU.OFFLINE_REWARD_GOLDS});e.setWorldSize(55,39.5),e.setPosition(50,0),this.add(e),this.icon=e}createCoinText(){let e=Z.buildText("+100 coins",35).setColor("#F0DB0F").setFixedWidth(455).setAlign("center").setDefaultStroke().setHighQuality().setDefaultShadow({offsetX:-8,offsetY:8}).build(this.scene);e.setPosition(-30,0),this.add(e),this.text=e}setText(e){this.text.setText(`+${e}`)}},lU=hU,uU=U(it()),{KEY:cU,FRAME:dU}=W.DEFAULT_8_BIT,{language:pU}=codex,gU=class extends uU.Container{constructor(e){super(e),this.createRibbon(),this.createTitle(),this.scene.add.existing(this)}createRibbon(){let e=this.scene.make.image({key:cU,frame:dU.OFFLINE_REWARD_RIBBON});e.setWorldSize(247,43.5),this.add(e)}createTitle(){let e=Z.buildText(pU.getText("OFFLINE_COINS_REWARDS").toUpperCase(),15).applyScreenHeaderStyle().setFixedWidth(195).build(this.scene);e.setPosition(0,-4),this.add(e)}createUnderlineText(){let e=Z.buildText("Get Free Coins!",12).setColor("#D5330F").setFixedWidth(130).setAlign("center").setHighQuality().build(this.scene);e.setPosition(0,5),this.add(e)}},fU=gU,Xp=U(it()),Yr=U(yt()),mU=class extends Xp.Container{payload;constructor(e,t){super(e),this.payload=t,this.createGraphics(),this.scene.add.existing(this)}createGraphics(){let{lineNumber:e=16}=this.payload;for(let t=0;t<e;t++){let i=this.drawCardinalTriangle(),s=(0,Yr.DegToRad)(t*(360/e));i.setPosition(0,0),i.setRotation(s),this.scene.add.existing(i),this.add(i)}}drawCardinalTriangle(){let{color:e,radius:t,width:i}=this.payload,s=Yr.RND.between(t.min,t.max),n=new Xp.Graphics(this.scene);n.clear();let r=[{x:0,y:0}],o=Yr.RND.between(i.min,i.max),a=(0,Yr.DegToRad)(o),h={x:s,y:s*Math.tan(a)};r.push(h);let l={x:s,y:s*Math.tan(a)*-1};r.push(l),n.lineStyle(1,16777215,0),n.beginPath(),n.moveTo(r[0].x,r[0].y);for(let c=1;c<r.length;c++)n.lineTo(r[c].x,r[c].y);return n.closePath(),n.strokePath(),n.fillGradientStyle(e,e,e,e,0,1,0,1),n.fillPath(),n}},Kp=mU,vU=U(it()),jp=U(yt()),EU=U(ft()),{KEY:bn,FRAME:Pn}=W.DEFAULT_8_BIT,yU=class extends vU.Container{listParticle=[];backEffect;tween;backEffectTween;constructor(e){super(e),this.createBackEffect(),this.createTicketCoin(),this.createParticle(),this.createAnimation(),this.scene.add.existing(this)}createBackEffect(){let e=new Kp(this.scene,{color:234748,width:{min:4,max:8},radius:{min:180,max:170},lineNumber:18});e.setPosition(0,110),this.add(e),this.backEffect=e}createTicketCoin(){let e=this.scene.make.image({key:bn,frame:Pn.OFFLINE_REWARD_TICKET});e.setWorldSize(155.5,124.5),e.setPosition(0,110),this.add(e)}createParticle(){let e=this.scene.make.image({key:bn,frame:Pn.OFFLINE_REWARD_PARTICLE_1});e.setWorldSize(23,23),e.setPosition(-102,100),this.add(e),this.listParticle.push(e),e=this.scene.make.image({key:bn,frame:Pn.OFFLINE_REWARD_PARTICLE_1}),e.setWorldSize(23,23),e.setPosition(78,156),this.add(e),this.listParticle.push(e),e=this.scene.make.image({key:bn,frame:Pn.OFFLINE_REWARD_PARTICLE_2}),e.setWorldSize(14.5,15),e.setPosition(-90,129),this.add(e),this.listParticle.push(e),e=this.scene.make.image({key:bn,frame:Pn.OFFLINE_REWARD_PARTICLE_2}),e.setWorldSize(14.5,15),e.setPosition(100,110),this.add(e),this.listParticle.push(e),this.listParticle.push(e)}createAnimation(){let e=this.listParticle[0].scale;this.tween=this.scene.add.tween({paused:!0,targets:this.listParticle,duration:800,ease:EU.Cubic.Out,repeat:-1,yoyo:!0,delay:this.scene.tweens.stagger(50,{start:Math.random()*50+50}),props:{scale:{from:e,to:e*(0,jp.FloatBetween)(.7,.9)}}}),this.backEffectTween=this.scene.add.tween({paused:!0,targets:this.backEffect,duration:1e6,ease:jp.Linear,repeat:-1,props:{rotation:{start:0,to:180}}})}runAnimation(){this.tween.resume(),this.backEffectTween.resume()}stopAnimation(){this.tween.pause(),this.backEffectTween.pause()}},TU=yU,SU=U(dt()),{KEY:Zp,FRAME:qp}=W.DEFAULT_8_BIT,{language:Qp}=codex,AU=class extends Gt{constructor(e){super(e,Zp,qp.OFFLINE_REWARD_YELLOW_BTN,128.5,45.5),this.createCoinIcon(),this.createText()}createCoinIcon(){let e=this.scene.make.image({key:Zp,frame:qp.OFFLINE_REWARD_ADS});e.setWorldSize(32,30),e.setPosition(-40,-3),this.add(e)}createText(){let e=Qp.getCurrentLocale(),t=15;switch(e){case"pt":case"es":t=12;break;case"de":case"it":t=13;break}let i=Z.buildText(Qp.getText("X2_COINS").toUpperCase(),t).setOrigin({x:.5,y:.65}).setFixedWidth(13*15).setAlign("center").setDefaultStroke().setHighQuality().build(this.scene);SU.Align.In.RightCenter(i,this.button,0,0),i.setPosition(15,0),this.add(i)}},xU=AU,zs=U(dt()),wU=U(ft()),{Plugins:{Ads:{Types:{REWARDED_VIDEO:RU}}}}=Ludex,{Utils:{Signal:CU}}=Ludex,_U=class extends ye{rewardValue;closeBtn;collectButton;viewAdButton;coinIcon;contents;title;popup;screenAnimController=new CU.SignalController;adsTimer;constructor(e,t){super(e,t),this.setName(t),this.setDepth(hi.POPUP),this.background.setAlpha(.7),this.createPopup(),this.createTicketCoinIcon(),this.createCloseBtn(),this.createContents(),this.createTitle(),this.createCollectButton(),this.createViewAdsButton()}open=e=>{super.open(e),this.scene.scene.get(ct.GAME_SCENE)instanceof St&&ot.listenResizeEventForCalculateLight(this),wt.isReadyAdShowable(RU)?this.viewAdButton.setDisabled(!1):this.viewAdButton.setDisabled(!0);let t=this.getData("rewardValue");this.setRewardValue(this.calculateRewardCoins(t)),this.runOpenAnimation()};createPopup(){this.popup=new Ui(this.scene,{x:0,y:0,width:332,height:404.5,rightEdge:870778,bottomRightCorner:221341,topInnerCornerStrokeWidth:2,rightInnerCornerStrokeWidth:3,lightY:-80}),this.add(this.popup)}recalculateLightPosition(){this.popup&&this.popup.recalculateLightPosition()}createTicketCoinIcon(){let e=new TU(this.scene);zs.Align.In.TopCenter(e,this.popup,0,-30),this.add(e),this.coinIcon=e}createCloseBtn(){let e=new Ni(this.scene);e.onClick=this.handleClosePopup,zs.Align.In.TopRight(e,this.popup,10,10),this.popup.add(e),this.closeBtn=e}createContents(){let e=new lU(this.scene);zs.Align.In.Center(e,this.popup,0,60),this.add(e),this.contents=e}createTitle(){let e=new fU(this.scene);zs.Align.In.TopCenter(e,this.popup,0,-10),this.add(e),this.title=e}createCollectButton(){let e=new nU(this.scene);e.setName("Collect"),e.onClick=this.handleClosePopup,zs.Align.In.BottomCenter(e,this.popup,-70,-20),this.add(e),this.collectButton=e}createViewAdsButton(){let e=new xU(this.scene);e.setName("CollectX2"),e.onClick=this.handleShowRewardedVideoAd,zs.Align.In.BottomCenter(e,this.popup,70,-20),this.add(e),this.viewAdButton=e}handleClosePopup=()=>{this.runCloseAnimation(),this.rewardCoins(this.rewardValue)};handleShowRewardedVideoAd=async()=>{if(this.viewAdButton.setDisabled(!0),await wt.showRewardVideoAdAsync()){ut.playSound(Et.DAILY_REWARD);let e=this.rewardValue.clone();e.multiply(2),this.rewardCoins(e),this.runCloseAnimation()}this.viewAdButton.setDisabled(!1)};runOpenAnimation(){nt.getGlobalScene()?.requestBackgroundMaskUpdate(tt.OFFLINE_REWARD_SCREEN,this.background.alpha);let e=this.screenAnimController.renew();this.animateBackgroundAlpha(.7,200),this.runPopupEntrancesAnimation(e),this.runPopupContentEntrancesAnimation(100,400,e)}runCloseAnimation=()=>{let e=this.screenAnimController.renew();this.runExitsAnimation(0,200,e)};runPopupEntrancesAnimation(e){gt.runTween(this.scene.tweens.add({...fe,paused:!0,targets:[this.popup,this.title],onStart:()=>{this.popup.revive()}}),e)}runPopupContentEntrancesAnimation(e,t,i){this.coinIcon.runAnimation();let s=[this.collectButton,this.viewAdButton,this.contents],n=s.map(r=>r.alpha);s.forEach(r=>r.setAlpha(0)),gt.runTween(this.scene.tweens.add({...ns,targets:s,duration:t,delay:this.scene.tweens.stagger(100,{start:e}),props:{scale:{getStart:r=>r.scale-.3,getEnd:r=>r.scale},alpha:{getStart:()=>0,getEnd:(r,o,a,h)=>n[h]}}}),i)}rewardCoins(e){let t=e;_t.inst.addCoin(t);let i=this.scene.scene.get(ct.GAME_SCENE);i instanceof St&&i.updateUI()}calculateRewardCoins(e){let t=e/60>24?24:e/60,i=this.getUnitPriceFromGameScene(),s=new Dt(Q.BASE_UNIT_COIN),n=this.getMaxRewardUnitCount()*(t/24);return i.multiply(n),i.smallerThan(s)&&(i=s),i}getUnitPriceFromGameScene(){let e=this.scene.scene.get(ct.GAME_SCENE);if(!(e instanceof St))return new Dt(2);let{unitManager:t,coinManager:i}=e,s=t.getPlayerMeleeSpawnedUnitsCount(),n=t.getPlayerRangedSpawnedUnitsCount(),r=s>n?s:n;return i.getUnitPrice(r)}getMaxRewardUnitCount(){let e=At.getLevelProgress();return e<0&&(e=0),e++,e>=251?4.5:e>=151?6.5:e>=51?8.5:12.5}runExitsAnimation(e,t,i){this.collectButton.setDisabled(!0);let s=[this.coinIcon,this.contents,this.title,this.collectButton,this.viewAdButton];this.animateBackgroundAlpha(0,200),gt.runTween(this.scene.tweens.add({paused:!0,targets:s,delay:e,duration:t,props:{alpha:{start:.7,from:.7,to:0}},ease:wU.Cubic.Out,onStart:()=>{this.popup.kill()},onUpdate:(n,r)=>{nt.getGlobalScene()?.requestBackgroundMaskUpdate(tt.OFFLINE_REWARD_SCREEN,r.alpha)},onComplete:()=>{this.scene.scene.get(ct.GAME_SCENE)instanceof St&&ot.removeResizeEventForCalculateLight(this),ot.closeScreen(this.name),this.collectButton.setDisabled(!1),this.coinIcon.stopAnimation()}}),i)}setRewardValue(e){this.rewardValue=e,this.contents.setText(e.toString())}},bU=_U,PU=U(Ka()),LU=(0,PU.default)(.55,.47,.43,.91),IU=LU,MU={yoyo:!0,repeat:-1,duration:600,repeatDelay:50,ease:IU,easeParams:[0,.9],props:{scale:{from:1,to:1.2}}},Jp=MU,OU=U(ft()),DU=U(ow()),kU={repeat:-1,yoyo:!0,duration:33,ease:OU.Sine.InOut},BU=class{posX;tween;constructor(e,t){let i={...kU,...t,props:{x:t.shakeX??5,...t.props}};this.posX=typeof i.props.x=="number"?i.props.x:5,this.tween=e.tweens.add(i),this.tween?.on(DU.Events.TWEEN_REPEAT,this.handleSwitchPosition,this)}handleSwitchPosition(){this.posX=-this.posX,this.tween?.updateTo("x",-this.posX)}},$p=BU,NU=class extends Gt{paddingZone;showDebugZone;debugZone;constructor(e,t){let{key:i,frame:s,width:n,height:r,usePixelPerfect:o}=t;super(e,i,s,n,r,o);let{paddingZone:a=0,showDebugZone:h=!1}=t;this.paddingZone=a,this.showDebugZone=h}updateSize(){super.updateSize();let{width:e,height:t}=this,i=e+this.paddingZone,s=t+this.paddingZone;this.setSize(i,s),this.hitZone.setSize(i,s),this.showDebugZone&&(this.debugZone?.destroy(),this.debugZone=this.hitZone.drawDebugBox(10699282,.5),this.add(this.debugZone))}},tg=NU,UU=U(it()),eg=U(ft()),FU=U(Li()),{KEY:GU,FRAME:YU}=W.EFFECTS,HU=class extends UU.Container{emitZone;emitter;constructor(e){super(e),this.createEmitZone(),this.createEmitters(),this.scene.add.existing(this)}createEmitZone(){this.emitZone=new FU.Rectangle}createEmitters(){let e=1/$.getPixelRatio();this.emitter=this.scene.make.particles({key:GU,config:{frame:YU.FX_COMET,emitZone:{source:this.emitZone,type:"random"},deathZone:{source:this.emitZone,type:"onLeave"},timeScale:1,frequency:150,speedY:{min:-20,max:-60},alpha:{start:1,end:0,ease:eg.Cubic.Out},scale:{start:e*1,end:0,ease:eg.Cubic.Out},lifespan:{min:1500,max:2500}}})}run(e,t,i,s,n){this.stop(),this.emitZone.setSize(s,n),this.emitZone.setPosition(t-s/2,i-n/2),this.emitter.setQuantity(e),this.emitter.start()}stop(){this.emitter?.killAll(),this.emitter?.stop()}},WU=HU,zU=U(it()),VU=U(Li()),ig=U(yt()),{KEY:XU,FRAME:KU}=W.DEFAULT_8_BIT,jU=class extends zU.Container{emitZone;emitter;constructor(e){super(e),this.createEmitZone(),this.scene.add.existing(this)}createEmitZone(){this.emitZone=new VU.Rectangle}createEmitters(){let e=1/$.getPixelRatio();this.emitter=this.scene.make.particles({key:XU,config:{frame:KU.UNIT_REWARD_PARTICLE,emitZone:{source:this.emitZone,type:"random"},timeScale:1,frequency:100,rotate:{min:0,max:90},alpha:{start:1,end:0,ease:ig.Easing.Expo.Out},scale:{start:e*1,end:0,ease:ig.Easing.Expo.Out},lifespan:{min:3e3,max:4500}}})}run(e,t,i,s,n,r=100){this.stop(),this.reset(),this.emitZone.setSize(s,n),this.emitZone.setPosition(t-s/2,i-n/2),this.emitter.setQuantity(e),this.emitter.setFrequency(r),this.emitter.start()}stop(){this.emitter?.killAll(),this.emitter?.stop()}reset(){this.createEmitters()}},ZU=jU,qU=U(it()),QU=U(Li()),sg=U(ft()),{KEY:JU,FRAME:$U}=W.DEFAULT_8_BIT,tF=class extends qU.Container{emitZone;emitter;constructor(e){super(e),this.createEmitZone(),this.createEmitters(),this.scene.add.existing(this)}createEmitZone(){this.emitZone=new QU.Rectangle}createEmitters(){let e=1/$.getPixelRatio();this.emitter=this.scene.make.particles({key:JU,config:{frame:$U.UNIT_REWARD_ELLIPSE_FX,emitZone:{source:this.emitZone,type:"random"},deathZone:{source:this.emitZone,type:"onLeave"},timeScale:1,frequency:150,speedY:{min:-20,max:-60},alpha:{start:1,end:0,ease:sg.Cubic.Out},scale:{start:e*1,end:0,ease:sg.Cubic.Out},lifespan:{min:1500,max:2500}}})}run(e,t,i,s,n){this.stop(),this.emitZone.setSize(s,n),this.emitZone.setPosition(t-s/2,i-n/2),this.emitter.setQuantity(e),this.emitter.start()}stop(){this.emitter?.killAll(),this.emitter?.stop()}},eF=tF,iF=U(it()),sF=U(yt()),{Utils:{Signal:nF}}=Ludex,{KEY:rh,FRAME:ah}=W.DEFAULT_8_BIT,rF=class extends iF.Container{giftAdIcon;particleTweens=[];bubbleTwinkleUp;iconAttentionAnimController=new nF.SignalController;constructor(e){super(e),this.createGlow(),this.createFx(),this.createCurrencyIcon(),this.updateSize(),this.createEllipses(),this.createParticles(),this.scene.add.existing(this)}createGlow(){let e=this.scene.make.image({key:rh,frame:ah.UNIT_REWARD_GLOW});e.setWorldSize(372.5,372.5),this.add(e)}createFx(){let e=this.scene.make.image({key:rh,frame:ah.UNIT_REWARD_FX});e.setWorldSize(375,234.5),this.add(e)}createCurrencyIcon(){this.giftAdIcon=this.scene.add.image(0,0,rh,ah.UNIT_REWARD_GIFT_AD),this.giftAdIcon.setWorldSize(168.5,168),this.giftAdIcon.setY(0),this.add(this.giftAdIcon)}updateSize(){let{displayWidth:e,displayHeight:t}=this.giftAdIcon;this.setSize(e,t)}createEllipses(){this.bubbleTwinkleUp=new eF(this.scene),this.bubbleTwinkleUp.setScale(1.5),this.add(this.bubbleTwinkleUp)}createParticles(){for(let e=0;e<4;e++){let t=new ZU(this.scene);this.add(t),this.particleTweens.push(t)}}runLogoAttentionAnimation(e){let t=this.iconAttentionAnimController.renew();gt.runTween(this.scene.tweens.add({...Jp,paused:!0,targets:[this.giftAdIcon],delay:e,props:{scale:"+=0.05"}}),t);let{x:i,y:s,width:n,height:r}=this.giftAdIcon;this.bubbleTwinkleUp.run(1,i,s,n,r);for(let o of this.particleTweens){let a=(0,sF.Between)(1e3,2e3);o.run(1,0,0,n,r,a)}}stopAnimation(){for(let e of this.particleTweens)e.stop();this.iconAttentionAnimController.abort()}},aF=rF,ng=U(dt()),{KEY:rg,FRAME:ag}=W.DEFAULT_8_BIT,{language:oF}=codex,hF=class extends Gt{constructor(e){super(e,rg,ag.BUTTON_GREEN_LONG,200,64),this.setName("ViewAd"),this.createIcon(),this.createViewText()}createIcon(){let e=this.scene.add.image(0,0,rg,ag.ICON_AD);e.setWorldSize(43.5,45.5),ng.Align.In.Center(e,this,-60,-5),this.add(e)}createViewText(){let e=Z.buildText(oF.getText("GET_NOW"),22).setDefaultStroke().setDefaultShadow({offsetX:-1.5,offsetY:1.5}).build(this.scene);ng.Align.In.Center(e,this,25,-5),this.add(e)}},lF=hF,rs=U(dt()),uF=U(Zt()),og=U(yt()),cF=U(Cs()),{KEY:oh,FRAME:hh}=W.DEFAULT_8_BIT,{Utils:{Valid:dF,Signal:as}}=Ludex,{language:pF}=codex,gF=class extends ye{rewardValue;hand;viewAdButton;skipButton;giftIcon;giftIconWhite;currencyText;giftAdComponent;popupContents;cometTwinkle;starTwinkleUp;sparksExplosive;contentFadeOutAnimController=new as.SignalController;backgroundFadeInAnimController=new as.SignalController;contentShowUpAnimController=new as.SignalController;giftEntrancesAnimController=new as.SignalController;giftAttentionAnimController=new as.SignalController;giftShakeAnimController=new as.SignalController;giftOpenAnimController=new as.SignalController;adsTimer;constructor(e,t){super(e,t),this.setDepth(hi.POPUP),this.background.setAlpha(0),this.createViewAdsButton(),this.createSkipButton(),this.createGiftAdIcon(),this.createCurrencyText(),this.createEffects(),this.createGiftIcon(),this.createHand(),this.createContentsGroup()}open=e=>{super.open(e),this.background.setAlpha(0),nt.getGlobalScene()?.requestBackgroundMaskUpdate(tt.UNIT_REWARD_SCREEN,this.background.alpha),this.setRewardValue(e?.unitType??"MELEE"),this.runOpenAnimation(),this.handleShowRewardedVideoAd()};handleClosePopup=()=>{this.runCloseAnimation()};handleShowRewardedVideoAd=async()=>{this.viewAdButton.setDisabled(!0),await wt.showRewardVideoAdAsync()&&(this.background.setAlpha(.8),nt.getGlobalScene()?.requestBackgroundMaskUpdate(tt.UNIT_REWARD_SCREEN,this.background.alpha),this.starTwinkleUp.stop(),ut.playSound(Et.DAILY_REWARD),this.popupContents.killGroup(),this.runTheGiftEntrancesAnimation(0,1500)),ot.closeScreen(tt.NOTIFY_SCREEN)};setTheGiftClickable(e){e?this.giftIcon.setInteractive():this.giftIcon.disableInteractive()}handleTheGiftClick=()=>{this.setTheGiftClickable(!1),this.logButtonEvent("OpenGift"),this.hand.stopAnimation(),this.hand.kill(),this.giftIconWhite.revive(),this.scene.tweens.killTweensOf(this.giftIcon),rs.Align.In.Center(this.giftIconWhite,this.giftIcon),ut.playSound(Et.GIFT_CHARGE),si.vibrate(50),this.runShakeTheGift(),this.runOpenTheGift()};logButtonEvent(e){xt.trackButtonClick(e)}runOpenAnimation(){this.revive(),this.hand.stopAnimation(),this.hand.kill(),this.popupContents.reviveGroup(),this.starTwinkleUp.stop(),this.runPopupContentEntrancesAnimation(100,400),this.runLogoAttentionAnimation(500)}runCloseAnimation=()=>{this.runExitsAnimation(0,200)};runBackgroundEntrancesAnimation(e,t){let i=this.backgroundFadeInAnimController.renew();gt.runTween(this.scene.tweens.add({...mr,paused:!0,targets:this.background,delay:e,duration:t,props:{alpha:{start:0,to:.8}},onUpdate:(s,n)=>{nt.getGlobalScene()?.requestBackgroundMaskUpdate(tt.UNIT_REWARD_SCREEN,n.alpha)}}),i)}runPopupContentEntrancesAnimation(e,t){let i=this.contentShowUpAnimController.renew();gt.runTween(this.scene.tweens.add({...ns,targets:this.popupContents.getChildren(),duration:t,delay:this.scene.tweens.stagger(100,{start:e}),props:{scale:{getStart:s=>s.scale-.3,getEnd:s=>s.scale},alpha:{start:0,from:0,to:1}}}),i)}runLogoAttentionAnimation(e){let{x:t,y:i,width:s,height:n}=this.giftAdComponent;this.starTwinkleUp.run(1,t,i,s,n),this.giftAdComponent.runLogoAttentionAnimation(e)}runTheGiftEntrancesAnimation(e,t){this.giftIcon.revive(),this.giftIcon.setAlpha(1),rs.Align.In.TopRight(this.giftIcon,this.zone);let i=this.giftEntrancesAnimController.renew(),{x:s,y:n}=this.giftIcon,{x:r,y:o}=this.currencyText,a={x:s,y:n},h={x:r,y:o},l=1/$.getPixelRatio();gt.runTween(fo(this.scene,{targets:this.giftIcon,delay:e,duration:t,curve:[[a.x,a.y],[a.x-80,a.y+80],[h.x,h.y]],onCurveUpdate:c=>{let f=c.x+og.RND.between(-40,40),u=c.y+og.RND.between(-40,40);this.cometTwinkle.explode(1,f,u)}}),i),gt.runTween(this.scene.tweens.add({targets:this.giftIcon,delay:e,duration:t,props:{scale:{start:l*.5,to:l},angle:{start:20,to:0}},onComplete:()=>{ut.playSound(Et.GIFT_REVEAL);let c=1.5;this.starTwinkleUp.setScale(c);let{x:f,y:u,width:p,height:d}=this.giftIcon;this.starTwinkleUp.run(1,f,u,p/c,d/c),this.moveTo(this.starTwinkleUp,this.length-1),this.runTheGiftAttentionAnimation()}}),i)}runTheGiftAttentionAnimation(){let e=this.giftAttentionAnimController.renew();this.hand.revive(),this.hand.playAnimation(),rs.Align.In.Center(this.hand,this.giftIcon,20,20),this.setTheGiftClickable(!0),gt.runTween(this.scene.tweens.add({...Jp,paused:!0,targets:this.giftIcon,props:{scale:"+=0.05"}}),e)}runShakeTheGift(){let e=this.giftShakeAnimController.renew();gt.runTween(new $p(this.scene,{targets:[this.giftIcon,this.giftIconWhite],duration:22}).tween,e)}runOpenTheGift(){let e=this.giftOpenAnimController.renew(),t=1/$.getPixelRatio();gt.runTween(this.scene.tweens.add({...ip,targets:[this.giftIcon,this.giftIconWhite],duration:1500,props:{alpha:0,scale:t},onUpdate:()=>{this.giftIconWhite.setAlpha(1)},onComplete:()=>{this.giftShakeAnimController.abort(),this.giftIcon.kill(),this.giftIconWhite.kill(),this.sparksExplosive.explode(100,this.giftIcon.x,this.giftIcon.y,230),ut.playSound(Et.GIFT_EXPLODE),this.rewardUnit(),this.scene.time.delayedCall(500,this.runCloseAnimation)}}),e)}rewardUnit(){xt.logEarnUnitAnalytics(this.rewardValue,this.getRewardedUnitLevel());let e=nt.getCurrentScene();e instanceof St&&e.canSpawnUnit(this.rewardValue)&&this.scene.renderer.once(cF.default.Events.PRE_RENDER,()=>{e.spawnUnit(this.rewardValue,!0,this.getRewardedUnitLevel())})}getRewardedUnitLevel(){let e=At.getLevelProgress(),t=dF.isNumber(e)?e+1:1,{BUYING_UNIT_LEVEL:i}=Q,s=1;return i.forEach((n,r)=>{n<=t&&(s=r+1)}),s}runExitsAnimation(e,t){let i=this.contentFadeOutAnimController.renew();gt.runTween(this.scene.tweens.add({...od,paused:!0,targets:this.popupContents.getChildren(),delay:e,duration:t,props:{alpha:{start:.8,to:0}},onComplete:()=>{nt.getGlobalScene()?.requestBackgroundMaskUpdate(tt.UNIT_REWARD_SCREEN,0),ot.closeScreen(this.name),this.viewAdButton.setDisabled(!1),this.skipButton.setDisabled(!1)}}),i)}createHand(){this.hand=new tp(this.scene),this.add(this.hand)}createContentsGroup(){this.popupContents=this.scene.make.group({}),this.popupContents.addMultiple([this.giftAdComponent,this.currencyText])}createCurrencyText(){this.currencyText=Z.buildText("WATCH_A_VIDEO",22).setAlign("center").build(this.scene),this.setRewardValue("MELEE"),this.add(this.currencyText)}setRewardValue(e){this.rewardValue=e,this.currencyText.setText(pF.getText("WATCH_A_VIDEO")),rs.Align.In.BottomCenter(this.currencyText,this.giftAdComponent,0,20)}createViewAdsButton(){this.viewAdButton=new lF(this.scene),this.viewAdButton.onClick=this.handleShowRewardedVideoAd,rs.Align.In.Center(this.viewAdButton,this.zone,0,100),this.viewAdButton.kill()}createSkipButton(){this.skipButton=new tg(this.scene,{key:oh,frame:hh.UNIT_REWARD_NO_THANKS_TEXT,width:123.5,height:18.5,paddingZone:50}),this.skipButton.setName("NoThanks"),this.skipButton.onClick=this.handleClosePopup,rs.Align.In.BottomCenter(this.skipButton,this.viewAdButton,0,80),this.skipButton.kill()}createGiftAdIcon(){this.giftAdComponent=new aF(this.scene),rs.Align.In.Center(this.giftAdComponent,this.zone,0,-80),this.add(this.giftAdComponent)}createGiftIcon(){this.giftIconWhite=this.scene.make.image({key:oh,frame:hh.UNIT_REWARD_GIFT_GLOW,visible:!1}),this.giftIconWhite.setWorldSize(168.5,168),this.giftIconWhite.setDepth(rt.PRIORITY),this.add(this.giftIconWhite),this.giftIcon=this.scene.make.image({key:oh,frame:hh.UNIT_REWARD_GIFT,visible:!1}),this.giftIcon.setInteractive({useHandCursor:!0}),this.giftIcon.setWorldSize(168.5,168),this.giftIcon.on(uF.GAMEOBJECT_POINTER_DOWN,this.handleTheGiftClick),this.setTheGiftClickable(!1),this.add(this.giftIcon)}createEffects(){this.cometTwinkle=new Hc(this.scene),this.starTwinkleUp=new WU(this.scene),this.sparksExplosive=new Wc(this.scene),this.add([this.cometTwinkle,this.starTwinkleUp,this.sparksExplosive])}},fF=gF,mF=U(it()),vF=U(Li()),hg=U(ft()),{KEY:EF,FRAME:yF}=W.EFFECTS,TF=class extends mF.Container{emitZone;emitter;constructor(e){super(e),this.createEmitZone(),this.scene.add.existing(this)}createEmitZone(){this.emitZone=new vF.Rectangle}createEmitters(){this.emitter=this.scene.add.particles(0,0,EF,{frame:yF.FX_STAR_YELLOW,emitZone:{source:this.emitZone,type:"random"},timeScale:1,frequency:100,alpha:{start:1,end:0,ease:hg.Expo.Out},scale:{start:1,end:0,ease:hg.Expo.Out},lifespan:{min:800,max:1500}}),this.emitter.stop()}run(e,t,i,s,n,r=100){this.stop(),this.reset(),this.emitZone.setSize(s,n),this.emitZone.setPosition(t-s/2,i-n/2),this.emitter.setQuantity(e),this.emitter.setFrequency(r),this.emitter.start()}stop(){this.emitter?.killAll(),this.emitter?.stop()}reset(){this.createEmitters()}},SF=TF,AF=U(it()),lg=U(pn()),Vs=U(dt()),ug=U(yt()),{KEY:lh}=W.UNITS,{KEY:Fi,FRAME:Gi}=W.DEFAULT_8_BIT,{language:xF}=codex,{Utils:{Number:cg,Signal:wF}}=Ludex,RF=class extends AF.Container{glow;backEffect;bg;ribbon;healthContainer;healthText;atkContainer;atkText;unitName;unitFrame;particleTween=[];backEffectTween;onExitComplete;exitCurveAnimController=new wF.SignalController;loading;payload;constructor(e){super(e),this.scene=e,this.setName("UnitCard"),this.createGlow(),this.createBackEffect(),this.createBg(),this.updateSize(),this.createRibbon(),this.createHealthContainer(),this.createAtkContainer(),this.createUnitName(),this.createUnitFrame(),this.createAnimation(),this.scene.add.existing(this)}createGlow(){let e=this.scene.make.image({key:Fi,frame:Gi.UNIT_UNLOCK_GLOW});e.setName("glow"),e.setWorldSize(340.5,349.5),this.add(e),this.glow=e}createBackEffect(){let e=new Kp(this.scene,{color:234748,width:{min:4,max:8},radius:{min:180,max:170},lineNumber:18});e.setName("backEffect"),e.setPosition(0,0),this.add(e),this.backEffect=e}createBg(){let e=this.scene.make.image({key:Fi,frame:Gi.UNIT_UNLOCK_FRAME});e.setName("frame"),e.setWorldSize(207.5,292),this.add(e),this.bg=e}createRibbon(){let e=this.scene.make.image({key:Fi,frame:Gi.UNIT_UNLOCK_BG});e.setName("ribbon"),e.setWorldSize(204,34.5),this.add(e),Vs.Align.In.TopCenter(e,this,-1,-4),this.ribbon=e}updateSize(){let{width:e,height:t}=this.bg;this.setSize(e,t)}createHealthContainer(){this.healthContainer=this.scene.make.container({}),this.healthContainer.setName("healthContainer");let e=this.scene.make.image({key:Fi,frame:Gi.UNIT_UNLOCK_BG_1});e.setName("health-bg"),e.setWorldSize(79.5,25),this.healthContainer.setSize(e.width,e.height);let t=this.scene.make.image({key:Fi,frame:Gi.UNIT_UNLOCK_ICON_HEART});t.setName("health-icon"),t.setWorldSize(21.5,19),Vs.Align.In.LeftCenter(t,e,-10);let i=Z.buildText("0",22).setDefaultStroke().setFixedWidth(13*22).setAlign("center").setHighQuality().build(this.scene);i.setPosition(15,0),this.healthText=i,this.healthContainer.add([e,t,i]),this.add(this.healthContainer),Vs.Align.In.TopLeft(this.healthContainer,this,-15,-8)}createAtkContainer(){this.atkContainer=this.scene.make.container({}),this.atkContainer.setName("atkContainer");let e=this.scene.make.image({key:Fi,frame:Gi.UNIT_UNLOCK_BG_1});e.setName("atk-bg"),e.setWorldSize(79.5,25),this.atkContainer.setSize(e.width,e.height);let t=this.scene.make.image({key:Fi,frame:Gi.UNIT_UNLOCK_ICON_BATTLE});t.setName("atk-icon"),t.setWorldSize(20.5,18),Vs.Align.In.LeftCenter(t,e,-10);let i=Z.buildText("0",22).setDefaultStroke().setFixedWidth(13*22).setAlign("center").setHighQuality().build(this.scene);i.setPosition(15,0),this.atkText=i,this.atkContainer.add([e,t,i]),this.add(this.atkContainer),Vs.Align.In.TopRight(this.atkContainer,this.ribbon,-15,-4)}createUnitName(){let e=Z.buildText("Abcdefghjklmnopx",22).setFixedWidth(286).setAlign("center").setHighQuality().build(this.scene);this.unitName=e,this.add(e),Vs.Align.In.BottomCenter(e,this,0,-21)}createUnitFrame(){this.loading=new Sn(this.scene),this.loading.setY(-10),this.add(this.loading);let e=this.scene.make.image({key:Fi,frame:Gi.BLANK});e.setName("unitFrame"),e.setWorldSize(200,200),e.setY(-9),this.add(e),e.kill(),this.unitFrame=e}createAnimation(){for(let e=0;e<4;e++){let t=new SF(this.scene);this.add(t),this.particleTween.push(t)}this.backEffectTween=this.scene.add.tween({paused:!0,targets:this.backEffect,duration:1e6,ease:ug.Linear,repeat:-1,props:{rotation:{start:0,to:180}}})}runAnimation(){this.glow.revive(),this.backEffect.revive();let{width:e,height:t}=this;this.particleTween.forEach(i=>{let s=(0,ug.Between)(1e3,2e3);i.run(1,0,0,e/2,t/2.5,s)}),this.backEffectTween.resume()}stopAnimation(){this.particleTween.forEach(e=>{e.stop()}),this.backEffectTween.pause()}runExitAnimation(){this.glow.kill(),this.backEffect.kill()}updateInfo(e){this.payload=e;let{name:t,health:i,atk:s,frame:n}=e;switch(this.unitFrame.kill(),this.loading.revive(),this.unitName.setText(t.toUpperCase()),xF.getCurrentLocale()){case"ja":this.unitName.text.length>8&&this.unitName.setScale(8/this.unitName.text.length);break;default:this.unitName.text.length>15&&this.unitName.setScale(15/this.unitName.text.length);break}let r=cg.toAbbreviatedString(i);this.healthText.setText(r);let o=cg.toAbbreviatedString(s);this.atkText.setText(o),this.scene.textures.get(lh).has(n)?this.setUnitFrame():this.scene.textures.on(lg.ADD,this.handleWaitAddTexture),this.unitFrame.setFrame(n)}handleWaitAddTexture=e=>{e===lh&&(this.scene.textures.off(lg.ADD,this.handleWaitAddTexture),!(!this.visible&&!this.active)&&this.setUnitFrame())};setUnitFrame(){let{frame:e}=this.payload;this.unitFrame.revive(),this.loading.kill(),this.unitFrame.setTexture(lh,e),this.unitFrame.setWorldSize(200,200)}},CF=RF,uh=U(dt()),xi=U(dt()),_F=class ff{static _instance;static get inst(){return this._instance||(this._instance=new ff),this._instance}static alignChildTopLeft(t,i,s=0,n=0){let r=i.x,o=i.y;xi.Align.In.TopLeft(t,i,s+r,n+o)}static alignChildTopRight(t,i,s=0,n=0){let r=i.x,o=i.y;xi.Align.In.TopRight(t,i,s+r,n+o)}static alignChildBottomLeft(t,i,s=0,n=0){let r=i.x,o=i.y;xi.Align.In.BottomLeft(t,i,s-r,n-o)}static alignChildBottomRight(t,i,s=0,n=0){let r=i.x,o=i.y;xi.Align.In.BottomRight(t,i,s-r,n-o)}static alignChildCenter(t,i,s=0,n=0){let r=i.x,o=i.y;xi.Align.In.Center(t,i,s-r,n-o)}static alignChildLeftCenter(t,i,s=0,n=0){let r=i.x,o=i.y;xi.Align.In.LeftCenter(t,i,s-r,n-o)}static alignChildRightCenter(t,i,s=0,n=0){let r=i.x,o=i.y;xi.Align.In.RightCenter(t,i,s-r,n-o)}static alignChildTopCenter(t,i,s=0,n=0){let r=i.x,o=i.y;xi.Align.In.TopCenter(t,i,s+r,n+o)}static alignChildBottomCenter(t,i,s=0,n=0){let r=i.x,o=i.y;xi.Align.In.BottomCenter(t,i,s-r,n-o)}static alignChildrenContainer(t,i){let{width:s,height:n,x:r,y:o}=i,a=s!==void 0,h=n!==void 0;if(a){let l=r-s/2,c=s/(t.length+1);t.forEach((f,u)=>{f.setPosition(l+(u+1)*c,o)})}else if(h){let l=o-n/2,c=n/(t.length+1);t.forEach((f,u)=>{f.setPosition(r,l+(u+1)*c)})}}},ch=_F,dh=U(ft()),{FRAME:dg}=W.UNITS,{KEY:bF,FRAME:PF}=W.DEFAULT_8_BIT,{language:Yt}=codex,{Utils:{Signal:LF}}=Ludex,IF=class extends ye{frameBg;popup;title;unitCard;closeBtn;isShowingAdBanner;showPopupAnimController=new LF.SignalController;constructor(e,t){super(e,t),this.background.setAlpha(.7),this.setDepth(hi.POPUP),this.createPopup(),this.createUnitCard(),this.createPopupTitle()}createPopup(){this.popup=this.scene.make.container({}),this.add(this.popup),this.popup.setName("popup");let e=307,t=386,i=new Ui(this.scene,{x:0,y:0,width:e,height:t,rightEdge:292019,topInnerCornerStrokeWidth:2,rightInnerCornerStrokeWidth:3,lightY:-80});i.setName("frame"),this.frameBg=i,this.popup.add(i),this.popup.setWorldSize(e,t),this.createCloseButton();let s=this.isShowingAdBanner?-50:0;uh.Align.In.Center(this.popup,this,0,s)}recalculateLightPosition(){this.frameBg&&this.frameBg.recalculateLightPosition()}createPopupTitle(){let e=this.scene.make.container({});e.setName("title");let t=this.scene.make.image({key:bF,frame:PF.RIBBON_GREEN});t.setWorldSize(239,65),e.add(t);let i=Z.buildText(Yt.getText("NEW_CHARACTER").toUpperCase(),23).setFixedWidth(13*23).setAlign("center").setHighQuality().build(this.scene);i.setPosition(0,-5),e.add(i),uh.Align.In.TopCenter(e,this.popup,0,-28),this.add(e),this.title=e}createUnitCard(){this.unitCard=new CF(this.scene),this.add(this.unitCard);let e=this.isShowingAdBanner?-25:25;this.unitCard.setPosition(0,e)}updateInfo(){let e=this.scene.scene.get(ct.GAME_SCENE);if(!(e instanceof St))return;let{unitManager:t}=e;if(!t)return;let{latestUnitMergePayload:i}=t,{level:s,type:n}=i,r=t.getUnitDataForUnlockingScreen(),o="";if(n===Q.MELEE_UNIT_TYPE&&(o=dg.UNLOCKED.MELEE[s]),n===Q.RANGED_UNIT_TYPE&&(o=dg.UNLOCKED.RANGED[s]),o==="")return;this.unitCard.updateInfo({frame:o,atk:r.damage,health:r.health,name:this.translateUnitName(r.name)});let a=this.isShowingAdBanner?-50:0;this.popup.setY(a),uh.Align.In.TopCenter(this.title,this.popup,0,-28);let h=this.isShowingAdBanner?-25:25;this.unitCard.setAngle(0),this.unitCard.setPosition(0,h)}translateUnitName(e){switch(e){case"Rockthrower":return Yt.getText("ROCKTHROWER");case"Javelineer":return Yt.getText("JAVELINEER");case"Boomeranger":return Yt.getText("BOOMERANGER");case"Macer":return Yt.getText("MACER");case"Artemis":return Yt.getText("ARTEMIS");case"William":return Yt.getText("WILLIAM");case"Blanchette":return Yt.getText("BLANCHETTE");case"Phantom":return Yt.getText("PHANTOM");case"Oracle":return Yt.getText("ORACLE");case"Shaman":return Yt.getText("SHAMAN");case"Seraph":return Yt.getText("SERAPH");case"Velociraptor":return Yt.getText("VELOCIRAPTOR");case"Saurolophus":return Yt.getText("SAUROLOPHUS");case"Pachysaurus":return Yt.getText("PACHYSAURUS");case"Triceratops":return Yt.getText("TRICERATOPS");case"Stegosaurus":return Yt.getText("STEGOSAURUS");case"Ankylosaurus":return Yt.getText("ANKYLOSAURUS");case"Baroptiloraptor":return Yt.getText("BAROPTILORAPTOR");case"Tyrannosaurus":return Yt.getText("TYRANNOSAURUS");case"Dilophosaurus":return Yt.getText("DILOPHOSAURUS");case"Triceradonosaurus":return Yt.getText("TRICERADONOSAURUS");case"Spinosaurus Rex":return Yt.getText("SPINOSAURUS_REX");default:return e}}createCloseButton(){let e=new Ni(this.scene);e.setName("Close"),this.popup.add(e),ch.alignChildTopRight(e,this.popup,10,0),e.onClick=this.handleCloseScreen,this.closeBtn=e}open(){super.open(),nt.getGlobalScene()?.requestBackgroundMaskUpdate(tt.UNIT_UNLOCK_SCREEN,this.background.alpha);let e=this.scene.scene.get(ct.GAME_SCENE);e instanceof St&&ot.listenResizeEventForCalculateLight(this),this.isShowingAdBanner=e?e.isBannerAdShowed:!0,this.playShowPopupAnimation(),this.updateInfo(),this.popup.revive(),this.title.revive(),this.background.revive(),this.unitCard.runAnimation()}close(){this.setBlockInputOutsideEnabled(!1),this.visible&&(this.popup.kill(),this.title.kill(),this.background.kill(),this.unitCard.onExitComplete=()=>{let e=this.scene.game.scene.getScene(ct.GAME_SCENE);e instanceof St&&(ot.removeResizeEventForCalculateLight(this),e.uiManager.runUnitBtnAnim(),e.unitManager.enableDragOnPlayerUnits()),ut.playSound(Et.COIN_SPAWN_SOUND),super.close()},this.unitCard.runExitAnimation(),this.scene.scene.resume(ct.GAME_SCENE))}handleCloseScreen=()=>{this.unitCard.stopAnimation(),nt.getGlobalScene()?.requestBackgroundMaskUpdate(tt.UNIT_UNLOCK_SCREEN,0),ot.closeScreen(this.name)};playShowPopupAnimation(){let e=this.showPopupAnimController.renew();gt.runTween(this.scene.tweens.add({...fe,paused:!0,props:{alpha:{start:0,to:1,duration:500,ease:dh.Cubic.Out},scale:{start:.8,to:1,duration:1e3,ease:dh.Elastic.Out,easeParams:[.1,.45]},y:{getStart:t=>t.y,getEnd:t=>t.y,duration:500,ease:dh.Back.Out}},targets:[this.popup,this.title,this.unitCard,this.closeBtn]}),e)}},MF=IF,OF=U(it()),ph=U(Nt()),Hr=U(Zt()),DF=class extends OF.Container{config;isEnable;maxHeight;isScrolling;boundTop;boundBottom;maskGraphics;objects;_value=0;velocity=0;isScrollingSmooth;lastScrollY;isScrollingBack;scrollingBackTo;lastScrollYCount=0;hitArea;onScrollEvents=[];get marginTop(){return this.config.marginTop}get marginBottom(){return this.config.marginBottom}get acceleration(){return this.config.acceleration}get maxScrollOver(){return this.config.maxScrollOver}get scrollSmooth(){return this.config.scrollSmooth}get scrollingBackRate(){return this.config.scrollingBackRate}constructor(e,t){super(e),this.config={marginTop:0,marginBottom:0,acceleration:1400,maxScrollOver:.15,scrollSmooth:40,scrollingBackRate:5,...t};let{width:i,height:s}=t;this.isEnable=!1,this.maxHeight=0,this.lastScrollY=new Array(3).fill(0),this.setSize(i,s),this.createGroup(),this.createInput(),this.createEvents(),this.scene.add.existing(this)}onScroll(e){this.onScrollEvents.push(e)}get value(){return this._value}set value(e){let t=e-this._value;this._value=e,this.updateObject(t)}gotoTop(){this.value=this.config.marginTop}reset(){this.maxHeight=0,this.isScrolling=!1,this.isScrollingBack=!1,this.isScrollingSmooth=!1,this.gotoTop(),this.setEnable(!1)}createDebug(){let e=this.drawDebugBox(16711680,.8)}setEnable(e){this.isEnable=e,e?this.setInteractive({draggable:!0,useHandCursor:!0}):this.disableInteractive()}addItem(e){this.addAt(e),this.objects.add(e);let{y:t,height:i}=e,s=t+i+this.marginBottom-this.height/2;this.maxHeight=Math.max(this.maxHeight,s,0),this.updateObjectVisible()}addItems(e){this.addAt(e),this.objects.addMultiple(e);let t=e.map(i=>i.y+i.height+this.marginBottom-this.height/2);this.maxHeight=Math.max(this.maxHeight,Math.max(...t),0),this.updateObjectVisible()}clearItem(){this.objects.clear(!0,!0),this.reset()}getChildren(){return this.objects.getChildren().filter(e=>e.active)}createBound(e,t,i,s){this.boundTop=this.scene.make.image({key:e,frame:t}),this.boundBottom=this.scene.make.image({key:e,frame:t}),this.boundTop.setTint(s),this.boundBottom.setTint(s),this.boundTop.setAlpha(1,1,0,0),this.boundBottom.setAlpha(0,0,1,1),this.boundTop.setDepth(rt.PRIORITY),this.boundBottom.setDepth(rt.PRIORITY);let n=this.width,r=i,{x:o,y:a}=this.getWorldPosition();this.boundTop.setDisplaySize(n,r),this.boundBottom.setDisplaySize(n,r),this.boundTop.setY(-this.displayHeight/2+r/2+a-this.y-1),this.boundBottom.setY(this.displayHeight/2-r/2+a-this.y+1),this.boundTop.setX(o-this.x),this.boundBottom.setX(o-this.x),this.add([this.boundTop,this.boundBottom])}createMask(){this.maskGraphics?.destroy(),this.maskGraphics=this.scene.make.graphics({fillStyle:{color:255,alpha:1}}),this.maskGraphics.setName("MaskGraphics");let e=this.width,t=this.height;this.maskGraphics.fillRoundedRect(0-e/2,0-t/2,e,t,0),this.setMask(this.maskGraphics.createGeometryMask()),this.scene.events.off(ph.UPDATE,this.updateMask,this),this.scene.events.on(ph.UPDATE,this.updateMask,this)}updateMask(){let{x:e,y:t}=this.getWorldPosition();this.maskGraphics.setPosition(e,t)}createGroup(){this.objects=this.scene.make.group({})}updateObject(e){this.objects.incY(e),this.updateObjectVisible()}updateObjectVisible(){let e=this.objects.getChildren();for(let t=0;t<e.length;t++){let i=e[t];i.y+i.height<-this.height/2||i.y-i.height>this.height/2?i.setVisible(!1):i.setVisible(!0)}}createInput(){this.setInteractive({draggable:!0,useHandCursor:!0}),this.on(Hr.POINTER_WHEEL,this.onMouseScroll),this.on(Hr.GAMEOBJECT_DRAG,this.onTouchScroll),this.on(Hr.GAMEOBJECT_POINTER_DOWN,this.onTouchDown),this.scene.input.on(Hr.POINTER_UP,this.onTouchEnd,this)}createEvents(){this.scene.events.on(ph.UPDATE,this.update)}update=(e,t)=>{this.isScrollingSmooth&&this.velocity&&this.scrollingSmooth(t),this.isScrollingBack&&this.scrollingBack(t)};callOnScrollEvents(e,t){for(let i of this.onScrollEvents)i(this,e,t)}scrollingBack(e){let t=(this.scrollingBackTo-this.value)*e*this.scrollingBackRate/1e3;this.value+=t,Math.abs(this.scrollingBackTo-this.value)<.5&&(this.value=this.scrollingBackTo,this.stopScrollingBack()),this.callOnScrollEvents(this.value,t)}startScrollingBack(e){this.isScrollingBack=!0,this.scrollingBackTo=e}stopScrollingBack(){this.isScrollingBack=!1}scrollingSmooth(e){let t=this.velocity*e/1e3;this.value+=t;let i=Math.abs(this.velocity)/this.velocity;this.velocity-=i*this.acceleration*e/1e3,Math.abs(this.velocity)<this.acceleration*e/1e3&&this.stopScrollSmooth(),this.isReachTop()&&(this.startScrollingBack(this.marginTop),this.stopScrollSmooth()),this.isReachBottom()&&(this.startScrollingBack(-this.maxHeight),this.stopScrollSmooth()),this.callOnScrollEvents(this.value,t)}startScrollSmooth(e){this.isScrollingSmooth=!0,e&&(e*this.velocity>0?this.velocity+=e:this.velocity=e)}stopScrollSmooth(){this.isScrollingSmooth=!1,this.isScrolling=!1,this.velocity=0}isReachTop(){return this.value>this.marginTop}isReachBottom(){return-this.value>this.maxHeight}checkReachBound=()=>this.isReachTop()||this.isReachBottom();onMouseScroll=Pp((e,t,i)=>{if(this.isEnable){if(this.isScrolling=!0,this.checkReachBound()){this.lastScrollY=this.lastScrollY.map(()=>0),this.isScrolling=!1;return}this.stopScrollingBack(),this.startScrollSmooth(-i*this.scrollSmooth/15)}},100,{isImmediate:!0,maxWait:100});onTouchScroll=e=>{if(!this.isEnable)return;this.velocity&&this.stopScrollSmooth(),this.stopScrollingBack(),this.isScrolling=!0;let t=$.getZoomRatio(),{position:i,prevPosition:s}=e,n=(i.y-s.y)/t,r=this.height*this.maxScrollOver,o=1;if(this.lastScrollY[++this.lastScrollYCount%this.lastScrollY.length]=n,this.isReachTop()&&n>=0){let l=(r-(this.value-this.marginTop))/r;o=Math.min(o,l)}if(this.isReachBottom()&&n<=0){let l=(r-(-this.maxHeight-this.value))/r;o=Math.min(o,l)}let a=n*o,h=this.maxScrollOver*this.height;this.value+a>this.marginTop+h?this.value=this.marginTop+h:this.value+a<-this.maxHeight-h?this.value=-this.maxHeight-h:this.value+=a,this.callOnScrollEvents(this.value,a)};onTouchDown=()=>{this.isEnable&&(this.velocity&&this.stopScrollSmooth(),this.stopScrollingBack())};onTouchEnd=()=>{if(this.isReachTop()&&(this.startScrollingBack(this.marginTop),this.stopScrollSmooth()),this.isReachBottom()&&(this.startScrollingBack(-this.maxHeight),this.stopScrollSmooth()),!this.isScrolling)return;let e=this.lastScrollY.reduce((t,i)=>t+i)/this.lastScrollY.length;this.startScrollSmooth(e*this.scrollSmooth),this.lastScrollY=this.lastScrollY.map(()=>0)}},kF=DF,J5=U(it()),pg=class extends kF{classType;listConfigs;padding;startObjectIndex;endObjectIndex;listObjects;constructor(e,t){super(e,t),this.classType=t.classType,this.listConfigs=t.listConfigs,this.padding=t.padding?t.padding:0,this.objects.classType=this.classType,this.updateConfig(this.listConfigs)}reset(){super.reset(),this.killAndHideAll()}getChildren(){return this.listObjects.filter(e=>e?.active)}get objHeight(){let e=this.objects.getChildren();return e.length===0?(this.maxHeight=0,this.maxHeight):e[0].height}updateConfig(e){this.reset(),this.listConfigs=e,this.listObjects=new Array(e.length).fill(void 0),this.addObjectIndex(0,0);let t=this.getEndObjectIndex();this.addObjectIndex(1,t),this.startObjectIndex=this.getStartObjectIndex(),this.endObjectIndex=this.getEndObjectIndex(),this.updateMaxHeight(),this.value=this.marginTop}getConfig(){return this.listConfigs}killAndHideAll(){if(Array.isArray(this.listObjects))for(let e of this.listObjects)e!==void 0&&this.objects.killAndHide(e)}setItemPosition(e,t){let i=e.height;e.setPosition(0,i/2+(i+this.padding)*t-this.height/2)}updateMaxHeight(){return this.maxHeight=Math.max(this.listConfigs.length*(this.objHeight+this.padding)-this.padding+this.marginBottom-this.height,0),this.maxHeight}updateObject(e){this.objects.incY(e);let t=this.getStartObjectIndex(),i=this.getEndObjectIndex();t!==this.startObjectIndex&&(t>this.startObjectIndex?this.killObjectIndex(this.startObjectIndex,t-1):this.addObjectIndex(t,this.startObjectIndex-1),this.startObjectIndex=t),i!==this.endObjectIndex&&(i<this.endObjectIndex?this.killObjectIndex(i+1,this.endObjectIndex):this.addObjectIndex(this.endObjectIndex+1,i),this.endObjectIndex=i)}killObjectIndex(e,t){for(let i=e;i<=t;i++){let s=this.listObjects[i];s&&(this.objects.killAndHide(s),this.listObjects[i]=void 0)}}addObjectIndex(e,t){for(let i=e;i<=t;i++){let{padding:s,listConfigs:n}=this;if(i>=n.length)return;let r=this.objects.getFirstDead(!0),o=r.height,a=o/2+(o+s)*i+this.value-this.height/2;r.updateInfo(n[i]),r.setPosition(0,a),r.setActive(!0),r.setVisible(!0),this.addAt(r),this.listObjects[i]=r}}getStartObjectIndex(){let{objHeight:e,padding:t}=this;return Math.max(Math.floor((0-this.value)/(e+t)),0)}getEndObjectIndex(){let{objHeight:e,padding:t,listConfigs:i}=this,s=e+t;return Math.min(Math.floor((this.height-this.value)/s),i.length)}},Ln=U(dt()),BF=U(it()),{KEY:gg,FRAME:wi}=W.DEFAULT_8_BIT,{Utils:{Signal:fg}}=Ludex,NF=class extends BF.Container{avatar;rankIcon;rankText;username;score;scoreText;background;showPopUpAnimController=new fg.SignalController;showItemsAnimController=new fg.SignalController;payload;constructor(e,t){super(e),this.createBackground(),this.updateSize(),this.createRank(),this.createAvatar(),this.createUsername(),this.createScore(),t&&this.updateInfo(t),this.scene.add.existing(this)}updateInfo(e){this.payload={extraData:"",isHighlight:!1,...e},this.updateBackground(),this.updateAvatar(),this.updateRank(),this.updateUsername(),this.updateScore()}createBackground(){this.background=this.scene.make.image({key:gg,frame:wi.LEADERBOARD_BG_DARK}),this.add(this.background),this.updateBackground()}updateBackground(){let{isHighlight:e=!1}=this.payload||{};e?(this.background.setFrame(wi.LEADERBOARD_BG_LIGHT),this.background.setWorldSize(313.5,41)):(this.background.setFrame(wi.LEADERBOARD_BG_DARK),this.background.setWorldSize(314.5,42))}updateSize(){let{width:e,height:t}=this.background;this.setSize(e,t)}createAvatar(){this.avatar=new cp(this.scene,{size:42,loadDelay:300}),this.add(this.avatar),Ln.Align.In.LeftCenter(this.avatar,this.rankIcon,-40)}updateAvatar(){let{playerId:e,photo:t}=this.payload;this.avatar.loadPhoto(e,t)}createRank(){this.createRankIcon(),this.createRankText()}updateRank(){let{rank:e=99}=this.payload||{};this.updateRankIcon(e),this.updateRankText(e)}getRankIconFrame(e){let t=null;switch(e){case 1:t=wi.LEADERBOARD_RANK_GOLD;break;case 2:t=wi.LEADERBOARD_RANK_SILVER;break;case 3:t=wi.LEADERBOARD_RANK_COPPER;break}return t}createRankIcon(){this.rankIcon=this.scene.make.image({key:gg}),this.updateRankIcon(1),this.kill(),this.add(this.rankIcon),Ln.Align.In.LeftCenter(this.rankIcon,this)}updateRankIcon(e){let t=this.getRankIconFrame(e);if(!t){this.rankIcon.kill();return}this.rankIcon.revive(),this.rankIcon.setFrame(t),t===wi.LEADERBOARD_RANK_GOLD&&this.rankIcon.setWorldSize(39,34.5),t===wi.LEADERBOARD_RANK_SILVER&&this.rankIcon.setWorldSize(32.5,32),t===wi.LEADERBOARD_RANK_COPPER&&this.rankIcon.setWorldSize(27,35.5)}createRankText(){this.rankText=Z.buildText("0",16).setDefaultStroke().setHighQuality().build(this.scene),this.rankText.kill(),this.add(this.rankText),Ln.Align.In.Center(this.rankText,this.rankIcon,0,-1)}updateRankText(e){this.rankText.kill(),e>3&&this.rankText.revive(),this.rankText?.setText(`${e}`)}getShortName(e){let t=e.substring(0,7);return t.split(" ")[0]||t}createUsername(){this.username=Z.buildText("Player",16).setFontStyle("bold").setHighQuality().build(this.scene),Ln.Align.In.LeftCenter(this.username,this.avatar,-53),this.add(this.username)}updateUsername(){let e=this.payload.name;this.username.setText(this.getShortName(e))}createScore(){this.score=this.scene.add.container(),this.scoreText=Z.buildText("99999",16).setOrigin({x:1,y:.5}).setDefaultStroke().setHighQuality().build(this.scene),this.score.add(this.scoreText),this.add(this.score),Ln.Align.In.RightCenter(this.score,this,-10)}updateScore(){let{score:e="0"}=this.payload||{};this.scoreText.setText(`${e}`)}handleChallengeFriend=async()=>{};updateBattleProfiles(){}runShowPopUpAnimation(e,t){let i=this.showPopUpAnimController.renew();this.scene.tweens.killTweensOf(this),gt.runTween(this.scene.tweens.add({...fe,paused:!0,targets:this,delay:e,duration:t,props:{...fe.props,y:{...fe.props.y,start:this.y+70,to:this.y}}}),i)}runShowItemAnimation(e,t){let i=this.getAll(),s=this.showItemsAnimController.renew();this.scene.tweens.killTweensOf(i);let n=i.map(o=>o.scale),r=()=>{for(let o=0;o<i.length;o++){let a=i[o],h=n[o];a.setScale(h)}};s.once(r),gt.runTween(this.scene.tweens.add({...xr,paused:!0,targets:i,duration:t,delay:this.scene.tweens.stagger(50,{start:e+50}),props:{...xr.props,scale:{...xr.props.scale,value:void 0,getStart:o=>o.scale*.8,getEnd:o=>o.scale}}}),s)}runShowUpAnimation(e=0,t=300){let i=e*100;this.runShowPopUpAnimation(i,t),this.runShowItemAnimation(i,t)}},UF=NF,FF=U(it()),{Limit:GF}=Ut.Leaderboards,{player:YF,language:HF}=codex,WF=class extends FF.Container{currentPlayerId;isUpdating;scroller;constructor(e){super(e),this.scene=e,this.currentPlayerId=YF.getPlayerId(),this.isUpdating=!1,this.createReuseScroller(),this.scene.add.existing(this)}createReuseScroller(){this.scroller=new pg(this.scene,{classType:UF,listConfigs:[],width:320,height:290,padding:10,marginTop:10,marginBottom:10}),this.scroller.createMask(),this.scroller.setPosition(0,0),this.add(this.scroller)}updateData(e){if(this.isUpdating)return;this.isUpdating=!0;let t=Object.values(e)||[];if(t.length<1){this.showLeaderboardIsEmpty();return}let i=t.sort((r,o)=>+o.score-+r.score),s=[],n=1;for(let r of i){if(s.length>=GF)break;let{playerId:o,photo:a,score:h,name:l}=r;if(!o||!l)continue;let c=this.currentPlayerId===o,f={playerId:o,photo:a||j.AVATAR_DEFAULT.FILE,name:l,rank:n,score:h,isHighlight:c};s.push(f),n++}this.scroller.updateConfig(s),this.showLeaders()}removeLeaders(){this.scroller.updateConfig([])}getLeaders(){return this.scroller.getChildren()}showLeaders(){let e=this.getLeaders(),t=Math.min(e.length,6),i=300;for(let n=0;n<t;n++){let r=e[n];r&&(r.setVisible(!0),r.runShowUpAnimation(n,i))}let s=i+t*100+50*5;this.scene.time.delayedCall(s,()=>{let n=ot.getScreen(tt.LEADER_BOARD_SCREEN);this.isUpdating=!1,n.isSwitchable=!0,this.scroller.setEnable(!0)})}showLeaderboardIsEmpty(){let e=ot.getScreen(tt.LEADER_BOARD_SCREEN);this.isUpdating=!1,e.isSwitchable=!0,e.board.showMessage(!0,HF.getText("LEADERBOARD_IS_EMPTY"))}},zF=WF,VF=U(it()),Wr=U(dt()),{language:zr}=codex,XF=class extends VF.Container{constructor(e){super(e),this.createRankText(),this.createPhotoText(),this.createNameText(),this.createLevelText()}createRankText(){let e=Z.buildText(zr.getText("RANK"),14).setOrigin({x:.2,y:.5}).build(this.scene);this.add(e),Wr.Align.In.Center(e,this,-138)}createPhotoText(){let e=Z.buildText(zr.getText("PHOTO"),14).setOrigin({x:.2,y:.5}).build(this.scene);this.add(e),Wr.Align.In.Center(e,this,-94)}createNameText(){let e=Z.buildText(zr.getText("NAME"),14).setOrigin({x:.2,y:.5}).build(this.scene);this.add(e),Wr.Align.In.Center(e,this,-45)}createLevelText(){let e=Z.buildText(zr.getText("LEVEL"),14).setOrigin({x:.2,y:.5}).build(this.scene);this.add(e),Wr.Align.In.Center(e,this,135)}},KF=XF,jF=U(it()),Xe=U(dt()),{KEY:gh,FRAME:fh}=W.DEFAULT_8_BIT,{KEY:ZF,FRAME:qF}=W.DEFAULT,{Utils:{Signal:QF}}=Ludex,{language:mg}=codex,JF=class extends jF.Container{background;titleText;titleRibbon;header;leaders;loading;message;challengeFriendsBtn;messageAnimController=new QF.SignalController;onClose;constructor(e){super(e),this.setName("Board"),this.createBackground(),this.createLoading(),this.createMessage(),this.createContents(),this.createCloseButton(),this.updateSize(),this.scene.add.existing(this)}updateSize(){let{width:e,height:t}=this.background;this.setSize(e,t)}showLoading(e){this.loading.setVisible(e),this.showMessage(!1)}showMessage(e,t){this.message.setVisible(e),t&&(this.message.setText(t),this.playMessageAnimation())}createBackground(){this.background=new Ui(this.scene,{x:0,y:0,width:332,height:404.5,topInnerCornerStrokeWidth:1,rightInnerCornerStrokeWidth:3,lightY:-80}),this.add(this.background),this.setSize(this.background.width,this.background.height)}recalculateLightPosition(){this.background&&this.background.recalculateLightPosition()}createLoading(){this.loading=new Sn(this.scene),this.loading.setTint(16777215),this.loading.setWorldSize(113,113),this.add(this.loading),Xe.Align.In.Center(this.loading,this.background)}createMessage(){this.message=Z.createText(this.scene,"",18),this.message.setTint(16777215),this.add(this.message),Xe.Align.In.Center(this.message,this.background)}createContents(){this.createLeaders(),this.createTitle(),this.createHeader()}createLeaders(){this.leaders=new zF(this.scene),this.add(this.leaders),Xe.Align.In.Center(this.leaders,this.background,0,30)}createTitle(){let e=this.scene.add.container();e.setName("title");let t=this.scene.make.image({key:ZF,frame:qF.RIBBON_BLUE});t.setWorldSize(239,67);let i=Z.createText(this.scene,mg.getText("LEADERBOARD"),22);Xe.Align.In.Center(i,t,0,-10),e.add([t,i]),Xe.Align.In.TopCenter(e,this.background,0,-25),this.add(e),this.titleText=i,this.titleRibbon=t}createHeader(){let e=this.scene.add.container(),t=this.scene.make.image({key:gh,frame:fh.LEADERBOARD_TAB_BG});t.setX(1),t.setWorldSize(329,29),this.header=new KF(this.scene),e.add([t,this.header]),this.add(e),Xe.Align.In.TopCenter(this.header,e),Xe.Align.In.Center(e,this.background,-1,-125)}createCloseButton(){let e=new Ni(this.scene);Xe.Align.In.TopRight(e,this,10,10),this.add(e),e.onClick=this.handleOnCloseClick}createChallengeFriendsBtn(){this.challengeFriendsBtn=new Gt(this.scene,gh,fh.BUTTON_GREEN,144,57),this.add(this.challengeFriendsBtn);let e=Z.buildText(mg.getText("CHALLENGE_FRIENDS"),17).setAlign("center").setDefaultStroke().setPadding({left:10,right:10}).setDefaultShadow({offsetX:-10,offsetY:4}).setHighQuality().build(this.scene);this.challengeFriendsBtn.add(e),Xe.Align.In.Center(e,this.challengeFriendsBtn,18,-3);let t=this.scene.make.image({key:gh,frame:fh.ICON_BATTLE});t.setOrigin(.5,.5),t.setWorldSize(34.5,31.5),this.challengeFriendsBtn.add(t),Xe.Align.In.Center(t,this.challengeFriendsBtn,-45,-3),Xe.Align.In.BottomCenter(this.challengeFriendsBtn,this.background,0,-15),this.challengeFriendsBtn.onClick=this.handleChallengeFriends}handleChallengeFriends=async()=>{};handleOnCloseClick=()=>{this.onClose&&this.onClose()};playMessageAnimation(){let e=this.messageAnimController.renew();gt.runTween(new $p(this.scene,{targets:this.message,duration:60,repeat:2}).tween,e)}},$F=JF,vg=U(dt()),t2=U(ft()),{Name:Eg,Limit:yg}=Ut.Leaderboards,{Utils:{Signal:Tg}}=Ludex,{language:e2}=codex,i2="friends",s2="world",n2=class extends ye{scene;board;tabId;offset;isSwitchable;showPopupAnimController=new Tg.SignalController;fadeOutAnimController=new Tg.SignalController;constructor(e,t){super(e,t),this.scene=e,this.background.setAlpha(.7),this.setDepth(hi.POPUP),this.createBoard()}open(){super.open(),this.scene.scene.get(ct.GAME_SCENE)instanceof St&&ot.listenResizeEventForCalculateLight(this),nt.getGlobalScene()?.requestBackgroundMaskUpdate(tt.LEADER_BOARD_SCREEN,this.background.alpha),this.runPopupAnimation(),this.isSwitchable=!1,this.selectWorldTab()}close(){super.close(),nt.getGlobalScene()?.requestBackgroundMaskUpdate(tt.LEADER_BOARD_SCREEN,0)}selectFriendTab(){this.tabId=i2,this.offset=0,this.board.showLoading(!0),this.board.header.kill(),this.board.leaders.removeLeaders(),this.fetchLeaderboardData("friends")}selectWorldTab(){this.tabId=s2,this.offset=0,this.board.showLoading(!0),this.board.header.kill(),this.board.leaders.removeLeaders(),this.fetchLeaderboardData("world")}createBoard(){this.board=new $F(this.scene),this.board.onClose=this.handleCloseClick,vg.Align.In.Center(this.board,this,0,-20),this.add(this.board);let e=e2.getCurrentLocale(),t=22;switch(e){case"es":t=19;break}this.board.titleText.setFontSize(t),vg.Align.In.Center(this.board.titleText,this.board.titleRibbon,0,-10)}recalculateLightPosition(){this.board&&this.board.recalculateLightPosition()}handleCloseClick=()=>{this.runFadeOutAnimation()};async fetchLeaderboardData(e){try{if(!Eg||!("getLeaderboardAsync"in GameSDK.extra))return;let t=await GameSDK.extra.getLeaderboardAsync(Eg),i=[];e==="world"?i=await t.getEntriesAsync(yg,0):i=await t.getConnectedPlayerEntriesAsync(yg,0);let s={};i.forEach(n=>{let{playerId:r,score:o,rank:a}=n,h=n.getPlayer(),l=h.getName(),c=h.getPhoto();s[r]={playerId:r,name:l,photo:c,score:o,rank:a}}),this.board.leaders.updateData(s)}catch{}finally{this.isSwitchable=!0,this.board.showLoading(!1),this.board.header.revive()}}runPopupAnimation(){let e=this.showPopupAnimController.renew();gt.runTween(this.scene.tweens.add({...fe,paused:!0,targets:this.board}),e)}runFadeOutAnimation(){if(!this.visible)return;let e=this.fadeOutAnimController.renew();gt.runTween(this.scene.tweens.add({paused:!0,targets:this.background,duration:200,ease:t2.Cubic.Out,props:{alpha:{start:.7,from:.7,to:0}},onActive:()=>{this.board.kill()},onUpdate:(t,i)=>{nt.getGlobalScene()?.requestBackgroundMaskUpdate(tt.LEADER_BOARD_SCREEN,i.alpha)},onComplete:()=>{this.board.revive(),this.scene.scene.get(ct.GAME_SCENE)instanceof St&&ot.removeResizeEventForCalculateLight(this),this.background.setAlpha(.7),ot.closeScreen(this.name)}}),e)}},r2=n2,a2=U(it()),o2=U(Zt()),Sg=U(dt()),{KEY:h2,FRAME:Ag}=W.DEFAULT,l2=class extends a2.Container{icon;label;switch;hitZone;isSwitchOn;payload;constructor(e,t){super(e),this.payload=t,this.setName("SettingSwitch"),this.setWorldSize(180,45),this.createHitZone(),this.createIcon(),this.createLabel(),this.createSwitch()}set onClick(e){this.hitZone.removeAllListeners(),this.hitZone.setInteractive({useHandCursor:!0}),this.hitZone.on(o2.GAMEOBJECT_POINTER_DOWN,()=>{let t=!this.isSwitchOn;this.logButtonEvent(t),this.setSwitch(t),e(t),si.vibrate(50)})}setSwitch(e){e?(this.switch.setFrame(Ag.SETTINGS_SWITCH_ON),this.switch.setWorldSize(37.5,22)):(this.switch.setFrame(Ag.SETTINGS_SWITCH_OFF),this.switch.setWorldSize(37,21.5)),this.isSwitchOn=e}createIcon(){this.icon=this.scene.make.image({key:this.payload.iconKey,frame:this.payload.icon}),this.add(this.icon),Sg.Align.In.LeftCenter(this.icon,this.hitZone,this.payload.iconLeftOffset)}createLabel(){let e=Z.buildText(this.payload.label,15).setFixedWidth(100).setOrigin({x:0,y:.5}).setHighQuality().build(this.scene);e.setName("label"),this.add(e),e.setX(this.payload.localTextX),this.label=e}createSwitch(){this.switch=this.scene.make.image({key:h2}),this.setSwitch(!1),Sg.Align.In.RightCenter(this.switch,this,10),this.add(this.switch)}createHitZone(){let e=$.getPixelRatio();this.hitZone=this.scene.add.zone(0,0,180*e,45*e),this.add(this.hitZone)}logButtonEvent(e){let t=this.name;xt.trackButtonClick(t)}setDisabled(e){e?(this.hitZone?.disableInteractive(),this.setAlpha(.5)):(this.hitZone?.setInteractive(),this.setAlpha(1))}},Vr=l2,os=U(dt()),u2=U(ft()),{Utils:{Signal:c2}}=Ludex,{KEY:d2,FRAME:p2}=W.DEFAULT,{KEY:Xr,FRAME:Kr}=W.DEFAULT_8_BIT,{player:Xs,language:hs}=codex,{Utils:{Device:xg}}=Ludex,g2=class extends ye{popup;sound;music;vibration;speedUp;title;screenAnimController=new c2.SignalController;constructor(e,t){super(e,t),this.scene=e,this.background.setAlpha(.7),this.createPopup(),this.createCloseButton(),this.createTitle(),this.createContent()}open(){super.open(),this.scene.scene.get(ct.GAME_SCENE)instanceof St&&ot.listenResizeEventForCalculateLight(this),nt.getGlobalScene()?.requestBackgroundMaskUpdate(tt.SETTINGS_SCREEN,this.background.alpha),this.recalculateLightPosition(),this.runOpenAnimation();let e=!!Xs.getPlayerSetting("sound");this.sound.setSwitch(e);let t=!!Xs.getPlayerSetting("music");if(this.music.setSwitch(t),si.isSupportVibrateApi()&&!xg.isDesktop()){let i=si.isVibrateEnable();this.vibration.setSwitch(i)}else this.vibration.setSwitch(!1)}handleChangeSound=e=>{ut.playSound(Et.TURN_SWITCH),Xs.setSetting("sound",e)};handleChangeMusic=e=>{ut.playSound(Et.TURN_SWITCH),Xs.setSetting("music",e),e?ut.playMusic():ut.pauseMusic()};handleChangeVibration=e=>{ut.playSound(Et.TURN_SWITCH),Xs.setSetting("vibrate",e)};handleChangeSpeedUp=e=>{ut.playSound(Et.TURN_SWITCH),Xs.setSetting("speedUp",e)};handleClosePopup=()=>{let e=this.screenAnimController.renew();this.runFadeOutAnimation(e)};createPopup(){this.popup=new Ui(this.scene,{x:0,y:0,width:261.5,height:323,rightEdge:870778,topInnerCornerStrokeWidth:2,rightInnerCornerStrokeWidth:3,lightY:-40}),this.add(this.popup)}recalculateLightPosition(){this.popup&&this.popup.recalculateLightPosition()}createCloseButton(){let e=new Ni(this.scene);e.setName("button"),os.Align.In.TopRight(e,this.popup,10,10),this.popup.add(e),e.onClick=this.handleClosePopup}createTitle(){let e=Z.buildText(hs.getText("SETTINGS").toUpperCase(),22).applyScreenHeaderStyle().build(this.scene);e.setName("title"),this.add(e),os.Align.In.TopCenter(e,this.popup,0,-13);let t=this.scene.make.image({key:d2,frame:p2.TITLE_LINE});t.setWorldSize(235,23),this.popup.add(t),os.Align.In.BottomCenter(t,e,0,30),this.title=e}createContent(){this.createSoundSetting(),this.createMusicSetting(),this.createVibrationSetting(),si.isSupportVibrateApi()||(this.vibration.setSwitch(!1),this.vibration.setDisabled(!0))}createSoundSetting(){this.sound=new Vr(this.scene,{iconKey:Xr,icon:Kr.ICON_SOUND,iconLeftOffset:10,localTextX:-60,label:`${hs.getText("SOUND_FX").toUpperCase()}  `});let e=hs.getCurrentLocale(),t=15;switch(e){case"pt":case"it":t=13;break;case"es":t=11;break}this.sound.label.setFontSize(t),this.sound.setName("SettingSound"),this.add(this.sound),os.Align.In.Center(this.sound,this.popup,0,-55),this.sound.onClick=this.handleChangeSound;let i=this.scene.make.graphics({});i.fillStyle(16777215,.1),i.fillRect(-104.5,-.5,209,1),i.setPosition(0,-19.5),this.popup.add(i)}createMusicSetting(){this.music=new Vr(this.scene,{iconKey:Xr,icon:Kr.ICON_MUSIC,iconLeftOffset:8,localTextX:-60,label:`${hs.getText("MUSIC").toUpperCase()}      `}),this.music.setName("SettingMusic"),this.add(this.music),os.Align.In.Center(this.music,this.popup,0,15),this.music.onClick=this.handleChangeMusic;let e=this.scene.make.graphics({});e.fillStyle(16777215,.1),e.fillRect(-104.5,-.5,209,1),e.setPosition(0,45.5),this.popup.add(e)}createVibrationSetting(){this.vibration=new Vr(this.scene,{iconKey:Xr,icon:Kr.ICON_VIBRATION,iconLeftOffset:10,localTextX:-60,label:`${hs.getText("VIBRATION").toUpperCase()}`}),this.vibration.setName("SettingVibration"),this.add(this.vibration),os.Align.In.Center(this.vibration,this.popup,0,85),si.isSupportVibrateApi()&&(this.vibration.onClick=this.handleChangeVibration)}createSpeedUpSetting(){this.speedUp=new Vr(this.scene,{iconKey:Xr,icon:Kr.ICON_QUICK_FIGHT,iconLeftOffset:8,localTextX:-60,label:`${hs.getText("QUICK_FIGHT").toUpperCase()}`});let e=hs.getCurrentLocale(),t=15;switch(e){case"ja":case"fr":t=13;break;case"de":t=11;break}this.speedUp.label.setFontSize(t),this.speedUp.setName("SettingSpeed"),this.add(this.speedUp),os.Align.In.Center(this.speedUp,this.popup,0,85),this.speedUp.onClick=this.handleChangeSpeedUp}runOpenAnimation(){let e=this.screenAnimController.renew();this.animateBackgroundAlpha(.7,200),this.runPopupEntrancesAnimation(e),this.runPopupContentEntrancesAnimation(100,400,e)}runPopupEntrancesAnimation(e){gt.runTween(this.scene.tweens.add({...fe,paused:!0,targets:this.popup,onStart:()=>{this.popup.revive()}}),e)}runPopupContentEntrancesAnimation(e,t,i){let s=[this.title,this.sound,this.music];this.speedUp&&s.push(this.speedUp),this.vibration&&s.push(this.vibration);for(let r of s)r.setAlpha(0);let n=si.isSupportVibrateApi()&&!xg.isDesktop();n||(this.vibration.setDisabled(!0),this.vibration.setAlpha(0)),gt.runTween(this.scene.tweens.add({...ns,targets:s,duration:t,delay:this.scene.tweens.stagger(100,{start:e}),props:{scale:{from:.7,to:1},alpha:{from:0,getEnd:r=>r===this.vibration&&!n?.5:1}}}),i)}runFadeOutAnimation(e){let t=[this.title,this.sound,this.music];this.speedUp&&t.push(this.speedUp),this.vibration&&t.push(this.vibration),this.animateBackgroundAlpha(0,200),gt.runTween(this.scene.tweens.add({paused:!0,targets:t,duration:300,ease:u2.Cubic.Out,props:{alpha:{start:.7,from:.7,to:0}},onStart:()=>{this.popup.kill()},onUpdate:(i,s)=>{nt.getGlobalScene()?.requestBackgroundMaskUpdate(tt.SETTINGS_SCREEN,s.alpha)},onComplete:()=>{this.scene.scene.get(ct.GAME_SCENE)instanceof St&&ot.removeResizeEventForCalculateLight(this),ot.closeScreen(this.name)}}),e)}},wg=g2,f2=U(ft()),In=U(dt()),{Utils:{Signal:m2}}=Ludex,{KEY:v2,FRAME:E2}=W.DEFAULT,{KEY:Rg,FRAME:Cg}=W.DEFAULT_8_BIT,{language:ls}=codex,y2=class extends ye{popup;title;confirmBtn;cancelBtn;description;screenAnimController=new m2.SignalController;constructor(e,t){super(e,t),this.scene=e,this.background.setAlpha(.7),this.createPopup(),this.createCloseButton(),this.createTitle(),this.createContent()}open(){super.open(),this.scene.scene.get(ct.GAME_SCENE)instanceof St&&ot.listenResizeEventForCalculateLight(this),nt.getGlobalScene()?.requestBackgroundMaskUpdate(tt.RESET_DATA_SCREEN,this.background.alpha),this.runOpenAnimation()}handleClosePopup=()=>{let e=this.screenAnimController.renew();this.runFadeOutAnimation(e)};createPopup(){this.popup=new Ui(this.scene,{x:0,y:0,width:300,height:200,rightEdge:870778,topInnerCornerStrokeWidth:2,rightInnerCornerStrokeWidth:3,lightY:-40}),this.add(this.popup)}recalculateLightPosition(){this.popup&&this.popup.recalculateLightPosition()}createCloseButton(){let e=new Ni(this.scene);e.setName("button"),In.Align.In.TopRight(e,this.popup,10,10),this.popup.add(e),e.onClick=this.handleClosePopup}createTitle(){let e=Z.buildText(ls.getText("RESET_DATA"),22).setDefaultStroke().setFixedWidth(325).setAlign("center").setHighQuality().setDefaultShadow({offsetX:-8,offsetY:8}).build(this.scene);e.setName("title"),this.add(e),In.Align.In.TopCenter(e,this.popup,0,-13);let t=this.scene.make.image({key:v2,frame:E2.TITLE_LINE});t.setWorldSize(235,23),this.popup.add(t),In.Align.In.BottomCenter(t,e,0,30),this.title=e}createContent(){this.createDescription(),this.createConfirmButton(),this.createCancelButton()}createDescription(){let e=ls.getCurrentLocale(),t=17;switch(e){case"id":case"de":t=15;break}this.description=Z.buildText(ls.getText("RESET_DESC"),t).setDefaultStroke().setWordWrap({width:275}).setAlign("center").build(this.scene),this.add(this.description),this.description.setPosition(0,-10)}createConfirmButton(){this.confirmBtn=new Gt(this.scene,Rg,Cg.BUTTON_RED,108,43),this.confirmBtn.setName("confirmBtn");let e=ls.getCurrentLocale(),t=-5;switch(e){case"tr":t=-8;break}let i=Z.buildText(ls.getText("YES"),20).setDefaultStroke().setDefaultShadow({offsetX:-1,offsetY:1.5}).build(this.scene);this.confirmBtn.add(i),i.setPosition(0,t),this.add(this.confirmBtn),In.Align.In.Center(this.confirmBtn,this.popup,-70,60),this.confirmBtn.onClick=()=>{let s=this.scene.scene.get(ct.GAME_SCENE);s instanceof St&&s.resetLevel();let n=ot.getScreen(tt.SETTINGS_SCREEN);n instanceof wg&&n.handleClosePopup(),this.handleClosePopup()}}createCancelButton(){this.cancelBtn=new Gt(this.scene,Rg,Cg.BUTTON_GREEN,108,43),this.cancelBtn.setName("cancelBtn");let e=ls.getCurrentLocale(),t=-5;switch(e){case"tr":t=-8;break}let i=Z.buildText(ls.getText("NO"),20).setDefaultStroke().setDefaultShadow({offsetX:-1,offsetY:1.5}).build(this.scene);this.cancelBtn.add(i),i.setPosition(0,t),this.add(this.cancelBtn),In.Align.In.Center(this.cancelBtn,this.popup,70,60),this.cancelBtn.onClick=this.handleClosePopup}runOpenAnimation(){let e=this.screenAnimController.renew();this.animateBackgroundAlpha(.7,200),this.runPopupEntrancesAnimation(e),this.runPopupContentEntrancesAnimation(100,400,e)}runPopupEntrancesAnimation(e){gt.runTween(this.scene.tweens.add({...fe,paused:!0,targets:this.popup,onStart:()=>{this.popup.revive()}}),e)}runPopupContentEntrancesAnimation(e,t,i){let s=[this.title,this.description,this.confirmBtn,this.cancelBtn],n=s.map(r=>r.alpha);gt.runTween(this.scene.tweens.add({...ns,targets:s,duration:t,delay:this.scene.tweens.stagger(100,{start:e}),props:{scale:{getStart:r=>r.scale-.3,getEnd:r=>r.scale},alpha:{getStart:r=>(r.setAlpha(0),0),getEnd:(r,o,a,h)=>n[h]}}}),i)}runFadeOutAnimation(e){let t=[this.title,this.description,this.confirmBtn,this.cancelBtn];this.animateBackgroundAlpha(0,200),gt.runTween(this.scene.tweens.add({paused:!0,targets:t,duration:200,ease:f2.Cubic.Out,props:{alpha:{start:.7,from:.7,to:0}},onStart:()=>{this.popup.kill()},onUpdate:(i,s)=>{nt.getGlobalScene()?.requestBackgroundMaskUpdate(tt.RESET_DATA_SCREEN,s.alpha)},onComplete:()=>{this.scene.scene.get(ct.GAME_SCENE)instanceof St&&ot.removeResizeEventForCalculateLight(this),ot.closeScreen(this.name)}}),e)}},T2=y2,Mn=U(dt()),S2=U(ft()),{Utils:{Signal:A2}}=Ludex,{KEY:x2,FRAME:w2}=W.DEFAULT,{KEY:_g,FRAME:bg}=W.DEFAULT_8_BIT,{language:Yi}=codex,R2=class extends ye{popup;title;confirmBtn;cancelBtn;description;screenAnimController=new A2.SignalController;constructor(e,t){super(e,t),this.scene=e,this.background.setAlpha(.7),this.createPopup(),this.createCloseButton(),this.createTitle(),this.createContent()}open(){super.open(),this.scene.scene.get(ct.GAME_SCENE)instanceof St&&ot.listenResizeEventForCalculateLight(this),nt.getGlobalScene()?.requestBackgroundMaskUpdate(tt.START_OVER_POPUP,this.background.alpha),this.updateDescription(),this.runOpenAnimation()}updateDescription(){At.getGameCompletedCount()<1?this.description.setText(Yi.getText("START_OVER_DESC_2")):this.description.setText(Yi.getText("START_OVER_DESC"))}handleClosePopup=()=>{let e=this.screenAnimController.renew();this.runFadeOutAnimation(e)};createPopup(){this.popup=new Ui(this.scene,{x:0,y:0,width:300,height:200,rightEdge:870778,topInnerCornerStrokeWidth:2,rightInnerCornerStrokeWidth:3,lightY:-40}),this.add(this.popup)}recalculateLightPosition(){this.popup&&this.popup.recalculateLightPosition()}createCloseButton(){let e=new Ni(this.scene);e.setName("button"),Mn.Align.In.TopRight(e,this.popup,10,10),this.popup.add(e),e.onClick=()=>{let t=this.scene.scene.get(ct.GAME_SCENE);t instanceof St&&t.stateManager.levelComplete(),this.handleClosePopup()}}createTitle(){let e=Z.buildText(Yi.getText("START_OVER_TITLE").toUpperCase(),22).setDefaultStroke().setFixedWidth(325).setAlign("center").setHighQuality().setDefaultShadow({offsetX:-8,offsetY:8}).build(this.scene);e.setName("title"),this.add(e),Mn.Align.In.TopCenter(e,this.popup,0,-13);let t=this.scene.make.image({key:x2,frame:w2.TITLE_LINE});t.setWorldSize(235,23),this.popup.add(t),Mn.Align.In.BottomCenter(t,e,0,30),this.title=e}createContent(){this.createDescription(),this.createConfirmButton(),this.createCancelButton()}createDescription(){this.description=Z.buildText(Yi.getText("START_OVER_DESC"),15).setDefaultStroke().setAlign("center").build(this.scene),this.add(this.description),this.description.setPosition(0,-10)}createConfirmButton(){this.confirmBtn=new Gt(this.scene,_g,bg.BUTTON_RED,108,43),this.confirmBtn.setName("confirmBtn");let e=Yi.getCurrentLocale(),t=-5;switch(e){case"tr":t=-8;break}let i=Z.buildText(Yi.getText("YES"),20).setDefaultStroke().setDefaultShadow({offsetX:-1,offsetY:1.5}).build(this.scene);this.confirmBtn.add(i),i.setPosition(0,t),this.add(this.confirmBtn),Mn.Align.In.Center(this.confirmBtn,this.popup,-70,60),this.confirmBtn.onClick=()=>{let s=this.scene.scene.get(ct.GAME_SCENE);s instanceof St&&s.resetLevel(!1),this.handleClosePopup()}}createCancelButton(){this.cancelBtn=new Gt(this.scene,_g,bg.BUTTON_GREEN,108,43),this.cancelBtn.setName("cancelBtn");let e=Yi.getCurrentLocale(),t=-5;switch(e){case"tr":t=-8;break}let i=Z.buildText(Yi.getText("NO"),20).setDefaultStroke().setDefaultShadow({offsetX:-1,offsetY:1.5}).build(this.scene);this.cancelBtn.add(i),i.setPosition(0,t),this.add(this.cancelBtn),Mn.Align.In.Center(this.cancelBtn,this.popup,70,60),this.cancelBtn.onClick=()=>{this.handleClosePopup()}}runOpenAnimation(){let e=this.screenAnimController.renew();this.animateBackgroundAlpha(.7,200),this.runPopupEntrancesAnimation(e),this.runPopupContentEntrancesAnimation(100,400,e)}runPopupEntrancesAnimation(e){gt.runTween(this.scene.tweens.add({...fe,paused:!0,targets:this.popup,onStart:()=>{this.popup.revive()}}),e)}runPopupContentEntrancesAnimation(e,t,i){let s=[this.title,this.description,this.confirmBtn,this.cancelBtn],n=s.map(r=>r.alpha);gt.runTween(this.scene.tweens.add({...ns,targets:s,duration:t,delay:this.scene.tweens.stagger(100,{start:e}),props:{scale:{getStart:r=>r.scale-.3,getEnd:r=>r.scale},alpha:{getStart:r=>(r.setAlpha(0),0),getEnd:(r,o,a,h)=>n[h]}}}),i)}runFadeOutAnimation(e){let t=[this.title,this.description,this.confirmBtn,this.cancelBtn];this.animateBackgroundAlpha(0,200),gt.runTween(this.scene.tweens.add({paused:!0,targets:t,duration:200,ease:S2.Cubic.Out,props:{alpha:{start:.7,from:.7,to:0}},onStart:()=>{this.popup.kill()},onUpdate:(i,s)=>{nt.getGlobalScene()?.requestBackgroundMaskUpdate(tt.START_OVER_POPUP,s.alpha)},onComplete:()=>{this.scene.scene.get(ct.GAME_SCENE)instanceof St&&ot.removeResizeEventForCalculateLight(this),ot.closeScreen(this.name)}}),e)}},C2=R2,_2=U(ft()),On=U(dt()),{Utils:{Signal:b2}}=Ludex,{KEY:P2,FRAME:L2}=W.DEFAULT,{KEY:mh,FRAME:vh}=W.DEFAULT_8_BIT,{BossChallenge:I2}=Ut.Powers,{language:Ri}=codex,M2=class extends ye{popup;title;bossLevelText;confirmBtn;adIcon;confirmBtnText;cancelBtn;isAccepted;adsTimer=null;description;screenAnimController=new b2.SignalController;constructor(e,t){super(e,t),this.scene=e,this.background.setAlpha(.7),this.createPopup(),this.createCloseButton(),this.createTitle(),this.createContent()}open(){super.open(),this.isAccepted=!1,this.scene.scene.get(ct.GAME_SCENE)instanceof St&&ot.listenResizeEventForCalculateLight(this),nt.getGlobalScene()?.requestBackgroundMaskUpdate(tt.BOSS_CHALLENGE_SCREEN,this.background.alpha),this.updateDescription(),this.runOpenAnimation()}updateDescription(){let e=At.getPlayerBossLevelProgress(),t=this.isBossChallengeAvailable(),i=t?"BOSS_CHALLENGE_DESC":"BOSS_CHALLENGE_AD";this.setAdMode(!t),this.description.setText(Ri.getText(i,[`${e}`])),this.bossLevelText.setText(Ri.getText("BOSS_LEVEL",[`${e}`]))}handleClosePopup=()=>{let e=this.screenAnimController.renew();this.runFadeOutAnimation(e)};createPopup(){this.popup=new Ui(this.scene,{x:0,y:0,width:350,height:200,rightEdge:870778,topInnerCornerStrokeWidth:2,rightInnerCornerStrokeWidth:3,lightY:-40}),this.add(this.popup)}recalculateLightPosition(){this.popup&&this.popup.recalculateLightPosition()}createCloseButton(){let e=new Ni(this.scene);e.setName("button"),On.Align.In.TopRight(e,this.popup,10,10),this.popup.add(e),e.onClick=()=>{this.handleClosePopup()}}createTitle(){let e=Z.buildText(Ri.getText("BOSS_CHALLENGE_TITLE").toUpperCase(),22).applyScreenHeaderStyle().build(this.scene);e.setName("title"),this.add(e),On.Align.In.TopCenter(e,this.popup,0,-10);let t=this.scene.make.image({key:P2,frame:L2.TITLE_LINE});t.setWorldSize(235,23),this.popup.add(t),On.Align.In.BottomCenter(t,e,0,30),this.title=e}createContent(){this.createBossLevelText(),this.createDescription(),this.createConfirmButton(),this.createCancelButton()}createBossLevelText(){this.bossLevelText=Z.buildText(Ri.getText("BOSS_LEVEL").toUpperCase(),18).setDefaultStroke().build(this.scene),this.bossLevelText.setAlign("center"),this.add(this.bossLevelText),this.bossLevelText.setPosition(0,-40)}createDescription(){this.description=Z.buildText(Ri.getText("START_OVER_DESC").toUpperCase(),15).setDefaultStroke().build(this.scene),this.description.setAlign("center"),this.add(this.description),this.description.setPosition(0,3)}createConfirmButton(){this.confirmBtn=new Gt(this.scene,mh,vh.BUTTON_GREEN,108,43),this.confirmBtn.setName("confirmBtn"),this.confirmBtnText=Z.buildText(Ri.getText("YES").toUpperCase(),20).setDefaultStroke().setDefaultShadow({offsetX:-1,offsetY:1.5}).build(this.scene),this.adIcon=this.scene.make.image({key:mh,frame:vh.ICON_AD}),this.adIcon.setWorldSize(25.5,27),this.confirmBtn.add([this.adIcon,this.confirmBtnText]),this.adIcon.setPosition(-32,-3),this.add(this.confirmBtn),On.Align.In.Center(this.confirmBtn,this.popup,-70,60),this.confirmBtn.onClick=async()=>{let e=this.scene.scene.get(ct.GAME_SCENE);if(this.isAccepted=!0,!this.isBossChallengeAvailable()){await this.handleShowRewardedVideoAd();return}this.handleClosePopup(),this.scene.time.delayedCall(200,()=>{e instanceof St&&e.requestBossFight()})}}createCancelButton(){this.cancelBtn=new Gt(this.scene,mh,vh.BUTTON_RED,108,43),this.cancelBtn.setName("cancelBtn");let e=Ri.getCurrentLocale(),t=-5,i=20;switch(e){case"tr":t=-8;break;case"ja":i=18,t=-7;break;case"zh":i=18;break}let s=Z.buildText(Ri.getText("NO").toUpperCase(),i).setDefaultStroke().setDefaultShadow({offsetX:-1,offsetY:1.5}).build(this.scene);this.cancelBtn.add(s),s.setPosition(0,t),this.add(this.cancelBtn),On.Align.In.Center(this.cancelBtn,this.popup,70,60),this.cancelBtn.onClick=()=>{this.handleClosePopup()}}runOpenAnimation(){let e=this.screenAnimController.renew();this.animateBackgroundAlpha(.7,200),this.runPopupEntrancesAnimation(e),this.runPopupContentEntrancesAnimation(100,400,e)}runPopupEntrancesAnimation(e){gt.runTween(this.scene.tweens.add({...fe,paused:!0,targets:this.popup,onStart:()=>{this.popup.revive()}}),e)}runPopupContentEntrancesAnimation(e,t,i){let s=[this.title,this.bossLevelText,this.description,this.confirmBtn,this.cancelBtn];for(let n of s)n.setAlpha(0);gt.runTween(this.scene.tweens.add({...ns,targets:s,duration:t,delay:this.scene.tweens.stagger(100,{start:e}),props:{scale:{from:.7,to:1},alpha:{from:0,to:1}}}),i)}runFadeOutAnimation(e){let t=[this.title,this.bossLevelText,this.description,this.confirmBtn,this.cancelBtn];this.animateBackgroundAlpha(0,200),gt.runTween(this.scene.tweens.add({paused:!0,targets:t,duration:200,ease:_2.Cubic.Out,props:{alpha:{start:.7,from:.7,to:0}},onStart:()=>{this.popup.kill()},onUpdate:(i,s)=>{nt.getGlobalScene()?.requestBackgroundMaskUpdate(tt.BOSS_CHALLENGE_SCREEN,s.alpha)},onComplete:()=>{let i=this.scene.scene.get(ct.GAME_SCENE);if(i instanceof St){let{powerManager:s}=i;ot.removeResizeEventForCalculateLight(this),this.isAccepted||s.updateTimers()}ot.closeScreen(this.name)}}),e)}handleShowRewardedVideoAd=async()=>{if(this.confirmBtn.setDisabled(!0),this.cancelBtn.setDisabled(!0),await wt.showRewardVideoAdAsync()){this.handleClosePopup();let e=this.scene.scene.get(ct.GAME_SCENE);this.scene.time.delayedCall(200,()=>{e instanceof St&&e.requestBossFight()})}this.confirmBtn.setDisabled(!1),this.cancelBtn.setDisabled(!1)};isBossChallengeAvailable(){let e=At.getLastBossChallengeTime(),t=Date.now();return I2.duration-(t-e)<=0}setAdMode(e){let t=Ri.getCurrentLocale(),i=-5,s=15,n=20;switch(t){case"tr":i=-8;break;case"ja":n=18,i=-7;break;case"zh":n=18;break}e?(this.adIcon.setVisible(!0),this.confirmBtnText.setFontSize(20),this.confirmBtnText.setPosition(s,i)):(this.adIcon.setVisible(!1),this.confirmBtnText.setFontSize(n),this.confirmBtnText.setPosition(0,i))}},O2=M2,D2=U(Nt()),Pg=U(dt()),{KEY:Lg,FRAME:Ig}=W.DEFAULT_8_BIT,{Plugins:{Ads:{Types:{REWARDED_VIDEO:k2}}}}=Ludex,B2=class extends pg{numOfCols;colPadding;sliderBg;sliderBar;minSliderY;maxSliderY;constructor(e,t){super(e,t),this.numOfCols=t.numOfCols?t.numOfCols:2,this.colPadding=t.colPadding?t.colPadding:0,this.createSlider(),this.updateConfig(t.listConfigs)}createSlider(){let e=this.scene.make.image({key:Lg,frame:Ig.UNIT_SCREEN_SLIDEBAR_BG});e.setName("sliderBg"),e.setWorldSize(6.5,255),Pg.Align.In.RightCenter(e,this,-3,5),this.add(e),this.sliderBg=e;let t=this.scene.make.image({key:Lg,frame:Ig.UNIT_SCREEN_BAR});t.setName("sliderBar"),t.setWorldSize(3.5,41.5),Pg.Align.In.TopCenter(t,this.sliderBg),this.add(t),this.sliderBar=t;let{y:i,displayHeight:s}=this.sliderBg;this.minSliderY=i-s/2+this.sliderBar.displayHeight/2+1.5,this.maxSliderY=this.minSliderY+this.sliderBg.displayHeight-this.sliderBar.displayHeight-1.5}createEvents(){super.createEvents(),this.scene.events.on(D2.UPDATE,()=>{let e=this.value-this.marginTop;this.value<-this.maxHeight?e=-this.maxHeight:this.value>0&&(e=0),e=-e;let t=e/(this.maxHeight+this.marginTop);this.sliderBar.setY(this.minSliderY+t*(this.maxSliderY-this.minSliderY))})}updateMaxHeight(){let e=Math.ceil(this.listConfigs.length/this.numOfCols);return this.maxHeight=Math.max(e*(this.objHeight+this.padding)-this.padding+this.marginBottom-this.height,0),this.maxHeight}addObjectIndex(e,t){for(let i=e;i<=t;i++){let{padding:s,listConfigs:n}=this;if(i>=n.length)return;let r=this.objects.getFirstDead(!0),o=r.height,a=Math.floor(i/this.numOfCols),h=i%this.numOfCols,l=o/2,c=(o+s)*a,f=this.height/2,u=l+c+this.value-f,p=r.width,d=p/2,g=-(this.numOfCols*(p+this.colPadding)-this.colPadding)/2+d+(p+this.colPadding)*h;r.updateInfo(n[i]),r.setPosition(g,u),r.setActive(!0),r.setVisible(!0),this.addAt(r),this.listObjects[i]=r}}getEndObjectIndex(){let{objHeight:e,padding:t,listConfigs:i}=this,s=e+t;return Math.min(this.numOfCols*Math.floor((this.height-this.value)/s)+(this.numOfCols-1),i.length)}updateListConfigMember(e,t,i){for(let n=0;n<this.listObjects.length;n++){let r=this.listConfigs[n],{unitType:o,originData:a,currentAdWatched:h}=r;if(!o||!a||h===void 0)continue;let{level:l}=a;if(l&&o===e&&l===t){r.currentAdWatched=i;break}}if(wt.isReadyAdShowable(k2))return;let s=this.objects.getMatching("active",!0);for(let n of s)n.disableAds()}},N2=B2,U2=U(dt()),{KEY:jr,FRAME:Zr}=W.DEFAULT_8_BIT,{language:Ks}=codex,F2=class extends Gt{countText;adContainer;btnText;iconAd;iconCoin;constructor(e){super(e,jr,Zr.UNIT_SCREEN_AD_BUTTON,145,41),this.createText(),this.createAdCount()}createText(){let e=Z.buildText(Ks.getText("FREE").toUpperCase(),20).setDefaultStroke().setDefaultShadow({offsetX:-3,offsetY:3}).build(this.scene);e.setY(-7),this.add(e),this.btnText=e}getBtnTextFontSize(e){let t=Ks.getCurrentLocale(),i=20;switch(e){case"notAvailable":switch(t){case"pt":i=17;break;case"id":i=18;break;case"de":case"it":case"tr":i=16;break}break}return t==="ja"&&(i=16),i}createAdCount(){let e=this.scene.make.container({}),t=this.scene.make.image({key:jr,frame:Zr.UNIT_SCREEN_AD_COUNT_BG});t.setWorldSize(68.5,17.5),e.setSize(68.5,17.5),e.add(t);let i=this.scene.make.image({key:jr,frame:Zr.UNIT_SCREEN_AD_ICON});i.setWorldSize(9,7.5),i.setX(-25),e.add(i),this.iconAd=i;let s=this.scene.make.image({key:jr,frame:Zr.UNIT_SCREEN_COIN_ICON});s.setWorldSize(12,11.5),s.setX(-25),e.add(s),this.iconCoin=s;let n=Z.buildText("0/999",10).setOrigin({x:.5,y:.6}).build(this.scene);e.add(n),this.countText=n,U2.Align.In.BottomCenter(e,this),this.add(e),this.adContainer=e}setCountText(e,t){t===0?this.countText.setText(`${e.toString()}`):t===-1?this.countText.setText(""):this.countText.setText(`${e.toString()}/${t}`),t===0?this.setMode("buy"):t===-1?this.setMode("notAvailable"):typeof e=="number"&&e>=t?this.setMode("collect"):this.setMode("watch")}setMode(e){e==="watch"?(this.adContainer.revive(),this.iconAd.revive(),this.iconCoin.kill(),this.btnText.setText(Ks.getText("FREE"))):e==="collect"?(this.adContainer.kill(),this.btnText.setText(Ks.getText("COLLECT"))):e==="notAvailable"?(this.adContainer.kill(),this.btnText.setText(Ks.getText("UNAVAILABLE"))):(this.adContainer.revive(),this.iconAd.kill(),this.iconCoin.revive(),this.btnText.setText(Ks.getText("BUY"))),this.btnText.setFontSize(this.getBtnTextFontSize(e))}},G2=F2,Mg=U(pn()),js=U(dt()),Y2=U(it()),Og=U(ft()),H2=U(Cs()),{KEY:Eh,FRAME:Dg}=W.UNITS,{KEY:us,FRAME:Ci}=W.DEFAULT_8_BIT,{MaximumMeleeLevel:W2,MaximumRangedLevel:z2}=Ut,{MELEE_UNIT_TYPE:V2,RANGED_UNIT_TYPE:X2}=Q,{language:kg}=codex,{Utils:{Signal:K2,String:j2,Number:Bg},Plugins:{Ads:{Types:{REWARDED_VIDEO:Z2}}}}=Ludex,q2=class extends Y2.Container{background;watchAdButton;titleText;lock;healthContainer;healthText;atkContainer;atkText;unitIcon;payload;showPopUpAnimController=new K2.SignalController;loading;constructor(e,t){super(e),this.scene=e,this.createBackground(),this.createWatchAdButton(),this.updateSize(),this.createUnitIcon(),this.createTitleText(),this.createLock(),this.createHealthContainer(),this.createAtkContainer(),t&&this.updateInfo(t),this.scene.add.existing(this)}updateInfo(e){this.payload={isUnlock:!1,isCanBuy:!1,coinNeed:new Dt(0),...e},this.updateFrame(),this.updateTitle(),this.updateAdButton(),this.updateLock(),this.updateUnitIcon(),this.updateHealthContainer(),this.updateAtkContainer()}disableAds(){let{currentAdWatched:e,targetAdWatched:t}=this.payload;t>0&&e<t&&this.watchAdButton.setDisabled(!0)}runShowUpAnimation(e=0,t=300){let i=e*100;this.runShowPopUpAnimation(i,t),this.runShowItemAnimation(i,t)}runShowPopUpAnimation(e,t){let i=this.showPopUpAnimController.renew();this.scene.tweens.killTweensOf(this),gt.runTween(this.scene.tweens.add({...fe,paused:!0,targets:this,delay:e,duration:t,props:{...fe.props,y:{...fe.props.y,start:this.y+70,to:this.y}}}),i)}runShowItemAnimation(e,t){let i=[this.background,this.watchAdButton,this.titleText,this.lock,this.healthContainer,this.atkContainer];this.unitIcon.visible&&this.unitIcon.active&&i.push(this.unitIcon);let s=i.map(r=>r.alpha);i.forEach(r=>r.setAlpha(0));let n=i.map(r=>r.scale);this.scene.tweens.killTweensOf(i),this.scene.add.tween({targets:i,duration:t,delay:this.scene.tweens.stagger(50,{start:e+50}),props:{scale:{duration:1e3,getStart:(r,o,a,h)=>n[h]*.8,getEnd:(r,o,a,h)=>n[h],ease:Og.Elastic.Out,easeParams:[.1,.45]},alpha:{duration:500,getStart:r=>(r.setAlpha(0),0),getEnd:(r,o,a,h)=>s[h],ease:Og.Cubic.Out}},onStop:()=>{i.forEach((r,o)=>{r.setScale(n[o])})},onComplete:()=>{i.forEach((r,o)=>{r.setScale(n[o])})}})}createBackground(){this.background=this.scene.make.image({key:us,frame:Ci.UNIT_SCREEN_FRAME_1}),this.background.setWorldSize(145,205),this.background.setY(-20.5),this.add(this.background)}createWatchAdButton(){let e=new G2(this.scene);e.onClick=this.handleClickWatchAd,this.add(e),js.Align.In.BottomCenter(e,this.background,0,41),this.watchAdButton=e}canCollectUnit(e,t=!1){let i=this.scene.scene.get(ct.GAME_SCENE);if(!(i instanceof St))return!1;let s=e===Q.MELEE_UNIT_TYPE?"MELEE":"RANGED";return i.canSpawnUnit(s,t)}collectUnit(e,t,i=!1){let s=this.scene.scene.get(ct.GAME_SCENE);if(!(s instanceof St))return;let n=e===Q.MELEE_UNIT_TYPE?"MELEE":"RANGED";s.spawnUnit(n,!0,t,i)}handleClickWatchAd=async()=>{let{currentAdWatched:e,targetAdWatched:t,updateDataCallback:i,unitType:s,originData:n,showAdsCallback:r,collectCallback:o}=this.payload,{level:a}=n;if(e>=t){let h=t===0;if(h||xt.trackButtonClick(this.watchAdButton.name),o(s,a,h),!this.canCollectUnit(s,h))return;this.scene.renderer.once(H2.default.Events.PRE_RENDER,()=>{this.collectUnit(s,a,h)}),xt.logEarnUnitAnalytics(s,a),this.payload.currentAdWatched=0,i(s,a,this.payload.currentAdWatched),this.updateAdButton();return}xt.trackButtonClick(this.watchAdButton.name);try{if(!await r())return}catch{return}this.payload.currentAdWatched++,i(s,a,this.payload.currentAdWatched),this.updateAdButton()};updateSize(){let{width:e,height:t}=this.background;this.setSize(e,t+41)}createTitleText(){let e=Z.buildText("Locked",15).setFixedWidth(195).setAlign("center").setHighQuality().build(this.scene);this.add(e),this.titleText=e}createLock(){let e=this.scene.make.image({key:us,frame:Ci.UNIT_SCREEN_ICON_LOCK});e.setWorldSize(21,28),this.add(e),this.lock=e}createHealthContainer(){this.healthContainer=this.scene.make.container({});let e=this.scene.make.image({key:us,frame:Ci.UNIT_SCREEN_BG});e.setWorldSize(56.5,18),this.add(e);let t=this.scene.make.image({key:us,frame:Ci.UNIT_SCREEN_ICON_HEART});t.setWorldSize(15,13.5),js.Align.In.LeftCenter(t,e,-5);let i=Z.buildText("0",13).setFixedWidth(13*13).setAlign("center").setHighQuality().build(this.scene);i.setPosition(10,0),this.healthText=i,this.healthContainer.add([e,t,i]),this.add(this.healthContainer),js.Align.In.TopLeft(this.healthContainer,this.background,-35,-12)}createAtkContainer(){this.atkContainer=this.scene.make.container({});let e=this.scene.make.image({key:us,frame:Ci.UNIT_SCREEN_BG});this.add(e),e.setWorldSize(56.5,18);let t=this.scene.make.image({key:us,frame:Ci.UNIT_SCREEN_ICON_BATTLE});t.setWorldSize(14,13),js.Align.In.LeftCenter(t,e,-5);let i=Z.buildText("0",13).setFixedWidth(13*13).setAlign("center").setHighQuality().build(this.scene);i.setPosition(10,0),this.atkText=i,this.atkContainer.add([e,t,i]),this.add(this.atkContainer),js.Align.In.TopRight(this.atkContainer,this.background,-35,-12)}createUnitIcon(){this.loading=new Sn(this.scene),this.loading.setY(-30),this.add(this.loading);let e=this.scene.make.image({key:us,frame:Ci.BLANK});e.setWorldSize(142,142),this.add(e),js.Align.In.Center(e,this.background,0,-8),e.kill(),this.unitIcon=e}updateFrame(){let{isUnlock:e}=this.payload;e?(this.background.setFrame(Ci.UNIT_SCREEN_FRAME_1),this.background.setWorldSize(145,205)):(this.background.setFrame(Ci.UNIT_SCREEN_FRAME_LOCKED),this.background.setWorldSize(145,202.5))}updateTitle(){let{isUnlock:e}=this.payload;if(this.titleText.setScale(1),e){let{name:t}=this.payload.originData;switch(this.titleText.setText(t),this.titleText.setColor("#FFFFFF"),this.titleText.setPosition(0,58),kg.getCurrentLocale()){case"ja":this.titleText.text.length>8&&this.titleText.setScale(8/this.titleText.text.length);break;default:this.titleText.text.length>15&&this.titleText.setScale(15/this.titleText.text.length);break}}else{let t=kg.getText("LOCKED");this.titleText.setPosition(0,58),this.isUnitComingSoon()&&(t="Coming Soon",this.titleText.setPosition(0,58)),this.titleText.setText(t),this.titleText.setColor("#9AACBF")}}isUnitComingSoon(){let{originData:e,unitType:t}=this.payload,{level:i}=e;switch(t){case V2:return i>W2;case X2:return i>z2;default:return!0}}updateAdButton(){let{isUnlock:e,currentAdWatched:t,targetAdWatched:i,isUnitBoardFull:s,coinNeed:n,isCanBuy:r,unitType:o,originData:a}=this.payload,{level:h}=a,l=!1,c=this.scene.scene.get(ct.GAME_SCENE);if(c instanceof St&&(l=c.gameMode===Tt.BATTLE),this.watchAdButton.setDisabled(!1),e)if(this.watchAdButton.setVisible(!0),i===0){let f=j2.toCamelCase(o);this.watchAdButton.setName(`Buy${f}Unit`),this.watchAdButton.setCountText(n,i),(!r||s||l)&&this.watchAdButton.setDisabled(!0)}else if(i===-1)this.watchAdButton.setName(`NotAvailable${o}${h}Unit`),this.watchAdButton.setCountText(0,i),this.watchAdButton.setDisabled(!0);else{let f="BuyUnitByRewardedVideo";t>=i&&(f="CollectUnitByRewardedVideo"),this.watchAdButton.setName(f);let u=t??0;this.watchAdButton.setCountText(u,i),t>=i&&(s||l)&&this.watchAdButton.setDisabled(!0),t<i&&!wt.isReadyAdShowable(Z2)&&this.watchAdButton.setDisabled(!0)}else this.watchAdButton.setVisible(!1)}updateLock(){let{isUnlock:e}=this.payload;e?this.lock.setVisible(!1):(this.isUnitComingSoon()?this.lock.setPosition(-45,53):this.lock.setPosition(-57,25),this.lock.setVisible(!0))}updateUnitIcon(){let e=this.getUnitFrame();e!==""&&(this.scene.textures.get(Eh).has(e)?this.setUnitFrame(e):this.scene.textures.on(Mg.ADD,this.handleWaitAddTexture))}getUnitFrame(){let{isUnlock:e,unitType:t}=this.payload,{level:i}=this.payload.originData,s="UNLOCKED";e||(s="LOCKED");let n="";return t===Q.MELEE_UNIT_TYPE&&(n=Dg[s].MELEE[i]),t===Q.RANGED_UNIT_TYPE&&(n=Dg[s].RANGED[i]),n}handleWaitAddTexture=e=>{if(e!==Eh||(this.scene.textures.off(Mg.ADD,this.handleWaitAddTexture),!this.visible&&!this.active))return;let t=this.getUnitFrame();t!==""&&this.setUnitFrame(t)};setUnitFrame(e){this.unitIcon.revive(),this.loading.kill(),this.unitIcon.setTexture(Eh,e),this.unitIcon.setWorldSize(142,142)}updateHealthContainer(){let{health:e}=this.payload.originData,t=Bg.toAbbreviatedString(e);this.healthText.setText(t)}updateAtkContainer(){let{damage:e}=this.payload.originData,t=Bg.toAbbreviatedString(e);this.atkText.setText(t)}},Q2=q2,J2=U(it()),$2=class extends J2.Container{scroller;constructor(e){super(e),this.createScroller(),this.scene.add.existing(this)}createScroller(){this.scroller=new N2(this.scene,{classType:Q2,listConfigs:[],width:322,height:423.5-158,padding:10,marginTop:10,marginBottom:10,numOfCols:2,colPadding:5}),this.scroller.setName("scroller"),this.scroller.createMask(),this.scroller.setPosition(0,40),this.add(this.scroller)}updateData(e){e.length<1||(this.scroller.updateConfig(e),this.runAnimations())}updateListConfigMember(e,t,i){this.scroller.updateListConfigMember(e,t,i)}runAnimations(){let e=this.scroller.getChildren();if(e.length<1){let n=ot.getScreen(tt.UNITS_SCREEN);if(!(n instanceof Ah))return;n.isSwitchable=!0;return}let t=Math.min(e.length,this.scroller.numOfCols*3),i=300;for(let n=0;n<t;n++){let r=e[n];r&&(r.setVisible(!0),r.runShowUpAnimation(n,i))}let s=i+t*100+50*5;this.scene.time.delayedCall(s,()=>{let n=ot.getScreen(tt.UNITS_SCREEN);n instanceof Ah&&(n.isSwitchable=!0,this.scroller.setEnable(!0))})}},tG=$2,eG=U(dt()),{KEY:iG,FRAME:sG}=W.DEFAULT_8_BIT,nG=class extends Gt{focusFrame;text;constructor(e,t,i,s){super(e,t,i),this.createText(s),this.createFocus()}createText(e){let t=Z.buildText(e,13).setDefaultStroke().setFixedWidth(169).setAlign("center").setHighQuality().setDefaultShadow({offsetY:2}).build(this.scene);this.add(t),this.text=t}createFocus(){let e=this.scene.make.image({key:iG,frame:sG.UNIT_SCREEN_TAB_FOCUS});e.setName("focus"),e.setWorldSize(57,3.5),e.setVisible(!1),eG.Align.In.Center(e,this,0,this.button.height),e.setPosition(0,13),this.add(e),this.focusFrame=e}turnOnFocus(){this.focusFrame.setVisible(!0),this.text.setColor("#FFFFFF")}turnOffFocus(){this.focusFrame.setVisible(!1),this.text.setColor("#72ABFA")}},Ng=nG,rG=U(it()),yh=U(dt()),{KEY:Th,FRAME:Sh}=W.DEFAULT_8_BIT,{language:Ug}=codex,aG=class extends rG.Container{ribbon;dinosaursBtn;warriorsBtn;constructor(e){super(e),this.createRibbon(),this.createDinosaursBtn(),this.createWarriorsBtn()}selectTabDinosaurs(){this.dinosaursBtn.turnOnFocus(),this.warriorsBtn.turnOffFocus()}selectTabWarriors(){this.dinosaursBtn.turnOffFocus(),this.warriorsBtn.turnOnFocus()}createRibbon(){let e=this.scene.make.image({key:Th,frame:Sh.UNIT_SCREEN_TAB_BG});e.setWorldSize(329,29),e.setName("ribbon"),yh.Align.In.Center(e,this),this.add(e),this.ribbon=e}createDinosaursBtn(){let e=new Ng(this.scene,Th,Sh.BLANK,Ug.getText("DINOSAURS").toUpperCase());e.button.setWorldSize(85,29),e.button.setVisible(!1),e.setName("DinosaursTab"),yh.Align.In.Center(e,this.ribbon,-100,0),this.add(e),this.dinosaursBtn=e}createWarriorsBtn(){let e=new Ng(this.scene,Th,Sh.BLANK,Ug.getText("WARRIORS").toUpperCase());e.button.setWorldSize(85,29),e.button.setVisible(!1),e.setName("WarriorsTab"),yh.Align.In.Center(e,this.ribbon,0,0),this.add(e),this.warriorsBtn=e}},oG=aG,Zs=U(dt()),hG=U(it()),{language:Ht}=codex,{KEY:lG,FRAME:uG}=W.DEFAULT,cG=class extends hG.Container{popup;tabs;scrollerController;closeBtn;onClose;constructor(e){super(e),this.createPopup(),this.createPopupContents(),this.updateSize(),this.createCloseButton()}updateSize(){let{width:e,height:t}=this.popup;this.setSize(e,t)}createPopup(){this.popup=new Ui(this.scene,{x:0,y:0,width:332,height:399,rightEdge:283798,bottomRightCorner:215172,bottomEdge:76382,mainTopColorGradient:145525,mainBotColorGradient:145525,topInnerCornerStrokeWidth:1.3,rightInnerCornerStrokeWidth:3}),this.popup.turnOffLight(),this.add(this.popup),Zs.Align.In.Center(this.popup,this)}recalculateLightPosition(){this.popup&&this.popup.recalculateLightPosition()}createPopupContents(){this.createTitle(),this.createScrollerController(),this.createNonInteractiveArea(),this.createTabs()}createTitle(){let e=this.scene.add.container();e.setName("title");let t=this.scene.make.image({key:lG,frame:uG.RIBBON_BLUE});t.setWorldSize(239,67);let i=Z.buildText(Ht.getText("CHARACTER_LIST").toUpperCase(),21).setFixedWidth(13*22).setAlign("center").setHighQuality().build(this.scene);Zs.Align.In.Center(i,t,0,-10),e.add([t,i]),this.add(e),Zs.Align.In.TopCenter(e,this.popup,0,-28)}createTabs(){this.tabs=new oG(this.scene),this.tabs.setName("tabs"),this.add(this.tabs),Zs.Align.In.TopCenter(this.tabs,this.popup,0,-85)}createScrollerController(){this.scrollerController=new tG(this.scene),this.add(this.scrollerController),Zs.Align.In.Center(this.scrollerController,this.popup)}createNonInteractiveArea(){let e=0;$.isLandscape()&&(e=15);let t=40,i=322,s=423.5-158,n=this.scrollerController.y+t,r=s+50,o=this.scene.add.zone(0,0,i,r);o.setPosition(0,n-e-(s+(r-s)/2)),o.setInteractive(),this.add(o);let a=this.scene.add.zone(0,0,i,r);a.setPosition(0,n+e+(s+(r-s)/2)),a.setInteractive(),this.add(a)}createCloseButton(){this.closeBtn=new Ni(this.scene),Zs.Align.In.TopRight(this.closeBtn,this,10,10),this.add(this.closeBtn),this.closeBtn.onClick=this.handleOnCloseClick}handleOnCloseClick=()=>{this.onClose&&this.onClose()};updateData(e){e.forEach(t=>{t.originData.name=this.translateUnitName(t.originData.name).toUpperCase()}),this.scrollerController.updateData(e)}translateUnitName(e){switch(e){case"Rockthrower":return Ht.getText("ROCKTHROWER");case"Javelineer":return Ht.getText("JAVELINEER");case"Boomeranger":return Ht.getText("BOOMERANGER");case"Macer":return Ht.getText("MACER");case"Artemis":return Ht.getText("ARTEMIS");case"William":return Ht.getText("WILLIAM");case"Blanchette":return Ht.getText("BLANCHETTE");case"Phantom":return Ht.getText("PHANTOM");case"Oracle":return Ht.getText("ORACLE");case"Shaman":return Ht.getText("SHAMAN");case"Seraph":return Ht.getText("SERAPH");case"Velociraptor":return Ht.getText("VELOCIRAPTOR");case"Saurolophus":return Ht.getText("SAUROLOPHUS");case"Pachysaurus":return Ht.getText("PACHYSAURUS");case"Triceratops":return Ht.getText("TRICERATOPS");case"Stegosaurus":return Ht.getText("STEGOSAURUS");case"Ankylosaurus":return Ht.getText("ANKYLOSAURUS");case"Baroptiloraptor":return Ht.getText("BAROPTILORAPTOR");case"Tyrannosaurus":return Ht.getText("TYRANNOSAURUS");case"Dilophosaurus":return Ht.getText("DILOPHOSAURUS");case"Triceradonosaurus":return Ht.getText("TRICERADONOSAURUS");case"Spinosaurus Rex":return Ht.getText("SPINOSAURUS_REX");default:return e}}updateListConfigMember(e,t,i){this.scrollerController.updateListConfigMember(e,t,i)}removeAllBlocks(){this.scrollerController.updateData([])}},dG=cG,pG=U(dt()),gG=U(ft()),{Utils:{Signal:Fg}}=Ludex,{AD_WATCH_REQUIREMENT:Gg}=Q,{MaximumMeleeLevel:Yg,MaximumRangedLevel:fG}=Ut,{player:mG}=codex,vG=class extends ye{unitPopup;isSwitchable;showPopupAnimController=new Fg.SignalController;fadeOutAnimController=new Fg.SignalController;adsTimer;isShowingAds;constructor(e,t){super(e,t),this.background.setAlpha(.7),this.setDepth(hi.POPUP),this.createUnitPopup()}open(){super.open(),this.isShowingAds=!1,nt.getGlobalScene()?.requestBackgroundMaskUpdate(tt.UNITS_SCREEN,this.background.alpha),this.runPopupAnimation(),this.isSwitchable=!1,this.selectDinosaursTab()}selectDinosaursTab(){this.unitPopup.tabs.selectTabDinosaurs(),this.unitPopup.removeAllBlocks();let e=this.getDataOf(Q.MELEE_UNIT_TYPE);this.unitPopup.updateData(e)}selectWarriorsTab(){this.unitPopup.tabs.selectTabWarriors(),this.unitPopup.removeAllBlocks();let e=this.getDataOf(Q.RANGED_UNIT_TYPE);this.unitPopup.updateData(e)}recalculateLightPosition(){this.unitPopup&&this.unitPopup.recalculateLightPosition()}getDataOf(e){let t=[],i=this.scene.scene.get(ct.GAME_SCENE),s=this.getAdWatchedCount(e),n=!0,r=1,o=!1;if(i instanceof St&&(n=!(i.fieldManager.getRemainingAvailablePlacement()>0),r=i.getBuyingUnitLevel(),o=i.tutorialManager.isRunning()),e===Q.MELEE_UNIT_TYPE){let a=At.getPlayerUnlockedMeleeLevel();(!a||typeof a!="number")&&(a=1);let h=_t.inst.getCoin(),l=new Dt(0),c=!0;if(i instanceof St){let f=i.unitManager.getPlayerMeleeSpawnedUnitsCount();l=i.coinManager.getUnitPrice(f)}if(h.smallerThan(l)){let f=h.toString(),u=l.toString();f!==u&&(c=!1)}this.scene.cache.json.get("unitData").melee.forEach(f=>{t.push({originData:f,unitType:Q.MELEE_UNIT_TYPE,isUnlock:f.level<=a,currentAdWatched:s[f.level-1],targetAdWatched:!o&&f.level>=r?Gg[f.level-1]:-1,isUnitBoardFull:n,isCanBuy:f.level===1&&c,coinNeed:l,updateDataCallback:this.updateListConfig,showAdsCallback:this.handleShowRewardedVideoAd,collectCallback:this.handleCloseScreen})})}else if(e===Q.RANGED_UNIT_TYPE){let a=At.getPlayerUnlockedRangedLevel();(!a||typeof a!="number")&&(a=1);let h=_t.inst.getCoin(),l=new Dt(0),c=!0;if(i instanceof St){let f=i.unitManager.getPlayerRangedSpawnedUnitsCount();l=i.coinManager.getUnitPrice(f)}if(h.smallerThan(l)){let f=h.toString(),u=l.toString();f!==u&&(c=!1)}this.scene.cache.json.get("unitData").ranged.forEach(f=>{t.push({originData:f,unitType:Q.RANGED_UNIT_TYPE,isUnlock:f.level<=a,currentAdWatched:s[f.level-1],targetAdWatched:!o&&f.level>=r?Gg[f.level-1]:-1,isUnitBoardFull:n,isCanBuy:f.level===1&&c,coinNeed:l,updateDataCallback:this.updateListConfig,showAdsCallback:this.handleShowRewardedVideoAd,collectCallback:this.handleCloseScreen})})}return t}getAdWatchedCount(e){let t=At.getPlayerAdWatchedCount(),i={},s=0;if(e===Q.MELEE_UNIT_TYPE)i=t.MELEE,s=Yg;else if(e===Q.RANGED_UNIT_TYPE)i=t.RANGED,s=fG;else{let r=[];for(let o=0;o<s;o++)r.push(0);return r}let n=[];for(let[r,o]of Object.entries(i)){let a=parseInt(r);if(a>s||a<1)break;n[a-1]=o}return n.forEach((r,o)=>{r===void 0&&(n[o]=0)}),n}createUnitPopup(){this.unitPopup=new dG(this.scene),this.unitPopup.setName("UnitPopup"),this.unitPopup.onClose=this.handleCloseScreen,pG.Align.In.Center(this.unitPopup,this,0,-20),this.add(this.unitPopup),this.unitPopup.tabs.dinosaursBtn.onClick=this.handleSelectDinosaursTab,this.unitPopup.tabs.warriorsBtn.onClick=this.handleSelectWarriorsTab}handleSelectDinosaursTab=()=>{this.isSwitchable&&(this.isSwitchable=!1,this.selectDinosaursTab())};handleSelectWarriorsTab=()=>{this.isSwitchable&&(this.isSwitchable=!1,this.selectWarriorsTab())};handleCloseScreen=()=>{this.runFadeOutAnimation()};runPopupAnimation(){let e=this.showPopupAnimController.renew();gt.runTween(this.scene.tweens.add({...fe,paused:!0,targets:this.unitPopup}),e)}runFadeOutAnimation(){let e=this.fadeOutAnimController.renew();gt.runTween(this.scene.tweens.add({targets:this.background,duration:200,ease:gG.Cubic.Out,props:{alpha:{start:.7,from:.7,to:0}},onActive:()=>{this.unitPopup.kill()},onUpdate:(t,i)=>{nt.getGlobalScene()?.requestBackgroundMaskUpdate(tt.UNITS_SCREEN,i.alpha)},onComplete:()=>{this.unitPopup.revive(),this.background.setAlpha(.7),ot.closeScreen(this.name)}}),e)}updateListConfig=(e,t,i)=>{let s={MELEE:{},RANGED:{}};try{s=this.mergeAndGetAdWatchedCountConfig(e,t,i)}catch{}mG.setGameData({unitScreenAdWatchedCount:s}),this.unitPopup.updateListConfigMember(e,t,i)};mergeAndGetAdWatchedCountConfig(e,t,i){if(t===void 0||i===void 0)return{MELEE:{},RANGED:{}};if(e===Q.MELEE_UNIT_TYPE&&t<=Yg&&t>0)return{MELEE:{[t]:i},RANGED:{}};if(e===Q.RANGED_UNIT_TYPE)return{MELEE:{},RANGED:{[t]:i}};throw Error(`Unknown type in Get Ad Watched Config: ${e}`)}handleShowRewardedVideoAd=async()=>{if(this.isShowingAds)return!1;let e=!1;return this.isShowingAds=!0,await wt.showRewardVideoAdAsync()&&(ut.playSound(Et.DAILY_REWARD),e=!0),this.isShowingAds=!1,e}},Ah=vG,EG=U(it()),yG=U(ft()),{KEY:TG,FRAME:SG}=W.GAMEPLAY,AG=class extends EG.Container{emitter;constructor(e){super(e),this.createEmitters(),this.setActive(!1),this.setVisible(!1),this.scene.add.existing(this)}createEmitters(){let e=1/$.getPixelRatio();this.emitter=this.scene.make.particles({key:TG,config:{frame:SG.DASHBOARD_COINBAR_COIN,gravityY:160,angle:{min:-180,max:0},speed:{min:50,max:200},scale:{min:e*.8,max:e*.8},alpha:{start:1,end:0,ease:yG.Expo.In},lifespan:1500}}),this.add(this.emitter),this.emitter.stop()}explode(e,t,i){this.setActive(!0),this.setVisible(!0),this.emitter.explode(e,t,i)}kill(){super.kill(),this.emitter.stop()}revive(){super.revive(),this.emitter.start()}},xG=AG,wG=U(it()),RG=U(qt()),{KEY:cs,FRAME:ds}=W.EFFECTS,CG={CONFETTI_HEXAGON:{KEY:"confetti-hexagon-animation",TEXTURE:cs,PREFIX:ds.FX_CONFETTI_HEXAGON,FRAME_RATE:8,END:5,ZERO_PAD:0},CONFETTI_STAR_X:{KEY:"confetti-star-x",TEXTURE:cs,PREFIX:ds.ANIMATION_STAR_X,FRAME_RATE:4,END:4,ZERO_PAD:0},CONFETTI_STAR_Y:{KEY:"confetti-star-y",TEXTURE:cs,PREFIX:ds.ANIMATION_STAR_Y,FRAME_RATE:4,END:4,ZERO_PAD:0},RIBBON_A:{KEY:"animation-ribbon-a",TEXTURE:cs,PREFIX:ds.PREFIX_ANIMATION_RIBBON_CONFETTI_A,FRAME_RATE:16,END:3,ZERO_PAD:0},RIBBON_B:{KEY:"animation-ribbon-b",TEXTURE:cs,PREFIX:ds.PREFIX_ANIMATION_RIBBON_CONFETTI_B,FRAME_RATE:16,END:4,ZERO_PAD:0},RIBBON_C:{KEY:"animation-ribbon-c",TEXTURE:cs,PREFIX:ds.PREFIX_ANIMATION_RIBBON_CONFETTI_C,FRAME_RATE:16,END:4,ZERO_PAD:0},RIBBON_D:{KEY:"animation-ribbon-d",TEXTURE:cs,PREFIX:ds.PREFIX_ANIMATION_RIBBON_CONFETTI_D,FRAME_RATE:16,END:4,ZERO_PAD:0}},It=CG,{KEY:_G,TEXTURE:bG,FRAME_RATE:PG,END:LG,PREFIX:IG,ZERO_PAD:MG}=It.RIBBON_A,OG=class extends RG.Animation{constructor(e){let t={repeat:-1,frameRate:PG,frames:e.generateFrameNames(bG,{prefix:IG,end:LG,zeroPad:MG,start:1}),yoyo:!0,showOnStart:!0};super(e,_G,t)}},DG=OG,kG=U(qt()),{KEY:BG,TEXTURE:NG,FRAME_RATE:UG,END:FG,PREFIX:GG,ZERO_PAD:YG}=It.RIBBON_B,HG=class extends kG.Animation{constructor(e){let t={repeat:-1,frameRate:UG,frames:e.generateFrameNames(NG,{prefix:GG,end:FG,zeroPad:YG,start:1}),yoyo:!0,showOnStart:!0};super(e,BG,t)}},WG=HG,zG=U(qt()),{KEY:VG,TEXTURE:XG,FRAME_RATE:KG,END:jG,PREFIX:ZG,ZERO_PAD:qG}=It.RIBBON_C,QG=class extends zG.Animation{constructor(e){let t={repeat:-1,frameRate:KG,frames:e.generateFrameNames(XG,{prefix:ZG,end:jG,zeroPad:qG,start:1}),yoyo:!0,showOnStart:!0};super(e,VG,t)}},JG=QG,$G=U(qt()),{KEY:tY,TEXTURE:eY,FRAME_RATE:iY,END:sY,PREFIX:nY,ZERO_PAD:rY}=It.RIBBON_D,aY=class extends $G.Animation{constructor(e){let t={repeat:-1,frameRate:iY,frames:e.generateFrameNames(eY,{prefix:nY,end:sY,zeroPad:rY,start:1}),yoyo:!0,showOnStart:!0};super(e,tY,t)}},oY=aY,hY=U(qt()),{KEY:lY,TEXTURE:uY,FRAME_RATE:cY,END:dY,PREFIX:pY,ZERO_PAD:gY}=It.CONFETTI_STAR_X,fY=class extends hY.Animation{constructor(e){let t={repeat:-1,frameRate:cY,frames:e.generateFrameNames(uY,{prefix:pY,end:dY,zeroPad:gY,start:1}),yoyo:!0,showOnStart:!0};super(e,lY,t)}},mY=fY,vY=U(qt()),{KEY:EY,TEXTURE:yY,FRAME_RATE:TY,END:SY,PREFIX:AY,ZERO_PAD:xY}=It.CONFETTI_STAR_Y,wY=class extends vY.Animation{constructor(e){let t={repeat:-1,frameRate:TY,frames:e.generateFrameNames(yY,{prefix:AY,end:SY,zeroPad:xY,start:1}),yoyo:!0,showOnStart:!0};super(e,EY,t)}},RY=wY,CY=U(it()),Dn=U(yt()),_Y=class extends CY.Particles.Particle{ribbon;graphics;colorUse;lastChange;currentFrame;isYoyo;isGravityChanged;points;constructor(e){super(e);let{x:t,y:i}=this.emitter;this.points=new Array(10).fill(null).map(()=>({x:this.x+t,y:this.y+i})),this.isYoyo=!1,this.isGravityChanged=!1,this.lastChange=0,this.currentFrame=-1,this.createGraphics(),this.randomRibbonUsedWhenFall()}randomRibbonUsedWhenFall(){switch((0,Dn.Between)(0,3)){case 0:this.ribbon=this.scene.anims.get(It.RIBBON_A.KEY);break;case 1:this.ribbon=this.scene.anims.get(It.RIBBON_B.KEY);break;case 2:this.ribbon=this.scene.anims.get(It.RIBBON_C.KEY);break;case 3:this.ribbon=this.scene.anims.get(It.RIBBON_D.KEY);break;default:this.ribbon=this.scene.anims.get(It.RIBBON_A.KEY);break}}setRibbonPosition(e,t){this.points.map(i=>{i.x=e,i.y=t})}createGraphics(){let e=[8443204,2928867,12013036,16376097,15285798];this.colorUse=e[(0,Dn.Between)(0,e.length-1)],this.graphics=this.scene.add.graphics({lineStyle:{width:3,color:this.colorUse}});let{x:t,y:i,depth:s}=this.emitter;this.graphics.setDepth(s),this.graphics.setPosition(t,i),this.emitter.parentContainer.add(this.graphics)}update(e,t,i){let s=super.update(e,t,i);return this.updateFrames(e),this.updatePoints(),this.updateGraphics(),this.updateGravity(),this.updateVelocity(),this.updateColor(),s}updateFrames(e){this.lastChange+=e,this.lastChange>=this.ribbon.msPerFrame&&(this.isYoyo?this.currentFrame--:this.currentFrame++,this.currentFrame<0&&(this.isYoyo=!1,this.currentFrame=1),this.currentFrame>=this.ribbon.frames.length&&(this.isYoyo=!0,this.currentFrame-=1),this.frame=this.ribbon.frames[this.currentFrame].frame,this.lastChange-=this.ribbon.msPerFrame)}updatePoints(){this.graphics.visible&&(this.points.shift(),this.points.push({x:this.x,y:this.y}))}updateGraphics(){if(this.graphics.visible){for(let e of this.points)if(e.y===0)return;this.graphics.clear(),this.graphics.strokePoints(this.points)}}updateGravity(){this.lifeCurrent>this.life-2e3||this.isGravityChanged||(this.isGravityChanged=!0,this.graphics.destroy(),this.emitter.setVisible(!0),this.emitter.setParticleGravity(0,45))}updateVelocity(){if(this.graphics.visible){if(this.lifeCurrent>this.life-1800){this.velocityX+=(0,Dn.Between)(-12,12);return}this.velocityX>0?this.velocityX+=(0,Dn.Between)(-10,6):this.velocityX+=(0,Dn.Between)(-6,10)}}updateColor(){this.graphics.visible||(this.tint=this.colorUse)}},bY=_Y,PY=U(it()),qr=U(yt()),LY=class extends PY.Particles.Particle{isYoyo;isGravityChanged;lastChange;currentFrame;star;starX;starY;constructor(e){super(e),this.isYoyo=!1,this.isGravityChanged=!1,this.lastChange=0,this.currentFrame=-1,this.starX=this.scene.anims.get(It.CONFETTI_STAR_X.KEY),this.starY=this.scene.anims.get(It.CONFETTI_STAR_Y.KEY),this.star=this.starX}update(e,t,i){let s=super.update(e,t,i);return this.updateGravity(),this.updateVelocity(),this.updateFrameRate(),this.updateFrames(e),s}updateGravity(){this.lifeCurrent>this.life-2e3||this.isGravityChanged||(this.isGravityChanged=!0,this.emitter.setParticleGravity(0,15),this.emitter.setParticleSpeed(0))}updateVelocity(){this.lifeCurrent>this.life-2e3||(this.velocityX>0?this.velocityX+=(0,qr.Between)(-6,3):this.velocityX+=(0,qr.Between)(-3,6))}updateFrames(e){if(this.lastChange+=e,this.lastChange>=this.star.msPerFrame){let t=qr.RND.between(0,1);this.star=t>0?this.starX:this.starY,this.isYoyo?this.currentFrame--:this.currentFrame++,this.currentFrame<0&&(this.isYoyo=!1,this.currentFrame=1,this.emitter.setAlpha(1)),this.currentFrame>=this.star.frames.length&&(this.isYoyo=!0,this.currentFrame-=1,this.emitter.setAlpha(.8)),this.frame=this.star.frames[this.currentFrame].frame,this.lastChange-=this.star.msPerFrame}}updateFrameRate(){this.lifeCurrent<this.life-2e3?this.star.msPerFrame=150:this.star.msPerFrame=qr.RND.between(300,600)}},IY=LY,{KEY:Qr,FRAME:Hg}=W.EFFECTS,MY=class extends wG.Container{emitterConfetti;emitterRibbons;ribbonConfig;confettiConfig;constructor(e){super(e),this.emitterRibbons=[],this.emitterConfetti=[],this.createConfigs(),this.createAnimations(),this.scene.add.existing(this)}createConfigs(){let e=[8443204,2928867,12013036,16376097,15285798];this.ribbonConfig={duration:100,visible:!1,timeScale:1.5,frame:Hg.BLANK,particleBringToTop:!0,speedY:{min:-480,max:-560},gravityY:290,lifespan:{min:4e3,max:6e3},rotate:{start:0,end:360*5,random:!0},scale:{min:.6,max:1},particleClass:bY};let t=Hg.PREFIX_ANIMATION_RIBBON_CONFETTI_A;this.confettiConfig={duration:100,delay:200,timeScale:2,tint:e,particleBringToTop:!0,frame:`${t}1`,speedY:{min:-460,max:-580},gravityY:280,lifespan:{min:5e3,max:8e3},rotate:{start:0,end:360*3},scale:{min:.6,max:1},particleClass:IY}}createAnimations(){if(!this.scene.anims.get(It.CONFETTI_STAR_X.KEY)){let e=new mY(this.scene.anims);this.scene.anims.add(It.CONFETTI_STAR_X.KEY,e)}if(!this.scene.anims.get(It.CONFETTI_STAR_Y.KEY)){let e=new RY(this.scene.anims);this.scene.anims.add(It.CONFETTI_STAR_Y.KEY,e)}if(!this.scene.anims.get(It.RIBBON_A.KEY)){let e=new DG(this.scene.anims);this.scene.anims.add(It.RIBBON_A.KEY,e)}if(!this.scene.anims.get(It.RIBBON_B.KEY)){let e=new WG(this.scene.anims);this.scene.anims.add(It.RIBBON_B.KEY,e)}if(!this.scene.anims.get(It.RIBBON_C.KEY)){let e=new JG(this.scene.anims);this.scene.anims.add(It.RIBBON_C.KEY,e)}if(!this.scene.anims.get(It.RIBBON_D.KEY)){let e=new oY(this.scene.anims);this.scene.anims.add(It.RIBBON_D.KEY,e)}}run(e,t,i,s){this.setPosition(e,t),this.width=i,this.height=s,this.createEmitters();for(let n of this.emitterConfetti)n.emitParticle(25);for(let n of this.emitterRibbons)n.emitParticle(20)}stop(){for(let e of this.emitterConfetti)e.killAll();for(let e of this.emitterRibbons)e.killAll();this.kill()}createEmitters(){this.emitterRibbons=[],this.emitterConfetti=[],this.createConfettiLeftEmitter(),this.createConfettiRightEmitter(),this.createRibbonLeftEmitter(),this.createRibbonRightEmitter()}createConfettiLeftEmitter(){let{height:e}=this,t=e/667*1.1,i={...this.confettiConfig,speedX:{min:5,max:90},speedY:{min:-460*t,max:-580*t},gravityY:280*t},s=this.scene.add.particles(0,0,Qr,i);this.add(s),this.emitterConfetti.push(s),s.stop()}createConfettiRightEmitter(){let{width:e,height:t}=this,i=t/667*1.1,s={...this.confettiConfig,speedX:{min:-5,max:-90},speedY:{min:-460*i,max:-580*i},gravityY:280*i},n=this.scene.add.particles(e,0,Qr,s);this.add(n),this.emitterConfetti.push(n),n.stop()}createRibbonLeftEmitter(){let{height:e}=this,t=e/667*1.1,i={...this.ribbonConfig,speedX:{min:20,max:80},speedY:{min:-480*t,max:-560*t},gravityY:290*t},s=this.scene.add.particles(0,0,Qr,i);this.add(s),this.emitterRibbons.push(s),s.stop()}createRibbonRightEmitter(){let{width:e,height:t}=this,i=t/667*1.1,s={...this.ribbonConfig,speedX:{min:-20,max:-80},speedY:{min:-480*i,max:-560*i},gravityY:290*i},n=this.scene.add.particles(e,0,Qr,s);this.add(n),this.emitterRibbons.push(n),n.stop()}killAllParticles(){this.emitterConfetti.forEach(e=>{e.forEachAlive(t=>{t.lifeCurrent=0},this)}),this.emitterRibbons.forEach(e=>{e.forEachAlive(t=>{t.lifeCurrent=0},this)})}},OY=MY,DY=U(it()),xh=U(ft()),{language:Hi}=codex,{KEY:qs,FRAME:Qs}=W.DEFAULT_8_BIT,{Utils:{Signal:kY}}=Ludex,BY=class extends DY.Container{continueButton;coinText;getText;winContainer;loseContainer;postAdContinueAnimation;replayButton;postAdReplayAnimation;returnButton;postAdReturnAnimation;openAnimController=new kY.SignalController;mode="NORMAL";constructor(e){super(e),this.setName("Footer"),this.createContinueButton(),this.createReplayButton(),this.createReturnButton(),this.scene.add.existing(this)}createContinueButton(){this.continueButton=new tg(this.scene,{key:qs,frame:Qs.RESULT_SCREEN_YELLOW_BUTTON,width:129,height:46}),this.continueButton.setName("Continue"),this.add(this.continueButton),this.createContinueWinContainer(),this.createContinueLoseContainer()}createContinueWinContainer(){let e=this.scene.make.container({});e.setSize(this.continueButton.width,this.continueButton.height),this.winContainer=e,this.continueButton.add(this.winContainer);let t=Hi.getCurrentLocale(),i=18,s=-14;switch(t){case"ja":i=16,s=-12;break;case"zh":i=16,s=-12;break}this.getText=Z.buildText(Hi.getText("GET").toUpperCase(),i).setDefaultStroke().setDefaultShadow({offsetX:-2,offsetY:2}).build(this.scene),this.getText.setPosition(0,s),e.add(this.getText);let n=this.scene.make.image({key:qs,frame:Qs.RESULT_SCREEN_SINGLE_COIN_ICON});n.setWorldSize(16,16),e.add(n),n.setPosition(-40,7);let r=Z.buildText("0",18).setColor("#eecf00").setDefaultStroke().setDefaultShadow({offsetX:-2,offsetY:2}).build(this.scene);r.setPosition(0,5),e.add(r),this.coinText=r}createContinueLoseContainer(){let e=this.scene.make.container({});e.setSize(this.continueButton.width,this.continueButton.height),this.loseContainer=e,this.continueButton.add(this.loseContainer);let t=Hi.getCurrentLocale(),i=20;switch(t){case"pt":i=18;break;case"de":i=18;break}let s=Z.buildText(Hi.getText("CLAIM").toUpperCase(),i).setDefaultStroke().setDefaultShadow({offsetX:-2,offsetY:2}).build(this.scene);s.setPosition(0,-5),e.add(s)}createReplayButton(){this.replayButton=new Gt(this.scene,qs,Qs.RESULT_SCREEN_GREEN_BUTTON,129,46),this.replayButton.setName("BattleReplay");let e=Z.buildText(Hi.getText("REPLAY").toUpperCase(),15).setDefaultStroke().setDefaultShadow({offsetX:-2,offsetY:2}).build(this.scene);e.setPosition(15,-5),this.replayButton.add(e);let t=this.scene.make.image({key:qs,frame:Qs.ICON_REPLAY});t.setWorldSize(23.5,27.5),t.setPosition(-40,-3),this.replayButton.add(t),this.replayButton.setX(-70),this.add(this.replayButton)}createReturnButton(){this.returnButton=new Gt(this.scene,qs,Qs.RESULT_SCREEN_YELLOW_BUTTON,129,46),this.returnButton.setName("BackToSinglePlay");let e=Z.buildText(Hi.getText("BACK_TO_SINGLEPLAY").toUpperCase(),15).setDefaultStroke().setDefaultShadow({offsetX:-2,offsetY:2}).build(this.scene);e.setPosition(15,-5),this.returnButton.add(e);let t=this.scene.make.image({key:qs,frame:Qs.ICON_BACK_TO});t.setWorldSize(28.5,20.5),t.setPosition(-45,-2),this.returnButton.add(t),this.returnButton.setX(70),this.add(this.returnButton)}set onClickContinueBtn(e){this.continueButton.onClick=e}set onClickReplayBtn(e){this.replayButton.onClick=e}set onClickReturnBtn(e){this.returnButton.onClick=e}setMode(e,t,i){this.continueButton.setY(0),this.continueButton.setScale(1),this.replayButton.setPosition(-70,0),this.replayButton.setScale(1),this.returnButton.setPosition(70,0),this.returnButton.setScale(1),e==="BATTLE"?(this.replayButton.revive(),this.returnButton.revive(),this.continueButton.kill()):(this.replayButton.kill(),this.returnButton.kill(),this.continueButton.revive(),i==="win"?(this.winContainer.revive(),this.loseContainer.kill(),this.coinText.setText(t.toString()),this.getText.setText(Hi.getText("GET"))):(this.winContainer.kill(),this.loseContainer.revive(),this.getText.setText(Hi.getText("CLAIM")))),this.mode=e}setCoinText(e){this.winContainer.revive(),this.loseContainer.kill(),this.coinText.setText(e)}runAnimation(e){if(this.mode!=="BATTLE")return;let t=this.openAnimController.renew();this.returnButton.setAlpha(0),this.replayButton.setAlpha(0),gt.runTween(this.scene.tweens.add({...mr,paused:!0,targets:[this.replayButton,this.returnButton],delay:e,duration:400,props:{alpha:{from:0,to:1}},onComplete:()=>{this.returnButton.setAlpha(1),this.replayButton.setAlpha(1)}}),t)}runPostAnimation(e){if(this.mode==="BATTLE"){this.openAnimController.abort(),this.postAdReplayAnimation?.stop(),this.postAdReplayAnimation?.remove(),this.postAdReturnAnimation?.stop(),this.postAdReturnAnimation?.remove(),this.replayButton.setDisabled(!0),this.replayButton.setAlpha(1);let t=this.replayButton.x;this.postAdReplayAnimation=this.scene.tweens.add({targets:this.replayButton,duration:500,delay:e,y:{from:0,to:-70},x:{from:t,to:t-15},scale:{from:this.replayButton.scale,to:this.replayButton.scale*1.2},ease:xh.Quintic.Out,onComplete:()=>{this.replayButton.setDisabled(!1)}}),this.returnButton.setDisabled(!0),this.returnButton.setAlpha(1);let i=this.returnButton.x;this.postAdReturnAnimation=this.scene.tweens.add({targets:this.returnButton,duration:500,delay:e,y:{from:0,to:-70},x:{from:i,to:i+15},scale:{from:this.returnButton.scale,to:this.returnButton.scale*1.2},ease:xh.Quintic.Out,onComplete:()=>{this.returnButton.setDisabled(!1)}})}else{this.postAdContinueAnimation?.stop(),this.postAdContinueAnimation?.remove(),this.continueButton.setDisabled(!0),this.continueButton.setAlpha(1);let{scale:t}=this.continueButton;this.postAdContinueAnimation=this.scene.tweens.add({targets:this.continueButton,duration:500,delay:e,y:{from:0,to:-70},scale:{from:t,to:t*2},ease:xh.Quintic.Out,onComplete:()=>{this.continueButton.setDisabled(!1)}})}}},NY=BY,UY=U(it()),Wg=U(yt()),FY=U(dt()),{KEY:zg,FRAME:Vg}=W.DEFAULT_8_BIT,GY=class extends UY.Container{wheelArrow;luckSpinMilestones;luckSpinRewards;spinningTween;constructor(e){super(e,0,0),this.createWheelBackground(),this.createWheelArrow(),this.scene.add.existing(this)}createWheelBackground(){let e=this.scene.make.image({key:zg,frame:Vg.WHEEL_LUCKY_SPIN,origin:{x:.5,y:.5}});this.scene.add.existing(e),this.add(e),e.setPosition(0,-35),this.createText("x2",-53,-25),this.createText("x3",-6,-60),this.createText("x4",37,-50),this.createText("x5",55,-15)}createText(e,t,i){let s=Z.buildText(e,22).setDefaultStroke().setDefaultShadow({offsetX:-1,offsetY:1}).build(this.scene);this.add(s),s.setPosition(t,i)}createWheelArrow(){this.wheelArrow=this.scene.make.image({key:zg,frame:Vg.WHEEL_ARROW}),this.wheelArrow.setWorldSize(17,26),this.add(this.wheelArrow),FY.Align.In.Center(this.wheelArrow,this,0,-25),this.luckSpinMilestones=[-30,16,59],this.luckSpinRewards=[2,3,4,5]}startWheelSpinning(){this.spinningTween?.stop(),this.spinningTween?.remove();let e=ot.getScreen(tt.RESULT_SCREEN);e instanceof jg&&(this.spinningTween=this.scene.tweens.addCounter({from:(0,Wg.DegToRad)(-90),to:(0,Wg.DegToRad)(90),onUpdate:t=>{let i=t.getValue();this.wheelArrow.setRotation(i);let s=Math.sin(i)*29,n=Math.cos(i)*-29;this.wheelArrow.setPosition(s,n),e?.updateCoinText(this.getCurrentMultiplierResult())},yoyo:!0,duration:625,repeat:-1}))}stopWheelSpinning(){this.spinningTween?.stop()}getCurrentMultiplierResult(){for(let e=0;e<this.luckSpinMilestones.length;e++){let t=this.luckSpinMilestones[e];if(this.wheelArrow.angle<=t)return this.luckSpinRewards[e]}return this.luckSpinRewards[this.luckSpinRewards.length-1]}handleOnOpen(){this.startWheelSpinning()}handleOnClose(){this.stopWheelSpinning()}},YY=GY,Xg=U(Nt()),Be=U(dt()),wh=U(yt()),Kg=U(ft()),{Plugins:{Ads:{Types:{REWARDED_VIDEO:HY}}},Configs:{Ads:{Enabled:WY}},Utils:{Signal:zY}}=Ludex,{language:li}=codex,{KEY:VY,FRAME:XY}=W.DEFAULT_8_BIT,{KEY:kn,FRAME:_i}=W.DEFAULT_8_BIT,{MULTIPLY_REWARD_BATTLE:KY,MULTIPLY_REWARD_ROUND:jY}=Q,ZY=class extends ye{baseValue;rewardWheel;coinText;coinIcon;claimCoinText;claimText;resultText;levelCompletedText;ribbon;shineFx;collectButton;footerContainer;openAnimController=new zY.SignalController;postAdCollectAnimation;fxSpinAnimation;fxScaleAnimation;coinTextAnimation;confettiAnimation;adsTimer;isRewardCollected;coinExplodeEffect;constructor(e,t){super(e,t),this.scene=e,this.background.setAlpha(.9),this.setDepth(hi.SCREEN),this.createContent(),this.createEffect()}createEffect(){this.coinExplodeEffect=new xG(this.scene),this.coinExplodeEffect.setDepth(hi.SCREEN+1),this.confettiAnimation=new OY(this.scene),this.confettiAnimation.setDepth(hi.SCREEN+1)}open(e){super.open(e);let t=$.isLandscape();this.setScale(t?.83:1),this.background.setScale(t?1.2:1),nt.getGlobalScene()?.requestBackgroundMaskUpdate(tt.RESULT_SCREEN,this.background.alpha);let i=this.getData("coinRewarded");this.baseValue=i,this.updateScreen(),WY?(this.collectButton.revive(),wt.isReadyAdShowable(HY)?(this.collectButton.setDisabled(!1),this.collectButton.setAlpha(1)):(this.collectButton.setDisabled(!0),this.collectButton.setAlpha(.5)),this.rewardWheel.revive(),this.rewardWheel.handleOnOpen()):(this.collectButton.kill(),this.rewardWheel.kill()),this.runOpenAnimation()}closeScreen=()=>{this.stopShineFxTween(),this.rewardWheel.handleOnClose(),this.confettiAnimation.killAllParticles();let e=this.getData("result");if(!this.isRewardCollected){let t=this.scene.scene.get(ct.GAME_SCENE);t instanceof St&&e==="win"&&t.rewardWinCoin(1)}nt.getGlobalScene()?.requestBackgroundMaskUpdate(tt.RESULT_SCREEN,0),ot.closeScreen(this.name),ut.playSound(Et.NEXT_ROUND_EFFECT)};updateScreen(){let e=this.baseValue.toString();this.coinText.setText(`+${e}`),this.isRewardCollected=!1,this.coinIcon.setPosition(this.coinText.displayWidth/2+10,this.coinIcon.y);let t=this.getData("mode"),i=this.getData("result");if(this.footerContainer.setMode(t,this.baseValue,i),i==="lose")this.resultText.setText(li.getText("FAILED")),this.ribbon.setFrame(_i.RESULT_SCREEN_RIBBON_LOSE),this.shineFx.setFrame(_i.RESULT_SCREEN_FX_LOSE),this.levelCompletedText.setText("");else if(i==="win"){this.runConfetti(),this.resultText.setText(li.getText("VICTORY")),this.ribbon.setFrame(_i.RESULT_SCREEN_RIBBON_WIN),this.shineFx.setFrame(_i.RESULT_SCREEN_FX_WIN);let s=jY;if(this.scene instanceof St){let{gameMode:n}=this.scene;n===Tt.BATTLE&&(s=KY)}this.levelCompletedText.setText(`${li.getText("LEVEL_COMPLETED_BONUS_X").toUpperCase()}${s}`)}}runConfetti(){let{width:e,height:t}=$.getWorldSize();this.confettiAnimation.run(0,t/2,0,t*.9)}handleOnCollect=()=>{this.viewAdsReward()};viewAdsReward=async()=>{this.rewardWheel.handleOnClose(),await wt.showRewardVideoAdAsync()&&this.onWheelEnding()};onWheelEnding=()=>{this.runCoinTextAnimation();let e=this.rewardWheel.getCurrentMultiplierResult(),t=this.getData("result"),i=this.scene.scene.get(ct.GAME_SCENE);t==="lose"?i.rewardLostCoin(e):t==="win"&&i.rewardWinCoin(e);let s=this.baseValue.clone();s.multiply(e),this.footerContainer.setCoinText(s.toString()),this.isRewardCollected=!0};createContent(){this.createCollectButton(),this.createFx(),this.createFooter(),this.createLevelCompleteText(),this.createGoldText(),this.createGoldIcon(),this.createEarnText(),this.createRibbon(),this.createRewardWheel()}createCollectButton(){let e=li.getCurrentLocale();this.collectButton=new Gt(this.scene,kn,_i.RESULT_SCREEN_GREEN_BUTTON_RESULT,181,71),this.collectButton.setName("ClaimWithAds"),this.add(this.collectButton);let t=30,i=-18,s=13,n=10;switch(e){case"ru":t=20,i=-15,s=3;break;case"es":t=21;break;case"pt":t=25;break;case"ja":t=25,i=-20,n=8;break;case"zh":t=25,s=25,i=-13;break;case"tr":t=22,s=11;break;case"fr":t=20;break;case"id":t=25;break;case"de":t=18,s=6;break;case"it":t=23,s=8;break}let r=Z.buildText(`${li.getText("GET")} x5`,t).setDefaultStroke().setDefaultShadow({offsetX:-2,offsetY:3}).build(this.scene);this.claimText=r,this.collectButton.add(r),ch.alignChildCenter(r,this.collectButton,s,i);let o=this.scene.make.image({key:VY,frame:XY.ICON_AD});o.setWorldSize(25.5,27),this.collectButton.add(o),Be.Align.In.Center(o,this.collectButton,-60,-5);let a=this.scene.make.image({key:kn,frame:_i.RESULT_SCREEN_SINGLE_COIN_ICON});a.setWorldSize(16,16),this.collectButton.add(a),Be.Align.In.Center(a,this.collectButton,-15,13),this.claimCoinText=Z.buildText("0",17).setColor("#e4c701").setDefaultStroke().setDefaultShadow({offsetX:-2,offsetY:2}).build(this.scene),this.collectButton.add(this.claimCoinText),ch.alignChildCenter(this.claimCoinText,this.collectButton,22,n),Be.Align.In.Center(this.collectButton,this,0,100),this.collectButton.onClick=this.handleOnCollect}createFooter(){this.footerContainer=new NY(this.scene),this.add(this.footerContainer),this.footerContainer.onClickContinueBtn=this.handleClickContinueBtn,this.footerContainer.onClickReplayBtn=this.handleClickReplayBtn,this.footerContainer.onClickReturnBtn=this.handleClickContinueBtn,Be.Align.In.Center(this.footerContainer,this.collectButton,0,130)}handleClickContinueBtn=()=>{let e=this.scene.scene.get(ct.GAME_SCENE),t=this.getData("result"),i=this.getData("mode");e.events.once(Xg.RESUME,()=>{e instanceof St&&(i===Tt.NORMAL&&t==="lose"?e.replayRound():e.nextRound())}),this.closeScreen()};handleClickReplayBtn=()=>{let e=this.scene.scene.get(ct.GAME_SCENE);e.events.once(Xg.RESUME,()=>{e instanceof St&&e.replayRound()}),this.closeScreen()};createLevelCompleteText(){this.levelCompletedText=Z.buildText(`${li.getText("LEVEL_COMPLETED_BONUS_X").toUpperCase()}5`,18).setColor("#eecf00").setDefaultStroke().setDefaultShadow({offsetX:-1,offsetY:1}).build(this.scene),this.add(this.levelCompletedText),Be.Align.In.Center(this.levelCompletedText,this,0,-80),this.levelCompletedText.setScale(this.collectButton.scaleX,this.collectButton.scaleY)}createGoldIcon(){this.coinIcon=this.scene.make.image({key:kn,frame:_i.RESULT_SCREEN_GOLD_ICON}),this.coinIcon.setWorldSize(55,39.5),this.add(this.coinIcon),Be.Align.In.Center(this.coinIcon,this,this.coinText.displayWidth/2,-120)}createGoldText(){this.coinText=Z.buildText("+0",32).setDefaultStroke().setDefaultShadow({offsetX:-2,offsetY:2}).build(this.scene),this.add(this.coinText),Be.Align.In.Center(this.coinText,this,-20,-125)}createEarnText(){let e=Z.buildText(li.getText("YOU_EARNED").toUpperCase(),18).setDefaultStroke().setDefaultShadow({offsetX:-3,offsetY:1}).build(this.scene);this.add(e),Be.Align.In.Center(e,this,0,-180),e.setScale(this.collectButton.scaleX,this.collectButton.scaleY)}createFx(){this.shineFx=this.scene.make.image({key:kn,frame:_i.RESULT_SCREEN_FX_WIN}),this.add(this.shineFx),this.shineFx.setWorldSize(375,407),Be.Align.In.Center(this.shineFx,this,0,-120)}createRibbon(){let e=li.getCurrentLocale(),t=-7;switch(e){case"ja":t=-10;break}this.ribbon=this.scene.make.image({key:kn,frame:_i.RESULT_SCREEN_RIBBON_WIN}),this.add(this.ribbon),this.ribbon.setWorldSize(280,50),Be.Align.In.Center(this.ribbon,this,2,-240),this.resultText=Z.buildText(li.getText("VICTORY").toUpperCase(),24).setDefaultStroke().setDefaultShadow({offsetX:-3,offsetY:2}).build(this.scene),this.add(this.resultText),Be.Align.In.Center(this.resultText,this.ribbon,3,t)}createRewardWheel(){this.rewardWheel=new YY(this.scene),this.add(this.rewardWheel),Be.Align.In.Center(this.rewardWheel,this,0,40)}runOpenAnimation(){let e=this.openAnimController.renew();this.collectButton.setAlpha(1);let t=this.list.filter(s=>s!==this.background&&s!==this.footerContainer),i=t.map(s=>s.alpha);t.forEach(s=>s.setAlpha(0)),gt.runTween(this.scene.tweens.add({...mr,paused:!0,targets:t,duration:400,props:{alpha:{getStart:()=>0,getEnd:(s,n,r,o)=>i[o]}},onComplete:()=>{this.runShineFxTween()}}),e),this.footerContainer.runAnimation(2500)}runShineFxTween(){let e=this.getData("result");this.fxSpinAnimation=this.scene.tweens.add({targets:this.shineFx,duration:e==="win"?2e4:4e4,ease:"Linear",repeat:-1,props:{rotation:{from:(0,wh.DegToRad)(0),to:(0,wh.DegToRad)(360)}},onStop:()=>{this.shineFx.rotation=(0,wh.DegToRad)(0)}});let t=this.shineFx.scaleX,i=this.shineFx.scaleY;this.fxScaleAnimation=this.scene.tweens.add({targets:this.shineFx,duration:2e3,ease:Kg.Quadratic.Out,repeat:-1,yoyo:!0,props:{scaleX:{from:t,to:t*1.2},scaleY:{from:i,to:i*1.2}},onStop:()=>{this.shineFx.setScale(t,i)}})}stopShineFxTween(){this.fxSpinAnimation?.stop(),this.fxSpinAnimation?.remove(),this.fxScaleAnimation?.stop(),this.fxScaleAnimation?.remove()}runPostAdAnimation(){this.postAdCollectAnimation?.stop(),this.postAdCollectAnimation?.remove(),this.postAdCollectAnimation=this.scene.tweens.add({targets:this.collectButton,duration:500,alpha:{from:.5,to:0},ease:Kg.Quadratic.In}),this.footerContainer.runPostAnimation(500)}runCoinTextAnimation(){this.coinTextAnimation?.stop(),this.coinTextAnimation?.remove();let e=this.rewardWheel.getCurrentMultiplierResult(),t=this.baseValue.clone(),i=this.baseValue.clone();i.multiply(e);let s=i.clone();s.subtract(t),s.divide(10);let n=this.coinText.scaleX,r=this.coinText.scaleY;this.coinExplodeEffect.explode(12,this.coinIcon.x,this.coinIcon.y),this.coinTextAnimation=this.scene.tweens.addCounter({from:1,to:10,duration:150,onRepeat:()=>{t.add(s),this.coinText.setText(`+${t.toString()}`),this.coinIcon.setPosition(this.coinText.displayWidth/2+10,this.coinIcon.y)},onStart:()=>{ut.playSound(Et.COIN_INCREASE_REPEATEDLY_SOUND),this.coinText.setScale(n*1.1,r*1.1),this.coinIcon.setPosition(this.coinText.displayWidth/2+10,this.coinIcon.y),t.add(s),this.coinText.setText(`+${t.toString()}`),this.coinIcon.setPosition(this.coinText.displayWidth/2+10,this.coinIcon.y)},onComplete:()=>{this.coinText.setScale(n,r),this.coinIcon.setPosition(this.coinText.displayWidth/2+10,this.coinIcon.y)},onStop:()=>{this.coinText.setScale(n,r),this.coinIcon.setPosition(this.coinText.displayWidth/2+10,this.coinIcon.y)},repeat:9})}updateCoinText(e){let t=this.baseValue.clone();t.multiply(e),this.claimCoinText.setText(`${t.toString()}`),this.claimText.setText(`${li.getText("GET").toUpperCase()} x${e}`)}},jg=ZY,qY={[tt.NOTIFY_SCREEN]:WN,[tt.LOADING_SCREEN]:ON,[tt.RESULT_SCREEN]:jg,[tt.UNIT_REWARD_SCREEN]:fF,[tt.UNIT_UNLOCK_SCREEN]:MF,[tt.LEADER_BOARD_SCREEN]:r2,[tt.OFFLINE_REWARD_SCREEN]:bU,[tt.RESET_DATA_SCREEN]:T2,[tt.START_OVER_POPUP]:C2,[tt.BOSS_CHALLENGE_SCREEN]:O2,[tt.UNITS_SCREEN]:Ah,[tt.SETTINGS_SCREEN]:wg},QY=qY,JY=U(dt()),$Y=U(it()),{Events:Js,Utils:{Valid:Zg,Object:t5}}=Ludex,{event:ps,monitorError:qg}=codex,e5=class{screens={};screenOpenStack=[];init(){this.bindEventHandlers()}bindEventHandlers(){ps.on(Js.OPEN_SCREEN,this.handleOpenScreen),ps.on(Js.CLOSE_SCREEN,this.handleCloseScreen),ps.on(Qt.DESTROY_SCREENS,this.destroyAllScreens)}handleOpenScreen=e=>{this.openScreen(e.screenName,e.screenData),this.screenOpenStack.push(e.screenName),nt.pauseGameScene()};handleCloseScreen=e=>{this.closeScreen(e.screenName,!0),this.screenOpenStack=this.screenOpenStack.filter(t=>t!==e.screenName),!(this.screenOpenStack.length>0)&&nt.resumeGameScene()};createScreen(e){let t=nt.getGlobalScene();if(!t)throw new Error(`Create Screen: Invalid scene ${e}`);let{scenes:i}=this.screens[e],s=i[t.scene.key];if(s){this.setupScreen(t,s);return}let n=this.getScreenInstance(e);if(!n)throw new Error(`Create Screen: Invalid screen ${e}`);let r=new n(t,e);this.setupScreen(t,r)}setupScreen(e,t){let i=t.name;this.screens[i].scenes[e.scene.key]=t,ot.addScreen(i,t),e.add.existing(t),t5.hasOwn(e,"gameZone")&&Zg.isObject(e.gameZone)&&e.gameZone instanceof $Y.Zone&&JY.Align.In.Center(t,e.gameZone)}getScreenInstance(e){return QY[e]||null}prepareScreen(e){this.addScreen(e),this.createScreen(e)}addScreen(e){if(this.screens[e])return;let t=Object.keys(this.screens).length;this.screens[e]={name:e,order:t,scenes:{}}}getScreen(e){this.prepareScreen(e);let t=nt.getGlobalScene();if(!t)throw new Error(`ScreenManager: Invalid scene ${e}`);let{scenes:i}=this.screens[e],s=i[t.scene.key];if(!s)throw new Error(`ScreenManager: Screen ${e} not ready`);return s}validateScreen(e){if(!Zg.isString(e))throw new Error(`ScreenManager: Invalid screen name ${e}`)}async openScreen(e,t){this.validateScreen(e),await new Promise(s=>requestAnimationFrame(s));let i=this.getScreen(e);i.active||this.showScreen(i,e,t)}async showScreen(e,t,i){let s={screenName:t,screenData:i};ps.emit(Js.OPENING_SCREEN,s),e.open(i),this.updateAnalytics(t),ps.emit(Js.OPENED_SCREEN,s)}async closeScreen(e,t=!1){this.validateScreen(e),await new Promise(s=>requestAnimationFrame(s));let i=this.getScreen(e);i.active&&(ps.emit(Js.CLOSING_SCREEN,{screenName:e}),i.close(),t&&this.updateAnalytics(e,!1),ps.emit(Js.CLOSED_SCREEN,{screenName:e}))}updateAnalytics(e,t=!0){xt.trackCurrentPage(e,t),t?qg?.addMetadata({currentScreen:e}):qg?.removeMetadata("currentScreen")}closeAllScreens(){for(let e in this.screens)this.closeScreen(e,!1)}destroyAllScreens=e=>{let{sceneKey:t}=e;if(t)for(let i in this.screens){let s=this.screens[i];if(!s)continue;let n=s.scenes[t];n&&(n.destroy(),delete s.scenes[t])}}},i5=e5,{storage:s5}=codex,n5=class{init(){}setupDefaultData(){this.setupTournamentData()}setupTournamentData(){s5.addStorage("Tournament",{showResult:!1,previousScore:void 0})}},r5=n5,{Utils:{Device:a5}}=Ludex;function o5(e,t){let i=!1,s={};for(let n of e)for(let r of t)if(r.includes(n)){s[n]=!0,i=!0;break}return{loaded:s,hasLoaded:i}}var h5=class{ready;constructor(){let e=Ps.instance.getPlayerLocale(),t=Z.getGoogleFontFamilies(e);if(t.length===0||this.isAllFontLoaded(t)){this.ready=Promise.resolve();return}if(a5.isIOS()){this.handleIOSFontLoadingCase();return}this.ready=new Promise(i=>{let s=n=>{let{loaded:r,hasLoaded:o}=o5(t,n.fontfaces.map(a=>a.family));o&&(t=t.filter(a=>!r[a]),t.length===0&&(document.fonts.removeEventListener("loadingdone",s),i()))};document.fonts.addEventListener("loadingdone",s)})}init(){}isAllFontLoaded(e){let t=[];for(let i of document.fonts)t.push(i.family);for(let i of e){let s=i.replace(/['"]/g,"");if(!t.includes(s))return!1}return!0}handleIOSFontLoadingCase(){this.ready=new Promise(e=>{let t=setInterval(()=>{let i=Ps.instance.getPlayerLocale(),s=Z.getGoogleFontFamilies(i);this.isAllFontLoaded(s)&&(clearInterval(t),e())},100)})}},l5=h5,{Events:Bn,Plugins:{Analytics:{Events:Jr}},Utils:{Function:Qg,Valid:u5}}=Ludex,{context:c5,event:Nn,analytics:$r,monitorError:Rh}=codex,d5=class{m=new zB;ct=new HB;U=new vN;G=new qB;dt=new i5;P=new $B;Y=new r5;T=new pN;H=new l5;constructor(){window.isCustomRequestAnimationFrame=!1,this.gt(),this.M()}gt(){this.m.init(),this.ct.init(),this.U.init(),this.dt.init(),this.G.init(),this.P.init(),this.Y.init(),this.T.init(),this.H.init()}M(){this.m.onCoreBoot(this.ft),this.m.onCoreStart(this.mt),this.m.onCoreReady(this.vt),this.U.onSwitchScene(this.handleSwitchScene)}ft=()=>{this.m.requestStart()};mt=()=>{this.P.setupDefaultGameData()};vt=async()=>{await this.P.syncPlayerData(),this.G.setupDefaultMatchData(),this.Y.setupDefaultData(),this.Et(),Nn.catchUp(Bn.BUNDLE_READY,this.yt)};yt=()=>{$r.event(Jr.ENGINE_READY),Nn.catchUp(Bn.SCENE_LAUNCHED,this.Tt),this.St()};Tt=async()=>{$r.event(Jr.LOAD_START),await Nn.waitTo(Bn.SCENE_LAUNCHED,15e3),await this.H.ready,window.phaser.isRunning||await this.At(),this.xt()};async At(){return new Promise(e=>{window.phaser.events.once(b1.RESUME,e)})}St(){window.phaser.scene.start(ct.BOOT_SCENE)}async xt(){$r.event(Jr.LOAD_COMPLETE),await this.W(),Nn.catchUp(Bn.PLAYER_INFO_LOADED,this.wt),"subscribeBotAsync"in GameSDK.extra&&setTimeout(()=>{GameSDK.extra.subscribeBotAsync().catch(e=>{})},1e3)}handleSwitchScene=()=>{};async W(e=0){let t=GameSDK.startGameAsync(),[i,s]=await Qg.handleAsync(t);try{let{width:n,height:r}=$.getCanvasSize();Rh?.addMetadata({sceneSize:`${n}x${r}`})}catch{}if(s){if(e<=3){setTimeout(()=>{this.W(e+1)},1e3);return}Rh?.sendException(s)}}wt=async()=>{$r.event(Jr.APP_READY),this.P.requestConnectedPlayers();let e=c5.processContextData(),[t,i]=await Qg.handleAsync(e);i&&Rh?.sendException(i),Nn.emit(Bn.GAME_READY)};Et(){this.T.initMissions(),this.T.initLeaderboards(),this.T.initFrameCapture(),this.T.initAdaptivePerformance()}};new d5,u5.isDebugger()&&new EventSource("/esbuild").addEventListener("change",()=>location.reload());var p5=U(dt()),g5=U(it()),Rt=U(it()),f5=U(Cs()),{DesignSize:{Resolution:m5}}=gr,v5=class{addKillRevive(){[Rt.Container,Rt.Image,Rt.Sprite,Rt.Graphics,Rt.Text,Rt.Zone,Rt.Particles.ParticleEmitter,Rt.NineSlice,g5.Rectangle].forEach(e=>{e.prototype.kill=this.kill,e.prototype.revive=this.revive})}addKillReviveGroup(){Rt.Group.prototype.killGroup=this.killGroup,Rt.Group.prototype.reviveGroup=this.reviveGroup}addSetFrame(){[Rt.Image,Rt.Sprite].forEach(e=>{e.prototype.oriSetFrame=e.prototype.setFrame,e.prototype.setFrame=this.setFrame})}addSetWorldSize(){[Rt.Image,Rt.Sprite,Rt.Zone].forEach(e=>{e.prototype.setWorldSize=this.setWorldSize})}addSetWorldSizeForNineSlice(){[Rt.NineSlice].forEach(e=>{e.prototype.setWorldSize=this.setWorldSizeForNineSlice})}addSetWorldSizeForContainer(){[Rt.Container].forEach(e=>{e.prototype.setWorldSize=this.setWorldSizeForContainer})}addGetWorldPosition(){[Rt.Container,Rt.Image,Rt.Sprite,Rt.Graphics,Rt.Text,Rt.Zone].forEach(e=>{e.prototype.getWorldPosition=this.getWorldPosition})}addDrawDebugBox(){[Rt.Container,Rt.Image,Rt.Sprite,Rt.Graphics,Rt.Text,Rt.Zone].forEach(e=>{e.prototype.drawDebugBox=this.drawDebugBox})}addHighQuality(){[Rt.Text].forEach(e=>{e.prototype.setHighQuality=this.setHighQuality})}kill(){this.setActive(!1),this.setVisible(!1)}revive(){this.setActive(!0),this.setVisible(!0)}killGroup(){let e=this.getChildren();for(let t of e)t.setActive(!1),t.setVisible(!1)}reviveGroup(){let e=this.getChildren();for(let t of e)t.setActive(!0),t.setVisible(!0)}setFrame(e,t=!0,i=!0){return this.oriSetFrame(e,t,i),this.__width=this.width,this.__height=this.height,this}setWorldSize(e,t){typeof this.__width!="number"&&(this.__width=this.width),typeof this.__height!="number"&&(this.__height=this.height);let i=$.getPixelRatio(),s=e||this.__width/i,n=t||this.__height/i;this.setSize(s,n),this.setDisplaySize(s,n)}setWorldSizeForContainer(e,t){typeof e!="number"||typeof t!="number"||(this.setSize(e,t),this.setDisplaySize(e,t))}setWorldSizeForNineSlice(e,t){this.__width||(this.__width=this.frame.width),this.__height||(this.__height=this.frame.height);let i=$.getPixelRatio(),s=e||this.__width/i,n=t||this.__height/i;this.leftWidth=this.leftWidth/i,this.rightWidth=this.rightWidth/i,this.topHeight=this.topHeight/i,this.bottomHeight=this.bottomHeight/i,this.setSize(s,n),this.setDisplaySize(s,n)}getWorldPosition(){let e=this.getWorldTransformMatrix(),{translateX:t,translateY:i}=e.decomposeMatrix();return{x:t,y:i}}drawDebugBox(e=65280,t=.2){let{width:i,height:s,depth:n,originX:r,originY:o}=this;if(!i||!s)throw new Error("Width and height are required in drawDebugBox");let a=this.scene.add.rectangle(0,0,i,s,e,t);return a.setName("Debug Box"),a.setDepth(n+1),this instanceof Rt.Container&&this.add(a),this.parentContainer&&this.parentContainer.add(a),a.setOrigin(r,o),p5.Align.In.Center(a,this),a}setHighQuality(){return this.renderer instanceof f5.WebGL.WebGLRenderer?this.setResolution(m5):this}},E5=v5,y5=U(E1()),{event:T5}=codex,{Events:S5}=Ludex,A5=class extends mn{create(){super.create();try{T5.catchUp(S5.GAME_SDK_STARTED,this.processWhenGameSdkStarted),nt.switchScene(ct.LOAD_SCENE),this.scene.launch(ct.GLOBAL_SCENE)}catch{}}processWhenGameSdkStarted=()=>{this.setupGameData()};setupGameData(){_t.inst.loadCoin()}},x5=A5,{MELEE_UNIT_TYPE:Ch,RANGED_UNIT_TYPE:_h,ALIEN_UNIT_TYPE:Jg}=Q,{UNITS_SPINES:w5}=W,{MaximumMeleeLevel:R5,MaximumRangedLevel:C5}=Ut,{player:$g}=codex,_5=class extends mn{requestingSpines=[];requestingSprites=[];isLazyLoadRequesting;preload(){let e=this.getLevelJsonName();this.load.on(`filecomplete-json-${e}`,()=>{this.scene.wake(),this.loadEnemyUnits(e)}),this.load.json(e,`assets/json/${e}.json`),this.loadDefaultUnits(),this.loadPlayerUnits(),this.load.json("unitData","assets/json/unit-data.json"),this.load.json("bossData","assets/json/boss-data.json"),Ps.instance.loadPlayerLanguage(this),this.load.multiatlas({key:W.DEFAULT_8_BIT.KEY,atlasURL:W.DEFAULT_8_BIT.JSON,path:W.DEFAULT_8_BIT.PATH}),this.load.atlas({key:W.DEFAULT.KEY,atlasURL:W.DEFAULT.JSON,textureURL:W.DEFAULT.TEXTURE}),this.load.atlas({key:W.GAMEPLAY.KEY,atlasURL:W.GAMEPLAY.JSON,textureURL:W.GAMEPLAY.TEXTURE}),this.loadBackgroundByCurrentLevel(),this.load.multiatlas({key:W.EFFECTS.KEY,path:W.EFFECTS.PATH,atlasURL:W.EFFECTS.JSON}),this.load.spine(W.SPINE_EFFECTS.FX_MERGE.KEY,W.SPINE_EFFECTS.FX_MERGE.jsonPATH,W.SPINE_EFFECTS.FX_MERGE.atlasPATH)}create(){super.create(),this.Rt()}Rt(){let e=nt.getGlobalScene();!e||!(e instanceof ao)||e.setup()}loadBackgroundByCurrentLevel(){let e=At.getLevelProgress();if(typeof e!="number"||e<0){this.loadAllBackgrounds();return}let t=Math.floor((e+1)/10)%5;$.isUsingLandscapeBackground()?(this.loadBackgroundImage(j.BG_LANDSCAPE_TREE.FILE,j.BG_LANDSCAPE_TREE.KEY),t===1?this.loadBackgroundImage(j.BG_LANDSCAPE_DESERT.FILE,j.BG_LANDSCAPE_DESERT.KEY):t===2?this.loadBackgroundImage(j.BG_LANDSCAPE_ICE.FILE,j.BG_LANDSCAPE_ICE.KEY):t===3?this.loadBackgroundImage(j.BG_LANDSCAPE_CRYSTAL.FILE,j.BG_LANDSCAPE_CRYSTAL.KEY):t===4&&this.loadBackgroundImage(j.BG_LANDSCAPE_VOLCANO.FILE,j.BG_LANDSCAPE_VOLCANO.KEY)):(this.load.image(j.BG_TREE.KEY,j.BG_TREE.FILE),t===1?this.load.image(j.BG_DESERT.KEY,j.BG_DESERT.FILE):t===2?this.load.image(j.BG_ICE.KEY,j.BG_ICE.FILE):t===3?this.load.image(j.BG_CRYSTAL.KEY,j.BG_CRYSTAL.FILE):t===4&&this.load.image(j.BG_VOLCANO.KEY,j.BG_VOLCANO.FILE))}getLevelJsonName(){let e=$g.getGameData()?.level??0,t=Math.floor((e||0)/100)*100+1,i=t+99,s=(1e4+t).toString().substring(1),n=(1e4+i).toString().substring(1);return`levels-${s}-${n}`}loadDefaultUnits(){let e=At.getBuyingUnitLevel(),t=At.getPlayerUnlockedMeleeLevel(),i=At.getPlayerUnlockedRangedLevel(),s=Math.min(t+3,R5),n=Math.min(i+3,C5);for(let r=e;r<=s;r++)this.loadUnit("spine",r,Ch);for(let r=e;r<=n;r++)this.loadUnit("spine",r,_h)}loadPlayerUnits(){let e=At.getPlayerUnitData();if(!e||typeof e!="string"){this.loadAllUnits();return}let t=At.upgradePlayerUnits(e);$g.setGameData({playerUnitData:t}),this.loadUnits("spine",t)}loadEnemyUnits(e){let t=At.getLevelProgress(),i=typeof t=="number"?t:0,s=Math.floor(i/100)*100+1,n=i-s+1,r=this.cache.json.get(e).levels[n],o=`${r.enemy_row1}/${r.enemy_row2}/${r.enemy_row3}`;this.loadUnits("spine",o)}loadUnits(e,t){let i=t.split("/"),s=[];for(let n of i){let r=n.split("-");for(let o of r){if(o==="0"||s.includes(o))continue;let a=Jg;if(o[0]==="m"?a=Ch:o[0]==="r"&&(a=_h),a===Jg)continue;let h=parseInt(o.substring(1));s.push(o),this.loadUnit(e,h,a)}}}loadUnit(e,t,i){let{MELEE:s,RANGED:n}=w5,r=null;switch(i){case Ch:t>0&&t<=Object.keys(s).length&&(r=s[t]);break;case _h:t>0&&t<=Object.keys(n).length&&(r=n[t]);break}if(r){if(e==="spine"){if(this.requestingSpines.includes(r.KEY))return;this.requestingSpines.push(r.KEY),this.load.spine(r.KEY,r.jsonPATH,r.atlasPATH),this.isLazyLoadRequesting=!0}if(e==="sprite"){if(this.textures.exists(r.KEY)||this.requestingSprites.includes(r.KEY))return;this.requestingSprites.push(r.KEY),this.load.multiatlas({key:r.KEY,atlasURL:r.JSON,path:r.PATH}),this.isLazyLoadRequesting=!0}}}loadAllUnits(){this.loadUnits("spine","m1-m2-m3-m4-m5/m6-m7-m8-m9-m10/m11-r1-r2-r3-r4-r5"),this.loadUnits("spine","r6-r7-r8-r9-r10/r11-0-0-0-0/0-0-0-0-0")}loadAllBackgrounds(){let e=$.isUsingLandscapeBackground(),t=(s,n)=>{this.textures.exists(s)||this.loadBackgroundImage(n,s)},i=(s,n)=>{this.textures.exists(s)||this.load.image(s,n)};if(e){t(j.BG_LANDSCAPE_TREE.KEY,j.BG_LANDSCAPE_TREE.FILE),t(j.BG_LANDSCAPE_DESERT.KEY,j.BG_LANDSCAPE_DESERT.FILE),t(j.BG_LANDSCAPE_ICE.KEY,j.BG_LANDSCAPE_ICE.FILE),t(j.BG_LANDSCAPE_VOLCANO.KEY,j.BG_LANDSCAPE_VOLCANO.FILE),t(j.BG_LANDSCAPE_CRYSTAL.KEY,j.BG_LANDSCAPE_CRYSTAL.FILE);return}i(j.BG_TREE.KEY,j.BG_TREE.FILE),i(j.BG_DESERT.KEY,j.BG_DESERT.FILE),i(j.BG_ICE.KEY,j.BG_ICE.FILE),i(j.BG_VOLCANO.KEY,j.BG_VOLCANO.FILE),i(j.BG_CRYSTAL.KEY,j.BG_CRYSTAL.FILE)}async loadBackgroundImage(e,t){return new Promise((i,s)=>{let n=new Image;n.crossOrigin="use-credentials",n.onload=()=>{this.load.image(t,e),i()},n.onerror=()=>{s()},n.src=e})}},b5=_5,P5=class extends y5.default{async boot(){super.boot(),this.addExtraGameObjectMethods(),this.addPlugins(),this.addScenes(),this.initWorld()}addExtraGameObjectMethods(){let e=new E5;e.addKillRevive(),e.addKillReviveGroup(),e.addDrawDebugBox(),e.addSetFrame(),e.addSetWorldSize(),e.addSetWorldSizeForContainer(),e.addGetWorldPosition(),e.addHighQuality(),e.addSetWorldSizeForNineSlice()}addPlugins(){this.plugins.installScenePlugin("SpinePlugin",SpinePlugin,"spine")}addScenes(){this.scene.add(ct.BOOT_SCENE,x5,!1),this.scene.add(ct.LOAD_SCENE,b5,!1),this.scene.add(ct.GAME_SCENE,Zo,!1),this.scene.add(ct.GLOBAL_SCENE,ao,!1)}initWorld(){$.init(this)}},L5=P5,I5=U(Ke()),M5=!("AudioContext"in window)&&!("webkitAudioContext"in window),O5={parent:"GameDiv",type:I5.WEBGL,autoMobilePipeline:!0,scale:{autoRound:!0},dom:{createContainer:!1},fps:{target:60,smoothStep:!0},loader:{maxParallelDownloads:6,crossOrigin:"no-cros"},input:{gamepad:!1,touch:{capture:!0},smoothFactor:1,activePointers:1,windowEvents:!1},audio:{noAudio:M5},disablePreFX:!0,disablePostFX:!0,disableContextMenu:!0,render:{pixelArt:!1,antialias:!0,antialiasGL:!1,transparent:!1,desynchronized:!0,clearBeforeRender:!1,roundPixels:!1,defaultPipeline:"MultiPipeline",autoMobilePipeline:!1},plugins:{global:[]}},D5=O5,{event:k5}=codex,{Events:B5}=Ludex,N5=()=>{try{window.phaser=new L5(D5),window.phaser.device.os.iOS=!1,k5.emit(B5.BUNDLE_READY)}catch{}};N5()})();
