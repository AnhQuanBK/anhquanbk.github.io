"use strict";var Im=Object.create,St=Object.defineProperty,Lm=Object.defineProperties,Xo=Object.getOwnPropertyDescriptor,Cm=Object.getOwnPropertyDescriptors,Em=Object.getOwnPropertyNames,Yt=Object.getOwnPropertySymbols,Mm=Object.getPrototypeOf,xa=Object.prototype.hasOwnProperty,Zo=Object.prototype.propertyIsEnumerable,Ze=Math.pow,Jo=(e,t,r)=>t in e?St(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,S=(e,t)=>{for(var r in t||={})xa.call(t,r)&&Jo(e,r,t[r]);if(Yt)for(var r of Yt(t))Zo.call(t,r)&&Jo(e,r,t[r]);return e},R=(e,t)=>Lm(e,Cm(t)),wa=(e,t)=>{var r={};for(var n in e)xa.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&Yt)for(var n of Yt(e))t.indexOf(n)<0&&Zo.call(e,n)&&(r[n]=e[n]);return r},F=(e,t)=>()=>(e&&(t=e(e=0)),t),Tm=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),It=(e,t)=>{for(var r in t)St(e,r,{get:t[r],enumerable:!0})},Om=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let y of Em(t))!xa.call(e,y)&&y!==r&&St(e,y,{get:()=>t[y],enumerable:!(n=Xo(t,y))||n.enumerable});return e},_m=(e,t,r)=>(r=e!=null?Im(Mm(e)):{},Om(t||!e||!e.__esModule?St(r,"default",{value:e,enumerable:!0}):r,e)),se=(e,t,r,n)=>{for(var y=n>1?void 0:n?Xo(t,r):t,f=e.length-1,w;f>=0;f--)(w=e[f])&&(y=(n?w(t,r,y):w(y))||y);return n&&y&&St(t,r,y),y},P,s=F(()=>{P={AppId:"dinosaurs-merge-master",AppDescription:"",ApiHost:"https://fbig-singleplay-apps.citigo.site",OtherHost:"https://fbig-leaderboards.citigo.site",Ads:{Enabled:!1,PreloadAds:!0,NotifyPlayerBeforeShow:!1,ShowAdOnLoad:{Enabled:!1,DelaySeconds:0,PlacementId:"interstitial_demo"},DegradationTracking:{ResetTimeMinutes:5,MaxFailedAttempts:8},AdServiceConfigs:{AdSense:{Enabled:!1,UsePreload:!1,DataAdClient:"ca-pub-1234567890",DataAdChannel:"1234567890",DataAdBreakTest:!1,DataAdFrequencyHint:30},Savana:{Enabled:!1,UsePreload:!1,DataAdClient:"ca-pub-1234567890",DataAdChannel:"1234567890",DataAdBreakTest:!1,DataAdFrequencyHint:45,BannerAdSlotId:"1234567890"},AppLovin:{Enabled:!1,UsePreload:!1}},InterstitialAdOptions:[{AdService:"platform",PlacementId:"interstitial_demo",SecondsFirstTime:30,SecondsBetweenAds:45},{AdService:"adsense",PlacementId:"interstitial_adsense",SecondsFirstTime:30,SecondsBetweenAds:45}],RewardedVideoAdOptions:[{AdService:"platform",PlacementId:"rewarded_video_demo",SecondsFirstTime:0,SecondsBetweenAds:0},{AdService:"adsense",PlacementId:"rewarded_video_adsense",SecondsFirstTime:0,SecondsBetweenAds:0}],RewardedInterstitialAdOptions:[{AdService:"platform",PlacementId:"rewarded_interstitial_demo",SecondsFirstTime:0,SecondsBetweenAds:0},{AdService:"adsense",PlacementId:"rewarded_interstitial_adsense",SecondsFirstTime:0,SecondsBetweenAds:0}],BannerDisplayAdOptions:[{AdService:"platform",PlacementId:"banner_demo",Position:"bottom",BannerHeight:50,SecondsReload:60,Platform:"ALL"}]},Languages:{DetectPlayerLocale:!0},GameSDKOptions:{AllowWithoutSDK:!0,UseNameGenerator:!0,MSGames:{LoginOnStart:!1,MaxLoginAttemptsPerDay:1},Yandex:{LoginOnStart:!1,MaxLoginAttemptsPerDay:1},TranssionH5:{GaId:"G-XXXXXXXXXX"}},Core:{InitAsync:!1,AverageLoadTime:3,StartSDKAfterLoadGame:!0,FastCheckTournamentContext:!0},GameEngine:{ForceDesktopDPR:2,AutoResizeCanvas:!0,PreferredFPS:{Mobile:60,Desktop:60},DynamicAtlas:{IOS:{Enabled:!0,AutoAtlasSize:!1,MaxAtlasCount:2,MaxAtlasSize:4096,MaxFrameSize:2048},Android:{Enabled:!0,AutoAtlasSize:!1,MaxAtlasCount:2,MaxAtlasSize:4096,MaxFrameSize:2048},Desktop:{Enabled:!0,AutoAtlasSize:!1,MaxAtlasCount:2,MaxAtlasSize:4096,MaxFrameSize:2048},UsePowerOfTwo:!1,TextureBleeding:!0,AllowNonePackable:!1,TextureAtlasOptimize:!0,OnlyOptimizeWhenRenderTooLong:!0},DynamicAssets:{Enabled:!0,Debug:!1,Resolution:{Adjust:2,Original:2},Compression:{PNG:{colors:256,quality:50,dither:.6,palette:!0,compressionLevel:8},JPEG:{quality:50,mozjpeg:!0},WEBP:{quality:35,lossless:!1,alphaQuality:40,smartSubsample:!0,preset:"drawing"}},IgnoreFiles:[]},HybridFileCache:{Enabled:!0,BuildMode:{Enabled:!0,InvalidateMode:"version",SupportedExtensions:[".json",".cconb"]},PreviewMode:{Enabled:!1,CacheScene:!1,CachePrefab:!1,CacheUuidExtension:!1,InvalidateMode:"commitId",SupportedExtensions:[".json",".cconb"]}}},Gameplay:{StartAdAtLevel:1,MaxRescueCount:1,Tutorial:{Enabled:!0,ForceUseTutorial:!1}},Firebase:{Enabled:!1,Options:{AppId:"",ApiKey:"",ProjectId:"",AuthDomain:"",StorageBucket:"",MeasurementId:"",MessagingSenderId:""},Services:{Analytics:{Enabled:!1},Performance:{Enabled:!1},RemoteConfig:{Enabled:!1}}},Analytics:{GoogleAnalytics:{Enabled:!0,ConsoleLog:!1},ClarityAnalytics:{Enabled:!1,ConsoleLog:!1,ScreenshotCanvas:{Interval:1500,ByEvent:["APP_READY","PAGE_VIEW","BUTTON_CLICK","AD_SHOWING","LEVEL_START","LEVEL_END"]}},FirebaseAnalytics:{Enabled:!1,ConsoleLog:!1},FacebookAnalytics:{Prefix:"fba",Enabled:!1,ConsoleLog:!1}},PerformanceMonitor:{CoreFlows:!0,EngineFlows:!0,FpsTracking:{Enabled:!0,TrackingDuration:60,TrackingInterval:10},LoadResources:!0},RemoteConfig:{Enabled:!1,Options:{ForceReloadGame:!1,FetchIntervalInSeconds:300},ServiceType:"mockup",DefaultConfigId:"default",SupportedDataTypes:["Ludex","Gameplay"],MockupConfig:{Enabled:!0},SelfHostedConfig:{Enabled:!1,AppId:"",ApiKey:"",ApiUrl:""}},Network:{MaximumRequest:6,Timeout:15e3,Retries:3},Leaderboards:{LeaderboardList:[]},Notification:{Enabled:!1,ApiUrl:"https://notifications.sunstudio.io"},DailyRewards:{MaxDays:7,MockTime:0,CheckInterrupt:!1},Mockup:{Ads:{Enabled:!1,ErrorRate:5,GiphyApiKey:"VmjHIRsfrwCAssDS4mDo9DoImxJm1lLM",SafeAreaBottom:0},Match:{Enabled:!1,ErrorRate:5,PlayerInfo:{Id:"player-mock",Name:"Player Mock",Photo:"",Signature:""},OpponentInfo:{Id:"opponent-mock",Name:"Opponent Mock",Photo:"",Signature:""}},GameSDK:{SlowAPI:{Enabled:!1,ErrorRate:5,StartDelay:1e3,InitialDelay:1e3,PlayerDataDelay:1e3},Context:{Enabled:!1},Player:{SubscribeBot:{Enabled:!1,CanSubscribeBot:!0},ConnectedPlayers:{Enabled:!1,ErrorRate:5,RandomDelayMs:1e3,NumOfPlayers:3}},AddShortcut:{Enabled:!1},Tournament:{Enabled:!1,ErrorRates:5,RandomDelayMs:1e3,NumOfTournament:{Normal:10,HostPage:2}},Payments:{Enabled:!1,ErrorRates:5,RandomDelayMs:1e3,Products:[]}},Profile:{Enabled:!1,ErrorRate:5,RandomDelayMs:1e3,AvatarUrl:"https://picsum.photos/seed/%1/300/300",RandomNameApiKey:"a1f7164dc9d2468b953aef67b0a19355"},Leaderboards:{Enabled:!0,MinScore:10,MaxScore:100,ErrorRate:5,NumOfLeaders:{Min:10,Max:50},DefaultLimit:60,RandomDelayMs:1e3},LoadingScreen:{Enabled:!1}},Debugger:{Console:{Enabled:!1},Profiler:{Enabled:!1},EventLogging:{Enabled:!1},CanvasRecorder:{Enabled:!1,OnlyCore:!1,PanelExpanded:!1,Options:{Type:"png",Quality:.85,RecordFps:60,SyncFps:!0}},MonitorError:{Enabled:!1,ApiKey:"",Service:"BugSnag",TrackUser:!1,TrackPerformance:!1,FilterErrors:{Codes:{Accepted:[],Ignored:["USER_INPUT","NETWORK_FAILURE"]},Messages:{Accepted:[],Ignored:["Load image failed"]}},Feedback:!1},ListPlayerDevIds:["guest-007"],InputRecorder:{Enabled:!1,Logging:!0,PlaybackDelay:0,TimeScale:1,UseVisualizer:!0,SkipInactivity:{Enabled:!0,MinTime:3e3},MouseEvents:{mousedown:!0,mouseup:!0,mousemove:!0,mouseenter:!0,mouseleave:!0,mouseout:!0,mouseover:!0}}},AdaptivePerformance:{Enabled:!0,Quality:{Min:1,Max:2,AdjustStep:.1},Options:{FpsThreshold:48,CheckInterval:2e3,AutoUpgradeQuality:!0,OnlyUpdateWhenSwitchScene:!1},TrackingSceneNames:["GameScene"]},FrameCapture:{Enabled:!1,Options:{Quality:.85,RenderType:"jpeg",UseBlobIfPossible:!0,FallbackWithWideframe:"Default"}}}}),g,o=F(()=>{g={AllowWithoutSDK:!0,UseNameGenerator:!0}}),Qt,km,i=F(()=>{"use strict";Qt={},window.__listeners=Qt,km=window.addEventListener.bind(window),window.addEventListener=(e,t,r)=>{Qt[e]||(Qt[e]=[]),Qt[e].push(t),km(e,t,r)}});function Gm(){let e=["error","unhandledrejection"],t=window.__listeners??[];for(let r of e)t[r]?.[0]&&window.removeEventListener(r,t[r].shift())}function ei(e){window.__errorQueue&&window.__errorQueue.push(typeof e=="string"?new Error(e):e)}function $m(){window.addEventListener("error",e=>{ei(e.error)}),window.addEventListener("unhandledrejection",e=>{ei(e.reason)})}var c=F(()=>{"use strict";window.__errorQueue=[],window.addEventListener("load",()=>{Gm(),$m()})}),et,Aa,Jt,ba,Fm,Xt,Bm,va,Vm,Um,Hm,Km,jm,ti,Wm,l=F(()=>{"use strict";window.__sdkLoadingCount=window.__sdkLoadingCount??0,window.__errorQueue=window.__errorQueue??[],et=e=>{let t=Ludex?.Utils.Function.toError(e);t?.message&&(Aa("app_crash_handle",{error:t.message}),window.__errorQueue?.push(t),codex?.monitorError?.sendException(t))},Aa=(e,t)=>{codex?.analytics?.event(e,t)},Jt=null,ba=()=>{Jt&&(clearInterval(Jt),Jt=null)},Fm=()=>{if(ba(),!(window.__sdkLoadingCount>=70)){let e=70-window.__sdkLoadingCount,t=e>0?3e3/e:3e3;Jt=setInterval(()=>{if(window.__sdkLoadingCount>=70){ba();return}window.__sdkLoadingCount++,window.GameSDK?.setLoadingProgress(window.__sdkLoadingCount)},t)}},Xt=null,Bm=()=>{va(),Xt=setTimeout(()=>{window.__sdkLoadingCount<=1&&window.GameSDK?.extra?.displayWarnLoading?.(!0)},8e3)},va=()=>{Xt!==null&&(clearTimeout(Xt),Xt=null),window.GameSDK?.extra?.displayWarnLoading?.(!1)},Vm=async e=>{let t=document.createElement("script");return t.src=`https://www.googletagmanager.com/gtag/js?id=${e}`,t.async=!0,new Promise((r,n)=>{let y=!1,f=null,w=null,A=null,x=()=>{f!==null&&clearTimeout(f),w&&t.removeEventListener("load",w),A&&t.removeEventListener("error",A)};f=setTimeout(()=>{y||(y=!0,x(),n(new Error(`Timeout loading GA script after ${1e4/1e3}s`)))},1e4),w=()=>{y||(y=!0,x(),r())},A=()=>{y||(y=!0,x(),n(new Error("Failed to load GA script")))},t.addEventListener("load",w),t.addEventListener("error",A),document.head.appendChild(t)})},Um=(e,t,r)=>{try{if(typeof window.gtag!="function")throw new Error("window.gtag function not found after loading script.");let n=window.GameSDK?.getEntryPointData()||{},{fbig_ad_id:y,fbig_adset_id:f,fbig_campaign_id:w,fb_instant_game_adset_id:A,fb_instant_game_ad_id:x,fb_instant_game_campaign_id:v}=n,D=y??x??void 0,I=f??A??void 0,E=w??v??void 0;window.dataLayer=window.dataLayer||[],window.gtag("js",new Date),window.gtag("set",{client_id:`100.${e}`,user_id:e,send_page_view:!1});let b="0";for(let _ of r)window.gtag("config",_,{cookie_flags:"SameSite=None;Secure",build:b,medium:t,campaign:E,groups:"GA"});let T=(Ludex?.Utils?.Browser?.getQueryParams()||{}).entry_point||t,U={user_id:e,player_id:e,app_version:b,traffic_source:t,traffic_source_detail:T,ad_id:D,adset_id:I,campaign_id:E,new_user:void 0,coins:void 0,score:void 0};window.gtag("set","user_properties",U)}catch(n){et(n)}},Hm=async()=>{let e=[],t;try{return;if(window.GameSDK)try{a=await window.GameSDK.getEntryPointAsync()??a}catch{}}catch(r){et(r)}finally{jm()}},Km=()=>{try{if(!codex?.player||typeof window.gtag!="function")return;let e=codex.player.getBestScore()??0,t=codex.player.getGameData()?.coins??0,r=codex.player.isFirstSession()??void 0,n=window.GameSDK?.getEntryPointData()||{},{content:y,notif_id:f}=n,w={new_user:r,coins:t,score:e};(y||f)&&(w.traffic_source_detail=y??`notif_${f}`);let A=Object.entries(w).filter(([x,v])=>v!==void 0).reduce((x,[v,D])=>(x[v]=D,x),{});Object.keys(A).length>0&&window.gtag("set","user_properties",A)}catch(e){et(e)}},jm=()=>{try{let{Events:e,Plugins:{Analytics:{Events:t}}}=Ludex;Aa(t.APP_LAUNCH),codex.event.catchUp(e.GAME_SDK_READY,()=>{Aa(t.APP_INITIALIZED)}),codex.event.catchUp(Ludex.Events.PLAYER_INFO_LOADED,Km)}catch(e){et(e)}},ti=async(e=0)=>{try{Bm(),await window.GameSDK.initializeAsync(),va(),window.__sdkLoadingCount=1,window.GameSDK.setLoadingProgress(window.__sdkLoadingCount),Fm(),await Hm(),codex.event.emit(Ludex.Events.GAME_SDK_READY)}catch(t){if(va(),ba(),e>=5){et(t);return}setTimeout(()=>ti(e+1),2e3)}},Wm=()=>{let e=0,t=()=>{window.GameSDK?ti():e<1e4?(e+=50,setTimeout(t,50)):et(new Error(`GameSDK not found after ${1e4/1e3}s`))};t()},Wm()});function qm(e){let t=document.createElement("div");t.innerHTML=".",t.style.fontFamily=`'${e}'`,t.style.position="absolute",t.style.left="-100px",t.style.top="-100px",document.body.appendChild(t)}function zm(){let e="Lilita One, M PLUS 1p, Baloo 2";if(!e)return;let t=e.split(",").map(r=>r.trim());for(let r of t)qm(r);setTimeout(()=>{let r=t.join("&family="),n=document.createElement("link");n.href=`https://fonts.googleapis.com/css2?family=${r}&display=swap`,n.rel="stylesheet",n.as="style",document.head.appendChild(n)},200)}var d=F(()=>{"use strict";document.addEventListener("DOMContentLoaded",zm,{once:!0})});function Ym(){let e=arguments;e[0]==="event"&&(typeof e[2]!="object"&&(e[2]={}),e[2].build="0",e[2].send_to="GA",e[2].extend_session=1),window.dataLayer.push(e)}function Qm(){try{return}catch{}}var u=F(()=>{"use strict";window.dataLayer=window.dataLayer||[],window.gtag=Ym,Qm()}),Jm,p=F(()=>{"use strict";Jm=window.navigator.getGamepads,window.navigator.getGamepads=()=>{try{return Jm()}catch{return[]}}}),Lt,m=F(()=>{"use strict";Lt=window.performance||{},(typeof Lt.mark!="function"||typeof Lt.measure!="function")&&(Lt={mark:()=>{},measure:()=>{}}),Lt.mark("load-start"),window.__perf=Lt}),Z={};It(Z,{default:()=>M});var M,O=F(()=>{"use strict";s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),M=null}),Da,Zt,Sa=F(()=>{"use strict";s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),Da=class{adapter;extra;currentContextID=null;currentContextType="SOLO";currentContextPlayers=[];m=null;n=null;w=null;P;T=[];v;constructor(e){this.adapter=e,this.extra=e.extra}setCurrentContextId(e){this.E(e),this.currentContextID=e,this.currentContextType="THREAD"}initContextInfo(e,t){let{Array:r,String:n}=Ludex.Utils;this.P={},this.v={},this.T=r.fillWith(10,()=>n.generateObjectId()),!(!e||!t)&&(["SOLO","THREAD","POST","GROUP"].indexOf(t)<0||(this.currentContextID=e,this.currentContextType=t))}getID(){return this.currentContextID}getType(){return this.currentContextType}async re(){if(this.w)return;let e=(await Promise.resolve().then(()=>(O(),Z))).default;typeof e=="function"&&(this.w=new e,await this.w.setupTemplate())}async ie(){if(this.m)return;let e=(await Promise.resolve().then(()=>(O(),Z))).default;typeof e=="function"&&(this.m=new e,await this.m.setupTemplate())}async ne(){if(this.n)return;let e=(await Promise.resolve().then(()=>(O(),Z))).default;typeof e=="function"&&(this.n=new e,await this.n.setupTemplate())}async switchAsync(e,t=!1){if(this.extra.checkPopupShown(),await this.extra.awaitRandomDelay(),this.validateSwitchAsyncContextId(e),e==="SOLO"&&t){this.currentContextID=null,this.currentContextType="SOLO",this.b([]);return}await this.re(),await new Promise((n,y)=>{this.w||this.adapter.extra.exceptionUnsupported(),this.w.onYes(this.u(n)),this.w.onNo(this.y(y)),this.w.show(e),this.extra.isPopupShown=!0}),this.currentContextID=e,this.currentContextType="THREAD",this.$(e,10);let r=this.v[e].map(n=>this.O(n));this.b(r)}async chooseAsync(e){this.extra.checkPopupShown(),await this.extra.awaitRandomDelay(),await this.ie(),await new Promise((y,f)=>{this.m||this.adapter.extra.exceptionUnsupported(),this.m.onYes(this.u(y)),this.m.onNo(this.y(f)),this.m.show(),this.extra.isPopupShown=!0});let t=Math.floor(Math.random()*this.T.length),r=this.T[t];this.E(r),this.currentContextID=r,this.currentContextType="THREAD",this.$(r,2);let n=this.v[r].map(y=>this.O(y));this.b(n)}async createAsync(e){if(this.extra.checkPopupShown(),await this.extra.awaitRandomDelay(),await this.oe(e),await this.ne(),await new Promise((n,y)=>{this.n||this.adapter.extra.exceptionUnsupported(),this.n.onYes(this.u(n)),this.n.onNo(this.y(y)),this.n.show(e),this.extra.isPopupShown=!0}),!this.P[e]){let{Utils:{String:n}}=Ludex;this.P[e]=n.generateObjectId()}let t=this.P[e];this.E(t),this.currentContextID=t,this.currentContextType="THREAD";let r=this.O(e);this.b([r])}u=e=>()=>{this.extra.isPopupShown=!1,e(!0)};y=e=>()=>{this.extra.isPopupShown=!1;try{this.extra.exceptionUserInput("Player closed the context menu")}catch(t){e(t)}};async getPlayersAsync(){return await this.extra.awaitRandomDelay(),this.currentContextPlayers}$(e,t){if(!this.v[e]){let{Array:r,String:n}=Ludex.Utils,y=Math.floor(Math.random()*t),f=r.fillWith(y,()=>n.generateObjectId());this.v[e]=f}return this.v[e]}O(e){return{getID:()=>e,getName:()=>`Player ${e}`,getPhoto:()=>""}}b(e){if(this.currentContextType==="SOLO"){this.currentContextPlayers=[];return}this.currentContextPlayers=e}E(e){this.currentContextID===e&&this.extra.exceptionSameContext()}async oe(e){if((!e||Array.isArray(e))&&this.extra.exceptionClientUnsupportedOperation("Client does not support no player IDS or multiple player IDs yet"),!Ludex.Utils.Valid.isString(e)){let r=`Array of type String contained a value of another type: ${e}`;this.extra.exceptionInvalidParam(r)}if(e===GameSDK.player.getID()&&this.extra.exceptionInvalidParam("At least one player id besides the current player must be provided."),(await GameSDK.player.getConnectedPlayersAsync()).some(r=>r.getID()===e))return;let t=`Provided ID ${e} is not a connected player of the current player.`;this.extra.exceptionInvalidParam(t)}validateSwitchAsyncContextId(e){this.E(e),!Ludex.Utils.Valid.isString(e)&&this.extra.exceptionClientUnsupportedOperation("Client requires update to support this operation")}},Zt=Da}),ai,ri=F(()=>{ai="./assets/async-popup.html"}),si,ni=F(()=>{si="./assets/loading.html"}),eh,er,oi,ii,ci,Ia=F(()=>{"use strict";s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),ri(),ni(),eh=e=>!!document.querySelector(e),er={},oi=async e=>{let{template:t,selector:r}=e;if(t in er)return await er[t],document.querySelector(r);let n=(await fetch(t)).text();er[t]=n;let y=await er[t];return eh(r)||document.body.insertAdjacentHTML("beforeend",y),document.querySelector(r)},ii=async()=>oi({template:ai,selector:"#async-popup-container"}),ci=async()=>oi({template:si,selector:"#loading-screen"})}),li,La,di,ui=F(()=>{"use strict";s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),Ia(),La=class{L=0;c=null;constructor(){this.le()}async le(){this.c=await ci(),this.c&&(this.c.setAttribute("data-clarity-unmask","true"),this.ce())}ce(){if(!this.c)return;let e="logo-128x128.png",t=this.c.querySelector("#lds-game-icon");t&&t instanceof HTMLElement&&(t.style.backgroundImage=`url(${e})`,t.style.backgroundColor="transparent");let r=this.c.querySelector("#lds-game-icon-blur");r&&r instanceof HTMLElement&&(r.style.backgroundImage=`url(${e})`,r.style.backgroundColor="transparent")}setLoadingProgress(e){if(this.L>=e)return;this.L=e,this.L>=100&&(this.L=100);let t=document.getElementById("lds-percent");t&&(t.innerHTML=`${e}`)}displayWarnLoading(e){let t=document.getElementById("lds-warn-text");t&&(clearTimeout(li),e?(t.style.display="block",t.offsetWidth,t.style.opacity="0.8"):(t.style.opacity="0",li=setTimeout(()=>{t.style.display="none"},300)))}removeLoadingElement(){this.c&&(this.c.style.opacity="0",setTimeout(()=>{this.c?.remove()},300))}},di=La}),Ca,pi,mi=F(()=>{"use strict";s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),Ca=class extends Error{code;constructor(e,t){super(t),this.code=e}},pi=Ca}),th,Ea,hi,fi=F(()=>{"use strict";s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),ui(),mi(),th=1e4,Ea=class{adapter;isGuest=!1;isPopupShown=!1;loadingElement=null;constructor(e){this.adapter=e}async subscribeBotAsync(){if(!await this.adapter.player.canSubscribeBotAsync())return!1;let{analytics:e}=codex,{Plugins:{Analytics:{Events:{BOT_SUBSCRIBE:t,BOT_SUBSCRIBE_POPUP:r}}}}=Ludex;e.event(r);try{return await this.waitSDKInitiatedAsync(),await this.adapter.player.subscribeBotAsync(),e.event(t,{success:!0}),!0}catch{return e.event(t,{success:!1}),!1}}async checkAndCreateShortcutAsync(){if(!await this.adapter.canCreateShortcutAsync())return;let{analytics:e}=codex,{Plugins:{Analytics:{Events:{SHORTCUT_CREATE:t,SHORTCUT_CREATE_POPUP:r}}}}=Ludex;e.event(r);try{await this.waitSDKInitiatedAsync(),await this.adapter.createShortcutAsync(),e.event(t,{success:!0})}catch{e.event(t,{success:!1})}}waitSDKInitiatedAsync(){let{Events:{GAME_SDK_READY:e}}=Ludex;return new Promise(t=>{codex.event.catchUp(e,t)})}async waitLudexReadyAsync(){let e=0;return new Promise(t=>{let r=setInterval(()=>{if("Ludex"in window){clearInterval(r),t();return}e+=10,e>th&&(e=0)},10)})}createLoadingElement(){this.loadingElement||(this.loadingElement=new di)}setLoadingElementProgress(e){this.loadingElement&&this.loadingElement.setLoadingProgress(e)}displayWarnLoading(e){this.loadingElement&&this.loadingElement.displayWarnLoading(e)}destroyLoadingElement(){this.loadingElement&&this.loadingElement.removeLoadingElement()}checkPopupShown(){this.isPopupShown&&this.exceptionPendingRequest("Please wait for the popup to close")}async delayInitialAsync(){let{Utils:{Time:e},Configs:{Mockup:{GameSDK:{SlowAPI:t}}}}=Ludex;!t.Enabled||t.InitialDelay<=0||await e.sleepAsync(t.InitialDelay)}async delayStartAsync(){let{Configs:{Mockup:{GameSDK:{SlowAPI:e}}},Utils:{Time:t}}=Ludex;!e.Enabled||e.StartDelay<=0||await t.sleepAsync(e.StartDelay)}async delayPlayerDataAsync(){let{Configs:{Mockup:{GameSDK:{SlowAPI:e}}},Utils:{Time:t}}=Ludex;!e.Enabled||e.PlayerDataDelay<=0||await t.sleepAsync(e.PlayerDataDelay)}awaitRandomDelay(e=1e3){let{Utils:{Time:t}}=Ludex;return t.sleepAsync(Math.random()*e)}randomException(e){let t=Math.floor(Math.random()*e.length),r=e[t];this[`exception${r}`]()}getErrorMessage(e){let{Valid:t,Object:r}=Ludex.Utils;return!r.hasOwn(e,"message")||!t.isString(e.message)?null:e.message}o(e,t){throw new pi(e,t)}exceptionUserInput(e){this.o("USER_INPUT",e)}exceptionUnsupported(){this.o("UNSUPPORTED","Unsupported method")}exceptionInvalidParam(e){this.o("INVALID_PARAM",e)}exceptionPendingRequest(e){this.o("PENDING_REQUEST",e)}exceptionMethodNotImplemented(){this.o("METHOD_NOT_IMPLEMENTED","Method not implemented")}exceptionTournamentNotFound(e){this.o("TOURNAMENT_NOT_FOUND",e)}exceptionSameContext(){this.o("SAME_CONTEXT","Must specify a context other than the current one.")}exceptionInvalidOperation(e){this.o("INVALID_OPERATION",e)}exceptionNetworkFailure(e="Request failed to be processed"){this.o("NETWORK_FAILURE",e)}exceptionUnknown(e){this.o("UNKNOWN",e)}exceptionClientUnsupportedOperation(e){this.o("CLIENT_UNSUPPORTED_OPERATION",e)}exceptionRateLimited(e){this.o("RATE_LIMITED",e)}},hi=Ea}),Ma,yi,gi=F(()=>{"use strict";s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),Ia(),Ma=class{popup;title;content;okButton;noButton;N;R;async setupTemplate(){let e=await ii();e&&(this.popup=e,this.title=e.querySelector("#title"),this.content=e.querySelector("#content"),this.okButton=e.querySelector("#ok"),this.noButton=e.querySelector("#no"),this.hide())}onYes=e=>{this.okButton&&(this.okButton.removeEventListener("click",this.N),this.N=this.W(e),this.okButton.addEventListener("click",this.N,{once:!0}))};onNo=e=>{this.noButton&&(this.noButton.removeEventListener("click",this.R),this.R=this.W(e),this.noButton.addEventListener("click",this.R,{once:!0}))};W=e=>t=>{t.stopImmediatePropagation(),this.hide(),e()};show(e){this.content.textContent=`${e}`,this.popup.style.display="flex"}hide(){this.popup.style.display="none"}},yi=Ma}),Pi={};It(Pi,{default:()=>rh});var Ta,rh,xi=F(()=>{"use strict";s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),gi(),Ta=class extends yi{show(e){this.title.textContent="Purchase",this.okButton.textContent="Purchase",this.noButton.textContent="Cancel";let t=JSON.stringify(e,null,2);super.show(`Do you want to purchase?
Payload: ${t}`)}},rh=Ta}),tr,ah,nh,sh,oh,wi,Oa,_a,Ai,bi=F(()=>{"use strict";s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),tr=["Unsupported","NetworkFailure","PendingRequest","ClientUnsupportedOperation"],ah=[...tr,"InvalidParam"],nh=[...tr,"InvalidParam","UserInput"],sh=[...tr,"NetworkFailure"],oh=[...tr,"InvalidParam","UserInput"],wi="ProductsDataMockKey",Oa="PurchasesDataMockKey",_a=class{adapter;extra;context;A=null;constructor(e){this.adapter=e,this.extra=e.extra,this.context=e.context}async initPaymentInfoAsync(){let{Configs:{Mockup:{GameSDK:{Payments:{Enabled:e}}}}}=Ludex;e&&await this.createMockProductsData()}async getCatalogAsync(){await this.l(),this.randomError(ah);let e=this.M();return Object.values(e)}async de(){if(this.A)return;let e=(await Promise.resolve().then(()=>(xi(),Pi))).default;typeof e=="function"&&(this.A=new e,await this.A.setupTemplate())}async purchaseAsync(e){return this.extra.checkPopupShown(),await this.l(),this.he(e),this.randomError(nh),await this.de(),await new Promise((t,r)=>{this.A||this.adapter.extra.exceptionUnsupported(),this.A.onYes(this.u(t)),this.A.onNo(this.y(r)),this.A.show(e),this.extra.isPopupShown=!0}),this.ue(e)}async getPurchasesAsync(){await this.l(),this.randomError(sh);let e=this.adapter.player.getID();return e?this.k()[e]||[]:[]}async consumePurchaseAsync(e){await this.l(),this.ye(e),this.randomError(oh);let t=this.adapter.player.getID();if(!t)return;let r=(this.k()[t]||[]).filter(n=>n.purchaseToken!==e);this.z(t,r)}onReady(e){e()}async l(){let{Configs:{Mockup:{GameSDK:{Payments:{RandomDelayMs:e}}}}}=Ludex;return this.extra.awaitRandomDelay(e)}randomError(e){let{Configs:{Mockup:{GameSDK:{Payments:{ErrorRates:t}}}}}=Ludex;Math.random()*100<t&&this.extra.randomException(e)}he(e){let{Utils:{Object:t,Valid:r}}=Ludex;r.isObject(e)||this.extra.exceptionInvalidParam("Config must be an object"),t.hasOwn(e,"productID")||this.extra.exceptionInvalidParam("Config must have productID");let{productID:n}=e;r.isString(n)||this.extra.exceptionInvalidParam("productID must be a string"),t.hasOwn(e,"developerPayload")&&!r.isString(e.developerPayload)&&this.extra.exceptionInvalidParam("developerPayload must be a string")}ye(e){let{Utils:{Valid:t}}=Ludex;t.isString(e)||this.extra.exceptionInvalidParam("Purchase token must be a string")}ue(e){let{Utils:{String:t}}=Ludex,r={productID:e.productID,paymentID:t.generateObjectId(),purchaseToken:t.generateObjectId(),purchaseTime:new Date().toISOString(),developerPayload:e.developerPayload,signedRequest:t.generateObjectId()},n=this.adapter.player.getID();if(n){let y=this.k()[n]||[];y.push(r),this.z(n,y)}return r}async createMockProductsData(){let{Configs:{Mockup:{GameSDK:{Payments:{Enabled:e,Products:t}}}}}=Ludex;if(!e)return;let r=this.M();if(Object.values(r).length>=t.length)return;let n=this.pe();await Promise.all(n)}pe(){let{Configs:{Mockup:{GameSDK:{Payments:{Products:e}}}}}=Ludex;return e.map(t=>{let r={productID:t.id,title:`Product ${t.id}`,description:`Description for ${t.id}`,price:t.price.toString(),priceCurrencyCode:"USD",priceAmount:t.price};return this.ge(t.id,r),r})}M(){let{Utils:{Browser:e,Valid:t}}=Ludex,r=e.getLocalStorage(wi);return t.isObject(r)?r:{}}ge(e,t){let r=this.M();r[e]=t,this.fe(r)}fe(e){let{Utils:{Browser:t,Valid:r}}=Ludex;r.isObject(e)&&t.writeLocalStorage(wi,e)}k(){let{Utils:{Browser:e,Valid:t}}=Ludex,r=e.getLocalStorage(Oa);return t.isObject(r)?r:{}}z(e,t){let{Utils:{Browser:r}}=Ludex;if(!Array.isArray(t))return;let n=r.getLocalStorage(Oa)??{};n[e]=t,r.writeLocalStorage(Oa,n)}u=e=>()=>{this.extra.isPopupShown=!1,e(!0)};y=e=>()=>{this.extra.isPopupShown=!1;try{this.extra.exceptionUserInput("Player closed the context menu")}catch(t){e(t)}}},Ai=_a}),vi,Di,Na,Si,Ii=F(()=>{"use strict";s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),vi="Dinosaurs Merge Master".replace(/ /g,"-"),Di="https://picsum.photos/seed/%1/300/300",Na=class{adapter;extra;defaultPlayerInfo;currentPlayerInfo;infoKey=`${vi}_PlayerInfo`;dataKey=`${vi}_PlayerData`;D=null;C=null;constructor(e){this.adapter=e,this.extra=e.extra,this.initDefaultPlayerInfo()}initDefaultPlayerInfo(){let e="guest-007";this.defaultPlayerInfo={playerId:e,playerName:"Guest",playerPhoto:Di.replace("%1",e)},this.extra.isGuest=!0,this.currentPlayerInfo=S({},this.defaultPlayerInfo)}initPlayerInfo(e){this.updateCurrentPlayerInfo(e);let{Utils:{Browser:t}}=Ludex;t.writeLocalStorage(this.infoKey,this.currentPlayerInfo)}async canSubscribeBotAsync(){return await this.q(),this.D||this.extra.exceptionUnsupported(),this.D.canSubscribeBotAsync()}async subscribeBotAsync(){return await this.q(),this.D||this.extra.exceptionUnsupported(),this.D.subscribeBotAsync()}getID(){return this.currentPlayerInfo.playerId}getName(){return this.currentPlayerInfo.playerName}getPhoto(){return this.currentPlayerInfo.playerPhoto}async getDataAsync(e){if(e.length<1)return{};await this.extra.delayPlayerDataAsync();let{Utils:{Browser:t,Valid:r,Object:n}}=Ludex,y=t.getLocalStorage(this.dataKey);if(!r.isObject(y))return{};let f={};for(let w of e)n.hasOwn(y,w)&&(f[w]=y[w]);return f}async setDataAsync(e){await this.extra.delayPlayerDataAsync();let{Utils:{Browser:t}}=Ludex;t.writeLocalStorage(this.dataKey,e)}async getSignedPlayerInfoAsync(){return{getPlayerID:()=>this.getID()??"",getSignature:this.me}}async getConnectedPlayersAsync(){return await this.we(),this.C||this.extra.exceptionUnsupported(),this.C.getConnectedPlayersAsync()}updateCurrentPlayerInfo(e){let{Utils:{Browser:t,Valid:r,Object:n,String:y}}=Ludex,f=e??"",w="Nameless";if(this.extra.isGuest){let A=t.getLocalStorage(this.infoKey);r.isObject(A)&&n.hasOwn(A,"playerId")&&r.isString(A.playerId)&&(f=A.playerId),r.isObject(A)&&n.hasOwn(A,"playerName")&&r.isString(A.playerName)&&(w=A.playerName)}r.isEmpty(f)&&(f=y.generateObjectId()),w==="Nameless"&&this.Ae()&&(w=y.generateNameUsingString(f)),this.currentPlayerInfo.playerId=f,this.currentPlayerInfo.playerName=w,this.currentPlayerInfo.playerPhoto=Di.replace("%1",f),this.xe(f)}Ae(){return g?.UseNameGenerator===!0}ve(){let{Match:e}=Ludex.Configs.Mockup;return e.Enabled?e.PlayerInfo:null}De(){let{Match:e}=Ludex.Configs.Mockup;return e.Enabled?e.OpponentInfo:null}xe(e){let t=this.De();e!==t?.Id&&(t=this.ve()),t&&(this.currentPlayerInfo.playerId=t.Id,t.Name&&(this.currentPlayerInfo.playerName=t.Name),t.Photo&&(this.currentPlayerInfo.playerPhoto=t.Photo))}me=()=>{let e=this.Ie();return Ludex.Utils.Valid.isString(e)?e:"default_token"};Ie(){let{Configs:{Mockup:{Match:e}}}=Ludex,t=e.PlayerInfo.Id===this.getID(),r=e.OpponentInfo.Id===this.getID();return t?e.PlayerInfo.Signature:r?e.OpponentInfo.Signature:null}async q(){if(this.D)return;let e=(await Promise.resolve().then(()=>(O(),Z))).default;typeof e=="function"&&(this.D=new e(this.adapter))}async we(){if(this.C)return;let e=(await Promise.resolve().then(()=>(O(),Z))).default;typeof e=="function"&&(this.C=new e(this.extra))}},Si=Na}),Ra,Li,Ci=F(()=>{"use strict";s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),Ra=class{id;G;F;s;U;B;constructor(e,t,r=!1){let{config:n,data:y}=t;this.id=e,this.G=n.title,this.F=`0123${this.id}`,this.s=JSON.stringify(y??{}),this.U=n.endTime??this.Se(),this.B=r?"PAGE_HOSTED":"DEFAULT"}Se(){return Math.round((Date.now()+1e3*60*60*24*7)/1e3)}getID(){return this.id}getTitle(){return this.G}getPayload(){return this.s}getEndTime(){return this.U}getContextID(){return this.F}getTournamentType(){return this.B}toObject(){return{id:this.id,title:this.G,payload:this.s,endTime:this.U,contextId:this.F,tournamentType:this.B}}},Li=Ra}),Ct,ih,ch,lh,dh,uh,Ei,ka,Ga,Mi,Ti=F(()=>{"use strict";s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),Sa(),Ci(),Ct=["Unsupported","NetworkFailure","PendingRequest","ClientUnsupportedOperation"],ih=[...Ct,"InvalidParam","UserInput"],ch=[...Ct,"InvalidOperation","UserInput"],lh=[...Ct,"InvalidParam","UserInput"],dh=[...Ct,"InvalidParam","UserInput"],uh=[...Ct,"NetworkFailure"],Ei="TournamentsDataMockKey",ka="TournamentLeadersMockKey",Ga=class{adapter;extra;context;x=null;n=null;constructor(e){this.adapter=e,this.extra=e.extra,this.context=e.context}async initTournamentInfoAsync(e){let{Configs:{Mockup:{GameSDK:{Tournament:{Enabled:t}}}}}=Ludex;t&&(await this.createMockTournamentsData(),e&&await this.Pe(e))}Pe=async e=>{this.Y(e)&&await this.joinAsync(e)};async createMockTournamentsData(){let{Utils:{Object:e},Configs:{Mockup:{GameSDK:{Tournament:{Enabled:t,NumOfTournament:r}}}}}=Ludex,{Normal:n,HostPage:y}=r;if(!t)return;let f=this.S(),w=e.vals(f),A=this.Ee(w),x=A.filter(_=>_.tournamentType==="DEFAULT"),v=A.filter(_=>_.tournamentType==="PAGE_HOSTED"),{length:D}=x,{length:I}=v,E=n-D,b=y-I,T=this.be(E),U=this.Le(b);await Promise.all([...T,...U])}Ee(e){let t=Date.now()/1e3,r=e.filter(y=>y.endTime>t),n={};for(let y of r)n[y.id]=y;return this.Q(n),r}be(e){let{Utils:{String:t,Array:r,Number:n},Configs:{Mockup:{GameSDK:{Tournament:{ExtraPlayerTournamentPayload:y}}}}}=Ludex,{leaderboard:f}=codex,w=GameSDK.player.getID(),A=GameSDK.player.getName();return r.length(e).map(async()=>{let x=`${A}'s Tournament ${t.generateObjectId()}`,v=await f.createLeaderboardAsync({name:x}),D=this.j({initialScore:0,config:{title:x,tournamentTitle:x},data:S({playerId:w,playerName:A,leaderboardId:v},y)}).getID().toString();if(this._(D))return;let I=n.random(2),E=codex.player.getConnectedPlayerIds(I,0).map(b=>({playerId:b,score:n.random(4)}));E.sort((b,T)=>b.score-T.score),this.H(D,E)})}Le(e){let{Utils:{String:t,Array:r,Number:n},Configs:{Mockup:{GameSDK:{Tournament:{ExtraGlobalTournamentPayload:y}}}}}=Ludex,{leaderboard:f}=codex;return r.length(e).map(async()=>{let w=t.generateObjectId(),A=S({leaderboardId:w,playerId:"global"},y),x=`Global Tournament ${w}`;await f.createLeaderboardAsync({name:x,_id:w,type:"world_tournament_leaderboard",description:JSON.stringify(A)});let v=this.j({initialScore:0,config:{title:x,tournamentTitle:x},data:A},!0).getID().toString();if(this._(v))return;let D=n.random(2),I=r.length(D).map(()=>({playerId:t.generateObjectId(),score:n.random(4)}));I.sort((E,b)=>E.score-b.score),this.H(v,I)})}async l(){let{Configs:{Mockup:{GameSDK:{Tournament:{RandomDelayMs:e}}}}}=Ludex;return this.extra.awaitRandomDelay(e)}randomError(e){let{Configs:{Mockup:{GameSDK:{Tournament:{ErrorRates:t}}}}}=Ludex;Math.random()*100<t&&this.extra.randomException(e)}async Ce(){if(this.n)return;let e=(await Promise.resolve().then(()=>(O(),Z))).default;typeof e=="function"&&(this.n=new e,await this.n.setupTemplate())}async _e(){if(this.x)return;let e=(await Promise.resolve().then(()=>(O(),Z))).default;typeof e=="function"&&(this.x=new e,await this.x.setupTemplate())}async createAsync(e){this.extra.checkPopupShown(),await this.l(),this.context.getID()!==null&&this.extra.exceptionInvalidOperation("Cannot create tournament while in a context"),this.Te(e),this.randomError(ih),await this.Ce(),await new Promise((n,y)=>{this.n||this.adapter.extra.exceptionUnsupported(),this.n.onYes(this.u(n)),this.n.onNo(this.y(y)),this.n.show(e),this.extra.isPopupShown=!0});let t=this.j(e),r=t.getContextID();return this.Oe(r),t}j(e,t=!1){let{Utils:{String:r}}=Ludex,n=r.generateObjectId(),y=new Li(n,e,t),f=y.toObject();return this.Ne(n,f),y}async postScoreAsync(e){await this.l(),this.J(),e<0&&this.extra.exceptionInvalidParam("Score must be a positive number"),this.randomError(dh);let t=codex.player.getPlayerId();this.X(t,e)}async shareAsync(e){this.extra.checkPopupShown(),await this.l(),this.J(),this.Re(e),this.randomError(lh),await this._e();let{score:t}=e,r=t,n=this.K();if(n){let f=codex.player.getPlayerId(),w=n.getID().toString(),A=this.Me(w,f);A&&A<t&&(r=A)}await new Promise((f,w)=>{this.x||this.adapter.extra.exceptionUnsupported(),this.x.onYes(this.u(f)),this.x.onNo(this.y(w)),this.x.show(r),this.extra.isPopupShown=!0});let y=codex.player.getPlayerId();this.X(y,t)}async getTournamentsAsync(){await this.l(),this.randomError(uh);let e=this.S(),{Utils:{Object:t}}=Ludex;return t.vals(e).map(r=>this.V(r.id)).filter(r=>r!==null)}async joinAsync(e){await this.l();let{Utils:{Valid:t}}=Ludex;t.isString(e)||this.extra.exceptionInvalidParam("Tournament ID must be a string");let r=this.V(e);r||this.extra.exceptionTournamentNotFound("Tournament could not be found."),this.randomError(ch);let n=r.getContextID();await GameSDK.context.switchAsync(n)}Oe(e){this.context instanceof Zt&&this.context.setCurrentContextId(e)}u=e=>()=>{this.extra.isPopupShown=!1,e(!0)};y=e=>()=>{this.extra.isPopupShown=!1;try{this.extra.exceptionUserInput("Player closed the context menu")}catch(t){e(t)}};K(){let e=this.context.getID();if(!e)return null;let t=this.S();for(let r in t)if(Object.hasOwn(t,r)&&t[r].contextId===e)return this.V(r);return null}Te(e){let{Utils:{Object:t,Valid:r}}=Ludex;r.isObject(e)||this.extra.exceptionInvalidParam("Payload must be an object"),t.hasOwn(e,"initialScore")||this.extra.exceptionInvalidParam("Payload must have initialScore"),t.hasOwn(e,"config")||this.extra.exceptionInvalidParam("Payload must have config");let{initialScore:n,config:y}=e;r.isNumber(n)||this.extra.exceptionInvalidParam("initialScore must be a number"),r.isObject(y)||this.extra.exceptionInvalidParam("Config must be an object"),t.hasOwn(y,"title")||this.extra.exceptionInvalidParam("Config must have title"),t.hasOwn(y,"tournamentTitle")||this.extra.exceptionInvalidParam("Config must have tournamentTitle"),t.hasOwn(e,"data")&&!r.isObject(e.data)&&this.extra.exceptionInvalidParam("Data must be an object")}Re(e){let{Utils:{Object:t,Valid:r}}=Ludex;r.isObject(e)||this.extra.exceptionInvalidParam("Payload must be an object"),t.hasOwn(e,"score")||this.extra.exceptionInvalidParam("Payload must have score");let{score:n}=e;r.isNumber(n)||this.extra.exceptionInvalidParam("Score must be a number"),t.hasOwn(e,"data")&&!r.isObject(e.data)&&this.extra.exceptionInvalidParam("Data must be an object")}J(){this.K()||this.extra.exceptionTournamentNotFound("There is no tournament for this context.")}V(e){let t=this.Y(e);return t?{getID:()=>t.id,getTitle:()=>t.title,getPayload:()=>t.payload,getEndTime:()=>t.endTime,getContextID:()=>t.contextId,getTournamentType:()=>t.tournamentType}:null}Y(e){let t=this.S();return t[e]?t[e]:null}Ne(e,t){let r=this.S();r[e]=t,this.Q(r)}S(){let{Utils:{Browser:e,Valid:t}}=Ludex,r=e.getLocalStorage(Ei);return t.isObject(r)?r:{}}Q(e){let{Utils:{Browser:t,Valid:r}}=Ludex;r.isObject(e)&&t.writeLocalStorage(Ei,e)}Me(e,t){let r=this.Z(e,t);return r?r.score??null:null}X(e,t){let r=this.K();if(!r)return;let n=r.getID().toString();if(!n)return;let y=this.Z(n,e);if(!y){this.ee(n,{playerId:e,score:t});return}y.score<t&&(y.score=t,this.ee(n,y))}Z(e,t){let r=this._(e);if(!r.length)return null;let{Utils:{Array:n}}=Ludex;return n.search(r,y=>y.playerId===t)??null}_(e){let{Utils:{Browser:t,Object:r}}=Ludex,n=t.getLocalStorage(ka);if(!r.hasOwn(n,e))return[];let y=n[e];return Array.isArray(y)?(y.sort((f,w)=>w.score-f.score),y):[]}ee(e,t){let{Utils:{Array:r}}=Ludex,n=this._(e),y=r.searchIndex(n,f=>f.playerId===t.playerId);y===-1?n.push(t):n[y]=t,this.H(e,n)}H(e,t){let{Utils:{Browser:r,Object:n}}=Ludex;if(!Array.isArray(t))return;let y=r.getLocalStorage(ka)??{};n.assign(y,{[e]:t}),r.writeLocalStorage(ka,y)}},Mi=Ga}),$a,Oi,_i=F(()=>{"use strict";s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),Sa(),fi(),bi(),Ii(),Ti(),$a=class{extra;player;context;tournament;payments;I=null;isInitialized=!1;bannerAdInstances={};rewardedVideoInstance=null;interstitialAdInstance=null;rewardedInterstitialInstance=null;initialize(){this.extra=new hi(this),this.player=new Si(this),this.context=new Zt(this),this.tournament=new Mi(this),this.payments=new Ai(this)}isNeedSDK(){return g?.AllowWithoutSDK!==!0}getLocale(){return Ludex.Utils.Browser.getLocale()}getPlatform(){let{Device:e}=Ludex.Utils;return e.isAndroid()?"ANDROID":e.isIOS()?"IOS":e.isDesktop()?"WEB":e.isMobile()?"MOBILE_WEB":null}getSDKName(){return"Ludex"}getSDKVersion(){return"1.0.0"}async initializeAsync(){if(this.isInitialized)return;this.initialize(),this.extra.createLoadingElement(),this.isNeedSDK()&&await this.checkSDKInitialized(),await this.extra.waitLudexReadyAsync(),await this.extra.delayInitialAsync();let e=Ludex.Utils.Browser.getQueryParams();if(e.splashPreview){this.extra.destroyLoadingElement();return}let t=e.playerId;this.player.initPlayerInfo(t);let r=e.context_source_id,n=e.context_type;this.context.initContextInfo(r,n),this.isInitialized=!0}async checkSDKInitialized(){this.extra.exceptionInvalidOperation("GameSDK requires AllowWithoutSDK=true in game config")}async startGameAsync(e=!0){this.isInitialized||this.extra.exceptionInvalidOperation("GameSDK is not initialized"),await this.extra.delayStartAsync();let t=90;window.__sdkLoadingCount=t,this.setLoadingProgress(t),this.extra.destroyLoadingElement();let{Events:r,Utils:{Browser:{getQueryParams:n}}}=Ludex,y=n().tournament_id;await this.tournament.initTournamentInfoAsync(y),await this.payments.initPaymentInfoAsync(),e&&codex.event.emit(r.GAME_SDK_STARTED)}setLoadingProgress(e){this.extra.setLoadingElementProgress(e)}getEntryPointData(){let{Utils:{Browser:e,Json:t}}=Ludex,{payload:r="{}"}=e.getQueryParams();return typeof r!="string"?{}:t.decode(r)}async getEntryPointAsync(){return"no_entry"}async loadBannerAdAsync(e){if(e){if(!this.bannerAdInstances[e]){let t=(await Promise.resolve().then(()=>(O(),Z))).default;typeof t!="function"&&this.extra.exceptionInvalidOperation("Banner ads mock is not enabled"),this.bannerAdInstances[e]=new t("banner",e)}await this.bannerAdInstances[e].loadAsync(),await this.bannerAdInstances[e].showAsync()}}async hideBannerAdAsync(e){this.bannerAdInstances[e]&&await this.bannerAdInstances[e].hideAsync()}getBannerHeight(e){return e.BannerHeight}async getInterstitialAdAsync(e){if(!this.interstitialAdInstance){let t=(await Promise.resolve().then(()=>(O(),Z))).default;typeof t!="function"&&this.extra.exceptionInvalidOperation("Interstitial ads mock is not enabled"),this.interstitialAdInstance=new t("interstitial",e)}return this.interstitialAdInstance}async getRewardedVideoAsync(e){if(!this.rewardedVideoInstance){let t=(await Promise.resolve().then(()=>(O(),Z))).default;typeof t!="function"&&this.extra.exceptionInvalidOperation("Rewarded video ads mock is not enabled"),this.rewardedVideoInstance=new t("rewarded",e)}return this.rewardedVideoInstance}async getRewardedInterstitialAsync(e){if(!this.rewardedInterstitialInstance){let t=(await Promise.resolve().then(()=>(O(),Z))).default;typeof t!="function"&&this.extra.exceptionInvalidOperation("Rewarded interstitial ads mock is not enabled"),this.rewardedInterstitialInstance=new t("rewarded_interstitial",e)}return this.rewardedInterstitialInstance}async getTournamentAsync(){this.tournament.randomError(["Unsupported","NetworkFailure"]);let e=this.context.getID(),{Array:t,Valid:r}=Ludex.Utils;r.isString(e)||this.extra.exceptionInvalidOperation("Not in a context");let n=await this.tournament.getTournamentsAsync(),y=t.search(n,f=>f.getContextID()===e);return y||this.extra.exceptionTournamentNotFound("A Tournament with current context was not found"),y}getSupportedAPIs(){let{CanSubscribeBot:e}=Ludex.Configs.Mockup.GameSDK.Player.SubscribeBot;return e?["player.canSubscribeBotAsync"]:[]}async canCreateShortcutAsync(){return await this.te(),this.I||this.extra.exceptionUnsupported(),this.I.canCreateShortcutAsync()}async createShortcutAsync(){return await this.te(),this.I||this.extra.exceptionUnsupported(),this.I.createShortcutAsync()}async te(){if(this.I)return;let e=(await Promise.resolve().then(()=>(O(),Z))).default;typeof e=="function"&&(this.I=new e(this))}},Oi=$a}),Fa,ph,mh,tt,rr=F(()=>{"use strict";s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),Fa=class{usedCallLocations;constructor(){this.usedCallLocations=Object.create(null)}getCallerLine(){let e=new Error;if(!e.stack)return null;let t=e.stack.split(`
`)[4];return t?t.trim():null}blockAccess(){try{let e=this.getCallerLine();if(!e||this.usedCallLocations[e])return!1;if(["eval","at <","(<"].some(t=>e.includes(t)))throw new Error(`Access blocked for the caller: ${e}`);return this.usedCallLocations[e]=!0,!1}catch{return!0}}},ph=new Fa,mh=(e,t)=>{let r=Object.getOwnPropertyDescriptor(e,t);if(!r)return;let{value:n,get:y,initializer:f}=r;n&&typeof n!="object"||y&&typeof y!="function"||f&&typeof f!="function"||Object.defineProperty(e,t,{enumerable:!1,get(){if(!ph.blockAccess())return n??f?.call(this)??y?.call(this)},set(){}})},tt=mh});function hh(){let e,t=window,r="GameSDK";return"FBInstant"in t?(r="FBInstant",e=new M(window.FBInstant)):"YaGames"in t?(r="Yandex",e=new M(window.YaGames)):"funmax"in t?(r="Xiaomi",e=new M(window.funmax)):"$msstart"in t?(r="MsGames",e=new M(window.$msstart)):"gdsdk"in t?(r="GameDistribution",e=new M(window.gdsdk)):"h5sdk"in t?(r="TranssionH5",e=new M(window.h5sdk)):"CrazyGames"in t?(r="CrazyGames",e=new M(window.CrazyGames.SDK)):"GlanceGamingAdInterface"in t?(r="Glance",e=new M(window.GlanceGamingAdInterface)):e=new Oi,e}var h=F(()=>{"use strict";O(),O(),O(),O(),O(),O(),O(),O(),O(),_i(),rr(),window.GameSDK=Object.seal(hh()),tt(window,"GameSDK")}),Ni,pe,ar=F(()=>{"use strict";s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),Ni=(e=>(e.CORE_BOOTING="core-booting",e.REQUEST_CORE_START="core-start",e.CORE_STARTING="core-starting",e.CORE_READY="core-ready",e.GAME_SDK_READY="game-sdk-ready",e.GAME_SDK_STARTED="game-sdk-started",e.CONTEXT_DATA_PROCESSED="context-data-processed",e.CONTEXT_SESSION_TYPE_DETECTED="context-session-type-detected",e.GAME_READY="game-ready",e.BUNDLE_READY="bundle-ready",e.PLAYER_INFO_LOADED="player-info-loaded",e.REQUEST_SHOW_BANNER_ADS="request-show-banner-ads",e.SWITCH_SCENE="switch-scene",e.SCENE_LOADED="scene-loaded",e.PRELOAD_SCENE="preload-scene",e.SCENE_PROGRESS="scene-progress",e.SCENE_LAUNCHED="scene-launched",e.SCENE_RENDERED="scene-rendered",e.SCENE_BEFORE_RENDERED="scene-before-rendered",e.MARK_IS_TEST_SCENE="mark-is-test-scene",e.PRELOAD_SCREENS="preload-screens",e.OPENING_SCREEN="opening-screen",e.OPEN_SCREEN="open-screen",e.OPENED_SCREEN="opened-screen",e.CLOSING_SCREEN="closing-screen",e.CLOSE_SCREEN="close-screen",e.CLOSED_SCREEN="closed-screen",e.CORE_PLUGIN_READY="core-plugin-ready",e.MODULE_PLUGIN_READY="module-plugin-ready",e.AD_SHOWING="ad-showing",e.AD_CLOSED="ad-closed",e.AD_FAILED="ad-failed",e.LANGUAGE_CHANGED="language-changed",e.REQUEST_LANGUAGE="request-language",e.REQUEST_HOT_RELOAD="request-hot-reload",e.REQUEST_SAVE_CONFIG="request-save-config",e.REQUEST_UPDATE_CONFIG="request-update-config",e.REMOTE_CONFIG_UPDATED="remote-config-updated",e.VISIBILITY_HIDDEN="visibility-hidden",e.VISIBILITY_VISIBLE="visibility-visible",e.REQUEST_RESIZE_GAME="request-resize-game",e.REQUEST_QUALITY_UPGRADED="request-quality-upgraded",e.REQUEST_QUALITY_DOWNGRADED="request-quality-downgraded",e))(Ni||{}),pe=Ni}),Zd=Tm((e,t)=>{"use strict";s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var r=Object.prototype.hasOwnProperty,n="~";function y(){}Object.create&&(y.prototype=Object.create(null),new y().__proto__||(n=!1));function f(v,D,I){this.fn=v,this.context=D,this.once=I||!1}function w(v,D,I,E,b){if(typeof I!="function")throw new TypeError("The listener must be a function");var T=new f(I,E||v,b),U=n?n+D:D;return v._events[U]?v._events[U].fn?v._events[U]=[v._events[U],T]:v._events[U].push(T):(v._events[U]=T,v._eventsCount++),v}function A(v,D){--v._eventsCount===0?v._events=new y:delete v._events[D]}function x(){this._events=new y,this._eventsCount=0}x.prototype.eventNames=function(){var v=[],D,I;if(this._eventsCount===0)return v;for(I in D=this._events)r.call(D,I)&&v.push(n?I.slice(1):I);return Object.getOwnPropertySymbols?v.concat(Object.getOwnPropertySymbols(D)):v},x.prototype.listeners=function(v){var D=n?n+v:v,I=this._events[D];if(!I)return[];if(I.fn)return[I.fn];for(var E=0,b=I.length,T=new Array(b);E<b;E++)T[E]=I[E].fn;return T},x.prototype.listenerCount=function(v){var D=n?n+v:v,I=this._events[D];return I?I.fn?1:I.length:0},x.prototype.emit=function(v,D,I,E,b,T){var U=n?n+v:v;if(!this._events[U])return!1;var _=this._events[U],ue=arguments.length,Ft,K;if(_.fn){switch(_.once&&this.removeListener(v,_.fn,void 0,!0),ue){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,D),!0;case 3:return _.fn.call(_.context,D,I),!0;case 4:return _.fn.call(_.context,D,I,E),!0;case 5:return _.fn.call(_.context,D,I,E,b),!0;case 6:return _.fn.call(_.context,D,I,E,b,T),!0}for(K=1,Ft=new Array(ue-1);K<ue;K++)Ft[K-1]=arguments[K];_.fn.apply(_.context,Ft)}else{var Ng=_.length,Br;for(K=0;K<Ng;K++)switch(_[K].once&&this.removeListener(v,_[K].fn,void 0,!0),ue){case 1:_[K].fn.call(_[K].context);break;case 2:_[K].fn.call(_[K].context,D);break;case 3:_[K].fn.call(_[K].context,D,I);break;case 4:_[K].fn.call(_[K].context,D,I,E);break;default:if(!Ft)for(Br=1,Ft=new Array(ue-1);Br<ue;Br++)Ft[Br-1]=arguments[Br];_[K].fn.apply(_[K].context,Ft)}}return!0},x.prototype.on=function(v,D,I){return w(this,v,D,I,!1)},x.prototype.once=function(v,D,I){return w(this,v,D,I,!0)},x.prototype.removeListener=function(v,D,I,E){var b=n?n+v:v;if(!this._events[b])return this;if(!D)return A(this,b),this;var T=this._events[b];if(T.fn)T.fn===D&&(!E||T.once)&&(!I||T.context===I)&&A(this,b);else{for(var U=0,_=[],ue=T.length;U<ue;U++)(T[U].fn!==D||E&&!T[U].once||I&&T[U].context!==I)&&_.push(T[U]);_.length?this._events[b]=_.length===1?_[0]:_:A(this,b)}return this},x.prototype.removeAllListeners=function(v){var D;return v?(D=n?n+v:v,this._events[D]&&A(this,D)):(this._events=new y,this._eventsCount=0),this},x.prototype.off=x.prototype.removeListener,x.prototype.addListener=x.prototype.on,x.prefixed=n,x.EventEmitter=x,typeof t<"u"&&(t.exports=x)}),Fg,Ur,Fn=F(()=>{"use strict";s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),Fg={_id:"",name:"",createdBy:"",description:"",expireTime:6048e5,type:"app_leaderboard",timezone:"utc+0",createdAt:"2024-01-01T09:00:00.000Z",sortOrder:"desc",statistics:"max",resettable:"manually",resetScore:0,numberOfLeaders:15,amountPlayer:15},Ur=Fg}),uu={};It(uu,{default:()=>Wg});var cu,Bg,Bn,Vg,Ug,Hg,Hr,Kr,Kg,jr,jg,lu,du,Vn,Wg,pu=F(()=>{"use strict";s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),Fn(),{Configs:{Mockup:{Leaderboards:{MinScore:cu,MaxScore:Bg,NumOfLeaders:Bn,ErrorRate:Vg,DefaultLimit:Ug,RandomDelayMs:Hg}}},Utils:{Valid:Hr,Browser:Kr,Time:Kg,Object:jr,Number:jg}}=Ludex,lu="LeadersMockKey",du="LeaderboardsMockKey",Vn=class{async getPlayers(e,t){if(await this.awaitRandomDelay(),this.randomResponseError("Get players error"))return{data:[]};let{playerIds:r}=t,n=[];if(r&&r.length>0){let y=this.getLeadersData(e);for(let f of r){let w=y[f];w&&n.push(w)}}return{data:n}}async getLeaders(e,t){if(await this.awaitRandomDelay(),this.randomResponseError("Get leaders error"))return{data:[]};let{limit:r,offset:n}=t,y=this.getLeadersData(e),f=jr.vals(y);this.sortLeadersRank(f);let w=[],A=n,x=r===0?Ug:n+r;for(let v=A;v<x;v++){let D=f[v];D&&w.push(D)}return this.sortLeadersRank(w),{data:w}}async getLeaderboardAsync(e){return await this.awaitRandomDelay(),this.randomResponseError("Get leaderboard error")?null:this.getLeaderBoard(e)||null}async getLeaderboardsAsync(e){if(await this.awaitRandomDelay(),this.randomResponseError("Get leaderboards error"))return[];let{limit:t=9999,type:r}=e;if(t<=0)return[];let n=this.getLeaderBoardsData(),y=jr.vals(n);return r===void 0?y.slice(0,t):y.filter(f=>f.type===r).slice(0,t)}getLeadersData(e){let t=this.getPlayersData(),r=Object.keys(t[e]),n={};for(let y of r){let f=t[e][y];Hr.isObject(f)&&(n[y]=f)}return n}sortLeadersRank(e){e.sort((t,r)=>parseInt(r.score,10)-parseInt(t.score,10)),e.forEach((t,r)=>{t.rank=r+1})}async setScoreAsync(e,t,r){if(await this.awaitRandomDelay(),this.randomResponseError("Set score error"))return null;let n={success:!1},y=this.getLeaderBoard(e);if(!y)return n;let f=this.getPlayersData(),w=f[e][t];w||(w=this.createPlayerData(t),y.amountPlayer+=1,y.numberOfLeaders+=1,this.writeLeaderBoard(e,y)),w.score=r.toString(),f[e][t]=w;let A=jr.vals(f[e]);return this.sortLeadersRank(A),A.forEach((x,v)=>{f[e][x.playerId]=x}),this.writePlayersData(e,f),n.success=!0,n}async createLeaderboard(e){if(await this.awaitRandomDelay(),this.randomResponseError("Create leaderboard error"))return null;let{_id:t}=e,r=this.getLeaderBoardsData();if(r[t])return r[t];let{numberOfLeaders:n}=e;return n=n??jg.random(Bn.Max-Bn.Min)+Bn.Min,this.createPlayersData(e,n),this.createLeaderboardData(e,n)}createLeaderboardData(e,t){let{_id:r}=e,n=R(S(S({},Ur),e),{createdAt:new Date().toISOString(),createdBy:"mock",numberOfLeaders:t,amountPlayer:t});return this.writeLeaderBoard(r,n),n}createPlayersData(e,t){let{_id:r,name:n}=e,y=n==="friends-leaderboard-key",f={[r]:{}},w=[];for(let A=0;A<t;A++){let x=y?`connected-player-${A}`:A.toString(),v=this.createPlayerData(x);w.push(v)}return this.sortLeadersRank(w),w.forEach((A,x)=>{f[r][A.playerId]=A}),this.writePlayersData(r,f),f}createPlayerData(e){return{playerId:e,score:this.randomScore(),rank:0}}randomScore(){return Math.floor(Math.random()*(Bg-cu)+cu).toString()}getLeaderBoardsData(){let e=Kr.getLocalStorage(du);return Hr.isObject(e)?e:{}}writeLeaderBoardsData(e){Hr.isObject(e)&&Kr.writeLocalStorage(du,e)}getLeaderBoard(e){let t=this.getLeaderBoardsData();return t[e]?t[e]:null}writeLeaderBoard(e,t){let r=this.getLeaderBoardsData();r[e]=t,this.writeLeaderBoardsData(r)}getPlayersData(){let e=Kr.getLocalStorage(lu);return Hr.isObject(e)?e:{}}writePlayersData(e,t){let r=this.getPlayersData();r[e]||(r[e]={}),jr.assign(r[e],t[e]),Kr.writeLocalStorage(lu,r)}randomResponseError(e){return Math.random()*100<Vg}async awaitRandomDelay(){await Kg.sleepAsync(Math.random()*Hg)}},Wg=Vn}),Wo,um,pm=F(()=>{"use strict";s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),Wo=class{options;performance;isRunning=!1;checkTimer;fpsHistory;actualFPS=0;constructor(e,t){this.options=t,this.performance=e}start=()=>{this.isRunning||(this.isRunning=!0,this.checkTimer=this.options.CheckInterval,this.fpsHistory=[])};stop=()=>{this.isRunning&&(this.isRunning=!1,this.options.OnlyUpdateWhenSwitchScene&&this.checkFps())};postStep=e=>{this.isRunning&&(this.checkTimer-=e,!(this.checkTimer>0)&&(this.checkTimer+=this.options.CheckInterval,this.fpsHistory.push(this.actualFPS),this.options.OnlyUpdateWhenSwitchScene||this.fpsHistory.length>=5&&this.checkFps()))};checkFps(){let{ads:e}=this.performance.codex;if(e.isAdFullSizeShowing()||this.fpsHistory.length===0)return;let t=!1;this.options.AutoUpgradeQuality&&this.isHighFps()&&(t=this.performance.upgradeGraphicsQuality()),this.isLowFps()&&(t=this.performance.downgradeGraphicsQuality()),t&&(this.fpsHistory=[])}getFpsMedian(){return this.getMedian(this.fpsHistory)}getMedian(e){if(e.length===0)return Number.NaN;let t=e.sort((n,y)=>n-y),r=Math.floor(t.length/2);return t.length%2===0?(t[r-1]+t[r])/2:t[r]}isLowFps(){return this.getFpsMedian()<this.options.FpsThreshold}isHighFps(){return this.getFpsMedian()>this.options.FpsThreshold*1.2}},um=Wo}),Tx,qo,mm,hm=F(()=>{"use strict";s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),ar(),pm(),{Utils:{Device:Tx}}=Ludex,qo=class extends Ludex.Plugins.BasePlugin{enabled=!1;quality;fpsTracker;pixelRatio;trackingSceneNames=[];configure(e){let{Enabled:t,Quality:r,Options:n,TrackingSceneNames:y}=e;this.enabled=t,this.quality=r,this.pixelRatio=Tx.pixelRatio(),this.trackingSceneNames=y,this.createFPSTracker(n)}trackingScene=e=>{this.trackingSceneNames.indexOf(e)<0||(this.stopFPSTracker(),this.startFPSTracker())};getCurrentQuality(){return this.pixelRatio}downgradeGraphicsQuality(){this.event.emit(pe.REQUEST_QUALITY_DOWNGRADED);let{Min:e,AdjustStep:t}=this.quality,r=this.pixelRatio;if(r<=e)return!1;let n=+(r-t).toFixed(2);return n<e?!1:(this.pixelRatio=n,this.resizeGameWorld(this.pixelRatio),!0)}upgradeGraphicsQuality(){this.event.emit(pe.REQUEST_QUALITY_UPGRADED);let{Max:e,AdjustStep:t}=this.quality,r=this.pixelRatio;if(r>=e)return!1;let n=+(r+t).toFixed(2);return n>e?!1:(this.pixelRatio=n,this.resizeGameWorld(this.pixelRatio),!0)}createFPSTracker(e){this.fpsTracker=new um(this,e)}get event(){return this.codex.event}startFPSTracker=()=>{this.fpsTracker.start()};stopFPSTracker=()=>{this.fpsTracker.stop()};resizeGameWorld(e){let t={forcePixelRatio:e};this.event.emit(pe.REQUEST_RESIZE_GAME,t)}updatePostStepDeltaTime(e){this.fpsTracker.postStep(e)}updateActualFPS(e){this.fpsTracker.actualFPS=e}},mm=qo}),fm={};It(fm,{default:()=>Ox});var Ox,ym=F(()=>{"use strict";s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),hm(),Ox=mm});s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),ar(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Ri=(e=>(e.DRAFT="draft",e.SINGLE="single",e.TOURNAMENT="tournament",e.MATCHING_GROUP="matching-group",e.CHALLENGE_FRIEND="challenge-friend",e))(Ri||{}),j=Ri,fh=j,nr=fh;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var yh=e=>e,ki=yh;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var gh=()=>{},Gi=gh,$i={asConst:ki,noop:Gi};s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Ph=(e,t)=>{if(e)return t<0?e[e.length+t]:e[t]},Fi=Ph;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var xh=(e,t)=>{let r=[];for(let n=0;n<e;n++)r.push(t(n));return r},sr=xh,wh=e=>sr(e,()=>{}),rt=wh,Ah=(e,t)=>{let r=Math.ceil(e.length/t);return rt(r).map((n,y)=>e.slice(y*t,y*t+t))},Bi=Ah;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var bh=(e,t)=>e.filter(r=>t.indexOf(r)<0),Vi=bh;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var vh=e=>e.reduce((t,r)=>t.concat(r),[]),Ui=vh;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Dh=(e,t)=>e.indexOf(t)>=0,Hi=Dh;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Sh=(e,t)=>e.slice(0,t),Ki=Sh;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Ih=(e,t)=>{for(let r=0;r<e.length;r++)if(t(e[r],r))return e[r]},or=Ih;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Lh=(e,t)=>{for(let r=0;r<e.length;r++)if(t(e[r],r))return r;return-1},ir=Lh;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Ch=e=>{for(let t=e.length-1;t>0;t--){let r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}},cr=Ch;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Eh=e=>{let t=[...e];return cr(t),t},ji=Eh;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Mh=(e,t,r)=>r.indexOf(e)===t&&e!==null&&e!==void 0,Th=e=>e.filter(Mh),Wi=Th,qi={at:Fi,chunk:Bi,difference:Vi,fillWith:sr,length:rt,limit:Ki,search:or,searchIndex:ir,has:Hi,shuffle:cr,toShuffled:ji,unique:Wi,flatten:Ui};s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Oh=()=>"OffscreenCanvas"in window&&typeof OffscreenCanvas<"u",_h=(e,t)=>{let r=new OffscreenCanvas(0,0),n=r.getContext(e,t);return n?{canvas:r,context:n}:null},Nh=(e,t)=>{let r=document.createElement("canvas"),n=r.getContext(e,t);return n?{canvas:r,context:n}:null},Rh=e=>{let{contextType:t="2d",contextAttributes:r={},type:n="auto"}=e,y=null;return n!=="canvas"&&Oh()&&(y=_h(t,r)),!y&&n!=="offscreen"&&(y=Nh(t,r)),y},at=Rh;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var kh=e=>!e||e===""||e===0||typeof e=="number"&&isNaN(e),lr=kh,Gh=e=>lr(e)?e!==!1&&e!==0:typeof e=="string"||Array.isArray(e)?e.length===0:typeof e=="object"&&e!==null?Object.keys(e).length===0:!1,nt=Gh,zi="Dinosaurs Merge Master",Ba={},dr=e=>nt(e)?GameSDK.getSDKName()??"Storage":e??"Storage",$h=e=>{let t=`${zi}_${e}`;return Ba[t]?Promise.resolve(Ba[t]):new Promise((r,n)=>{let y=1,f,w=A=>{f=indexedDB.open(zi,A),f.onerror=x=>{let v=x.target.error;v?.name==="VersionError"?(y++,w(y)):n(v)},f.onsuccess=x=>{let v=f.result;if(!v.objectStoreNames.contains(e)){y++,w(y);return}Ba[t]=v,r(v)},f.onupgradeneeded=x=>{let v=x.target.result;y=v.version,v.objectStoreNames.contains(e)||v.createObjectStore(e)}};w(y)})},ur=$h,Fh=async(e,t)=>{try{let r=dr(t),n=await ur(r);if(!n.objectStoreNames.contains(r))return{};let y=n.transaction(r,"readonly").objectStore(r);return new Promise((f,w)=>{let A=y.get(e);A.onerror=()=>w(A.error),A.onsuccess=()=>f(A.result)})}catch{return{}}},Yi=Fh;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Bh=e=>{try{return JSON.parse(e)}catch{return null}},st=Bh,Vh=e=>{try{let t=localStorage.getItem(e);return t===null?null:st(t)}catch{return null}},pr=Vh;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Uh=e=>{try{return JSON.stringify(e,null,0)}catch{return""}},ot=Uh,Hh=e=>st(ot(e)),mr=Hh,Kh=()=>{let e="en_US",t=mr(window.navigator.languages)||[],r=or(t,n=>n.indexOf("-")>-1);return!r||r.indexOf("-")===-1?e:r.replace("-","_")},Qi=Kh;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var jh=()=>{let e=window.location.search.substring(1);if(!e)return{};let t=e.split("&"),r={};for(let n of t){let y=n.split("=");r[y[0]]=decodeURIComponent(y[1])}return r},Ji=jh;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Wh=()=>{let{body:e,documentElement:t}=document,{clientHeight:r}=e,{clientHeight:n}=t;return Math.max(n,r)||0},Xi=Wh;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var qh=()=>{let{body:e,documentElement:t}=document,{clientWidth:r}=e,{clientWidth:n}=t;return Math.max(n,r)||0},Zi=qh;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var zh=e=>{localStorage.removeItem(e)},ec=zh;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Yh=async(e,t,r)=>{try{if(nt(t))return;let n=dr(r),y=await ur(n);if(!y.objectStoreNames.contains(n))return;let f=y.transaction(n,"readwrite").objectStore(n);return new Promise((w,A)=>{try{let x=f.put(t,e);x.onsuccess=()=>w(),x.onerror=()=>A(x.error)}catch(x){A(x)}})}catch{}},tc=Yh;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Qh=()=>{let e="vibrate"in window.navigator;if(e)try{window.navigator.vibrate(0)}catch{return!1}return e},Jh=e=>{try{return Qh()?(window.navigator.vibrate(0),window.navigator.vibrate(e),!0):!1}catch{return!1}},rc=Jh;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Xh=(e,t,r)=>{let n,y=!1;return function(...f){if(r&&!y){y=!0,e.apply(this,f);return}clearTimeout(n),n=setTimeout(()=>{e.apply(this,f)},t)}},Et=Xh;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Zh=e=>{let t=Object.create(null);return function(...r){let n=`__memoize__${JSON.stringify(r)}`;if(n in t)return t[n];let y=e.apply(this,r);return t[n]=y,y}},be=Zh;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var ef=(e,t,r)=>{let n,y=!1,f=!1;return function(...w){if(r&&!f){f=!0,e.apply(this,w);return}y&&(y=!1,e.apply(this,w)),clearTimeout(n),n=setTimeout(()=>{y=!0},t)}},Mt=ef;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var tf=(e,t)=>{let r=e.value;return e.value=async function(...n){await t.apply(this,n);let y=r.apply(this,n);return y instanceof Promise?await y:y},e},ac=tf;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var rf=e=>{if(e instanceof Error)return e;if(e!==null&&typeof e=="object"&&"message"in e&&typeof e.message=="string"){let t=new Error(e.message);return"stack"in e&&typeof e.stack=="string"&&(t.stack=e.stack),"name"in e&&typeof e.name=="string"&&(t.name=e.name),"code"in e&&typeof e.code=="string"&&Object.assign(t,{code:e.code}),t}if(e!==null&&typeof e=="object")try{return new Error(JSON.stringify(e,null,2))}catch{return new Error(`[Object conversion failed] ${String(e)}`)}return new Error(String(e))},me=rf,af=(e,t)=>{let r=e.value;return e.value=async function(...n){let y;try{let f=r.apply(this,n);return f instanceof Promise?await f:f}catch(f){y=me(f)}finally{t?.(y)}},e},nc=af;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var nf=e=>{let t=typeof e=="object"||typeof e=="function",r=Array.isArray(e);return e!==null&&t&&!r},H=nf,sc=(e,t)=>{if(typeof e!==t)throw new Error(`Value ${e} is not type of ${t} (${typeof e})`)},sf=(e,t,r)=>{let n;return r||sc(e,t),!H(e)||!r?e:Object.defineProperty(e,r,{get(){return n},set(y){sc(y,t),n=y}})},it=sf,of=(e,t)=>{let r=e.value;return e.value=function(...n){return t.forEach((y,f)=>{try{it(n[f],y)}catch(w){let A="[Decorator:validateParams]";throw w instanceof Error?(w.message=`${A}: ${w.message}`,w):new Error(`${A}: ${w}`)}}),r.apply(this,n)},e},oc=of;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var cf=(e,t)=>{for(let r of t)try{return it(e,r),!1}catch{}return!0},lf=(e,t)=>{let r=e.value;return e.value=function(...n){let y=r.apply(this,n);if(cf(y,t))throw new Error(`[Decorator:validateReturn] ${y} (${typeof y}) is not type of ${t.join(" | ")}`);return y},e},ic=lf,Va=class ce{static isProperty(t,r,n){return!!(n&&(typeof n.value<"u"||n.get||n.set))}static isFunction(t,r,n){return!!(n&&(typeof n.value=="function"||typeof n.initializer=="function"))}static trace=(t,r,n)=>{try{let{value:y,initializer:f,get:w,set:A}=n??{};try{if(!(w||A)&&typeof y!="function")if(typeof f=="function"){let x=f?.();if(typeof x!="function"&&typeof x>"u")throw new Error("Initializer returned undefined")}else if(y){let x=typeof y}else throw new Error("Unsupported decorator")}catch{}}catch{}finally{}return n};static locked(t,r,n){return R(S({},n),{value:()=>{throw new Error("Method is locked")}})}static preStart(t){return(r,n,y)=>ce.isFunction("preStart",n,y)?ac(y,t):y}static tryCatch(t){return(r,n,y)=>ce.isFunction("tryCatch",n,y)?nc(y,t):y}static debounce(t){return(r,n,y)=>{if(!ce.isFunction("debounce",n,y))return y;let f=y.value;return f?y.value=Et(f,t):y.initializer&&(f=y.initializer,y.initializer=function(){return Et(f.call(this),t)}),y}}static throttle(t){return(r,n,y)=>{if(!ce.isFunction("throttle",n,y))return y;let f=y.value;return f?y.value=Mt(f,t):y.initializer&&(f=y.initializer,y.initializer=function(){return Mt(f.call(this),t,!0)}),y}}static memoize(t,r,n){if(!ce.isFunction("memoize",r,n))return n;let y=n.value;return y?n.value=be(y):n.initializer&&(y=n.initializer,n.initializer=function(){return be(y.call(this))}),n}static validateValue(t){return(r,n,y)=>{if(!ce.isProperty("validateValue",n,y))return y;try{return it(r,t,n)}catch(f){return f instanceof Error,y}}}static validateReturn=(...t)=>(r,n,y)=>ce.isFunction("validateReturn",n,y)?ic(y,t):y;static validateParams=(...t)=>(r,n,y)=>ce.isFunction("validateParams",n,y)?oc(y,t):y},Tt=Va,df=()=>{self.onmessage=n=>{let{action:y,payload:f}=n.data;switch(y){case"drawImage":break;case"saveData":break;case"getData":break;default:}};function e(n){}function t(n){}function r(n){}},Ot=class Nn{worker=null;static _instance;constructor(){this.init()}static get inst(){return this._instance||(this._instance=new Nn),this._instance}init(){let t=new Blob([`(${df.toString()})()`],{type:"application/javascript"});this.worker=new Worker(URL.createObjectURL(t))}static postMessage(t,r){if(!this.inst.worker)throw new Error("Worker is not initialized");this.inst.worker.postMessage({action:t,payload:r})}};se([Tt.tryCatch()],Ot.prototype,"init",1),se([Tt.tryCatch()],Ot,"postMessage",1);var Ua=Ot,cc=Ua;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var uf=e=>e==null,lc=e=>{if(!H(e))return e;for(let t in e)if(uf(e[t]))delete e[t];else{let r=e[t];H(r)&&(e[t]=lc(r))}return e},hr=lc;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var dc=Object,pf=(e,t)=>{if("assign"in dc)return dc.assign(e,t);let r=e;for(let n in t)r[n]=t[n];return r},Le=pf,mf=e=>typeof e!="object"||e===null?null:Le(e,{}),fr=mf;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var uc=(e,t)=>{for(let r in t)H(e[r])&&H(t[r])?uc(e[r],t[r]):Le(e,{[r]:t[r]});return e},yr=uc,hf=(e,t)=>{try{let r=pr(e),n={};H(r)&&(n=r);let y=fr(t);if(!H(y))return!1;let f=hr(y),w=yr(n,f),A=ot(w);return localStorage.setItem(e,A),!0}catch{return!1}},pc=hf,mc={createCanvas:at,getLocale:Qi,getLocalStorage:pr,getQueryParams:Ji,getScreenHeight:Xi,getScreenWidth:Zi,writeLocalStorage:pc,vibrate:rc,getIndexedDB:Yi,WebWorker:cc,setIndexedDB:tc,removeKeyLocalStorage:ec};s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var ff=()=>window.devicePixelRatio??1,gr=ff,yf=e=>e*gr(),hc=yf;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var gf=()=>/Android/i.test(navigator.userAgent),fc=gf;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Pf=()=>!/Android|iPhone|iPad|iPod/i.test(navigator.userAgent),yc=Pf;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var xf=()=>/iPhone|iPad|iPod/i.test(navigator.userAgent),gc=xf;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var wf=()=>/Android|iPhone|iPad|iPod/i.test(navigator.userAgent),Pc=wf,xc={getPhysicPixels:hc,isDesktop:yc,isMobile:Pc,isAndroid:fc,isIOS:gc,pixelRatio:gr};s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Af=e=>[null,e],$e=Af;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var bf=e=>e[1]!==null,ct=bf;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var vf=e=>[e,null],xe=vf,Df=e=>t=>{if(ct(t))return t;try{return xe(e(t[0]))}catch(r){return $e(me(r))}},Pr=Df;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Sf=e=>async t=>{if(ct(t))return t;try{return xe(await e(t[0]))}catch(r){return $e(me(r))}},xr=Sf;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var If=e=>{try{return xe(e())}catch(t){return $e(me(t))}},wc=If;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Lf=async e=>{try{return xe(await e())}catch(t){return $e(me(t))}},Ac=Lf;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Cf=e=>e[1],bc=Cf;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Ef=e=>e[0],vc=Ef;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Mf=e=>e[1]===null,Dc=Mf;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Tf=xe,Sc=Tf;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Of=(...e)=>t=>e.reduce((r,n)=>Pr(n)(r),t),Ic=Of;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var _f=(...e)=>async t=>{let r=t;for(let n of e)r=await xr(n)(r);return r},Lc=_f,Cc={apply:Pr,applyAsync:xr,applyImmediate:wc,applyImmediateAsync:Ac,lift:Sc,success:xe,pipe:Ic,pipeAsync:Lc,extractSuccess:vc,extractFailure:bc,isFailure:ct,isSuccess:Dc};s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),rr(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Nf=e=>{let t=e.map(r=>Promise.resolve(r).then(n=>({status:"fulfilled",value:n}),n=>({status:"rejected",reason:n})));return Promise.all(t)},Ec=Nf;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Rf=e=>typeof Promise.any=="function"?Promise.any(e):new Promise((t,r)=>{let n=[],y=0,f=w=>{if(!(w<e.length))if(n.length>0)t(n[0]);else{let A=new Error("All promises were rejected");A.errors=n,r(A)}};e.forEach((w,A)=>{w.then(x=>{n[A]=x,y++,f(y)}).catch(x=>{n[A]=x,y++,f(y)})})}),Mc=Rf;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var kf=async(e,t)=>{try{if(t){let r=new Promise((n,y)=>setTimeout(()=>y(new Error("Timeout")),t));return[await Promise.race([e,r]),null]}return[await e,null]}catch(r){return[null,me(r)]}},Tc=kf;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();function Ha(){let e={},t=n=>{let y=!1,f={release:()=>{y||(y=!0,r(n))}};return e[n]?new Promise(w=>{e[n].push(()=>w(f))}):(e[n]=[],Promise.resolve(f))},r=n=>{let y=e[n].shift();y?y():delete e[n]};return{use:t}}s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Gf=(e,t)=>{try{return e()}catch(r){try{return t()}catch{throw r}}},Oc=Gf;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var $f=async(e,t)=>{try{return await e()}catch(r){try{return await t()}catch{throw r}}},_c=$f;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Ff=e=>{let{generate:t,generateSeed:r=()=>Math.random()*1e6,seed:n=Date.now()}=e,y=n;return(...f)=>(y=r(y),t(y,...f))},Nc=Ff;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Rc=(e,t)=>{e.__proto__.valueOf=()=>t,e.__proto__.toString=()=>`${t}`},Bf=e=>e.constructor(R(S({},e),{__proto__:e.__proto__})),kc=e=>{let t=Object.keys(e);for(let r of t){let n=Object.getOwnPropertyDescriptor(e,r)?.value;if(H(n)){kc(n);continue}try{let y=n;Rc(y,n),Object.defineProperty(e,r,{enumerable:!1,configurable:!0,get(){return Bf(y)},set(f){Le(y,f),Rc(y,f)}})}catch{}}},Gc=kc;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Vf=(e,t,r=setTimeout)=>t<=0?Promise.resolve(e).then(n=>({status:"fulfilled",value:n})):Promise.race([Promise.resolve(e).then(n=>({status:"fulfilled",value:n})),new Promise(n=>r(()=>n({status:"timeout",duration:t,promise:e}),t))]),$c=Vf,Fc={debounce:Et,throttle:Mt,syncVars:Gc,memoize:be,retry:Oc,retryAsync:_c,allSettled:Ec,timeOut:$c,any:Mc,accessBlocker:tt,rng:Nc,handleAsync:Tc,toError:me,mutex:Ha};s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Uf=e=>{let t={};for(let r in e){let n=e[r];t[n]=r}return t},wr=Uf,Hf=be((e,t)=>{let r=e.toLowerCase();if(typeof e=="string"){let n=t[r];if(typeof n=="string")return n}return"?"}),Kf=be(e=>{let t=[],r=/:([A-Z0-9?]+)/gm,n=null;for(;n=r.exec(e),n!==null;)t.push(n[1]);return t}),jf=be(e=>{let t=[],r=/(\d+[A-Z?]|[A-Z?])/gm,n=null;for(;n=r.exec(e),n!==null;){let y=n[0];if(y.length>=2){let{length:f}=y,w=y.slice(0,f-1),A=y[f-1],x=rt(+w).map(()=>A);t.push(...x);continue}t.push(y)}return t}),Wf=(e,t)=>{let r=e,n=wr(t),y={},f=0,w=0,A=Kf(r);for(let x of A){f=0,w++,y[w]||(y[w]={});let v=jf(x);for(let D of v){f++;let I=Hf(D,n);y[w][f]=I}}return y},Bc=Wf;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var qf=(e,t)=>H(e)?typeof Object.hasOwn=="function"?Object.hasOwn(e,t):Object.prototype.hasOwnProperty.call(e,t):!1,oe=qf;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var zf=e=>typeof e=="string",Ar=zf,Yf=be((e,t)=>{if(!H(t)||!oe(t,e))return"?";let r=t[e];return typeof r=="string"?`${r.toUpperCase()}`:"?"}),Vc=(e,t,r=!1)=>{let n="";if(!H(e))return n;let y="",f=1;for(let w in e){if(!oe(e,w))continue;let A=e[w];if(H(A)){n+=`:${Vc(A,t,!0)}`;continue}if(!Ar(A))continue;let x=Yf(A,t);x===y?(f++,n=n.slice(0,-2)):f=1,n+=`${f}${x}`,y=x}return n=n.replace(/1([A-Z])/g,"$1"),n},Uc=Vc;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Qf=(e,t)=>{try{if(!e)return"";if(t){let r=atob(e),n=btoa(t);return r=r.replace(n,"="),atob(r)}return atob(e)}catch{return""}},Hc=Qf;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Jf=()=>({}),Ka={},_t=e=>(Ka[e]||(Ka[e]=Jf()),Ka[e]),Kc=(e,t)=>{let r=_t(t),n=Object.keys(r).length;r[e]=n+1},Xf=(e,t,r=1)=>{let n=e[0],y=[],f=_t(r);if(t)for(let x in t)Kc(x,r);for(let x=1;x<e.length;x++){let v=e[x],D=`${n}${v}`;x++,n=e[x],f[D]===void 0&&(Kc(D,r),f=_t(r))}n=e[0];let w=1,A=0;for(;w<e.length;){let x=e[w],v=`${n}${x}`,D=Zf(e.slice(A),f);if(D!==null){y.push(f[D]),w+=D.length-v.length,n="",A=w+1,w++;continue}f[v]===void 0?n=v:(y.push(f[v]),n="",A=w+1),w++}return y},Zf=(e,t)=>{let r=Object.keys(t);return r=r.filter(n=>e.indexOf(n)>-1&&e!==n),r.length===0?null:r.sort((n,y)=>y.length-n.length)[0]},jc=Xf;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var ey=e=>{let t={};for(let r in e)t[e[r]]=r;return t},ty=(e,t,r=1)=>{let n="",y="",f=_t(r);t&&(f=S(S({},t),f));let w=ey(f);for(let A in e){let x=e[A];w[x]!==void 0?n=w[x]:n="?",y+=n}return y},Wc=ty;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var ry=(e,t)=>{try{if(!e)return"";if(t){let r=btoa(e),n=btoa(t);return r=r.replace("=",n),btoa(r)}return btoa(e)}catch{return""}},qc=ry,zc={decodeMap:Bc,encodeMap:Uc,hashToString:Hc,stringToHash:qc,lwzCompress:jc,lwzDecompress:Wc};s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var ay=(e,t)=>{let r=e.split(","),n=r[0].match(/:(.*?);/);if(!n)return null;let y=n[1],f=atob(r[r.length-1]),w=f.length,A=new Uint8Array(w);for(;w--;)A[w]=f.charCodeAt(w);return new File([A],t,{type:y})},Yc=ay;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var ny=e=>new Promise((t,r)=>{let n=new FileReader;n.onloadend=()=>t(n.result),n.onerror=r,n.readAsDataURL(e)}),Qc=ny;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var lt=new Image,sy=(e,t=!0,r=!0)=>new Promise(n=>{t&&(lt=new Image),lt.onload=()=>{n(lt),r&&URL.revokeObjectURL(lt.src)},lt.onerror=()=>{n(null)},lt.src=URL.createObjectURL(e)}),Jc=sy;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var oy=async(e,t)=>{let r=await fetch(e).then(n=>n.blob()).catch(()=>null);return r?new File([r],t):null},Xc=oy;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var We=at({contextType:"2d",contextAttributes:{willReadFrequently:!0}}),iy=async e=>new Promise((t,r)=>{let n=new FileReader;n.onload=()=>t(n.result),n.onerror=r,n.readAsDataURL(e)}),cy=async(e,t="png")=>{let{width:r,height:n}=e;if(!r||!n)throw new Error("Element has no width or height");if(!We)throw new Error("Failed to create canvas");if(We.canvas.width=r,We.canvas.height=n,We.context.drawImage(e,0,0,r,n),We.canvas instanceof HTMLCanvasElement)return We.canvas.toDataURL(`image/${t}`,.85);let y=await We.canvas.convertToBlob({type:`image/${t}`});return iy(y)},Zc=cy;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var el=at({contextType:"2d",contextAttributes:{willReadFrequently:!0}}),ly=async(e,t="png")=>{try{if(!el)throw new Error("Failed to create canvas");let{canvas:r,context:n}=el;return r.width=e.width,r.height=e.height,n.drawImage(e,0,0,e.width,e.height),r instanceof HTMLCanvasElement?new Promise(y=>{r.toBlob(f=>y(f),`image/${t}`,.9)}):r.convertToBlob({type:`image/${t}`,quality:.9})}catch{return null}},tl=ly;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var dy=async e=>{if(!e)throw new Error("url is empty");try{let t=await fetch(e);if(!t.ok)throw new Error("Network response was not ok");return await t.blob()}catch(t){throw t instanceof Error?t:new Error("Failed to fetch image")}},rl=dy;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var uy=async e=>new Promise((t,r)=>{e||r(new Error("url is empty"));let n=new Image;n.crossOrigin="anonymous",n.onload=()=>{t(n)},n.onerror=y=>{r(y)},n.src=e}),al=uy;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var py=(e,t)=>{if(isNaN(e)||isNaN(t))throw new Error("width and height must be numbers");return{string:"+",style:`font-size: 1px; padding: ${Math.floor(t/2)}px ${Math.floor(e/2)}px;`}},my=(e,t=1)=>{let r=new Image;r.onload=function(){let n=this,y=n.width*t,f=n.height*t,w=py(y,f)},r.src=e},nl=my,sl={base64ToFile:Yc,blobToDataImage:Qc,blobToHtmlImage:Jc,blobUrlToFile:Xc,elementToBase64:Zc,elementToBlob:tl,fetchImage:rl,loadImage:al,logImage:nl};s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var ol={clone:mr,decode:st,encode:ot};s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var ja=class Xd{perf=null;static _inst;static get inst(){return this._inst||(this._inst=new Xd),this._inst}static setService(t){this.inst.perf=t??null}static measure(t){this.inst.perf?.measure(t)}static start(t){this.inst.perf?.start(t)}static stop(t){try{this.inst.perf?.stop(t)}catch{}}static putMetric(t,r,n=Date.now()){this.inst.perf?.putMetric(t,r,n)}static incMetric(t,r,n=1){this.inst.perf?.incrementMetric(t,r,n)}static putAttr(t,r,n){let y=n.slice(0,100);this.inst.perf?.putAttr(t,r,y)}static rmAttr(t,r){this.inst.perf?.removeAttr(t,r)}},il=ja,cl={Mark:il};s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var hy=(e,t)=>{if(typeof e!="number")return"0";let r=Ze(10,t),n=e,y=0;for(;n>=r;)n=Math.floor(n/1e3),y++;let f=n.toString(),w=["","K","M","B","T","Qa","Qi","Sx","Sp","Oc","No","Dc","Ud","Dd","Td","Qad","Qid","Sxd","Spd"][y];return`${f}${w}`},ll=hy;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var fy=(e,t,r="0")=>{let n=e.toString(),y=n.length;for(let f=0;f<t-y;f++)n=n+r;return n},dl=fy;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var yy=(e,t,r="0")=>{let n=e.toString(),y=n.length;for(let f=0;f<t-y;f++)n=r+n;return n},ul=yy;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var gy=(e,t)=>{let r=t?Math.random()>.5?1:-1:1;return Math.floor(Math.random()*e)*r},Nt=gy;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Py=e=>e>0?1:e<0?-1:e===0?0:Number.NaN,pl=Py;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var xy=(e,t)=>{let{fractionalDigits:r=0,startAbbreviate:n=1e3,abbreviateStep:y=3,maxLength:f=-1,removeLastZero:w=!0,suffixes:A=["","k","m","b","t","q"]}=t||{},x=f===-1?99999999:f;if(e>=n){let E=Math.floor(e/Ze(10,y)),b=Math.floor((E.toString().length-1)/y)+1,T=(e/Ze(Ze(10,y),b)).toFixed(r),U=x-A[b].length,_=T.substring(0,U);return(w?ml(_):_)+A[b]}let v=e.toFixed(r),D=x-A[0].length,I=v.substring(0,D);return w?ml(I):I+A[0]},ml=e=>{if(e.indexOf(".")<0)return e;for(let t=e.length-1;t>=0;t--){if(e[t]===".")return e.substring(0,t);if(e[t]!=="0")return e.substring(0,t+1)}return e},hl=xy,fl={getShortNumber:ll,sign:pl,padEnd:dl,padStart:ul,random:Nt,toAbbreviatedString:hl};s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var yl=e=>{let t=e.replace(/[-_\s.]+(.)?/g,(r,n)=>n?n.toUpperCase():"");return t.substring(0,1).toUpperCase()+t.substring(1)},br=e=>{let t=e.replace(/[-_\s.]+(.)?/g,(r,n)=>n?n.toUpperCase():"");return t.substring(0,1).toLowerCase()+t.substring(1)},Wa=e=>{let t={};for(let r in e){let n=e[r],y=br(r);Array.isArray(n)?t[y]=n.map(f=>typeof f=="object"?Wa(f):f):typeof n=="object"?t[y]=Wa(n):t[y]=e[r]}return t},gl=Wa;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Pl=(e,t)=>{let r={};for(let n in t)if(oe(t,n))if(oe(e,n)){let y=e[n],f=t[n];if(H(y)&&H(f)&&y!==null&&f!==null&&typeof y!="function"&&typeof f!="function"){let w=Pl(y,f);Object.keys(w).length>0&&(r[n]=w)}else Object.is(y,f)||(r[n]=f)}else r[n]=t[n];for(let n in e)oe(e,n)&&!oe(t,n)&&(r[n]=void 0);return r},xl=Pl;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var wl=(e,t)=>{let r={};for(let n in t)if(oe(t,n))if(H(t[n])&&t[n]!==null)if(H(e[n])&&e[n]!==null){if(typeof t[n]=="function")continue;let y=wl(e[n],t[n]);Object.keys(y).length>0&&(r[n]=y)}else oe(e,n)||(r[n]=Le({},t[n]));else oe(e,n)||(r[n]=t[n]);return r},Al=wl;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var wy=e=>["string","number","symbol"].indexOf(typeof e)>-1,vr=wy,Ay=(e,t)=>{let r={};for(let n of e){let y=n[t];vr(y)&&(r[y]=n)}return r},bl=Ay;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Dr=e=>e.replace(/([a-z])([A-Z])/g,"$1_$2").replace(/\s+/g,"_").toLowerCase(),qa=e=>{let t={};for(let r in e){let n=e[r],y=Dr(r);Array.isArray(n)?t[y]=n.map(f=>typeof f=="object"?qa(f):f):typeof n=="object"?t[y]=qa(n):t[y]=e[r]}return t},vl=qa;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var by=e=>Object.keys(e).map(t=>e[t]),Dl=by,Sl={assign:Le,camelCaseKeys:gl,clone:fr,clear:hr,diff:xl,hasOwn:oe,invert:wr,keyBy:bl,merge:yr,snakeCaseKeys:vl,vals:Dl,filterDeep:Al};s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Ya={};It(Ya,{Signal:()=>Sr,SignalAbortedError:()=>Rt,SignalController:()=>za}),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Rt=class extends Error{constructor(e="Signal aborted with no reason"){super(e),this.name="SignalAbortedStopped"}},Sr=class _g{state={type:"running"};callbacks=[];once(t){this.callbacks.push(t)}off(t){this.callbacks=this.callbacks.filter(r=>r!==t)}abort(t){let r=this.constructReason(t);this.state={type:"stopped",reason:r};for(let n of this.callbacks)n(r);this.callbacks=[]}get aborted(){return this.state.type==="stopped"}get reason(){if(this.state.type==="stopped")return this.state.reason}wrap(t){if(!this.aborted)return t}chain(t){t instanceof _g?t.once(r=>this.abort(r)):t.addEventListener("abort",()=>this.abort(t.reason),{once:!0})}promise(){return this.aborted?Promise.resolve(this.reason):new Promise(t=>{this.once(r=>t(r))})}constructReason(t){return t instanceof Error?t:typeof t=="string"?new Rt(t):new Rt}},za=class{signal;renew(){this.signal?.abort();let e=new Sr;return this.signal=e,e}abort(){this.signal?.abort()}promise(){return this.signal===void 0?Promise.resolve(void 0):this.signal.promise()}},Il=Ya;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var vy=e=>e&&e[0].toUpperCase()+e.slice(1),Ll=vy;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();function Dy(e,t=2){let r=[],n=e.split(" "),y=n.length;for(let f=y;f>=1;f--)for(let w=0;w<=y-f;w++){let A=n.slice(w,w+f).join(" ");e.split(A).length-1>=t&&r.indexOf(A)<0&&A.length>1&&r.push(A)}return r.sort((f,w)=>f.length-w.length)}var Cl=Dy;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var qe=null,Sy="Anonymous",Iy=async()=>{let e="https://randommer.io/api/Name",{RandomNameApiKey:t}=Ludex.Configs.Mockup.Profile,r=await fetch(e,{method:"GET",headers:{"X-Api-Key":t,"Content-Type":"application/json"},body:JSON.stringify({nameType:"surname",quantity:1e3})});if(!r.ok)throw new Error("Can't fetch names");let n=await r.json();if(!H(n)||!oe(n,"data")||!Array.isArray(n.data))throw new Error("Invalid names response");return n.data},Ly=async()=>{try{if(!qe&&(qe=await Iy(),!qe))throw new Error("Cannot fetch names");let e=qe[Nt(qe.length)],t=qe[Nt(qe.length)];return`${e} ${t}`}catch{return Sy}},El=Ly;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Cy=(e=16)=>{let t=y=>Math.floor(y).toString(e),r=t(Date.now()/1e3),n=Array(e+1).join(" ");return r+n.replace(/./g,()=>t(Math.random()*e))},Ml=Cy;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Ey=e=>{let t=e?e.split("_"):[],r=t.length>0?t[0]:"en_US";switch(r){case"id":case"in":r="id";break}return r},Tl=Ey;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var My=(e,t)=>{let r=e.split(" "),n=(r.length<=1?[...r]:[r[0],r.pop()]).join(" "),y=n.lastIndexOf(" ")||0,f=y>=0?y:t;return(n.length>t?n.substring(0,f):n).substring(0,t)},Ol=My;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Ty=e=>{let t=0;if(e.length===0)return t;for(let r=0;r<e.length;r++){let n=e.charCodeAt(r);t=(t<<5)-t+n,t=t&t}return t},_l=Ty;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Oy=(e,t)=>{for(let r=0;r<t.length;r++)if(e[r]!==t[r])return!1;return!0},Nl=Oy;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var _y=(e,t,r=" ")=>{let n=Math.floor(t);if(e.length>=n)return e;let y=n-e.length,f="";for(let w=0;w<y;w++)f+=r;return f.slice(0,y)+e},Rl=_y;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Ny=e=>Object.keys(e).reduce((t,r)=>{let n=e[r];return n!==void 0&&t.push(`${r}=${n}`),t},[]).join("&"),kl=Ny;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Ry=(e,t)=>{let r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789*#%&!",n="",y=e;t!==void 0&&(y-=t.length,n+=t);for(let f=0;f<y;f++){let w=Math.floor(Math.random()*r.length);n+=r.charAt(w)}return n},Gl=Ry;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var ky="0123456789ABCDEF",Gy=(e="0x")=>{let t=e;for(let r=0;r<6;r++)t+=ky[Math.floor(Math.random()*16)];return t},$l=Gy;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var $y=e=>e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[]/g,t=>t==="\u0111"?"d":"D"),Fl=$y;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();function Ul(e){let t=Fy(e),r=t%Bl.length,n=(t>>8)%Vl.length,y=(t>>16)%1e4;return`${Bl[r]}${Vl[n]}${y}`}var Fy=e=>{let t=0;for(let r=0;r<e.length;r++){let n=e.charCodeAt(r);t=(t<<5)-t+n,t=t|0}return t=Math.abs(t),t},Bl=["James","Mary","John","Patricia","Robert","Jennifer","Michael","Linda","William","Elizabeth","David","Susan","Richard","Jessica","Joseph","Sarah","Thomas","Karen","Charles","Nancy","Christopher","Lisa","Daniel","Margaret","Matthew","Betty","Anthony","Sandra","Mark","Ashley","Donald","Dorothy","Steven","Kimberly","Paul","Emily","Andrew","Donna","Joshua","Michelle","Kenneth","Carol","Kevin","Amanda","Brian","Melissa","George","Deborah"],Vl=["Smith","Johnson","Williams","Jones","Brown","Davis","Miller","Wilson","Moore","Taylor","Anderson","Thomas","Jackson","White","Harris","Martin","Thompson","Garcia","Martinez","Robinson","Clark","Rodriguez","Lewis","Lee","Walker","Hall","Allen","Young","Hernandez","King","Wright","Lopez","Hill","Scott","Green","Adams","Baker","Gonzalez","Nelson","Carter","Mitchell","Perez","Roberts","Turner","Phillips","Campbell","Parker","Evans"],Hl={toCamelCase:br,toUpperCamelCase:yl,capitalize:Ll,generateObjectId:Ml,getLanguageCode:Tl,getShortName:Ol,hashCode:_l,matchStart:Nl,padStart:Rl,params:kl,random:Gl,randomColor:$l,removeDiacritics:Fl,findDuplicateSubstrings:Cl,generateNameAsync:El,toSnakeCase:Dr,generateNameUsingString:Ul};s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Kl=[60,3600,86400,86400*7,86400*30,86400*365,Number.POSITIVE_INFINITY],By=["second","minute","hour","day","week","month","year"],Vy=(e,t,r,n="Soon")=>{try{let y=t??"en",f=r??{numeric:"auto"},w=Math.round((e*1e3-Date.now())/1e3),A=Math.abs(Math.round((e*1e3-Date.now())/1e3)),x=ir(Kl,D=>D>A),v=x?Kl[x-1]:1;return new Intl.RelativeTimeFormat(y,f).format(Math.floor(w/v),By[x])}catch(y){if(n!==void 0)return"Soon";throw y}},jl=Vy;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Uy=e=>{let t=new Date(e),r=t.getUTCHours(),n=t.getUTCMinutes(),y=t.getUTCSeconds(),f=t.getUTCMilliseconds(),w=r<10?`0${r}`:`${r}`,A=n<10?`0${n}`:`${n}`,x=y<10?`0${y}`:`${y}`,v=`${f}`;return f<10?v=`00${f}`:f<100&&(v=`0${f}`),`${w}:${A}:${x}:${v}`},Wl=Uy;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Hy=e=>{let t=new Date(e),r=new Date;return t.getDate()===r.getDate()&&t.getMonth()===r.getMonth()&&t.getFullYear()===r.getFullYear()},ql=Hy;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Ky=e=>new Promise(t=>setTimeout(t,e)),zl=Ky,Yl={isToday:ql,sleepAsync:zl,getRelativeTime:jl,getTimeString:Wl};s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var jy=e=>typeof e=="boolean",Ql=jy;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Wy=()=>!!codex?.player?.getPlayerDataByKey("debug"),Jl=Wy;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var qy=e=>typeof e=="function",Ir=qy;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var zy=e=>typeof e=="number",Xl=zy;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Yy=e=>Ir(e)?e instanceof Promise||"then"in e&&typeof e.then=="function"?!0:e.constructor.name==="AsyncFunction":!1,Zl=Yy;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Qy=(e,t,r)=>{let{timeout:n=1e3,checkInterval:y=16}=r??{},f,w;return new Promise((A,x)=>{if(typeof e!="function")throw new Error("Input from must be a function");w=setInterval(()=>{let v=e(),D=typeof t=="function"?t():t;v===D&&(clearTimeout(f),clearInterval(w),A(!0))},y),n>0&&(clearTimeout(f),f=setTimeout(()=>{clearInterval(w),x(new Error("Timeout"))},n))})},ed=Qy,td={isBoolean:Ql,isDebugger:Jl,isEmpty:nt,isFalsy:lr,isFunction:Ir,isNumber:Xl,isObject:H,isPromise:Zl,isPropertyKey:vr,isString:Ar,isValueChangeAsync:ed},Jy={Array:qi,Browser:mc,Decorator:Tt,Device:xc,Function:Fc,Hash:zc,Image:sl,Json:ol,Mark:cl.Mark,Object:Sl,Signal:Il,String:Hl,Number:fl,Time:Yl,Valid:td,Error:Cc},rd=Jy,Xy=Object.preventExtensions({Dtos:{},Utils:Object.freeze(rd),Match:Object.freeze({Modes:Object.freeze(nr)}),Events:Object.freeze(pe),Configs:Object.seal(P),Plugins:Object.seal({Ads:null,Audio:null,Analytics:null})});window.Ludex=Xy,window.TypeGuard=$i,window.GameName="Dinosaurs Merge Master",window.CommitId="6e5998fb",window.BuildVersion="0",s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Valid:dt,Object:ze,String:Qa,Json:ad}=Ludex.Utils,kt="is invalid",Ja=class ae{static strict={};static data={};static addDefaultData(t){dt.isObject(t)||this.prototype.e("default data",kt),t=ad.clone(t);let{name:r}=this;dt.isObject(ae.data[r])||(ae.data[r]={}),ae.data[r]=ze.merge(ae.data[r],t)}static getDefaultData(){let{name:t}=this;return ad.clone(ae.data[t])}static addValidateFunction(t,r){dt.isString(t)||this.prototype.e("validate key",kt),typeof r!="function"&&this.prototype.e("validate function",kt);let n=`validate${Qa.capitalize(t)}`;ze.assign(this.prototype,{[n]:r})}constructor(t){this.ke(),this.processData(t)}static makeStrict(){ae.strict[this.name]=!0}static makeLoose(){ae.strict[this.name]=!1}processData(t){this.d(t),this.h(t),this.setupData(t)}ke(){let{name:t}=this.constructor;this.Ge(ae.data[t])}Ge(t){dt.isObject(t)||this.e("data",kt);for(let r in t)if(ze.hasOwn(t,r)){let n=t[r];ze.assign(this,{[r]:n})}}p(t){dt.isObject(t)||this.e("structure","is not object");let r=this.getKeys();for(let n of r){let y=this[n];y===void 0&&this.e("structure",`has no key ${n}`),!ze.hasOwn(t,n)&&y!==void 0&&this.ae(n,t)}}ae(t,r){dt.isObject(r)||this.e("data",kt);let n=this[t];n===void 0&&this.e("default",`has no key ${t}`),ze.assign(r,{[t]:n})}g(t){let r=this.getKeys();for(let n of r){let y=t[n],f=Qa.removeDiacritics(n).replace(/[^a-zA-Z0-9]/g,""),w=`validate${Qa.capitalize(f)}`,A=this[w];if(typeof A=="function")try{A.call(this,y)}catch(x){if(ae.strict[this.constructor.name])throw x;this.ae(n,t)}else this.e("validate",`has no function ${w}`)}}f(t){let r=this.getKeys();for(let n of r){let y=t[n];ze.assign(this,{[n]:y})}}e(t,r){throw new Error(`${this.constructor.name}: ${t} ${r}`)}toObject(){let t={},r=Object.keys(this),n,y;for(n=0;n<r.length;n++)y=r[n],y!=="toObject"&&(t[y]=this[y]);return t}getKeys(){return Object.keys(this).filter(t=>t!=="toObject"&&t!=="strict")}},ee=Ja;Ludex.Dtos={Base:ee},s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Xa=class{codex;plugins;constructor(e){this.codex=e,this.plugins={}}install(e,t,r,n){if(typeof t!="function"){GameSDK.getSDKName();return}let y=new t(this.codex);this.plugins[e]=y,r&&Object.defineProperty(this.codex,n,{get:()=>y}),y.init()}get(e){return this.plugins[e]}},nd=Xa;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Za=class{codex;constructor(e){this.codex=e}init(){}},sd=Za,en=class{codex;plugins;ads;auth;audio;event;match;player;profile;context;storage;language;missions;analytics;visibility;leaderboard;dailyRewards;remoteConfig;frameCapture;firebase;monitorError;adaptivePerformance;inputRecorder;console;profiler;canvasRecorder;constructor(){this.codex=this,this.plugins=new nd(this.codex)}async boot(){}async start(){}getBuildVersion(){return 0}};window.Ludex.Plugins={BasePlugin:sd};var od=en;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var tn=class extends Error{payload;constructor(e,t){super(e),this.name="BadRequest",this.message=e??"This request is bad",this.payload=t}},Lr=tn;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var rn=class extends Error{payload;constructor(e,t){super(e),this.name="RequestTimeout",this.message=e??"This request is timeout",this.payload=t}},Cr=rn,{Utils:{Valid:Zy,Time:eg},Configs:{AppId:id,Network:an}}=Ludex,tg=e=>{if(!e.ok)throw new Lr(void 0,{response:e})},cd=()=>{let e=codex.auth.getToken();return{token:e,timeout:an.Timeout,headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}}},ld=(e,t,r,n)=>async()=>{try{if(!id)throw new Lr("AppId is not defined");let y=`${e}/apps/${id}/${t}`,f=new AbortController;r.signal=f.signal;let w=setTimeout(()=>{f.abort()},r.timeout);Zy.isObject(n)&&(r.body=JSON.stringify(n));let A=await fetch(y,r);return clearTimeout(w),tg(A),await A.json()||{}}catch(y){if(y instanceof Lr)return null;throw y instanceof Object&&"name"in y&&y.name==="AbortError"?new Cr:y}},nn=async(e,t)=>{try{return e()}catch(r){if(r instanceof Cr&&t>0)try{return await eg.sleepAsync(600),await nn(e,t-1)}catch{return{}}return r instanceof Cr?{}:{}}},Re=async(e,t,r,n=an.Retries)=>{try{let y=R(S(S({},cd()),t),{method:"GET"}),f=ld(r,e,y);return await nn(f,n)}catch{return{}}},he=async(e,t,r,n,y=an.Retries)=>{try{let f=R(S(S({},cd()),r),{method:"POST"}),w=ld(n,e,f,t);return await nn(w,y)}catch{return{}}},{Configs:{Notification:{ApiUrl:rg}},Utils:{Object:ag}}=Ludex,dd=async e=>{if(!ag.hasOwn(e,"playerId"))throw new Error("Missing playerId");let{playerId:t}=e;await he(`players/${t}`,e,{},rg,10)};s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var ng={score:"score",settings:"settings",isFirstLogin:"isFirstLogin",gameData:"gameData",missionsData:"missionsData",notificationData:"notificationData",dailyRewardedData:"dailyRewardedData",lastCallSwitchGame:"lastCallSwitchGame",remoteConfig:"remoteConfig"},ud=ng;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var sg={ASID:null,playerId:"0000",name:"Guest",photo:"",locale:"en_US",connectedPlayers:{},data:{score:0,isFirstLogin:!0,settings:{sound:!0,music:!0,vibrate:!0,language:"en"},gameData:{coins:0,level:1},notificationData:{D1:{arrivalDate:0},D2:{arrivalDate:0},D3:{arrivalDate:0},D4:{arrivalDate:0},D5:{arrivalDate:0},D6:{arrivalDate:0},D7:{arrivalDate:0}},missionsData:{process:{}},lastCallSwitchGame:0}},Pe=sg,{Valid:Gt}=Ludex.Utils,{playerId:og,name:ig,photo:cg,locale:lg}=Pe,$t="is invalid",Er=class extends ee{setupData(e){this.f(e)}d(e){this.p(e)}h(e){this.g(e)}validateId(e){(!Gt.isString(e)||!e)&&this.e("_id",$t)}validatePlayerId(e){(!Gt.isString(e)||!e)&&this.e("playerId",$t)}validateName(e){(!Gt.isString(e)||!e)&&this.e("name",$t)}validatePhoto(e){Gt.isString(e)||this.e("photo",$t)}validateLocale(e){(!Gt.isString(e)||!e)&&this.e("locale",$t)}toObject(){return super.toObject()}};Er.addDefaultData({playerId:og,name:ig,photo:cg,locale:lg});var ut=Er,dg=new ut({playerId:"10",name:"Your Friend"}).toObject(),ie=dg;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var sn=class extends Error{code;constructor(e){super(e),this.code="CREATE_MATCH_FAILED"}},te=sn,on=class extends te{constructor(e){super(e),this.name="PlayerIdNotValid",this.message=e??"Player id is not valid"}},G=on,{Dtos:cn,Utils:{Array:ug,Object:pg,Json:N8,Valid:ln},Events:mg}=Ludex,dn=class{codex;constructor(e){this.codex=e}initContext=()=>{let e={contextId:GameSDK.context.getID()??"",contextType:GameSDK.context.getType(),entryPointData:GameSDK.getEntryPointData()},t=new cn.Context.Info(e),{contextId:r,contextType:n,entryPointData:y}=t.toObject();this.codex.context.receiveContext(r,n,y)};initPlayer=async()=>{try{let{player:e}=this.codex,t=this.getPlayerInfo(),r=ug.unique(pg.vals(ud)),n=await GameSDK.player.getDataAsync(r),y=new cn.Player.Data(n).toObject();e.receiveData(t,y)}catch{}finally{this.codex.event.emit(mg.PLAYER_INFO_LOADED)}};getPlayerInfo=()=>{try{let e=GameSDK.player.getID(),t=GameSDK.player.getName(),r=GameSDK.player.getPhoto(),n=GameSDK.getLocale();if(!ln.isString(e))throw new G;return ln.isString(t)||(t="You"),(!ln.isString(n)||!n)&&(n="en"),new cn.Player.Info({playerId:e,name:t,photo:r,locale:n}).toObject()}catch{return ie}}},pd=dn;ar(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var md=(e=>(e.IDLE="idle",e.LOADING="loading",e.FILLED="filled",e.SHOWING="showing",e))(md||{}),Mr=md;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var hd=(e=>(e.BANNER="banner",e.INTERSTITIAL="interstitial",e.REWARDED_VIDEO="rewarded_video",e.REWARDED_INTERSTITIAL="rewarded_interstitial",e))(hd||{}),ve=hd;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var un=class extends Error{code;constructor(e,t){super(t),this.code=e,this.message=t}},pt=un;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var pn=class{type;service;placementId;_status;constructor(e,t){this.type=e,this._status=Mr.IDLE,this.placementId=t}setStatus(e){this._status!==e&&(this._status=e)}get status(){return this._status}e(e){throw new pt("AD_INSTANCE_ERROR",e)}},fd=pn,mn=class extends fd{loadAsync(){this.e("This method is not implemented")}showAsync(){this.e("This method is not implemented")}hideAsync(){this.e("Unsupported method")}},yd=mn;Ludex.Plugins.Ads={Types:ve,Status:Mr,AdError:pt,AdInstance:yd};var{Utils:{Array:Tr,Object:gd,Function:hg}}=Ludex,hn=class extends Ludex.Plugins.BasePlugin{enabled;config;lastCallAdShownTime;isAdFullSizeShowed;ads={};safeAreaBottom;degradationTracking={failedAttempts:0,lastSuccessTime:0};init(){let e=Date.now()/1e3;this.lastCallAdShownTime={[ve.BANNER]:e,[ve.INTERSTITIAL]:e,[ve.REWARDED_VIDEO]:e,[ve.REWARDED_INTERSTITIAL]:e},this.isAdFullSizeShowed=!1,this.calculateSafeAreaBottom(),this.resetDegradationTracking()}calculateSafeAreaBottom(){try{let e=getComputedStyle(document.documentElement).getPropertyValue("--sab");this.safeAreaBottom=parseInt(e,10),isNaN(this.safeAreaBottom)&&(this.safeAreaBottom=0)}catch{this.safeAreaBottom=0}}configure(e){this.config=e,this.enabled=this.config.Enabled}checkEnabled(){if(!this.enabled)throw new pt("ADS_NOT_ENABLED","Ads is't enabled")}isAdFullSizeShowing(){return this.isAdFullSizeShowed}setAdInstance(e,t,r){let n=`${e}-${t}`;this.ads[n]||(this.ads[n]={type:e,placementId:t,interval:null,instance:new r(e,t)})}async loadAdAsync(e,t){this.checkEnabled();try{await this.getAd(e,t).instance.loadAsync()}catch(r){throw this.degradationTracking.failedAttempts++,r}}async showAdAsync(e,t){if(this.checkEnabled(),!this.canShowAd(e,t))return;let{event:r}=this.codex,n=this.getAd(e,t);try{r.emit(Ludex.Events.AD_SHOWING,{type:e,placementId:t}),this.isAdFullSizeShowed=!0,await n.instance.showAsync(),this.resetDegradationTracking(),this.lastCallAdShownTime[e]=Date.now()/1e3}catch(y){throw this.degradationTracking.failedAttempts++,y}finally{r.emit(Ludex.Events.AD_CLOSED,{type:e,placementId:t}),this.isAdFullSizeShowed=!1}}getAdStatus(e,t){return this.checkEnabled(),this.getAd(e,t).instance.status}getAd(e,t){let r=null;if(t?r=this.getAdByPlacementId(t,e):r=this.getPriorityAdByType(e),!r)throw new pt("AD_INSTANCE_NOT_INITIATED","The instance ads not yet initiated");return r}getAdsByType(e){return gd.vals(this.ads).filter(t=>t.type===e)}getAdByPlacementId(e,t){let r=gd.vals(this.ads);return Tr.search(r,y=>y.placementId===e&&(!t||y.type===t))||null}getPriorityAdByType(e){let t=this.getAdsByType(e);return t.length&&Tr.search(t,n=>n.type===e)||null}canShowAd(e,t){return this.canShowAdByTime(e,t)}canShowAdByTime(e,t){try{let r=Date.now()/1e3,n;if(t)n=this.getCommonAdConfig(t);else{let v=this.getPriorityAdByType(e);if(!v)return!1;n=this.getCommonAdConfig(v.placementId)}let{SecondsBetweenAds:y,SecondsFirstTime:f}=n,w=r-this.lastCallAdShownTime[e],A=w>y,x=w>f;return this.lastCallAdShownTime[e]>0?A:x}catch{return!1}}canShowBannerAd(e){try{let t=this.getBannerConfig(e),{Platform:r}=t;if(r==="ALL")return!0;let n=GameSDK.getPlatform();return n?n===r:!1}catch{return!1}}async showBannerAdAsync(e,t=!0){this.checkEnabled();let r=this.getAd(ve.BANNER,e);if(!this.canShowBannerAd(r.placementId))throw new Error("Banner ad can not be shown");this.cleanBannerReloadTimer(r),t?await this.showBannerAdWithSchedule(r):await this.showBannerAdOnce(r)}async showBannerAdOnce(e){let{event:t}=this.codex;if(!this.isAdFullSizeShowing())try{await e.instance.loadAsync(),await e.instance.showAsync(),t.emit(Ludex.Events.AD_SHOWING,{type:ve.BANNER,placementId:e.placementId})}catch(r){let n=hg.toError(r);if(n.code!=="AD_NOT_FILLED")try{await e.instance.hideAsync()}catch{}t.emit(Ludex.Events.AD_FAILED,{type:ve.BANNER,placementId:e.placementId,error:n})}}async showBannerAdWithSchedule(e){await this.showBannerAdOnce(e);let t=this.getBannerConfig(e.placementId),{SecondsReload:r}=t;if(r<=0||!r)return;let n=()=>this.showBannerAdWithSchedule(e);e.interval=setTimeout(n,r*1e3)}async hideBannerAdAsync(e){this.checkEnabled();let t=this.getAd(ve.BANNER,e);this.cleanBannerReloadTimer(t),await t.instance.hideAsync();let{event:r}=this.codex;r.emit(Ludex.Events.AD_CLOSED,{type:ve.BANNER,placementId:e})}cleanBannerReloadTimer(e){try{let{interval:t}=e;if(!t)return;clearInterval(t)}catch{}}getCommonAdConfig(e){let t=[...this.config.InterstitialAdOptions,...this.config.RewardedVideoAdOptions,...this.config.RewardedInterstitialAdOptions],r=Tr.search(t,n=>n.PlacementId===e);if(!r)throw new Error(`Ad config with placementId ${e} not found`);return r}getBannerConfig(e){let t=Tr.search(this.config.BannerDisplayAdOptions,r=>r.PlacementId===e);if(!t)throw new Error(`Banner config with placementId ${e} not found`);return t}getBannerHeight(e,t,r=!0){this.checkEnabled();let n=this.getBannerConfig(e),y=GameSDK.getBannerHeight(n);return r?(this.safeAreaBottom<=0&&this.calculateSafeAreaBottom(),(y+this.safeAreaBottom)*t):y*t}getSafeAreaBottom(e){return this.safeAreaBottom<=0&&this.calculateSafeAreaBottom(),this.safeAreaBottom*e}resetDegradationTracking(){this.degradationTracking={failedAttempts:0,lastSuccessTime:Date.now()}}isServiceDegraded(){let e=Date.now(),{MaxFailedAttempts:t,ResetTimeMinutes:r}=this.config.DegradationTracking,{lastSuccessTime:n,failedAttempts:y}=this.degradationTracking;return e-n>r*60*1e3&&this.resetDegradationTracking(),y>=t}},Pd=hn,xd=Pd;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var fg={APP_LAUNCH:"app_launch",APP_INITIALIZED:"app_initialized",ENGINE_READY:"engine_ready",LOAD_START:"load_start",LOAD_COMPLETE:"load_complete",APP_READY:"app_ready",PAGE_VIEW:"page_view",SCREEN_OPEN:"screen_open",BUTTON_CLICK:"button_click",TUTORIAL_BEGIN:"tutorial_begin",TUTORIAL_STEP:"tutorial_step",TUTORIAL_COMPLETE:"tutorial_complete",MATCH_START:"match_start",MATCH_RESCUE:"match_rescue",MATCH_END:"match_end",LEVEL_START:"level_start",LEVEL_RESCUE:"level_rescue",LEVEL_END:"level_end",USE_ITEM:"use_item",EARN_ITEM:"earn_item",GET_FREE_ITEM:"get_free_item",SHARE:"share",INVITE:"invite",MESSAGE:"message",SHORTCUT_CREATE:"shortcut_create",SHORTCUT_CREATE_POPUP:"shortcut_create_popup",BOT_SUBSCRIBE:"bot_subscribe",BOT_SUBSCRIBE_POPUP:"bot_subscribe_popup",AD_INIT:"ad_init",AD_LOAD:"ad_load",AD_LOAD_FAILED:"ad_load_failed",AD_SHOWING:"ad_showing",AD_SHOW:"ad_show",AD_SHOW_FAILED:"ad_show_failed",AD_REWARD:"ad_reward",NEW_USER:"new_user",RETURNING_USER:"returning_user",JOIN_GROUP:"join_group",TOURNAMENT_START:"tournament_start",TOURNAMENT_SHARE:"tournament_share",TOURNAMENT_CREATE:"tournament_create",TOURNAMENT_POST_SCORE:"tournament_post_score",SWITCH_GAME_POPUP:"switch_game_popup",SWITCH_GAME:"switch_game"},L=fg;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var fn=class{history=[];missing=[];outOfOrder=[];completed=!1;failed=!1;warned=[];debug=!1;restrict=!1;addEvent(e,t){if(this.completed||this.failed){this.debugLog("Skip event:",e);return}this.history.push(e),this.validateAndUpdate(e)}validateAndUpdate(e){let t=this.validateFunnelState();if(t.hasFailed){this.failed=!0,this.logValidationError();return}t.hasWarnings&&this.handleWarnings(t.warnings),this.checkFunnelCompletion(e)}validateFunnelState(){let e={hasFailed:!1,hasWarnings:!1,warnings:[]},t=this.getCurrentSteps().filter(n=>n.t);for(let n=0;n<t.length;n++){let y=t[n],f=this.history.indexOf(y.name);if(f===-1)return this.missing=[y.name],e.hasFailed=!0,e;if(n>0){let w=t[n-1];if(this.history.indexOf(w.name)>f)return this.missing=[w.name],e.hasFailed=!0,e}}let r=this.validateDependencies();return r.length>0&&(e.hasWarnings=!0,e.warnings=r,this.outOfOrder=r),e}getCurrentSteps(){let e=this.history[this.history.length-1],t=this.funnelSteps.findIndex(r=>r.name===e);return this.funnelSteps.slice(0,t+1)}validateDependencies(){let e=[];return this.history.forEach((t,r)=>{let n=this.funnelSteps.find(f=>f.name===t);if(!n?.r?.length)return;let y=n.r.find(f=>!this.history.includes(f)||this.history.indexOf(f)>r);y&&!this.warned.includes(t)&&(e.push({event:t,missingDependency:y}),this.warned.push(t))}),e}checkFunnelCompletion(e){let t=this.funnelSteps[this.funnelSteps.length-1];e===t.name&&this.funnelSteps.filter(r=>r.t).every(r=>this.history.includes(r.name))&&(this.completed=!0,this.logCompletion())}handleWarnings(e){for(let t of e);}logValidationError(){let e=this.constructor.name;if(this.missing.length,this.restrict)throw new Error(`[${e}] Funnel is required to be completed ! (missing: ${this.missing.join(", ")})`)}logCompletion(){let e=this.constructor.name,t=this.outOfOrder.length>0}debugLog(...e){this.debug}isFunnelCompleted(){return this.completed}isFunnelFailed(){return this.failed}getEventHistory(){return[...this.history]}getMissingEvents(){return[...this.missing]}getOutOfOrderEvents(){return[...this.outOfOrder]}},Ce=fn,yn=class extends Ce{debug=!1;funnelSteps=[{name:L.AD_INIT,t:!0,s:{service:"adsense"},a:"Init adsense ad"},{name:L.AD_LOAD_FAILED,t:!1,s:{service:this.service},a:"Platform ad load failed (trigger for adsense)"},{name:L.AD_LOAD,t:!0,s:{service:"adsense"},a:"Start loading adsense ad"},{name:L.AD_LOAD_FAILED,t:!1,r:[L.AD_LOAD],s:{service:"adsense"},a:"Adsense ad load failed"},{name:L.AD_SHOWING,t:!0,r:[L.AD_LOAD],s:{service:"adsense"},a:"Adsense ad is showing"},{name:L.AD_SHOW,t:!1,r:[L.AD_SHOWING],s:{service:"adsense"},a:"Adsense ad shown successfully"},{name:L.AD_SHOW_FAILED,t:!1,r:[L.AD_SHOWING],s:{service:"adsense"},a:"Adsense ad show failed"},{name:L.AD_LOAD,t:!1,s:{service:"adsense"},a:"Preload adsense ad"}];get service(){return GameSDK?.getSDKName()??"Ludex"}addEvent(e,t){let{service:r}=t??{};!r||!(r==="adsense"||e===L.AD_LOAD_FAILED&&r==="platform")||super.addEvent(e,t)}},wd=yn;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var gn=class extends Ce{debug=!1;restrict=!1;funnelSteps=[{name:L.ENGINE_READY,t:!1,a:"Game engine initialized"},{name:L.APP_LAUNCH,t:!0,a:"Application launched"},{name:L.APP_INITIALIZED,t:!0,r:[L.APP_LAUNCH],a:"Application initialized"},{name:L.LOAD_START,t:!0,r:[L.APP_INITIALIZED],a:"Start loading game assets"},{name:L.LOAD_COMPLETE,t:!0,r:[L.LOAD_START],a:"Game assets loaded completely"},{name:L.APP_READY,t:!0,r:[L.LOAD_COMPLETE],a:"Game is ready to play"}]},Ad=gn;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Match:{Modes:mt}}=Ludex,Pn=class extends Ce{debug=!1;funnelSteps=[{name:L.MATCH_START,t:!0,s:{game_mode:mt.SINGLE},a:"Match started"},{name:L.LEVEL_START,t:!0,r:[L.MATCH_START],s:{game_mode:mt.SINGLE},a:"Level started"},{name:L.LEVEL_RESCUE,t:!1,r:[L.LEVEL_START],s:{game_mode:mt.SINGLE},a:"User was rescued"},{name:L.LEVEL_END,t:!0,r:[L.LEVEL_START],s:{game_mode:mt.SINGLE},a:"Level ended"},{name:L.MATCH_END,t:!0,r:[L.LEVEL_START],s:{game_mode:mt.SINGLE},a:"Match ended"}];addEvent(e,t){let{game_mode:r}=t??{};!r||r.toLowerCase()!==mt.SINGLE||super.addEvent(e,t)}},bd=Pn;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var xn=class extends Ce{debug=!1;funnelSteps=[{name:L.AD_INIT,t:!0,s:{service:this.service},a:"Init platform ad"},{name:L.AD_LOAD,t:!0,s:{service:this.service},a:"Start loading platform ad"},{name:L.AD_LOAD_FAILED,t:!1,r:[L.AD_LOAD],s:{service:this.service},a:"Platform ad load failed"},{name:L.AD_SHOWING,t:!0,r:[L.AD_LOAD],s:{service:this.service},a:"Platform ad is showing"},{name:L.AD_SHOW,t:!1,r:[L.AD_SHOWING],s:{service:this.service},a:"Platform ad shown successfully"},{name:L.AD_SHOW_FAILED,t:!1,r:[L.AD_SHOWING],s:{service:this.service},a:"Platform ad show failed"},{name:L.AD_LOAD,t:!1,s:{service:this.service},a:"Preload platform ad"}];get service(){return"platform"}addEvent(e,t){t?.service===this.service&&super.addEvent(e,t)}},vd=xn;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Utils:{String:Ye,Valid:yg}}=Ludex,wn=class{codex;name;color;options;selfLog;currentPath;constructor(e,t,r){this.codex=e,this.name=t,this.options=r,this.color=r.color||"#FFF",this.selfLog=r.log,this.currentPath="/"}event(e,t){this.logInfo("event",{name:e,payload:t});let r=this.formatEventName(e);this.processEvent(r,t)}logInfo(e,t){this.selfLog}pageview(e){let t=this.getPageTitle(e);t=this.addGameModeToPageTitle(t),document.title=t,this.event(L.PAGE_VIEW,{page_path:e,page_title:t})}levelStart(e,t,r){this.event(L.LEVEL_START,{level:e,score:t,level_name:this.getLevelName(e),game_mode:r?Ye.toUpperCamelCase(r):void 0})}levelFail(e,t,r){this.event(L.LEVEL_END,{level:e,score:t,success:!1,level_name:this.getLevelName(e),game_mode:r?Ye.toUpperCamelCase(r):void 0})}levelRescue(e,t,r){this.event(L.LEVEL_RESCUE,{level:e,score:t,level_name:this.getLevelName(e),game_mode:r?Ye.toUpperCamelCase(r):void 0})}levelComplete(e,t,r){this.event(L.LEVEL_END,{level:e,score:t,success:!0,level_name:this.getLevelName(e),game_mode:r?Ye.toUpperCamelCase(r):void 0})}initAdEvent(e){let{adService:t,state:r}=e;this.event(L.AD_INIT,{ad_service:t,state:r})}loadAdEvent(e){let{type:t,placement:r,service:n}=e;this.event(L.AD_LOAD,{ad_type:t,screen_name:r,ad_service:n})}showAdEvent(e){let{type:t,placement:r,service:n}=e;this.event(L.AD_SHOW,{ad_type:t,screen_name:r,ad_service:n})}loadInterstitialAd(e){let{placement:t,service:r}=e;this.loadAdEvent({type:"interstitial",placement:t,service:r})}showInterstitialAd(e){let{placement:t,service:r}=e;this.showAdEvent({type:"interstitial",placement:t,service:r})}loadRewardedVideoAd(e){let{placement:t,service:r}=e;this.loadAdEvent({type:"rewarded_video",placement:t,service:r})}showRewardedVideoAd(e){let{placement:t,service:r}=e;this.showAdEvent({type:"rewarded_video",placement:t,service:r})}receiveVideoReward(e){let{placement:t,service:r}=e;this.event(L.AD_REWARD,{screen_name:t,ad_service:r})}loadRewardedInterstitialAd(e){let{placement:t,service:r}=e;this.loadAdEvent({type:"rewarded_interstitial",placement:t,service:r})}showRewardedInterstitialAd(e){let{placement:t,service:r}=e;this.showAdEvent({type:"rewarded_interstitial",placement:t,service:r})}receiveInterstitialReward(e){let{placement:t,service:r}=e;this.event(L.AD_REWARD,{screen_name:t,ad_service:r})}loadAdFail(e){let{type:t,placement:r,service:n}=e;this.event(L.AD_LOAD_FAILED,{ad_type:t,screen_name:r,ad_service:n})}showAdFail(e){let{type:t,placement:r,service:n}=e;this.event(L.AD_SHOW_FAILED,{ad_type:t,screen_name:r,ad_service:n})}showingAd(e){let{type:t,placement:r,service:n}=e;this.event(L.AD_SHOWING,{ad_type:t,screen_name:r,ad_service:n})}formatEventName(e){return e.toLowerCase().replace(/:/g,"_")}getLevelName(e){return`Level ${Ye.padStart(e.toString(),5,"0")}`}getPageTitle(e){let t=e.split("/").pop();if(!yg.isString(t))return e;let r=t.replace(/([-_\s.])/g," $1");return Ye.toUpperCamelCase(r)}addGameModeToPageTitle(e){let{match:t}=this.codex,r=t.getMatchState(),{mode:n}=r;return n||(n="Normal"),`${Ye.toUpperCamelCase(n)}::${e}`}},Dd=wn;Ludex.Plugins.Analytics={Events:L,BaseFunnel:Ce,BaseAnalytics:Dd};var An=class extends Ludex.Plugins.BasePlugin{analytics=[];placement="unknown";funnels=[];constructor(e){super(e),this.initFunnels()}add(e){let t=this.analytics.findIndex(r=>r.name===e.name);t!==-1?this.analytics[t]=e:this.analytics.push(e)}isActive(){return this.analytics.length>=1}initFunnels(){this.addFunnel(new Ad),this.addFunnel(new wd),this.addFunnel(new vd),this.addFunnel(new bd)}addFunnel(e){this.funnels.push(e)}i(e,t){for(let r of this.funnels)r.addEvent(e,t)}pageview=e=>{if(!this.isActive())return;this.placement=e;let t=this.getPageByKey(e);for(let r of this.analytics)r.pageview(t);this.i(L.PAGE_VIEW)};event(e,t){if(this.isActive()){for(let r of this.analytics)r.event(e,t);this.i(e,t)}}levelStart(e,t,r){if(this.isActive()){for(let n of this.analytics)n.levelStart(e,t,r);this.i(L.LEVEL_START,{score:t,game_mode:r})}}levelRescue(e,t,r){if(this.isActive()){for(let n of this.analytics)n.levelRescue(e,t,r);this.i(L.LEVEL_RESCUE,{score:t,game_mode:r})}}levelFail(e,t,r){if(this.isActive()){for(let n of this.analytics)n.levelFail(e,t,r);this.i(L.LEVEL_END,{score:t,game_mode:r})}}levelComplete(e,t,r){if(this.isActive()){for(let n of this.analytics)n.levelComplete(e,t,r);this.i(L.LEVEL_END,{score:t,game_mode:r})}}async initAdEvent(e){if(this.isActive()){await new Promise(t=>{let{Events:r}=Ludex;this.codex.event.catchUp(r.GAME_READY,t)});for(let t of this.analytics)t.initAdEvent(e)}}loadInterstitialAd(e){if(!this.isActive())return;let t=R(S({},e),{placement:this.placement});for(let r of this.analytics)r.loadInterstitialAd(t);this.i(L.AD_LOAD,t)}showInterstitialAd(e){if(!this.isActive())return;let t=R(S({},e),{placement:this.placement});for(let r of this.analytics)r.showInterstitialAd(t);this.i(L.AD_SHOW,t)}loadRewardedVideoAd(e){if(!this.isActive())return;let t=R(S({},e),{placement:this.placement});for(let r of this.analytics)r.loadRewardedVideoAd(t);this.i(L.AD_LOAD,t)}showRewardedVideoAd(e){if(!this.isActive())return;let t=R(S({},e),{placement:this.placement});for(let r of this.analytics)r.showRewardedVideoAd(t);this.i(L.AD_SHOW,t)}receiveVideoReward(e){if(!this.isActive())return;let t=R(S({},e),{placement:this.placement});for(let r of this.analytics)r.receiveVideoReward(t);this.i(L.AD_REWARD,t)}loadRewardedInterstitialAd(e){if(!this.isActive())return;let t=R(S({},e),{placement:this.placement});for(let r of this.analytics)r.loadRewardedInterstitialAd(t);this.i(L.AD_LOAD,t)}showRewardedInterstitialAd(e){if(!this.isActive())return;let t=R(S({},e),{placement:this.placement});for(let r of this.analytics)r.showRewardedInterstitialAd(t);this.i(L.AD_SHOW,t)}receiveInterstitialReward(e){if(!this.isActive())return;let t=R(S({},e),{placement:this.placement});for(let r of this.analytics)r.receiveInterstitialReward(t);this.i(L.AD_REWARD,t)}loadAdFail(e){if(!this.isActive())return;let t=R(S({},e),{placement:this.placement});for(let r of this.analytics)r.loadAdFail(t);this.i(L.AD_LOAD_FAILED,t)}showAdFail(e){if(!this.isActive())return;let t=R(S({},e),{placement:this.placement});for(let r of this.analytics)r.showAdFail(t);this.i(L.AD_SHOW_FAILED,t)}showingAd(e){if(!this.isActive())return;let t=R(S({},e),{placement:this.placement});for(let r of this.analytics)r.showingAd(t);this.i(L.AD_SHOWING,t)}getPageByKey(e){let t=e;if(t.indexOf("_")>-1){let y=t.replace(/_/g,"-");return y=y.toLowerCase(),y}let r=t.length-1,n="";for(;r>0;){n=t.charAt(r);let y=isNaN(parseInt(n,10)),f=n===n.toUpperCase();y&&f&&(t=`${t.slice(0,r)}-${t.slice(r)}`),r--}return t.toLowerCase()}},Sd=An,Id=Sd;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var bn=class{key;constructor(e){this.key=e}getKey(){return this.key}},Ld=bn;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Decorator:Cd}=Ludex.Utils,Or=class{id;isMuteAll;masterVolume;audioClips;constructor(e){this.id=e,this.masterVolume=1,this.isMuteAll=!1,this.audioClips={}}getId(){return this.id}getAudioClip(e){return this.audioClips[e]?this.audioClips[e]:null}setAudioClip(e,t){this.audioClips[e]=S(S({},this.audioClips[e]),t)}async play(e,t){let r=this.getAudioClip(e);if(r){let{audioPlayer:n}=r;this.playWithRealConfig(n,t)}else await this.loadAndPlay(e,t)}async loadAndPlay(e,t){let r=await this.onLoadAudio(e,t);if(!r)return;let{volume:n=1}=t||{};this.setAudioClip(e,{volume:n,audioPlayer:r}),this.playWithRealConfig(r,t)}playWithRealConfig(e,t){if(t){let{volume:r=1}=t;t.volume=this.masterVolume*r}e.play(t)}pause(e){let t=this.getAudioClip(e);if(!t)return!1;let{audioPlayer:r}=t;return r.pause(),!0}resume(e){let t=this.getAudioClip(e);if(!t)return!1;let{audioPlayer:r}=t;return r.resume(),!0}stop(e){let t=this.getAudioClip(e);if(!t)return!1;let{audioPlayer:r}=t;return r.stop(),!0}stopAll(){this.callAudioPlayers("stop")}muteAll(){this.isMuteAll||(this.isMuteAll=!0,this.callAudioPlayers("mute"))}unmuteAll(){this.isMuteAll&&(this.isMuteAll=!1,this.callAudioPlayers("unmute"))}setVolume(e){this.masterVolume=e,this.callAudioPlayers("setVolume")}getVolume(){return this.masterVolume}queueAudioPlayer(e,t){try{let{audioPlayer:r,volume:n=1}=e;switch(t){case"play":r.play();break;case"pause":r.pause();break;case"resume":r.resume();break;case"stop":r.stop();break;case"mute":r.setVolume(0);break;case"unmute":case"setVolume":r.setVolume(this.masterVolume*n);break;default:throw new Error(`Unsupported function: ${t}`)}}catch{}}callAudioPlayers(e){let{Object:t}=Ludex.Utils,r=t.vals(this.audioClips);for(let n of r)this.queueAudioPlayer(n,e)}};se([Cd.tryCatch(),Cd.validateParams("string")],Or.prototype,"loadAndPlay",1);var Ed=Or;Ludex.Plugins.Audio={BaseAudioPlayer:Ld,BaseChannelManager:Ed};var{Decorator:Md}=Ludex.Utils,_r=class extends Ludex.Plugins.BasePlugin{firstChannelId;channels={};addChannel(e){let t=e.getId();this.channels[t]=e,this.firstChannelId||(this.firstChannelId=t)}getChannel(e){if(e===void 0)return this.channels[this.firstChannelId];let t=this.channels[e];if(!t)throw new Error(`Channel ${e} not found`);return t}async play(e,t,r){await this.getChannel(r).play(e,t)}pause(e,t){try{this.getChannel(t).pause(e)}catch{}}resume(e,t){try{this.getChannel(t).resume(e)}catch{}}stop(e,t){try{this.getChannel(t).stop(e)}catch{}}stopAll(e){try{this.getChannel(e).stopAll()}catch{}}mute(e){try{this.getChannel(e).muteAll()}catch{}}unmute(e){try{this.getChannel(e).unmuteAll()}catch{}}setVolume(e,t){try{this.getChannel(t).setVolume(e)}catch{}}getVolume(e){try{return this.getChannel(e).getVolume()}catch{return-1}}};se([Md.tryCatch(),Md.validateParams("string")],_r.prototype,"play",1);var Td=_r,Od=Td;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var gg={token:"",isRequesting:!1},_d=gg,{Utils:{Object:Pg}}=Ludex,vn=class extends Ludex.Plugins.BasePlugin{init(){let{storage:e}=this.codex;e.addStorage("auth",_d)}async requestToken(){let{storage:e}=this.codex;try{if(e.getStorageData("auth","isRequesting")||e.getStorageData("auth","token")!=="")return;e.setStorageData("auth","isRequesting",!0);let t=(await GameSDK.player.getSignedPlayerInfoAsync()).getSignature();e.setStorageData("auth","token",t)}catch(t){if(Pg.hasOwn(t,"code")&&t.code==="PENDING_REQUEST")return;e.setStorageData("auth","token","")}finally{e.setStorageData("auth","isRequesting",!1)}}getToken(){let{storage:e}=this.codex;return e.getStorageData("auth","token")??""}},Nd=vn,Rd=Nd;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var kd=(e=>(e.SOLO="solo",e.TOURNAMENT="tournament",e.SHARE_INVITE="share_invite",e.MATCHING_GROUP="matching_group_match",e.CHALLENGE_FRIEND="challenge_friend_match",e))(kd||{}),De=kd;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var xg=nr,ke=xg,{Configs:wg,Utils:{Array:Ag,Valid:bg,Browser:vg}}=Ludex,Dn=class{codex;constructor(e){this.codex=e}isValidContextType(e){return["THREAD","POST","SOLO","GROUP"].indexOf(e)>=0}isValidEntryPointData(e){return bg.isObject(e)}isTournamentEntryPoint(e){return Ag.has(["facebook~game_list~tournaments","fb_feed_tournament_unit","messenger~bot_thread~tournaments"],e)}receiveContext(e,t,r){let{storage:n}=this.codex;n.setStorageData("context","contextId",e),this.isValidEntryPointData(r)&&n.setStorageData("context","entryPointData",r),this.isValidContextType(t)&&n.setStorageData("context","contextType",t)}getContextId(){let{storage:e}=this.codex;return e.getStorageData("context","contextId")??""}getContextType(){let{storage:e}=this.codex;return e.getStorageData("context","contextType")??"SOLO"}getContextData(){let{storage:e}=this.codex;return e.getStorageData("context","entryPointData")??{}}getSessionContextType(){let{storage:e}=this.codex;return e.getStorageData("context","sessionContextType")??"unknown"}async detectContextSessionType(){let{storage:e}=this.codex,t=this.getContextData(),{type:r}=t??{},{SOLO:n,TOURNAMENT:y,MATCHING_GROUP:f,SHARE_INVITE:w,CHALLENGE_FRIEND:A}=De,x=n;r===y&&(x=y),r===f&&(x=f),(r===A||r===w)&&(x=A),x===n&&(wg.Core.FastCheckTournamentContext?x=this.fastCheckTournamentContext()||x:x=await this.outdatedCheckTournamentContext()||x),e.setStorageData("context","sessionContextType",x)}fastCheckTournamentContext(){let e=vg.getQueryParams().entry_point;return typeof e!="string"||!this.isTournamentEntryPoint(e)?!1:De.TOURNAMENT}async outdatedCheckTournamentContext(){let{storage:e}=this.codex;if(!("getTournamentAsync"in GameSDK))return!1;try{let t=await GameSDK.getTournamentAsync();return e.setStorageData("context","contextId",t.getContextID()),t.getEndTime()>Date.now()/1e3?De.TOURNAMENT:!1}catch{return!1}}detectContextGameMode(){let{player:e,storage:t}=this.codex,r=this.getContextData(),n=this.getSessionContextType(),y=e.getPlayerId(),{matchId:f,playerId:w,opponentId:A=ie.playerId}=r??{},x=y===w,v=A===ie.playerId||[A,w].indexOf(y)>=0,{TOURNAMENT:D,MATCHING_GROUP:I,SHARE_INVITE:E,CHALLENGE_FRIEND:b}=De,T=ke.SINGLE;n===D&&(T=ke.TOURNAMENT),n===E&&!x&&(T=ke.CHALLENGE_FRIEND),n===b&&f&&v&&(T=ke.CHALLENGE_FRIEND),n===I&&(T=ke.MATCHING_GROUP),t.setStorageData("context","contextGameMode",T)}},Gd=Dn;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Sn=class extends Error{constructor(e){super(e),this.name="PlayerHasFinishedMatch",this.message=e??"Player has finished match"}},Nr=Sn;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var In=class extends Error{constructor(e){super(e),this.name="PlayerNotJoinInMatch",this.message=e||"Player is not join in match"}},ht=In,{Events:Rr,Plugins:{Analytics:$d},Utils:{Valid:Dg}}=Ludex,Ln=class{codex;constructor(e){this.codex=e}async processContextData(){let{player:e,context:t}=this.codex,r=t.getContextId(),n=t.getContextData(),y=t.getSessionContextType(),{type:f,matchId:w,playerId:A,opponentId:x,playerScore:v,action:D}=n;D&&await this.processEntryPointAction(D);let I=e.isFirstSession();setTimeout(()=>{this.logUserAnalytics(I)},1e3);let{TOURNAMENT:E,SHARE_INVITE:b,MATCHING_GROUP:T,CHALLENGE_FRIEND:U}=De;if(y===E)try{await this.processTournamentModeAsync(r);return}catch{}if(y===U){if(f===b&&typeof A=="string"){await this.processChallengeFromPostAsync(A);return}if(f===U&&typeof w=="string"&&typeof A=="string"&&typeof x=="string"){await this.processChallengeFromMessageAsync({contextId:r,matchId:w,playerId:A,opponentId:x});return}}if(y===T&&typeof A=="string"&&typeof v=="number"){await this.processMatchingGroupModeAsync(A,v);return}if(I){await this.processSingleModeAsync(!0),e.loggedIn();return}this.switchToDashboardScene()}logUserAnalytics(e){try{let{player:t,analytics:r}=this.codex;if(e)r.event($d.Events.NEW_USER);else{let{coins:n}=t.getPlayerData().gameData;r.event($d.Events.RETURNING_USER,{coins:n})}}catch{}}async processEntryPointAction(e){try{let{player:t}=this.codex;switch(e){case"reset_data":t.setPlayerDataByName("score",0),t.setGameData({coins:0,level:1}),await t.syncProfileToServer();break;case"enable_debug":t.setPlayerDataByName("debug",!0);break;case"set_locale_en":this.requestSetLocale("en");break;case"set_locale_ru":this.requestSetLocale("ru");break}}catch{}}requestSetLocale(e){let{event:t}=this.codex;t.emit(Rr.REQUEST_LANGUAGE,{locale:e})}async processTournamentModeAsync(e){let{match:t,player:r}=this.codex,n=r.getPlayerId();if(Dg.isEmpty(e))throw new Error("Cannot get contextId");await t.tournament.continue.processAsync({playerId:n,contextId:e}),this.switchToGameScene()}async processChallengeFromPostAsync(e){let{match:t,player:r}=this.codex,n=r.getPlayerId();if(n===e)await t.single.start.processAsync({playerId:n});else try{await t.challenge.friend.processAsync({playerId:n,opponentId:e})}catch{await t.single.start.processAsync({playerId:n})}this.switchToGameScene()}async processChallengeFromMessageAsync(e){try{await this.processContinueChallengeFromMessageAsync(e)}catch(t){if(t instanceof Nr){await this.processAwaitChallengeFromMessageAsync(e);return}if(t instanceof ht){await this.processJoinChallengeFromMessageAsync(e);return}this.switchToDashboardScene()}}async processContinueChallengeFromMessageAsync(e){let{contextId:t,matchId:r,playerId:n,opponentId:y}=e,{match:f,player:w}=this.codex,A=w.getPlayerId();if(n===A)await f.challenge.continue.processAsync({contextId:t,matchId:r,playerId:A,opponentId:y});else{let x=y===ie.playerId;await f.challenge.continue.processAsync({contextId:t,matchId:r,playerId:A,opponentId:x?y:n})}this.switchToGameScene()}async processJoinChallengeFromMessageAsync(e){let{contextId:t,matchId:r,playerId:n}=e,{match:y,player:f}=this.codex,w=f.getPlayerId();await y.challenge.join.processAsync({contextId:t,matchId:r,playerId:w,opponentId:n}),this.switchToGameScene()}async processAwaitChallengeFromMessageAsync(e){let{contextId:t,matchId:r,playerId:n}=e,{match:y,player:f}=this.codex,w=f.getPlayerId();try{await y.challenge.await.processAsync({contextId:t,matchId:r,playerId:w,opponentId:n}),this.switchToChallengeResultScene()}catch{await this.processResultChallengeFromMessageAsync(e)}}async processResultChallengeFromMessageAsync(e){let{contextId:t,matchId:r,playerId:n}=e,{match:y,player:f}=this.codex,w=f.getPlayerId();try{await y.challenge.result.processAsync({contextId:t,matchId:r,playerId:w,opponentId:n}),this.switchToChallengeResultScene()}catch{this.switchToDashboardScene()}}async processMatchingGroupModeAsync(e,t){let{match:r,player:n}=this.codex;await r.group.join.processAsync({playerId:n.getPlayerId(),opponentId:e,opponentScore:t}),this.switchToGameScene()}async processSingleModeAsync(e){let{match:t,player:r}=this.codex,n=r.getPlayerId();e&&await t.handler.setMatchCustomData({playerId:n,contextId:"SOLO"}),await t.single.start.processAsync({playerId:n}),this.switchToGameScene()}switchToDashboardScene(){let{event:e}=this.codex;e.emit(Rr.SWITCH_SCENE,{sceneName:"DashboardScene",sceneData:{isFromLoader:!0}})}switchToGameScene(){let{event:e}=this.codex;e.emit(Rr.SWITCH_SCENE,{sceneName:"GameScene",sceneData:{isFromLoader:!0}})}switchToChallengeResultScene(){let{event:e}=this.codex;e.emit(Rr.SWITCH_SCENE,{sceneName:"ChallengeResultScene",sceneData:{isFromLoader:!0}})}},Fd=Ln;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Sg={processed:!1,contextId:"",contextType:"SOLO",entryPointData:{},contextGameMode:"",sessionContextType:""},kr=Sg,{Events:Gr,Utils:{Function:Bd}}=Ludex,Cn=class extends Ludex.Plugins.BasePlugin{context;loader;constructor(e){super(e),this.loader=new Fd(e),this.context=new Gd(e)}init(){let{storage:e}=this.codex;e.addStorage("context",kr)}getSessionContextTypes(){return De}async processContextData(){let{event:e,monitorError:t}=this.codex;e.catchUp(Gr.CONTEXT_SESSION_TYPE_DETECTED,async()=>{try{await this.loader.processContextData(),e.emit(Gr.CONTEXT_DATA_PROCESSED)}catch(r){this.switchToDashboardScene(),t?.sendException(Bd.toError(r))}})}async detectContextSessionType(){let{event:e,monitorError:t}=this.codex;try{await this.context.detectContextSessionType()}catch(r){t?.sendException(Bd.toError(r))}finally{e.emit(Gr.CONTEXT_SESSION_TYPE_DETECTED)}}detectContextGameMode(){this.context.detectContextGameMode()}receiveContext(e,t,r){this.context.receiveContext(e,t,r)}getContextId(){return this.context.getContextId()}getContextType(){return this.context.getContextType()}getContextData(){return this.context.getContextData()}getSessionContextType(){return this.context.getSessionContextType()}switchToDashboardScene(){let{event:e}=this.codex;e.emit(Gr.SWITCH_SCENE,{sceneName:"DashboardScene"})}},Vd=Cn;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Valid:En}=Ludex.Utils,{contextId:Ig,contextType:Lg,entryPointData:Cg}=kr,Mn="is invalid",$r=class extends ee{data;setupData(e){this.f(e)}d(e){this.p(e)}h(e){this.g(e)}validateContextId(e){En.isString(e)||this.e("contextId",Mn)}validateContextType(e){(!En.isString(e)||!e)&&this.e("contextType",Mn)}validateEntryPointData(e){En.isObject(e)||this.e("entryPointData",Mn)}toObject(){return super.toObject()}};$r.addDefaultData({contextId:Ig,contextType:Lg,entryPointData:Cg});var Ud=$r;Ludex.Dtos.Context={Info:Ud};var Hd=Vd;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Eg={0:{id:1,type:"coin",value:300},1:{id:2,type:"coin",value:500},2:{id:3,type:"coin",value:1e3},3:{id:4,type:"coin",value:2e3},4:{id:5,type:"coin",value:3e3},5:{id:6,type:"coin",value:5e3},6:{id:7,type:"coin",value:1e3}},Kd=Eg,{Object:Mg}=Ludex.Utils,Tn=class{async getDailyRewardsAsync(){return Mg.vals(Kd)}},jd=Tn;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Tg={REWARDED:"rewarded",SKIPPED:"skipped",READY:"ready",WAITING:"waiting"},fe=Tg;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Og={dailyRewards:{}},Wd=Og,{Configs:{DailyRewards:{CheckInterrupt:qd,MaxDays:zd,MockTime:Yd}},Utils:{Array:On,Valid:Qe}}=Ludex,Fr=Yd>0?Yd:864e5,_n=class extends Ludex.Plugins.BasePlugin{dailyRewardsApi=new jd;init(){let{storage:e}=this.codex;e.addStorage("dailyRewards",Wd)}async requestDailyRewardsAsync(){let e=await this.dailyRewardsApi.getDailyRewardsAsync(),{logs:t,rewards:r}=this.parseDailyRewards(e);this.setRewardsLog(t),this.setDailyRewards(r)}getDailyRewards(){let{storage:e}=this.codex;return e.getStorageData("dailyRewards","dailyRewards")||null}logLoginReward(){qd?this.logFromFirstReward():this.logFromLastReward()}logFromFirstReward(){let{player:e}=this.codex,{dailyRewardedData:t}=e.getPlayerData();if(!Qe.isObject(t))return;let{logDays:r,firstReward:n}=t,y=new Date,f=[...r];if(n===0){f[0]=!0,Qe.isDebugger()||y.setHours(0,0,0,0),this.setRewardsLog({logDays:f,firstReward:y.valueOf(),lastReward:y.valueOf()});return}let w=y.valueOf()-n,A=Math.floor(w/Fr);A>=zd||A>=r.length||(f[A]=!0,Qe.isDebugger()||y.setHours(0,0,0,0),this.setRewardsLog({logDays:f,lastReward:y.valueOf()}))}logFromLastReward(){let{player:e}=this.codex,{dailyRewardedData:t}=e.getPlayerData();if(!Qe.isObject(t))return;let{logDays:r,lastReward:n}=t,y=new Date,f=[...r];if(n===0){f[0]=!0,Qe.isDebugger()||y.setHours(0,0,0,0),this.setRewardsLog({logDays:f,firstReward:y.valueOf(),lastReward:y.valueOf()});return}let w=y.valueOf()-n;if(Math.floor(w/Fr)<1)return;let A=On.searchIndex(f,x=>x===!1);A!==void 0&&(f[A]=!0,Qe.isDebugger()||y.setHours(0,0,0,0),this.setRewardsLog({logDays:f,lastReward:y.valueOf()}))}setRewardsLog(e){let{logDays:t,firstReward:r,lastReward:n}=e,{player:y}=this.codex,{dailyRewardedData:f}=y.getPlayerData();Qe.isObject(f)&&(this.isSameLog(f,e)||y.setPlayerDataByName("dailyRewardedData",{logDays:t!==void 0?[...t]:[...f.logDays],firstReward:r??f.firstReward,lastReward:n??f.lastReward}))}isSameLog(e,t){if(t.firstReward!==void 0&&e.firstReward!==t.firstReward||t.lastReward!==void 0&&e.lastReward!==t.lastReward)return!1;if(t.logDays!==void 0){if(e.logDays.length!==t.logDays.length)return!1;for(let r=0;r<t.logDays.length;r++)if(e.logDays[r]!==t.logDays[r])return!1}return!0}parseDailyRewards(e){let{player:t}=this.codex,{dailyRewardedData:r}=t.getPlayerData(),{logDays:n,firstReward:y,lastReward:f}=r??{};if(n===void 0||y===void 0||y===0||f===void 0||f===0||n.length!==e.length){let w=this.getDefaultDailyRewards(e);return{logs:{logDays:w.logDays,firstReward:0,lastReward:0},rewards:w.rewards}}return qd?this.parseFromFirstReward(e,n,y,f):this.parseFromLastReward(e,n,y,f)}parseFromFirstReward(e,t,r,n){let y=Date.now()-r;if(y<0){let D=this.getDefaultDailyRewards(e);return{logs:{logDays:D.logDays,firstReward:0,lastReward:0},rewards:D.rewards}}let f=Math.floor(y/Fr),w=f>=zd||f>=t.length,A=On.search(t.slice(0,f),D=>D===!1)!==void 0;if(w||A){let D=this.getDefaultDailyRewards(e);return{logs:{logDays:D.logDays,firstReward:0,lastReward:n},rewards:D.rewards}}let x=[],v={};for(let D=0;D<e.length;D++){let I=e[D],E=x.length>f,b=x.length===f,T=t[D];if(E){x.push(!1),v[I.id]=R(S({},I),{status:fe.WAITING});continue}if(x.push(T),b){v[I.id]=R(S({},I),{status:T?fe.REWARDED:fe.READY});continue}v[I.id]=R(S({},I),{status:T?fe.REWARDED:fe.SKIPPED})}return{logs:{logDays:x,firstReward:r,lastReward:n},rewards:v}}parseFromLastReward(e,t,r,n){let y=Date.now()-n;if(y<0){let v=this.getDefaultDailyRewards(e);return{logs:{logDays:v.logDays,firstReward:0,lastReward:0},rewards:v.rewards}}let f=Math.floor(y/Fr)>=1,w=On.searchIndex(t,v=>v===!1);if(w===-1&&f){let v=this.getDefaultDailyRewards(e);return v.rewards[e[0].id].status=f?fe.READY:fe.WAITING,{logs:{logDays:v.logDays,firstReward:0,lastReward:n},rewards:v.rewards}}let A=[],x={};for(let v=0,D=e.length;v<D;v++){let I=e[v],E=w!==-1&&v>w,b=v===w;if(E){A.push(!1),x[I.id]=R(S({},I),{status:fe.WAITING});continue}if(b){A.push(!1),x[I.id]=R(S({},I),{status:f?fe.READY:fe.WAITING});continue}A.push(!0),x[I.id]=R(S({},I),{status:fe.REWARDED})}return{logs:{logDays:A,firstReward:r,lastReward:n},rewards:x}}getDefaultDailyRewards(e){let t=[],r={};for(let n of e)t.push(!1),r[n.id]=R(S({},n),{status:fe.WAITING});return r[e[0].id].status=fe.READY,{logDays:t,rewards:r}}setDailyRewards(e){let{storage:t}=this.codex;t.setStorageData("dailyRewards","dailyRewards",e)}},Qd=_n,Jd=Qd;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var eu=_m(Zd(),1),tu=eu.default,Rg=new tu,Fe=Rg;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var kg={names:[],history:[]},ru=kg,{Utils:{Decorator:Be}}=Ludex,Se=class extends Ludex.Plugins.BasePlugin{enableLog=!1;muteEvents=[];init(){let{storage:e}=this.codex;e.addStorage("event",ru)}enableLogEvent(){this.enableLog=!0}on(e,t){this.addEventName(e),this.addHistory(e,"on","listening"),Fe.on(e,t)}once(e,t){this.addEventName(e),this.addHistory(e,"once","listening"),Fe.once(e,t)}waitTo(e,t){return new Promise((r,n)=>{let y,f=w=>{clearTimeout(y),r(w)};this.once(e,f),t&&t>0&&(y=setTimeout(()=>{this.off(e,f),n(new Error(`Event ${e} timeout`))},t))})}catchUp(e,t){if(this.once(e,t),!(this.getEventEmitCount(e)>0))return;let{payload:r}=this.getLastEventInfo(e)??{};this.emit(e,r)}off(e,t){Fe.off(e,t),this.addHistory(e,"action","removed")}mute(e){this.muteEvents.indexOf(e)>-1||this.muteEvents.push(e)}clear(e){Fe.removeAllListeners(e),this.addHistory(e,"action","removed")}emit(e,t){if(this.muteEvents.indexOf(e)>-1)return;let r=[];t&&(r=[t]),this.addHistory(e,"action","called",t),Fe.emit(e,...r)}addEventName(e){let{storage:t}=this.codex,r=t.getStorageData("event","names");r&&r.indexOf(e)<0&&r.push(e)}limitHistory(e){if(e.length<=1e4)return e;let{Utils:{Array:t}}=Ludex;return t.limit(e,1e4)}getEventListeners(e){return this.getHistory().filter(t=>t.name===e&&t.status==="listening").map(t=>t.name)}getHistory(){let{storage:e}=this.codex,t=e.getStorageData("event","history")??[];return this.limitHistory(t)}getEventEmitCount(e){return this.getHistory().filter(t=>t.name===e&&t.status==="called").length}getLastEventInfo(e){let t=this.getHistory(),r=null;for(let n=t.length-1;n>=0;n--)if(t[n].name===e){r=t[n];break}return r}getTypeFromHistory(e){return this.getLastEventInfo(e)?.type??null}getCallsFromHistory(e){return this.getLastEventInfo(e)?.called??0}addHistory(e,t,r,n){let y=this.getTypeFromHistory(e)??t,f=this.getCallsFromHistory(e),w=r==="called"?f+1:f;this.getHistory().push({type:y,status:r,name:e,called:w,payload:n??{}}),this.logEventInfo(e,y,r,w)}logEventInfo(e,t,r,n){this.enableLog&&(r==="listening"&&Fe.listenerCount(e)>1,r==="called"&&Fe.listenerCount(e)<=0)}};se([Be.validateParams("string","function")],Se.prototype,"on",1),se([Be.validateParams("string","function")],Se.prototype,"once",1),se([Be.validateParams("string")],Se.prototype,"waitTo",1),se([Be.validateParams("string","function")],Se.prototype,"catchUp",1),se([Be.validateParams("string","function")],Se.prototype,"off",1),se([Be.validateParams("string")],Se.prototype,"mute",1),se([Be.validateParams("string")],Se.prototype,"clear",1),se([Be.validateParams("string")],Se.prototype,"emit",1);var au=Se,nu=au;O(),O(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Rn=class extends Error{locale;constructor(e){super(`Locale "${e}" not found`),this.name="LocaleNotFoundError",this.locale=e}},Vr=Rn;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var kn=class extends Error{key;locale;constructor(e,t){let r=String(e);super(`Text with key "${r}" not found in locale "${t}"`),this.name="MissingKeyInLocaleError",this.key=r,this.locale=t}},Bt=kn,{Utils:{Object:Gn,Function:su,Browser:Gg},Configs:{Languages:{DetectPlayerLocale:$g}}}=Ludex,$n=class extends Ludex.Plugins.BasePlugin{locale;fallbackLocale;data={};setFallbackLocale(e){this.fallbackLocale=e}hasTextKey(e,t){let r=t??this.getCurrentLocale(),{text:n}=this.getLocaleData(r);return Gn.hasOwn(n,e)}hasTextureKey(e,t){let r=t??this.getCurrentLocale(),{texture:n}=this.getLocaleData(r);return Gn.hasOwn(n,e)}add(e,t,r=!1){this.data[e]=t,r&&this.setFallbackLocale(e)}choose(e){this.locale=e;let{event:t}=this.codex;t.emit(Ludex.Events.LANGUAGE_CHANGED,{locale:e})}getText(e,t,r,n=!1){try{return this.uncaughtGetText(e,t,r,!n)}catch(y){return y instanceof Bt||y instanceof Vr,String(e)}}getTexture(e,t,r=!1){return this.uncaughtGetTexture(e,t,!r)}uncaughtGetText(e,t=[],r,n=!0){if(!n||this.fallbackLocale===void 0){let w=this.getRawText(e,r??this.getCurrentLocale());return this.replaceVariables(w,t)}let y=this.fallbackLocale,f=su.retry(()=>this.getRawText(e,r??this.getCurrentLocale()),()=>this.getRawText(e,y));return this.replaceVariables(f,t)}getRawText(e,t){if(!this.hasTextKey(e,t))throw new Bt(e,t);let{text:r}=this.getLocaleData(t);return r[e]}uncaughtGetTexture(e,t,r=!0){if(!r||this.fallbackLocale===void 0)return this.getRawTexture(e,t??this.getCurrentLocale());let n=this.fallbackLocale;return su.retry(()=>this.getRawTexture(e,t??this.getCurrentLocale()),()=>this.getRawTexture(e,n))}getRawTexture(e,t){if(!this.hasTextureKey(e,t))throw new Bt(e,t);let{texture:r}=this.getLocaleData(t);return r[e]}getCurrentLocale(){return this.locale??"en"}getLocaleData(e){let t=e??this.getCurrentLocale();if(!Gn.hasOwn(this.data,t))throw new Vr(t);return this.data[t]}replaceVariables(e,t){let r=t.length;if(r===0)return e;let n=e;for(let y=0;y<r;y++){let f=t[y],w=`%{${y}}`;n=n.replace(w,f)}return n}getPlayerLanguage(){let{player:e}=this.codex,t=GameSDK.getLocale()?.trim().split(/[-_]/)[0],r=this.getBrowserLanguage();return t!==r?t??r:e.isFirstSession()?r:e.getPlayerSetting("language")??r}getBrowserLanguage(){return $g===!1?"en":Gg.getLocale()?.trim()?.split(/[-_]/)[0]}},ou=$n,iu=ou;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),Fn();var{Configs:{OtherHost:Vt,Mockup:Ut,AppId:qg},Utils:{Object:Ht,String:Un,Valid:zg}}=Ludex,Hn=class{mockAPI;async initMockAPI(){if(this.mockAPI)return;let e=(await Promise.resolve().then(()=>(pu(),uu))).default;if(typeof e!="function")throw new Error("Cannot load LeaderboardAPIMock");this.mockAPI=new e}async getLeadersAsync(e,t,r){let n=Un.params(r),y;return Ut.Leaderboards.Enabled?(await this.initMockAPI(),"playerIds"in r?y=await this.mockAPI.getPlayers(e,r):y=await this.mockAPI.getLeaders(e,r)):y=await Re(`${t}?${n}`,{},Vt),!Ht.hasOwn(y,"data")||!Array.isArray(y.data)?[]:y.data}async getLeaderboardAsync(e){let t,r=`leaderboards/${e}`;return Ut.Leaderboards.Enabled?(await this.initMockAPI(),t=await this.mockAPI.getLeaderboardAsync(e)):(t=await Re(r,{},Vt),Ht.hasOwn(t,"data")&&typeof t.data=="object"&&(t=t.data)),t}async getLeaderboardsAsync(e){let t,r=Un.params(e);return Ut.Leaderboards.Enabled?(await this.initMockAPI(),t=await this.mockAPI.getLeaderboardsAsync(e)):(t=await Re(`leaderboards?${r}`,{},Vt),Ht.hasOwn(t,"data")&&Array.isArray(t.data)?t=t.data:t=[]),t}async setLeaderboardScoreAsync(e){let{leaderboardId:t,playerId:r,score:n}=e;Ut.Leaderboards.Enabled?(await this.initMockAPI(),await this.mockAPI.setScoreAsync(t,r,n)):await he(`leaderboards/${t}/players/${r}`,{score:n},{},Vt)}async createLeaderboardAsync(e){let t=e._id??Un.generateObjectId(),r=e.numberOfLeaders,n=R(S(S({},Ur),e),{_id:t,appId:qg,numberOfLeaders:r}),y="leaderboards",f;if(Ut.Leaderboards.Enabled?(await this.initMockAPI(),f=await this.mockAPI.createLeaderboard(n)):(f=await he(y,n,{},Vt),Ht.hasOwn(f,"data")&&zg.isObject(f.data)&&(f=f.data)),!Ht.hasOwn(f,"_id")||f._id!==t)throw new Error("Create leaderboard failed");return t}},mu=Hn;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Yg={limit:0,offset:0,leaders:{},isRequesting:!1,amountPlayer:0},Kn=Yg;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Qg={leaderboards:{}},hu=Qg,{Utils:{Array:Jg,Valid:Xg,Json:fu,Object:Wr}}=Ludex,jn=class extends Ludex.Plugins.BasePlugin{lbAPI=new mu;configs;init(){let{storage:e}=this.codex;e.addStorage("leaderboard",hu),this.configs={}}addLeaderboard(e){let{name:t,type:r,leaderboardId:n,autoSortRank:y}=e;if(this.getLeaderboard(t))return;let f=`leaderboards/${n}/`;(r==="global"||r==="tournament")&&(f+="leaders"),r==="friends"&&(f+="players"),this.configs[t]={id:n,name:t,type:r,host:f,autoSortRank:y};let w=fu.clone(Kn);this.setLeaderboard(t,S({},w))}async requestLeaderboardsAsync(e){try{return await this.lbAPI.getLeaderboardsAsync(e)}catch{return[]}}async requestLeaderboardAsync(e,t){try{this.validateLeaderboard(e),this.clearLeaderboard(e),this.setLeaderboard(e,{isRequesting:!0});let{id:r,type:n,host:y}=this.configs[e],f=[];if(n==="friends"){let{player:w}=this.codex,A=w.getPlayerId(),x=w.getConnectedPlayerIds(t,0),v=[A,...x];this.configs[e].playerIds=[...v],f=await this.lbAPI.getLeadersAsync(r,y,{playerIds:v})}else f=await this.lbAPI.getLeadersAsync(r,y,{limit:t,offset:0});if(f.length===0)return;await this.receiveLeaderboardAsync(e,f),this.setLeaderboard(e,{limit:t,offset:0})}finally{let r=await this.lbAPI.getLeaderboardAsync(this.configs[e].id),n=r?r.resettable:"",y=r?r.amountPlayer:0;this.setLeaderboard(e,{isRequesting:!1,resettable:n,amountPlayer:y})}}async loadMoreLeaderboardAsync(e,t){let r=this.getLeaderboard(e);if(r&&this.configs[e].type!=="friends")try{this.setLeaderboard(e,{isRequesting:!0});let{id:n,host:y}=this.configs[e],{offset:f,limit:w}=r,A=f+w,x=await this.lbAPI.getLeadersAsync(n,y,{limit:t,offset:A});if(x.length===0)return;this.receiveLeaderboardAsync(e,x),this.setLeaderboard(e,{limit:t,offset:A})}finally{this.setLeaderboard(e,{isRequesting:!1})}}getLeaderboard(e){let{storage:t}=this.codex,r=t.getStorageData("leaderboard","leaderboards");return!r||!r[e]?null:r[e]}async getLeadersByPlayerIdsAsync(e,t){try{this.validateLeaderboard(e);let{id:r}=this.configs[e],n=`leaderboards/${r}/players`,y=await this.lbAPI.getLeadersAsync(r,n,{playerIds:t});return y.length===0?[]:this.toLeaders(y)}catch{return[]}}async getLeaderboardResponseAsync(e){return this.lbAPI.getLeaderboardAsync(e)}clearLeaderboard(e){try{this.validateLeaderboard(e);let t=fu.clone(Kn);this.setLeaderboard(e,null),this.setLeaderboard(e,S({},t))}catch{}}isLeaderboardEmpty(e){let t=this.getLeaderboard(e);if(!t)return!0;let{leaders:r}=t;return Object.keys(r).length===0}isExistLeaderboardId(e){let{configs:t}=this;return Wr.vals(t).some(r=>r.id===e)}getLeaderboardName(e){let{configs:t}=this,r=Jg.search(Wr.vals(t),n=>n.id===e);return r?r.name:null}async setLeaderboardScoreAsync(e,t,r){try{if(GameSDK.extra.isGuest)return;this.validateLeaderboard(e);let{id:n}=this.configs[e],y=await this.getLastScoreOnLeaderboard(e,t);if(y&&r<=y)return;await this.lbAPI.setLeaderboardScoreAsync({leaderboardId:n,playerId:t,score:r})}catch{}}async getLastScoreOnLeaderboard(e,t){let r=await this.getLeadersByPlayerIdsAsync(e,[t]);return r.length===0?null:r[0].score}async createLeaderboardAsync(e){return this.lbAPI.createLeaderboardAsync(e)}validateLeaderboard(e){let t=this.getLeaderboard(e);if(!Xg.isObject(t))throw new Error(`Leaderboard with name ${e} not found`)}setLeaderboard(e,t){if(!t)return;let{storage:r}=this.codex;r.setStorageData("leaderboard","leaderboards",{[e]:t})}async receiveLeaderboardAsync(e,t){this.validateLeaderboard(e);let r=(await this.toLeaders(t)).filter(x=>x.name&&x.photo),{leaders:n={}}=this.getLeaderboard(e)??{},y=r.filter(x=>n[x.playerId]?(n[x.playerId]=x,!1):!0),f=Wr.vals(n);y.length>0&&f.unshift(...y);let w=f.sort((x,v)=>v.score-x.score);this.configs[e].autoSortRank&&(w=w.map((x,v)=>R(S({},x),{rank:v+1})));let A=Wr.keyBy(w,"playerId");this.setLeaderboard(e,{leaders:A})}async toLeaders(e){let{profile:t}=this.codex,r=e.map(y=>y.playerId);await t.requestProfiles(r);let n=t.getProfiles();return e.map(y=>{let{playerId:f}=y,w=n[f];if(!w){let{language:A}=this.codex,x=A.getText("core.nameless")??"Nameless";return R(S({},y),{name:x,photo:"default"})}return R(S({},y),{name:w.name,photo:w.photo})}).map(y=>R(S({},y),{score:parseInt(y.score,10)}))}},yu=jn,gu=yu;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Wn=class{APIHost;setAPIHost(e){this.APIHost=e}getAPIHost(){return this.APIHost}},Pu=Wn,{Utils:xu}=Ludex,qn=class extends Pu{async createSingleMatchAsync(e){let t=await he("single-matches",e,{},this.getAPIHost());return this.returnValidMatchData(t)}async getSingleMatchDetailAsync(){let e=await Re("single-matches/active",{},this.getAPIHost());return this.returnValidMatchData(e)}async updateSingleMatchMoveAsync(e,t){let r=`single-matches/${e}/move`,n=await he(r,t,{},this.getAPIHost());return this.returnValidMatchData(n)}async finishSingleMatchAsync(e){let t=`single-matches/${e}/finish`,r=await he(t,{},{},this.getAPIHost());return this.returnValidMatchData(r)}async createMatchAsync(e){let t=await he("matches",e,{},this.getAPIHost());return this.returnValidMatchData(t)}async joinMatchAsync(e){let t=`matches/${e}/join`,r=await he(t,{},{},this.getAPIHost());return this.returnValidMatchData(r)}async getMatchDetailByIdAsync(e){let t=`matches/${e}`,r=await Re(t,{},this.getAPIHost());return this.returnValidMatchData(r)}async finishMatchAsync(e){let{matchId:t="",score:r=0,level:n=0,extraData:y={}}=e,f=`matches/${t}/finish`,w=await he(f,{matchId:t,score:r,level:n,extraData:y},{},this.getAPIHost());return this.returnValidMatchData(w)}returnValidMatchData(e){return xu.Valid.isObject(e)?xu.Object.hasOwn(e,"data")?e.data??{}:{}:{}}},wu=qn,zn=class{matchAPI;constructor(e){this.createAPI(),this.setAPIConfig(e)}createAPI(){this.matchAPI=new wu}setAPIConfig(e){e.matchAPIHost&&this.matchAPI.setAPIHost(e.matchAPIHost)}setMatchAPIInstance(e){this.matchAPI=e}getMatchAPI(){return this.matchAPI}},Au=zn;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Yn=class{codex;match;constructor(e,t){this.codex=e,this.match=t}startLog(e){this.match.useCPUProfile}endLog(){this.match.useCPUProfile}async processAsync(e){throw new Error("Not implemented")}},N=Yn;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Object:Zg,Valid:Kt,Json:eP}=Ludex.Utils,Qn=class{codex;match;nextHandler;stateData;constructor(e){this.codex=e.codex,this.match=e.match,this.nextHandler=null,this.stateData={Before:null,After:null}}setNext(e){return this.nextHandler=e,e}async processAsync(e){this.se("Before",e)}async nextAsync(e){this.se("After",e),this.Fe(),this.nextHandler&&await this.nextHandler.processAsync(e)}se(e,t){if(!Kt.isDebugger())return;this.stateData[e]=eP.clone(t);let r=t,{profiles:n,customData:y}=r,f=wa(r,["profiles","customData"])}Fe(){let{After:e,Before:t}=this.stateData;if(!e||!t)return;let r=Zg.diff(t,e);if(!Kt.isEmpty(r)){let n=r,{profiles:y={},customData:f={}}=n,w=wa(n,["profiles","customData"]);Kt.isEmpty(w),Kt.isEmpty(y),Kt.isEmpty(f)}this.stateData.After=null,this.stateData.Before=null}},C=Qn,Jn=class extends C{async processAsync(e){await this.nextAsync(e)}async nextAsync(e){this.nextHandler&&await this.nextHandler.processAsync(e)}},k=Jn;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Xn=class extends te{constructor(e){super(e),this.name="LevelNotDefined",this.message=e??"Level is not defined"}},qr=Xn;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Zn=class extends te{constructor(e){super(e),this.name="MatchModeNotDefined",this.message=e??"Match id is not defined"}},ft=Zn,{Plugins:tP,Utils:rP}=Ludex,{Analytics:aP}=tP,{String:bu,Valid:vu}=rP,es=class extends C{async processAsync(e){super.processAsync(e);let{mode:t,customData:r}=e,{level:n}=r;this.validateMode(t),this.validateLevel(n);let{analytics:y}=this.codex;y.event(aP.Events.MATCH_START,{level:n,game_mode:bu.toUpperCamelCase(t),level_name:this.getLevelName(n)}),await this.nextAsync(e)}validateMode(e){if(!vu.isString(e))throw new ft}validateLevel(e){if(!vu.isNumber(e))throw new qr}getLevelName(e){return`Level ${bu.padStart(e.toString(),5,"0")}`}},Y=es;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var nP={OPEN:"open",ACTIVE:"active",FINISHED:"finished"},W=nP,ts=class extends C{async processAsync(e){super.processAsync(e);let{mode:t,status:r}=e,n=t??ke.SINGLE;r===W.FINISHED&&(n=ke.SINGLE),this.contextGameModeDetected(n),await this.nextAsync(e)}contextGameModeDetected(e){let{storage:t}=this.codex;t.setStorageData("context","contextGameMode",e)}},$=ts;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var rs=class extends Error{constructor(e){super(e),this.name="GetMatchDetailFailed",this.message=e??"Get match detail failed"}},yt=rs;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var as=class extends Error{constructor(e){super(e),this.name="MatchAreNotActive",this.message=e??"Match are not active"}},zr=as;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var ns=class extends te{constructor(e){super(e),this.name="MatchIdNotValid",this.message=e??"Match id is not valid"}},re=ns;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var ss=class extends Error{constructor(e){super(e),this.name="OpponentHasFinishedMatch",this.message=e||"Opponent has finished match"}},Du=ss;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var os=class extends te{constructor(e){super(e),this.name="OpponentIdNotValid",this.message=e??"Opponent id is not valid"}},z=os;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var is=class extends Error{constructor(e){super(e),this.name="PlayerNotCurrentInMatch",this.message=e??"The player is not currently in this match"}},gt=is;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var cs=class extends Error{constructor(e){super(e),this.name="PlayerNotFinishedMatch",this.message=e||"Player not finished match"}},Yr=cs,{Dtos:sP,Utils:{Object:oP}}=Ludex,ls=class extends C{async processAsync(e){super.processAsync(e),this.validateMatchData(e);let t=await this.getMatchAsync(e),r=new sP.Match.Data(t).toObject();this.validateAwaitMatchData(e,r),this.updateMatchData(e,r),this.validateMatchStatus(e),this.validatePlayerTurn(e),this.validateOpponentTurn(e),await this.nextAsync(e)}validateMatchData(e){let{id:t}=e;if(typeof t!="string")throw new re}validateMatchStatus(e){let{status:t}=e;if(t!==W.ACTIVE)throw new zr}validateAwaitMatchData(e,t){let{id:r,customData:n}=e,{_id:y,whitePlayerId:f,blackPlayerId:w}=t;if(typeof y!="string"||y!==r)throw new yt;let{playerId:A}=n,x=f===A,v=w===A;if(!x&&w===ie.playerId)throw new ht;if(!x&&!v)throw new gt}validatePlayerTurn(e){let{profiles:t,customData:r}=e,{playerId:n}=r;if(typeof n!="string")throw new G;let{finished:y}=t[n];if(!y)throw new Yr}validateOpponentTurn(e){let{profiles:t,customData:r}=e,{opponentId:n}=r;if(typeof n!="string")throw new z;let{finished:y}=t[n];if(y)throw new Du}async getMatchAsync(e){let{id:t}=e;return t?this.match.api.getMatchAPI().getMatchDetailByIdAsync(t):{}}updateMatchData(e,t){this.updateMatchGeneral(e,t),this.updatePlayerIds(e,t),this.initializeProfiles(e),this.updateScoresAndStatus(e,t)}updateMatchGeneral(e,t){let{status:r,extraData:n}=t;e.status=r,e.customData=oP.merge(e.customData,n)}updatePlayerIds(e,t){let{whitePlayerId:r,blackPlayerId:n}=t,y=r===e.customData.playerId;e.customData.playerId=y?r:n,e.customData.opponentId=y?n:r}initializeProfiles(e){let{playerId:t,opponentId:r}=e.customData;if(!t||!r)return;let n={name:"",photo:"",finished:!1};e.profiles[t]||(e.profiles[t]=S({id:t},n)),e.profiles[r]||(e.profiles[r]=S({id:r},n))}updateScoresAndStatus(e,t){let{playerId:r,opponentId:n}=e.customData;if(!r||!n)return;let{whitePlayerId:y,whitePlayerScore:f,whitePlayerFinish:w,blackPlayerScore:A,blackPlayerFinish:x}=t,v=y===r;e.profiles[r].score=v?f:A,e.profiles[n].score=v?A:f,e.profiles[r].finished=v?w:x,e.profiles[n].finished=v?x:w}},Su=ls;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var iP={level:1,rescued:0,contextId:null,playerId:null,opponentId:null,tournamentId:null,leaderboardId:null},Pt=iP,ds=class extends C{payload;constructor(e,t){super(e),this.payload=t}async processAsync(e){super.processAsync(e),this.initializeMatch(e),await this.nextAsync(e)}initializeMatch(e){let{id:t,mode:r,customData:n}=this.payload;e.id=t??null,e.mode=r||null,e.status=W.OPEN,e.startAt=0,e.finishAt=0,e.profiles={},e.customData=S(S(S({},Pt),e.customData),n)}},q=ds;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var cP=De,we=cP;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var us=class extends Error{constructor(e){super(e),this.name="UnavailableFeature",this.message=`Unavailable feature: ${e}`}},B=us;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var ps=class extends te{constructor(e){super(e),this.name="ContextIdNotValid",this.message=e??"Context id is not valid"}},Q=ps;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var ms=class extends te{constructor(e){super(e),this.name="ProfileNotFound",this.message=e??"Profile not found"}},V=ms,hs=class extends C{async processAsync(e){super.processAsync(e),this.validateData(e);let t=await this.createWideframesAwaitingAsync(e);t&&this.sendMessageAsync(e,t),await this.nextAsync(e)}validateData(e){let{id:t,customData:r}=e,{contextId:n,opponentId:y}=r;if(!t||typeof t!="string")throw new re;if(!n||typeof n!="string")throw new Q;if(!y||typeof y!="string")throw new z}async createWideframesAwaitingAsync(e){try{let{frameCapture:t}=this.codex,{profiles:r,customData:n}=e,{playerId:y,opponentId:f}=n;if(!y||!f)return null;let w=r[y],A=r[f];if(!w||!A)return null;let{photo:x,score:v=0,finished:D}=w;if(!D)return null;let{photo:I,score:E=0,finished:b}=A;return b?null:await t.renderAsync("result-challenge",{playerId:y,playerPhoto:x,playerScore:v,opponentId:f,opponentPhoto:I,opponentScore:E,isPlayerFinished:!0,isOpponentFinished:!1})}catch{return null}}async sendMessageAsync(e,t){let{id:r,profiles:n,customData:y}=e,{playerId:f,opponentId:w}=y;if(!f||typeof f!="string")throw new G;if(!("updateAsync"in GameSDK.extra))throw new B("updateAsync");let A=n[f];if(!A)throw new V;let{name:x}=A,v={data:{type:we.CHALLENGE_FRIEND,matchId:r,playerId:f,opponentId:w},action:"CUSTOM",template:"challenge",cta:{default:"Play",localizations:{vi_VN:"Ch\u01A1i ngay"}},text:{default:`${x} is waiting for you to finish this game. Play now!`,localizations:{vi_VN:`${x} \u0111ang ch\u1EDD b\u1EA1n k\u1EBFt th\xFAc tr\u1EADn \u0111\u1EA5u. Ch\u01A1i ngay!`}},image:t,strategy:"LAST",notification:"PUSH"};await GameSDK.extra.updateAsync(v)}},Iu=hs;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Dtos:lP}=Ludex,fs=class extends C{async processAsync(e){super.processAsync(e),this.validateData(e);let{customData:t}=e,{playerId:r,opponentId:n}=t,y=r,f=await this.getProfile(y);if(!f)throw new V;if(this.updateMatchProfile(e,y,f),y=n,y!==ie.playerId){let w=await this.getProfile(y);if(!w)throw new V;this.updateMatchProfile(e,y,w)}else this.updateMatchProfile(e,y);await this.nextAsync(e)}validateData(e){let{customData:t}=e,{playerId:r,opponentId:n}=t;if(!r||typeof r!="string")throw new G;if(!n||typeof n!="string")throw new z}async getProfile(e){let{profile:t}=this.codex;return await t.requestProfiles([e]),t.getProfiles()[e]}updateMatchProfile(e,t,r){let{name:n,photo:y}=r??ie,f=new lP.Match.Profile({id:t,name:n,photo:y}).toObject();e.profiles[t]?(e.profiles[t].name=f.name,e.profiles[t].photo=f.photo):e.profiles[t]=f}},le=fs,ys=class extends N{async processAsync(e){try{this.startLog(e);let{matchId:t,playerId:r,opponentId:n}=e,y=new k(this),f=new q(this,{id:t,mode:j.CHALLENGE_FRIEND,customData:{playerId:r,opponentId:n}});y.setNext(f);let w=new Su(this);f.setNext(w);let A=new le(this);w.setNext(A);let x=new Iu(this);A.setNext(x);let v=new Y(this);x.setNext(v);let D=new $(this);v.setNext(D);let I=this.match.getMatchState();await y.processAsync(I)}finally{this.endLog()}}},Lu=ys;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var gs=class extends te{constructor(e){super(e),this.name="CreateContextFailed",this.message=e??"Create context failed"}},xt=gs,{Valid:Cu,Object:Eu}=Ludex.Utils,Ps=class extends C{payload;constructor(e,t){super(e),this.payload=t}async processAsync(e){super.processAsync(e);let{opponentId:t}=this.payload,r=await this.createAsync(t);e.customData.contextId=r,await this.nextAsync(e)}async createAsync(e){try{await GameSDK.context.createAsync(e)}catch(r){this.validateError(r)}let t=GameSDK.context.getID();if(!Cu.isString(t))throw new xt;return t}validateError(e){if(!Eu.hasOwn(e,"code"))throw e;if(e.code!=="SAME_CONTEXT"){if(e.code==="INVALID_PARAM"){if(!this.isNotConnectedPlayerError(e))throw e;return}throw e}}validateErrorMessage(e){if(!Eu.hasOwn(e,"message")||!Cu.isString(e.message))throw e}isNotConnectedPlayerError(e){return this.validateErrorMessage(e),e.message.indexOf("is not a connected player of the current player")>-1}},Mu=Ps;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var xs=class extends te{constructor(e){super(e),this.name="MatchAreNotOpen",this.message=e??"Match are not open"}},Ve=xs,{Dtos:dP,Utils:{Object:uP}}=Ludex,ws=class extends C{payload;constructor(e,t){super(e),this.payload=t}async processAsync(e){super.processAsync(e),this.validateData(e);let t=await this.createMatchAsync(e),r=new dP.Match.Data(t).toObject();this.updateMatchState(e,r),await this.nextAsync(e)}validateData(e){let{status:t,customData:r}=e,{opponentId:n}=r;if(typeof n!="string")throw new z;if(t!==W.OPEN)throw new Ve}async createMatchAsync(e){let{opponentId:t}=e.customData,{extraData:r}=this.payload;if(!t)return{};let n={opponentPlayerId:t,extraData:r};return this.match.api.getMatchAPI().createMatchAsync(n)}updateMatchState(e,t){this.updateMatchGeneral(e,t),this.updatePlayerIds(e,t),this.initializeProfiles(e),this.updateFinishStatus(e,t)}updateMatchGeneral(e,t){let{_id:r,extraData:n}=t;e.id=r||null,e.customData=uP.merge(e.customData,n)}updatePlayerIds(e,t){let{whitePlayerId:r,blackPlayerId:n}=t,{customData:y}=e,f=r===y.opponentId,w=f?n:r,A=f?r:n;e.customData.playerId=w,e.customData.opponentId=A}initializeProfiles(e){let{playerId:t,opponentId:r}=e.customData;if(!t||!r)return;let n={name:"",photo:"",finished:!1};e.profiles[t]||(e.profiles[t]=S({id:t},n)),e.profiles[r]||(e.profiles[r]=S({id:r},n))}updateFinishStatus(e,t){let{playerId:r,opponentId:n}=e.customData;if(!r||!n)return;let{whitePlayerId:y,whitePlayerFinish:f,blackPlayerFinish:w}=t,A=y===e.customData.opponentId,x=A?w:f,v=A?f:w;e.profiles[r].finished=x,e.profiles[n].finished=v}},Qr=ws;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var As=class extends C{async processAsync(e){if(super.processAsync(e),e.status!==W.OPEN)throw new Ve;this.startMatch(e),await this.nextAsync(e)}startMatch(e){e.status=W.ACTIVE,e.startAt=Date.now()}},J=As;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var bs=class extends C{async processAsync(e){super.processAsync(e),this.validateData(e);let t=await this.createWideframesChallengeAsync(e);t&&this.sendMessageAsync(e,t),await this.nextAsync(e)}validateData(e){let{id:t,customData:r}=e,{contextId:n,opponentId:y}=r;if(!t||typeof t!="string")throw new re;if(!n||typeof n!="string")throw new Q;if(!y||typeof y!="string")throw new z}async createWideframesChallengeAsync(e){try{let{frameCapture:t}=this.codex,{profiles:r,customData:n}=e,{playerId:y,opponentId:f}=n;if(!y||!f)return null;let w=r[y],A=r[f];if(!w||!A)return null;let{photo:x,score:v=0}=w,{photo:D,score:I=0}=A;return await t.renderAsync("result-challenge",{playerId:y,playerPhoto:x,playerScore:v,opponentId:f,opponentPhoto:D,opponentScore:I,isPlayerFinished:!1,isOpponentFinished:!1})}catch{return null}}async sendMessageAsync(e,t){let{id:r,profiles:n,customData:y}=e,{playerId:f,opponentId:w}=y;if(!f||typeof f!="string")throw new G;if(!("updateAsync"in GameSDK.extra))throw new B("updateAsync");let{name:A}=n[f],x={data:{type:we.CHALLENGE_FRIEND,matchId:r,playerId:f,opponentId:w},action:"CUSTOM",template:"challenge",cta:{default:"Play",localizations:{vi_VN:"Ch\u01A1i ngay"}},text:{default:`${A} challenges you`,localizations:{vi_VN:`${A} th\u1EED th\xE1ch b\u1EA1n trong tr\u1EADn \u0111\u1EA5u n\xE0y. Ch\u01A1i ngay!`}},image:t,strategy:"IMMEDIATE",notification:"PUSH"};await GameSDK.extra.updateAsync(x)}},Jr=bs,vs=class extends N{async processAsync(e){try{this.startLog(e);let{playerId:t,opponentId:r,extraData:n}=e,y=new k(this),f=new Mu(this,{opponentId:r});y.setNext(f);let w=new q(this,{mode:j.CHALLENGE_FRIEND,customData:{playerId:t,opponentId:r}});f.setNext(w);let A=new Qr(this,{extraData:n});w.setNext(A);let x=new le(this);A.setNext(x);let v=new J(this);x.setNext(v);let D=new Y(this);v.setNext(D);let I=new Jr(this);D.setNext(I);let E=new $(this);I.setNext(E);let b=this.match.getMatchState();await y.processAsync(b)}finally{this.endLog()}}},Tu=vs;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Ds=class extends Error{constructor(e){super(e),this.name="SameContext",this.message=e??"Same context"}},Xr=Ds,{Utils:Ou}=Ludex,Ss=class extends C{payload;constructor(e,t){super(e),this.payload=t}async processAsync(e){super.processAsync(e);let{contextId:t}=this.payload;await this.switchAsync(t),e.customData.contextId=t,await this.nextAsync(e)}checkSameContext(e){let t=e==="SOLO",r=GameSDK.context.getID();if(r===e)throw new Xr;if(t&&r===null)throw new Xr}async switchAsync(e){let t=e==="SOLO";try{this.checkSameContext(e),await GameSDK.context.switchAsync(e,t)}catch(r){if(r instanceof Xr)return;if(!Ou.Object.hasOwn(r,"code"))throw r;if(Ou.Device.isAndroid()&&t&&r.code==="INVALID_PARAM")return;if(r.code!=="SAME_CONTEXT")throw r}}},Ue=Ss;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Dtos:pP,Utils:{Object:mP}}=Ludex,Is=class extends C{async processAsync(e){super.processAsync(e),this.validateMatchData(e);let t=await this.getMatchAsync(e),r=new pP.Match.Data(t).toObject();this.validateContinueMatchData(e,r),this.updateMatchData(e,r),this.validatePlayerTurn(e),await this.nextAsync(e)}validateMatchData(e){let{id:t,status:r}=e;if(typeof t!="string")throw new re;if(r!==W.OPEN)throw new Ve}validateContinueMatchData(e,t){let{id:r,customData:n}=e,{_id:y,whitePlayerId:f,blackPlayerId:w}=t;if(typeof y!="string"||y!==r)throw new yt;let{playerId:A}=n,x=f===A,v=w===A;if(!x&&w===ie.playerId)throw new ht;if(!x&&!v)throw new gt}validatePlayerTurn(e){let{profiles:t,customData:r}=e,{playerId:n}=r;if(typeof n!="string")throw new G;let{finished:y}=t[n];if(y)throw new Nr}async getMatchAsync(e){let{id:t}=e;return t?this.match.api.getMatchAPI().getMatchDetailByIdAsync(t):{}}updateMatchData(e,t){this.updateMatchGeneral(e,t),this.updatePlayerIds(e,t),this.initializeProfiles(e),this.updateScoresAndStatus(e,t)}updateMatchGeneral(e,t){let{extraData:r}=t;e.customData=mP.merge(e.customData,r)}updatePlayerIds(e,t){let{whitePlayerId:r,blackPlayerId:n}=t,y=r===e.customData.playerId;e.customData.playerId=y?r:n,e.customData.opponentId=y?n:r}initializeProfiles(e){let{playerId:t,opponentId:r}=e.customData;if(!t||!r)return;let n={name:"",photo:"",finished:!1};e.profiles[t]||(e.profiles[t]=S({id:t},n)),e.profiles[r]||(e.profiles[r]=S({id:r},n))}updateScoresAndStatus(e,t){let{playerId:r,opponentId:n}=e.customData;if(!r||!n)return;let{whitePlayerId:y,whitePlayerScore:f,whitePlayerFinish:w,blackPlayerScore:A,blackPlayerFinish:x}=t,v=y===r;e.profiles[r].score=v?f:A,e.profiles[n].score=v?A:f,e.profiles[r].finished=v?w:x,e.profiles[n].finished=v?x:w}},_u=Is;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Ls=class extends C{payload;constructor(e,t){super(e),this.payload=t}async processAsync(e){if(super.processAsync(e),this.payload.ignore){await this.nextAsync(e);return}this.validateData(e);let t=await this.createWideframesCurrentScoreAsync(e);t&&this.sendMessageAsync(e,t),await this.nextAsync(e)}validateData(e){let{id:t,customData:r}=e,{contextId:n,opponentId:y}=r;if(!t||typeof t!="string")throw new re;if(!n||typeof n!="string")throw new Q;if(!y||typeof y!="string")throw new z}async createWideframesCurrentScoreAsync(e){try{let{player:t,frameCapture:r}=this.codex,{playerId:n,photo:y}=t.getPlayer(),{opponentId:f}=e.customData;if(f==null)return null;let w=e.profiles[f];if(!w)return null;let A=w.photo;return await r.renderAsync("update-challenge",{playerId:n,playerPhoto:y,opponentId:f,opponentPhoto:A})}catch{return null}}async sendMessageAsync(e,t){let{id:r,profiles:n,customData:y}=e,{playerId:f,opponentId:w}=y;if(!f||typeof f!="string")throw new G;if(!("updateAsync"in GameSDK.extra))throw new B("updateAsync");let A=n[f];if(!A)throw new V;let{name:x}=A,v={data:{type:we.CHALLENGE_FRIEND,matchId:r,playerId:f,opponentId:w},action:"CUSTOM",template:"challenge",cta:{default:"Play",localizations:{vi_VN:"Ch\u01A1i ngay"}},text:{default:`${x} made an update.`,localizations:{vi_VN:`${x} \u0111\xE3 c\u1EADp nh\u1EADt tr\u1EADn \u0111\u1EA5u. Ch\u01A1i ngay!`}},image:t,strategy:"LAST",notification:"PUSH"};if(!("updateAsync"in GameSDK.extra))throw new B("updateAsync");await GameSDK.extra.updateAsync(v)}},Nu=Ls,Cs=class extends N{async processAsync(e){try{this.startLog(e);let{contextId:t,matchId:r,playerId:n,opponentId:y,sendUpdateMessage:f=!0}=e,w=new k(this),A=new Ue(this,{contextId:t});w.setNext(A);let x=new q(this,{id:r,mode:j.CHALLENGE_FRIEND,customData:{playerId:n,opponentId:y}});A.setNext(x);let v=new _u(this);x.setNext(v);let D=new le(this);v.setNext(D);let I=new J(this);D.setNext(I);let E=new Nu(this,{ignore:!f});I.setNext(E);let b=new Y(this);E.setNext(b);let T=new $(this);b.setNext(T);let U=this.match.getMatchState();await w.processAsync(U)}finally{this.endLog()}}},Ru=Cs;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Plugins:hP,Utils:fP}=Ludex,{Analytics:yP}=hP,{String:ku,Valid:Gu}=fP,Es=class extends C{async processAsync(e){super.processAsync(e);let{customData:t,mode:r,startAt:n,finishAt:y}=e,{level:f}=t;this.validateMode(r),this.validateLevel(f);let{analytics:w}=this.codex,A=Math.floor((y-n)/1e3);w.event(yP.Events.MATCH_END,{level:f,game_mode:ku.toUpperCamelCase(r),level_name:this.getLevelName(f),time_played:A}),await this.nextAsync(e)}validateMode(e){if(!Gu.isString(e))throw new ft}validateLevel(e){if(!Gu.isNumber(e))throw new qr}getLevelName(e){return`Level ${ku.padStart(e.toString(),5,"0")}`}},Ee=Es;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Ms=class extends Error{constructor(e){super(e),this.name="LeaderboardNotExist",this.message=e??"Leaderboard not exist in game"}},Zr=Ms;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Ts=class extends Error{constructor(e){super(e),this.name="ScoreNotValid",this.message=e??"Score is not valid"}},wt=Ts,{Utils:{Valid:gP},Configs:{Leaderboards:{LeaderboardList:PP}}}=Ludex,Os=class extends C{payload;skipPostScore;constructor(e,t){super(e),this.payload={score:0,playerId:""},this.skipPostScore=!!t?.ignore}async processAsync(e){if(super.processAsync(e),this.skipPostScore){await this.nextAsync(e);return}this.setupSetScorePayload(e),"submitGameResultsAsync"in GameSDK.extra&&await GameSDK.extra.submitGameResultsAsync(this.payload.score);for(let t of PP){let{Id:r,Mode:n}=t;!e.mode||!this.isValidMode(n,e.mode)||this.setLeaderboardScoreAsync(S({leaderboardId:r},this.payload))}await this.nextAsync(e)}isValidMode(e,t){return e===t}async setupSetScorePayload(e){let{profiles:t,customData:r}=e,{playerId:n}=r;if(!n||!t[n])throw new V;let{score:y}=t[n];if(!gP.isNumber(y))throw new wt;this.payload={score:y,playerId:n}}async setLeaderboardScoreAsync(e){try{let{playerId:t,score:r,leaderboardId:n}=e,y=this.codex.leaderboard.getLeaderboardName(n);if(!y)throw new Zr;await this.codex.leaderboard.setLeaderboardScoreAsync(y,t,r)}catch{}}},He=Os;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Dtos:xP,Utils:wP}=Ludex,{Valid:ea,Object:AP}=wP,_s=class extends C{payload;constructor(e,t){super(e),this.payload=t}async processAsync(e){super.processAsync(e),this.validateMatchData(e);let{useAPI:t}=this.payload;if(t){let r=await this.finishMatchAsync(e),n=new xP.Match.Data(r).toObject();this.updateMatchFromAPI(e,n)}else this.updateMatchData(e);this.updateMatchState(e),await this.nextAsync(e)}validateMatchData(e){let{status:t,profiles:r,customData:n}=e;if(t!==W.ACTIVE)throw new zr;let{playerId:y}=n;if(!y||!AP.hasOwn(r,y))throw new gt}updateMatchData(e){let{playerId:t}=e.customData;if(!ea.isString(t))throw new G;e.profiles[t].finished=!0}updateMatchState(e){e.status=W.FINISHED,e.finishAt=Date.now()}async finishMatchAsync(e){let{id:t,profiles:r,customData:n}=e,{level:y,playerId:f}=n;if(!ea.isString(f))throw new G;let{score:w}=r[f],{extraData:A}=this.payload,x={matchId:t??"",score:w,level:y,extraData:A};return this.match.api.getMatchAPI().finishMatchAsync(x)}updateMatchFromAPI(e,t){let{playerId:r,opponentId:n}=e.customData;if(!ea.isString(r))throw new G;if(!ea.isString(n))throw new z;let{whitePlayerId:y,whitePlayerScore:f,blackPlayerScore:w,whitePlayerFinish:A,blackPlayerFinish:x}=t,v=r===y,D=v?f:w,I=v?w:f,E=v?A:x,b=v?x:A;e.profiles[r].score=D,e.profiles[n].score=I,e.profiles[r].finished=E,e.profiles[n].finished=b}},Me=_s;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Ns=class extends C{async processAsync(e){super.processAsync(e),this.validateData(e);let t=await this.createWideframesResultAsync(e);t&&this.progressSendFinishedMessage(e,t),await this.nextAsync(e)}validateData(e){let{id:t,customData:r}=e,{contextId:n,opponentId:y}=r;if(!t||typeof t!="string")throw new re;if(!n||typeof n!="string")throw new Q;if(!y||typeof y!="string")throw new z}async createWideframesResultAsync(e){try{let{frameCapture:t}=this.codex,{profiles:r,customData:n}=e,{playerId:y,opponentId:f}=n;if(!y||!f)return null;let w=r[y],A=r[f];if(!w||!A)return null;let{photo:x,score:v=0,finished:D}=w,{photo:I,score:E=0,finished:b}=A;return await t.renderAsync("result-challenge",{playerId:y,playerPhoto:x,playerScore:v,opponentId:f,opponentPhoto:I,opponentScore:E,isPlayerFinished:!!D,isOpponentFinished:!!b})}catch{return null}}progressSendFinishedMessage(e,t){let{profiles:r,customData:n}=e,{playerId:y,opponentId:f}=n;if(!y||typeof y!="string")throw new G;if(!f||typeof f!="string")throw new z;if(!r[y]||!r[f])throw new V;let{score:w=0,finished:A}=r[y],{score:x=0,finished:v}=r[f];A?this.sendFinishMessageAsync(e,t):v&&w>x?this.sendBestScoreMessageAsync(e,t):this.sendPlayTurnMessageAsync(e,t)}async sendFinishMessageAsync(e,t){let{id:r,profiles:n,customData:y}=e,{playerId:f,opponentId:w}=y;if(!f||typeof f!="string")throw new G;if(!("updateAsync"in GameSDK.extra))throw new B("updateAsync");let A=n[f];if(!A)throw new V;let{name:x}=A,v={data:{type:we.CHALLENGE_FRIEND,matchId:r,playerId:f,opponentId:w,status:W.FINISHED},action:"CUSTOM",template:"finished",cta:{default:"See result",localizations:{vi_VN:"Xem k\u1EBFt qu\u1EA3"}},text:{default:`${x} just finished. Check them now.`,localizations:{vi_VN:`${x} v\u1EEBa ho\xE0n th\xE0nh m\xE0n ch\u01A1i. Nh\u1EA5n \u0111\u1EC3 xem k\u1EBFt qu\u1EA3 tr\u1EADn \u0111\u1EA5u.`}},image:t,strategy:"IMMEDIATE",notification:"PUSH"};if(!("updateAsync"in GameSDK.extra))throw new B("updateAsync");await GameSDK.extra.updateAsync(v)}async sendPlayTurnMessageAsync(e,t){let{id:r,profiles:n,customData:y}=e,{playerId:f,opponentId:w}=y;if(!f||typeof f!="string")throw new G;let A=n[f];if(!A)throw new V;let{name:x,score:v}=A,D={data:{type:we.CHALLENGE_FRIEND,matchId:r,playerId:f,opponentId:w,status:W.ACTIVE},action:"CUSTOM",template:"finished",cta:{default:"Play",localizations:{vi_VN:"Ch\u01A1i ngay"}},text:{default:`${x} got ${v} scores. So easy! Can you?`,localizations:{vi_VN:`${x} \u0111\xE3 \u0111\u1EA1t ${v} \u0111i\u1EC3m! Nh\u1EA5n Ch\u01A1i \u0111\u1EC3 so t\xE0i!`}},image:t,strategy:"IMMEDIATE",notification:"PUSH"};if(!("updateAsync"in GameSDK.extra))throw new B("updateAsync");await GameSDK.extra.updateAsync(D)}async sendBestScoreMessageAsync(e,t){let{id:r,profiles:n,customData:y}=e,{playerId:f,opponentId:w}=y;if(!f||typeof f!="string")throw new G;let A=n[f];if(!A)throw new V;let{name:x,score:v}=A,D={data:{type:we.CHALLENGE_FRIEND,matchId:r,playerId:f,opponentId:w,status:W.FINISHED},action:"CUSTOM",template:"pass_score",cta:{default:"See result",localizations:{vi_VN:"Xem k\u1EBFt qu\u1EA3"}},text:{default:`${x} beat your high score. Their score: ${v}`,localizations:{vi_VN:`${x} \u0111\xE3 v\u01B0\u1EE3t qua \u0111i\u1EC3m s\u1ED1 c\u1EE7a b\u1EA1n, v\u1EDBi ${v} \u0111i\u1EC3m!`}},image:t,strategy:"IMMEDIATE",notification:"PUSH"};if(!("updateAsync"in GameSDK.extra))throw new B("updateAsync");await GameSDK.extra.updateAsync(D)}},$u=Ns;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Rs=class extends C{ignore;constructor(e,t){super(e),this.ignore=!!t?.ignore}async processAsync(e){super.processAsync(e),this.setPlayerBestScore(e),await this.nextAsync(e)}setPlayerBestScore(e){if(this.ignore)return;let{profiles:t,customData:r}=e,{playerId:n}=r;if(!n||!t[n])throw new V;let{player:y}=this.codex,f=y.getBestScore()||0,{score:w=0}=t[n];w<=f||(y.setBestScore(w),t[n].bestScore=w)}},Te=Rs,ks=class extends N{async processAsync(e){try{this.startLog(e);let{extraData:t}=e??{},r=new k(this),n=new Me(this,{useAPI:!0,extraData:t});r.setNext(n);let y=new $u(this);n.setNext(y);let f=new Ee(this);y.setNext(f);let w=new Te(this);f.setNext(w);let A=new He(this);w.setNext(A);let x=new $(this);A.setNext(x);let v=this.match.getMatchState();await r.processAsync(v)}finally{this.endLog()}}},Fu=ks;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Gs=class extends Error{constructor(e){super(e),this.name="ContextAreSolo",this.message=e??"Context are solo"}},Bu=Gs;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var $s=class extends Error{constructor(e){super(e),this.name="ContextNotChallenge",this.message=e??"Context is not a challenge"}},Vu=$s;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Fs=class extends Error{constructor(e){super(e),this.name="NetworkFailure",this.message=e??"Network failure"}},Uu=Fs,{Utils:bP,Dtos:vP}=Ludex,{Array:DP,Object:SP}=bP,Bs=class extends C{payload;constructor(e,t){super(e),this.payload=t}async processAsync(e){super.processAsync(e),this.checkCurrentContext();let t=await this.getOpponentIdFromContextAsync();e.customData.opponentId=t,await this.nextAsync(e)}checkCurrentContext(){let e=GameSDK.context.getID();if(typeof e!="string")throw new Q;if(e==="SOLO")throw new Bu}async getOpponentIdFromContextAsync(){let{ignoreId:e}=this.payload,t=await this.getContextPlayers([e]);if(t.length>1)throw new Vu;let r=ie;return t.length===1&&(r=t[0]),r.playerId}async getContextPlayers(e){try{let t=await GameSDK.context.getPlayersAsync(),r=[];for(let n of t){let y=n.getID();if(e.indexOf(y)>-1)continue;let f=n.getName();if(!f)continue;let w=n.getPhoto();r.push(new vP.Player.Info({playerId:y,name:f,photo:w}).toObject())}return DP.unique(r)}catch(t){if(SP.hasOwn(t,"code")&&t.code==="NETWORK_FAILURE")throw new Uu;return[]}}},ta=Bs;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Vs=class extends Error{constructor(e){super(e),this.name="ContextIsTournament",this.message=e??"Context is a tournament"}},jt=Vs,{Object:IP}=Ludex.Utils,Us=class extends C{async processAsync(e){super.processAsync(e);let t=await this.chooseAsync();await this.checkContextTournament(),e.customData.contextId=t,await this.nextAsync(e)}async chooseAsync(){try{await GameSDK.context.chooseAsync({filters:["INCLUDE_EXISTING_CHALLENGES"],minSize:2,maxSize:2})}catch(t){if(!IP.hasOwn(t,"code")||t.code!=="SAME_CONTEXT")throw t}let e=GameSDK.context.getID();if(typeof e!="string")throw new xt;return e}async checkContextTournament(){try{if(!GameSDK.context.getID())return;throw"getTournamentAsync"in GameSDK?(await GameSDK.getTournamentAsync(),new jt):new B("getTournamentAsync")}catch(e){if(e instanceof jt)throw e}}},Hu=Us,Hs=class extends N{async processAsync(e){try{this.startLog(e);let{playerId:t,extraData:r}=e,n=new k(this),y=new Hu(this);n.setNext(y);let f=new q(this,{mode:j.CHALLENGE_FRIEND,customData:{playerId:t}});y.setNext(f);let w=new ta(this,{ignoreId:t});f.setNext(w);let A=new Qr(this,{extraData:r});w.setNext(A);let x=new le(this);A.setNext(x);let v=new J(this);x.setNext(v);let D=new Y(this);v.setNext(D);let I=new Jr(this);D.setNext(I);let E=new $(this);I.setNext(E);let b=this.match.getMatchState();await n.processAsync(b)}finally{this.endLog()}}},Ku=Hs;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Ks=class extends Error{constructor(e){super(e),this.name="JoinMatchFailed",this.message=e??"Join match failed"}},ju=Ks;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var js=class extends Error{constructor(e){super(e),this.name="MatchAreFinished",this.message=e??"Match are finished"}},Wu=js;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Ws=class extends Error{constructor(e){super(e),this.name="OtherPlayerHasJoinedMatch",this.message=e??"Other player has joined match"}},qu=Ws,{Dtos:LP,Utils:{Object:CP}}=Ludex,qs=class extends C{async processAsync(e){super.processAsync(e),this.validateMatchData(e);let t=await this.joinMatchAsync(e),r=new LP.Match.Data(t).toObject();this.validateJoinMatchData(e,r),this.updateMatchData(e,r),await this.nextAsync(e)}validateMatchData(e){let{status:t}=e;if(t!==W.OPEN)throw new Ve}validateJoinMatchData(e,t){let{id:r,customData:n}=e,{_id:y,blackPlayerId:f,whitePlayerId:w,whitePlayerFinish:A,blackPlayerFinish:x}=t,v=f===n.playerId,D=w===n.opponentId;if(typeof y!="string"||y!==r||!D)throw new ju;if(A&&x)throw new Wu;if(!v)throw new qu}async joinMatchAsync(e){let{id:t}=e;return t?this.match.api.getMatchAPI().joinMatchAsync(t):{}}updateMatchData(e,t){this.updateMatchGeneral(e,t),this.updatePlayerIds(e,t),this.initializeProfiles(e),this.updateScoresAndStatus(e,t)}updateMatchGeneral(e,t){let{extraData:r}=t;e.customData=CP.merge(e.customData,r)}updatePlayerIds(e,t){let{whitePlayerId:r,blackPlayerId:n}=t,{customData:y}=e,f=r===y.playerId,w=f?r:n,A=f?n:r;e.customData.playerId=w,e.customData.opponentId=A}initializeProfiles(e){let{playerId:t,opponentId:r}=e.customData;if(!t||!r)return;let n={name:"",photo:"",finished:!1};e.profiles[t]||(e.profiles[t]=S({id:t},n)),e.profiles[r]||(e.profiles[r]=S({id:r},n))}updateScoresAndStatus(e,t){let{playerId:r,opponentId:n}=e.customData;if(!r||!n)return;let{whitePlayerId:y,whitePlayerScore:f,whitePlayerFinish:w,blackPlayerScore:A,blackPlayerFinish:x}=t,v=y===e.customData.playerId;e.profiles[r].score=v?f:A,e.profiles[n].score=v?A:f,e.profiles[r].finished=v?w:x,e.profiles[n].finished=v?x:w}},zu=qs;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var zs=class extends C{async processAsync(e){super.processAsync(e),this.validateData(e);let t=await this.createWideframesAcceptedAsync(e);t&&this.sendMessageAsync(e,t),await this.nextAsync(e)}validateData(e){let{id:t,customData:r}=e,{contextId:n,opponentId:y}=r;if(!t||typeof t!="string")throw new re;if(!n||typeof n!="string")throw new Q;if(!y||typeof y!="string")throw new z}async createWideframesAcceptedAsync(e){try{let{frameCapture:t}=this.codex,{profiles:r,customData:n}=e,{playerId:y,opponentId:f}=n;if(!y||!f)return null;let w=r[y],A=r[f];if(!w||!A)return null;let{photo:x,score:v=0,finished:D}=w;if(D)return null;let{photo:I,score:E=0,finished:b}=A;return b?await t.renderAsync("result-challenge",{playerId:y,playerPhoto:x,playerScore:v,opponentId:f,opponentPhoto:I,opponentScore:E,isPlayerFinished:!1,isOpponentFinished:!0}):null}catch{return null}}async sendMessageAsync(e,t){let{id:r,profiles:n,customData:y}=e,{playerId:f,opponentId:w}=y;if(!f||typeof f!="string")throw new G;if(!("updateAsync"in GameSDK.extra))throw new B("updateAsync");let A=n[f];if(!A)throw new V;let{name:x}=A,v={data:{type:we.CHALLENGE_FRIEND,matchId:r,playerId:f,opponentId:w},action:"CUSTOM",template:"challenge",cta:{default:"Play",localizations:{vi_VN:"Ch\u01A1i ngay"}},text:{default:`${x} accepted the challenge.`,localizations:{vi_VN:`${x} \u0111\xE3 ch\u1EA5p nh\u1EADn tham gia tr\u1EADn \u0111\u1EA5u.`}},image:t,strategy:"LAST",notification:"PUSH"};await GameSDK.extra.updateAsync(v)}},Yu=zs,Ys=class extends N{async processAsync(e){try{this.startLog(e);let{matchId:t,playerId:r,opponentId:n}=e,y=new k(this),f=new q(this,{id:t,mode:j.CHALLENGE_FRIEND,customData:{playerId:r,opponentId:n}});y.setNext(f);let w=new zu(this);f.setNext(w);let A=new le(this);w.setNext(A);let x=new J(this);A.setNext(x);let v=new Yu(this);x.setNext(v);let D=new Y(this);v.setNext(D);let I=new $(this);D.setNext(I);let E=this.match.getMatchState();await y.processAsync(E)}finally{this.endLog()}}},Qu=Ys;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var EP={_id:"",status:"",appId:"",createdAt:"",startedAt:null,finishedAt:null,winnerId:"",whitePlayerId:"",blackPlayerId:"",whitePlayerScore:0,blackPlayerScore:0,whitePlayerFinish:!1,blackPlayerFinish:!1,extraData:{}},Ju=EP,{Configs:{AppId:MP},Utils:{Valid:ye}}=Ludex,ge="is invalid",Wt=class extends ee{setupData(e){this.f(e)}d(e){this.p(e)}h(e){this.g(e)}validateId(e){(!ye.isString(e)||!e)&&this.e("_id",ge)}validateStatus(e){(!ye.isString(e)||!e)&&this.e("status",ge)}validateAppId(e){(!ye.isString(e)||e!==MP)&&this.e("appId",ge)}validateCreatedAt(e){ye.isString(e)||this.e("createdAt",ge)}validateStartedAt(e){e!==null&&(ye.isString(e)||this.e("startedAt",ge))}validateFinishedAt(e){e!==null&&(ye.isString(e)||this.e("finishedAt",ge))}validateExtraData(e){e!==null&&(ye.isObject(e)||this.e("extraData",ge))}validateWinnerId(e){e!==null&&(!ye.isString(e)||!e)&&this.e("winnerId",ge)}validateWhitePlayerId(e){(!ye.isString(e)||!e)&&this.e("whitePlayerId",ge)}validateBlackPlayerId(e){(!ye.isString(e)||!e)&&this.e("blackPlayerId",ge)}validateWhitePlayerScore(e){ye.isNumber(e)||this.e("whitePlayerScore",ge)}validateBlackPlayerScore(e){ye.isNumber(e)||this.e("blackPlayerScore",ge)}validateWhitePlayerFinish(e){ye.isBoolean(e)||this.e("whitePlayerFinish",ge)}validateBlackPlayerFinish(e){ye.isBoolean(e)||this.e("blackPlayerFinish",ge)}toObject(){return super.toObject()}};Wt.makeStrict(),Wt.addDefaultData(Ju);var ra=Wt;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Qs=class extends Error{constructor(e){super(e),this.name="MatchAreNotFinished",this.message=e||"Match are not finished"}},Xu=Qs;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Js=class extends Error{constructor(e){super(e),this.name="OpponentNotFinishedMatch",this.message=e||"Opponent not finished match"}},Zu=Js,{Utils:{Object:TP}}=Ludex,Xs=class extends C{async processAsync(e){super.processAsync(e),this.validateMatchData(e);let t=await this.getMatchAsync(e),r=new ra(t).toObject();this.validateResultMatchData(e,r),this.updateMatchData(e,r),this.validatePlayerTurn(e),this.validateOpponentTurn(e),await this.nextAsync(e)}validateMatchData(e){let{id:t}=e;if(typeof t!="string")throw new re}validateResultMatchData(e,t){let{id:r}=e,{_id:n,whitePlayerFinish:y,blackPlayerFinish:f}=t;if(typeof n!="string"||n!==r)throw new yt;if(!y&&!f)throw new Xu}validatePlayerTurn(e){let{profiles:t,customData:r}=e,{playerId:n}=r;if(typeof n!="string")throw new G;let{finished:y}=t[n];if(!y)throw new Yr}validateOpponentTurn(e){let{profiles:t,customData:r}=e,{opponentId:n}=r;if(typeof n!="string")throw new z;let{finished:y}=t[n];if(!y)throw new Zu}async getMatchAsync(e){let{id:t}=e;return t?this.match.api.getMatchAPI().getMatchDetailByIdAsync(t):null}updateMatchData(e,t){this.updateMatchGeneral(e,t),this.updatePlayerIds(e,t),this.initializeProfiles(e),this.updateScoresAndStatus(e,t)}updateMatchGeneral(e,t){let{extraData:r}=t;e.status=W.FINISHED,e.customData=TP.merge(e.customData,r)}updatePlayerIds(e,t){let{whitePlayerId:r,blackPlayerId:n}=t,{customData:y}=e,f=r===y.playerId,w=f?r:n,A=f?n:r;e.customData.playerId=w,e.customData.opponentId=A}initializeProfiles(e){let{playerId:t,opponentId:r}=e.customData;if(!t||!r)return;let n={name:"",photo:"",finished:!0};e.profiles[t]||(e.profiles[t]=S({id:t},n)),e.profiles[r]||(e.profiles[r]=S({id:r},n))}updateScoresAndStatus(e,t){let{playerId:r,opponentId:n}=e.customData;if(!r||!n)return;let{whitePlayerId:y,whitePlayerScore:f,whitePlayerFinish:w,blackPlayerScore:A,blackPlayerFinish:x}=t,v=y===e.customData.playerId;e.profiles[r].score=v?f:A,e.profiles[n].score=v?A:f,e.profiles[r].finished=v?w:x,e.profiles[n].finished=v?x:w}},ep=Xs,Zs=class extends N{async processAsync(e){try{this.startLog(e);let{matchId:t,playerId:r,opponentId:n}=e,y=new k(this),f=new q(this,{id:t,mode:j.CHALLENGE_FRIEND,customData:{playerId:r,opponentId:n}});y.setNext(f);let w=new ep(this);f.setNext(w);let A=new le(this);w.setNext(A);let x=new $(this);A.setNext(x);let v=this.match.getMatchState();await y.processAsync(v)}finally{this.endLog()}}},tp=Zs;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var eo=class extends N{fallbackSingleMode;async processAsync(e){try{this.startLog(e);let{playerId:t,extraData:r,fallbackSingleMode:n}=e;this.fallbackSingleMode=n;let y=await this.startFLowChallengeFriend({playerId:t,extraData:r});if(y===!0)return;if(y instanceof jt)await this.startFlowTournament(t);else if(this.fallbackSingleMode)await this.startFlowSingle(t);else throw y}finally{this.endLog()}}startFLowChallengeFriend=async e=>{try{return await this.match.challenge.invite.processAsync(e),!0}catch(t){return t}};startFlowTournament=async e=>{try{let t=GameSDK.context.getID();if(typeof t!="string")throw new Q;await this.match.tournament.continue.processAsync({playerId:e,contextId:t})}catch{await this.startFlowSingle(e)}};startFlowSingle=async e=>this.match.single.start.processAsync({playerId:e})},rp=eo;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var to=class extends Error{constructor(e){super(e),this.name="LeaderboardIdNotValid",this.message=e??"Leaderboard id is not valid"}},Oe=to;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Valid:ap}=Ludex.Utils,ro=class extends C{payload;leaderboardPayload;constructor(e,t){super(e),this.payload=t}async processAsync(e){super.processAsync(e),this.setupSetScorePayload(e),"submitGameResultsAsync"in GameSDK.extra&&await GameSDK.extra.submitGameResultsAsync(this.payload.score),this.setLeaderboardScoreAsync(),await this.nextAsync(e)}async setupSetScorePayload(e){let{profiles:t,customData:r}=e,{playerId:n}=r;if(!n||!t[n])throw new V;let{score:y,leaderboardId:f}=this.payload;if(!ap.isNumber(y))throw new wt;if(!ap.isString(f))throw new Oe;this.leaderboardPayload={score:y,playerId:n,leaderboardId:f}}async setLeaderboardScoreAsync(){try{let{playerId:e,score:t,leaderboardId:r}=this.leaderboardPayload,n=this.codex.leaderboard.getLeaderboardName(r);if(!n)throw new Zr;await this.codex.leaderboard.setLeaderboardScoreAsync(n,e,t)}catch{}}},aa=ro,{Utils:{Valid:OP}}=Ludex,ao=class extends aa{constructor(e){super(e,{score:0,leaderboardId:""})}async setupSetScorePayload(e){let{profiles:t,customData:r}=e,{playerId:n,leaderboardId:y}=r;if(!y)throw new Oe;if(!n||!t[n])throw new V;let{score:f}=t[n];if(!OP.isNumber(f))throw new wt;this.payload.score=f,this.payload.leaderboardId=y,super.setupSetScorePayload(e)}},At=ao;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var no=class extends C{async processAsync(e){super.processAsync(e),this.validateData(e),this.progressSendGroupMessage(e),await this.nextAsync(e)}validateData(e){let{id:t,customData:r}=e,{contextId:n,opponentId:y}=r;if(!t||typeof t!="string")throw new re;if(!n||typeof n!="string")throw new Q;if(!y||typeof y!="string")throw new z}async createWideframesResultGroupAsync(e){try{let{frameCapture:t}=this.codex,{profiles:r,customData:n}=e,{playerId:y,opponentId:f}=n;if(!y||!f)return null;let w=r[y],A=r[f];if(!w||!A)return null;let{photo:x,score:v=0}=w,{photo:D,score:I=0}=A;return await t.renderAsync("result-challenge",{playerId:y,playerPhoto:x,playerScore:v,opponentId:f,opponentPhoto:D,opponentScore:I,isPlayerFinished:!0,isOpponentFinished:!0})}catch{return null}}async createWideframesBestScoreAsync(e){try{let{player:t,frameCapture:r}=this.codex,{playerId:n}=e.customData,{playerId:y,photo:f,data:w}=t.getPlayer();if(n!==y)return null;let{score:A}=w||{};return await r.renderAsync("share-score",{playerId:y,playerPhoto:f,playerScore:A})}catch{return null}}async progressSendGroupMessage(e){let{profiles:t,customData:r}=e,{playerId:n,opponentId:y}=r;if(y&&typeof y=="string"){if(!n||typeof n!="string")throw new G;let w=t[n],A=t[y];if(!w||!A)return;let{score:x=0}=w,{score:v=0}=A;if(x>v){let D=await this.createWideframesResultGroupAsync(e);if(!D)return;this.sendBestScoreMessageAsync(e,D);return}}let f=await this.createWideframesBestScoreAsync(e);f&&this.sendChallengeMessageAsync(e,f)}async sendBestScoreMessageAsync(e,t){let{profiles:r,customData:n}=e,{playerId:y}=n;if(!y||typeof y!="string")throw new G;if(!("updateAsync"in GameSDK.extra))throw new B("updateAsync");let f=r[y];if(!f)throw new V;let{name:w,score:A}=f,x={data:{type:this.codex.context.getSessionContextTypes().MATCHING_GROUP,playerId:y,playerName:w,playerScore:A},action:"CUSTOM",template:"play_turn",cta:{default:"Play",localizations:{vi_VN:"Ch\u01A1i"}},text:{default:`${w} beats your high score. Their score: ${A}.`,localizations:{vi_VN:`${w} v\u1EEBa v\u01B0\u1EE3t \u0111i\u1EC3m s\u1ED1 cao nh\u1EA5t c\u1EE7a b\u1EA1n! Ch\u01A1i l\u1EA7n n\u1EEFa ch\u1EE9?`}},image:t,strategy:"IMMEDIATE",notification:"PUSH"};if(!("updateAsync"in GameSDK.extra))throw new B("updateAsync");await GameSDK.extra.updateAsync(x)}async sendChallengeMessageAsync(e,t){let{profiles:r,customData:n}=e,{playerId:y}=n;if(!y||typeof y!="string")throw new G;let f=r[y];if(!f)throw new V;let{name:w,score:A}=f,x={data:{type:this.codex.context.getSessionContextTypes().MATCHING_GROUP,playerId:y,playerName:w,playerScore:A},action:"CUSTOM",template:"play_turn",cta:{default:"Play",localizations:{vi_VN:"Ch\u01A1i ngay"}},text:{default:`${w} got ${A} scores. So easy! Can you?`,localizations:{vi_VN:`${w} \u0111\xE3 \u0111\u1EA1t ${A} \u0111i\u1EC3m! Qu\xE1 d\u1EC5 lu\xF4n. Ch\u01A1i l\u1EA1i n\xE0o!`}},image:t,strategy:"IMMEDIATE",notification:"PUSH"};if(!("updateAsync"in GameSDK.extra))throw new B("updateAsync");await GameSDK.extra.updateAsync(x)}},np=no,so=class extends N{async processAsync(){try{this.startLog();let e=new k(this),t=new Me(this,{useAPI:!1});e.setNext(t);let r=new np(this);t.setNext(r);let n=new Ee(this);r.setNext(n);let y=new Te(this);n.setNext(y);let f=new At(this);y.setNext(f);let w=new $(this);f.setNext(w);let A=this.match.getMatchState();await e.processAsync(A)}finally{this.endLog()}}},sp=so;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Dtos:_P}=Ludex,oo=class extends C{payload;constructor(e,t){super(e),this.payload=t}async processAsync(e){super.processAsync(e),this.updateProfileMatchData(e),await this.nextAsync(e)}updateProfileMatchData(e){let{id:t}=this.payload,{profiles:r}=e;if(!r[t])throw new V;let n=S(S({},r[t]),this.payload),y=new _P.Match.Profile(n).toObject();r[y.id]=y}},Ke=oo,io=class extends N{async processAsync(e){try{this.startLog(e);let{playerId:t,opponentId:r,opponentScore:n}=e,y=new k(this),f=new q(this,{id:"7749",mode:j.MATCHING_GROUP,customData:{playerId:t,opponentId:r}});y.setNext(f);let w=new le(this);f.setNext(w);let A=new Ke(this,{id:t,score:n});w.setNext(A);let x=new J(this);A.setNext(x);let v=new Y(this);x.setNext(v);let D=new $(this);v.setNext(D);let I=this.match.getMatchState();await y.processAsync(I)}finally{this.endLog()}}},op=io;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var co=class extends Error{constructor(e){super(e),this.name="MatchGroupNotSupported",this.message=e??"Match group is not supported"}},lo=co,uo=class extends C{payload;constructor(e,t){super(e),this.payload=t}async processAsync(e){super.processAsync(e),await this.checkMatchGroupSupported();let t=await this.matchingGroup();e.customData.contextId=t,await this.nextAsync(e)}async checkMatchGroupSupported(){if(!("getSupportedAPIs"in GameSDK))throw new B("getSupportedAPIs");if(!("checkCanPlayerMatchAsync"in GameSDK.extra))throw new B("checkCanPlayerMatchAsync");if(!(GameSDK.getSupportedAPIs().indexOf("checkCanPlayerMatchAsync")>-1))throw new lo;if(!await GameSDK.extra.checkCanPlayerMatchAsync())throw new lo}async matchingGroup(){if(!("matchPlayerAsync"in GameSDK.extra))throw new B("matchPlayerAsync");let{matchTag:e,autoSwitch:t=!1,onlyExisting:r=!1}=this.payload;await GameSDK.extra.matchPlayerAsync(e,t,r);let n=GameSDK.context.getID();if(typeof n!="string")throw new xt;return n}},ip=uo,po=class extends N{async processAsync(e){try{this.startLog(e);let{matchTag:t,playerId:r,options:n}=e,y=new k(this),f=new ip(this,S({matchTag:t},n));y.setNext(f);let w=new q(this,{id:"7749",mode:j.MATCHING_GROUP,customData:{playerId:r}});f.setNext(w);let A=new ta(this,{ignoreId:r});w.setNext(A);let x=new J(this);A.setNext(x);let v=new le(this);x.setNext(v);let D=new Y(this);v.setNext(D);let I=new $(this);D.setNext(I);let E=this.match.getMatchState();await y.processAsync(E)}finally{this.endLog()}}},cp=po;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var mo=class extends N{async processAsync(){try{this.startLog();let e=new k(this),t=new Me(this,{useAPI:!1});e.setNext(t);let r=new Ee(this);t.setNext(r);let n=new Te(this);r.setNext(n);let y=new He(this);n.setNext(y);let f=new $(this);y.setNext(f);let w=this.match.getMatchState();await e.processAsync(w)}finally{this.endLog()}}},lp=mo;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var ho=class extends Error{constructor(e){super(e),this.name="ProfileIdNotDefined",this.message=e??"Profile id is not defined"}},dp=ho,{Dtos:NP}=Ludex,fo=class extends C{payload;constructor(e,t){super(e),this.payload=t}async processAsync(e){super.processAsync(e);let{profileId:t}=this.payload;if(!t)throw new dp;let{player:r}=this.codex,n=r.getPlayerId(),y;if(t===n)y=this.getPlayerProfile();else if(y=await this.getProfileAsync(t),!y)throw new V;this.updateMatchData(y,e),await this.nextAsync(e)}getPlayerProfile(){let{player:e}=this.codex,{playerId:t,name:r,photo:n,locale:y}=e.getPlayer();return{playerId:t,name:r,photo:n,locale:y}}async getProfileAsync(e){let{profile:t}=this.codex;return await t.requestProfiles([e]),t.getProfiles()[e]}updateMatchData(e,t){let{playerId:r,name:n,photo:y}=e,f=new NP.Match.Profile({id:r,name:n,photo:y}).toObject();t.profiles[r]=f}},_e=fo,yo=class extends N{async processAsync(e){try{this.startLog(e);let{playerId:t}=e,r=new k(this),n=new Ue(this,{contextId:"SOLO"});r.setNext(n);let y=new q(this,{id:"123456",mode:j.SINGLE,customData:{playerId:t}});n.setNext(y);let f=new J(this);y.setNext(f);let w=new _e(this,{profileId:t});f.setNext(w);let A=new Y(this);w.setNext(A);let x=new $(this);A.setNext(x);let v=this.match.getMatchState();await r.processAsync(v)}finally{this.endLog()}}},up=yo;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var go=class extends N{async processAsync(e){try{this.startLog(e);let{setPlayerBestScore:t=!1,postGlobalLeaderboard:r=!1}=e??{},n=new k(this),y=new Me(this,{useAPI:!1});n.setNext(y);let f=new Ee(this);y.setNext(f);let w=new Te(this,{ignore:!t});f.setNext(w);let A=new He(this,{ignore:!r});w.setNext(A);let x=new $(this);A.setNext(x);let v=this.match.getMatchState();await n.processAsync(v)}finally{this.endLog()}}},pp=go;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Po=class extends N{async processAsync(e){try{this.startLog(e);let{matchId:t,playerId:r,gameMode:n,extraData:y={}}=e,f=new k(this),w=new Ue(this,{contextId:"SOLO"});f.setNext(w);let A=new q(this,{id:t,mode:n,customData:S({playerId:r},y)});w.setNext(A);let x=new J(this);A.setNext(x);let v=new _e(this,{profileId:r});x.setNext(v);let D=new Y(this);v.setNext(D);let I=new $(this);D.setNext(I);let E=this.match.getMatchState();await f.processAsync(E)}finally{this.endLog()}}},mp=Po;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Plugins:RP,Utils:kP}=Ludex,{Analytics:GP}=RP,{String:$P,Valid:FP}=kP,xo=class extends C{async processAsync(e){super.processAsync(e);let{mode:t,customData:r}=e;this.validateMode(t);let{analytics:n}=this.codex,{tournamentId:y,leaderboardId:f}=r;n.event(GP.Events.TOURNAMENT_START,{success:!0,game_mode:$P.toUpperCamelCase(t),tournament_id:y,leaderboard_id:f}),await this.nextAsync(e)}validateMode(e){if(!FP.isString(e))throw new ft}},na=xo;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var wo=class extends Error{constructor(e){super(e),this.name="TournamentIdNotValid",this.message=e??"Tournament id is not valid"}},sa=wo,{Valid:Ao}=Ludex.Utils,bo=class extends C{payload;constructor(e,t){super(e),this.payload=t}async processAsync(e){super.processAsync(e);let{contextId:t}=this.payload;this.validateContextId(t);let r=await GameSDK.getTournamentAsync(),n=r.getID().toString(),y=r.getTournamentType();if(this.validateTournamentId(n),e.customData.contextId=t,e.customData.tournamentId=n,y!=="DAILY"){let f=JSON.parse(r.getPayload()||"{}"),{leaderboardId:w}=f;this.validateLeaderboardId(w),e.customData.leaderboardId=w}await this.nextAsync(e)}validateContextId(e){if(!Ao.isString(e))throw new Q}validateTournamentId(e){if(!Ao.isString(e))throw new sa}validateLeaderboardId(e){if(!Ao.isString(e)||e==="")throw new Oe}},hp=bo,vo=class extends N{async processAsync(e){try{this.startLog(e);let{playerId:t,contextId:r}=e,n=new k(this),y=new hp(this,{contextId:r});n.setNext(y);let f=new q(this,{id:"1997",mode:j.TOURNAMENT,customData:{playerId:t}});y.setNext(f);let w=new J(this);f.setNext(w);let A=new _e(this,{profileId:t});w.setNext(A);let x=new Y(this);A.setNext(x);let v=new na(this);x.setNext(v);let D=new $(this);x.setNext(D);let I=this.match.getMatchState();await n.processAsync(I)}finally{this.endLog()}}},fp=vo;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Plugins:BP}=Ludex,{Analytics:VP}=BP,Do=class extends C{async processAsync(e){super.processAsync(e);let{customData:t}=e,{analytics:r}=this.codex,{tournamentId:n,leaderboardId:y}=t;r.event(VP.Events.TOURNAMENT_CREATE,{success:!0,tournament_id:n,leaderboard_id:y}),await this.nextAsync(e)}},yp=Do;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var So=class extends C{payload;constructor(e,t){super(e),this.payload=t}async processAsync(e){super.processAsync(e),await this.createTournamentAsync(),await this.updateMatchStateAsync(e),await this.nextAsync(e)}async createTournamentAsync(){let{name:e,score:t,customData:r}=this.payload;await GameSDK.tournament.createAsync({initialScore:t,config:{title:e,tournamentTitle:e},data:r})}async updateMatchStateAsync(e){try{if(!("getTournamentAsync"in GameSDK))throw new B("getTournamentAsync");let t=await GameSDK.getTournamentAsync(),r=t.getContextID(),n=t.getID().toString(),{playerId:y}=this.payload;e.customData.playerId=y,e.customData.contextId=r,e.customData.tournamentId=n}catch(t){if(t instanceof B)return}}},gp=So;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Valid:Pp}=Ludex.Utils,Io=class extends C{payload;leaderboardPayload;constructor(e,t){super(e),this.payload=t}async processAsync(e){super.processAsync(e),this.validatePayload(),await this.setupCreatePayload(e),await this.createLeaderboardAsync(e),await this.nextAsync(e)}validatePayload(){let{leaderboardId:e}=this.payload;if(!Pp.isString(e))throw new Oe}validatePlayerId(e){if(!Pp.isString(e))throw new G}async setupCreatePayload(e){let{playerId:t}=e.customData;this.validatePlayerId(t);let{name:r,leaderboardId:n,customData:y}=this.payload;this.leaderboardPayload={_id:n,name:r??"",createdBy:t,description:JSON.stringify(y)}}async createLeaderboardAsync(e){let t=await this.codex.leaderboard.createLeaderboardAsync(this.leaderboardPayload);e.customData.leaderboardId=t}},xp=Io,Lo=class extends N{async processAsync(e){try{this.startLog(e);let{playerId:t,name:r,score:n,leaderboardId:y,payload:f}=e,w=new k(this),A=new Ue(this,{contextId:"SOLO"});w.setNext(A);let x=new gp(this,{name:r,score:n,playerId:t,customData:f});A.setNext(x);let v=new _e(this,{profileId:t});x.setNext(v);let D=new Ke(this,{id:t,score:n});v.setNext(D);let I=new xp(this,{name:r,customData:f,leaderboardId:y});D.setNext(I);let E=new At(this);I.setNext(E);let b=new yp(this);E.setNext(b);let T=this.match.getMatchState();await w.processAsync(T)}finally{this.endLog()}}},wp=Lo;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Plugins:{Analytics:Ap},Utils:{Valid:UP}}=Ludex,Co=class extends C{payload;constructor(e,t){super(e),this.payload=t}async processAsync(e){super.processAsync(e),this.validateData(e),await this.postScoreTournamentAsync(e),await this.nextAsync(e)}validateData(e){let{profiles:t,customData:r}=e,{playerId:n}=r;if(this.validatePlayerId(n),!t[n])throw new V}validatePlayerId(e){if(!UP.isString(e))throw new G}getPlayerProfile(e){let{profiles:t,customData:r}=e,{playerId:n}=r;return this.validatePlayerId(n),t[n]}isNewBestScore(e){let t=this.getPlayerProfile(e),{score:r=0,bestScore:n=0}=t;return r>n}async postScoreTournamentAsync(e){let{analytics:t}=codex,r=this.getPlayerProfile(e),{score:n=0}=r,y=null,f=!1,{checkBestScore:w}=this.payload,A=this.isNewBestScore(e);try{if(!("getTournamentAsync"in GameSDK))throw new B("getTournamentAsync");await GameSDK.getTournamentAsync(),!w||A?(y=Ap.Events.TOURNAMENT_SHARE,await GameSDK.tournament.shareAsync({score:n})):(y=Ap.Events.TOURNAMENT_POST_SCORE,await GameSDK.tournament.postScoreAsync(n)),f=!0}catch{}finally{y&&t.event(y,{success:f})}}},bp=Co,Eo=class extends N{async processAsync(e){try{this.startLog(e);let{playerId:t,bestScore:r,checkBestScore:n=!1}=e,y=new k(this),f=new Me(this,{useAPI:!1});y.setNext(f);let w=new Ke(this,{id:t,bestScore:r});f.setNext(w);let A=new bp(this,{checkBestScore:n});w.setNext(A);let x=new Ee(this);A.setNext(x);let v=new Te(this);x.setNext(v);let D=new At(this);v.setNext(D);let I=new He(this);D.setNext(I);let E=new $(this);I.setNext(E);let b=this.match.getMatchState();await y.processAsync(b)}finally{this.endLog()}}},vp=Eo;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Valid:Mo,Object:HP}=Ludex.Utils,To=class extends C{payload;constructor(e,t){super(e),this.payload=t}async processAsync(e){super.processAsync(e);let{tournamentId:t}=this.payload;this.validateTournamentId(t),await this.joinTournamentAsync(t);let r=await GameSDK.getTournamentAsync(),n=r.getContextID();this.validateContextId(n);let y=JSON.parse(r.getPayload()||"{}"),{leaderboardId:f}=y;this.validateLeaderboardId(f),e.customData.contextId=n,e.customData.tournamentId=t,e.customData.leaderboardId=f,await this.nextAsync(e)}validateTournamentId(e){if(!Mo.isString(e))throw new sa}validateContextId(e){if(!Mo.isString(e))throw new Q}validateLeaderboardId(e){if(!Mo.isString(e)||e==="")throw new Oe}async joinTournamentAsync(e){if(!("tournament"in GameSDK))throw new B("tournament");try{await GameSDK.tournament.joinAsync(e)}catch(t){if(!HP.hasOwn(t,"code")||t.code!=="SAME_CONTEXT")throw t}}},Dp=To,Oo=class extends N{async processAsync(e){try{this.startLog(e);let{playerId:t,tournamentId:r}=e,n=new k(this),y=new Dp(this,{tournamentId:r});n.setNext(y);let f=new q(this,{id:"1997",mode:j.TOURNAMENT,customData:{playerId:t}});y.setNext(f);let w=new J(this);f.setNext(w);let A=new _e(this,{profileId:t});w.setNext(A);let x=new Y(this);A.setNext(x);let v=new na(this);x.setNext(v);let D=new $(this);v.setNext(D);let I=this.match.getMatchState();await n.processAsync(I)}finally{this.endLog()}}},Sp=Oo;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Dtos:KP,Utils:jP}=Ludex,{Object:WP}=jP,_o=class extends C{async processAsync(e){super.processAsync(e);let t=await this.getMatchCustomData(e);this.updateMatchCustomData(e,t),await this.nextAsync(e)}async getMatchCustomData(e){let{id:t}=e;return t?(await this.match.api.getMatchAPI().getMatchDetailByIdAsync(t))?.extraData??{}:{}}updateMatchCustomData(e,t){let r=WP.merge(e.customData,t),n=new KP.Match.CustomData(r).toObject();e.customData=n}},Ip=_o;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Dtos:qP,Utils:zP}=Ludex,{Object:YP}=zP,No=class extends C{payload;constructor(e,t){super(e),this.payload=t}async processAsync(e){super.processAsync(e),this.updateMatchCustomData(e),await this.nextAsync(e)}updateMatchCustomData(e){let t=YP.merge(e.customData,this.payload),r=new qP.Match.CustomData(t).toObject();e.customData=r}},Lp=No;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var QP={id:null,mode:null,status:null,startAt:0,finishAt:0,profiles:{},customData:S({},Pt)},Cp=QP,{Configs:Ep}=Ludex,Ro=class extends Ludex.Plugins.BasePlugin{base;group;single;context;strategy;challenge;tournament;api;handler;useCPUProfile;init(){this.createMatchData(),this.createAPIHandler(),this.createBaseConcrete(),this.createConcreteFlows(),this.createConcreteHandlers()}setUseCPUProfile(e){this.useCPUProfile=e}createMatchData(){let{storage:e}=this.codex;e.addStorage("match",Cp)}getMatchState(){let{storage:e}=this.codex;return e.getStorage("match")}createBaseConcrete(){this.base=new N(this.codex,this)}createConcreteFlows(){this.createGroupFlows(),this.createSingleFlows(),this.createContextFlows(),this.createStrategyFlows(),this.createChallengeFlows(),this.createTournamentFlows()}createConcreteHandlers(){this.handler={setProfileData:async e=>{let t=new Ke(this.base,e);await this.processHandlerAsync(t)},setMatchCustomData:async e=>{let t=new Lp(this.base,e);await this.processHandlerAsync(t)},getMatchCustomData:async()=>{let e=new Ip(this.base);await this.processHandlerAsync(e)},setLeaderboardScore:async e=>{let t=new aa(this.base,e);await this.processHandlerAsync(t)}}}createAPIHandler(){let e={appId:Ep.AppId,matchAPIHost:Ep.ApiHost};this.api=new Au(e)}createGroupFlows(){this.group={join:new op(this.codex,this),start:new cp(this.codex,this),finish:new sp(this.codex,this)}}createSingleFlows(){this.single={start:new up(this.codex,this),finish:new lp(this.codex,this)}}createStrategyFlows(){this.strategy={start:new mp(this.codex,this),finish:new pp(this.codex,this)}}createContextFlows(){this.context={choose:new rp(this.codex,this)}}createChallengeFlows(){this.challenge={invite:new Ku(this.codex,this),friend:new Tu(this.codex,this),join:new Qu(this.codex,this),await:new Lu(this.codex,this),result:new tp(this.codex,this),finish:new Fu(this.codex,this),continue:new Ru(this.codex,this)}}createTournamentFlows(){this.tournament={join:new Sp(this.codex,this),create:new wp(this.codex,this),finish:new vp(this.codex,this),continue:new fp(this.codex,this)}}processHandlerAsync(e){let t=this.getMatchState();return e.processAsync(t)}},Mp=Ro;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Valid:Je}=Ludex.Utils,Xe="is invalid",qt=class extends ee{setupData(e){this.f(e)}d(e){this.p(e)}h(e){this.g(e)}validateLevel(e){(!Je.isNumber(e)||e<0)&&this.e("level",Xe)}validateRescued(e){(!Je.isNumber(e)||e<0)&&this.e("rescued",Xe)}validateContextId(e){Je.isString(e)||this.e("contextId",Xe)}validatePlayerId(e){Je.isString(e)||this.e("playerId",Xe)}validateOpponentId(e){!Je.isString(e)&&e!==null&&this.e("opponentId",Xe)}validateTournamentId(e){!Je.isString(e)&&e!==null&&this.e("tournamentId",Xe)}validateLeaderboardId(e){!Je.isString(e)&&e!==null&&this.e("leaderboardId",Xe)}toObject(){return super.toObject()}};qt.makeStrict(),qt.addDefaultData(Pt);var Tp=qt;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Valid:bt}=Ludex.Utils,vt="is invalid",oa=class extends ee{setupData(e){this.f(e)}d(e){this.p(e)}h(e){this.g(e)}validateId(e){(!bt.isString(e)||!e)&&this.e("id",vt)}validateName(e){(!bt.isString(e)||!e)&&this.e("name",vt)}validatePhoto(e){bt.isString(e)||this.e("photo",vt)}validateScore(e){(!bt.isNumber(e)||e<0)&&this.e("score",vt)}validateBestScore(e){(!bt.isNumber(e)||e<0)&&this.e("bestScore",vt)}validateFinished(e){bt.isBoolean(e)||this.e("finished",vt)}toObject(){return super.toObject()}};oa.addDefaultData({id:"",name:"Your Friend",photo:"./assets/images/others/avatar.png",score:0,bestScore:0,finished:!1});var Op=oa;Ludex.Dtos.Match={Data:ra,Profile:Op,CustomData:Tp};var _p=Mp;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Np=[{id:"finish-level",title:"Finish 1 level",require:{level:1},reward:{coin:300},duration:1e3*60*60*24}],ko=class{async getMissionsAsync(){return[...Np]}},Rp=ko;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var JP={tasks:[],process:{}},kp=JP,{Utils:{Json:Gp,Valid:$p,Object:ia}}=Ludex,Go=class extends Ludex.Plugins.BasePlugin{api;init(){let{storage:e}=this.codex;e.addStorage("missions",kp,!0),this.api=new Rp}async requestMissions(){let e=await this.api.getMissionsAsync(),t=Date.now();for(let r of e)r.expirationTime=t+r.duration;this.receivePlayerMissionData(e)}addMission(e){let{storage:t}=this.codex,{id:r,duration:n,expirationTime:y}=e;y||(e.expirationTime=Date.now()+n);let f=t.getStorageData("missions","tasks")??[],w=f.findIndex(x=>x.id===r);if(w!==-1){let x=ia.merge(f[w],e);f[w]=x}else f.push(e);let A=[...f];t.setStorageData("missions","tasks",A),this.addProcessLog(e),this.updatePlayerMissionProcess(),t.updateToWebStorage("missions")}addProcessLog(e){let{storage:t}=this.codex,{id:r,require:n}=e,y={},f=Object.keys(n);for(let A of f)y[A]=0;let w=t.getStorageData("missions","process")??{};w[r]={require:y,rewarded:!1},t.setStorageData("missions","process",w)}removeMission(e){let{storage:t}=this.codex,r=t.getStorageData("missions","tasks");if(!r)return;let n=r.filter(y=>y.id!==e);t.setStorageData("missions","tasks",n),this.removeProcessLog(e),t.updateToWebStorage("missions")}removeProcessLog(e){let{storage:t}=this.codex,r=t.getStorageData("missions","process")??{};if(r[e]){let{require:n}=r[e],y=Object.keys(n);for(let f of y)n[f]=0;r[e]={require:n,rewarded:!1}}t.setStorageData("missions","process",r)}receivePlayerMissionData(e){let{storage:t}=this.codex,r=t.getStorageData("missions","tasks")??[],n=this.filterMissionByExpirationTime(r),y=this.combineMissions(e,n);t.setStorageData("missions","tasks",y);let f=this.filterExistingSavedProcess(n);this.receiveProcessLogs(y,f),this.updatePlayerMissionProcess(),t.updateToWebStorage("missions")}filterExistingSavedProcess(e){let{player:t}=this.codex,r=t.getPlayerDataByKey("missionsData"),{process:n={}}=r||{},y=e.map(A=>A.id),f=Object.keys(n).filter(A=>!y.includes(A)),w={};for(let A of f)w[A]=n[A];return w}filterMissionByExpirationTime(e){let t=Date.now();return e.filter(r=>{let{expirationTime:n}=r;return n?t<n:!1})}combineMissions(e,t){let r=t.map(y=>y.id),n=e.filter(y=>{let{id:f}=y;return!r.includes(f)});return[...t,...n]}receiveProcessLogs(e,t){let r={};for(let n of e){let{id:y,require:f}=n;if(ia.hasOwn(t,y)){r[y]=Gp.clone(t[y]);return}let w={},A=Object.keys(f);for(let x of A)w[x]=0;r[y]={require:w,rewarded:!1}}this.updateMissionProcess(r)}updateMissionProcess(e){let{storage:t}=this.codex;t.setStorageData("missions","process",e),t.updateToWebStorage("missions")}getPlayerMissionProcess(){let{player:e}=this.codex,t=e.getPlayerDataByKey("missionsData"),{process:r}=t||{};return Gp.clone(r)}addMissionValue(e){let{id:t,type:r,value:n}=e,y=this.getPlayerMissionProcess();if(!$p.isObject(y))return;let f=y,w=Object.keys(f).filter(A=>A.includes(t));for(let A of w){let x=f[A];!x||x.rewarded||(x.require[r]+=n)}this.updateMissionProcess(f),this.updatePlayerMissionProcess()}setMissionRewardClaimed(e){let t=this.getPlayerMissionProcess();if(!$p.isObject(t))return;let r=t;ia.hasOwn(r,e)&&(r[e].rewarded=!0,this.updateMissionProcess(r),this.updatePlayerMissionProcess())}updatePlayerMissionProcess(){let{player:e}=this.codex,t=this.codex.storage.getStorageData("missions","process"),r=this.getPlayerMissionProcess(),n=ia.merge(r,t);e.setPlayerDataByName("missionsData",{process:n})}},Fp=Go,Bp=Fp;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Utils:{Object:XP},Configs:{ApiHost:Vp}}=Ludex,ZP=()=>{let e=GameSDK.getSDKName(),t="players";switch(e){case"MsGames":t+="?platform=ms-games";break;case"Yandex":t+="?platform=yandex";break;default:break}return t},Up=async e=>{if(!Vp)return{};let t=ZP(),r=await he(t,e,{},Vp,10);return XP.hasOwn(r,"data")?r.data||{}:{}},{Utils:{Array:ex,Object:ca,Valid:tx,Function:rx},Configs:{AppId:ax}}=Ludex,$o=class extends Ludex.Plugins.BasePlugin{isLoggedIn=!1;init(){let{storage:e}=this.codex;e.addStorage("player",Pe)}receiveData(e,t){let{storage:r}=this.codex,{playerId:n,name:y,photo:f,locale:w}=e;r.setStorageData("player","playerId",n),r.setStorageData("player","name",y),r.setStorageData("player","photo",f),r.setStorageData("player","locale",w),t&&(this.setPlayerData(t),this.isLoggedIn=!t.isFirstLogin)}async syncDataToSDK(){try{let e=this.getPlayerData();await GameSDK.player.setDataAsync(e)}catch{}}async syncProfileToServer(){if(GameSDK.extra.isGuest)throw new Error("Guest player cannot sync profile to server");let{storage:e}=this.codex,t=this.getPlayer(),{playerId:r,name:n,photo:y,locale:f}=t,w=this.getPlayerASID();if(!tx.isString(w)&&"getASIDAsync"in GameSDK.player){let[A,x]=await rx.handleAsync(GameSDK.player.getASIDAsync(),1e4);!x&&A&&(w=A,e.setStorageData("player","ASID",w))}await Up({appId:ax,ASID:w,playerId:r,name:n,photo:y,locale:f})}setPlayerDataByName(e,t){this.setPlayerData({[e]:t})}setPlayerData(e){let{storage:t}=this.codex;t.setStorageData("player","data",e),this.syncDataToSDK()}setBestScore(e){this.setPlayerDataByName("score",e)}setSetting(e,t){this.setPlayerDataByName("settings",{[e]:t})}setGameData(e){let t=this.getGameData()??{},r=ca.merge(t,e);this.setPlayerDataByName("gameData",r)}async requestConnectedPlayers(){let{storage:e}=this.codex,t=(await GameSDK.player.getConnectedPlayersAsync()).map(y=>{let f=y.getID(),w=y.getName(),A=y.getPhoto();return!f||!w||!A?null:new ut({playerId:f,name:w,photo:A}).toObject()}),r=ex.unique(t);if(r.length<1)return;let n=ca.keyBy(r,"playerId");e.setStorageData("player","connectedPlayers",n)}getPlayer(){let{storage:e}=this.codex;return e.getStorage("player")}getPlayerId(){let{storage:e}=this.codex;return e.getStorageData("player","playerId")??""}getPlayerASID(){let{storage:e}=this.codex;return e.getStorageData("player","ASID")??null}getPlayerLocale(){let{storage:e}=this.codex;return e.getStorageData("player","locale")??""}getPlayerData(){let{storage:e}=this.codex;return e.getStorageData("player","data")??Pe.data}getPlayerDataByKey(e){let t=this.getPlayerData();return ca.hasOwn(t,e)?t[e]:null}getGameData(){return this.getPlayerDataByKey("gameData")}getPlayerSetting(e){let t=this.getPlayerSettings();return ca.hasOwn(t,e)?t[e]:null}getPlayerSettings(){let{settings:e}=this.getPlayerData();return e}isFirstLogin(){return this.getPlayerDataByKey("isFirstLogin")??Pe.data.isFirstLogin}isFirstSession(){return!this.isLoggedIn}loggedIn(){this.setPlayerDataByName("isFirstLogin",!1)}getBestScore(){let{score:e}=this.getPlayerData();return e}getConnectedPlayers(){let{storage:e}=this.codex;return e.getStorageData("player","connectedPlayers")??{}}getConnectedPlayerIds(e,t){let r=this.getConnectedPlayers();return Object.keys(r).slice(t,t+e)}getNotificationData(){return this.getPlayerDataByKey("notificationData")??Pe.data.notificationData}},Hp=$o;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Dtos:Kp,Utils:{Valid:de}}=Ludex,{score:nx,settings:sx,gameData:ox,isFirstLogin:ix,missionsData:cx,notificationData:lx,dailyRewardedData:dx,lastCallSwitchGame:ux}=Pe.data,ne="is invalid",la=class extends ee{processData(e){this.d(e),e.settings=new Kp.Player.Settings(e.settings).toObject(),e.gameData=new Kp.Player.GameData(e.gameData).toObject(),this.h(e),this.setupData(e)}setupData(e){this.f(e)}d(e){this.p(e)}h(e){this.g(e)}validateScore(e){(!de.isNumber(e)||e<0)&&this.e("score",ne)}validateSettings(e){de.isObject(e)||this.e("settings",ne)}validateMissionsData(e){de.isObject(e)||this.e("missionsData",ne),(!("process"in e)||!de.isObject(e.process))&&this.e("missionsData.process",ne)}validateNotificationData(e){de.isObject(e)||this.e("notificationData",ne),(!("D1"in e)||!de.isObject(e.D1))&&this.e("notificationData.D1",ne),(!("D2"in e)||!de.isObject(e.D2))&&this.e("notificationData.D2",ne),(!("D3"in e)||!de.isObject(e.D3))&&this.e("notificationData.D3",ne),(!("D4"in e)||!de.isObject(e.D4))&&this.e("notificationData.D4",ne),(!("D5"in e)||!de.isObject(e.D5))&&this.e("notificationData.D5",ne),(!("D6"in e)||!de.isObject(e.D6))&&this.e("notificationData.D6",ne),(!("D7"in e)||!de.isObject(e.D7))&&this.e("notificationData.D7",ne)}validateGameData(e){de.isObject(e)||this.e("gameData",ne)}validateIsFirstLogin(e){de.isBoolean(e)||this.e("isFirstLogin",ne)}validateDailyRewardedData(e){de.isObject(e)||this.e("dailyRewardedData",ne)}validateLastCallSwitchGame(e){de.isNumber(e)||this.e("lastCallSwitchGame",ne),e<0&&this.e("lastCallSwitchGame",ne)}toObject(){return super.toObject()}};la.addDefaultData({score:nx,settings:sx,gameData:ox,isFirstLogin:ix,missionsData:cx,notificationData:lx,dailyRewardedData:dx,lastCallSwitchGame:ux});var jp=la;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Valid:Wp}=Ludex.Utils,{level:px,coins:mx}=Pe.data.gameData,da=class extends ee{setupData(e){this.f(e)}d(e){this.p(e)}h(e){this.g(e)}validateLevel(e){(!Wp.isNumber(e)||e<0)&&this.e("level","is invalid")}validateCoins(e){(!Wp.isNumber(e)||e<0)&&this.e("coins","is invalid")}toObject(){return super.toObject()}};da.addDefaultData({level:px,coins:mx});var qp=da;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Valid:ua}=Ludex.Utils,{sound:hx,music:fx,vibrate:yx,language:gx}=Pe.data.settings,pa="is invalid",ma=class extends ee{setupData(e){this.f(e)}d(e){this.p(e)}h(e){this.g(e)}validateSound(e){ua.isBoolean(e)||this.e("sound",pa)}validateMusic(e){ua.isBoolean(e)||this.e("music",pa)}validateVibrate(e){ua.isBoolean(e)||this.e("vibrate",pa)}validateLanguage(e){(!ua.isString(e)||!e)&&this.e("language",pa)}toObject(){return super.toObject()}};ma.addDefaultData({sound:hx,music:fx,vibrate:yx,language:gx});var zp=ma;Ludex.Dtos.Player={Info:ut,Data:jp,Settings:zp,GameData:qp};var Yp=Hp;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Configs:{ApiHost:Qp,Mockup:Px},Utils:{Object:xx,String:wx}}=Ludex,Fo=class{mockAPI;async initMockAPI(){if(this.mockAPI)return;let e=(await Promise.resolve().then(()=>(O(),Z))).default;if(typeof e!="function")throw new Error("Cannot load ProfileAPIMock");this.mockAPI=new e}async getPlayersAsync(e){let t=wx.params(e),r;if(Px.Profile.Enabled)await this.initMockAPI(),r=await this.mockAPI.getPlayersAsync(e);else{if(!Qp)return[];r=await Re(`players?${t}`,{},Qp)}return!xx.hasOwn(r,"data")||!Array.isArray(r.data)?[]:r.data}},Jp=Fo;s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Ax={profiles:{},profileIds:[]},Bo=Ax,{Utils:bx,Dtos:vx}=Ludex,{Array:Xp,Valid:Dx,Object:Sx,Function:Ix}=bx,Vo=class extends Ludex.Plugins.BasePlugin{profileAPI=new Jp;init(){let{storage:e}=this.codex;e.addStorage("profile",Bo)}async requestProfiles(e){let t=this.getProfileIds(),r=Xp.difference(e,t);if(r.length<1)return;let n=Xp.chunk(r,400).map(w=>this.profileAPI.getPlayersAsync({playerIds:w})),y=(await Ix.allSettled(n)).reduce((w,A)=>A.status==="fulfilled"?w.concat(A.value):w,[]);if(!this.validateProfilesResponse(y))return;let f=this.convertToProfiles(y);this.setProfiles(f)}getProfile(e){return this.getProfiles()[e]??null}getProfiles(){let{storage:e}=this.codex;return e.getStorageData("profile","profiles")??Bo.profiles}setProfiles(e){let{storage:t}=this.codex;t.setStorageData("profile","profiles",e),t.setStorageData("profile","profileIds",Object.keys(e))}getProfileIds(){let{storage:e}=this.codex;return e.getStorageData("profile","profileIds")??[]}validateProfilesResponse(e){return!(!Array.isArray(e)||e.length<1)}convertToProfiles(e){let t={};for(let r of e)Sx.hasOwn(r,"playerId")&&Dx.isString(r.playerId)&&(t[r.playerId]=new vx.Player.Info(r).toObject());return t}},Zp=Vo,em=Zp;O(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var tm="Dinosaurs Merge Master",{Utils:{Object:rm,Valid:am,Browser:nm}}=Ludex,Uo=class extends Ludex.Plugins.BasePlugin{storages;storageLocalKeys={};constructor(e){super(e),this.storages={}}async addStorage(e,t,r=!1){this.storages[e]=t,r&&await this.initFromWebStorage(e,t)}async initFromWebStorage(e,t){this.storageLocalKeys[e]=!0;let r=await nm.getIndexedDB(`${tm}_S_${e}`);if(!am.isObject(r))return;let n=Object.keys(t);for(let y of n)rm.hasOwn(r,y)&&typeof t[y]==typeof r[y]&&this.setStorageData(e,y,r[y])}initStorageData(e,t,r){this.storages[e][t]=r}setStorageData(e,t,r){let n;if(am.isObject(r)){let y=this.getStorageData(e,t);n=rm.merge(y,r)}else n=r;this.storages[e][t]=n}getStorageData(e,t){return this.getStorage(e)[t]}getStorage(e){return this.storages[e]}async updateToWebStorage(e){if(this.storageLocalKeys[e])return this.saveToWebStorage(e)}async saveToWebStorage(e){let t=this.getStorage(e);return nm.setIndexedDB(`${tm}_S_${e}`,t)}},sm=Uo,om=sm;s(),o(),i(),c(),l(),d(),u(),p(),m(),h(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var Ho=class extends Ludex.Plugins.BasePlugin{isVisible=!0;browserPrefixes=["moz","ms","o","","webkit"];init(){let e=this.getBrowserPrefix(),t=[this.getVisibilityEvent(e),"focus","blur"];for(let r of t)this.registerEvent(window,r),this.registerEvent(document,r);GameSDK.extra&&("onPause"in GameSDK.extra&&GameSDK.extra.onPause(()=>this.handleVisibilityChange("blur")),"onResume"in GameSDK.extra&&GameSDK.extra.onResume(()=>this.handleVisibilityChange("focus"))),this.registerEvent(window,"pageshow"),this.registerEvent(window,"pagehide"),window.addEventListener("message",r=>{(r.data==="nativePause"||r.data==="nativeResume")&&this.handleVisibilityChange(r.data)},!1)}isGameVisible(){return this.isVisible}getHiddenPropertyName(e){return e?`${e}Hidden`:"hidden"}getVisibilityEvent(e){return`${e||""}visibilitychange`}getBrowserPrefix(){for(let e of this.browserPrefixes)if(this.getHiddenPropertyName(e)in document)return e;return""}onVisibleEvent(){this.isVisible||(this.isVisible=!0,this.codex.event.emit(Ludex.Events.VISIBILITY_VISIBLE))}onHiddenEvent(){this.isVisible&&(this.isVisible=!1,this.codex.event.emit(Ludex.Events.VISIBILITY_HIDDEN))}registerEvent(e,t){e.addEventListener(t,()=>{this.handleVisibilityChange(t)},!1)}handleVisibilityChange=e=>{let t={focus:this.onVisibleEvent.bind(this),pageshow:this.onVisibleEvent.bind(this),nativeResume:this.onVisibleEvent.bind(this),blur:this.onHiddenEvent.bind(this),pagehide:this.onHiddenEvent.bind(this),nativePause:this.onHiddenEvent.bind(this)};if(t[e]){t[e]();return}if(document.visibilityState){document.visibilityState==="hidden"?this.onHiddenEvent():this.onVisibleEvent();return}let r=this.getBrowserPrefix(),n=this.getHiddenPropertyName(r);n in document&&(document[n]?this.onHiddenEvent():this.onVisibleEvent())}},im=Ho,cm=im;rr(),O(),O(),O(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{Utils:{Object:lm},Plugins:{Ads:{Status:Ae,Types:Ge,AdError:ha,AdInstance:Lx}}}=Ludex,Ko=class extends Lx{service;instance;instanceQueue=[];constructor(e,t){super(e,t),this.service=GameSDK.getSDKName(),this.instance=null}async loadAsync(){if(!(this.instance&&this.status===Ae.FILLED)){if(this.status!==Ae.IDLE)throw new ha("AD_NOT_READY","Ad is not ready.");try{if(this.instance=await this.createInstanceByType(this.type),this.instance===null)throw new ha("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");this.setStatus(Ae.LOADING),await this.instance.loadAsync(),this.setStatus(Ae.FILLED),this.logAdLoad()}catch(e){throw this.setStatus(Ae.IDLE),e instanceof Object&&"code"in e&&e.code==="INVALID_PARAM"&&(this.instance=null),this.instance&&this.pushInstanceToQueue(this.instance),self.codex.analytics.loadAdFail({type:this.type,service:this.service}),e}}}async showAsync(){if(this.status!==Ae.FILLED)throw new ha("AD_NOT_FILLED","Ad is not filled.");if(this.instance===null)throw new ha("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");let e=!1;try{this.setStatus(Ae.SHOWING),self.codex.analytics.showingAd({type:this.type,service:this.service}),await this.instance.showAsync(),e=!0,this.setStatus(Ae.IDLE),this.instance=null}catch(t){throw lm.hasOwn(t,"code")&&(t.code==="AD_NOT_LOADED"&&this.setStatus(Ae.IDLE),["INVALID_PARAM","INVALID_OPERATION","USER_INPUT"].indexOf(`${t.code}`)>-1&&(this.setStatus(Ae.IDLE),this.instance=null),t.code==="USER_INPUT"&&(e=!0)),this.status===Ae.SHOWING&&(this.setStatus(Ae.IDLE),this.instance=null),t}finally{e?this.logAdShown():self.codex.analytics.showAdFail({type:this.type,service:this.service})}}async createInstanceByType(e){try{return await this.getAdInstanceByType(e)}catch(t){return lm.hasOwn(t,"code")&&t.code==="ADS_TOO_MANY_INSTANCES"?this.getAdInstanceFailed():null}}async getAdInstanceByType(e){switch(e){case Ge.REWARDED_VIDEO:return await GameSDK.getRewardedVideoAsync(this.placementId);case Ge.INTERSTITIAL:return await GameSDK.getInterstitialAdAsync(this.placementId);case Ge.REWARDED_INTERSTITIAL:return await GameSDK.getRewardedInterstitialAsync(this.placementId);default:return null}}getAdInstanceFailed(){if("canLoadAd"in GameSDK.extra){for(let e of this.instanceQueue)if(GameSDK.extra.canLoadAd(e))return this.instanceQueue.splice(this.instanceQueue.indexOf(e),1),e}else return this.instanceQueue.shift()||null;return null}logAdLoad(){switch(this.type){case Ge.INTERSTITIAL:self.codex.analytics.loadInterstitialAd({service:this.service});break;case Ge.REWARDED_VIDEO:self.codex.analytics.loadRewardedVideoAd({service:this.service});break;case Ge.REWARDED_INTERSTITIAL:self.codex.analytics.loadRewardedInterstitialAd({service:this.service});break}}logAdShown(){switch(this.type){case Ge.INTERSTITIAL:self.codex.analytics.showInterstitialAd({service:this.service});break;case Ge.REWARDED_VIDEO:self.codex.analytics.showRewardedVideoAd({service:this.service});break;case Ge.REWARDED_INTERSTITIAL:self.codex.analytics.showRewardedInterstitialAd({service:this.service});break}}pushInstanceToQueue(e){this.instanceQueue.push(e)}},dm=Ko;O(),O(),O(),O(),O(),s(),o(),i(),c(),l(),d(),u(),p(),m(),h();var{BaseAnalytics:Cx,Events:Dt}=Ludex.Plugins.Analytics,Ex=[Dt.SCREEN_OPEN],{Utils:{Array:Mx}}=Ludex,jo=class extends Cx{constructor(e,t){super(e,"GoogleAnalytics",R(S({},t),{color:"#E35335"}))}processEvent(e,t){Mx.has(Ex,e)||(this.customEvent(e,t),gtag("event",e,t))}customEvent(e,t){switch(e){case Dt.AD_SHOW:case Dt.AD_SHOW_FAILED:case Dt.AD_SHOWING:case Dt.USE_ITEM:case Dt.EARN_ITEM:this.addLevelName(t);break;default:break}}addLevelName(e){if(!e||!this.codex?.match)return;let t=this.codex.match.getMatchState().customData.level;!t||t<0||(e.level_name=this.getLevelName(t))}},fa=jo;O(),O(),O();var gm="production",zo=null,{Dtos:_x,Events:je,Configs:{AppId:Nx,Ads:Ie,Analytics:ya,Debugger:Ne,Firebase:Pm,Notification:Rx,RemoteConfig:xm,PerformanceMonitor:kx,AdaptivePerformance:wm},Plugins:{Ads:{Types:ga}},Utils:{Device:Gx,Object:Am,Json:zt,String:bm,Valid:$x,Time:Fx,Function:Bx,Mark:X}}=Ludex,Yo=class extends od{markName="Core Initialize";modulePlugins=[];getBuildVersion(){return parseInt(`${zo}`)||0}async boot(){super.boot(),this.addPlugins(),this.initEventPlugin(),this.event.emit(je.CORE_BOOTING),this.Ue(),this.initFirebasePlugin(),this.initMarkCoreInitialize(),X.putAttr(this.markName,"Step","Init Analytics"),this.initGoogleAnalytics(),this.initClarityAnalytics(),this.initFirebaseAnalytics(),this.initYandexAnalytics(),this.initXiaomiAnalytics(),this.initFacebookAnalytics(),this.initTranssionH5Analytics(),X.putAttr(this.markName,"Step","Init Plugins"),this.initAds(),this.initMatchPlugin(),this.initRemoteConfig(),X.putAttr(this.markName,"Step","Load Lazy Plugins"),$x.isDebugger()||this.event.on(je.MODULE_PLUGIN_READY,this.handleProtectGameInstance),this.addMonitorPlugin().then(this.initMonitorErrorPlugin),this.addCanvasRecorderPlugin().then(this.initCanvasRecorderPlugin),this.addAdaptivePerformancePlugin().then(this.initAdaptivePerformancePlugin),this.addInputRecorderPlugin().then(this.initInputRecorderPlugin),X.putAttr(this.markName,"Step","Load Dev Plugins"),this.event.catchUp(je.GAME_SDK_READY,this.addDevPlugins)}async Ue(){await Fx.sleepAsync(5e3),this.event.getEventListeners(je.CORE_BOOTING).length}async start(){super.start(),X.putAttr(this.markName,"Step","Core Start"),this.event.emit(je.CORE_STARTING),X.putAttr(this.markName,"Step","Request Token"),await this.auth.requestToken(),X.putAttr(this.markName,"Step","Init States"),await this.initState(),X.putAttr(this.markName,"Step","Process Player Profile"),this.processPlayerProfile(),GameSDK.getSDKName()==="FacebookInstant"&&Gx.isIOS()?this.event.catchUp(je.GAME_SDK_STARTED,this.processContextSession):await this.processContextSession(),X.putAttr(this.markName,"Step","Core Ready"),X.putAttr(this.markName,"Success","true"),this.event.emit(je.CORE_READY)}processContextSession=async()=>{X.putAttr(this.markName,"Step","Process Context Payload"),await this.context.detectContextSessionType(),this.context.detectContextGameMode();let e=this.context.getSessionContextType();X.putAttr(this.markName,"Context Mode",e),X.stop(this.markName)};addPlugins(){this.installPlugin("Storage",om),this.installPlugin("Event",nu),this.installPlugin("Ads",xd),this.installPlugin("Auth",Rd),this.installPlugin("Audio",Od),this.installPlugin("Match",_p),this.installPlugin("Player",Yp),this.installPlugin("Profile",em),this.installPlugin("Context",Hd),this.installPlugin("Language",iu),this.installPlugin("Missions",Bp),this.installPlugin("Analytics",Id),this.installPlugin("Visibility",cm),this.installPlugin("Leaderboard",gu),this.installPlugin("DailyRewards",Jd),this.installPlugin("FrameCapture",M),this.installPlugin("RemoteConfig",M),"Proxy"in window&&this.installPlugin("Firebase",M)}installPlugin(e,t,r=!1){let n=bm.toCamelCase(bm.capitalize(e));this.plugins.install(e,t,!0,n),e!=="Storage"&&(r?this.emitModulePluginReady(e):this.emitCorePluginReady(e))}async addMonitorPlugin(){try{let{MonitorError:e}=Ne;if(!e.Enabled)return;this.modulePlugins.push("MonitorError");let t=(await Promise.resolve().then(()=>(O(),Z))).default;if(typeof t!="function")return;this.installPlugin("MonitorError",t,!0)}catch{}}async addCanvasRecorderPlugin(){try{let{CanvasRecorder:e}=Ne;if(!e.Enabled)return;this.modulePlugins.push("CanvasRecorder");let t=(await Promise.resolve().then(()=>(O(),Z))).default;if(typeof t!="function")throw new Error("CanvasRecorderPlugin is not a function");this.installPlugin("CanvasRecorder",t,!0)}catch{}}async addAdaptivePerformancePlugin(){try{if(!wm.Enabled)return;this.modulePlugins.push("AdaptivePerformance");let e=(await Promise.resolve().then(()=>(ym(),fm))).default;if(typeof e!="function")return;this.installPlugin("AdaptivePerformance",e,!0)}catch{}}async addInputRecorderPlugin(){try{let{InputRecorder:e}=Ne;if(!e.Enabled)return;this.modulePlugins.push("InputRecorder");let t=(await Promise.resolve().then(()=>(O(),Z))).default;if(typeof t!="function")return;this.installPlugin("InputRecorder",t,!0)}catch{}}addDevPlugins=()=>{let{ListPlayerDevIds:e}=Ne,t=this.player.getPlayerId();gm!=="development"&&(!t||e.indexOf(t)<0)||(this.addConsolePlugin(),this.addProfilerPlugin())};async addConsolePlugin(){try{let{Console:e}=Ne;if(!e.Enabled)return;this.modulePlugins.push("Console");let t=(await Promise.resolve().then(()=>(O(),Z))).default;if(typeof t!="function")throw new Error("ConsolePlugin is not a function");this.installPlugin("Console",t,!0),this.initConsolePlugin()}catch{}}async addProfilerPlugin(){try{let{Profiler:e}=Ne;if(!e.Enabled)return;this.modulePlugins.push("Profiler");let t=(await Promise.resolve().then(()=>(O(),Z))).default;if(typeof t!="function")throw new Error("ProfilerPlugin is not a function");this.installPlugin("Profiler",t,!0),this.initProfilerPlugin()}catch{}}emitCorePluginReady(e){this.event.emit(pe.CORE_PLUGIN_READY,{name:e})}emitModulePluginReady(e){this.event.emit(pe.MODULE_PLUGIN_READY,{name:e})}handleProtectGameInstance=()=>{let e=this.event.getEventEmitCount(pe.MODULE_PLUGIN_READY),t=this.modulePlugins.length;e<t||(window.codex=Object.freeze(window.codex),tt(window,"codex"))};initEventPlugin(){let{EventLogging:e}=Ne;e.Enabled&&this.event.enableLogEvent()}initMatchPlugin(){this.match.setUseCPUProfile(!1)}initAds(){this.ads.configure(Ie),this.initGoogleAds(),this.initTranssionH5Ads(),this.initAdInstance(),Ie.Enabled&&this.analytics.initAdEvent({adService:"platform",state:"loaded"})}async initGoogleAds(){try{if(!Ie.Enabled)return;let{AdSense:e}=Ie.AdServiceConfigs;if(!e.Enabled)return;let t=new M(this);await t.initAsync({usePreload:e.UsePreload,dataAdHost:e.DataAdHost,dataAdClient:e.DataAdClient,dataAdChannel:e.DataAdChannel,dataAdBreakTest:e.DataAdBreakTest,dataAdFrequencyHint:e.DataAdFrequencyHint}),window.GoogleAds=t}catch{}}async initTranssionH5Ads(){try{if(!Ie.Enabled)return;let{Savana:e}=Ie.AdServiceConfigs;if(!e.Enabled)return;let t=new M(this);await t.initAsync({usePreload:e.UsePreload,dataAdHost:e.DataAdHost,dataAdClient:e.DataAdClient,dataAdChannel:e.DataAdChannel,dataAdBreakTest:e.DataAdBreakTest,dataAdFrequencyHint:e.DataAdFrequencyHint}),window.TranssionH5Ads=t}catch{}}getAdInstanceByService(e,t=!1){let{AdSense:r,AppLovin:n,Savana:y}=Ie.AdServiceConfigs;switch(e){case"adsense":if(r.Enabled)return M;break;case"applovin":n.Enabled;break;case"savana":if(y.Enabled)return M;break;default:return t?M:dm}return null}initAdInstance(){for(let t of Ie.InterstitialAdOptions){let r=this.getAdInstanceByService(t.AdService);r&&this.ads.setAdInstance(ga.INTERSTITIAL,t.PlacementId,r)}for(let t of Ie.RewardedVideoAdOptions){let r=this.getAdInstanceByService(t.AdService);r&&this.ads.setAdInstance(ga.REWARDED_VIDEO,t.PlacementId,r)}for(let t of Ie.RewardedInterstitialAdOptions){let r=this.getAdInstanceByService(t.AdService);r&&this.ads.setAdInstance(ga.REWARDED_INTERSTITIAL,t.PlacementId,r)}let e=!0;for(let t of Ie.BannerDisplayAdOptions){let r=this.getAdInstanceByService(t.AdService,e);r&&this.ads.setAdInstance(ga.BANNER,t.PlacementId,r)}}async initState(){try{let e=new pd(this);e.initContext(),await e.initPlayer()}catch{}}initConsolePlugin(){this.console&&this.console.configure()}initProfilerPlugin(){this.profiler&&this.profiler.configure()}initCanvasRecorderPlugin=()=>{if(!this.canvasRecorder)return;let{CanvasRecorder:e}=Ne,{Type:t,Quality:r,RecordFps:n,SyncFps:y}=e.Options;this.canvasRecorder.configure({type:t,quality:r,syncFps:y,recordFps:n}),this.canvasRecorder.setPanelExpanded(e.PanelExpanded);let f=document.querySelector("canvas");f&&this.canvasRecorder.setCanvas(f)};initMonitorErrorPlugin=()=>{if(!this.monitorError)return;let{MonitorError:e,ListPlayerDevIds:t}=Ne,{ApiKey:r,Service:n,Feedback:y,TrackUser:f,FilterErrors:w}=e,{playerId:A,name:x}=this.player.getPlayer();A&&t.indexOf(A)>=0||(window.disableSimpleTrackErrors?.(),this.monitorError.configure({apiKey:r,service:n,feedback:y,trackUser:f,releaseStage:gm,buildVersion:`${zo??1}`}),this.monitorError.setUser({id:A,name:x}),this.monitorError.addFilterErrors(w),this.monitorError.initFeedbackTrackErrors(),this.updateMonitorErrorUserAndMetadata(),this.processErrorsQueue())};updateMonitorErrorUserAndMetadata=()=>{this.event.catchUp(je.PLAYER_INFO_LOADED,this.processWhenPlayerInfoLoaded)};processErrorsQueue=()=>{if(this.monitorError&&Array.isArray(window.__errorQueue)){for(let e of window.__errorQueue)if(e instanceof Error)this.monitorError.sendException(e);else{let t=Bx.toError(e);this.monitorError.sendException(t)}window.__errorQueue=null}};processWhenPlayerInfoLoaded=()=>{if(!this.monitorError)return;let{playerId:e,name:t}=this.player.getPlayer();this.monitorError.setUser({id:e,name:t}),this.monitorError.addMetadata({isFirstSession:this.player.isFirstSession()})};initRemoteConfig(){if(!xm.Enabled)return;let e=zt.clone(xm);this.remoteConfig.configure(e),this.event.on(pe.REQUEST_SAVE_CONFIG,this.handleSaveRemoteConfig),this.event.on(pe.REQUEST_UPDATE_CONFIG,this.handleUpdateLudexConfig),this.event.catchUp(pe.PLAYER_INFO_LOADED,this.handleStorageCurrentRemoteConfig)}handleSaveRemoteConfig=e=>{try{let t={[e.type]:e};this.player.setPlayerDataByName("remoteConfig",t)}catch{}};handleUpdateLudexConfig=e=>{try{let{id:t,type:r}=e;if(r!=="Ludex")return;Ludex.Configs=Am.merge(Ludex.Configs,e.config);let{Ads:n}=Ludex.Configs;this.ads.configure(n),this.event.emit(pe.REMOTE_CONFIG_UPDATED,{id:t,type:r})}catch{}};handleStorageCurrentRemoteConfig=()=>{let e=this.player.getPlayerDataByKey("remoteConfig");if(e){for(let t in e)if(Am.hasOwn(e,t)){let r=e[t],n=zt.clone(r),y=new _x.RemoteConfig.Data(n).toObject();this.remoteConfig.setRemoteConfig(y),this.remoteConfig.processUpdateConfig(y.id,y.type)}}};initFirebasePlugin(){if(!Pm.Enabled||!this.firebase)return;let e=zt.clone(Pm);this.firebase.configure(e),X.setService(this.firebase.services.performance)}initMarkCoreInitialize(){kx.CoreFlows&&(X.measure(this.markName),X.putAttr(this.markName,"Build",`${zo}`),X.putAttr(this.markName,"GameSDK",GameSDK.getSDKName()),X.putAttr(this.markName,"Platform",GameSDK.getPlatform()),X.putAttr(this.markName,"Success","false"),X.start(this.markName))}initAdaptivePerformancePlugin=()=>{if(!this.adaptivePerformance)return;let e=zt.clone(wm);this.adaptivePerformance.configure(e)};initInputRecorderPlugin=()=>{if(!this.inputRecorder)return;let{InputRecorder:e}=Ne,t=zt.clone(e);t&&this.inputRecorder.configure(t)};async processPlayerProfile(){try{await this.player.syncProfileToServer(),this.processAfterSyncProfile()}catch{}}processAfterSyncProfile=()=>{Rx.Enabled&&this.updatePlayerProfileToNotificationService()};async updatePlayerProfileToNotificationService(){try{let e=this.player.getPlayer(),{ASID:t,playerId:r,name:n,photo:y,locale:f}=e;await dd({appId:Nx,ASID:t,playerId:r,name:n,photo:y,locale:f})}catch{}}initGoogleAnalytics(){let{Enabled:e,ConsoleLog:t}=ya.GoogleAnalytics??{};e&&(typeof fa!="function"||!(fa.prototype instanceof Object)||this.analytics.add(new fa(this.codex,{log:!!t})))}initClarityAnalytics(){let{Enabled:e,ConsoleLog:t}=ya.ClarityAnalytics??{};if(!e||typeof M!="function"||!(M.prototype instanceof Object))return;let r=new M(this.codex,{log:!!t}),n=this.player.getPlayer(),{playerId:y}=n;r.setUser(y,GameSDK.extra?.isGuest??!0),this.analytics.add(r)}initFirebaseAnalytics(){let{Enabled:e,ConsoleLog:t}=ya.FirebaseAnalytics??{};if(!e||typeof M!="function"||!(M.prototype instanceof Object))return;let r=new M(this.codex,{log:!!t});this.analytics.add(r);let n="no_entry";GameSDK.getEntryPointAsync().then(y=>{n=y}).catch(y=>{}).finally(()=>{let y=this.player.getPlayer(),{playerId:f,locale:w}=y,{fbig_ad_id:A,fbig_adset_id:x,fbig_campaign_id:v,fb_instant_game_adset_id:D,fb_instant_game_ad_id:I,fb_instant_game_campaign_id:E}=GameSDK.getEntryPointData()||{},b=A||I,T=x||D,U=v||E;r.setUser(f,{locale:w,ad_id:b,adset_id:T,campaign_id:U,traffic_source:n})})}initYandexAnalytics(){GameSDK.getSDKName()==="Yandex"&&this.analytics.add(new M(this.codex))}initXiaomiAnalytics(){GameSDK.getSDKName()==="Xiaomi"&&this.analytics.add(new M(this.codex))}initFacebookAnalytics(){let e=GameSDK.getSDKName(),{Enabled:t,Prefix:r,ConsoleLog:n}=ya.FacebookAnalytics??{};!t||e!=="FacebookInstant"||typeof r=="string"&&this.analytics.add(new M(this.codex,{prefix:r,log:!!n}))}initTranssionH5Analytics(){GameSDK.getSDKName()==="TranssionH5"&&this.analytics.add(new M(this.codex))}},vm=Yo,{Configs:{GameEngine:{ForceDesktopDPR:Pa}},Utils:{Device:Vx},Events:Qo}=Ludex,Ux=async()=>{let e=new vm;window.codex=e,typeof globalThis<"u"&&(globalThis.codex=e);let t=20;window.__sdkLoadingCount<t&&(window.__sdkLoadingCount=t),await e.boot(),e.event.catchUp(Qo.REQUEST_CORE_START,Sm)},Dm=!1,Sm=()=>{if(Dm)return;if(codex.event.getEventEmitCount(Qo.GAME_SDK_READY)<1){codex.event.catchUp(Qo.GAME_SDK_READY,Sm);return}codex.start(),Dm=!0;let e=25;window.__sdkLoadingCount<e&&(window.__sdkLoadingCount=e)};Pa!==!1&&Vx.isDesktop()&&typeof Pa=="number"&&Pa>0&&(window.devicePixelRatio=Pa),window.originalRequestAnimationFrame=window.requestAnimationFrame,window.isCustomRequestAnimationFrame=window.isCustomRequestAnimationFrame??!0,window.isCustomRequestAnimationFrame&&(window.requestAnimationFrame=e=>window.isCustomRequestAnimationFrame?(setTimeout(e,1e3/60),0):window.originalRequestAnimationFrame(e)),Ux();
