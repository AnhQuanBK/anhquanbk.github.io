"use strict";(self.webpackChunkgame_core=self.webpackChunkgame_core||[]).push([[249],{708:function(t,n,e){var r=e(247),s=e.n(r),i=e(17),o=e(1),a=e(16),c=e.n(a),u=e(42),d=e.n(u),f=function(){function t(){this.payments=void 0}var n=t.prototype;return n.getLocale=function(){return null},n.getPlatform=function(){return null},n.getSDKVersion=function(){return"0.0"},n.getSupportedAPIs=function(){return[]},n.getEntryPointData=function(){return null},n.getEntryPointAsync=function(){return new(d())((function(t){t("")}))},n.canCreateShortcutAsync=function(){return new(d())((function(t,n){n(new Error("Not implemented"))}))},n.quit=function(){},n.performHapticFeedbackAsync=function(){return d().resolve()},t}(),h=function(){function t(){}var n=t.prototype;return n.getID=function(){return null},n.getType=function(){return"SOLO"},t}(),l=function(t){function n(n){var e;return(e=t.call(this)||this).sdk=void 0,e.sdk=n,e}(0,o.A)(n,t);var e=n.prototype;return e.getID=function(){return this.sdk.getID()},e.getType=function(){return this.sdk.getType()},e.isSizeBetween=function(t,n){return this.sdk.isSizeBetween(t,n)},e.switchAsync=function(t){return this.sdk.switchAsync(t)},e.chooseAsync=function(t){return this.sdk.chooseAsync(t)},e.createAsync=function(t){return this.sdk.createAsync(t)},e.getPlayersAsync=function(){return this.sdk.getPlayersAsync()},n}(h),y=l,p=function(){},A=function(t){function n(n){var e;return(e=t.call(this)||this).sdk=void 0,e.sdk=n,e}(0,o.A)(n,t);var e=n.prototype;return e.getID=function(){return this.sdk.getID()},e.getASIDAsync=function(){return this.sdk.getASIDAsync()},e.getSignedASIDAsync=function(){return this.sdk.getSignedASIDAsync()},e.getName=function(){return this.sdk.getName()},e.getPhoto=function(){return this.sdk.getPhoto()},e.getDataAsync=function(t){return this.sdk.getDataAsync(t)},e.setDataAsync=function(t){return this.sdk.setDataAsync(t)},e.flushDataAsync=function(){return this.sdk.flushDataAsync()},e.getSignedPlayerInfoAsync=function(t){return this.sdk.getSignedPlayerInfoAsync(t)},e.canSubscribeBotAsync=function(){return this.sdk.canSubscribeBotAsync()},e.subscribeBotAsync=function(){return this.sdk.subscribeBotAsync()},e.getConnectedPlayersAsync=function(){return this.sdk.getConnectedPlayersAsync()},e.isGuest=function(){return!1},n}(p),g=A,v=function(t){function n(n){var e;return(e=t.call(this)||this).sdk=void 0,e.player=void 0,e.context=void 0,e.graphApi=void 0,e.tournament=void 0,e.sdk=n,e.player=new g(n.player),e.context=new y(n.context),e}(0,o.A)(n,t);var e=n.prototype;return e.getLocale=function(){return this.sdk.getLocale()},e.getPlatform=function(){return this.sdk.getPlatform()},e.getSDKVersion=function(){return this.sdk.getSDKVersion()},e.initializeAsync=function(){return this.sdk.initializeAsync()},e.setLoadingProgress=function(t){this.sdk.setLoadingProgress(t)},e.getSupportedAPIs=function(){return this.sdk.getSupportedAPIs()},e.getEntryPointData=function(){return this.sdk.getEntryPointData()},e.getEntryPointAsync=function(){return this.sdk.getEntryPointAsync()},e.setSessionData=function(t){this.sdk.setSessionData(t)},e.startGameAsync=function(){return this.sdk.startGameAsync()},e.shareAsync=function(t){return this.sdk.shareAsync(t)},e.updateAsync=function(t){return this.sdk.updateAsync(t)},e.switchGameAsync=function(t,n){return this.sdk.switchGameAsync(t,n)},e.canCreateShortcutAsync=function(){return this.sdk.canCreateShortcutAsync()},e.createShortcutAsync=function(){return this.sdk.createShortcutAsync()},e.quit=function(){this.sdk.quit()},e.logEvent=function(t,n,e){return this.sdk.logEvent(t,n,e)},e.onPause=function(t){this.sdk.onPause(t)},e.getInterstitialAdAsync=function(t){return this.sdk.getInterstitialAdAsync(t)},e.getRewardedVideoAsync=function(t){return this.sdk.getRewardedVideoAsync(t)},e.matchPlayerAsync=function(t,n,e){return this.sdk.matchPlayerAsync(t,n,e)},e.checkCanPlayerMatchAsync=function(){return this.sdk.checkCanPlayerMatchAsync()},e.getLeaderboardAsync=function(t){return this.sdk.getLeaderboardAsync(t)},e.postSessionScoreAsync=function(t){return this.sdk.postSessionScoreAsync(t)},e.loadBannerAdAsync=function(t){return this.sdk.loadBannerAdAsync(t)},e.hideBannerAdAsync=function(){return this.sdk.hideBannerAdAsync()},e.showGameRating=function(){var t=(0,i.A)(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",d().reject(new Error("CLIENT_UNSUPPORTED_OPERATION")));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),e.getTournamentAsync=function(){return this.sdk.getTournamentAsync()},e.inviteAsync=function(t){return this.sdk.inviteAsync(t)},e.shareLinkAsync=function(t){return this.sdk.shareLinkAsync(t)},n}(f),w=v,S=e(34),m=function(){},k=function(t){function n(){var n;return(n=t.call(this)||this).code=void 0,n.name="USER_INPUT",n.code="USER_INPUT",n.message="User closed rewarded ad!",n}return(0,o.A)(n,t),n}((0,e(126).A)(Error)),I=function(t){function n(n,e){var r;return(r=t.call(this)||this).sdk=void 0,r.type=void 0,r.sdk=e,r.type=n,r}(0,o.A)(n,t);var e=n.prototype;return e.getPlacementID=function(){return"privateId"},e.loadAsync=function(){return new(d())((function(t){t()}))},e.showAsync=function(){var t=this;return new(d())((function(n,e){"interstitial"===t.type?t.sdk.send("VKWebAppShowNativeAds",{ad_format:EAdsFormats.INTERSTITIAL}).then((function(t){t.result?n():e()})).catch(e):"rewarded"===t.type?t.sdk.send("VKWebAppShowNativeAds",{ad_format:EAdsFormats.REWARD}).then((function(t){t.result?n():e(new k)})).catch(e):e(new Error("Unknown ad type"))}))},n}(m),D=I,P=function(t){function n(n){var e;return(e=t.call(this)||this).sdk=void 0,e.sdk=n,e}(0,o.A)(n,t);var e=n.prototype;return e.getID=function(){return null},e.getType=function(){return"SOLO"},e.isSizeBetween=function(t,n){return null},e.switchAsync=function(t){return new(d())((function(t,n){n(new Error("Unsupported"))}))},e.chooseAsync=function(){return new(d())((function(t,n){n(new Error("Unsupported"))}))},e.createAsync=function(t){return new(d())((function(t,n){n(new Error("Unsupported"))}))},e.getPlayersAsync=function(){return new(d())((function(t,n){n(new Error("Unsupported"))}))},n}(h),_=P,E=e(404),b=e.n(E),L=e(72),B=e.n(L),T=e(28),K=e.n(T),G=e(74),U=e.n(G),V=e(43),N=e.n(V),x=e(104),C=e.n(x),W=e(136),O=e.n(W),M="GuestID",R="GuestData",q="GuestStats",z=function(){function t(t){this._personalInfo=void 0,this._uniqueId=void 0,this._name=void 0,this._photo=void 0,this._playerData=void 0,this._playerStats=void 0,t?(this._uniqueId=t.id,this._name=t.name,this._photo=t.photo):(this._uniqueId=this.checkAndGetIdFromLocalStorage(),this._name="GUEST"),this._personalInfo={id:this._uniqueId,avatarIdHash:"0",lang:"ru",publicName:this.getName(),uniqueID:this._uniqueId,scopePermissions:{avatar:"forbid",public_name:"forbid"}},this._playerData=this.getDataFromLocalStorage(),this._playerStats=this.getStatsFromLocalStorage()}var n=t.prototype;return n.getUniqueID=function(){return this._uniqueId},n.getName=function(){return this._name},n.getPhoto=function(){return this._photo||""},n.getMode=function(){return""},n.getData=function(t){var n=this;if(t){var e=C()(t).call(t,(function(t,e){var r;return(0,S.A)({},t,((r={})[e]=n._playerData[e],r))}),{});return d().resolve(e)}return d().resolve(this._playerData)},n.setData=function(t){return this._playerData=(0,S.A)({},this._playerData,t),this.writeDataToLocalStorage(this._playerData),d().resolve(!0)},n.setStats=function(t){return this._playerStats=(0,S.A)({},this._playerStats,t),this.writeStatsToLocalStorage(this._playerStats),d().resolve(!0)},n.incrementStats=function(t){for(var n=0,e=O()(t);n<e.length;n++){var r=e[n],s=r[0],i=r[1];this._playerStats[s]=(this._playerStats[s]||0)+i}return this.writeStatsToLocalStorage(this._playerStats),d().resolve(this._playerStats)},n.getStats=function(t){var n=this;if(t){var e=C()(t).call(t,(function(t,e){var r;return(0,S.A)({},t,((r={})[e]=n._playerStats[e],r))}),{});return d().resolve(e)}return d().resolve(this._playerStats)},n.getIDsPerGame=function(){return d().resolve([])},n.checkAndGetIdFromLocalStorage=function(){var t=localStorage.getItem(M);if(null!=t)return t;var n=this.getRandomID();return localStorage.setItem(M,n),n},n.getRandomID=function(){return"GUEST_"+Math.random().toString(36).substr(2,15)},n.getDataFromLocalStorage=function(){var t=localStorage.getItem(R);return t?JSON.parse(t):{}},n.writeDataToLocalStorage=function(t){return localStorage.setItem(R,U()(t))},n.getStatsFromLocalStorage=function(){var t=localStorage.getItem(q);return t?JSON.parse(t):{}},n.writeStatsToLocalStorage=function(t){return localStorage.setItem(q,U()(t))},t}(),F="_stats-",j=function(t){function n(n){var e;return(e=t.call(this)||this).sdk=void 0,e.player=void 0,e.sdk=n,e}(0,o.A)(n,t);var e=n.prototype;return e.initPlayerAsync=function(){var t=(0,i.A)(c().mark((function t(){var n=this;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new(d())((function(t){n.sdk.send("VKWebAppGetUserInfo",{}).then((function(t){n.player=new z({id:""+t.id,name:t.first_name+" "+t.last_name,photo:t.photo_100})})).catch((function(){n.player=new z})).finally(t)})));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),e.getSignedASIDAsync=function(){throw new Error("Method not implemented.")},e.rejectPlayerNotInitialized=function(){return d().reject(new Error("Player is not initialized"))},e.getID=function(){var t,n;return null!=(t=null==(n=this.player)?void 0:n.getUniqueID())?t:null},e.getASIDAsync=function(){var t;return d().resolve(null!=(t=this.getID())?t:"")},e.getName=function(){var t,n,e=null!=(t=null==(n=this.player)?void 0:n.getName())?t:null;return""===e?"Anonymous":e},e.getPhoto=function(){var t,n;return null!=(t=null==(n=this.player)?void 0:n.getPhoto())?t:null},e.getDataAsync=function(t){var n=this;return new(d())((function(e,r){n.validateIsLogged(r),t?n.sdk.send("VKWebAppStorageGet",{keys:t}).then((function(t){var n={};b()(t).forEach((function(t){""!=t.value&&(n[t.key]=JSON.parse(t.value))})),e(n)})).catch(r):n.getStorageKeys().then((function(t){return e(n.getDataAsync(t))})).catch(r)}))},e.setDataAsync=function(t){var n=this;return new(d())((function(e,r){n.validateIsLogged(r);var s=B()(t),i=K()(s).call(s,(function(e){return n.sdk.send("VKWebAppStorageSet",{key:e,value:U()(t[e])})}));d().all(i).then((function(){e()})).catch(r)}))},e.flushDataAsync=function(){var t=this;return new(d())((function(n,e){t.getStorageKeys().then((function(e){var r={};e.forEach((function(t){return r[t]=""})),t.setDataAsync(r).then(n)})).catch(e)}))},e.getStorageKeys=function(){var t=this;return new(d())((function(n,e){t.sdk.send("VKWebAppStorageGetKeys",{count:100,offset:0}).then((function(t){n(b()(t))})).catch(e)}))},e.getSignedPlayerInfoAsync=function(){var t,n,e=this,r=null!=(t=null==(n=this.player)?void 0:n.getUniqueID())?t:this.rejectPlayerNotInitialized();return new(d())((function(t,n){"string"===typeof r?t({getPlayerID:function(){var t;return null!=(t=e.getID())?t:"10"},getSignature:function(){return r}}):n(new Error("Can't get player signed"))}))},e.canSubscribeBotAsync=function(){return new(d())((function(t){t(!1)}))},e.subscribeBotAsync=function(){return new(d())((function(t,n){n(new Error("Unsupported"))}))},e.getStatsAsync=function(t){var n=this;return void 0===t&&(t=[]),new(d())((function(e,r){n.validateIsLogged(r);var s=K()(t).call(t,(function(t){return F+t}));e(n.getDataAsync(s))}))},e.setStatsAsync=function(t){var n=this;return new(d())((function(e,r){n.validateIsLogged(r);for(var s=B()(t),i=K()(s).call(s,(function(t){return F+t})),o={},a=0;a<s.length;a++)o[i[a]]=t[s[a]];e(n.setDataAsync(o))}))},e.incrementStatsAsync=function(t){var n=this;return new(d())((function(e,r){n.validateIsLogged(r);var s=B()(t);n.getStatsAsync(s).then((function(r){var i={};s.forEach((function(n){i[n]=Number(r[F+n])+t[n]})),n.setStatsAsync(i).then((function(){return e(i)}))}))}))},e.getConnectedPlayersAsync=function(t){var n=this,e=GameCore.Configs.AppToken;return new(d())((function(r){t?n.sdk.send("VKWebAppCallAPIMethod",{method:"users.get",request_id:"connectedPlayers",params:{user_ids:t.join(","),fields:"photo",v:"5.131",access_token:e}}).then((function(t){var n=[];t.response.forEach((function(t){n.push({getID:function(){return t.id},getName:function(){return t.first_name+" "+t.last_name},getPhoto:function(){return t.photo||"./assets/images/others/avatar.png"}})})),r(n)})).catch((function(){r([])})):r([])}))},e.isGuest=function(){if(!this.player)return!0;var t=this.getID();return!t||"GUEST"==N()(t).call(t,0,5)},e.validateIsLogged=function(t){this.player||t(new Error("Player is not initialized"))},n}(p),H=j,J=function(t){return t.TOP="top",t.BOTTOM="bottom",t}(J||{}),Q=function(t){function n(n){var e;return(e=t.call(this)||this).sdk=void 0,e.player=void 0,e.context=void 0,e.graphApi=void 0,e.tournament=void 0,e.rewardedAdInstance=void 0,e.interstitialAdInstance=void 0,e.currentPercentLoading=0,e.platform=void 0,e.initSDKAsync=function(){return new(d())((function(t){e.player=new H(e.sdk),e.context=new _(e.sdk),e.rewardedAdInstance=new D("rewarded",e.sdk),e.interstitialAdInstance=new D("interstitial",e.sdk);var n=e.sdk.send("VKWebAppGetClientVersion",{});d().all([n,e.player.initPlayerAsync()]).then((function(t){var n=t[0];t[1];e.platform=n.platform})).finally(t)}))},e.sdk=n,e}(0,o.A)(n,t);var e=n.prototype;return e.getLocale=function(){return"ru"},e.getSDKVersion=function(){return"1.0"},e.getSupportedAPIs=function(){return["getLocale","getSDKVersion","initializeAsync","startGameAsync","setLoadingProgress","getInterstitialAdAsync","getRewardedVideoAsync","getPlatform","loadBannerAdAsync","hideBannerAdAsync"]},e.initializeAsync=function(){var t=(0,i.A)(c().mark((function t(){var n;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(n=document.getElementById("lds-content"))||((n=document.createElement("div")).id="lds-content",n.innerHTML='<div id="lds-dual-ring"></div><div id="lds-text"><span id="lds-percent">0</span>% \u043d\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u043d\u044b\u0439</div>',"complete"===document.readyState?document.body.appendChild(n):window.addEventListener("load",(function(){n&&document.body.appendChild(n)}))),n.hidden=!1,t.next=6,this.sdk.send("VKWebAppInit",{});case 6:return t.next=8,this.initSDKAsync();case 8:t.next=14;break;case 10:throw t.prev=10,t.t0=t.catch(0),console.error("initializeAsync",t.t0),t.t0;case 14:case"end":return t.stop()}}),t,this,[[0,10]])})));return function(){return t.apply(this,arguments)}}(),e.startGameAsync=function(){var t,n;return this.setLoadingProgress(100),null==(t=document.getElementById("lds-content"))||t.remove(),null==(n=document.getElementById("splash-screen"))||n.remove(),d().resolve()},e.setLoadingProgress=function(t){var n=document.getElementById("lds-percent");n&&(this.currentPercentLoading=Math.round(Math.max(Math.min(t,100),this.currentPercentLoading)),n.innerHTML=""+this.currentPercentLoading,this.currentPercentLoading=t)},e.setSessionData=function(t){},e.shareAsync=function(t){return this.inviteAsync((0,S.A)({},t))},e.updateAsync=function(t){return new(d())((function(t,n){n(new Error("Unsupported"))}))},e.switchGameAsync=function(t){return new(d())((function(t,n){n(new Error("Unsupported"))}))},e.canCreateShortcutAsync=function(){var t=this;return new(d())((function(n){t.sdk.send("VKWebAppAddToHomeScreenInfo").then((function(t){n(t.is_feature_supported&&t.is_added_to_home_screen)}))}))},e.createShortcutAsync=function(){var t=this;return new(d())((function(n,e){t.sdk.send("VKWebAppAddToHomeScreen").then((function(t){t.result?n():e()}))}))},e.logEvent=function(){return null},e.onPause=function(t){},e.getInterstitialAdAsync=function(t){var n=this;return new(d())((function(t){t(n.interstitialAdInstance)}))},e.getRewardedVideoAsync=function(t){var n=this;return new(d())((function(t){t(n.rewardedAdInstance)}))},e.matchPlayerAsync=function(t){return new(d())((function(t,n){n(new Error("Unsupported"))}))},e.checkCanPlayerMatchAsync=function(){return new(d())((function(t,n){n(!1)}))},e.getLeaderboardAsync=function(t){return d().reject()},e.postSessionScoreAsync=function(t){return new(d())((function(t,n){n(new Error("Unsupported"))}))},e.getPlatform=function(){return"web"!==this.platform?"MOBILE_WEB":"WEB"},e.inviteAsync=function(t){var n=this;return new(d())((function(t,e){setTimeout(e,3e3),n.sdk.send("VKWebAppShowInviteBox",{}).then((function(){e()})).catch((function(){e()}))}))},e.getTournamentAsync=function(){return d().reject(new Error("Unsupported"))},e.loadBannerAdAsync=function(){var t=(0,i.A)(c().mark((function t(n){var e,r;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e="top"===n?J.TOP:J.BOTTOM,t.next=4,this.sdk.send("VKWebAppShowBannerAd",{banner_location:e});case 4:r=t.sent,console.log("bannerInfo",r),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.warn("loadBannerAdAsync",t.t0);case 11:case"end":return t.stop()}}),t,this,[[0,8]])})));return function(n){return t.apply(this,arguments)}}(),e.setBannerAdSize=function(t,n){},e.hideBannerAdAsync=function(){var t=(0,i.A)(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.sdk.send("VKWebAppHideBannerAd");case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.warn("hideBannerAdAsync",t.t0);case 8:case"end":return t.stop()}}),t,this,[[0,5]])})));return function(){return t.apply(this,arguments)}}(),e.showGameRating=function(){var t=(0,i.A)(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",d().reject());case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),e.showLeaderboard=function(t){this.sdk.send("VKWebAppShowLeaderBoardBox",{user_result:t})},e.happyTime=function(){},e.shareLinkAsync=function(t){return d().reject(new Error("Unsupported"))},n}(f),X=Q;"FBInstant"in window&&(window.GameSDK=new w(window.FBInstant)),"vkBridge"in window&&(window.GameSDK=new X(s())),window.FBInstant=window.GameSDK}}]);