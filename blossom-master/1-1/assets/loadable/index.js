function _ts_generator(e,t){var n,a,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},l=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return l.next=verb(0),l.throw=verb(1),l.return=verb(2),"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function verb(e){return function(t){return step([e,t])}}function step(u){if(n)throw new TypeError("Generator is already executing.");while(l&&(l=0,u[0]&&(r=0)),r)try{if(n=1,a&&(i=2&u[0]?a.return:u[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,u[1])).done)return i;if(a=0,i)u=[2&u[0],i.value];switch(u[0]){case 0:case 1:i=u;break;case 4:return r.label++,{value:u[1],done:false};case 5:r.label++,a=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===u[0]||2===u[0])){r=0;continue}if(3===u[0]&&(!i||u[1]>i[0]&&u[1]<i[3])){r.label=u[1];break}if(6===u[0]&&r.label<i[1]){r.label=i[1],i=u;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(u);break}if(i[2])r.ops.pop();r.trys.pop();continue}u=t.call(e,r)}catch(e){u=[6,e],a=0}finally{n=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:true}}}function _ts_values(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],a=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){if(e&&a>=e.length)e=void 0;return{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}System.register("chunks:///loadable.js",["./rollupPluginModLoBabelHelpers-41cf6f9b.js","cc","./GlowDot-a2a2ca3d.js","./AnalyticsUtils-9a227e15.js"],function(){var e,t,n,a,i,r,l,u,h,v,f,y,m,g,C,B,w,E,T,L,I,D,A,R,_,M,P,N,O,x,z,U,G,F,K,q,V,W,j,J,H,Y,X,Z,Q,$,ee,et,en,ea,ei,er,eo,es,el,ec,eu,eh;return{setters:[function(g){e=g._,t=g.a,n=g.b,a=g.c,i=g.d,r=g.e,l=g.f,u=g.h,h=g.l,v=g.k,f=g.n,y=g.g,m=g.j},function(e){g=e.cclegacy,C=e._decorator,B=e.Label,w=e.Color,E=e.Component,T=e.Node,L=e.UITransform,I=e.Widget,D=e.Button,A=e.game,R=e.Sprite,_=e.Vec3,M=e.view,P=e.director,N=e.UIOpacity,O=e.CCBoolean,x=e.find,z=e.instantiate,U=e.EditBox,G=e.tween},function(e){F=e.C,K=e.G,q=e.j,V=e.f,W=e.L,j=e.k,J=e.D,H=e.e,Y=e.c,X=e.I,Z=e.h,Q=e.b},function(e){$=e.c,ee=e.h,et=e.G,en=e.S,ea=e.e,ei=e.g,er=e.d,eo=e.R,es=e.i,el=e.f,ec=e.x,eu=e.s,eh=e.A}],execute:function(){var ed,ep,ev,ef,ey,em,eg,eC,eS,eb,ek,eB,ew,eE,eT,eL,eI,eD,eA,eR;g._RF.push({},"66df6DPSKpI0oxfXTqbbb1l","BundleSizeMonitor",void 0);var e_,eM,eP,eN,eO=C.ccclass,ex=C.property,ez=(ed=eO("BundleSizeMonitor"),ep=ex(B),ev=F.required,ef=ex(B),ey=F.required,em=ex(B),eg=F.required,eC=ex(B),eS=F.required,eb=ex(B),ek=F.required,eB=ex(B),ew=F.required,ed((eT=e((eE=function(e){t(s,e);var u=n(s);function s(){var e;a(this,s);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return e=u.call.apply(u,[this].concat(n)),i(e,"bundleSizeNative",eT,r(e)),i(e,"totalRequestsNative",eL,r(e)),i(e,"timeMeasuredNative",eI,r(e)),i(e,"bundleSizeNative32",eD,r(e)),i(e,"totalRequestsNative32",eA,r(e)),i(e,"timeMeasuredNative32",eR,r(e)),e}return l(s,[{key:"__preload",value:function(){F.validateRequiredProperties(this,s),this.updateMonitor(),this.node.active=!1}},{key:"updateMonitor",value:function(){var e=localStorage.getItem("bundlesSize");if(e){var t=JSON.parse(e||"{}");this.bundleSizeNative.string="Bundle Size: ".concat(t.native.totalSize," kB"),this.totalRequestsNative.string="Total Requests: ".concat(t.native.totalRequests),this.timeMeasuredNative.string="Time: ".concat(t.native.timeMeasured),this.bundleSizeNative.color=t.native.totalSize>3e3?new w(255,0,0,255):new w(0,255,0,255);var n=localStorage.getItem("bundlesSize32");if(n){var a=JSON.parse(n||"{}");this.bundleSizeNative32.string="Bundle Size: ".concat(a.native32.totalSize," kB"),this.totalRequestsNative32.string="Total Requests: ".concat(a.native32.totalRequests),this.timeMeasuredNative32.string="Time: ".concat(a.native32.timeMeasured)}}}}]),s}(E)).prototype,"bundleSizeNative",[ep,ev],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eL=e(eE.prototype,"totalRequestsNative",[ef,ey],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eI=e(eE.prototype,"timeMeasuredNative",[em,eg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eD=e(eE.prototype,"bundleSizeNative32",[eC,eS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eA=e(eE.prototype,"totalRequestsNative32",[eb,ek],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eR=e(eE.prototype,"timeMeasuredNative32",[eB,ew],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eE))||eE);g._RF.pop(),g._RF.push({},"f885817nJZM0aNJCvlRnF6r","DevToolScreenManager",void 0);var eU,eG,eF,eK,eq,eV,eW,ej,eJ,eH,eY,eX,eZ,eQ,e$=C.ccclass,e0=C.property,e1=globalThis.game.event,e3=GameCore.Events,e2=(e_=e$("DevToolScreenManager"),eM=e0([T]),e_((eN=e((eP=function(e){t(c,e);var h=n(c);function c(){var e;a(this,c);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return e=h.call.apply(h,[this].concat(n)),i(e,"screens",eN,r(e)),e.mapScreens=new Map,e.currentScreen=null,e.previousScreen=null,e.handleOpenedScreen=function(t){var n;if(-1===["FinishTournamentInfoScreen","ChapterCompleteScreen","ChapterCompleteScreenLandscape","StampScreen","RewardTournamentScreen"].indexOf((null==(n=t.screenName)?void 0:n.toString())||"")){var a=t.screenName,i=e.getScreenByName(a);e.setActiveScreen(i)}else e.setActiveScreen(e.getScreenByName("DashBoardScreen"))},e.handleClosedScreen=function(){var t=$.getCurrentPage(),n=e.getScreenByName(t);-1===["FinishTournamentInfoScreen","ChapterCompleteScreen","ChapterCompleteScreenLandscape","StampScreen","RewardTournamentScreen","TournamentInfoScreen"].indexOf(t)?e.setActiveScreen(n):e.setActiveScreen(e.getScreenByName("DashBoardScreen"))},e}return l(c,[{key:"start",value:function(){var e=this;this.initScreens(),this.alignScreens(),this.listenEvents();var t=ee.gameScene.gamePlay.gameDataManager.getMultiData(["level"]).level,n=window.game.match.getMatchState();this.node.active=!1,1===t||"tournament"===n.mode?this.setActiveScreen(this.getScreenByName("GameScene")):this.setActiveScreen(this.getScreenByName("DashBoardScreen")),this.node.scene.on(K.FADED_IN_DASHBOARD_DONE,function(){e.setActiveScreen(e.getScreenByName("DashBoardScreen"))})}},{key:"onDestroy",value:function(){this.unlistenEvents()}},{key:"listenEvents",value:function(){e1.on(e3.OPENED_SCREEN,this.handleOpenedScreen),e1.on(e3.CLOSED_SCREEN,this.handleClosedScreen)}},{key:"unlistenEvents",value:function(){e1.off(e3.OPENED_SCREEN,this.handleOpenedScreen),e1.off(e3.CLOSED_SCREEN,this.handleClosedScreen)}},{key:"initScreens",value:function(){var e,t=u(this.screens);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.mapScreens.set(n.name,n)}}catch(e){t.e(e)}finally{t.f()}}},{key:"getScreenByName",value:function(e){var t;if("string"!=typeof e||!e)return null;var n=e;return n.includes("Landscape")&&(n=n.replace("Landscape","")),n="".concat(n,"DevTool"),null!=(t=this.mapScreens.get(n))?t:null}},{key:"setActiveScreen",value:function(e){this.previousScreen=this.currentScreen,this.currentScreen!==e&&(this.currentScreen&&(this.currentScreen.active=!1),this.currentScreen=e,this.currentScreen&&(this.currentScreen.active=!0))}},{key:"findChildByName",value:function(e,t){var n,a=u(e.children);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i.name===t)return i;var r=this.findChildByName(i,t);if(r)return r}}catch(e){a.e(e)}finally{a.f()}return null}},{key:"alignScreens",value:function(){var e,t=u(this.screens);try{for(t.s();!(e=t.n()).done;){var n,a,i,r,l=e.value;if(!l)return;var h=this.findChildByName(l,"Background");if(!h)return;var v=null!=(n=null==(a=h.getComponent(L))?void 0:a.contentSize.height)?n:0,f=null!=(i=null==(r=h.getComponent(L))?void 0:r.contentSize.width)?i:0,y=l.getComponent(I);y&&(y.isAlignVerticalCenter=!0,y.verticalCenter=-v/2+50,y.isAlignHorizontalCenter=!0,y.horizontalCenter=f/2+75)}}catch(e){t.e(e)}finally{t.f()}}}]),c}(E)).prototype,"screens",[eM],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),eP))||eP);g._RF.pop(),g._RF.push({},"1e0ebYJy/VBuZBccoVaQpe4","DevToolManager",void 0);var e5,e4,e6,e8,e7,e9,te,tt,tn,ta,ti,tr,to,ts,tl,tc,tu,th,td,tp,tv,tf,ty=C.ccclass,tm=C.property;eU=ty("DevToolManager"),eG=tm(D),eF=F.required,eK=tm(e2),eq=F.required,eV=tm(ez),eW=F.required,ej=tm(D),eJ=F.required,eU((eY=e((eH=function(e){t(s,e);var u=n(s);function s(){var e;a(this,s);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return e=u.call.apply(u,[this].concat(n)),i(e,"devToolBtn",eY,r(e)),i(e,"devToolScreenManager",eX,r(e)),i(e,"bundleSizeMonitor",eZ,r(e)),i(e,"switchView",eQ,r(e)),e.active=!1,e.viewMode=0,e.STORAGE_KEY="devtool_state",e}return l(s,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){F.validateRequiredProperties(this,s)}},{key:"onLoad",value:function(){this.switchView.node.active=!1,this.loadState(),this.listenEvents()}},{key:"onDestroy",value:function(){this.unlistenEvents()}},{key:"listenEvents",value:function(){var e=this;this.devToolBtn.node.on(D.EventType.CLICK,this.onDevToolBtnClick,this),this.switchView.node.on(D.EventType.CLICK,this.onSwitchViewBtnClick,this),A.on(et.VIEW_RESIZED,function(){e.checkOutOfScreen(e.devToolBtn.node)})}},{key:"unlistenEvents",value:function(){this.devToolBtn.node.off(D.EventType.CLICK,this.onDevToolBtnClick,this)}},{key:"onDevToolBtnClick",value:function(){var e=this.devToolBtn.getComponent(q);(null==e?void 0:e.consumeDraggedThisFrame())||!1||(this.active=!this.active,this.showViewByMode(),this.setColorDevToolBtn()),this.saveState()}},{key:"onSwitchViewBtnClick",value:function(){this.viewMode=(this.viewMode+1)%2,this.showViewByMode(),this.saveState()}},{key:"showViewByMode",value:function(){if(!this.active)return this.devToolScreenManager.node.active=!1,this.bundleSizeMonitor.node.active=!1,void(this.switchView.node.active=!1);switch(this.switchView.node.active=!0,this.viewMode){case 0:this.devToolScreenManager.node.active=!0,this.bundleSizeMonitor.node.active=!1;break;case 1:this.bundleSizeMonitor.node.active=!0,this.devToolScreenManager.node.active=!1}}},{key:"setColorDevToolBtn",value:function(){var e=this.devToolBtn.node.getComponent(R);e&&(e.color=this.active?new w(8,226,34,255):new w(255,255,255,255))}},{key:"saveState",value:function(){var e=this.devToolBtn.node.position,t={active:this.active,position:{x:e.x,y:e.y},viewMode:this.viewMode};localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}},{key:"loadState",value:function(){var e=this,t=localStorage.getItem(this.STORAGE_KEY);if(t)try{var n=JSON.parse(t);n.position&&this.devToolBtn.node.setPosition(new _(n.position.x,n.position.y,1)),n.viewMode&&(this.viewMode=n.viewMode),this.checkOutOfScreen(this.devToolBtn.node);var a=setTimeout(function(){n.active&&e.onDevToolBtnClick(),clearTimeout(a)},100)}catch(e){}}},{key:"checkOutOfScreen",value:function(e){var t=e.getWorldPosition(),n=M.getVisibleSize(),a=n.width-50,i=n.height-50,r=t.x,l=t.y;t.x<50&&(r=50),t.x>a&&(r=a),t.y<50&&(l=50),t.y>i&&(l=i),r===t.x&&l===t.y||e.setWorldPosition(new _(r,l,t.z))}}]),s}(E)).prototype,"devToolBtn",[eG,eF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eX=e(eH.prototype,"devToolScreenManager",[eK,eq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eZ=e(eH.prototype,"bundleSizeMonitor",[eV,eW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eQ=e(eH.prototype,"switchView",[ej,eJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eH)),g._RF.pop(),g._RF.push({},"26d1dlhIGxN2axOCXwDnkLG","DailyMissionsScreenDevTool",void 0);var tg,tC,tS,tb,tk,tB,tw,tE,tT,tL,tI,tD,tA,tR,t_,tM,tP,tN=["passLevels","useBoosters","collectTiles","passLevelsInARow"],tO=C.ccclass,tx=C.property;e5=tO("DailyMissionsScreenDevTool"),e4=tx(D),e6=tx(D),e8=tx(D),e7=tx(D),e9=tx(D),te=tx(D),tt=tx(D),tn=tx(D),ta=tx(D),ti=tx(D),e5((to=e((tr=function(e){t(d,e);var u=n(d);function d(){var e;a(this,d);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return e=u.call.apply(u,[this].concat(n)),i(e,"resetPassLevelsBtn",to,r(e)),i(e,"resetUseBoostersBtn",ts,r(e)),i(e,"resetCollectTilesBtn",tl,r(e)),i(e,"resetPassLevelsInARowBtn",tc,r(e)),i(e,"resetAllBtn",tu,r(e)),i(e,"completePassLevelsBtn",th,r(e)),i(e,"completeUseBoostersBtn",td,r(e)),i(e,"completeCollectTilesBtn",tp,r(e)),i(e,"completePassLevelsInARowBtn",tv,r(e)),i(e,"completeAllBtn",tf,r(e)),e.originalPositionsByBlockName=new Map,e.dailyMissionsScreen=void 0,e.dailyMissionContainer=void 0,e.dataManager=void 0,e.missions={passLevels:{payloadKey:"pass-levels",blockSelector:function(e){return e.passLevelsBlock},blockName:"PassLevelsBlock<SmallMissionBlock>",denominator:V.PASS_LEVELS,applyUpdate:function(){return ee.gameScene.gamePlay.updateDailyMissionCount({passLevels:function(){return V.PASS_LEVELS}})}},useBoosters:{payloadKey:"use-boosters",blockSelector:function(e){return e.useBoostersBlock},blockName:"UseBoostersBlock<SmallMissionBlock>",denominator:V.USE_BOOSTERS,applyUpdate:function(){return ee.gameScene.gamePlay.updateDailyMissionCount({useBoosters:function(){return V.USE_BOOSTERS}})}},collectTiles:{payloadKey:"collect-tiles",blockSelector:function(e){return e.collectTilesBlock},blockName:"CollectTilesBlock<SmallMissionBlock>",denominator:V.COLLECT_TILES,applyUpdate:function(){return ee.gameScene.gamePlay.updateDailyMissionCount({collectTiles:function(){return V.COLLECT_TILES}})}},passLevelsInARow:{payloadKey:"pass-levels-in-a-row",blockSelector:function(e){return e.passLevelsInARowBlock},blockName:"PassLevelsInARowBlock<SmallMissionBlock>",denominator:V.PASS_LEVELS_IN_A_ROW,applyUpdate:function(){return ee.gameScene.gamePlay.updateDailyMissionCount({passLevelsInARow:function(){return V.PASS_LEVELS_IN_A_ROW}})}}},e}return l(d,[{key:"onLoad",value:function(){this.initData(),this.listenEvents()}},{key:"onDestroy",value:function(){this.unlistenEvents()}},{key:"initData",value:function(){var e;this.dailyMissionsScreen=null==(e=P.getScene())?void 0:e.getComponentInChildren("DailyMissionsScreen"),this.dailyMissionContainer=this.dailyMissionsScreen.getDailyMissionContainer(),this.dataManager=this.dailyMissionsScreen.getDataManager();for(var t=0;t<tN.length;t++){var n=tN[t],a=this.missions[n],i=a.blockSelector(this.dailyMissionContainer).rewardItem.node.position.clone();this.originalPositionsByBlockName.set(a.blockName,i)}}},{key:"listenEvents",value:function(){this.resetPassLevelsBtn.node.on(D.EventType.CLICK,this.onResetPassLevelsBtnClick,this),this.resetUseBoostersBtn.node.on(D.EventType.CLICK,this.onResetUseBoostersBtnClick,this),this.resetCollectTilesBtn.node.on(D.EventType.CLICK,this.onResetCollectTilesBtnClick,this),this.resetPassLevelsInARowBtn.node.on(D.EventType.CLICK,this.onResetPassLevelsInARowBtnClick,this),this.resetAllBtn.node.on(D.EventType.CLICK,this.onResetAllBtnClick,this),this.completePassLevelsBtn.node.on(D.EventType.CLICK,this.onCompletePassLevelsBtnClick,this),this.completeUseBoostersBtn.node.on(D.EventType.CLICK,this.onCompleteUseBoostersBtnClick,this),this.completeCollectTilesBtn.node.on(D.EventType.CLICK,this.onCompleteCollectTilesBtnClick,this),this.completePassLevelsInARowBtn.node.on(D.EventType.CLICK,this.onCompletePassLevelsInARowBtnClick,this),this.completeAllBtn.node.on(D.EventType.CLICK,this.onCompleteAllBtnClick,this)}},{key:"unlistenEvents",value:function(){this.resetPassLevelsBtn.node.off(D.EventType.CLICK,this.onResetPassLevelsBtnClick,this),this.resetUseBoostersBtn.node.off(D.EventType.CLICK,this.onResetUseBoostersBtnClick,this),this.resetCollectTilesBtn.node.off(D.EventType.CLICK,this.onResetCollectTilesBtnClick,this),this.resetPassLevelsInARowBtn.node.off(D.EventType.CLICK,this.onResetPassLevelsInARowBtnClick,this),this.resetAllBtn.node.off(D.EventType.CLICK,this.onResetAllBtnClick,this),this.completePassLevelsBtn.node.off(D.EventType.CLICK,this.onCompletePassLevelsBtnClick,this),this.completeUseBoostersBtn.node.off(D.EventType.CLICK,this.onCompleteUseBoostersBtnClick,this),this.completeCollectTilesBtn.node.off(D.EventType.CLICK,this.onCompleteCollectTilesBtnClick,this),this.completePassLevelsInARowBtn.node.off(D.EventType.CLICK,this.onCompletePassLevelsInARowBtnClick,this),this.completeAllBtn.node.off(D.EventType.CLICK,this.onCompleteAllBtnClick,this)}},{key:"refreshContainer",value:function(){this.dataManager.updatePayloadFromGameData();var e=this.dataManager.getPayload();this.dailyMissionContainer.prepareOpen(e)}},{key:"resetUIForBlock",value:function(e){var t=e.progressBar.node.getComponent(N);if(t){t.opacity=255,e.claimButton.interactable=!0,e.rewardLabel.scale=_.ONE,e.rewardLabelUIOpacity.opacity=255;var n=this.originalPositionsByBlockName.get(e.name);n&&e.rewardItem.node.setPosition(n)}}},{key:"resetMission",value:function(e){var t=this.getDailyMissionsData(),n=t[e];if(0!==n.count||n.isClaimed){ee.gameScene.gamePlay.gameDataManager.setGameData({dailyMissions:h(h({},null!=t?t:{}),{},v({},e,{count:0,isClaimed:!1}))}),this.dataManager.updatePayloadFromGameData();var a=this.missions[e],i=this.dataManager.getPayload()[a.payloadKey];a.blockSelector(this.dailyMissionContainer).setPayload(i);var r=a.blockSelector(this.dailyMissionContainer);this.resetUIForBlock(r),this.updateBigMissionProgress()}}},{key:"completeMission",value:function(e){var t=this.getDailyMissionsData(),n=this.missions[e],a=t[e];if(a.count!==n.denominator||!a.isClaimed){n.applyUpdate(),this.dataManager.updatePayloadFromGameData();var i=this.dataManager.getPayload()[n.payloadKey];n.blockSelector(this.dailyMissionContainer).setPayload(i)}}},{key:"getDailyMissionsData",value:function(){return ee.gameScene.gamePlay.gameDataManager.getMultiData(["dailyMissions"]).dailyMissions}},{key:"updateBigMissionProgress",value:function(){var e=Object.values(this.getDailyMissionsData()).filter(function(e){return"object"===f(e)&&null!==e&&"isClaimed"in e}).filter(function(e){return e.isClaimed}).length;this.dailyMissionContainer.setBigMissionBlockPayload({progress:{numerator:e,denominator:4},check:4===e})}},{key:"onResetPassLevelsBtnClick",value:function(){this.resetMission("passLevels")}},{key:"onResetUseBoostersBtnClick",value:function(){this.resetMission("useBoosters")}},{key:"onResetCollectTilesBtnClick",value:function(){this.resetMission("collectTiles")}},{key:"onResetPassLevelsInARowBtnClick",value:function(){this.resetMission("passLevelsInARow")}},{key:"onResetAllBtnClick",value:function(){var e=this.getDailyMissionsData();tN.every(function(t){return 0===e[t].count&&!e[t].isClaimed})||(ee.gameScene.gamePlay.gameDataManager.setGameData({dailyMissions:h(h({},null!=e?e:{}),{},{passLevels:{count:0,isClaimed:!1},useBoosters:{count:0,isClaimed:!1},collectTiles:{count:0,isClaimed:!1},passLevelsInARow:{count:0,isClaimed:!1}})}),this.refreshContainer(),this.resetUIForBlock(this.dailyMissionContainer.passLevelsBlock),this.resetUIForBlock(this.dailyMissionContainer.useBoostersBlock),this.resetUIForBlock(this.dailyMissionContainer.collectTilesBlock),this.resetUIForBlock(this.dailyMissionContainer.passLevelsInARowBlock))}},{key:"onCompletePassLevelsBtnClick",value:function(){this.completeMission("passLevels")}},{key:"onCompleteUseBoostersBtnClick",value:function(){this.completeMission("useBoosters")}},{key:"onCompleteCollectTilesBtnClick",value:function(){this.completeMission("collectTiles")}},{key:"onCompletePassLevelsInARowBtnClick",value:function(){this.completeMission("passLevelsInARow")}},{key:"onCompleteAllBtnClick",value:function(){for(var e=0;e<tN.length;e++){var t=tN[e];this.completeMission(t)}}}]),d}(E)).prototype,"resetPassLevelsBtn",[e4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ts=e(tr.prototype,"resetUseBoostersBtn",[e6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tl=e(tr.prototype,"resetCollectTilesBtn",[e8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tc=e(tr.prototype,"resetPassLevelsInARowBtn",[e7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tu=e(tr.prototype,"resetAllBtn",[e9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),th=e(tr.prototype,"completePassLevelsBtn",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),td=e(tr.prototype,"completeUseBoostersBtn",[tt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tp=e(tr.prototype,"completeCollectTilesBtn",[tn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tv=e(tr.prototype,"completePassLevelsInARowBtn",[ta],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tf=e(tr.prototype,"completeAllBtn",[ti],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tr)),g._RF.pop(),g._RF.push({},"22f0dxzgihCJ5rJVb44lUgz","NumpadUI",void 0);var tz,tU=C.ccclass,tG=C.disallowMultiple,tF=C.property,tK=(GameCore.Events,globalThis.game.event,tg=tU("NumpadUI"),tC=tF(B),tS=tF(D),tb=tF(D),tk=tF(D),tB=tF(D),tw=tF([D]),tE=tF(O),tg(tT=tG((tI=e((tL=function(e){t(p,e);var h,v,f,m=n(p);function p(){var e;a(this,p);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=m.call.apply(m,[this].concat(n))).stack=[],i(e,"levelText",tI,r(e)),i(e,"closeButton",tD,r(e)),i(e,"confirmButton",tA,r(e)),i(e,"clearButton",tR,r(e)),i(e,"deleteButton",t_,r(e)),i(e,"numberButtons",tM,r(e)),i(e,"isNumpadInDashBoardDevTool",tP,r(e)),e.handleInputNumber=function(t){var n=t.node.name;n&&(e.stack.push(n),e.updateLevelText())},e}return l(p,[{key:"__preload",value:function(){this.validateRequiredComponents(),this.listenEvents()}},{key:"onDestroy",value:function(){this.unlistenEvents()}},{key:"listenEvents",value:function(){this.closeButton.node.on(D.EventType.CLICK,this.handleClickedCloseButton,this),this.confirmButton.node.on(D.EventType.CLICK,this.handleConfirmInput,this),this.clearButton.node.on(D.EventType.CLICK,this.handleClearInput,this),this.deleteButton.node.on(D.EventType.CLICK,this.handleDeleteLastInput,this),this.listenNumberButtonsEvents()}},{key:"unlistenEvents",value:function(){this.closeButton.node.off(D.EventType.CLICK,this.handleClickedCloseButton,this),this.confirmButton.node.off(D.EventType.CLICK,this.handleConfirmInput,this),this.clearButton.node.off(D.EventType.CLICK,this.handleClearInput,this),this.deleteButton.node.off(D.EventType.CLICK,this.handleDeleteLastInput,this),this.unlistenNumberButtonsEvents()}},{key:"listenNumberButtonsEvents",value:function(){var e,t=u(this.numberButtons);try{for(t.s();!(e=t.n()).done;)e.value.node.on(D.EventType.CLICK,this.handleInputNumber,this)}catch(e){t.e(e)}finally{t.f()}}},{key:"unlistenNumberButtonsEvents",value:function(){var e,t=u(this.numberButtons);try{for(t.s();!(e=t.n()).done;)e.value.node.off(D.EventType.CLICK,this.handleInputNumber,this)}catch(e){t.e(e)}finally{t.f()}}},{key:"gameScene",get:function(){var e,t=null==(e=x("Canvas"))?void 0:e.getComponent("GameScene");if(!t)throw new Error("GameScene is not defined");return t}},{key:"validateRequiredComponents",value:function(){F.lazyValidateProperties(this)}},{key:"handleClickedCloseButton",value:(f=y(function(){return _ts_generator(this,function(e){return this.node.active=!1,[2]})}),function(){return f.apply(this,arguments)})},{key:"handleClearInput",value:function(){this.stack=[],this.updateLevelText()}},{key:"handleDeleteLastInput",value:function(){this.stack.length>0&&(this.stack.pop(),this.updateLevelText())}},{key:"updateLevelText",value:function(){if(this.levelText){var e=this.stack.join("");this.levelText.string=e,0===this.stack.length&&"Invalid Level"!==this.levelText.string&&(this.levelText.string="Enter Level")}}},{key:"handleConfirmInput",value:(v=y(function(){var e;return _ts_generator(this,function(t){switch(t.label){case 0:if(0===this.stack.length){if(!this.levelText)return[2];return[2,void(this.levelText.string="Invalid Level")]}if(!isNaN(e=parseInt(this.stack.join(""),10)))return[3,1];return[3,3];case 1:return this.handleClearInput(),[4,this.loadInputLevel(e)];case 2:t.sent(),this.gameScene.toggleBlockInputContainer(!1),t.label=3;case 3:return[2]}})}),function(){return v.apply(this,arguments)})},{key:"loadInputLevel",value:(h=y(function(e){var t,n,a;return _ts_generator(this,function(i){switch(i.label){case 0:if(n=this.gameScene.gamePlay,e===W.MAX_LEVEL+1||0===e)throw new Error("Level is not defined");if(ee.levelManager.setLevel(e),n.gameDataManager.setGameData({level:e}),n.tileContainer.reset(),this.gameScene.background.loadBgData(),!(a=null==(t=P.getScene())?void 0:t.getComponentInChildren("DashboardScreen")))return[3,3];if(a.handleSetLevelInDevTool(e),n.gameDataManager.setGameData({dashboardAnimLevel:e}),n.requestResetLevel(),this.isNumpadInDashBoardDevTool)return[3,2];return[4,n.startGameAsync()];case 1:i.sent(),i.label=2;case 2:i.label=3;case 3:return[2]}})}),function(e){return h.apply(this,arguments)})}]),p}(E)).prototype,"levelText",[tC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),tD=e(tL.prototype,"closeButton",[tS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tA=e(tL.prototype,"confirmButton",[tb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tR=e(tL.prototype,"clearButton",[tk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t_=e(tL.prototype,"deleteButton",[tB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tM=e(tL.prototype,"numberButtons",[tw],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),tP=e(tL.prototype,"isNumpadInDashBoardDevTool",[tE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),tT=tL))||tT)||tT);g._RF.pop(),g._RF.push({},"23d59bB+MRA7J5xb0EUTiUs","ScreensDropdown",void 0);var tq,tV,tW,tj,tJ,tH,tY,tX,tZ,tQ,t$,t0,t1,t3,t2,t5,t4,t6,t8,t7,t9=(0,C.ccclass)("ScreensDropdown")(tz=function(e){t(o,e);var i=n(o);function o(){return a(this,o),i.apply(this,arguments)}return l(o,[{key:"onDropdownItemClick",value:function(e){this.scroller.registerClickEvents(e)}}]),o}(j))||tz;g._RF.pop(),g._RF.push({},"f96ecK5hc5J9LcAp25N8bnZ","DashBoardScreenDevTool",void 0);var ne,nt,nn,na,ni,nr,no,ns,nl,nc,nu,nh=C.ccclass,nd=C.property;GameCore.Configs.GameEngine.DynamicAssets.Enabled,tq=nh("DashBoardScreenDevTool"),tV=nd(D),tW=nd(D),tj=nd(D),tJ=nd(D),tH=nd(D),tY=nd(D),tX=nd(D),tZ=nd(tK),tQ=nd(t9),tq((t0=e((t$=function(e){t(k,e);var h,v,f,g,C,w,E,I=n(k);function k(){var e;a(this,k);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return e=I.call.apply(I,[this].concat(n)),i(e,"unlockTourFeatureBtn",t0,r(e)),i(e,"lockTourFeatureBtn",t1,r(e)),i(e,"resetDailyGiftsBtn",t3,r(e)),i(e,"setLevelBtn",t2,r(e)),i(e,"resetCoinBarBtn",t5,r(e)),i(e,"add500CoinsBtn",t4,r(e)),i(e,"minus500CoinsBtn",t6,r(e)),i(e,"numpadUI",t8,r(e)),i(e,"screensDropdown",t7,r(e)),e.STORAGE_KEY="dashboard_devtool_state",e}return l(k,[{key:"__preload",value:function(){this.addButton("ClearIndexedDBBtn","Clear IndexedDB",7,this.onClearIndexedDBBtnClick),this.addButton("CheckAllScreensBtn","Check All Screens",8,this.checkAllScreensBtnClick)}},{key:"onLoad",value:function(){this.listenEvents(),this.loadDataDropdown()}},{key:"onDestroy",value:function(){this.unlistenEvents()}},{key:"listenEvents",value:function(){this.unlockTourFeatureBtn.node.on(D.EventType.CLICK,this.onUnlockTourFeatureBtnClick,this),this.lockTourFeatureBtn.node.on(D.EventType.CLICK,this.onLockTourFeatureBtnClick,this),this.resetDailyGiftsBtn.node.on(D.EventType.CLICK,this.onResetDailyGiftsBtnClick,this),this.setLevelBtn.node.on(D.EventType.CLICK,this.onSetLevelBtnClick,this),this.resetCoinBarBtn.node.on(D.EventType.CLICK,this.onResetCoinBarBtnClick,this),this.add500CoinsBtn.node.on(D.EventType.CLICK,this.onAdd500CoinsBtnClick,this),this.minus500CoinsBtn.node.on(D.EventType.CLICK,this.onMinus500CoinsBtnClick,this)}},{key:"unlistenEvents",value:function(){this.unlockTourFeatureBtn.node.off(D.EventType.CLICK,this.onUnlockTourFeatureBtnClick,this),this.lockTourFeatureBtn.node.off(D.EventType.CLICK,this.onLockTourFeatureBtnClick,this),this.resetDailyGiftsBtn.node.off(D.EventType.CLICK,this.onResetDailyGiftsBtnClick,this),this.setLevelBtn.node.off(D.EventType.CLICK,this.onSetLevelBtnClick,this),this.resetCoinBarBtn.node.off(D.EventType.CLICK,this.onResetCoinBarBtnClick,this),this.add500CoinsBtn.node.off(D.EventType.CLICK,this.onAdd500CoinsBtnClick,this),this.minus500CoinsBtn.node.off(D.EventType.CLICK,this.onMinus500CoinsBtnClick,this)}},{key:"onUnlockTourFeatureBtnClick",value:function(){var e;ee.gameScene.gamePlay.gameDataManager.setGameData({isUnlockTourFeature:!0});var t=null==(e=P.getScene())?void 0:e.getComponentInChildren("DashboardScreen");t&&t.toggleTournamentButton(!0)}},{key:"onLockTourFeatureBtnClick",value:function(){var e;ee.gameScene.gamePlay.gameDataManager.setGameData({isUnlockTourFeature:!1});var t=null==(e=P.getScene())?void 0:e.getComponentInChildren("DashboardScreen");t&&t.toggleTournamentButton(!1)}},{key:"onResetDailyGiftsBtnClick",value:function(){var e,t=null==(e=P.getScene())?void 0:e.getComponentInChildren("DashboardScreen");t&&(J.resetDailyGifts(),t.toggleDailyRewardButton(J.canClaimReward()))}},{key:"onSetLevelBtnClick",value:function(){this.numpadUI.node.active=!0}},{key:"onResetCoinBarBtnClick",value:function(){ee.gameScene.gamePlay.gameDataManager.setGameData({coins:0})}},{key:"onAdd500CoinsBtnClick",value:function(){ee.gameScene.gamePlay.gameDataManager.setGameData({coins:ee.gameScene.gamePlay.gameDataManager.getCoins()+500})}},{key:"onMinus500CoinsBtnClick",value:function(){var e=ee.gameScene.gamePlay.gameDataManager.getCoins()-500;e<0&&(e=0),ee.gameScene.gamePlay.gameDataManager.setGameData({coins:e})}},{key:"loadDataDropdown",value:function(){var e=this,t=["LoadingFullScreen","DashBoardScreen","DashBoardScreenLandscape","DailyChallengeScreen","ThemeScreen","RewardScreen"],n=Object.entries(er).filter(function(e){var n=m(e,2),a=n[0],i=n[1];return!a.includes("old")&&!t.includes(i)}).sort(function(e,t){var n=m(e,1)[0],a=m(t,1)[0];return Number(n)-Number(a)}).reduce(function(e,t,n){var a=m(t,2)[1];return e[n]=a.replace("Landscape",""),e},{});var a="Select Screen",i=localStorage.getItem(this.STORAGE_KEY);i&&(a=i),this.screensDropdown.init(a,"Open",n,this.onClickOpen.bind(this)),this.screensDropdown.onDropdownItemClick(function(t){localStorage.setItem(e.STORAGE_KEY,t)})}},{key:"addButton",value:function(e,t,n,a){var i,r=new T(e);r.addComponent(L);var l=r.addComponent(D);l.target=r,l.interactable=!0,l.transition=D.Transition.SCALE,l.duration=.1,l.zoomScale=1.2;var u=null==(i=this.node.getChildByName("Container"))?void 0:i.getChildByName("ResetGroup");null==u||u.addChild(r);var h=r.addComponent(B);h.string=t,h.fontSize=35,h.useSystemFont=!0,h.isBold=!0,null==r||r.setSiblingIndex(n),l.node.on(D.EventType.CLICK,a,this)}},{key:"onClearIndexedDBBtnClick",value:(E=y(function(){var e,t,n;return _ts_generator(this,function(a){if("infoKey"in(e=GameSDK.player)){if(t=e.infoKey.replace("_PlayerInfo","").replaceAll("-"," "))(n=indexedDB.deleteDatabase(t)).onsuccess=function(){n.result.close(),indexedDB.deleteDatabase(t)}}return[2]})}),function(){return E.apply(this,arguments)})},{key:"getScreenHolder",value:function(){var e=P.getScene();return null==e?void 0:e.getComponentInChildren("Screens")}},{key:"checkAllScreensBtnClick",value:(w=y(function(){var e,t,n,a,i,r,l,h;return _ts_generator(this,function(v){switch(v.label){case 0:if(!(e=this.getScreenHolder()))return[3,10];return[4,ee.gameScene.gamePlay.loader.loadSpinePrefabAsync()];case 1:v.sent(),n=null==e?void 0:e.screenKeys,a=u(n),v.label=2;case 2:v.trys.push([2,7,8,9]),a.s(),v.label=3;case 3:if(!!(t=a.n()).done)return[3,6];return i=er[t.value],[4,eo.loadPrefabAsync("screens/".concat(i))];case 4:r=v.sent(),l=z(r),e.node.addChild(l),l.active=!0,l.active=!1,v.label=5;case 5:return[3,3];case 6:return[3,9];case 7:return h=v.sent(),a.e(h),[3,9];case 8:return a.f(),[7];case 9:v.label=10;case 10:return[2]}})}),function(){return w.apply(this,arguments)})},{key:"onClickOpen",value:function(e){switch(e){case"LoadingScreen":ee.gameScene.showLoadingScreen(2,H.LOADING,!0);break;case"ChapterCompleteScreen":en.openScreenAsync(ei.CHAPTER_COMPLETE_SCREEN,{level:1});break;case"ResultScreen":en.openScreenAsync(ei.RESULT_SCREEN,{canShowButtons:!0,level:1,playerLevel:1,stampName:ee.mapDataManager.getCurrentCardName()});break;case"ResultDailyScreen":this.openResultDailyScreen();break;case"ResultTournamentScreen":en.openScreenAsync(ei.RESULT_TOURNAMENT_SCREEN,this.getScreenKeyByLabel(e));break;case"GlobalLeaderboardScreen":this.openGlobalLeaderboardScreen();break;case"DailyRewardScreen":this.openDailyRewardScreen();break;case"BattleScreen":this.openBattleScreen();break;case"StampScreen":this.openStampScreen();break;default:en.openScreenAsync(ea[e],{})}}},{key:"getScreenKeyByLabel",value:function(e){var t={};return"ResultTournamentScreen"===e&&(t={leaders:[{playerId:"5",name:"игрок 66b35",photo:"https://picsum.photos/seed/69086f813c45675f80366b35/300/300",score:83,rank:1,active:!0,idx:0},{playerId:"0",name:"Player",photo:"https://picsum.photos/id/237/200/300",score:82,rank:2,active:!0,idx:1},{playerId:"7",name:"παίχτης 0db28",photo:"https://picsum.photos/seed/69086f81cd46ad5181b0db28/300/300",score:76,rank:3,active:!0,idx:2},{playerId:"2",name:"플레이어 4cb36",photo:"https://picsum.photos/seed/69086f815c45cfe61fb4cb36/300/300",score:47,rank:4,active:!0,idx:3},{playerId:"6",name:"プレーヤー e58d2",photo:"https://picsum.photos/seed/69086f8151e23ce719be58d2/300/300",score:41,rank:5,active:!0,idx:4},{playerId:"1",name:"プレーヤー 8b5b2",photo:"https://picsum.photos/seed/69086f812c17e1699b88b5b2/300/300",score:33,rank:6,active:!0,idx:5},{playerId:"8",name:"παίχτης 5b896",photo:"https://picsum.photos/seed/69086f818a92db163c05b896/300/300",score:32,rank:7,active:!0,idx:6},{playerId:"4",name:"παίχτης 3bc33",photo:"https://picsum.photos/seed/69086f81405076b71003bc33/300/300",score:18,rank:8,active:!0,idx:7},{playerId:"3",name:"player 3de7e",photo:"https://picsum.photos/seed/69086f81762106cd89b3de7e/300/300",score:17,rank:9,active:!0,idx:8},{playerId:"9",name:"παίχτης f433a",photo:"https://picsum.photos/seed/69086f815eb6b70c2fcf433a/300/300",score:17,rank:10,active:!0,idx:9}],currentRank:1,newScore:88,playerEntry:{playerId:"0",name:"Player",photo:"https://picsum.photos/id/237/200/300",score:88,rank:2},allowLoadNewData:!1}),t}},{key:"openGlobalLeaderboardScreen",value:(C=y(function(){var e;return _ts_generator(this,function(t){switch(t.label){case 0:return ee.gameScene.toggleBlockInputContainer(!0),[4,ee.gameScene.waitUntilResourcesScreenLoaded(ei.GLOBAL_LEADERBOARD_SCREEN)];case 1:return t.sent(),e=ee.gameScene.uiManager.getDashboardScreen(),[4,Promise.all([ee.gameScene.rubyBarComp.runHideAnimationAsync(),e.container.fadeOutPlayGameAndSettingButtons()])];case 2:return t.sent(),[4,Promise.all([ee.gameScene.uiManager.openGlobalLeaderboardScreenAsync(),en.closeScreenAsync(ei.DASHBOARD_SCREEN)])];case 3:return t.sent(),ee.gameScene.toggleBlockInputContainer(!1),[2]}})}),function(){return C.apply(this,arguments)})},{key:"openDailyRewardScreen",value:(g=y(function(){var e,t,n,a,i;return _ts_generator(this,function(r){switch(r.label){case 0:return ee.gameScene.toggleBlockInputContainer(!0),t=(e=ee.gameScene).gamePlay,n=e.uiManager,a=t.gameDataManager.getLevel(),J.resetDailyGifts(),[4,Promise.all([ee.gameScene.waitUntilResourcesScreenLoaded(ei.DAILY_REWARD_SCREEN),t.setBackgroundFor({level:a})])];case 1:return r.sent(),ee.gameScene.closeLoadingScreen(),i=n.getDashboardScreen(),[4,Promise.all([ee.gameScene.rubyBarComp.runHideAnimationAsync(),i.container.fadeOutPlayGameAndSettingButtons()])];case 2:return r.sent(),[4,Promise.all([en.openScreenAsync(ei.DAILY_REWARD_SCREEN),en.closeScreenAsync(ei.DASHBOARD_SCREEN)])];case 3:return r.sent(),ee.gameScene.toggleBlockInputContainer(!1),[2]}})}),function(){return g.apply(this,arguments)})},{key:"openResultDailyScreen",value:(f=y(function(){return _ts_generator(this,function(e){switch(e.label){case 0:return[4,ee.gameScene.gamePlay.loader.loadSpinePrefabAsync()];case 1:return e.sent(),[4,ee.gameScene.waitUntilResourcesScreenLoaded(ei.RESULT_DAILY_SCREEN)];case 2:return e.sent(),[4,ee.gameScene.gamePlay.loadLevelResourcesAsync(1)];case 3:return e.sent(),en.openScreenAsync(ei.RESULT_DAILY_SCREEN,{canShowButtons:!0,level:1,playerLevel:1,stampName:ee.mapDataManager.getCurrentCardName()}),[2]}})}),function(){return f.apply(this,arguments)})},{key:"openBattleScreen",value:(v=y(function(){return _ts_generator(this,function(e){switch(e.label){case 0:return[4,ee.gameScene.waitUntilResourcesScreenLoaded(ei.BATTLE_SCREEN)];case 1:return e.sent(),[4,en.openScreenAndWaitForClose(ei.BATTLE_SCREEN)];case 2:return e.sent(),[2]}})}),function(){return v.apply(this,arguments)})},{key:"openStampScreen",value:(h=y(function(){return _ts_generator(this,function(e){switch(e.label){case 0:return[4,en.openScreenAsync(ei.STAMP_SCREEN)];case 1:return e.sent(),[4,en.closeScreenAsync(ei.STAMP_SCREEN)];case 2:return e.sent(),[2]}})}),function(){return h.apply(this,arguments)})}]),k}(E)).prototype,"unlockTourFeatureBtn",[tV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t1=e(t$.prototype,"lockTourFeatureBtn",[tW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t3=e(t$.prototype,"resetDailyGiftsBtn",[tj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t2=e(t$.prototype,"setLevelBtn",[tJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t5=e(t$.prototype,"resetCoinBarBtn",[tH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t4=e(t$.prototype,"add500CoinsBtn",[tY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t6=e(t$.prototype,"minus500CoinsBtn",[tX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t8=e(t$.prototype,"numpadUI",[tZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t7=e(t$.prototype,"screensDropdown",[tQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t$)),g._RF.pop(),g._RF.push({},"a84e2WNmShNPIEC+QODrKy6","GlobalLeaderboardScreenDevTool",void 0);var np,nv,nf,ny,nm,ng,nC,nS,nb,nk,nB,nw=C.ccclass,nE=C.property;ne=nw("GlobalLeaderboardScreenDevTool"),nt=nE(D),nn=F.required,na=nE(U),ni=F.required,nr=nE(U),no=F.required,ne((nl=e((ns=function(e){t(c,e);var u,h=n(c);function c(){var e;a(this,c);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return e=h.call.apply(h,[this].concat(n)),i(e,"updateBtn",nl,r(e)),i(e,"inputRank",nc,r(e)),i(e,"inputScore",nu,r(e)),e}return l(c,[{key:"__preload",value:function(){F.validateRequiredProperties(this,c)}},{key:"onLoad",value:function(){this.listenEvents()}},{key:"onDestroy",value:function(){this.unlistenEvents()}},{key:"listenEvents",value:function(){this.updateBtn.node.on(D.EventType.CLICK,this.onUpdateBtnClick,this)}},{key:"unlistenEvents",value:function(){this.updateBtn.node.off(D.EventType.CLICK,this.onUpdateBtnClick,this)}},{key:"onUpdateBtnClick",value:(u=y(function(){var e,t,n,a,i,r,l;return _ts_generator(this,function(u){switch(u.label){case 0:if(e=parseInt(this.inputRank.string)||-1,t=parseInt(this.inputScore.string)||0,ee.gameScene.showLoadingScreen(0,"Waiting...",!0),n=ee.gameScene.gamePlay.globalLeaderboardLoader,e&&e>=1){if((a=n.getLeaderboard())&&a.length>0)i=a.find(function(t){return t.rank===e}),r=a.find(function(t){return t.rank===e-1}),i&&r&&(t=Math.floor(Math.random()*(r.score-i.score))+i.score),i&&!r&&(t=i.score+Math.floor(10*Math.random())+1),e>a.length&&(t=a[a.length-1].score-Math.floor(10*Math.random())-1)}return t>W.MAX_LEVEL&&(t=W.MAX_LEVEL),t<1&&(t=1),ee.gameScene.gamePlay.gameDataManager.setGameData({level:t}),[4,ee.gameScene.gamePlay.saveGlobalLeaderboardScore(t)];case 1:return u.sent(),[4,es.waitTweenAsync(3)];case 2:return u.sent(),l={leaderboardId:n.getGlobalLeaderboardId(),currentPlayer:n.getCurrentPlayerEntry(),leaders:n.getLeaderboard(),allowLoadNewData:!0},en.openScreen(ei.GLOBAL_LEADERBOARD_SCREEN,l),ee.gameScene.closeLoadingScreen(),[2]}})}),function(){return u.apply(this,arguments)})}]),c}(E)).prototype,"updateBtn",[nt,nn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nc=e(ns.prototype,"inputRank",[na,ni],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nu=e(ns.prototype,"inputScore",[nr,no],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ns)),g._RF.pop(),g._RF.push({},"1cdacnJqnNPErBGVeMN/2EZ","LeaderboardScreenDevTool",void 0);var nT,nL,nI,nD,nA,nR,n_,nM,nP,nN,nO,nx,nz,nU,nG=C.ccclass,nF=C.property;np=nG("LeaderboardScreenDevTool"),nv=nF(D),nf=F.required,ny=nF(U),nm=F.required,ng=nF(U),nC=F.required,np((nb=e((nS=function(e){t(c,e);var u,h=n(c);function c(){var e;a(this,c);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return e=h.call.apply(h,[this].concat(n)),i(e,"updateBtn",nb,r(e)),i(e,"inputRank",nk,r(e)),i(e,"inputScore",nB,r(e)),e}return l(c,[{key:"__preload",value:function(){F.validateRequiredProperties(this,c)}},{key:"onLoad",value:function(){this.listenEvents()}},{key:"onDestroy",value:function(){this.unlistenEvents()}},{key:"listenEvents",value:function(){this.updateBtn.node.on(D.EventType.CLICK,this.onUpdateBtnClick,this)}},{key:"unlistenEvents",value:function(){this.updateBtn.node.off(D.EventType.CLICK,this.onUpdateBtnClick,this)}},{key:"onUpdateBtnClick",value:(u=y(function(){var e,t,n,a,i,r,l,u,h,v,f,y,m,g;return _ts_generator(this,function(C){switch(C.label){case 0:if(t=(e=ee.gameScene.gamePlay.resultTournamentLoader).updateScoreByLeaderboardId,n=e.fetchLeaderboard,a=e.updatePlayerEntry,i=e.preloadLeaderboardData,r=parseInt(this.inputRank.string)||-1,l=parseInt(this.inputScore.string)||0,u=ee.gameScene.gamePlay.resultTournamentLoader,h=ee.tournamentManager.getSelectedLeaderboardId()||void 0,v=u.getCurrentPlayerEntry(),!h)return[3,6];if(r&&r>=1){if((f=u.getLeaderboard())&&f.length>0)y=f.find(function(e){return e.rank===r}),m=f.find(function(e){return e.rank===r-1}),y&&m&&(l=Math.floor(Math.random()*(m.score-y.score))+y.score),y&&!m&&(l=y.score+Math.floor(10*Math.random())+1),r>f.length&&(l=f[f.length-1].score-Math.floor(10*Math.random())-1)}return ee.gameScene.showLoadingScreen(0,"Waiting...",!0),l<1&&(l=1),a(r,l),[4,t(h,(null==v?void 0:v.score)||0,l,r)];case 1:return C.sent(),[4,es.waitTweenAsync(3)];case 2:return C.sent(),[4,i()];case 3:return C.sent(),[4,n()];case 4:return C.sent(),[4,es.waitTweenAsync(3)];case 5:C.sent(),g={leaderboardId:h,shouldOpenPopupJoinTournament:!1,currentPlayer:v,leaders:u.getLeaderboard(),allowLoadNewData:u.getAllowLoadNewData()},en.openScreen(ei.LEADERBOARD_SCREEN,g),ee.gameScene.closeLoadingScreen(),C.label=6;case 6:return[2]}})}),function(){return u.apply(this,arguments)})}]),c}(E)).prototype,"updateBtn",[nv,nf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nk=e(nS.prototype,"inputRank",[ny,nm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nB=e(nS.prototype,"inputScore",[ng,nC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nS)),g._RF.pop(),g._RF.push({},"53f6ekiEw5I1YVRB/cqQu48","DebuggerManager",void 0);var nK,nq=C.ccclass,nV=C.property,nW={TOP:{x:0,y:-.5},BOTTOM:{x:0,y:.5},LEFT:{x:-.5,y:0},RIGHT:{x:.5,y:0},TOP_LEFT:{x:-.5,y:-.5},TOP_RIGHT:{x:.5,y:-.5},BOTTOM_LEFT:{x:-.5,y:.5},BOTTOM_RIGHT:{x:.5,y:.5},CENTER:{x:0,y:0}};nT=nq("DebuggerManager"),nL=nV(T),nI=nV(T),nD=nV(T),nA=nV(O),nR=nV(D),n_=nV(D),nT((nP=e((nM=function(e){t(b,e);var v,f,m,g,C,B,w,E,T,L,I,A=n(b);function b(){var e;a(this,b);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return e=A.call.apply(A,[this].concat(n)),i(e,"nextStepButton",nP,r(e)),i(e,"autoPlayButton",nN,r(e)),i(e,"numpadUI",nO,r(e)),i(e,"isDebugWin",nx,r(e)),e.tileManager=void 0,e.tileContainer=void 0,e.enableUseItems=!1,e.canAutoPlay=!1,i(e,"add3ForAllItemsBtn",nz,r(e)),i(e,"minus3ForAllItemsBtn",nU,r(e)),e}return l(b,[{key:"gameScene",get:function(){var e,t=null==(e=x("Canvas"))?void 0:e.getComponent("GameScene");if(!t)throw new Error("GameScene is not defined");return t}},{key:"__preload",value:function(){this.tileManager=this.gameScene.gamePlay.tileManager,this.tileContainer=this.gameScene.gamePlay.tileContainer,this.nextStepButton.on(D.EventType.CLICK,this.handleClickedNextStep,this),this.autoPlayButton.on(D.EventType.CLICK,this.handleClickedAutoPlay,this),this.add3ForAllItemsBtn.node.on(D.EventType.CLICK,this.onAdd3ForAllItemsBtnClick,this),this.minus3ForAllItemsBtn.node.on(D.EventType.CLICK,this.onMinus3ForAllItemsBtnClick,this)}},{key:"resetDebug",value:function(){this.canAutoPlay=!1}},{key:"handleClickedNextStep",value:(I=y(function(){var e,t,n,a,i,r,l,u,h,v,f,y,m,g,C,B,w,E,T,L,I,D,A,R,_,M,P,N,O,x,z,U;return _ts_generator(this,function(G){switch(G.label){case 0:for(e=this.getFreeTiles(),t=this.tileManager.getBoardMap(),n=this.convertBoardMapToTileMap(t,"1/2"),a=[],i=this.tileContainer.getTilesOnRack(),r=0;r<i.length;r++)a.push(i[r].id.toString());if(!(0!==(l=this.getTilesCollectable([n])).length))return[3,11];u=l[Math.floor(Math.random()*l.length)],h=[],v=function(){var e;return _ts_generator(this,function(t){return e=l[f],2===a.filter(function(t){return t===e.icon.toString()}).length&&h.push(e),[2]})},f=0,G.label=1;case 1:if(!(f<l.length))return[3,4];return[5,_ts_values(v())];case 2:G.sent(),G.label=3;case 3:return f++,[3,1];case 4:if(0!==h.length)return[3,10];y=0,G.label=5;case 5:if(!(y<l.length))return[3,10];m=l[y],C=(g=JSON.parse(JSON.stringify(n)))[m.inUsedTileMapIndex||0],this.detachTileView(m,C),B=this.getTilesCollectable(g),w=function(){var e;return _ts_generator(this,function(t){return e=B[E],2===a.filter(function(t){return t===e.icon.toString()}).length&&h.push(m),[2]})},E=0,G.label=6;case 6:if(!(E<B.length))return[3,9];return[5,_ts_values(w())];case 7:G.sent(),G.label=8;case 8:return E++,[3,6];case 9:return y++,[3,5];case 10:if(0===h.length){for(T=[],L=0;L<l.length;L++)I=l[L],a.includes(I.icon.toString())&&T.push(I);T.length>0&&(u=T[Math.floor(Math.random()*T.length)])}else u=h[Math.floor(Math.random()*h.length)];for(a.push(u.icon.toString()),A=(D=u.position).x,R=D.y,_=D.z,M=0;M<e.length;M++)if(O=(N=(P=e[M]).gridPos).x,x=N.y,z=P.getLayer(),O===A&&x===R&&z===_){if(!(U=P.getComponent(X)))continue;U.handleClick({scaleUpElapse:.1})}G.label=11;case 11:return[2]}})}),function(){return I.apply(this,arguments)})},{key:"detachTileView",value:function(e,t){if(!e)return!1;var n=e.position,a=n.x,i=n.y,r=n.z;return!!this.existPosition({x:a,y:i,z:r},t)&&(delete t[r][i][a],!0)}},{key:"getTilesCollectable",value:function(e){for(var t=[],n=0;n<e.length;n++){var a=e[n];for(var i in a){var r=a[i];if(r)for(var l in r){var u=r[l];if(u)for(var h in u){var v=u[h];if(v){var f=v.position,y=v.type,m=void 0===y?"1/2":y,g=!this.existUpperTiles(f,a,m);v.inUsedTileMapIndex=n,v.key="cluster-".concat(n),g&&t.push(v)}}}}}return t}},{key:"existUpperTiles",value:function(e,t,n){if(!this.existPosition(e,t))return!1;var a,i=Object.keys(t).map(Number).filter(function(t){return t>e.z}).sort(function(e,t){return e-t}),r=Object.values(nW),l=u(i);try{for(l.s();!(a=l.n()).done;){var h,v=a.value,f=u(r);try{for(f.s();!(h=f.n()).done;){var y,m=h.value,g=e.x+m.x,C=e.y+m.y;if(null!=(y=t[v])&&null!=(y=y[C])&&y[g])return!0}}catch(e){f.e(e)}finally{f.f()}}}catch(e){l.e(e)}finally{l.f()}return!1}},{key:"existPosition",value:function(e,t){var n,a=e.x,i=e.y;return!(null==(n=t[e.z])||null==(n=n[i])||!n[a])}},{key:"convertBoardMapToTileMap",value:function(e,t){var n={};for(var a in e){var i=e[a];if(i){var r=Number(a);for(var l in n[r]||(n[r]={}),i){var u=i[l];if(u){var h=Number(l);for(var v in n[r][h]||(n[r][h]={}),u){var f=u[v];if(f){var y=Number(v);n[r][h][y]={position:{x:y,y:h,z:r},icon:f.id.toString(),inUsedTileMapIndex:0,type:t,key:""}}}}}}}return n}},{key:"getFreeTiles",value:function(){return this.tileManager.getLeftTiles().filter(function(e){return e.state===Y.ALREADY&&e.isActive})}},{key:"getTheMaxSameTileId",value:function(){var e,t=this.tileContainer.getTilesOnRack(),n=5e-324,a=-1,i=u(t);try{for(i.s();!(e=i.n()).done;)(function(){var i=e.value,r=t.filter(function(e){return e.id===i.id}).length;r>n&&(a=i.id,n=r)})()}catch(e){i.e(e)}finally{i.f()}return a}},{key:"handleClickedAutoPlay",value:(L=y(function(){var e;return _ts_generator(this,function(t){switch(t.label){case 0:if(this.canAutoPlay=!this.canAutoPlay,!this.canAutoPlay)return[3,7];e=this.tileManager.getLeftTiles(),t.label=1;case 1:if(!(e.length>0&&this.canAutoPlay))return[3,6];return[4,es.waitTweenAsync(.25)];case 2:return t.sent(),[4,this.handleClickNextStep2()];case 3:return t.sent(),[4,es.waitTweenAsync(.25)];case 4:t.sent(),t.label=5;case 5:return[3,1];case 6:this.canAutoPlay=!1,t.label=7;case 7:return[2]}})}),function(){return L.apply(this,arguments)})},{key:"useRandomItem",value:(T=y(function(){var e,t,n;return _ts_generator(this,function(a){switch(a.label){case 0:if(!(n=(t=[(e=this.gameScene.gamePlay.gameUI.footer).undoItem,e.shuffleItem,e.magicWandItem])[Math.floor(Math.random()*t.length)]))return[3,2];return[4,n.useItem()];case 1:a.sent(),a.label=2;case 2:return[2]}})}),function(){return T.apply(this,arguments)})},{key:"handleClickNextStep2",value:(E=y(function(){return _ts_generator(this,function(e){switch(e.label){case 0:if(!this.gameScene.gamePlay.tileContainer.isLoseGame())return[3,1];return this.resetDebug(),[3,5];case 1:if(!(Math.random()<.2&&this.enableUseItems))return[3,4];return[4,this.useRandomItem()];case 2:return e.sent(),[4,es.waitTweenAsync(1.5)];case 3:e.sent(),e.label=4;case 4:this.handleClickedNextStep(),e.label=5;case 5:return[2]}})}),function(){return E.apply(this,arguments)})},{key:"chooseBestFitTiles",value:(w=y(function(){var e,t,n,a,i,r,l,h,v,f,y,m,g,C;return _ts_generator(this,function(B){switch(B.label){case 0:t=this.tileManager.getLeftTiles(),this.tileContainer.getTilesOnRack(),n=u(t),B.label=1;case 1:B.trys.push([1,13,14,15]),n.s(),B.label=2;case 2:if(!!(e=n.n()).done)return[3,12];if(!(a=e.value).isActive)return[3,11];(i=[]).push(a),l=u(t);try{for(l.s();!(r=l.n()).done&&(!(h=r.value).isActive||h.state!==Y.ALREADY||h.id!==a.id||i.includes(h)||(i.push(h),3!==i.length)););}catch(e){l.e(e)}finally{l.f()}if(3!==i.length)return[3,11];f=u(i),B.label=3;case 3:B.trys.push([3,9,10,11]),f.s(),B.label=4;case 4:if(!!(v=f.n()).done)return[3,8];if(!(y=v.value))return[2];if(y.state!==Y.ALREADY)return[3,7];if(!(m=y.getComponent(X)))return[3,6];return m.handleClick({scaleUpElapse:.1}),[4,es.waitTweenAsync(.25)];case 5:B.sent(),B.label=6;case 6:B.label=7;case 7:return[3,4];case 8:return[3,11];case 9:return g=B.sent(),f.e(g),[3,11];case 10:return f.f(),[7];case 11:return[3,2];case 12:return[3,15];case 13:return C=B.sent(),n.e(C),[3,15];case 14:return n.f(),[7];case 15:return this.handleClickedNextStep(),[4,es.waitTweenAsync(.25)];case 16:return B.sent(),[2]}})}),function(){return w.apply(this,arguments)})},{key:"handleCheckedUseItemToggle",value:(B=y(function(e){return _ts_generator(this,function(t){return this.enableUseItems=e.isChecked,[2]})}),function(e){return B.apply(this,arguments)})},{key:"handleClickedNumpadButton",value:(C=y(function(){return _ts_generator(this,function(e){switch(e.label){case 0:return this.numpadUI.setParent(this.gameScene.gamePlay.node),this.numpadUI.active=!0,[4,es.waitTweenAsync(0)];case 1:return e.sent(),this.numpadUI.setPosition(0,0,0),[2]}})}),function(){return C.apply(this,arguments)})},{key:"handleClickedNextLevel",value:(g=y(function(){var e;return _ts_generator(this,function(t){switch(t.label){case 0:if(!this.gameScene.gamePlay.gameUI.header.getCanDebug())return[3,3];if(!this.isDebugWin)return[3,1];return this.gameScene.gamePlay.handleGameWin(),[3,3];case 1:return this.gameScene.toggleBlockInputContainer(!0),e=ee.levelManager.getLevel(),[4,this.loadInputLevel(e+1)];case 2:t.sent(),this.gameScene.toggleBlockInputContainer(!1),t.label=3;case 3:return[2]}})}),function(){return g.apply(this,arguments)})},{key:"handleClickedPreviousLevel",value:(m=y(function(){var e;return _ts_generator(this,function(t){switch(t.label){case 0:if(!this.gameScene.gamePlay.gameUI.header.getCanDebug())return[3,2];return this.gameScene.toggleBlockInputContainer(!0),e=ee.levelManager.getLevel(),[4,this.loadInputLevel(e-1)];case 1:t.sent(),this.gameScene.toggleBlockInputContainer(!1),t.label=2;case 2:return[2]}})}),function(){return m.apply(this,arguments)})},{key:"handleResetLevel",value:function(){this.gameScene.gamePlay.gameUI.header.getCanDebug()&&this.gameScene.gamePlay.handleGameOver()}},{key:"handleClickedClearDataButton",value:(f=y(function(){return _ts_generator(this,function(e){return this.gameScene.gamePlay.gameUI.header.getCanDebug()&&this.resetDefaultData(),[2]})}),function(){return f.apply(this,arguments)})},{key:"resetDefaultData",value:function(){this.gameScene.gamePlay.gameDataManager.setGameData({level:1,coins:10,currentMaxLevel:0,items:{undo:0,shuffle:0,magicWand:0,return:0,extraSlot:0},dailyChallenge:{timeCompleted:0,daysCompleted:0,isTodayCompleted:!1},timeWatchAdsSuccess:{rewardScreen:0,shopScreen:{}},collectedChapterEndLevel:0,dashboardAnimLevel:1,removeAds:{endTime:0},tournamentsJoined:[],dailyMissions:{timeJoined:0,passLevels:{count:0,isClaimed:!1},useBoosters:{count:0,isClaimed:!1},collectTiles:{count:0,isClaimed:!1},passLevelsInARow:{count:0,isClaimed:!1}},lastClaimDailyReward:0})}},{key:"loadInputLevel",value:(v=y(function(e){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(t=this.gameScene.gamePlay,e===W.MAX_LEVEL+1||0===e)throw new Error("Level is not defined");return ee.levelManager.setLevel(e),t.gameDataManager.setGameData({level:e}),t.tileContainer.reset(),this.gameScene.background.loadBgData(),[4,t.startGameAsync()];case 1:return n.sent(),[2]}})}),function(e){return v.apply(this,arguments)})},{key:"onAdd3ForAllItemsBtnClick",value:function(){var e=this.gameScene.gamePlay.gameDataManager.getItems(),t=h(h({},e),{},{undo:e.undo+3,shuffle:e.shuffle+3,magicWand:e.magicWand+3});this.gameScene.gamePlay.gameDataManager.setGameData({items:t})}},{key:"onMinus3ForAllItemsBtnClick",value:function(){var e=this.gameScene.gamePlay.gameDataManager.getItems(),t=h(h({},e),{},{undo:e.undo-3<0?0:e.undo-3,shuffle:e.shuffle-3<0?0:e.shuffle-3,magicWand:e.magicWand-3<0?0:e.magicWand-3});this.gameScene.gamePlay.gameDataManager.setGameData({items:t})}}]),b}(E)).prototype,"nextStepButton",[nL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nN=e(nM.prototype,"autoPlayButton",[nI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nO=e(nM.prototype,"numpadUI",[nD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nx=e(nM.prototype,"isDebugWin",[nA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),nz=e(nM.prototype,"add3ForAllItemsBtn",[nR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nU=e(nM.prototype,"minus3ForAllItemsBtn",[n_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nM)),g._RF.pop(),g._RF.push({},"cb1353BpE5Ne52kUTq+zLJM","GlowBowl",void 0);var nj,nJ,nH,nY,nX,nZ,nQ,n$,n0,n1,n3,n2,n5,n4,n6,n8,n7,n9,ae,at=(0,C.ccclass)("GlowBowl")(nK=function(e){t(o,e);var i=n(o);function o(){var e;a(this,o);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=i.call.apply(i,[this].concat(n))).dotsChild=[],e.dotsTween=[],e}return l(o,[{key:"__preload",value:function(){this.init()}},{key:"init",value:function(){for(var e=0;e<this.node.children.length;e++)this.dotsChild.push(this.node.children[e])}},{key:"prepareGlow",value:function(){for(var e=0;e<this.dotsChild.length;e++){this.dotsChild[e].scale=new _(0,0,0);var t=this.dotsChild[e].getComponent(N);t&&(t.opacity=0)}}},{key:"runGlow",value:function(){for(var e=0;e<this.dotsChild.length;e++){var t=this.dotsChild[e],n=(1e3*Math.random()+1e3)/1e3,a=1e3*Math.random()/1e3,i=t.getComponent(N);if(i){var r=G(t).delay(a).to(n,{scale:new _(1,1,1)},{easing:"sineInOut"}).to(n,{scale:new _(0,0,0)},{easing:"sineInOut"}).union().repeatForever().start(),l=G(i).delay(a).to(n,{opacity:255},{easing:"sineInOut"}).to(n,{opacity:0},{easing:"sineInOut"}).union().repeatForever().start();this.dotsTween.push(r,l)}}}},{key:"stopGlow",value:function(){for(var e=0;e<this.dotsTween.length;e++)this.dotsTween[e].stop()}}]),o}(E))||nK;g._RF.pop(),g._RF.push({},"1db83Uh/bNNyr/6sjnB3I7v","FreeRubiesScreen",void 0);var an=C.ccclass,aa=C.property,ai=GameCore,ar=ai.Events,ao=ai.Utils,as=globalThis.game.event;nj=an("FreeRubiesScreen"),nJ=aa(T),nH=F.required,nY=aa(T),nX=F.required,nZ=aa(B),nQ=F.required,n$=aa(Z),n0=F.required,n1=aa(at),n3=F.required,n2=F.required,nj((n4=e((n5=function(e){t(S,e);var u,h,v,f,m,g,C,B,w,E,T,L=n(S);function S(){var e;a(this,S);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return e=L.call.apply(L,[this].concat(n)),i(e,"container",n4,r(e)),i(e,"bowl",n6,r(e)),i(e,"watchVideoText",n8,r(e)),i(e,"glowDot",n7,r(e)),i(e,"glowBowl",n9,r(e)),i(e,"baseScreen",ae,r(e)),e.enableCloseOnTouch=!0,e.rewardRubies=50,e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&e.updateScreenData(t)},e.handleClosingScreen=function(t){e.validateEventPayload(t)&&e.unscheduleAllCallbacks()},e}return l(S,[{key:"__preload",value:function(){this.listenScreenEvents(),this.baseScreen=this.node.getComponent("BaseScreen"),this.baseScreen.open=this.open.bind(this),this.baseScreen.close=this.close.bind(this),this.container.scale=new _(.5,.5);var e=this.node.getComponent(N);e&&(e.opacity=0),this.validateRequiredComponents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"start",value:function(){var e=this.container.getComponent(N);e&&(e.opacity=255)}},{key:"open",value:(T=y(function(){var e;return _ts_generator(this,function(t){switch(t.label){case 0:return el.playSound(Q.POPUP_SHOW),ec(),this.updateWatchAdsText(),this.glowDot.prepareGlow(),this.glowBowl.prepareGlow(),this.bowl.active=!0,[4,Promise.all([(e=ee.gameScene).rubyBarComp.hidePlusIcon(),e.rubyBarComp.runHideAnimationAsync(),this.runEntranceAnimation()])];case 1:return t.sent(),this.glowDot.runGlow(),this.glowBowl.runGlow(),as.emit(ar.OPENED_SCREEN,{screenName:this.node.name,screenData:this.baseScreen.data}),as.emit(eu.OPEN_ANIM_FINISHED,{name:this.node.name}),[2]}})}),function(){return T.apply(this,arguments)})},{key:"updateWatchAdsText",value:function(){if(globalThis.game.language.hasTextKey("Watch a video")){var e=globalThis.game.language.getText("Watch a video",["".concat(this.rewardRubies)]);this.watchVideoText.string=e}}},{key:"close",value:(E=y(function(){var e;return _ts_generator(this,function(t){switch(t.label){case 0:return el.playSound(Q.POPUP_OFF),this.glowDot.stopGlow(),this.glowBowl.stopGlow(),[4,Promise.all([(e=ee.gameScene).rubyBarComp.runShowAnimationAsync(),this.runExitAnimation()])];case 1:return t.sent(),e.rubyBarComp.showPlusIcon(),as.emit(ar.CLOSED_SCREEN,{screenName:this.node.name}),this.node.active=!1,as.emit(eu.CLOSE_ANIM_FINISHED,{name:this.node.name}),[2]}})}),function(){return E.apply(this,arguments)})},{key:"runExitAnimation",value:(w=y(function(){return _ts_generator(this,function(e){return[2,Promise.all([this.runScreenExitAnimation(),this.runPopupExitAnimation()])]})}),function(){return w.apply(this,arguments)})},{key:"runScreenExitAnimation",value:(B=y(function(){var e;return _ts_generator(this,function(t){if(e=this.node.getComponent(N))return[2,new Promise(function(t){G(e).to(.25,{opacity:0}).call(function(){return t()}).start()})];return[2]})}),function(){return B.apply(this,arguments)})},{key:"runPopupExitAnimation",value:(C=y(function(){var e;return _ts_generator(this,function(t){return e=this,[2,new Promise(function(t){G(e.container).to(.3,{scale:new _(.5,.5,1)},{easing:"backIn"}).call(function(){return t()}).start()})]})}),function(){return C.apply(this,arguments)})},{key:"runEntranceAnimation",value:(g=y(function(){return _ts_generator(this,function(e){return[2,Promise.all([this.runScreenEntranceAnimation(),this.runPopupEntranceAnimation()])]})}),function(){return g.apply(this,arguments)})},{key:"runScreenEntranceAnimation",value:(m=y(function(){var e;return _ts_generator(this,function(t){if(e=this.node.getComponent(N))return[2,new Promise(function(t){G(e).to(.25,{opacity:255}).call(function(){return t()}).start()})];return[2]})}),function(){return m.apply(this,arguments)})},{key:"runPopupEntranceAnimation",value:(f=y(function(){var e;return _ts_generator(this,function(t){return e=this,[2,new Promise(function(t){var n=e.baseScreen.backgroundMask.getComponent(N);n&&G(n).to(.25,{opacity:255}).start(),G(e.container).to(.3,{scale:new _(1,1,1)},{easing:"backOut"}).call(function(){return t()}).start()})]})}),function(){return f.apply(this,arguments)})},{key:"validateRequiredComponents",value:function(){F.validateRequiredProperties(this,S)}},{key:"listenScreenEvents",value:function(){as.on(ar.OPENING_SCREEN,this.handleOpeningScreen),as.on(ar.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"unListenScreenEvents",value:function(){as.off(ar.OPENING_SCREEN,this.handleOpeningScreen),as.off(ar.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"updateScreenData",value:function(e){var t=e.screenData;ao.Valid.isObject(t)&&(t.duration&&t.duration>0&&this.scheduleOnce(function(){en.closeScreen(ei.TUTORIAL_SCREEN)},t.duration),!1===t.enableCloseOnTouch?this.enableCloseOnTouch=!1:this.enableCloseOnTouch=!0)}},{key:"handleClose",value:(v=y(function(){var e;return _ts_generator(this,function(t){switch(t.label){case 0:return(e=ee.gameScene).toggleBlockInputContainer(!0),[4,en.closeScreenAsync(ei.FREE_RUBIES_SCREEN)];case 1:return t.sent(),e.toggleBlockInputContainer(!1),[2]}})}),function(){return v.apply(this,arguments)})},{key:"handleClickedAd",value:(h=y(function(){return _ts_generator(this,function(e){switch(e.label){case 0:return[4,eh.showRewardVideoAdAsync2("FREE_RUBIES_SCREEN")];case 1:if(!e.sent())return[3,3];return ee.gameScene.toggleBlockInputContainer(!0),[4,this.handleWatchedFullAd()];case 2:e.sent(),ee.gameScene.toggleBlockInputContainer(!1),e.label=3;case 3:return[2]}})}),function(){return h.apply(this,arguments)})},{key:"handleWatchedFullAd",value:(u=y(function(){return _ts_generator(this,function(e){switch(e.label){case 0:return ee.gameScene.toggleBlockInputContainer(!0),ee.gameScene.rubyBarComp.setCanUpdateRubyAmountAfterSetGameData(!1),ee.gameScene.gamePlay.addCoinData(this.rewardRubies),this.bowl.active=!1,[4,Promise.all([en.closeScreenAsync(ei.FREE_RUBIES_SCREEN),ee.gameScene.shop.runAnimationGetRubyByFreeRubiesScreen(this.bowl.worldPosition,this.rewardRubies)])];case 1:return e.sent(),ee.gameScene.rubyBarComp.setCanUpdateRubyAmountAfterSetGameData(!0),this.node.scene.emit(K.CLAIM_COIN_SUCCEEDED),ee.gameScene.toggleBlockInputContainer(!1),[2]}})}),function(){return u.apply(this,arguments)})}]),S}(E)).prototype,"container",[nJ,nH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n6=e(n5.prototype,"bowl",[nY,nX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n8=e(n5.prototype,"watchVideoText",[nZ,nQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n7=e(n5.prototype,"glowDot",[n$,n0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n9=e(n5.prototype,"glowBowl",[n1,n3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ae=e(n5.prototype,"baseScreen",[n2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n5)),g._RF.pop()}}}),function(e){e("virtual:///prerequisite-imports/loadable","chunks:///loadable.js")}(function(e,t){System.register(e,[t],function(e,t){return{setters:[function(t){var n={};for(var a in t)if("default"!==a&&"__esModule"!==a)n[a]=t[a];e(n)}],execute:function(){}}})});