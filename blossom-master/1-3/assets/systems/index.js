function _instanceof(r,c){if(null!=c&&"undefined"!=typeof Symbol&&c[Symbol.hasInstance])return!!c[Symbol.hasInstance](r);return r instanceof c}function _type_of(r){return r&&"undefined"!=typeof Symbol&&r.constructor===Symbol?"symbol":typeof r}function _ts_generator(r,c){var f,y,m,S={label:0,sent:function(){if(1&m[0])throw m[1];return m[1]},trys:[],ops:[]},w=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return w.next=verb(0),w.throw=verb(1),w.return=verb(2),"function"==typeof Symbol&&(w[Symbol.iterator]=function(){return this}),w;function verb(r){return function(c){return step([r,c])}}function step(_){if(f)throw new TypeError("Generator is already executing.");while(w&&(w=0,_[0]&&(S=0)),S)try{if(f=1,y&&(m=2&_[0]?y.return:_[0]?y.throw||((m=y.return)&&m.call(y),0):y.next)&&!(m=m.call(y,_[1])).done)return m;if(y=0,m)_=[2&_[0],m.value];switch(_[0]){case 0:case 1:m=_;break;case 4:return S.label++,{value:_[1],done:false};case 5:S.label++,y=_[1],_=[0];continue;case 7:_=S.ops.pop(),S.trys.pop();continue;default:if(!(m=(m=S.trys).length>0&&m[m.length-1])&&(6===_[0]||2===_[0])){S=0;continue}if(3===_[0]&&(!m||_[1]>m[0]&&_[1]<m[3])){S.label=_[1];break}if(6===_[0]&&S.label<m[1]){S.label=m[1],m=_;break}if(m&&S.label<m[2]){S.label=m[2],S.ops.push(_);break}if(m[2])S.ops.pop();S.trys.pop();continue}_=c.call(r,S)}catch(r){_=[6,r],y=0}finally{f=m=0}if(5&_[0])throw _[1];return{value:_[0]?_[1]:void 0,done:true}}}System.register("chunks:///systems.js",["./rollupPluginModLoBabelHelpers-41cf6f9b.js","cc","./AnalyticsUtils-9a227e15.js","./InvalidCheck-eedc91c6.js","./cjs-loader-b56ba787.js"],function(r,c){var f,y,m,S,w,_,b,A,C,T,R,k,D,L,F,P,O,N,I,x,M,U,G,B,V,H,z,j,q,W,Y,Q,K,X,J,Z,$,ee,et,en,er,ea,ei,es,eo,eu,ec,el,eh,ed,ef,ep,ev,eg,ey,em,eE,eS,ew,e_,eb,eA;return{setters:[function(r){f=r._,y=r.f,m=r.g,S=r.c,w=r.d,_=r.h,b=r.i,A=r.j,C=r.k,T=r.l,R=r.a,k=r.b},function(r){D=r.cclegacy,L=r.game,F=r.settings,P=r.Settings,O=r.AssetManager,N=r.director,I=r.input,x=r.Input,M=r.sys,U=r.macro,G=r.DynamicAtlasManager,B=r.view,V=r.ResolutionPolicy,H=r.Size,z=r.screen,j=r.Director,q=r.Texture2D,W=r.assetManager,Y=r.Layers,Q=r.ImageAsset,K=r.instantiate,X=r.Node,J=r.UITransform,Z=r.UIOpacity,$=r.Game,ee=r.gfx,et=r._decorator,en=r.rendering,er=r.Component},function(r){ea=r.G,ei=r.A,es=r.a,eo=r.C,eu=r.b,ec=r.R,el=r.L,eh=r.S,ed=r.c,ef=r.d,ep=r.e},function(r){ev=r.P,eg=r.G,ey=r.E,r.B,em=r.L,eE=r.a,eS=r.b,ew=r.S,e_=r.c,eb=r.d},function(r){eA=r.l}],execute:function(){var r,c,eC,eT={text:{fpsX:"FPS: {{num}}","Loading...":"Loading...","\nRetrieving puzzle data.\nThis may take a bit longer\non slower networks.":"\nRetrieving puzzle data.\nThis may take a bit longer\non slower networks.","\nOops!\nSomething went wrong.\nLet's try again soon!":"\nOops!\nSomething went wrong.\nLet's try again soon!","Loading ads...":"Loading ads...","No ads to display!":"No ads to display!","Sorry, no rewards!\n You have cancelled the ad.":"Sorry, no rewards!\nYou have cancelled the ad.",LEVEL_X:"LEVEL %{0}",levelX:"Level %{0}",MAP:"MAP",REPLAY:"REPLAY",REVIVE:"REVIVE",NEXT:"NEXT",SETTINGS:"SETTINGS",SFX:"SFX",MUSIC:"MUSIC",VIBRATION:"VIBRATION",TUTORIAL:"TUTORIAL",LANGUAGES:"LANGUAGES",FANPAGE:"FANPAGE","INVITE FRIENDS":"INVITE FRIENDS","FOLLOW PAGE":"FOLLOW PAGE","JOIN GROUP":"JOIN GROUP","YOU GOT A GIFT BOX!":"YOU GOT A GIFT BOX!","CHAPTER COMPLETE!":"CHAPTER COMPLETE!","Chapter Complete!":"Chapter Complete!",COLLECT:"COLLECT","You got 3 rewards!":"You got 3 rewards!","SELECT LANGUAGE":"SELECT LANGUAGE",CONFIRM:"CONFIRM","HOW TO PLAY":"HOW TO PLAY","Collect 3 same tiles to eliminate":"Collect 3 same tiles to eliminate",OK:"OK","Loading Image":"Loading\nImage","Find Opponent":"Find Opponent",BACK:"BACK",YOU:"YOU","Complete all daily tasks":"Complete all daily tasks",Finished:"Finished",CONTINUE:"CONTINUE","Collect Golden Clover Tiles to complete the challenge!":"Collect Golden Clover Tiles\nto complete the challenge!",Shop:"Shop","Daily Mission":"Daily Missions","Daily Reward":"Daily Reward",Leaderboard:"Leaderboard","VS Friends":"VS Friends",Tournament:"Tournament",CLAIM:"CLAIM",GO:"GO","Pass levels":"Pass levels","Use boosters":"Use boosters","Collect tiles":"Collect tiles","Pass levels in a row":"Pass levels in a row",Reward:"Reward",Xdays:"%{0} days","All daily tasks completed":"All daily tasks completed","Leaderboard is empty":"Leaderboard is empty","NEW MATCH":"NEW MATCH","Failed to play with\nyour friend":"Failed to play with\nyour friend","Joining tournament...":"Joining tournament...","Failed to save your score":"Failed to save your score","Failed to get your new rank":"Failed to get your new rank","Failed to load leaderboard":"Failed to load leaderboard","Retrieving puzzle data.\nThis may take a bit longer\non slower networks.":"Retrieving puzzle data.\nThis may take a bit longer\non slower networks.","Purchase successful":"Purchase successful","Purchase failed":"Purchase failed","Sorry, you cannot join\nat this time.":"Sorry, you cannot join\nat this time.","No tournament right now!":"No tournament right now!","Failed to join tournament":"Failed to join tournament","Failed to load tournament result":"Failed to load tournament result","Purchasing...":"Purchasing...","Remove ADS":"Remove ADS",XRubies:"%{0} Rubies","30 days + 300 Rubies":"30 days + 300 Rubies",START:"START","Win levels!":"Win levels!","Collect Golden Clover Tiles!":" Collect\nGolden Clover Tiles!","Improve ranking!":"Improve ranking!","Tap to continue":"Tap to continue",End:"End",PickDailyGift:"Pick your daily gift!",DailyReward:"Daily Gifts",Congratulations:"Congratulations!",Collect:"Collect","Collect x2":"Collect x2",DailyGift:"Daily Gift",CHALLENGE:"CHALLENGE","Daily Challenge":"Daily Challenge","NO MORE SPACE":"NO MORE SPACE",WATCH:"WATCH","First Win Quote p1":"Victory achieved!\n%{0}% of players couldn’t keep up!","First Win Quote p2":"Surpassed %{0}% of players!\nVictory is yours!","First Win Quote p3":"Beat %{0}% of players!\nYou showed a perfect performance!","Retry Win Quote 1":"Not an easy challenge, but you\nshowed how it's done!","Retry Win Quote 2":"That level wasn’t easy, but you\nnailed it like a champ!","Retry Win Quote 3":"That was a tough one, but you\nhandled it beautifully!",Only:"Only","levels left":"levels left!!",SHARE:"SHARE","PURCHASE CANCELED":"PURCHASE CANCELED","Purchase has been canceled":"Purchase has been canceled",RewardTournament:"Congratulations! You placed at %{0}%%{1}%!\nClaim your reward now!","Watch a video":"Watch a video for x%{0} RUBIES","The tournament is over":"The tournament is over!","You got 2 rewards!":"You got 2 rewards!"},texture:{DailyMissionTexture:"locales/textures/daily-mission-screen/title-en",CloverChallengeTexture:"locales/textures/clover-challenge/clover-challenge-en",CloverChallengeGuideTexture:"locales/textures/clover-challenge/clover-challenge-guide-en",LeaderboardTexture:"locales/textures/leaderboard/leaderboard-en",MegaBundleTexture:"locales/textures/shop/mega-bundle-en",SuperBundleTexture:"locales/textures/shop/super-bundle-en",ShopTitleTexture:"locales/textures/shop/shop-en",CollectTexture:"locales/textures/daily-reward/collect-en",DailyGiftTexture:"locales/textures/daily-reward/daily-gift-en",PickDailyGiftTexture:"locales/textures/daily-reward/pick-daily-gift-en",DesNoMoreSpaceTexture:"locales/textures/no-more-space/des-en",ResultScreenTitleTexture:"locales/textures/result-screen/text-overcome-en",FreeRubiesScreenTitleTexture:"locales/textures/free-rubies-screen/title-en",TournamentResultScreenTitleTexture:"locales/textures/tournament-result-screen/title-en",LeaderboardScreenTitleTexture:"locales/textures/leaderboard-screen/title-en"}};D._RF.push({},"0b067Iz+iFJLJjNpsfblY7S","AdsManager",void 0);var eR=GameCore,ek=eR.Events,eD=eR.Configs.Ads,eL=eD.Enabled,eF=eD.PreloadAds,eP=eD.ShowAdOnLoad,eO=eD.BannerDisplayAdOptions,eN=eR.Utils,eI=eN.Time,ex=eN.Decorator,eM=globalThis.game.event,eU=(r=ex.tryCatch(),eC=f((c=function(){function e(){var r=this;S(this,e),this.currentLayout="",this.processShowBannerAds=function(){},this.processPreloadAds=m(function(){return _ts_generator(this,function(r){switch(r.label){case 0:if(!eF)return[3,2];return[4,eI.sleepAsync(3e3)];case 1:r.sent(),ei.preloadAds(),r.label=2;case 2:return[2]}})}),w(this,"processShowFirstInterstitialAd",eC,this),this.handleLayoutChanged=function(c){r.currentLayout!==c&&(r.currentLayout=c,c!==es.Layout.Landscape?eO.forEach(function(r){var c=r.PlacementId,f=r.Position;"bottom"===f||"top"===f||ei.hideBannerAd(c)}):r.processShowBannerAds())}}return y(e,[{key:"init",value:function(){this.listenEvents()}},{key:"listenEvents",value:function(){L.on(ea.LAYOUT_CHANGED,this.handleLayoutChanged),eM.catchUp(ek.GAME_READY,this.processPreloadAds),eM.catchUp(ek.GAME_READY,this.processShowBannerAds),eM.catchUp(ek.GAME_SDK_READY,this.processShowFirstInterstitialAd)}}]),e}()).prototype,"processShowFirstInterstitialAd",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return m(function(){var r,c,f;return _ts_generator(this,function(y){switch(y.label){case 0:if(!eL)return[3,4];if(r=eP.Enabled,c=eP.DelaySeconds,!r)return[3,4];if(!(c>0))return[3,2];return[4,eI.sleepAsync(1e3*c)];case 1:y.sent(),y.label=2;case 2:return(f="Yandex"===GameSDK.getSDKName())&&L.pause(),[4,ei.showInterstitialAdAsync({forceLoad:!0,contextType:"preroll"})];case 3:y.sent(),f&&L.resume(),y.label=4;case 4:return[2]}})})}}),c);D._RF.pop(),D._RF.push({},"43001Am3F9GVZjL3Nj2K44h","CoreManager",void 0);var eG=GameCore.Events,eB=globalThis.game.event,eV=function(){function e(){S(this,e)}return y(e,[{key:"init",value:function(){}},{key:"requestStart",value:function(){eB.emit(eG.REQUEST_CORE_START)}},{key:"onCoreBoot",value:function(r){eB.catchUp(eG.CORE_BOOTING,r)}},{key:"onCoreStart",value:function(r){eB.catchUp(eG.CORE_STARTING,r)}},{key:"onCoreReady",value:function(r){eB.catchUp(eG.CORE_READY,r)}}]),e}();D._RF.pop(),D._RF.push({},"b4ad5mMokdAa6EVNGzNedpF","EngineManager",void 0);var eH,ez=GameCore,ej=ez.Events,eq=ez.Configs.GameEngine,eW=eq.DynamicAtlas,eY=eq.PreferredFPS,eQ=ez.Utils,eK=eQ.Valid,eX=eQ.Device,eJ=globalThis.game.event,eZ=function(){var r;function e(){var r=this;S(this,e),this.handlePauseEngine=m(function(){return _ts_generator(this,function(r){return L.isPaused(),[2]})}),this.handleResumeEngine=m(function(){return _ts_generator(this,function(c){return r.restoreRequestAnimationFrame(),L.isPaused(),[2]})})}return y(e,[{key:"init",value:function(){this.overrideSettings(),this.setupAutoAtlas(),this.setupBatcherLimit(),this.setupDynamicAtlas(),this.setupAssetDownloader(),this.setupOptimalPipelines(),this.setupEngineRunningState()}},{key:"overrideSettings",value:function(){F.overrideSettings(P.Category.ENGINE,"debug",eK.isDebugger()),eX.isDesktop()?L.frameRate=eY.Desktop:L.frameRate=eY.Mobile}},{key:"setupAutoAtlas",value:function(){O.instance.cacheAsset=!0}},{key:"setupAssetDownloader",value:function(){var r=O.instance.downloader;r.maxConcurrency=30,r.maxRequestsPerFrame=30}},{key:"getPipelineFlows",value:function(){var r,c;return null!=(r=null==(c=N.root)||null==(c=c.pipeline)?void 0:c.flows)?r:[]}},{key:"getRenderQueues",value:function(r){var c=this.getPipelineFlows()[0];return null!=c&&c.stages?c.stages[r].renderQueues:[]}},{key:"setupOptimalPipelines",value:(r=m(function(){return _ts_generator(this,function(r){return O.instance.transformPipeline.remove(1),[2]})}),function(){return r.apply(this,arguments)})},{key:"setupEngineRunningState",value:function(){var r=this;I.on(x.EventType.TOUCH_START,this.handleResumeEngine),eJ.catchUp(ej.GAME_READY,function(){eJ.on(ej.VISIBILITY_HIDDEN,r.handlePauseEngine),eJ.on(ej.VISIBILITY_VISIBLE,r.handleResumeEngine),r.restoreRequestAnimationFrame()})}},{key:"restoreRequestAnimationFrame",value:function(){window.isCustomRequestAnimationFrame=!1}},{key:"setupDynamicAtlas",value:function(){switch(M.os){case M.OS.IOS:this.setupDynamicAtlasForIOS();break;case M.OS.ANDROID:this.setupDynamicAtlasForAndroid();break;default:this.setupDynamicAtlasForDesktop()}}},{key:"setDynamicAtlas",value:function(r){var c=r.Enabled,f=r.AutoAtlasSize,y=r.MaxAtlasCount,m=r.MaxAtlasSize,S=r.MaxFrameSize;if(U.CLEANUP_IMAGE_CACHE=!c,G.instance.enabled=c,G.instance.textureSize=m,G.instance.maxFrameSize=S,G.instance.maxAtlasCount=y,G.instance.textureBleeding=eW.TextureBleeding,f){var w=this.getMaxTextureSize();if(!w)return;G.instance.textureSize=w}}},{key:"getMaxTextureSize",value:function(){if(!N.root)return -1;var r=N.root.device.capabilities.maxTextureSize;if(r>8192)return 7168;var c=G.instance.maxFrameSize,f=r-1024;return f<=(void 0===c?0:c)||f<=0?-1:f}},{key:"setupDynamicAtlasForIOS",value:function(){var r=eW.IOS;this.setDynamicAtlas(r)}},{key:"setupDynamicAtlasForAndroid",value:function(){var r=eW.Android;this.setDynamicAtlas(r)}},{key:"setupDynamicAtlasForDesktop",value:function(){var r=eW.Desktop;this.setDynamicAtlas(r)}},{key:"setupBatcherLimit",value:function(){U.BATCHER2D_MEM_INCREMENT=288,U.MAX_LABEL_CANVAS_POOL_SIZE=125}}]),e}();function Ue(r){return(Ue="function"==typeof Symbol&&"symbol"==_type_of(Symbol.iterator)?function(r){return void 0===r?"undefined":_type_of(r)}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":void 0===r?"undefined":_type_of(r)})(r)}D._RF.pop();var e$,e0,e1,e2="file:///Users/anhquan/Desktop/Repository/blossom-master-cocos/node_modules/resize-observer-polyfill/dist/ResizeObserver.js";eA.define(e2,function(r,c,f,y,m){!function(c,y){"object"===Ue(r)&&void 0!==f?f.exports=y():"function"==typeof define&&define.amd?define(y):c.ResizeObserver=y()}(this,function(){var r=function(){if("undefined"!=typeof Map)return Map;function e(r,c){var f=-1;return r.some(function(r,y){return r[0]===c&&(f=y,!0)}),f}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(r){var c=e(this.__entries__,r),f=this.__entries__[c];return f&&f[1]},t.prototype.set=function(r,c){var f=e(this.__entries__,r);~f?this.__entries__[f][1]=c:this.__entries__.push([r,c])},t.prototype.delete=function(r){var c=this.__entries__,f=e(c,r);~f&&c.splice(f,1)},t.prototype.has=function(r){return!!~e(this.__entries__,r)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(r,c){void 0===c&&(c=null);for(var f=0,y=this.__entries__;f<y.length;f++){var m=y[f];r.call(c,m[1],m[0])}},t}()}(),c="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,f="undefined"!=typeof global&&global.Math===Math?global:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),y="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(f):function(r){return setTimeout(function(){return r(Date.now())},1e3/60)};var m=["top","right","bottom","left","width","height","size","weight"],S="undefined"!=typeof MutationObserver,w=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(r,c){var f=!1,m=!1,S=0;function o(){f&&(f=!1,r()),m&&l()}function s(){y(o)}function l(){var r=Date.now();if(f){if(r-S<2)return;m=!0}else f=!0,m=!1,setTimeout(s,20);S=r}return l}(this.refresh.bind(this),0)}return e.prototype.addObserver=function(r){~this.observers_.indexOf(r)||this.observers_.push(r),this.connected_||this.connect_()},e.prototype.removeObserver=function(r){var c=this.observers_,f=c.indexOf(r);~f&&c.splice(f,1),!c.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var r=this.observers_.filter(function(r){return r.gatherActive(),r.hasActive()});return r.forEach(function(r){return r.broadcastActive()}),r.length>0},e.prototype.connect_=function(){c&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),S?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){c&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(r){var c=r.propertyName,f=void 0===c?"":c;m.some(function(r){return!!~f.indexOf(r)})&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),s=function(r,c){for(var f=0,y=Object.keys(c);f<y.length;f++){var m=y[f];Object.defineProperty(r,m,{value:c[m],enumerable:!1,writable:!1,configurable:!0})}return r},l=function(r){return r&&r.ownerDocument&&r.ownerDocument.defaultView||f},_=v(0,0,0,0);function u(r){return parseFloat(r)||0}function d(r){for(var c=[],f=1;f<arguments.length;f++)c[f-1]=arguments[f];return c.reduce(function(c,f){return c+u(r["border-"+f+"-width"])},0)}function h(r){var c=r.clientWidth,f=r.clientHeight;if(!c&&!f)return _;var y=l(r).getComputedStyle(r),m=function(r){for(var c={},f=0,y=["top","right","bottom","left"];f<y.length;f++){var m=y[f],S=r["padding-"+m];c[m]=u(S)}return c}(y),S=m.left+m.right,w=m.top+m.bottom,b=u(y.width),A=u(y.height);if("border-box"===y.boxSizing&&(Math.round(b+S)!==c&&(b-=d(y,"left","right")+S),Math.round(A+w)!==f&&(A-=d(y,"top","bottom")+w)),!function(r){return r===l(r).document.documentElement}(r)){var C=Math.round(b+S)-c,T=Math.round(A+w)-f;1!==Math.abs(C)&&(b-=C),1!==Math.abs(T)&&(A-=T)}return v(m.left,m.top,b,A)}var b="undefined"!=typeof SVGGraphicsElement?function(r){return _instanceof(r,l(r).SVGGraphicsElement)}:function(r){return _instanceof(r,l(r).SVGElement)&&"function"==typeof r.getBBox};function p(r){return c?b(r)?function(r){var c=r.getBBox();return v(0,0,c.width,c.height)}(r):h(r):_}function v(r,c,f,y){return{x:r,y:c,width:f,height:y}}var A=function(){function e(r){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=v(0,0,0,0),this.target=r}return e.prototype.isActive=function(){var r=p(this.target);return this.contentRect_=r,r.width!==this.broadcastWidth||r.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var r=this.contentRect_;return this.broadcastWidth=r.width,this.broadcastHeight=r.height,r},e}(),g=function(r,c){var f,y,m,S,w,_,b=(f=c.x,y=c.y,m=c.width,S=c.height,w="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,s(_=Object.create(w.prototype),{x:f,y:y,width:m,height:S,top:y,right:f+m,bottom:S+y,left:f}),_);s(this,{target:r,contentRect:b})},C=function(){function t(c,f,y){if(this.activeObservations_=[],this.observations_=new r,"function"!=typeof c)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=c,this.controller_=f,this.callbackCtx_=y}return t.prototype.observe=function(r){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&_instanceof(Element,Object)){if(!_instanceof(r,l(r).Element))throw new TypeError('parameter 1 is not of type "Element".');var c=this.observations_;c.has(r)||(c.set(r,new A(r)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(r){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&_instanceof(Element,Object)){if(!_instanceof(r,l(r).Element))throw new TypeError('parameter 1 is not of type "Element".');var c=this.observations_;c.has(r)&&(c.delete(r),c.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var r=this;this.clearActive(),this.observations_.forEach(function(c){c.isActive()&&r.activeObservations_.push(c)})},t.prototype.broadcastActive=function(){if(this.hasActive()){var r=this.callbackCtx_,c=this.activeObservations_.map(function(r){return new g(r.target,r.broadcastRect())});this.callback_.call(r,c,r),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),T="undefined"!=typeof WeakMap?new WeakMap:new r,E=function e(r){if(!_instanceof(this,e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var c=new C(r,w.getInstance(),this);T.set(this,c)};return["observe","unobserve","disconnect"].forEach(function(r){E.prototype[r]=function(){var c;return(c=T.get(this))[r].apply(c,arguments)}}),void 0!==f.ResizeObserver?f.ResizeObserver:E}),eH=f.exports},{}),eA.require(e2),D._RF.push({},"9f0a0l1uXlNwqKEKardFRyv","LayoutManager",void 0);var e3=es.Layout,e4=es.DesignSize,e5=e4.Portrait,e6=e4.Landscape,e9=es.AcceptPortraitRatio,e7=GameCore,e8=e7.Utils,te=e8.Device,tt=e8.Decorator,tn=e7.Configs.GameEngine.AutoResizeCanvas,tr=(e$=tt.debounce(100),e1=f((e0=function(){function e(){var r=this;S(this,e),this.currentLayout=void 0,this.resolutionPolicy=void 0,this.handleViewResizeBySystem=function(c){if(!r.isAdShowing()){var f=te.pixelRatio();window.devicePixelRatio=null!=c?c:f,r.setupOrientationByCanvasSize()}},w(this,"handleBodyResize",e1,this)}return y(e,[{key:"init",value:function(){this.listenResizeEvent(),this.setupResolutionPolicy()}},{key:"listenResizeEvent",value:function(){if(tn){var r=window.listeners.resize;if(r.length>0){var c,f=_(r);try{for(f.s();!(c=f.n()).done;){var y=c.value;window.removeEventListener("resize",y)}}catch(r){f.e(r)}finally{f.f()}}new eH(this.handleBodyResize).observe(window.document.body)}L.on(ea.REQUEST_VIEW_RESIZE,this.handleViewResizeBySystem)}},{key:"setupResolutionPolicy",value:function(){B.setOrientation(U.ORIENTATION_AUTO),this.resolutionPolicy=B.getResolutionPolicy(),this.resolutionPolicy.setContentStrategy(V.ContentStrategy.EXACT_FIT),this.resolutionPolicy.setContainerStrategy(V.ContainerStrategy.PROPORTION_TO_FRAME)}},{key:"isAdShowing",value:function(){return!!globalThis.game.ads.isAdFullSizeShowing()}},{key:"setupOrientationByCanvasSize",value:function(){var r=this.getScreenRatio();if(!window.hasCheckedDocumentSizeForFirstTime){var c,f=eo.getScreenWidthCss(),y=eo.getScreenHeightCss();if(f!==window.widthBeforeLayoutManager||y!==window.heightBeforeLayoutManager)null==(c=window.game.monitorError)||c.sendException(new Error("LayoutManager resize run before BootScene and size is different"),{screenWidth:f,screenHeight:y,widthBeforeLayoutManager:window.widthBeforeLayoutManager,heightBeforeLayoutManager:window.heightBeforeLayoutManager});es.FULL_LANDSCAPE_SIZE=!(r<=e9),window.hasCheckedDocumentSizeForFirstTime=!0}switch(es.PRIMARY_LAYOUT){case"portrait":this.setPortraitView();break;case"landscape":this.setLandscapeView();break;case"auto":r<=e9?this.setPortraitView():this.setLandscapeView()}}},{key:"setPortraitView",value:function(){var r=e5.WIDTH,c=e5.HEIGHT,f=es.PRIMARY_LAYOUT===e3.Portrait;(this.currentLayout!==e3.Portrait||f)&&(this.currentLayout=e3.Portrait,this.setupLayoutStrategy(r,c)),this.resizeGameView(r,c)}},{key:"setLandscapeView",value:function(){var r=e6.WIDTH,c=e6.HEIGHT,f=es.PRIMARY_LAYOUT===e3.Landscape;(this.currentLayout!==e3.Landscape||f)&&(this.currentLayout=e3.Landscape,this.setupLayoutStrategy(r,c)),this.resizeGameView(r,c)}},{key:"setupLayoutStrategy",value:function(r,c){var f=B.getDesignResolutionSize(),y=f.width,m=f.height,S=this.resolutionPolicy.getContentStrategy(),w=this.resolutionPolicy._containerStrategy.name,_=this.currentLayout===e3.Portrait,b=this.currentLayout===e3.Landscape;_&&this.resolutionPolicy.setContentStrategy(V.ContentStrategy.FIXED_WIDTH),b&&this.resolutionPolicy.setContentStrategy(V.ContentStrategy.FIXED_HEIGHT),_&&!es.FULL_PORTRAIT_SIZE&&(this.resolutionPolicy.setContentStrategy(V.ContentStrategy.SHOW_ALL),this.resolutionPolicy.setContainerStrategy(V.ContainerStrategy.PROPORTION_TO_FRAME)),b&&!es.FULL_LANDSCAPE_SIZE&&(this.resolutionPolicy.setContentStrategy(V.ContentStrategy.EXACT_FIT),this.resolutionPolicy.setContainerStrategy(V.ContainerStrategy.PROPORTION_TO_FRAME)),this.getScreenRatio()>es.AcceptPortraitRatio&&_&&this.resolutionPolicy.setContentStrategy(V.ContentStrategy.FIXED_HEIGHT),_&&this.resolutionPolicy.setContainerStrategy(V.ContainerStrategy.EQUAL_TO_FRAME),es.FULL_LANDSCAPE_SIZE&&b&&this.resolutionPolicy.setContainerStrategy(V.ContainerStrategy.EQUAL_TO_FRAME),y===r&&m===c&&S===this.resolutionPolicy.getContentStrategy()&&w===this.resolutionPolicy._containerStrategy.name||B.setDesignResolutionSize(r,c,this.resolutionPolicy),L.emit(ea.LAYOUT_CHANGED,this.currentLayout)}},{key:"resizeGameView",value:function(r,c){var f=es.DesignSize.Resolution,y=new H(r/f,c/f),m=eo.getScreenWidthCss(),S=eo.getScreenHeightCss(),w=m/y.width,_=S/y.height,b=new H(y.width,y.height),A=this.currentLayout===e3.Portrait,C=es.FULL_LANDSCAPE_SIZE&&this.currentLayout===e3.Landscape;if(A||C)b.width*=w,b.height*=_;else{var T=Math.min(w,_);b.width*=T,b.height*=T}var R=eo.worldSizeToCssSize(b.width),k=eo.worldSizeToCssSize(b.height),D=new H(R,k);z.windowSize=D,L.emit(ea.VIEW_RESIZED,D)}},{key:"getScreenRatio",value:function(){return eo.getScreenWidthCss()/eo.getScreenHeightCss()}}]),e}()).prototype,"handleBodyResize",[e$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var r=this;return function(){if(!r.isAdShowing()){var c=te.pixelRatio();window.devicePixelRatio=c,r.setupOrientationByCanvasSize()}}}}),e0);D._RF.pop(),D._RF.push({},"d675ctpYslBHp4qqiYEki+q","PlayerManager",void 0);var ta=GameCore,ti=ta.Utils.Valid,ts=ta.Dtos.Player,to=globalThis.game.player,tu=function(){function e(){S(this,e)}return y(e,[{key:"init",value:function(){}},{key:"setupDefaultGameData",value:function(){ts.Data.addDefaultData(ev),ts.GameData.addDefaultData(eg),ts.GameData.addValidateFunction("totalLevel",function(r){if(!ti.isNumber(r)||r<1)throw new Error("totalLevel ".concat(r," is invalid"))}),ts.GameData.addValidateFunction("passAllLevels",function(r){if(!ti.isBoolean(r))throw new Error("passAllLevels ".concat(r," is invalid"))}),ts.GameData.addValidateFunction("levelProgress",function(r){if(!ti.isObject(r))throw new Error("levelProgress ".concat(r," is invalid"))}),ts.GameData.addValidateFunction("bestEndlessScore",function(r){if(!ti.isNumber(r)||r<0)throw new Error("bestEndlessScore ".concat(r," is invalid"))}),ts.GameData.addValidateFunction("currentMaxLevel",function(r){if(!ti.isNumber(r)||r<0)throw new Error("currentMaxLevel ".concat(r," is invalid"))}),ts.GameData.addValidateFunction("items",function(r){if(!ti.isObject(r))throw new Error("items ".concat(r," is invalid"));if(!ti.isNumber(r.undo)||r.undo<0)throw new Error("items.undo ".concat(r.undo," is invalid"));if(!ti.isNumber(r.shuffle)||r.shuffle<0)throw new Error("items.shuffle ".concat(r.shuffle," is invalid"));if(!ti.isNumber(r.magicWand)||r.magicWand<0)throw new Error("items.magicWand ".concat(r.magicWand," is invalid"));if(!ti.isNumber(r.return)||r.return<0)throw new Error("items.return ".concat(r.return," is invalid"));if(!ti.isNumber(r.extraSlot)||r.extraSlot<0)throw new Error("items.extraSlot ".concat(r.extraSlot," is invalid"))}),ts.GameData.addValidateFunction("dailyChallenge",function(r){if(!ti.isObject(r))throw new Error("dailyChallenge ".concat(r," is invalid"))}),ts.GameData.addValidateFunction("timeWatchAdsSuccess",function(r){if(!ti.isObject(r))throw new Error("timeWatchAdsSuccess ".concat(r," is invalid"))}),ts.GameData.addValidateFunction("collectedChapterEndLevel",function(r){if(!ti.isNumber(r)||r<0)throw new Error("collectedChapterEndLevel ".concat(r," is invalid"))}),ts.GameData.addValidateFunction("dashboardAnimLevel",function(r){if(!ti.isNumber(r)||r<0)throw new Error("dashboardAnimLevel ".concat(r," is invalid"))}),ts.GameData.addValidateFunction("removeAds",function(r){if(!ti.isObject(r))throw new Error("removeAds ".concat(r," is invalid"))}),ts.GameData.addValidateFunction("tournamentsJoined",function(r){if(!Array.isArray(r))throw new Error("tournamentsJoined ".concat(r," is not an array"));var c,f=_(r);try{for(f.s();!(c=f.n()).done;){var y=c.value;if(!ti.isObject(y))throw new Error("tournament ".concat(y," is invalid"))}}catch(r){f.e(r)}finally{f.f()}}),ts.GameData.addValidateFunction("dailyMissions",function(r){if(!ti.isObject(r))throw new Error("dailyMissions ".concat(r," is invalid"))}),ts.GameData.addValidateFunction("lastClaimDailyReward",function(r){if(!ti.isNumber(r)||r<0)throw new Error("lastClaimDailyReward ".concat(r," is invalid"))}),ts.GameData.addValidateFunction("isUnlockTourFeature",function(r){if(!ti.isBoolean(r))throw new Error("isUnlockTourFeature ".concat(r," is invalid"))})}},{key:"requestConnectedPlayers",value:function(){to.requestConnectedPlayers().catch(function(r){})}}]),e}();D._RF.pop(),D._RF.push({},"c510204p3JAXLCuogskxTkP","AdaptivePerformance",void 0);var tc=GameCore,tl=tc.Events,th=tc.Utils.Valid,td=globalThis.game,tf=td.event,tp=td.adaptivePerformance,tv=function(){function e(){var r=this;S(this,e),this.handleBeginFrame=function(){N.on(j.EVENT_AFTER_UPDATE,r.lateUpdate),N.on(j.EVENT_BEFORE_UPDATE,r.updateActualFPS)},this.handleAfterSceneLaunch=function(r){tp&&tp.trackingScene(r.name)},this.handleRequestResizeGame=function(r){var c=r.forcePixelRatio;th.isNumber(c)&&L.emit(ea.REQUEST_VIEW_RESIZE,c)},this.lateUpdate=function(){var r=1e3*L.deltaTime;null==tp||tp.updatePostStepDeltaTime(r)},this.updateActualFPS=function(){var r,c=null==(r=N.root)?void 0:r.fps;th.isNumber(c)&&(null==tp||tp.updateActualFPS(c))}}return y(e,[{key:"init",value:function(){tp&&this.listenEvents()}},{key:"listenEvents",value:function(){tf.on(tl.REQUEST_RESIZE_GAME,this.handleRequestResizeGame),N.once(j.EVENT_BEGIN_FRAME,this.handleBeginFrame),N.on(j.EVENT_AFTER_SCENE_LAUNCH,this.handleAfterSceneLaunch)}}]),e}();D._RF.pop(),D._RF.push({},"0bbd4wf2fRDcKljBcls6K8a","CanvasRecorder",void 0);var tg=globalThis.game.canvasRecorder,ty=function(){function e(){S(this,e)}return y(e,[{key:"init",value:function(){if(L.canvas&&tg){tg.setCanvas(L.canvas);var r=tg.getOptions(),t=function(){L.pause(),L.step()},c=tg.waitNextFrame;tg.waitNextFrame=function(f){var y=arguments.length>0&&void 0!==f&&f;return new Promise(function(f,m){y||tg.isCapturing()?r.syncFps?(N.once(j.EVENT_AFTER_RENDER,f),t()):c(y).then(f).catch(m):L.resume()})}}}}]),e}();D._RF.pop(),D._RF.push({},"e8b3dVomjtKZ68ykoRs82vP","DailyRewards",void 0);var tm,tE,tS,tw=globalThis.game.storage,t_=function(){function e(){S(this,e)}return y(e,[{key:"init",value:function(){this.initStorage()}},{key:"initStorage",value:function(){tw.addStorage("dashboardDailyRewards",{hasShownPopup:!1})}}]),e}();D._RF.pop(),D._RF.push({},"49a72YoKFFCKbOm5Xgp9R+k","DynamicAssets",void 0);var tb,tA,tC=GameCore,tT=tC.Configs.GameEngine.DynamicAssets,tR=tT.Enabled,tk=tT.Resolution,tD=tT.IgnoreFiles,tL=tC.Events,tF=tC.Utils,tP=tF.Array,tO=tF.Function,tN=tF.Time,tI=tF.Decorator,tx=globalThis.game,tM=tx.event,tU=tx.storage,tG=tx.getBuildVersion,tB=[".png",".jpg",".jpeg",".webp"],tV=(tm=tI.debounce(1e3),tS=f((tE=function(){var r,c,f,b;function e(){var r=this;S(this,e),this.isProcessing=!1,this.useHighQuality=!1,this.upgradedAssets={},this.upgradableAssets={},w(this,"handleChangeQuality",tS,this),this.replaceAssetUrl=function(c){return r.useHighQuality?c.replace("native/","native32/"):c},this.requestUpdateDynamicAssets=function(){L.emit(ea.UPGRADE_DYNAMIC_ATLAS,{force:!0})},this.collectUpgradableAssets=function(c){var f,y=c.output=c.input,m=tk.Adjust,S=tk.Original,w=m<S?m:S,b=!1,A=_(y);try{for(A.s();!(f=A.n()).done;){var C=f.value;if(tP.has(tB,C.ext)&&!tP.has(tD,C.uuid)&&(C.url=r.replaceAssetUrl(C.url),!(C.uuid in r.upgradableAssets))){var T={ext:C.ext,url:C.url,uuid:C.uuid,options:C.options,resolution:w};r.upgradableAssets[C.uuid]=T,b=!0}}}catch(r){A.e(r)}finally{A.f()}b&&L.emit(ea.REQUEST_UPGRADE_ASSET)}}return y(e,[{key:"init",value:(b=m(function(){return _ts_generator(this,function(r){switch(r.label){case 0:if(!tR)return[3,2];return[4,this.initStorage()];case 1:r.sent(),this.checkCacheVersion(),W.transformPipeline.insert(this.collectUpgradableAssets,2),this.useHighQuality||this.injectTextureResolution(),this.listenEvents(),r.label=2;case 2:return[2]}})}),function(){return b.apply(this,arguments)})},{key:"initStorage",value:(f=m(function(){return _ts_generator(this,function(r){switch(r.label){case 0:return[4,tU.addStorage("DynamicAssets",{useHighQuality:!1,buildVersion:"0"},!0)];case 1:return r.sent(),[2]}})}),function(){return f.apply(this,arguments)})},{key:"checkCacheVersion",value:function(){var r=tG().toString(),c=tU.getStorage("DynamicAssets"),f=null!=c?c:{},y=f.buildVersion,m=f.useHighQuality;"boolean"==typeof m&&(this.useHighQuality=m&&y===r),tU.setStorageData("DynamicAssets","buildVersion",r),tU.updateToWebStorage("DynamicAssets")}},{key:"listenEvents",value:function(){var r=this;this.useHighQuality||tM.catchUp(tL.GAME_READY,function(){r.useHighQuality=!0,L.on(ea.REQUEST_UPGRADE_ASSET,r.handleChangeQuality)})}},{key:"injectTextureResolution",value:function(){var r=tk.Adjust,c=tk.Original;if(!(r>=c||c<=0)){var f=r/c;Object.defineProperty(q.prototype,"width",{get:function(){var r,c;return this.isValid?this.uuid?(null==(r=this.image.data)||null==(r=r.src)?void 0:r.indexOf("native32/"))>=0?this._width:(null==(c=this.image)||null==(c=c.data)?void 0:c.width)/f||this._width:this._width/f:this._width}}),Object.defineProperty(q.prototype,"height",{get:function(){var r,c;return this.isValid?this.uuid?(null==(r=this.image.data)||null==(r=r.src)?void 0:r.indexOf("native32/"))>=0?this._height:(null==(c=this.image)||null==(c=c.data)?void 0:c.height)/f||this._height:this._height/f:this._height}})}}},{key:"saveStateToStorage",value:function(){tU.setStorageData("DynamicAssets","useHighQuality",this.useHighQuality),tU.updateToWebStorage("DynamicAssets")}},{key:"updateSpriteFrames",value:(c=m(function(){var r,c,f,y,m,S,w,b,A;return _ts_generator(this,function(C){switch(C.label){case 0:if(!(r=N.getScene()))return[3,9];f=r.getComponentsInChildren("cc.Sprite"),y=_(f),C.label=1;case 1:C.trys.push([1,7,8,9]),y.s(),C.label=2;case 2:if(!!(c=y.n()).done)return[3,6];if(!(null!=(w=(S=c.value).spriteFrame)&&w.texture))return[3,5];if(b=w.texture,!this.upgradedAssets[null==(m=b.image)?void 0:m.uuid])return[3,4];return S.node.layer=Y.Enum.UI_2D,b.updateImage(),[4,tN.sleepAsync(8)];case 3:C.sent(),C.label=4;case 4:C.label=5;case 5:return[3,2];case 6:return[3,9];case 7:return A=C.sent(),y.e(A),[3,9];case 8:return y.f(),[7];case 9:return[2]}})}),function(){return c.apply(this,arguments)})},{key:"processUpgradeQualityAsync",value:(r=m(function(r){var c,f;return _ts_generator(this,function(y){return c=this,[2,_instanceof(f=W.assets.get(r.uuid),Q)?(r.url=this.replaceAssetUrl(r.url),new Promise(function(y){W.loadAny(r,r.options,function(m,S){if(m)return void y(!1);f.reset(S),f._nativeUrl=c.replaceAssetUrl(f.nativeUrl),c.upgradedAssets[r.uuid]=!0,L.emit(ea.ASSET_QUALITY_CHANGE,{asset:f,item:r}),y(!0)})})):(this.upgradedAssets[r.uuid]=!1,!1)]})}),function(c){return r.apply(this,arguments)})}]),e}()).prototype,"handleChangeQuality",[tm],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var r=this;return m(function(){var c,f,y;return _ts_generator(this,function(m){switch(m.label){case 0:if(!!r.isProcessing)return[3,6];m.label=1;case 1:for(var S in m.trys.push([1,4,5,6]),r.isProcessing=!0,c=[],r.upgradableAssets)if((f=r.upgradableAssets[S])&&!r.upgradedAssets[S])y=r.processUpgradeQualityAsync(f),c.push(y);if(c.length<1)return[2];return[4,tO.allSettled(c)];case 2:return m.sent().filter(function(r){return"fulfilled"===r.status}).length,r.saveStateToStorage(),[4,r.updateSpriteFrames()];case 3:return m.sent(),r.requestUpdateDynamicAssets(),[3,6];case 4:return m.sent(),[3,6];case 5:return r.isProcessing=!1,[7];case 6:return[2]}})})}}),tE);D._RF.pop(),D._RF.push({},"15ecbqnx5lFtYRSJp2lOLCm","DynamicAtlas",void 0);var tH,tz,tj,tq=GameCore,tW=tq.Events,tY=tq.Configs.GameEngine.DynamicAtlas,tQ=tY.UsePowerOfTwo,tK=tY.TextureAtlasOptimize,tX=tY.AllowNonePackable,tJ=tY.OnlyOptimizeWhenRenderTooLong,tZ=tq.Utils,t$=tZ.Array,t0=tZ.Json,t1=tZ.Object,t2=tZ.Decorator,t3=globalThis.game.event,t4=(tb=t2.debounce(2e3),f((tA=function(){function e(){var r=this;S(this,e),this.drawInfo=[],this.atlasInfo=null,this.lastAtlasInfo=null,this.renderTimes=[],this.lastRenderTime=0,this.renderTimeInterval=5e3,this.isEffective=!0,this.isProcessing=!1,this.forceUpdateDynamicAtlas=!1,this.collectInfo={},this.pendingSprites={},this.pendingTextures={},this.setupRenderListeners=function(){N.on(j.EVENT_BEFORE_RENDER,r.updateBeforeRenderTime),N.on(j.EVENT_AFTER_RENDER,r.updateAfterRenderTime),tJ&&t3.catchUp(tW.SCENE_LAUNCHED,function(){N.once(j.EVENT_AFTER_RENDER,r.checkRenderTimeHighers)})},this.checkRenderTimeHighers=function(){var c=r.getMeanRenderTime();c>8&&r.handleLaggyFrame(c),N.once(j.EVENT_AFTER_RENDER,function(){setTimeout(r.checkRenderTimeHighers,r.renderTimeInterval)})},this.resetPendingInfo=function(){r.pendingSprites={},r.pendingTextures={}},this.updateBeforeRenderTime=function(){r.lastRenderTime=performance.now()},this.updateAfterRenderTime=function(){r.renderTimes.push(performance.now()-r.lastRenderTime)},this.tryInsertSpriteFrame=function(c){var f=r.getAtlas();if(!f)throw new Error("DynamicAtlas: Atlas not found");if(t$.has(f._innerSpriteFrames,c))throw new Error("DynamicAtlas: Sprite frame already exists");var y=f.insertSpriteFrame(c);if(!1===y)throw new Error("DynamicAtlas: Failed to insert sprite frame");return y},this.requestUpdateDynamicAtlas=function(c){r.isProcessing||(r.forceUpdateDynamicAtlas||(r.forceUpdateDynamicAtlas=(null==c?void 0:c.force)||!1),r.updateDynamicAtlas())},this.generateDrawInfo=function(c){if(!(c.length<1)){var f=c.sort(function(r,c){return c.usageCount-r.usageCount}),y=G.instance.textureSize;if(r.calculateOptimizedAtlas(f,y),r.atlasInfo){var m,S=r.atlasInfo.textures,w=_(S);try{for(w.s();!(m=w.n()).done;){var b=m.value;r.drawInfo.push(b)}}catch(r){w.e(r)}finally{w.f()}var A=f.filter(function(r){return!S.some(function(c){return c.id===r.id})});A.length>0&&r.generateDrawInfo(A)}}},this.calculateOptimizedAtlas=function(c,f){var y=function(r){var c,f=0,y=0,m=_(r);try{for(m.s();!(c=m.n()).done;){var S=c.value;f+=S.w*S.h,y=Math.max(y,S.w)}}catch(r){m.e(r)}finally{m.f()}r.sort(function(r,c){return c.h-r.h});var w,b=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(f/.95)),y),h:1/0}],A=0,C=0,T=_(r);try{for(T.s();!(w=T.n()).done;)for(var R=w.value,k=b.length-1;k>=0;k--){var D=b[k];if(!(R.w>D.w||R.h>D.h)){if(R.x=D.x,R.y=D.y,C=Math.max(C,R.y+R.h),A=Math.max(A,R.x+R.w),R.w===D.w&&R.h===D.h){var L=b.pop();k<b.length&&(b[k]=L)}else R.h===D.h?(D.x+=R.w,D.w-=R.w):R.w===D.w?(D.y+=R.h,D.h-=R.h):(b.push({x:D.x+R.w,y:D.y,w:D.w-R.w,h:R.h}),D.y+=R.h,D.h-=R.h);break}}}catch(r){T.e(r)}finally{T.f()}return{w:A,h:C,fill:f/(A*C)||0}}(c),m=y.w,S=y.h,w=y.fill;if(w<.6);else{if(m>f||S>f)return void(c.pop()&&r.calculateOptimizedAtlas(c,f));r.atlasInfo={textures:c,atlasSize:f,packedInfo:{width:Math.round(m),height:Math.round(S),fillRate:w}}}},this.drawTexture=function(c,f,y){var m,S,w=f.texture,_=w.image,b=w.getId(),A=t$.search(r.drawInfo,function(r){return r.id===b})||{x:-1,y:-1},C=A.x,T=A.y;if(C<0||T<0)return r.pendingSprites[f.uuid]||(r.pendingSprites[f.uuid]=f),r.pendingTextures[b]||(r.pendingTextures[b]=w,tJ||r.requestUpdateDynamicAtlas()),!1;var R=y?2:0;C+=R,T+=R;var k=c._innerTextureInfos[b];k||(y&&((_.width<=8||_.height<=8)&&(c._texture.drawTextureAt(_,C-1,T-1),c._texture.drawTextureAt(_,C-1,T+1),c._texture.drawTextureAt(_,C+1,T-1),c._texture.drawTextureAt(_,C+1,T+1)),c._texture.drawTextureAt(_,C-1,T),c._texture.drawTextureAt(_,C+1,T),c._texture.drawTextureAt(_,C,T-1),c._texture.drawTextureAt(_,C,T+1)),c._texture.drawTextureAt(_,C,T),c._count++,c._innerTextureInfos[b]={texture:w,x:C,y:T});var D=f.rect,L=D.x,F=D.y;L+=null!=(m=null==k?void 0:k.x)?m:C,F+=null!=(S=null==k?void 0:k.y)?S:T;var P={texture:c._texture,x:L,y:F};return C-=R,T-=R,c._innerSpriteFrames.push(f),P},this.refreshComponents=function(r){var c,f=_(r);try{for(f.s();!(c=f.n()).done;){var y=c.value;y.node.active&&(y.node.active=!1,y.node.active=!0)}}catch(r){f.e(r)}finally{f.f()}},this.isSameAtlas=function(r,c){if(!r||!c)return!1;var f=r.textures,y=c.textures;if(f.length!==y.length)return!1;var m=f.slice().sort(function(r,c){return r.id.localeCompare(c.id)}),S=y.slice().sort(function(r,c){return r.id.localeCompare(c.id)});return m.every(function(r,c){var f=S[c];if(!f)return!1;var y=r.id,m=r.name,w=r.w,_=r.h,b=f.id,A=f.name,C=f.w,T=f.h;return!m||y===b&&m===A&&w===C&&_===T})}}return y(e,[{key:"init",value:function(){tK&&G.instance.enabled&&(this.listenEvents(),this.overrideDynamicAtlas())}},{key:"listenEvents",value:function(){L.on(ea.UPGRADE_DYNAMIC_ATLAS,this.requestUpdateDynamicAtlas,this),t3.on(tW.SWITCH_SCENE,this.resetPendingInfo),t3.on(tW.SCENE_RENDERED,this.requestUpdateDynamicAtlas),t3.catchUp(tW.GAME_READY,this.setupRenderListeners)}},{key:"handleLaggyFrame",value:function(r){this.isEffective||(this.renderTimeInterval=Math.min(this.renderTimeInterval+1e3,1e4)),this.requestUpdateDynamicAtlas()}},{key:"getMeanRenderTime",value:function(){var r,c=0,f=_(this.renderTimes);try{for(f.s();!(r=f.n()).done;)c+=r.value}catch(r){f.e(r)}finally{f.f()}return c/=this.renderTimes.length,this.renderTimes=[],c}},{key:"overrideDynamicAtlas",value:function(){var r=this,c=G.instance;c.insertSpriteFrame=function(f){if(!c.enabled)return null;var y=c.maxAtlasCount,m=(c._atlases,c._atlasIndex),S=void 0===m?-1:m;if(S>=y)return null;try{var w=r.tryInsertSpriteFrame(f);return w||S>=y?w:w=r.tryInsertSpriteFrame(f)}catch(r){return null}}}},{key:"createAtlas",value:function(){return G.instance.newAtlas()}},{key:"getAtlas",value:function(){var r=this,c=G.instance,f=c._atlases,y=c._atlasIndex,m=c.textureBleeding,S=(void 0===f?[]:f)[y];return S||(S=this.createAtlas()),S?(S.originalInsertSpriteFrame||(S.originalInsertSpriteFrame=S.insertSpriteFrame,S.insertSpriteFrame=function(c){return r.drawTexture(S,c,m)}),S):null}},{key:"updateDynamicAtlas",value:function(){try{var r=N.getScene();if(!r)return;var c=this.collectPackageInfo();if(Object.keys(c).length<1)return;if(this.drawInfo=[],this.atlasInfo=null,this.isProcessing=!0,this.generateDrawInfo(t1.vals(c)),!this.atlasInfo)return;if(!this.updateAtlasData()&&!this.forceUpdateDynamicAtlas)return;var f=r.getComponentsInChildren("cc.UIRenderer");this.refreshComponents(f)}catch(r){}finally{this.isProcessing=!1,this.forceUpdateDynamicAtlas&&(this.forceUpdateDynamicAtlas=!1)}}},{key:"collectAllSpriteFrames",value:function(){var r=N.getScene();if(r){var c,f=r.getComponentsInChildren("cc.UIRenderer"),y=_(f);try{for(y.s();!(c=y.n()).done;){var m=c.value,S=m.spriteFrame;if(m.__classname__,m.enabled&&S&&S.packable&&S.texture){var w=S.uuid;w&&(this.pendingSprites[w]||(m.node.layer=Y.Enum.UI_2D,this.pendingSprites[w]=S))}}}catch(r){y.e(r)}finally{y.f()}}}},{key:"collectPackageInfo",value:function(){tX&&this.collectAllSpriteFrames();var r,c=t1.vals(this.pendingSprites),f={},y=_(c);try{for(y.s();!(r=y.n()).done;){var m,S=r.value,w=S.texture,b=S.original,A=null==w?void 0:w.getId(),C=null==b||null==(m=b._texture)?void 0:m.getId();if(C&&(A=C),A){this.collectInfo[A]||this.initializeCollectInfo(A,S);var T=this.collectInfo[A];T&&(T.usageCount++,f[A]=T)}}}catch(r){y.e(r)}finally{y.f()}return f}},{key:"initializeCollectInfo",value:function(r,c){var f=c.texture,y=c.original,m=c.uuid,S=f.width,w=f.height,_=(null==y?void 0:y._texture)||{width:0,height:0},b=_.width,A=_.height,C=Math.max(S,b)+2,T=Math.max(w,A)+2;C<=1||T<=1||(this.collectInfo[r]={id:r,w:C,h:T,x:-1,y:-1,usageCount:0,name:m})}},{key:"updateAtlasData",value:function(){if(!this.atlasInfo)return!1;if(this.lastAtlasInfo&&!this.forceUpdateDynamicAtlas){var r=this.isSameAtlas(this.lastAtlasInfo,this.atlasInfo);if(this.isEffective=!r,r)return!1}var c=this.getAtlas();if(!c||!c._texture)return!1;var f=this.atlasInfo.packedInfo,y=c._texture,m={width:y.width,height:y.height},S=f.width+20,w=f.height+20,_=Math.max(S,w),b=tQ?_:S;return!!(m.width!==b||m.height!==b)&&(G.instance.reset(),!(!(c=this.getAtlas())||!c._texture)&&(tQ?c._texture.initWithSize(b,b):c._texture.initWithSize(S,w),this.lastAtlasInfo=t0.clone(this.atlasInfo),!0))}}]),e}()).prototype,"updateDynamicAtlas",[tb],Object.getOwnPropertyDescriptor(tA.prototype,"updateDynamicAtlas"),tA.prototype),tA);D._RF.pop(),D._RF.push({},"2f36c+IsKJAU5s61TqQdaJ6","HybridFileCache",void 0);var t5=GameCore,t6=t5.Events,t9=t5.Configs.GameEngine.HybridFileCache,t7=t9.Enabled,t8=t9.PreviewMode,ne=t9.BuildMode,nt=t5.Utils,nn=nt.Object,nr=nt.Function,na=nt.Json,ni=nt.Decorator,ns=globalThis.game,no=ns.event,nu=ns.storage,nc=ns.getBuildVersion,nl=D.internal.CCON,nh=O.instance,nd=nh.downloader,nf=nh.pipeline,np=nh.fetchPipeline,nv=(tH=ni.throttle(1e3),tj=f((tz=function(){var r,c,f,T,R;function e(){var r=this;S(this,e),this.supportTypes=[],this.bundledFiles={},this.originDownloaders={},this.nativeAssetDictionary={},this.downloadFile=function(c){return function(f,y,m){var S=r.getCache(c,f);if(S)return m(null,S);var w=r.getDownloader(c);if(!w)return m(new Error("Downloader not found"),null);w(f,y,function(y,S){return y||r.setCache(c,f,S),m(y,S)})}},w(this,"requestUpdateStorage",tj,this),this.clearCache=function(){nu.initStorageData("HybridFileCache","cachedFiles",{}),nu.initStorageData("HybridFileCache","cachedBundles",{}),nu.updateToWebStorage("HybridFileCache")}}return y(e,[{key:"init",value:(R=m(function(){return _ts_generator(this,function(r){switch(r.label){case 0:if(!(t7&&!ey))return[3,3];return[4,this.initStorage()];case 1:return r.sent(),[4,this.checkCacheVersion()];case 2:return r.sent(),this.initSupportedTypes(),this.injectOptimalLoadPipeline(),this.injectOptimalFetchPipeline(),this.injectCacheExtensionPipeline(),this.saveOriginDownloaders(),this.registerCustomDownloader(),this.setupBundledFiles(),this.listenEvents(),[3,4];case 3:no.emit(t6.BUNDLE_READY),r.label=4;case 4:return[2]}})}),function(){return R.apply(this,arguments)})},{key:"initStorage",value:(T=m(function(){return _ts_generator(this,function(r){return[2,nu.addStorage("HybridFileCache",{buildVersion:"0",cachedFiles:{},cachedBundles:{},cachedExtensions:{}},!0)]})}),function(){return T.apply(this,arguments)})},{key:"checkCacheVersion",value:(f=m(function(){var r,c;return _ts_generator(this,function(f){switch(f.label){case 0:if(r=nc().toString(),c=nu.getStorageData("HybridFileCache","buildVersion"),nu.setStorageData("HybridFileCache","buildVersion",r),!(c!==r))return[3,2];return[4,this.clearCache()];case 1:f.sent(),f.label=2;case 2:return this.requestUpdateStorage(),[2]}})}),function(){return f.apply(this,arguments)})},{key:"initSupportedTypes",value:function(){this.supportTypes=ne.SupportedExtensions}},{key:"setupBundledFiles",value:(c=m(function(){var r,c,f,y;return _ts_generator(this,function(m){switch(m.label){case 0:if(m.trys.push([0,,3,4]),!ne.Enabled)return[2];c=[],f=_(this.supportTypes);try{for(f.s();!(r=f.n()).done;)y=r.value,this.getCachedBundles(y)||c.push(this.downloadBundledFile(y))}catch(r){f.e(r)}finally{f.f()}if(!(c.length>0))return[3,2];return[4,nr.allSettled(c)];case 1:m.sent(),m.label=2;case 2:return[3,4];case 3:return no.emit(t6.BUNDLE_READY),[7];case 4:return[2]}})}),function(){return c.apply(this,arguments)})},{key:"downloadBundledFile",value:(r=m(function(r){var c,f,y;return _ts_generator(this,function(m){switch(m.label){case 0:return m.trys.push([0,3,,4]),c=r.replace(".",""),f="./cache/bundle".concat(c.toUpperCase(),".").concat(c),"bundle"===r&&(f="./cache/bundleBUNDLE.json"),[4,fetch(f,{method:"GET",headers:{"Content-Type":"application/json"}})];case 1:return[4,m.sent().json()];case 2:return y=m.sent(),this.setBundledCache(r,y),[3,4];case 3:return m.sent(),[3,4];case 4:return[2]}})}),function(c){return r.apply(this,arguments)})},{key:"injectOptimalFetchPipeline",value:function(){if(t8.Enabled||ne.Enabled){var r=np.pipes[1];if(r)np.remove(2),np.insert(function(c,f){try{r(c,f)}catch(r){}},2)}}},{key:"injectOptimalLoadPipeline",value:function(){if(t8.Enabled||ne.Enabled){var r=nf.pipes[2];if(r)nf.remove(2),nf.insert(function(c,f){try{r(c,f)}catch(r){}},2)}}},{key:"injectCacheExtensionPipeline",value:function(){var r=this;if(t8.Enabled&&t8.CacheUuidExtension){var c={},n=function(f,y){f.output=f.input;for(var m=0;m<f.input.length;m++){var S=f.input[m];if(S.id){var w=r.getCacheExtension(S.id);w?(S.url=S.url.replace(S.ext,w),S.ext=w,c[S.id]=!0):c[S.id]=!1}}y(null,null)},a=function(f){return function(y,m){for(var S=b(y.input),w=0;w<S.length;w++){var _=S[w];if(_.id){var A,C=c[_.id];if(!nn.hasOwn(r.nativeAssetDictionary,_.id))r.nativeAssetDictionary[_.id]=null!=(A=_.isNative)&&A;C&&(_.isNative=!0)}}y.input.length,f(y,m)}},i=function(f,y){f.output=f.input;for(var m=0;m<f.output.length;m++){var S,w=f.output[m];if(w.id){var _=null!=(S=r.nativeAssetDictionary[w.id])&&S;w.isNative=_,c[w.id]||r.setCacheExtension(w.id,w.ext)}}y(null,null)};nf.insert(n,1),np.insert(n,1),nf.insert(i,3),np.insert(i,3);var f=b(nf.pipes),y=b(np.pipes);nf.pipes[2]=a(f[2]),np.pipes[2]=a(y[2]),b(nf.pipes),b(np.pipes)}}},{key:"saveOriginDownloaders",value:function(){var r,c=_(this.supportTypes);try{for(c.s();!(r=c.n()).done;){var f=r.value;this.originDownloaders[f]=nd._downloaders[f]}}catch(r){c.e(r)}finally{c.f()}}},{key:"registerCustomDownloader",value:function(){var r,c=_(this.supportTypes);try{for(c.s();!(r=c.n()).done;){var f=r.value;"bundle"!==f&&nd.register(f,this.downloadFile(f))}}catch(r){c.e(r)}finally{c.f()}}},{key:"listenEvents",value:function(){no.on(t6.SCENE_LOADED,this.requestUpdateStorage),L.on(ea.CLEAR_HYBRID_FILE_CACHE,this.clearCache)}},{key:"getDownloader",value:function(r){var c;return null!=(c=this.originDownloaders[r])?c:null}},{key:"getCacheKey",value:function(r,c){var f=c.match(/.*\/([-a-z0-9@]+)\.([^\.]+)$/);if(!f)return null;var y=A(f,3),m=(y[0],y[1]),S=y[2];return!S||r.indexOf(S)<0?null:"".concat(m,":").concat(r)}},{key:"validateDataType",value:function(r,c){return Array.isArray(c)&&nn.hasOwn(c[0],"__type__"),!(".cconb"===r&&nn.hasOwn(c,"chunks")&&!(Array.isArray(c.chunks)&&_instanceof(c,nl)))}},{key:"encodeData",value:function(r,c){return".cconb"===r?nn.hasOwn(c,"_document")&&nn.hasOwn(c,"_chunks")?new nl(c._document,c._chunks):null:na.clone(c)}},{key:"decodeData",value:function(r,c){if(".cconb"===r){if(!nn.hasOwn(c,"_document")||!nn.hasOwn(c,"_chunks"))return null;if(!Array.isArray(c._chunks))return null;var f,y=[],m=_(c._chunks);try{for(m.s();!(f=m.n()).done;){var S=f.value;_instanceof(S,Uint8Array)?y.push(S):y.push(new Uint8Array(Object.values(S)))}}catch(r){m.e(r)}finally{m.f()}return new nl(c._document,y)}return na.clone(c)}},{key:"setCache",value:function(r,c,f){var y=this.getCacheKey(r,c);if(y&&this.validateDataType(r,f)){var m=this.encodeData(r,f);nu.setStorageData("HybridFileCache","cachedFiles",C({},y,m)),this.requestUpdateStorage()}}},{key:"getCache",value:function(r,c){var f=this.getCacheKey(r,c);if(!f)return null;var y=this.getFileCaches()[f];return y||(y=this.getBundledCache(r,f)),y?this.decodeData(r,y):null}},{key:"getFileCaches",value:function(){var r;return null!=(r=nu.getStorageData("HybridFileCache","cachedFiles"))?r:{}}},{key:"getCachedBundles",value:function(r){var c=nu.getStorageData("HybridFileCache","cachedBundles");if(!c)return null;var f=c[r];return f?(this.bundledFiles[r]=f,f):null}},{key:"getBundledCache",value:function(r,c){var f,y=this.bundledFiles[r];return y&&null!=(f=y[c.replace(":".concat(r),"")])?f:null}},{key:"setBundledCache",value:function(r,c){this.bundledFiles[r]=c,nu.setStorageData("HybridFileCache","cachedBundles",C({},r,c)),this.requestUpdateStorage()}},{key:"getCacheExtension",value:function(r){return this.getCachedExtensions()[r]}},{key:"setCacheExtension",value:function(r,c){nu.setStorageData("HybridFileCache","cachedExtensions",C({},r,c)),this.requestUpdateStorage()}},{key:"getCachedExtensions",value:function(){var r;return null!=(r=nu.getStorageData("HybridFileCache","cachedExtensions"))?r:{}}}]),e}()).prototype,"requestUpdateStorage",[tH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){nu.updateToWebStorage("HybridFileCache")}}}),tz);D._RF.pop(),D._RF.push({},"14b76Yew19JgY7K+L9F5mmu","Languages",void 0);var ng=GameCore,ny=ng.Events,nm=ng.Utils.Array,nE=globalThis.game,nS=nE.player,nw=nE.event,n_=nE.language,nb=nE.monitorError,nA=function(){var r,c,f,w,_;function e(){var r=this;S(this,e),this.handlePreloadLanguage=function(){var c=m(function(c){var f,y,m,S,w;return _ts_generator(this,function(_){switch(_.label){case 0:if(f=c.locale,y=c.onLoad,m=c.onError,!r.isSupportedLocale(f))return[2,void(null==m||m(new Error("Language ".concat(f," not found"))))];_.label=1;case 1:return _.trys.push([1,3,,4]),[4,r.addLanguage(f)];case 2:return _.sent(),null==y||y(f),[3,4];case 3:return S=_.sent(),w=r.toError(S,"handleLanguageRequested"),null==nb||nb.sendException(w),null==m||m(S),[3,4];case 4:return[2]}})});return function(r){return c.apply(this,arguments)}}(),this.handleChooseLanguage=function(c){var f=c.locale,y=c.saveToPlayerData;if(r.isSupportedLocale(f))try{r.setLanguage(f,void 0!==y&&y)}catch(c){var m=r.toError(c,"handleLanguageRequested");null==nb||nb.sendException(m)}},this.handleLanguageRequested=function(){var c=m(function(c){var f,y,m,S,w,_,b;return _ts_generator(this,function(A){switch(A.label){case 0:if(f=c.locale,m=void 0!==(y=c.saveToPlayerData)&&y,S=c.onLoad,w=c.onError,!r.isSupportedLocale(f))return[2,void(null==w||w(new Error("Language ".concat(f," not found"))))];A.label=1;case 1:return A.trys.push([1,3,,4]),[4,r.addLanguage(f)];case 2:return A.sent(),null==S||S(f),r.setLanguage(f,m),[3,4];case 3:return _=A.sent(),b=r.toError(_,"handleLanguageRequested"),null==nb||nb.sendException(b),null==w||w(b),[3,4];case 4:return[2]}})});return function(r){return c.apply(this,arguments)}}()}return y(e,[{key:"init",value:(_=m(function(){var r,c;return _ts_generator(this,function(f){switch(f.label){case 0:return f.trys.push([0,3,,4]),[4,this.initDefaultLanguage()];case 1:return f.sent(),this.listenEvent(),[4,this.initPlayerLanguage()];case 2:return f.sent(),[3,4];case 3:return r=f.sent(),c=this.toError(r,"handleLanguageRequested"),null==nb||nb.sendException(c),[3,4];case 4:return[2]}})}),function(){return _.apply(this,arguments)})},{key:"initDefaultLanguage",value:(w=m(function(){return _ts_generator(this,function(r){return n_.add("en",eT,!0),this.setLanguage("en"),[2]})}),function(){return w.apply(this,arguments)})},{key:"initPlayerLanguage",value:(f=m(function(){var r,c,f;return _ts_generator(this,function(y){switch(y.label){case 0:if(!(c=n_.getPlayerLanguage())||!this.isSupportedLocale(c))return[2,void this.setLanguage("en",!0)];return[4,this.addLanguage(c)];case 1:return y.sent(),f=null!=(r=nS.getPlayerDataByKey("isFirstLogin"))&&r,this.setLanguage(c,f),[2]}})}),function(){return f.apply(this,arguments)})},{key:"isSupportedLocale",value:function(r){return nm.has(eu,r)}},{key:"listenEvent",value:function(){nw.on(ny.REQUEST_LANGUAGE,this.handleLanguageRequested),L.on(ny.REQUEST_LANGUAGE,this.handleLanguageRequested),L.on(ea.PRELOAD_LANGUAGE,this.handlePreloadLanguage),L.on(ea.CHOOSE_LANGUAGE,this.handleChooseLanguage)}},{key:"addLanguage",value:(c=m(function(r){var c,f;var y=arguments;return _ts_generator(this,function(m){switch(m.label){case 0:return c=y.length>1&&void 0!==y[1]&&y[1],[4,this.getLangData(r)];case 1:return f=m.sent(),n_.add(r,f,c),[2]}})}),function(r){return c.apply(this,arguments)})},{key:"setLanguage",value:function(r,c){var f=arguments.length>1&&void 0!==c&&c;if(n_.choose(r),f){var y=nS.getPlayerSettings(),m=T(T({},y),{},{language:r});nS.setPlayerDataByName("settings",m)}}},{key:"getLangData",value:(r=m(function(r){var c;return _ts_generator(this,function(f){switch(f.label){case 0:if("en"===r)return[2,eT];return[4,ec.loadJsonAsync(el[r])];case 1:if(null===(c=f.sent()))throw new Error("Language ".concat(r," not found"));if(null===c.json)throw new Error("Language ".concat(r," is empty"));return[2,c.json]}})}),function(c){return r.apply(this,arguments)})},{key:"toError",value:function(r,c){return _instanceof(r,Error)?r:"string"==typeof r?new Error("LanguagePlugin: ".concat(r)):new Error("LanguagePlugin: Unknown error in module: <".concat(c,">"))}}]),e}();D._RF.pop(),D._RF.push({},"fb33bK/6Y5FAas5AwmmBM/X","Leaderboards",void 0);var nC=GameCore,nT=nC.Configs,nR=nT.Mockup,nk=nR.Leaderboards,nD=nR.GameSDK.Player,nL=nT.Leaderboards,nF=nC.Utils.Number,nP=globalThis.game.leaderboard,nO=function(){var r,c,f,w;function e(){var r=this;S(this,e),this.handleWhenGameSDKStarted=function(){nk.Enabled?r.setupLeaderboardsMockup():r.setupLeaderboards()}}return y(e,[{key:"init",value:function(){this.handleWhenGameSDKStarted()}},{key:"setupLeaderboards",value:(w=m(function(){return _ts_generator(this,function(r){return this.setupLeaderboardByConfigs(),[2]})}),function(){return w.apply(this,arguments)})},{key:"setupLeaderboardByConfigs",value:function(){var r,c=nL.LeaderboardList,f=_(c);try{for(f.s();!(r=f.n()).done;){var y=r.value,m=y.Id,S=y.Name;nP.addLeaderboard({name:S,type:"global",autoSortRank:!0,leaderboardId:m})}}catch(r){f.e(r)}finally{f.f()}}},{key:"setupLeaderboardsMockup",value:(f=m(function(){return _ts_generator(this,function(r){return this.setupMockGlobalLeaderboards(),this.setupMockFriendsLeaderboard(),[2]})}),function(){return f.apply(this,arguments)})},{key:"setupMockGlobalLeaderboards",value:(c=m(function(){var r,c,f,y,m,S,w,b,A;return _ts_generator(this,function(C){switch(C.label){case 0:c=nk.NumOfLeaders,f=nL.LeaderboardList,y=_(f),C.label=1;case 1:C.trys.push([1,7,8,9]),y.s(),C.label=2;case 2:if(!!(r=y.n()).done)return[3,6];if(S=(m=r.value).Name,w=m.Id,!S)return[3,5];return[4,nP.createLeaderboardAsync({_id:w,name:S,numberOfLeaders:nF.random(c.Max-c.Min)+c.Min})];case 3:return b=C.sent(),nP.addLeaderboard({name:S,type:"global",autoSortRank:!0,leaderboardId:b}),[4,nP.requestLeaderboardAsync(S,10)];case 4:C.sent(),nP.getLeaderboard(S),nP.getLeaderboard(S),C.label=5;case 5:return[3,2];case 6:return[3,9];case 7:return A=C.sent(),y.e(A),[3,9];case 8:return y.f(),[7];case 9:return[2]}})}),function(){return c.apply(this,arguments)})},{key:"setupMockFriendsLeaderboard",value:(r=m(function(){var r,c,f,y,m;return _ts_generator(this,function(S){switch(S.label){case 0:return r=em.FRIENDS,c=eE.FRIENDS,f=0,(y=nD.ConnectedPlayers).Enabled&&(f=nF.random(y.NumOfPlayers-1)+1),[4,nP.createLeaderboardAsync({_id:c,name:r,numberOfLeaders:f})];case 1:return m=S.sent(),nP.addLeaderboard({name:r,type:"friends",autoSortRank:!0,leaderboardId:m}),[4,nP.requestLeaderboardAsync(r,10)];case 2:return S.sent(),nP.getLeaderboard(r),[2]}})}),function(){return r.apply(this,arguments)})}]),e}();D._RF.pop(),D._RF.push({},"e7bf73g4jJGuI9FqvW5YBsS","PerformanceMonitor",void 0);var nN=GameCore,nI=nN.Utils,nx=nN.Events,nM=nN.Configs.PerformanceMonitor.FpsTracking,nU=globalThis.game.event,nG=function(){function e(){var r=this;S(this,e),this.markName="FPS Tracking",this.minFps=void 0,this.maxFps=void 0,this.fpsTraceDuration=void 0,this.fpsTraceInterval=void 0,this.fpsTraceIntervalTimer=void 0,this.traceStopped=void 0,this.handleStartTraceFps=function(){r.startTraceFps(),N.on(j.EVENT_AFTER_UPDATE,r.handleLateUpdate)},this.handleLateUpdate=function(){if(r.mark){if(r.fpsTraceDuration-=L.deltaTime,r.fpsTraceDuration<=0&&!r.traceStopped)return r.traceStopped=!0,r.unListenEvents(),r.updateFPS(),void r.mark.stop(r.markName);r.fpsTraceIntervalTimer-=L.deltaTime,r.fpsTraceIntervalTimer>0||(r.fpsTraceIntervalTimer=r.fpsTraceInterval,r.updateFPS(),r.mark.stop(r.markName),r.startTraceFps())}}}return y(e,[{key:"mark",get:function(){return nM.Enabled?nI.Mark:null}},{key:"init",value:function(){var r=nM.TrackingDuration,c=nM.TrackingInterval;this.mark&&(this.fpsTraceDuration=null!=r?r:60,this.fpsTraceInterval=null!=c?c:10,this.fpsTraceIntervalTimer=this.fpsTraceInterval,this.traceStopped=!1,this.listenEvents())}},{key:"listenEvents",value:function(){nU.catchUp(nx.GAME_READY,this.handleStartTraceFps)}},{key:"unListenEvents",value:function(){N.off(j.EVENT_AFTER_UPDATE,this.handleLateUpdate)}},{key:"startTraceFps",value:function(){this.mark&&(this.mark.measure(this.markName),this.mark.start(this.markName))}},{key:"updateFPS",value:function(){var r,c;if(this.mark){var f=this.getFPS(),y=this.getDrawCalls(),m=this.getDeviceRender(),S=this.getTextureMemory();this.minFps=Math.min(null!=(r=this.minFps)?r:f,f),this.maxFps=Math.max(null!=(c=this.maxFps)?c:0,f),this.mark.putMetric(this.markName,"FPS Metric",f),this.mark.putAttr(this.markName,"Page Title",document.title),this.mark.putAttr(this.markName,"Device Render",m),this.mark.putAttr(this.markName,"Draw Calls",y.toString()),this.mark.putAttr(this.markName,"Texture Memory",S.toFixed(2)),this.mark.putAttr(this.markName,"Min FPS",this.minFps.toString()),this.mark.putAttr(this.markName,"Max FPS",this.maxFps.toString())}}},{key:"getFPS",value:function(){if(!N.root)return 0;return Math.floor(N.root.fps)||0}},{key:"getDrawCalls",value:function(){return N.root&&N.root.device.numDrawCalls||0}},{key:"getDeviceRender",value:function(){return N.root&&N.root.device.renderer||"Unknown"}},{key:"getTextureMemory",value:function(){return N.root&&N.root.device.memoryStatus.textureSize/1048576||0}}]),e}();D._RF.pop(),D._RF.push({},"58248LBip1DBrMjK0UWw2rM","RemoteConfig",void 0);var nB=GameCore.Events,nV=globalThis.game.event,nH=function(){function e(){S(this,e),this.handleHotReload=function(){L.restart()},this.handleUpdateConfig=function(r){if("Gameplay"===r.type){L.emit(ea.GAMEPLAY_UPDATE_CONFIG,r.config);var c=r.id,f=r.type;nV.emit(nB.REMOTE_CONFIG_UPDATED,{id:c,type:f})}}}return y(e,[{key:"init",value:function(){this.listenEvents()}},{key:"listenEvents",value:function(){nV.on(nB.REQUEST_HOT_RELOAD,this.handleHotReload),nV.on(nB.REQUEST_UPDATE_CONFIG,this.handleUpdateConfig)}}]),e}();D._RF.pop(),D._RF.push({},"c34a93D1BREiKms1T21AkQS","PluginsManager",void 0);var nz=function(){function e(){S(this,e)}return y(e,[{key:"init",value:function(){this.initHybridFileCache()}},{key:"initLanguages",value:function(){(new nA).init()}},{key:"initLeaderboards",value:function(){(new nO).init()}},{key:"initRemoteConfig",value:function(){(new nH).init()}},{key:"initDynamicAtlas",value:function(){(new t4).init()}},{key:"initDynamicAssets",value:function(){(new tV).init()}},{key:"initHybridFileCache",value:function(){(new nv).init()}},{key:"initCanvasRecorder",value:function(){(new ty).init()}},{key:"initPerformanceMonitor",value:function(){(new nG).init()}},{key:"initAdaptivePerformance",value:function(){(new tv).init()}},{key:"initDailyRewards",value:function(){(new t_).init()}}]),e}();D._RF.pop(),D._RF.push({},"ac8b03T+rFB061sXoEEsCUH","SceneManager",void 0);var nj=globalThis.game,nq=nj.event,nW=nj.monitorError,nY=GameCore,nQ=nY.Events,nK=nY.Configs.PerformanceMonitor,nX=nY.Utils.Mark,nJ=function(){var r;function e(){var r=this;S(this,e),this.markName="Load Scene",this.testScene={},this.isClearedMark=!1,this.queueLoadScene={},this.callbackSwitchScene=null,this.switchScene=function(){var c=m(function(c){var f,y,m;return _ts_generator(this,function(S){return f=c.sceneName,y=c.sceneData,(m=r.correctSceneName(f))&&(eh.showLoadingFullScreen(m),r.startScene({sceneName:m,sceneData:y})),[2]})});return function(r){return c.apply(this,arguments)}}(),this.preloadScene=function(){var c=m(function(c,f){var y,m;return _ts_generator(this,function(S){switch(S.label){case 0:return y=c.sceneName,[4,r.waitSceneLoaded(y)];case 1:return S.sent(),r.startMeasure("preload",c),null==(m=W.getBundle("main"))||m.loadScene(y,{},r.onSceneProgress,r.onScenePreloaded(y,f)),[2]}})});return function(r,f){return c.apply(this,arguments)}}(),this.waitSceneLoaded=function(){var c=m(function(c){return _ts_generator(this,function(f){switch(f.label){case 0:if(!r.queueLoadScene[c])return[3,2];return[4,nq.waitTo(nQ.SCENE_LOADED)];case 1:f.sent(),f.label=2;case 2:return[2]}})});return function(r){return c.apply(this,arguments)}}(),this.startMeasure=function(c,f){if(r.mark){var y=f.sceneName;r.queueLoadScene[y]&&(r.mark.putAttr(r.markName,"Canceled","true"),r.stopMeasure(y)),r.mark.measure(r.markName),r.mark.putAttr(r.markName,"Cancel","false"),r.mark.putAttr(r.markName,"Success","false"),r.mark.putMetric(r.markName,y),r.mark.start(r.markName),r.queueLoadScene[y]=!0}},this.stopMeasure=function(c){r.mark&&r.queueLoadScene[c]&&(r.mark.rmAttr(r.markName,"File"),r.mark.putAttr(r.markName,"Success","true"),r.mark.stop(r.markName),r.queueLoadScene[c]=!1)},this.onSceneProgress=function(c,f,y){r.mark&&r.mark.putAttr(r.markName,"Last File","".concat(y.id," (").concat(y.ext,")"));var m=Math.floor(c/f*60+30);GameSDK.setLoadingProgress(m)},this.onScenePreloaded=function(c,f){return function(y){f&&f(c,null!=y?y:null),y||r.handleCustomLoadingProgress(c)}},this.onSceneLoaded=function(c,f){var y=arguments.length>1&&void 0!==f?f:0;return function(f,m){var S=c.sceneName,w=c.sceneData;if(f||!m||m.name!==S)return void r.startScene(c,y+1);r.handleBeforeSceneLaunch(m,w)(),N.once(j.EVENT_AFTER_SCENE_LAUNCH,r.handleSceneLaunched(S,w))}},this.handleBeforeSceneLaunch=function(c,f){return function(){r.setSceneData(c,null!=f?f:{}),nq.emit(nQ.SCENE_LOADED,{sceneName:c.name}),r.isClearedMark||(nq.clear(nQ.MARK_IS_TEST_SCENE),r.isClearedMark=!0)}},this.handleSceneLaunched=function(c,f){return function(){var y;eh.hideLoadingFullScreen(c),ed.switchSceneTracking(),null==nW||nW.addMetadata({currentScene:c}),null==(y=r.callbackSwitchScene)||y.call(r,{sceneName:c,sceneData:f}),nq.emit(nQ.SCENE_LAUNCHED,{sceneName:c}),N.once(j.EVENT_AFTER_RENDER,function(){nq.emit(nQ.SCENE_RENDERED,{sceneName:c})})}},this.handleSceneLoaded=function(c){var f=c.sceneName;r.stopMeasure(f),ew.markIsSceneLoaded(f)},this.setTestScene=function(c){var f=c.sceneName;r.testScene[f]=!0}}return y(e,[{key:"init",value:function(){this.listenEvents()}},{key:"listenEvents",value:function(){nq.catchUp(nQ.MARK_IS_TEST_SCENE,this.setTestScene),nq.on(nQ.SWITCH_SCENE,this.switchScene),nq.on(nQ.PRELOAD_SCENE,this.preloadScene),nq.on(nQ.SCENE_LOADED,this.handleSceneLoaded)}},{key:"correctSceneName",value:function(r){var c=this.getCurrentScene(),f=this.getTestScene();return f?f===(null==c?void 0:c.name)?null:f:("DashboardScene"!==r&&"ChallengeResultScene"!==r||(r="GameScene"),null!=c&&c.isValid&&r===c.name?null:r)}},{key:"startScene",value:(r=m(function(r){var c,f,y,m;var S=arguments;return _ts_generator(this,function(w){switch(w.label){case 0:return c=this,f=S.length>1&&void 0!==S[1]?S[1]:0,y=r.sceneName,[4,this.waitSceneLoaded(y)];case 1:return w.sent(),this.startMeasure("start",r),null==(m=W.getBundle("main"))||m.loadScene(y,{},null,function(y,m){if(y)return void c.startScene(r,f+1);N.runScene(m,void 0,c.onSceneLoaded(r,f))}),[2]}})}),function(c){return r.apply(this,arguments)})},{key:"mark",get:function(){return nK.LoadResources?nX:null}},{key:"handleCustomLoadingProgress",value:function(r){var c=eS.assetPreloader,f=this.updateLoadingProgress();c?c.then(function(){clearInterval(f),GameSDK.setLoadingProgress(100),nq.emit(nQ.SCENE_LOADED,{sceneName:r,isPreload:!0})}):null==nW||nW.sendException(new Error("game scene loaded before boot scene"))}},{key:"updateLoadingProgress",value:function(){var r=90,c=setInterval(function(){var f=Math.min(r,99);GameSDK.setLoadingProgress(f),99===r&&clearInterval(c),r++},100);return c}},{key:"getCurrentScene",value:function(){return N.getScene()}},{key:"getTestScene",value:function(){var r;return null!=(r=Object.keys(this.testScene)[0])?r:null}},{key:"onSwitchScene",value:function(r){this.callbackSwitchScene=r}},{key:"setSceneData",value:function(r,c){if(c&&("data"in r||r.scene.attr({data:{}}),"data"in r)){var f=r.data||{};r.scene.attr({data:T(T({},f),c)})}}}]),e}();D._RF.pop(),D._RF.push({},"617b2SRAL5CyL75C998xBnx","ScreenManager",void 0);var nZ=globalThis.game,n$=nZ.event,n0=nZ.monitorError,n1=GameCore,n2=n1.Events,n3=n1.Utils,n4=n3.Object,n5=n3.Valid;function fa(r){return"ready"===r.state?(r.screen.node.removeFromParent(),r.screen.node.destroy(),{state:"prefab",order:r.order,name:r.name,prefab:r.prefab,useCount:r.useCount}):"prefab"===r.state?T({},r):{state:"queued",order:r.order,name:r.name}}var n6=function(){var r,c,f,w,A;function e(){var r=this;S(this,e),this.screens={},this.onPrefabReadyCallbacks={},this.handleOpenScreen=function(c){r.openScreen(c.screenName,c.screenData)},this.handleCloseScreen=function(c){r.closeScreen(c.screenName,!0)},this.handlePreloadScreens=function(){var c=N.getScene();r.validateScene(c)&&(r.initScreens(c),r.preloadScreens())},this.handleSwitchScene=function(){r.resetAllScreenParents(),r.onPrefabReadyCallbacks={}}}return y(e,[{key:"init",value:function(){this.bindEventHandlers()}},{key:"bindEventHandlers",value:function(){n$.on(n2.OPEN_SCREEN,this.handleOpenScreen),n$.on(n2.CLOSE_SCREEN,this.handleCloseScreen),n$.on(n2.PRELOAD_SCREENS,this.handlePreloadScreens),n$.on(n2.SWITCH_SCENE,this.handleSwitchScene)}},{key:"resetAllScreenParents",value:function(){for(var r in this.screens){var c=this.screens[r];void 0!==c&&(this.screens[r]=fa(c))}}},{key:"validateScene",value:function(r){return!!r}},{key:"initScreens",value:function(r){var c=r.getComponentsInChildren("BaseScreen"),f=this.getScreenHolder();if(f){if(!n5.isEmpty(c))c.map(function(r){return null==r?void 0:r.node.name}).join(", "),this.addScreens(c,f.screenKeys);var y=f.screenKeys.filter(function(r){return!c.some(function(c){return c.node.name===ef[r]})});if(!n5.isEmpty(y)){var m=y.map(function(r){return ef[r]});this.addScreenQueues(m,f.screenKeys)}}}},{key:"getScreenHolder",value:function(){var r=N.getScene();return null==r?void 0:r.getComponentInChildren("Screens")}},{key:"addScreens",value:function(r,c){for(var f=0;f<r.length;f++){var y=r[f],m=y.node.name;if(this.isScreenNameValid(m)){var S=c.indexOf(ep[m]);-1===S&&(S=f);var w=this.screens[m];"ready"!==(null==w?void 0:w.state)?this.screens[m]={state:"ready",order:S,screen:y,prefab:y.node,name:m,useCount:0}:this.screens[m]=T(T({},w),{},{order:S,screen:y})}}}},{key:"isScreenNameValid",value:function(r){return n5.isString(r)&&n4.vals(ef).includes(r)}},{key:"addScreenQueues",value:function(r,c){var f=this.getScreenHolder();if(null!=f&&f.isValid)for(var y=0;y<r.length;y++){var m=r[y];if(this.isScreenNameValid(m)){var S=c.indexOf(ep[m]);-1===S&&(S=y);var w=this.screens[m];this.screens[m]=void 0===w?{state:"queued",order:S,name:m}:T(T({},w),{},{order:S})}}}},{key:"loadScreen",value:(A=m(function(r){var c;return _ts_generator(this,function(f){switch(f.label){case 0:return f.trys.push([0,2,,3]),this.screens[r.name]=T(T({},r),{},{state:"loading"}),[4,ec.loadPrefabAsync("screens/".concat(r.name))];case 1:if(null===(c=f.sent()))throw new Error("ScreenManager.loadScreen: Failed to load prefab: ".concat(r.name));return this.screens[r.name]=T(T({},r),{},{state:"prefab",prefab:c,useCount:0}),this.emitPrefabReady(r.name),[3,3];case 2:return f.sent(),this.screens[r.name]={state:"queued",order:r.order,name:r.name},[3,3];case 3:return[2]}})}),function(r){return A.apply(this,arguments)})},{key:"preloadScreens",value:function(){for(var r in this.screens){var c=this.screens[r];"queued"===(null==c?void 0:c.state)&&this.loadScreen(c)}}},{key:"getScreen",value:(w=m(function(r){var c,f,y;return _ts_generator(this,function(m){if(null==(c=this.getScreenHolder())||!c.isValid)throw new Error("ScreenManager.getScreen: Invalid screen holder");if("ready"===r.state)return[2,r.screen];return(f=K(r.prefab)).name=r.name,y=f.getComponent("BaseScreen"),[2,(c.node.addChild(f),f.active=!1,this.screens[r.name]=T(T({},r),{},{state:"ready",screen:y}),this.reorderScreens(),y)]})}),function(r){return w.apply(this,arguments)})},{key:"reorderScreens",value:function(){var r=[];for(var c in this.screens){var f=this.screens[c];"ready"===(null==f?void 0:f.state)&&null!=f&&f.screen.isValid&&r.push(f)}r.sort(function(r,c){return r.order-c.order});for(var y=0;y<r.length;y++){var m=r[y];m.screen.node.setSiblingIndex(m.order)}}},{key:"openScreen",value:(f=m(function(r,c){var f,y;return _ts_generator(this,function(m){switch(m.label){case 0:if(!this.isScreenNameValid(r))return[3,9];if(!(void 0!==(f=this.getOrTryAddScreen(r))))return[3,8];if(!("ready"!==f.state&&"prefab"!==f.state))return[3,2];return"queued"===f.state&&this.loadScreen(f),[4,this.queueScreen(r,c)];case 1:return[2,m.sent()];case 2:return m.trys.push([2,5,6,7]),e_.setBlockInput(!0),[4,this.getScreen(f)];case 3:if(null==(y=m.sent())||!y.isValid)throw new Error("ScreenManager.performScreenOpen: Invalid screen ".concat(r));return this.incrementUseCount(r),[4,this.showScreen(y,r,c)];case 4:return m.sent(),[3,7];case 5:return m.sent(),[3,7];case 6:return e_.setBlockInput(!1),[7];case 7:return[3,9];case 8:m.label=9;case 9:return[2]}})}),function(r,c){return f.apply(this,arguments)})},{key:"queueScreen",value:function(r,c){var f,y=this;var S=null!=(f=this.onPrefabReadyCallbacks[r])?f:[];return new Promise(function(f){var w=function(){var S=m(function(){return _ts_generator(this,function(m){switch(m.label){case 0:return[4,y.openScreen(r,c)];case 1:return m.sent(),f(),[2]}})});return function(){return S.apply(this,arguments)}}();y.onPrefabReadyCallbacks[r]=[].concat(b(S),[w])})}},{key:"incrementUseCount",value:function(r){var c=this.screens[r];"ready"!==(null==c?void 0:c.state)&&"prefab"!==(null==c?void 0:c.state)||(this.screens[r]=T(T({},c),{},{useCount:c.useCount+1}))}},{key:"showScreen",value:(c=m(function(r,c,f){var y;return _ts_generator(this,function(m){switch(m.label){case 0:return r.node.active=!0,y={screenName:c,screenData:f},n$.emit(n2.OPENING_SCREEN,y),[4,new Promise(function(r){return N.once(j.EVENT_AFTER_RENDER,r)})];case 1:return m.sent(),r.open(f),this.updateAnalytics(c),[2]}})}),function(r,f,y){return c.apply(this,arguments)})},{key:"closeScreen",value:(r=m(function(r){var c,f;var y=arguments;return _ts_generator(this,function(m){if(c=y.length>1&&void 0!==y[1]&&y[1],this.isScreenNameValid(r)){if(void 0!==(f=this.screens[r])){if("ready"!==f.state)return[2,void delete this.onPrefabReadyCallbacks[r]];try{if(!f.screen.isValid||!f.screen.node.active)return[2];n$.emit(n2.CLOSING_SCREEN,{screenName:r}),f.screen.close(),c&&this.updateAnalytics(r,!1)}catch(r){}}}return[2]})}),function(c){return r.apply(this,arguments)})},{key:"updateAnalytics",value:function(r,c){var f=!(arguments.length>1&&void 0!==c)||c;ed.trackCurrentPage(r,f),f?null==n0||n0.addMetadata({currentScreen:r}):null==n0||n0.removeMetadata("currentScreen")}},{key:"closeAllScreens",value:function(){for(var r in this.screens)this.closeScreen(r,false)}},{key:"getOrTryAddScreen",value:function(r){var c,f=this.screens[r];if(void 0===f){var y=this.getScreenHolder();return this.addScreenQueues([r],null!=(c=null==y?void 0:y.screenKeys)?c:[]),this.screens[r]}return f}},{key:"emitPrefabReady",value:function(r){var c,f,y=null!=(c=this.onPrefabReadyCallbacks[r])?c:[],m=_(y);try{for(m.s();!(f=m.n()).done;)(0,f.value)()}catch(r){m.e(r)}finally{m.f()}delete this.onPrefabReadyCallbacks[r]}}]),e}();D._RF.pop(),D._RF.push({},"a851bnZR1RCUILrjMPf7nMm","CorecosSystem",void 0);var n9=GameCore,n7=n9.Configs.Core,n8=n9.Events,re=n9.Plugins.Analytics.Events,rt=globalThis.game,rn=rt.context,rr=(rt.storage,rt.event),ra=rt.analytics,ri=rt.monitorError;new(function(){var r,c,f;function e(){var r=this;S(this,e),this.coreManager=new eV,this.adsManager=new eU,this.sceneManager=new nJ,this.screenManager=new n6,this.engineManager=new eZ,this.layoutManager=new tr,this.playerManager=new tu,this.pluginsManager=new nz,this.handleWhenCoreBoot=function(){L.inited?r.handleCocosInit():L.once($.EVENT_GAME_INITED,r.handleCocosInit)},this.handleCocosInit=function(){r.coreManager.requestStart()},this.handleWhenCoreStart=function(){r.playerManager.setupDefaultGameData()},this.handleWhenCoreReady=function(){r.initPlugins(),ra.event(re.LOAD_START),rr.catchUp(n8.BUNDLE_READY,r.processPreStartGame)},this.processPreStartGame=function(){rr.catchUp(n8.SCENE_LOADED,r.preloadScenes),rr.catchUp(n8.SCENE_LAUNCHED,r.processBootSceneLaunched),r.runBootScene()},this.processBootSceneLaunched=m(function(){return _ts_generator(this,function(c){switch(c.label){case 0:if(!n7.StartSDKAfterLoadGame)return[3,2];return[4,rr.waitTo(n8.SCENE_LOADED)];case 1:c.sent(),c.label=2;case 2:if(!L.isPaused())return[3,4];return[4,r.waitGameResume()];case 3:c.sent(),c.label=4;case 4:return r.processStartGame(),[2]}})}),this.preloadScenes=function(){ew.preloadGameScene()},this.handleSwitchScene=function(){rr.emit(n8.PRELOAD_SCREENS)},this.startProcessContextData=m(function(){var c;return _ts_generator(this,function(f){switch(f.label){case 0:ra.event(re.APP_READY),f.label=1;case 1:return f.trys.push([1,3,4,5]),r.playerManager.requestConnectedPlayers(),[4,rn.processContextData()];case 2:return f.sent(),[3,5];case 3:return _instanceof(c=f.sent(),Error)&&(null==ri||ri.sendException(c)),[3,5];case 4:return rr.emit(n8.GAME_READY),[7];case 5:return[2]}})}),ra.event(re.ENGINE_READY),this.initManagers(),this.listenEvents()}return y(e,[{key:"initManagers",value:function(){this.coreManager.init(),this.engineManager.init(),this.layoutManager.init(),this.adsManager.init(),this.sceneManager.init(),this.screenManager.init(),this.playerManager.init(),this.pluginsManager.init(),this.overrideNodeComponent()}},{key:"listenEvents",value:function(){this.coreManager.onCoreBoot(this.handleWhenCoreBoot),this.coreManager.onCoreStart(this.handleWhenCoreStart),this.coreManager.onCoreReady(this.handleWhenCoreReady),this.sceneManager.onSwitchScene(this.handleSwitchScene)}},{key:"waitGameResume",value:(f=m(function(){return _ts_generator(this,function(r){return[2,new Promise(function(r){L.once($.EVENT_RESUME,r)})]})}),function(){return f.apply(this,arguments)})},{key:"runBootScene",value:function(){ew.switchScene(eb.BOOT_SCENE)}},{key:"processStartGame",value:(c=m(function(){return _ts_generator(this,function(r){switch(r.label){case 0:return ra.event(re.LOAD_COMPLETE),[4,this.startGameAsync()];case 1:return r.sent(),rr.catchUp(n8.PLAYER_INFO_LOADED,this.startProcessContextData),[2]}})}),function(){return c.apply(this,arguments)})},{key:"startGameAsync",value:(r=m(function(){var r,c,f;var y=arguments;return _ts_generator(this,function(m){switch(m.label){case 0:r=this,c=y.length>0&&void 0!==y[0]?y[0]:0,m.label=1;case 1:return m.trys.push([1,3,,4]),[4,GameSDK.startGameAsync()];case 2:return m.sent(),[3,4];case 3:return f=m.sent(),c<=3?setTimeout(function(){r.startGameAsync(c+1)},1e3):null==ri||ri.sendException(_instanceof(f,Error)?f:new Error(JSON.stringify(f))),[3,4];case 4:return[2]}})}),function(){return r.apply(this,arguments)})},{key:"initPlugins",value:function(){this.pluginsManager.initLanguages(),this.pluginsManager.initLeaderboards(),this.pluginsManager.initDynamicAtlas(),this.pluginsManager.initDynamicAssets(),this.pluginsManager.initCanvasRecorder(),this.pluginsManager.initPerformanceMonitor(),this.pluginsManager.initAdaptivePerformance(),this.pluginsManager.initDailyRewards()}},{key:"overrideNodeComponent",value:function(){X.prototype.getUITransform=function(){return this.getComponent(J)||this.addComponent(J)},X.prototype.getUIOpacity=function(){return this.getComponent(Z)||this.addComponent(Z)}}}]),e}()),D._RF.pop(),D._RF.push({},"826b3i39nhICrG3S59Y/cpR","PipelineData",void 0);var rs=y(function e(r,c,f,y){S(this,e),this.id=0xffffffff,this.width=0,this.height=0,this.framebuffer=void 0,this.id=r,this.width=c,this.height=f,this.framebuffer=y});D.user||(D.user={windowID:0,windows:new WeakMap}),D._RF.pop(),D._RF.push({},"c7df3pBHqRChZTjXMfWIy6H","Optimized2DPipeline",void 0);var ro=et.ccclass,ru=function(){function e(){S(this,e),this._viewport=new ee.Viewport,this._clearColor=new ee.Color(0,0,0,1),this.usesMask=!0}return y(e,[{key:"setup",value:function(r,c){for(var f=0;f<r.length;f++){var y=r[f];if(y&&null!==y.scene&&null!==y.window){var m=this.prepareCameraResources(c,y);this.buildForward(c,y,m.id,m.width,m.height)}}}},{key:"prepareCameraResources",value:function(r,c){var f=function(r){var c=D.user.windows.get(r.window);return void 0!==c||(c=new rs(D.user.windowID,0,0,r.window.framebuffer),++D.user.windowID,D.user.windows.set(r.window,c)),c}(c);return 0===f.width&&0===f.height?(f.width=c.window.width,f.height=c.window.height,this.initCameraResources(r,c,f.id,f.width,f.height)):f.framebuffer===c.window.framebuffer&&f.width===c.window.width&&f.height===c.window.height||(f.framebuffer=c.window.framebuffer,f.width=c.window.width,f.height=c.window.height,this.initCameraResources(r,c,f.id,f.width,f.height)),f}},{key:"initCameraResources",value:function(r,c,f,y,m){r.addRenderWindow("Color".concat(f),ee.Format.RGBA8,y,m,c.window),this.usesMask&&r.addDepthStencil("DepthStencil".concat(f),ee.Format.DEPTH_STENCIL,y,m)}},{key:"buildForward",value:function(r,c,f,y,m){this._clearColor.x=c.clearColor.x,this._clearColor.y=c.clearColor.y,this._clearColor.z=c.clearColor.z,this._clearColor.w=c.clearColor.w,this._viewport.left=c.viewport.x*y,this._viewport.top=c.viewport.y*m,this._viewport.width=c.viewport.z*y,this._viewport.height=c.viewport.w*m;var S=r.addRenderPass(y,m,"default");S.setViewport(this._viewport),function(r){return 0!=(r.clearFlag&ee.ClearFlagBit.COLOR)}(c)?S.addRenderTarget("Color".concat(f),ee.LoadOp.CLEAR,ee.StoreOp.STORE,this._clearColor):S.addRenderTarget("Color".concat(f),ee.LoadOp.LOAD),this.usesMask&&(c.clearFlag&ee.ClearFlagBit.DEPTH_STENCIL?S.addDepthStencil("DepthStencil".concat(f),ee.LoadOp.CLEAR,ee.StoreOp.STORE,c.clearDepth,c.clearStencil,c.clearFlag&ee.ClearFlagBit.DEPTH_STENCIL):S.addDepthStencil("DepthStencil".concat(f),ee.LoadOp.LOAD))}}]),e}();en&&en.setCustomPipeline("Optimized2DPipeline",new ru),ro("Optimized2DPipeline")(function(r){R(n,r);var c=k(n);function n(){return S(this,n),c.apply(this,arguments)}return y(n,[{key:"start",value:function(){}},{key:"update",value:function(r){}}]),n}(er)),D._RF.pop()}}}),function(r){r("virtual:///prerequisite-imports/systems","chunks:///systems.js")}(function(r,c){System.register(r,[c],function(r,c){return{setters:[function(c){var f={};for(var y in c)if("default"!==y&&"__esModule"!==y)f[y]=c[y];r(f)}],execute:function(){}}})});