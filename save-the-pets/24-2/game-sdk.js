function _instanceof(e,t){if(null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance])return!!t[Symbol.hasInstance](e);return e instanceof t}function _array_like_to_array(e,t){if(null==t||t>e.length)t=e.length;for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _array_without_holes(e){if(Array.isArray(e))return _array_like_to_array(e)}function _assert_this_initialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function asyncGeneratorStep(e,t,n,r,a,o,s){try{var u=e[o](s);var l=u.value}catch(e){n(e);return}if(u.done)t(l);else Promise.resolve(l).then(r,a)}function _async_to_generator(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function _next(e){asyncGeneratorStep(o,r,a,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(o,r,a,_next,_throw,"throw",e)}_next(void 0)})}}function _call_super(e,t,n){return t=_get_prototype_of(t),_possible_constructor_return(e,_is_native_reflect_construct()?Reflect.construct(t,n||[],_get_prototype_of(e).constructor):t.apply(e,n))}function _class_call_check(e,t){if(!_instanceof(e,t))throw new TypeError("Cannot call a class as a function")}function _construct(){return(_construct=_is_native_reflect_construct()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));if(n)_set_prototype_of(a,n.prototype);return a}).apply(null,arguments)}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];if(r.enumerable=r.enumerable||false,r.configurable=true,"value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}function _create_class(e,t,n){if(t)_defineProperties(e.prototype,t);if(n)_defineProperties(e,n);return e}function _define_property(e,t,n){if(t in e)Object.defineProperty(e,t,{value:n,enumerable:true,configurable:true,writable:true});else e[t]=n;return e}function _get(e,t,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=_super_prop_base(e,t);if(!r)return;var a=Object.getOwnPropertyDescriptor(r,t);if(a.get)return a.get.call(n||e);return a.value})(e,t,n||e)}function _get_prototype_of(e){return(_get_prototype_of=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");if(e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}}),t)_set_prototype_of(e,t)}function _instanceof1(e,t){if(null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance])return!!t[Symbol.hasInstance](e);return _instanceof(e,t)}function _is_native_function(e){return -1!==Function.toString.call(e).indexOf("[native code]")}function _iterable_to_array(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _non_iterable_spread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _object_spread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};var r=Object.keys(n);if("function"==typeof Object.getOwnPropertySymbols)r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}));r.forEach(function(t){_define_property(e,t,n[t])})}return e}function _possible_constructor_return(e,t){if(t&&("object"===_type_of(t)||"function"==typeof t))return t;return _assert_this_initialized(e)}function _set_prototype_of(e,t){return(_set_prototype_of=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _super_prop_base(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(null===(e=_get_prototype_of(e)))break;return e}function _to_consumable_array(e){return _array_without_holes(e)||_iterable_to_array(e)||_unsupported_iterable_to_array(e)||_non_iterable_spread()}function _type_of(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function _unsupported_iterable_to_array(e,t){if(!e)return;if("string"==typeof e)return _array_like_to_array(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor)n=e.constructor.name;if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _array_like_to_array(e,t)}function _wrap_native_super(e){var t="function"==typeof Map?new Map:void 0;return(_wrap_native_super=function(e){if(null===e||!_is_native_function(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,Wrapper)}function Wrapper(){return _construct(e,arguments,_get_prototype_of(this).constructor)}return Wrapper.prototype=Object.create(e.prototype,{constructor:{value:Wrapper,enumerable:false,writable:true,configurable:true}}),_set_prototype_of(Wrapper,e)})(e)}function _is_native_reflect_construct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_is_native_reflect_construct=function(){return!!e})()}function _ts_generator(e,t){var n,r,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function verb(e){return function(t){return step([e,t])}}function step(o){if(n)throw new TypeError("Generator is already executing.");while(s)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;if(r=0,a)o=[2&o[0],a.value];switch(o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:false};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}if(a[2])s.ops.pop();s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:true}}}(function(){"use strict";var e=Object.defineProperty;var f=function(e,t){return function(){return e&&(t=e(e=0)),t}};var A=function(t,n){for(var r in n)e(t,r,{get:n[r],enumerable:!0})};var i=function(t,n,r){return function(t,n,r){return n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r}(t,(void 0===n?"undefined":_type_of(n))!="symbol"?n+"":n,r)};var t,n=f(function(){t={AllowWithoutSDK:!0,MSGames:{UseLoginFeature:!1,ScheduleNotification:{D1:"The dogs are in danger! Draw quick and keep them safe from the bees. \uD83D\uDC1D\uD83D\uDC36",D2:"The pets need your help! Protect them from today's hazards. Can you do it? \uD83D\uDCAA\uD83D\uDC15",D3:"Buzz buzz! Bees are back. Can you outsmart them and save the dogs? \uD83D\uDC3Eâœ¨",D4:"Get ready to draw your best defenses! The dogs are counting on you. \uD83D\uDC15\uD83D\uDEA8",D5:"The danger is real! Hurry up, the bees are closing in on the pets. \uD83D\uDC1D\uD83D\uDD25",D6:"The dogs are waiting for their hero! Can you keep them safe from harm? \uD83C\uDFAE\uD83D\uDC15",D7:"Your furry friends need you now! Join the game and save the day. \uD83C\uDFC6\uD83D\uDC3E"}},Yandex:{UseLoginFeature:!1}}});var r=f(function(){});var a={};A(a,{default:function(){return o}});var o,s=f(function(){"use strict";n(),r(),o={}});var u,l,d,_=f(function(){"use strict";n(),r(),u='\n<div id="async-popup">\n    <div id="title"></div>\n    <div id="content"></div>\n    <div class="buttons">\n        <button id="ok"></button>\n        <button id="no"></button>\n    </div>\n</div>',l="\n#async-popup {\n    width: 100%;\n    height: 100%;\n    color: #fff;\n    display: flex;\n    position: absolute;\n    flex-direction: column;\n    justify-content: space-evenly;\n    background: #202020;\n    font-family: sans-serif;\n    border-radius: 20px;\n    align-items: center;\n    padding: 20px\n}\n\n#async-popup #title {\n    font-size: 2rem;\n    font-weight: bold;\n    margin-bottom: 1rem;\n}\n\n#async-popup #content {\n    display: flex;\n    text-align: center;\n    text-wrap: balance;\n    font-size: large;\n}\n\n#async-popup .buttons {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: space-evenly;\n}\n\n#async-popup .buttons button {\n    margin: 0.5rem;\n    padding: 0.5rem 1rem;\n    font-size: 1.5rem;\n    font-weight: bold;\n    border-radius: 0.5rem;\n    border: none;\n    cursor: pointer;\n}",d=/*#__PURE__*/function(){function B(){var e=this;_class_call_check(this,B),i(this,"popup"),i(this,"title"),i(this,"content"),i(this,"okButton"),i(this,"noButton"),i(this,"okCallback"),i(this,"noCallback"),i(this,"onYes",function(t){e.okButton.removeEventListener("click",e.okCallback),e.okCallback=e.handleCallback(t),e.okButton.addEventListener("click",e.okCallback,{once:!0})}),i(this,"onNo",function(t){e.noButton.removeEventListener("click",e.noCallback),e.noCallback=e.handleCallback(t),e.noButton.addEventListener("click",e.noCallback,{once:!0})}),i(this,"handleCallback",function(t){return function(n){n.stopImmediatePropagation(),e.hide(),t()}}),this.createPopupElement(),this.addPopupElementStyle();var t=new MutationObserver(function(){document.getElementById("GameDiv")&&e.setupPopupElementSizeAndPosition()}),n=document.body;t.observe(n,{attributes:!0,childList:!0,subtree:!0})}return _create_class(B,[{key:"createPopupElement",value:function(){var e=document.createElement("div");e.id=this.constructor.name,e.innerHTML=u,e.style.width="100%",e.style.height="100%",e.style.position="absolute",e.style.backgroundColor="#0000001f",document.body.appendChild(e),this.popup=e,this.popup.style.display="none",this.title=e.querySelector("#title"),this.content=e.querySelector("#content"),this.okButton=e.querySelector("#ok"),this.noButton=e.querySelector("#no")}},{key:"addPopupElementStyle",value:function(){var e=document.createElement("style");(document.head||document.getElementsByTagName("head")[0]).appendChild(e),e.appendChild(document.createTextNode(l))}},{key:"setupPopupElementSizeAndPosition",value:function(){var e=document.getElementById(this.constructor.name);if(!e)return;var t=e.querySelector("#async-popup");if(!t||!document.getElementById("GameDiv"))return;t.style.width="".concat(350,"px"),t.style.height="".concat(250,"px");var n=document.body.getBoundingClientRect(),r=n.width,a=n.height;t.style.left="".concat((r-350)/2,"px"),t.style.top="".concat((a-250)/2,"px")}},{key:"show",value:function(e){this.content.textContent="".concat(e),this.popup.style.display="flex"}},{key:"hide",value:function(){this.popup.style.display="none"}}]),B}()});var p={};A(p,{default:function(){return g}});var g,v=f(function(){"use strict";n(),r(),_(),g=/*#__PURE__*/function(e){function R(){return _class_call_check(this,R),_call_super(this,R,arguments)}return _inherits(R,e),_create_class(R,[{key:"show",value:function(e){this.title.textContent="Switch Context",this.okButton.textContent="Switch",this.noButton.textContent="Cancel",_get(_get_prototype_of(R.prototype),"show",this).call(this,"Do you want to switch context?\nContext ID: ".concat(e))}}]),R}(d)});var m={};A(m,{default:function(){return b}});var b,k=f(function(){"use strict";n(),r(),_(),b=/*#__PURE__*/function(e){function j(){return _class_call_check(this,j),_call_super(this,j,arguments)}return _inherits(j,e),_create_class(j,[{key:"show",value:function(){this.title.textContent="Choose Contexts",this.okButton.textContent="Choose",this.noButton.textContent="Cancel",_get(_get_prototype_of(j.prototype),"show",this).call(this,"Do you want to switch context?\n            This will choose random a friend or tournament to play with.")}}]),j}(d)});var x={};A(x,{default:function(){return P}});var P,C=f(function(){"use strict";n(),r(),_(),P=/*#__PURE__*/function(e){function H(){return _class_call_check(this,H),_call_super(this,H,arguments)}return _inherits(H,e),_create_class(H,[{key:"show",value:function(e){this.title.textContent="Create Context",this.okButton.textContent="Create",this.noButton.textContent="Cancel",_get(_get_prototype_of(H.prototype),"show",this).call(this,"Do you want to create context?\nPlayer ID: ".concat(e))}}]),H}(d)});var T={};A(T,{default:function(){return G}});var O,G,N=f(function(){"use strict";n(),r(),O="MockConnectedPlayers",G=/*#__PURE__*/function(){function Y(e){_class_call_check(this,Y),i(this,"extra"),this.extra=e}return _create_class(Y,[{key:"getConnectedPlayersAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a;return _ts_generator(this,function(o){switch(o.label){case 0:return n=(t=GameCore.Configs.Mockup.GameSDK.Player.ConnectedPlayers).ErrorRate,r=t.NumOfPlayers,a=t.RandomDelayMs,e.randomExceptionError("getConnectedPlayersAsync",n)&&e.extra.exceptionNetworkFailure("Get connected players error"),[4,e.extra.awaitRandomDelay(a)];case 1:return[2,(o.sent(),e.createPlayers(r))]}})})()}},{key:"createPlayers",value:function(e){var t=GameCore.Configs.Mockup.GameSDK.Player.ConnectedPlayers.AvatarUrl,n=this.loadLocalStorage();if(n||(n=[],this.saveLocalStorage(n)),n.length!==e){var _loop=function(e){var r="connected-player-".concat(e),a={getID:function(){return r},getName:function(){return"Connected Player ".concat(e)},getPhoto:function(){return t.replace("%1",r)}};n.push(a)};for(var r=n.length;r<e;r++)_loop(r);this.saveLocalStorage(n)}return this.loadLocalStorage()}},{key:"loadLocalStorage",value:function(){var e=GameCore.Utils,t=e.Browser,n=e.Object,r=t.getLocalStorage(O);if(!r)return[];var a=n.vals(r);if(!Array.isArray(a))return[];var o=[];var s=true,u=false,l=void 0;try{for(var d,_=a[Symbol.iterator]();!(s=(d=_.next()).done);s=true)(function(){var e=d.value;o.push({getID:function(){return e.id},getName:function(){return e.name},getPhoto:function(){return e.photo}})})()}catch(e){u=true,l=e}finally{try{if(!s&&null!=_.return)_.return()}finally{if(u)throw l}}return o}},{key:"saveLocalStorage",value:function(e){var t=GameCore.Utils.Browser,n=[];var r=true,a=false,o=void 0;try{for(var s,u=e[Symbol.iterator]();!(r=(s=u.next()).done);r=true){var l,d,_=s.value;var p={id:_.getID()||"",name:null!==(l=_.getName())&&void 0!==l?l:"",photo:null!==(d=_.getPhoto())&&void 0!==d?d:""};n.push(p)}}catch(e){a=true,o=e}finally{try{if(!r&&null!=u.return)u.return()}finally{if(a)throw o}}var g=_object_spread({},n);t.writeLocalStorage(O,g)}},{key:"randomExceptionError",value:function(e,t){return 100*Math.random()<t}}]),Y}()});var L={};A(L,{default:function(){return M}});var M,K=f(function(){"use strict";n(),r(),_(),M=/*#__PURE__*/function(e){function J(){return _class_call_check(this,J),_call_super(this,J,arguments)}return _inherits(J,e),_create_class(J,[{key:"show",value:function(e){this.title.textContent="Create Tournament",this.okButton.textContent="Create",this.noButton.textContent="Cancel";var t=JSON.stringify(e,null,2);_get(_get_prototype_of(J.prototype),"show",this).call(this,"Do you want to create tournament?\nPayload: ".concat(t))}}]),J}(d)});var F={};A(F,{default:function(){return Z}});var Z,ee=f(function(){"use strict";n(),r(),_(),Z=/*#__PURE__*/function(e){function X(){return _class_call_check(this,X),_call_super(this,X,arguments)}return _inherits(X,e),_create_class(X,[{key:"show",value:function(e){this.title.textContent="Share tournament",this.okButton.textContent="Share",this.noButton.textContent="Cancel",_get(_get_prototype_of(X.prototype),"show",this).call(this,"Do you want to share your score?\nScore: ".concat(e))}}]),X}(d)});n(),r(),s(),s(),s(),s(),s(),n(),r(),n(),r(),n(),r();var en=/*#__PURE__*/function(){function V(e){var t=this;_class_call_check(this,V),i(this,"adapter"),i(this,"extra"),i(this,"currentContextID",null),i(this,"currentContextType","SOLO"),i(this,"currentContextPlayers",[]),i(this,"chooseAsyncPopup",null),i(this,"createAsyncPopup",null),i(this,"switchAsyncPopup",null),i(this,"contextIdsByCreate"),i(this,"contextIdsByChoose",[]),i(this,"playerIdsInContexts"),i(this,"handleOnYes",function(e){return function(){t.extra.isPopupShown=!1,e(!0)}}),i(this,"handleOnNo",function(e){return function(){t.extra.isPopupShown=!1;try{t.extra.exceptionUserInput("Player closed the context menu")}catch(t){e(t)}}}),this.adapter=e,this.extra=e.extra}return _create_class(V,[{key:"setCurrentContextId",value:function(e){this.checkSameContext(e),this.currentContextID=e,this.currentContextType="THREAD"}},{key:"initContextInfo",value:function(e,t){var n=GameCore.Utils,r=n.Array,a=n.String;this.contextIdsByCreate={},this.playerIdsInContexts={},this.contextIdsByChoose=r.fillWith(10,function(){return a.generateObjectId()}),!(!e||!t)&&(["SOLO","THREAD","POST","GROUP"].indexOf(t)<0||(this.currentContextID=e,this.currentContextType=t))}},{key:"getID",value:function(){return this.currentContextID}},{key:"getType",value:function(){return this.currentContextType}},{key:"loadSwitchAsyncPopup",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.switchAsyncPopup)return[2];return[4,Promise.resolve().then(function(){return v(),p})];case 1:return"function"==typeof(t=n.sent().default)&&(e.switchAsyncPopup=new t),[2]}})})()}},{key:"loadChooseAsyncPopup",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.chooseAsyncPopup)return[2];return[4,Promise.resolve().then(function(){return k(),m})];case 1:return"function"==typeof(t=n.sent().default)&&(e.chooseAsyncPopup=new t),[2]}})})()}},{key:"loadCreateAsyncPopup",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.createAsyncPopup)return[2];return[4,Promise.resolve().then(function(){return C(),x})];case 1:return"function"==typeof(t=n.sent().default)&&(e.createAsyncPopup=new t),[2]}})})()}},{key:"switchAsync",value:function(e,t){var n=arguments.length>1&&void 0!==t&&t;var r=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(a){switch(a.label){case 0:return r.extra.checkPopupShown(),[4,r.extra.awaitRandomDelay()];case 1:if(a.sent(),r.validateSwitchAsyncContextId(e),"SOLO"===e&&n)return r.currentContextID=null,r.currentContextType="SOLO",r.updatePlayers([]),[2];return[4,r.loadSwitchAsyncPopup()];case 2:return a.sent(),[4,new Promise(function(t,n){r.switchAsyncPopup||r.adapter.extra.exceptionUnsupported(),r.switchAsyncPopup.onYes(r.handleOnYes(t)),r.switchAsyncPopup.onNo(r.handleOnNo(n)),r.switchAsyncPopup.show(e),r.extra.isPopupShown=!0})];case 3:return a.sent(),r.currentContextID=e,r.currentContextType="THREAD",r.createPlayerIdsInContext(e,10),t=r.playerIdsInContexts[e].map(function(e){return r.createPlayerInfo(e)}),r.updatePlayers(t),[2]}})})()}},{key:"chooseAsync",value:function(e){var t=this;return _async_to_generator(function(){var e,n,r;return _ts_generator(this,function(a){switch(a.label){case 0:return t.extra.checkPopupShown(),[4,t.extra.awaitRandomDelay()];case 1:return a.sent(),[4,t.loadChooseAsyncPopup()];case 2:return a.sent(),[4,new Promise(function(e,n){t.chooseAsyncPopup||t.adapter.extra.exceptionUnsupported(),t.chooseAsyncPopup.onYes(t.handleOnYes(e)),t.chooseAsyncPopup.onNo(t.handleOnNo(n)),t.chooseAsyncPopup.show(),t.extra.isPopupShown=!0})];case 3:return a.sent(),e=Math.floor(Math.random()*t.contextIdsByChoose.length),n=t.contextIdsByChoose[e],t.checkSameContext(n),t.currentContextID=n,t.currentContextType="THREAD",t.createPlayerIdsInContext(n,2),r=t.playerIdsInContexts[n].map(function(e){return t.createPlayerInfo(e)}),t.updatePlayers(r),[2]}})})()}},{key:"createAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a;return _ts_generator(this,function(o){switch(o.label){case 0:return t.extra.checkPopupShown(),[4,t.extra.awaitRandomDelay()];case 1:return o.sent(),[4,t.validateCreateAsyncPlayerId(e)];case 2:return o.sent(),[4,t.loadCreateAsyncPopup()];case 3:return o.sent(),[4,new Promise(function(n,r){t.createAsyncPopup||t.adapter.extra.exceptionUnsupported(),t.createAsyncPopup.onYes(t.handleOnYes(n)),t.createAsyncPopup.onNo(t.handleOnNo(r)),t.createAsyncPopup.show(e),t.extra.isPopupShown=!0})];case 4:if(o.sent(),!t.contextIdsByCreate[e])n=GameCore.Utils.String,t.contextIdsByCreate[e]=n.generateObjectId();return r=t.contextIdsByCreate[e],t.checkSameContext(r),t.currentContextID=r,t.currentContextType="THREAD",a=t.createPlayerInfo(e),t.updatePlayers([a]),[2]}})})()}},{key:"getPlayersAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.extra.awaitRandomDelay()];case 1:return[2,(t.sent(),e.currentContextPlayers)]}})})()}},{key:"createPlayerIdsInContext",value:function(e,t){if(!this.playerIdsInContexts[e]){var n=GameCore.Utils,r=n.Array,a=n.String,o=Math.floor(Math.random()*t),s=r.fillWith(o,function(){return a.generateObjectId()});this.playerIdsInContexts[e]=s}return this.playerIdsInContexts[e]}},{key:"createPlayerInfo",value:function(e){return{getID:function(){return e},getName:function(){return"Player ".concat(e)},getPhoto:function(){return""}}}},{key:"updatePlayers",value:function(e){if("SOLO"===this.currentContextType){this.currentContextPlayers=[];return}this.currentContextPlayers=e}},{key:"checkSameContext",value:function(e){this.currentContextID===e&&this.extra.exceptionSameContext()}},{key:"validateCreateAsyncPlayerId",value:function(e){var t=this;return _async_to_generator(function(){var n,r;return _ts_generator(this,function(a){switch(a.label){case 0:if((!e||Array.isArray(e))&&t.extra.exceptionClientUnsupportedOperation("Client does not support no player IDS or multiple player IDs yet"),!GameCore.Utils.Valid.isString(e))n="Array of type String contained a value of another type: ".concat(e),t.extra.exceptionInvalidParam(n);return e===GameSDK.player.getID()&&t.extra.exceptionInvalidParam("'At least one player id besides the current player must be provided.'"),[4,GameSDK.player.getConnectedPlayersAsync()];case 1:if(a.sent().some(function(t){return t.getID()===e}))return[2];return r="Provided ID ".concat(e," is not a connected player of the current player."),t.extra.exceptionInvalidParam(r),[2]}})})()}},{key:"validateSwitchAsyncContextId",value:function(e){if(this.checkSameContext(e),GameCore.Utils.Valid.isString(e))return;this.extra.exceptionClientUnsupportedOperation("Client requires update to support this operation")}}]),V}();n(),r(),n(),r();var er,ea="lds-container",eo=/*#__PURE__*/function(){function $(){var e=this;_class_call_check(this,$),i(this,"percentage",0),document.addEventListener("DOMContentLoaded",function(){e.createLoadingElement(),e.updateLoadingStyle()})}return _create_class($,[{key:"createLoadingElement",value:function(){var e=document.getElementById("GameDiv");if(!e)return null;var t=document.createElement("div");return t.id=ea,t.setAttribute("data-clarity-unmask","true"),t.innerHTML='\n<div id="lds-game-icon-blur"></div>\n<div id="lds-game-icon"></div>\n<div id="lds-text">\n    <span id="lds-percent">0</span>%\n</div>\n<span id="lds-warn-text">Youâ€™re loading slower than others. Please try reloading the game.</span>\n',e.appendChild(t),t}},{key:"updateLoadingStyle",value:function(){var e=document.getElementById(ea);if(!e)return;var t="assets/public/logo-128x128.png";t="public/logo-128x128.png";var n=e.querySelector("#lds-game-icon");n&&_instanceof1(n,HTMLElement)&&(n.style.backgroundImage="url(".concat(t,")"),n.style.backgroundColor="transparent");var r=e.querySelector("#lds-game-icon-blur");r&&_instanceof1(r,HTMLElement)&&(r.style.backgroundImage="url(".concat(t,")"),r.style.backgroundColor="transparent")}},{key:"setLoadingProgress",value:function(e){if(this.percentage>=e)return;this.percentage=e,this.percentage>=100&&(this.percentage=100);var t=document.getElementById("lds-percent");t&&(t.innerHTML="".concat(e))}},{key:"displayWarnLoading",value:function(e){var t=document.getElementById("lds-warn-text");t&&(clearTimeout(er),e?(t.style.display="block",t.offsetWidth,t.style.opacity="0.8"):(t.style.opacity="0",er=setTimeout(function(){t.style.display="none"},300)))}},{key:"removeLoadingElement",value:function(){var e=document.getElementById(ea);e&&(e.style.opacity="0",setTimeout(function(){e.remove()},300))}}]),$}();n(),r();var ei=/*#__PURE__*/function(e){function W(e,t){var n;return _class_call_check(this,W),i(n=_call_super(this,W,[t]),"code"),n.code=e,n}return _inherits(W,e),W}(_wrap_native_super(Error));var es=/*#__PURE__*/function(){function z(e){_class_call_check(this,z),i(this,"adapter"),i(this,"isGuest",!1),i(this,"isPopupShown",!1),i(this,"maxWaitGameCoreReadyTime",1e4),i(this,"loadingElement",null),this.adapter=e}return _create_class(z,[{key:"subscribeBotAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a;return _ts_generator(this,function(o){switch(o.label){case 0:return[4,e.adapter.player.canSubscribeBotAsync()];case 1:if(!o.sent())return[2,!1];t=window.game.analytics,r=(n=GameCore.Plugins.Analytics.Events).BOT_SUBSCRIBE,a=n.BOT_SUBSCRIBE_POPUP,t.event(a),o.label=2;case 2:return o.trys.push([2,5,,6]),[4,e.waitSDKInitiatedAsync()];case 3:return o.sent(),[4,e.adapter.player.subscribeBotAsync()];case 4:return[2,(o.sent(),t.event(r,{success:!0}),!0)];case 5:return o.sent(),[2,(t.event(r,{success:!1}),!1)];case 6:return[2]}})})()}},{key:"checkAndCreateShortcutAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a;return _ts_generator(this,function(o){switch(o.label){case 0:return[4,e.adapter.canCreateShortcutAsync()];case 1:if(!o.sent())return[2];t=window.game.analytics,r=(n=GameCore.Plugins.Analytics.Events).SHORTCUT_CREATE,a=n.SHORTCUT_CREATE_POPUP,t.event(a),o.label=2;case 2:return o.trys.push([2,5,,6]),[4,e.waitSDKInitiatedAsync()];case 3:return o.sent(),[4,e.adapter.createShortcutAsync()];case 4:return o.sent(),t.event(r,{success:!0}),[3,6];case 5:return o.sent(),t.event(r,{success:!1}),[3,6];case 6:return[2]}})})()}},{key:"waitSDKInitiatedAsync",value:function(){return GameCore.Utils.Valid.isValueChangeAsync(function(){return window.__sdkInitiated},!0,{timeout:1e4,checkInterval:100})}},{key:"waitGameCoreReadyAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){return t=0,[2,new Promise(function(n){var r=setInterval(function(){if("GameCore"in window){clearInterval(r),n();return}(t+=10)>e.maxWaitGameCoreReadyTime&&(t=0)},10)})]})})()}},{key:"createLoadingElement",value:function(){this.loadingElement||(this.loadingElement=new eo)}},{key:"setLoadingElementProgress",value:function(e){this.loadingElement&&this.loadingElement.setLoadingProgress(e)}},{key:"displayWarnLoading",value:function(e){this.loadingElement&&this.loadingElement.displayWarnLoading(e)}},{key:"destroyLoadingElement",value:function(){this.loadingElement&&this.loadingElement.removeLoadingElement()}},{key:"checkPopupShown",value:function(){this.isPopupShown&&this.exceptionPendingRequest("Please wait for the popup to close")}},{key:"delayInitialAsync",value:function(){return _async_to_generator(function(){var e,t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e=GameCore.Utils.Time,!(t=GameCore.Configs.Mockup.GameSDK.SlowAPI).Enabled||t.InitialDelay<=0)return[3,2];return[4,e.sleepAsync(t.InitialDelay)];case 1:n.sent(),n.label=2;case 2:return[2]}})})()}},{key:"delayStartAsync",value:function(){return _async_to_generator(function(){var e,t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e=GameCore.Configs.Mockup.GameSDK.SlowAPI,t=GameCore.Utils.Time,!e.Enabled||e.StartDelay<=0)return[3,2];return[4,t.sleepAsync(e.StartDelay)];case 1:n.sent(),n.label=2;case 2:return[2]}})})()}},{key:"delayPlayerDataAsync",value:function(){return _async_to_generator(function(){var e,t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e=GameCore.Configs.Mockup.GameSDK.SlowAPI,t=GameCore.Utils.Time,!e.Enabled||e.PlayerDataDelay<=0)return[3,2];return[4,t.sleepAsync(e.PlayerDataDelay)];case 1:n.sent(),n.label=2;case 2:return[2]}})})()}},{key:"awaitRandomDelay",value:function(e){var t=arguments.length>0&&void 0!==e?e:1e3;return GameCore.Utils.Time.sleepAsync(Math.random()*t)}},{key:"randomException",value:function(e){var t=Math.floor(Math.random()*e.length),n=e[t];this["exception".concat(n)]()}},{key:"getErrorMessage",value:function(e){var t=GameCore.Utils,n=t.Valid;return t.Object.hasOwn(e,"message")&&n.isString(e.message)?e.message:null}},{key:"throwNewCommonError",value:function(e,t){throw new ei(e,t)}},{key:"exceptionUserInput",value:function(e){this.throwNewCommonError("USER_INPUT",e)}},{key:"exceptionUnsupported",value:function(){this.throwNewCommonError("UNSUPPORTED","Unsupported method")}},{key:"exceptionInvalidParam",value:function(e){this.throwNewCommonError("INVALID_PARAM",e)}},{key:"exceptionPendingRequest",value:function(e){this.throwNewCommonError("PENDING_REQUEST",e)}},{key:"exceptionMethodNotImplemented",value:function(){this.throwNewCommonError("METHOD_NOT_IMPLEMENTED","Method not implemented")}},{key:"exceptionTournamentNotFound",value:function(e){this.throwNewCommonError("TOURNAMENT_NOT_FOUND",e)}},{key:"exceptionSameContext",value:function(){this.throwNewCommonError("SAME_CONTEXT","Must specify a context other than the current one.")}},{key:"exceptionInvalidOperation",value:function(e){this.throwNewCommonError("INVALID_OPERATION",e)}},{key:"exceptionNetworkFailure",value:function(e){var t=arguments.length>0&&void 0!==e?e:"Request failed to be processed";this.throwNewCommonError("NETWORK_FAILURE",t)}},{key:"exceptionUnknown",value:function(e){this.throwNewCommonError("UNKNOWN",e)}},{key:"exceptionClientUnsupportedOperation",value:function(e){this.throwNewCommonError("CLIENT_UNSUPPORTED_OPERATION",e)}},{key:"exceptionRateLimited",value:function(e){this.throwNewCommonError("RATE_LIMITED",e)}}]),z}();n(),r();var ec="Save The Pets".replace(/ /g,"-"),eu=/*#__PURE__*/function(){function q(e){var t=this;_class_call_check(this,q),i(this,"adapter"),i(this,"extra"),i(this,"defaultPlayerInfo"),i(this,"currentPlayerInfo"),i(this,"infoKey","".concat(ec,"_PlayerInfo")),i(this,"dataKey","".concat(ec,"_PlayerData")),i(this,"subscribeBot",null),i(this,"connectedPlayers",null),i(this,"getSignature",function(){var e=GameCore.Utils.Valid,n=t.getSignatureFormMockup();return e.isString(n)?n:"default_token"}),this.adapter=e,this.extra=e.extra,this.initDefaultPlayerInfo()}return _create_class(q,[{key:"initDefaultPlayerInfo",value:function(){var e="guest-007";this.defaultPlayerInfo={playerId:e,playerName:"Guest",playerPhoto:"https://picsum.photos/seed/".concat(e,"/300/300")},this.extra.isGuest=!0,this.currentPlayerInfo=_object_spread({},this.defaultPlayerInfo)}},{key:"initPlayerInfo",value:function(e){this.updateCurrentPlayerInfo(e),GameCore.Utils.Browser.writeLocalStorage(this.infoKey,this.currentPlayerInfo)}},{key:"canSubscribeBotAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.loadMockSubscribeBot()];case 1:return[2,(t.sent(),e.subscribeBot||e.extra.exceptionUnsupported(),e.subscribeBot.canSubscribeBotAsync())]}})})()}},{key:"subscribeBotAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.loadMockSubscribeBot()];case 1:return[2,(t.sent(),e.subscribeBot||e.extra.exceptionUnsupported(),e.subscribeBot.subscribeBotAsync())]}})})()}},{key:"getID",value:function(){return this.currentPlayerInfo.playerId}},{key:"getName",value:function(){return this.currentPlayerInfo.playerName}},{key:"getPhoto",value:function(){return this.currentPlayerInfo.playerPhoto}},{key:"getDataAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a,o,s,u;return _ts_generator(this,function(l){switch(l.label){case 0:return[4,t.extra.delayPlayerDataAsync()];case 1:if(l.sent(),r=(n=GameCore.Utils).Browser,a=n.Valid,o=n.Object,s=r.getLocalStorage(t.dataKey),!a.isObject(s))return[2,{}];if(0===e.length)return[2,s];return u={},[2,(e.forEach(function(e){o.hasOwn(s,e)&&(u[e]=s[e])}),u)]}})})()}},{key:"setDataAsync",value:function(e){var t=this;return _async_to_generator(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,t.extra.delayPlayerDataAsync()];case 1:return n.sent(),GameCore.Utils.Browser.writeLocalStorage(t.dataKey,e),[2]}})})()}},{key:"getSignedPlayerInfoAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){return[2,{getPlayerID:function(){var t;return null!==(t=e.getID())&&void 0!==t?t:""},getSignature:e.getSignature}]})})()}},{key:"getConnectedPlayersAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.loadMockConnectedPlayers()];case 1:return[2,(t.sent(),e.connectedPlayers||e.extra.exceptionUnsupported(),e.connectedPlayers.getConnectedPlayersAsync())]}})})()}},{key:"updateCurrentPlayerInfo",value:function(e){var t=GameCore.Utils,n=t.Browser,r=t.Valid,a=t.Object,o=t.String,s=e,u=n.getLocalStorage(this.infoKey);r.isObject(u)&&a.hasOwn(u,"playerId")&&r.isString(u.playerId)&&(s=u.playerId),r.isString(s)||(s=o.generateObjectId());var l=this.getName();r.isString(l)||(l="Nameless"),this.currentPlayerInfo.playerId=s,this.currentPlayerInfo.playerName=l,this.currentPlayerInfo.playerPhoto="https://picsum.photos/seed/".concat(s,"/300/300"),this.updateMockupPlayerInfo(s)}},{key:"updateMockupPlayerInfo",value:function(e){var t=GameCore.Configs.Mockup.Match,n=t.Enabled,r=t.PlayerInfo,a=t.OpponentInfo;if(!n)return;var o=r.Id===e,s=a.Id===e;o&&(this.currentPlayerInfo.playerId=r.Id,r.Name&&(this.currentPlayerInfo.playerName=r.Name),r.Photo&&(this.currentPlayerInfo.playerPhoto=r.Photo)),s&&(this.currentPlayerInfo.playerId=a.Id,a.Name&&(this.currentPlayerInfo.playerName=a.Name),a.Photo&&(this.currentPlayerInfo.playerPhoto=a.Photo))}},{key:"getSignatureFormMockup",value:function(){var e=GameCore.Configs.Mockup.Match,t=e.PlayerInfo.Id===this.getID(),n=e.OpponentInfo.Id===this.getID();return t?e.PlayerInfo.Signature:n?e.OpponentInfo.Signature:null}},{key:"loadMockSubscribeBot",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.subscribeBot)return[2];return[4,Promise.resolve().then(function(){return s(),a})];case 1:return"function"==typeof(t=n.sent().default)&&(e.subscribeBot=new t(e.adapter)),[2]}})})()}},{key:"loadMockConnectedPlayers",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.connectedPlayers)return[2];return[4,Promise.resolve().then(function(){return N(),T})];case 1:return"function"==typeof(t=n.sent().default)&&(e.connectedPlayers=new t(e.extra)),[2]}})})()}}]),q}();n(),r(),n(),r();var el=/*#__PURE__*/function(){function Q(e,t,n){var r,a=arguments.length>2&&void 0!==n&&n;_class_call_check(this,Q),i(this,"id"),i(this,"title"),i(this,"contextId"),i(this,"payload"),i(this,"endTime"),i(this,"tournamentType");var o=t.config,s=t.data;this.id=e,this.title=o.title,this.contextId="0123".concat(this.id),this.payload=JSON.stringify(null!=s?s:{}),this.endTime=null!==(r=o.endTime)&&void 0!==r?r:this.defaultEndTime(),this.tournamentType=a?"PAGE_HOSTED":"DEFAULT"}return _create_class(Q,[{key:"defaultEndTime",value:function(){return Math.round((Date.now()+6048e5)/1e3)}},{key:"getID",value:function(){return this.id}},{key:"getTitle",value:function(){return this.title}},{key:"getPayload",value:function(){return this.payload}},{key:"getEndTime",value:function(){return this.endTime}},{key:"getContextID",value:function(){return this.contextId}},{key:"getTournamentType",value:function(){return this.tournamentType}},{key:"toObject",value:function(){return{id:this.id,title:this.title,payload:this.payload,endTime:this.endTime,contextId:this.contextId,tournamentType:this.tournamentType}}}]),Q}();var ed=["Unsupported","NetworkFailure","PendingRequest","ClientUnsupportedOperation"],ef=_to_consumable_array(ed).concat(["InvalidParam","UserInput"]),ey=_to_consumable_array(ed).concat(["InvalidOperation","UserInput"]),eh=_to_consumable_array(ed).concat(["InvalidParam","UserInput"]),e_=_to_consumable_array(ed).concat(["InvalidParam","UserInput"]),ep=_to_consumable_array(ed).concat(["NetworkFailure"]),eg="TournamentsDataMockKey",ev="TournamentLeadersMockKey",em=/*#__PURE__*/function(){function tt(e){var t=this;_class_call_check(this,tt);var n=this;i(this,"adapter"),i(this,"extra"),i(this,"context"),i(this,"shareAsyncPopup",null),i(this,"createAsyncPopup",null),i(this,"processEnterTournament",/*#__PURE__*/function(){var e=_async_to_generator(function(e){return _ts_generator(this,function(t){switch(t.label){case 0:if(!n.getTournamentData(e))return[3,2];return[4,n.joinAsync(e)];case 1:t.sent(),t.label=2;case 2:return[2]}})});return function(t){return e.apply(this,arguments)}}()),i(this,"handleOnYes",function(e){return function(){t.extra.isPopupShown=!1,e(!0)}}),i(this,"handleOnNo",function(e){return function(){t.extra.isPopupShown=!1;try{t.extra.exceptionUserInput("Player closed the context menu")}catch(t){e(t)}}}),this.adapter=e,this.extra=e.extra,this.context=e.context}return _create_class(tt,[{key:"initTournamentInfoAsync",value:function(e){var t=this;return _async_to_generator(function(){return _ts_generator(this,function(n){switch(n.label){case 0:if(!GameCore.Configs.Mockup.GameSDK.Tournament.Enabled)return[3,4];return[4,t.createMockTournamentsData()];case 1:if(n.sent(),!e)return[3,3];return[4,t.processEnterTournament(e)];case 2:n.sent(),n.label=3;case 3:n.label=4;case 4:return[2]}})})()}},{key:"createMockTournamentsData",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o,s,u,l,d,_,p,g,v,m,b,k,x;return _ts_generator(this,function(P){switch(P.label){case 0:if(t=GameCore.Utils.Object,r=(n=GameCore.Configs.Mockup.GameSDK.Tournament).Enabled,o=(a=n.NumOfTournament).Normal,s=a.HostPage,!r)return[2];return u=e.getTournamentsData(),l=t.vals(u),_=(d=e.filterExpiredTournaments(l)).filter(function(e){return"DEFAULT"===e.tournamentType}),p=d.filter(function(e){return"PAGE_HOSTED"===e.tournamentType}),g=_.length,v=p.length,m=o-g,b=s-v,k=e.createDefaultTournaments(m),x=e.createGlobalTournaments(b),[4,Promise.all(_to_consumable_array(k).concat(_to_consumable_array(x)))];case 1:return P.sent(),[2]}})})()}},{key:"filterExpiredTournaments",value:function(e){var t=Date.now()/1e3,n=e.filter(function(e){return e.endTime>t}),r={};var a=true,o=false,s=void 0;try{for(var u,l=n[Symbol.iterator]();!(a=(u=l.next()).done);a=true){var d=u.value;r[d.id]=d}}catch(e){o=true,s=e}finally{try{if(!a&&null!=l.return)l.return()}finally{if(o)throw s}}return this.writeTournamentsData(r),n}},{key:"createDefaultTournaments",value:function(e){var t=GameCore.Utils,n=t.String,r=t.Array,a=t.Number,o=GameCore.Configs.Mockup.GameSDK.Tournament.ExtraPlayerTournamentPayload,s=window.game.leaderboard,u=GameSDK.player.getID(),l=GameSDK.player.getName();var d=this;return r.length(e).map(/*#__PURE__*/_async_to_generator(function(){var e,t,r,_,p;return _ts_generator(this,function(g){switch(g.label){case 0:return e="".concat(l,"'s Tournament ").concat(n.generateObjectId()),[4,s.createLeaderboardAsync({name:e})];case 1:if(t=g.sent(),r=d.createMockTournamentAsync({initialScore:0,config:{title:e,tournamentTitle:e},data:_object_spread({playerId:u,playerName:l,leaderboardId:t},o)}).getID().toString(),d.getTournamentLeadersData(r))return[2];return _=a.random(2),(p=window.game.player.getConnectedPlayerIds(_,0).map(function(e){return{playerId:e,score:a.random(4)}})).sort(function(e,t){return e.score-t.score}),d.writeTournamentLeadersData(r,p),[2]}})}))}},{key:"createGlobalTournaments",value:function(e){var t=GameCore.Utils,n=t.String,r=t.Array,a=t.Number,o=GameCore.Configs.Mockup.GameSDK.Tournament.ExtraGlobalTournamentPayload,s=window.game.leaderboard;var u=this;return r.length(e).map(/*#__PURE__*/_async_to_generator(function(){var e,t,l,d,_,p;return _ts_generator(this,function(g){switch(g.label){case 0:return t=_object_spread({leaderboardId:e=n.generateObjectId(),playerId:"global"},o),l="Global Tournament ".concat(e),[4,s.createLeaderboardAsync({name:l,_id:e,type:"world_tournament_leaderboard",description:JSON.stringify(t)})];case 1:if(g.sent(),d=u.createMockTournamentAsync({initialScore:0,config:{title:l,tournamentTitle:l},data:t},!0).getID().toString(),u.getTournamentLeadersData(d))return[2];return _=a.random(2),(p=r.length(_).map(function(){return{playerId:n.generateObjectId(),score:a.random(4)}})).sort(function(e,t){return e.score-t.score}),u.writeTournamentLeadersData(d,p),[2]}})}))}},{key:"awaitRandomDelay",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){return t=GameCore.Configs.Mockup.GameSDK.Tournament.RandomDelayMs,[2,e.extra.awaitRandomDelay(t)]})})()}},{key:"randomError",value:function(e){100*Math.random()<GameCore.Configs.Mockup.GameSDK.Tournament.ErrorRates&&this.extra.randomException(e)}},{key:"loadCreateTournamentPopupAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.createAsyncPopup)return[2];return[4,Promise.resolve().then(function(){return K(),L})];case 1:return"function"==typeof(t=n.sent().default)&&(e.createAsyncPopup=new t),[2]}})})()}},{key:"loadSharePopupAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.shareAsyncPopup)return[2];return[4,Promise.resolve().then(function(){return ee(),F})];case 1:return"function"==typeof(t=n.sent().default)&&(e.shareAsyncPopup=new t),[2]}})})()}},{key:"createAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r;return _ts_generator(this,function(a){switch(a.label){case 0:return t.extra.checkPopupShown(),[4,t.awaitRandomDelay()];case 1:return a.sent(),null!==t.context.getID()&&t.extra.exceptionInvalidOperation("Cannot create tournament while in a context"),t.validateCreatePayload(e),t.randomError(ef),[4,t.loadCreateTournamentPopupAsync()];case 2:return a.sent(),[4,new Promise(function(n,r){t.createAsyncPopup||t.adapter.extra.exceptionUnsupported(),t.createAsyncPopup.onYes(t.handleOnYes(n)),t.createAsyncPopup.onNo(t.handleOnNo(r)),t.createAsyncPopup.show(e),t.extra.isPopupShown=!0})];case 3:return a.sent(),r=(n=t.createMockTournamentAsync(e)).getContextID(),[2,(t.setCurrentContextID(r),n)]}})})()}},{key:"createMockTournamentAsync",value:function(e,t){var n=arguments.length>1&&void 0!==t&&t;var r=GameCore.Utils.String.generateObjectId(),a=new el(r,e,n),o=a.toObject();return this.writeTournamentData(r,o),a}},{key:"postScoreAsync",value:function(e){var t=this;return _async_to_generator(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:return[4,t.awaitRandomDelay()];case 1:return r.sent(),t.validateAvailableTournament(),e<0&&t.extra.exceptionInvalidParam("Score must be a positive number"),t.randomError(e_),n=window.game.player.getPlayerId(),t.updateBestScore(n,e),[2]}})})()}},{key:"shareAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a,o,s,u,l;return _ts_generator(this,function(d){switch(d.label){case 0:return t.extra.checkPopupShown(),[4,t.awaitRandomDelay()];case 1:return d.sent(),t.validateAvailableTournament(),t.validateSharePayload(e),t.randomError(eh),[4,t.loadSharePopupAsync()];case 2:if(d.sent(),r=n=e.score,a=t.getCurrentTournament())o=window.game.player.getPlayerId(),s=a.getID().toString(),(u=t.getBestScore(s,o))&&u<n&&(r=u);return[4,new Promise(function(e,n){t.shareAsyncPopup||t.adapter.extra.exceptionUnsupported(),t.shareAsyncPopup.onYes(t.handleOnYes(e)),t.shareAsyncPopup.onNo(t.handleOnNo(n)),t.shareAsyncPopup.show(r),t.extra.isPopupShown=!0})];case 3:return d.sent(),l=window.game.player.getPlayerId(),t.updateBestScore(l,n),[2]}})})()}},{key:"getTournamentsAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:return[4,e.awaitRandomDelay()];case 1:return n.sent(),e.randomError(ep),t=e.getTournamentsData(),[2,GameCore.Utils.Object.vals(t).map(function(t){return e.getTournamentInstance(t.id)}).filter(function(e){return null!==e})]}})})()}},{key:"joinAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r;return _ts_generator(this,function(a){switch(a.label){case 0:return[4,t.awaitRandomDelay()];case 1:return a.sent(),GameCore.Utils.Valid.isString(e)||t.extra.exceptionInvalidParam("Tournament ID must be a string"),(n=t.getTournamentInstance(e))||t.extra.exceptionTournamentNotFound("Tournament could not be found."),t.randomError(ey),r=n.getContextID(),[4,GameSDK.context.switchAsync(r)];case 2:return a.sent(),[2]}})})()}},{key:"setCurrentContextID",value:function(e){_instanceof1(this.context,en)&&this.context.setCurrentContextId(e)}},{key:"getCurrentTournament",value:function(){var e=this.context.getID();if(!e)return null;var t=this.getTournamentsData();for(var n in t)if(Object.hasOwn(t,n)&&t[n].contextId===e)return this.getTournamentInstance(n);return null}},{key:"validateCreatePayload",value:function(e){var t=GameCore.Utils,n=t.Object,r=t.Valid;r.isObject(e)||this.extra.exceptionInvalidParam("Payload must be an object"),n.hasOwn(e,"initialScore")||this.extra.exceptionInvalidParam("Payload must have initialScore"),n.hasOwn(e,"config")||this.extra.exceptionInvalidParam("Payload must have config");var a=e.initialScore,o=e.config;r.isNumber(a)||this.extra.exceptionInvalidParam("initialScore must be a number"),r.isObject(o)||this.extra.exceptionInvalidParam("Config must be an object"),n.hasOwn(o,"title")||this.extra.exceptionInvalidParam("Config must have title"),n.hasOwn(o,"tournamentTitle")||this.extra.exceptionInvalidParam("Config must have tournamentTitle"),n.hasOwn(e,"data")&&!r.isObject(e.data)&&this.extra.exceptionInvalidParam("Data must be an object")}},{key:"validateSharePayload",value:function(e){var t=GameCore.Utils,n=t.Object,r=t.Valid;r.isObject(e)||this.extra.exceptionInvalidParam("Payload must be an object"),n.hasOwn(e,"score")||this.extra.exceptionInvalidParam("Payload must have score");var a=e.score;r.isNumber(a)||this.extra.exceptionInvalidParam("Score must be a number"),n.hasOwn(e,"data")&&!r.isObject(e.data)&&this.extra.exceptionInvalidParam("Data must be an object")}},{key:"validateAvailableTournament",value:function(){this.getCurrentTournament()||this.extra.exceptionTournamentNotFound("There is no tournament for this context.")}},{key:"getTournamentInstance",value:function(e){var t=this.getTournamentData(e);return t?{getID:function(){return t.id},getTitle:function(){return t.title},getPayload:function(){return t.payload},getEndTime:function(){return t.endTime},getContextID:function(){return t.contextId},getTournamentType:function(){return t.tournamentType}}:null}},{key:"getTournamentData",value:function(e){var t=this.getTournamentsData();return t[e]?t[e]:null}},{key:"writeTournamentData",value:function(e,t){var n=this.getTournamentsData();n[e]=t,this.writeTournamentsData(n)}},{key:"getTournamentsData",value:function(){var e=GameCore.Utils,t=e.Browser,n=e.Valid,r=t.getLocalStorage(eg);return n.isObject(r)?r:{}}},{key:"writeTournamentsData",value:function(e){var t=GameCore.Utils,n=t.Browser;t.Valid.isObject(e)&&n.writeLocalStorage(eg,e)}},{key:"getBestScore",value:function(e,t){var n,r=this.getTournamentLeader(e,t);return r?null!==(n=r.score)&&void 0!==n?n:null:null}},{key:"updateBestScore",value:function(e,t){var n=this.getCurrentTournament();if(!n)return;var r=n.getID().toString();if(!r)return;var a=this.getTournamentLeader(r,e);if(!a){this.writeTournamentLeader(r,{playerId:e,score:t});return}a.score<t&&(a.score=t,this.writeTournamentLeader(r,a))}},{key:"getTournamentLeader",value:function(e,t){var n,r=this.getTournamentLeadersData(e);if(!r.length)return null;return null!==(n=GameCore.Utils.Array.search(r,function(e){return e.playerId===t}))&&void 0!==n?n:null}},{key:"getTournamentLeadersData",value:function(e){var t=GameCore.Utils,n=t.Browser,r=t.Object,a=n.getLocalStorage(ev);if(!r.hasOwn(a,e))return[];var o=a[e];return Array.isArray(o)?(o.sort(function(e,t){return t.score-e.score}),o):[]}},{key:"writeTournamentLeader",value:function(e,t){var n=GameCore.Utils.Array,r=this.getTournamentLeadersData(e),a=n.searchIndex(r,function(e){return e.playerId===t.playerId});-1===a?r.push(t):r[a]=t,this.writeTournamentLeadersData(e,r)}},{key:"writeTournamentLeadersData",value:function(e,t){var n,r=GameCore.Utils,a=r.Browser,o=r.Object;if(!Array.isArray(t))return;var s=null!==(n=a.getLocalStorage(ev))&&void 0!==n?n:{};o.assign(s,_define_property({},e,t)),a.writeLocalStorage(ev,s)}}]),tt}();var ew=/*#__PURE__*/function(){function et(){_class_call_check(this,et),i(this,"extra"),i(this,"player"),i(this,"context"),i(this,"tournament"),i(this,"shortcut",null),i(this,"isInitialized",!1),i(this,"bannerAdInstances",{}),i(this,"rewardedVideoInstance",null),i(this,"interstitialAdInstance",null),i(this,"rewardedInterstitialInstance",null)}return _create_class(et,[{key:"initialize",value:function(){this.extra=new es(this),this.player=new eu(this),this.context=new en(this),this.tournament=new em(this)}},{key:"isNeedSDK",value:function(){return(null==t?void 0:t.AllowWithoutSDK)!==!0}},{key:"getLocale",value:function(){return GameCore.Utils.Browser.getLocale()}},{key:"getPlatform",value:function(){var e=GameCore.Utils.Device;return e.isAndroid()?"ANDROID":e.isIOS()?"IOS":e.isDesktop()?"WEB":e.isMobile()?"MOBILE_WEB":null}},{key:"getSDKName",value:function(){return"GameCore"}},{key:"getSDKVersion",value:function(){return"1.0.0"}},{key:"initializeAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a;return _ts_generator(this,function(o){switch(o.label){case 0:if(e.isInitialized)return[2];if(e.initialize(),e.extra.createLoadingElement(),!e.isNeedSDK())return[3,2];return[4,e.checkSDKInitialized()];case 1:o.sent(),o.label=2;case 2:return[4,e.extra.waitGameCoreReadyAsync()];case 3:return o.sent(),[4,e.extra.delayInitialAsync()];case 4:if(o.sent(),(t=GameCore.Utils.Browser.getQueryParams()).splashPreview)return e.extra.destroyLoadingElement(),[2];return n=t.playerId,e.player.initPlayerInfo(n),r=t.context_source_id,a=t.context_type,e.context.initContextInfo(r,a),e.isInitialized=!0,[2]}})})()}},{key:"checkSDKInitialized",value:function(){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2]})})()}},{key:"startGameAsync",value:function(e){var t=!(arguments.length>0)||void 0===e||e;var n=this;return _async_to_generator(function(){var e,r;return _ts_generator(this,function(a){switch(a.label){case 0:return n.isInitialized||n.extra.exceptionInvalidOperation("GameSDK is not initialized"),[4,n.extra.delayStartAsync()];case 1:return a.sent(),window.__sdkLoadingCount=90,n.setLoadingProgress(90),setTimeout(function(){n.extra.destroyLoadingElement()},500),e=GameCore.Events,r=(0,GameCore.Utils.Browser.getQueryParams)().tournament_id,[4,n.tournament.initTournamentInfoAsync(r)];case 2:return a.sent(),t&&window.game.event.emit(e.GAME_SDK_STARTED),[2]}})})()}},{key:"setLoadingProgress",value:function(e){this.extra.setLoadingElementProgress(e)}},{key:"getEntryPointData",value:function(){var e=GameCore.Utils,t=e.Browser,n=e.Json,r=t.getQueryParams().payload,a=void 0===r?"{}":r;return"string"!=typeof a?{}:n.decode(a)}},{key:"getEntryPointAsync",value:function(){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2,"no_entry"]})})()}},{key:"loadBannerAdAsync",value:function(e){var t=this;return _async_to_generator(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:if(!e)return[3,5];if(!!t.bannerAdInstances[e])return[3,2];return[4,Promise.resolve().then(function(){return s(),a})];case 1:"function"!=typeof(n=r.sent().default)&&t.extra.exceptionInvalidOperation("Banner ads mock is not enabled"),t.bannerAdInstances[e]=new n("banner",e),r.label=2;case 2:return[4,t.bannerAdInstances[e].loadAsync()];case 3:return r.sent(),[4,t.bannerAdInstances[e].showAsync()];case 4:r.sent(),r.label=5;case 5:return[2]}})})()}},{key:"hideBannerAdAsync",value:function(e){var t=this;return _async_to_generator(function(){return _ts_generator(this,function(n){switch(n.label){case 0:if(!t.bannerAdInstances[e])return[3,2];return[4,t.bannerAdInstances[e].hideAsync()];case 1:n.sent(),n.label=2;case 2:return[2]}})})()}},{key:"getBannerHeight",value:function(e){return e.BannerHeight}},{key:"getInterstitialAdAsync",value:function(e){var t=this;return _async_to_generator(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:if(!!t.interstitialAdInstance)return[3,2];return[4,Promise.resolve().then(function(){return s(),a})];case 1:"function"!=typeof(n=r.sent().default)&&t.extra.exceptionInvalidOperation("Interstitial ads mock is not enabled"),t.interstitialAdInstance=new n("interstitial",e),r.label=2;case 2:return[2,t.interstitialAdInstance]}})})()}},{key:"getRewardedVideoAsync",value:function(e){var t=this;return _async_to_generator(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:if(!!t.rewardedVideoInstance)return[3,2];return[4,Promise.resolve().then(function(){return s(),a})];case 1:"function"!=typeof(n=r.sent().default)&&t.extra.exceptionInvalidOperation("Rewarded video ads mock is not enabled"),t.rewardedVideoInstance=new n("rewarded",e),r.label=2;case 2:return[2,t.rewardedVideoInstance]}})})()}},{key:"getRewardedInterstitialAsync",value:function(e){var t=this;return _async_to_generator(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:if(!!t.rewardedInterstitialInstance)return[3,2];return[4,Promise.resolve().then(function(){return s(),a})];case 1:"function"!=typeof(n=r.sent().default)&&t.extra.exceptionInvalidOperation("Rewarded interstitial ads mock is not enabled"),t.rewardedInterstitialInstance=new n("rewarded_interstitial",e),r.label=2;case 2:return[2,t.rewardedInterstitialInstance]}})})()}},{key:"getTournamentAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o;return _ts_generator(this,function(s){switch(s.label){case 0:return e.tournament.randomError(["Unsupported","NetworkFailure"]),t=e.context.getID(),r=(n=GameCore.Utils).Array,n.Valid.isString(t)||e.extra.exceptionInvalidOperation("Not in a context"),[4,e.tournament.getTournamentsAsync()];case 1:return a=s.sent(),[2,((o=r.search(a,function(e){return e.getContextID()===t}))||e.extra.exceptionTournamentNotFound("A Tournament with current context was not found"),o)]}})})()}},{key:"getSupportedAPIs",value:function(){return GameCore.Configs.Mockup.GameSDK.Player.SubscribeBot.CanSubscribeBot?["player.canSubscribeBotAsync"]:[]}},{key:"canCreateShortcutAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.loadMockAddShortcut()];case 1:return[2,(t.sent(),e.shortcut||e.extra.exceptionUnsupported(),e.shortcut.canCreateShortcutAsync())]}})})()}},{key:"createShortcutAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.loadMockAddShortcut()];case 1:return[2,(t.sent(),e.shortcut||e.extra.exceptionUnsupported(),e.shortcut.createShortcutAsync())]}})})()}},{key:"loadMockAddShortcut",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.shortcut)return[2];return[4,Promise.resolve().then(function(){return s(),a})];case 1:return"function"==typeof(t=n.sent().default)&&(e.shortcut=new t(e)),[2]}})})()}}]),et}();n(),r(),n(),r();var eI=/*#__PURE__*/function(){function nt(e,t){_class_call_check(this,nt),i(this,"type"),i(this,"placementId"),this.type=e,this.placementId=t}return _create_class(nt,[{key:"getPlacementID",value:function(){return this.placementId}},{key:"hideAsync",value:function(){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2,Promise.resolve()]})})()}}]),nt}();var eb={instanceId:""},ek={AD_NOT_LOADED:"AD_NOT_LOADED",LOAD_ADS_FAILURE:"LOAD_ADS_FAILURE",INVALID_OPERATION:"INVALID_OPERATION",SHOW_ADS_FAILURE:"SHOW_ADS_FAILURE",SHOW_ADS_TIMEOUT:"SHOW_ADS_TIMEOUT",SHOW_ADS_COMPLETED_FAILURE:"SHOW_ADS_COMPLETED_FAILURE"},eA=/*#__PURE__*/function(e){function at(e,t){var n;return _class_call_check(this,at),i(n=_call_super(this,at,[e,""]),"sdk"),i(n,"type"),i(n,"instance"),i(n,"isAdDisplayed",!1),i(n,"isAdShowInProgress",!1),n.sdk=t,n.type=e,n.instance=eb,n}return _inherits(at,e),_create_class(at,[{key:"getPlacementID",value:function(){return this.instance.instanceId}},{key:"resetInstance",value:function(){this.instance=eb}},{key:"loadAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n;return _ts_generator(this,function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),e.isAdShowInProgress)throw e.makeErrorWithCode(ek.INVALID_OPERATION,"Can't load ads while showing ads");if(e.instance.instanceId)return[2];return[4,e.sdk.loadAdsAsync({isRewardedAd:"rewarded"===e.type,canBackfill:!1})];case 1:return t=r.sent(),e.instance=t,[3,3];case 2:throw n=r.sent(),e.makeErrorWithCode(ek.LOAD_ADS_FAILURE,n);case 3:return[2]}})})()}},{key:"showAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n;return _ts_generator(this,function(r){if(!e.instance.instanceId)throw e.makeErrorWithCode(ek.AD_NOT_LOADED,"Ad is not loaded. InstanceId is empty");if(e.isAdShowInProgress)throw e.makeErrorWithCode(ek.INVALID_OPERATION,"Can't show ads while showing ads");return e.isAdDisplayed=!1,e.isAdShowInProgress=!0,t=e.processShowAd(e.instance.instanceId),n=e.scheduleShowingAdTimeout(1e4),[2,new Promise(function(r,a){Promise.race([t,n]).then(function(){if(!e.isAdDisplayed){a(e.makeErrorWithCode(ek.SHOW_ADS_TIMEOUT,"Showing ad is timed out"));return}t.then(function(){r()}).catch(function(e){a(e)})}).catch(function(e){a(e)}).finally(function(){e.isAdShowInProgress=!1})})]})})()}},{key:"processShowAd",value:function(e){var t=this;return _async_to_generator(function(){var n,r;return _ts_generator(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,4,5]),[4,t.sdk.showAdsAsync(e)];case 1:if(n=a.sent(),!t.isPromise(n.showAdsCompletedAsync))throw t.makeErrorWithCode(ek.SHOW_ADS_FAILURE,new Error("The showAdsCompletedAsync promise is empty"));return t.isAdDisplayed=!0,[4,n.showAdsCompletedAsync];case 2:return a.sent(),[3,5];case 3:throw r=a.sent(),t.isErrorWithCode(r)&&r.code===ek.SHOW_ADS_COMPLETED_FAILURE&&(r.code="USER_INPUT"),t.makeErrorWithCode(ek.SHOW_ADS_FAILURE,r);case 4:return t.resetInstance(),[7];case 5:return[2]}})})()}},{key:"scheduleShowingAdTimeout",value:function(e){return _async_to_generator(function(){return _ts_generator(this,function(t){return[2,new Promise(function(t,n){setTimeout(function(){t()},e)})]})})()}},{key:"isPromise",value:function(e){return(void 0===e?"undefined":_type_of(e))=="object"&&null!==e&&"function"==typeof e.then}},{key:"isErrorWithCode",value:function(e){return GameCore.Utils.Object.hasOwn(e,"code")&&"string"==typeof e.code}},{key:"getErrorReason",value:function(e){var t=GameCore.Utils.Object;return t.hasOwn(e,"message")&&"string"==typeof e.message?{reason:e.message}:t.hasOwn(e,"description")&&"string"==typeof e.description?{reason:e.description}:null}},{key:"parseError",value:function(e){try{return"string"==typeof e?e:JSON.stringify(e)}catch(e){return"Unknown error"}}},{key:"makeErrorWithCode",value:function(e,t){var n,r,a=e,o=null!==(r=null===(n=this.getErrorReason(t))||void 0===n?void 0:n.reason)&&void 0!==r?r:"";return o||(o=this.parseError(t)),this.isErrorWithCode(t)&&(a=t.code),new ei(a,o)}}]),at}(eI);n(),r();var ex=/*#__PURE__*/function(e){function it(){return _class_call_check(this,it),_call_super(this,it,arguments)}return _inherits(it,e),_create_class(it,[{key:"getID",value:function(){return this.currentContextID}},{key:"getType",value:function(){return this.currentContextType}},{key:"switchAsync",value:function(e,t){var n=arguments.length>1&&void 0!==t&&t;var r=this;return _async_to_generator(function(){return _ts_generator(this,function(t){if(r.validateSwitchAsyncContextId(e),"SOLO"===e&&n)return r.currentContextID=null,r.currentContextType="SOLO",[2];return r.currentContextID=e,r.currentContextType="THREAD",[2]})})()}},{key:"getPlayersAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.extra.awaitRandomDelay()];case 1:return[2,(t.sent(),e.currentContextPlayers)]}})})()}}]),it}(en);n(),r(),n(),r();var eP="How about diving into the game for a relaxing experience?",eD=/*#__PURE__*/function(){function U(){_class_call_check(this,U)}return _create_class(U,[{key:"sendDailyNotificationInstance",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){try{if(!GameCore.Configs.GameSDKOptions.MSGames.ScheduleNotification)throw new Error("MsGamesNotification content not set up!");t=e.getNotificationPayloads(),e.batchSendNotification(t),e.updatePlayerNotificationData(t)}catch(e){}return[2]})})()}},{key:"getNotificationPayloads",value:function(){var e,t=globalThis.game.player.getNotificationData(),n={},r=[],a=Date.now(),o=a;for(var s=1;s<=7;s++){var u="D".concat(s),l=(null===(e=t[u])||void 0===e?void 0:e.arrivalDate)||0;if(a<l){o=Math.max(o,l);continue}r.push(u)}if(0===r.length)return n;var d=Math.floor(o-a)/1e3;for(var _=0;_<r.length;_++){var p=r[_],g=parseInt(p.replace("D","")),v={description:this.getNotificationContent(p),minDelayInSeconds:86400*(_+1)+d,type:g};n[p]=v}return n}},{key:"getNotificationContent",value:function(e){var t=GameCore.Configs.GameSDKOptions.MSGames.ScheduleNotification;if(!t)throw new Error("MsGamesNotification content not set up!");if(this.validateNotificationKey(e)){var n=t[e];return n&&""!==n?n:eP}return eP}},{key:"updatePlayerNotificationData",value:function(e){var t=globalThis.game.player,n=t.getNotificationData(),r=Date.now();for(var a=1;a<=7;a++){var o="D".concat(a),s=e[o];if(!!s){var u=s.minDelayInSeconds;u&&(n[o]={arrivalDate:r+1e3*u})}}t.setPlayerDataByName("notificationData",n)}},{key:"batchSendNotification",value:function(e){if(!("scheduleNotificationAsync"in GameSDK.extra))throw new Error("scheduleNotificationAsync is not available!");for(var t=1;t<=7;t++){var n=e["D".concat(t)];n&&GameSDK.extra.scheduleNotificationAsync(n)}}},{key:"validateNotificationKey",value:function(e){return GameCore.Utils.Array.has(["D1","D2","D3","D4","D5","D6","D7"],e)}}],[{key:"sendDailyNotification",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){return[2,e.getInstance().sendDailyNotificationInstance()]})})()}},{key:"getInstance",value:function(){return this._instance||(this._instance=new U),this._instance}}]),U}();i(eD,"_instance");var eC="Save The Pets",eS=/*#__PURE__*/function(e){function st(e){var t;return _class_call_check(this,st),i(t=_call_super(this,st,[e]),"sdk"),i(t,"shareImageBase64"),i(t,"notificationImageBase64"),t.sdk=e.sdk,t.adapter=e,t}return _inherits(st,e),_create_class(st,[{key:"shareAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(n.trys.push([0,4,,5]),!!e.shareImageBase64)return[3,2];return[4,e.loadImageAsync("./public/share-95x95.jpg")];case 1:(t=n.sent())&&(e.shareImageBase64=t),n.label=2;case 2:return[4,e.sdk.shareAsync({title:eC,text:"Play now!",image:e.shareImageBase64})];case 3:return n.sent(),[3,5];case 4:return n.sent(),[3,5];case 5:return[2]}})})()}},{key:"switchGameAsync",value:function(e){return this.sdk.switchGameAsync({id:e})}},{key:"submitGameResultsAsync",value:function(e){return this.sdk.submitGameResultsAsync(e)}},{key:"scheduleNotificationAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a;return _ts_generator(this,function(o){switch(o.label){case 0:if(!!t.notificationImageBase64)return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,t.loadImageAsync("./public/notification-364x180.jpg")];case 2:return(n=o.sent())&&(t.notificationImageBase64=n),[3,4];case 3:return o.sent(),[3,4];case 4:r={playerId:t.adapter.player.getID()||"Anonymous"},a=_object_spread({},a={title:eC,description:"We miss you!",type:0,minDelayInSeconds:300,imageData:t.notificationImageBase64,callToAction:"Play now!",payload:JSON.stringify(r)},e),o.label=5;case 5:return o.trys.push([5,7,,8]),[4,t.sdk.scheduleNotificationAsync(a)];case 6:return o.sent(),[3,8];case 7:return o.sent(),[3,8];case 8:return[2]}})})()}},{key:"sendDailyNotificationAsync",value:function(){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2,eD.sendDailyNotification()]})})()}},{key:"isValidDisplayAdPlacement",value:function(e){return["top:728x90","bottom:728x90","left:300x250","right:300x250","topleft:300x250","topright:300x250","bottomleft:300x250","bottomright:300x250","top:320x50","right:320x50","bottom:320x50","left:320x50","left:300x600","right:300x600","top:970x250","bottom:970x250","left:160x600","right:160x600"].indexOf(e)>-1}},{key:"getBannerOffset",value:function(){return 20}},{key:"loadImageAsync",value:function(e){return _async_to_generator(function(){var t,n,r,a;return _ts_generator(this,function(o){switch(o.label){case 0:return n=(t=GameCore.Utils.Image).fetchImage,r=t.blobToDataImage,[4,n(e)];case 1:return a=o.sent(),[4,r(a)];case 2:return[2,o.sent()]}})})()}}]),st}(es);n(),r();var eT=/*#__PURE__*/function(e){function ct(e){var t;return _class_call_check(this,ct),i(t=_call_super(this,ct,[e]),"_personalInfo"),i(t,"signature",""),i(t,"isLoginEnabled",!1),t.updateLoginEnabledConfig(),t}return _inherits(ct,e),_create_class(ct,[{key:"updateLoginEnabledConfig",value:function(){var e=t;if(!e)return;var n=e.MSGames;n&&(this.isLoginEnabled=n.UseLoginFeature)}},{key:"initPlayerAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,8,,10]),[4,e.tryGettingSignedInPlayer()];case 1:if(t=n.sent(),!(e.isLoginEnabled&&!t))return[3,3];return[4,e.tryMakingPlayerSignedIn()];case 2:t=n.sent(),n.label=3;case 3:if(!t)return[3,5];return[4,e.initLoggedMode(t)];case 4:return n.sent(),[3,7];case 5:return[4,e.initGuestMode()];case 6:n.sent(),n.label=7;case 7:return[3,10];case 8:return n.sent(),[4,e.initGuestMode()];case 9:return n.sent(),[3,10];case 10:return[2]}})})()}},{key:"initLoggedMode",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a,o;return _ts_generator(this,function(s){return n=e.playerId,r=e.signature,a=e.publisherPlayerId,o=e.playerDisplayName,t.currentPlayerInfo.playerId=n,t.currentPlayerInfo.playerName=o,t.signature="".concat(n," ").concat(r),t._personalInfo={id:n,avatarIdHash:"0",lang:"en",publicName:o,uniqueID:a,scopePermissions:{avatar:"forbid",public_name:"forbid"}},t.extra.isGuest=!1,t.initPlayerInfo(n),[2]})})()}},{key:"initGuestMode",value:function(){var e=this;return _async_to_generator(function(){var t,n;return _ts_generator(this,function(r){try{t=e.getID(),e.extra.isGuest=!0,e.initPlayerInfo(t),n=e.getName(),e._personalInfo={id:t,avatarIdHash:"0",lang:"en",publicName:n,uniqueID:t,scopePermissions:{avatar:"forbid",public_name:"forbid"}}}catch(e){}return[2]})})()}},{key:"tryGettingSignedInPlayer",value:function(e){var t=arguments.length>0&&void 0!==e?e:0;var n=this;return _async_to_generator(function(){var e,r,a,o;return _ts_generator(this,function(s){switch(s.label){case 0:e=null,r=n.adapter.sdk,a=GameCore.Utils.Object,s.label=1;case 1:return s.trys.push([1,3,,6]),[4,r.getSignedInUserAsync()];case 2:return e=s.sent(),[3,6];case 3:if(o=s.sent(),!(a.hasOwn(o,"code")&&"SERVICE_REQUEST_FAILED"===o.code&&t<3))return[3,5];return[4,n.tryGettingSignedInPlayer(t+1)];case 4:return[2,s.sent()];case 5:return[3,6];case 6:return[2,Promise.resolve(e)]}})})()}},{key:"tryMakingPlayerSignedIn",value:function(e){var t=arguments.length>0&&void 0!==e?e:0;var n=this;return _async_to_generator(function(){var e,r,a,o;return _ts_generator(this,function(s){switch(s.label){case 0:e=null,r=n.adapter.sdk,a=GameCore.Utils.Object,s.label=1;case 1:return s.trys.push([1,3,,6]),[4,r.signInAsync()];case 2:return e=s.sent(),[3,6];case 3:if(o=s.sent(),!(a.hasOwn(o,"code")&&"SERVICE_REQUEST_FAILED"===o.code&&t<3))return[3,5];return[4,n.tryMakingPlayerSignedIn(t+1)];case 4:return[2,s.sent()];case 5:return[3,6];case 6:return[2,Promise.resolve(e)]}})})()}},{key:"getASIDAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){return[2,null!=(t=e._personalInfo.uniqueID)?t:""]})})()}},{key:"getSignedASIDAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:return[4,e.getASIDAsync()];case 1:return t=n.sent(),[2,{getASID:function(){return t},getSignature:function(){return e.signature}}]}})})()}},{key:"getSignedPlayerInfoAsync",value:function(){var e=this;return Promise.resolve({getPlayerID:function(){var t;return null!==(t=e.getID())&&void 0!==t?t:"10"},getSignature:function(){return e.signature}})}},{key:"canSubscribeBotAsync",value:function(){return Promise.resolve(!1)}},{key:"subscribeBotAsync",value:function(){this.adapter.extra.exceptionUnsupported()}},{key:"getConnectedPlayersAsync",value:function(){this.adapter.extra.exceptionUnsupported()}}]),ct}(eu);n(),r(),n(),r();var eE=/*#__PURE__*/function(){function lt(e){_class_call_check(this,lt),i(this,"id"),i(this,"title"),i(this,"contextId"),i(this,"payload"),i(this,"endTime"),i(this,"tournamentType");var t=e._id,n=e.name,r=e.type,a=e.createdAt,o=e.expireTime,s=JSON.parse(e.description),u=_object_spread({leaderboardId:t},s);this.id=s.tournamentId,this.title=n,this.contextId=s.contextId,this.payload=JSON.stringify(u),this.endTime=Math.round((new Date(a).getTime()+1e3*o)/1e3),this.tournamentType="world_tournament_leaderboard"===r?"PAGE_HOSTED":"DEFAULT"}return _create_class(lt,[{key:"getID",value:function(){return this.id}},{key:"getTitle",value:function(){return this.title}},{key:"getPayload",value:function(){return this.payload}},{key:"getEndTime",value:function(){return this.endTime}},{key:"getContextID",value:function(){return this.contextId}},{key:"getTournamentType",value:function(){return this.tournamentType}}]),lt}();var eO=/*#__PURE__*/function(e){function ut(){return _class_call_check(this,ut),_call_super(this,ut,arguments)}return _inherits(ut,e),_create_class(ut,[{key:"joinAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a;return _ts_generator(this,function(o){switch(o.label){case 0:return n=GameCore.Utils.Array,[4,t.getTournamentsAsync()];case 1:return r=o.sent(),(a=n.search(r,function(t){return t.getID()===e}))||t.extra.exceptionTournamentNotFound("Tournament could not be found."),[4,GameSDK.context.switchAsync(a.getContextID())];case 2:return o.sent(),[2]}})})()}},{key:"getTournamentsAsync",value:function(){return _async_to_generator(function(){var e,t,n,r,a,o,s,u,l;return _ts_generator(this,function(d){switch(d.label){case 0:e=[],d.label=1;case 1:return d.trys.push([1,3,,4]),[4,globalThis.game.leaderboard.requestLeaderboardsAsync({limit:100,type:"world_tournament_leaderboard"})];case 2:t=d.sent(),n=true,r=false,a=void 0;try{for(o=t[Symbol.iterator]();!(n=(s=o.next()).done);n=true)u=s.value,l=new eE(u),e.push(l)}catch(e){r=true,a=e}finally{try{if(!n&&null!=o.return)o.return()}finally{if(r)throw a}}return[3,4];case 3:return d.sent(),[3,4];case 4:return[2,e]}})})()}}]),ut}(em);var eG=/*#__PURE__*/function(e){function dt(e){var t;return _class_call_check(this,dt),i(t=_call_super(this,dt),"sdk"),i(t,"adPlacementList",new Set),t.sdk=e,t}return _inherits(dt,e),_create_class(dt,[{key:"initialize",value:function(){_get(_get_prototype_of(dt.prototype),"initialize",this).call(this),this.extra=new eS(this),this.player=new eT(this),this.context=new ex(this),this.tournament=new eO(this),this.rewardedVideoInstance=new eA("rewarded",this.sdk),this.interstitialAdInstance=new eA("interstitial",this.sdk)}},{key:"checkSDKInitialized",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){return e.sdk&&e.sdk.isInMicrosoftStart()||e.extra.exceptionInvalidOperation("Microsoft Games SDK is not initialized"),[2]})})()}},{key:"initializeAsync",value:function(){var e=this;var t=this;return _async_to_generator(function(){return _ts_generator(this,function(n){switch(n.label){case 0:if(!!t.isInitialized)return[3,5];return[4,(function(){return _get(_get_prototype_of(dt.prototype),"initializeAsync",e)})().call(t)];case 1:n.sent(),t.isInitialized=!1,n.label=2;case 2:return n.trys.push([2,4,,5]),t.extra.displayWarnLoading(!1),[4,t.player.initPlayerAsync()];case 3:return n.sent(),t.isInitialized=!0,[3,5];case 4:if(n.sent(),t.isNeedSDK())throw new Error("Microsoft Games SDK not initialized");return[3,5];case 5:return[2]}})})()}},{key:"getLocale",value:function(){return this.sdk.getLocale()}},{key:"getSDKVersion",value:function(){return"v1.0.0-rc.13"}},{key:"getSDKName",value:function(){return"MsGames"}},{key:"canCreateShortcutAsync",value:function(){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2,!0]})})()}},{key:"createShortcutAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,e.sdk.promptInstallAsync()];case 1:return t.sent(),[3,3];case 2:return t.sent(),[3,3];case 3:return[2]}})})()}},{key:"getInterstitialAdAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){return[2,e.interstitialAdInstance]})})()}},{key:"getRewardedVideoAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){return[2,e.rewardedVideoInstance]})})()}},{key:"getRewardedInterstitialAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){return[2,e.rewardedVideoInstance]})})()}},{key:"loadBannerAdAsync",value:function(e){var t=this;return _async_to_generator(function(){var e,n,r,a,o,s,u,l,d,_,p;return _ts_generator(this,function(g){switch(g.label){case 0:e=GameCore.Configs.Ads.BannerDisplayAdOptions,n=true,r=false,a=void 0;try{for(o=e[Symbol.iterator]();!(n=(s=o.next()).done);n=true)l=(u=s.value).Position,d=u.BannerWidth,_=u.BannerHeight,p="".concat(l,":").concat(d,"x").concat(_),t.extra.isValidDisplayAdPlacement(p)&&t.adPlacementList.add(p)}catch(e){r=true,a=e}finally{try{if(!n&&null!=o.return)o.return()}finally{if(r)throw a}}return[4,t.showBannerAdsAsync()];case 1:return g.sent(),[2]}})})()}},{key:"hideBannerAdAsync",value:function(e){var t=this;return _async_to_generator(function(){return _ts_generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,t.sdk.hideDisplayAdsAsync()];case 1:return e.sent(),[3,3];case 2:return e.sent(),[3,3];case 3:return[2]}})})()}},{key:"getEntryPointAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){return t=e.sdk.getEntryPointInfo(),[2,e.sdk.getNotificationPayload()?"msn_notification":t.entryPointId]})})()}},{key:"showBannerAdsAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(0!==e.adPlacementList.size)return[3,1];return e.extra.exceptionInvalidOperation("Invalid banner ad placement"),[3,4];case 1:return n.trys.push([1,3,,4]),t=_to_consumable_array(e.adPlacementList),[4,e.sdk.showDisplayAdsAsync(t)];case 2:return n.sent(),[3,4];case 3:return n.sent(),[3,4];case 4:return e.adPlacementList.clear(),[2]}})})()}},{key:"getTournamentAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o;return _ts_generator(this,function(s){switch(s.label){case 0:return t=e.context.getID(),r=(n=GameCore.Utils).Array,n.Valid.isString(t)||e.extra.exceptionInvalidOperation("Not in a context"),[4,e.tournament.getTournamentsAsync()];case 1:return a=s.sent(),[2,((o=r.search(a,function(e){return e.getContextID()===t}))||e.extra.exceptionTournamentNotFound("A Tournament with current context was not found"),o)]}})})()}}]),dt}(ew);s(),n(),r();var eN=new/*#__PURE__*/(function(){function pt(){_class_call_check(this,pt),i(this,"usedCallLocations"),this.usedCallLocations=Object.create(null)}return _create_class(pt,[{key:"getCallerLine",value:function(){var e=new Error;if(!e.stack)return null;var t=e.stack.split("\n")[4];return t?t.trim():null}},{key:"blockAccess",value:function(){try{var e=this.getCallerLine();if(!e||this.usedCallLocations[e])return!1;if(["eval","at <","(<"].some(function(t){return e.includes(t)}))throw new Error("Access blocked for the caller: ".concat(e));return this.usedCallLocations[e]=!0,!1}catch(e){return!0}}}]),pt}());function ce(){var e,t=window;return"FBInstant"in t?e=new o(window.FBInstant):"YaGames"in t?e=new o(window.YaGames):"$msstart"in t?e=new eG(window.$msstart):"gdsdk"in t?e=new o(window.gdsdk):"CrazyGames"in t?e=new o(window.CrazyGames.SDK):"GlanceGamingAdInterface"in t?e=new o(window.GlanceGamingAdInterface):e=new ew,e}window.GameSDK=Object.seal(ce()),function(e,t){var n=Object.getOwnPropertyDescriptor(e,t);if(!n)return;var r=n.value,a=n.get,o=n.initializer;r&&(void 0===r?"undefined":_type_of(r))!="object"||a&&"function"!=typeof a||o&&"function"!=typeof o||Object.defineProperty(e,t,{enumerable:!1,get:function(){var e;if(!eN.blockAccess())return null!==(e=null!=r?r:null==o?void 0:o.call(this))&&void 0!==e?e:null==a?void 0:a.call(this)},set:function(){}})}(window,"GameSDK")})(),function(){"use strict";var e={TAG_IDS:"G-EX3MNH7ENG",BUILD_VERSION:"24"},f=function(){var e=setInterval(function(){if(window.__sdkLoadingCount>=70){clearInterval(e);return}GameSDK.setLoadingProgress(window.__sdkLoadingCount++)},250)};var t=null,y=function(){t=setTimeout(function(){window.__sdkLoadingCount>0||GameSDK.extra.displayWarnLoading(!0)},8e3)},D=function(){clearTimeout(t),GameSDK.extra.displayWarnLoading(!1)},n=/*#__PURE__*/function(){var e=_async_to_generator(function(){return _ts_generator(this,function(e){switch(e.label){case 0:y(),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,GameSDK.initializeAsync()];case 2:return e.sent(),[3,4];case 3:return e.sent(),setTimeout(n,2e3),[2];case 4:return D(),window.__sdkLoadingCount=1,GameSDK.setLoadingProgress(window.__sdkLoadingCount),f(),[4,a()];case 5:return e.sent(),window.__sdkInitiated=!0,[2]}})});return function(){return e.apply(this,arguments)}}(),r={},a=/*#__PURE__*/function(){var t=_async_to_generator(function(){var t,n,r,a;return _ts_generator(this,function(o){switch(o.label){case 0:if(o.trys.push([0,2,3,4]),0===(t=e.TAG_IDS.split(" ")).length&&t.push("G-3ZG4F3ZNXH"),!t[0]||"null"===t[0])return[2];return[4,GameSDK.getEntryPointAsync()];case 1:return r=null!==(n=o.sent())&&void 0!==n?n:"no_entry",(a=document.createElement("script")).async=!0,a.src="https://www.googletagmanager.com/gtag/js?id=".concat(t[0]),document.head.appendChild(a),S(GameSDK.player.getID(),r,t),[3,4];case 2:return c(o.sent()),[3,4];case 3:return w(),[7];case 4:return[2]}})});return function(){return t.apply(this,arguments)}}(),c=function(e){var t=window.game,n=t.analytics,r=t.monitorError;if(!r){window.__errorQueue.push(e);return}n.event("app_crash_handle",{error:e}),r.sendException(e)},S=function(t,n,a){try{window.focus();var o=e.BUILD_VERSION,s=void 0===o?"0":o,u=GameSDK.getEntryPointData()||{},l=u.fbig_ad_id,d=u.fbig_adset_id,_=u.fbig_campaign_id;window.gtag("js",new Date),window.gtag("set","client_id","100.".concat(t)),window.gtag("set","user_id",t),window.gtag("set","send_page_view",!1),a.forEach(function(e){window.gtag("config",e,{cookie_flags:"SameSite=None;Secure",build:s,medium:n,campaign:_,groups:"GA",transport_type:"beacon"})});var p=GameCore.Utils.Browser.getQueryParams().entry_point||n;r.user_id=t,r.player_id=t,r.app_version=s,r.traffic_source=n,r.traffic_source_detail=p,r.ad_id=l,r.adset_id=d,r.campaign_id=_,window.gtag("set","user_properties",r)}catch(e){c(e)}},w=function(e){var t=arguments.length>0&&void 0!==e?e:0;if(!(t>=30)){if(!window.game||!window.game.event){setTimeout(function(){return w(t+1)},50);return}I(),E()}},I=function(){var e=window.game,t=e.analytics,n=e.event,r=GameCore.Events,a=GameCore.Plugins.Analytics.Events,o=a.APP_LAUNCH,s=a.APP_INITIALIZED;t.event(o),n.catchUp(r.GAME_SDK_READY,function(){t.event(s)})},h=function(){try{var e;var t=window.game.player,n=t.getBestScore(),a=null!==(e=t.getGameData().coins)&&void 0!==e?e:0,o=t.isFirstLogin();r.new_user=o,r.coins=a,r.score=n;var s=GameSDK.getEntryPointData()||{},u=s.content,l=s.notif_id;(u||l)&&(r.traffic_source_detail=null!=u?u:"notif_".concat(l)),window.gtag("set","user_properties",r)}catch(e){c(e)}},E=function(){try{if(!GameSDK.player.getID())return;var e=window.game.event,t=GameCore.Events.PLAYER_INFO_LOADED;e.catchUp(t,h)}catch(e){c(e)}};n()}();