System.register([], function(_export, _context) { return { execute: function () {
System.register("chunks:///TournamentUtils-b668f6fb.js",["cc"],(function(e){var t,n,r,i,a,o,u,s,l,c,d,f,y,h,v,p,m,g,S,E,A,T,N;return{setters:[function(e){t=e.cclegacy,n=e.JsonAsset,r=e.Prefab,i=e.AnimationClip,a=e.ImageAsset,o=e.SpriteFrame,u=e.Font,s=e.assetManager,l=e.AudioClip,c=e.sp,d=e.tween,f=e.Animation,y=e.UITransform,h=e.view,v=e.screen,p=e.math,m=e.director,g=e.find,S=e.loadWasmModuleBullet,E=e.loadWasmModulePhysX,A=e.loadWasmModuleBox2D,T=e.loadWasmModuleSpine,N=e.game}],execute:function(){function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){L(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function I(t){return(I=e("_","function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}))(t)}function R(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,i)}function C(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){R(a,r,i,o,u,"next",e)}function u(e){R(a,r,i,o,u,"throw",e)}o(void 0)}))}}function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Y(r.key),r)}}function _(e,t,n){return t&&D(e.prototype,t),n&&D(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function L(e,t,n){return(t=Y(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P(e,t)}function $(t){return($=e("m",Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)}))(t)}function P(e,t){return(P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function F(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function B(e,t,n){return(B=F()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&P(i,n.prototype),i}).apply(null,arguments)}function x(t){var n="function"==typeof Map?new Map:void 0;return(x=e("f",(function(e){if(null===e||(t=e,-1===Function.toString.call(t).indexOf("[native code]")))return e;var t;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,r)}function r(){return B(e,arguments,$(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),P(r,e)})))(t)}function M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function G(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return M(e)}function U(e){var t=F();return function(){var n,r=$(e);if(t){var i=$(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return G(this,n)}}function W(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$(e)););return e}function H(){return(H="undefined"!=typeof Reflect&&Reflect.get?e("l",Reflect.get.bind()):e("l",(function(e,t,n){var r=W(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}))).apply(this,arguments)}function j(e){return function(e){if(Array.isArray(e))return K(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||z(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){if(e){if("string"==typeof e)return K(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?K(e,t):void 0}}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function V(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=z(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(u)throw a}}}}function Y(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}e({_:I,a:C,b:O,c:U,d:k,e:_,f:x,g:V,h:function(e,t,n,r,i){var a={};Object.keys(r).forEach((function(e){a[e]=r[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0);a=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),a),i&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(i):void 0,a.initializer=void 0);void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null);return a},i:function(e,t,n,r){if(!n)return;Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})},j:M,k:w,l:H,m:$,o:L,r:function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,u=[],s=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(u.push(r.value),u.length!==t);s=!0);}catch(e){l=!0,i=e}finally{try{if(!s&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return u}}(e,t)||z(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()},t:j});e("E",!1),e("H",!0);t._RF.push({},"725f8u/lDtFbY1DMY0uJSL9","Locales",void 0);e("u",["en","ru"]);var q=e("L",{en:"fonts/mikado-bold.ttf",ru:"fonts/nunito-black.ttf"});e("I",{ru:"locales/ru"}),e("F",{en:"104px",ru:"96px"});t._RF.pop(),t._RF.push({},"30f3eu78CVKp5+jOQ2m1GKG","ResourceUtils",void 0);var J=Ludex.Utils,Z=J.Function,X=J.Time,Q=["loadable","animations"],ee=function(){var e=C((function*(){try{var e=Q.map((function(e){return te.loadBundle(e)}));yield Promise.all(e)}catch(e){console.warn("ResourceUtils: initBundles failed",e),yield X.sleepAsync(500)}}));return function(){return e.apply(this,arguments)}}(),te=e("R",function(){function e(){k(this,e),this.bundles={loadable:null,animations:null}}var t,d,f,y,h,v,p,m,g,S,E,A,T,N,b,w,I;return _(e,[{key:"getBundleNameByType",value:function(e){switch(e){case i:return"animations";default:return"loadable"}}},{key:"loadBundleByType",value:(I=C((function*(t){var n=this.getBundleNameByType(t);return e.loadBundle(n)})),function(e){return I.apply(this,arguments)})},{key:"getBundleByType",value:function(e){var t,n=this.getBundleNameByType(e);return null!==(t=this.bundles[n])&&void 0!==t?t:null}},{key:"preloadAsset",value:(w=C((function*(e,t,n){var r=this;yield this.loadBundleByType(t);var i=this.getBundleByType(t);if(i)return new Promise((function(a,o){i.preload(e,t,(function(i){if(i)return console.warn("Failed to preload asset at path: ".concat(e),i),void o(i);n?r.loadAssetAsync(e,t).finally(a):a()}))}))})),function(e,t,n){return w.apply(this,arguments)})},{key:"loadAssetAsync",value:(b=C((function*(e,t){yield this.loadBundleByType(t);var n=this.getBundleByType(t);if(!n)return null;var r=this.getAsset(e,t);return r||new Promise((function(r,i){n.load(e,t,(function(t,n){n?r(n):(console.warn("[ResourceUtils] Failed to load asset at path: ".concat(e),t),i(null))}))}))})),function(e,t){return b.apply(this,arguments)})},{key:"loadAssetsAsync",value:(N=C((function*(e,t){yield this.loadBundleByType(t);var n=this.getBundleByType(t);if(!n)return null;for(var r=[],i=[],a=0,o=e.length;a<o;a++){var u=e[a],s=this.getAsset(u,t);s?r.push({index:a,asset:s}):i.push({index:a,path:u})}return 0===i.length?Promise.resolve(r.map((function(e){return e.asset}))):new Promise((function(e){n.load(i.map((function(e){return e.path})),t,(function(t,n){if(t||n.length!==i.length)e(null);else{for(var a=0,o=n.length;a<o;a++){var u,s=n[a];if(s){var l=null===(u=i[a])||void 0===u?void 0:u.index;if(!l)return;r.splice(l,0,{index:l,asset:s})}}e(r.map((function(e){return e.asset})))}}))}))})),function(e,t){return N.apply(this,arguments)})},{key:"loadDirAsync",value:(T=C((function*(e,t){yield this.loadBundleByType(t);var n=this.getBundleByType(t);return n?new Promise((function(r){n.loadDir(e,t,(function(t,n){n?r(n):(console.warn("Failed to load assets at path: ".concat(e),t),r([]))}))})):Promise.resolve([])})),function(e,t){return T.apply(this,arguments)})},{key:"preloadDirAsync",value:(A=C((function*(e,t,n){var r=this;yield this.loadBundleByType(t);var i=this.getBundleByType(t);if(i)return new Promise((function(a,o){i.preloadDir(e,t,(function(i){if(i)return console.warn("Failed to preload assets at path: ".concat(e),i),void o(i);n?r.loadDirAsync(e,t).finally(a):a()}))}))})),function(e,t,n){return A.apply(this,arguments)})},{key:"getAsset",value:function(t,n){var r=this.getBundleByType(n);if(!r)return null;var i=e.getAssetInfo(t,n);return i?r.get(i.path,n):null}},{key:"loadFontAsync",value:function(e){var t=q[e].replace(/\.[^.]+$/,"");return this.loadAssetAsync(t,u)}},{key:"loadSpriteFramesAsync",value:(E=C((function*(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=yield this.loadAssetsAsync(e,o);if(n){var r,i=V(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;a.packable=t}}catch(e){i.e(e)}finally{i.f()}}return n})),function(e){return E.apply(this,arguments)})}],[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"loadBundle",value:(S=C((function*(e){var t=this;this.inst.bundles[e]||(yield new Promise((function(n,r){var i=setTimeout(r,15e3);s.loadBundle(e,null,(function(a,o){clearTimeout(i);var u=t.inst.bundles[e];u||!a&&o?(t.inst.bundles[e]=null!=u?u:o,n(!0)):r(a)}))})))})),function(e){return S.apply(this,arguments)})},{key:"loadAudioAsync",value:(g=C((function*(e){return this.inst.loadAssetAsync(e,l)})),function(e){return g.apply(this,arguments)})},{key:"loadJsonAsync",value:(m=C((function*(e){return this.inst.loadAssetAsync(e,n)})),function(e){return m.apply(this,arguments)})},{key:"loadPrefabAsync",value:(p=C((function*(e){return this.inst.loadAssetAsync(e,r)})),function(e){return p.apply(this,arguments)})},{key:"loadAnimClipAsync",value:(v=C((function*(e){return this.inst.loadAssetAsync(e,i)})),function(e){return v.apply(this,arguments)})},{key:"loadSkeletonDataAsync",value:(h=C((function*(e){return this.inst.loadAssetAsync(e,c.SkeletonData)})),function(e){return h.apply(this,arguments)})},{key:"loadImageSpriteFrameAsync",value:(y=C((function*(e){var t=yield this.inst.loadAssetAsync(e,a);return t?o.createWithImage(t):null})),function(e){return y.apply(this,arguments)})},{key:"loadSpriteFrameAsync",value:(f=C((function*(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=yield this.inst.loadAssetAsync(e,o);return n&&(n.packable=t),n})),function(e){return f.apply(this,arguments)})},{key:"loadSpriteFramesDirAsync",value:(d=C((function*(e){return this.inst.loadDirAsync(e,o)})),function(e){return d.apply(this,arguments)})},{key:"preloadJson",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.inst.preloadAsset(e,n,t)}},{key:"preloadPrefab",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.inst.preloadAsset(e,r,t)}},{key:"preloadAnimClip",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.inst.preloadAsset(e,i,t)}},{key:"preloadImageSpriteFrame",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.inst.preloadAsset(e,a,t)}},{key:"preloadSpriteFrame",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.inst.preloadAsset(e,o,t)}},{key:"preloadSpriteFramesDir",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.inst.preloadDirAsync(e,o,t)}},{key:"getAssetInfo",value:function(e,t){var n=this.inst.getBundleByType(t);return n?n.getInfoWithPath(e,t):null}},{key:"getAsset",value:function(e,t){return this.inst.getAsset(e,t)}},{key:"loadFontAsync",value:function(e){return this.inst.loadFontAsync(e)}},{key:"loadSpriteFramesAsync",value:(t=C((function*(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.inst.loadSpriteFramesAsync(e,t)})),function(e){return t.apply(this,arguments)})}]),e}());Z.retry(ee,ee),t._RF.pop(),t._RF.push({},"a0999j91ytLSYSzNSPnMz3i","AnimAbortSignalAdapter",void 0);var ne=Ludex.Utils.Signal,re=function(){function e(t){k(this,e),this.oldCallbacks=[],this.newCallbacks=[],this.signal=t}return _(e,[{key:"once",value:function(e){var t=this,n=function(){return e(new Error(t.signal.reason))};this.oldCallbacks.push(n),this.newCallbacks.push(e),this.signal.addAbortListener(n)}},{key:"off",value:function(e){var t=this.newCallbacks.indexOf(e);if(-1!==t){var n=this.oldCallbacks[t];this.signal.removeAbortListener(n),this.oldCallbacks.splice(t,1),this.newCallbacks.splice(t,1)}}},{key:"abort",value:function(e){var t=e instanceof Error?e.message:e;this.signal.abort(t)}},{key:"aborted",get:function(){return this.signal.aborted}},{key:"reason",get:function(){return"string"==typeof this.signal.reason?new Error(this.signal.reason):void 0}},{key:"wrap",value:function(e){if(!this.aborted)return e}},{key:"chain",value:function(e){var t=this;e instanceof ne.Signal?e.once((function(){return t.abort()})):e.addEventListener("abort",(function(){return t.abort()}))}},{key:"promise",value:function(){var e=this;return this.aborted?Promise.resolve(this.reason):new Promise((function(t){e.once((function(e){return t(e)}))}))}}]),e}();t._RF.pop(),t._RF.push({},"99b8eEF6WlE8pzPfD+whiJu","AnimUtils",void 0);var ie=Ludex.Utils.Signal;function ae(e){return e instanceof ie.Signal?e:new re(e)}var oe=e("A",function(e){O(n,e);var t=U(n);function n(){return k(this,n),t.apply(this,arguments)}return _(n)}(function(){function e(){k(this,e)}return _(e,null,[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}},{key:"elasticOut",value:function(e,t,n){var r=t||.1,i=n||.1;if(0===e)return 0;if(1===e)return 1;var a=i/4;return r<1?r=1:a=i*Math.asin(1/r)/(2*Math.PI),r*Math.pow(2,-10*e)*Math.sin((e-a)*(2*Math.PI)/i)+1}},{key:"easeOutExpo",value:function(e){return 1===e?1:1-Math.pow(2,-10*e)}},{key:"easeInExpo",value:function(e){return 0===e?0:Math.pow(2,10*e-10)}},{key:"runTweenAsync",value:function(e,t){if(void 0===t)return new Promise((function(t){e.call((function(){return t({tween:e})})).start()}));var n=ae(t);return n.aborted?Promise.resolve({tween:e}):new Promise((function(t){var r=function(){e.stop(),t({tween:e})};n.once(r),e.call((function(){n.off(r),t({tween:e})})).start()}))}},{key:"runOnUpdateAsync",value:function(e,t,n,r){return new Promise((function(i,a){var o=d(e).to(t,{},{onUpdate:function(e,t){if(void 0!==t)try{n(t)}catch(e){a(e instanceof Error?e:new Error(String(e)))}}});if(void 0!==r){var u=ae(r);if(u.aborted)i({tween:o});else{var s=function(){o.stop(),i({tween:o})};u.once(s),o.call((function(){u.off(s),i({tween:o})})).start()}}else o.call((function(){return i({tween:o})})).start()}))}},{key:"waitTweenAsync",value:function(e,t){return new Promise((function(n){var r=d({}).delay(e);if(void 0!==t){var i=ae(t);if(i.aborted)n();else{var a=function(){r.stop(),n()};i.once(a),r.call((function(){i.off(a),n()})).start()}}else r.call((function(){return n()})).start()}))}},{key:"runAnimationAsync",value:function(e,t,n){if(void 0===n)return new Promise((function(n){e.once(f.EventType.FINISHED,n),e.play(t)}));var r=ae(n);return r.aborted?Promise.resolve():new Promise((function(n){var i=function(){e.stop(),n()};r.once(i),e.once(f.EventType.FINISHED,(function(){r.off(i),n()})),e.play(t)}))}}]),e}()));t._RF.pop(),t._RF.push({},"244e9OHsmpDnpHQKeLzgiiX","GameEvents",void 0);var ue=e("G",{VIEW_RESIZED:"view-resized",LAYOUT_CHANGED:"layout-changed",ORIENTATION_CHANGED:"orientation-changed",WIDGET_RESIZED:"widget-resized",GAMEPLAY_UPDATE_CONFIG:"gameplay-update-config",OPENED_SKIP_OVERLAY:"opened-skip-overlay",CLOSED_SKIP_OVERLAY:"closed-skip-overlay",RESULT_SCENE_REPLAY:"result-scene-replay",RESULT_SCENE_HOME:"result-scene-home",REQUEST_DYNAMIC_ATLAS:"request-dynamic-atlas",FINISHED_DYNAMIC_ATLAS:"finished-dynamic-atlas",ASSET_QUALITY_CHANGE:"asset-quality-change",REQUEST_UPGRADE_ASSET:"request-upgrade-asset",CLEAR_HYBRID_FILE_CACHE:"clear-hybrid-file-cache",PRELOAD_LANGUAGE:"preload-language",CHOOSE_LANGUAGE:"choose-language",LOCALIZE_APPLIED:"localize-applied"});t._RF.pop(),t._RF.push({},"5c76fxO2ppOqYp4WNO+Kavm","GameWorld",void 0);var se=e("n",{Layout:{Portrait:"portrait",Landscape:"landscape"},DesignSize:{Portrait:{WIDTH:750,HEIGHT:1583},Landscape:{WIDTH:2732,HEIGHT:1536},Resolution:2},AcceptPortraitRatio:690/829,PRIMARY_LAYOUT:"auto",FULL_PORTRAIT_SIZE:!0,FULL_LANDSCAPE_SIZE:!0});t._RF.pop(),t._RF.push({},"05faedSJ2NHFqLe9b3g4RIl","CocosUtils",void 0);var le,ce,de=Ludex.Utils.Device,fe=e("C",function(e){O(n,e);var t=U(n);function n(){return k(this,n),t.apply(this,arguments)}return _(n)}(function(){function e(){var t=this;k(this,e),this.getWindowSizeVsWorldGameRatio$=function(){var t=h.getVisibleSize();return v.windowSize.width/e.getMaxPixelRatio()/t.width},this.getBoundingBoxTo$=function(e,n){var r=p.mat4();p.Mat4.fromSRT(r,n.getRotation(),n.getPosition(),n.getScale());var i=n.getComponent(y);if(!i)throw new Error("Node must have UITransform component");var a=i.anchorPoint,o=i.contentSize,u=o.width,s=o.height,l=new p.Rect(-a.x*u,-a.y*s,u,s),c=p.mat4();if(p.Mat4.multiply(c,e,r),l.transformMat4(c),!n.children||0===n.children.length)return l;var d,f=n.children,h=n.getWorldMatrix(),v=V(f);try{for(v.s();!(d=v.n()).done;){var m=d.value;if(null!=m&&m.active)if(m.getComponent(y)){var g=t.getBoundingBoxTo$(h,m);g&&p.Rect.union(l,l,g)}}}catch(e){v.e(e)}finally{v.f()}return l}}return _(e,null,[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}},{key:"getBoundingBoxToWorld",value:function(e){if(e.parent){var t=e.parent.getWorldMatrix();return this.inst.getBoundingBoxTo$(t,e)}var n=e.getComponent(y);if(!n)throw new Error("Node must have UITransform component");return n.getBoundingBox()}},{key:"getMaxPixelRatio",value:function(){return Math.min(de.pixelRatio(),3)}},{key:"worldSizeToCssSize",value:function(e){var t=this.getMaxPixelRatio();return Math.round(e*t)}},{key:"cssSizeToWorldSize",value:function(e){return e/this.inst.getWindowSizeVsWorldGameRatio$()}},{key:"getScreenWidthCss",value:function(){var e=document,t=e.body,n=e.documentElement,r=t.clientWidth,i=n.clientWidth;return Math.max(i,r)||0}},{key:"getScreenHeightCss",value:function(){var e=document,t=e.body,n=e.documentElement,r=t.clientHeight,i=n.clientHeight;return Math.max(i,r)||0}}]),e}()));t._RF.pop(),t._RF.push({},"7ca06lc4HNFbaPBFusdm7/G","ScreenKeys",void 0);var ye=e("v",function(e){return e[e.LOADING_SCREEN=1]="LOADING_SCREEN",e[e.SETTINGS_SCREEN=2]="SETTINGS_SCREEN",e[e.NOTIFICATION_SCREEN=3]="NOTIFICATION_SCREEN",e[e.LOSE_SCREEN=4]="LOSE_SCREEN",e[e.WINNING_SCREEN=5]="WINNING_SCREEN",e[e.CONGRATULATION_SCREEN=6]="CONGRATULATION_SCREEN",e}(ye||{})),he=e("z",(L(le={},ye.LOADING_SCREEN,"LoadingScreen"),L(le,ye.SETTINGS_SCREEN,"SettingsScreen"),L(le,ye.NOTIFICATION_SCREEN,"NotificationScreen"),L(le,ye.LOSE_SCREEN,"LoseScreen"),L(le,ye.WINNING_SCREEN,"WinningScreen"),L(le,ye.CONGRATULATION_SCREEN,"CongratulationScreen"),le)),ve=(L(ce={},he[ye.LOADING_SCREEN],ye.LOADING_SCREEN),L(ce,he[ye.SETTINGS_SCREEN],ye.SETTINGS_SCREEN),L(ce,he[ye.NOTIFICATION_SCREEN],ye.NOTIFICATION_SCREEN),L(ce,he[ye.LOSE_SCREEN],ye.LOSE_SCREEN),L(ce,he[ye.WINNING_SCREEN],ye.WINNING_SCREEN),L(ce,he[ye.CONGRATULATION_SCREEN],ye.CONGRATULATION_SCREEN),[he[ye.NOTIFICATION_SCREEN],he[ye.LOADING_SCREEN]]);t._RF.pop(),t._RF.push({},"09bc071ZcpI978b1NdKUaqD","AnalyticsUtils",void 0);var pe=Ludex,me=pe.Utils.Array,ge=pe.Configs.Analytics,Se=codex.analytics,Ee=function(){function e(){k(this,e)}return _(e,null,[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}},{key:"trackCurrentPage",value:function(e,t){if(ge.Enabled&&!me.has(ve,e)&&(t||me.has(this.trackingPages$,e))){this.trackingPages$=this.trackingPages$.filter((function(t){return t!==e})),t&&this.trackingPages$.push(e);var n=this.getCurrentPage();Se.pageview(n)}}},{key:"switchSceneTracking",value:function(){if(ge.Enabled){this.trackingPages$=[];var e=this.getCurrentPage();Se.pageview(e)}}},{key:"getCurrentPage",value:function(){var e,t;return this.trackingPages$.length>0?this.trackingPages$[this.trackingPages$.length-1]||"Unknown Page":null!==(e=null===(t=m.getScene())||void 0===t?void 0:t.name)&&void 0!==e?e:"Unknown Scene"}},{key:"trackDeviceInfo",value:function(e){ge.Enabled&&Se.event("device_info",e)}}]),e}();Ee.trackingPages$=[];e("q",function(e){O(n,e);var t=U(n);function n(){return k(this,n),t.apply(this,arguments)}return _(n)}(Ee));t._RF.pop(),t._RF.push({},"31871PLRYRJu7yCCX5F6lWK","AudioUtils",void 0);var Ae=Ludex.Utils.Signal,Te=e("p",function(e){O(n,e);var t=U(n);function n(){return k(this,n),t.apply(this,arguments)}return _(n)}(function(){function e(){k(this,e),this.signalController$=new Ae.SignalController}var t,n,r,i,a;return _(e,[{key:"sound",get:function(){var e;return null===(e=g("Sound"))||void 0===e?void 0:e.getComponent("Sound")}},{key:"music",get:function(){var e;return null===(e=g("Music"))||void 0===e?void 0:e.getComponent("Music")}}],[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}},{key:"muteAudio",value:function(e){this.muteMusic(e),this.muteSound(e)}},{key:"muteSound",value:function(e){var t;null===(t=this.inst.sound)||void 0===t||t.mute(e)}},{key:"muteMusic",value:function(e){var t;null===(t=this.inst.music)||void 0===t||t.mute(e)}},{key:"getCurrentMusic",value:function(){return this.inst.currentMusic$}},{key:"turnUpMusic",value:(a=C((function*(){var e,t;(null!==(e=null===(t=this.inst.music)||void 0===t?void 0:t.getVolume())&&void 0!==e?e:0)>.6||(yield this.setVolumeMusic(.6,!0))})),function(){return a.apply(this,arguments)})},{key:"turnDownMusic",value:(i=C((function*(){var e,t;(null!==(e=null===(t=this.inst.music)||void 0===t?void 0:t.getVolume())&&void 0!==e?e:0)<.2||(yield this.setVolumeMusic(.2,!0))})),function(){return i.apply(this,arguments)})},{key:"turnOffMusic",value:(r=C((function*(){yield this.setVolumeMusic(0)})),function(){return r.apply(this,arguments)})},{key:"getVolumeMusic",value:function(){var e,t;return null!==(e=null===(t=this.inst.music)||void 0===t?void 0:t.getVolume())&&void 0!==e?e:0}},{key:"setVolumeMusic",value:(n=C((function*(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.inst.music){var r=this.inst.signalController$.renew();if(n){var i=this.inst.music.getVolume(),a=i;yield oe.runOnUpdateAsync(this.inst.music.node,1,(function(n){t.inst.music&&(a=i+(e-i)*n,t.inst.music.setVolume(a))}),r)}else{var o;null===(o=this.inst.music)||void 0===o||o.setVolume(e)}}})),function(e){return n.apply(this,arguments)})},{key:"playSound",value:(t=C((function*(e,t){var n;return null===(n=this.inst.sound)||void 0===n?void 0:n.play(e,t)})),function(e,n){return t.apply(this,arguments)})},{key:"pauseSound",value:function(e){var t;null===(t=this.inst.sound)||void 0===t||t.pause(e)}},{key:"resumeSound",value:function(e){var t;null===(t=this.inst.sound)||void 0===t||t.resume(e)}},{key:"stopSound",value:function(e){var t;null===(t=this.inst.sound)||void 0===t||t.stop(e)}},{key:"stopAllSounds",value:function(){var e;null===(e=this.inst.sound)||void 0===e||e.stopAll()}},{key:"playMusic",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.inst.music&&(this.inst.currentMusic$!==e&&this.pauseMusic(),this.inst.currentMusic$=e,!t&&this.inst.music.playing(e)||(t&&this.inst.music.stop(e),this.inst.music.play(e)))}},{key:"pauseMusic",value:function(){var e;null===(e=this.inst.music)||void 0===e||e.pause(this.inst.currentMusic$)}}]),e}()));t._RF.pop(),t._RF.push({},"358fdIqjFdNzZGa95REWt2F","Ads",void 0);var Ne=e("y",{MAX_BOTTOM_BANNER_RATIO:1/6,NUM_LEVEL_WITHOUT_BANNER_ADS:0});t._RF.pop(),t._RF.push({},"a0dcdDZxhZImZ8Cfg4Dc7SJ","ScreenUtils",void 0);var be=codex.event,we=Ludex,Ie=we.Events,Re=we.Utils.Array,Ce=e("S",function(e){O(n,e);var t=U(n);function n(){return k(this,n),t.apply(this,arguments)}return _(n)}(function(){function e(){k(this,e),this.showedScreens$=[]}var t,n,r;return _(e,null,[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}},{key:"preloadScreen",value:function(e){var t=he[e];t&&be.emit(Ie.PRELOAD_SCREEN,{screenName:t})}},{key:"preloadScreens",value:function(){be.emit(Ie.PRELOAD_SCREENS)}},{key:"openScreen",value:function(e,t){var n=he[e];return be.emit(Ie.OPEN_SCREEN,{screenName:n,screenData:t}),new Promise((function(e){be.on(Ie.OPENED_SCREEN,(function t(r){r.screenName===n&&(be.off(Ie.OPENED_SCREEN,t),e())}))}))}},{key:"closeScreen",value:function(e){var t=he[e];return be.emit(Ie.CLOSE_SCREEN,{screenName:t}),new Promise((function(e){be.on(Ie.CLOSED_SCREEN,(function n(r){r.screenName===t&&(be.off(Ie.CLOSED_SCREEN,n),e())}))}))}},{key:"openScreenAndWaitForClose",value:(r=C((function*(e,t){return yield this.openScreen(e,t),yield new Promise((function(t){be.on(Ie.CLOSE_SCREEN,(function n(r){r.screenName===he[e]&&(be.off(Ie.CLOSE_SCREEN,n),t(r))}))}))})),function(e,t){return r.apply(this,arguments)})},{key:"showLoadingScreen",value:function(e){return this.openScreen(ye.LOADING_SCREEN,{duration:e})}},{key:"closeLoadingScreen",value:function(){return this.closeScreen(ye.LOADING_SCREEN)}},{key:"showNotificationScreen",value:function(e,t){return this.openScreen(ye.NOTIFICATION_SCREEN,{message:e,duration:t})}},{key:"showNotificationScreenWithLocalizedKey",value:function(e,t){return this.openScreen(ye.NOTIFICATION_SCREEN,{localizedMessageKey:e,duration:t})}},{key:"closeNotificationScreen",value:function(){return this.closeScreen(ye.NOTIFICATION_SCREEN)}},{key:"addShowedScene",value:function(e){Re.has(this.inst.showedScreens$,e)||this.inst.showedScreens$.push(e)}},{key:"showLoadingFullScreen",value:(n=C((function*(e){if(!Re.has(this.inst.showedScreens$,e)){this.addShowedScene(e);var t=g("Loading");if(t){var n=t.getComponent("Loading");yield n.show(e)}}})),function(e){return n.apply(this,arguments)})},{key:"hideLoadingFullScreen",value:(t=C((function*(e){var t;if(!Re.has(this.inst.showedScreens$,e)){var n=null===(t=g("Loading"))||void 0===t?void 0:t.getComponent("Loading");yield null==n?void 0:n.hide(e)}})),function(e){return t.apply(this,arguments)})},{key:"showLoadingNotificationScreen",value:function(){return this.openScreen(ye.NOTIFICATION_SCREEN,{message:"Loading",enableCloseOnTouch:!1})}}]),e}()));t._RF.pop(),t._RF.push({},"4a4bfX6KIJCcIozlNHuAwoi","AdsUtils",void 0);var ke=Ludex,De=ke.Events,_e=ke.Configs,Le=_e.Ads.Enabled,Oe=_e.Gameplay.StartAdAtLevel,$e=ke.Plugins.Ads,Pe=void 0===$e?{}:$e,Fe=Pe.Types,Be=Pe.Status,xe=ke.Utils,Me=xe.Array,Ge=xe.Function,Ue=xe.Object,We=codex,He=We.ads,je=We.event,ze=We.player,Ke=function(e){O(n,e);var t=U(n);function n(e){return k(this,n),t.call(this,"AdsUtils.loadAdAsync: Timed out after ".concat(e,"ms"))}return _(n)}(x(Error)),Ve=e("s",function(e){O(r,e);var t,n=U(r);function r(){return k(this,r),n.apply(this,arguments)}return _(r,null,[{key:"preloadAds",value:(t=C((function*(){Fe&&(this.preloadAdsByType(Fe.INTERSTITIAL),this.preloadAdsByType(Fe.REWARDED_VIDEO))})),function(){return t.apply(this,arguments)})},{key:"applyRemoveAds",value:function(){if(Fe){var e=!this.isRemoveAdActive();this.setAdEnable(Fe.BANNER,e),this.setAdEnable(Fe.INTERSTITIAL,e),this.refreshBannerAdVisibility()}}},{key:"isRemoveAdActive",value:function(){var e=(ze.getGameData()||{}).removeAdEndTime;return!!e&&e>Date.now()}}]),r}(function(){function e(){var t=this;k(this,e),this.adsEnable$={},this.visibleBannerConfigs$=[],this.invisibleBannerConfigs$=[],this.updateBannerAdsConfigByLayout$=function(e){if(Fe){var n=h.getVisibleSize(),r=fe.worldSizeToCssSize(n.height*Ne.MAX_BOTTOM_BANNER_RATIO),i=e===se.Layout.Landscape,a=He.getAdsByType(Fe.BANNER).map((function(e){return e.config})).filter((function(e){var t=e.Position,n=e.BannerHeight;return!("bottom"===t&&n>r)}));t.visibleBannerConfigs$=a.filter((function(e){var t=e.Position;return i||"bottom"===t||"top"===t})),t.invisibleBannerConfigs$=a.filter((function(e){return!t.visibleBannerConfigs$.includes(e)}))}},this.getAdReady$=function(e,t){var n;if(!Be||!Ve.isAdEnabled(e))return null;if(t)return He.getAdStatus(e,t)===Be.FILLED?t:null;var r=He.getAdsByType(e).find((function(t){return He.getAdStatus(e,t.placementId)===Be.FILLED}));return null!==(n=null==r?void 0:r.placementId)&&void 0!==n?n:null},this.getPlacementIdByService$=function(e,t){var n;if(!t)return!1;if(!Fe)return!1;var r=He.getAdsByType(e),i=Me.search(r,(function(e){return e.config.AdService===t}));return null!==(n=null==i?void 0:i.placementId)&&void 0!==n&&n},this.getAdIdByPayload$=function(e,n){var r=n||{},i=r.adService,a=r.placementId;return t.getPlacementIdByService$(e,i)||a},this.getAdErrorMessage$=function(e,n){if(!Fe)return null;switch(e){case Fe.REWARDED_VIDEO:case Fe.REWARDED_INTERSTITIAL:return t.isUserCancelledAdError$(n)?"ads.cancelled":"error.noAd";default:return null}},this.showAdByType$=function(){var e=C((function*(e,n){if(!Fe||!Be)return!1;if(!Ve.isAdEnabled(e))return!1;var r=n||{},i=r.placementId,a=r.includeSDK,o=r.excludeSDK,u=r.forceLoad,s=r.autoLoad,l=r.adService,c=r.timeout,d=void 0===c?15e3:c,f=r.showError;if(!t.canShowInSDK$(a,o))return!1;var y=t.getAdIdByPayload$(e,n),h=!1,v=!1;try{Te.muteAudio(!0);var p=He.getAdStatus(e,i);for((u||s&&p!==Be.FILLED)&&(Ce.showLoadingScreen(),yield Ge.timeOut(He.loadAdAsync(e,y),d));!h;)try{var m=t.getAdReady$(e,y);if(!m)return!1;y=m,yield He.showAdAsync(e,y),h=!0}catch(e){if(l)throw e;if(t.isUserCancelledAdError$(e))throw e;if(t.isRequestAdTimeoutError$(e))throw e;y=void 0,h=!1,v=!0}return!0}catch(n){v=!0;var g=t.getAdErrorMessage$(e,n);return g&&f&&Ce.showNotificationScreenWithLocalizedKey(g,2),!1}finally{Te.muteAudio(!1),(u||s)&&Ce.closeLoadingScreen(),v&&(y=i),Ve.preloadAdsByType(e,y),je.emit(De.REQUEST_RESIZE_GAME)}}));return function(t,n){return e.apply(this,arguments)}}(),this.canShowInSDK$=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=GameSDK.getSDKName();return(null==t||!t.length||!Me.has(t,n))&&!(null!=e&&e.length&&!Me.has(e,n))},this.isUserCancelledAdError$=function(e){return Ue.hasOwn(e,"code")&&"USER_INPUT"===e.code},this.isRequestAdTimeoutError$=function(e){return e instanceof Ke||!(!Ue.hasOwn(e,"code")||"SHOW_ADS_TIMEOUT"!==e.code)}}var t,n,r,i;return _(e,null,[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}},{key:"setAdEnable",value:function(e,t){this.inst.adsEnable$[e]=t}},{key:"isAdEnabled",value:function(e){return!!Le&&!1!==this.inst.adsEnable$[e]}},{key:"preloadAds",value:(i=C((function*(){Fe&&(this.preloadAdsByType(Fe.INTERSTITIAL),this.preloadAdsByType(Fe.REWARDED_VIDEO),this.preloadAdsByType(Fe.REWARDED_INTERSTITIAL))})),function(){return i.apply(this,arguments)})},{key:"isServiceDegraded",value:function(){return He.isServiceDegraded()}},{key:"preloadAdsByType",value:function(e,t){if(this.isAdEnabled(e)&&Be){var n=He.getAdsByType(e);(t?n.filter((function(e){return e.placementId===t})):n).forEach((function(n){He.getAdStatus(e,n.placementId)!==Be.FILLED&&(He.getAdStatus(e,t)!==Be.FILLED&&He.loadAdAsync(e,n.placementId).catch((function(){})))}))}}},{key:"updateBannerAdsByLayout",value:function(e){this.inst.updateBannerAdsConfigByLayout$(e)}},{key:"refreshBannerAdVisibility",value:function(){if(Fe&&Be)if(this.isAdEnabled(Fe.BANNER)){var e,t=V(this.inst.invisibleBannerConfigs$);try{for(t.s();!(e=t.n()).done;){var n=e.value.PlacementId;He.getAdStatus(Fe.BANNER,n)===Be.SHOWING&&this.hideBannerAd(n)}}catch(e){t.e(e)}finally{t.f()}var r,i=V(this.inst.visibleBannerConfigs$);try{for(i.s();!(r=i.n()).done;){var a=r.value.PlacementId,o=He.getAdStatus(Fe.BANNER,a);!1!==o&&o!==Be.SHOWING&&this.showBannerAd(a)}}catch(e){i.e(e)}finally{i.f()}}else this.hideBannerAds()}},{key:"getBannerAdHeight",value:function(){try{if(!Fe)return 0;var e=fe.cssSizeToWorldSize(1),t=He.getAd(Fe.BANNER);return Math.round(He.getBannerHeight(t.placementId,e))}catch(e){return console.warn("[AdsUtils] getBannerAdHeight error:",e),0}}},{key:"showBannerAds",value:function(){if(Fe&&Be&&this.isAdEnabled(Fe.BANNER)){var e,t=V(He.getAdsByType(Fe.BANNER));try{for(t.s();!(e=t.n()).done;){var n=e.value;He.getAdStatus(Fe.BANNER,n.placementId)!==Be.IDLE&&this.showBannerAd(n.placementId)}}catch(e){t.e(e)}finally{t.f()}}}},{key:"hideBannerAds",value:function(){if(Le&&Fe&&Be){var e,t=V(He.getAdsByType(Fe.BANNER));try{for(t.s();!(e=t.n()).done;){var n=e.value;He.getAdStatus(Fe.BANNER,n.placementId)!==Be.IDLE&&this.hideBannerAd(n.placementId)}}catch(e){t.e(e)}finally{t.f()}}}},{key:"showBannerAd",value:function(e){Fe&&this.isAdEnabled(Fe.BANNER)&&He.showBannerAdAsync(e).catch((function(){}))}},{key:"hideBannerAd",value:function(e){Le&&He.hideBannerAdAsync(e).catch((function(){}))}},{key:"isReadyAdShowable",value:function(e,t){var n=this.inst.getAdReady$(e,t);return!!n&&He.canShowAd(e,n)}},{key:"isBannerAdShowing",value:function(){if(!Fe||!Be)return!1;var e,t=V(He.getAdsByType(Fe.BANNER));try{for(t.s();!(e=t.n()).done;){var n=e.value;if(He.getAdStatus(Fe.BANNER,n.placementId)===Be.SHOWING)return!0}}catch(e){t.e(e)}finally{t.f()}return!1}},{key:"showInterstitialAdAsync",value:(r=C((function*(e){if(!Fe)return!1;var t,n,r=null!=e?e:{},i=r.forLevel,a=r.contextType,o=r.forceLoad;if(i&&Oe>=i)return!1;a&&(null===(t=window.GoogleAds)||void 0===t||t.setInterstitialType(a),null===(n=window.TranssionH5Ads)||void 0===n||n.setInterstitialType(a));var u=GameSDK.isGameSDK("MsGames");return this.inst.showAdByType$(Fe.INTERSTITIAL,w(w({},e),{},{forceLoad:o||u}))})),function(e){return r.apply(this,arguments)})},{key:"showRewardVideoAdAsync",value:(n=C((function*(e){if(!Fe)return!1;var t,n,r=(null!=e?e:{}).contextType;return r&&(null===(t=window.GoogleAds)||void 0===t||t.setRewardType(r),null===(n=window.TranssionH5Ads)||void 0===n||n.setRewardType(r)),this.inst.showAdByType$(Fe.REWARDED_VIDEO,w(w({showError:!0},e),{},{autoLoad:!0}))})),function(e){return n.apply(this,arguments)})},{key:"showRewardedInterstitialAdAsync",value:(t=C((function*(e){if(!Fe)return!1;var t,n,r=(null!=e?e:{}).contextType;return r&&(null===(t=window.GoogleAds)||void 0===t||t.setRewardType(r),null===(n=window.TranssionH5Ads)||void 0===n||n.setRewardType(r)),this.inst.showAdByType$(Fe.REWARDED_INTERSTITIAL,w(w({showError:!0},e),{},{autoLoad:!0}))})),function(e){return t.apply(this,arguments)})}]),e}()));t._RF.pop(),t._RF.push({},"f8533KH/fxOfYqya9sgLrSj","GameData",void 0);var Ye,qe=e("D",{level:0,coins:0,bestEndlessScore:0,firstLoginTime:0,removeAdEndTime:0,lastCreateTournamentShown:0,tournamentProgress:{}});t._RF.pop(),t._RF.push({},"3b9bcPJBxpNOqG2I6exTOVn","MatchCustomData",void 0);var Je=Ludex.Dtos.Match,Ze=(void 0===Je?{}:Je).CustomData,Xe=null!==(Ye=null==Ze?void 0:Ze.getDefaults())&&void 0!==Ye?Ye:{};e("M",w(w({},Xe),{},{score:0,challengeData:null}));t._RF.pop(),t._RF.push({},"074c4KXFZ1Pq6d+66PrLd2+","PlayerData",void 0);e("P",{score:0,settings:{sound:!0,music:!0,vibrate:!0,language:"en"},gameData:qe,isFirstLogin:!0,dailyRewardedData:{logDays:[],firstReward:0,lastReward:0},lastCallSwitchGame:0,notificationData:{},missionsData:{process:{}}});t._RF.pop(),t._RF.push({},"ff436w8KphN2o+jnnVL3RYx","SceneKeys",void 0);var Qe=e("x",{TEST_SCENE:"TestScene",BOOT_SCENE:"BootScene",DASHBOARD_SCENE:"DashboardScene",GAME_SCENE:"GameScene",ENDLESS_SCENE:"EndlessScene",DRAFT_SCENE:"DraftScene",PLAYABLE_SCENE:"PlayableScene",TEST_LAYOUT_SCENE:"TestLayoutScene",TEST_PERFORMANCE_SCENE:"TestPerformanceScene",TEST_PARTICLE_SYSTEM_SCENE:"TestParticleSystemScene"});t._RF.pop(),t._RF.push({},"58f4330KXRL77xyoA3903MY","WasmUtils",void 0);var et=Ludex.Utils.Function,tt=e("W",function(e){O(n,e);var t=U(n);function n(){return k(this,n),t.apply(this,arguments)}return _(n)}(function(){function e(){k(this,e),this.mutex$=et.mutex()}var t;return _(e,null,[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}},{key:"loadModuleAsync",value:(t=C((function*(e){var t=yield this.inst.mutex$.use("module-wasm-".concat(e));try{switch(e){case"spine":if("function"!=typeof T)return;yield T();break;case"box2d":if("function"!=typeof A)return;yield A();break;case"physx":if("function"!=typeof E)return;yield E();break;case"bullet":if("function"!=typeof S)return;yield S()}}finally{t.release()}})),function(e){return t.apply(this,arguments)})}]),e}()));t._RF.pop(),t._RF.push({},"97ca9J9nzNCeIjC1l+ZT/Hm","SceneUtils",void 0);var nt=codex.event,rt=Ludex.Events;e("w",function(e){O(i,e);var t,n,r=U(i);function i(){return k(this,i),r.apply(this,arguments)}return _(i,null,[{key:"preloadDashboardScene",value:function(){this.preloadScene(Qe.DASHBOARD_SCENE)}},{key:"switchToDashboardScene",value:function(e){this.switchScene(Qe.DASHBOARD_SCENE,e)}},{key:"preloadGameScene",value:(n=C((function*(){yield tt.loadModuleAsync("spine"),this.preloadScene(Qe.GAME_SCENE)})),function(){return n.apply(this,arguments)})},{key:"switchToGameScene",value:(t=C((function*(e){Te.stopAllSounds(),Te.turnOffMusic(),yield tt.loadModuleAsync("spine"),this.switchScene(Qe.GAME_SCENE,e)})),function(e){return t.apply(this,arguments)})},{key:"switchToEndlessScene",value:function(e){Te.stopAllSounds(),Te.turnOffMusic(),this.switchScene(Qe.ENDLESS_SCENE,e)}}]),i}(function(){function e(){k(this,e),this.loadedScenes$={}}return _(e,null,[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}},{key:"switchScene",value:function(e,t){nt.emit(rt.SWITCH_SCENE,{sceneName:e,sceneData:t})}},{key:"preloadScene",value:function(e){nt.emit(rt.PRELOAD_SCENE,{sceneName:e})}},{key:"isSceneLoaded",value:function(e){var t;return null!==(t=this.inst.loadedScenes$[e])&&void 0!==t&&t}},{key:"markIsSceneLoaded",value:function(e){this.inst.loadedScenes$[e]=!0}},{key:"markIsTestScene",value:function(e){nt.emit(rt.MARK_IS_TEST_SCENE,{sceneName:e})}},{key:"getSceneData",value:function(e){return"data"in e.scene&&e.scene.data||{}}}]),e}()));t._RF.pop(),t._RF.push({},"669a1OtNF9EDrMRLWTjxk4B","GeneralUtils",void 0);e("J",function(e){O(n,e);var t=U(n);function n(){return k(this,n),t.apply(this,arguments)}return _(n)}(function(){function e(){k(this,e)}return _(e,null,[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}},{key:"setBlockInput",value:function(e){var t=g("Canvas/InputBlocker");t&&(t.active=e)}},{key:"getBlockInput",value:function(){var e=g("Canvas/InputBlocker");return!!e&&e.active}}]),e}()));t._RF.pop(),t._RF.push({},"ed5c6D+6KVEj5lrgtq+D9bJ","LayoutUtils",void 0);var it,at=se.Layout;e("B",function(e){O(n,e);var t=U(n);function n(){return k(this,n),t.apply(this,arguments)}return _(n)}(function(){function e(){var t=this;k(this,e),this.isListening$=!1,this.currentLayout$=at.Portrait,this.onLayoutChanged$=function(e){t.currentLayout$!==e&&(t.currentLayout$=e,N.emit(ue.ORIENTATION_CHANGED,e))}}return _(e,null,[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}},{key:"listenLayoutChanges",value:function(){this.inst.isListening$||(this.inst.isListening$=!0,N.on(ue.LAYOUT_CHANGED,this.inst.onLayoutChanged$))}},{key:"getCurrentLayout",value:function(){return this.inst.currentLayout$}},{key:"isPortrait",value:function(){return this.inst.currentLayout$===at.Portrait}},{key:"isLandscape",value:function(){return this.inst.currentLayout$===at.Landscape}},{key:"getScreenRatio",value:function(){return fe.getScreenWidthCss()/fe.getScreenHeightCss()}}]),e}()));t._RF.pop(),t._RF.push({},"58eae10lp9GX4EnVB/hLwAg","LoaderUtils",void 0);var ot=codex,ut=ot.event,st=ot.match,lt=ot.player,ct=ot.context,dt=e("K",function(e){O(n,e);var t=U(n);function n(){return k(this,n),t.apply(this,arguments)}return _(n,null,[{key:"applyCustomFlows",value:function(){var e=this;ct.configureFlows((function(t){t.addBefore("ChallengeFromPostFlow",e.createNewUserChallengeFriendToSingleFlow$(t)),t.addBefore("ChallengeFromPostFlow",e.createStartSingleFromShareInviteContextFlow$(t)),t.addBefore("ChallengeFromMessageFlow",e.createFastChallengeFromMessageFlow$(t))}))}}]),n}(function(){function e(){k(this,e)}return _(e,null,[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}}]),e}()));it=dt,dt.createNewUserChallengeFriendToSingleFlow$=function(e){var t=ct.getSessionContextTypes().CHALLENGE_FRIEND;return{id:"NewUserChallengeFriendToSingleFlow",when:function(e){var n=e.contextSessionType;return!!e.isFirstSession&&n===t},do:e.createSteps([it.createNewUserSingleModeStep$(),it.createSwitchSceneStep$()])}},dt.createStartSingleFromShareInviteContextFlow$=function(e){var t=ct.getSessionContextTypes().CHALLENGE_FRIEND;return{id:"StartSingleFromChallengeContextFlow",when:function(e){var n=e.contextSessionType;return!e.isFirstSession&&(n===t&&null!==it.extractLevel$(e.contextData))},do:e.createSteps([it.createStartSingleMode$(),it.createSwitchSceneStep$()])}},dt.createFastChallengeFromMessageFlow$=function(e){var t=ct.getSessionContextTypes().CHALLENGE_FRIEND;return{id:"FastChallengeFromMessageFlow",when:function(e){var n=e.contextData,r=n.matchId,i=n.playerId,a=n.opponentId,o=e.contextSessionType;return!e.isFirstSession&&("string"==typeof r&&("string"==typeof i&&("string"==typeof a&&(o===t&&null!==it.extractLevel$(e.contextData)))))},do:e.createSteps([it.createPrepareChallengeLevelStep$()])}},dt.createSwitchSceneStep$=function(){return{id:"SwitchScene",runAsync:(e=C((function*(e){var t=e.sceneName;return!t||(ut.emit(Ludex.Events.SWITCH_SCENE,{sceneName:t,sceneData:{isFromLoader:!0}}),!1)})),function(t){return e.apply(this,arguments)})};var e},dt.createNewUserSingleModeStep$=function(){return{id:"NewUserSingleMode",runAsync:(e=C((function*(e){var t=lt.getPlayerId();return yield st.handler.setMatchCustomData({playerId:t,contextId:"SOLO"}),yield st.single.start.processAsync({playerId:t}),e.sceneName=Qe.GAME_SCENE,!0})),function(t){return e.apply(this,arguments)})};var e},dt.createPrepareChallengeLevelStep$=function(){return{id:"PrepareChallengeLevelFromMessage",runAsync:(e=C((function*(e){var t=it.extractLevel$(e.contextData);return"number"!=typeof t||(yield st.handler.setMatchCustomData({level:t})),!0})),function(t){return e.apply(this,arguments)})};var e},dt.createStartSingleMode$=function(){return{id:"StartSingleMode",runAsync:(e=C((function*(e){var t=it.extractLevel$(e.contextData);if("number"!=typeof t)return!0;var n=lt.getPlayerId();return yield st.handler.setMatchCustomData({level:t}),yield st.single.start.processAsync({playerId:n}),e.sceneName=Qe.GAME_SCENE,!0})),function(t){return e.apply(this,arguments)})};var e},dt.extractLevel$=function(e){var t=e.level;return"number"==typeof t?t:null},t._RF.pop(),t._RF.push({},"d6fb7/+FFxLs7k5w6K38JYb","TournamentUtils",void 0);var ft=Ludex,yt=ft.Utils,ht=yt.String,vt=yt.Valid,pt=yt.Array,mt=ft.Configs.Mockup.Leaderboards,gt=codex.language,St=codex,Et=St.leaderboard,At=St.player;e("T",function(e){O(r,e);var t,n=U(r);function r(){return k(this,r),n.apply(this,arguments)}return _(r,[{key:"processPlayerTournamentData",value:function(){var e,t=[],n=V(this.playerTournaments$);try{for(n.s();!(e=n.n()).done;){var r,i,a=e.value,o="".concat(a.getID()),u=a.getContextID(),s=a.getEndTime(),l=this.parseTournamentPayload(a.getPayload());if(this.validateGameSDKTournamentPayload(l))if(!(s<Date.now()/1e3)){var c=a.getTournamentType();if("PAGE_HOSTED"!==c){var d=null!==(r=l.playerName)&&void 0!==r?r:"Player",f={id:o,title:null!==(i=a.getTitle())&&void 0!==i?i:this.createDefaultTournamentName(d),endTime:s,contextId:u,payload:l,tournamentType:c};t.push(f)}}}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"processGlobalTournamentLeaderboardData",value:function(){var e=[];if(mt.Enabled){var t,n=V(this.playerTournaments$);try{for(n.s();!(t=n.n()).done;){var r,i=t.value,a=i.getTournamentType();if("PAGE_HOSTED"===a){var o="".concat(i.getID()),u=i.getContextID(),s=i.getEndTime(),l=this.parseTournamentPayload(i.getPayload()),c={id:o,title:null!==(r=i.getTitle())&&void 0!==r?r:"Global Tournament",endTime:s,contextId:u,payload:l,tournamentType:a};e.push(c)}}}catch(e){n.e(e)}finally{n.f()}return e}var d,f=V(this.globalTournamentLBData$);try{for(f.s();!(d=f.n()).done;){var y,h,v=d.value,p=void 0;try{p=JSON.parse(v.description)}catch(e){continue}if(this.validateExpireTime(v)&&this.validateGlobalTournamentPayload(p)){var m="isNEZP"in GameSDK.extra&&GameSDK.extra.isNEZP(),g="isRestricted"in GameSDK.extra&&GameSDK.extra.isRestricted();if(m||g){if(!p.restrict)continue}else if(p.restrict)continue;var S=null!==(y=null===(h=p.i18n)||void 0===h||null===(h=h[gt.getCurrentLocale()])||void 0===h?void 0:h.title)&&void 0!==y?y:v.name,E={id:p.tournamentId,title:S,endTime:this.getTournamentEndTime(v),contextId:p.contextId,payload:{playerId:"global",playerName:"global",leaderboardId:v._id},tournamentType:"PAGE_HOSTED"};e.push(E)}}}catch(e){f.e(e)}finally{f.f()}return e}},{key:"createDefaultTournamentName",value:function(e){var t=e.substring(0,7),n="".concat(t.split(" ")[0]||t,"'s Tournament"),r=ht.removeDiacritics(n);return"".concat(r)}}],[{key:"requestTournamentDataAsync",value:(t=C((function*(){var e=this.inst;yield Promise.all([e.fetchTournamentsAsync$(),e.fetchGlobalTournamentLeaderboardAsync$()]);var t=e.processPlayerTournamentData(),n=e.processGlobalTournamentLeaderboardData();t.sort((function(e,t){return e.endTime-t.endTime})),n.sort((function(e,t){return e.endTime-t.endTime})),e.tournamentData$=[].concat(j(n),j(t));var r,i=V(e.tournamentData$);try{for(i.s();!(r=i.n()).done;){var a=r.value.payload.leaderboardId;a&&(Et.isExistLeaderboardId(a)||Et.addLeaderboard({type:"tournament",name:a,autoSortRank:!0,leaderboardId:a}))}}catch(e){i.e(e)}finally{i.f()}return e.tournamentData$})),function(){return t.apply(this,arguments)})},{key:"saveTournamentProgress",value:function(e,t,n){var r,i,a,o,u=(null!==(r=At.getGameData())&&void 0!==r?r:{}).tournamentProgress,s=null==u?void 0:u[n],l={level:Math.max(e,null!==(i=null==s?void 0:s.level)&&void 0!==i?i:0),score:Math.max(t,null!==(a=null==s?void 0:s.score)&&void 0!==a?a:0),replayCount:null!==(o=null==s?void 0:s.replayCount)&&void 0!==o?o:0};At.setGameData({tournamentProgress:w(w({},u),{},L({},n,l))})}},{key:"syncTournamentProgress",value:function(){var e,t=(null!==(e=At.getGameData())&&void 0!==e?e:{}).tournamentProgress;if(t){var n=this.inst,r=function(e){pt.search(n.tournamentData$,(function(t){return t.id===e}))||delete t[e]};for(var i in t)r(i);At.setGameData({tournamentProgress:t})}}}]),r}(function(){function e(){var t=this;k(this,e),this.globalTournamentLBData$=[],this.playerTournaments$=[],this.tournamentData$=[],this.maxTimeRefetch$=5e3,this.lastFetchTournamentsData$=0,this.lastFetchGlobalTournament$=0,this.fetchGlobalTournamentLeaderboardAsync$=C((function*(){try{Date.now()-t.lastFetchGlobalTournament$>t.maxTimeRefetch$&&(t.globalTournamentLBData$=yield Et.requestLeaderboardsAsync({limit:100,type:"world_tournament_leaderboard"}),t.globalTournamentLBData$.sort((function(e,t){return e.expireTime-t.expireTime})))}catch(e){console.warn("fetchGlobalTournamentLeaderboardAsync",e)}return t.globalTournamentLBData$})),this.fetchTournamentsAsync$=C((function*(){try{Date.now()-t.lastFetchTournamentsData$>t.maxTimeRefetch$&&(t.playerTournaments$=yield GameSDK.tournament.getTournamentsAsync(),t.playerTournaments$.sort((function(e,t){return e.getEndTime()-t.getEndTime()})))}catch(e){console.warn("fetchTournamentsAsync",e)}return t.playerTournaments$}))}return _(e,[{key:"validateGlobalTournamentPayload",value:function(e){var t=e.tournamentId,n=e.contextId;return!(!vt.isString(t)||""===t)&&!(!vt.isString(n)||""===n)}},{key:"getTournamentEndTime",value:function(e){var t=new Date(e.createdAt).getTime();return Math.round((1e3*e.expireTime+t)/1e3)}},{key:"validateExpireTime",value:function(e){return 1e3*this.getTournamentEndTime(e)-Date.now()>0}},{key:"validateGameSDKTournamentPayload",value:function(e){return!(!vt.isString(e.playerId)||""===e.playerId)&&(!(!vt.isString(e.playerName)||""===e.playerName)&&!(!vt.isString(e.leaderboardId)||""===e.leaderboardId))}},{key:"parseTournamentPayload",value:function(e){if("string"!=typeof e)return{};try{return JSON.parse(e)}catch(e){return{}}}}],[{key:"inst",get:function(){return this.inst$||(this.inst$=new this),this.inst$}},{key:"getAllTournamentData",value:function(){return this.inst.tournamentData$}},{key:"getTournamentDataById",value:function(e){var t=this.inst;return pt.search(t.tournamentData$,(function(t){return t.id===e}))}},{key:"getPlayerTournamentData",value:function(){var e=this.inst,t=At.getPlayerId();return e.tournamentData$.filter((function(e){return e.payload.playerId===t}))}},{key:"getFriendsTournamentData",value:function(){var e=this.inst,t=At.getPlayerId();return e.tournamentData$.filter((function(e){var n=e.payload;return n.playerId!==t&&"global"!==n.playerId}))}},{key:"getGlobalTournamentData",value:function(){return this.inst.tournamentData$.filter((function(e){return"global"===e.payload.playerId}))}},{key:"validateTournamentExpired",value:function(e){var t=this.getTournamentDataById(e);return!!t&&t.endTime<Date.now()/1e3}}]),e}()));t._RF.pop()}}}));

} }; });