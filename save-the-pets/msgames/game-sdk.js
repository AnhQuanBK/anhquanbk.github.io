function _array_like_to_array(e,t){if(null==t||t>e.length)t=e.length;for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _array_without_holes(e){if(Array.isArray(e))return _array_like_to_array(e)}function _assert_this_initialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function asyncGeneratorStep(e,t,n,r,a,o,s){try{var u=e[o](s);var l=u.value}catch(e){n(e);return}if(u.done)t(l);else Promise.resolve(l).then(r,a)}function _async_to_generator(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function _next(e){asyncGeneratorStep(o,r,a,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(o,r,a,_next,_throw,"throw",e)}_next(void 0)})}}function _call_super(e,t,n){t=_get_prototype_of(t);return _possible_constructor_return(e,_is_native_reflect_construct()?Reflect.construct(t,n||[],_get_prototype_of(e).constructor):t.apply(e,n))}function _class_call_check(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _construct(){_construct=_is_native_reflect_construct()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=Function.bind.apply(e,r);var o=new a;if(n)_set_prototype_of(o,n.prototype);return o};return _construct.apply(null,arguments)}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}function _create_class(e,t,n){if(t)_defineProperties(e.prototype,t);if(n)_defineProperties(e,n);return e}function _define_property(e,t,n){if(t in e)Object.defineProperty(e,t,{value:n,enumerable:true,configurable:true,writable:true});else e[t]=n;return e}function _get(e,t,n){_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=_super_prop_base(e,t);if(!r)return;var a=Object.getOwnPropertyDescriptor(r,t);if(a.get)return a.get.call(n||e);return a.value};return _get(e,t,n||e)}function _get_prototype_of(e){_get_prototype_of=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)};return _get_prototype_of(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});if(t)_set_prototype_of(e,t)}function _instanceof(e,t){if(null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance])return!!t[Symbol.hasInstance](e);return e instanceof t}function _is_native_function(e){return -1!==Function.toString.call(e).indexOf("[native code]")}function _iterable_to_array(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _non_iterable_spread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _object_spread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};var r=Object.keys(n);if("function"==typeof Object.getOwnPropertySymbols)r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}));r.forEach(function(t){_define_property(e,t,n[t])})}return e}function _possible_constructor_return(e,t){if(t&&("object"===_type_of(t)||"function"==typeof t))return t;return _assert_this_initialized(e)}function _set_prototype_of(e,t){_set_prototype_of=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return _set_prototype_of(e,t)}function _super_prop_base(e,t){while(!Object.prototype.hasOwnProperty.call(e,t)){e=_get_prototype_of(e);if(null===e)break}return e}function _to_consumable_array(e){return _array_without_holes(e)||_iterable_to_array(e)||_unsupported_iterable_to_array(e)||_non_iterable_spread()}function _type_of(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function _unsupported_iterable_to_array(e,t){if(!e)return;if("string"==typeof e)return _array_like_to_array(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor)n=e.constructor.name;if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _array_like_to_array(e,t)}function _wrap_native_super(e){var t="function"==typeof Map?new Map:void 0;_wrap_native_super=function(e){if(null===e||!_is_native_function(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,Wrapper)}function Wrapper(){return _construct(e,arguments,_get_prototype_of(this).constructor)}Wrapper.prototype=Object.create(e.prototype,{constructor:{value:Wrapper,enumerable:false,writable:true,configurable:true}});return _set_prototype_of(Wrapper,e)};return _wrap_native_super(e)}function _is_native_reflect_construct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_is_native_reflect_construct=function(){return!!e})()}function _ts_generator(e,t){var n,r,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function verb(e){return function(t){return step([e,t])}}function step(o){if(n)throw new TypeError("Generator is already executing.");while(s)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;if(r=0,a)o=[2&o[0],a.value];switch(o[0]){case 0:case 1:a=o;break;case 4:s.label++;return{value:o[1],done:false};case 5:s.label++;r=o[1];o=[0];continue;case 7:o=s.ops.pop();s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1];a=o;break}if(a&&s.label<a[2]){s.label=a[2];s.ops.push(o);break}if(a[2])s.ops.pop();s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e];r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:true}}}(function(){"use strict";var e=Object.defineProperty;var Rt=function(t,n,r){return n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r};var f=function(e,t){return function(){return e&&(t=e(e=0)),t}};var S=function(t,n){for(var r in n)e(t,r,{get:n[r],enumerable:!0})};var i=function(e,t,n){return Rt(e,(void 0===t?"undefined":_type_of(t))!="symbol"?t+"":t,n)};var t,n=f(function(){t={AllowWithoutSDK:!0,MSGames:{UseLoginFeature:!1,ScheduleNotification:{D1:"The dogs are in danger! Draw quick and keep them safe from the bees. \uD83D\uDC1D\uD83D\uDC36",D2:"The pets need your help! Protect them from today's hazards. Can you do it? \uD83D\uDCAA\uD83D\uDC15",D3:"Buzz buzz! Bees are back. Can you outsmart them and save the dogs? \uD83D\uDC3Eâœ¨",D4:"Get ready to draw your best defenses! The dogs are counting on you. \uD83D\uDC15\uD83D\uDEA8",D5:"The danger is real! Hurry up, the bees are closing in on the pets. \uD83D\uDC1D\uD83D\uDD25",D6:"The dogs are waiting for their hero! Can you keep them safe from harm? \uD83C\uDFAE\uD83D\uDC15",D7:"Your furry friends need you now! Join the game and save the day. \uD83C\uDFC6\uD83D\uDC3E"}},Yandex:{UseLoginFeature:!1}}});var r=f(function(){});var a={};S(a,{default:function(){return o}});var o,s=f(function(){"use strict";n();r();o={}});var u,l,d,h,_=f(function(){"use strict";n();r();u='\n<div id="async-popup">\n    <div id="title"></div>\n    <div id="content"></div>\n    <div class="buttons">\n        <button id="ok"></button>\n        <button id="no"></button>\n    </div>\n</div>',l="\n#async-popup {\n    width: 100%;\n    height: 100%;\n    color: #fff;\n    display: flex;\n    position: absolute;\n    flex-direction: column;\n    justify-content: space-evenly;\n    background: #202020;\n    font-family: sans-serif;\n    border-radius: 20px;\n    align-items: center;\n    padding: 20px\n}\n\n#async-popup #title {\n    font-size: 2rem;\n    font-weight: bold;\n    margin-bottom: 1rem;\n}\n\n#async-popup #content {\n    display: flex;\n    text-align: center;\n    text-wrap: balance;\n    font-size: large;\n}\n\n#async-popup .buttons {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: space-evenly;\n}\n\n#async-popup .buttons button {\n    margin: 0.5rem;\n    padding: 0.5rem 1rem;\n    font-size: 1.5rem;\n    font-weight: bold;\n    border-radius: 0.5rem;\n    border: none;\n    cursor: pointer;\n}",d=/*#__PURE__*/function(){function B(){var e=this;_class_call_check(this,B);i(this,"popup");i(this,"title");i(this,"content");i(this,"okButton");i(this,"noButton");i(this,"okCallback");i(this,"noCallback");i(this,"onYes",function(t){e.okButton.removeEventListener("click",e.okCallback),e.okCallback=e.handleCallback(t),e.okButton.addEventListener("click",e.okCallback,{once:!0})});i(this,"onNo",function(t){e.noButton.removeEventListener("click",e.noCallback),e.noCallback=e.handleCallback(t),e.noButton.addEventListener("click",e.noCallback,{once:!0})});i(this,"handleCallback",function(t){return function(n){n.stopImmediatePropagation(),e.hide(),t()}});this.createPopupElement(),this.addPopupElementStyle();var t=new MutationObserver(function(){document.getElementById("GameDiv")&&e.setupPopupElementSizeAndPosition()}),n={attributes:!0,childList:!0,subtree:!0},r=document.body;t.observe(r,n)}_create_class(B,[{key:"createPopupElement",value:function(){var e=document.createElement("div");e.id=this.constructor.name,e.innerHTML=u,e.style.width="100%",e.style.height="100%",e.style.position="absolute",e.style.backgroundColor="#0000001f",document.body.appendChild(e),this.popup=e,this.popup.style.display="none",this.title=e.querySelector("#title"),this.content=e.querySelector("#content"),this.okButton=e.querySelector("#ok"),this.noButton=e.querySelector("#no")}},{key:"addPopupElementStyle",value:function(){var e=document.createElement("style");(document.head||document.getElementsByTagName("head")[0]).appendChild(e),e.appendChild(document.createTextNode(l))}},{key:"setupPopupElementSizeAndPosition",value:function(){var e=document.getElementById(this.constructor.name);if(!e)return;var t=e.querySelector("#async-popup");if(!t||!document.getElementById("GameDiv"))return;var n=350,r=250,a=t;a.style.width="".concat(n,"px"),a.style.height="".concat(r,"px");var o=document.body.getBoundingClientRect(),s=o.width,u=o.height;a.style.left="".concat((s-n)/2,"px"),a.style.top="".concat((u-r)/2,"px")}},{key:"show",value:function(e){this.content.textContent="".concat(e),this.popup.style.display="flex"}},{key:"hide",value:function(){this.popup.style.display="none"}}]);return B}(),h=d});var v={};S(v,{default:function(){return m}});var g,m,b=f(function(){"use strict";n();r();_();g=/*#__PURE__*/function(e){_inherits(U,e);function U(){_class_call_check(this,U);return _call_super(this,U,arguments)}_create_class(U,[{key:"show",value:function(e){this.title.textContent="Switch Context",this.okButton.textContent="Switch",this.noButton.textContent="Cancel",_get(_get_prototype_of(U.prototype),"show",this).call(this,"Do you want to switch context?\nContext ID: ".concat(e))}}]);return U}(h),m=g});var k={};S(k,{default:function(){return P}});var x,P,A=f(function(){"use strict";n();r();_();x=/*#__PURE__*/function(e){_inherits(R,e);function R(){_class_call_check(this,R);return _call_super(this,R,arguments)}_create_class(R,[{key:"show",value:function(){this.title.textContent="Choose Contexts",this.okButton.textContent="Choose",this.noButton.textContent="Cancel",_get(_get_prototype_of(R.prototype),"show",this).call(this,"Do you want to switch context?\n            This will choose random a friend or tournament to play with.")}}]);return R}(h),P=x});var D={};S(D,{default:function(){return T}});var C,T,E=f(function(){"use strict";n();r();_();C=/*#__PURE__*/function(e){_inherits(j,e);function j(){_class_call_check(this,j);return _call_super(this,j,arguments)}_create_class(j,[{key:"show",value:function(e){this.title.textContent="Create Context",this.okButton.textContent="Create",this.noButton.textContent="Cancel",_get(_get_prototype_of(j.prototype),"show",this).call(this,"Do you want to create context?\nPlayer ID: ".concat(e))}}]);return j}(h),T=C});var O={};S(O,{default:function(){return M}});var N,L,M,F=f(function(){"use strict";n();r();N="MockConnectedPlayers",L=/*#__PURE__*/function(){function z(e){_class_call_check(this,z);i(this,"extra");this.extra=e}_create_class(z,[{key:"getConnectedPlayersAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o,s;return _ts_generator(this,function(u){switch(u.label){case 0:t=GameCore.Configs,n=t.Mockup,r=n.GameSDK.Player.ConnectedPlayers,a=r.ErrorRate,o=r.NumOfPlayers,s=r.RandomDelayMs;e.randomExceptionError("getConnectedPlayersAsync",a)&&e.extra.exceptionNetworkFailure("Get connected players error");return[4,e.extra.awaitRandomDelay(s)];case 1:return[2,(u.sent(),e.createPlayers(o))]}})})()}},{key:"createPlayers",value:function(e){var t=GameCore.Configs,n=t.Mockup,r=n.GameSDK.Player.ConnectedPlayers,a=r.AvatarUrl,o=this.loadLocalStorage();if(o||(o=[],this.saveLocalStorage(o)),o.length!==e){var _loop=function(e){var t="connected-player-".concat(e),n={getID:function(){return t},getName:function(){return"Connected Player ".concat(e)},getPhoto:function(){return a.replace("%1",t)}};o.push(n)};for(var s=o.length;s<e;s++)_loop(s);this.saveLocalStorage(o)}return this.loadLocalStorage()}},{key:"loadLocalStorage",value:function(){var e=GameCore.Utils,t=e.Browser,n=e.Object,r=t.getLocalStorage(N);if(!r)return[];var a=n.vals(r);if(!Array.isArray(a))return[];var o=[];var s=true,u=false,l=void 0;try{var _loop=function(){var e=h.value;o.push({getID:function(){return e.id},getName:function(){return e.name},getPhoto:function(){return e.photo}})};for(var d=a[Symbol.iterator](),h;!(s=(h=d.next()).done);s=true)_loop()}catch(e){u=true;l=e}finally{try{if(!s&&null!=d.return)d.return()}finally{if(u)throw l}}return o}},{key:"saveLocalStorage",value:function(e){var t=GameCore.Utils,n=t.Browser,r=[];var a=true,o=false,s=void 0;try{for(var u=e[Symbol.iterator](),l;!(a=(l=u.next()).done);a=true){var d=l.value;var h,_;var v={id:d.getID()||"",name:null!==(h=d.getName())&&void 0!==h?h:"",photo:null!==(_=d.getPhoto())&&void 0!==_?_:""};r.push(v)}}catch(e){o=true;s=e}finally{try{if(!a&&null!=u.return)u.return()}finally{if(o)throw s}}var g=_object_spread({},r);n.writeLocalStorage(N,g)}},{key:"randomExceptionError",value:function(e,t){return 100*Math.random()<t}}]);return z}(),M=L});var X={};S(X,{default:function(){return en}});var ee,en,er=f(function(){"use strict";n();r();_();ee=/*#__PURE__*/function(e){_inherits(Q,e);function Q(){_class_call_check(this,Q);return _call_super(this,Q,arguments)}_create_class(Q,[{key:"show",value:function(e){this.title.textContent="Create Tournament",this.okButton.textContent="Create",this.noButton.textContent="Cancel";var t=JSON.stringify(e,null,2);_get(_get_prototype_of(Q.prototype),"show",this).call(this,"Do you want to create tournament?\nPayload: ".concat(t))}}]);return Q}(h),en=ee});var ea={};S(ea,{default:function(){return ei}});var eo,ei,es=f(function(){"use strict";n();r();_();eo=/*#__PURE__*/function(e){_inherits(J,e);function J(){_class_call_check(this,J);return _call_super(this,J,arguments)}_create_class(J,[{key:"show",value:function(e){this.title.textContent="Share tournament",this.okButton.textContent="Share",this.noButton.textContent="Cancel",_get(_get_prototype_of(J.prototype),"show",this).call(this,"Do you want to share your score?\nScore: ".concat(e))}}]);return J}(h),ei=eo});n();r();s();s();s();s();s();n();r();n();r();n();r();var eu=/*#__PURE__*/function(){function H(e){var t=this;_class_call_check(this,H);i(this,"adapter");i(this,"extra");i(this,"currentContextID",null);i(this,"currentContextType","SOLO");i(this,"currentContextPlayers",[]);i(this,"chooseAsyncPopup",null);i(this,"createAsyncPopup",null);i(this,"switchAsyncPopup",null);i(this,"contextIdsByCreate");i(this,"contextIdsByChoose",[]);i(this,"playerIdsInContexts");i(this,"handleOnYes",function(e){return function(){t.extra.isPopupShown=!1,e(!0)}});i(this,"handleOnNo",function(e){return function(){t.extra.isPopupShown=!1;try{t.extra.exceptionUserInput("Player closed the context menu")}catch(t){e(t)}}});this.adapter=e,this.extra=e.extra}_create_class(H,[{key:"setCurrentContextId",value:function(e){this.checkSameContext(e),this.currentContextID=e,this.currentContextType="THREAD"}},{key:"initContextInfo",value:function(e,t){var n=GameCore.Utils,r=n.Array,a=n.Number;this.contextIdsByCreate={},this.playerIdsInContexts={},this.contextIdsByChoose=r.fillWith(10,function(){return a.random(10).toString()}),!(!e||!t)&&(["SOLO","THREAD","POST","GROUP"].indexOf(t)<0||(this.currentContextID=e,this.currentContextType=t))}},{key:"getID",value:function(){return this.currentContextID}},{key:"getType",value:function(){return this.currentContextType}},{key:"loadSwitchAsyncPopup",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.switchAsyncPopup)return[2];return[4,Promise.resolve().then(function(){return b(),v})];case 1:t=n.sent().default;"function"==typeof t&&(e.switchAsyncPopup=new t);return[2]}})})()}},{key:"loadChooseAsyncPopup",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.chooseAsyncPopup)return[2];return[4,Promise.resolve().then(function(){return A(),k})];case 1:t=n.sent().default;"function"==typeof t&&(e.chooseAsyncPopup=new t);return[2]}})})()}},{key:"loadCreateAsyncPopup",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.createAsyncPopup)return[2];return[4,Promise.resolve().then(function(){return E(),D})];case 1:t=n.sent().default;"function"==typeof t&&(e.createAsyncPopup=new t);return[2]}})})()}},{key:"switchAsync",value:function(e,t){var n=arguments.length>1&&void 0!==t&&t;var r=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(a){switch(a.label){case 0:r.extra.checkPopupShown();return[4,r.extra.awaitRandomDelay()];case 1:if(a.sent(),r.validateSwitchAsyncContextId(e),"SOLO"===e&&n){r.currentContextID=null,r.currentContextType="SOLO",r.updatePlayers([]);return[2]}return[4,r.loadSwitchAsyncPopup()];case 2:a.sent();return[4,new Promise(function(t,n){r.switchAsyncPopup||r.adapter.extra.exceptionUnsupported(),r.switchAsyncPopup.onYes(r.handleOnYes(t)),r.switchAsyncPopup.onNo(r.handleOnNo(n)),r.switchAsyncPopup.show(e),r.extra.isPopupShown=!0})];case 3:a.sent(),r.currentContextID=e,r.currentContextType="THREAD",r.createPlayerIdsInContext(e,10);t=r.playerIdsInContexts[e].map(function(e){return r.createPlayerInfo(e)});r.updatePlayers(t);return[2]}})})()}},{key:"chooseAsync",value:function(e){var t=this;return _async_to_generator(function(){var e,n,r;return _ts_generator(this,function(a){switch(a.label){case 0:t.extra.checkPopupShown();return[4,t.extra.awaitRandomDelay()];case 1:a.sent();return[4,t.loadChooseAsyncPopup()];case 2:a.sent();return[4,new Promise(function(e,n){t.chooseAsyncPopup||t.adapter.extra.exceptionUnsupported(),t.chooseAsyncPopup.onYes(t.handleOnYes(e)),t.chooseAsyncPopup.onNo(t.handleOnNo(n)),t.chooseAsyncPopup.show(),t.extra.isPopupShown=!0})];case 3:a.sent();e=Math.floor(Math.random()*t.contextIdsByChoose.length),n=t.contextIdsByChoose[e];t.checkSameContext(n),t.currentContextID=n,t.currentContextType="THREAD",t.createPlayerIdsInContext(n,2);r=t.playerIdsInContexts[n].map(function(e){return t.createPlayerInfo(e)});t.updatePlayers(r);return[2]}})})()}},{key:"createAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r;return _ts_generator(this,function(a){switch(a.label){case 0:t.extra.checkPopupShown();return[4,t.extra.awaitRandomDelay()];case 1:a.sent();return[4,t.validateCreateAsyncPlayerId(e)];case 2:a.sent();return[4,t.loadCreateAsyncPopup()];case 3:a.sent();return[4,new Promise(function(n,r){t.createAsyncPopup||t.adapter.extra.exceptionUnsupported(),t.createAsyncPopup.onYes(t.handleOnYes(n)),t.createAsyncPopup.onNo(t.handleOnNo(r)),t.createAsyncPopup.show(e),t.extra.isPopupShown=!0})];case 4:a.sent(),t.contextIdsByCreate[e]||(t.contextIdsByCreate[e]=GameCore.Utils.Number.random(10).toString());n=t.contextIdsByCreate[e];t.checkSameContext(n),t.currentContextID=n,t.currentContextType="THREAD";r=t.createPlayerInfo(e);t.updatePlayers([r]);return[2]}})})()}},{key:"getPlayersAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.extra.awaitRandomDelay()];case 1:return[2,(t.sent(),e.currentContextPlayers)]}})})()}},{key:"createPlayerIdsInContext",value:function(e,t){if(!this.playerIdsInContexts[e]){var n=GameCore.Utils,r=n.Array,a=n.Number,o=Math.floor(Math.random()*t),s=r.fillWith(o,function(){return a.random(10).toString()});this.playerIdsInContexts[e]=s}return this.playerIdsInContexts[e]}},{key:"createPlayerInfo",value:function(e){return{getID:function(){return e},getName:function(){return"Player ".concat(e)},getPhoto:function(){return""}}}},{key:"updatePlayers",value:function(e){if("SOLO"===this.currentContextType){this.currentContextPlayers=[];return}this.currentContextPlayers=e}},{key:"checkSameContext",value:function(e){this.currentContextID===e&&this.extra.exceptionSameContext()}},{key:"validateCreateAsyncPlayerId",value:function(e){var t=this;return _async_to_generator(function(){var n,r;return _ts_generator(this,function(a){switch(a.label){case 0:if((!e||Array.isArray(e))&&t.extra.exceptionClientUnsupportedOperation("Client does not support no player IDS or multiple player IDs yet"),!GameCore.Utils.Valid.isString(e)){n="Array of type String contained a value of another type: ".concat(e);t.extra.exceptionInvalidParam(n)}e===GameSDK.player.getID()&&t.extra.exceptionInvalidParam("'At least one player id besides the current player must be provided.'");return[4,GameSDK.player.getConnectedPlayersAsync()];case 1:if(a.sent().some(function(t){return t.getID()===e}))return[2];r="Provided ID ".concat(e," is not a connected player of the current player.");t.extra.exceptionInvalidParam(r);return[2]}})})()}},{key:"validateSwitchAsyncContextId",value:function(e){if(this.checkSameContext(e),GameCore.Utils.Valid.isString(e))return;this.extra.exceptionClientUnsupportedOperation("Client requires update to support this operation")}}]);return H}(),ec=eu;n();r();n();r();var el='\n<div id="lds-game-icon-blur"></div>\n<div id="lds-game-icon"></div>\n<div id="lds-text">\n    <span id="lds-percent">0</span>%\n</div>\n',ef="lds-container",ey=/*#__PURE__*/function(){function V(){var e=this;_class_call_check(this,V);i(this,"percentage",0);document.addEventListener("DOMContentLoaded",function(){e.createLoadingElement(),e.updateLoadingStyle()})}_create_class(V,[{key:"createLoadingElement",value:function(){var e=document.getElementById("GameDiv");if(!e)return null;var t=document.createElement("div");return t.id=ef,t.setAttribute("data-clarity-unmask","true"),t.innerHTML=el,e.appendChild(t),t}},{key:"updateLoadingStyle",value:function(){var e=document.getElementById(ef);if(!e)return;var t="assets/public/logo-128x128.png";t="public/logo-128x128.png";var n=e.querySelector("#lds-game-icon");n&&_instanceof(n,HTMLElement)&&(n.style.backgroundImage="url(".concat(t,")"),n.style.backgroundColor="transparent");var r=e.querySelector("#lds-game-icon-blur");r&&_instanceof(r,HTMLElement)&&(r.style.backgroundImage="url(".concat(t,")"),r.style.backgroundColor="transparent")}},{key:"setLoadingProgress",value:function(e){if(e===this.percentage||this.percentage>e)return;this.percentage=e;var t=document.getElementById("lds-percent");t&&(t.innerHTML="".concat(e))}},{key:"removeLoadingElement",value:function(){var e=document.getElementById(ef);e&&(e.style.opacity="0",setTimeout(function(){e.remove()},300))}}]);return V}(),ed=ey;n();r();var eh=/*#__PURE__*/function(e){_inherits($,e);function $(e,t){_class_call_check(this,$);var n;n=_call_super(this,$,[t]);i(n,"code");n.code=e;return n}return $}(_wrap_native_super(Error)),e_=eh;var ep=/*#__PURE__*/function(){function W(e){_class_call_check(this,W);i(this,"adapter");i(this,"isGuest",!1);i(this,"isPopupShown",!1);i(this,"maxWaitGameCoreReadyTime",1e4);i(this,"loadingElement",null);this.adapter=e}_create_class(W,[{key:"subscribeBotAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o;return _ts_generator(this,function(s){switch(s.label){case 0:return[4,e.adapter.player.canSubscribeBotAsync()];case 1:if(!s.sent())return[2,!1];t=window.game,n=t.analytics,r=GameCore.Plugins.Analytics.Events,a=r.BOT_SUBSCRIBE,o=r.BOT_SUBSCRIBE_POPUP;n.event(o);s.label=2;case 2:s.trys.push([2,5,,6]);return[4,e.waitSDKInitiatedAsync()];case 3:s.sent();return[4,e.adapter.player.subscribeBotAsync()];case 4:return[2,(s.sent(),n.event(a,{success:!0}),!0)];case 5:s.sent();return[2,(n.event(a,{success:!1}),!1)];case 6:return[2]}})})()}},{key:"checkAndCreateShortcutAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o;return _ts_generator(this,function(s){switch(s.label){case 0:return[4,e.adapter.canCreateShortcutAsync()];case 1:if(!s.sent())return[2];t=window.game,n=t.analytics,r=GameCore.Plugins.Analytics.Events,a=r.SHORTCUT_CREATE,o=r.SHORTCUT_CREATE_POPUP;n.event(o);s.label=2;case 2:s.trys.push([2,5,,6]);return[4,e.waitSDKInitiatedAsync()];case 3:s.sent();return[4,e.adapter.createShortcutAsync()];case 4:s.sent(),n.event(a,{success:!0});return[3,6];case 5:s.sent();n.event(a,{success:!1});return[3,6];case 6:return[2]}})})()}},{key:"waitSDKInitiatedAsync",value:function(){var e=GameCore.Utils,t=e.Valid;return t.isValueChangeAsync(window.__sdkInitiated,!0)}},{key:"waitGameCoreReadyAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){t=0;return[2,new Promise(function(n){var r=setInterval(function(){if("GameCore"in window){clearInterval(r),n();return}t+=10,t>e.maxWaitGameCoreReadyTime&&(t=0)},10)})]})})()}},{key:"createLoadingElement",value:function(){this.loadingElement||(this.loadingElement=new ed)}},{key:"setLoadingElementProgress",value:function(e){this.loadingElement&&this.loadingElement.setLoadingProgress(e)}},{key:"destroyLoadingElement",value:function(){this.loadingElement&&this.loadingElement.removeLoadingElement()}},{key:"checkPopupShown",value:function(){this.isPopupShown&&this.exceptionPendingRequest("Please wait for the popup to close")}},{key:"delayInitialAsync",value:function(){return _async_to_generator(function(){var e,t,n,r,a,o,s;return _ts_generator(this,function(u){switch(u.label){case 0:e=GameCore.Utils,t=e.Time,n=GameCore.Configs,r=n.Mockup,a=r.GameSDK,o=a.SlowAPI;s=!o.Enabled||o.InitialDelay<=0;if(s)return[3,2];return[4,t.sleepAsync(o.InitialDelay)];case 1:s=u.sent();u.label=2;case 2:return[2]}})})()}},{key:"delayStartAsync",value:function(){return _async_to_generator(function(){var e,t,n,r,a,o,s;return _ts_generator(this,function(u){switch(u.label){case 0:e=GameCore.Configs,t=e.Mockup,n=t.GameSDK,r=n.SlowAPI,a=GameCore.Utils,o=a.Time;s=!r.Enabled||r.StartDelay<=0;if(s)return[3,2];return[4,o.sleepAsync(r.StartDelay)];case 1:s=u.sent();u.label=2;case 2:return[2]}})})()}},{key:"delayPlayerDataAsync",value:function(){return _async_to_generator(function(){var e,t,n,r,a,o,s;return _ts_generator(this,function(u){switch(u.label){case 0:e=GameCore.Configs,t=e.Mockup,n=t.GameSDK,r=n.SlowAPI,a=GameCore.Utils,o=a.Time;s=!r.Enabled||r.PlayerDataDelay<=0;if(s)return[3,2];return[4,o.sleepAsync(r.PlayerDataDelay)];case 1:s=u.sent();u.label=2;case 2:return[2]}})})()}},{key:"awaitRandomDelay",value:function(e){var t=arguments.length>0&&void 0!==e?e:1e3;var n=GameCore.Utils,r=n.Time;return r.sleepAsync(Math.random()*t)}},{key:"randomException",value:function(e){var t=Math.floor(Math.random()*e.length),n=e[t];this["exception".concat(n)]()}},{key:"throwNewCommonError",value:function(e,t){throw new e_(e,t)}},{key:"exceptionUserInput",value:function(e){this.throwNewCommonError("USER_INPUT",e)}},{key:"exceptionUnsupported",value:function(){this.throwNewCommonError("UNSUPPORTED","Unsupported method")}},{key:"exceptionInvalidParam",value:function(e){this.throwNewCommonError("INVALID_PARAM",e)}},{key:"exceptionPendingRequest",value:function(e){this.throwNewCommonError("PENDING_REQUEST",e)}},{key:"exceptionMethodNotImplemented",value:function(){this.throwNewCommonError("METHOD_NOT_IMPLEMENTED","Method not implemented")}},{key:"exceptionTournamentNotFound",value:function(e){this.throwNewCommonError("TOURNAMENT_NOT_FOUND",e)}},{key:"exceptionSameContext",value:function(){this.throwNewCommonError("SAME_CONTEXT","Must specify a context other than the current one.")}},{key:"exceptionInvalidOperation",value:function(e){this.throwNewCommonError("INVALID_OPERATION",e)}},{key:"exceptionNetworkFailure",value:function(e){var t=arguments.length>0&&void 0!==e?e:"Request failed to be processed";this.throwNewCommonError("NETWORK_FAILURE",t)}},{key:"exceptionUnknown",value:function(e){this.throwNewCommonError("UNKNOWN",e)}},{key:"exceptionClientUnsupportedOperation",value:function(e){this.throwNewCommonError("CLIENT_UNSUPPORTED_OPERATION",e)}},{key:"exceptionRateLimited",value:function(e){this.throwNewCommonError("RATE_LIMITED",e)}}]);return W}(),ev=ep;n();r();var eg="Save The Pets".replace(/ /g,"-"),em=/*#__PURE__*/function(){function Y(e){var t=this;_class_call_check(this,Y);i(this,"adapter");i(this,"extra");i(this,"defaultPlayerInfo");i(this,"currentPlayerInfo");i(this,"infoKey","".concat(eg,"_PlayerInfo"));i(this,"dataKey","".concat(eg,"_PlayerData"));i(this,"subscribeBot",null);i(this,"connectedPlayers",null);i(this,"getSignature",function(){var e=GameCore.Utils,n=e.Valid,r=t.getSignatureFormMockup();return n.isString(r)?r:"default_token"});this.adapter=e,this.extra=e.extra,this.initDefaultPlayerInfo()}_create_class(Y,[{key:"initDefaultPlayerInfo",value:function(){var e="guest-007";this.defaultPlayerInfo={playerId:e,playerName:"Guest",playerPhoto:"https://picsum.photos/seed/".concat(e,"/300/300")},this.extra.isGuest=!0,this.currentPlayerInfo=_object_spread({},this.defaultPlayerInfo)}},{key:"initPlayerInfo",value:function(e){this.updateCurrentPlayerInfo(e);var t=GameCore.Utils,n=t.Browser;n.writeLocalStorage(this.infoKey,this.currentPlayerInfo)}},{key:"canSubscribeBotAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.loadMockSubscribeBot()];case 1:return[2,(t.sent(),e.subscribeBot||e.extra.exceptionUnsupported(),e.subscribeBot.canSubscribeBotAsync())]}})})()}},{key:"subscribeBotAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.loadMockSubscribeBot()];case 1:return[2,(t.sent(),e.subscribeBot||e.extra.exceptionUnsupported(),e.subscribeBot.subscribeBotAsync())]}})})()}},{key:"getID",value:function(){var e=GameCore.Utils,t=e.Browser,n=e.Valid,r=e.Object,a=t.getLocalStorage(this.infoKey),o=this.currentPlayerInfo,s=o.playerId;return n.isObject(a)&&r.hasOwn(a,"playerId")&&n.isString(a.playerId)?a.playerId:s}},{key:"getName",value:function(){var e=GameCore.Utils,t=e.Browser,n=e.Valid,r=e.Object,a=t.getLocalStorage(this.infoKey),o=this.currentPlayerInfo,s=o.playerName;return n.isObject(a)&&r.hasOwn(a,"name")&&n.isString(a.name)?a.name:s}},{key:"getPhoto",value:function(){var e=GameCore.Utils,t=e.Browser,n=e.Valid,r=e.Object,a=t.getLocalStorage(this.infoKey),o=this.currentPlayerInfo,s=o.playerPhoto;return n.isObject(a)&&r.hasOwn(a,"photo")&&n.isString(a.photo)?a.photo:s}},{key:"getDataAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a,o,s,u;return _ts_generator(this,function(l){switch(l.label){case 0:return[4,t.extra.delayPlayerDataAsync()];case 1:l.sent();n=GameCore.Utils,r=n.Browser,a=n.Valid,o=n.Object,s=r.getLocalStorage(t.dataKey);if(!a.isObject(s))return[2,{}];if(0===e.length)return[2,s];u={};return[2,(e.forEach(function(e){o.hasOwn(s,e)&&(u[e]=s[e])}),u)]}})})()}},{key:"setDataAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r;return _ts_generator(this,function(a){switch(a.label){case 0:return[4,t.extra.delayPlayerDataAsync()];case 1:a.sent();n=GameCore.Utils,r=n.Browser;r.writeLocalStorage(t.dataKey,e);return[2]}})})()}},{key:"getSignedPlayerInfoAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){return[2,{getPlayerID:function(){var t;return null!==(t=e.getID())&&void 0!==t?t:""},getSignature:e.getSignature}]})})()}},{key:"getConnectedPlayersAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.loadMockConnectedPlayers()];case 1:return[2,(t.sent(),e.connectedPlayers||e.extra.exceptionUnsupported(),e.connectedPlayers.getConnectedPlayersAsync())]}})})()}},{key:"updateCurrentPlayerInfo",value:function(e){if(!e)return;var t=GameCore.Configs,n=t.Mockup,r=n.Match,a=r.PlayerInfo.Id===e,o=r.OpponentInfo.Id===e;a&&(this.currentPlayerInfo.playerId=r.PlayerInfo.Id,r.PlayerInfo.Name&&(this.currentPlayerInfo.playerName=r.PlayerInfo.Name),r.PlayerInfo.Photo&&(this.currentPlayerInfo.playerPhoto=r.PlayerInfo.Photo)),o&&(this.currentPlayerInfo.playerId=r.OpponentInfo.Id,r.OpponentInfo.Name&&(this.currentPlayerInfo.playerName=r.OpponentInfo.Name),r.OpponentInfo.Photo&&(this.currentPlayerInfo.playerPhoto=r.OpponentInfo.Photo))}},{key:"getSignatureFormMockup",value:function(){var e=GameCore.Configs,t=e.Mockup,n=t.Match,r=n.PlayerInfo.Id===this.getID(),a=n.OpponentInfo.Id===this.getID();return r?n.PlayerInfo.Signature:a?n.OpponentInfo.Signature:null}},{key:"loadMockSubscribeBot",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.subscribeBot)return[2];return[4,Promise.resolve().then(function(){return s(),a})];case 1:t=n.sent().default;"function"==typeof t&&(e.subscribeBot=new t(e.adapter));return[2]}})})()}},{key:"loadMockConnectedPlayers",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.connectedPlayers)return[2];return[4,Promise.resolve().then(function(){return F(),O})];case 1:t=n.sent().default;"function"==typeof t&&(e.connectedPlayers=new t(e.extra));return[2]}})})()}}]);return Y}(),ew=em;n();r();n();r();var eI=/*#__PURE__*/function(){function q(e,t,n){var r=arguments.length>2&&void 0!==n&&n;_class_call_check(this,q);i(this,"id");i(this,"title");i(this,"contextId");i(this,"payload");i(this,"endTime");i(this,"tournamentType");var a=t.config,o=t.data;var s;this.id=e,this.title=a.title,this.contextId="0123".concat(this.id),this.payload=JSON.stringify(null!=o?o:{}),this.endTime=null!==(s=a.endTime)&&void 0!==s?s:this.defaultEndTime(),this.tournamentType=r?"PAGE_HOSTED":"DEFAULT"}_create_class(q,[{key:"defaultEndTime",value:function(){return Math.round((Date.now()+6048e5)/1e3)}},{key:"getID",value:function(){return this.id}},{key:"getTitle",value:function(){return this.title}},{key:"getPayload",value:function(){return this.payload}},{key:"getEndTime",value:function(){return this.endTime}},{key:"getContextID",value:function(){return this.contextId}},{key:"getTournamentType",value:function(){return this.tournamentType}},{key:"toObject",value:function(){return{id:this.id,title:this.title,payload:this.payload,endTime:this.endTime,contextId:this.contextId,tournamentType:this.tournamentType}}}]);return q}(),eb=eI;var ek=["Unsupported","NetworkFailure","PendingRequest","ClientUnsupportedOperation"],ex=_to_consumable_array(ek).concat(["InvalidParam","UserInput"]),eP=_to_consumable_array(ek).concat(["InvalidOperation","UserInput"]),eA=_to_consumable_array(ek).concat(["InvalidParam","UserInput"]),eD=_to_consumable_array(ek).concat(["InvalidParam","UserInput"]),eC=_to_consumable_array(ek).concat(["NetworkFailure"]),eS="TournamentsDataMockKey",eT="TournamentLeadersMockKey",eE=/*#__PURE__*/function(){function Z(e){var t=this;_class_call_check(this,Z);var n=this;i(this,"adapter");i(this,"extra");i(this,"context");i(this,"shareAsyncPopup",null);i(this,"createAsyncPopup",null);i(this,"processEnterTournament",/*#__PURE__*/function(){var e=_async_to_generator(function(e){var t;return _ts_generator(this,function(r){switch(r.label){case 0:t=n.getTournamentData(e);if(!t)return[3,2];return[4,n.joinAsync(e)];case 1:t=r.sent();r.label=2;case 2:return[2]}})});return function(t){return e.apply(this,arguments)}}());i(this,"handleOnYes",function(e){return function(){t.extra.isPopupShown=!1,e(!0)}});i(this,"handleOnNo",function(e){return function(){t.extra.isPopupShown=!1;try{t.extra.exceptionUserInput("Player closed the context menu")}catch(t){e(t)}}});this.adapter=e,this.extra=e.extra,this.context=e.context}_create_class(Z,[{key:"initTournamentInfoAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a,o;return _ts_generator(this,function(s){switch(s.label){case 0:n=GameCore.Configs.Mockup.GameSDK,r=n.Tournament;a=r.Enabled;if(!a)return[3,4];return[4,t.createMockTournamentsData()];case 1:s.sent();o=e;if(!o)return[3,3];return[4,t.processEnterTournament(e)];case 2:o=s.sent();s.label=3;case 3:a=o;s.label=4;case 4:return[2]}})})()}},{key:"createMockTournamentsData",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o,s,u,l,d,h,_,v,g,m,b,k,x,P;return _ts_generator(this,function(A){switch(A.label){case 0:t=GameCore.Utils,n=t.Object,r=GameCore.Configs.Mockup.GameSDK,a=r.Tournament,o=a.NumOfTournament,s=o.Normal,u=o.HostPage;if(!a.Enabled)return[2];l=e.getTournamentsData(),d=n.vals(l),h=e.filterExpiredTournaments(d),_=h.filter(function(e){return"DEFAULT"===e.tournamentType}),v=h.filter(function(e){return"PAGE_HOSTED"===e.tournamentType}),g=_.length,m=v.length,b=s-g,k=u-m,x=e.createDefaultTournaments(b),P=e.createGlobalTournaments(k);return[4,Promise.all(_to_consumable_array(x).concat(_to_consumable_array(P)))];case 1:A.sent();return[2]}})})()}},{key:"filterExpiredTournaments",value:function(e){var t=Date.now()/1e3,n=e.filter(function(e){return e.endTime>t}),r={};var a=true,o=false,s=void 0;try{for(var u=n[Symbol.iterator](),l;!(a=(l=u.next()).done);a=true){var d=l.value;r[d.id]=d}}catch(e){o=true;s=e}finally{try{if(!a&&null!=u.return)u.return()}finally{if(o)throw s}}return this.writeTournamentsData(r),n}},{key:"createDefaultTournaments",value:function(e){var t=GameCore.Utils,n=t.String,r=t.Array,a=window.game,o=a.leaderboard,s=GameSDK.player.getID(),u=GameSDK.player.getName();var l=this;return r.length(e).map(/*#__PURE__*/_async_to_generator(function(){var e,t,r,a,d,h,_,v;return _ts_generator(this,function(g){switch(g.label){case 0:e="".concat(u,"'s Tournament ").concat(n.generateObjectId()),t=GameCore.Configs.Mockup.GameSDK.Tournament,r=t.ExtraPlayerTournamentPayload,a=void 0===r?{}:r;return[4,o.createLeaderboardAsync({name:e})];case 1:d=g.sent(),h=l.createMockTournamentAsync({initialScore:0,config:{title:e,tournamentTitle:e},data:_object_spread({playerId:s,playerName:u,leaderboardId:d},a)}).getID().toString();if(l.getTournamentLeadersData(h))return[2];_=GameCore.Utils.Number.random(2),v=window.game.player.getConnectedPlayerIds(_,0).map(function(e){return{playerId:e,score:GameCore.Utils.Number.random(4)}});v.sort(function(e,t){return e.score-t.score}),l.writeTournamentLeadersData(h,v);return[2]}})}))}},{key:"createGlobalTournaments",value:function(e){var t=GameCore.Utils,n=t.String,r=t.Array,a=t.Number,o=window.game,s=o.leaderboard,u=GameCore.Configs.Mockup.GameSDK.Tournament,l=u.ExtraGlobalTournamentPayload,d=void 0===l?{}:l;var h=this;return r.length(e).map(/*#__PURE__*/_async_to_generator(function(){var e,t,o,u,l,_;return _ts_generator(this,function(v){switch(v.label){case 0:e=n.generateObjectId(),t=_object_spread({leaderboardId:e,playerId:"global"},d),o="Global Tournament ".concat(e);return[4,s.createLeaderboardAsync({name:o,_id:e,type:"world_tournament_leaderboard",description:JSON.stringify(t)})];case 1:v.sent();u=h.createMockTournamentAsync({initialScore:0,config:{title:o,tournamentTitle:o},data:t},!0).getID().toString();if(h.getTournamentLeadersData(u))return[2];l=a.random(2),_=r.length(l).map(function(){return{playerId:n.generateObjectId(),score:a.random(4)}});_.sort(function(e,t){return e.score-t.score}),h.writeTournamentLeadersData(u,_);return[2]}})}))}},{key:"awaitRandomDelay",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a;return _ts_generator(this,function(o){t=GameCore.Configs,n=t.Mockup,r=n.GameSDK.Tournament,a=r.RandomDelayMs;return[2,e.extra.awaitRandomDelay(a)]})})()}},{key:"randomError",value:function(e){var t=GameCore.Configs,n=t.Mockup,r=n.GameSDK.Tournament,a=r.ErrorRates;100*Math.random()<a&&this.extra.randomException(e)}},{key:"loadCreateTournamentPopupAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.createAsyncPopup)return[2];return[4,Promise.resolve().then(function(){return er(),X})];case 1:t=n.sent().default;"function"==typeof t&&(e.createAsyncPopup=new t);return[2]}})})()}},{key:"loadSharePopupAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.shareAsyncPopup)return[2];return[4,Promise.resolve().then(function(){return es(),ea})];case 1:t=n.sent().default;"function"==typeof t&&(e.shareAsyncPopup=new t);return[2]}})})()}},{key:"createAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r;return _ts_generator(this,function(a){switch(a.label){case 0:t.extra.checkPopupShown();return[4,t.awaitRandomDelay()];case 1:a.sent(),null!==t.context.getID()&&t.extra.exceptionInvalidOperation("Cannot create tournament while in a context"),t.validateCreatePayload(e),t.randomError(ex);return[4,t.loadCreateTournamentPopupAsync()];case 2:a.sent();return[4,new Promise(function(n,r){t.createAsyncPopup||t.adapter.extra.exceptionUnsupported(),t.createAsyncPopup.onYes(t.handleOnYes(n)),t.createAsyncPopup.onNo(t.handleOnNo(r)),t.createAsyncPopup.show(e),t.extra.isPopupShown=!0})];case 3:a.sent();n=t.createMockTournamentAsync(e),r=n.getContextID();return[2,(t.setCurrentContextID(r),n)]}})})()}},{key:"createMockTournamentAsync",value:function(e,t){var n=arguments.length>1&&void 0!==t&&t;var r=GameCore.Utils.String.generateObjectId(),a=new eb(r,e,n),o=a.toObject();return this.writeTournamentData(r,o),a}},{key:"postScoreAsync",value:function(e){var t=this;return _async_to_generator(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:return[4,t.awaitRandomDelay()];case 1:r.sent(),t.validateAvailableTournament(),e<0&&t.extra.exceptionInvalidParam("Score must be a positive number"),t.randomError(eD);n=window.game.player.getPlayerId();t.updateBestScore(n,e);return[2]}})})()}},{key:"shareAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a,o,s,u,l;return _ts_generator(this,function(d){switch(d.label){case 0:t.extra.checkPopupShown();return[4,t.awaitRandomDelay()];case 1:d.sent(),t.validateAvailableTournament(),t.validateSharePayload(e),t.randomError(eA);return[4,t.loadSharePopupAsync()];case 2:d.sent();n=e.score,r=n,a=t.getCurrentTournament();if(a){o=window.game.player.getPlayerId(),s=a.getID().toString(),u=t.getBestScore(s,o);u&&u<n&&(r=u)}return[4,new Promise(function(e,n){t.shareAsyncPopup||t.adapter.extra.exceptionUnsupported(),t.shareAsyncPopup.onYes(t.handleOnYes(e)),t.shareAsyncPopup.onNo(t.handleOnNo(n)),t.shareAsyncPopup.show(r),t.extra.isPopupShown=!0})];case 3:d.sent();l=window.game.player.getPlayerId();t.updateBestScore(l,n);return[2]}})})()}},{key:"getTournamentsAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r;return _ts_generator(this,function(a){switch(a.label){case 0:return[4,e.awaitRandomDelay()];case 1:a.sent(),e.randomError(eC);t=e.getTournamentsData(),n=GameCore.Utils,r=n.Object;return[2,r.vals(t).map(function(t){return e.getTournamentInstance(t.id)}).filter(function(e){return null!==e})]}})})()}},{key:"joinAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r;return _ts_generator(this,function(a){switch(a.label){case 0:return[4,t.awaitRandomDelay()];case 1:a.sent(),GameCore.Utils.Valid.isString(e)||t.extra.exceptionInvalidParam("Tournament ID must be a string");n=t.getTournamentInstance(e);n||t.extra.exceptionTournamentNotFound("Tournament could not be found."),t.randomError(eP);r=n.getContextID();return[4,GameSDK.context.switchAsync(r)];case 2:a.sent();return[2]}})})()}},{key:"setCurrentContextID",value:function(e){_instanceof(this.context,ec)&&this.context.setCurrentContextId(e)}},{key:"getCurrentTournament",value:function(){var e=this.context.getID();if(!e)return null;var t=this.getTournamentsData();for(var n in t)if(Object.hasOwn(t,n)&&t[n].contextId===e)return this.getTournamentInstance(n);return null}},{key:"validateCreatePayload",value:function(e){var t=GameCore.Utils,n=t.Object,r=t.Valid;r.isObject(e)||this.extra.exceptionInvalidParam("Payload must be an object"),n.hasOwn(e,"initialScore")||this.extra.exceptionInvalidParam("Payload must have initialScore"),n.hasOwn(e,"config")||this.extra.exceptionInvalidParam("Payload must have config");var a=e.initialScore,o=e.config;r.isNumber(a)||this.extra.exceptionInvalidParam("initialScore must be a number"),r.isObject(o)||this.extra.exceptionInvalidParam("Config must be an object"),n.hasOwn(o,"title")||this.extra.exceptionInvalidParam("Config must have title"),n.hasOwn(o,"tournamentTitle")||this.extra.exceptionInvalidParam("Config must have tournamentTitle"),n.hasOwn(e,"data")&&!r.isObject(e.data)&&this.extra.exceptionInvalidParam("Data must be an object")}},{key:"validateSharePayload",value:function(e){var t=GameCore.Utils,n=t.Object,r=t.Valid;r.isObject(e)||this.extra.exceptionInvalidParam("Payload must be an object"),n.hasOwn(e,"score")||this.extra.exceptionInvalidParam("Payload must have score");var a=e.score;r.isNumber(a)||this.extra.exceptionInvalidParam("Score must be a number"),n.hasOwn(e,"data")&&!r.isObject(e.data)&&this.extra.exceptionInvalidParam("Data must be an object")}},{key:"validateAvailableTournament",value:function(){this.getCurrentTournament()||this.extra.exceptionTournamentNotFound("There is no tournament for this context.")}},{key:"getTournamentInstance",value:function(e){var t=this.getTournamentData(e);return t?{getID:function(){return t.id},getTitle:function(){return t.title},getPayload:function(){return t.payload},getEndTime:function(){return t.endTime},getContextID:function(){return t.contextId},getTournamentType:function(){return t.tournamentType}}:null}},{key:"getTournamentData",value:function(e){var t=this.getTournamentsData();return t[e]?t[e]:null}},{key:"writeTournamentData",value:function(e,t){var n=this.getTournamentsData();n[e]=t,this.writeTournamentsData(n)}},{key:"getTournamentsData",value:function(){var e=GameCore.Utils,t=e.Browser,n=e.Valid,r=t.getLocalStorage(eS);return n.isObject(r)?r:{}}},{key:"writeTournamentsData",value:function(e){var t=GameCore.Utils,n=t.Browser,r=t.Valid;r.isObject(e)&&n.writeLocalStorage(eS,e)}},{key:"getBestScore",value:function(e,t){var n=this.getTournamentLeader(e,t);var r;return n?null!==(r=n.score)&&void 0!==r?r:null:null}},{key:"updateBestScore",value:function(e,t){var n=this.getCurrentTournament();if(!n)return;var r=n.getID().toString();if(!r)return;var a=this.getTournamentLeader(r,e);if(!a){this.writeTournamentLeader(r,{playerId:e,score:t});return}a.score<t&&(a.score=t,this.writeTournamentLeader(r,a))}},{key:"getTournamentLeader",value:function(e,t){var n=this.getTournamentLeadersData(e);if(!n.length)return null;var r=GameCore.Utils,a=r.Array;var o;return null!==(o=a.search(n,function(e){return e.playerId===t}))&&void 0!==o?o:null}},{key:"getTournamentLeadersData",value:function(e){var t=GameCore.Utils,n=t.Browser,r=t.Object,a=n.getLocalStorage(eT);if(!r.hasOwn(a,e))return[];var o=a[e];return Array.isArray(o)?(o.sort(function(e,t){return t.score-e.score}),o):[]}},{key:"writeTournamentLeader",value:function(e,t){var n=GameCore.Utils,r=n.Array,a=this.getTournamentLeadersData(e),o=r.searchIndex(a,function(e){return e.playerId===t.playerId});-1===o?a.push(t):a[o]=t,this.writeTournamentLeadersData(e,a)}},{key:"writeTournamentLeadersData",value:function(e,t){var n=GameCore.Utils,r=n.Browser,a=n.Object;if(!Array.isArray(t))return;var o;var s=null!==(o=r.getLocalStorage(eT))&&void 0!==o?o:{};a.assign(s,_define_property({},e,t)),r.writeLocalStorage(eT,s)}}]);return Z}(),eO=eE;var eG=/*#__PURE__*/function(){function tt(){_class_call_check(this,tt);i(this,"extra");i(this,"player");i(this,"context");i(this,"tournament");i(this,"shortcut",null);i(this,"isInitialized",!1);i(this,"bannerAdInstances",{});i(this,"rewardedVideoInstance",null);i(this,"interstitialAdInstance",null);i(this,"rewardedInterstitialInstance",null)}_create_class(tt,[{key:"initialize",value:function(){this.extra=new ev(this),this.player=new ew(this),this.context=new ec(this),this.tournament=new eO(this)}},{key:"isNeedSDK",value:function(){return(null==t?void 0:t.AllowWithoutSDK)!==!0}},{key:"getLocale",value:function(){return GameCore.Utils.Browser.getLocale()}},{key:"getPlatform",value:function(){var e=GameCore.Utils,t=e.Device;return t.isAndroid()?"ANDROID":t.isIOS()?"IOS":t.isDesktop()?"WEB":t.isMobile()?"MOBILE_WEB":null}},{key:"getSDKName",value:function(){return"GameCore"}},{key:"getSDKVersion",value:function(){return"1.0.0"}},{key:"initializeAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o;return _ts_generator(this,function(s){switch(s.label){case 0:if(e.isInitialized)return[2];e.initialize(),e.extra.createLoadingElement();t=e.isNeedSDK();if(!t)return[3,2];return[4,e.checkSDKInitialized()];case 1:t=s.sent();s.label=2;case 2:return[4,e.extra.waitGameCoreReadyAsync()];case 3:s.sent();return[4,e.extra.delayInitialAsync()];case 4:s.sent();n=GameCore.Utils.Browser.getQueryParams();if(n.splashPreview){e.extra.destroyLoadingElement();return[2]}r=n.playerId;e.player.initPlayerInfo(r);a=n.context_source_id,o=n.context_type;e.context.initContextInfo(a,o),e.isInitialized=!0;return[2]}})})()}},{key:"checkSDKInitialized",value:function(){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2]})})()}},{key:"startGameAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o,s;return _ts_generator(this,function(u){switch(u.label){case 0:e.isInitialized||e.extra.exceptionInvalidOperation("GameSDK is not initialized");return[4,e.extra.delayStartAsync()];case 1:u.sent();t=90;window.__sdkLoadingCount=t,e.setLoadingProgress(t),setTimeout(function(){e.extra.destroyLoadingElement()},500);n=GameCore.Events,r=GameCore.Utils,a=r.Browser,o=a.getQueryParams,s=o().tournament_id;return[4,e.tournament.initTournamentInfoAsync(s)];case 2:u.sent(),window.game.event.emit(n.GAME_SDK_STARTED);return[2]}})})()}},{key:"setLoadingProgress",value:function(e){this.extra.setLoadingElementProgress(e)}},{key:"getEntryPointData",value:function(){var e=GameCore.Utils,t=e.Browser,n=e.Json,r=t.getQueryParams(),a=r.payload,o=void 0===a?"{}":a;return"string"!=typeof o?{}:n.decode(o)}},{key:"getEntryPointAsync",value:function(){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2,"no_entry"]})})()}},{key:"loadBannerAdAsync",value:function(e){var t=this;return _async_to_generator(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:if(!e)return[3,5];if(!!t.bannerAdInstances[e])return[3,2];return[4,Promise.resolve().then(function(){return s(),a})];case 1:n=r.sent().default;"function"!=typeof n&&t.extra.exceptionInvalidOperation("Banner ads mock is not enabled"),t.bannerAdInstances[e]=new n("banner",e);r.label=2;case 2:return[4,t.bannerAdInstances[e].loadAsync()];case 3:r.sent();return[4,t.bannerAdInstances[e].showAsync()];case 4:r.sent();r.label=5;case 5:return[2]}})})()}},{key:"hideBannerAdAsync",value:function(e){var t=this;return _async_to_generator(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:n=t.bannerAdInstances[e];if(!n)return[3,2];return[4,t.bannerAdInstances[e].hideAsync()];case 1:n=r.sent();r.label=2;case 2:return[2]}})})()}},{key:"getBannerHeight",value:function(e){return e.BannerHeight}},{key:"getInterstitialAdAsync",value:function(e){var t=this;return _async_to_generator(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:if(!!t.interstitialAdInstance)return[3,2];return[4,Promise.resolve().then(function(){return s(),a})];case 1:n=r.sent().default;"function"!=typeof n&&t.extra.exceptionInvalidOperation("Interstitial ads mock is not enabled"),t.interstitialAdInstance=new n("interstitial",e);r.label=2;case 2:return[2,t.interstitialAdInstance]}})})()}},{key:"getRewardedVideoAsync",value:function(e){var t=this;return _async_to_generator(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:if(!!t.rewardedVideoInstance)return[3,2];return[4,Promise.resolve().then(function(){return s(),a})];case 1:n=r.sent().default;"function"!=typeof n&&t.extra.exceptionInvalidOperation("Rewarded video ads mock is not enabled"),t.rewardedVideoInstance=new n("rewarded",e);r.label=2;case 2:return[2,t.rewardedVideoInstance]}})})()}},{key:"getRewardedInterstitialAsync",value:function(e){var t=this;return _async_to_generator(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:if(!!t.rewardedInterstitialInstance)return[3,2];return[4,Promise.resolve().then(function(){return s(),a})];case 1:n=r.sent().default;"function"!=typeof n&&t.extra.exceptionInvalidOperation("Rewarded interstitial ads mock is not enabled"),t.rewardedInterstitialInstance=new n("rewarded_interstitial",e);r.label=2;case 2:return[2,t.rewardedInterstitialInstance]}})})()}},{key:"getTournamentAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o,s;return _ts_generator(this,function(u){switch(u.label){case 0:e.tournament.randomError(["Unsupported","NetworkFailure"]);t=e.context.getID(),n=GameCore.Utils,r=n.Array,a=n.Valid;a.isString(t)||e.extra.exceptionInvalidOperation("Not in a context");return[4,e.tournament.getTournamentsAsync()];case 1:o=u.sent(),s=r.search(o,function(e){return e.getContextID()===t});return[2,(s||e.extra.exceptionTournamentNotFound("A Tournament with current context was not found"),s)]}})})()}},{key:"getSupportedAPIs",value:function(){var e=GameCore.Configs.Mockup.GameSDK.Player.SubscribeBot,t=e.CanSubscribeBot;return t?["player.canSubscribeBotAsync"]:[]}},{key:"canCreateShortcutAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.loadMockAddShortcut()];case 1:return[2,(t.sent(),e.shortcut||e.extra.exceptionUnsupported(),e.shortcut.canCreateShortcutAsync())]}})})()}},{key:"createShortcutAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.loadMockAddShortcut()];case 1:return[2,(t.sent(),e.shortcut||e.extra.exceptionUnsupported(),e.shortcut.createShortcutAsync())]}})})()}},{key:"loadMockAddShortcut",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.shortcut)return[2];return[4,Promise.resolve().then(function(){return s(),a})];case 1:t=n.sent().default;"function"==typeof t&&(e.shortcut=new t(e));return[2]}})})()}}]);return tt}(),eN=eG;n();r();n();r();var eL=/*#__PURE__*/function(){function et(e,t){_class_call_check(this,et);i(this,"type");i(this,"placementId");this.type=e,this.placementId=t}_create_class(et,[{key:"getPlacementID",value:function(){return this.placementId}},{key:"hideAsync",value:function(){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2,Promise.resolve()]})})()}}]);return et}(),eU=eL;var eB={instanceId:""},eR={AD_NOT_LOADED:"AD_NOT_LOADED",LOAD_ADS_FAILURE:"LOAD_ADS_FAILURE",INVALID_OPERATION:"INVALID_OPERATION",SHOW_ADS_FAILURE:"SHOW_ADS_FAILURE",SHOW_ADS_TIMEOUT:"SHOW_ADS_TIMEOUT",SHOW_ADS_COMPLETED_FAILURE:"SHOW_ADS_COMPLETED_FAILURE"},eM=/*#__PURE__*/function(e){_inherits(nt,e);function nt(e,t){_class_call_check(this,nt);var n;n=_call_super(this,nt,[e,""]);i(n,"sdk");i(n,"type");i(n,"instance");i(n,"isAdDisplayed",!1);i(n,"isAdShowInProgress",!1);n.sdk=t,n.type=e,n.instance=eB;return n}_create_class(nt,[{key:"getPlacementID",value:function(){return this.instance.instanceId}},{key:"resetInstance",value:function(){this.instance=eB}},{key:"loadAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n;return _ts_generator(this,function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);if(e.isAdShowInProgress)throw e.makeErrorWithCode(eR.INVALID_OPERATION,"Can't load ads while showing ads");if(e.instance.instanceId)return[2];return[4,e.sdk.loadAdsAsync({isRewardedAd:"rewarded"===e.type,canBackfill:!1})];case 1:t=r.sent();e.instance=t;return[3,3];case 2:n=r.sent();throw e.makeErrorWithCode(eR.LOAD_ADS_FAILURE,n);case 3:return[2]}})})()}},{key:"showAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n;return _ts_generator(this,function(r){if(!e.instance.instanceId)throw e.makeErrorWithCode(eR.AD_NOT_LOADED,"Ad is not loaded. InstanceId is empty");if(e.isAdShowInProgress)throw e.makeErrorWithCode(eR.INVALID_OPERATION,"Can't show ads while showing ads");e.isAdDisplayed=!1,e.isAdShowInProgress=!0;t=e.processShowAd(e.instance.instanceId),n=e.scheduleShowingAdTimeout(1e4);return[2,new Promise(function(r,a){Promise.race([t,n]).then(function(){if(!e.isAdDisplayed){a(e.makeErrorWithCode(eR.SHOW_ADS_TIMEOUT,"Showing ad is timed out"));return}t.then(function(){r()}).catch(function(e){a(e)})}).catch(function(e){a(e)}).finally(function(){e.isAdShowInProgress=!1})})]})})()}},{key:"processShowAd",value:function(e){var t=this;return _async_to_generator(function(){var n,r;return _ts_generator(this,function(a){switch(a.label){case 0:a.trys.push([0,3,4,5]);return[4,t.sdk.showAdsAsync(e)];case 1:n=a.sent();if(!t.isPromise(n.showAdsCompletedAsync))throw t.makeErrorWithCode(eR.SHOW_ADS_FAILURE,new Error("The showAdsCompletedAsync promise is empty"));t.isAdDisplayed=!0;return[4,n.showAdsCompletedAsync];case 2:a.sent();return[3,5];case 3:r=a.sent();throw t.isErrorWithCode(r)&&r.code===eR.SHOW_ADS_COMPLETED_FAILURE&&(r.code="USER_INPUT"),t.makeErrorWithCode(eR.SHOW_ADS_FAILURE,r);case 4:t.resetInstance();return[7];case 5:return[2]}})})()}},{key:"scheduleShowingAdTimeout",value:function(e){return _async_to_generator(function(){return _ts_generator(this,function(t){return[2,new Promise(function(t,n){setTimeout(function(){t()},e)})]})})()}},{key:"isPromise",value:function(e){return(void 0===e?"undefined":_type_of(e))=="object"&&null!==e&&"function"==typeof e.then}},{key:"isErrorWithCode",value:function(e){var t=GameCore.Utils,n=t.Object;return n.hasOwn(e,"code")&&"string"==typeof e.code}},{key:"getErrorReason",value:function(e){var t=GameCore.Utils,n=t.Object;return n.hasOwn(e,"message")&&"string"==typeof e.message?{reason:e.message}:n.hasOwn(e,"description")&&"string"==typeof e.description?{reason:e.description}:null}},{key:"parseError",value:function(e){try{return"string"==typeof e?e:JSON.stringify(e)}catch(e){return"Unknown error"}}},{key:"makeErrorWithCode",value:function(e,t){var n;var r;var a=e,o=null!==(r=null===(n=this.getErrorReason(t))||void 0===n?void 0:n.reason)&&void 0!==r?r:"";return o||(o=this.parseError(t)),this.isErrorWithCode(t)&&(a=t.code),new e_(a,o)}}]);return nt}(eU),ej=eM;n();r();var eK=/*#__PURE__*/function(e){_inherits(rt,e);function rt(){_class_call_check(this,rt);return _call_super(this,rt,arguments)}_create_class(rt,[{key:"getID",value:function(){return this.currentContextID}},{key:"getType",value:function(){return this.currentContextType}},{key:"switchAsync",value:function(e,t){var n=arguments.length>1&&void 0!==t&&t;var r=this;return _async_to_generator(function(){return _ts_generator(this,function(t){if(r.validateSwitchAsyncContextId(e),"SOLO"===e&&n){r.currentContextID=null,r.currentContextType="SOLO";return[2]}r.currentContextID=e,r.currentContextType="THREAD";return[2]})})()}},{key:"chooseAsync",value:function(e){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2]})})()}},{key:"createAsync",value:function(e){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2]})})()}},{key:"getPlayersAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.extra.awaitRandomDelay()];case 1:return[2,(t.sent(),e.currentContextPlayers)]}})})()}}]);return rt}(ec),eW=eK;n();r();n();r();var ez="How about diving into the game for a relaxing experience?",eH=/*#__PURE__*/function(){function K(){_class_call_check(this,K)}_create_class(K,[{key:"sendDailyNotificationInstance",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o;return _ts_generator(this,function(s){try{t=GameCore.Configs,n=t.GameSDKOptions,r=n.MSGames,a=r.ScheduleNotification;if(!a)throw new Error("MsGamesNotification content not set up!");o=e.getNotificationPayloads();e.batchSendNotification(o),e.updatePlayerNotificationData(o)}catch(e){}return[2]})})()}},{key:"getNotificationPayloads",value:function(){var e=globalThis.game,t=e.player,n=t.getNotificationData(),r={},a=[],o=Date.now(),s=o;for(var u=1;u<=7;u++){var l;var d="D".concat(u),h=(null===(l=n[d])||void 0===l?void 0:l.arrivalDate)||0;if(o<h){s=Math.max(s,h);continue}a.push(d)}if(0===a.length)return r;var _=Math.floor(s-o)/1e3;for(var v=0;v<a.length;v++){var g=a[v],m=parseInt(g.replace("D","")),b={description:this.getNotificationContent(g),minDelayInSeconds:86400*(v+1)+_,type:m};r[g]=b}return r}},{key:"getNotificationContent",value:function(e){var t=GameCore.Configs,n=t.GameSDKOptions,r=n.MSGames,a=r.ScheduleNotification;if(!a)throw new Error("MsGamesNotification content not set up!");if(this.validateNotificationKey(e)){var o=a[e];return o&&""!==o?o:ez}return ez}},{key:"updatePlayerNotificationData",value:function(e){var t=globalThis.game,n=t.player,r=n.getNotificationData(),a=Date.now();for(var o=1;o<=7;o++){var s="D".concat(o),u=e[s];if(!!u){var l=u.minDelayInSeconds;l&&(r[s]={arrivalDate:a+1e3*l})}}n.setPlayerDataByName("notificationData",r)}},{key:"batchSendNotification",value:function(e){if(!("scheduleNotificationAsync"in GameSDK.extra))throw new Error("scheduleNotificationAsync is not available!");for(var t=1;t<=7;t++){var n="D".concat(t),r=e[n];r&&GameSDK.extra.scheduleNotificationAsync(r)}}},{key:"validateNotificationKey",value:function(e){var t=GameCore.Utils,n=t.Array;return n.has(["D1","D2","D3","D4","D5","D6","D7"],e)}}],[{key:"sendDailyNotification",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){return[2,e.getInstance().sendDailyNotificationInstance()]})})()}},{key:"getInstance",value:function(){return this._instance||(this._instance=new K),this._instance}}]);return K}();i(eH,"_instance");var eV=eH,eF=eV;var eY="Save The Pets".replace(/ /g,"-"),eq=/*#__PURE__*/function(e){_inherits(ot,e);function ot(e){_class_call_check(this,ot);var t;t=_call_super(this,ot,[e]);i(t,"sdk");i(t,"shareImageBase64");i(t,"notificationImageBase64");t.sdk=e.sdk,t.adapter=e;return t}_create_class(ot,[{key:"shareAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:n.trys.push([0,4,,5]);if(!!e.shareImageBase64)return[3,2];return[4,e.loadImageAsync("./public/share-95x95.jpg")];case 1:t=n.sent();t&&(e.shareImageBase64=t);n.label=2;case 2:return[4,e.sdk.shareAsync({title:eY,text:"Play now!",image:e.shareImageBase64})];case 3:n.sent();return[3,5];case 4:n.sent();return[3,5];case 5:return[2]}})})()}},{key:"switchGameAsync",value:function(e){var t={id:e};return this.sdk.switchGameAsync(t)}},{key:"submitGameResultsAsync",value:function(e){return this.sdk.submitGameResultsAsync(e)}},{key:"scheduleNotificationAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a;return _ts_generator(this,function(o){switch(o.label){case 0:if(!!t.notificationImageBase64)return[3,4];o.label=1;case 1:o.trys.push([1,3,,4]);return[4,t.loadImageAsync("./public/notification-364x180.jpg")];case 2:n=o.sent();n&&(t.notificationImageBase64=n);return[3,4];case 3:o.sent();return[3,4];case 4:r={playerId:t.adapter.player.getID()||"Anonymous"},a={title:eY,description:"We miss you!",type:0,minDelayInSeconds:300,imageData:t.notificationImageBase64,callToAction:"Play now!",payload:JSON.stringify(r)};a=_object_spread({},a,e);o.label=5;case 5:o.trys.push([5,7,,8]);return[4,t.sdk.scheduleNotificationAsync(a)];case 6:o.sent();return[3,8];case 7:o.sent();return[3,8];case 8:return[2]}})})()}},{key:"sendDailyNotificationAsync",value:function(){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2,eF.sendDailyNotification()]})})()}},{key:"isValidDisplayAdPlacement",value:function(e){return["top:728x90","bottom:728x90","left:300x250","right:300x250","topleft:300x250","topright:300x250","bottomleft:300x250","bottomright:300x250","top:320x50","right:320x50","bottom:320x50","left:320x50","left:300x600","right:300x600","top:970x250","bottom:970x250","left:160x600","right:160x600"].indexOf(e)>-1}},{key:"getBannerOffset",value:function(){return 20}},{key:"loadImageAsync",value:function(e){return _async_to_generator(function(){var t,n,r,a,o;return _ts_generator(this,function(s){switch(s.label){case 0:t=GameCore.Utils,n=t.Image,r=n.fetchImage,a=n.blobToDataImage;return[4,r(e)];case 1:o=s.sent();return[4,a(o)];case 2:return[2,s.sent()]}})})()}}]);return ot}(ev),eJ=eq;n();r();var eQ=/*#__PURE__*/function(e){_inherits(st,e);function st(e){_class_call_check(this,st);var t;t=_call_super(this,st,[e]);i(t,"_personalInfo");i(t,"signature","");i(t,"isLoginEnabled",!1);t.updateLoginEnabledConfig();return t}_create_class(st,[{key:"updateLoginEnabledConfig",value:function(){var e=t;if(!e)return;var n=e.MSGames;n&&(this.isLoginEnabled=n.UseLoginFeature)}},{key:"initPlayerAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n;return _ts_generator(this,function(r){switch(r.label){case 0:r.trys.push([0,8,,10]);return[4,e.tryGettingSignedInPlayer()];case 1:t=r.sent();n=e.isLoginEnabled&&!t;if(!n)return[3,3];return[4,e.tryMakingPlayerSignedIn()];case 2:n=t=r.sent();r.label=3;case 3:if(!t)return[3,5];return[4,e.initLoggedMode(t)];case 4:r.sent();return[3,7];case 5:return[4,e.initGuestMode()];case 6:r.sent();r.label=7;case 7:return[3,10];case 8:r.sent();return[4,e.initGuestMode()];case 9:r.sent();return[3,10];case 10:return[2]}})})()}},{key:"updateCurrentPlayerInfo",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a,o;return _ts_generator(this,function(s){n=GameCore.Utils,r=n.Valid,a=n.Number,o=t.getID();r.isString(o)&&r.isString(e)||(o="".concat(a.random(1e5)),t.currentPlayerInfo.playerId=o,t.currentPlayerInfo.playerName="Guest_".concat(o));return[2]})})()}},{key:"initLoggedMode",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a;return _ts_generator(this,function(o){n=e.playerId,r=e.signature,a=e.playerDisplayName;t.currentPlayerInfo.playerId=n,t.currentPlayerInfo.playerName=a,t.signature="".concat(n," ").concat(r),t._personalInfo={id:n,avatarIdHash:"0",lang:"en",publicName:a,uniqueID:n,scopePermissions:{avatar:"forbid",public_name:"forbid"}},t.extra.isGuest=!1,t.initPlayerInfo(n);return[2]})})()}},{key:"initGuestMode",value:function(){var e=this;return _async_to_generator(function(){var t,n;return _ts_generator(this,function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,e.getRandomName()];case 1:t=r.sent(),n=t.replace(/ /g,"-");if(n===e.getID())return[2];e.currentPlayerInfo.playerId=n,e.currentPlayerInfo.playerName=t,e._personalInfo={id:n,avatarIdHash:"0",lang:"en",publicName:t,uniqueID:n,scopePermissions:{avatar:"forbid",public_name:"forbid"}},e.extra.isGuest=!0,e.initPlayerInfo(n);return[3,3];case 2:r.sent();return[3,3];case 3:return[2]}})})()}},{key:"getRandomName",value:function(){return _async_to_generator(function(){var e,t;return _ts_generator(this,function(n){e=GameCore.Utils,t=e.String;return[2,t.generateNameAsync()]})})()}},{key:"tryGettingSignedInPlayer",value:function(){var e=this;return _async_to_generator(function(){var t,n,r;return _ts_generator(this,function(a){switch(a.label){case 0:t=null,n=e.adapter,r=n.sdk;a.label=1;case 1:a.trys.push([1,3,,4]);return[4,r.getSignedInUserAsync()];case 2:t=a.sent();return[3,4];case 3:a.sent();return[3,4];case 4:return[2,Promise.resolve(t)]}})})()}},{key:"tryMakingPlayerSignedIn",value:function(){var e=this;return _async_to_generator(function(){var t,n,r;return _ts_generator(this,function(a){switch(a.label){case 0:t=null,n=e.adapter,r=n.sdk;a.label=1;case 1:a.trys.push([1,3,,4]);return[4,r.signInAsync()];case 2:t=a.sent();return[3,4];case 3:a.sent();return[3,4];case 4:return[2,Promise.resolve(t)]}})})()}},{key:"getASIDAsync",value:function(){var e;return Promise.resolve(null!==(e=this.getID())&&void 0!==e?e:"")}},{key:"getSignedASIDAsync",value:function(){var e=this;return Promise.resolve({getASID:function(){var t;return null!==(t=e.getID())&&void 0!==t?t:""},getSignature:function(){return e.signature}})}},{key:"getSignedPlayerInfoAsync",value:function(){var e=this;return Promise.resolve({getPlayerID:function(){var t;return null!==(t=e.getID())&&void 0!==t?t:"10"},getSignature:function(){return e.signature}})}},{key:"canSubscribeBotAsync",value:function(){return Promise.resolve(!1)}},{key:"subscribeBotAsync",value:function(){this.adapter.extra.exceptionUnsupported()}},{key:"getConnectedPlayersAsync",value:function(){this.adapter.extra.exceptionUnsupported()}}]);return st}(ew),e$=eQ;n();r();n();r();var eZ=/*#__PURE__*/function(){function ct(e){_class_call_check(this,ct);i(this,"id");i(this,"title");i(this,"contextId");i(this,"payload");i(this,"endTime");i(this,"tournamentType");var t=e._id,n=e.name,r=e.type,a=e.createdAt,o=e.expireTime,s=JSON.parse(e.description),u=_object_spread({leaderboardId:t},s);this.id=s.tournamentId,this.title=n,this.contextId=s.contextId,this.payload=JSON.stringify(u),this.endTime=Math.round((new Date(a).getTime()+1e3*o)/1e3),this.tournamentType="world_tournament_leaderboard"===r?"PAGE_HOSTED":"DEFAULT"}_create_class(ct,[{key:"getID",value:function(){return this.id}},{key:"getTitle",value:function(){return this.title}},{key:"getPayload",value:function(){return this.payload}},{key:"getEndTime",value:function(){return this.endTime}},{key:"getContextID",value:function(){return this.contextId}},{key:"getTournamentType",value:function(){return this.tournamentType}}]);return ct}(),eX=eZ;var e0=/*#__PURE__*/function(e){_inherits(lt,e);function lt(){_class_call_check(this,lt);return _call_super(this,lt,arguments)}_create_class(lt,[{key:"joinAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a,o;return _ts_generator(this,function(s){switch(s.label){case 0:n=GameCore.Utils,r=n.Array;return[4,t.getTournamentsAsync()];case 1:a=s.sent(),o=r.search(a,function(t){return t.getID()===e});o||t.extra.exceptionTournamentNotFound("Tournament could not be found.");return[4,GameSDK.context.switchAsync(o.getContextID())];case 2:s.sent();return[2]}})})()}},{key:"getTournamentsAsync",value:function(){return _async_to_generator(function(){var e,t,n,r,a,o,s,u,l,d,h;return _ts_generator(this,function(_){switch(_.label){case 0:e=[];_.label=1;case 1:_.trys.push([1,3,,4]);t=globalThis.game,n=t.leaderboard;return[4,n.requestLeaderboardsAsync({limit:100,type:"world_tournament_leaderboard"})];case 2:r=_.sent();a=true,o=false,s=void 0;try{for(u=r[Symbol.iterator]();!(a=(l=u.next()).done);a=true){d=l.value;h=new eX(d);e.push(h)}}catch(e){o=true;s=e}finally{try{if(!a&&null!=u.return)u.return()}finally{if(o)throw s}}return[3,4];case 3:_.sent();return[3,4];case 4:return[2,e]}})})()}}]);return lt}(eO),e2=e0;var e1=/*#__PURE__*/function(e){_inherits(ut,e);function ut(e){_class_call_check(this,ut);var t;t=_call_super(this,ut);i(t,"sdk");i(t,"adPlacementList",new Set);t.sdk=e;return t}_create_class(ut,[{key:"initialize",value:function(){_get(_get_prototype_of(ut.prototype),"initialize",this).call(this),this.extra=new eJ(this),this.player=new e$(this),this.context=new eW(this),this.tournament=new e2(this),this.rewardedVideoInstance=new ej("rewarded",this.sdk),this.interstitialAdInstance=new ej("interstitial",this.sdk)}},{key:"checkSDKInitialized",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){e.sdk&&e.sdk.isInMicrosoftStart()||e.extra.exceptionInvalidOperation("Microsoft Games SDK is not initialized");return[2]})})()}},{key:"initializeAsync",value:function(){var e=this;var t=this,_superprop_get_initializeAsync=function(){return _get(_get_prototype_of(ut.prototype),"initializeAsync",e)};return _async_to_generator(function(){return _ts_generator(this,function(e){switch(e.label){case 0:if(!!t.isInitialized)return[3,5];return[4,_superprop_get_initializeAsync().call(t)];case 1:e.sent(),t.isInitialized=!1;e.label=2;case 2:e.trys.push([2,4,,5]);return[4,t.player.initPlayerAsync()];case 3:e.sent(),t.isInitialized=!0;return[3,5];case 4:e.sent();return[3,5];case 5:return[2]}})})()}},{key:"getLocale",value:function(){return this.sdk.getLocale()}},{key:"getSDKVersion",value:function(){return"v1.0.0-rc.13"}},{key:"getSDKName",value:function(){return"MsGames"}},{key:"canCreateShortcutAsync",value:function(){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2,!0]})})()}},{key:"createShortcutAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:t.trys.push([0,2,,3]);return[4,e.sdk.promptInstallAsync()];case 1:t.sent();return[3,3];case 2:t.sent();return[3,3];case 3:return[2]}})})()}},{key:"getInterstitialAdAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){return[2,e.interstitialAdInstance]})})()}},{key:"getRewardedVideoAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){return[2,e.rewardedVideoInstance]})})()}},{key:"loadBannerAdAsync",value:function(e){var t=this;return _async_to_generator(function(){var e,n,r,a,o,s,u,l,d,h,_,v;return _ts_generator(this,function(g){switch(g.label){case 0:e=GameCore.Configs.Ads,n=e.BannerDisplayAdOptions;r=true,a=false,o=void 0;try{for(s=n[Symbol.iterator]();!(r=(u=s.next()).done);r=true){l=u.value;d=l.Position,h=l.BannerWidth,_=l.BannerHeight,v="".concat(d,":").concat(h,"x").concat(_);t.extra.isValidDisplayAdPlacement(v)&&t.adPlacementList.add(v)}}catch(e){a=true;o=e}finally{try{if(!r&&null!=s.return)s.return()}finally{if(a)throw o}}return[4,t.showBannerAdsAsync()];case 1:g.sent();return[2]}})})()}},{key:"hideBannerAdAsync",value:function(e){var t=this;return _async_to_generator(function(){return _ts_generator(this,function(e){switch(e.label){case 0:e.trys.push([0,2,,3]);return[4,t.sdk.hideDisplayAdsAsync()];case 1:e.sent();return[3,3];case 2:e.sent();return[3,3];case 3:return[2]}})})()}},{key:"getEntryPointAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){t=e.sdk.getEntryPointInfo();return[2,e.sdk.getNotificationPayload()?"msn_notification":t.entryPointId]})})()}},{key:"showBannerAdsAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(0!==e.adPlacementList.size)return[3,1];e.extra.exceptionInvalidOperation("Invalid banner ad placement");return[3,4];case 1:n.trys.push([1,3,,4]);t=_to_consumable_array(e.adPlacementList);return[4,e.sdk.showDisplayAdsAsync(t)];case 2:n.sent();return[3,4];case 3:n.sent();return[3,4];case 4:e.adPlacementList.clear();return[2]}})})()}},{key:"getTournamentAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o,s;return _ts_generator(this,function(u){switch(u.label){case 0:t=e.context.getID(),n=GameCore.Utils,r=n.Array,a=n.Valid;a.isString(t)||e.extra.exceptionInvalidOperation("Not in a context");return[4,e.tournament.getTournamentsAsync()];case 1:o=u.sent(),s=r.search(o,function(e){return e.getContextID()===t});return[2,(s||e.extra.exceptionTournamentNotFound("A Tournament with current context was not found"),s)]}})})()}}]);return ut}(eN),e4=e1;s();function ne(){var e,t=window;return"FBInstant"in t?e=new o(window.FBInstant):"YaGames"in t?e=new o(window.YaGames):"$msstart"in t?e=new e4(window.$msstart):"gdsdk"in t?e=new o(window.gdsdk):"CrazyGames"in t?e=new o(window.CrazyGames.SDK):"GlanceGamingAdInterface"in t?e=new o(window.GlanceGamingAdInterface):e=new eN,e}window.GameSDK=Object.seal(ne())})();(function(){"use strict";var e={TAG_IDS:"G-EX3MNH7ENG",BUILD_VERSION:"23"};var t=e,p=function(){var e=setInterval(function(){if(window.__sdkLoadingCount>=70){clearInterval(e);return}GameSDK.setLoadingProgress(window.__sdkLoadingCount++)},250)};var n=/*#__PURE__*/function(){var e=_async_to_generator(function(){return _ts_generator(this,function(e){switch(e.label){case 0:e.trys.push([0,2,,3]);return[4,GameSDK.initializeAsync()];case 1:e.sent();return[3,3];case 2:e.sent();setTimeout(n,2e3);return[2];case 3:window.__sdkLoadingCount=1,GameSDK.setLoadingProgress(window.__sdkLoadingCount),p();return[4,a()];case 4:e.sent(),window.__sdkInitiated=!0;return[2]}})});return function(){return e.apply(this,arguments)}}(),r={},a=/*#__PURE__*/function(){var e=_async_to_generator(function(){var e,n,r,a,o,s,u;return _ts_generator(this,function(l){switch(l.label){case 0:l.trys.push([0,2,3,4]);e=t.TAG_IDS,n=e.split(" ");if(0===n.length||!n[0]||"null"===n[0])return[2];return[4,GameSDK.getEntryPointAsync()];case 1:a=null!==(r=l.sent())&&void 0!==r?r:"no_entry",o=document.createElement("script");o.async=!0,o.src="https://www.googletagmanager.com/gtag/js?id=".concat(n[0]),document.head.appendChild(o);s=GameSDK.player.getID();y(s,a,n);return[3,4];case 2:u=l.sent();c(u);return[3,4];case 3:w();return[7];case 4:return[2]}})});return function(){return e.apply(this,arguments)}}(),c=function(e){var t=window.game,n=t.analytics,r=t.monitorError;if(!r){window.__errorQueue.push(e);return}n.event("app_crash_handle",{error:e}),r.sendException(e)},y=function(e,n,a){try{window.focus();var o=t.BUILD_VERSION,s=void 0===o?"0":o,u=GameSDK.getEntryPointData()||{},l=u.fbig_ad_id,d=u.fbig_adset_id,h=u.fbig_campaign_id;window.gtag("js",new Date),window.gtag("set","client_id","100.".concat(e)),window.gtag("set","user_id",e),window.gtag("set","send_page_view",!1),a.forEach(function(e){window.gtag("config",e,{cookie_flags:"SameSite=None;Secure",build:s,medium:n,campaign:h,groups:"GA"})});var _=GameCore.Utils.Browser.getQueryParams().entry_point||n;r.user_id=e,r.player_id=e,r.app_version=s,r.traffic_source=n,r.traffic_source_detail=_,r.ad_id=l,r.adset_id=d,r.campaign_id=h,window.gtag("set","user_properties",r)}catch(e){c(e)}},o=30,w=function(e){var t=arguments.length>0&&void 0!==e?e:0;if(!(t>=o)){if(!window.game||!window.game.event){setTimeout(function(){return w(t+1)},2);return}G(),I()}},G=function(){var e=window.game,t=e.analytics,n=e.event,r=GameCore.Events,a=GameCore.Plugins,o=a.Analytics,s=o.Events,u=s.APP_LAUNCH,l=s.APP_INITIALIZED;t.event(u),n.catchUp(r.GAME_SDK_READY,function(){t.event(l)})},S=function(){try{var e;var t=window.game,n=t.player,a=n.getBestScore(),o=null!==(e=n.getGameData().coins)&&void 0!==e?e:0,s=n.isFirstLogin();r.new_user=s,r.coins=o,r.score=a;var u=GameSDK.getEntryPointData(),l=u||{},d=l.content,h=l.notif_id;(d||h)&&(r.traffic_source_detail=null!=d?d:"notif_".concat(h)),window.gtag("set","user_properties",r)}catch(e){c(e)}},I=function(){try{if(!GameSDK.player.getID())return;var e=window.game,t=e.event,n=GameCore.Events,r=n.PLAYER_INFO_LOADED;t.catchUp(r,S)}catch(e){c(e)}};n()})();