function _array_like_to_array(e,t){if(null==t||t>e.length)t=e.length;for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _array_without_holes(e){if(Array.isArray(e))return _array_like_to_array(e)}function _assert_this_initialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function asyncGeneratorStep(e,t,n,r,a,o,i){try{var s=e[o](i);var c=s.value}catch(e){n(e);return}if(s.done)t(c);else Promise.resolve(c).then(r,a)}function _async_to_generator(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function _next(e){asyncGeneratorStep(o,r,a,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(o,r,a,_next,_throw,"throw",e)}_next(void 0)})}}function _call_super(e,t,n){return t=_get_prototype_of(t),_possible_constructor_return(e,_is_native_reflect_construct()?Reflect.construct(t,n||[],_get_prototype_of(e).constructor):t.apply(e,n))}function _class_call_check(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _construct(){return(_construct=_is_native_reflect_construct()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));if(n)_set_prototype_of(a,n.prototype);return a}).apply(null,arguments)}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];if(r.enumerable=r.enumerable||false,r.configurable=true,"value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}function _create_class(e,t,n){if(t)_defineProperties(e.prototype,t);if(n)_defineProperties(e,n);return e}function _define_property(e,t,n){if(t in e)Object.defineProperty(e,t,{value:n,enumerable:true,configurable:true,writable:true});else e[t]=n;return e}function _get(e,t,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=_super_prop_base(e,t);if(!r)return;var a=Object.getOwnPropertyDescriptor(r,t);if(a.get)return a.get.call(n||e);return a.value})(e,t,n||e)}function _get_prototype_of(e){return(_get_prototype_of=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");if(e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}}),t)_set_prototype_of(e,t)}function _instanceof(e,t){if(null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance])return!!t[Symbol.hasInstance](e);return e instanceof t}function _is_native_function(e){return -1!==Function.toString.call(e).indexOf("[native code]")}function _iterable_to_array(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _non_iterable_spread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _object_spread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};var r=Object.keys(n);if("function"==typeof Object.getOwnPropertySymbols)r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}));r.forEach(function(t){_define_property(e,t,n[t])})}return e}function _possible_constructor_return(e,t){if(t&&("object"===_type_of(t)||"function"==typeof t))return t;return _assert_this_initialized(e)}function _set_prototype_of(e,t){return(_set_prototype_of=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _super_prop_base(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(null===(e=_get_prototype_of(e)))break;return e}function _to_consumable_array(e){return _array_without_holes(e)||_iterable_to_array(e)||_unsupported_iterable_to_array(e)||_non_iterable_spread()}function _type_of(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function _unsupported_iterable_to_array(e,t){if(!e)return;if("string"==typeof e)return _array_like_to_array(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor)n=e.constructor.name;if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _array_like_to_array(e,t)}function _wrap_native_super(e){var t="function"==typeof Map?new Map:void 0;return(_wrap_native_super=function(e){if(null===e||!_is_native_function(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,Wrapper)}function Wrapper(){return _construct(e,arguments,_get_prototype_of(this).constructor)}return Wrapper.prototype=Object.create(e.prototype,{constructor:{value:Wrapper,enumerable:false,writable:true,configurable:true}}),_set_prototype_of(Wrapper,e)})(e)}function _is_native_reflect_construct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_is_native_reflect_construct=function(){return!!e})()}function _ts_generator(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function verb(e){return function(t){return step([e,t])}}function step(o){if(n)throw new TypeError("Generator is already executing.");while(i)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;if(r=0,a)o=[2&o[0],a.value];switch(o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:false};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}if(a[2])i.ops.pop();i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:true}}}(function(){"use strict";var e,t,n,r,a,o,i,s,c,u,l,_,d,f,y,p,h,m,g,v,w=Object.defineProperty;var b=Object.getOwnPropertyNames;var __name=function(e,t){return w(e,"name",{value:t,configurable:true})};var __esm=function(e,t){return function(){return e&&(t=(0,e[b(e)[0]])(e=0)),t}};var __export=function(e,t){for(var n in t)w(e,n,{get:t[n],enumerable:true})};var __publicField=function(e,t,n){return function(e,t,n){return t in e?w(e,t,{enumerable:true,configurable:true,writable:true,value:n}):e[t]=n}(e,(void 0===t?"undefined":_type_of(t))!=="symbol"?t+"":t,n)};var I=__esm({"<define:__AD_SERVICE_SAVANA__>":function(){}});var A=__esm({"<define:__GAME_SDK_CONFIG__>":function(){e={AllowWithoutSDK:true,MSGames:{LoginOnStart:false,MaxLoginAttemptsPerDay:1,UseLoginFeature:false,ScheduleNotification:{D1:"The dogs are in danger! Draw quick and keep them safe from the bees. \uD83D\uDC1D\uD83D\uDC36",D2:"The pets need your help! Protect them from today's hazards. Can you do it? \uD83D\uDCAA\uD83D\uDC15",D3:"Buzz buzz! Bees are back. Can you outsmart them and save the dogs? \uD83D\uDC3E✨",D4:"Get ready to draw your best defenses! The dogs are counting on you. \uD83D\uDC15\uD83D\uDEA8",D5:"The danger is real! Hurry up, the bees are closing in on the pets. \uD83D\uDC1D\uD83D\uDD25",D6:"The dogs are waiting for their hero! Can you keep them safe from harm? \uD83C\uDFAE\uD83D\uDC15",D7:"Your furry friends need you now! Join the game and save the day. \uD83C\uDFC6\uD83D\uDC3E"}},Yandex:{LoginOnStart:false,MaxLoginAttemptsPerDay:1},TranssionH5:{GaId:"G-XXXXXXXXXX"}}}});var P=__esm({"<define:__INIT_CONFIG__>":function(){}});var S={};__export(S,{default:function(){return t}});var k=__esm({"libs/empty-script.js":function(){"use strict";I(),A(),P(),t={}}});var x=__esm({"src/game-sdk/common/BaseAsyncPopup.ts":function(){"use strict";I(),A(),P(),n='\n<div id="async-popup">\n    <div id="title"></div>\n    <div id="content"></div>\n    <div class="buttons">\n        <button id="ok"></button>\n        <button id="no"></button>\n    </div>\n</div>',r="\n#async-popup {\n    width: 100%;\n    height: 100%;\n    color: #fff;\n    display: flex;\n    position: absolute;\n    flex-direction: column;\n    justify-content: space-evenly;\n    background: #202020;\n    font-family: sans-serif;\n    border-radius: 20px;\n    align-items: center;\n    padding: 20px\n}\n\n#async-popup #title {\n    font-size: 2rem;\n    font-weight: bold;\n    margin-bottom: 1rem;\n}\n\n#async-popup #content {\n    display: flex;\n    text-align: center;\n    text-wrap: balance;\n    font-size: large;\n}\n\n#async-popup .buttons {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: space-evenly;\n}\n\n#async-popup .buttons button {\n    margin: 0.5rem;\n    padding: 0.5rem 1rem;\n    font-size: 1.5rem;\n    font-weight: bold;\n    border-radius: 0.5rem;\n    border: none;\n    cursor: pointer;\n}",a=/*#__PURE__*/function(){function _BaseAsyncPopup(){var e=this;_class_call_check(this,_BaseAsyncPopup),__publicField(this,"popup"),__publicField(this,"title"),__publicField(this,"content"),__publicField(this,"okButton"),__publicField(this,"noButton"),__publicField(this,"okCallback"),__publicField(this,"noCallback"),__publicField(this,"onYes",/* @__PURE__ */__name(function(t){e.okButton.removeEventListener("click",e.okCallback),e.okCallback=e.handleCallback(t),e.okButton.addEventListener("click",e.okCallback,{once:true})},"onYes")),__publicField(this,"onNo",/* @__PURE__ */__name(function(t){e.noButton.removeEventListener("click",e.noCallback),e.noCallback=e.handleCallback(t),e.noButton.addEventListener("click",e.noCallback,{once:true})},"onNo")),__publicField(this,"handleCallback",/* @__PURE__ */__name(function(t){return function(n){n.stopImmediatePropagation(),e.hide(),t()}},"handleCallback")),this.createPopupElement(),this.addPopupElementStyle();var t=new MutationObserver(function(){if(!document.getElementById("GameDiv"))return;e.setupPopupElementSizeAndPosition()});var n=document.body;t.observe(n,{attributes:true,childList:true,subtree:true})}return _create_class(_BaseAsyncPopup,[{key:"createPopupElement",value:function(){var e=document.createElement("div");e.id=this.constructor.name,e.innerHTML=n,e.style.width="100%",e.style.height="100%",e.style.position="absolute",e.style.backgroundColor="#0000001f",document.body.appendChild(e),this.popup=e,this.popup.style.display="none",this.title=e.querySelector("#title"),this.content=e.querySelector("#content"),this.okButton=e.querySelector("#ok"),this.noButton=e.querySelector("#no")}},{key:"addPopupElementStyle",value:function(){var e=document.createElement("style");(document.head||document.getElementsByTagName("head")[0]).appendChild(e),e.appendChild(document.createTextNode(r))}},{key:"setupPopupElementSizeAndPosition",value:function(){var e=document.getElementById(this.constructor.name);if(!e)return;var t=e.querySelector("#async-popup");if(!t)return;if(!document.getElementById("GameDiv"))return;t.style.width="".concat(350,"px"),t.style.height="".concat(250,"px");var n=document.body.getBoundingClientRect(),r=n.width,a=n.height;t.style.left="".concat((r-350)/2,"px"),t.style.top="".concat((a-250)/2,"px")}},{key:"show",value:function(e){this.content.textContent="".concat(e),this.popup.style.display="flex"}},{key:"hide",value:function(){this.popup.style.display="none"}}]),_BaseAsyncPopup}(),__name(a,"BaseAsyncPopup"),o=a}});var D={};__export(D,{default:function(){return s}});var C=__esm({"src/game-sdk/common/SwitchAsyncPopup.ts":function(){"use strict";I(),A(),P(),x(),__name(i=/*#__PURE__*/function(e){function _SwitchAsyncPopup(){return _class_call_check(this,_SwitchAsyncPopup),_call_super(this,_SwitchAsyncPopup,arguments)}return _inherits(_SwitchAsyncPopup,e),_create_class(_SwitchAsyncPopup,[{key:"show",value:function(e){this.title.textContent="Switch Context",this.okButton.textContent="Switch",this.noButton.textContent="Cancel",_get(_get_prototype_of(_SwitchAsyncPopup.prototype),"show",this).call(this,"Do you want to switch context?\nContext ID: ".concat(e))}}]),_SwitchAsyncPopup}(o),"SwitchAsyncPopup"),s=i}});var T={};__export(T,{default:function(){return u}});var E=__esm({"src/game-sdk/common/ChooseAsyncPopup.ts":function(){"use strict";I(),A(),P(),x(),__name(c=/*#__PURE__*/function(e){function _ChooseAsyncPopup(){return _class_call_check(this,_ChooseAsyncPopup),_call_super(this,_ChooseAsyncPopup,arguments)}return _inherits(_ChooseAsyncPopup,e),_create_class(_ChooseAsyncPopup,[{key:"show",value:function(){this.title.textContent="Choose Contexts",this.okButton.textContent="Choose",this.noButton.textContent="Cancel",_get(_get_prototype_of(_ChooseAsyncPopup.prototype),"show",this).call(this,"Do you want to switch context?\n            This will choose random a friend or tournament to play with.")}}]),_ChooseAsyncPopup}(o),"ChooseAsyncPopup"),u=c}});var O={};__export(O,{default:function(){return _}});var G=__esm({"src/game-sdk/common/CreateAsyncPopup.ts":function(){"use strict";I(),A(),P(),x(),__name(l=/*#__PURE__*/function(e){function _CreateAsyncPopup(){return _class_call_check(this,_CreateAsyncPopup),_call_super(this,_CreateAsyncPopup,arguments)}return _inherits(_CreateAsyncPopup,e),_create_class(_CreateAsyncPopup,[{key:"show",value:function(e){this.title.textContent="Create Context",this.okButton.textContent="Create",this.noButton.textContent="Cancel",_get(_get_prototype_of(_CreateAsyncPopup.prototype),"show",this).call(this,"Do you want to create context?\nPlayer ID: ".concat(e))}}]),_CreateAsyncPopup}(o),"CreateAsyncPopup"),_=l}});var L={};__export(L,{default:function(){return y}});var N=__esm({"src/game-sdk/common/MockConnectedPlayers.ts":function(){"use strict";I(),A(),P(),d="MockConnectedPlayers",f=/*#__PURE__*/function(){function _MockConnectedPlayers(e){_class_call_check(this,_MockConnectedPlayers),__publicField(this,"extra"),this.extra=e}return _create_class(_MockConnectedPlayers,[{key:"getConnectedPlayersAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a;return _ts_generator(this,function(o){switch(o.label){case 0:if(n=(t=GameCore.Configs.Mockup.GameSDK.Player.ConnectedPlayers).ErrorRate,r=t.NumOfPlayers,a=t.RandomDelayMs,e.randomExceptionError("getConnectedPlayersAsync",n))e.extra.exceptionNetworkFailure("Get connected players error");return[4,e.extra.awaitRandomDelay(a)];case 1:return o.sent(),[2,e.createPlayers(r)]}})})()}},{key:"createPlayers",value:function(e){var t=GameCore.Configs.Mockup.GameSDK.Player.ConnectedPlayers.AvatarUrl;var n=this.loadLocalStorage();if(!n)n=[],this.saveLocalStorage(n);if(n.length!==e){var _loop=function(e){var r="connected-player-".concat(e);var a={getID:/* @__PURE__ */__name(function(){return r},"getID"),getName:/* @__PURE__ */__name(function(){return"Connected Player ".concat(e)},"getName"),getPhoto:/* @__PURE__ */__name(function(){return t.replace("%1",r)},"getPhoto")};n.push(a)};for(var r=n.length;r<e;r++)_loop(r);this.saveLocalStorage(n)}return this.loadLocalStorage()}},{key:"loadLocalStorage",value:function(){var e=GameCore.Utils,t=e.Browser,n=e.Object;var r=t.getLocalStorage(d);if(!r)return[];var a=n.vals(r);if(!Array.isArray(a))return[];var o=[];var i=true,s=false,c=void 0;try{for(var u,l=a[Symbol.iterator]();!(i=(u=l.next()).done);i=true)(function(){var e=u.value;o.push({getID:/* @__PURE__ */__name(function(){return e.id},"getID"),getName:/* @__PURE__ */__name(function(){return e.name},"getName"),getPhoto:/* @__PURE__ */__name(function(){return e.photo},"getPhoto")})})()}catch(e){s=true,c=e}finally{try{if(!i&&null!=l.return)l.return()}finally{if(s)throw c}}return o}},{key:"saveLocalStorage",value:function(e){var t=GameCore.Utils.Browser;var n=[];var r=true,a=false,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done);r=true){var c,u,l=i.value;var _={id:l.getID()||"",name:null!==(c=l.getName())&&void 0!==c?c:"",photo:null!==(u=l.getPhoto())&&void 0!==u?u:""};n.push(_)}}catch(e){a=true,o=e}finally{try{if(!r&&null!=s.return)s.return()}finally{if(a)throw o}}var f=_object_spread({},n);t.writeLocalStorage(d,f)}},{key:"randomExceptionError",value:function(e,t){if(!(100*Math.random()<t))return false;return console.warn("[".concat(this.constructor.name,"]"),e),true}}]),_MockConnectedPlayers}(),__name(f,"MockConnectedPlayers"),y=f}});var M={};__export(M,{default:function(){return h}});var B=__esm({"src/game-sdk/common/CreateTournamentAsyncPopup.ts":function(){"use strict";I(),A(),P(),x(),__name(p=/*#__PURE__*/function(e){function _CreateTournamentAsyncPopup(){return _class_call_check(this,_CreateTournamentAsyncPopup),_call_super(this,_CreateTournamentAsyncPopup,arguments)}return _inherits(_CreateTournamentAsyncPopup,e),_create_class(_CreateTournamentAsyncPopup,[{key:"show",value:function(e){this.title.textContent="Create Tournament",this.okButton.textContent="Create",this.noButton.textContent="Cancel";var t=JSON.stringify(e,null,2);_get(_get_prototype_of(_CreateTournamentAsyncPopup.prototype),"show",this).call(this,"Do you want to create tournament?\nPayload: ".concat(t))}}]),_CreateTournamentAsyncPopup}(o),"CreateTournamentAsyncPopup"),h=p}});var F={};__export(F,{default:function(){return g}});var U=__esm({"src/game-sdk/common/ShareTournamentAsyncPopup.ts":function(){"use strict";I(),A(),P(),x(),__name(m=/*#__PURE__*/function(e){function _ShareTournamentAsyncPopup(){return _class_call_check(this,_ShareTournamentAsyncPopup),_call_super(this,_ShareTournamentAsyncPopup,arguments)}return _inherits(_ShareTournamentAsyncPopup,e),_create_class(_ShareTournamentAsyncPopup,[{key:"show",value:function(e){this.title.textContent="Share tournament",this.okButton.textContent="Share",this.noButton.textContent="Cancel",_get(_get_prototype_of(_ShareTournamentAsyncPopup.prototype),"show",this).call(this,"Do you want to share your score?\nScore: ".concat(e))}}]),_ShareTournamentAsyncPopup}(o),"ShareTournamentAsyncPopup"),g=m}});I(),A(),P(),k(),k(),k(),k(),k(),I(),A(),P(),I(),A(),P(),I(),A(),P();var R=/*#__PURE__*/function(){function _Context(e){var t=this;_class_call_check(this,_Context),__publicField(this,"adapter"),__publicField(this,"extra"),__publicField(this,"currentContextID",null),__publicField(this,"currentContextType","SOLO"),__publicField(this,"currentContextPlayers",[]),__publicField(this,"chooseAsyncPopup",null),__publicField(this,"createAsyncPopup",null),__publicField(this,"switchAsyncPopup",null),__publicField(this,"contextIdsByCreate"),__publicField(this,"contextIdsByChoose",[]),__publicField(this,"playerIdsInContexts"),__publicField(this,"handleOnYes",/* @__PURE__ */__name(function(e){return function(){t.extra.isPopupShown=false,e(true)}},"handleOnYes")),__publicField(this,"handleOnNo",/* @__PURE__ */__name(function(e){return function(){t.extra.isPopupShown=false;try{t.extra.exceptionUserInput("Player closed the context menu")}catch(t){e(t)}}},"handleOnNo")),this.adapter=e,this.extra=e.extra}return _create_class(_Context,[{key:"setCurrentContextId",value:function(e){this.checkSameContext(e),this.currentContextID=e,this.currentContextType="THREAD"}},{key:"initContextInfo",value:function(e,t){var n=GameCore.Utils,r=n.Array,a=n.String;if(this.contextIdsByCreate={},this.playerIdsInContexts={},this.contextIdsByChoose=r.fillWith(10,function(){return a.generateObjectId()}),!e||!t)return;if(["SOLO","THREAD","POST","GROUP"].indexOf(t)<0){console.warn("Invalid context type: ".concat(t));return}this.currentContextID=e,this.currentContextType=t}},{key:"getID",value:function(){return this.currentContextID}},{key:"getType",value:function(){return this.currentContextType}},{key:"loadSwitchAsyncPopup",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.switchAsyncPopup)return[2];return[4,Promise.resolve().then(function(){return C(),D})];case 1:if("function"!=typeof(t=n.sent().default))return[2];return e.switchAsyncPopup=new t,[2]}})})()}},{key:"loadChooseAsyncPopup",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.chooseAsyncPopup)return[2];return[4,Promise.resolve().then(function(){return E(),T})];case 1:if("function"!=typeof(t=n.sent().default))return[2];return e.chooseAsyncPopup=new t,[2]}})})()}},{key:"loadCreateAsyncPopup",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.createAsyncPopup)return[2];return[4,Promise.resolve().then(function(){return G(),O})];case 1:if("function"!=typeof(t=n.sent().default))return[2];return e.createAsyncPopup=new t,[2]}})})()}},{key:"switchAsync",value:function(e,t){var n=arguments.length>1&&void 0!==t&&t;var r=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(a){switch(a.label){case 0:return r.extra.checkPopupShown(),[4,r.extra.awaitRandomDelay()];case 1:if(a.sent(),r.validateSwitchAsyncContextId(e),"SOLO"===e&&n)return r.currentContextID=null,r.currentContextType="SOLO",r.updatePlayers([]),[2];return[4,r.loadSwitchAsyncPopup()];case 2:return a.sent(),[4,new Promise(function(t,n){if(!r.switchAsyncPopup)r.adapter.extra.exceptionUnsupported();r.switchAsyncPopup.onYes(r.handleOnYes(t)),r.switchAsyncPopup.onNo(r.handleOnNo(n)),r.switchAsyncPopup.show(e),r.extra.isPopupShown=true})];case 3:return a.sent(),r.currentContextID=e,r.currentContextType="THREAD",r.createPlayerIdsInContext(e,10),t=r.playerIdsInContexts[e].map(function(e){return r.createPlayerInfo(e)}),r.updatePlayers(t),[2]}})})()}},{key:"chooseAsync",value:function(e){var t=this;return _async_to_generator(function(){var e,n,r;return _ts_generator(this,function(a){switch(a.label){case 0:return t.extra.checkPopupShown(),[4,t.extra.awaitRandomDelay()];case 1:return a.sent(),[4,t.loadChooseAsyncPopup()];case 2:return a.sent(),[4,new Promise(function(e,n){if(!t.chooseAsyncPopup)t.adapter.extra.exceptionUnsupported();t.chooseAsyncPopup.onYes(t.handleOnYes(e)),t.chooseAsyncPopup.onNo(t.handleOnNo(n)),t.chooseAsyncPopup.show(),t.extra.isPopupShown=true})];case 3:return a.sent(),e=Math.floor(Math.random()*t.contextIdsByChoose.length),n=t.contextIdsByChoose[e],t.checkSameContext(n),t.currentContextID=n,t.currentContextType="THREAD",t.createPlayerIdsInContext(n,2),r=t.playerIdsInContexts[n].map(function(e){return t.createPlayerInfo(e)}),t.updatePlayers(r),[2]}})})()}},{key:"createAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a;return _ts_generator(this,function(o){switch(o.label){case 0:return t.extra.checkPopupShown(),[4,t.extra.awaitRandomDelay()];case 1:return o.sent(),[4,t.validateCreateAsyncPlayerId(e)];case 2:return o.sent(),[4,t.loadCreateAsyncPopup()];case 3:return o.sent(),[4,new Promise(function(n,r){if(!t.createAsyncPopup)t.adapter.extra.exceptionUnsupported();t.createAsyncPopup.onYes(t.handleOnYes(n)),t.createAsyncPopup.onNo(t.handleOnNo(r)),t.createAsyncPopup.show(e),t.extra.isPopupShown=true})];case 4:if(o.sent(),!t.contextIdsByCreate[e])n=GameCore.Utils.String,t.contextIdsByCreate[e]=n.generateObjectId();return r=t.contextIdsByCreate[e],t.checkSameContext(r),t.currentContextID=r,t.currentContextType="THREAD",a=t.createPlayerInfo(e),t.updatePlayers([a]),[2]}})})()}},{key:"getPlayersAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.extra.awaitRandomDelay()];case 1:return t.sent(),[2,e.currentContextPlayers]}})})()}},{key:"createPlayerIdsInContext",value:function(e,t){if(!this.playerIdsInContexts[e]){var n=GameCore.Utils,r=n.Array,a=n.String;var o=Math.floor(Math.random()*t);var i=r.fillWith(o,function(){return a.generateObjectId()});this.playerIdsInContexts[e]=i}return this.playerIdsInContexts[e]}},{key:"createPlayerInfo",value:function(e){return{getID:/* @__PURE__ */__name(function(){return e},"getID"),getName:/* @__PURE__ */__name(function(){return"Player ".concat(e)},"getName"),getPhoto:/* @__PURE__ */__name(function(){return""},"getPhoto")}}},{key:"updatePlayers",value:function(e){if("SOLO"===this.currentContextType){this.currentContextPlayers=[];return}this.currentContextPlayers=e}},{key:"checkSameContext",value:function(e){if(this.currentContextID===e)this.extra.exceptionSameContext()}},{key:"validateCreateAsyncPlayerId",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a,o;return _ts_generator(this,function(i){switch(i.label){case 0:if(!e||Array.isArray(e))n="Client does not support no player IDS or multiple player IDs yet",t.extra.exceptionClientUnsupportedOperation(n);if(!GameCore.Utils.Valid.isString(e))r="Array of type String contained a value of another type: ".concat(e),t.extra.exceptionInvalidParam(r);if(e===GameSDK.player.getID())a="'At least one player id besides the current player must be provided.'",t.extra.exceptionInvalidParam(a);return[4,GameSDK.player.getConnectedPlayersAsync()];case 1:if(i.sent().some(function(t){return t.getID()===e}))return[2];return o="Provided ID ".concat(e," is not a connected player of the current player."),t.extra.exceptionInvalidParam(o),[2]}})})()}},{key:"validateSwitchAsyncContextId",value:function(e){if(this.checkSameContext(e),GameCore.Utils.Valid.isString(e))return;this.extra.exceptionClientUnsupportedOperation("Client requires update to support this operation")}}]),_Context}();__name(R,"Context"),I(),A(),P(),I(),A(),P();var K="lds-container";var j=/*#__PURE__*/function(){function _LoadingScreenElement(){var e=this;_class_call_check(this,_LoadingScreenElement),__publicField(this,"percentage",0),document.addEventListener("DOMContentLoaded",function(){e.createLoadingElement(),e.updateLoadingStyle()})}return _create_class(_LoadingScreenElement,[{key:"createLoadingElement",value:function(){var e=document.getElementById("GameDiv");if(!e)return null;var t=document.createElement("div");return t.id=K,t.setAttribute("data-clarity-unmask","true"),t.innerHTML='\n<div id="lds-game-icon-blur"></div>\n<div id="lds-game-icon"></div>\n<div id="lds-text">\n    <span id="lds-percent">0</span>%\n</div>\n<span id="lds-warn-text">We detected a slow internet, trying to load your game...</span>\n',e.appendChild(t),t}},{key:"updateLoadingStyle",value:function(){var e=document.getElementById(K);if(!e)return;var t="assets/public/logo-128x128.png";t="public/logo-128x128.png";var n=e.querySelector("#lds-game-icon");if(n&&_instanceof(n,HTMLElement))n.style.backgroundImage="url(".concat(t,")"),n.style.backgroundColor="transparent";var r=e.querySelector("#lds-game-icon-blur");if(r&&_instanceof(r,HTMLElement))r.style.backgroundImage="url(".concat(t,")"),r.style.backgroundColor="transparent"}},{key:"setLoadingProgress",value:function(e){if(this.percentage>=e)return;if(this.percentage=e,this.percentage>=100)this.percentage=100;var t=document.getElementById("lds-percent");if(!t)return;t.innerHTML="".concat(e)}},{key:"displayWarnLoading",value:function(e){var t=document.getElementById("lds-warn-text");if(!t)return;if(clearTimeout(v),e)t.style.display="block",t.offsetWidth,t.style.opacity="0.8";else t.style.opacity="0",v=setTimeout(function(){t.style.display="none"},300)}},{key:"removeLoadingElement",value:function(){var e=document.getElementById(K);if(!e)return;e.style.opacity="0",setTimeout(function(){e.remove()},300)}}]),_LoadingScreenElement}();__name(j,"LoadingScreenElement"),I(),A(),P();var z=/*#__PURE__*/function(e){function _SDKCommonError(e,t){var n;return _class_call_check(this,_SDKCommonError),__publicField(n=_call_super(this,_SDKCommonError,[t]),"code"),n.code=e,n}return _inherits(_SDKCommonError,e),_SDKCommonError}(_wrap_native_super(Error));__name(z,"SDKCommonError");var W=/*#__PURE__*/function(){function _Extra(e){_class_call_check(this,_Extra),__publicField(this,"adapter"),__publicField(this,"isGuest",false),__publicField(this,"isPopupShown",false),__publicField(this,"maxWaitGameCoreReadyTime",1e4),__publicField(this,"loadingElement",null),this.adapter=e}return _create_class(_Extra,[{key:"isRestricted",value:function(){return false}},{key:"subscribeBotAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a;return _ts_generator(this,function(o){switch(o.label){case 0:return[4,e.adapter.player.canSubscribeBotAsync()];case 1:if(!o.sent())return[2,false];t=window.game.analytics,r=(n=GameCore.Plugins.Analytics.Events).BOT_SUBSCRIBE,a=n.BOT_SUBSCRIBE_POPUP,t.event(a),o.label=2;case 2:return o.trys.push([2,5,,6]),[4,e.waitSDKInitiatedAsync()];case 3:return o.sent(),[4,e.adapter.player.subscribeBotAsync()];case 4:return o.sent(),t.event(r,{success:true}),[2,true];case 5:return o.sent(),t.event(r,{success:false}),[2,false];case 6:return[2]}})})()}},{key:"checkAndCreateShortcutAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a;return _ts_generator(this,function(o){switch(o.label){case 0:return[4,e.adapter.canCreateShortcutAsync()];case 1:if(!o.sent())return[2];t=window.game.analytics,r=(n=GameCore.Plugins.Analytics.Events).SHORTCUT_CREATE,a=n.SHORTCUT_CREATE_POPUP,t.event(a),o.label=2;case 2:return o.trys.push([2,5,,6]),[4,e.waitSDKInitiatedAsync()];case 3:return o.sent(),[4,e.adapter.createShortcutAsync()];case 4:return o.sent(),t.event(r,{success:true}),[3,6];case 5:return o.sent(),t.event(r,{success:false}),[3,6];case 6:return[2]}})})()}},{key:"waitSDKInitiatedAsync",value:function(){return GameCore.Utils.Valid.isValueChangeAsync(function(){return window.__sdkInitiated},true,{timeout:1e4,checkInterval:100})}},{key:"waitGameCoreReadyAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){return t=0,[2,new Promise(function(n){var r=setInterval(function(){if("GameCore"in window){clearInterval(r),n();return}if((t+=10)>e.maxWaitGameCoreReadyTime)t=0,console.warn("GameCore is slow to load, please check your network connection.")},10)})]})})()}},{key:"createLoadingElement",value:function(){if(this.loadingElement)return;this.loadingElement=new j}},{key:"setLoadingElementProgress",value:function(e){if(!this.loadingElement)return;this.loadingElement.setLoadingProgress(e)}},{key:"displayWarnLoading",value:function(e){if(!this.loadingElement)return;this.loadingElement.displayWarnLoading(e)}},{key:"destroyLoadingElement",value:function(){if(!this.loadingElement)return;this.loadingElement.removeLoadingElement()}},{key:"checkPopupShown",value:function(){if(!this.isPopupShown)return;this.exceptionPendingRequest("Please wait for the popup to close")}},{key:"delayInitialAsync",value:function(){return _async_to_generator(function(){var e,t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e=GameCore.Utils.Time,!(t=GameCore.Configs.Mockup.GameSDK.SlowAPI).Enabled||t.InitialDelay<=0)return[2];return[4,e.sleepAsync(t.InitialDelay)];case 1:return n.sent(),[2]}})})()}},{key:"delayStartAsync",value:function(){return _async_to_generator(function(){var e,t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e=GameCore.Configs.Mockup.GameSDK.SlowAPI,t=GameCore.Utils.Time,!e.Enabled||e.StartDelay<=0)return[2];return[4,t.sleepAsync(e.StartDelay)];case 1:return n.sent(),[2]}})})()}},{key:"delayPlayerDataAsync",value:function(){return _async_to_generator(function(){var e,t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e=GameCore.Configs.Mockup.GameSDK.SlowAPI,t=GameCore.Utils.Time,!e.Enabled||e.PlayerDataDelay<=0)return[2];return[4,t.sleepAsync(e.PlayerDataDelay)];case 1:return n.sent(),[2]}})})()}},{key:"awaitRandomDelay",value:function(e){var t=arguments.length>0&&void 0!==e?e:1e3;return GameCore.Utils.Time.sleepAsync(Math.random()*t)}},{key:"randomException",value:function(e){var t=Math.floor(Math.random()*e.length);var n=e[t];console.warn("Random exception",n),this["exception".concat(n)]()}},{key:"getErrorMessage",value:function(e){var t=GameCore.Utils,n=t.Valid;if(!t.Object.hasOwn(e,"message")||!n.isString(e.message))return null;return e.message}},{key:"throwNewCommonError",value:function(e,t){throw new z(e,t)}},{key:"exceptionUserInput",value:function(e){this.throwNewCommonError("USER_INPUT",e)}},{key:"exceptionUnsupported",value:function(){this.throwNewCommonError("UNSUPPORTED","Unsupported method")}},{key:"exceptionInvalidParam",value:function(e){this.throwNewCommonError("INVALID_PARAM",e)}},{key:"exceptionPendingRequest",value:function(e){this.throwNewCommonError("PENDING_REQUEST",e)}},{key:"exceptionMethodNotImplemented",value:function(){this.throwNewCommonError("METHOD_NOT_IMPLEMENTED","Method not implemented")}},{key:"exceptionTournamentNotFound",value:function(e){this.throwNewCommonError("TOURNAMENT_NOT_FOUND",e)}},{key:"exceptionSameContext",value:function(){this.throwNewCommonError("SAME_CONTEXT","Must specify a context other than the current one.")}},{key:"exceptionInvalidOperation",value:function(e){this.throwNewCommonError("INVALID_OPERATION",e)}},{key:"exceptionNetworkFailure",value:function(e){var t=arguments.length>0&&void 0!==e?e:"Request failed to be processed";this.throwNewCommonError("NETWORK_FAILURE",t)}},{key:"exceptionUnknown",value:function(e){this.throwNewCommonError("UNKNOWN",e)}},{key:"exceptionClientUnsupportedOperation",value:function(e){this.throwNewCommonError("CLIENT_UNSUPPORTED_OPERATION",e)}},{key:"exceptionRateLimited",value:function(e){this.throwNewCommonError("RATE_LIMITED",e)}}]),_Extra}();__name(W,"Extra"),I(),A(),P();var V="Save The Pets".replace(/ /g,"-");var H=/*#__PURE__*/function(){function _Player(e){var t=this;_class_call_check(this,_Player),__publicField(this,"adapter"),__publicField(this,"extra"),__publicField(this,"defaultPlayerInfo"),__publicField(this,"currentPlayerInfo"),__publicField(this,"infoKey","".concat(V,"_PlayerInfo")),__publicField(this,"dataKey","".concat(V,"_PlayerData")),__publicField(this,"subscribeBot",null),__publicField(this,"connectedPlayers",null),__publicField(this,"getSignature",/* @__PURE__ */__name(function(){var e=t.getSignatureFormMockup();if(GameCore.Utils.Valid.isString(e))return e;return"default_token"},"getSignature")),this.adapter=e,this.extra=e.extra,this.initDefaultPlayerInfo()}return _create_class(_Player,[{key:"initDefaultPlayerInfo",value:function(){var e="guest-007";this.defaultPlayerInfo={playerId:e,playerName:"Guest",playerPhoto:"https://picsum.photos/seed/".concat(e,"/300/300")},this.extra.isGuest=true,this.currentPlayerInfo=_object_spread({},this.defaultPlayerInfo)}},{key:"initPlayerInfo",value:function(e){this.updateCurrentPlayerInfo(e),GameCore.Utils.Browser.writeLocalStorage(this.infoKey,this.currentPlayerInfo)}},{key:"canSubscribeBotAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.loadMockSubscribeBot()];case 1:if(t.sent(),!e.subscribeBot)e.extra.exceptionUnsupported();return[2,e.subscribeBot.canSubscribeBotAsync()]}})})()}},{key:"subscribeBotAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.loadMockSubscribeBot()];case 1:if(t.sent(),!e.subscribeBot)e.extra.exceptionUnsupported();return[2,e.subscribeBot.subscribeBotAsync()]}})})()}},{key:"getID",value:function(){return this.currentPlayerInfo.playerId}},{key:"getName",value:function(){return this.currentPlayerInfo.playerName}},{key:"getPhoto",value:function(){return this.currentPlayerInfo.playerPhoto}},{key:"getDataAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a,o,i,s;return _ts_generator(this,function(c){switch(c.label){case 0:return[4,t.extra.delayPlayerDataAsync()];case 1:if(c.sent(),r=(n=GameCore.Utils).Browser,a=n.Valid,o=n.Object,i=r.getLocalStorage(t.dataKey),!a.isObject(i))return[2,{}];if(0===e.length)return[2,i];return s={},e.forEach(function(e){if(o.hasOwn(i,e))s[e]=i[e]}),[2,s]}})})()}},{key:"setDataAsync",value:function(e){var t=this;return _async_to_generator(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,t.extra.delayPlayerDataAsync()];case 1:return n.sent(),GameCore.Utils.Browser.writeLocalStorage(t.dataKey,e),[2]}})})()}},{key:"getSignedPlayerInfoAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){return[2,{getPlayerID:/* @__PURE__ */__name(function(){var t;return null!==(t=e.getID())&&void 0!==t?t:""},"getPlayerID"),getSignature:e.getSignature}]})})()}},{key:"getConnectedPlayersAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.loadMockConnectedPlayers()];case 1:if(t.sent(),!e.connectedPlayers)e.extra.exceptionUnsupported();return[2,e.connectedPlayers.getConnectedPlayersAsync()]}})})()}},{key:"updateCurrentPlayerInfo",value:function(e){var t,n=GameCore.Utils,r=n.Browser,a=n.Valid,o=n.Object,i=n.String;var s=e;if(this.extra.isGuest){var c=r.getLocalStorage(this.infoKey);if(a.isObject(c)&&o.hasOwn(c,"playerId")&&a.isString(c.playerId))s=c.playerId}if(a.isEmpty(s))s=i.generateObjectId();var u=this.getName();if(a.isEmpty(u))u=null!==(t=window.game.language.getText("core.nameless"))&&void 0!==t?t:"Nameless";this.currentPlayerInfo.playerId=s,this.currentPlayerInfo.playerName=u,this.currentPlayerInfo.playerPhoto="https://picsum.photos/seed/".concat(s,"/300/300"),this.updateMockupPlayerInfo(s)}},{key:"updateMockupPlayerInfo",value:function(e){var t=GameCore.Configs.Mockup.Match,n=t.Enabled,r=t.PlayerInfo,a=t.OpponentInfo;if(!n)return;var o=r.Id===e;var i=a.Id===e;if(o){if(this.currentPlayerInfo.playerId=r.Id,r.Name)this.currentPlayerInfo.playerName=r.Name;if(r.Photo)this.currentPlayerInfo.playerPhoto=r.Photo}if(i){if(this.currentPlayerInfo.playerId=a.Id,a.Name)this.currentPlayerInfo.playerName=a.Name;if(a.Photo)this.currentPlayerInfo.playerPhoto=a.Photo}}},{key:"getSignatureFormMockup",value:function(){var e=GameCore.Configs.Mockup.Match;var t=e.PlayerInfo.Id===this.getID();var n=e.OpponentInfo.Id===this.getID();if(t)return e.PlayerInfo.Signature;if(n)return e.OpponentInfo.Signature;return null}},{key:"loadMockSubscribeBot",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.subscribeBot)return[2];return[4,Promise.resolve().then(function(){return k(),S})];case 1:if("function"!=typeof(t=n.sent().default))return[2];return e.subscribeBot=new t(e.adapter),[2]}})})()}},{key:"loadMockConnectedPlayers",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.connectedPlayers)return[2];return[4,Promise.resolve().then(function(){return N(),L})];case 1:if("function"!=typeof(t=n.sent().default))return[2];return e.connectedPlayers=new t(e.extra),[2]}})})()}}]),_Player}();__name(H,"Player"),I(),A(),P(),I(),A(),P();var Y=/*#__PURE__*/function(){function _TournamentInstance(e,t,n){var r,a=arguments.length>2&&void 0!==n&&n;_class_call_check(this,_TournamentInstance),__publicField(this,"id"),__publicField(this,"title"),__publicField(this,"contextId"),__publicField(this,"payload"),__publicField(this,"endTime"),__publicField(this,"tournamentType");var o=t.config,i=t.data;this.id=e,this.title=o.title,this.contextId="0123".concat(this.id),this.payload=JSON.stringify(null!=i?i:{}),this.endTime=null!==(r=o.endTime)&&void 0!==r?r:this.defaultEndTime(),this.tournamentType=a?"PAGE_HOSTED":"DEFAULT"}return _create_class(_TournamentInstance,[{key:"defaultEndTime",value:function(){return Math.round((Date.now()+6048e5)/1e3)}},{key:"getID",value:function(){return this.id}},{key:"getTitle",value:function(){return this.title}},{key:"getPayload",value:function(){return this.payload}},{key:"getEndTime",value:function(){return this.endTime}},{key:"getContextID",value:function(){return this.contextId}},{key:"getTournamentType",value:function(){return this.tournamentType}},{key:"toObject",value:function(){return{id:this.id,title:this.title,payload:this.payload,endTime:this.endTime,contextId:this.contextId,tournamentType:this.tournamentType}}}]),_TournamentInstance}();__name(Y,"TournamentInstance");var q=["Unsupported","NetworkFailure","PendingRequest","ClientUnsupportedOperation"];var X=_to_consumable_array(q).concat(["InvalidParam","UserInput"]);var J=_to_consumable_array(q).concat(["InvalidOperation","UserInput"]);var Q=_to_consumable_array(q).concat(["InvalidParam","UserInput"]);var Z=_to_consumable_array(q).concat(["InvalidParam","UserInput"]);var $=_to_consumable_array(q).concat(["NetworkFailure"]);var ee="TournamentsDataMockKey";var et="TournamentLeadersMockKey";var en=/*#__PURE__*/function(){function _Tournament(e){var t=this;_class_call_check(this,_Tournament);var n=this;__publicField(this,"adapter"),__publicField(this,"extra"),__publicField(this,"context"),__publicField(this,"shareAsyncPopup",null),__publicField(this,"createAsyncPopup",null),__publicField(this,"processEnterTournament",/* @__PURE__ */__name(/*#__PURE__*/function(){var e=_async_to_generator(function(e){return _ts_generator(this,function(t){switch(t.label){case 0:if(!n.getTournamentData(e))return[2];return[4,n.joinAsync(e)];case 1:return t.sent(),[2]}})});return function(t){return e.apply(this,arguments)}}(),"processEnterTournament")),__publicField(this,"handleOnYes",/* @__PURE__ */__name(function(e){return function(){t.extra.isPopupShown=false,e(true)}},"handleOnYes")),__publicField(this,"handleOnNo",/* @__PURE__ */__name(function(e){return function(){t.extra.isPopupShown=false;try{t.extra.exceptionUserInput("Player closed the context menu")}catch(t){e(t)}}},"handleOnNo")),this.adapter=e,this.extra=e.extra,this.context=e.context}return _create_class(_Tournament,[{key:"initTournamentInfoAsync",value:function(e){var t=this;return _async_to_generator(function(){return _ts_generator(this,function(n){switch(n.label){case 0:if(!GameCore.Configs.Mockup.GameSDK.Tournament.Enabled)return[2];return[4,t.createMockTournamentsData()];case 1:if(n.sent(),!e)return[3,3];return[4,t.processEnterTournament(e)];case 2:n.sent(),n.label=3;case 3:return[2]}})})()}},{key:"createMockTournamentsData",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o,i,s,c,u,l,_,d,f,y,p,h,m;return _ts_generator(this,function(g){switch(g.label){case 0:if(t=GameCore.Utils.Object,r=(n=GameCore.Configs.Mockup.GameSDK.Tournament).Enabled,o=(a=n.NumOfTournament).Normal,i=a.HostPage,!r)return[2];return s=e.getTournamentsData(),c=t.vals(s),l=(u=e.filterExpiredTournaments(c)).filter(function(e){return"DEFAULT"===e.tournamentType}),_=u.filter(function(e){return"PAGE_HOSTED"===e.tournamentType}),d=l.length,f=_.length,y=o-d,p=i-f,h=e.createDefaultTournaments(y),m=e.createGlobalTournaments(p),[4,Promise.all(_to_consumable_array(h).concat(_to_consumable_array(m)))];case 1:return g.sent(),[2]}})})()}},{key:"filterExpiredTournaments",value:function(e){var t=Date.now()/1e3;var n=e.filter(function(e){return e.endTime>t});var r={};var a=true,o=false,i=void 0;try{for(var s,c=n[Symbol.iterator]();!(a=(s=c.next()).done);a=true){var u=s.value;r[u.id]=u}}catch(e){o=true,i=e}finally{try{if(!a&&null!=c.return)c.return()}finally{if(o)throw i}}return this.writeTournamentsData(r),n}},{key:"createDefaultTournaments",value:function(e){var t=GameCore.Utils,n=t.String,r=t.Array,a=t.Number,o=GameCore.Configs.Mockup.GameSDK.Tournament.ExtraPlayerTournamentPayload;var i=window.game.leaderboard;var s=GameSDK.player.getID();var c=GameSDK.player.getName();var u=this;return r.length(e).map(/*#__PURE__*/_async_to_generator(function(){var e,t,r,l,_;return _ts_generator(this,function(d){switch(d.label){case 0:return e="".concat(c,"'s Tournament ").concat(n.generateObjectId()),[4,i.createLeaderboardAsync({name:e})];case 1:if(t=d.sent(),r=u.createMockTournamentAsync({initialScore:0,config:{title:e,tournamentTitle:e},data:_object_spread({playerId:s,playerName:c,leaderboardId:t},o)}).getID().toString(),u.getTournamentLeadersData(r))return[2];return l=a.random(2),(_=window.game.player.getConnectedPlayerIds(l,0).map(function(e){return{playerId:e,score:a.random(4)}})).sort(function(e,t){return e.score-t.score}),u.writeTournamentLeadersData(r,_),[2]}})}))}},{key:"createGlobalTournaments",value:function(e){var t=GameCore.Utils,n=t.String,r=t.Array,a=t.Number,o=GameCore.Configs.Mockup.GameSDK.Tournament.ExtraGlobalTournamentPayload;var i=window.game.leaderboard;var s=this;return r.length(e).map(/*#__PURE__*/_async_to_generator(function(){var e,t,c,u,l,_;return _ts_generator(this,function(d){switch(d.label){case 0:return t=_object_spread({leaderboardId:e=n.generateObjectId(),playerId:"global"},o),c="Global Tournament ".concat(e),[4,i.createLeaderboardAsync({name:c,_id:e,type:"world_tournament_leaderboard",description:JSON.stringify(t)})];case 1:if(d.sent(),u=s.createMockTournamentAsync({initialScore:0,config:{title:c,tournamentTitle:c},data:t},true).getID().toString(),s.getTournamentLeadersData(u))return[2];return l=a.random(2),(_=r.length(l).map(function(){return{playerId:n.generateObjectId(),score:a.random(4)}})).sort(function(e,t){return e.score-t.score}),s.writeTournamentLeadersData(u,_),[2]}})}))}},{key:"awaitRandomDelay",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){return t=GameCore.Configs.Mockup.GameSDK.Tournament.RandomDelayMs,[2,e.extra.awaitRandomDelay(t)]})})()}},{key:"randomError",value:function(e){if(!(100*Math.random()<GameCore.Configs.Mockup.GameSDK.Tournament.ErrorRates))return;this.extra.randomException(e)}},{key:"loadCreateTournamentPopupAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.createAsyncPopup)return[2];return[4,Promise.resolve().then(function(){return B(),M})];case 1:if("function"!=typeof(t=n.sent().default))return[2];return e.createAsyncPopup=new t,[2]}})})()}},{key:"loadSharePopupAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.shareAsyncPopup)return[2];return[4,Promise.resolve().then(function(){return U(),F})];case 1:if("function"!=typeof(t=n.sent().default))return[2];return e.shareAsyncPopup=new t,[2]}})})()}},{key:"createAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r;return _ts_generator(this,function(a){switch(a.label){case 0:return t.extra.checkPopupShown(),[4,t.awaitRandomDelay()];case 1:if(a.sent(),null!==t.context.getID())t.extra.exceptionInvalidOperation("Cannot create tournament while in a context");return t.validateCreatePayload(e),t.randomError(X),[4,t.loadCreateTournamentPopupAsync()];case 2:return a.sent(),[4,new Promise(function(n,r){if(!t.createAsyncPopup)t.adapter.extra.exceptionUnsupported();t.createAsyncPopup.onYes(t.handleOnYes(n)),t.createAsyncPopup.onNo(t.handleOnNo(r)),t.createAsyncPopup.show(e),t.extra.isPopupShown=true})];case 3:return a.sent(),r=(n=t.createMockTournamentAsync(e)).getContextID(),t.setCurrentContextID(r),[2,n]}})})()}},{key:"createMockTournamentAsync",value:function(e,t){var n=arguments.length>1&&void 0!==t&&t;var r=GameCore.Utils.String.generateObjectId();var a=new Y(r,e,n);var o=a.toObject();return this.writeTournamentData(r,o),a}},{key:"postScoreAsync",value:function(e){var t=this;return _async_to_generator(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:return[4,t.awaitRandomDelay()];case 1:if(r.sent(),t.validateAvailableTournament(),e<0)t.extra.exceptionInvalidParam("Score must be a positive number");return t.randomError(Z),n=window.game.player.getPlayerId(),t.updateBestScore(n,e),[2]}})})()}},{key:"shareAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a,o,i,s,c;return _ts_generator(this,function(u){switch(u.label){case 0:return t.extra.checkPopupShown(),[4,t.awaitRandomDelay()];case 1:return u.sent(),t.validateAvailableTournament(),t.validateSharePayload(e),t.randomError(Q),[4,t.loadSharePopupAsync()];case 2:if(u.sent(),r=n=e.score,a=t.getCurrentTournament()){if(o=window.game.player.getPlayerId(),i=a.getID().toString(),(s=t.getBestScore(i,o))&&s<n)r=s}return[4,new Promise(function(e,n){if(!t.shareAsyncPopup)t.adapter.extra.exceptionUnsupported();t.shareAsyncPopup.onYes(t.handleOnYes(e)),t.shareAsyncPopup.onNo(t.handleOnNo(n)),t.shareAsyncPopup.show(r),t.extra.isPopupShown=true})];case 3:return u.sent(),c=window.game.player.getPlayerId(),t.updateBestScore(c,n),[2]}})})()}},{key:"getTournamentsAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:return[4,e.awaitRandomDelay()];case 1:return n.sent(),e.randomError($),t=e.getTournamentsData(),[2,GameCore.Utils.Object.vals(t).map(function(t){return e.getTournamentInstance(t.id)}).filter(function(e){return null!==e})]}})})()}},{key:"joinAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r;return _ts_generator(this,function(a){switch(a.label){case 0:return[4,t.awaitRandomDelay()];case 1:if(a.sent(),!GameCore.Utils.Valid.isString(e))t.extra.exceptionInvalidParam("Tournament ID must be a string");if(!(n=t.getTournamentInstance(e)))t.extra.exceptionTournamentNotFound("Tournament could not be found.");return t.randomError(J),r=n.getContextID(),[4,GameSDK.context.switchAsync(r)];case 2:return a.sent(),[2]}})})()}},{key:"setCurrentContextID",value:function(e){if(_instanceof(this.context,R))this.context.setCurrentContextId(e)}},{key:"getCurrentTournament",value:function(){var e=this.context.getID();if(!e)return null;var t=this.getTournamentsData();for(var n in t)if(Object.hasOwn(t,n)){if(t[n].contextId===e)return this.getTournamentInstance(n)}return null}},{key:"validateCreatePayload",value:function(e){var t=GameCore.Utils,n=t.Object,r=t.Valid;if(!r.isObject(e))this.extra.exceptionInvalidParam("Payload must be an object");if(!n.hasOwn(e,"initialScore"))this.extra.exceptionInvalidParam("Payload must have initialScore");if(!n.hasOwn(e,"config"))this.extra.exceptionInvalidParam("Payload must have config");var a=e.initialScore,o=e.config;if(!r.isNumber(a))this.extra.exceptionInvalidParam("initialScore must be a number");if(!r.isObject(o))this.extra.exceptionInvalidParam("Config must be an object");if(!n.hasOwn(o,"title"))this.extra.exceptionInvalidParam("Config must have title");if(!n.hasOwn(o,"tournamentTitle"))this.extra.exceptionInvalidParam("Config must have tournamentTitle");if(n.hasOwn(e,"data")&&!r.isObject(e.data))this.extra.exceptionInvalidParam("Data must be an object")}},{key:"validateSharePayload",value:function(e){var t=GameCore.Utils,n=t.Object,r=t.Valid;if(!r.isObject(e))this.extra.exceptionInvalidParam("Payload must be an object");if(!n.hasOwn(e,"score"))this.extra.exceptionInvalidParam("Payload must have score");var a=e.score;if(!r.isNumber(a))this.extra.exceptionInvalidParam("Score must be a number");if(n.hasOwn(e,"data")&&!r.isObject(e.data))this.extra.exceptionInvalidParam("Data must be an object")}},{key:"validateAvailableTournament",value:function(){if(this.getCurrentTournament())return;this.extra.exceptionTournamentNotFound("There is no tournament for this context.")}},{key:"getTournamentInstance",value:function(e){var t=this.getTournamentData(e);if(!t)return null;return{getID:/* @__PURE__ */__name(function(){return t.id},"getID"),getTitle:/* @__PURE__ */__name(function(){return t.title},"getTitle"),getPayload:/* @__PURE__ */__name(function(){return t.payload},"getPayload"),getEndTime:/* @__PURE__ */__name(function(){return t.endTime},"getEndTime"),getContextID:/* @__PURE__ */__name(function(){return t.contextId},"getContextID"),getTournamentType:/* @__PURE__ */__name(function(){return t.tournamentType},"getTournamentType")}}},{key:"getTournamentData",value:function(e){var t=this.getTournamentsData();if(!t[e])return null;return t[e]}},{key:"writeTournamentData",value:function(e,t){var n=this.getTournamentsData();n[e]=t,this.writeTournamentsData(n)}},{key:"getTournamentsData",value:function(){var e=GameCore.Utils,t=e.Browser,n=e.Valid;var r=t.getLocalStorage(ee);if(!n.isObject(r))return{};return r}},{key:"writeTournamentsData",value:function(e){var t=GameCore.Utils,n=t.Browser;if(!t.Valid.isObject(e))return;n.writeLocalStorage(ee,e)}},{key:"getBestScore",value:function(e,t){var n,r=this.getTournamentLeader(e,t);if(!r)return null;return null!==(n=r.score)&&void 0!==n?n:null}},{key:"updateBestScore",value:function(e,t){var n=this.getCurrentTournament();if(!n)return;var r=n.getID().toString();if(!r)return;var a=this.getTournamentLeader(r,e);if(!a){this.writeTournamentLeader(r,{playerId:e,score:t});return}if(a.score<t)a.score=t,this.writeTournamentLeader(r,a)}},{key:"getTournamentLeader",value:function(e,t){var n,r=this.getTournamentLeadersData(e);if(!r.length)return null;return null!==(n=GameCore.Utils.Array.search(r,function(e){return e.playerId===t}))&&void 0!==n?n:null}},{key:"getTournamentLeadersData",value:function(e){var t=GameCore.Utils,n=t.Browser,r=t.Object;var a=n.getLocalStorage(et);if(!r.hasOwn(a,e))return[];var o=a[e];if(!Array.isArray(o))return[];return o.sort(function(e,t){return t.score-e.score}),o}},{key:"writeTournamentLeader",value:function(e,t){var n=GameCore.Utils.Array;var r=this.getTournamentLeadersData(e);var a=n.searchIndex(r,function(e){return e.playerId===t.playerId});if(-1===a)r.push(t);else r[a]=t;this.writeTournamentLeadersData(e,r)}},{key:"writeTournamentLeadersData",value:function(e,t){var n,r=GameCore.Utils,a=r.Browser,o=r.Object;if(!Array.isArray(t))return;var i=null!==(n=a.getLocalStorage(et))&&void 0!==n?n:{};o.assign(i,_define_property({},e,t)),a.writeLocalStorage(et,i)}}]),_Tournament}();__name(en,"Tournament");var er=/*#__PURE__*/function(){function _GameSDK(){_class_call_check(this,_GameSDK),__publicField(this,"extra"),__publicField(this,"player"),__publicField(this,"context"),__publicField(this,"tournament"),__publicField(this,"shortcut",null),__publicField(this,"isInitialized",false),__publicField(this,"bannerAdInstances",{}),__publicField(this,"rewardedVideoInstance",null),__publicField(this,"interstitialAdInstance",null),__publicField(this,"rewardedInterstitialInstance",null)}return _create_class(_GameSDK,[{key:"initialize",value:function(){this.extra=new W(this),this.player=new H(this),this.context=new R(this),this.tournament=new en(this)}},{key:"isNeedSDK",value:function(){var t=e;return(null==t?void 0:t.AllowWithoutSDK)!==true}},{key:"getLocale",value:function(){return GameCore.Utils.Browser.getLocale()}},{key:"getPlatform",value:function(){var e=GameCore.Utils.Device;if(e.isAndroid())return"ANDROID";if(e.isIOS())return"IOS";if(e.isDesktop())return"WEB";if(e.isMobile())return"MOBILE_WEB";return null}},{key:"getSDKName",value:function(){return"GameCore"}},{key:"getSDKVersion",value:function(){return"1.0.0"}},{key:"initializeAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a;return _ts_generator(this,function(o){switch(o.label){case 0:if(e.isInitialized)return[2];if(e.initialize(),e.extra.createLoadingElement(),!e.isNeedSDK())return[3,2];return[4,e.checkSDKInitialized()];case 1:o.sent(),o.label=2;case 2:return[4,e.extra.waitGameCoreReadyAsync()];case 3:return o.sent(),[4,e.extra.delayInitialAsync()];case 4:if(o.sent(),console.info("Browser params:",t=GameCore.Utils.Browser.getQueryParams()),t.splashPreview)return e.extra.destroyLoadingElement(),[2];return n=t.playerId,e.player.initPlayerInfo(n),r=t.context_source_id,a=t.context_type,e.context.initContextInfo(r,a),e.isInitialized=true,[2]}})})()}},{key:"checkSDKInitialized",value:function(){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2]})})()}},{key:"startGameAsync",value:function(e){var t=!(arguments.length>0)||void 0===e||e;var n=this;return _async_to_generator(function(){var e,r;return _ts_generator(this,function(a){switch(a.label){case 0:if(!n.isInitialized)n.extra.exceptionInvalidOperation("GameSDK is not initialized");return[4,n.extra.delayStartAsync()];case 1:return a.sent(),window.__sdkLoadingCount=90,n.setLoadingProgress(90),setTimeout(function(){n.extra.destroyLoadingElement()},500),e=GameCore.Events,r=(0,GameCore.Utils.Browser.getQueryParams)().tournament_id,[4,n.tournament.initTournamentInfoAsync(r)];case 2:if(a.sent(),t)window.game.event.emit(e.GAME_SDK_STARTED);return[2]}})})()}},{key:"setLoadingProgress",value:function(e){this.extra.setLoadingElementProgress(e)}},{key:"getEntryPointData",value:function(){var e=GameCore.Utils,t=e.Browser,n=e.Json;var r=t.getQueryParams().payload,a=void 0===r?"{}":r;if("string"!=typeof a)return{};return n.decode(a)}},{key:"getEntryPointAsync",value:function(){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2,"no_entry"]})})()}},{key:"loadBannerAdAsync",value:function(e){var t=this;return _async_to_generator(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:if(!e)return[2];if(!!t.bannerAdInstances[e])return[3,2];return[4,Promise.resolve().then(function(){return k(),S})];case 1:if("function"!=typeof(n=r.sent().default))t.extra.exceptionInvalidOperation("Banner ads mock is not enabled");t.bannerAdInstances[e]=new n("banner",e),r.label=2;case 2:return[4,t.bannerAdInstances[e].loadAsync()];case 3:return r.sent(),[4,t.bannerAdInstances[e].showAsync()];case 4:return r.sent(),[2]}})})()}},{key:"hideBannerAdAsync",value:function(e){var t=this;return _async_to_generator(function(){return _ts_generator(this,function(n){switch(n.label){case 0:if(!t.bannerAdInstances[e])return[2];return[4,t.bannerAdInstances[e].hideAsync()];case 1:return n.sent(),[2]}})})()}},{key:"getBannerHeight",value:function(e){return e.BannerHeight}},{key:"getInterstitialAdAsync",value:function(e){var t=this;return _async_to_generator(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:if(!!t.interstitialAdInstance)return[3,2];return[4,Promise.resolve().then(function(){return k(),S})];case 1:if("function"!=typeof(n=r.sent().default))t.extra.exceptionInvalidOperation("Interstitial ads mock is not enabled");t.interstitialAdInstance=new n("interstitial",e),r.label=2;case 2:return[2,t.interstitialAdInstance]}})})()}},{key:"getRewardedVideoAsync",value:function(e){var t=this;return _async_to_generator(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:if(!!t.rewardedVideoInstance)return[3,2];return[4,Promise.resolve().then(function(){return k(),S})];case 1:if("function"!=typeof(n=r.sent().default))t.extra.exceptionInvalidOperation("Rewarded video ads mock is not enabled");t.rewardedVideoInstance=new n("rewarded",e),r.label=2;case 2:return[2,t.rewardedVideoInstance]}})})()}},{key:"getRewardedInterstitialAsync",value:function(e){var t=this;return _async_to_generator(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:if(!!t.rewardedInterstitialInstance)return[3,2];return[4,Promise.resolve().then(function(){return k(),S})];case 1:if("function"!=typeof(n=r.sent().default))t.extra.exceptionInvalidOperation("Rewarded interstitial ads mock is not enabled");t.rewardedInterstitialInstance=new n("rewarded_interstitial",e),r.label=2;case 2:return[2,t.rewardedInterstitialInstance]}})})()}},{key:"getTournamentAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o;return _ts_generator(this,function(i){switch(i.label){case 0:if(e.tournament.randomError(["Unsupported","NetworkFailure"]),t=e.context.getID(),r=(n=GameCore.Utils).Array,!n.Valid.isString(t))e.extra.exceptionInvalidOperation("Not in a context");return[4,e.tournament.getTournamentsAsync()];case 1:if(a=i.sent(),!(o=r.search(a,function(e){return e.getContextID()===t})))e.extra.exceptionTournamentNotFound("A Tournament with current context was not found");return[2,o]}})})()}},{key:"getSupportedAPIs",value:function(){if(GameCore.Configs.Mockup.GameSDK.Player.SubscribeBot.CanSubscribeBot)return["player.canSubscribeBotAsync"];return[]}},{key:"canCreateShortcutAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.loadMockAddShortcut()];case 1:if(t.sent(),!e.shortcut)e.extra.exceptionUnsupported();return[2,e.shortcut.canCreateShortcutAsync()]}})})()}},{key:"createShortcutAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.loadMockAddShortcut()];case 1:if(t.sent(),!e.shortcut)e.extra.exceptionUnsupported();return[2,e.shortcut.createShortcutAsync()]}})})()}},{key:"loadMockAddShortcut",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.shortcut)return[2];return[4,Promise.resolve().then(function(){return k(),S})];case 1:if("function"!=typeof(t=n.sent().default))return[2];return e.shortcut=new t(e),[2]}})})()}}]),_GameSDK}();__name(er,"GameSDK"),I(),A(),P(),I(),A(),P();var ea=/*#__PURE__*/function(){function _AdInstance(e,t){_class_call_check(this,_AdInstance),__publicField(this,"type"),__publicField(this,"placementId"),this.type=e,this.placementId=t}return _create_class(_AdInstance,[{key:"getPlacementID",value:function(){return this.placementId}},{key:"hideAsync",value:function(){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2,Promise.resolve()]})})()}}]),_AdInstance}();__name(ea,"AdInstance");var eo={instanceId:""};var ei={AD_NOT_LOADED:"AD_NOT_LOADED",LOAD_ADS_FAILURE:"LOAD_ADS_FAILURE",INVALID_OPERATION:"INVALID_OPERATION",SHOW_ADS_FAILURE:"SHOW_ADS_FAILURE",SHOW_ADS_TIMEOUT:"SHOW_ADS_TIMEOUT",SHOW_ADS_COMPLETED_FAILURE:"SHOW_ADS_COMPLETED_FAILURE"};var es=/*#__PURE__*/function(e){function _MSAdInstance(e,t){var n;return _class_call_check(this,_MSAdInstance),__publicField(n=_call_super(this,_MSAdInstance,[e,""]),"sdk"),__publicField(n,"type"),__publicField(n,"instance"),__publicField(n,"isAdDisplayed",false),__publicField(n,"isAdShowInProgress",false),n.sdk=t,n.type=e,n.instance=eo,n}return _inherits(_MSAdInstance,e),_create_class(_MSAdInstance,[{key:"getPlacementID",value:function(){return this.instance.instanceId}},{key:"resetInstance",value:function(){this.instance=eo}},{key:"loadAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n;return _ts_generator(this,function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),e.isAdShowInProgress)throw e.makeErrorWithCode(ei.INVALID_OPERATION,"Can't load ads while showing ads");if(e.instance.instanceId)return console.debug("MSAdInstance loadAsync already loaded"),[2];return[4,e.sdk.loadAdsAsync({isRewardedAd:"rewarded"===e.type,canBackfill:false})];case 1:return t=r.sent(),e.instance=t,[3,3];case 2:throw n=r.sent(),e.makeErrorWithCode(ei.LOAD_ADS_FAILURE,n);case 3:return[2]}})})()}},{key:"showAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n;return _ts_generator(this,function(r){if(!e.instance.instanceId)throw e.makeErrorWithCode(ei.AD_NOT_LOADED,"Ad is not loaded. InstanceId is empty");if(e.isAdShowInProgress)throw e.makeErrorWithCode(ei.INVALID_OPERATION,"Can't show ads while showing ads");return e.isAdDisplayed=false,e.isAdShowInProgress=true,t=e.processShowAd(e.instance.instanceId),n=e.scheduleShowingAdTimeout(1e4),[2,new Promise(function(r,a){Promise.race([t,n]).then(function(){if(!e.isAdDisplayed){a(e.makeErrorWithCode(ei.SHOW_ADS_TIMEOUT,"Showing ad is timed out"));return}t.then(function(){r(),console.debug("MSAdInstance showAsync completed")}).catch(function(e){a(e)})}).catch(function(e){a(e)}).finally(function(){e.isAdShowInProgress=false})})]})})()}},{key:"processShowAd",value:function(e){var t=this;return _async_to_generator(function(){var n,r;return _ts_generator(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,4,5]),[4,t.sdk.showAdsAsync(e)];case 1:if(n=a.sent(),!t.isPromise(n.showAdsCompletedAsync))throw t.makeErrorWithCode(ei.SHOW_ADS_FAILURE,new Error("The showAdsCompletedAsync promise is empty"));return t.isAdDisplayed=true,[4,n.showAdsCompletedAsync];case 2:return console.debug("MSAdInstance processShowAd:",a.sent()),[3,5];case 3:if(r=a.sent(),t.isErrorWithCode(r)&&r.code===ei.SHOW_ADS_COMPLETED_FAILURE)r.code="USER_INPUT";throw t.makeErrorWithCode(ei.SHOW_ADS_FAILURE,r);case 4:return t.resetInstance(),[7];case 5:return[2]}})})()}},{key:"scheduleShowingAdTimeout",value:function(e){return _async_to_generator(function(){return _ts_generator(this,function(t){return[2,new Promise(function(t,n){setTimeout(function(){t()},e)})]})})()}},{key:"isPromise",value:function(e){return(void 0===e?"undefined":_type_of(e))==="object"&&null!==e&&"function"==typeof e.then}},{key:"isErrorWithCode",value:function(e){return GameCore.Utils.Object.hasOwn(e,"code")&&"string"==typeof e.code}},{key:"getErrorReason",value:function(e){var t=GameCore.Utils.Object;if(t.hasOwn(e,"message")&&"string"==typeof e.message)return{reason:e.message};if(t.hasOwn(e,"description")&&"string"==typeof e.description)return{reason:e.description};return null}},{key:"parseError",value:function(e){try{return"string"==typeof e?e:JSON.stringify(e)}catch(e){return"Unknown error"}}},{key:"makeErrorWithCode",value:function(e,t){var n,r,a=e;var o=null!==(r=null===(n=this.getErrorReason(t))||void 0===n?void 0:n.reason)&&void 0!==r?r:"";if(!o)o=this.parseError(t);if(this.isErrorWithCode(t))a=t.code;return new z(a,o)}}]),_MSAdInstance}(ea);__name(es,"MSAdInstance"),I(),A(),P();var ec=/*#__PURE__*/function(e){function _MSContext(){return _class_call_check(this,_MSContext),_call_super(this,_MSContext,arguments)}return _inherits(_MSContext,e),_create_class(_MSContext,[{key:"getID",value:function(){return this.currentContextID}},{key:"getType",value:function(){return this.currentContextType}},{key:"switchAsync",value:function(e,t){var n=arguments.length>1&&void 0!==t&&t;var r=this;return _async_to_generator(function(){return _ts_generator(this,function(t){if(r.validateSwitchAsyncContextId(e),"SOLO"===e&&n)return r.currentContextID=null,r.currentContextType="SOLO",[2];return r.currentContextID=e,r.currentContextType="THREAD",[2]})})()}},{key:"getPlayersAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.extra.awaitRandomDelay()];case 1:return t.sent(),[2,e.currentContextPlayers]}})})()}}]),_MSContext}(R);__name(ec,"MSContext"),I(),A(),P(),I(),A(),P();var eu="How about diving into the game for a relaxing experience?";var el=/*#__PURE__*/function(){function _MSDailyNotification(){_class_call_check(this,_MSDailyNotification)}return _create_class(_MSDailyNotification,[{key:"sendDailyNotificationInstance",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){try{if(!GameCore.Configs.GameSDKOptions.MSGames.ScheduleNotification)throw new Error("MsGamesNotification content not set up!");t=e.getNotificationPayloads(),e.batchSendNotification(t),e.updatePlayerNotificationData(t)}catch(e){console.warn(e)}return[2]})})()}},{key:"getNotificationPayloads",value:function(){var e;var t=globalThis.game.player.getNotificationData();var n={};var r=[];var a=Date.now();var o=a;for(var i=1;i<=7;i++){var s="D".concat(i);var c=(null===(e=t[s])||void 0===e?void 0:e.arrivalDate)||0;if(a<c){o=Math.max(o,c);continue}r.push(s)}if(0===r.length)return n;var u=Math.floor(o-a)/1e3;for(var l=0;l<r.length;l++){var _=r[l];var d=parseInt(_.replace("D",""));var f={description:this.getNotificationContent(_),minDelayInSeconds:86400*(l+1)+u,type:d};n[_]=f}return n}},{key:"getNotificationContent",value:function(e){var t=GameCore.Configs.GameSDKOptions.MSGames.ScheduleNotification;if(!t)throw new Error("MsGamesNotification content not set up!");if(this.validateNotificationKey(e)){var n=t[e];if(!n||""===n)return eu;return n}return eu}},{key:"updatePlayerNotificationData",value:function(e){var t=globalThis.game.player;var n=t.getNotificationData();var r=Date.now();for(var a=1;a<=7;a++){var o="D".concat(a);var i=e[o];if(!!i){var s=i.minDelayInSeconds;if(!!s)n[o]={arrivalDate:r+1e3*s}}}t.setPlayerDataByName("notificationData",n)}},{key:"batchSendNotification",value:function(e){if(!("scheduleNotificationAsync"in GameSDK.extra))throw new Error("scheduleNotificationAsync is not available!");for(var t=1;t<=7;t++){var n=e["D".concat(t)];if(!!n)GameSDK.extra.scheduleNotificationAsync(n)}}},{key:"validateNotificationKey",value:function(e){return GameCore.Utils.Array.has(["D1","D2","D3","D4","D5","D6","D7"],e)}}],[{key:"sendDailyNotification",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){return[2,e.getInstance().sendDailyNotificationInstance()]})})()}},{key:"getInstance",value:function(){if(!this._instance)this._instance=new _MSDailyNotification;return this._instance}}]),_MSDailyNotification}();__name(el,"MSDailyNotification"),__publicField(el,"_instance");var e_="Save The Pets";var ed=/*#__PURE__*/function(e){function _MSExtra(e){var t;return _class_call_check(this,_MSExtra),__publicField(t=_call_super(this,_MSExtra,[e]),"sdk"),__publicField(t,"shareImageBase64"),__publicField(t,"notificationImageBase64"),t.sdk=e.sdk,t.adapter=e,t}return _inherits(_MSExtra,e),_create_class(_MSExtra,[{key:"shareAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(n.trys.push([0,4,,5]),!!e.shareImageBase64)return[3,2];return[4,e.loadImageAsync("./public/share-95x95.jpg")];case 1:if(t=n.sent())e.shareImageBase64=t;n.label=2;case 2:return[4,e.sdk.shareAsync({title:e_,text:"Play now!",image:e.shareImageBase64})];case 3:return n.sent(),[3,5];case 4:return console.warn("shareAsync",n.sent()),[3,5];case 5:return[2]}})})()}},{key:"switchGameAsync",value:function(e){return this.sdk.switchGameAsync({id:e})}},{key:"submitGameResultsAsync",value:function(e){return this.sdk.submitGameResultsAsync(e)}},{key:"scheduleNotificationAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a;return _ts_generator(this,function(o){switch(o.label){case 0:if(!!t.notificationImageBase64)return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,t.loadImageAsync("./public/notification-364x180.jpg")];case 2:if(n=o.sent())t.notificationImageBase64=n;return[3,4];case 3:return console.warn("scheduleNotificationAsync > notificationImageBase64",o.sent()),[3,4];case 4:r={playerId:t.adapter.player.getID()||"Anonymous"},a=_object_spread({},a={title:e_,description:"We miss you!",type:0,minDelayInSeconds:300,imageData:t.notificationImageBase64,callToAction:"Play now!",payload:JSON.stringify(r)},e),o.label=5;case 5:return o.trys.push([5,7,,8]),[4,t.sdk.scheduleNotificationAsync(a)];case 6:return o.sent(),[3,8];case 7:return console.warn("scheduleNotificationAsync",o.sent()),[3,8];case 8:return[2]}})})()}},{key:"sendDailyNotificationAsync",value:function(){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2,el.sendDailyNotification()]})})()}},{key:"isValidDisplayAdPlacement",value:function(e){return["top:728x90","bottom:728x90","left:300x250","right:300x250","topleft:300x250","topright:300x250","bottomleft:300x250","bottomright:300x250","top:320x50","right:320x50","bottom:320x50","left:320x50","left:300x600","right:300x600","top:970x250","bottom:970x250","left:160x600","right:160x600"].indexOf(e)>-1}},{key:"getBannerOffset",value:function(){return 20}},{key:"loadImageAsync",value:function(e){return _async_to_generator(function(){var t,n,r,a;return _ts_generator(this,function(o){switch(o.label){case 0:return n=(t=GameCore.Utils.Image).fetchImage,r=t.blobToDataImage,[4,n(e)];case 1:return a=o.sent(),[4,r(a)];case 2:return[2,o.sent()]}})})()}}]),_MSExtra}(W);__name(ed,"MSExtra"),I(),A(),P();var ef="MSPlayer";var ey=/*#__PURE__*/function(t){function _MSPlayer(e){var t;return _class_call_check(this,_MSPlayer),__publicField(t=_call_super(this,_MSPlayer,[e]),"_personalInfo"),__publicField(t,"signature",""),__publicField(t,"canbeLogin",false),__publicField(t,"maxLoginAttempts",0),t.updateLoginEnabledConfig(),t}return _inherits(_MSPlayer,t),_create_class(_MSPlayer,[{key:"updateLoginEnabledConfig",value:function(){var t=e;if(!t)return;var n=t.MSGames;if(!n)return;this.canbeLogin=n.LoginOnStart,this.maxLoginAttempts=n.MaxLoginAttemptsPerDay}},{key:"initPlayerAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,8,10,11]),[4,e.tryGettingSignedInPlayer()];case 1:if(t=n.sent(),!(e.canbeLogin&&!t))return[3,3];return[4,e.tryMakingPlayerSignedIn()];case 2:t=n.sent(),n.label=3;case 3:if(!t)return[3,5];return[4,e.initLoggedMode(t)];case 4:return n.sent(),[3,7];case 5:return[4,e.initGuestMode()];case 6:n.sent(),n.label=7;case 7:return[3,11];case 8:return n.sent(),[4,e.initGuestMode()];case 9:return n.sent(),[3,11];case 10:return e.canbeLogin=true,[7];case 11:return[2]}})})()}},{key:"initLoggedMode",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a,o;return _ts_generator(this,function(i){return n=e.playerId,r=e.signature,a=e.publisherPlayerId,o=e.playerDisplayName,t.currentPlayerInfo.playerId=n,t.currentPlayerInfo.playerName=o,t.signature="".concat(n," ").concat(r),t._personalInfo={id:n,avatarIdHash:"0",lang:"en",publicName:o,uniqueID:a,scopePermissions:{avatar:"forbid",public_name:"forbid"}},t.extra.isGuest=false,t.initPlayerInfo(n),[2]})})()}},{key:"initGuestMode",value:function(){var e=this;return _async_to_generator(function(){var t,n;return _ts_generator(this,function(r){try{t=e.getID(),e.extra.isGuest=true,e.initPlayerInfo(t),n=e.getName(),e._personalInfo={id:t,avatarIdHash:"0",lang:"en",publicName:n,uniqueID:t,scopePermissions:{avatar:"forbid",public_name:"forbid"}}}catch(e){}return[2]})})()}},{key:"tryGettingSignedInPlayer",value:function(e){var t=arguments.length>0&&void 0!==e?e:0;var n=this;return _async_to_generator(function(){var e;return _ts_generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,5]),[4,n.adapter.sdk.getSignedInUserAsync()];case 1:return[2,r.sent()];case 2:if(e=r.sent(),!GameCore.Utils.Object.hasOwn(e,"code"))return[3,4];if(!("SERVICE_REQUEST_FAILED"===e.code&&t<3))return[3,4];return[4,n.tryGettingSignedInPlayer(t+1)];case 3:return[2,r.sent()];case 4:return console.warn("tryGettingSignedInPlayer",e),[2,null];case 5:return[2]}})})()}},{key:"tryMakingPlayerSignedIn",value:function(e){var t=arguments.length>0&&void 0!==e?e:0;var n=this;return _async_to_generator(function(){var e,r;return _ts_generator(this,function(a){switch(a.label){case 0:e=GameCore.Utils.Object,a.label=1;case 1:return a.trys.push([1,3,,6]),n.validateLoginAttempts(),[4,n.adapter.sdk.signInAsync()];case 2:return[2,a.sent()];case 3:if(r=a.sent(),!e.hasOwn(r,"code"))return[3,5];if(!("SERVICE_REQUEST_FAILED"===r.code&&t<3))return[3,5];return[4,n.tryMakingPlayerSignedIn(t+1)];case 4:return[2,a.sent()];case 5:return console.warn("tryMakingPlayerSignedIn",r),[2,null];case 6:return[2]}})})()}},{key:"validateLoginAttempts",value:function(){var e=GameCore.Utils,t=e.Browser,n=e.Valid,r=e.Object,a=e.Time;var o=t.getLocalStorage(ef);var i=0;var s=Date.now();if(r.hasOwn(o,"loginAttempts")&&n.isNumber(o.loginAttempts))i=o.loginAttempts;if(r.hasOwn(o,"lastLoginAttempt")&&n.isNumber(o.lastLoginAttempt)){if(!a.isToday(o.lastLoginAttempt))i=0}else i=0;if(i>=this.maxLoginAttempts)this.extra.exceptionInvalidOperation("Maximum login attempts reached for today.");t.writeLocalStorage(ef,{loginAttempts:i,lastLoginAttempt:s})}},{key:"getASIDAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){return[2,null!=(t=e._personalInfo.uniqueID)?t:""]})})()}},{key:"getSignedASIDAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:return[4,e.getASIDAsync()];case 1:return t=n.sent(),[2,{getASID:/* @__PURE__ */__name(function(){return t},"getASID"),getSignature:/* @__PURE__ */__name(function(){return e.signature},"getSignature")}]}})})()}},{key:"getSignedPlayerInfoAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){return[2,{getPlayerID:/* @__PURE__ */__name(function(){var t;return null!==(t=e.getID())&&void 0!==t?t:"10"},"getPlayerID"),getSignature:/* @__PURE__ */__name(function(){return e.signature},"getSignature")}]})})()}},{key:"canSubscribeBotAsync",value:function(){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2,false]})})()}},{key:"subscribeBotAsync",value:function(){this.adapter.extra.exceptionUnsupported()}},{key:"getConnectedPlayersAsync",value:function(){this.adapter.extra.exceptionUnsupported()}}]),_MSPlayer}(H);__name(ey,"MSPlayer"),I(),A(),P(),I(),A(),P();var ep=/*#__PURE__*/function(){function _MSTournamentInstance(e){_class_call_check(this,_MSTournamentInstance),__publicField(this,"id"),__publicField(this,"title"),__publicField(this,"contextId"),__publicField(this,"payload"),__publicField(this,"endTime"),__publicField(this,"tournamentType");var t=e._id,n=e.name,r=e.type,a=e.createdAt,o=e.expireTime;var i=JSON.parse(e.description);var s=_object_spread({leaderboardId:t},i);this.id=i.tournamentId,this.title=n,this.contextId=i.contextId,this.payload=JSON.stringify(s),this.endTime=Math.round((new Date(a).getTime()+1e3*o)/1e3),this.tournamentType="world_tournament_leaderboard"===r?"PAGE_HOSTED":"DEFAULT"}return _create_class(_MSTournamentInstance,[{key:"getID",value:function(){return this.id}},{key:"getTitle",value:function(){return this.title}},{key:"getPayload",value:function(){return this.payload}},{key:"getEndTime",value:function(){return this.endTime}},{key:"getContextID",value:function(){return this.contextId}},{key:"getTournamentType",value:function(){return this.tournamentType}}]),_MSTournamentInstance}();__name(ep,"MSTournamentInstance");var eh=/*#__PURE__*/function(e){function _YDTournament(){return _class_call_check(this,_YDTournament),_call_super(this,_YDTournament,arguments)}return _inherits(_YDTournament,e),_create_class(_YDTournament,[{key:"joinAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a;return _ts_generator(this,function(o){switch(o.label){case 0:return n=GameCore.Utils.Array,[4,t.getTournamentsAsync()];case 1:if(r=o.sent(),!(a=n.search(r,function(t){return t.getID()===e})))t.extra.exceptionTournamentNotFound("Tournament could not be found.");return[4,GameSDK.context.switchAsync(a.getContextID())];case 2:return o.sent(),[2]}})})()}},{key:"getTournamentsAsync",value:function(){return _async_to_generator(function(){var e,t,n,r,a,o,i,s,c;return _ts_generator(this,function(u){switch(u.label){case 0:e=[],u.label=1;case 1:return u.trys.push([1,3,,4]),[4,globalThis.game.leaderboard.requestLeaderboardsAsync({limit:100,type:"world_tournament_leaderboard"})];case 2:t=u.sent(),n=true,r=false,a=void 0;try{for(o=t[Symbol.iterator]();!(n=(i=o.next()).done);n=true)s=i.value,c=new ep(s),e.push(c)}catch(e){r=true,a=e}finally{try{if(!n&&null!=o.return)o.return()}finally{if(r)throw a}}return[3,4];case 3:return console.warn("fetchGlobalTournamentLeaderboardAsync",u.sent()),[3,4];case 4:return[2,e]}})})()}}]),_YDTournament}(en);__name(eh,"YDTournament");var em=/*#__PURE__*/function(e){function _MSAdapter(e){var t;return _class_call_check(this,_MSAdapter),__publicField(t=_call_super(this,_MSAdapter),"sdk"),__publicField(t,"adPlacementList",/* @__PURE__ */new Set),t.sdk=e,t}return _inherits(_MSAdapter,e),_create_class(_MSAdapter,[{key:"initialize",value:function(){_get(_get_prototype_of(_MSAdapter.prototype),"initialize",this).call(this),this.extra=new ed(this),this.player=new ey(this),this.context=new ec(this),this.tournament=new eh(this),this.rewardedVideoInstance=new es("rewarded",this.sdk),this.interstitialAdInstance=new es("interstitial",this.sdk)}},{key:"checkSDKInitialized",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){if(!e.sdk||!e.sdk.isInMicrosoftStart())e.extra.exceptionInvalidOperation("Microsoft Games SDK is not initialized");return[2]})})()}},{key:"initializeAsync",value:function(){var e=this;var t=this;return _async_to_generator(function(){return _ts_generator(this,function(n){switch(n.label){case 0:if(t.isInitialized)return[2];return[4,(function(){return _get(_get_prototype_of(_MSAdapter.prototype),"initializeAsync",e)})().call(t)];case 1:n.sent(),t.isInitialized=false,n.label=2;case 2:return n.trys.push([2,4,,5]),t.extra.displayWarnLoading(false),[4,t.player.initPlayerAsync()];case 3:return n.sent(),t.isInitialized=true,[3,5];case 4:if(console.debug(n.sent()),t.isNeedSDK())throw new Error("Microsoft Games SDK not initialized");return console.warn("Microsoft Games SDK not initialized, running without platform sdk"),[3,5];case 5:return[2]}})})()}},{key:"getLocale",value:function(){return this.sdk.getLocale()}},{key:"getSDKVersion",value:function(){return"v1.0.0-rc.13"}},{key:"getSDKName",value:function(){return"MsGames"}},{key:"canCreateShortcutAsync",value:function(){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2,true]})})()}},{key:"createShortcutAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,e.sdk.promptInstallAsync()];case 1:return t.sent(),[3,3];case 2:return console.warn("createShortcutAsync",t.sent()),[3,3];case 3:return[2]}})})()}},{key:"getInterstitialAdAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){return[2,e.interstitialAdInstance]})})()}},{key:"getRewardedVideoAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){return[2,e.rewardedVideoInstance]})})()}},{key:"getRewardedInterstitialAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){return[2,e.rewardedVideoInstance]})})()}},{key:"loadBannerAdAsync",value:function(e){var t=this;return _async_to_generator(function(){var e,n,r,a,o,i,s,c,u,l,_;return _ts_generator(this,function(d){switch(d.label){case 0:e=GameCore.Configs.Ads.BannerDisplayAdOptions,n=true,r=false,a=void 0;try{for(o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=true)if(c=(s=i.value).Position,u=s.BannerWidth,l=s.BannerHeight,_="".concat(c,":").concat(u,"x").concat(l),t.extra.isValidDisplayAdPlacement(_))t.adPlacementList.add(_)}catch(e){r=true,a=e}finally{try{if(!n&&null!=o.return)o.return()}finally{if(r)throw a}}return[4,t.showBannerAdsAsync()];case 1:return d.sent(),[2]}})})()}},{key:"hideBannerAdAsync",value:function(e){var t=this;return _async_to_generator(function(){return _ts_generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,t.sdk.hideDisplayAdsAsync()];case 1:return e.sent(),[3,3];case 2:return console.warn("\uD83D\uDE80 > hideBannerAdAsync",e.sent()),[3,3];case 3:return[2]}})})()}},{key:"getEntryPointAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){if(t=e.sdk.getEntryPointInfo(),e.sdk.getNotificationPayload())return[2,"msn_notification"];return[2,t.entryPointId]})})()}},{key:"showBannerAdsAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(0!==e.adPlacementList.size)return[3,1];return e.extra.exceptionInvalidOperation("Invalid banner ad placement"),[3,4];case 1:return n.trys.push([1,3,,4]),t=_to_consumable_array(e.adPlacementList),[4,e.sdk.showDisplayAdsAsync(t)];case 2:return n.sent(),[3,4];case 3:return n.sent(),[3,4];case 4:return e.adPlacementList.clear(),[2]}})})()}},{key:"getTournamentAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o;return _ts_generator(this,function(i){switch(i.label){case 0:if(t=e.context.getID(),r=(n=GameCore.Utils).Array,!n.Valid.isString(t))e.extra.exceptionInvalidOperation("Not in a context");return[4,e.tournament.getTournamentsAsync()];case 1:if(a=i.sent(),!(o=r.search(a,function(e){return e.getContextID()===t})))e.extra.exceptionTournamentNotFound("A Tournament with current context was not found");return[2,o]}})})()}}]),_MSAdapter}(er);__name(em,"MSAdapter"),k(),k(),k(),I(),A(),P();var eg=/*#__PURE__*/function(){function _AccessBlocker(){_class_call_check(this,_AccessBlocker),__publicField(this,"usedCallLocations"),this.usedCallLocations=/* @__PURE__ */Object.create(null)}return _create_class(_AccessBlocker,[{key:"getCallerLine",value:function(){var e=new Error;if(!e.stack)return null;var t=e.stack.split("\n")[4];return t?t.trim():null}},{key:"blockAccess",value:function(){try{var e=this.getCallerLine();if(!e)return false;if(this.usedCallLocations[e])return false;if(["eval","at <","(<"].some(function(t){return e.includes(t)}))throw new Error("Access blocked for the caller: ".concat(e));return this.usedCallLocations[e]=true,false}catch(e){return console.warn("Block access encountered an error:",e),true}}}]),_AccessBlocker}();__name(eg,"AccessBlocker"),new eg;var ev=/* @__PURE__ */__name(function(e,t){},"wrapGetterToBlockObjectAccess");function autoDetectAndInitializeSDKAdapter(){var e;var n=window;var r="GameSDK";if("FBInstant"in n)r="FBInstant",e=new t(window.FBInstant);else if("YaGames"in n)r="Yandex",e=new t(window.YaGames);else if("funmax"in n)r="Xiaomi",e=new t(window.funmax);else if("$msstart"in n)r="MsGames",e=new em(window.$msstart);else if("gdsdk"in n)r="GameDistribution",e=new t(window.gdsdk);else if("h5sdk"in n)r="TranssionH5",e=new t(window.h5sdk);else if("CrazyGames"in n)r="CrazyGames",e=new t(window.CrazyGames.SDK);else if("GlanceGamingAdInterface"in n)r="Glance",e=new t(window.GlanceGamingAdInterface);else e=new er;return console.info("GameSDK loaded (".concat(r,")")),e}console.groupCollapsed("⚡️ Corecos initialized"),__name(autoDetectAndInitializeSDKAdapter,"autoDetectAndInitializeSDKAdapter"),console.groupCollapsed("\uD83D\uDD79️ GameSDK"),window.GameSDK=Object.seal(autoDetectAndInitializeSDKAdapter()),ev(window,"GameSDK")})(),function(){"use strict";var e=Object.defineProperty;var __name=function(t,n){return e(t,"name",{value:n,configurable:true})};var t={TAG_IDS:"null",BUILD_VERSION:"31"};var n=0;var r=/* @__PURE__ */__name(function(){var e=setInterval(function(){if(window.__sdkLoadingCount>=70){clearInterval(e);return}if(n===window.__sdkLoadingCount)return;n=window.__sdkLoadingCount,GameSDK.setLoadingProgress(window.__sdkLoadingCount)},500)},"stepProgressLoading");var a=null;var o=/* @__PURE__ */__name(function(){a=setTimeout(function(){if(window.__sdkLoadingCount>0)return;GameSDK.extra.displayWarnLoading(true)},8e3)},"checkSlowLoading");var i=/* @__PURE__ */__name(function(){clearTimeout(a),GameSDK.extra.displayWarnLoading(false)},"clearCheckSlowLoading");var s=/* @__PURE__ */__name(/*#__PURE__*/_async_to_generator(function(){var e;return _ts_generator(this,function(t){switch(t.label){case 0:console.info("GameSDK initializing..."),console.groupEnd(),o(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,GameSDK.initializeAsync()];case 2:return t.sent(),[3,4];case 3:return e=t.sent(),console.warn("GameSDK initialize failed, retry..."),console.debug(e),setTimeout(s,2e3),[2];case 4:return i(),window.__sdkLoadingCount=1,GameSDK.setLoadingProgress(window.__sdkLoadingCount),r(),u(),[3,7];case 5:return[4,u()];case 6:t.sent(),t.label=7;case 7:return console.groupEnd(),console.info("GameSDK initialized"),window.__sdkInitiated=true,[2]}})}),"initGameSDK");var c={};var u=/* @__PURE__ */__name(/*#__PURE__*/_async_to_generator(function(){var e,n,r,a;return _ts_generator(this,function(o){switch(o.label){case 0:if(o.trys.push([0,2,3,4]),0===(e=t.TAG_IDS.split(" ")).length)e.push("G-3ZG4F3ZNXH");if(!e[0]||"null"===e[0])return[2];return[4,GameSDK.getEntryPointAsync()];case 1:return r=null!==(n=o.sent())&&void 0!==n?n:"no_entry",(a=document.createElement("script")).async=true,a.src="https://www.googletagmanager.com/gtag/js?id=".concat(e[0]),document.head.appendChild(a),_(GameSDK.player.getID(),r,e),[3,4];case 2:return l(o.sent()),[3,4];case 3:return d(),[7];case 4:return[2]}})}),"processGoogleAnalytics");var l=/* @__PURE__ */__name(function(e){var t=window.game,n=t.analytics,r=t.monitorError;if(!r){window.__errorQueue.push(e);return}n.event("app_crash_handle",{error:e}),r.sendException(e)},"logError");var _=/* @__PURE__ */__name(function(e,n,r){try{window.focus();var a=t.BUILD_VERSION,o=void 0===a?"0":a;var i=GameSDK.getEntryPointData()||{},s=i.fbig_ad_id,u=i.fbig_adset_id,_=i.fbig_campaign_id;window.gtag("js",/* @__PURE__ */new Date),window.gtag("set","client_id","100.".concat(e)),window.gtag("set","user_id",e),window.gtag("set","send_page_view",false),r.forEach(function(e){window.gtag("config",e,{cookie_flags:"SameSite=None;Secure",build:o,medium:n,campaign:_,groups:"GA"})});var d=GameCore.Utils.Browser.getQueryParams().entry_point||n;c.user_id=e,c.player_id=e,c.app_version=o,c.traffic_source=n,c.traffic_source_detail=d,c.ad_id=s,c.adset_id=u,c.campaign_id=_,window.gtag("set","user_properties",c)}catch(e){l(e)}},"initGoogleAnalytics");var d=/* @__PURE__ */__name(function(e){var t=arguments.length>0&&void 0!==e?e:0;if(t>=30)return;if(!window.game||!window.game.event){console.warn("Game not ready, retry..."),setTimeout(function(){return d(t+1)},50);return}f(),p()},"progressAnalyticsWhenCoreInitialized");var f=/* @__PURE__ */__name(function(){var e=window.game,t=e.analytics,n=e.event;var r=GameCore.Events,a=GameCore.Plugins.Analytics.Events,o=a.APP_LAUNCH,i=a.APP_INITIALIZED;t.event(o),n.catchUp(r.GAME_SDK_READY,function(){t.event(i)})},"logAppInitializedEvent");var y=/* @__PURE__ */__name(function(){try{var e,t=window.game.player;var n=t.getBestScore();var r=null!==(e=t.getGameData().coins)&&void 0!==e?e:0;var a=t.isFirstLogin();c.new_user=a,c.coins=r,c.score=n;var o=GameSDK.getEntryPointData()||{},i=o.content,s=o.notif_id;if(i||s)c.traffic_source_detail=null!=i?i:"notif_".concat(s);window.gtag("set","user_properties",c)}catch(e){l(e)}},"processUserProperties");var p=/* @__PURE__ */__name(function(){try{if(!GameSDK.player.getID())return;var e=window.game.event;var t=GameCore.Events.PLAYER_INFO_LOADED;e.catchUp(t,y)}catch(e){l(e)}},"updateUserPropertiesWhenPlayerInfoLoaded");s()}();