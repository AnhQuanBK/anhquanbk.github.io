function _array_like_to_array(e,t){if(null==t||t>e.length)t=e.length;for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _array_without_holes(e){if(Array.isArray(e))return _array_like_to_array(e)}function _assert_this_initialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function asyncGeneratorStep(e,t,n,r,a,o,i){try{var s=e[o](i);var c=s.value}catch(e){n(e);return}if(s.done)t(c);else Promise.resolve(c).then(r,a)}function _async_to_generator(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function _next(e){asyncGeneratorStep(o,r,a,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(o,r,a,_next,_throw,"throw",e)}_next(void 0)})}}function _call_super(e,t,n){t=_get_prototype_of(t);return _possible_constructor_return(e,_is_native_reflect_construct()?Reflect.construct(t,n||[],_get_prototype_of(e).constructor):t.apply(e,n))}function _class_call_check(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _construct(){_construct=_is_native_reflect_construct()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=Function.bind.apply(e,r);var o=new a;if(n)_set_prototype_of(o,n.prototype);return o};return _construct.apply(null,arguments)}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}function _create_class(e,t,n){if(t)_defineProperties(e.prototype,t);if(n)_defineProperties(e,n);return e}function _define_property(e,t,n){if(t in e)Object.defineProperty(e,t,{value:n,enumerable:true,configurable:true,writable:true});else e[t]=n;return e}function _get(e,t,n){_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=_super_prop_base(e,t);if(!r)return;var a=Object.getOwnPropertyDescriptor(r,t);if(a.get)return a.get.call(n||e);return a.value};return _get(e,t,n||e)}function _get_prototype_of(e){_get_prototype_of=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)};return _get_prototype_of(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});if(t)_set_prototype_of(e,t)}function _instanceof(e,t){if(null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance])return!!t[Symbol.hasInstance](e);return e instanceof t}function _is_native_function(e){return -1!==Function.toString.call(e).indexOf("[native code]")}function _iterable_to_array(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _non_iterable_spread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _object_spread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};var r=Object.keys(n);if("function"==typeof Object.getOwnPropertySymbols)r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}));r.forEach(function(t){_define_property(e,t,n[t])})}return e}function _possible_constructor_return(e,t){if(t&&("object"===_type_of(t)||"function"==typeof t))return t;return _assert_this_initialized(e)}function _set_prototype_of(e,t){_set_prototype_of=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return _set_prototype_of(e,t)}function _super_prop_base(e,t){while(!Object.prototype.hasOwnProperty.call(e,t)){e=_get_prototype_of(e);if(null===e)break}return e}function _to_consumable_array(e){return _array_without_holes(e)||_iterable_to_array(e)||_unsupported_iterable_to_array(e)||_non_iterable_spread()}function _type_of(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function _unsupported_iterable_to_array(e,t){if(!e)return;if("string"==typeof e)return _array_like_to_array(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor)n=e.constructor.name;if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _array_like_to_array(e,t)}function _wrap_native_super(e){var t="function"==typeof Map?new Map:void 0;_wrap_native_super=function(e){if(null===e||!_is_native_function(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,Wrapper)}function Wrapper(){return _construct(e,arguments,_get_prototype_of(this).constructor)}Wrapper.prototype=Object.create(e.prototype,{constructor:{value:Wrapper,enumerable:false,writable:true,configurable:true}});return _set_prototype_of(Wrapper,e)};return _wrap_native_super(e)}function _is_native_reflect_construct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_is_native_reflect_construct=function(){return!!e})()}function _ts_generator(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function verb(e){return function(t){return step([e,t])}}function step(o){if(n)throw new TypeError("Generator is already executing.");while(i)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;if(r=0,a)o=[2&o[0],a.value];switch(o[0]){case 0:case 1:a=o;break;case 4:i.label++;return{value:o[1],done:false};case 5:i.label++;r=o[1];o=[0];continue;case 7:o=i.ops.pop();i.trys.pop();continue;default:if(a=i.trys,!(a=a.length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1];a=o;break}if(a&&i.label<a[2]){i.label=a[2];i.ops.push(o);break}if(a[2])i.ops.pop();i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e];r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:true}}}(function(){"use strict";var e=Object.defineProperty;var t=Object.getOwnPropertyNames;var __defNormalProp=function(t,n,r){return n in t?e(t,n,{enumerable:true,configurable:true,writable:true,value:r}):t[n]=r};var __name=function(t,n){return e(t,"name",{value:n,configurable:true})};var __esm=function(e,n){return function(){return e&&(n=(0,e[t(e)[0]])(e=0)),n}};var __export=function(t,n){for(var r in n)e(t,r,{get:n[r],enumerable:true})};var __publicField=function(e,t,n){return __defNormalProp(e,(void 0===t?"undefined":_type_of(t))!=="symbol"?t+"":t,n)};var n;var r=__esm({"<define:__GAME_SDK_CONFIG__>":function(){n={MSGames:{UseLoginFeature:false,ScheduleNotification:{D1:"The dogs are in danger! Draw quick and keep them safe from the bees. \uD83D\uDC1D\uD83D\uDC36",D2:"The pets need your help! Protect them from today's hazards. Can you do it? \uD83D\uDCAA\uD83D\uDC15",D3:"Buzz buzz! Bees are back. Can you outsmart them and save the dogs? \uD83D\uDC3Eâœ¨",D4:"Get ready to draw your best defenses! The dogs are counting on you. \uD83D\uDC15\uD83D\uDEA8",D5:"The danger is real! Hurry up, the bees are closing in on the pets. \uD83D\uDC1D\uD83D\uDD25",D6:"The dogs are waiting for their hero! Can you keep them safe from harm? \uD83C\uDFAE\uD83D\uDC15",D7:"Your furry friends need you now! Join the game and save the day. \uD83C\uDFC6\uD83D\uDC3E"}},Yandex:{UseLoginFeature:false}}}});var a=__esm({"<define:__INIT_CONFIG__>":function(){}});var o={};__export(o,{default:function(){return i}});var i;var s=__esm({"libs/empty-script.js":function(){"use strict";r();a();i={}}});var c,u,l,_,d;var f=__esm({"src/game-sdk/common/BaseAsyncPopup.ts":function(){"use strict";r();a();c='\n<div id="async-popup">\n    <div id="title"></div>\n    <div id="content"></div>\n    <div class="buttons">\n        <button id="ok"></button>\n        <button id="no"></button>\n    </div>\n</div>';u="\n#async-popup {\n    width: 100%;\n    height: 100%;\n    color: #fff;\n    display: flex;\n    position: absolute;\n    flex-direction: column;\n    justify-content: space-evenly;\n    background: #202020;\n    font-family: sans-serif;\n    border-radius: 20px;\n    align-items: center;\n    padding: 20px\n}\n\n#async-popup #title {\n    font-size: 2rem;\n    font-weight: bold;\n    margin-bottom: 1rem;\n}\n\n#async-popup #content {\n    display: flex;\n    text-align: center;\n    text-wrap: balance;\n    font-size: large;\n}\n\n#async-popup .buttons {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: space-evenly;\n}\n\n#async-popup .buttons button {\n    margin: 0.5rem;\n    padding: 0.5rem 1rem;\n    font-size: 1.5rem;\n    font-weight: bold;\n    border-radius: 0.5rem;\n    border: none;\n    cursor: pointer;\n}";l=/*#__PURE__*/function(){function _BaseAsyncPopup(){var e=this;_class_call_check(this,_BaseAsyncPopup);__publicField(this,"popup");__publicField(this,"title");__publicField(this,"content");__publicField(this,"okButton");__publicField(this,"noButton");__publicField(this,"okCallback");__publicField(this,"noCallback");__publicField(this,"onYes",/* @__PURE__ */__name(function(t){e.okButton.removeEventListener("click",e.okCallback);e.okCallback=e.handleCallback(t);e.okButton.addEventListener("click",e.okCallback,{once:true})},"onYes"));__publicField(this,"onNo",/* @__PURE__ */__name(function(t){e.noButton.removeEventListener("click",e.noCallback);e.noCallback=e.handleCallback(t);e.noButton.addEventListener("click",e.noCallback,{once:true})},"onNo"));__publicField(this,"handleCallback",/* @__PURE__ */__name(function(t){return function(n){n.stopImmediatePropagation();e.hide();t()}},"handleCallback"));this.createPopupElement();this.addPopupElementStyle();var t=new MutationObserver(function(){var t=document.getElementById("GameDiv");if(!t)return;e.setupPopupElementSizeAndPosition()});var n={attributes:true,childList:true,subtree:true};var r=document.body;t.observe(r,n)}_create_class(_BaseAsyncPopup,[{key:"createPopupElement",value:function(){var e=document.createElement("div");e.id=this.constructor.name;e.innerHTML=c;e.style.width="100%";e.style.height="100%";e.style.position="absolute";e.style.backgroundColor="#0000001f";document.body.appendChild(e);this.popup=e;this.popup.style.display="none";this.title=e.querySelector("#title");this.content=e.querySelector("#content");this.okButton=e.querySelector("#ok");this.noButton=e.querySelector("#no")}},{key:"addPopupElementStyle",value:function(){var e=document.createElement("style");var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e);e.appendChild(document.createTextNode(u))}},{key:"setupPopupElementSizeAndPosition",value:function(){var e=document.getElementById(this.constructor.name);if(!e)return;var t=e.querySelector("#async-popup");if(!t)return;var n=document.getElementById("GameDiv");if(!n)return;var r=350;var a=250;var o=t;o.style.width="".concat(r,"px");o.style.height="".concat(a,"px");var i=document.body.getBoundingClientRect(),s=i.width,c=i.height;o.style.left="".concat((s-r)/2,"px");o.style.top="".concat((c-a)/2,"px")}},{key:"show",value:function(e){this.content.textContent="".concat(e);this.popup.style.display="flex"}},{key:"hide",value:function(){this.popup.style.display="none"}}]);return _BaseAsyncPopup}();__name(l,"BaseAsyncPopup");_=l;d=_}});var y={};__export(y,{default:function(){return m}});var p,h,m;var v=__esm({"src/game-sdk/common/SwitchAsyncPopup.ts":function(){"use strict";r();a();f();p=/*#__PURE__*/function(e){_inherits(_SwitchAsyncPopup,e);function _SwitchAsyncPopup(){_class_call_check(this,_SwitchAsyncPopup);return _call_super(this,_SwitchAsyncPopup,arguments)}_create_class(_SwitchAsyncPopup,[{key:"show",value:function(e){this.title.textContent="Switch Context";this.okButton.textContent="Switch";this.noButton.textContent="Cancel";_get(_get_prototype_of(_SwitchAsyncPopup.prototype),"show",this).call(this,"Do you want to switch context?\nContext ID: ".concat(e))}}]);return _SwitchAsyncPopup}(d);__name(p,"SwitchAsyncPopup");h=p;m=h}});var g={};__export(g,{default:function(){return I}});var w,b,I;var A=__esm({"src/game-sdk/common/ChooseAsyncPopup.ts":function(){"use strict";r();a();f();w=/*#__PURE__*/function(e){_inherits(_ChooseAsyncPopup,e);function _ChooseAsyncPopup(){_class_call_check(this,_ChooseAsyncPopup);return _call_super(this,_ChooseAsyncPopup,arguments)}_create_class(_ChooseAsyncPopup,[{key:"show",value:function(){this.title.textContent="Choose Contexts";this.okButton.textContent="Choose";this.noButton.textContent="Cancel";_get(_get_prototype_of(_ChooseAsyncPopup.prototype),"show",this).call(this,"Do you want to switch context?\n            This will choose random a friend or tournament to play with.")}}]);return _ChooseAsyncPopup}(d);__name(w,"ChooseAsyncPopup");b=w;I=b}});var P={};__export(P,{default:function(){return C}});var S,k,C;var D=__esm({"src/game-sdk/common/CreateAsyncPopup.ts":function(){"use strict";r();a();f();S=/*#__PURE__*/function(e){_inherits(_CreateAsyncPopup,e);function _CreateAsyncPopup(){_class_call_check(this,_CreateAsyncPopup);return _call_super(this,_CreateAsyncPopup,arguments)}_create_class(_CreateAsyncPopup,[{key:"show",value:function(e){this.title.textContent="Create Context";this.okButton.textContent="Create";this.noButton.textContent="Cancel";_get(_get_prototype_of(_CreateAsyncPopup.prototype),"show",this).call(this,"Do you want to create context?\nPlayer ID: ".concat(e))}}]);return _CreateAsyncPopup}(d);__name(S,"CreateAsyncPopup");k=S;C=k}});var x={};__export(x,{default:function(){return G}});var T,E,O,G;var N=__esm({"src/game-sdk/common/MockConnectedPlayers.ts":function(){"use strict";r();a();T="MockConnectedPlayers";E=/*#__PURE__*/function(){function _MockConnectedPlayers(e){_class_call_check(this,_MockConnectedPlayers);__publicField(this,"extra");this.extra=e}_create_class(_MockConnectedPlayers,[{key:"getConnectedPlayersAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o;return _ts_generator(this,function(i){switch(i.label){case 0:t=GameCore.Configs.Mockup;n=t.GameSDK.Player.ConnectedPlayers,r=n.ErrorRate,a=n.NumOfPlayers,o=n.RandomDelayMs;if(e.randomExceptionError("getConnectedPlayersAsync",r))e.extra.exceptionNetworkFailure("Get connected players error");return[4,e.extra.awaitRandomDelay(o)];case 1:i.sent();return[2,e.createPlayers(a)]}})})()}},{key:"createPlayers",value:function(e){var t=GameCore.Configs.Mockup;var n=t.GameSDK.Player.ConnectedPlayers.AvatarUrl;var r=this.loadLocalStorage();if(!r){r=[];this.saveLocalStorage(r)}if(r.length!==e){var _loop=function(e){var t="connected-player-".concat(e);var a={getID:/* @__PURE__ */__name(function(){return t},"getID"),getName:/* @__PURE__ */__name(function(){return"Connected Player ".concat(e)},"getName"),getPhoto:/* @__PURE__ */__name(function(){return n.replace("%1",t)},"getPhoto")};r.push(a)};for(var a=r.length;a<e;a++)_loop(a);this.saveLocalStorage(r)}return this.loadLocalStorage()}},{key:"loadLocalStorage",value:function(){var e=GameCore.Utils,t=e.Browser,n=e.Object;var r=t.getLocalStorage(T);if(!r)return[];var a=n.vals(r);if(!Array.isArray(a))return[];var o=[];var i=true,s=false,c=void 0;try{var _loop=function(){var e=l.value;o.push({getID:/* @__PURE__ */__name(function(){return e.id},"getID"),getName:/* @__PURE__ */__name(function(){return e.name},"getName"),getPhoto:/* @__PURE__ */__name(function(){return e.photo},"getPhoto")})};for(var u=a[Symbol.iterator](),l;!(i=(l=u.next()).done);i=true)_loop()}catch(e){s=true;c=e}finally{try{if(!i&&null!=u.return)u.return()}finally{if(s)throw c}}return o}},{key:"saveLocalStorage",value:function(e){var t=GameCore.Utils,n=t.Browser;var r=[];var a=true,o=false,i=void 0;try{for(var s=e[Symbol.iterator](),c;!(a=(c=s.next()).done);a=true){var u=c.value;var l,_;var d={id:u.getID()||"",name:null!==(l=u.getName())&&void 0!==l?l:"",photo:null!==(_=u.getPhoto())&&void 0!==_?_:""};r.push(d)}}catch(e){o=true;i=e}finally{try{if(!a&&null!=s.return)s.return()}finally{if(o)throw i}}var f=_object_spread({},r);n.writeLocalStorage(T,f)}},{key:"randomExceptionError",value:function(e,t){var n=100*Math.random()<t;if(!n)return false;console.warn("[".concat(this.constructor.name,"]"),e);return true}}]);return _MockConnectedPlayers}();__name(E,"MockConnectedPlayers");O=E;G=O}});var M={};__export(M,{default:function(){return F}});var L,B,F;var U=__esm({"src/game-sdk/common/CreateTournamentAsyncPopup.ts":function(){"use strict";r();a();f();L=/*#__PURE__*/function(e){_inherits(_CreateTournamentAsyncPopup,e);function _CreateTournamentAsyncPopup(){_class_call_check(this,_CreateTournamentAsyncPopup);return _call_super(this,_CreateTournamentAsyncPopup,arguments)}_create_class(_CreateTournamentAsyncPopup,[{key:"show",value:function(e){this.title.textContent="Create Tournament";this.okButton.textContent="Create";this.noButton.textContent="Cancel";var t=JSON.stringify(e,null,2);_get(_get_prototype_of(_CreateTournamentAsyncPopup.prototype),"show",this).call(this,"Do you want to create tournament?\nPayload: ".concat(t))}}]);return _CreateTournamentAsyncPopup}(d);__name(L,"CreateTournamentAsyncPopup");B=L;F=B}});var R={};__export(R,{default:function(){return z}});var K,j,z;var W=__esm({"src/game-sdk/common/ShareTournamentAsyncPopup.ts":function(){"use strict";r();a();f();K=/*#__PURE__*/function(e){_inherits(_ShareTournamentAsyncPopup,e);function _ShareTournamentAsyncPopup(){_class_call_check(this,_ShareTournamentAsyncPopup);return _call_super(this,_ShareTournamentAsyncPopup,arguments)}_create_class(_ShareTournamentAsyncPopup,[{key:"show",value:function(e){this.title.textContent="Share tournament";this.okButton.textContent="Share";this.noButton.textContent="Cancel";_get(_get_prototype_of(_ShareTournamentAsyncPopup.prototype),"show",this).call(this,"Do you want to share your score?\nScore: ".concat(e))}}]);return _ShareTournamentAsyncPopup}(d);__name(K,"ShareTournamentAsyncPopup");j=K;z=j}});r();a();s();s();s();s();s();r();a();r();a();r();a();var H=/*#__PURE__*/function(){function _Context(e){var t=this;_class_call_check(this,_Context);__publicField(this,"adapter");__publicField(this,"extra");__publicField(this,"currentContextID",null);__publicField(this,"currentContextType","SOLO");__publicField(this,"currentContextPlayers",[]);__publicField(this,"chooseAsyncPopup",null);__publicField(this,"createAsyncPopup",null);__publicField(this,"switchAsyncPopup",null);__publicField(this,"contextIdsByCreate");__publicField(this,"contextIdsByChoose",[]);__publicField(this,"playerIdsInContexts");__publicField(this,"handleOnYes",/* @__PURE__ */__name(function(e){return function(){t.extra.isPopupShown=false;e(true)}},"handleOnYes"));__publicField(this,"handleOnNo",/* @__PURE__ */__name(function(e){return function(){t.extra.isPopupShown=false;try{t.extra.exceptionUserInput("Player closed the context menu")}catch(t){e(t)}}},"handleOnNo"));this.adapter=e;this.extra=e.extra}_create_class(_Context,[{key:"setCurrentContextId",value:function(e){this.checkSameContext(e);this.currentContextID=e;this.currentContextType="THREAD"}},{key:"initContextInfo",value:function(e,t){var n=GameCore.Utils,r=n.Array,a=n.Number;this.contextIdsByCreate={};this.playerIdsInContexts={};this.contextIdsByChoose=r.fillWith(10,function(){return a.random(10).toString()});if(!e||!t)return;if(["SOLO","THREAD","POST","GROUP"].indexOf(t)<0){console.warn("Invalid context type: ".concat(t));return}this.currentContextID=e;this.currentContextType=t}},{key:"getID",value:function(){return this.currentContextID}},{key:"getType",value:function(){return this.currentContextType}},{key:"loadSwitchAsyncPopup",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.switchAsyncPopup)return[2];return[4,Promise.resolve().then(function(){return v(),y})];case 1:t=n.sent().default;if("function"!=typeof t)return[2];e.switchAsyncPopup=new t;return[2]}})})()}},{key:"loadChooseAsyncPopup",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.chooseAsyncPopup)return[2];return[4,Promise.resolve().then(function(){return A(),g})];case 1:t=n.sent().default;if("function"!=typeof t)return[2];e.chooseAsyncPopup=new t;return[2]}})})()}},{key:"loadCreateAsyncPopup",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.createAsyncPopup)return[2];return[4,Promise.resolve().then(function(){return D(),P})];case 1:t=n.sent().default;if("function"!=typeof t)return[2];e.createAsyncPopup=new t;return[2]}})})()}},{key:"switchAsync",value:function(e,t){var n=arguments.length>1&&void 0!==t&&t;var r=this;return _async_to_generator(function(){var t,a;return _ts_generator(this,function(o){switch(o.label){case 0:r.extra.checkPopupShown();return[4,r.extra.awaitRandomDelay()];case 1:o.sent();r.validateSwitchAsyncContextId(e);if("SOLO"===e&&n){r.currentContextID=null;r.currentContextType="SOLO";r.updatePlayers([]);return[2]}return[4,r.loadSwitchAsyncPopup()];case 2:o.sent();return[4,new Promise(function(t,n){if(!r.switchAsyncPopup)r.adapter.extra.exceptionUnsupported();r.switchAsyncPopup.onYes(r.handleOnYes(t));r.switchAsyncPopup.onNo(r.handleOnNo(n));r.switchAsyncPopup.show(e);r.extra.isPopupShown=true})];case 3:o.sent();r.currentContextID=e;r.currentContextType="THREAD";r.createPlayerIdsInContext(e,10);t=r.playerIdsInContexts[e];a=t.map(function(e){return r.createPlayerInfo(e)});r.updatePlayers(a);return[2]}})})()}},{key:"chooseAsync",value:function(e){var t=this;return _async_to_generator(function(){var e,n,r,a;return _ts_generator(this,function(o){switch(o.label){case 0:t.extra.checkPopupShown();return[4,t.extra.awaitRandomDelay()];case 1:o.sent();return[4,t.loadChooseAsyncPopup()];case 2:o.sent();return[4,new Promise(function(e,n){if(!t.chooseAsyncPopup)t.adapter.extra.exceptionUnsupported();t.chooseAsyncPopup.onYes(t.handleOnYes(e));t.chooseAsyncPopup.onNo(t.handleOnNo(n));t.chooseAsyncPopup.show();t.extra.isPopupShown=true})];case 3:o.sent();e=Math.floor(Math.random()*t.contextIdsByChoose.length);n=t.contextIdsByChoose[e];t.checkSameContext(n);t.currentContextID=n;t.currentContextType="THREAD";t.createPlayerIdsInContext(n,2);r=t.playerIdsInContexts[n];a=r.map(function(e){return t.createPlayerInfo(e)});t.updatePlayers(a);return[2]}})})()}},{key:"createAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r;return _ts_generator(this,function(a){switch(a.label){case 0:t.extra.checkPopupShown();return[4,t.extra.awaitRandomDelay()];case 1:a.sent();return[4,t.validateCreateAsyncPlayerId(e)];case 2:a.sent();return[4,t.loadCreateAsyncPopup()];case 3:a.sent();return[4,new Promise(function(n,r){if(!t.createAsyncPopup)t.adapter.extra.exceptionUnsupported();t.createAsyncPopup.onYes(t.handleOnYes(n));t.createAsyncPopup.onNo(t.handleOnNo(r));t.createAsyncPopup.show(e);t.extra.isPopupShown=true})];case 4:a.sent();if(!t.contextIdsByCreate[e])t.contextIdsByCreate[e]=GameCore.Utils.Number.random(10).toString();n=t.contextIdsByCreate[e];t.checkSameContext(n);t.currentContextID=n;t.currentContextType="THREAD";r=t.createPlayerInfo(e);t.updatePlayers([r]);return[2]}})})()}},{key:"getPlayersAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.extra.awaitRandomDelay()];case 1:t.sent();return[2,e.currentContextPlayers]}})})()}},{key:"createPlayerIdsInContext",value:function(e,t){if(!this.playerIdsInContexts[e]){var n=GameCore.Utils,r=n.Array,a=n.Number;var o=Math.floor(Math.random()*t);var i=r.fillWith(o,function(){return a.random(10).toString()});this.playerIdsInContexts[e]=i}return this.playerIdsInContexts[e]}},{key:"createPlayerInfo",value:function(e){return{getID:/* @__PURE__ */__name(function(){return e},"getID"),getName:/* @__PURE__ */__name(function(){return"Player ".concat(e)},"getName"),getPhoto:/* @__PURE__ */__name(function(){return""},"getPhoto")}}},{key:"updatePlayers",value:function(e){if("SOLO"===this.currentContextType){this.currentContextPlayers=[];return}this.currentContextPlayers=e}},{key:"checkSameContext",value:function(e){if(this.currentContextID===e)this.extra.exceptionSameContext()}},{key:"validateCreateAsyncPlayerId",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a,o,i,s;return _ts_generator(this,function(c){switch(c.label){case 0:if(!e||Array.isArray(e)){n="Client does not support no player IDS or multiple player IDs yet";t.extra.exceptionClientUnsupportedOperation(n)}if(!GameCore.Utils.Valid.isString(e)){r="Array of type String contained a value of another type: ".concat(e);t.extra.exceptionInvalidParam(r)}if(e===GameSDK.player.getID()){a="'At least one player id besides the current player must be provided.'";t.extra.exceptionInvalidParam(a)}return[4,GameSDK.player.getConnectedPlayersAsync()];case 1:o=c.sent();i=o.some(function(t){return t.getID()===e});if(i)return[2];s="Provided ID ".concat(e," is not a connected player of the current player.");t.extra.exceptionInvalidParam(s);return[2]}})})()}},{key:"validateSwitchAsyncContextId",value:function(e){this.checkSameContext(e);if(GameCore.Utils.Valid.isString(e))return;var t="Client requires update to support this operation";this.extra.exceptionClientUnsupportedOperation(t)}}]);return _Context}();__name(H,"Context");var V=H;var Y=V;r();a();r();a();var q='\n<div id="lds-game-icon-blur"></div>\n<div id="lds-game-icon"></div>\n<div id="lds-text">\n    <span id="lds-percent">0</span>%\n</div>\n';var J="lds-container";var Q=/*#__PURE__*/function(){function _LoadingScreenElement(){var e=this;_class_call_check(this,_LoadingScreenElement);__publicField(this,"percentage",0);document.addEventListener("DOMContentLoaded",function(){e.createLoadingElement();e.updateLoadingStyle()})}_create_class(_LoadingScreenElement,[{key:"createLoadingElement",value:function(){var e=document.getElementById("GameDiv");if(!e)return null;var t=document.createElement("div");t.id=J;t.setAttribute("data-clarity-unmask","true");t.innerHTML=q;e.appendChild(t);return t}},{key:"updateLoadingStyle",value:function(){var e=document.getElementById(J);if(!e)return;var t="assets/public/logo-128x128.png";"false";t="public/logo-128x128.png";var n=e.querySelector("#lds-game-icon");if(n&&_instanceof(n,HTMLElement)){n.style.backgroundImage="url(".concat(t,")");n.style.backgroundColor="transparent"}var r=e.querySelector("#lds-game-icon-blur");if(r&&_instanceof(r,HTMLElement)){r.style.backgroundImage="url(".concat(t,")");r.style.backgroundColor="transparent"}}},{key:"setLoadingProgress",value:function(e){if(e===this.percentage)return;if(this.percentage>e)return;this.percentage=e;var t=document.getElementById("lds-percent");if(!t)return;t.innerHTML="".concat(e)}},{key:"removeLoadingElement",value:function(){var e=document.getElementById(J);if(!e)return;e.style.opacity="0";setTimeout(function(){e.remove()},300)}}]);return _LoadingScreenElement}();__name(Q,"LoadingScreenElement");var $=Q;var X=$;r();a();var Z=/*#__PURE__*/function(e){_inherits(_SDKCommonError,e);function _SDKCommonError(e,t){_class_call_check(this,_SDKCommonError);var n;n=_call_super(this,_SDKCommonError,[t]);__publicField(n,"code");n.code=e;return n}return _SDKCommonError}(_wrap_native_super(Error));__name(Z,"SDKCommonError");var ee=Z;var et=ee;var en=/*#__PURE__*/function(){function _Extra(e){_class_call_check(this,_Extra);__publicField(this,"adapter");__publicField(this,"isGuest",false);__publicField(this,"isPopupShown",false);__publicField(this,"maxWaitGameCoreReadyTime",1e4);__publicField(this,"loadingElement",null);this.adapter=e}_create_class(_Extra,[{key:"subscribeBotAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o;return _ts_generator(this,function(i){switch(i.label){case 0:return[4,e.adapter.player.canSubscribeBotAsync()];case 1:t=i.sent();if(!t)return[2,false];n=window.game.analytics;r=GameCore.Plugins.Analytics.Events,a=r.BOT_SUBSCRIBE,o=r.BOT_SUBSCRIBE_POPUP;n.event(o);i.label=2;case 2:i.trys.push([2,5,,6]);return[4,e.waitSDKInitiatedAsync()];case 3:i.sent();return[4,e.adapter.player.subscribeBotAsync()];case 4:i.sent();n.event(a,{success:true});return[2,true];case 5:i.sent();n.event(a,{success:false});return[2,false];case 6:return[2]}})})()}},{key:"checkAndCreateShortcutAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o;return _ts_generator(this,function(i){switch(i.label){case 0:return[4,e.adapter.canCreateShortcutAsync()];case 1:t=i.sent();if(!t)return[2];n=window.game.analytics;r=GameCore.Plugins.Analytics.Events,a=r.SHORTCUT_CREATE,o=r.SHORTCUT_CREATE_POPUP;n.event(o);i.label=2;case 2:i.trys.push([2,5,,6]);return[4,e.waitSDKInitiatedAsync()];case 3:i.sent();return[4,e.adapter.createShortcutAsync()];case 4:i.sent();n.event(a,{success:true});return[3,6];case 5:i.sent();n.event(a,{success:false});return[3,6];case 6:return[2]}})})()}},{key:"waitSDKInitiatedAsync",value:function(){var e=GameCore.Utils,t=e.Valid;return t.isValueChangeAsync(window.__sdkInitiated,true)}},{key:"waitGameCoreReadyAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){t=0;return[2,new Promise(function(n){var r=setInterval(function(){if("GameCore"in window){clearInterval(r);n();return}t+=10;if(t>e.maxWaitGameCoreReadyTime){t=0;console.warn("GameCore is slow to load, please check your network connection.")}},10)})]})})()}},{key:"createLoadingElement",value:function(){if(this.loadingElement)return;this.loadingElement=new X}},{key:"setLoadingElementProgress",value:function(e){if(!this.loadingElement)return;this.loadingElement.setLoadingProgress(e)}},{key:"destroyLoadingElement",value:function(){if(!this.loadingElement)return;this.loadingElement.removeLoadingElement()}},{key:"checkPopupShown",value:function(){if(!this.isPopupShown)return;this.exceptionPendingRequest("Please wait for the popup to close")}},{key:"delayInitialAsync",value:function(){return _async_to_generator(function(){var e,t,n,r,a;return _ts_generator(this,function(o){switch(o.label){case 0:e=GameCore.Utils,t=e.Time,n=GameCore.Configs,r=n.Mockup,a=r.GameSDK.SlowAPI;if(!a.Enabled||a.InitialDelay<=0)return[2];return[4,t.sleepAsync(a.InitialDelay)];case 1:o.sent();return[2]}})})()}},{key:"delayStartAsync",value:function(){return _async_to_generator(function(){var e,t,n,r,a;return _ts_generator(this,function(o){switch(o.label){case 0:e=GameCore.Configs,t=e.Mockup,n=t.GameSDK.SlowAPI,r=GameCore.Utils,a=r.Time;if(!n.Enabled||n.StartDelay<=0)return[2];return[4,a.sleepAsync(n.StartDelay)];case 1:o.sent();return[2]}})})()}},{key:"delayPlayerDataAsync",value:function(){return _async_to_generator(function(){var e,t,n,r,a;return _ts_generator(this,function(o){switch(o.label){case 0:e=GameCore.Configs,t=e.Mockup,n=t.GameSDK.SlowAPI,r=GameCore.Utils,a=r.Time;if(!n.Enabled||n.PlayerDataDelay<=0)return[2];return[4,a.sleepAsync(n.PlayerDataDelay)];case 1:o.sent();return[2]}})})()}},{key:"awaitRandomDelay",value:function(e){var t=arguments.length>0&&void 0!==e?e:1e3;var n=GameCore.Utils,r=n.Time;return r.sleepAsync(Math.random()*t)}},{key:"randomException",value:function(e){var t=Math.floor(Math.random()*e.length);var n=e[t];console.warn("Random exception",n);this["exception".concat(n)]()}},{key:"throwNewCommonError",value:function(e,t){throw new et(e,t)}},{key:"exceptionUserInput",value:function(e){this.throwNewCommonError("USER_INPUT",e)}},{key:"exceptionUnsupported",value:function(){this.throwNewCommonError("UNSUPPORTED","Unsupported method")}},{key:"exceptionInvalidParam",value:function(e){this.throwNewCommonError("INVALID_PARAM",e)}},{key:"exceptionPendingRequest",value:function(e){this.throwNewCommonError("PENDING_REQUEST",e)}},{key:"exceptionMethodNotImplemented",value:function(){this.throwNewCommonError("METHOD_NOT_IMPLEMENTED","Method not implemented")}},{key:"exceptionTournamentNotFound",value:function(e){this.throwNewCommonError("TOURNAMENT_NOT_FOUND",e)}},{key:"exceptionSameContext",value:function(){this.throwNewCommonError("SAME_CONTEXT","Must specify a context other than the current one.")}},{key:"exceptionInvalidOperation",value:function(e){this.throwNewCommonError("INVALID_OPERATION",e)}},{key:"exceptionNetworkFailure",value:function(e){var t=arguments.length>0&&void 0!==e?e:"Request failed to be processed";this.throwNewCommonError("NETWORK_FAILURE",t)}},{key:"exceptionUnknown",value:function(e){this.throwNewCommonError("UNKNOWN",e)}},{key:"exceptionClientUnsupportedOperation",value:function(e){this.throwNewCommonError("CLIENT_UNSUPPORTED_OPERATION",e)}},{key:"exceptionRateLimited",value:function(e){this.throwNewCommonError("RATE_LIMITED",e)}}]);return _Extra}();__name(en,"Extra");var er=en;var ea=er;r();a();var eo="Save The Pets".replace(/ /g,"-");var ei=/*#__PURE__*/function(){function _Player(e){var t=this;_class_call_check(this,_Player);__publicField(this,"adapter");__publicField(this,"extra");__publicField(this,"defaultPlayerInfo");__publicField(this,"currentPlayerInfo");__publicField(this,"infoKey","".concat(eo,"_PlayerInfo"));__publicField(this,"dataKey","".concat(eo,"_PlayerData"));__publicField(this,"subscribeBot",null);__publicField(this,"connectedPlayers",null);__publicField(this,"getSignature",/* @__PURE__ */__name(function(){var e=GameCore.Utils,n=e.Valid;var r=t.getSignatureFormMockup();if(n.isString(r))return r;return"default_token"},"getSignature"));this.adapter=e;this.extra=e.extra;this.initDefaultPlayerInfo()}_create_class(_Player,[{key:"initDefaultPlayerInfo",value:function(){var e="guest-007";this.defaultPlayerInfo={playerId:e,playerName:"Guest",playerPhoto:"https://picsum.photos/seed/".concat(e,"/300/300")};this.extra.isGuest=true;this.currentPlayerInfo=_object_spread({},this.defaultPlayerInfo)}},{key:"initPlayerInfo",value:function(e){this.updateCurrentPlayerInfo(e);var t=GameCore.Utils,n=t.Browser;n.writeLocalStorage(this.infoKey,this.currentPlayerInfo)}},{key:"canSubscribeBotAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.loadMockSubscribeBot()];case 1:t.sent();if(!e.subscribeBot)e.extra.exceptionUnsupported();return[2,e.subscribeBot.canSubscribeBotAsync()]}})})()}},{key:"subscribeBotAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.loadMockSubscribeBot()];case 1:t.sent();if(!e.subscribeBot)e.extra.exceptionUnsupported();return[2,e.subscribeBot.subscribeBotAsync()]}})})()}},{key:"getID",value:function(){var e=GameCore.Utils,t=e.Browser,n=e.Valid,r=e.Object;var a=t.getLocalStorage(this.infoKey);var o=this.currentPlayerInfo.playerId;if(!n.isObject(a))return o;if(r.hasOwn(a,"playerId")&&n.isString(a.playerId))return a.playerId;return o}},{key:"getName",value:function(){var e=GameCore.Utils,t=e.Browser,n=e.Valid,r=e.Object;var a=t.getLocalStorage(this.infoKey);var o=this.currentPlayerInfo.playerName;if(!n.isObject(a))return o;if(r.hasOwn(a,"name")&&n.isString(a.name))return a.name;return o}},{key:"getPhoto",value:function(){var e=GameCore.Utils,t=e.Browser,n=e.Valid,r=e.Object;var a=t.getLocalStorage(this.infoKey);var o=this.currentPlayerInfo.playerPhoto;if(!n.isObject(a))return o;if(r.hasOwn(a,"photo")&&n.isString(a.photo))return a.photo;return o}},{key:"getDataAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a,o,i,s;return _ts_generator(this,function(c){switch(c.label){case 0:return[4,t.extra.delayPlayerDataAsync()];case 1:c.sent();n=GameCore.Utils,r=n.Browser,a=n.Valid,o=n.Object;i=r.getLocalStorage(t.dataKey);if(!a.isObject(i))return[2,{}];if(0===e.length)return[2,i];s={};e.forEach(function(e){if(o.hasOwn(i,e))s[e]=i[e]});return[2,s]}})})()}},{key:"setDataAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r;return _ts_generator(this,function(a){switch(a.label){case 0:return[4,t.extra.delayPlayerDataAsync()];case 1:a.sent();n=GameCore.Utils,r=n.Browser;r.writeLocalStorage(t.dataKey,e);return[2]}})})()}},{key:"getSignedPlayerInfoAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){return[2,{getPlayerID:/* @__PURE__ */__name(function(){var t;return null!==(t=e.getID())&&void 0!==t?t:""},"getPlayerID"),getSignature:e.getSignature}]})})()}},{key:"getConnectedPlayersAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.loadMockConnectedPlayers()];case 1:t.sent();if(!e.connectedPlayers)e.extra.exceptionUnsupported();return[2,e.connectedPlayers.getConnectedPlayersAsync()]}})})()}},{key:"updateCurrentPlayerInfo",value:function(e){if(!e)return;var t=GameCore.Configs,n=t.Mockup.Match;var r=n.PlayerInfo.Id===e;var a=n.OpponentInfo.Id===e;if(r){this.currentPlayerInfo.playerId=n.PlayerInfo.Id;if(n.PlayerInfo.Name)this.currentPlayerInfo.playerName=n.PlayerInfo.Name;if(n.PlayerInfo.Photo)this.currentPlayerInfo.playerPhoto=n.PlayerInfo.Photo}if(a){this.currentPlayerInfo.playerId=n.OpponentInfo.Id;if(n.OpponentInfo.Name)this.currentPlayerInfo.playerName=n.OpponentInfo.Name;if(n.OpponentInfo.Photo)this.currentPlayerInfo.playerPhoto=n.OpponentInfo.Photo}}},{key:"getSignatureFormMockup",value:function(){var e=GameCore.Configs,t=e.Mockup.Match;var n=t.PlayerInfo.Id===this.getID();var r=t.OpponentInfo.Id===this.getID();if(n)return t.PlayerInfo.Signature;if(r)return t.OpponentInfo.Signature;return null}},{key:"loadMockSubscribeBot",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.subscribeBot)return[2];return[4,Promise.resolve().then(function(){return s(),o})];case 1:t=n.sent().default;if("function"!=typeof t)return[2];e.subscribeBot=new t(e.adapter);return[2]}})})()}},{key:"loadMockConnectedPlayers",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.connectedPlayers)return[2];return[4,Promise.resolve().then(function(){return N(),x})];case 1:t=n.sent().default;if("function"!=typeof t)return[2];e.connectedPlayers=new t(e.extra);return[2]}})})()}}]);return _Player}();__name(ei,"Player");var es=ei;var ec=es;r();a();r();a();var eu=/*#__PURE__*/function(){function _TournamentInstance(e,t,n){var r=arguments.length>2&&void 0!==n&&n;_class_call_check(this,_TournamentInstance);__publicField(this,"id");__publicField(this,"title");__publicField(this,"contextId");__publicField(this,"payload");__publicField(this,"endTime");__publicField(this,"tournamentType");var a=t.config,o=t.data;this.id=e;this.title=a.title;this.contextId="0123".concat(this.id);this.payload=JSON.stringify(null!=o?o:{});var i;this.endTime=null!==(i=a.endTime)&&void 0!==i?i:this.defaultEndTime();this.tournamentType=r?"PAGE_HOSTED":"DEFAULT"}_create_class(_TournamentInstance,[{key:"defaultEndTime",value:function(){return Math.round((Date.now()+6048e5)/1e3)}},{key:"getID",value:function(){return this.id}},{key:"getTitle",value:function(){return this.title}},{key:"getPayload",value:function(){return this.payload}},{key:"getEndTime",value:function(){return this.endTime}},{key:"getContextID",value:function(){return this.contextId}},{key:"getTournamentType",value:function(){return this.tournamentType}},{key:"toObject",value:function(){return{id:this.id,title:this.title,payload:this.payload,endTime:this.endTime,contextId:this.contextId,tournamentType:this.tournamentType}}}]);return _TournamentInstance}();__name(eu,"TournamentInstance");var el=eu;var e_=el;var ed=["Unsupported","NetworkFailure","PendingRequest","ClientUnsupportedOperation"];var ef=_to_consumable_array(ed).concat(["InvalidParam","UserInput"]);var ey=_to_consumable_array(ed).concat(["InvalidOperation","UserInput"]);var ep=_to_consumable_array(ed).concat(["InvalidParam","UserInput"]);var eh=_to_consumable_array(ed).concat(["InvalidParam","UserInput"]);var em=_to_consumable_array(ed).concat(["NetworkFailure"]);var ev="TournamentsDataMockKey";var eg="TournamentLeadersMockKey";var ew=/*#__PURE__*/function(){function _Tournament(e){var t=this;_class_call_check(this,_Tournament);var n=this;__publicField(this,"adapter");__publicField(this,"extra");__publicField(this,"context");__publicField(this,"shareAsyncPopup",null);__publicField(this,"createAsyncPopup",null);__publicField(this,"processEnterTournament",/* @__PURE__ */__name(/*#__PURE__*/function(){var e=_async_to_generator(function(e){var t;return _ts_generator(this,function(r){switch(r.label){case 0:t=n.getTournamentData(e);if(!t)return[2];return[4,n.joinAsync(e)];case 1:r.sent();return[2]}})});return function(t){return e.apply(this,arguments)}}(),"processEnterTournament"));__publicField(this,"handleOnYes",/* @__PURE__ */__name(function(e){return function(){t.extra.isPopupShown=false;e(true)}},"handleOnYes"));__publicField(this,"handleOnNo",/* @__PURE__ */__name(function(e){return function(){t.extra.isPopupShown=false;try{t.extra.exceptionUserInput("Player closed the context menu")}catch(t){e(t)}}},"handleOnNo"));this.adapter=e;this.extra=e.extra;this.context=e.context}_create_class(_Tournament,[{key:"initTournamentInfoAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r;return _ts_generator(this,function(a){switch(a.label){case 0:n=GameCore.Configs.Mockup.GameSDK,r=n.Tournament;if(!r.Enabled)return[2];return[4,t.createMockTournamentsData()];case 1:a.sent();if(!e)return[3,3];return[4,t.processEnterTournament(e)];case 2:a.sent();a.label=3;case 3:return[2]}})})()}},{key:"createMockTournamentsData",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o,i,s,c,u,l,_,d,f,y,p,h,m,v;return _ts_generator(this,function(g){switch(g.label){case 0:t=GameCore.Utils,n=t.Object;r=GameCore.Configs.Mockup.GameSDK,a=r.Tournament;o=a.NumOfTournament,i=o.Normal,s=o.HostPage;if(!a.Enabled)return[2];c=e.getTournamentsData();u=n.vals(c);l=e.filterExpiredTournaments(u);_=l.filter(function(e){return"DEFAULT"===e.tournamentType});d=l.filter(function(e){return"PAGE_HOSTED"===e.tournamentType});f=_.length;y=d.length;p=i-f;h=s-y;m=e.createDefaultTournaments(p);v=e.createGlobalTournaments(h);return[4,Promise.all(_to_consumable_array(m).concat(_to_consumable_array(v)))];case 1:g.sent();return[2]}})})()}},{key:"filterExpiredTournaments",value:function(e){var t=Date.now()/1e3;var n=e.filter(function(e){return e.endTime>t});var r={};var a=true,o=false,i=void 0;try{for(var s=n[Symbol.iterator](),c;!(a=(c=s.next()).done);a=true){var u=c.value;r[u.id]=u}}catch(e){o=true;i=e}finally{try{if(!a&&null!=s.return)s.return()}finally{if(o)throw i}}this.writeTournamentsData(r);return n}},{key:"createDefaultTournaments",value:function(e){var t=GameCore.Utils,n=t.String,r=t.Array;var a=window.game.leaderboard;var o=GameSDK.player.getID();var i=GameSDK.player.getName();var s=this;return r.length(e).map(/*#__PURE__*/_async_to_generator(function(){var e,t,r,c,u,l,_,d,f,y;return _ts_generator(this,function(p){switch(p.label){case 0:e="".concat(i,"'s Tournament ").concat(n.generateObjectId());t=GameCore.Configs.Mockup.GameSDK.Tournament,r=t.ExtraPlayerTournamentPayload,c=void 0===r?{}:r;return[4,a.createLeaderboardAsync({name:e})];case 1:u=p.sent();l=s.createMockTournamentAsync({initialScore:0,config:{title:e,tournamentTitle:e},data:_object_spread({playerId:o,playerName:i,leaderboardId:u},c)});_=l.getID().toString();if(s.getTournamentLeadersData(_))return[2];d=GameCore.Utils.Number.random(2);f=window.game.player.getConnectedPlayerIds(d,0);y=f.map(function(e){return{playerId:e,score:GameCore.Utils.Number.random(4)}});y.sort(function(e,t){return e.score-t.score});s.writeTournamentLeadersData(_,y);return[2]}})}))}},{key:"createGlobalTournaments",value:function(e){var t=GameCore.Utils,n=t.String,r=t.Array,a=t.Number;var o=window.game.leaderboard;var i=GameCore.Configs.Mockup.GameSDK.Tournament,s=i.ExtraGlobalTournamentPayload,c=void 0===s?{}:s;var u=this;return r.length(e).map(/*#__PURE__*/_async_to_generator(function(){var e,t,i,s,l,_,d;return _ts_generator(this,function(f){switch(f.label){case 0:e=n.generateObjectId();t=_object_spread({leaderboardId:e,playerId:"global"},c);i="Global Tournament ".concat(e);return[4,o.createLeaderboardAsync({name:i,_id:e,type:"world_tournament_leaderboard",description:JSON.stringify(t)})];case 1:f.sent();s=u.createMockTournamentAsync({initialScore:0,config:{title:i,tournamentTitle:i},data:t},true);l=s.getID().toString();if(u.getTournamentLeadersData(l))return[2];_=a.random(2);d=r.length(_).map(function(){return{playerId:n.generateObjectId(),score:a.random(4)}});d.sort(function(e,t){return e.score-t.score});u.writeTournamentLeadersData(l,d);return[2]}})}))}},{key:"awaitRandomDelay",value:function(){var e=this;return _async_to_generator(function(){var t,n;return _ts_generator(this,function(r){t=GameCore.Configs.Mockup;n=t.GameSDK.Tournament.RandomDelayMs;return[2,e.extra.awaitRandomDelay(n)]})})()}},{key:"randomError",value:function(e){var t=GameCore.Configs.Mockup;var n=t.GameSDK.Tournament.ErrorRates;var r=100*Math.random()<n;if(!r)return;this.extra.randomException(e)}},{key:"loadCreateTournamentPopupAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.createAsyncPopup)return[2];return[4,Promise.resolve().then(function(){return U(),M})];case 1:t=n.sent().default;if("function"!=typeof t)return[2];e.createAsyncPopup=new t;return[2]}})})()}},{key:"loadSharePopupAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.shareAsyncPopup)return[2];return[4,Promise.resolve().then(function(){return W(),R})];case 1:t=n.sent().default;if("function"!=typeof t)return[2];e.shareAsyncPopup=new t;return[2]}})})()}},{key:"createAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r;return _ts_generator(this,function(a){switch(a.label){case 0:t.extra.checkPopupShown();return[4,t.awaitRandomDelay()];case 1:a.sent();if(null!==t.context.getID())t.extra.exceptionInvalidOperation("Cannot create tournament while in a context");t.validateCreatePayload(e);t.randomError(ef);return[4,t.loadCreateTournamentPopupAsync()];case 2:a.sent();return[4,new Promise(function(n,r){if(!t.createAsyncPopup)t.adapter.extra.exceptionUnsupported();t.createAsyncPopup.onYes(t.handleOnYes(n));t.createAsyncPopup.onNo(t.handleOnNo(r));t.createAsyncPopup.show(e);t.extra.isPopupShown=true})];case 3:a.sent();n=t.createMockTournamentAsync(e);r=n.getContextID();t.setCurrentContextID(r);return[2,n]}})})()}},{key:"createMockTournamentAsync",value:function(e,t){var n=arguments.length>1&&void 0!==t&&t;var r=GameCore.Utils.String.generateObjectId();var a=new e_(r,e,n);var o=a.toObject();this.writeTournamentData(r,o);return a}},{key:"postScoreAsync",value:function(e){var t=this;return _async_to_generator(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:return[4,t.awaitRandomDelay()];case 1:r.sent();t.validateAvailableTournament();if(e<0)t.extra.exceptionInvalidParam("Score must be a positive number");t.randomError(eh);n=window.game.player.getPlayerId();t.updateBestScore(n,e);return[2]}})})()}},{key:"shareAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a,o,i,s,c;return _ts_generator(this,function(u){switch(u.label){case 0:t.extra.checkPopupShown();return[4,t.awaitRandomDelay()];case 1:u.sent();t.validateAvailableTournament();t.validateSharePayload(e);t.randomError(ep);return[4,t.loadSharePopupAsync()];case 2:u.sent();n=e.score;r=n;a=t.getCurrentTournament();if(a){o=window.game.player.getPlayerId();i=a.getID().toString();s=t.getBestScore(i,o);if(s&&s<n)r=s}return[4,new Promise(function(e,n){if(!t.shareAsyncPopup)t.adapter.extra.exceptionUnsupported();t.shareAsyncPopup.onYes(t.handleOnYes(e));t.shareAsyncPopup.onNo(t.handleOnNo(n));t.shareAsyncPopup.show(r);t.extra.isPopupShown=true})];case 3:u.sent();c=window.game.player.getPlayerId();t.updateBestScore(c,n);return[2]}})})()}},{key:"getTournamentsAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o;return _ts_generator(this,function(i){switch(i.label){case 0:return[4,e.awaitRandomDelay()];case 1:i.sent();e.randomError(em);t=e.getTournamentsData();n=GameCore.Utils,r=n.Object;a=r.vals(t);o=a.map(function(t){return e.getTournamentInstance(t.id)});return[2,o.filter(function(e){return null!==e})]}})})()}},{key:"joinAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r;return _ts_generator(this,function(a){switch(a.label){case 0:return[4,t.awaitRandomDelay()];case 1:a.sent();if(!GameCore.Utils.Valid.isString(e))t.extra.exceptionInvalidParam("Tournament ID must be a string");n=t.getTournamentInstance(e);if(!n)t.extra.exceptionTournamentNotFound("Tournament could not be found.");t.randomError(ey);r=n.getContextID();return[4,GameSDK.context.switchAsync(r)];case 2:a.sent();return[2]}})})()}},{key:"setCurrentContextID",value:function(e){if(_instanceof(this.context,Y))this.context.setCurrentContextId(e)}},{key:"getCurrentTournament",value:function(){var e=this.context.getID();if(!e)return null;var t=this.getTournamentsData();for(var n in t)if(Object.hasOwn(t,n)){var r=t[n];if(r.contextId===e)return this.getTournamentInstance(n)}return null}},{key:"validateCreatePayload",value:function(e){var t=GameCore.Utils,n=t.Object,r=t.Valid;if(!r.isObject(e))this.extra.exceptionInvalidParam("Payload must be an object");if(!n.hasOwn(e,"initialScore"))this.extra.exceptionInvalidParam("Payload must have initialScore");if(!n.hasOwn(e,"config"))this.extra.exceptionInvalidParam("Payload must have config");var a=e.initialScore,o=e.config;if(!r.isNumber(a))this.extra.exceptionInvalidParam("initialScore must be a number");if(!r.isObject(o))this.extra.exceptionInvalidParam("Config must be an object");if(!n.hasOwn(o,"title"))this.extra.exceptionInvalidParam("Config must have title");if(!n.hasOwn(o,"tournamentTitle"))this.extra.exceptionInvalidParam("Config must have tournamentTitle");if(n.hasOwn(e,"data")&&!r.isObject(e.data))this.extra.exceptionInvalidParam("Data must be an object")}},{key:"validateSharePayload",value:function(e){var t=GameCore.Utils,n=t.Object,r=t.Valid;if(!r.isObject(e))this.extra.exceptionInvalidParam("Payload must be an object");if(!n.hasOwn(e,"score"))this.extra.exceptionInvalidParam("Payload must have score");var a=e.score;if(!r.isNumber(a))this.extra.exceptionInvalidParam("Score must be a number");if(n.hasOwn(e,"data")&&!r.isObject(e.data))this.extra.exceptionInvalidParam("Data must be an object")}},{key:"validateAvailableTournament",value:function(){var e=this.getCurrentTournament();if(e)return;this.extra.exceptionTournamentNotFound("There is no tournament for this context.")}},{key:"getTournamentInstance",value:function(e){var t=this.getTournamentData(e);if(!t)return null;return{getID:/* @__PURE__ */__name(function(){return t.id},"getID"),getTitle:/* @__PURE__ */__name(function(){return t.title},"getTitle"),getPayload:/* @__PURE__ */__name(function(){return t.payload},"getPayload"),getEndTime:/* @__PURE__ */__name(function(){return t.endTime},"getEndTime"),getContextID:/* @__PURE__ */__name(function(){return t.contextId},"getContextID"),getTournamentType:/* @__PURE__ */__name(function(){return t.tournamentType},"getTournamentType")}}},{key:"getTournamentData",value:function(e){var t=this.getTournamentsData();if(!t[e])return null;return t[e]}},{key:"writeTournamentData",value:function(e,t){var n=this.getTournamentsData();n[e]=t;this.writeTournamentsData(n)}},{key:"getTournamentsData",value:function(){var e=GameCore.Utils,t=e.Browser,n=e.Valid;var r=t.getLocalStorage(ev);if(!n.isObject(r))return{};return r}},{key:"writeTournamentsData",value:function(e){var t=GameCore.Utils,n=t.Browser,r=t.Valid;if(!r.isObject(e))return;n.writeLocalStorage(ev,e)}},{key:"getBestScore",value:function(e,t){var n=this.getTournamentLeader(e,t);if(!n)return null;var r;return null!==(r=n.score)&&void 0!==r?r:null}},{key:"updateBestScore",value:function(e,t){var n=this.getCurrentTournament();if(!n)return;var r=n.getID().toString();if(!r)return;var a=this.getTournamentLeader(r,e);if(!a){this.writeTournamentLeader(r,{playerId:e,score:t});return}if(a.score<t){a.score=t;this.writeTournamentLeader(r,a)}}},{key:"getTournamentLeader",value:function(e,t){var n=this.getTournamentLeadersData(e);if(!n.length)return null;var r=GameCore.Utils,a=r.Array;var o;return null!==(o=a.search(n,function(e){return e.playerId===t}))&&void 0!==o?o:null}},{key:"getTournamentLeadersData",value:function(e){var t=GameCore.Utils,n=t.Browser,r=t.Object;var a=n.getLocalStorage(eg);if(!r.hasOwn(a,e))return[];var o=a[e];if(!Array.isArray(o))return[];o.sort(function(e,t){return t.score-e.score});return o}},{key:"writeTournamentLeader",value:function(e,t){var n=GameCore.Utils,r=n.Array;var a=this.getTournamentLeadersData(e);var o=r.searchIndex(a,function(e){return e.playerId===t.playerId});if(-1===o)a.push(t);else a[o]=t;this.writeTournamentLeadersData(e,a)}},{key:"writeTournamentLeadersData",value:function(e,t){var n=GameCore.Utils,r=n.Browser,a=n.Object;if(!Array.isArray(t))return;var o;var i=null!==(o=r.getLocalStorage(eg))&&void 0!==o?o:{};a.assign(i,_define_property({},e,t));r.writeLocalStorage(eg,i)}}]);return _Tournament}();__name(ew,"Tournament");var eb=ew;var eI=eb;var eA=/*#__PURE__*/function(){function _GameSDK(){_class_call_check(this,_GameSDK);__publicField(this,"extra");__publicField(this,"player");__publicField(this,"context");__publicField(this,"tournament");__publicField(this,"shortcut",null);__publicField(this,"isInitialized",false);__publicField(this,"bannerAdInstances",{});__publicField(this,"rewardedVideoInstance",null);__publicField(this,"interstitialAdInstance",null);__publicField(this,"rewardedInterstitialInstance",null)}_create_class(_GameSDK,[{key:"initialize",value:function(){this.extra=new ea(this);this.player=new ec(this);this.context=new Y(this);this.tournament=new eI(this)}},{key:"getLocale",value:function(){return GameCore.Utils.Browser.getLocale()}},{key:"getPlatform",value:function(){var e=GameCore.Utils,t=e.Device;if(t.isAndroid())return"ANDROID";if(t.isIOS())return"IOS";if(t.isDesktop())return"WEB";if(t.isMobile())return"MOBILE_WEB";return null}},{key:"getSDKName",value:function(){return"GameCore"}},{key:"getSDKVersion",value:function(){return"1.0.0"}},{key:"initializeAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o;return _ts_generator(this,function(i){switch(i.label){case 0:if(e.isInitialized)return[2];e.initialize();e.extra.createLoadingElement();return[4,e.extra.waitGameCoreReadyAsync()];case 1:i.sent();return[4,e.extra.delayInitialAsync()];case 2:i.sent();t=GameCore.Utils.Browser.getQueryParams();console.info("Browser params:",t);n=t.splashPreview;if(n){e.extra.destroyLoadingElement();return[2]}r=t.playerId;e.player.initPlayerInfo(r);a=t.context_source_id;o=t.context_type;e.context.initContextInfo(a,o);e.isInitialized=true;return[2]}})})()}},{key:"startGameAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o,i;return _ts_generator(this,function(s){switch(s.label){case 0:return[4,e.extra.delayStartAsync()];case 1:s.sent();t=90;window.__sdkLoadingCount=t;e.setLoadingProgress(t);e.extra.destroyLoadingElement();n=GameCore.Events,r=GameCore.Utils,a=r.Browser.getQueryParams;o=a();i=o.tournament_id;return[4,e.tournament.initTournamentInfoAsync(i)];case 2:s.sent();window.game.event.emit(n.GAME_SDK_STARTED);return[2]}})})()}},{key:"setLoadingProgress",value:function(e){this.extra.setLoadingElementProgress(e)}},{key:"getEntryPointData",value:function(){var e=GameCore.Utils,t=e.Browser,n=e.Json;var r=t.getQueryParams(),a=r.payload,o=void 0===a?"{}":a;if("string"!=typeof o)return{};return n.decode(o)}},{key:"getEntryPointAsync",value:function(){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2,"no_entry"]})})()}},{key:"loadBannerAdAsync",value:function(e){var t=this;return _async_to_generator(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:if(!e)return[2];if(!!t.bannerAdInstances[e])return[3,2];return[4,Promise.resolve().then(function(){return s(),o})];case 1:n=r.sent().default;if("function"!=typeof n)t.extra.exceptionInvalidOperation("Banner ads mock is not enabled");t.bannerAdInstances[e]=new n("banner",e);r.label=2;case 2:return[4,t.bannerAdInstances[e].loadAsync()];case 3:r.sent();return[4,t.bannerAdInstances[e].showAsync()];case 4:r.sent();return[2]}})})()}},{key:"hideBannerAdAsync",value:function(e){var t=this;return _async_to_generator(function(){return _ts_generator(this,function(n){switch(n.label){case 0:if(!t.bannerAdInstances[e])return[2];return[4,t.bannerAdInstances[e].hideAsync()];case 1:n.sent();return[2]}})})()}},{key:"getBannerHeight",value:function(e){return e.BannerHeight}},{key:"getInterstitialAdAsync",value:function(e){var t=this;return _async_to_generator(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:if(!!t.interstitialAdInstance)return[3,2];return[4,Promise.resolve().then(function(){return s(),o})];case 1:n=r.sent().default;if("function"!=typeof n)t.extra.exceptionInvalidOperation("Interstitial ads mock is not enabled");t.interstitialAdInstance=new n("interstitial",e);r.label=2;case 2:return[2,t.interstitialAdInstance]}})})()}},{key:"getRewardedVideoAsync",value:function(e){var t=this;return _async_to_generator(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:if(!!t.rewardedVideoInstance)return[3,2];return[4,Promise.resolve().then(function(){return s(),o})];case 1:n=r.sent().default;if("function"!=typeof n)t.extra.exceptionInvalidOperation("Rewarded video ads mock is not enabled");t.rewardedVideoInstance=new n("rewarded",e);r.label=2;case 2:return[2,t.rewardedVideoInstance]}})})()}},{key:"getRewardedInterstitialAsync",value:function(e){var t=this;return _async_to_generator(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:if(!!t.rewardedInterstitialInstance)return[3,2];return[4,Promise.resolve().then(function(){return s(),o})];case 1:n=r.sent().default;if("function"!=typeof n)t.extra.exceptionInvalidOperation("Rewarded interstitial ads mock is not enabled");t.rewardedInterstitialInstance=new n("rewarded_interstitial",e);r.label=2;case 2:return[2,t.rewardedInterstitialInstance]}})})()}},{key:"getTournamentAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o,i;return _ts_generator(this,function(s){switch(s.label){case 0:e.tournament.randomError(["Unsupported","NetworkFailure"]);t=e.context.getID();n=GameCore.Utils,r=n.Array,a=n.Valid;if(!a.isString(t))e.extra.exceptionInvalidOperation("Not in a context");return[4,e.tournament.getTournamentsAsync()];case 1:o=s.sent();i=r.search(o,function(e){return e.getContextID()===t});if(!i)e.extra.exceptionTournamentNotFound("A Tournament with current context was not found");return[2,i]}})})()}},{key:"getSupportedAPIs",value:function(){var e=GameCore.Configs.Mockup.GameSDK.Player.SubscribeBot.CanSubscribeBot;if(e)return["player.canSubscribeBotAsync"];return[]}},{key:"canCreateShortcutAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.loadMockAddShortcut()];case 1:t.sent();if(!e.shortcut)e.extra.exceptionUnsupported();return[2,e.shortcut.canCreateShortcutAsync()]}})})()}},{key:"createShortcutAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.loadMockAddShortcut()];case 1:t.sent();if(!e.shortcut)e.extra.exceptionUnsupported();return[2,e.shortcut.createShortcutAsync()]}})})()}},{key:"loadMockAddShortcut",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.shortcut)return[2];return[4,Promise.resolve().then(function(){return s(),o})];case 1:t=n.sent().default;if("function"!=typeof t)return[2];e.shortcut=new t(e);return[2]}})})()}}]);return _GameSDK}();__name(eA,"GameSDK");var eP=eA;var eS=eP;r();a();r();a();var ek=/*#__PURE__*/function(){function _AdInstance(e,t){_class_call_check(this,_AdInstance);__publicField(this,"type");__publicField(this,"placementId");this.type=e;this.placementId=t}_create_class(_AdInstance,[{key:"getPlacementID",value:function(){return this.placementId}},{key:"hideAsync",value:function(){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2,Promise.resolve()]})})()}}]);return _AdInstance}();__name(ek,"AdInstance");var eC=ek;var eD=eC;var ex={instanceId:""};var eT={AD_NOT_LOADED:"AD_NOT_LOADED",LOAD_ADS_FAILURE:"LOAD_ADS_FAILURE",INVALID_OPERATION:"INVALID_OPERATION",SHOW_ADS_FAILURE:"SHOW_ADS_FAILURE",SHOW_ADS_TIMEOUT:"SHOW_ADS_TIMEOUT",SHOW_ADS_COMPLETED_FAILURE:"SHOW_ADS_COMPLETED_FAILURE"};var eE=/*#__PURE__*/function(e){_inherits(_MSAdInstance,e);function _MSAdInstance(e,t){_class_call_check(this,_MSAdInstance);var n;n=_call_super(this,_MSAdInstance,[e,""]);__publicField(n,"sdk");__publicField(n,"type");__publicField(n,"instance");__publicField(n,"isAdDisplayed",false);__publicField(n,"isAdShowInProgress",false);n.sdk=t;n.type=e;n.instance=ex;return n}_create_class(_MSAdInstance,[{key:"getPlacementID",value:function(){return this.instance.instanceId}},{key:"resetInstance",value:function(){this.instance=ex}},{key:"loadAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n;return _ts_generator(this,function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);if(e.isAdShowInProgress)throw e.makeErrorWithCode(eT.INVALID_OPERATION,"Can't load ads while showing ads");if(e.instance.instanceId){console.debug("MSAdInstance loadAsync already loaded");return[2]}return[4,e.sdk.loadAdsAsync({isRewardedAd:"rewarded"===e.type})];case 1:t=r.sent();e.instance=t;return[3,3];case 2:n=r.sent();throw e.makeErrorWithCode(eT.LOAD_ADS_FAILURE,n);case 3:return[2]}})})()}},{key:"showAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o;return _ts_generator(this,function(i){switch(i.label){case 0:if(!e.instance.instanceId)throw e.makeErrorWithCode(eT.AD_NOT_LOADED,"Ad is not loaded. InstanceId is empty");if(e.isAdShowInProgress)throw e.makeErrorWithCode(eT.INVALID_OPERATION,"Can't show ads while showing ads");i.label=1;case 1:i.trys.push([1,3,4,5]);e.isAdDisplayed=false;e.isAdShowInProgress=true;t=e.processShowAd(e.instance.instanceId);n=e.scheduleShowingAdTimeout(1e4);r=GameCore.Utils,a=r.Function;return[4,a.any([t,n])];case 2:i.sent();console.debug("MSAdInstance showAsync completed");return[3,5];case 3:o=i.sent();if(_instanceof(o,et))throw o;throw e.makeErrorWithCode(eT.SHOW_ADS_FAILURE,o);case 4:e.isAdShowInProgress=false;return[7];case 5:return[2]}})})()}},{key:"processShowAd",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a;return _ts_generator(this,function(o){switch(o.label){case 0:o.trys.push([0,3,4,5]);return[4,t.sdk.showAdsAsync(e)];case 1:n=o.sent();if(!t.isPromise(n.showAdsCompletedAsync))throw t.makeErrorWithCode(eT.SHOW_ADS_FAILURE,new Error("The showAdsCompletedAsync promise is empty"));t.isAdDisplayed=true;return[4,n.showAdsCompletedAsync];case 2:r=o.sent();console.debug("MSAdInstance processShowAd:",r);return[3,5];case 3:a=o.sent();if(t.isErrorWithCode(a)&&a.code===eT.SHOW_ADS_COMPLETED_FAILURE)a.code="USER_INPUT";throw t.makeErrorWithCode(eT.SHOW_ADS_FAILURE,a);case 4:t.resetInstance();return[7];case 5:return[2]}})})()}},{key:"scheduleShowingAdTimeout",value:function(e){var t=this;return _async_to_generator(function(){return _ts_generator(this,function(n){return[2,new Promise(function(n,r){setTimeout(function(){if(t.isAdDisplayed)t.isAdShowInProgress,r();else r(t.makeErrorWithCode(eT.SHOW_ADS_TIMEOUT,"Showing ad is timed out"))},e)})]})})()}},{key:"isPromise",value:function(e){return(void 0===e?"undefined":_type_of(e))==="object"&&null!==e&&"function"==typeof e.then}},{key:"isErrorWithCode",value:function(e){var t=GameCore.Utils,n=t.Object;return n.hasOwn(e,"code")&&"string"==typeof e.code}},{key:"getErrorReason",value:function(e){var t=GameCore.Utils,n=t.Object;if(n.hasOwn(e,"message")&&"string"==typeof e.message)return{reason:e.message};if(n.hasOwn(e,"description")&&"string"==typeof e.description)return{reason:e.description};return null}},{key:"parseError",value:function(e){try{return"string"==typeof e?e:JSON.stringify(e)}catch(e){return"Unknown error"}}},{key:"makeErrorWithCode",value:function(e,t){var n;var r=e;var a;var o=null!==(a=null===(n=this.getErrorReason(t))||void 0===n?void 0:n.reason)&&void 0!==a?a:"";if(!o)o=this.parseError(t);if(this.isErrorWithCode(t))r=t.code;return new et(r,o)}}]);return _MSAdInstance}(eD);__name(eE,"MSAdInstance");var eO=eE;var eG=eO;r();a();var eN=/*#__PURE__*/function(e){_inherits(_MSContext,e);function _MSContext(){_class_call_check(this,_MSContext);return _call_super(this,_MSContext,arguments)}_create_class(_MSContext,[{key:"getID",value:function(){return this.currentContextID}},{key:"getType",value:function(){return this.currentContextType}},{key:"switchAsync",value:function(e,t){var n=arguments.length>1&&void 0!==t&&t;var r=this;return _async_to_generator(function(){return _ts_generator(this,function(t){r.validateSwitchAsyncContextId(e);if("SOLO"===e&&n){r.currentContextID=null;r.currentContextType="SOLO";return[2]}r.currentContextID=e;r.currentContextType="THREAD";return[2]})})()}},{key:"chooseAsync",value:function(e){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2]})})()}},{key:"createAsync",value:function(e){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2]})})()}},{key:"getPlayersAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.extra.awaitRandomDelay()];case 1:t.sent();return[2,e.currentContextPlayers]}})})()}}]);return _MSContext}(Y);__name(eN,"MSContext");var eM=eN;var eL=eM;r();a();r();a();var eB="How about diving into the game for a relaxing experience?";var eF=/*#__PURE__*/function(){function _MSDailyNotification(){_class_call_check(this,_MSDailyNotification)}_create_class(_MSDailyNotification,[{key:"sendDailyNotificationInstance",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a;return _ts_generator(this,function(o){try{t=GameCore.Configs,n=t.GameSDKOptions,r=n.MSGames.ScheduleNotification;if(!r)throw new Error("MsGamesNotification content not set up!");a=e.getNotificationPayloads();e.batchSendNotification(a);e.updatePlayerNotificationData(a)}catch(e){console.warn(e)}return[2]})})()}},{key:"getNotificationPayloads",value:function(){var e=globalThis.game.player;var t=e.getNotificationData();var n={};var r=[];var a=Date.now();var o=a;for(var i=1;i<=7;i++){var s;var c="D".concat(i);var u=(null===(s=t[c])||void 0===s?void 0:s.arrivalDate)||0;if(a<u){o=Math.max(o,u);continue}r.push(c)}if(0===r.length)return n;var l=Math.floor(o-a)/1e3;for(var _=0;_<r.length;_++){var d=r[_];var f=parseInt(d.replace("D",""));var y={description:this.getNotificationContent(d),minDelayInSeconds:86400*(_+1)+l,type:f};n[d]=y}return n}},{key:"getNotificationContent",value:function(e){var t=GameCore.Configs,n=t.GameSDKOptions,r=n.MSGames.ScheduleNotification;if(!r)throw new Error("MsGamesNotification content not set up!");if(this.validateNotificationKey(e)){var a=r[e];if(!a||""===a)return eB;return a}return eB}},{key:"updatePlayerNotificationData",value:function(e){var t=globalThis.game.player;var n=t.getNotificationData();var r=Date.now();for(var a=1;a<=7;a++){var o="D".concat(a);var i=e[o];if(!!i){var s=i.minDelayInSeconds;if(!!s)n[o]={arrivalDate:r+1e3*s}}}t.setPlayerDataByName("notificationData",n)}},{key:"batchSendNotification",value:function(e){if(!("scheduleNotificationAsync"in GameSDK.extra))throw new Error("scheduleNotificationAsync is not available!");for(var t=1;t<=7;t++){var n="D".concat(t);var r=e[n];if(!!r)GameSDK.extra.scheduleNotificationAsync(r)}}},{key:"validateNotificationKey",value:function(e){var t=GameCore.Utils,n=t.Array;return n.has(["D1","D2","D3","D4","D5","D6","D7"],e)}}],[{key:"sendDailyNotification",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){t=e.getInstance();return[2,t.sendDailyNotificationInstance()]})})()}},{key:"getInstance",value:function(){if(!this._instance)this._instance=new _MSDailyNotification;return this._instance}}]);return _MSDailyNotification}();__name(eF,"MSDailyNotification");__publicField(eF,"_instance");var eU=eF;var eR=eU;var eK="Save The Pets".replace(/ /g,"-");var ej=/*#__PURE__*/function(e){_inherits(_MSExtra,e);function _MSExtra(e){_class_call_check(this,_MSExtra);var t;t=_call_super(this,_MSExtra,[e]);__publicField(t,"sdk");__publicField(t,"shareImageBase64");__publicField(t,"notificationImageBase64");t.sdk=e.sdk;t.adapter=e;return t}_create_class(_MSExtra,[{key:"shareAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n;return _ts_generator(this,function(r){switch(r.label){case 0:r.trys.push([0,4,,5]);if(!!e.shareImageBase64)return[3,2];return[4,e.loadImageAsync("./public/share-95x95.jpg")];case 1:t=r.sent();if(t)e.shareImageBase64=t;r.label=2;case 2:return[4,e.sdk.shareAsync({title:eK,text:"Play now!",image:e.shareImageBase64})];case 3:r.sent();return[3,5];case 4:n=r.sent();console.warn("shareAsync",n);return[3,5];case 5:return[2]}})})()}},{key:"switchGameAsync",value:function(e){var t={id:e};return this.sdk.switchGameAsync(t)}},{key:"submitGameResultsAsync",value:function(e){return this.sdk.submitGameResultsAsync(e)}},{key:"scheduleNotificationAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a,o,i;return _ts_generator(this,function(s){switch(s.label){case 0:if(!!t.notificationImageBase64)return[3,4];s.label=1;case 1:s.trys.push([1,3,,4]);return[4,t.loadImageAsync("./public/notification-364x180.jpg")];case 2:n=s.sent();if(n)t.notificationImageBase64=n;return[3,4];case 3:r=s.sent();console.warn("scheduleNotificationAsync > notificationImageBase64",r);return[3,4];case 4:a={playerId:t.adapter.player.getID()||"Anonymous"};o={title:eK,description:"We miss you!",type:0,minDelayInSeconds:300,imageData:t.notificationImageBase64,callToAction:"Play now!",payload:JSON.stringify(a)};o=_object_spread({},o,e);s.label=5;case 5:s.trys.push([5,7,,8]);return[4,t.sdk.scheduleNotificationAsync(o)];case 6:s.sent();return[3,8];case 7:i=s.sent();console.warn("scheduleNotificationAsync",i);return[3,8];case 8:return[2]}})})()}},{key:"sendDailyNotificationAsync",value:function(){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2,eR.sendDailyNotification()]})})()}},{key:"isValidDisplayAdPlacement",value:function(e){var t=["top:728x90","bottom:728x90","left:300x250","right:300x250","topleft:300x250","topright:300x250","bottomleft:300x250","bottomright:300x250","top:320x50","right:320x50","bottom:320x50","left:320x50","left:300x600","right:300x600","top:970x250","bottom:970x250","left:160x600","right:160x600"];return t.indexOf(e)>-1}},{key:"getBannerOffset",value:function(){return 20}},{key:"loadImageAsync",value:function(e){return _async_to_generator(function(){var t,n,r,a,o,i;return _ts_generator(this,function(s){switch(s.label){case 0:t=GameCore.Utils,n=t.Image,r=n.fetchImage,a=n.blobToDataImage;return[4,r(e)];case 1:o=s.sent();return[4,a(o)];case 2:i=s.sent();return[2,i]}})})()}}]);return _MSExtra}(ea);__name(ej,"MSExtra");var ez=ej;var eW=ez;r();a();var eH=/*#__PURE__*/function(e){_inherits(_MSPlayer,e);function _MSPlayer(e){_class_call_check(this,_MSPlayer);var t;t=_call_super(this,_MSPlayer,[e]);__publicField(t,"_personalInfo");__publicField(t,"signature","");__publicField(t,"isLoginEnabled",false);t.updateLoginEnabledConfig();return t}_create_class(_MSPlayer,[{key:"updateLoginEnabledConfig",value:function(){var e=n;if(!e)return;var t=e.MSGames;if(!t)return;this.isLoginEnabled=t.UseLoginFeature}},{key:"initPlayerAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:n.trys.push([0,8,,10]);return[4,e.tryGettingSignedInPlayer()];case 1:t=n.sent();if(!(e.isLoginEnabled&&!t))return[3,3];return[4,e.tryMakingPlayerSignedIn()];case 2:t=n.sent();n.label=3;case 3:if(!t)return[3,5];return[4,e.initLoggedMode(t)];case 4:n.sent();return[3,7];case 5:return[4,e.initGuestMode()];case 6:n.sent();n.label=7;case 7:return[3,10];case 8:n.sent();return[4,e.initGuestMode()];case 9:n.sent();return[3,10];case 10:return[2]}})})()}},{key:"updateCurrentPlayerInfo",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a,o;return _ts_generator(this,function(i){n=GameCore.Utils,r=n.Valid,a=n.Number;o=t.getID();if(!r.isString(o)||!r.isString(e)){o="".concat(a.random(1e5));t.currentPlayerInfo.playerId=o;t.currentPlayerInfo.playerName="Guest_".concat(o)}return[2]})})()}},{key:"initLoggedMode",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a;return _ts_generator(this,function(o){n=e.playerId,r=e.signature,a=e.playerDisplayName;t.currentPlayerInfo.playerId=n;t.currentPlayerInfo.playerName=a;t.signature="".concat(n," ").concat(r);t._personalInfo={id:n,avatarIdHash:"0",lang:"en",publicName:a,uniqueID:n,scopePermissions:{avatar:"forbid",public_name:"forbid"}};t.extra.isGuest=false;t.initPlayerInfo(n);return[2]})})()}},{key:"initGuestMode",value:function(){var e=this;return _async_to_generator(function(){var t,n;return _ts_generator(this,function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,e.getRandomName()];case 1:t=r.sent();n=t.replace(/ /g,"-");if(n===e.getID())return[2];e.currentPlayerInfo.playerId=n;e.currentPlayerInfo.playerName=t;e._personalInfo={id:n,avatarIdHash:"0",lang:"en",publicName:t,uniqueID:n,scopePermissions:{avatar:"forbid",public_name:"forbid"}};e.extra.isGuest=true;e.initPlayerInfo(n);return[3,3];case 2:r.sent();return[3,3];case 3:return[2]}})})()}},{key:"getRandomName",value:function(){return _async_to_generator(function(){var e,t;return _ts_generator(this,function(n){e=GameCore.Utils,t=e.String;return[2,t.generateNameAsync()]})})()}},{key:"tryGettingSignedInPlayer",value:function(){var e=this;return _async_to_generator(function(){var t,n,r;return _ts_generator(this,function(a){switch(a.label){case 0:t=null;n=e.adapter.sdk;a.label=1;case 1:a.trys.push([1,3,,4]);return[4,n.getSignedInUserAsync()];case 2:t=a.sent();return[3,4];case 3:r=a.sent();console.warn("tryGettingSignedInPlayer",r);return[3,4];case 4:return[2,Promise.resolve(t)]}})})()}},{key:"tryMakingPlayerSignedIn",value:function(){var e=this;return _async_to_generator(function(){var t,n,r;return _ts_generator(this,function(a){switch(a.label){case 0:t=null;n=e.adapter.sdk;a.label=1;case 1:a.trys.push([1,3,,4]);return[4,n.signInAsync()];case 2:t=a.sent();return[3,4];case 3:r=a.sent();console.warn("tryMakingPlayerSignedIn",r);return[3,4];case 4:return[2,Promise.resolve(t)]}})})()}},{key:"getASIDAsync",value:function(){var e;return Promise.resolve(null!==(e=this.getID())&&void 0!==e?e:"")}},{key:"getSignedASIDAsync",value:function(){var e=this;return Promise.resolve({getASID:/* @__PURE__ */__name(function(){var t;return null!==(t=e.getID())&&void 0!==t?t:""},"getASID"),getSignature:/* @__PURE__ */__name(function(){return e.signature},"getSignature")})}},{key:"getSignedPlayerInfoAsync",value:function(){var e=this;return Promise.resolve({getPlayerID:/* @__PURE__ */__name(function(){var t;return null!==(t=e.getID())&&void 0!==t?t:"10"},"getPlayerID"),getSignature:/* @__PURE__ */__name(function(){return e.signature},"getSignature")})}},{key:"canSubscribeBotAsync",value:function(){return Promise.resolve(false)}},{key:"subscribeBotAsync",value:function(){this.adapter.extra.exceptionUnsupported()}},{key:"getConnectedPlayersAsync",value:function(){this.adapter.extra.exceptionUnsupported()}}]);return _MSPlayer}(ec);__name(eH,"MSPlayer");var eV=eH;var eY=eV;r();a();r();a();var eq=/*#__PURE__*/function(){function _MSTournamentInstance(e){_class_call_check(this,_MSTournamentInstance);__publicField(this,"id");__publicField(this,"title");__publicField(this,"contextId");__publicField(this,"payload");__publicField(this,"endTime");__publicField(this,"tournamentType");var t=e._id,n=e.name,r=e.type,a=e.createdAt,o=e.expireTime;var i=JSON.parse(e.description);var s=_object_spread({leaderboardId:t},i);this.id=i.tournamentId;this.title=n;this.contextId=i.contextId;this.payload=JSON.stringify(s);this.endTime=Math.round((new Date(a).getTime()+1e3*o)/1e3);this.tournamentType="world_tournament_leaderboard"===r?"PAGE_HOSTED":"DEFAULT"}_create_class(_MSTournamentInstance,[{key:"getID",value:function(){return this.id}},{key:"getTitle",value:function(){return this.title}},{key:"getPayload",value:function(){return this.payload}},{key:"getEndTime",value:function(){return this.endTime}},{key:"getContextID",value:function(){return this.contextId}},{key:"getTournamentType",value:function(){return this.tournamentType}}]);return _MSTournamentInstance}();__name(eq,"MSTournamentInstance");var eJ=eq;var eQ=eJ;var e$=/*#__PURE__*/function(e){_inherits(_YDTournament,e);function _YDTournament(){_class_call_check(this,_YDTournament);return _call_super(this,_YDTournament,arguments)}_create_class(_YDTournament,[{key:"joinAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a,o;return _ts_generator(this,function(i){switch(i.label){case 0:n=GameCore.Utils,r=n.Array;return[4,t.getTournamentsAsync()];case 1:a=i.sent();o=r.search(a,function(t){return t.getID()===e});if(!o)t.extra.exceptionTournamentNotFound("Tournament could not be found.");return[4,GameSDK.context.switchAsync(o.getContextID())];case 2:i.sent();return[2]}})})()}},{key:"getTournamentsAsync",value:function(){return _async_to_generator(function(){var e,t,n,r,a,o,i,s,c,u,l;return _ts_generator(this,function(_){switch(_.label){case 0:e=[];_.label=1;case 1:_.trys.push([1,3,,4]);t=globalThis.game.leaderboard;return[4,t.requestLeaderboardsAsync({limit:100,type:"world_tournament_leaderboard"})];case 2:n=_.sent();r=true,a=false,o=void 0;try{for(i=n[Symbol.iterator]();!(r=(s=i.next()).done);r=true){c=s.value;u=new eQ(c);e.push(u)}}catch(e){a=true;o=e}finally{try{if(!r&&null!=i.return)i.return()}finally{if(a)throw o}}return[3,4];case 3:l=_.sent();console.warn("fetchGlobalTournamentLeaderboardAsync",l);return[3,4];case 4:return[2,e]}})})()}}]);return _YDTournament}(eI);__name(e$,"YDTournament");var eX=e$;var eZ=eX;var e0=/*#__PURE__*/function(e){_inherits(_MSAdapter,e);function _MSAdapter(e){_class_call_check(this,_MSAdapter);var t;t=_call_super(this,_MSAdapter);__publicField(t,"sdk");__publicField(t,"adPlacementList",/* @__PURE__ */new Set);t.sdk=e;return t}_create_class(_MSAdapter,[{key:"initialize",value:function(){_get(_get_prototype_of(_MSAdapter.prototype),"initialize",this).call(this);this.extra=new eW(this);this.player=new eY(this);this.context=new eL(this);this.tournament=new eZ(this);this.rewardedVideoInstance=new eG("rewarded",this.sdk);this.interstitialAdInstance=new eG("interstitial",this.sdk)}},{key:"initializeAsync",value:function(){var e=this;var t=this,_superprop_get_initializeAsync=function(){return _get(_get_prototype_of(_MSAdapter.prototype),"initializeAsync",e)};return _async_to_generator(function(){return _ts_generator(this,function(e){switch(e.label){case 0:if(t.isInitialized)return[2];return[4,_superprop_get_initializeAsync().call(t)];case 1:e.sent();t.isInitialized=false;e.label=2;case 2:e.trys.push([2,4,,5]);return[4,t.player.initPlayerAsync()];case 3:e.sent();t.isInitialized=true;return[3,5];case 4:e.sent();console.warn("Microsoft Games SDK not initialized, running without platform sdk");return[3,5];case 5:return[2]}})})()}},{key:"startGameAsync",value:function(){if(!this.sdk.isInMicrosoftStart())throw new Error("Not in Microsoft Start");return _get(_get_prototype_of(_MSAdapter.prototype),"startGameAsync",this).call(this)}},{key:"getLocale",value:function(){return this.sdk.getLocale()}},{key:"getSDKVersion",value:function(){return"v1.0.0-rc.13"}},{key:"getSDKName",value:function(){return"MsGames"}},{key:"canCreateShortcutAsync",value:function(){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2,true]})})()}},{key:"createShortcutAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,e.sdk.promptInstallAsync()];case 1:n.sent();return[3,3];case 2:t=n.sent();console.warn("createShortcutAsync",t);return[3,3];case 3:return[2]}})})()}},{key:"getInterstitialAdAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){return[2,e.interstitialAdInstance]})})()}},{key:"getRewardedVideoAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){return[2,e.rewardedVideoInstance]})})()}},{key:"loadBannerAdAsync",value:function(e){var t=this;return _async_to_generator(function(){var e,n,r,a,o,i,s,c,u,l,_;return _ts_generator(this,function(d){switch(d.label){case 0:e=GameCore.Configs.Ads.BannerDisplayAdOptions;n=true,r=false,a=void 0;try{for(o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=true){s=i.value;c=s.Position,u=s.BannerWidth,l=s.BannerHeight;_="".concat(c,":").concat(u,"x").concat(l);if(t.extra.isValidDisplayAdPlacement(_))t.adPlacementList.add(_)}}catch(e){r=true;a=e}finally{try{if(!n&&null!=o.return)o.return()}finally{if(r)throw a}}return[4,t.showBannerAdsAsync()];case 1:d.sent();return[2]}})})()}},{key:"hideBannerAdAsync",value:function(e){var t=this;return _async_to_generator(function(){var e;return _ts_generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,t.sdk.hideDisplayAdsAsync()];case 1:n.sent();return[3,3];case 2:e=n.sent();console.warn("\uD83D\uDE80 > hideBannerAdAsync",e);return[3,3];case 3:return[2]}})})()}},{key:"getEntryPointAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){t=e.sdk.getEntryPointInfo();if(e.sdk.getNotificationPayload())return[2,"msn_notification"];return[2,t.entryPointId]})})()}},{key:"showBannerAdsAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(0!==e.adPlacementList.size)return[3,1];e.extra.exceptionInvalidOperation("Invalid banner ad placement");return[3,4];case 1:n.trys.push([1,3,,4]);t=_to_consumable_array(e.adPlacementList);return[4,e.sdk.showDisplayAdsAsync(t)];case 2:n.sent();return[3,4];case 3:n.sent();return[3,4];case 4:e.adPlacementList.clear();return[2]}})})()}},{key:"getTournamentAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o,i;return _ts_generator(this,function(s){switch(s.label){case 0:t=e.context.getID();n=GameCore.Utils,r=n.Array,a=n.Valid;if(!a.isString(t))e.extra.exceptionInvalidOperation("Not in a context");return[4,e.tournament.getTournamentsAsync()];case 1:o=s.sent();i=r.search(o,function(e){return e.getContextID()===t});if(!i)e.extra.exceptionTournamentNotFound("A Tournament with current context was not found");return[2,i]}})})()}}]);return _MSAdapter}(eS);__name(e0,"MSAdapter");var e2=e0;var e1=e2;s();r();a();var e4=/*#__PURE__*/function(){function _AccessBlocker(){_class_call_check(this,_AccessBlocker);__publicField(this,"usedCallLocations");this.usedCallLocations=/* @__PURE__ */Object.create(null)}_create_class(_AccessBlocker,[{key:"getCallerLine",value:function(){var e=new Error;if(!e.stack)return null;var t=e.stack.split("\n");var n=t[4];var r=n?n.trim():null;return r}},{key:"blockAccess",value:function(e){try{var t=this.getCallerLine();if(!t)return e;if(this.usedCallLocations[t])return e;var n=["eval","at <","(<"];if(n.some(function(e){return t.includes(e)}))throw new Error("Access blocked for the caller: ".concat(t));this.usedCallLocations[t]=true;return e}catch(e){console.warn("Block access encountered an error:",e);return}}}]);return _AccessBlocker}();__name(e4,"AccessBlocker");var e3=e4;new e3;var e5=/* @__PURE__ */__name(function(e,t){},"wrapGetterToBlockObjectAccess");var e6=e5;console.groupCollapsed("âš¡ï¸ Corecos initialized");function autoDetectAndInitializeSDKAdapter(){var e;var t=window;var n="GameSDK";if("FBInstant"in t){n="FBInstant";e=new i(window.FBInstant)}else if("YaGames"in t){n="Yandex";e=new i(window.YaGames)}else if("$msstart"in t){n="MsGames";e=new e1(window.$msstart)}else if("gdsdk"in t){n="GameDistribution";e=new i(window.gdsdk)}else if("CrazyGames"in t){n="CrazyGames";e=new i(window.CrazyGames.SDK)}else if("GlanceGamingAdInterface"in t){n="Glance";e=new i(window.GlanceGamingAdInterface)}else e=new eS;console.info("GameSDK loaded (".concat(n,")"));return e}__name(autoDetectAndInitializeSDKAdapter,"autoDetectAndInitializeSDKAdapter");console.groupCollapsed("\uD83D\uDD79ï¸ GameSDK");window.GameSDK=Object.seal(autoDetectAndInitializeSDKAdapter());e6(window,"GameSDK")})();(function(){"use strict";var e=Object.defineProperty;var __name=function(t,n){return e(t,"name",{value:n,configurable:true})};var t={TAG_IDS:"G-EX3MNH7ENG",BUILD_VERSION:"16"};var n=t;var r=0;var a=/* @__PURE__ */__name(function(){var e=setInterval(function(){if(window.__sdkLoadingCount>=99){clearInterval(e);return}if(r===window.__sdkLoadingCount)return;r=window.__sdkLoadingCount;GameSDK.setLoadingProgress(window.__sdkLoadingCount)},300)},"stepProgressLoading");var o=/* @__PURE__ */__name(/*#__PURE__*/_async_to_generator(function(){var e;return _ts_generator(this,function(t){switch(t.label){case 0:console.info("GameSDK initializing...");console.groupEnd();t.label=1;case 1:t.trys.push([1,3,,4]);return[4,GameSDK.initializeAsync()];case 2:t.sent();return[3,4];case 3:e=t.sent();console.warn("GameSDK initialize failed, retry...",e);setTimeout(o,500);return[2];case 4:window.__sdkLoadingCount=1;GameSDK.setLoadingProgress(window.__sdkLoadingCount);a();return[3,5];case 5:return[4,s()];case 6:t.sent();t.label=7;case 7:console.groupEnd();console.info("GameSDK initialized");window.__sdkInitiated=true;return[2]}})}),"initGameSDK");var i={};var s=/* @__PURE__ */__name(/*#__PURE__*/_async_to_generator(function(){var e,t,r,a,o,i,s;return _ts_generator(this,function(l){switch(l.label){case 0:l.trys.push([0,2,3,4]);e=n.TAG_IDS;t=e.split(" ");if(0===t.length)return[2];if(!t[0]||"null"===t[0])return[2];return[4,GameSDK.getEntryPointAsync()];case 1:a=null!==(r=l.sent())&&void 0!==r?r:"no_entry";o=document.createElement("script");o.async=true;o.src="https://www.googletagmanager.com/gtag/js?id=".concat(t[0]);document.head.appendChild(o);i=GameSDK.player.getID();u(i,a,t);return[3,4];case 2:s=l.sent();c(s);return[3,4];case 3:_();return[7];case 4:return[2]}})}),"processGoogleAnalytics");var c=/* @__PURE__ */__name(function(e){var t=window.game,n=t.analytics,r=t.monitorError;if(!r){window.__errorQueue.push(e);return}n.event("app_crash_handle",{error:e});r.sendException(e)},"logError");var u=/* @__PURE__ */__name(function(e,t,r){try{window.focus();var a=n.BUILD_VERSION,o=void 0===a?"0":a;var s=GameSDK.getEntryPointData()||{},u=s.fbig_ad_id,l=s.fbig_adset_id,_=s.fbig_campaign_id;window.gtag("js",/* @__PURE__ */new Date);window.gtag("set","client_id","100.".concat(e));window.gtag("set","user_id",e);window.gtag("set","send_page_view",false);r.forEach(function(e){window.gtag("config",e,{cookie_flags:"SameSite=None;Secure",build:o,medium:t,campaign:_,groups:"GA"})});var d=GameCore.Utils.Browser.getQueryParams();var f=d.entry_point||t;i.user_id=e;i.player_id=e;i.app_version=o;i.traffic_source=t;i.traffic_source_detail=f;i.ad_id=u;i.adset_id=l;i.campaign_id=_;window.gtag("set","user_properties",i)}catch(e){c(e)}},"initGoogleAnalytics");var l=30;var _=/* @__PURE__ */__name(function(e){var t=arguments.length>0&&void 0!==e?e:0;if(t>=l)return;if(!window.game||!window.game.event){console.warn("Game not ready, retry...");setTimeout(function(){return _(t+1)},2);return}d();y()},"progressAnalyticsWhenCoreInitialized");var d=/* @__PURE__ */__name(function(){var e=window.game,t=e.analytics,n=e.event;var r=GameCore.Events,a=GameCore.Plugins,o=a.Analytics,i=o.Events,s=i.APP_LAUNCH,c=i.APP_INITIALIZED;t.event(s);n.catchUp(r.GAME_SDK_READY,function(){t.event(c)})},"logAppInitializedEvent");var f=/* @__PURE__ */__name(function(){try{var e=window.game.player;var t=e.getBestScore();var n;var r=null!==(n=e.getGameData().coins)&&void 0!==n?n:0;var a=e.isFirstLogin();i.new_user=a;i.coins=r;i.score=t;var o=GameSDK.getEntryPointData();var s=o||{},u=s.content,l=s.notif_id;if(u||l)i.traffic_source_detail=null!=u?u:"notif_".concat(l);window.gtag("set","user_properties",i)}catch(e){c(e)}},"processUserProperties");var y=/* @__PURE__ */__name(function(){try{var e=GameSDK.player.getID();if(!e)return;var t=window.game.event;var n=GameCore.Events.PLAYER_INFO_LOADED;t.catchUp(n,f)}catch(e){c(e)}},"updateUserPropertiesWhenPlayerInfoLoaded");o()})();