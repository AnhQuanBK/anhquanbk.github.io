function _array_like_to_array(e,t){if(null==t||t>e.length)t=e.length;for(var o=0,c=new Array(t);o<t;o++)c[o]=e[o];return c}function _array_with_holes(e){if(Array.isArray(e))return e}function _array_without_holes(e){if(Array.isArray(e))return _array_like_to_array(e)}function _assert_this_initialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function asyncGeneratorStep(e,t,o,c,l,d,h){try{var _=e[d](h);var y=_.value}catch(e){o(e);return}if(_.done)t(y);else Promise.resolve(y).then(c,l)}function _async_to_generator(e){return function(){var t=this,o=arguments;return new Promise(function(c,l){var d=e.apply(t,o);function _next(e){asyncGeneratorStep(d,c,l,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(d,c,l,_next,_throw,"throw",e)}_next(void 0)})}}function _call_super(e,t,o){t=_get_prototype_of(t);return _possible_constructor_return(e,_is_native_reflect_construct()?Reflect.construct(t,o||[],_get_prototype_of(e).constructor):t.apply(e,o))}function _class_call_check(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _construct(){_construct=_is_native_reflect_construct()?Reflect.construct:function construct(e,t,o){var c=[null];c.push.apply(c,t);var l=Function.bind.apply(e,c);var d=new l;if(o)_set_prototype_of(d,o.prototype);return d};return _construct.apply(null,arguments)}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var c=t[o];c.enumerable=c.enumerable||false;c.configurable=true;if("value"in c)c.writable=true;Object.defineProperty(e,c.key,c)}}function _create_class(e,t,o){if(t)_defineProperties(e.prototype,t);if(o)_defineProperties(e,o);return e}function _define_property(e,t,o){if(t in e)Object.defineProperty(e,t,{value:o,enumerable:true,configurable:true,writable:true});else e[t]=o;return e}function _get(e,t,o){_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function get(e,t,o){var c=_super_prop_base(e,t);if(!c)return;var l=Object.getOwnPropertyDescriptor(c,t);if(l.get)return l.get.call(o||e);return l.value};return _get(e,t,o||e)}function _get_prototype_of(e){_get_prototype_of=Object.setPrototypeOf?Object.getPrototypeOf:function getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)};return _get_prototype_of(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});if(t)_set_prototype_of(e,t)}function _instanceof(e,t){if(null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance])return!!t[Symbol.hasInstance](e);return e instanceof t}function _is_native_function(e){return -1!==Function.toString.call(e).indexOf("[native code]")}function _iterable_to_array(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _iterable_to_array_limit(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==o)return;var c=[];var l=true;var d=false;var h,_;try{for(o=o.call(e);!(l=(h=o.next()).done);l=true){c.push(h.value);if(t&&c.length===t)break}}catch(e){d=true;_=e}finally{try{if(!l&&null!=o.return)o.return()}finally{if(d)throw _}}return c}function _non_iterable_rest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _non_iterable_spread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _object_spread(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};var c=Object.keys(o);if("function"==typeof Object.getOwnPropertySymbols)c=c.concat(Object.getOwnPropertySymbols(o).filter(function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable}));c.forEach(function(t){_define_property(e,t,o[t])})}return e}function ownKeys(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);if(t)c=c.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable});o.push.apply(o,c)}return o}function _object_spread_props(e,t){t=null!=t?t:{};if(Object.getOwnPropertyDescriptors)Object.defineProperties(e,Object.getOwnPropertyDescriptors(t));else ownKeys(Object(t)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(t,o))});return e}function _possible_constructor_return(e,t){if(t&&("object"===_type_of(t)||"function"==typeof t))return t;return _assert_this_initialized(e)}function _set_prototype_of(e,t){_set_prototype_of=Object.setPrototypeOf||function setPrototypeOf(e,t){e.__proto__=t;return e};return _set_prototype_of(e,t)}function _sliced_to_array(e,t){return _array_with_holes(e)||_iterable_to_array_limit(e,t)||_unsupported_iterable_to_array(e,t)||_non_iterable_rest()}function _super_prop_base(e,t){while(!Object.prototype.hasOwnProperty.call(e,t)){e=_get_prototype_of(e);if(null===e)break}return e}function _to_consumable_array(e){return _array_without_holes(e)||_iterable_to_array(e)||_unsupported_iterable_to_array(e)||_non_iterable_spread()}function _type_of(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function _unsupported_iterable_to_array(e,t){if(!e)return;if("string"==typeof e)return _array_like_to_array(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);if("Object"===o&&e.constructor)o=e.constructor.name;if("Map"===o||"Set"===o)return Array.from(o);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return _array_like_to_array(e,t)}function _wrap_native_super(e){var t="function"==typeof Map?new Map:void 0;_wrap_native_super=function wrapNativeSuper(e){if(null===e||!_is_native_function(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,Wrapper)}function Wrapper(){return _construct(e,arguments,_get_prototype_of(this).constructor)}Wrapper.prototype=Object.create(e.prototype,{constructor:{value:Wrapper,enumerable:false,writable:true,configurable:true}});return _set_prototype_of(Wrapper,e)};return _wrap_native_super(e)}function _is_native_reflect_construct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_is_native_reflect_construct=function(){return!!e})()}function _ts_generator(e,t){var o,c,l,d,h={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return d={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d;function verb(e){return function(t){return step([e,t])}}function step(d){if(o)throw new TypeError("Generator is already executing.");while(h)try{if(o=1,c&&(l=2&d[0]?c.return:d[0]?c.throw||((l=c.return)&&l.call(c),0):c.next)&&!(l=l.call(c,d[1])).done)return l;if(c=0,l)d=[2&d[0],l.value];switch(d[0]){case 0:case 1:l=d;break;case 4:h.label++;return{value:d[1],done:false};case 5:h.label++;c=d[1];d=[0];continue;case 7:d=h.ops.pop();h.trys.pop();continue;default:if(l=h.trys,!(l=l.length>0&&l[l.length-1])&&(6===d[0]||2===d[0])){h=0;continue}if(3===d[0]&&(!l||d[1]>l[0]&&d[1]<l[3])){h.label=d[1];break}if(6===d[0]&&h.label<l[1]){h.label=l[1];l=d;break}if(l&&h.label<l[2]){h.label=l[2];h.ops.push(d);break}if(l[2])h.ops.pop();h.trys.pop();continue}d=t.call(e,h)}catch(e){d=[6,e];c=0}finally{o=l=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:true}}}var Do=Object.defineProperty;var Po=function(e,t,o){return t in e?Do(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o};var u=function(e,t,o){return Po(e,(void 0===t?"undefined":_type_of(t))!="symbol"?t+"":t,o)};System.register(["./bundle/core.js","./bundle/monitor-error.js"],function(e,t){"use strict";var o,c,l,d,h,_,y,f;return{setters:[function(e){o=e.G,c=e.P,l=e.M,d=e._,h=e.a,_=e.C,y=e.w},function(e){f=e.g}],execute:function execute(){var p=o.Utils,v=p.Valid,g=p.Object,m=p.String,A=p.Json,k="is invalid",b=/*#__PURE__*/function(){function ne(e){_class_call_check(this,ne);this.defaultData(),this.processData(e)}_create_class(ne,[{key:"processData",value:function processData(e){this.validateStructure(e),this.validateData(e),this.setupData(e)}},{key:"defaultData",value:function defaultData(){var e=this.constructor,t=e.name;this.lazyDefaultData(ne.data[t])}},{key:"lazyDefaultData",value:function lazyDefaultData(e){v.isObject(e)||this.exception("data",k);for(var t in e)if(g.hasOwn(e,t)){var o=e[t];g.assign(this,_define_property({},t,o))}}},{key:"lazyValidateStructure",value:function lazyValidateStructure(e){v.isObject(e)||this.exception("structure","is not object");var t=this.getKeys();var o=true,c=false,l=void 0;try{for(var d=t[Symbol.iterator](),h;!(o=(h=d.next()).done);o=true){var _=h.value;var y=this[_];void 0===y&&this.exception("structure","has no key ".concat(_)),g.hasOwn(e,_)||void 0===y||this.setDefaultData(_,e)}}catch(e){c=true;l=e}finally{try{if(!o&&null!=d.return)d.return()}finally{if(c)throw l}}}},{key:"setDefaultData",value:function setDefaultData(e,t){v.isObject(t)||this.exception("data",k);var o=this[e];void 0===o&&this.exception("default","has no key ".concat(e)),g.assign(t,_define_property({},e,o))}},{key:"lazyValidateData",value:function lazyValidateData(e){var t=this.getKeys();var o=true,c=false,l=void 0;try{for(var d=t[Symbol.iterator](),h;!(o=(h=d.next()).done);o=true){var _=h.value;var y=e[_],f=m.removeDiacritics(_).replace(/[^a-zA-Z0-9]/g,""),p="validate".concat(m.capitalize(f)),v=this[p];if("function"==typeof v)try{v.call(this,y)}catch(t){this.setDefaultData(_,e)}else this.exception("validate","has no function ".concat(p))}}catch(e){c=true;l=e}finally{try{if(!o&&null!=d.return)d.return()}finally{if(c)throw l}}}},{key:"lazySetupData",value:function lazySetupData(e){var t=this.getKeys();var o=true,c=false,l=void 0;try{for(var d=t[Symbol.iterator](),h;!(o=(h=d.next()).done);o=true){var _=h.value;var y=e[_];g.assign(this,_define_property({},_,y))}}catch(e){c=true;l=e}finally{try{if(!o&&null!=d.return)d.return()}finally{if(c)throw l}}}},{key:"validate",value:function validate(){this.validateData(this.toObject())}},{key:"exception",value:function exception(e,t){throw new Error("".concat(this.constructor.name,": ").concat(e," ").concat(t))}},{key:"toObject",value:function toObject(){return Object.fromEntries(Object.entries(this).filter(function(e){var t=_sliced_to_array(e,1),o=t[0];return"toObject"!==o}))}},{key:"getKeys",value:function getKeys(){return Object.keys(this).filter(function(e){return"toObject"!==e})}}],[{key:"addDefaultData",value:function addDefaultData(e){v.isObject(e)||this.prototype.exception("default data",k),e=A.clone(e);var t=this,o=t.name;v.isObject(ne.data[o])||(ne.data[o]={}),ne.data[o]=g.merge(ne.data[o],e)}},{key:"getDefaultData",value:function getDefaultData(){var e=this,t=e.name;return A.clone(ne.data[t])}},{key:"addValidateFunction",value:function addValidateFunction(e,t){v.isString(e)||this.prototype.exception("validate key",k),"function"!=typeof t&&this.prototype.exception("validate function",k);var o="validate".concat(m.capitalize(e));g.assign(this.prototype,_define_property({},o,t))}}]);return ne}();u(b,"data",{});var D=b;o.Dtos={Base:D};var P={score:"score",endlessScore:"endlessScore",settings:"settings",gameData:"gameData",remoteConfig:"remoteConfig",isFirstLogin:"isFirstLogin",dailyRewarded:"dailyRewarded",notificationData:"notificationData"},C={ASID:null,playerId:"0000",name:"Guest",photo:"",locale:"en_US",connectedPlayers:{},data:{dailyRewarded:{logDays:[],lastRewarded:0},score:0,endlessScore:0,settings:{sound:!0,music:!0,vibrate:!0,language:"en"},gameData:{coins:0,level:1},isFirstLogin:!0,notificationData:{currentId:0,lastSent:0}}},T=o.Utils,O=T.Valid,R=C.playerId,M=C.name,G=C.photo,V=C.locale,H="is invalid";var W=/*#__PURE__*/function(e){_inherits(ke,e);function ke(){_class_call_check(this,ke);return _call_super(this,ke,arguments)}_create_class(ke,[{key:"setupData",value:function setupData(e){this.lazySetupData(e)}},{key:"validateStructure",value:function validateStructure(e){this.lazyValidateStructure(e)}},{key:"validateData",value:function validateData(e){this.lazyValidateData(e)}},{key:"validateId",value:function validateId(e){O.isString(e)&&e||this.exception("_id",H)}},{key:"validatePlayerId",value:function validatePlayerId(e){O.isString(e)&&e||this.exception("playerId",H)}},{key:"validateName",value:function validateName(e){O.isString(e)&&e||this.exception("name",H)}},{key:"validatePhoto",value:function validatePhoto(e){O.isString(e)||this.exception("photo",H)}},{key:"validateLocale",value:function validateLocale(e){O.isString(e)&&e||this.exception("locale",H)}},{key:"toObject",value:function toObject(){return _get(_get_prototype_of(ke.prototype),"toObject",this).call(this)}}]);return ke}(D);W.addDefaultData({playerId:R,name:M,photo:G,locale:V});var z=new W({playerId:"10",name:"Your Friend"}).toObject();var Y=/*#__PURE__*/function(e){_inherits(X,e);function X(e){_class_call_check(this,X);var t;t=_call_super(this,X,[e]);u(t,"code");t.code="CREATE_MATCH_FAILED";return t}return X}(_wrap_native_super(Error));var Q=/*#__PURE__*/function(e){_inherits(S,e);function S(e){_class_call_check(this,S);var t;t=_call_super(this,S,[e]),t.name="PlayerIdNotValid",t.message=null!=e?e:"Player id is not valid";return t}return S}(Y);var $=o.Dtos,ee=o.Utils,et=o.Events,ea=ee.Array,er=ee.Object,es=(ee.Json,ee.Valid);var sa=function sa(e){var t=this;_class_call_check(this,sa);var o=this;u(this,"game");u(this,"initContext",function(){var e={contextId:GameSDK.context.getID(),contextType:GameSDK.context.getType(),entryPointData:GameSDK.getEntryPointData()},o=new $.Context.Info(e),c=o.toObject(),l=c.contextId,d=c.contextType,h=c.entryPointData;t.game.context.receiveContext(l,d,h)});u(this,"initPlayer",/*#__PURE__*/_async_to_generator(function(){var e,t,c,l,d,h;return _ts_generator(this,function(_){switch(_.label){case 0:e=o.game,t=e.player,c=o.getPlayerInfo(),l=ea.unique(er.vals(P));return[4,GameSDK.player.getDataAsync(l)];case 1:d=_.sent(),h=new $.Player.Data(d).toObject();t.receiveData(c,h),o.game.event.emit(et.PLAYER_INFO_LOADED);return[2]}})}));u(this,"getPlayerInfo",function(){try{var e=GameSDK.player.getID();var t=GameSDK.player.getName();var o=GameSDK.player.getPhoto(),c=GameSDK.getLocale();if(!es.isString(e))throw new Q;return es.isString(t)||(t="You"),new $.Player.Info({playerId:e,name:t,photo:o,locale:c}).toObject()}catch(e){return z}});this.game=e};var eo=/*#__PURE__*/function(e){_inherits(rt,e);function rt(e,t){_class_call_check(this,rt);var o;o=_call_super(this,rt,[e]);u(o,"payload");o.name="BadRequest",o.message=null!=e?e:"This request is bad",o.payload=t;return o}return rt}(_wrap_native_super(Error));var ec=/*#__PURE__*/function(e){_inherits(ot,e);function ot(e,t){_class_call_check(this,ot);var o;o=_call_super(this,ot,[e]);u(o,"payload");o.name="RequestTimeout",o.message=null!=e?e:"This request is timeout",o.payload=t;return o}return ot}(_wrap_native_super(Error));var eu=o.Utils,el=o.Configs,ed=el.AppId,eh=el.Network,ia=function(e){if(!e.ok)throw new eo(void 0,{response:e})},Wt=function(){var e=window.game.auth.getToken();return{token:e,timeout:eh.Timeout,headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}},zt=function(e,t,c,l){return /*#__PURE__*/_async_to_generator(function(){var d,h,_,y,f;return _ts_generator(this,function(p){switch(p.label){case 0:p.trys.push([0,3,,4]);if(!ed)throw new eo("AppId is not defined");d="".concat(e,"/apps/").concat(ed,"/").concat(t),h=new AbortController;c.signal=h.signal;_=setTimeout(function(){h.abort()},c.timeout);o.Utils.Valid.isObject(l)&&(c.body=JSON.stringify(l));return[4,fetch(d,c)];case 1:y=p.sent();clearTimeout(_),ia(y);return[4,y.json()];case 2:return[2,p.sent()||{}];case 3:f=p.sent();if(_instanceof(f,eo))return[2,null];throw _instanceof(f,Object)&&"name"in f&&"AbortError"===f.name?new ec:f;case 4:return[2]}})})},e_=/*#__PURE__*/function(){var e=_async_to_generator(function(e,t){var o;return _ts_generator(this,function(c){switch(c.label){case 0:c.trys.push([0,1,,7]);return[2,e()];case 1:o=c.sent();if(!(_instanceof(o,ec)&&t>0))return[3,6];c.label=2;case 2:c.trys.push([2,5,,6]);return[4,eu.Time.sleepAsync(600)];case 3:c.sent();return[4,e_(e,t-1)];case 4:return[2,c.sent()];case 5:c.sent();return[2,{}];case 6:return[2,_instanceof(o,ec)?{}:{}];case 7:return[2]}})});return function lt(t,o){return e.apply(this,arguments)}}(),ey=/*#__PURE__*/function(){var e=_async_to_generator(function(e,t,o){var c,l,d;var h=arguments;return _ts_generator(this,function(_){switch(_.label){case 0:c=h.length>3&&void 0!==h[3]?h[3]:eh.Retries;_.label=1;case 1:_.trys.push([1,3,,4]);l=_object_spread_props(_object_spread({},Wt(),t),{method:"GET"}),d=zt(o,e,l);return[4,e_(d,c)];case 2:return[2,_.sent()];case 3:_.sent();return[2,{}];case 4:return[2]}})});return function fe(t,o,c){return e.apply(this,arguments)}}(),ef=/*#__PURE__*/function(){var e=_async_to_generator(function(e,t,o,c){var l,d,h;var _=arguments;return _ts_generator(this,function(y){switch(y.label){case 0:l=_.length>4&&void 0!==_[4]?_[4]:eh.Retries;y.label=1;case 1:y.trys.push([1,3,,4]);d=_object_spread_props(_object_spread({},Wt(),o),{method:"POST"}),h=zt(c,e,d,t);return[4,e_(h,l)];case 2:return[2,y.sent()];case 3:y.sent();return[2,{}];case 4:return[2]}})});return function F(t,o,c,l){return e.apply(this,arguments)}}(),ep=o.Configs,ev=ep.Notification,eg=ev.ApiUrl,em=o.Utils,eA=em.Object,ew=/*#__PURE__*/function(){var e=_async_to_generator(function(e){var t;return _ts_generator(this,function(o){switch(o.label){case 0:if(!eA.hasOwn(e,"playerId"))throw new Error("Missing playerId");t=e.playerId;return[4,ef("players/".concat(t),e,{},eg,10)];case 1:o.sent();return[2]}})});return function ca(t){return e.apply(this,arguments)}}();var eI=function(e){return e.IDLE="idle",e.LOADING="loading",e.FILLED="filled",e.SHOWING="showing",e}(eI||{}),ek=function(e){return e.BANNER="banner",e.INTERSTITIAL="interstitial",e.REWARDED_VIDEO="rewarded_video",e.REWARDED_INTERSTITIAL="rewarded_interstitial",e}(ek||{});var eb=/*#__PURE__*/function(e){_inherits(Ve,e);function Ve(e,t){_class_call_check(this,Ve);var o;o=_call_super(this,Ve,[t]);u(o,"code");o.code=e,o.message=t;return o}return Ve}(_wrap_native_super(Error));var eS=/*#__PURE__*/function(){function la(e,t){_class_call_check(this,la);u(this,"type");u(this,"placementId");u(this,"_status");this.type=e,this._status=eI.IDLE,this.placementId=t}_create_class(la,[{key:"setStatus",value:function setStatus(e){this._status!==e&&(this._status=e)}},{key:"status",get:function get(){return this._status}},{key:"exception",value:function exception(e){throw new eb("AD_INSTANCE_ERROR",e)}}]);return la}();var eD=/*#__PURE__*/function(e){_inherits(qt,e);function qt(){_class_call_check(this,qt);return _call_super(this,qt,arguments)}_create_class(qt,[{key:"loadAsync",value:function loadAsync(){this.exception("This method is not implemented")}},{key:"showAsync",value:function showAsync(){this.exception("This method is not implemented")}},{key:"hideAsync",value:function hideAsync(){this.exception("Unsupported method")}}]);return qt}(eS);o.Plugins.Ads={Types:ek,Status:eI,AdError:eb,AdInstance:eD};var eP=o.Utils,eE=eP.Array,ex=eP.Object;var eC=/*#__PURE__*/function(e){_inherits(ha,e);function ha(){_class_call_check(this,ha);var e;e=_call_super(this,ha,arguments);u(e,"enabled");u(e,"config");u(e,"lastCallAdShownTime");u(e,"isAdFullSizeShowed");u(e,"ads",{});u(e,"fallbackAds",{});u(e,"safeAreaBottom");return e}_create_class(ha,[{key:"init",value:function init(){var e;this.lastCallAdShownTime=(e={},_define_property(e,ek.BANNER,0),_define_property(e,ek.INTERSTITIAL,0),_define_property(e,ek.REWARDED_VIDEO,0),_define_property(e,ek.REWARDED_INTERSTITIAL,0),e),this.isAdFullSizeShowed=!1,this.calculateSafeAreaBottom()}},{key:"calculateSafeAreaBottom",value:function calculateSafeAreaBottom(){try{var e=getComputedStyle(document.documentElement).getPropertyValue("--sab");this.safeAreaBottom=Number.parseInt(e,10),Number.isNaN(this.safeAreaBottom)&&(this.safeAreaBottom=0)}catch(e){this.safeAreaBottom=0}}},{key:"configure",value:function configure(e){this.config=e,this.enabled=this.config.Enabled}},{key:"checkEnabled",value:function checkEnabled(){if(!this.enabled)throw new eb("ADS_NOT_ENABLED","Ads is't enabled")}},{key:"isAdFullSizeShowing",value:function isAdFullSizeShowing(){return this.isAdFullSizeShowed}},{key:"setAdInstance",value:function setAdInstance(e,t,o){this.ads[t]||(this.ads[t]={type:e,placementId:t,interval:null,instance:new o(e,t)})}},{key:"setFallbackAdInstance",value:function setFallbackAdInstance(e,t,o){this.fallbackAds[t]||(this.fallbackAds[t]={type:e,placementId:t,interval:null,instance:new o(e,t)})}},{key:"loadAdAsync",value:function loadAdAsync(e,t,o){var c=arguments.length>2&&void 0!==o&&o;var l=this;return _async_to_generator(function(){return _ts_generator(this,function(o){switch(o.label){case 0:l.checkEnabled();return[4,l.getAd(e,t,c).instance.loadAsync()];case 1:o.sent();return[2]}})})()}},{key:"showAdAsync",value:function showAdAsync(e,t,c){var l=arguments.length>2&&void 0!==c&&c;var d=this;return _async_to_generator(function(){var c,h,_;return _ts_generator(this,function(y){switch(y.label){case 0:d.checkEnabled();c=d.game,h=c.event,_=d.getAd(e,t,l);d.lastCallAdShownTime[e]=window.performance.now()/1e3;y.label=1;case 1:y.trys.push([1,,3,4]);h.emit(o.Events.AD_SHOWING,{placementId:t}),d.isAdFullSizeShowed=!0;return[4,_.instance.showAsync()];case 2:y.sent();return[3,4];case 3:h.emit(o.Events.AD_CLOSED,{placementId:t}),d.isAdFullSizeShowed=!1;return[7];case 4:return[2]}})})()}},{key:"getAdStatus",value:function getAdStatus(e,t,o){var c=arguments.length>2&&void 0!==o&&o;return this.checkEnabled(),this.getAd(e,t,c).instance.status}},{key:"getAd",value:function getAd(e,t,o){var c=arguments.length>2&&void 0!==o&&o;var l=null;if(t?l=this.getAdByPlacementId(t,c):l=this.getPriorityAdByType(e,c),!l)throw new eb("AD_INSTANCE_NOT_INITIATED","The instance ads not yet initiated");return l}},{key:"getAdsByType",value:function getAdsByType(e,t){var o=t?this.fallbackAds:this.ads;return ex.vals(o).filter(function(t){return t.type===e})}},{key:"getAdByPlacementId",value:function getAdByPlacementId(e,t){var o=(t?this.fallbackAds:this.ads)[e];return o||null}},{key:"getPriorityAdByType",value:function getPriorityAdByType(e,t){var o=this.getAdsByType(e,t);if(!o.length)return null;var c=eE.search(o,function(t){return t.type===e});return c||null}},{key:"canbeShowInterstitialAd",value:function canbeShowInterstitialAd(e){return this.canbeShowInterstitialAdByTime(e)}},{key:"canbeShowInterstitialAdByTime",value:function canbeShowInterstitialAdByTime(e){try{var t=window.performance.now()/1e3;var o;if(e)o=this.getCommonAdConfig(e);else{var c=this.getPriorityAdByType(ek.INTERSTITIAL,!1);if(!c)return!1;o=this.getCommonAdConfig(c.placementId)}var l=o.SecondsBetweenAds,d=o.SecondsFirstTime,h=t-this.lastCallAdShownTime[ek.INTERSTITIAL],_=h>l,y=h>d;return this.lastCallAdShownTime[ek.INTERSTITIAL]>0?_:y}catch(e){return!1}}},{key:"canbeShowBannerAd",value:function canbeShowBannerAd(e){try{var t=this.getBannerConfig(e),o=t.Platform;if("ALL"===o)return!0;var c=GameSDK.getPlatform();return!!c&&c===o}catch(e){return!1}}},{key:"showBannerAdAsync",value:function showBannerAdAsync(e){var t=this;return _async_to_generator(function(){var c,l,d,h,_;return _ts_generator(this,function(y){switch(y.label){case 0:t.checkEnabled();c=t.getAd(ek.BANNER,e,!1);if(!t.canbeShowBannerAd(c.placementId))throw new Error("Banner ad can not be shown");t.cleanBannerReloadTimer(c.placementId);return[4,c.instance.showAsync()];case 1:y.sent();l=t.game,d=l.event;if(d.emit(o.Events.AD_SHOWING,{placementId:e}),"MsGames"===GameSDK.getSDKName())return[2];h=t.getBannerConfig(c.placementId),_=h.SecondsReload;_<=0||(c.interval=setTimeout(function(){t.showBannerAdAsync(c.placementId)},1e3*_));return[2]}})})()}},{key:"hideBannerAdAsync",value:function hideBannerAdAsync(e){var t=this;return _async_to_generator(function(){var c,l,d;return _ts_generator(this,function(h){switch(h.label){case 0:t.checkEnabled();c=t.getAd(ek.BANNER,e,!1);t.cleanBannerReloadTimer(c.placementId);return[4,c.instance.hideAsync()];case 1:h.sent();l=t.game,d=l.event;d.emit(o.Events.AD_CLOSED,{placementId:e});return[2]}})})()}},{key:"cleanBannerReloadTimer",value:function cleanBannerReloadTimer(e){try{var t=this.getAd(ek.BANNER,e,!1),o=t.interval;if(!o)return;clearInterval(o)}catch(e){}}},{key:"getCommonAdConfig",value:function getCommonAdConfig(e){var t=_to_consumable_array(this.config.InterstitialAdOptions).concat(_to_consumable_array(this.config.RewardedVideoAdOptions)),o=eE.search(t,function(t){return t.PlacementId===e});if(!o)throw new Error("Ad config with placementId ".concat(e," not found"));return o}},{key:"getBannerConfig",value:function getBannerConfig(e){var t=eE.search(this.config.BannerDisplayAdOptions,function(t){return t.PlacementId===e});if(!t)throw new Error("Banner config with placementId ".concat(e," not found"));return t}},{key:"getBannerHeight",value:function getBannerHeight(e,t,o){var c=!(arguments.length>2)||void 0===o||o;this.checkEnabled();var l=this.getBannerConfig(e),d=GameSDK.getBannerHeight(l);return c?(this.safeAreaBottom<=0&&this.calculateSafeAreaBottom(),(d+this.safeAreaBottom)*t):d*t}},{key:"getSafeAreaBottom",value:function getSafeAreaBottom(e){return this.safeAreaBottom<=0&&this.calculateSafeAreaBottom(),this.safeAreaBottom*e}}]);return ha}(c.Plugins.BasePlugin);var eN={ENGINE_READY:"engine_ready",LOAD_START:"load_start",LOAD_COMPLETE:"load_complete",APP_READY:"app_ready",PAGE_VIEW:"page_view",SCREEN_OPEN:"screen_open",BUTTON_CLICK:"button_click",TUTORIAL_BEGIN:"tutorial_begin",TUTORIAL_STEP:"tutorial_step",TUTORIAL_COMPLETE:"tutorial_complete",MATCH_START:"match_start",MATCH_RESCUE:"match_rescue",MATCH_END:"match_end",LEVEL_START:"level_start",LEVEL_RESCUE:"level_rescue",LEVEL_END:"level_end",SHARE:"share",MESSAGE:"message",INVITE:"invite",SHORTCUT_CREATE:"shortcut_create",SHORTCUT_CREATE_POPUP:"shortcut_create_popup",BOT_SUBSCRIBE:"bot_subscribe",BOT_SUBSCRIBE_POPUP:"bot_subscribe_popup",AD_LOAD:"ad_load",AD_LOAD_FAILED:"ad_load_failed",AD_SHOW:"ad_show",AD_SHOW_FAILED:"ad_show_failed",AD_SHOWING:"ad_showing",AD_REWARD:"ad_reward",NEW_USER:"new_user",RETURNING_USER:"returning_user",JOIN_GROUP:"join_group",TOURNAMENT_START:"tournament_start",TOURNAMENT_SHARE:"tournament_share",TOURNAMENT_CREATE:"tournament_create",TOURNAMENT_POST_SCORE:"tournament_post_score",GET_FREE_ITEM:"get_free_item",USE_ITEM:"use_item",EARN_ITEM:"earn_item"},eT=o.Utils,eL=eT.String,eO=eT.Valid;var eR=/*#__PURE__*/function(){function ya(e,t,o){_class_call_check(this,ya);u(this,"game");u(this,"name");u(this,"color");u(this,"options");u(this,"selfLog");u(this,"currentPath");this.game=e,this.name=t,this.options=o,this.color=o.color||"#FFF",this.selfLog=o.log,this.currentPath="/"}_create_class(ya,[{key:"event",value:function event(e,t){this.logInfo("event",{name:e,payload:t});var o=this.formatEventName(e);this.processEvent(o,t)}},{key:"logInfo",value:function logInfo(e,t){this.selfLog}},{key:"pageview",value:function pageview(e){var t=this.getPageTitle(e);t=this.addGameModeToPageTitle(t),document.title=t,this.event(eN.PAGE_VIEW,{path_path:e,page_title:t})}},{key:"levelStart",value:function levelStart(e,t,o){this.event(eN.LEVEL_START,{level:e,score:t,level_name:this.getLevelName(e),game_mode:o?eL.toUpperCamelCase(o):void 0})}},{key:"levelFail",value:function levelFail(e,t,o){this.event(eN.LEVEL_END,{level:e,score:t,success:!1,level_name:this.getLevelName(e),game_mode:o?eL.toUpperCamelCase(o):void 0})}},{key:"levelRescue",value:function levelRescue(e,t,o){this.event(eN.LEVEL_RESCUE,{level:e,score:t,level_name:this.getLevelName(e),game_mode:o?eL.toUpperCamelCase(o):void 0})}},{key:"levelComplete",value:function levelComplete(e,t,o){this.event(eN.LEVEL_END,{level:e,score:t,success:!0,level_name:this.getLevelName(e),game_mode:o?eL.toUpperCamelCase(o):void 0})}},{key:"loadAdEvent",value:function loadAdEvent(e,t,o){this.event(eN.AD_LOAD,{ad_type:e,screen_name:t,ad_service:o})}},{key:"showAdEvent",value:function showAdEvent(e,t,o){this.event(eN.AD_SHOW,{ad_type:e,screen_name:t,ad_service:o})}},{key:"loadInterstitialAd",value:function loadInterstitialAd(e,t){this.loadAdEvent("interstitial",e,t)}},{key:"showInterstitialAd",value:function showInterstitialAd(e,t){this.showAdEvent("interstitial",e,t)}},{key:"loadRewardedVideoAd",value:function loadRewardedVideoAd(e,t){this.loadAdEvent("rewarded_video",e,t)}},{key:"showRewardedVideoAd",value:function showRewardedVideoAd(e,t){this.showAdEvent("rewarded_video",e,t)}},{key:"receiveVideoReward",value:function receiveVideoReward(e,t){this.event(eN.AD_REWARD,{screen_name:e,ad_service:t})}},{key:"loadRewardedInterstitialAd",value:function loadRewardedInterstitialAd(e,t){this.loadAdEvent("rewarded_interstitial",e,t)}},{key:"showRewardedInterstitialAd",value:function showRewardedInterstitialAd(e,t){this.showAdEvent("rewarded_interstitial",e,t)}},{key:"receiveInterstitialReward",value:function receiveInterstitialReward(e,t){this.event(eN.AD_REWARD,{screen_name:e,ad_service:t})}},{key:"loadAdFail",value:function loadAdFail(e,t,o){this.event(eN.AD_LOAD_FAILED,{ad_type:e,screen_name:t,ad_service:o})}},{key:"showAdFail",value:function showAdFail(e,t,o){this.event(eN.AD_SHOW_FAILED,{ad_type:e,screen_name:t,ad_service:o})}},{key:"showingAd",value:function showingAd(e,t,o){this.event(eN.AD_SHOWING,{ad_type:e,screen_name:t,ad_service:o})}},{key:"formatEventName",value:function formatEventName(e){return e.toLowerCase().replace(/:/g,"_")}},{key:"getLevelName",value:function getLevelName(e){return"Level ".concat(eL.padStart(e.toString(),5,"0"))}},{key:"getPageTitle",value:function getPageTitle(e){var t=e.split("/").pop();if(!eO.isString(t))return e;var o=t.replace(/([-_\s.])/g," $1");return eL.toUpperCamelCase(o)}},{key:"addGameModeToPageTitle",value:function addGameModeToPageTitle(e){var t=this.game,o=t.match,c=o.getMatchState();var l=c.mode;return l||(l="Normal"),"".concat(eL.toUpperCamelCase(l),"::").concat(e)}}]);return ya}();o.Plugins.Analytics={Events:eN,BaseAnalytics:eR};var eM=/*#__PURE__*/function(e){_inherits(pa,e);function pa(){_class_call_check(this,pa);var e;e=_call_super(this,pa,arguments);u(e,"analytics",[]);u(e,"placement","unknown");u(e,"pageview",function(t){if(!e.isActive())return;e.placement=t;var o=e.getPageByKey(t);var c=true,l=false,d=void 0;try{for(var h=e.analytics[Symbol.iterator](),_;!(c=(_=h.next()).done);c=true){var y=_.value;y.pageview(o)}}catch(e){l=true;d=e}finally{try{if(!c&&null!=h.return)h.return()}finally{if(l)throw d}}});return e}_create_class(pa,[{key:"add",value:function add(e){this.analytics.some(function(t){return t.name===e.name})||this.analytics.push(e)}},{key:"isActive",value:function isActive(){return this.analytics.length>=1}},{key:"event",value:function event(e,t){var o=true,c=false,l=void 0;if(this.isActive())try{for(var d=this.analytics[Symbol.iterator](),h;!(o=(h=d.next()).done);o=true){var _=h.value;_.event(e,t)}}catch(e){c=true;l=e}finally{try{if(!o&&null!=d.return)d.return()}finally{if(c)throw l}}}},{key:"levelStart",value:function levelStart(e,t,o){var c=true,l=false,d=void 0;if(this.isActive())try{for(var h=this.analytics[Symbol.iterator](),_;!(c=(_=h.next()).done);c=true){var y=_.value;y.levelStart(e,t,o)}}catch(e){l=true;d=e}finally{try{if(!c&&null!=h.return)h.return()}finally{if(l)throw d}}}},{key:"levelRescue",value:function levelRescue(e,t,o){var c=true,l=false,d=void 0;if(this.isActive())try{for(var h=this.analytics[Symbol.iterator](),_;!(c=(_=h.next()).done);c=true){var y=_.value;y.levelRescue(e,t,o)}}catch(e){l=true;d=e}finally{try{if(!c&&null!=h.return)h.return()}finally{if(l)throw d}}}},{key:"levelFail",value:function levelFail(e,t,o){var c=true,l=false,d=void 0;if(this.isActive())try{for(var h=this.analytics[Symbol.iterator](),_;!(c=(_=h.next()).done);c=true){var y=_.value;y.levelFail(e,t,o)}}catch(e){l=true;d=e}finally{try{if(!c&&null!=h.return)h.return()}finally{if(l)throw d}}}},{key:"levelComplete",value:function levelComplete(e,t,o){var c=true,l=false,d=void 0;if(this.isActive())try{for(var h=this.analytics[Symbol.iterator](),_;!(c=(_=h.next()).done);c=true){var y=_.value;y.levelComplete(e,t,o)}}catch(e){l=true;d=e}finally{try{if(!c&&null!=h.return)h.return()}finally{if(l)throw d}}}},{key:"loadInterstitialAd",value:function loadInterstitialAd(e){var t=true,o=false,c=void 0;if(this.isActive())try{for(var l=this.analytics[Symbol.iterator](),d;!(t=(d=l.next()).done);t=true){var h=d.value;h.loadInterstitialAd(this.placement,e)}}catch(e){o=true;c=e}finally{try{if(!t&&null!=l.return)l.return()}finally{if(o)throw c}}}},{key:"showInterstitialAd",value:function showInterstitialAd(e){var t=true,o=false,c=void 0;if(this.isActive())try{for(var l=this.analytics[Symbol.iterator](),d;!(t=(d=l.next()).done);t=true){var h=d.value;h.showInterstitialAd(this.placement,e)}}catch(e){o=true;c=e}finally{try{if(!t&&null!=l.return)l.return()}finally{if(o)throw c}}}},{key:"loadRewardedVideoAd",value:function loadRewardedVideoAd(e){var t=true,o=false,c=void 0;if(this.isActive())try{for(var l=this.analytics[Symbol.iterator](),d;!(t=(d=l.next()).done);t=true){var h=d.value;h.loadRewardedVideoAd(this.placement,e)}}catch(e){o=true;c=e}finally{try{if(!t&&null!=l.return)l.return()}finally{if(o)throw c}}}},{key:"showRewardedVideoAd",value:function showRewardedVideoAd(e){var t=true,o=false,c=void 0;if(this.isActive())try{for(var l=this.analytics[Symbol.iterator](),d;!(t=(d=l.next()).done);t=true){var h=d.value;h.showRewardedVideoAd(this.placement,e)}}catch(e){o=true;c=e}finally{try{if(!t&&null!=l.return)l.return()}finally{if(o)throw c}}}},{key:"receiveVideoReward",value:function receiveVideoReward(e){var t=true,o=false,c=void 0;if(this.isActive())try{for(var l=this.analytics[Symbol.iterator](),d;!(t=(d=l.next()).done);t=true){var h=d.value;h.receiveVideoReward(this.placement,e)}}catch(e){o=true;c=e}finally{try{if(!t&&null!=l.return)l.return()}finally{if(o)throw c}}}},{key:"loadRewardedInterstitialAd",value:function loadRewardedInterstitialAd(e){var t=true,o=false,c=void 0;if(this.isActive())try{for(var l=this.analytics[Symbol.iterator](),d;!(t=(d=l.next()).done);t=true){var h=d.value;h.loadRewardedInterstitialAd(this.placement,e)}}catch(e){o=true;c=e}finally{try{if(!t&&null!=l.return)l.return()}finally{if(o)throw c}}}},{key:"showRewardedInterstitialAd",value:function showRewardedInterstitialAd(e){var t=true,o=false,c=void 0;if(this.isActive())try{for(var l=this.analytics[Symbol.iterator](),d;!(t=(d=l.next()).done);t=true){var h=d.value;h.showRewardedInterstitialAd(this.placement,e)}}catch(e){o=true;c=e}finally{try{if(!t&&null!=l.return)l.return()}finally{if(o)throw c}}}},{key:"receiveInterstitialReward",value:function receiveInterstitialReward(e){var t=true,o=false,c=void 0;if(this.isActive())try{for(var l=this.analytics[Symbol.iterator](),d;!(t=(d=l.next()).done);t=true){var h=d.value;h.receiveInterstitialReward(this.placement,e)}}catch(e){o=true;c=e}finally{try{if(!t&&null!=l.return)l.return()}finally{if(o)throw c}}}},{key:"loadAdFail",value:function loadAdFail(e,t){var o=true,c=false,l=void 0;if(this.isActive())try{for(var d=this.analytics[Symbol.iterator](),h;!(o=(h=d.next()).done);o=true){var _=h.value;_.loadAdFail(e,this.placement,t)}}catch(e){c=true;l=e}finally{try{if(!o&&null!=d.return)d.return()}finally{if(c)throw l}}}},{key:"showAdFail",value:function showAdFail(e,t){var o=true,c=false,l=void 0;if(this.isActive())try{for(var d=this.analytics[Symbol.iterator](),h;!(o=(h=d.next()).done);o=true){var _=h.value;_.showAdFail(e,this.placement,t)}}catch(e){c=true;l=e}finally{try{if(!o&&null!=d.return)d.return()}finally{if(c)throw l}}}},{key:"showingAd",value:function showingAd(e,t){var o=true,c=false,l=void 0;if(this.isActive())try{for(var d=this.analytics[Symbol.iterator](),h;!(o=(h=d.next()).done);o=true){var _=h.value;_.showingAd(e,this.placement,t)}}catch(e){c=true;l=e}finally{try{if(!o&&null!=d.return)d.return()}finally{if(c)throw l}}}},{key:"getPageByKey",value:function getPageByKey(e){var t=e;if(t.indexOf("_")>-1){var o=t.replace(/_/g,"-");return o.toLowerCase()}var c=t.length-1,l="";for(;c>0;){l=t.charAt(c);var d=Number.isNaN(Number.parseInt(l,10)),h=l===l.toUpperCase();d&&h&&(t="".concat(t.slice(0,c),"-").concat(t.slice(c))),c--}return t.toLowerCase()}}]);return pa}(c.Plugins.BasePlugin);var eF=/*#__PURE__*/function(){function fa(e){_class_call_check(this,fa);u(this,"key");this.key=e}_create_class(fa,[{key:"getKey",value:function getKey(){return this.key}}]);return fa}();var eG=/*#__PURE__*/function(){function ga(e){_class_call_check(this,ga);u(this,"id");u(this,"isMuteAll");u(this,"masterVolume");u(this,"audioClips");this.id=e,this.masterVolume=1,this.isMuteAll=!1,this.audioClips={}}_create_class(ga,[{key:"getId",value:function getId(){return this.id}},{key:"getAudioClip",value:function getAudioClip(e){return this.audioClips[e]?this.audioClips[e]:null}},{key:"setAudioClip",value:function setAudioClip(e,t){this.audioClips[e]=_object_spread({},this.audioClips[e],t)}},{key:"play",value:function play(e,t){var o=this;return _async_to_generator(function(){var c,l;return _ts_generator(this,function(d){switch(d.label){case 0:c=o.getAudioClip(e);if(!c)return[3,1];l=c.audioPlayer;o.playWithRealConfig(l,t);return[3,3];case 1:return[4,o.loadAndPlay(e,t)];case 2:d.sent();d.label=3;case 3:return[2]}})})()}},{key:"loadAndPlay",value:function loadAndPlay(e,t){var o=this;return _async_to_generator(function(){var c,l,d,h;return _ts_generator(this,function(_){switch(_.label){case 0:_.trys.push([0,2,,3]);return[4,o.onLoadAudio(e,t)];case 1:c=_.sent(),l=t||{},d=l.volume,h=void 0===d?1:d;o.setAudioClip(e,{volume:h,audioPlayer:c}),o.playWithRealConfig(c,t);return[3,3];case 2:_.sent();return[3,3];case 3:return[2]}})})()}},{key:"playWithRealConfig",value:function playWithRealConfig(e,t){if(t){var o=t.volume,c=void 0===o?1:o;t.volume=this.masterVolume*c}e.play(t)}},{key:"pause",value:function pause(e){var t=this.getAudioClip(e);if(!t)return!1;var o=t.audioPlayer;return o.pause(),!0}},{key:"resume",value:function resume(e){var t=this.getAudioClip(e);if(!t)return!1;var o=t.audioPlayer;return o.resume(),!0}},{key:"stop",value:function stop(e){var t=this.getAudioClip(e);if(!t)return!1;var o=t.audioPlayer;return o.stop(),!0}},{key:"stopAll",value:function stopAll(){this.callAudioPlayers("stop")}},{key:"muteAll",value:function muteAll(){this.isMuteAll||(this.isMuteAll=!0,this.callAudioPlayers("mute"))}},{key:"unmuteAll",value:function unmuteAll(){this.isMuteAll&&(this.isMuteAll=!1,this.callAudioPlayers("unmute"))}},{key:"setVolume",value:function setVolume(e){this.masterVolume=e,this.callAudioPlayers("setVolume")}},{key:"getVolume",value:function getVolume(){return this.masterVolume}},{key:"queueAudioPlayer",value:function queueAudioPlayer(e,t){try{var o=e.audioPlayer,c=e.volume,l=void 0===c?1:c;switch(t){case"play":o.play();break;case"pause":o.pause();break;case"resume":o.resume();break;case"stop":o.stop();break;case"mute":o.setVolume(0);break;case"unmute":case"setVolume":o.setVolume(this.masterVolume*l);break;default:throw new Error("Unsupported function: ".concat(t))}}catch(e){}}},{key:"callAudioPlayers",value:function callAudioPlayers(e){var t=o.Utils,c=t.Object,l=c.vals(this.audioClips);var d=true,h=false,_=void 0;try{for(var y=l[Symbol.iterator](),f;!(d=(f=y.next()).done);d=true){var p=f.value;this.queueAudioPlayer(p,e)}}catch(e){h=true;_=e}finally{try{if(!d&&null!=y.return)y.return()}finally{if(h)throw _}}}}]);return ga}();o.Plugins.Audio={BaseAudioPlayer:eF,BaseChannelManager:eG};var ej=/*#__PURE__*/function(e){_inherits(ma,e);function ma(){_class_call_check(this,ma);var e;e=_call_super(this,ma,arguments);u(e,"firstChannelId");u(e,"channels",{});return e}_create_class(ma,[{key:"addChannel",value:function addChannel(e){var t=e.getId();this.channels[t]=e,this.firstChannelId||(this.firstChannelId=t)}},{key:"getChannel",value:function getChannel(e){if(void 0===e)return this.channels[this.firstChannelId];var t=this.channels[e];if(!t)throw new Error("Channel ".concat(e," not found"));return t}},{key:"play",value:function play(e,t,o){var c=this;return _async_to_generator(function(){return _ts_generator(this,function(l){switch(l.label){case 0:l.trys.push([0,2,,3]);return[4,c.getChannel(o).play(e,t)];case 1:l.sent();return[3,3];case 2:l.sent();return[3,3];case 3:return[2]}})})()}},{key:"pause",value:function pause(e,t){try{this.getChannel(t).pause(e)}catch(e){}}},{key:"resume",value:function resume(e,t){try{this.getChannel(t).resume(e)}catch(e){}}},{key:"stop",value:function stop(e,t){try{this.getChannel(t).stop(e)}catch(e){}}},{key:"stopAll",value:function stopAll(e){try{this.getChannel(e).stopAll()}catch(e){}}},{key:"mute",value:function mute(e){try{this.getChannel(e).muteAll()}catch(e){}}},{key:"unmute",value:function unmute(e){try{this.getChannel(e).unmuteAll()}catch(e){}}},{key:"setVolume",value:function setVolume(e,t){try{this.getChannel(t).setVolume(e)}catch(e){}}},{key:"getVolume",value:function getVolume(e){try{return this.getChannel(e).getVolume()}catch(e){return -1}}}]);return ma}(c.Plugins.BasePlugin);var eV={token:"",isRequesting:!1};var eB=/*#__PURE__*/function(e){_inherits(Aa,e);function Aa(){_class_call_check(this,Aa);return _call_super(this,Aa,arguments)}_create_class(Aa,[{key:"init",value:function init(){var e=this.game,t=e.storage;t.addStorage("auth",eV)}},{key:"requestToken",value:function requestToken(){var e=this;return _async_to_generator(function(){var t,c,l,d;return _ts_generator(this,function(h){switch(h.label){case 0:t=e.game,c=t.storage;h.label=1;case 1:h.trys.push([1,3,4,5]);if(c.getStorageData("auth","isRequesting")||""!==c.getStorageData("auth","token"))return[2];c.setStorageData("auth","isRequesting",!0);return[4,GameSDK.player.getSignedPlayerInfoAsync()];case 2:l=h.sent().getSignature();c.setStorageData("auth","token",l);return[3,5];case 3:d=h.sent();if(o.Utils.Object.hasOwn(d,"code")&&"PENDING_REQUEST"===d.code)return[2];c.setStorageData("auth","token","");return[3,5];case 4:c.setStorageData("auth","isRequesting",!1);return[7];case 5:return[2]}})})()}},{key:"getToken",value:function getToken(){var e=this.game,t=e.storage;return t.getStorageData("auth","token")}}]);return Aa}(c.Plugins.BasePlugin);var eU=function(e){return e.SOLO="solo",e.TOURNAMENT="tournament",e.SHARE_INVITE="share_invite",e.MATCHING_GROUP="matching_group_match",e.CHALLENGE_FRIEND="challenge_friend_match",e}(eU||{});var eH=l,eK=o.Configs,eW=o.Utils,ez=eW.Array,eq=eW.Valid,eJ=eW.Browser;var eY=/*#__PURE__*/function(){function Ea(e){_class_call_check(this,Ea);u(this,"game");this.game=e}_create_class(Ea,[{key:"isValidContextType",value:function isValidContextType(e){return["THREAD","POST","SOLO","GROUP"].indexOf(e)>=0}},{key:"isValidEntryPointData",value:function isValidEntryPointData(e){return eq.isObject(e)}},{key:"isTournamentEntryPoint",value:function isTournamentEntryPoint(e){return ez.has(["facebook~game_list~tournaments","fb_feed_tournament_unit","messenger~bot_thread~tournaments"],e)}},{key:"receiveContext",value:function receiveContext(e,t,o){var c=this.game,l=c.storage;l.setStorageData("context","contextId",e),this.isValidEntryPointData(o)&&l.setStorageData("context","entryPointData",o),this.isValidContextType(t)&&l.setStorageData("context","contextType",t)}},{key:"detectContextSessionType",value:function detectContextSessionType(){var e=this;return _async_to_generator(function(){var t,o,c,l,d,h,_,y,f,p;return _ts_generator(this,function(v){switch(v.label){case 0:t=e.game,o=t.storage,c=o.getStorageData("context","entryPointData"),l=c.type,d=eU.SOLO,h=eU.TOURNAMENT,_=eU.MATCHING_GROUP,y=eU.SHARE_INVITE,f=eU.CHALLENGE_FRIEND;p=d;if(l===h&&(p=h),l===_&&(p=_),(l===f||l===y)&&(p=f),p!==d)return[3,6];v.label=1;case 1:v.trys.push([1,5,,6]);if(!eK.Core.FastCheckTournamentContext)return[3,2];p=e.fastCheckTournamentContext()||p;return[3,4];case 2:return[4,e.outdatedCheckTournamentContext()];case 3:p=v.sent()||p;v.label=4;case 4:return[3,6];case 5:v.sent();return[3,6];case 6:o.setStorageData("context","sessionContextType",p);return[2]}})})()}},{key:"fastCheckTournamentContext",value:function fastCheckTournamentContext(){var e=eJ.getQueryParams().entry_point;return!!("string"==typeof e&&this.isTournamentEntryPoint(e))&&eU.TOURNAMENT}},{key:"outdatedCheckTournamentContext",value:function outdatedCheckTournamentContext(){return _async_to_generator(function(){var e;return _ts_generator(this,function(t){switch(t.label){case 0:e="getTournamentAsync"in GameSDK;if(!e)return[3,2];return[4,GameSDK.getTournamentAsync()];case 1:e=t.sent().getEndTime()>Date.now()/1e3;t.label=2;case 2:return[2,!!e&&eU.TOURNAMENT]}})})()}},{key:"detectContextGameMode",value:function detectContextGameMode(){var e=this.game,t=e.player,o=e.storage,c=o.getStorageData("context","entryPointData"),l=o.getStorageData("context","sessionContextType"),d=t.getPlayerId(),h=c.matchId,_=c.playerId,y=c.opponentId,f=void 0===y?z.playerId:y,p=d===_,v=f===z.playerId||[f,_].indexOf(d)>=0,g=eU.TOURNAMENT,m=eU.MATCHING_GROUP,A=eU.SHARE_INVITE,k=eU.CHALLENGE_FRIEND;var b=eH.SINGLE;l===g&&(b=eH.TOURNAMENT),l!==A||p||(b=eH.CHALLENGE_FRIEND),l===k&&h&&v&&(b=eH.CHALLENGE_FRIEND),l===m&&(b=eH.MATCHING_GROUP),o.setStorageData("context","contextGameMode",b)}}]);return Ea}();var eX=/*#__PURE__*/function(e){_inherits(Jt,e);function Jt(e){_class_call_check(this,Jt);var t;t=_call_super(this,Jt,[e]),t.name="PlayerHasFinishedMatch",t.message=null!=e?e:"Player has finished match";return t}return Jt}(_wrap_native_super(Error));var eQ=/*#__PURE__*/function(e){_inherits(ut,e);function ut(e){_class_call_check(this,ut);var t;t=_call_super(this,ut,[e]),t.name="PlayerNotJoinInMatch",t.message=e||"Player is not join in match";return t}return ut}(_wrap_native_super(Error));var eZ=o.Events,e$=o.Plugins,e0=e$.Analytics;var e2=/*#__PURE__*/function(){function xa(e){_class_call_check(this,xa);u(this,"game");this.game=e}_create_class(xa,[{key:"processContextData",value:function processContextData(){var e=this;return _async_to_generator(function(){var t,o,c,l,d,h,_,y,f,p,v,g,m,A,k,b,D,P,C,T;return _ts_generator(this,function(O){switch(O.label){case 0:t=e.game,o=t.player,c=t.storage,l=t.monitorError,d=c.getStorageData("context","contextId"),h=c.getStorageData("context","entryPointData"),_=c.getStorageData("context","sessionContextType"),y=h||{},f=y.type,p=y.matchId,v=y.playerId,g=y.opponentId,m=y.playerScore,A=y.action;k=A;if(!k)return[3,2];return[4,e.processEntryPointAction(A)];case 1:k=O.sent();O.label=2;case 2:b=o.isFirstLogin();setTimeout(function(){e.logUserAnalytics(b)},1e3);D=eU.TOURNAMENT,P=eU.SHARE_INVITE,C=eU.MATCHING_GROUP,T=eU.CHALLENGE_FRIEND;if(_!==D)return[3,6];O.label=3;case 3:O.trys.push([3,5,,6]);return[4,e.processTournamentModeAsync(d)];case 4:O.sent();return[2];case 5:O.sent();null==l||l.sendException(new Error("Process Tournament Fail"),{contextId:d,isFirstLogin:b,entryPointData:h,playerData:o.getPlayerData()});return[3,6];case 6:if(_!==T)return[3,10];if(!(f===P&&"string"==typeof v))return[3,8];return[4,e.processChallengeFromPostAsync(v)];case 7:O.sent();return[2];case 8:if(!(f===T&&"string"==typeof p&&"string"==typeof v&&"string"==typeof g))return[3,10];return[4,e.processChallengeFromMessageAsync({contextId:d,matchId:p,playerId:v,opponentId:g})];case 9:O.sent();return[2];case 10:if(!(_===C&&"string"==typeof v&&"number"==typeof m))return[3,12];return[4,e.processMatchingGroupModeAsync(v,m)];case 11:O.sent();return[2];case 12:if(!b)return[3,14];return[4,e.processSingleModeAsync(!0)];case 13:O.sent(),o.loggedIn();return[2];case 14:e.processSingleModeAsync(!1);return[2]}})})()}},{key:"logUserAnalytics",value:function logUserAnalytics(e){try{var t=this.game,o=t.player,c=t.analytics;if(e)c.event(e0.Events.NEW_USER);else{var l=o.getPlayerData().gameData,d=l.coins;c.event(e0.Events.RETURNING_USER,{coins:d})}}catch(e){}}},{key:"processEntryPointAction",value:function processEntryPointAction(e){var t=this;return _async_to_generator(function(){var o,c;return _ts_generator(this,function(l){switch(l.label){case 0:l.trys.push([0,7,,8]);o=t.game,c=o.player;switch(e){case"reset_data":return[3,1];case"enable_debug":return[3,3];case"set_locale_en":return[3,4];case"set_locale_ru":return[3,5]}return[3,6];case 1:c.setPlayerDataByName("score",0),c.setPlayerDataByName("endlessScore",0),c.setGameData({coins:0,level:1});return[4,c.syncProfileToServer()];case 2:l.sent();return[3,6];case 3:c.setPlayerDataByName("debug",!0);return[3,6];case 4:t.requestSetLocale("en");return[3,6];case 5:t.requestSetLocale("ru");return[3,6];case 6:return[3,8];case 7:l.sent();return[3,8];case 8:return[2]}})})()}},{key:"requestSetLocale",value:function requestSetLocale(e){var t=this.game,o=t.event;o.emit(eZ.REQUEST_LANGUAGE,{locale:e})}},{key:"processTournamentModeAsync",value:function processTournamentModeAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d;return _ts_generator(this,function(h){switch(h.label){case 0:o=t.game,c=o.match,l=o.player,d=l.getPlayerId();if("string"!=typeof e)throw new Error("Cannot get contextId");return[4,c.tournament.continue.processAsync({playerId:d,contextId:e})];case 1:h.sent(),t.switchToGameScene();return[2]}})})()}},{key:"processChallengeFromPostAsync",value:function processChallengeFromPostAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d;return _ts_generator(this,function(h){switch(h.label){case 0:o=t.game,c=o.match,l=o.player,d=l.getPlayerId();if(d!==e)return[3,2];return[4,c.single.start.processAsync({playerId:d})];case 1:h.sent();return[3,6];case 2:h.trys.push([2,4,,6]);return[4,c.challenge.friend.processAsync({playerId:d,opponentId:e})];case 3:h.sent();return[3,6];case 4:h.sent();return[4,c.single.start.processAsync({playerId:d})];case 5:h.sent();return[3,6];case 6:t.switchToGameScene();return[2]}})})()}},{key:"processChallengeFromMessageAsync",value:function processChallengeFromMessageAsync(e){var t=this;return _async_to_generator(function(){var o;return _ts_generator(this,function(c){switch(c.label){case 0:c.trys.push([0,2,,7]);return[4,t.processContinueChallengeFromMessageAsync(e)];case 1:c.sent();return[3,7];case 2:o=c.sent();if(!_instanceof(o,eX))return[3,4];return[4,t.processAwaitChallengeFromMessageAsync(e)];case 3:c.sent();return[2];case 4:if(!_instanceof(o,eQ))return[3,6];return[4,t.processJoinChallengeFromMessageAsync(e)];case 5:c.sent();return[2];case 6:t.switchToDashboardScene();return[3,7];case 7:return[2]}})})()}},{key:"processContinueChallengeFromMessageAsync",value:function processContinueChallengeFromMessageAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,h,_,y,f,p;return _ts_generator(this,function(v){switch(v.label){case 0:o=e.contextId,c=e.matchId,l=e.playerId,d=e.opponentId,h=t.game,_=h.match,y=h.player,f=y.getPlayerId();if(l!==f)return[3,2];return[4,_.challenge.continue.processAsync({contextId:o,matchId:c,playerId:f,opponentId:d})];case 1:v.sent();return[3,4];case 2:p=d===z.playerId;return[4,_.challenge.continue.processAsync({contextId:o,matchId:c,playerId:f,opponentId:p?d:l})];case 3:v.sent();v.label=4;case 4:t.switchToGameScene();return[2]}})})()}},{key:"processJoinChallengeFromMessageAsync",value:function processJoinChallengeFromMessageAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,h,_,y;return _ts_generator(this,function(f){switch(f.label){case 0:o=e.contextId,c=e.matchId,l=e.playerId,d=t.game,h=d.match,_=d.player,y=_.getPlayerId();return[4,h.challenge.join.processAsync({contextId:o,matchId:c,playerId:y,opponentId:l})];case 1:f.sent(),t.switchToGameScene();return[2]}})})()}},{key:"processAwaitChallengeFromMessageAsync",value:function processAwaitChallengeFromMessageAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,h,_,y;return _ts_generator(this,function(f){switch(f.label){case 0:o=e.contextId,c=e.matchId,l=e.playerId,d=t.game,h=d.match,_=d.player,y=_.getPlayerId();f.label=1;case 1:f.trys.push([1,3,,5]);return[4,h.challenge.await.processAsync({contextId:o,matchId:c,playerId:y,opponentId:l})];case 2:f.sent(),t.switchToChallengeResultScene();return[3,5];case 3:f.sent();return[4,t.processResultChallengeFromMessageAsync(e)];case 4:f.sent();return[3,5];case 5:return[2]}})})()}},{key:"processResultChallengeFromMessageAsync",value:function processResultChallengeFromMessageAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,h,_,y;return _ts_generator(this,function(f){switch(f.label){case 0:o=e.contextId,c=e.matchId,l=e.playerId,d=t.game,h=d.match,_=d.player,y=_.getPlayerId();f.label=1;case 1:f.trys.push([1,3,,4]);return[4,h.challenge.result.processAsync({contextId:o,matchId:c,playerId:y,opponentId:l})];case 2:f.sent(),t.switchToChallengeResultScene();return[3,4];case 3:f.sent();t.switchToDashboardScene();return[3,4];case 4:return[2]}})})()}},{key:"processMatchingGroupModeAsync",value:function processMatchingGroupModeAsync(e,t){var o=this;return _async_to_generator(function(){var c,l,d;return _ts_generator(this,function(h){switch(h.label){case 0:c=o.game,l=c.match,d=c.player;return[4,l.group.join.processAsync({playerId:d.getPlayerId(),opponentId:e,opponentScore:t})];case 1:h.sent(),o.switchToGameScene();return[2]}})})()}},{key:"processSingleModeAsync",value:function processSingleModeAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,h;return _ts_generator(this,function(_){switch(_.label){case 0:o=t.game,c=o.match,l=o.player,d=l.getPlayerId();h=e;if(!h)return[3,2];return[4,c.handler.setMatchCustomData({level:0})];case 1:h=_.sent();_.label=2;case 2:return[4,c.single.start.processAsync({playerId:d})];case 3:_.sent(),t.switchToGameScene();return[2]}})})()}},{key:"switchToDashboardScene",value:function switchToDashboardScene(){var e=this.game,t=e.event;t.emit(eZ.SWITCH_SCENE,{sceneName:"DashboardScene",sceneData:{isFromLoader:!0}})}},{key:"switchToGameScene",value:function switchToGameScene(){var e=this.game,t=e.event;t.emit(eZ.SWITCH_SCENE,{sceneName:"GameScene",sceneData:{isFromLoader:!0}})}},{key:"switchToChallengeResultScene",value:function switchToChallengeResultScene(){var e=this.game,t=e.event;t.emit(eZ.SWITCH_SCENE,{sceneName:"ChallengeResultScene",sceneData:{isFromLoader:!0}})}}]);return xa}();var e3={processed:!1,contextId:"",contextType:"SOLO",entryPointData:{},contextGameMode:"",sessionContextType:""},e1=o.Events;var e4=/*#__PURE__*/function(e){_inherits(Ca,e);function Ca(e){_class_call_check(this,Ca);var t;t=_call_super(this,Ca,[e]);u(t,"context");u(t,"loader");t.loader=new e2(e),t.context=new eY(e);return t}_create_class(Ca,[{key:"init",value:function init(){var e=this.game,t=e.storage;t.addStorage("context",e3)}},{key:"getSessionContextTypes",value:function getSessionContextTypes(){return eU}},{key:"processContextData",value:function processContextData(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:t.trys.push([0,2,,3]);return[4,e.loader.processContextData()];case 1:t.sent();return[3,3];case 2:t.sent();e.switchToDashboardScene();return[3,3];case 3:return[2]}})})()}},{key:"detectContextSessionType",value:function detectContextSessionType(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:t.trys.push([0,2,,3]);return[4,e.context.detectContextSessionType()];case 1:t.sent();return[3,3];case 2:t.sent();return[3,3];case 3:return[2]}})})()}},{key:"detectContextGameMode",value:function detectContextGameMode(){this.context.detectContextGameMode()}},{key:"receiveContext",value:function receiveContext(e,t,o){this.context.receiveContext(e,t,o)}},{key:"switchToDashboardScene",value:function switchToDashboardScene(){var e=this.game,t=e.event;t.emit(e1.SWITCH_SCENE,{sceneName:"DashboardScene"})}}]);return Ca}(c.Plugins.BasePlugin);var e5=o.Utils,e6=e5.Valid,e7=e3.contextId,e8=e3.contextType,e9=e3.entryPointData,te="is invalid";var tt=/*#__PURE__*/function(e){_inherits(Xt,e);function Xt(){_class_call_check(this,Xt);var e;e=_call_super(this,Xt,arguments);u(e,"data");return e}_create_class(Xt,[{key:"setupData",value:function setupData(e){this.lazySetupData(e)}},{key:"validateStructure",value:function validateStructure(e){this.lazyValidateStructure(e)}},{key:"validateData",value:function validateData(e){this.lazyValidateData(e)}},{key:"validateContextId",value:function validateContextId(e){e6.isString(e)||this.exception("contextId",te)}},{key:"validateContextType",value:function validateContextType(e){e6.isString(e)&&e||this.exception("contextType",te)}},{key:"validateEntryPointData",value:function validateEntryPointData(e){e6.isObject(e)||this.exception("entryPointData",te)}},{key:"toObject",value:function toObject(){return _get(_get_prototype_of(Xt.prototype),"toObject",this).call(this)}}]);return Xt}(D);tt.addDefaultData({contextId:e7,contextType:e8,entryPointData:e9}),o.Dtos.Context={Info:tt};var tn={0:{id:1,type:"coin",value:300},1:{id:2,type:"coin",value:500},2:{id:3,type:"coin",value:1e3},3:{id:4,type:"coin",value:2e3},4:{id:5,type:"coin",value:3e3},5:{id:6,type:"coin",value:5e3},6:{id:7,type:"coin",value:1e3}},ta=o.Utils,to=ta.Object;var tc=/*#__PURE__*/function(){function _a(){_class_call_check(this,_a)}_create_class(_a,[{key:"getDailyRewardsAsync",value:function getDailyRewardsAsync(){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2,to.vals(tn)]})})()}}]);return _a}();var tu={REWARDED:"rewarded",SKIPPED:"skipped",READY:"ready",WAITING:"waiting"},tl={dailyRewards:{}},td=o.Configs.DailyRewards;var th=/*#__PURE__*/function(e){_inherits(Ra,e);function Ra(){_class_call_check(this,Ra);var e;e=_call_super(this,Ra,arguments);u(e,"dailyRewardsApi",new tc);return e}_create_class(Ra,[{key:"init",value:function init(){var e=this.game,t=e.storage;t.addStorage("dailyRewards",tl)}},{key:"requestDailyRewardsAsync",value:function requestDailyRewardsAsync(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(o){switch(o.label){case 0:return[4,e.dailyRewardsApi.getDailyRewardsAsync()];case 1:t=o.sent();0!==t.length&&e.receiveDailyRewards(t);return[2]}})})()}},{key:"getDailyRewards",value:function getDailyRewards(){var e=this.game,t=e.storage,o=t.getStorageData("dailyRewards","dailyRewards");return o||null}},{key:"logLoginReward",value:function logLoginReward(){var e=this.game,t=e.player,o=t.getPlayerData().dailyRewarded,c=o.logDays,l=_to_consumable_array(c);l[l.length-1]=!0,this.logDailyRewards(l)}},{key:"logDailyRewards",value:function logDailyRewards(e,t){var o=arguments.length>1&&void 0!==t&&t;var c=this.game,l=c.player;l.setPlayerDataByName("dailyRewarded",{logDays:e,lastRewarded:o?0:Date.now()})}},{key:"receiveDailyRewards",value:function receiveDailyRewards(e){var t=this.game,o=t.player,c=o.getPlayerData().dailyRewarded,l=c.logDays,d=c.lastRewarded,h=new Date,_=new Date(d),y=new Date(_.toDateString()),f=Math.abs(h.valueOf()-y.valueOf()),p=Math.floor(f/864e5)>1,v=td.CheckInterrupt&&p||l.length>=td.MaxDays,g=v?[!1]:_to_consumable_array(l).concat([!1]);this.logDailyRewards(g);var m=e.map(function(e,t){var o=t<g.length,c=g.length===t+1,l=!1===g[t];var d=tu.WAITING;return c?d=tu.READY:v?d=tu.WAITING:o&&l?d=tu.SKIPPED:o&&(d=tu.REWARDED),_object_spread_props(_object_spread({},e),{status:d})});this.setDailyRewards(m)}},{key:"setDailyRewards",value:function setDailyRewards(e){var t=this.game,o=t.storage;o.setStorageData("dailyRewards","dailyRewards",e)}}]);return Ra}(c.Plugins.BasePlugin);var t_={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,o="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(o=!1));function a(e,t,o){this.fn=e,this.context=t,this.once=o||!1}function n(e,t,c,l,d){if("function"!=typeof c)throw new TypeError("The listener must be a function");var h=new a(c,l||e,d),_=o?o+t:t;return e._events[_]?e._events[_].fn?e._events[_]=[e._events[_],h]:e._events[_].push(h):(e._events[_]=h,e._eventsCount++),e}function i(e,t){0===--e._eventsCount?e._events=new s:delete e._events[t]}function r(){this._events=new s,this._eventsCount=0}r.prototype.eventNames=function(){var e=[],c,l;if(0===this._eventsCount)return e;for(l in c=this._events)t.call(c,l)&&e.push(o?l.slice(1):l);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(c)):e},r.prototype.listeners=function(e){var t=o?o+e:e,c=this._events[t];if(!c)return[];if(c.fn)return[c.fn];for(var l=0,d=c.length,h=new Array(d);l<d;l++)h[l]=c[l].fn;return h},r.prototype.listenerCount=function(e){var t=o?o+e:e,c=this._events[t];return c?c.fn?1:c.length:0},r.prototype.emit=function(e,t,c,l,d,h){var _=o?o+e:e;if(!this._events[_])return!1;var y=this._events[_],f=arguments.length,p,v;if(y.fn){switch(y.once&&this.removeListener(e,y.fn,void 0,!0),f){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,t),!0;case 3:return y.fn.call(y.context,t,c),!0;case 4:return y.fn.call(y.context,t,c,l),!0;case 5:return y.fn.call(y.context,t,c,l,d),!0;case 6:return y.fn.call(y.context,t,c,l,d,h),!0}for(v=1,p=new Array(f-1);v<f;v++)p[v-1]=arguments[v];y.fn.apply(y.context,p)}else{var g=y.length,m;for(v=0;v<g;v++)switch(y[v].once&&this.removeListener(e,y[v].fn,void 0,!0),f){case 1:y[v].fn.call(y[v].context);break;case 2:y[v].fn.call(y[v].context,t);break;case 3:y[v].fn.call(y[v].context,t,c);break;case 4:y[v].fn.call(y[v].context,t,c,l);break;default:if(!p)for(m=1,p=new Array(f-1);m<f;m++)p[m-1]=arguments[m];y[v].fn.apply(y[v].context,p)}}return!0},r.prototype.on=function(e,t,o){return n(this,e,t,o,!1)},r.prototype.once=function(e,t,o){return n(this,e,t,o,!0)},r.prototype.removeListener=function(e,t,c,l){var d=o?o+e:e;if(!this._events[d])return this;if(!t)return i(this,d),this;var h=this._events[d];if(h.fn)h.fn!==t||l&&!h.once||c&&h.context!==c||i(this,d);else{for(var _=0,y=[],f=h.length;_<f;_++)(h[_].fn!==t||l&&!h[_].once||c&&h[_].context!==c)&&y.push(h[_]);y.length?this._events[d]=1===y.length?y[0]:y:i(this,d)}return this},r.prototype.removeAllListeners=function(e){var t;return e?(t=o?o+e:e,this._events[t]&&i(this,t)):(this._events=new s,this._eventsCount=0),this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prefixed=o,r.EventEmitter=r,e.exports=r})(t_);var ty=t_.exports;var tf=f(ty),tp=new tf,tv={names:[],history:[]};var tg=/*#__PURE__*/function(e){_inherits(ka,e);function ka(){_class_call_check(this,ka);var e;e=_call_super(this,ka,arguments);u(e,"enableLog",!1);u(e,"muteEvents",[]);return e}_create_class(ka,[{key:"init",value:function init(){var e=this.game,t=e.storage;t.addStorage("event",tv)}},{key:"enableLogEvent",value:function enableLogEvent(){this.enableLog=!0}},{key:"on",value:function on(e,t){this.validateCallback(t),this.addEventName(e),this.addHistory(e,"on","listening"),tp.on(e,t)}},{key:"once",value:function once(e,t){this.validateCallback(t),this.addEventName(e),this.addHistory(e,"once","listening"),tp.once(e,t)}},{key:"catchUp",value:function catchUp(e,t){if(this.validateCallback(t),this.once(e,t),!(this.getEventEmitCount(e)>0))return;var o;var c=null!==(o=this.getLastEventInfo(e))&&void 0!==o?o:{},l=c.payload;this.emit(e,l)}},{key:"off",value:function off(e,t){this.validateCallback(t),tp.off(e,t),this.addHistory(e,"action","removed")}},{key:"mute",value:function mute(e){this.muteEvents.indexOf(e)>-1||this.muteEvents.push(e)}},{key:"clear",value:function clear(e){tp.removeAllListeners(e),this.addHistory(e,"action","removed")}},{key:"emit",value:function emit(e,t){var o;if(this.muteEvents.indexOf(e)>-1)return;var c=[];t&&(c=[t]),this.addHistory(e,"action","called",t),(o=tp).emit.apply(o,[e].concat(_to_consumable_array(c)))}},{key:"validateCallback",value:function validateCallback(e){if("function"!=typeof e)throw new Error("Callback must be a function")}},{key:"addEventName",value:function addEventName(e){var t=this.game,o=t.storage,c=o.getStorageData("event","names");c.indexOf(e)<0&&c.push(e)}},{key:"getEventListeners",value:function getEventListeners(){var e=tp.eventNames();return Object.keys(e)}},{key:"getHistory",value:function getHistory(){var e=this.game,t=e.storage;return t.getStorageData("event","history")}},{key:"getEventEmitCount",value:function getEventEmitCount(e){return this.getHistory().filter(function(t){return t.name===e&&"called"===t.status}).length}},{key:"getLastEventInfo",value:function getLastEventInfo(e){var t=this.getHistory();var o=null;for(var c=t.length-1;c>=0;c--)if(t[c].name===e){o=t[c];break}return o}},{key:"getTypeFromHistory",value:function getTypeFromHistory(e){var t=this.getLastEventInfo(e);var o;return null!==(o=null==t?void 0:t.type)&&void 0!==o?o:null}},{key:"getCallsFromHistory",value:function getCallsFromHistory(e){var t=this.getLastEventInfo(e);var o;return null!==(o=null==t?void 0:t.called)&&void 0!==o?o:0}},{key:"addHistory",value:function addHistory(e,t,o,c){var l;var d=null!==(l=this.getTypeFromHistory(e))&&void 0!==l?l:t,h=this.getCallsFromHistory(e),_="called"===o?h+1:h;this.getHistory().push({type:d,status:o,name:e,called:_,payload:null!=c?c:{}}),this.logEventInfo(e,d,o,_)}},{key:"logEventInfo",value:function logEventInfo(e,t,o,c){this.enableLog&&("listening"===o&&tp.listenerCount(e),"called"===o&&tp.listenerCount(e))}}]);return ka}(c.Plugins.BasePlugin);var tm={},tA=Object.freeze(Object.defineProperty({__proto__:null,default:tm},Symbol.toStringTag,{value:"Module"})),tw='nunito,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",sans-serif',tI=o.Configs,tk=o.Utils,tb=tk.Object,tS=tI.FrameCapture,tD=tS.Enabled,tP=tS.WideframeConfigs,tE=/*#__PURE__*/function(){var e=_async_to_generator(function(e){var t,o,c,l,d,h;return _ts_generator(this,function(_){if(!tD)return[2,null];t=Wa(e);if(!t)return[2,null];Ka(t,tP.ResultChallenge);o=window.game,c=o.frameCapture,l=tP.ResultChallenge,d=l.Width,h=l.Height;return[2,c.captureAsync({name:"ResultChallenge",width:d,height:h,renderOptions:t})]})});return function ja(t){return e.apply(this,arguments)}}(),Ka=function(e,t){var o=t.Width,c=t.Height,l=t.Wideframe;e.wideframe={name:"result-challenge",type:"image",depth:0,image:l,size:[o,c],position:[0,0]}},Wa=function(e){try{var t=e.playerId,o=void 0===t?"10":t,c=e.playerPhoto,l=void 0===c?"":c,d=e.playerScore,h=void 0===d?0:d,_=e.opponentId,y=void 0===_?"20":_,f=e.opponentPhoto,p=void 0===f?"":f,v=e.opponentScore,g=void 0===v?0:v,m=e.isPlayerFinished,A=e.isOpponentFinished,k=tP.ResultChallenge,b=k.RenderOptions,D=tb.clone(b);if(!D)return null;var P=tb.clear(D),C=tb.camelCaseKeys(P),T=C.playerPhoto,O=C.opponentPhoto,R=h===g,M=h>g,G=null!=m?m:A,V=m&&A;return"image"===T.type&&(T.name="".concat(o),T.image=l),"image"===O.type&&(O.name="".concat(y),O.image=p),G&&za(C,{playerScore:h,opponentScore:g,isPlayerFinished:m,isOpponentFinished:A}),!V||R?(delete C.leftCrown,delete C.rightCrown,C):(M?delete C.rightCrown:delete C.leftCrown,C)}catch(e){return null}},za=function(e,t){var o=e.leftScore,c=e.rightScore,l=t.playerScore,d=void 0===l?0:l,h=t.opponentScore,_=void 0===h?0:h,y=t.isPlayerFinished,f=t.isOpponentFinished;(null==o?void 0:o.type)==="text"&&(o.text=y?"".concat(d):"???"),(null==c?void 0:c.type)==="text"&&(c.text=f?"".concat(_):"???")},tx=o.Configs,tC=o.Utils,tN=tC.Object,tT=tx.FrameCapture,tL=tT.Enabled,tO=tT.WideframeConfigs,tR=/*#__PURE__*/function(){var e=_async_to_generator(function(e){var t,o,c,l,d,h;return _ts_generator(this,function(_){if(!tL)return[2,null];t=Za(e);if(!t)return[2,null];Xa(t,tO.ShareLeaderboard);o=window.game,c=o.frameCapture,l=tO.ShareLeaderboard,d=l.Width,h=l.Height;return[2,c.captureAsync({name:"ShareLeaderboard",width:d,height:h,renderOptions:t})]})});return function Qa(t){return e.apply(this,arguments)}}(),Xa=function(e,t){var o=t.Width,c=t.Height,l=t.Wideframe;e.wideframe={name:"share-leaderboard",type:"image",depth:0,image:l,size:[o,c],position:[0,0]}},Za=function(e){try{var t=e.playerId,o=e.playerPhoto,c=e.leaders,l=tO.ShareLeaderboard,d=l.RenderOptions,h=tN.clone(d);if(!h)return null;var _=tN.clear(h),y=tN.camelCaseKeys(_),f=y.avatar;return"image"===f.type&&(f.name="".concat(t),f.image=o),en(y,c),y}catch(e){return null}},en=function(e,t){var o="600 48px";t.forEach(function(t,c){var l=t.id,d=t.name,h=t.photo,_=t.score;var y=1294+180*c;e["photo_".concat(l)]={depth:-1,name:l,type:"image",image:h,size:[96,96],position:[436,y]},y=1360+180*c,e["name_".concat(l)]={font:o,depth:1,name:l,type:"text",text:d,position:[600,y]},e["score_".concat(l)]={font:o,depth:1,name:l,type:"text",text:"".concat(_),position:[100,y]}})},tM=o.Configs,tF=o.Utils,tG=tF.Object,tj=tM.FrameCapture,tV=tj.Enabled,tB=tj.WideframeConfigs,tU=/*#__PURE__*/function(){var e=_async_to_generator(function(e){var t,o,c,l,d,h;return _ts_generator(this,function(_){if(!tV)return[2,null];t=on(e);if(!t)return[2,null];rn(t,tB.ShareScore);o=window.game,c=o.frameCapture,l=tB.ShareScore,d=l.Width,h=l.Height;return[2,c.captureAsync({name:"ShareScore",width:d,height:h,renderOptions:t})]})});return function nn(t){return e.apply(this,arguments)}}(),rn=function(e,t){var o=t.Width,c=t.Height,l=t.Wideframe;e.wideframe={name:"share-score",type:"image",depth:0,image:l,size:[o,c],position:[0,0]}},on=function(e){try{var t=e.playerId,o=e.playerPhoto,c=e.playerScore,l=tB.ShareScore,d=l.RenderOptions,h=tG.clone(d);if(!h)return null;var _=tG.clear(h),y=tG.camelCaseKeys(_),f=y.avatar,p=y.playerScore;return"image"===f.type&&(f.name="".concat(t),f.image=o),"text"===p.type&&(p.text="".concat(c)),y}catch(e){return null}},tH=o.Configs,tK=o.Utils,tW=tK.Image,tz=tK.Object,tq=tK.Valid,tJ=tH.FrameCapture,tY=tJ.Options;var tX=/*#__PURE__*/function(e){_inherits(dn,e);function dn(){_class_call_check(this,dn);var e;e=_call_super(this,dn,arguments);u(e,"width");u(e,"height");u(e,"canvas",null);u(e,"testRenderOptions",null);u(e,"caches",{});u(e,"wideframe",{});return e}_create_class(dn,[{key:"init",value:function init(){this.addWideframeRender("renderShareScore",tU),this.addWideframeRender("renderResultChallenge",tE),this.addWideframeRender("renderShareLeaderboard",tR)}},{key:"preloadAsync",value:function preloadAsync(e){var t=this;return _async_to_generator(function(){var o;return _ts_generator(this,function(c){switch(c.label){case 0:o=e.renderOptions;return[4,t.loadImages(o)];case 1:c.sent();return[2]}})})()}},{key:"captureAsync",value:function captureAsync(e){var t=this;return _async_to_generator(function(){var o,c,l;return _ts_generator(this,function(d){switch(d.label){case 0:o=e.width,c=e.height,l=e.renderOptions;return[4,t.loadImages(l)];case 1:return[2,(d.sent(),t.width=o,t.height=c,t.createCanvas(),t.drawObjects(l),t.snapshotFrameAsync())]}})})()}},{key:"addWideframeRender",value:function addWideframeRender(e,t){this.wideframe[e]=t}},{key:"setTestRenderOptions",value:function setTestRenderOptions(e){if(!e){this.testRenderOptions=null;return}var t=tz.camelCaseKeys(e);this.testRenderOptions=tz.merge(this.testRenderOptions,t)}},{key:"createCanvas",value:function createCanvas(){if(this.canvas){var e=this.canvas.getContext("2d");e?e.clearRect(0,0,this.canvas.width,this.canvas.height):this.canvas=null}this.canvas||(this.canvas=document.createElement("canvas",{is:"canvas"})),this.canvas.width=this.width,this.canvas.height=this.height}},{key:"loadImages",value:function loadImages(e){var t=this;return _async_to_generator(function(){var o,c,l,d;return _ts_generator(this,function(h){switch(h.label){case 0:o=tz.vals(e).filter(function(e){return"image"===e.type}),c=t.prepareLoadImages(o),l=tz.vals(c);if(l.length<1)return[2];return[4,Promise.all(l)];case 1:d=h.sent();t.cacheImages(c,d);return[2]}})})()}},{key:"prepareLoadImages",value:function prepareLoadImages(e){var t={};var o=true,c=false,l=void 0;try{var d,_loop=function(){var e=_.value;var o=e.name,c=e.image,l=e.fallbackImage,h=d.caches[o];!tq.isString(c)||h||(""===c&&tq.isString(l)&&(e.image=l),t[o]=new Promise(function(t){tW.loadImage(c).then(function(e){t(e)}).catch(function(){tq.isString(l)?(e.image=l,tW.loadImage(e.image).then(function(e){t(e)}).catch(function(){t(null)})):t(null)})}))};for(var h=e[Symbol.iterator](),_;!(o=(_=h.next()).done);o=true)d=this,_loop()}catch(e){c=true;l=e}finally{try{if(!o&&null!=h.return)h.return()}finally{if(c)throw l}}return t}},{key:"cacheImages",value:function cacheImages(e,t){for(var o in e){var c=t.shift();c&&(this.caches[o]=c)}}},{key:"drawObjects",value:function drawObjects(e){var t=tz.vals(e).sort(function(e,t){return e.depth-t.depth});var o=true,c=false,l=void 0;try{for(var d=t[Symbol.iterator](),h;!(o=(h=d.next()).done);o=true){var _=h.value;switch(_.type){case"text":this.drawText(_);break;case"image":this.drawImage(_);break}}}catch(e){c=true;l=e}finally{try{if(!o&&null!=d.return)d.return()}finally{if(c)throw l}}}},{key:"drawText",value:function drawText(e){if(!this.canvas)return;var t=this.canvas.getContext("2d",{alpha:!1,desynchronized:!0,willReadFrequently:!0});if(!t)return;var o=e.position,c=e.font,l=e.text,d=e.color,h=e.lineWidth,_=e.textAlign;t.font="".concat(c," ").concat(tw),t.fillStyle=null!=d?d:"#ffffff",h&&(t.lineWidth=h),_&&(t.textAlign=_);var y=_sliced_to_array(o,2),f=y[0],p=y[1];t.fillText(l,f,p)}},{key:"drawImage",value:function drawImage(e){if(!this.canvas)return;var t=this.canvas.getContext("2d",{alpha:!1,desynchronized:!0,willReadFrequently:!0});if(!t)return;var o=e.name,c=e.size,l=e.position,d=e.fallbackImage;var h=this.caches[o];if(!h&&d&&(h=this.caches[d]),!h)throw new Error("Image ".concat(o," not found"));var _=_sliced_to_array(l,2),y=_[0],f=_[1],p=_sliced_to_array(c,2),v=p[0],g=p[1];t.drawImage(h,y,f,v,g)}},{key:"snapshotFrameAsync",value:function snapshotFrameAsync(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(o){switch(o.label){case 0:if(!e.canvas)return[2,null];t=null;if(!(tY.UseBlobIfPossible&&"toBlob"in e.canvas))return[3,2];return[4,e.createAsBlob()];case 1:t=o.sent();return[3,3];case 2:t=e.createAsDataImage();o.label=3;case 3:if(!t)throw new Error("Image data is null");return[2,(tq.isDebugger()&&tW.logImage(t),t)]}})})()}},{key:"createAsDataImage",value:function createAsDataImage(){if(!this.canvas)return null;var e=this.canvas.getContext("2d",{alpha:!1,desynchronized:!0,willReadFrequently:!0});if(!e)return null;var t=tY.Quality,o=tY.RenderType;return e.canvas.toDataURL("image/".concat(o),t)}},{key:"createAsBlob",value:function createAsBlob(){var e=this;return new Promise(function(t){if(!e.canvas){t(null);return}var o=tY.Quality,c=tY.RenderType;e.canvas.toBlob(function(e){if(!e){t(null);return}tW.blobToDataImage(e).then(function(e){t(e)})},"image/".concat(c),o)})}}]);return dn}(c.Plugins.BasePlugin);var tQ=/*#__PURE__*/function(e){_inherits(ts,e);function ts(e,t){_class_call_check(this,ts);var o;var c=String(e);o=_call_super(this,ts,['Text with key "'.concat(c,'" not found in locale "').concat(t,'"')]);u(o,"key");u(o,"locale");o.name="MissingKeyInLocaleError",o.key=c,o.locale=t;return o}return ts}(_wrap_native_super(Error));var tZ=/*#__PURE__*/function(e){_inherits(hn,e);function hn(e){_class_call_check(this,hn);var t;t=_call_super(this,hn,['Locale "'.concat(e,'" not found')]);u(t,"locale");t.name="LocaleNotFoundError",t.locale=e;return t}return hn}(_wrap_native_super(Error));var t$=o.Utils,t0=t$.Object,t2=t$.Function;var t3=/*#__PURE__*/function(e){_inherits(un,e);function un(){_class_call_check(this,un);var e;e=_call_super(this,un,arguments);u(e,"locale");u(e,"fallbackLocale");u(e,"data",{});return e}_create_class(un,[{key:"setFallbackLocale",value:function setFallbackLocale(e){this.fallbackLocale=e}},{key:"hasTextKey",value:function hasTextKey(e,t){var o=null!=t?t:this.getCurrentLocale(),c=this.getLocaleData(o),l=c.text;return t0.hasOwn(l,e)}},{key:"hasTextureKey",value:function hasTextureKey(e,t){var o=null!=t?t:this.getCurrentLocale(),c=this.getLocaleData(o),l=c.texture;return t0.hasOwn(l,e)}},{key:"add",value:function add(e,t,o){var c=arguments.length>2&&void 0!==o&&o;this.data[e]=t,c&&this.setFallbackLocale(e)}},{key:"choose",value:function choose(e){this.locale=e;var t=this.game,c=t.event;c.emit(o.Events.LANGUAGE_CHANGED,{locale:e})}},{key:"getText",value:function getText(e,t,o,c){var l=arguments.length>3&&void 0!==c&&c;try{return this.uncaughtGetText(e,t,o,!l)}catch(t){return String(e)}}},{key:"getTexture",value:function getTexture(e,t,o){var c=arguments.length>2&&void 0!==o&&o;return this.uncaughtGetTexture(e,t,!c)}},{key:"uncaughtGetText",value:function uncaughtGetText(e,t,o,c){var l=this;var d=arguments.length>1&&void 0!==t?t:[],h=arguments.length>2?o:void 0,_=!(arguments.length>3)||void 0===c||c;if(!_||void 0===this.fallbackLocale){var y=this.getRawText(e,null!=h?h:this.getCurrentLocale());return this.replaceVariables(y,d)}var f=this.fallbackLocale,p=t2.retry(function(){return l.getRawText(e,null!=h?h:l.getCurrentLocale())},function(){return l.getRawText(e,f)});return this.replaceVariables(p,d)}},{key:"getRawText",value:function getRawText(e,t){if(!this.hasTextKey(e,t))throw new tQ(e,t);var o=this.getLocaleData(t),c=o.text;return c[e]}},{key:"uncaughtGetTexture",value:function uncaughtGetTexture(e,t,o){var c=this;var l=!(arguments.length>2)||void 0===o||o;if(!l||void 0===this.fallbackLocale)return this.getRawTexture(e,null!=t?t:this.getCurrentLocale());var d=this.fallbackLocale;return t2.retry(function(){return c.getRawTexture(e,null!=t?t:c.getCurrentLocale())},function(){return c.getRawTexture(e,d)})}},{key:"getRawTexture",value:function getRawTexture(e,t){if(!this.hasTextureKey(e,t))throw new tQ(e,t);var o=this.getLocaleData(t),c=o.texture;return c[e]}},{key:"getCurrentLocale",value:function getCurrentLocale(){var e;return null!==(e=this.locale)&&void 0!==e?e:"en"}},{key:"getLocaleData",value:function getLocaleData(e){var t=null!=e?e:this.getCurrentLocale();if(!t0.hasOwn(this.data,t))throw new tZ(t);return this.data[t]}},{key:"replaceVariables",value:function replaceVariables(e,t){var o=t.length;if(0===o)return e;var c=e;for(var l=0;l<o;l++){var d=t[l],h="%{".concat(l,"}");c=c.replace(h,d)}return c}}]);return un}(c.Plugins.BasePlugin);var t1=e("D",{_id:"",name:"",createdBy:"",description:"",expireTime:6048e5,type:"app_leaderboard",timezone:"utc+0",createdAt:"2024-01-01T09:00:00.000Z",sortOrder:"desc",statistics:"max",resettable:"manually",resetScore:0,numberOfLeaders:15,amountPlayer:15}),t4=o.Configs,t5=o.Utils,t6=t5.Object,t7=t5.String,t8=t5.Valid,t9=t4.OtherHost,nt=t4.Mockup,na=t4.AppId;var nr=/*#__PURE__*/function(){function mn(){_class_call_check(this,mn);u(this,"mockAPI")}_create_class(mn,[{key:"initMockAPI",value:function initMockAPI(){var e=this;return _async_to_generator(function(){var o;return _ts_generator(this,function(c){switch(c.label){case 0:if(e.mockAPI)return[2];return[4,d(/*#__PURE__*/_async_to_generator(function(){var e,o;return _ts_generator(this,function(c){switch(c.label){case 0:return[4,t.import("./bundle/LeaderboardAPIMock.js")];case 1:e=c.sent(),o=e.default;return[2,{default:o}]}})}),void 0,t.meta.url)];case 1:o=c.sent().default;if("function"!=typeof o)throw new Error("Cannot load LeaderboardAPIMock");e.mockAPI=new o;return[2]}})})()}},{key:"getLeadersAsync",value:function getLeadersAsync(e,t,o){var c=this;return _async_to_generator(function(){var l,d;return _ts_generator(this,function(h){switch(h.label){case 0:l=t7.params(o);if(!nt.Leaderboards.Enabled)return[3,6];return[4,c.initMockAPI()];case 1:h.sent();if(!("playerIds"in o))return[3,3];return[4,c.mockAPI.getPlayers(e,o)];case 2:d=h.sent();return[3,5];case 3:return[4,c.mockAPI.getLeaders(e,o)];case 4:d=h.sent();h.label=5;case 5:return[3,8];case 6:return[4,ey("".concat(t,"?").concat(l),{},t9)];case 7:d=h.sent();h.label=8;case 8:return[2,t6.hasOwn(d,"data")&&Array.isArray(d.data)?d.data:[]]}})})()}},{key:"getLeaderboardAsync",value:function getLeaderboardAsync(e){var t=this;return _async_to_generator(function(){var o,c;return _ts_generator(this,function(l){switch(l.label){case 0:c="leaderboards/".concat(e);if(!nt.Leaderboards.Enabled)return[3,3];return[4,t.initMockAPI()];case 1:l.sent();return[4,t.mockAPI.getLeaderboardAsync(e)];case 2:o=l.sent();return[3,5];case 3:return[4,ey(c,{},t9)];case 4:o=l.sent(),t6.hasOwn(o,"data")&&t8.isObject(o.data)&&(o=o.data);l.label=5;case 5:return[2,o]}})})()}},{key:"getLeaderboardsAsync",value:function getLeaderboardsAsync(e){var t=this;return _async_to_generator(function(){var c,l;return _ts_generator(this,function(d){switch(d.label){case 0:l=o.Utils.String.params(e);if(!nt.Leaderboards.Enabled)return[3,3];return[4,t.initMockAPI()];case 1:d.sent();return[4,t.mockAPI.getLeaderboardsAsync(e)];case 2:c=d.sent();return[3,5];case 3:return[4,ey("leaderboards?".concat(l),{},t9)];case 4:c=d.sent(),t6.hasOwn(c,"data")&&Array.isArray(c.data)?c=c.data:c=[];d.label=5;case 5:return[2,c]}})})()}},{key:"setLeaderboardScoreAsync",value:function setLeaderboardScoreAsync(e){var t=this;return _async_to_generator(function(){var o,c,l;return _ts_generator(this,function(d){switch(d.label){case 0:o=e.leaderboardId,c=e.playerId,l=e.score;if(!nt.Leaderboards.Enabled)return[3,3];return[4,t.initMockAPI()];case 1:d.sent();return[4,t.mockAPI.setScoreAsync(o,c,l)];case 2:d.sent();return[3,5];case 3:return[4,ef("leaderboards/".concat(o,"/players/").concat(c),{score:l},{},t9)];case 4:d.sent();d.label=5;case 5:return[2]}})})()}},{key:"createLeaderboardAsync",value:function createLeaderboardAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,h,_;return _ts_generator(this,function(y){switch(y.label){case 0:c=null!==(o=e._id)&&void 0!==o?o:t7.generateObjectId(),l=e.numberOfLeaders,d=_object_spread_props(_object_spread({},t1,e),{_id:c,appId:na,numberOfLeaders:l}),h="leaderboards";if(!nt.Leaderboards.Enabled)return[3,3];return[4,t.initMockAPI()];case 1:y.sent();return[4,t.mockAPI.createLeaderboard(d)];case 2:_=y.sent();return[3,5];case 3:return[4,ef(h,d,{},t9)];case 4:_=y.sent(),t6.hasOwn(_,"data")&&t8.isObject(_.data)&&(_=_.data);y.label=5;case 5:if(!t6.hasOwn(_,"_id")||_._id!==c)throw new Error("Create leaderboard failed");return[2,c]}})})()}}]);return mn}();var ns={limit:0,offset:0,leaders:{},isRequesting:!1,amountPlayer:0},ni={leaderboards:{}},no=o.Utils,nc=no.Array,nu=no.Valid,nl=no.Json,nd=no.Object;var nh=/*#__PURE__*/function(e){_inherits(Dn,e);function Dn(){_class_call_check(this,Dn);var e;e=_call_super(this,Dn,arguments);u(e,"lbAPI",new nr);u(e,"configs");return e}_create_class(Dn,[{key:"init",value:function init(){var e=this.game,t=e.storage;t.addStorage("leaderboard",ni),this.configs={}}},{key:"addLeaderboard",value:function addLeaderboard(e){var t=e.name,o=e.type,c=e.leaderboardId,l=e.autoSortRank;if(this.getLeaderboard(t))return;var d="leaderboards/".concat(c,"/");("global"===o||"tournament"===o)&&(d+="leaders"),"friends"===o&&(d+="players"),this.configs[t]={id:c,name:t,type:o,host:d,autoSortRank:l};var h=nl.clone(ns);this.setLeaderboard(t,_object_spread({},h))}},{key:"requestLeaderboardsAsync",value:function requestLeaderboardsAsync(e){var t=this;return _async_to_generator(function(){return _ts_generator(this,function(o){switch(o.label){case 0:o.trys.push([0,2,,3]);return[4,t.lbAPI.getLeaderboardsAsync(e)];case 1:return[2,o.sent()];case 2:o.sent();return[2,[]];case 3:return[2]}})})()}},{key:"requestLeaderboardAsync",value:function requestLeaderboardAsync(e,t){var o=this;return _async_to_generator(function(){var c,l,d,h,_,y,f,p,v,g,m,A,k;return _ts_generator(this,function(b){switch(b.label){case 0:b.trys.push([0,,6,8]);o.validateLeaderboard(e),o.clearLeaderboard(e),o.setLeaderboard(e,{isRequesting:!0});c=o.configs[e],l=c.id,d=c.type,h=c.host;_=[];if("friends"!==d)return[3,2];y=o.game,f=y.player,p=f.getPlayerId(),v=f.getConnectedPlayerIds(t,0),g=[p].concat(_to_consumable_array(v));o.configs[e].playerIds=_to_consumable_array(g);return[4,o.lbAPI.getLeadersAsync(l,h,{playerIds:g})];case 1:_=b.sent();return[3,4];case 2:return[4,o.lbAPI.getLeadersAsync(l,h,{limit:t,offset:0})];case 3:_=b.sent();b.label=4;case 4:if(0===_.length)return[2];return[4,o.receiveLeaderboardAsync(e,_)];case 5:b.sent(),o.setLeaderboard(e,{limit:t,offset:0});return[3,8];case 6:return[4,o.lbAPI.getLeaderboardAsync(o.configs[e].id)];case 7:m=b.sent(),A=m?m.resettable:"",k=m?m.amountPlayer:0;o.setLeaderboard(e,{isRequesting:!1,resettable:A,amountPlayer:k});return[7];case 8:return[2]}})})()}},{key:"loadMoreLeaderboardAsync",value:function loadMoreLeaderboardAsync(e,t){var o=this;return _async_to_generator(function(){var c,l,d,h,_,y,f,p;return _ts_generator(this,function(v){switch(v.label){case 0:c=o.getLeaderboard(e);if(!(c&&"friends"!==o.configs[e].type))return[3,4];v.label=1;case 1:v.trys.push([1,,3,4]);o.setLeaderboard(e,{isRequesting:!0});l=o.configs[e],d=l.id,h=l.host,_=c.offset,y=c.limit,f=_+y;return[4,o.lbAPI.getLeadersAsync(d,h,{limit:t,offset:f})];case 2:p=v.sent();if(0===p.length)return[2];o.receiveLeaderboardAsync(e,p),o.setLeaderboard(e,{limit:t,offset:f});return[3,4];case 3:o.setLeaderboard(e,{isRequesting:!1});return[7];case 4:return[2]}})})()}},{key:"getLeaderboard",value:function getLeaderboard(e){var t=this.game,o=t.storage,c=o.getStorageData("leaderboard","leaderboards");return c[e]?c[e]:null}},{key:"getLeadersByPlayerIdsAsync",value:function getLeadersByPlayerIdsAsync(e,t){var o=this;return _async_to_generator(function(){var c,l,d,h;return _ts_generator(this,function(_){switch(_.label){case 0:_.trys.push([0,2,,3]);o.validateLeaderboard(e);c=o.configs[e],l=c.id,d="leaderboards/".concat(l,"/players");return[4,o.lbAPI.getLeadersAsync(l,d,{playerIds:t})];case 1:h=_.sent();return[2,0===h.length?[]:o.toLeaders(h)];case 2:_.sent();return[2,[]];case 3:return[2]}})})()}},{key:"getLeaderboardResponseAsync",value:function getLeaderboardResponseAsync(e){var t=this;return _async_to_generator(function(){return _ts_generator(this,function(o){switch(o.label){case 0:return[4,t.lbAPI.getLeaderboardAsync(e)];case 1:return[2,o.sent()]}})})()}},{key:"clearLeaderboard",value:function clearLeaderboard(e){try{this.validateLeaderboard(e);var t=nl.clone(ns);this.setLeaderboard(e,null),this.setLeaderboard(e,_object_spread({},t))}catch(e){}}},{key:"isLeaderboardEmpty",value:function isLeaderboardEmpty(e){var t=this.getLeaderboard(e);if(!t)return!0;var o=t.leaders;return 0===Object.keys(o).length}},{key:"isExistLeaderboardId",value:function isExistLeaderboardId(e){var t=this,o=t.configs;return nd.vals(o).some(function(t){return t.id===e})}},{key:"getLeaderboardName",value:function getLeaderboardName(e){var t=this,o=t.configs,c=nc.search(nd.vals(o),function(t){return t.id===e});return c?c.name:null}},{key:"setLeaderboardScoreAsync",value:function setLeaderboardScoreAsync(e,t,o){var c=this;return _async_to_generator(function(){var l,d,h;return _ts_generator(this,function(_){switch(_.label){case 0:_.trys.push([0,3,,4]);c.validateLeaderboard(e);l=c.configs[e],d=l.id;return[4,c.getLastScoreOnLeaderboard(e,t)];case 1:h=_.sent();if(h&&o<=h)return[2];return[4,c.lbAPI.setLeaderboardScoreAsync({leaderboardId:d,playerId:t,score:o})];case 2:_.sent();return[3,4];case 3:_.sent();return[3,4];case 4:return[2]}})})()}},{key:"getLastScoreOnLeaderboard",value:function getLastScoreOnLeaderboard(e,t){var o=this;return _async_to_generator(function(){var c;return _ts_generator(this,function(l){switch(l.label){case 0:return[4,o.getLeadersByPlayerIdsAsync(e,[t])];case 1:c=l.sent();return[2,0===c.length?null:c[0].score]}})})()}},{key:"createLeaderboardAsync",value:function createLeaderboardAsync(e){var t=this;return _async_to_generator(function(){return _ts_generator(this,function(o){return[2,t.lbAPI.createLeaderboardAsync(e)]})})()}},{key:"validateLeaderboard",value:function validateLeaderboard(e){var t=this.getLeaderboard(e);if(!nu.isObject(t))throw new Error("Leaderboard with name ".concat(e," not found"))}},{key:"setLeaderboard",value:function setLeaderboard(e,t){var o=this.game,c=o.storage;c.setStorageData("leaderboard","leaderboards",_define_property({},e,t))}},{key:"receiveLeaderboardAsync",value:function receiveLeaderboardAsync(e,t){var o=this;return _async_to_generator(function(){var c,l,d,h,_,y,f,p,v,g,m,A;return _ts_generator(this,function(k){switch(k.label){case 0:o.validateLeaderboard(e);return[4,o.toLeaders(t)];case 1:l=k.sent().filter(function(e){return e.name&&e.photo}),d=null!==(c=o.getLeaderboard(e))&&void 0!==c?c:{},h=d.offset,_=void 0===h?0:h,y=d.leaders,f=void 0===y?{}:y,p=l.filter(function(e){return!f[e.playerId]});if(_>0&&p.length>0){g=nd.vals(f);(v=p).unshift.apply(v,_to_consumable_array(g))}m=p.sort(function(e,t){return t.score-e.score});o.configs[e].autoSortRank&&(m=m.map(function(e,t){return _object_spread_props(_object_spread({},e),{rank:t+1})}));A=nd.keyBy(m,"playerId");o.setLeaderboard(e,{leaders:A});return[2]}})})()}},{key:"toLeaders",value:function toLeaders(e){var t=this;return _async_to_generator(function(){var o,c,l,d;return _ts_generator(this,function(h){switch(h.label){case 0:o=t.game,c=o.profile,l=e.map(function(e){return e.playerId});return[4,c.requestProfiles(l)];case 1:h.sent();d=c.getProfiles();return[2,e.map(function(e){var t=e.playerId,o=d[t];return o?_object_spread_props(_object_spread({},e),{name:o.name,photo:o.photo}):_object_spread_props(_object_spread({},e),{name:"Nameless",photo:"default"})}).map(function(e){return _object_spread_props(_object_spread({},e),{score:Number.parseInt(e.score,10)})})]}})})()}}]);return Dn}(c.Plugins.BasePlugin);var n_=/*#__PURE__*/function(){function Pn(){_class_call_check(this,Pn);u(this,"APIHost")}_create_class(Pn,[{key:"setAPIHost",value:function setAPIHost(e){this.APIHost=e}},{key:"getAPIHost",value:function getAPIHost(){return this.APIHost}}]);return Pn}();var ny=o.Utils;var nf=/*#__PURE__*/function(e){_inherits(Sn,e);function Sn(){_class_call_check(this,Sn);return _call_super(this,Sn,arguments)}_create_class(Sn,[{key:"createSingleMatchAsync",value:function createSingleMatchAsync(e){var t=this;return _async_to_generator(function(){var o;return _ts_generator(this,function(c){switch(c.label){case 0:return[4,ef("single-matches",e,{},t.getAPIHost())];case 1:o=c.sent();return[2,t.returnValidMatchData(o)]}})})()}},{key:"getSingleMatchDetailAsync",value:function getSingleMatchDetailAsync(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(o){switch(o.label){case 0:return[4,ey("single-matches/active",{},e.getAPIHost())];case 1:t=o.sent();return[2,e.returnValidMatchData(t)]}})})()}},{key:"updateSingleMatchMoveAsync",value:function updateSingleMatchMoveAsync(e,t){var o=this;return _async_to_generator(function(){var c,l;return _ts_generator(this,function(d){switch(d.label){case 0:c="single-matches/".concat(e,"/move");return[4,ef(c,t,{},o.getAPIHost())];case 1:l=d.sent();return[2,o.returnValidMatchData(l)]}})})()}},{key:"finishSingleMatchAsync",value:function finishSingleMatchAsync(e){var t=this;return _async_to_generator(function(){var o,c;return _ts_generator(this,function(l){switch(l.label){case 0:o="single-matches/".concat(e,"/finish");return[4,ef(o,{},{},t.getAPIHost())];case 1:c=l.sent();return[2,t.returnValidMatchData(c)]}})})()}},{key:"createEndlessMatchAsync",value:function createEndlessMatchAsync(e){var t=this;return _async_to_generator(function(){var o;return _ts_generator(this,function(c){switch(c.label){case 0:return[4,ef("endless-matches",e,{},t.getAPIHost())];case 1:o=c.sent();return[2,t.returnValidMatchData(o)]}})})()}},{key:"getEndlessMatchDetailAsync",value:function getEndlessMatchDetailAsync(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(o){switch(o.label){case 0:return[4,ey("endless-matches/active",{},e.getAPIHost())];case 1:t=o.sent();return[2,e.returnValidMatchData(t)]}})})()}},{key:"updateEndlessMatchMilestoneAsync",value:function updateEndlessMatchMilestoneAsync(e,t){var o=this;return _async_to_generator(function(){var c,l;return _ts_generator(this,function(d){switch(d.label){case 0:c="endless-matches/".concat(e,"/milestone");return[4,ef(c,t,{},o.getAPIHost())];case 1:l=d.sent();return[2,o.returnValidMatchData(l)]}})})()}},{key:"finishEndlessMatchAsync",value:function finishEndlessMatchAsync(e){var t=this;return _async_to_generator(function(){var o,c;return _ts_generator(this,function(l){switch(l.label){case 0:o="endless-matches/".concat(e,"/finish");return[4,ef(o,{},{},t.getAPIHost())];case 1:c=l.sent();return[2,t.returnValidMatchData(c)]}})})()}},{key:"createMatchAsync",value:function createMatchAsync(e){var t=this;return _async_to_generator(function(){var o;return _ts_generator(this,function(c){switch(c.label){case 0:return[4,ef("matches",e,{},t.getAPIHost())];case 1:o=c.sent();return[2,t.returnValidMatchData(o)]}})})()}},{key:"joinMatchAsync",value:function joinMatchAsync(e){var t=this;return _async_to_generator(function(){var o,c;return _ts_generator(this,function(l){switch(l.label){case 0:o="matches/".concat(e,"/join");return[4,ef(o,{},{},t.getAPIHost())];case 1:c=l.sent();return[2,t.returnValidMatchData(c)]}})})()}},{key:"getMatchDetailByIdAsync",value:function getMatchDetailByIdAsync(e){var t=this;return _async_to_generator(function(){var o,c;return _ts_generator(this,function(l){switch(l.label){case 0:o="matches/".concat(e);return[4,ey(o,{},t.getAPIHost())];case 1:c=l.sent();return[2,t.returnValidMatchData(c)]}})})()}},{key:"finishMatchAsync",value:function finishMatchAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,h,_,y,f,p,v;return _ts_generator(this,function(g){switch(g.label){case 0:o=e.matchId,c=void 0===o?"":o,l=e.score,d=void 0===l?0:l,h=e.level,_=void 0===h?0:h,y=e.extraData,f=void 0===y?{}:y,p="matches/".concat(c,"/finish");return[4,ef(p,{matchId:c,score:d,level:_,extraData:f},{},t.getAPIHost())];case 1:v=g.sent();return[2,t.returnValidMatchData(v)]}})})()}},{key:"returnValidMatchData",value:function returnValidMatchData(e){var t={};return ny.Valid.isObject(e)&&ny.Object.hasOwn(e,"data")&&(t=e.data),t}}]);return Sn}(n_);var np=/*#__PURE__*/function(){function En(e){_class_call_check(this,En);u(this,"matchAPI");this.createAPI(),this.setAPIConfig(e)}_create_class(En,[{key:"createAPI",value:function createAPI(){this.matchAPI=new nf}},{key:"setAPIConfig",value:function setAPIConfig(e){e.matchAPIHost&&this.matchAPI.setAPIHost(e.matchAPIHost)}},{key:"setMatchAPIInstance",value:function setMatchAPIInstance(e){this.matchAPI=e}},{key:"getMatchAPI",value:function getMatchAPI(){return this.matchAPI}}]);return En}();var nv=/*#__PURE__*/function(){function E(e,t){_class_call_check(this,E);u(this,"game");u(this,"match");this.game=e,this.match=t}_create_class(E,[{key:"startLog",value:function startLog(e){}},{key:"endLog",value:function endLog(){}},{key:"processAsync",value:function processAsync(e){return _async_to_generator(function(){return _ts_generator(this,function(e){throw new Error("Not implemented")})})()}}]);return E}();var ng=/*#__PURE__*/function(e){_inherits(cs,e);function cs(e){_class_call_check(this,cs);var t;t=_call_super(this,cs,[e]),t.name="LevelNotDefined",t.message=null!=e?e:"Level is not defined";return t}return cs}(Y);var nm=/*#__PURE__*/function(e){_inherits(xt,e);function xt(e){_class_call_check(this,xt);var t;t=_call_super(this,xt,[e]),t.name="MatchModeNotDefined",t.message=null!=e?e:"Match id is not defined";return t}return xt}(Y);var nA=o.Utils,nw=(nA.Object,nA.Valid);var nI=/*#__PURE__*/function(){function w(e){_class_call_check(this,w);u(this,"game");u(this,"match");u(this,"nextHandler");this.game=e.game,this.match=e.match,this.nextHandler=null}_create_class(w,[{key:"setNext",value:function setNext(e){return this.nextHandler=e,e}},{key:"processAsync",value:function processAsync(e){var t=this;return _async_to_generator(function(){return _ts_generator(this,function(o){t.logData("Before",e);return[2]})})()}},{key:"nextAsync",value:function nextAsync(e){var t=this;return _async_to_generator(function(){var o;return _ts_generator(this,function(c){switch(c.label){case 0:t.logData("After",e);o=t.nextHandler;if(!o)return[3,2];return[4,t.nextHandler.processAsync(e)];case 1:o=c.sent();c.label=2;case 2:return[2]}})})()}},{key:"logData",value:function logData(e,t){nw.isDebugger()}}]);return w}();var nk=o.Plugins,nb=o.Utils,nS=nk.Analytics,nD=nb.String,nP=nb.Valid;var nE=/*#__PURE__*/function(e){_inherits(j,e);function j(){_class_call_check(this,j);return _call_super(this,j,arguments)}_create_class(j,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(j.prototype),"processAsync",t)};return _async_to_generator(function(){var t,c,l,d,h;return _ts_generator(this,function(_){switch(_.label){case 0:_superprop_get_processAsync().call(o,e);t=e.mode,c=e.customData,l=c.level;o.validateMode(t),o.validateLevel(l);d=o.game,h=d.analytics;h.event(nS.Events.MATCH_START,{level:l,game_mode:nD.toUpperCamelCase(t),level_name:o.getLevelName(l)});return[4,o.nextAsync(e)];case 1:_.sent();return[2]}})})()}},{key:"validateMode",value:function validateMode(e){if(!nP.isString(e))throw new nm}},{key:"validateLevel",value:function validateLevel(e){if(!nP.isNumber(e))throw new ng}},{key:"getLevelName",value:function getLevelName(e){return"Level ".concat(nD.padStart(e.toString(),5,"0"))}}]);return j}(nI);var nx={OPEN:"open",ACTIVE:"active",FINISHED:"finished"};var nC=/*#__PURE__*/function(e){_inherits(L,e);function L(){_class_call_check(this,L);return _call_super(this,L,arguments)}_create_class(L,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(L.prototype),"processAsync",t)};return _async_to_generator(function(){var t,c,l;return _ts_generator(this,function(d){switch(d.label){case 0:_superprop_get_processAsync().call(o,e);t=e.mode,c=e.status;l=null!=t?t:eH.SINGLE;c===nx.FINISHED&&(l=eH.SINGLE),o.contextGameModeDetected(l);return[4,o.nextAsync(e)];case 1:d.sent();return[2]}})})()}},{key:"contextGameModeDetected",value:function contextGameModeDetected(e){var t=this.game,o=t.storage;o.setStorageData("context","contextGameMode",e)}}]);return L}(nI);var nN=/*#__PURE__*/function(e){_inherits(vt,e);function vt(e){_class_call_check(this,vt);var t;t=_call_super(this,vt,[e]),t.name="GetMatchDetailFailed",t.message=null!=e?e:"Get match detail failed";return t}return vt}(_wrap_native_super(Error));var nT=/*#__PURE__*/function(e){_inherits(hs,e);function hs(e){_class_call_check(this,hs);var t;t=_call_super(this,hs,[e]),t.name="MatchAreNotActive",t.message=null!=e?e:"Match are not active";return t}return hs}(_wrap_native_super(Error));var nL=/*#__PURE__*/function(e){_inherits(Z,e);function Z(e){_class_call_check(this,Z);var t;t=_call_super(this,Z,[e]),t.name="MatchIdNotValid",t.message=null!=e?e:"Match id is not valid";return t}return Z}(Y);var nO=/*#__PURE__*/function(e){_inherits(Nn,e);function Nn(e){_class_call_check(this,Nn);var t;t=_call_super(this,Nn,[e]),t.name="OpponentHasFinishedMatch",t.message=e||"Opponent has finished match";return t}return Nn}(_wrap_native_super(Error));var nR=/*#__PURE__*/function(e){_inherits(U,e);function U(e){_class_call_check(this,U);var t;t=_call_super(this,U,[e]),t.name="OpponentIdNotValid",t.message=null!=e?e:"Opponent id is not valid";return t}return U}(Y);var nM=/*#__PURE__*/function(e){_inherits(Ct,e);function Ct(e){_class_call_check(this,Ct);var t;t=_call_super(this,Ct,[e]),t.name="PlayerNotCurrentInMatch",t.message=null!=e?e:"The player is not currently in this match";return t}return Ct}(_wrap_native_super(Error));var nF=/*#__PURE__*/function(e){_inherits(us,e);function us(e){_class_call_check(this,us);var t;t=_call_super(this,us,[e]),t.name="PlayerNotFinishedMatch",t.message=e||"Player not finished match";return t}return us}(_wrap_native_super(Error));var nG=o.Dtos;var nj=/*#__PURE__*/function(e){_inherits(Ln,e);function Ln(){_class_call_check(this,Ln);return _call_super(this,Ln,arguments)}_create_class(Ln,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(Ln.prototype),"processAsync",t)};return _async_to_generator(function(){var t,c;return _ts_generator(this,function(l){switch(l.label){case 0:_superprop_get_processAsync().call(o,e),o.validateMatchData(e);return[4,o.getMatchAsync(e)];case 1:t=l.sent(),c=new nG.Match.Data(t).toObject();o.validateAwaitMatchData(e,c),o.updateMatchData(e,c),o.validateMatchStatus(e),o.validatePlayerTurn(e),o.validateOpponentTurn(e);return[4,o.nextAsync(e)];case 2:l.sent();return[2]}})})()}},{key:"validateMatchData",value:function validateMatchData(e){var t=e.id;if("string"!=typeof t)throw new nL}},{key:"validateMatchStatus",value:function validateMatchStatus(e){var t=e.status;if(t!==nx.ACTIVE)throw new nT}},{key:"validateAwaitMatchData",value:function validateAwaitMatchData(e,t){var o=e.id,c=e.customData,l=t._id,d=t.whitePlayerId,h=t.blackPlayerId;if("string"!=typeof l||l!==o)throw new nN;var _=c.playerId,y=d===_,f=h===_;if(!y&&h===z.playerId)throw new eQ;if(!y&&!f)throw new nM}},{key:"validatePlayerTurn",value:function validatePlayerTurn(e){var t=e.profiles,o=e.customData,c=o.playerId;if("string"!=typeof c)throw new Q;var l=t[c],d=l.finished;if(!d)throw new nF}},{key:"validateOpponentTurn",value:function validateOpponentTurn(e){var t=e.profiles,o=e.customData,c=o.opponentId;if("string"!=typeof c)throw new nR;var l=t[c],d=l.finished;if(d)throw new nO}},{key:"getMatchAsync",value:function getMatchAsync(e){var t=this;return _async_to_generator(function(){var o;return _ts_generator(this,function(c){o=e.id;return[2,o?t.match.api.getMatchAPI().getMatchDetailByIdAsync(o):{}]})})()}},{key:"updateMatchData",value:function updateMatchData(e,t){var o=e.customData,c=t.whitePlayerId,l=t.blackPlayerId,d=t.whitePlayerScore,h=t.blackPlayerScore,_=t.whitePlayerFinish,y=t.blackPlayerFinish,f=t.status;e.status=f;var p=c===o.playerId,v=p?c:l,g=p?l:c;e.customData.playerId=v,e.customData.opponentId=g,e.profiles[v]||(e.profiles[v]={id:v,name:"",photo:"",finished:!1}),e.profiles[g]||(e.profiles[g]={id:g,name:"",photo:"",finished:!1});var m=p?d:h,A=p?h:d;e.profiles[v].score=m,e.profiles[g].score=A;var k=p?_:y,b=p?y:_;e.profiles[v].finished=k,e.profiles[g].finished=b}}]);return Ln}(nI);var nV={level:1,rescued:0,contextId:null,playerId:null,opponentId:null,tournamentId:null,leaderboardId:null};var nB=/*#__PURE__*/function(e){_inherits(B,e);function B(e,t){_class_call_check(this,B);var o;o=_call_super(this,B,[e]);u(o,"payload");o.payload=t;return o}_create_class(B,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(B.prototype),"processAsync",t)};return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:_superprop_get_processAsync().call(o,e),o.initializeMatch(e);return[4,o.nextAsync(e)];case 1:t.sent();return[2]}})})()}},{key:"initializeMatch",value:function initializeMatch(e){var t=this.payload,o=t.id,c=t.mode,l=t.customData;e.id=null!=o?o:null,e.mode=c||null,e.status=nx.OPEN,e.startAt=0,e.finishAt=0,e.profiles={},e.customData=_object_spread({},nV,e.customData,l)}}]);return B}(nI);var nU=eU;var nH=/*#__PURE__*/function(e){_inherits(x,e);function x(e){_class_call_check(this,x);var t;t=_call_super(this,x,[e]),t.name="UnavailableFeature",t.message="Unavailable feature: ".concat(e);return t}return x}(_wrap_native_super(Error));var nK=/*#__PURE__*/function(e){_inherits(q,e);function q(e){_class_call_check(this,q);var t;t=_call_super(this,q,[e]),t.name="ContextIdNotValid",t.message=null!=e?e:"Context id is not valid";return t}return q}(Y);var nW=/*#__PURE__*/function(e){_inherits(Mn,e);function Mn(){_class_call_check(this,Mn);return _call_super(this,Mn,arguments)}_create_class(Mn,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(Mn.prototype),"processAsync",t)};return _async_to_generator(function(){var t;return _ts_generator(this,function(c){switch(c.label){case 0:_superprop_get_processAsync().call(o,e),o.validateData(e);return[4,o.createWideframesAwaitingAsync(e)];case 1:t=c.sent();t&&o.sendMessageAsync(e,t);return[4,o.nextAsync(e)];case 2:c.sent();return[2]}})})()}},{key:"validateData",value:function validateData(e){var t=e.id,o=e.customData,c=o.contextId,l=o.opponentId;if(!t||"string"!=typeof t)throw new nL;if(!c||"string"!=typeof c)throw new nK;if(!l||"string"!=typeof l)throw new nR}},{key:"createWideframesAwaitingAsync",value:function createWideframesAwaitingAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,h,_,y,f,p,v,g,m,A,k,b,D,P;return _ts_generator(this,function(C){switch(C.label){case 0:C.trys.push([0,4,,5]);o=t.game,c=o.frameCapture,l=e.profiles,d=e.customData,h=d.playerId,_=d.opponentId;if(!h||!_)return[2,null];y=l[h],f=l[_],p=y.photo,v=y.score,g=void 0===v?0:v,m=y.finished;if(!m)return[2,null];A=f.photo,k=f.score,b=void 0===k?0:k,D=f.finished;if(!D)return[3,1];P=null;return[3,3];case 1:return[4,c.wideframe.renderResultChallenge({playerId:h,playerPhoto:p,playerScore:g,opponentId:_,opponentPhoto:A,opponentScore:b,isPlayerFinished:!0,isOpponentFinished:!1})];case 2:P=C.sent();C.label=3;case 3:return[2,P];case 4:C.sent();return[2,null];case 5:return[2]}})})()}},{key:"sendMessageAsync",value:function sendMessageAsync(e,t){return _async_to_generator(function(){var o,c,l,d,h,_,y,f;return _ts_generator(this,function(p){switch(p.label){case 0:o=e.id,c=e.profiles,l=e.customData,d=l.playerId,h=l.opponentId;if(!d||"string"!=typeof d)throw new Q;if(!("updateAsync"in GameSDK.extra))throw new nH("updateAsync");_=c[d],y=_.name,f={data:{type:nU.CHALLENGE_FRIEND,matchId:o,playerId:d,opponentId:h},action:"CUSTOM",template:"challenge",cta:{default:"Play",localizations:{vi_VN:"Chơi ngay"}},text:{default:"".concat(y," is waiting for you to finish this game. Play now!"),localizations:{vi_VN:"".concat(y," đang chờ bạn kết th\xfac trận đấu. Chơi ngay!")}},image:t,strategy:"LAST",notification:"PUSH"};return[4,GameSDK.extra.updateAsync(f)];case 1:p.sent();return[2]}})})()}}]);return Mn}(nI);var nz=/*#__PURE__*/function(e){_inherits(N,e);function N(){_class_call_check(this,N);return _call_super(this,N,arguments)}_create_class(N,[{key:"processAsync",value:function processAsync(e){var t=this;return _async_to_generator(function(){return _ts_generator(this,function(o){switch(o.label){case 0:return[4,t.nextAsync(e)];case 1:o.sent();return[2]}})})()}},{key:"nextAsync",value:function nextAsync(e){var t=this;return _async_to_generator(function(){var o;return _ts_generator(this,function(c){switch(c.label){case 0:o=t.nextHandler;if(!o)return[3,2];return[4,t.nextHandler.processAsync(e)];case 1:o=c.sent();c.label=2;case 2:return[2]}})})()}}]);return N}(nI);var nq=/*#__PURE__*/function(e){_inherits(K,e);function K(e){_class_call_check(this,K);var t;t=_call_super(this,K,[e]),t.name="ProfileNotFound",t.message=null!=e?e:"Profile not found";return t}return K}(Y);var nJ=o.Dtos;var nY=/*#__PURE__*/function(e){_inherits(le,e);function le(){_class_call_check(this,le);return _call_super(this,le,arguments)}_create_class(le,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(le.prototype),"processAsync",t)};return _async_to_generator(function(){var t,c,l,d,h,_;return _ts_generator(this,function(y){switch(y.label){case 0:_superprop_get_processAsync().call(o,e),o.validateData(e);t=e.customData,c=t.playerId,l=t.opponentId;d=c;return[4,o.getProfile(d)];case 1:h=y.sent();if(!h)throw new nq;if(o.updateMatchProfile(e,d,h),d=l,d===z.playerId)return[3,3];return[4,o.getProfile(d)];case 2:_=y.sent();if(!_)throw new nq;o.updateMatchProfile(e,d,_);return[3,4];case 3:o.updateMatchProfile(e,d);y.label=4;case 4:return[4,o.nextAsync(e)];case 5:y.sent();return[2]}})})()}},{key:"validateData",value:function validateData(e){var t=e.customData,o=t.playerId,c=t.opponentId;if(!o||"string"!=typeof o)throw new Q;if(!c||"string"!=typeof c)throw new nR}},{key:"getProfile",value:function getProfile(e){var t=this;return _async_to_generator(function(){var o,c;return _ts_generator(this,function(l){switch(l.label){case 0:o=t.game,c=o.profile;return[4,c.requestProfiles([e])];case 1:return[2,(l.sent(),c.getProfiles()[e])]}})})()}},{key:"updateMatchProfile",value:function updateMatchProfile(e,t,o){var c=null!=o?o:z,l=c.name,d=c.photo,h=new nJ.Match.Profile({id:t,name:l,photo:d}).toObject();e.profiles[t]?(e.profiles[t].name=h.name,e.profiles[t].photo=h.photo):e.profiles[t]=h}}]);return le}(nI);var nX=/*#__PURE__*/function(e){_inherits(On,e);function On(){_class_call_check(this,On);return _call_super(this,On,arguments)}_create_class(On,[{key:"processAsync",value:function processAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,_,y,f,p,v,g,m;return _ts_generator(this,function(A){switch(A.label){case 0:A.trys.push([0,,2,3]);t.startLog(e);o=e.matchId,c=e.playerId,l=e.opponentId,d=new nz(t),_=new nB(t,{id:o,mode:h.CHALLENGE_FRIEND,customData:{playerId:c,opponentId:l}});d.setNext(_);y=new nj(t);_.setNext(y);f=new nY(t);y.setNext(f);p=new nW(t);f.setNext(p);v=new nE(t);p.setNext(v);g=new nC(t);v.setNext(g);m=t.match.getMatchState();return[4,d.processAsync(m)];case 1:A.sent();return[3,3];case 2:t.endLog();return[7];case 3:return[2]}})})()}}]);return On}(nv);var nQ=/*#__PURE__*/function(e){_inherits(Nt,e);function Nt(e){_class_call_check(this,Nt);var t;t=_call_super(this,Nt,[e]),t.name="CreateContextFailed",t.message=null!=e?e:"Create context failed";return t}return Nt}(Y);var nZ=o.Utils,n$=nZ.Valid,n0=nZ.Object;var n2=/*#__PURE__*/function(e){_inherits(Rn,e);function Rn(e,t){_class_call_check(this,Rn);var o;o=_call_super(this,Rn,[e]);u(o,"payload");o.payload=t;return o}_create_class(Rn,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(Rn.prototype),"processAsync",t)};return _async_to_generator(function(){var t,c,l;return _ts_generator(this,function(d){switch(d.label){case 0:_superprop_get_processAsync().call(o,e);t=o.payload,c=t.opponentId;return[4,o.createAsync(c)];case 1:l=d.sent();e.customData.contextId=l;return[4,o.nextAsync(e)];case 2:d.sent();return[2]}})})()}},{key:"createAsync",value:function createAsync(e){var t=this;return _async_to_generator(function(){var o,c;return _ts_generator(this,function(l){switch(l.label){case 0:l.trys.push([0,2,,3]);return[4,GameSDK.context.createAsync(e)];case 1:l.sent();return[3,3];case 2:o=l.sent();t.validateError(o);return[3,3];case 3:c=GameSDK.context.getID();if(!n$.isString(c))throw new nQ;return[2,c]}})})()}},{key:"validateError",value:function validateError(e){if(!n0.hasOwn(e,"code"))throw e;if("SAME_CONTEXT"!==e.code){if("INVALID_PARAM"===e.code){if(!this.isNotConnectedPlayerError(e))throw e;return}throw e}}},{key:"validateErrorMessage",value:function validateErrorMessage(e){if(!n0.hasOwn(e,"message")||!n$.isString(e.message))throw e}},{key:"isNotConnectedPlayerError",value:function isNotConnectedPlayerError(e){return this.validateErrorMessage(e),e.message.indexOf("is not a connected player of the current player")>-1}}]);return Rn}(nI);var n3=/*#__PURE__*/function(e){_inherits(Ke,e);function Ke(e){_class_call_check(this,Ke);var t;t=_call_super(this,Ke,[e]),t.name="MatchAreNotOpen",t.message=null!=e?e:"Match are not open";return t}return Ke}(Y);var n1=o.Dtos;var n4=/*#__PURE__*/function(e){_inherits(fs,e);function fs(e,t){_class_call_check(this,fs);var o;o=_call_super(this,fs,[e]);u(o,"payload");o.payload=t;return o}_create_class(fs,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(fs.prototype),"processAsync",t)};return _async_to_generator(function(){var t,c;return _ts_generator(this,function(l){switch(l.label){case 0:_superprop_get_processAsync().call(o,e),o.validateData(e);return[4,o.createMatchAsync(e)];case 1:t=l.sent(),c=new n1.Match.Data(t).toObject();o.updateMatchState(e,c);return[4,o.nextAsync(e)];case 2:l.sent();return[2]}})})()}},{key:"validateData",value:function validateData(e){var t=e.status,o=e.customData,c=o.opponentId;if("string"!=typeof c)throw new nR;if(t!==nx.OPEN)throw new n3}},{key:"createMatchAsync",value:function createMatchAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,h;return _ts_generator(this,function(_){o=e.customData,c=o.opponentId,l=t.payload,d=l.extraData;if(!c)return[2,{}];h={opponentPlayerId:c,extraData:d};return[2,t.match.api.getMatchAPI().createMatchAsync(h)]})})()}},{key:"updateMatchState",value:function updateMatchState(e,t){var o=e.customData,c=t._id,l=t.whitePlayerId,d=t.blackPlayerId,h=t.whitePlayerFinish,_=t.blackPlayerFinish,y=l===o.opponentId;e.id=c||null;var f=y?d:l,p=y?l:d;e.customData.playerId=f,e.customData.opponentId=p,e.profiles[f]||(e.profiles[f]={id:f,name:"",photo:"",finished:!1}),e.profiles[p]||(e.profiles[p]={id:p,name:"",photo:"",finished:!1});var v=y?_:h,g=y?h:_;e.profiles[f].finished=v,e.profiles[p].finished=g}}]);return fs}(nI);var n5=/*#__PURE__*/function(e){_inherits(J,e);function J(){_class_call_check(this,J);return _call_super(this,J,arguments)}_create_class(J,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(J.prototype),"processAsync",t)};return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:if(_superprop_get_processAsync().call(o,e),e.status!==nx.OPEN)throw new n3;o.startMatch(e);return[4,o.nextAsync(e)];case 1:t.sent();return[2]}})})()}},{key:"startMatch",value:function startMatch(e){e.status=nx.ACTIVE,e.startAt=Date.now()}}]);return J}(nI);var n6=/*#__PURE__*/function(e){_inherits(gs,e);function gs(){_class_call_check(this,gs);return _call_super(this,gs,arguments)}_create_class(gs,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(gs.prototype),"processAsync",t)};return _async_to_generator(function(){var t;return _ts_generator(this,function(c){switch(c.label){case 0:_superprop_get_processAsync().call(o,e),o.validateData(e);return[4,o.createWideframesChallengeAsync(e)];case 1:t=c.sent();t&&o.sendMessageAsync(e,t);return[4,o.nextAsync(e)];case 2:c.sent();return[2]}})})()}},{key:"validateData",value:function validateData(e){var t=e.id,o=e.customData,c=o.contextId,l=o.opponentId;if(!t||"string"!=typeof t)throw new nL;if(!c||"string"!=typeof c)throw new nK;if(!l||"string"!=typeof l)throw new nR}},{key:"createWideframesChallengeAsync",value:function createWideframesChallengeAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,h,_,y,f,p,v,g,m,A,k;return _ts_generator(this,function(b){switch(b.label){case 0:b.trys.push([0,2,,3]);o=t.game,c=o.frameCapture,l=e.profiles,d=e.customData,h=d.playerId,_=d.opponentId;if(!h||!_)return[2,null];y=l[h],f=l[_],p=y.photo,v=y.score,g=void 0===v?0:v,m=f.photo,A=f.score,k=void 0===A?0:A;return[4,c.wideframe.renderResultChallenge({playerId:h,playerPhoto:p,playerScore:g,opponentId:_,opponentPhoto:m,opponentScore:k,isPlayerFinished:!1,isOpponentFinished:!1})];case 1:return[2,b.sent()];case 2:b.sent();return[2,null];case 3:return[2]}})})()}},{key:"sendMessageAsync",value:function sendMessageAsync(e,t){return _async_to_generator(function(){var o,c,l,d,h,_,y,f;return _ts_generator(this,function(p){switch(p.label){case 0:o=e.id,c=e.profiles,l=e.customData,d=l.playerId,h=l.opponentId;if(!d||"string"!=typeof d)throw new Q;if(!("updateAsync"in GameSDK.extra))throw new nH("updateAsync");_=c[d],y=_.name,f={data:{type:nU.CHALLENGE_FRIEND,matchId:o,playerId:d,opponentId:h},action:"CUSTOM",template:"challenge",cta:{default:"Play",localizations:{vi_VN:"Chơi ngay"}},text:{default:"".concat(y," challenges you"),localizations:{vi_VN:"".concat(y," thử th\xe1ch bạn trong trận đấu n\xe0y. Chơi ngay!")}},image:t,strategy:"IMMEDIATE",notification:"PUSH"};return[4,GameSDK.extra.updateAsync(f)];case 1:p.sent();return[2]}})})()}}]);return gs}(nI);var n7=/*#__PURE__*/function(e){_inherits(Gn,e);function Gn(){_class_call_check(this,Gn);return _call_super(this,Gn,arguments)}_create_class(Gn,[{key:"processAsync",value:function processAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,_,y,f,p,v,g,m,A;return _ts_generator(this,function(k){switch(k.label){case 0:k.trys.push([0,,2,3]);t.startLog(e);o=e.playerId,c=e.opponentId,l=new nz(t),d=new n2(t,{opponentId:c});l.setNext(d);_=new nB(t,{mode:h.CHALLENGE_FRIEND,customData:{playerId:o,opponentId:c}});d.setNext(_);y=new n4(t,{extraData:e.extraData});_.setNext(y);f=new nY(t);y.setNext(f);p=new n5(t);f.setNext(p);v=new nE(t);p.setNext(v);g=new n6(t);v.setNext(g);m=new nC(t);g.setNext(m);A=t.match.getMatchState();return[4,l.processAsync(A)];case 1:k.sent();return[3,3];case 2:t.endLog();return[7];case 3:return[2]}})})()}}]);return Gn}(nv);var n8=/*#__PURE__*/function(e){_inherits(Tt,e);function Tt(e){_class_call_check(this,Tt);var t;t=_call_super(this,Tt,[e]),t.name="SameContext",t.message=null!=e?e:"Same context";return t}return Tt}(_wrap_native_super(Error));var n9=o.Utils;var ae=/*#__PURE__*/function(e){_inherits(We,e);function We(e,t){_class_call_check(this,We);var o;o=_call_super(this,We,[e]);u(o,"payload");o.payload=t;return o}_create_class(We,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(We.prototype),"processAsync",t)};return _async_to_generator(function(){var t,c;return _ts_generator(this,function(l){switch(l.label){case 0:_superprop_get_processAsync().call(o,e);t=o.payload,c=t.contextId;return[4,o.switchAsync(c)];case 1:l.sent(),e.customData.contextId=c;return[4,o.nextAsync(e)];case 2:l.sent();return[2]}})})()}},{key:"checkSameContext",value:function checkSameContext(e){var t="SOLO"===e,o=GameSDK.context.getID();if(o===e)throw new n8;if(t&&null===o)throw new n8}},{key:"switchAsync",value:function switchAsync(e){var t=this;return _async_to_generator(function(){var o,c;return _ts_generator(this,function(l){switch(l.label){case 0:o="SOLO"===e;l.label=1;case 1:l.trys.push([1,3,,4]);t.checkSameContext(e);return[4,GameSDK.context.switchAsync(e,o)];case 2:l.sent();return[3,4];case 3:c=l.sent();if(_instanceof(c,n8))return[2];if(!n9.Object.hasOwn(c,"code"))throw c;if(n9.Device.isAndroid()&&o&&"INVALID_PARAM"===c.code)return[2];if("SAME_CONTEXT"!==c.code)throw c;return[3,4];case 4:return[2]}})})()}}]);return We}(nI);var at=o.Dtos;var an=/*#__PURE__*/function(e){_inherits(kn,e);function kn(){_class_call_check(this,kn);return _call_super(this,kn,arguments)}_create_class(kn,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(kn.prototype),"processAsync",t)};return _async_to_generator(function(){var t,c;return _ts_generator(this,function(l){switch(l.label){case 0:_superprop_get_processAsync().call(o,e),o.validateMatchData(e);return[4,o.getMatchAsync(e)];case 1:t=l.sent(),c=new at.Match.Data(t).toObject();o.validateContinueMatchData(e,c),o.updateMatchData(e,c),o.validatePlayerTurn(e);return[4,o.nextAsync(e)];case 2:l.sent();return[2]}})})()}},{key:"validateMatchData",value:function validateMatchData(e){var t=e.id,o=e.status;if("string"!=typeof t)throw new nL;if(o!==nx.OPEN)throw new n3}},{key:"validateContinueMatchData",value:function validateContinueMatchData(e,t){var o=e.id,c=e.customData,l=t._id,d=t.whitePlayerId,h=t.blackPlayerId;if("string"!=typeof l||l!==o)throw new nN;var _=c.playerId,y=d===_,f=h===_;if(!y&&h===z.playerId)throw new eQ;if(!y&&!f)throw new nM}},{key:"validatePlayerTurn",value:function validatePlayerTurn(e){var t=e.profiles,o=e.customData,c=o.playerId;if("string"!=typeof c)throw new Q;var l=t[c],d=l.finished;if(d)throw new eX}},{key:"getMatchAsync",value:function getMatchAsync(e){var t=this;return _async_to_generator(function(){var o;return _ts_generator(this,function(c){o=e.id;return[2,o?t.match.api.getMatchAPI().getMatchDetailByIdAsync(o):{}]})})()}},{key:"updateMatchData",value:function updateMatchData(e,t){var o=e.customData,c=t.whitePlayerId,l=t.blackPlayerId,d=t.whitePlayerScore,h=t.blackPlayerScore,_=t.whitePlayerFinish,y=t.blackPlayerFinish,f=c===o.playerId,p=f?c:l,v=f?l:c;e.customData.playerId=p,e.customData.opponentId=v,e.profiles[p]||(e.profiles[p]={id:p,name:"",photo:"",finished:!1}),e.profiles[v]||(e.profiles[v]={id:v,name:"",photo:"",finished:!1});var g=f?d:h,m=f?h:d;e.profiles[p].score=g,e.profiles[v].score=m;var A=f?_:y,k=f?y:_;e.profiles[p].finished=A,e.profiles[v].finished=k}}]);return kn}(nI);var aa=/*#__PURE__*/function(e){_inherits(Vn,e);function Vn(){_class_call_check(this,Vn);return _call_super(this,Vn,arguments)}_create_class(Vn,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(Vn.prototype),"processAsync",t)};return _async_to_generator(function(){var t;return _ts_generator(this,function(c){switch(c.label){case 0:_superprop_get_processAsync().call(o,e),o.validateData(e);return[4,o.createWideframesCurrentScoreAsync()];case 1:t=c.sent();t&&o.sendMessageAsync(e,t);return[4,o.nextAsync(e)];case 2:c.sent();return[2]}})})()}},{key:"validateData",value:function validateData(e){var t=e.id,o=e.customData,c=o.contextId,l=o.opponentId;if(!t||"string"!=typeof t)throw new nL;if(!c||"string"!=typeof c)throw new nK;if(!l||"string"!=typeof l)throw new nR}},{key:"createWideframesCurrentScoreAsync",value:function createWideframesCurrentScoreAsync(){var e=this;return _async_to_generator(function(){var t,o,c,l,d,h,_,y,f,p,v;return _ts_generator(this,function(g){switch(g.label){case 0:g.trys.push([0,2,,3]);t=e.game,o=t.player,c=t.frameCapture,l=o.getPlayer(),d=l.playerId,h=l.photo,_=e.match.getMatchState(),y=_.profiles,f=y[d]||{},p=f.score,v=void 0===p?0:p;return[4,c.wideframe.renderShareScore({playerId:d,playerPhoto:h,playerScore:v})];case 1:return[2,g.sent()];case 2:g.sent();return[2,null];case 3:return[2]}})})()}},{key:"sendMessageAsync",value:function sendMessageAsync(e,t){return _async_to_generator(function(){var o,c,l,d,h,_,y,f;return _ts_generator(this,function(p){switch(p.label){case 0:o=e.id,c=e.profiles,l=e.customData,d=l.playerId,h=l.opponentId;if(!d||"string"!=typeof d)throw new Q;if(!("updateAsync"in GameSDK.extra))throw new nH("updateAsync");_=c[d],y=_.name,f={data:{type:nU.CHALLENGE_FRIEND,matchId:o,playerId:d,opponentId:h},action:"CUSTOM",template:"challenge",cta:{default:"Play",localizations:{vi_VN:"Chơi ngay"}},text:{default:"".concat(y," made an update."),localizations:{vi_VN:"".concat(y," đ\xe3 cập nhật trận đấu. Chơi ngay!")}},image:t,strategy:"LAST",notification:"PUSH"};if(!("updateAsync"in GameSDK.extra))throw new nH("updateAsync");return[4,GameSDK.extra.updateAsync(f)];case 1:p.sent();return[2]}})})()}}]);return Vn}(nI);var ar=/*#__PURE__*/function(e){_inherits(Un,e);function Un(){_class_call_check(this,Un);return _call_super(this,Un,arguments)}_create_class(Un,[{key:"processAsync",value:function processAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,_,y,f,p,v,g,m,A,k,b;return _ts_generator(this,function(D){switch(D.label){case 0:D.trys.push([0,,2,3]);t.startLog(e);o=e.contextId,c=e.matchId,l=e.playerId,d=e.opponentId,_=new nz(t),y=new ae(t,{contextId:o});_.setNext(y);f=new nB(t,{id:c,mode:h.CHALLENGE_FRIEND,customData:{playerId:l,opponentId:d}});y.setNext(f);p=new an(t);f.setNext(p);v=new nY(t);p.setNext(v);g=new n5(t);v.setNext(g);m=new aa(t);g.setNext(m);A=new nE(t);m.setNext(A);k=new nC(t);A.setNext(k);b=t.match.getMatchState();return[4,_.processAsync(b)];case 1:D.sent();return[3,3];case 2:t.endLog();return[7];case 3:return[2]}})})()}}]);return Un}(nv);var as=o.Plugins,ai=o.Utils,ao=as.Analytics,ac=ai.String,au=ai.Valid;var al=/*#__PURE__*/function(e){_inherits(Oe,e);function Oe(){_class_call_check(this,Oe);return _call_super(this,Oe,arguments)}_create_class(Oe,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(Oe.prototype),"processAsync",t)};return _async_to_generator(function(){var t,c,l,d,h,_,y,f;return _ts_generator(this,function(p){switch(p.label){case 0:_superprop_get_processAsync().call(o,e);t=e.customData,c=e.mode,l=e.startAt,d=e.finishAt,h=t.level;o.validateMode(c),o.validateLevel(h);_=o.game,y=_.analytics,f=Math.floor((d-l)/1e3);y.event(ao.Events.MATCH_END,{level:h,game_mode:ac.toUpperCamelCase(c),level_name:o.getLevelName(h),time_played:f});return[4,o.nextAsync(e)];case 1:p.sent();return[2]}})})()}},{key:"validateMode",value:function validateMode(e){if(!au.isString(e))throw new nm}},{key:"validateLevel",value:function validateLevel(e){if(!au.isNumber(e))throw new ng}},{key:"getLevelName",value:function getLevelName(e){return"Level ".concat(ac.padStart(e.toString(),5,"0"))}}]);return Oe}(nI);var ad=/*#__PURE__*/function(e){_inherits(ze,e);function ze(e){_class_call_check(this,ze);var t;t=_call_super(this,ze,[e]),t.name="ScoreNotValid",t.message=null!=e?e:"Score is not valid";return t}return ze}(_wrap_native_super(Error));var ah=/*#__PURE__*/function(e){_inherits(Re,e);function Re(e){_class_call_check(this,Re);var t;t=_call_super(this,Re,[e]),t.name="LeaderboardIdNotValid",t.message=null!=e?e:"Leaderboard id is not valid";return t}return Re}(_wrap_native_super(Error));var a_=/*#__PURE__*/function(e){_inherits(Kn,e);function Kn(e){_class_call_check(this,Kn);var t;t=_call_super(this,Kn,[e]),t.name="LeaderboardNotExist",t.message=null!=e?e:"Leaderboard not exist in game";return t}return Kn}(_wrap_native_super(Error));var ay=o.Utils,af=ay.Valid;var ap=/*#__PURE__*/function(e){_inherits(qe,e);function qe(e,t){_class_call_check(this,qe);var o;o=_call_super(this,qe,[e]);u(o,"payload");u(o,"leaderboardPayload");o.payload=t;return o}_create_class(qe,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(qe.prototype),"processAsync",t)};return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:_superprop_get_processAsync().call(o,e),o.setupSetScorePayload(e),o.setLeaderboardScoreAsync();return[4,o.nextAsync(e)];case 1:t.sent();return[2]}})})()}},{key:"setupSetScorePayload",value:function setupSetScorePayload(e){var t=this;return _async_to_generator(function(){var o,c,l,d,h,_;return _ts_generator(this,function(y){o=e.profiles,c=e.customData,l=c.playerId;if(!l||!o[l])throw new nq;d=t.payload,h=d.score,_=d.leaderboardId;if(!af.isNumber(h))throw new ad;if(!af.isString(_))throw new ah;t.leaderboardPayload={score:h,playerId:l,leaderboardId:_};return[2]})})()}},{key:"setLeaderboardScoreAsync",value:function setLeaderboardScoreAsync(){var e=this;return _async_to_generator(function(){var t,o,c,l,d;return _ts_generator(this,function(h){switch(h.label){case 0:h.trys.push([0,2,,3]);t=e.leaderboardPayload,o=t.playerId,c=t.score,l=t.leaderboardId,d=e.game.leaderboard.getLeaderboardName(l);if(!d)throw new a_;return[4,e.game.leaderboard.setLeaderboardScoreAsync(d,o,c)];case 1:h.sent();return[3,3];case 2:h.sent();return[3,3];case 3:return[2]}})})()}}]);return qe}(nI);var av=o.Utils,ag=av.Valid,am=o.Configs,aA=am.Leaderboards;var aw=/*#__PURE__*/function(e){_inherits(Lt,e);function Lt(e){_class_call_check(this,Lt);var t;var o=globalThis.game,c=o.player,l=c.getBestScore();t=_call_super(this,Lt,[e,{score:l,leaderboardId:aA.LeaderboardId}]),"submitGameResultsAsync"in GameSDK.extra&&GameSDK.extra.submitGameResultsAsync(l);return t}_create_class(Lt,[{key:"setupSetScorePayload",value:function setupSetScorePayload(e){var t=this;var o=this,_superprop_get_setupSetScorePayload=function(){return _get(_get_prototype_of(Lt.prototype),"setupSetScorePayload",t)};return _async_to_generator(function(){var t,c,l,d,h;return _ts_generator(this,function(_){t=e.profiles,c=e.customData,l=c.playerId;if(!l||!t[l])throw new nq;d=t[l],h=d.score;if(!ag.isNumber(h))throw new ad;o.payload.score=h,_superprop_get_setupSetScorePayload().call(o,e);return[2]})})()}}]);return Lt}(ap);var aI=o.Dtos,ak=o.Utils,ab=ak.Valid,aS=ak.Object;var aD=/*#__PURE__*/function(e){_inherits(Fe,e);function Fe(e,t){_class_call_check(this,Fe);var o;o=_call_super(this,Fe,[e]);u(o,"payload");o.payload=t;return o}_create_class(Fe,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(Fe.prototype),"processAsync",t)};return _async_to_generator(function(){var t,c,l,d;return _ts_generator(this,function(h){switch(h.label){case 0:_superprop_get_processAsync().call(o,e),o.validateMatchData(e);t=o.payload,c=t.useAPI;if(!c)return[3,2];return[4,o.finishMatchAsync(e)];case 1:l=h.sent(),d=new aI.Match.Data(l).toObject();o.updateMatchFromAPI(e,d);return[3,3];case 2:o.updateMatchData(e);h.label=3;case 3:o.updateMatchState(e);return[4,o.nextAsync(e)];case 4:h.sent();return[2]}})})()}},{key:"validateMatchData",value:function validateMatchData(e){var t=e.status,o=e.profiles,c=e.customData;if(t!==nx.ACTIVE)throw new nT;var l=c.playerId;if(!l||!aS.hasOwn(o,l))throw new nM}},{key:"updateMatchData",value:function updateMatchData(e){var t=e.customData,o=t.playerId;if(!ab.isString(o))throw new Q;e.profiles[o].finished=!0}},{key:"updateMatchState",value:function updateMatchState(e){e.status=nx.FINISHED,e.finishAt=Date.now()}},{key:"finishMatchAsync",value:function finishMatchAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,h,_,y,f,p,v;return _ts_generator(this,function(g){o=e.id,c=e.profiles,l=e.customData,d=l.level,h=l.playerId;if(!ab.isString(h))throw new Q;_=c[h],y=_.score,f=t.payload,p=f.extraData,v={matchId:null!=o?o:"",score:y,level:d,extraData:p};return[2,t.match.api.getMatchAPI().finishMatchAsync(v)]})})()}},{key:"updateMatchFromAPI",value:function updateMatchFromAPI(e,t){var o=e.customData,c=o.playerId,l=o.opponentId;if(!ab.isString(c))throw new Q;if(!ab.isString(l))throw new nR;var d=t.whitePlayerId,h=t.whitePlayerScore,_=t.blackPlayerScore,y=t.whitePlayerFinish,f=t.blackPlayerFinish,p=c===d,v=p?h:_,g=p?_:h,m=p?y:f,A=p?f:y;e.profiles[c].score=v,e.profiles[l].score=g,e.profiles[c].finished=m,e.profiles[l].finished=A}}]);return Fe}(nI);var aP=/*#__PURE__*/function(e){_inherits(Qn,e);function Qn(){_class_call_check(this,Qn);return _call_super(this,Qn,arguments)}_create_class(Qn,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(Qn.prototype),"processAsync",t)};return _async_to_generator(function(){var t;return _ts_generator(this,function(c){switch(c.label){case 0:_superprop_get_processAsync().call(o,e),o.validateData(e);return[4,o.createWideframesResultAsync(e)];case 1:t=c.sent();t&&o.progressSendFinishedMessage(e,t);return[4,o.nextAsync(e)];case 2:c.sent();return[2]}})})()}},{key:"validateData",value:function validateData(e){var t=e.id,o=e.customData,c=o.contextId,l=o.opponentId;if(!t||"string"!=typeof t)throw new nL;if(!c||"string"!=typeof c)throw new nK;if(!l||"string"!=typeof l)throw new nR}},{key:"createWideframesResultAsync",value:function createWideframesResultAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,h,_,y,f,p,v,g,m,A,k,b,D;return _ts_generator(this,function(P){switch(P.label){case 0:P.trys.push([0,2,,3]);o=t.game,c=o.frameCapture,l=e.profiles,d=e.customData,h=d.playerId,_=d.opponentId;if(!h||!_)return[2,null];y=l[h],f=l[_],p=y.photo,v=y.score,g=void 0===v?0:v,m=y.finished,A=f.photo,k=f.score,b=void 0===k?0:k,D=f.finished;return[4,c.wideframe.renderResultChallenge({playerId:h,playerPhoto:p,playerScore:g,opponentId:_,opponentPhoto:A,opponentScore:b,isPlayerFinished:!!m,isOpponentFinished:!!D})];case 1:return[2,P.sent()];case 2:P.sent();return[2,null];case 3:return[2]}})})()}},{key:"progressSendFinishedMessage",value:function progressSendFinishedMessage(e,t){var o=e.profiles,c=e.customData,l=c.playerId,d=c.opponentId;if(!l||"string"!=typeof l)throw new Q;if(!d||"string"!=typeof d)throw new nR;var h=o[l],_=h.score,y=void 0===_?0:_,f=h.finished,p=o[d],v=p.score,g=void 0===v?0:v,m=p.finished;f?this.sendFinishMessageAsync(e,t):m&&y>g?this.sendBestScoreMessageAsync(e,t):this.sendPlayTurnMessageAsync(e,t)}},{key:"sendFinishMessageAsync",value:function sendFinishMessageAsync(e,t){return _async_to_generator(function(){var o,c,l,d,h,_,y,f;return _ts_generator(this,function(p){switch(p.label){case 0:o=e.id,c=e.profiles,l=e.customData,d=l.playerId,h=l.opponentId;if(!d||"string"!=typeof d)throw new Q;if(!("updateAsync"in GameSDK.extra))throw new nH("updateAsync");_=c[d],y=_.name,f={data:{type:nU.CHALLENGE_FRIEND,matchId:o,playerId:d,opponentId:h,status:nx.FINISHED},action:"CUSTOM",template:"finished",cta:{default:"See result",localizations:{vi_VN:"Xem kết quả"}},text:{default:"".concat(y," just finished. Check them now."),localizations:{vi_VN:"".concat(y," vừa ho\xe0n th\xe0nh m\xe0n chơi. Nhấn để xem kết quả trận đấu.")}},image:t,strategy:"IMMEDIATE",notification:"PUSH"};if(!("updateAsync"in GameSDK.extra))throw new nH("updateAsync");return[4,GameSDK.extra.updateAsync(f)];case 1:p.sent();return[2]}})})()}},{key:"sendPlayTurnMessageAsync",value:function sendPlayTurnMessageAsync(e,t){return _async_to_generator(function(){var o,c,l,d,h,_,y,f,p;return _ts_generator(this,function(v){switch(v.label){case 0:o=e.id,c=e.profiles,l=e.customData,d=l.playerId,h=l.opponentId;if(!d||"string"!=typeof d)throw new Q;_=c[d],y=_.name,f=_.score,p={data:{type:nU.CHALLENGE_FRIEND,matchId:o,playerId:d,opponentId:h,status:nx.ACTIVE},action:"CUSTOM",template:"finished",cta:{default:"Play",localizations:{vi_VN:"Chơi ngay"}},text:{default:"".concat(y," got ").concat(f," scores. So easy! Can you?"),localizations:{vi_VN:"".concat(y," đ\xe3 đạt ").concat(f," điểm! Nhấn Chơi để so t\xe0i!")}},image:t,strategy:"IMMEDIATE",notification:"PUSH"};if(!("updateAsync"in GameSDK.extra))throw new nH("updateAsync");return[4,GameSDK.extra.updateAsync(p)];case 1:v.sent();return[2]}})})()}},{key:"sendBestScoreMessageAsync",value:function sendBestScoreMessageAsync(e,t){return _async_to_generator(function(){var o,c,l,d,h,_,y,f,p;return _ts_generator(this,function(v){switch(v.label){case 0:o=e.id,c=e.profiles,l=e.customData,d=l.playerId,h=l.opponentId;if(!d||"string"!=typeof d)throw new Q;_=c[d],y=_.name,f=_.score,p={data:{type:nU.CHALLENGE_FRIEND,matchId:o,playerId:d,opponentId:h,status:nx.FINISHED},action:"CUSTOM",template:"pass_score",cta:{default:"See result",localizations:{vi_VN:"Xem kết quả"}},text:{default:"".concat(y," beat your high score. Their score: ").concat(f),localizations:{vi_VN:"".concat(y," đ\xe3 vượt qua điểm số của bạn, với ").concat(f," điểm!")}},image:t,strategy:"IMMEDIATE",notification:"PUSH"};if(!("updateAsync"in GameSDK.extra))throw new nH("updateAsync");return[4,GameSDK.extra.updateAsync(p)];case 1:v.sent();return[2]}})})()}}]);return Qn}(nI);var aE=/*#__PURE__*/function(e){_inherits(Ye,e);function Ye(){_class_call_check(this,Ye);return _call_super(this,Ye,arguments)}_create_class(Ye,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(Ye.prototype),"processAsync",t)};return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:_superprop_get_processAsync().call(o,e),o.setPlayerBestScore(e);return[4,o.nextAsync(e)];case 1:t.sent();return[2]}})})()}},{key:"setPlayerBestScore",value:function setPlayerBestScore(e){var t=e.profiles,o=e.customData,c=o.playerId;if(!c||!t[c])throw new nq;var l=this.game,d=l.player,h=d.getBestScore()||0,_=t[c],y=_.score,f=void 0===y?0:y;f<=h||(d.setBestScore(f),t[c].bestScore=f)}}]);return Ye}(nI);var ax=/*#__PURE__*/function(e){_inherits(Xn,e);function Xn(){_class_call_check(this,Xn);return _call_super(this,Xn,arguments)}_create_class(Xn,[{key:"processAsync",value:function processAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,h,_,y,f,p,v;return _ts_generator(this,function(g){switch(g.label){case 0:g.trys.push([0,,2,3]);t.startLog(e);o=null!=e?e:{},c=o.extraData,l=new nz(t),d=new aD(t,{useAPI:!0,extraData:c});l.setNext(d);h=new aP(t);d.setNext(h);_=new al(t);h.setNext(_);y=new aE(t);_.setNext(y);f=new aw(t);y.setNext(f);p=new nC(t);f.setNext(p);v=t.match.getMatchState();return[4,l.processAsync(v)];case 1:g.sent();return[3,3];case 2:t.endLog();return[7];case 3:return[2]}})})()}}]);return Xn}(nv);var aC=/*#__PURE__*/function(e){_inherits(Zn,e);function Zn(e){_class_call_check(this,Zn);var t;t=_call_super(this,Zn,[e]),t.name="ContextAreSolo",t.message=null!=e?e:"Context are solo";return t}return Zn}(_wrap_native_super(Error));var aN=/*#__PURE__*/function(e){_inherits(ei,e);function ei(e){_class_call_check(this,ei);var t;t=_call_super(this,ei,[e]),t.name="ContextNotChallenge",t.message=null!=e?e:"Context is not a challenge";return t}return ei}(_wrap_native_super(Error));var aT=/*#__PURE__*/function(e){_inherits(ti,e);function ti(e){_class_call_check(this,ti);var t;t=_call_super(this,ti,[e]),t.name="NetworkFailure",t.message=null!=e?e:"Network failure";return t}return ti}(_wrap_native_super(Error));var aL=o.Utils,aO=o.Dtos,aR=aL.Array,aM=aL.Object;var aF=/*#__PURE__*/function(e){_inherits(Ds,e);function Ds(e,t){_class_call_check(this,Ds);var o;o=_call_super(this,Ds,[e]);u(o,"payload");o.payload=t;return o}_create_class(Ds,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(Ds.prototype),"processAsync",t)};return _async_to_generator(function(){var t;return _ts_generator(this,function(c){switch(c.label){case 0:_superprop_get_processAsync().call(o,e),o.checkCurrentContext();return[4,o.getOpponentIdFromContextAsync()];case 1:t=c.sent();e.customData.opponentId=t;return[4,o.nextAsync(e)];case 2:c.sent();return[2]}})})()}},{key:"checkCurrentContext",value:function checkCurrentContext(){var e=GameSDK.context.getID();if("string"!=typeof e)throw new nK;if("SOLO"===e)throw new aC}},{key:"getOpponentIdFromContextAsync",value:function getOpponentIdFromContextAsync(){var e=this;return _async_to_generator(function(){var t,o,c,l;return _ts_generator(this,function(d){switch(d.label){case 0:t=e.payload,o=t.ignoreId;return[4,e.getContextPlayers([o])];case 1:c=d.sent();if(c.length>1)throw new aN;l=z;return[2,(1===c.length&&(l=c[0]),l.playerId)]}})})()}},{key:"getContextPlayers",value:function getContextPlayers(e){return _async_to_generator(function(){var t,o,c,l,d,h,_,y,f,p,v,g;return _ts_generator(this,function(m){switch(m.label){case 0:m.trys.push([0,2,,3]);return[4,GameSDK.context.getPlayersAsync()];case 1:t=m.sent(),o=[];c=true,l=false,d=void 0;try{for(h=t[Symbol.iterator]();!(c=(_=h.next()).done);c=true){y=_.value;f=y.getID();if(!(e.indexOf(f)>-1)){p=y.getName();if(!!p){v=y.getPhoto();o.push(new aO.Player.Info({playerId:f,name:p,photo:v}).toObject())}}}}catch(e){l=true;d=e}finally{try{if(!c&&null!=h.return)h.return()}finally{if(l)throw d}}return[2,aR.unique(o)];case 2:g=m.sent();if(aM.hasOwn(g,"code")&&"NETWORK_FAILURE"===g.code)throw new aT;return[2,[]];case 3:return[2]}})})()}}]);return Ds}(nI);var aG=/*#__PURE__*/function(e){_inherits(Mt,e);function Mt(e){_class_call_check(this,Mt);var t;t=_call_super(this,Mt,[e]),t.name="ContextIsTournament",t.message=null!=e?e:"Context is a tournament";return t}return Mt}(_wrap_native_super(Error));var aj=o.Utils,aV=aj.Object;var aB=/*#__PURE__*/function(e){_inherits(oi,e);function oi(){_class_call_check(this,oi);return _call_super(this,oi,arguments)}_create_class(oi,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(oi.prototype),"processAsync",t)};return _async_to_generator(function(){var t;return _ts_generator(this,function(c){switch(c.label){case 0:_superprop_get_processAsync().call(o,e);return[4,o.chooseAsync()];case 1:t=c.sent();return[4,o.checkContextTournament()];case 2:c.sent(),e.customData.contextId=t;return[4,o.nextAsync(e)];case 3:c.sent();return[2]}})})()}},{key:"chooseAsync",value:function chooseAsync(){return _async_to_generator(function(){var e,t;return _ts_generator(this,function(o){switch(o.label){case 0:o.trys.push([0,2,,3]);return[4,GameSDK.context.chooseAsync({filters:["INCLUDE_EXISTING_CHALLENGES"],minSize:2,maxSize:2})];case 1:o.sent();return[3,3];case 2:e=o.sent();if(!aV.hasOwn(e,"code")||"SAME_CONTEXT"!==e.code)throw e;return[3,3];case 3:t=GameSDK.context.getID();if("string"!=typeof t)throw new nQ;return[2,t]}})})()}},{key:"checkContextTournament",value:function checkContextTournament(){return _async_to_generator(function(){var e,t;return _ts_generator(this,function(o){switch(o.label){case 0:o.trys.push([0,4,,5]);if(!GameSDK.context.getID())return[2];if(!("getTournamentAsync"in GameSDK))return[3,2];return[4,GameSDK.getTournamentAsync()];case 1:e=(o.sent(),new aG);return[3,3];case 2:e=new nH("getTournamentAsync");o.label=3;case 3:throw e;case 4:t=o.sent();if(_instanceof(t,aG))throw t;return[3,5];case 5:return[2]}})})()}}]);return oi}(nI);var aU=/*#__PURE__*/function(e){_inherits(ci,e);function ci(){_class_call_check(this,ci);return _call_super(this,ci,arguments)}_create_class(ci,[{key:"processAsync",value:function processAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,_,y,f,p,v,g,m,A;return _ts_generator(this,function(k){switch(k.label){case 0:k.trys.push([0,,2,3]);t.startLog(e);o=e.playerId,c=new nz(t),l=new aB(t);c.setNext(l);d=new nB(t,{mode:h.CHALLENGE_FRIEND,customData:{playerId:o}});l.setNext(d);_=new aF(t,{ignoreId:o});d.setNext(_);y=new n4(t,{extraData:e.extraData});_.setNext(y);f=new nY(t);y.setNext(f);p=new n5(t);f.setNext(p);v=new nE(t);p.setNext(v);g=new n6(t);v.setNext(g);m=new nC(t);g.setNext(m);A=t.match.getMatchState();return[4,c.processAsync(A)];case 1:k.sent();return[3,3];case 2:t.endLog();return[7];case 3:return[2]}})})()}}]);return ci}(nv);var aH=/*#__PURE__*/function(e){_inherits(li,e);function li(e){_class_call_check(this,li);var t;t=_call_super(this,li,[e]),t.name="JoinMatchFailed",t.message=null!=e?e:"Join match failed";return t}return li}(_wrap_native_super(Error));var aK=/*#__PURE__*/function(e){_inherits(di,e);function di(e){_class_call_check(this,di);var t;t=_call_super(this,di,[e]),t.name="MatchAreFinished",t.message=null!=e?e:"Match are finished";return t}return di}(_wrap_native_super(Error));var aW=/*#__PURE__*/function(e){_inherits(hi,e);function hi(e){_class_call_check(this,hi);var t;t=_call_super(this,hi,[e]),t.name="OtherPlayerHasJoinedMatch",t.message=null!=e?e:"Other player has joined match";return t}return hi}(_wrap_native_super(Error));var az=o.Dtos;var aq=/*#__PURE__*/function(e){_inherits(yi,e);function yi(){_class_call_check(this,yi);return _call_super(this,yi,arguments)}_create_class(yi,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(yi.prototype),"processAsync",t)};return _async_to_generator(function(){var t,c;return _ts_generator(this,function(l){switch(l.label){case 0:_superprop_get_processAsync().call(o,e),o.validateMatchData(e);return[4,o.joinMatchAsync(e)];case 1:t=l.sent(),c=new az.Match.Data(t).toObject();o.validateJoinMatchData(e,c),o.updateMatchData(e,c);return[4,o.nextAsync(e)];case 2:l.sent();return[2]}})})()}},{key:"validateMatchData",value:function validateMatchData(e){var t=e.status;if(t!==nx.OPEN)throw new n3}},{key:"validateJoinMatchData",value:function validateJoinMatchData(e,t){var o=e.id,c=e.customData,l=t._id,d=t.blackPlayerId,h=t.whitePlayerId,_=t.whitePlayerFinish,y=t.blackPlayerFinish,f=d===c.playerId,p=h===c.opponentId;if("string"!=typeof l||l!==o||!p)throw new aH;if(_&&y)throw new aK;if(!f)throw new aW}},{key:"joinMatchAsync",value:function joinMatchAsync(e){var t=this;return _async_to_generator(function(){var o;return _ts_generator(this,function(c){o=e.id;return[2,o?t.match.api.getMatchAPI().joinMatchAsync(o):{}]})})()}},{key:"updateMatchData",value:function updateMatchData(e,t){var o=e.customData,c=t.whitePlayerId,l=t.blackPlayerId,d=t.whitePlayerScore,h=t.blackPlayerScore,_=t.whitePlayerFinish,y=t.blackPlayerFinish,f=c===o.playerId,p=f?c:l,v=f?l:c;e.customData.playerId=p,e.customData.opponentId=v,e.profiles[p]||(e.profiles[p]={id:p,name:"",photo:"",finished:!1}),e.profiles[v]||(e.profiles[v]={id:v,name:"",photo:"",finished:!1});var g=f?d:h,m=f?h:d;e.profiles[p].score=g,e.profiles[v].score=m;var A=f?_:y,k=f?y:_;e.profiles[p].finished=A,e.profiles[v].finished=k}}]);return yi}(nI);var aJ=/*#__PURE__*/function(e){_inherits(pi,e);function pi(){_class_call_check(this,pi);return _call_super(this,pi,arguments)}_create_class(pi,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(pi.prototype),"processAsync",t)};return _async_to_generator(function(){var t;return _ts_generator(this,function(c){switch(c.label){case 0:_superprop_get_processAsync().call(o,e),o.validateData(e);return[4,o.createWideframesAcceptedAsync(e)];case 1:t=c.sent();t&&o.sendMessageAsync(e,t);return[4,o.nextAsync(e)];case 2:c.sent();return[2]}})})()}},{key:"validateData",value:function validateData(e){var t=e.id,o=e.customData,c=o.contextId,l=o.opponentId;if(!t||"string"!=typeof t)throw new nL;if(!c||"string"!=typeof c)throw new nK;if(!l||"string"!=typeof l)throw new nR}},{key:"createWideframesAcceptedAsync",value:function createWideframesAcceptedAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,h,_,y,f,p,v,g,m,A,k,b,D,P;return _ts_generator(this,function(C){switch(C.label){case 0:C.trys.push([0,4,,5]);o=t.game,c=o.frameCapture,l=e.profiles,d=e.customData,h=d.playerId,_=d.opponentId;if(!h||!_)return[2,null];y=l[h],f=l[_],p=y.photo,v=y.score,g=void 0===v?0:v,m=y.finished;if(m)return[2,null];A=f.photo,k=f.score,b=void 0===k?0:k,D=f.finished;if(!D)return[3,2];return[4,c.wideframe.renderResultChallenge({playerId:h,playerPhoto:p,playerScore:g,opponentId:_,opponentPhoto:A,opponentScore:b,isPlayerFinished:!1,isOpponentFinished:!0})];case 1:P=C.sent();return[3,3];case 2:P=null;C.label=3;case 3:return[2,P];case 4:C.sent();return[2,null];case 5:return[2]}})})()}},{key:"sendMessageAsync",value:function sendMessageAsync(e,t){return _async_to_generator(function(){var o,c,l,d,h,_,y,f;return _ts_generator(this,function(p){switch(p.label){case 0:o=e.id,c=e.profiles,l=e.customData,d=l.playerId,h=l.opponentId;if(!d||"string"!=typeof d)throw new Q;if(!("updateAsync"in GameSDK.extra))throw new nH("updateAsync");_=c[d],y=_.name,f={data:{type:nU.CHALLENGE_FRIEND,matchId:o,playerId:d,opponentId:h},action:"CUSTOM",template:"challenge",cta:{default:"Play",localizations:{vi_VN:"Chơi ngay"}},text:{default:"".concat(y," accepted the challenge."),localizations:{vi_VN:"".concat(y," đ\xe3 chấp nhận tham gia trận đấu.")}},image:t,strategy:"LAST",notification:"PUSH"};return[4,GameSDK.extra.updateAsync(f)];case 1:p.sent();return[2]}})})()}}]);return pi}(nI);var aY=/*#__PURE__*/function(e){_inherits(fi,e);function fi(){_class_call_check(this,fi);return _call_super(this,fi,arguments)}_create_class(fi,[{key:"processAsync",value:function processAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,_,y,f,p,v,g,m,A;return _ts_generator(this,function(k){switch(k.label){case 0:k.trys.push([0,,2,3]);t.startLog(e);o=e.matchId,c=e.playerId,l=e.opponentId,d=new nz(t),_=new nB(t,{id:o,mode:h.CHALLENGE_FRIEND,customData:{playerId:c,opponentId:l}});d.setNext(_);y=new aq(t);_.setNext(y);f=new nY(t);y.setNext(f);p=new n5(t);f.setNext(p);v=new aJ(t);p.setNext(v);g=new nE(t);v.setNext(g);m=new nC(t);g.setNext(m);A=t.match.getMatchState();return[4,d.processAsync(A)];case 1:k.sent();return[3,3];case 2:t.endLog();return[7];case 3:return[2]}})})()}}]);return fi}(nv);var aX={_id:"",status:"",winnerId:"",whitePlayerId:"",blackPlayerId:"",whitePlayerScore:0,blackPlayerScore:0,whitePlayerFinish:!1,blackPlayerFinish:!1},aQ=o.Utils,aZ=aQ.Valid,a$="is invalid";var a0=/*#__PURE__*/function(e){_inherits(_t,e);function _t(){_class_call_check(this,_t);return _call_super(this,_t,arguments)}_create_class(_t,[{key:"setupData",value:function setupData(e){this.lazySetupData(e)}},{key:"validateStructure",value:function validateStructure(e){this.lazyValidateStructure(e)}},{key:"validateData",value:function validateData(e){this.lazyValidateData(e)}},{key:"validateId",value:function validateId(e){aZ.isString(e)&&e||this.exception("_id",a$)}},{key:"validateStatus",value:function validateStatus(e){aZ.isString(e)&&e||this.exception("status",a$)}},{key:"validateWinnerId",value:function validateWinnerId(e){null===e||aZ.isString(e)&&e||this.exception("winnerId",a$)}},{key:"validateWhitePlayerId",value:function validateWhitePlayerId(e){aZ.isString(e)&&e||this.exception("whitePlayerId",a$)}},{key:"validateBlackPlayerId",value:function validateBlackPlayerId(e){aZ.isString(e)&&e||this.exception("blackPlayerId",a$)}},{key:"validateWhitePlayerScore",value:function validateWhitePlayerScore(e){aZ.isNumber(e)||this.exception("whitePlayerScore",a$)}},{key:"validateBlackPlayerScore",value:function validateBlackPlayerScore(e){aZ.isNumber(e)||this.exception("blackPlayerScore",a$)}},{key:"validateWhitePlayerFinish",value:function validateWhitePlayerFinish(e){aZ.isBoolean(e)||this.exception("whitePlayerFinish",a$)}},{key:"validateBlackPlayerFinish",value:function validateBlackPlayerFinish(e){aZ.isBoolean(e)||this.exception("blackPlayerFinish",a$)}},{key:"toObject",value:function toObject(){return _get(_get_prototype_of(_t.prototype),"toObject",this).call(this)}}],[{key:"getDefaultData",value:function getDefaultData(){return aX}}]);return _t}(D);a0.addDefaultData(aX);var a2=/*#__PURE__*/function(e){_inherits(gi,e);function gi(e){_class_call_check(this,gi);var t;t=_call_super(this,gi,[e]),t.name="MatchAreNotFinished",t.message=e||"Match are not finished";return t}return gi}(_wrap_native_super(Error));var a3=/*#__PURE__*/function(e){_inherits(mi,e);function mi(e){_class_call_check(this,mi);var t;t=_call_super(this,mi,[e]),t.name="OpponentNotFinishedMatch",t.message=e||"Opponent not finished match";return t}return mi}(_wrap_native_super(Error));var a1=/*#__PURE__*/function(e){_inherits(wi,e);function wi(){_class_call_check(this,wi);return _call_super(this,wi,arguments)}_create_class(wi,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(wi.prototype),"processAsync",t)};return _async_to_generator(function(){var t,c;return _ts_generator(this,function(l){switch(l.label){case 0:_superprop_get_processAsync().call(o,e),o.validateMatchData(e);return[4,o.getMatchAsync(e)];case 1:t=l.sent(),c=new a0(t).toObject();o.validateResultMatchData(e,c),o.updateMatchData(e,c),o.validatePlayerTurn(e),o.validateOpponentTurn(e);return[4,o.nextAsync(e)];case 2:l.sent();return[2]}})})()}},{key:"validateMatchData",value:function validateMatchData(e){var t=e.id;if("string"!=typeof t)throw new nL}},{key:"validateResultMatchData",value:function validateResultMatchData(e,t){var o=e.id,c=t._id,l=t.whitePlayerFinish,d=t.blackPlayerFinish;if("string"!=typeof c||c!==o)throw new nN;if(!l&&!d)throw new a2}},{key:"validatePlayerTurn",value:function validatePlayerTurn(e){var t=e.profiles,o=e.customData,c=o.playerId;if("string"!=typeof c)throw new Q;var l=t[c],d=l.finished;if(!d)throw new nF}},{key:"validateOpponentTurn",value:function validateOpponentTurn(e){var t=e.profiles,o=e.customData,c=o.opponentId;if("string"!=typeof c)throw new nR;var l=t[c],d=l.finished;if(!d)throw new a3}},{key:"getMatchAsync",value:function getMatchAsync(e){var t=this;return _async_to_generator(function(){var o;return _ts_generator(this,function(c){o=e.id;return[2,o?t.match.api.getMatchAPI().getMatchDetailByIdAsync(o):{}]})})()}},{key:"updateMatchData",value:function updateMatchData(e,t){var o=e.customData,c=t.whitePlayerId,l=t.blackPlayerId,d=t.whitePlayerScore,h=t.blackPlayerScore,_=t.whitePlayerFinish,y=t.blackPlayerFinish,f=c===o.playerId,p=f?c:l,v=f?l:c;e.customData.playerId=p,e.customData.opponentId=v,e.profiles[p]||(e.profiles[p]={id:p,name:"",photo:"",finished:!0}),e.profiles[v]||(e.profiles[v]={id:v,name:"",photo:"",finished:!0});var g=f?d:h,m=f?h:d;e.profiles[p].score=g,e.profiles[v].score=m;var A=f?_:y,k=f?y:_;e.profiles[p].finished=A,e.profiles[v].finished=k}}]);return wi}(nI);var a4=/*#__PURE__*/function(e){_inherits(Ai,e);function Ai(){_class_call_check(this,Ai);return _call_super(this,Ai,arguments)}_create_class(Ai,[{key:"processAsync",value:function processAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,_,y,f,p,v;return _ts_generator(this,function(g){switch(g.label){case 0:g.trys.push([0,,2,3]);t.startLog(e);o=e.matchId,c=e.playerId,l=e.opponentId,d=new nz(t),_=new nB(t,{id:o,mode:h.CHALLENGE_FRIEND,customData:{playerId:c,opponentId:l}});d.setNext(_);y=new a1(t);_.setNext(y);f=new nY(t);y.setNext(f);p=new nC(t);f.setNext(p);v=t.match.getMatchState();return[4,d.processAsync(v)];case 1:g.sent();return[3,3];case 2:t.endLog();return[7];case 3:return[2]}})})()}}]);return Ai}(nv);var a5=/*#__PURE__*/function(e){_inherits(Ii,e);function Ii(){_class_call_check(this,Ii);var e;var t;e=_call_super(this,Ii,arguments),t=e;u(e,"fallbackSingleMode");u(e,"startFLowChallengeFriend",/*#__PURE__*/function(){var e=_async_to_generator(function(e){var o;return _ts_generator(this,function(c){switch(c.label){case 0:c.trys.push([0,2,,3]);return[4,t.match.challenge.invite.processAsync(e)];case 1:return[2,(c.sent(),!0)];case 2:o=c.sent();return[2,o];case 3:return[2]}})});return function(t){return e.apply(this,arguments)}}());u(e,"startFlowTournament",/*#__PURE__*/function(){var e=_async_to_generator(function(e){var o;return _ts_generator(this,function(c){switch(c.label){case 0:c.trys.push([0,2,,4]);o=GameSDK.context.getID();if("string"!=typeof o)throw new nK;return[4,t.match.tournament.continue.processAsync({playerId:e,contextId:o})];case 1:c.sent();return[3,4];case 2:c.sent();return[4,t.startFlowSingle(e)];case 3:c.sent();return[3,4];case 4:return[2]}})});return function(t){return e.apply(this,arguments)}}());u(e,"startFlowSingle",/*#__PURE__*/function(){var e=_async_to_generator(function(e){var o;return _ts_generator(this,function(c){switch(c.label){case 0:o=t.fallbackSingleMode;if(!o)return[3,2];return[4,t.match.single.start.processAsync({playerId:e})];case 1:o=c.sent();c.label=2;case 2:return[2]}})});return function(t){return e.apply(this,arguments)}}());return e}_create_class(Ii,[{key:"processAsync",value:function processAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d;return _ts_generator(this,function(h){switch(h.label){case 0:h.trys.push([0,,6,7]);t.startLog(e);o=e.playerId,c=e.extraData,l=e.fallbackSingleMode;t.fallbackSingleMode=l;return[4,t.startFLowChallengeFriend({playerId:o,extraData:c})];case 1:d=h.sent();if(!0===d)return[2];if(!_instanceof(d,aG))return[3,3];return[4,t.startFlowTournament(o)];case 2:h.sent();return[3,5];case 3:return[4,t.startFlowSingle(o)];case 4:h.sent();h.label=5;case 5:return[3,7];case 6:t.endLog();return[7];case 7:return[2]}})})()}}]);return Ii}(nv);var a6=o.Utils,a7=a6.Valid,a8=o.Configs,a9=a8.Leaderboards;var re=/*#__PURE__*/function(e){_inherits(Si,e);function Si(e){_class_call_check(this,Si);return _call_super(this,Si,[e,{score:0,leaderboardId:a9.LeaderboardEndlessId}])}_create_class(Si,[{key:"setupSetScorePayload",value:function setupSetScorePayload(e){var t=this;var o=this,_superprop_get_setupSetScorePayload=function(){return _get(_get_prototype_of(Si.prototype),"setupSetScorePayload",t)};return _async_to_generator(function(){var t,c,l,d,h;return _ts_generator(this,function(_){t=e.profiles,c=e.customData,l=c.playerId;if(!l||!t[l])throw new nq;d=t[l],h=d.endlessScore;if(!a7.isNumber(h))throw new ad;o.payload.score=h,_superprop_get_setupSetScorePayload().call(o,e);return[2]})})()}}]);return Si}(ap);var ra=/*#__PURE__*/function(e){_inherits(Ei,e);function Ei(){_class_call_check(this,Ei);return _call_super(this,Ei,arguments)}_create_class(Ei,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(Ei.prototype),"processAsync",t)};return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:_superprop_get_processAsync().call(o,e),o.setPlayerEndlessScore(e);return[4,o.nextAsync(e)];case 1:t.sent();return[2]}})})()}},{key:"setPlayerEndlessScore",value:function setPlayerEndlessScore(e){var t=e.profiles,o=e.customData,c=o.playerId;if(!c||!t[c])throw new nq;var l;var d=this.game,h=d.player,_=null!==(l=h.getBestEndlessScore())&&void 0!==l?l:0,y=t[c],f=y.endlessScore,p=void 0===f?0:f,v=_<p?p:_;h.setBestEndlessScore(v),t[c].bestEndlessScore=v}}]);return Ei}(nI);var rs=/*#__PURE__*/function(e){_inherits(xi,e);function xi(){_class_call_check(this,xi);return _call_super(this,xi,arguments)}_create_class(xi,[{key:"processAsync",value:function processAsync(){var e=this;return _async_to_generator(function(){var t,o,c,l,d,h,_;return _ts_generator(this,function(y){switch(y.label){case 0:y.trys.push([0,,2,3]);e.startLog();t=new nz(e),o=new aD(e,{useAPI:!1});t.setNext(o);c=new al(e);o.setNext(c);l=new ra(e);c.setNext(l);d=new re(e);l.setNext(d);h=new nC(e);d.setNext(h);_=e.match.getMatchState();return[4,t.processAsync(_)];case 1:y.sent();return[3,3];case 2:e.endLog();return[7];case 3:return[2]}})})()}}]);return xi}(nv);var ri=/*#__PURE__*/function(e){_inherits(vi,e);function vi(e){_class_call_check(this,vi);var t;t=_call_super(this,vi,[e]),t.name="ProfileIdNotDefined",t.message=null!=e?e:"Profile id is not defined";return t}return vi}(_wrap_native_super(Error));var ro=o.Dtos;var rc=/*#__PURE__*/function(e){_inherits(Ge,e);function Ge(e,t){_class_call_check(this,Ge);var o;o=_call_super(this,Ge,[e]);u(o,"payload");o.payload=t;return o}_create_class(Ge,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(Ge.prototype),"processAsync",t)};return _async_to_generator(function(){var t,c,l,d,h,_;return _ts_generator(this,function(y){switch(y.label){case 0:_superprop_get_processAsync().call(o,e);t=o.payload,c=t.profileId;if(!c)throw new ri;l=o.game,d=l.player,h=d.getPlayerId();if(c!==h)return[3,1];_=o.getPlayerProfile();return[3,3];case 1:return[4,o.getProfileAsync(c)];case 2:if(_=y.sent(),!_)throw new nq;y.label=3;case 3:o.updateMatchData(_,e);return[4,o.nextAsync(e)];case 4:y.sent();return[2]}})})()}},{key:"getPlayerProfile",value:function getPlayerProfile(){var e=this.game,t=e.player,o=t.getPlayer(),c=o.playerId,l=o.name,d=o.photo,h=o.locale;return{playerId:c,name:l,photo:d,locale:h}}},{key:"getProfileAsync",value:function getProfileAsync(e){var t=this;return _async_to_generator(function(){var o,c;return _ts_generator(this,function(l){switch(l.label){case 0:o=t.game,c=o.profile;return[4,c.requestProfiles([e])];case 1:return[2,(l.sent(),c.getProfiles()[e])]}})})()}},{key:"updateMatchData",value:function updateMatchData(e,t){var o=e.playerId,c=e.name,l=e.photo,d=new ro.Match.Profile({id:o,name:c,photo:l}).toObject();t.profiles[o]=d}}]);return Ge}(nI);var ru=/*#__PURE__*/function(e){_inherits(bi,e);function bi(){_class_call_check(this,bi);return _call_super(this,bi,arguments)}_create_class(bi,[{key:"processAsync",value:function processAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,_,y,f,p,v;return _ts_generator(this,function(g){switch(g.label){case 0:g.trys.push([0,,2,3]);t.startLog(e);o=e.playerId,c=new nz(t),l=new ae(t,{contextId:"SOLO"});c.setNext(l);d=new nB(t,{id:"234567",mode:h.ENDLESS,customData:{playerId:o}});l.setNext(d);_=new n5(t);d.setNext(_);y=new rc(t,{profileId:o});_.setNext(y);f=new nE(t);y.setNext(f);p=new nC(t);f.setNext(p);v=t.match.getMatchState();return[4,c.processAsync(v)];case 1:g.sent();return[3,3];case 2:t.endLog();return[7];case 3:return[2]}})})()}}]);return bi}(nv);var rl=o.Utils,rd=rl.Valid;var rh=/*#__PURE__*/function(e){_inherits(Ot,e);function Ot(e){_class_call_check(this,Ot);return _call_super(this,Ot,[e,{score:0,leaderboardId:""}])}_create_class(Ot,[{key:"setupSetScorePayload",value:function setupSetScorePayload(e){var t=this;var o=this,_superprop_get_setupSetScorePayload=function(){return _get(_get_prototype_of(Ot.prototype),"setupSetScorePayload",t)};return _async_to_generator(function(){var t,c,l,d,h,_;return _ts_generator(this,function(y){t=e.profiles,c=e.customData,l=c.playerId,d=c.leaderboardId;if(!d)throw new ah;if(!l||!t[l])throw new nq;h=t[l],_=h.score;if(!rd.isNumber(_))throw new ad;o.payload.score=_,o.payload.leaderboardId=d,_superprop_get_setupSetScorePayload().call(o,e);return[2]})})()}}]);return Ot}(ap);var r_=/*#__PURE__*/function(e){_inherits(Ti,e);function Ti(){_class_call_check(this,Ti);return _call_super(this,Ti,arguments)}_create_class(Ti,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(Ti.prototype),"processAsync",t)};return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:_superprop_get_processAsync().call(o,e),o.validateData(e),o.progressSendGroupMessage(e);return[4,o.nextAsync(e)];case 1:t.sent();return[2]}})})()}},{key:"validateData",value:function validateData(e){var t=e.id,o=e.customData,c=o.contextId,l=o.opponentId;if(!t||"string"!=typeof t)throw new nL;if(!c||"string"!=typeof c)throw new nK;if(!l||"string"!=typeof l)throw new nR}},{key:"createWideframesResultGroupAsync",value:function createWideframesResultGroupAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,h,_,y,f,p,v,g,m,A,k;return _ts_generator(this,function(b){switch(b.label){case 0:b.trys.push([0,2,,3]);o=t.game,c=o.frameCapture,l=e.profiles,d=e.customData,h=d.playerId,_=d.opponentId;if(!h||!_)return[2,null];y=l[h],f=l[_],p=y.photo,v=y.score,g=void 0===v?0:v,m=f.photo,A=f.score,k=void 0===A?0:A;return[4,c.wideframe.renderResultChallenge({playerId:h,playerPhoto:p,playerScore:g,opponentId:_,opponentPhoto:m,opponentScore:k,isPlayerFinished:!0,isOpponentFinished:!0})];case 1:return[2,b.sent()];case 2:b.sent();return[2,null];case 3:return[2]}})})()}},{key:"createWideframesBestScoreAsync",value:function createWideframesBestScoreAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,h,_,y,f,p,v,g;return _ts_generator(this,function(m){switch(m.label){case 0:m.trys.push([0,2,,3]);o=t.game,c=o.player,l=o.frameCapture,d=e.customData,h=d.playerId,_=c.getPlayer(),y=_.playerId,f=_.photo,p=_.data;if(h!==y)return[2,null];v=p||{},g=v.score;return[4,l.wideframe.renderShareScore({playerId:y,playerPhoto:f,playerScore:g})];case 1:return[2,m.sent()];case 2:m.sent();return[2,null];case 3:return[2]}})})()}},{key:"progressSendGroupMessage",value:function progressSendGroupMessage(e){var t=this;return _async_to_generator(function(){var o,c,l,d,h,_,y,f,p,v,g,m;return _ts_generator(this,function(A){switch(A.label){case 0:o=e.profiles,c=e.customData,l=c.playerId,d=c.opponentId;if(!(d&&"string"==typeof d))return[3,2];if(!l||"string"!=typeof l)throw new Q;h=o[l]||{},_=h.score,y=void 0===_?0:_,f=o[d]||{},p=f.score,v=void 0===p?0:p;if(!(y>v))return[3,2];return[4,t.createWideframesResultGroupAsync(e)];case 1:g=A.sent();if(!g)return[2];t.sendBestScoreMessageAsync(e,g);return[2];case 2:return[4,t.createWideframesBestScoreAsync(e)];case 3:m=A.sent();m&&t.sendChallengeMessageAsync(e,m);return[2]}})})()}},{key:"sendBestScoreMessageAsync",value:function sendBestScoreMessageAsync(e,t){var o=this;return _async_to_generator(function(){var c,l,d,h,_,y,f;return _ts_generator(this,function(p){switch(p.label){case 0:c=e.profiles,l=e.customData,d=l.playerId;if(!d||"string"!=typeof d)throw new Q;if(!("updateAsync"in GameSDK.extra))throw new nH("updateAsync");h=c[d],_=h.name,y=h.score,f={data:{type:o.game.context.getSessionContextTypes().MATCHING_GROUP,playerId:d,playerName:_,playerScore:y},action:"CUSTOM",template:"play_turn",cta:{default:"Play",localizations:{vi_VN:"Chơi"}},text:{default:"".concat(_," beats your high score. Their score: ").concat(y,"."),localizations:{vi_VN:"".concat(_," vừa vượt điểm số cao nhất của bạn! Chơi lần nữa chứ?")}},image:t,strategy:"IMMEDIATE",notification:"PUSH"};if(!("updateAsync"in GameSDK.extra))throw new nH("updateAsync");return[4,GameSDK.extra.updateAsync(f)];case 1:p.sent();return[2]}})})()}},{key:"sendChallengeMessageAsync",value:function sendChallengeMessageAsync(e,t){var o=this;return _async_to_generator(function(){var c,l,d,h,_,y,f;return _ts_generator(this,function(p){switch(p.label){case 0:c=e.profiles,l=e.customData,d=l.playerId;if(!d||"string"!=typeof d)throw new Q;h=c[d],_=h.name,y=h.score,f={data:{type:o.game.context.getSessionContextTypes().MATCHING_GROUP,playerId:d,playerName:_,playerScore:y},action:"CUSTOM",template:"play_turn",cta:{default:"Play",localizations:{vi_VN:"Chơi ngay"}},text:{default:"".concat(_," got ").concat(y," scores. So easy! Can you?"),localizations:{vi_VN:"".concat(_," đ\xe3 đạt ").concat(y," điểm! Qu\xe1 dễ lu\xf4n. Chơi lại n\xe0o!")}},image:t,strategy:"IMMEDIATE",notification:"PUSH"};if(!("updateAsync"in GameSDK.extra))throw new nH("updateAsync");return[4,GameSDK.extra.updateAsync(f)];case 1:p.sent();return[2]}})})()}}]);return Ti}(nI);var ry=/*#__PURE__*/function(e){_inherits(Li,e);function Li(){_class_call_check(this,Li);return _call_super(this,Li,arguments)}_create_class(Li,[{key:"processAsync",value:function processAsync(){var e=this;return _async_to_generator(function(){var t,o,c,l,d,h,_,y;return _ts_generator(this,function(f){switch(f.label){case 0:f.trys.push([0,,2,3]);e.startLog();t=new nz(e),o=new aD(e,{useAPI:!1});t.setNext(o);c=new r_(e);o.setNext(c);l=new al(e);c.setNext(l);d=new aE(e);l.setNext(d);h=new rh(e);d.setNext(h);_=new nC(e);h.setNext(_);y=e.match.getMatchState();return[4,t.processAsync(y)];case 1:f.sent();return[3,3];case 2:e.endLog();return[7];case 3:return[2]}})})()}}]);return Li}(nv);var rf=o.Dtos;var rp=/*#__PURE__*/function(e){_inherits(Qe,e);function Qe(e,t){_class_call_check(this,Qe);var o;o=_call_super(this,Qe,[e]);u(o,"payload");o.payload=t;return o}_create_class(Qe,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(Qe.prototype),"processAsync",t)};return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:_superprop_get_processAsync().call(o,e),o.updateProfileMatchData(e);return[4,o.nextAsync(e)];case 1:t.sent();return[2]}})})()}},{key:"updateProfileMatchData",value:function updateProfileMatchData(e){var t=this.payload,o=t.id,c=e.profiles;if(!c[o])throw new nq;var l=_object_spread({},c[o],this.payload),d=new rf.Match.Profile(l).toObject();c[d.id]=d}}]);return Qe}(nI);var rv=/*#__PURE__*/function(e){_inherits(_i,e);function _i(){_class_call_check(this,_i);return _call_super(this,_i,arguments)}_create_class(_i,[{key:"processAsync",value:function processAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,_,y,f,p,v,g,m;return _ts_generator(this,function(A){switch(A.label){case 0:A.trys.push([0,,2,3]);t.startLog(e);o=e.playerId,c=e.opponentId,l=e.opponentScore,d=new nz(t),_=new nB(t,{id:"7749",mode:h.MATCHING_GROUP,customData:{playerId:o,opponentId:c}});d.setNext(_);y=new nY(t);_.setNext(y);f=new rp(t,{id:o,score:l});y.setNext(f);p=new n5(t);f.setNext(p);v=new nE(t);p.setNext(v);g=new nC(t);v.setNext(g);m=t.match.getMatchState();return[4,d.processAsync(m)];case 1:A.sent();return[3,3];case 2:t.endLog();return[7];case 3:return[2]}})})()}}]);return _i}(nv);var rg=/*#__PURE__*/function(e){_inherits(Ss,e);function Ss(e){_class_call_check(this,Ss);var t;t=_call_super(this,Ss,[e]),t.name="MatchGroupNotSupported",t.message=null!=e?e:"Match group is not supported";return t}return Ss}(_wrap_native_super(Error));var rm=/*#__PURE__*/function(e){_inherits(Oi,e);function Oi(e,t){_class_call_check(this,Oi);var o;o=_call_super(this,Oi,[e]);u(o,"payload");o.payload=t;return o}_create_class(Oi,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(Oi.prototype),"processAsync",t)};return _async_to_generator(function(){var t;return _ts_generator(this,function(c){switch(c.label){case 0:_superprop_get_processAsync().call(o,e);return[4,o.checkMatchGroupSupported()];case 1:c.sent();return[4,o.matchingGroup()];case 2:t=c.sent();e.customData.contextId=t;return[4,o.nextAsync(e)];case 3:c.sent();return[2]}})})()}},{key:"checkMatchGroupSupported",value:function checkMatchGroupSupported(){return _async_to_generator(function(){return _ts_generator(this,function(e){switch(e.label){case 0:if(!("getSupportedAPIs"in GameSDK))throw new nH("getSupportedAPIs");if(!("checkCanPlayerMatchAsync"in GameSDK.extra))throw new nH("checkCanPlayerMatchAsync");if(!(GameSDK.getSupportedAPIs().indexOf("checkCanPlayerMatchAsync")>-1))throw new rg;return[4,GameSDK.extra.checkCanPlayerMatchAsync()];case 1:if(!e.sent())throw new rg;return[2]}})})()}},{key:"matchingGroup",value:function matchingGroup(){var e=this;return _async_to_generator(function(){var t,o,c,l,d,h,_;return _ts_generator(this,function(y){switch(y.label){case 0:if(!("matchPlayerAsync"in GameSDK.extra))throw new nH("matchPlayerAsync");t=e.payload,o=t.matchTag,c=t.autoSwitch,l=void 0!==c&&c,d=t.onlyExisting,h=void 0!==d&&d;return[4,GameSDK.extra.matchPlayerAsync(o,l,h)];case 1:y.sent();_=GameSDK.context.getID();if("string"!=typeof _)throw new nQ;return[2,_]}})})()}}]);return Oi}(nI);var rA=/*#__PURE__*/function(e){_inherits(Ri,e);function Ri(){_class_call_check(this,Ri);return _call_super(this,Ri,arguments)}_create_class(Ri,[{key:"processAsync",value:function processAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,_,y,f,p,v,g,m,A;return _ts_generator(this,function(k){switch(k.label){case 0:k.trys.push([0,,2,3]);t.startLog(e);o=e.matchTag,c=e.playerId,l=e.options,d=new nz(t),_=new rm(t,_object_spread({matchTag:o},l));d.setNext(_);y=new nB(t,{id:"7749",mode:h.MATCHING_GROUP,customData:{playerId:c}});_.setNext(y);f=new aF(t,{ignoreId:c});y.setNext(f);p=new n5(t);f.setNext(p);v=new nY(t);p.setNext(v);g=new nE(t);v.setNext(g);m=new nC(t);g.setNext(m);A=t.match.getMatchState();return[4,d.processAsync(A)];case 1:k.sent();return[3,3];case 2:t.endLog();return[7];case 3:return[2]}})})()}}]);return Ri}(nv);var rw=/*#__PURE__*/function(e){_inherits(Fi,e);function Fi(){_class_call_check(this,Fi);return _call_super(this,Fi,arguments)}_create_class(Fi,[{key:"processAsync",value:function processAsync(){var e=this;return _async_to_generator(function(){var t,o,c,l,d,h,_;return _ts_generator(this,function(y){switch(y.label){case 0:y.trys.push([0,,2,3]);e.startLog();t=new nz(e),o=new aD(e,{useAPI:!1});t.setNext(o);c=new al(e);o.setNext(c);l=new aE(e);c.setNext(l);d=new aw(e);l.setNext(d);h=new nC(e);d.setNext(h);_=e.match.getMatchState();return[4,t.processAsync(_)];case 1:y.sent();return[3,3];case 2:e.endLog();return[7];case 3:return[2]}})})()}}]);return Fi}(nv);var rI=/*#__PURE__*/function(e){_inherits(Gi,e);function Gi(){_class_call_check(this,Gi);return _call_super(this,Gi,arguments)}_create_class(Gi,[{key:"processAsync",value:function processAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,_,y,f,p,v;return _ts_generator(this,function(g){switch(g.label){case 0:g.trys.push([0,,2,3]);t.startLog(e);o=e.playerId,c=new nz(t),l=new ae(t,{contextId:"SOLO"});c.setNext(l);d=new nB(t,{id:"123456",mode:h.SINGLE,customData:{playerId:o}});l.setNext(d);_=new n5(t);d.setNext(_);y=new rc(t,{profileId:o});_.setNext(y);f=new nE(t);y.setNext(f);p=new nC(t);f.setNext(p);v=t.match.getMatchState();return[4,c.processAsync(v)];case 1:g.sent();return[3,3];case 2:t.endLog();return[7];case 3:return[2]}})})()}}]);return Gi}(nv);var rk=o.Plugins,rb=o.Utils,rS=rk.Analytics,rD=rb.String,rP=rb.Valid;var rE=/*#__PURE__*/function(e){_inherits(Es,e);function Es(){_class_call_check(this,Es);return _call_super(this,Es,arguments)}_create_class(Es,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(Es.prototype),"processAsync",t)};return _async_to_generator(function(){var t,c,l,d,h,_;return _ts_generator(this,function(y){switch(y.label){case 0:_superprop_get_processAsync().call(o,e);t=e.mode,c=e.customData;o.validateMode(t);l=o.game,d=l.analytics,h=c.tournamentId,_=c.leaderboardId;d.event(rS.Events.TOURNAMENT_START,{success:!0,game_mode:rD.toUpperCamelCase(t),tournament_id:h,leaderboard_id:_});return[4,o.nextAsync(e)];case 1:y.sent();return[2]}})})()}},{key:"validateMode",value:function validateMode(e){if(!rP.isString(e))throw new nm}}]);return Es}(nI);var rx=/*#__PURE__*/function(e){_inherits(xs,e);function xs(e){_class_call_check(this,xs);var t;t=_call_super(this,xs,[e]),t.name="TournamentIdNotValid",t.message=null!=e?e:"Tournament id is not valid";return t}return xs}(_wrap_native_super(Error));var rC=o.Utils,rN=rC.Valid;var rT=/*#__PURE__*/function(e){_inherits(Hi,e);function Hi(e,t){_class_call_check(this,Hi);var o;o=_call_super(this,Hi,[e]);u(o,"payload");o.payload=t;return o}_create_class(Hi,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(Hi.prototype),"processAsync",t)};return _async_to_generator(function(){var t,c,l,d,h,_;return _ts_generator(this,function(y){switch(y.label){case 0:_superprop_get_processAsync().call(o,e);t=o.payload,c=t.contextId;o.validateContextId(c);return[4,GameSDK.getTournamentAsync()];case 1:l=y.sent(),d=l.getID().toString();o.validateTournamentId(d);h=JSON.parse(l.getPayload()||"{}"),_=h.leaderboardId;o.validateLeaderboardId(_),e.customData.contextId=c,e.customData.tournamentId=d,e.customData.leaderboardId=_;return[4,o.nextAsync(e)];case 2:y.sent();return[2]}})})()}},{key:"validateContextId",value:function validateContextId(e){if(!rN.isString(e))throw new nK}},{key:"validateTournamentId",value:function validateTournamentId(e){if(!rN.isString(e))throw new rx}},{key:"validateLeaderboardId",value:function validateLeaderboardId(e){if(!rN.isString(e)||""===e)throw new ah}}]);return Hi}(nI);var rL=/*#__PURE__*/function(e){_inherits(ji,e);function ji(){_class_call_check(this,ji);return _call_super(this,ji,arguments)}_create_class(ji,[{key:"processAsync",value:function processAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,_,y,f,p,v,g,m;return _ts_generator(this,function(A){switch(A.label){case 0:A.trys.push([0,,2,3]);t.startLog(e);o=e.playerId,c=e.contextId,l=new nz(t),d=new rT(t,{contextId:c});l.setNext(d);_=new nB(t,{id:"1997",mode:h.TOURNAMENT,customData:{playerId:o}});d.setNext(_);y=new n5(t);_.setNext(y);f=new rc(t,{profileId:o});y.setNext(f);p=new nE(t);f.setNext(p);v=new rE(t);p.setNext(v);g=new nC(t);p.setNext(g);m=t.match.getMatchState();return[4,l.processAsync(m)];case 1:A.sent();return[3,3];case 2:t.endLog();return[7];case 3:return[2]}})})()}}]);return ji}(nv);var rO=o.Plugins,rR=rO.Analytics;var rM=/*#__PURE__*/function(e){_inherits(zi,e);function zi(){_class_call_check(this,zi);return _call_super(this,zi,arguments)}_create_class(zi,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(zi.prototype),"processAsync",t)};return _async_to_generator(function(){var t,c,l,d,h;return _ts_generator(this,function(_){switch(_.label){case 0:_superprop_get_processAsync().call(o,e);t=e.customData,c=o.game,l=c.analytics,d=t.tournamentId,h=t.leaderboardId;l.event(rR.Events.TOURNAMENT_CREATE,{success:!0,tournament_id:d,leaderboard_id:h});return[4,o.nextAsync(e)];case 1:_.sent();return[2]}})})()}}]);return zi}(nI);var rF=/*#__PURE__*/function(e){_inherits(qi,e);function qi(e,t){_class_call_check(this,qi);var o;o=_call_super(this,qi,[e]);u(o,"payload");o.payload=t;return o}_create_class(qi,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(qi.prototype),"processAsync",t)};return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:_superprop_get_processAsync().call(o,e);return[4,o.createTournamentAsync()];case 1:t.sent();return[4,o.updateMatchStateAsync(e)];case 2:t.sent();return[4,o.nextAsync(e)];case 3:t.sent();return[2]}})})()}},{key:"createTournamentAsync",value:function createTournamentAsync(){var e=this;return _async_to_generator(function(){var t,o,c,l;return _ts_generator(this,function(d){switch(d.label){case 0:t=e.payload,o=t.name,c=t.score,l=t.customData;return[4,GameSDK.tournament.createAsync({initialScore:c,config:{title:o,tournamentTitle:o},data:l})];case 1:d.sent();return[2]}})})()}},{key:"updateMatchStateAsync",value:function updateMatchStateAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,h,_;return _ts_generator(this,function(y){switch(y.label){case 0:y.trys.push([0,2,,3]);if(!("getTournamentAsync"in GameSDK))throw new nH("getTournamentAsync");return[4,GameSDK.getTournamentAsync()];case 1:o=y.sent(),c=o.getContextID(),l=o.getID().toString(),d=t.payload,h=d.playerId;e.customData.playerId=h,e.customData.contextId=c,e.customData.tournamentId=l;return[3,3];case 2:_=y.sent();if(_instanceof(_,nH))return[2];return[3,3];case 3:return[2]}})})()}}]);return qi}(nI);var rG=o.Utils,rj=rG.Valid;var rV=/*#__PURE__*/function(e){_inherits(Ji,e);function Ji(e,t){_class_call_check(this,Ji);var o;o=_call_super(this,Ji,[e]);u(o,"payload");u(o,"leaderboardPayload");o.payload=t;return o}_create_class(Ji,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(Ji.prototype),"processAsync",t)};return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:_superprop_get_processAsync().call(o,e),o.validatePayload();return[4,o.setupCreatePayload(e)];case 1:t.sent();return[4,o.createLeaderboardAsync(e)];case 2:t.sent();return[4,o.nextAsync(e)];case 3:t.sent();return[2]}})})()}},{key:"validatePayload",value:function validatePayload(){var e=this.payload,t=e.leaderboardId;if(!rj.isString(t))throw new ah}},{key:"validatePlayerId",value:function validatePlayerId(e){if(!rj.isString(e))throw new Q}},{key:"setupCreatePayload",value:function setupCreatePayload(e){var t=this;return _async_to_generator(function(){var o,c,l,d,h,_;return _ts_generator(this,function(y){o=e.customData,c=o.playerId;t.validatePlayerId(c);l=t.payload,d=l.name,h=l.leaderboardId,_=l.customData;t.leaderboardPayload={_id:h,name:null!=d?d:"",createdBy:c,description:JSON.stringify(_)};return[2]})})()}},{key:"createLeaderboardAsync",value:function createLeaderboardAsync(e){var t=this;return _async_to_generator(function(){var o;return _ts_generator(this,function(c){switch(c.label){case 0:return[4,t.game.leaderboard.createLeaderboardAsync(t.leaderboardPayload)];case 1:o=c.sent();e.customData.leaderboardId=o;return[2]}})})()}}]);return Ji}(nI);var rB=/*#__PURE__*/function(e){_inherits(Yi,e);function Yi(){_class_call_check(this,Yi);return _call_super(this,Yi,arguments)}_create_class(Yi,[{key:"processAsync",value:function processAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,h,_,y,f,p,v,g,m,A,k;return _ts_generator(this,function(b){switch(b.label){case 0:b.trys.push([0,,2,3]);t.startLog(e);o=e.playerId,c=e.name,l=e.score,d=e.leaderboardId,h=e.payload,_=new nz(t),y=new ae(t,{contextId:"SOLO"});_.setNext(y);f=new rF(t,{name:c,score:l,playerId:o,customData:h});y.setNext(f);p=new rc(t,{profileId:o});f.setNext(p);v=new rp(t,{id:o,score:l});p.setNext(v);g=new rV(t,{name:c,customData:h,leaderboardId:d});v.setNext(g);m=new rh(t);g.setNext(m);A=new rM(t);m.setNext(A);k=t.match.getMatchState();return[4,_.processAsync(k)];case 1:b.sent();return[3,3];case 2:t.endLog();return[7];case 3:return[2]}})})()}}]);return Yi}(nv);var rU=o.Plugins,rH=rU.Analytics,rK=o.Utils,rW=rK.Valid;var rz=/*#__PURE__*/function(e){_inherits(Xi,e);function Xi(e,t){_class_call_check(this,Xi);var o;o=_call_super(this,Xi,[e]);u(o,"payload");o.payload=t;return o}_create_class(Xi,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(Xi.prototype),"processAsync",t)};return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:_superprop_get_processAsync().call(o,e),o.validateData(e);return[4,o.postScoreTournamentAsync(e)];case 1:t.sent();return[4,o.nextAsync(e)];case 2:t.sent();return[2]}})})()}},{key:"validateData",value:function validateData(e){var t=e.profiles,o=e.customData,c=o.playerId;if(this.validatePlayerId(c),!t[c])throw new nq}},{key:"validatePlayerId",value:function validatePlayerId(e){if(!rW.isString(e))throw new Q}},{key:"getPlayerProfile",value:function getPlayerProfile(e){var t=e.profiles,o=e.customData,c=o.playerId;return this.validatePlayerId(c),t[c]}},{key:"isNewBestScore",value:function isNewBestScore(e){var t=this.getPlayerProfile(e),o=t.score,c=void 0===o?0:o,l=t.bestScore,d=void 0===l?0:l;return c>d}},{key:"postScoreTournamentAsync",value:function postScoreTournamentAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,h,_,y,f,p,v;return _ts_generator(this,function(g){switch(g.label){case 0:o=window.game,c=o.analytics,l=t.getPlayerProfile(e),d=l.score,h=void 0===d?0:d;_=null,y=!1;f=t.payload,p=f.checkBestScore,v=t.isNewBestScore(e);g.label=1;case 1:g.trys.push([1,7,8,9]);if(!("getTournamentAsync"in GameSDK))throw new nH("getTournamentAsync");return[4,GameSDK.getTournamentAsync()];case 2:g.sent();if(!(!p||v))return[3,4];_=rH.Events.TOURNAMENT_SHARE;return[4,GameSDK.tournament.shareAsync({score:h})];case 3:g.sent();return[3,6];case 4:_=rH.Events.TOURNAMENT_POST_SCORE;return[4,GameSDK.tournament.postScoreAsync(h)];case 5:g.sent();g.label=6;case 6:y=!0;return[3,9];case 7:g.sent();return[3,9];case 8:_&&c.event(_,{success:y});return[7];case 9:return[2]}})})()}}]);return Xi}(nI);var rq=/*#__PURE__*/function(e){_inherits(Zi,e);function Zi(){_class_call_check(this,Zi);return _call_super(this,Zi,arguments)}_create_class(Zi,[{key:"processAsync",value:function processAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,h,_,y,f,p,v,g,m;return _ts_generator(this,function(A){switch(A.label){case 0:A.trys.push([0,,2,3]);t.startLog(e);o=e.playerId,c=e.bestScore,l=new nz(t),d=new aD(t,{useAPI:!1});l.setNext(d);h=new rp(t,{id:o,bestScore:c});d.setNext(h);_=new rz(t,{checkBestScore:!1});h.setNext(_);y=new al(t);_.setNext(y);f=new aE(t);y.setNext(f);p=new rh(t);f.setNext(p);v=new aw(t);p.setNext(v);g=new nC(t);v.setNext(g);m=t.match.getMatchState();return[4,l.processAsync(m)];case 1:A.sent();return[3,3];case 2:t.endLog();return[7];case 3:return[2]}})})()}}]);return Zi}(nv);var rJ=o.Utils,rY=rJ.Valid,rX=rJ.Object;var rQ=/*#__PURE__*/function(e){_inherits(tr,e);function tr(e,t){_class_call_check(this,tr);var o;o=_call_super(this,tr,[e]);u(o,"payload");o.payload=t;return o}_create_class(tr,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(tr.prototype),"processAsync",t)};return _async_to_generator(function(){var t,c,l,d,h,_;return _ts_generator(this,function(y){switch(y.label){case 0:_superprop_get_processAsync().call(o,e);t=o.payload,c=t.tournamentId;o.validateTournamentId(c);return[4,o.joinTournamentAsync(c)];case 1:y.sent();return[4,GameSDK.getTournamentAsync()];case 2:l=y.sent(),d=l.getContextID();o.validateContextId(d);h=JSON.parse(l.getPayload()||"{}"),_=h.leaderboardId;o.validateLeaderboardId(_),e.customData.contextId=d,e.customData.tournamentId=c,e.customData.leaderboardId=_;return[4,o.nextAsync(e)];case 3:y.sent();return[2]}})})()}},{key:"validateTournamentId",value:function validateTournamentId(e){if(!rY.isString(e))throw new rx}},{key:"validateContextId",value:function validateContextId(e){if(!rY.isString(e))throw new nK}},{key:"validateLeaderboardId",value:function validateLeaderboardId(e){if(!rY.isString(e)||""===e)throw new ah}},{key:"joinTournamentAsync",value:function joinTournamentAsync(e){return _async_to_generator(function(){var t;return _ts_generator(this,function(o){switch(o.label){case 0:if(!("tournament"in GameSDK))throw new nH("tournament");o.label=1;case 1:o.trys.push([1,3,,4]);return[4,GameSDK.tournament.joinAsync(e)];case 2:o.sent();return[3,4];case 3:t=o.sent();if(!rX.hasOwn(t,"code")||"SAME_CONTEXT"!==t.code)throw t;return[3,4];case 4:return[2]}})})()}}]);return tr}(nI);var rZ=/*#__PURE__*/function(e){_inherits(sr,e);function sr(){_class_call_check(this,sr);return _call_super(this,sr,arguments)}_create_class(sr,[{key:"processAsync",value:function processAsync(e){var t=this;return _async_to_generator(function(){var o,c,l,d,_,y,f,p,v,g,m;return _ts_generator(this,function(A){switch(A.label){case 0:A.trys.push([0,,2,3]);t.startLog(e);o=e.playerId,c=e.tournamentId,l=new nz(t),d=new rQ(t,{tournamentId:c});l.setNext(d);_=new nB(t,{id:"1997",mode:h.TOURNAMENT,customData:{playerId:o}});d.setNext(_);y=new n5(t);_.setNext(y);f=new rc(t,{profileId:o});y.setNext(f);p=new nE(t);f.setNext(p);v=new rE(t);p.setNext(v);g=new nC(t);v.setNext(g);m=t.match.getMatchState();return[4,l.processAsync(m)];case 1:A.sent();return[3,3];case 2:t.endLog();return[7];case 3:return[2]}})})()}}]);return sr}(nv);var r$=o.Dtos,r0=o.Utils,r2=r0.Object;var r3=/*#__PURE__*/function(e){_inherits(rr,e);function rr(e,t){_class_call_check(this,rr);var o;o=_call_super(this,rr,[e]);u(o,"payload");o.payload=t;return o}_create_class(rr,[{key:"processAsync",value:function processAsync(e){var t=this;var o=this,_superprop_get_processAsync=function(){return _get(_get_prototype_of(rr.prototype),"processAsync",t)};return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:_superprop_get_processAsync().call(o,e),o.updateMatchCustomData(e);return[4,o.nextAsync(e)];case 1:t.sent();return[2]}})})()}},{key:"updateMatchCustomData",value:function updateMatchCustomData(e){var t=r2.merge(e.customData,this.payload),o=new r$.Match.CustomData(t).toObject();e.customData=o}}]);return rr}(nI);var r1={id:null,mode:null,status:null,startAt:0,finishAt:0,profiles:{},customData:_object_spread({},nV)},r4=o.Configs;var r5=/*#__PURE__*/function(e){_inherits(cr,e);function cr(){_class_call_check(this,cr);var e;e=_call_super(this,cr,arguments);u(e,"base");u(e,"group");u(e,"single");u(e,"endless");u(e,"context");u(e,"challenge");u(e,"tournament");u(e,"api");u(e,"handler");u(e,"useCPUProfile");return e}_create_class(cr,[{key:"init",value:function init(){this.createMatchData(),this.createAPIHandler(),this.createBaseConcrete(),this.createConcreteFlows(),this.createConcreteHandlers()}},{key:"setUseCPUProfile",value:function setUseCPUProfile(e){this.useCPUProfile=e}},{key:"createMatchData",value:function createMatchData(){var e=this.game,t=e.storage;t.addStorage("match",r1)}},{key:"getMatchState",value:function getMatchState(){var e=this.game,t=e.storage;return t.getStorage("match")}},{key:"createBaseConcrete",value:function createBaseConcrete(){this.base=new nv(this.game,this)}},{key:"createConcreteFlows",value:function createConcreteFlows(){this.createGroupFlows(),this.createSingleFlows(),this.createEndlessFlows(),this.createContextFlows(),this.createChallengeFlows(),this.createTournamentFlows()}},{key:"createConcreteHandlers",value:function createConcreteHandlers(){var e=this;this.handler={setProfileData:/*#__PURE__*/function(){var t=_async_to_generator(function(t){var o;return _ts_generator(this,function(c){switch(c.label){case 0:o=new rp(e.base,t);return[4,e.processHandlerAsync(o)];case 1:c.sent();return[2]}})});return function(e){return t.apply(this,arguments)}}(),setMatchCustomData:/*#__PURE__*/function(){var t=_async_to_generator(function(t){var o;return _ts_generator(this,function(c){switch(c.label){case 0:o=new r3(e.base,t);return[4,e.processHandlerAsync(o)];case 1:c.sent();return[2]}})});return function(e){return t.apply(this,arguments)}}(),setLeaderboardScore:/*#__PURE__*/function(){var t=_async_to_generator(function(t){var o;return _ts_generator(this,function(c){switch(c.label){case 0:o=new ap(e.base,t);return[4,e.processHandlerAsync(o)];case 1:c.sent();return[2]}})});return function(e){return t.apply(this,arguments)}}()}}},{key:"createAPIHandler",value:function createAPIHandler(){var e={appId:r4.AppId,matchAPIHost:r4.ApiHost};this.api=new np(e)}},{key:"createGroupFlows",value:function createGroupFlows(){this.group={join:new rv(this.game,this),start:new rA(this.game,this),finish:new ry(this.game,this)}}},{key:"createSingleFlows",value:function createSingleFlows(){this.single={start:new rI(this.game,this),finish:new rw(this.game,this)}}},{key:"createEndlessFlows",value:function createEndlessFlows(){this.endless={start:new ru(this.game,this),finish:new rs(this.game,this)}}},{key:"createContextFlows",value:function createContextFlows(){this.context={choose:new a5(this.game,this)}}},{key:"createChallengeFlows",value:function createChallengeFlows(){this.challenge={invite:new aU(this.game,this),friend:new n7(this.game,this),join:new aY(this.game,this),await:new nX(this.game,this),result:new a4(this.game,this),finish:new ax(this.game,this),continue:new ar(this.game,this)}}},{key:"createTournamentFlows",value:function createTournamentFlows(){this.tournament={join:new rZ(this.game,this),create:new rB(this.game,this),finish:new rq(this.game,this),continue:new rL(this.game,this)}}},{key:"processHandlerAsync",value:function processHandlerAsync(e){var t=this.getMatchState();return e.processAsync(t)}}]);return cr}(c.Plugins.BasePlugin);var r6=o.Utils,r7=r6.Valid,r8="is invalid";var r9=/*#__PURE__*/function(e){_inherits(Ns,e);function Ns(){_class_call_check(this,Ns);return _call_super(this,Ns,arguments)}_create_class(Ns,[{key:"setupData",value:function setupData(e){this.lazySetupData(e)}},{key:"validateStructure",value:function validateStructure(e){this.lazyValidateStructure(e)}},{key:"validateData",value:function validateData(e){this.lazyValidateData(e)}},{key:"validateLevel",value:function validateLevel(e){(!r7.isNumber(e)||e<0)&&this.exception("level",r8)}},{key:"validateRescued",value:function validateRescued(e){(!r7.isNumber(e)||e<0)&&this.exception("rescued",r8)}},{key:"validateContextId",value:function validateContextId(e){r7.isString(e)||this.exception("contextId",r8)}},{key:"validatePlayerId",value:function validatePlayerId(e){r7.isString(e)||this.exception("playerId",r8)}},{key:"validateOpponentId",value:function validateOpponentId(e){r7.isString(e)||this.exception("opponentId",r8)}},{key:"validateTournamentId",value:function validateTournamentId(e){r7.isString(e)||this.exception("tournamentId",r8)}},{key:"validateLeaderboardId",value:function validateLeaderboardId(e){r7.isString(e)||this.exception("leaderboardId",r8)}},{key:"toObject",value:function toObject(){return _get(_get_prototype_of(Ns.prototype),"toObject",this).call(this)}}],[{key:"getDefaultData",value:function getDefaultData(){return D.getDefaultData()}}]);return Ns}(D);r9.addDefaultData(nV);var se=o.Utils,st=se.Valid,sn="is invalid";var ss=/*#__PURE__*/function(e){_inherits(Ts,e);function Ts(){_class_call_check(this,Ts);return _call_super(this,Ts,arguments)}_create_class(Ts,[{key:"setupData",value:function setupData(e){this.lazySetupData(e)}},{key:"validateStructure",value:function validateStructure(e){this.lazyValidateStructure(e)}},{key:"validateData",value:function validateData(e){this.lazyValidateData(e)}},{key:"validateId",value:function validateId(e){st.isString(e)&&e||this.exception("id",sn)}},{key:"validateName",value:function validateName(e){st.isString(e)&&e||this.exception("name",sn)}},{key:"validatePhoto",value:function validatePhoto(e){st.isString(e)||this.exception("photo",sn)}},{key:"validateScore",value:function validateScore(e){(!st.isNumber(e)||e<0)&&this.exception("score",sn)}},{key:"validateBestScore",value:function validateBestScore(e){(!st.isNumber(e)||e<0)&&this.exception("bestScore",sn)}},{key:"validateEndlessScore",value:function validateEndlessScore(e){(!st.isNumber(e)||e<0)&&this.exception("endlessScore",sn)}},{key:"validateBestEndlessScore",value:function validateBestEndlessScore(e){(!st.isNumber(e)||e<0)&&this.exception("bestEndlessScore",sn)}},{key:"validateFinished",value:function validateFinished(e){st.isBoolean(e)||this.exception("finished",sn)}},{key:"toObject",value:function toObject(){return _get(_get_prototype_of(Ts.prototype),"toObject",this).call(this)}}],[{key:"getDefaultData",value:function getDefaultData(){return D.getDefaultData()}}]);return Ts}(D);ss.addDefaultData({id:"",name:"Your Friend",photo:"./assets/images/others/avatar.png",score:0,bestScore:0,finished:!1,endlessScore:0,bestEndlessScore:0}),o.Dtos.Match={Data:a0,CustomData:r9,Profile:ss};var si=o.Utils,sc=o.Configs,su=sc.ApiHost,sl=/*#__PURE__*/function(){var e=_async_to_generator(function(e){var t,o;return _ts_generator(this,function(c){switch(c.label){case 0:t="players";"MsGames"===GameSDK.getSDKName()&&(t="players?platform=ms-games");return[4,ef(t,e,{},su,10)];case 1:o=c.sent();return[2,si.Object.hasOwn(o,"data")?o.data||{}:{}]}})});return function hr(t){return e.apply(this,arguments)}}(),sd=o.Utils,sh=o.Configs,s_=sh.AppId,sy=sd.Array,sf=sd.Object,sp=sd.Valid;var sv=/*#__PURE__*/function(e){_inherits(mr,e);function mr(){_class_call_check(this,mr);return _call_super(this,mr,arguments)}_create_class(mr,[{key:"init",value:function init(){var e=this.game,t=e.storage;t.addStorage("player",C)}},{key:"saveToCloud",value:function saveToCloud(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(o){switch(o.label){case 0:o.trys.push([0,2,,3]);t=e.getPlayerData();return[4,GameSDK.player.setDataAsync(t)];case 1:o.sent();return[3,3];case 2:o.sent();return[3,3];case 3:return[2]}})})()}},{key:"receiveData",value:function receiveData(e,t){var o=this.game,c=o.storage,l=e.playerId,d=e.name,h=e.photo,_=e.locale;c.setStorageData("player","playerId",l),c.setStorageData("player","name",d),c.setStorageData("player","photo",h),c.setStorageData("player","locale",_),t&&this.setPlayerData(t)}},{key:"syncProfileToServer",value:function syncProfileToServer(){var e=this;return _async_to_generator(function(){var t,o,c,l,d,h,_,y,f,p;return _ts_generator(this,function(v){switch(v.label){case 0:t=e.game,o=t.storage,c=e.getPlayer(),l=c.playerId,d=c.name,h=c.photo,_=c.locale;y=e.getPlayerASID();p=!sp.isString(y)&&"getASIDAsync"in GameSDK.player;if(!p)return[3,2];return[4,GameSDK.player.getASIDAsync()];case 1:p=(y=null!==(f=v.sent())&&void 0!==f?f:y,o.setStorageData("player","ASID","".concat(y)));v.label=2;case 2:return[4,sl({appId:s_,ASID:y,playerId:l,name:d,photo:h,locale:_})];case 3:v.sent();return[2]}})})()}},{key:"setPlayerDataByName",value:function setPlayerDataByName(e,t){this.setPlayerData(_define_property({},e,t))}},{key:"setPlayerData",value:function setPlayerData(e){var t=this.game,o=t.storage;o.setStorageData("player","data",e),this.saveToCloud()}},{key:"setBestScore",value:function setBestScore(e){this.setPlayerDataByName("score",e)}},{key:"setBestEndlessScore",value:function setBestEndlessScore(e){this.setPlayerDataByName("endlessScore",e)}},{key:"setSetting",value:function setSetting(e,t){this.setPlayerDataByName("settings",_define_property({},e,t))}},{key:"setGameData",value:function setGameData(e){var t;var o=null!==(t=this.getGameData())&&void 0!==t?t:{},c=sf.merge(o,e);this.setPlayerDataByName("gameData",c)}},{key:"requestConnectedPlayers",value:function requestConnectedPlayers(){var e=this;return _async_to_generator(function(){var t,o,c,l,d;return _ts_generator(this,function(h){switch(h.label){case 0:t=e.game,o=t.storage;return[4,GameSDK.player.getConnectedPlayersAsync()];case 1:c=h.sent().map(function(e){var t=e.getID(),o=e.getName(),c=e.getPhoto();return t&&o&&c?new W({playerId:t,name:o,photo:c}).toObject():null}),l=sy.unique(c);if(l.length<1)return[2];d=sf.keyBy(l,"playerId");o.setStorageData("player","connectedPlayers",d);return[2]}})})()}},{key:"getPlayer",value:function getPlayer(){var e=this.game,t=e.storage;return t.getStorage("player")}},{key:"getPlayerId",value:function getPlayerId(){var e=this.game,t=e.storage;return t.getStorageData("player","playerId")}},{key:"getPlayerASID",value:function getPlayerASID(){var e=this.game,t=e.storage;return t.getStorageData("player","ASID")}},{key:"getPlayerLocale",value:function getPlayerLocale(){var e=this.game,t=e.storage;return t.getStorageData("player","locale")}},{key:"getPlayerData",value:function getPlayerData(){var e=this.game,t=e.storage;return t.getStorageData("player","data")}},{key:"getPlayerDataByKey",value:function getPlayerDataByKey(e){var t=this.getPlayerData();return sf.hasOwn(t,e)?t[e]:null}},{key:"getGameData",value:function getGameData(){return this.getPlayerDataByKey("gameData")}},{key:"getPlayerSetting",value:function getPlayerSetting(e){var t=this.getPlayerSettings();return sf.hasOwn(t,e)?t[e]:null}},{key:"getPlayerSettings",value:function getPlayerSettings(){var e=this.getPlayerData(),t=e.settings;return t}},{key:"isFirstLogin",value:function isFirstLogin(){var e;return null!==(e=this.getPlayerDataByKey("isFirstLogin"))&&void 0!==e?e:C.data.isFirstLogin}},{key:"loggedIn",value:function loggedIn(){this.setPlayerDataByName("isFirstLogin",!1)}},{key:"getBestScore",value:function getBestScore(){var e=this.getPlayerData(),t=e.score;return t}},{key:"getBestEndlessScore",value:function getBestEndlessScore(){var e=this.getPlayerData(),t=e.endlessScore;return t}},{key:"getConnectedPlayers",value:function getConnectedPlayers(){var e=this.game,t=e.storage;return t.getStorageData("player","connectedPlayers")}},{key:"getConnectedPlayerIds",value:function getConnectedPlayerIds(e,t){var o=this.getConnectedPlayers();return Object.keys(o).slice(t,t+e)}},{key:"getNotificationData",value:function getNotificationData(){var e;return null!==(e=this.getPlayerDataByKey("notificationData"))&&void 0!==e?e:C.data.notificationData}}]);return mr}(c.Plugins.BasePlugin);var sg=o.Dtos,sm=o.Utils,sA=sm.Valid,sw=C.data,sI=sw.score,sk=sw.endlessScore,sb=sw.settings,sS=sw.gameData,sD=sw.isFirstLogin,sP=sw.dailyRewarded,sE=sw.notificationData,sx="is invalid";var sC=/*#__PURE__*/function(e){_inherits(_s,e);function _s(){_class_call_check(this,_s);return _call_super(this,_s,arguments)}_create_class(_s,[{key:"processData",value:function processData(e){this.validateStructure(e),e.settings=new sg.Player.Settings(e.settings).toObject(),e.gameData=new sg.Player.GameData(e.gameData).toObject(),this.validateData(e),this.setupData(e)}},{key:"setupData",value:function setupData(e){this.lazySetupData(e)}},{key:"validateStructure",value:function validateStructure(e){this.lazyValidateStructure(e)}},{key:"validateData",value:function validateData(e){this.lazyValidateData(e)}},{key:"validateScore",value:function validateScore(e){(!sA.isNumber(e)||e<0)&&this.exception("score",sx)}},{key:"validateEndlessScore",value:function validateEndlessScore(e){(!sA.isNumber(e)||sI<0)&&this.exception("endlessScore",sx)}},{key:"validateSettings",value:function validateSettings(e){sA.isObject(e)||this.exception("settings",sx)}},{key:"validateNotificationData",value:function validateNotificationData(e){sA.isObject(e)||this.exception("notificationData",sx),"lastSent"in e&&sA.isNumber(e.lastSent)||this.exception("notificationData.lastSent",sx),"currentId"in e&&sA.isNumber(e.currentId)||this.exception("notificationData.currentId",sx)}},{key:"validateGameData",value:function validateGameData(e){sA.isObject(e)||this.exception("gameData",sx)}},{key:"validateIsFirstLogin",value:function validateIsFirstLogin(e){sA.isBoolean(e)||this.exception("isFirstLogin",sx)}},{key:"validateDailyRewarded",value:function validateDailyRewarded(e){sA.isObject(e)||this.exception("dailyRewarded",sx)}},{key:"toObject",value:function toObject(){return _get(_get_prototype_of(_s.prototype),"toObject",this).call(this)}}]);return _s}(D);sC.addDefaultData({score:sI,endlessScore:sk,settings:sb,gameData:sS,isFirstLogin:sD,dailyRewarded:sP,notificationData:sE});var sN=o.Utils,sT=sN.Valid,sL=C.data.gameData,sO=sL.level,sR=sL.coins;var sM=/*#__PURE__*/function(e){_inherits(Rs,e);function Rs(){_class_call_check(this,Rs);return _call_super(this,Rs,arguments)}_create_class(Rs,[{key:"setupData",value:function setupData(e){this.lazySetupData(e)}},{key:"validateStructure",value:function validateStructure(e){this.lazyValidateStructure(e)}},{key:"validateData",value:function validateData(e){this.lazyValidateData(e)}},{key:"validateLevel",value:function validateLevel(e){(!sT.isNumber(e)||e<0)&&this.exception("level","is invalid")}},{key:"validateCoins",value:function validateCoins(e){(!sT.isNumber(e)||e<0)&&this.exception("coins","is invalid")}},{key:"toObject",value:function toObject(){return _get(_get_prototype_of(Rs.prototype),"toObject",this).call(this)}}]);return Rs}(D);sM.addDefaultData({level:sO,coins:sR});var sF=o.Utils,sG=sF.Valid,sj=C.data.settings,sV=sj.sound,sB=sj.music,sU=sj.vibrate,sH=sj.language,sK="is invalid";var sW=/*#__PURE__*/function(e){_inherits(Fs,e);function Fs(){_class_call_check(this,Fs);return _call_super(this,Fs,arguments)}_create_class(Fs,[{key:"setupData",value:function setupData(e){this.lazySetupData(e)}},{key:"validateStructure",value:function validateStructure(e){this.lazyValidateStructure(e)}},{key:"validateData",value:function validateData(e){this.lazyValidateData(e)}},{key:"validateSound",value:function validateSound(e){sG.isBoolean(e)||this.exception("sound",sK)}},{key:"validateMusic",value:function validateMusic(e){sG.isBoolean(e)||this.exception("music",sK)}},{key:"validateVibrate",value:function validateVibrate(e){sG.isBoolean(e)||this.exception("vibrate",sK)}},{key:"validateLanguage",value:function validateLanguage(e){sG.isString(e)&&e||this.exception("language",sK)}},{key:"toObject",value:function toObject(){return _get(_get_prototype_of(Fs.prototype),"toObject",this).call(this)}}]);return Fs}(D);sW.addDefaultData({sound:sV,music:sB,vibrate:sU,language:sH}),o.Dtos.Player={Info:W,Data:sC,Settings:sW,GameData:sM};var sz=o.Configs,sq=o.Utils,sJ=sq.Object,sY=sq.String,sX=sz.ApiHost,sQ=sz.Mockup;var sZ=/*#__PURE__*/function(){function Gr(){_class_call_check(this,Gr);u(this,"mockAPI")}_create_class(Gr,[{key:"initMockAPI",value:function initMockAPI(){var e=this;return _async_to_generator(function(){var o;return _ts_generator(this,function(c){switch(c.label){case 0:if(e.mockAPI)return[2];return[4,d(/*#__PURE__*/_async_to_generator(function(){var e,o;return _ts_generator(this,function(c){switch(c.label){case 0:return[4,t.import("./bundle/ProfileAPIMock.js")];case 1:e=c.sent(),o=e.default;return[2,{default:o}]}})}),void 0,t.meta.url)];case 1:o=c.sent().default;if("function"!=typeof o)throw new Error("Cannot load ProfileAPIMock");e.mockAPI=new o;return[2]}})})()}},{key:"getPlayersAsync",value:function getPlayersAsync(e){var t=this;return _async_to_generator(function(){var o,c;return _ts_generator(this,function(l){switch(l.label){case 0:o=sY.params(e);if(!sQ.Profile.Enabled)return[3,3];return[4,t.initMockAPI()];case 1:l.sent();return[4,t.mockAPI.getPlayersAsync(e)];case 2:c=l.sent();return[3,5];case 3:return[4,ey("players?".concat(o),{},sX)];case 4:c=l.sent();l.label=5;case 5:return[2,sJ.hasOwn(c,"data")&&Array.isArray(c.data)?c.data:[]]}})})()}}]);return Gr}();var s$={profiles:{},profileIds:[]},s0=o.Utils,s2=o.Dtos,s3=s0.Array,s1=s0.Valid,s4=s0.Object,s5=s0.Function;var s6=/*#__PURE__*/function(e){_inherits(jr,e);function jr(){_class_call_check(this,jr);var e;e=_call_super(this,jr,arguments);u(e,"profileAPI",new sZ);return e}_create_class(jr,[{key:"init",value:function init(){var e=this.game,t=e.storage;t.addStorage("profile",s$)}},{key:"requestProfiles",value:function requestProfiles(e){var t=this;return _async_to_generator(function(){var o,c,l,d,h;return _ts_generator(this,function(_){switch(_.label){case 0:o=t.getProfileIds(),c=s3.difference(e,o);if(c.length<1)return[2];l=s3.chunk(c,400).map(function(e){return t.profileAPI.getPlayersAsync({playerIds:e})});return[4,s5.allSettled(l)];case 1:d=_.sent().reduce(function(e,t){return"fulfilled"===t.status?e.concat(t.value):e},[]);if(!t.validateProfilesResponse(d))return[2];h=t.convertToProfiles(d);t.setProfiles(h);return[2]}})})()}},{key:"getProfile",value:function getProfile(e){var t;return null!==(t=this.getProfiles()[e])&&void 0!==t?t:null}},{key:"getProfiles",value:function getProfiles(){var e=this.game,t=e.storage;return t.getStorageData("profile","profiles")}},{key:"setProfiles",value:function setProfiles(e){var t=this.game,o=t.storage;o.setStorageData("profile","profiles",e),o.setStorageData("profile","profileIds",Object.keys(e))}},{key:"getProfileIds",value:function getProfileIds(){var e=this.game,t=e.storage;return t.getStorageData("profile","profileIds")}},{key:"validateProfilesResponse",value:function validateProfilesResponse(e){return!(!Array.isArray(e)||e.length<1)}},{key:"convertToProfiles",value:function convertToProfiles(e){var t={};var o=true,c=false,l=void 0;try{for(var d=e[Symbol.iterator](),h;!(o=(h=d.next()).done);o=true){var _=h.value;s4.hasOwn(_,"playerId")&&s1.isString(_.playerId)&&(t[_.playerId]=new s2.Player.Info(_).toObject())}}catch(e){c=true;l=e}finally{try{if(!o&&null!=d.return)d.return()}finally{if(c)throw l}}return t}}]);return jr}(c.Plugins.BasePlugin);var s7="Save The Pets",s8=o.Utils,s9=s8.Object,ie=s8.Valid,it=s8.Browser;var ir=/*#__PURE__*/function(e){_inherits(Kr,e);function Kr(e){_class_call_check(this,Kr);var t;t=_call_super(this,Kr,[e]);u(t,"storages");u(t,"storageLocalKeys",{});t.storages={};return t}_create_class(Kr,[{key:"addStorage",value:function addStorage(e,t,o){var c=arguments.length>2&&void 0!==o&&o;var l=this;return _async_to_generator(function(){var o;return _ts_generator(this,function(d){switch(d.label){case 0:l.storages[e]=t;o=c;if(!o)return[3,2];return[4,l.initFromWebStorage(e,t)];case 1:o=d.sent();d.label=2;case 2:return[2]}})})()}},{key:"initFromWebStorage",value:function initFromWebStorage(e,t){var o=this;return _async_to_generator(function(){var c,l,d,h,_,y,f,p;return _ts_generator(this,function(v){switch(v.label){case 0:o.storageLocalKeys[e]=!0;return[4,it.getIndexedDB("".concat(s7,"_S_").concat(e))];case 1:c=v.sent();if(!ie.isObject(c))return[2];l=Object.keys(t);d=true,h=false,_=void 0;try{for(y=l[Symbol.iterator]();!(d=(f=y.next()).done);d=true){p=f.value;s9.hasOwn(c,p)&&_type_of(t[p])==_type_of(c[p])&&o.setStorageData(e,p,c[p])}}catch(e){h=true;_=e}finally{try{if(!d&&null!=y.return)y.return()}finally{if(h)throw _}}return[2]}})})()}},{key:"setStorageData",value:function setStorageData(e,t,o){var c;if(ie.isObject(o)){var l=this.getStorageData(e,t);c=s9.merge(l,o)}else c=o;this.storages[e][t]=c}},{key:"getStorageData",value:function getStorageData(e,t){return this.getStorage(e)[t]}},{key:"getStorage",value:function getStorage(e){return this.storages[e]}},{key:"updateToWebStorage",value:function updateToWebStorage(e){this.storageLocalKeys[e]&&this.saveToWebStorage(e)}},{key:"saveToWebStorage",value:function saveToWebStorage(e){var t=this.getStorage(e);it.setIndexedDB("".concat(s7,"_S_").concat(e),t)}}]);return Kr}(c.Plugins.BasePlugin);var is=/*#__PURE__*/function(e){_inherits(Wr,e);function Wr(){_class_call_check(this,Wr);var e;e=_call_super(this,Wr,arguments);u(e,"isVisible",!0);u(e,"browserPrefixes",["moz","ms","o","","webkit"]);u(e,"handleVisibilityChange",function(t){if(["focus","blur"].indexOf(t)>-1)return"focus"===t?e.onVisibleEvent():e.onHiddenEvent();var o=e.getBrowserPrefix();return e.getHiddenPropertyName(o) in document?e.onHiddenEvent():e.onVisibleEvent()});return e}_create_class(Wr,[{key:"init",value:function init(){var e=this;var t=this.getBrowserPrefix(),o=[this.getVisibilityEvent(t),"focus","blur"];var c=true,l=false,d=void 0;try{var _loop=function(){var t=_.value;window.addEventListener(t,function(){e.handleVisibilityChange(t)},!1),document.addEventListener(t,function(){e.handleVisibilityChange(t)},!1)};for(var h=o[Symbol.iterator](),_;!(c=(_=h.next()).done);c=true)_loop()}catch(e){l=true;d=e}finally{try{if(!c&&null!=h.return)h.return()}finally{if(l)throw d}}GameSDK.extra&&"onPause"in GameSDK.extra&&GameSDK.extra.onPause(function(){e.handleVisibilityChange("blur")})}},{key:"isGameVisible",value:function isGameVisible(){return this.isVisible}},{key:"getHiddenPropertyName",value:function getHiddenPropertyName(e){return e?"".concat(e,"Hidden"):"hidden"}},{key:"getVisibilityEvent",value:function getVisibilityEvent(e){return"".concat(e||"","visibilitychange")}},{key:"getBrowserPrefix",value:function getBrowserPrefix(){var e=true,t=false,o=void 0;try{for(var c=this.browserPrefixes[Symbol.iterator](),l;!(e=(l=c.next()).done);e=true){var d=l.value;if(this.getHiddenPropertyName(d) in document)return d}}catch(e){t=true;o=e}finally{try{if(!e&&null!=c.return)c.return()}finally{if(t)throw o}}return""}},{key:"onVisibleEvent",value:function onVisibleEvent(){this.isVisible||(this.isVisible=!0,this.game.event.emit(o.Events.VISIBILITY_VISIBLE))}},{key:"onHiddenEvent",value:function onHiddenEvent(){this.isVisible&&(this.isVisible=!1,this.game.event.emit(o.Events.VISIBILITY_HIDDEN))}}]);return Wr}(c.Plugins.BasePlugin);var ii=/*#__PURE__*/function(e){_inherits(zr,e);function zr(){_class_call_check(this,zr);return _call_super(this,zr,arguments)}_create_class(zr,[{key:"loadAsync",value:function loadAsync(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){e.exception("Unsupported method");return[2]})})()}},{key:"showAsync",value:function showAsync(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){e.exception("This method is not implemented");return[2]})})()}},{key:"hideAsync",value:function hideAsync(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){e.exception("This method is not implemented");return[2]})})()}}]);return zr}(eD);var io=o.Plugins.Ads,ic=io.Status;var iu=/*#__PURE__*/function(e){_inherits(qr,e);function qr(){_class_call_check(this,qr);return _call_super(this,qr,arguments)}_create_class(qr,[{key:"showAsync",value:function showAsync(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,GameSDK.loadBannerAdAsync(e.placementId)];case 1:t.sent(),e.setStatus(ic.SHOWING);return[2]}})})()}},{key:"hideAsync",value:function hideAsync(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,GameSDK.hideBannerAdAsync(e.placementId)];case 1:t.sent(),e.setStatus(ic.IDLE);return[2]}})})()}}]);return qr}(ii);var il=o.Utils,id=il.Object,ih=o.Plugins.Ads,i_=ih.Status,iy=ih.Types,ip=ih.AdError,iv=ih.AdInstance,ig={NOT_LOADED:"not-loaded",LOADING:"loading",LOADED:"loaded",PENDING:"pending"},im=/*#__PURE__*/function(e){_inherits(I,e);function I(e,t){_class_call_check(this,I);var o;o=_call_super(this,I,[e,t]);u(o,"instance");u(o,"adServiceName","google");o.instance=null;return o}_create_class(I,[{key:"makeAdInstance",value:function makeAdInstance(){var e=this;return{getPlacementID:function(){return""},loadAsync:function(){return e.preloadAdPlacement()},showAsync:function(){return e.createAdPlacement()},hideAsync:function(){return Promise.resolve()},getAdServiceName:function(){return e.adServiceName}}}},{key:"preloadAdPlacement",value:function preloadAdPlacement(){return I._initStatus!==ig.LOADED?Promise.reject(new Error("Google Ads not initiated.")):I.isPreloadConfigReady?Promise.resolve():I.preloadPromise?I.preloadPromise:I.runPreloadAdConfig()}},{key:"createAdPlacement",value:function createAdPlacement(){switch(this.type){case iy.REWARDED_VIDEO:return this.createAdPlacementRewarded();case iy.INTERSTITIAL:return this.createAdPlacementInterstitial();default:return Promise.reject(new ip("UNSUPPORTED_AD_TYPE","Unsupported."))}}},{key:"createAdPlacementInterstitial",value:function createAdPlacementInterstitial(){return new Promise(function(e,t){window.adBreak({type:"next",name:"interstitialAd",beforeAd:function(){self.game.ads.hideBannerAdAsync()},adBreakDone:function(o){switch(self.game.ads.showBannerAdAsync(),o.breakStatus){case"dismissed":case"viewed":e();return;default:t(new ip(o.breakStatus,o.breakType));return}}})})}},{key:"createAdPlacementRewarded",value:function createAdPlacementRewarded(){return new Promise(function(e,t){window.adBreak({type:"reward",name:"rewardedAd",beforeReward:function(e){self.game.ads.hideBannerAdAsync(),e()},adViewed:function(){},adDismissed:function(){},adBreakDone:function(o){switch(self.game.ads.showBannerAdAsync(),o.breakStatus){case"dismissed":t(new ip("USER_INPUT","User dismissed."));return;case"viewed":e();return;default:t(new ip(o.breakStatus,o.breakType));return}}})})}},{key:"getStatus",value:function getStatus(){return this.status}},{key:"loadAsync",value:function loadAsync(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(o){switch(o.label){case 0:if(e.status!==i_.IDLE)return[3,4];o.label=1;case 1:o.trys.push([1,3,,4]);if(e.instance=e.makeAdInstance(),null===e.instance)throw new ip("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");return[4,e.instance.loadAsync()];case 2:o.sent(),e.type===iy.INTERSTITIAL&&self.game.analytics.loadInterstitialAd(e.adServiceName),e.type===iy.REWARDED_VIDEO&&self.game.analytics.loadRewardedVideoAd(e.adServiceName),e.status=i_.FILLED;return[3,4];case 3:t=o.sent();throw e.status=i_.IDLE,e.isAdTypeValid(e.type)&&self.game.analytics.loadAdFail(e.type,e.adServiceName),t;case 4:return[2]}})})()}},{key:"showAsync",value:function showAsync(){var e=this;return _async_to_generator(function(){var t,o;return _ts_generator(this,function(c){switch(c.label){case 0:t=!1;c.label=1;case 1:c.trys.push([1,3,4,5]);if(e.status!==i_.FILLED)throw new ip("AD_NOT_FILLED","Ads no fill.");if(e.status=i_.SHOWING,null===e.instance)throw new ip("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");return[4,e.instance.showAsync()];case 2:c.sent(),t=!0,e.status=i_.IDLE,e.instance=null;return[3,5];case 3:o=c.sent();throw _instanceof(o,Object)&&id.hasOwn(o,"code")?("noAdPreloaded"===o.code?e.status=i_.FILLED:(e.status=i_.IDLE,e.instance=null),"USER_INPUT"===o.code&&(e.status=i_.IDLE,e.instance=null,t=!0)):(e.status=i_.IDLE,e.instance=null),o;case 4:window.focus(),t?(e.type===iy.INTERSTITIAL&&self.game.analytics.showInterstitialAd(e.adServiceName),e.type===iy.REWARDED_VIDEO&&self.game.analytics.showRewardedVideoAd(e.adServiceName)):e.isAdTypeValid(e.type)&&self.game.analytics.showAdFail(e.type,e.adServiceName);return[7];case 5:return[2]}})})()}},{key:"isAdTypeValid",value:function isAdTypeValid(e){return Object.values(iy).includes(e)}}],[{key:"initStatus",get:function get(){return I._initStatus}},{key:"initGoogleAdsAsync",value:function initGoogleAdsAsync(e){return _async_to_generator(function(){return _ts_generator(this,function(t){"loaded"!==I.initStatus&&(I._initStatus=ig.LOADING,I.adsByGoogleConfig=e,I.loadScriptElementAsync(e));return[2]})})()}},{key:"configGoogleAdsOnInit",value:function configGoogleAdsOnInit(){return _async_to_generator(function(){return _ts_generator(this,function(e){window.adsbygoogle=window.adsbygoogle||[],window.adBreak=function(e){adsbygoogle.push(e)},window.adConfig=function(e){adsbygoogle.push(e)},I._initStatus=ig.LOADED,I.runPreloadAdConfig();return[2]})})()}},{key:"runPreloadAdConfig",value:function runPreloadAdConfig(){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2,(I.isPreloadingAdConfig=!0,I.preloadPromise=new Promise(function(e,t){window.adConfig({preloadAdBreaks:"on",onReady:function(){I.isPreloadConfigReady=!0,I.isPreloadingAdConfig=!1,e()}}),setTimeout(function(){I.isPreloadConfigReady||t(new Error("Failed to preload ad config in time."))},5e3)}),I.preloadPromise)]})})()}},{key:"loadScriptElementAsync",value:function loadScriptElementAsync(e){return new Promise(function(t,o){I.isPreloadingAdConfig=!0;var c=e.dataAdClient,l=e.dataAdHost,d=e.dataAdChannel,h=e.dataAdBreakTest,_=e.dataAdFrequencyHint;if(!c&&!l){I._initStatus=ig.NOT_LOADED,o(new Error("dataAdClient or dataAdHost is required."));return}var y=document.createElement("script");y.async=!0,y.setAttribute("data-ad-frequency-hint","".concat(_,"s")),c&&y.setAttribute("data-ad-client",c),d&&y.setAttribute("data-ad-channel",d),l&&y.setAttribute("data-ad-host",l),h&&y.setAttribute("data-adbreak-test","on");var f="";if(c||l){f="?";var p=[];c&&p.push("client=".concat(c)),l&&p.push("host=".concat(l)),f+=p.join("&")}y.src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js".concat(f),y.crossOrigin="anonymous",y.onload=function(){I.configGoogleAdsOnInit(),t(!0)},y.onerror=function(){I._initStatus=ig.NOT_LOADED,o(new Error("Failed to load Google Ads script."))};var v=document.createElement("script");v.text="window.adsbygoogle = window.adsbygoogle || []; var adBreak = adConfig = function(o) {adsbygoogle.push(o);}",document.head.appendChild(y),document.head.appendChild(v)})}},{key:"setGame",value:function setGame(e){self.game=e}}]);return I}(iv);u(im,"_initStatus",ig.NOT_LOADED),u(im,"isPreloadConfigReady",!1),u(im,"isPreloadingAdConfig",!1),u(im,"adsByGoogleConfig"),u(im,"preloadPromise");var iA=im;var iw=o.Utils,iI=iw.Object,ik=o.Plugins.Ads,ib=ik.Status,iS=ik.Types,iD=ik.AdError,iP=ik.AdInstance;var iE=/*#__PURE__*/function(e){_inherits(Ee,e);function Ee(e,t){_class_call_check(this,Ee);var o;o=_call_super(this,Ee,[e,t]);u(o,"instance");u(o,"interstitialAdInstanceList",[]);u(o,"rewardedVideoAdInstanceList",[]);u(o,"rewardedInterstitialAdInstanceList",[]);o.instance=null;return o}_create_class(Ee,[{key:"loadAsync",value:function loadAsync(){var e=this;return _async_to_generator(function(){var t,o;return _ts_generator(this,function(c){switch(c.label){case 0:if(e.instance&&e.status===ib.FILLED)return[2];if(e.status!==ib.IDLE)throw new iD("AD_NOT_READY","Ad is not ready.");t="unknown";c.label=1;case 1:c.trys.push([1,4,,5]);return[4,e.createInstanceByType(e.type)];case 2:if(e.instance=c.sent(),null===e.instance)throw new iD("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");t=e.instance.getAdServiceName(),e.setStatus(ib.LOADING);return[4,e.instance.loadAsync()];case 3:c.sent(),e.setStatus(ib.FILLED),e.logAdLoad();return[3,5];case 4:o=c.sent();throw e.setStatus(ib.IDLE),_instanceof(o,Object)&&"code"in o&&"INVALID_PARAM"===o.code&&(e.instance=null),e.instance&&e.pushInstanceToQueue(e.instance),self.game.analytics.loadAdFail(e.type,t),o;case 5:return[2]}})})()}},{key:"showAsync",value:function showAsync(){var e=this;return _async_to_generator(function(){var t,c,l;return _ts_generator(this,function(d){switch(d.label){case 0:if(e.status!==ib.FILLED)throw new iD("AD_NOT_FILLED","Ad is not filled.");if(null===e.instance)throw new iD("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");t=!1;c=e.instance.getAdServiceName();d.label=1;case 1:d.trys.push([1,3,4,5]);e.setStatus(ib.SHOWING),self.game.analytics.showingAd(e.type,c);return[4,e.instance.showAsync()];case 2:d.sent(),t=!0,e.setStatus(ib.IDLE),e.instance=null;return[3,5];case 3:l=d.sent();throw o.Utils.Object.hasOwn(l,"code")&&("AD_NOT_LOADED"===l.code&&e.setStatus(ib.IDLE),["INVALID_PARAM","INVALID_OPERATION","USER_INPUT"].indexOf("".concat(l.code))>-1&&(e.setStatus(ib.IDLE),e.instance=null),"USER_INPUT"===l.code&&(t=!0)),e.status===ib.SHOWING&&(e.setStatus(ib.IDLE),e.instance=null),l;case 4:t?e.logAdShown():self.game.analytics.showAdFail(e.type,c);return[7];case 5:return[2]}})})()}},{key:"createInstanceByType",value:function createInstanceByType(e){var t=this;return _async_to_generator(function(){var o;return _ts_generator(this,function(c){switch(c.label){case 0:c.trys.push([0,2,,3]);return[4,t.getAdInstanceByType(e)];case 1:return[2,c.sent()];case 2:o=c.sent();return[2,iI.hasOwn(o,"code")&&"ADS_TOO_MANY_INSTANCES"===o.code?t.getAdInstanceFailed(e):null];case 3:return[2]}})})()}},{key:"getAdInstanceByType",value:function getAdInstanceByType(e){var t=this;return _async_to_generator(function(){return _ts_generator(this,function(o){switch(o.label){case 0:switch(e){case iS.REWARDED_VIDEO:return[3,1];case iS.INTERSTITIAL:return[3,3];case iS.REWARDED_INTERSTITIAL:return[3,5]}return[3,7];case 1:return[4,GameSDK.getRewardedVideoAsync(t.placementId)];case 2:return[2,o.sent()];case 3:return[4,GameSDK.getInterstitialAdAsync(t.placementId)];case 4:return[2,o.sent()];case 5:return[4,GameSDK.getRewardedInterstitialAsync(t.placementId)];case 6:return[2,o.sent()];case 7:return[2,null];case 8:return[2]}})})()}},{key:"getAdInstanceFailed",value:function getAdInstanceFailed(e){var t=null;switch(e){case iS.INTERSTITIAL:t=this.interstitialAdInstanceList;break;case iS.REWARDED_VIDEO:t=this.rewardedVideoAdInstanceList;break;case iS.REWARDED_INTERSTITIAL:t=this.rewardedInterstitialAdInstanceList;break}if(null===t)return null;if(!("canBeLoadedAd"in GameSDK.extra))return t.shift()||null;var o=true,c=false,l=void 0;try{for(var d=t[Symbol.iterator](),h;!(o=(h=d.next()).done);o=true){var _=h.value;if(GameSDK.extra.canBeLoadedAd(_))return t.splice(t.indexOf(_),1),_}}catch(e){c=true;l=e}finally{try{if(!o&&null!=d.return)d.return()}finally{if(c)throw l}}return null}},{key:"logAdLoad",value:function logAdLoad(){var e="unknown";switch(this.instance&&(e=this.instance.getAdServiceName()),this.type){case iS.INTERSTITIAL:self.game.analytics.loadInterstitialAd(e);break;case iS.REWARDED_VIDEO:self.game.analytics.loadRewardedVideoAd(e);break;case iS.REWARDED_INTERSTITIAL:self.game.analytics.loadRewardedInterstitialAd(e);break}}},{key:"logAdShown",value:function logAdShown(){var e="unknown";switch(this.instance&&(e=this.instance.getAdServiceName()),this.type){case iS.INTERSTITIAL:self.game.analytics.showInterstitialAd(e);break;case iS.REWARDED_VIDEO:self.game.analytics.showRewardedVideoAd(e);break;case iS.REWARDED_INTERSTITIAL:self.game.analytics.showRewardedInterstitialAd(e);break}}},{key:"pushInstanceToQueue",value:function pushInstanceToQueue(e){var t=null;switch(this.type){case iS.INTERSTITIAL:t=this.interstitialAdInstanceList;break;case iS.REWARDED_VIDEO:t=this.rewardedVideoAdInstanceList;break;case iS.REWARDED_INTERSTITIAL:t=this.rewardedInterstitialAdInstanceList;break}t&&t.push(e)}}]);return Ee}(iP);var ix=o.Plugins.Analytics,iC=ix.BaseAnalytics,iN=ix.Events,iT=[iN.BUTTON_CLICK,iN.SCREEN_OPEN],iL=o.Utils,iO=iL.Array;var iR=/*#__PURE__*/function(e){_inherits(so,e);function so(e,t){_class_call_check(this,so);var o;o=_call_super(this,so,[e,"FacebookAnalytics",_object_spread_props(_object_spread({},t),{color:"#0F52BA"})]);u(o,"prefix");o.prefix=t.prefix;return o}_create_class(so,[{key:"processEvent",value:function processEvent(e,t){if(!("logEvent"in GameSDK.extra)||iO.has(iT,e))return;var o=this.addPrefixToEventName(e);GameSDK.extra.logEvent(o,1,t)}},{key:"addPrefixToEventName",value:function addPrefixToEventName(e){return"".concat(this.prefix,"_").concat(e)}}]);return so}(iC);var iM=o.Plugins.Analytics,iF=iM.BaseAnalytics,iG=iM.Events,ij=[iG.SCREEN_OPEN],iV=o.Utils,iB=iV.Array;var iU=/*#__PURE__*/function(e){_inherits(oo,e);function oo(e,t){_class_call_check(this,oo);return _call_super(this,oo,[e,"FirebaseAnalytics",_object_spread_props(_object_spread({},t),{color:"#FFCA28"})])}_create_class(oo,[{key:"setUser",value:function setUser(e,t){var o,c;null==(c=null==(o=this.game.firebase)?void 0:o.services.analytics)||c.setUser(e,t)}},{key:"processEvent",value:function processEvent(e,t){var o,c;iB.has(ij,e)||null==(c=null==(o=this.game.firebase)?void 0:o.services.analytics)||c.event(e,t)}}]);return oo}(iF);var iH=o.Plugins.Analytics,iK=iH.BaseAnalytics,iW=iH.Events,iz=[iW.SCREEN_OPEN],iq=o.Utils,iJ=iq.Array;var iY=/*#__PURE__*/function(e){_inherits(uo,e);function uo(e,t){_class_call_check(this,uo);return _call_super(this,uo,[e,"GoogleAnalytics",_object_spread_props(_object_spread({},t),{color:"#E35335"})])}_create_class(uo,[{key:"processEvent",value:function processEvent(e,t){iJ.has(iz,e)||(this.customEvent(e,t),gtag("event",e,t))}},{key:"customEvent",value:function customEvent(e,t){switch(e){case iW.AD_SHOW:case iW.AD_SHOW_FAILED:case iW.AD_SHOWING:case iW.USE_ITEM:case iW.EARN_ITEM:this.addLevelName(t);break}}},{key:"addLevelName",value:function addLevelName(e){if(!e||!(null!=game&&game.match))return;var t=game.match.getMatchState().customData.level;t<0||(e.level_name=this.getLevelName(t))}}]);return uo}(iK);var iX="production",iQ="0",iZ=o.Dtos,i$=o.Events,i0=o.Configs,i2=o.Utils,i3=i2.Object,i1=i2.Json,i4=i2.String,i5=i2.Valid,i6=i2.Mark;var i7=/*#__PURE__*/function(e){_inherits(mo,e);function mo(){_class_call_check(this,mo);var e;e=_call_super(this,mo,arguments);u(e,"markName","Core Initialize");u(e,"modulePlugins",[]);u(e,"handleProtectGameInstance",function(){var t=e.event.getEventEmitCount(_.MODULE_PLUGIN_READY),o=e.modulePlugins.length;t<o||(window.game=Object.freeze(window.game),y(window,"game"))});u(e,"initMonitorErrorPlugin",function(){var t;if(!e.monitorError)return;null==(t=window.disableSimpleTrackErrors)||t.call(window);var o=i0.Debugger,c=o.MonitorError,l=o.ListPlayerDevIds,d=c.ApiKey,h=c.Service,_=c.Feedback,y=c.TrackUser,f=c.FilterErrors,p=GameSDK.player.getID(),v=GameSDK.player.getName();p&&l.indexOf(p)>=0||(e.monitorError.configure({apiKey:d,service:h,feedback:_,trackUser:y,releaseStage:iX,buildVersion:"".concat(iQ)}),e.monitorError.setUser({id:p,name:v}),e.monitorError.addFilterErrors(f),e.monitorError.initFeedbackTrackErrors(),e.updateMonitorErrorUserAndMetadata(),e.processErrorsQueue())});u(e,"updateMonitorErrorUserAndMetadata",function(){e.event.catchUp(i$.PLAYER_INFO_LOADED,e.processWhenPlayerInfoLoaded)});u(e,"processErrorsQueue",function(){if(e.monitorError&&window.__errorQueue){var t=true,o=false,c=void 0;try{for(var l=window.__errorQueue[Symbol.iterator](),d;!(t=(d=l.next()).done);t=true){var h=d.value;if(_instanceof(h,Error))e.monitorError.sendException(h);else{var _=h||{message:"",code:"Unknown",stack:"Unknown stack"},y=_.message,f=_.code,p=_.stack,v=new Error(y||f);v.stack=p,e.monitorError.sendException(v)}}}catch(e){o=true;c=e}finally{try{if(!t&&null!=l.return)l.return()}finally{if(o)throw c}}window.__errorQueue=null}});u(e,"processWhenPlayerInfoLoaded",function(){if(!e.monitorError)return;var t=e.player.getPlayer(),o=t.playerId,c=t.name;e.monitorError.setUser({id:o,name:c}),e.monitorError.addMetadata({isFirstLogin:e.player.isFirstLogin()})});u(e,"handleSaveRemoteConfig",function(t){try{var o=_define_property({},t.type,t);e.player.setPlayerDataByName("remoteConfig",o)}catch(e){}});u(e,"handleUpdateGameCoreConfig",function(t){try{var c=t.id,l=t.type;if("GameCore"!==l)return;o.Configs=i3.merge(o.Configs,t.config);var d=o.Configs,h=d.Ads;e.ads.configure(h),e.event.emit(_.REMOTE_CONFIG_UPDATED,{id:c,type:l})}catch(e){}});u(e,"handleStorageCurrentRemoteConfig",function(){var t=e.player.getPlayerDataByKey("remoteConfig");if(t){for(var o in t)if(i3.hasOwn(t,o)){var c=t[o],l=i1.clone(c),d=new iZ.RemoteConfig.Data(l).toObject();e.remoteConfig.setRemoteConfig(d),e.remoteConfig.processUpdateConfig(d.id,d.type)}}});u(e,"initAdaptivePerformancePlugin",function(){if(!e.adaptivePerformance)return;var t=i1.clone(i0.AdaptivePerformance);e.adaptivePerformance.configure(t)});u(e,"processAfterSyncProfile",function(){var t=i0.Notification;t.Enabled&&e.updatePlayerProfileToNotificationService()});return e}_create_class(mo,[{key:"getBuildVersion",value:function getBuildVersion(){return Number.parseInt("".concat(iQ))||0}},{key:"boot",value:function boot(){var e=this;var t=this,_superprop_get_boot=function(){return _get(_get_prototype_of(mo.prototype),"boot",e)};return _async_to_generator(function(){return _ts_generator(this,function(e){_superprop_get_boot().call(t),t.addPlugins(),t.initEventPlugin(),t.event.emit(i$.CORE_BOOTING),t.initFirebasePlugin(),t.initMarkCoreInitialize(),i6.putAttr(t.markName,"Step","Init Plugins"),t.initAds(),t.initMatchPlugin(),t.initRemoteConfig(),i6.putAttr(t.markName,"Step","Load Lazy Plugins"),i5.isDebugger()||t.event.on(i$.MODULE_PLUGIN_READY,t.handleProtectGameInstance),t.addMonitorPlugin().then(t.initMonitorErrorPlugin),t.addAdaptivePerformancePlugin().then(t.initAdaptivePerformancePlugin),i6.putAttr(t.markName,"Step","Load Dev Plugins"),t.addDevPlugins();return[2]})})()}},{key:"start",value:function start(){var e=this;var t=this,_superprop_get_start=function(){return _get(_get_prototype_of(mo.prototype),"start",e)};return _async_to_generator(function(){var e;return _ts_generator(this,function(o){switch(o.label){case 0:_superprop_get_start().call(t),i6.putAttr(t.markName,"Step","Core Start"),t.event.emit(i$.CORE_STARTING),i6.putAttr(t.markName,"Step","Request Token");return[4,t.auth.requestToken()];case 1:o.sent(),i6.putAttr(t.markName,"Step","Init States");return[4,t.initState()];case 2:o.sent(),i6.putAttr(t.markName,"Step","Process Player Profile"),t.processPlayerProfile(),i6.putAttr(t.markName,"Step","Process Context Payload");return[4,t.context.detectContextSessionType()];case 3:o.sent(),t.context.detectContextGameMode();e=t.storage.getStorageData("context","sessionContextType");i6.putAttr(t.markName,"Context Mode",e||"Unknown"),i6.putAttr(t.markName,"Step","Init Analytics"),t.initGoogleAnalytics(),t.initFirebaseAnalytics(),t.initFacebookAnalytics(),i6.putAttr(t.markName,"Step","Core Ready"),i6.putAttr(t.markName,"Success","true"),i6.stop(t.markName),t.event.emit(i$.CORE_READY);return[2]}})})()}},{key:"addPlugins",value:function addPlugins(){this.installPlugin("Storage",ir),this.installPlugin("Event",tg),this.installPlugin("Ads",eC),this.installPlugin("Auth",eB),this.installPlugin("Audio",ej),this.installPlugin("Match",r5),this.installPlugin("Player",sv),this.installPlugin("Profile",s6),this.installPlugin("Context",e4),this.installPlugin("Language",t3),this.installPlugin("Analytics",eM),this.installPlugin("Visibility",is),this.installPlugin("Leaderboard",nh),this.installPlugin("DailyRewards",th),this.installPlugin("FrameCapture",tX),this.installPlugin("RemoteConfig",tm),"Proxy"in window&&this.installPlugin("Firebase",tm)}},{key:"installPlugin",value:function installPlugin(e,t,o){var c=arguments.length>2&&void 0!==o&&o;var l=i4.toCamelCase(i4.capitalize(e));this.plugins.install(e,t,!0,l),"Storage"!==e&&(c?this.emitModulePluginReady(e):this.emitCorePluginReady(e))}},{key:"addMonitorPlugin",value:function addMonitorPlugin(){var e=this;return _async_to_generator(function(){var o,c,l;return _ts_generator(this,function(h){switch(h.label){case 0:o=i0.Debugger,c=o.MonitorError;if(!c.Enabled)return[2];e.modulePlugins.push("MonitorError");return[4,d(/*#__PURE__*/_async_to_generator(function(){var e,o;return _ts_generator(this,function(c){switch(c.label){case 0:return[4,t.import("./bundle/monitor-error.js").then(function(e){return e.i})];case 1:e=c.sent(),o=e.default;return[2,{default:o}]}})}),void 0,t.meta.url)];case 1:l=h.sent().default;"function"==typeof l&&e.installPlugin("MonitorError",l,!0);return[2]}})})()}},{key:"addAdaptivePerformancePlugin",value:function addAdaptivePerformancePlugin(){var e=this;return _async_to_generator(function(){var o,c;return _ts_generator(this,function(l){switch(l.label){case 0:o=i0.AdaptivePerformance;if(!o.Enabled)return[2];e.modulePlugins.push("AdaptivePerformance");return[4,d(/*#__PURE__*/_async_to_generator(function(){var e,o;return _ts_generator(this,function(c){switch(c.label){case 0:return[4,t.import("./bundle/index.js")];case 1:e=c.sent(),o=e.default;return[2,{default:o}]}})}),void 0,t.meta.url)];case 1:c=l.sent().default;"function"==typeof c&&e.installPlugin("AdaptivePerformance",c,!0);return[2]}})})()}},{key:"addDevPlugins",value:function addDevPlugins(){var e=i0.Debugger,t=e.ListPlayerDevIds,o=GameSDK.player.getID();!o||t.indexOf(o)<0||(this.addConsolePlugin(),this.addProfilerPlugin(),this.addCanvasRecorderPlugin())}},{key:"addConsolePlugin",value:function addConsolePlugin(){var e=this;return _async_to_generator(function(){var o,c,l;return _ts_generator(this,function(h){switch(h.label){case 0:h.trys.push([0,2,,3]);o=i0.Debugger,c=o.Console;if(!c.Enabled)return[2];e.modulePlugins.push("Console");return[4,d(/*#__PURE__*/_async_to_generator(function(){var e,t;return _ts_generator(this,function(o){switch(o.label){case 0:return[4,Promise.resolve().then(function(){return tA})];case 1:e=o.sent(),t=e.default;return[2,{default:t}]}})}),void 0,t.meta.url)];case 1:l=h.sent().default;if("function"!=typeof l)throw new Error("ConsolePlugin is not a function");e.installPlugin("Console",l,!0),e.initConsolePlugin();return[3,3];case 2:h.sent();return[3,3];case 3:return[2]}})})()}},{key:"addProfilerPlugin",value:function addProfilerPlugin(){var e=this;return _async_to_generator(function(){var o,c,l;return _ts_generator(this,function(h){switch(h.label){case 0:h.trys.push([0,2,,3]);o=i0.Debugger,c=o.Profiler;if(!c.Enabled)return[2];e.modulePlugins.push("Profiler");return[4,d(/*#__PURE__*/_async_to_generator(function(){var e,t;return _ts_generator(this,function(o){switch(o.label){case 0:return[4,Promise.resolve().then(function(){return tA})];case 1:e=o.sent(),t=e.default;return[2,{default:t}]}})}),void 0,t.meta.url)];case 1:l=h.sent().default;if("function"!=typeof l)throw new Error("ProfilerPlugin is not a function");e.installPlugin("Profiler",l,!0),e.initProfilerPlugin();return[3,3];case 2:h.sent();return[3,3];case 3:return[2]}})})()}},{key:"addCanvasRecorderPlugin",value:function addCanvasRecorderPlugin(){var e=this;return _async_to_generator(function(){var o,c,l;return _ts_generator(this,function(h){switch(h.label){case 0:h.trys.push([0,2,,3]);o=i0.Debugger,c=o.CanvasRecorder;if(!c.Enabled)return[2];e.modulePlugins.push("CanvasRecorder");return[4,d(/*#__PURE__*/_async_to_generator(function(){var e,t;return _ts_generator(this,function(o){switch(o.label){case 0:return[4,Promise.resolve().then(function(){return tA})];case 1:e=o.sent(),t=e.default;return[2,{default:t}]}})}),void 0,t.meta.url)];case 1:l=h.sent().default;if("function"!=typeof l)throw new Error("CanvasRecorderPlugin is not a function");e.installPlugin("CanvasRecorder",l,!0),e.initCanvasRecorderPlugin();return[3,3];case 2:h.sent();return[3,3];case 3:return[2]}})})()}},{key:"emitCorePluginReady",value:function emitCorePluginReady(e){this.event.emit(_.CORE_PLUGIN_READY,{name:e})}},{key:"emitModulePluginReady",value:function emitModulePluginReady(e){this.event.emit(_.MODULE_PLUGIN_READY,{name:e})}},{key:"initEventPlugin",value:function initEventPlugin(){var e=i0.Debugger,t=e.EventLogging;t.Enabled&&this.event.enableLogEvent()}},{key:"initMatchPlugin",value:function initMatchPlugin(){this.match.setUseCPUProfile(!1)}},{key:"initAds",value:function initAds(){var e=o.Plugins,t=e.Ads;this.ads.configure(i0.Ads),this.initAdInstance(t,i0),this.initFallbackAds()}},{key:"initAdInstance",value:function initAdInstance(e,t){var o=t.Ads,c=o.InterstitialAdOptions,l=o.RewardedVideoAdOptions,d=o.RewardedInterstitialAdOptions,h=o.BannerDisplayAdOptions;var _=true,y=false,f=void 0;try{for(var p=c[Symbol.iterator](),v;!(_=(v=p.next()).done);_=true){var g=v.value;this.ads.setAdInstance(e.Types.INTERSTITIAL,g.PlacementId,iE)}}catch(e){y=true;f=e}finally{try{if(!_&&null!=p.return)p.return()}finally{if(y)throw f}}var m=true,A=false,k=void 0;try{for(var b=l[Symbol.iterator](),D;!(m=(D=b.next()).done);m=true){var P=D.value;this.ads.setAdInstance(e.Types.REWARDED_VIDEO,P.PlacementId,iE)}}catch(e){A=true;k=e}finally{try{if(!m&&null!=b.return)b.return()}finally{if(A)throw k}}var C=true,T=false,O=void 0;try{for(var R=d[Symbol.iterator](),M;!(C=(M=R.next()).done);C=true){var G=M.value;this.ads.setAdInstance(e.Types.REWARDED_INTERSTITIAL,G.PlacementId,iE)}}catch(e){T=true;O=e}finally{try{if(!C&&null!=R.return)R.return()}finally{if(T)throw O}}var V=true,H=false,W=void 0;try{for(var z=h[Symbol.iterator](),Y;!(V=(Y=z.next()).done);V=true){var Q=Y.value;this.ads.setAdInstance(e.Types.BANNER,Q.PlacementId,iu)}}catch(e){H=true;W=e}finally{try{if(!V&&null!=z.return)z.return()}finally{if(H)throw W}}}},{key:"initFallbackAds",value:function initFallbackAds(){var e=o.Plugins,t=e.Ads,c=i0.Ads,l=c.FallbackAdService;if("none"===l)return;if("google"===l){this.initGoogleAds();return}var d=i0.Ads,h=d.InterstitialAdOptions,_=d.RewardedVideoAdOptions,y=d.RewardedInterstitialAdOptions;var f=true,p=false,v=void 0;try{for(var g=h[Symbol.iterator](),m;!(f=(m=g.next()).done);f=true){var A=m.value;this.ads.setFallbackAdInstance(t.Types.INTERSTITIAL,A.PlacementId,iE)}}catch(e){p=true;v=e}finally{try{if(!f&&null!=g.return)g.return()}finally{if(p)throw v}}var k=true,b=false,D=void 0;try{for(var P=_[Symbol.iterator](),C;!(k=(C=P.next()).done);k=true){var T=C.value;this.ads.setFallbackAdInstance(t.Types.REWARDED_VIDEO,T.PlacementId,iE)}}catch(e){b=true;D=e}finally{try{if(!k&&null!=P.return)P.return()}finally{if(b)throw D}}var O=true,R=false,M=void 0;try{for(var G=y[Symbol.iterator](),V;!(O=(V=G.next()).done);O=true){var H=V.value;this.ads.setFallbackAdInstance(t.Types.REWARDED_INTERSTITIAL,H.PlacementId,iE)}}catch(e){R=true;M=e}finally{try{if(!O&&null!=G.return)G.return()}finally{if(R)throw M}}}},{key:"initGoogleAds",value:function initGoogleAds(){var e=o.Plugins,t=e.Ads,c=i0.Ads,l=c.AdServiceConfigs,d=l.Google;if(d){if("loaded"===iA.initStatus){this.ads.setFallbackAdInstance(t.Types.INTERSTITIAL,"interstitial",iA),this.ads.setFallbackAdInstance(t.Types.REWARDED_VIDEO,"rewarded_video",iA),this.ads.setFallbackAdInstance(t.Types.REWARDED_INTERSTITIAL,"rewarded_interstitial",iA);return}try{iA.setGame(this),iA.initGoogleAdsAsync(d),this.ads.setFallbackAdInstance(t.Types.INTERSTITIAL,"interstitial",iA),this.ads.setFallbackAdInstance(t.Types.REWARDED_VIDEO,"rewarded_video",iA),this.ads.setFallbackAdInstance(t.Types.REWARDED_INTERSTITIAL,"rewarded_interstitial",iA)}catch(e){}}}},{key:"initState",value:function initState(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(o){switch(o.label){case 0:o.trys.push([0,2,,3]);t=new sa(e);t.initContext();return[4,t.initPlayer()];case 1:o.sent();return[3,3];case 2:o.sent();return[3,3];case 3:return[2]}})})()}},{key:"initConsolePlugin",value:function initConsolePlugin(){this.console&&this.console.configure()}},{key:"initProfilerPlugin",value:function initProfilerPlugin(){this.profiler&&this.profiler.configure()}},{key:"initCanvasRecorderPlugin",value:function initCanvasRecorderPlugin(){if(!this.canvasRecorder)return;var e=i0.Debugger,t=e.CanvasRecorder,o=t.Options,c=o.Type,l=o.Quality,d=o.RecordFps,h=o.SyncFps;this.canvasRecorder.configure({type:c,quality:l,syncFps:h,recordFps:d});var _=document.querySelector("canvas");_&&this.canvasRecorder.setCanvas(_)}},{key:"initRemoteConfig",value:function initRemoteConfig(){var e=i0.RemoteConfig;if(!e.Enabled)return;var t=i1.clone(e);this.remoteConfig.configure(t),this.event.on(_.REQUEST_SAVE_CONFIG,this.handleSaveRemoteConfig),this.event.on(_.REQUEST_UPDATE_CONFIG,this.handleUpdateGameCoreConfig),this.event.catchUp(_.PLAYER_INFO_LOADED,this.handleStorageCurrentRemoteConfig)}},{key:"initFirebasePlugin",value:function initFirebasePlugin(){var e=i0.Firebase;if(!e.Enabled||!this.firebase)return;var t=i1.clone(e);this.firebase.configure(t),i6.setService(this.firebase.services.performance)}},{key:"initMarkCoreInitialize",value:function initMarkCoreInitialize(){i0.PerformanceMonitor.CoreFlows&&(i6.measure(this.markName),i6.putAttr(this.markName,"Build","".concat(iQ)),i6.putAttr(this.markName,"GameSDK",GameSDK.getSDKName()),i6.putAttr(this.markName,"Platform",GameSDK.getPlatform()),i6.putAttr(this.markName,"Success","false"),i6.start(this.markName))}},{key:"processPlayerProfile",value:function processPlayerProfile(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:t.trys.push([0,2,,3]);return[4,e.player.syncProfileToServer()];case 1:t.sent(),e.processAfterSyncProfile();return[3,3];case 2:t.sent();return[3,3];case 3:return[2]}})})()}},{key:"updatePlayerProfileToNotificationService",value:function updatePlayerProfileToNotificationService(){var e=this;return _async_to_generator(function(){var t,o,c,l,d,h,_;return _ts_generator(this,function(y){switch(y.label){case 0:y.trys.push([0,2,,3]);t=i0.AppId,o=e.player.getPlayer(),c=o.ASID,l=o.playerId,d=o.name,h=o.photo,_=o.locale;return[4,ew({appId:t,ASID:c,playerId:l,name:d,photo:h,locale:_})];case 1:y.sent();return[3,3];case 2:y.sent();return[3,3];case 3:return[2]}})})()}},{key:"initGoogleAnalytics",value:function initGoogleAnalytics(){var e;var t=null!==(e=i0.Analytics.GoogleAnalytics)&&void 0!==e?e:{},o=t.Enabled,c=t.ConsoleLog;o&&this.analytics.add(new iY(this.game,{log:!!c}))}},{key:"initFirebaseAnalytics",value:function initFirebaseAnalytics(){var e=this;var t;var o=null!==(t=i0.Analytics.FirebaseAnalytics)&&void 0!==t?t:{},c=o.Enabled,l=o.ConsoleLog;if(!c)return;var d=new iU(this.game,{log:!!l});this.analytics.add(d);var h="no_entry";GameSDK.getEntryPointAsync().then(function(e){h=e}).catch(function(e){}).finally(function(){var t=e.player.getPlayer(),o=t.playerId,c=t.locale,l=GameSDK.getEntryPointData()||{},_=l.fbig_ad_id,y=l.fbig_adset_id,f=l.fbig_campaign_id;d.setUser(o,{locale:c,ad_id:_,adset_id:y,campaign_id:f,traffic_source:h})})}},{key:"initFacebookAnalytics",value:function initFacebookAnalytics(){var e;var t=null!==(e=i0.Analytics.FacebookAnalytics)&&void 0!==e?e:{},o=t.Enabled,c=t.Prefix,l=t.ConsoleLog;o&&"string"==typeof c&&this.analytics.add(new iR(this.game,{prefix:c,log:!!l}))}}]);return mo}(c.Game);var i8=o.Configs,i9=i8.GameEngine,oe=i9.ForceDesktopDPR,oa=o.Utils,or=oa.Device,os=o.Events,oc=/*#__PURE__*/function(){var e=_async_to_generator(function(){var e,t;return _ts_generator(this,function(o){switch(o.label){case 0:e=new i7;window.game=e;t=20;window.__sdkLoadingCount<t&&(window.__sdkLoadingCount=t),window.__gameCoreStart=!0;return[4,e.boot()];case 1:o.sent(),e.event.catchUp(os.REQUEST_CORE_START,Ws),Io(e);return[2]}})});return function Ao(){return e.apply(this,arguments)}}(),Ws=function(){if(!window.__sdkInitiated){game.event.catchUp(os.GAME_SDK_READY,Ws);return}window.game.start();var e=25;window.__sdkLoadingCount<e&&(window.__sdkLoadingCount=e)},Io=function(e){var t=setInterval(function(){if(!window.__sdkInitiated)return;clearInterval(t);var o=10;window.__sdkLoadingCount<o&&(window.__sdkLoadingCount=o),e.event.emit(os.GAME_SDK_READY)},5)};!1!==oe&&or.isDesktop()&&"number"==typeof oe&&oe>0&&(window.devicePixelRatio=oe),oc()}}});