function _instanceof(n,r){if(null!=r&&"undefined"!=typeof Symbol&&r[Symbol.hasInstance])return!!r[Symbol.hasInstance](n);return n instanceof r}function _type_of(n){return n&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n}function _ts_generator(n,r){var i,a,u,f,y={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return f={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(f[Symbol.iterator]=function(){return this}),f;function verb(n){return function(r){return step([n,r])}}function step(f){if(i)throw new TypeError("Generator is already executing.");while(y)try{if(i=1,a&&(u=2&f[0]?a.return:f[0]?a.throw||((u=a.return)&&u.call(a),0):a.next)&&!(u=u.call(a,f[1])).done)return u;if(a=0,u)f=[2&f[0],u.value];switch(f[0]){case 0:case 1:u=f;break;case 4:y.label++;return{value:f[1],done:false};case 5:y.label++;a=f[1];f=[0];continue;case 7:f=y.ops.pop();y.trys.pop();continue;default:if(u=y.trys,!(u=u.length>0&&u[u.length-1])&&(6===f[0]||2===f[0])){y=0;continue}if(3===f[0]&&(!u||f[1]>u[0]&&f[1]<u[3])){y.label=f[1];break}if(6===f[0]&&y.label<u[1]){y.label=u[1];u=f;break}if(u&&y.label<u[2]){y.label=u[2];y.ops.push(f);break}if(u[2])y.ops.pop();y.trys.pop();continue}f=r.call(n,y)}catch(n){f=[6,n];a=0}finally{i=u=0}if(5&f[0])throw f[1];return{value:f[0]?f[1]:void 0,done:true}}}function _ts_values(n){var r="function"==typeof Symbol&&Symbol.iterator,i=r&&n[r],a=0;if(i)return i.call(n);if(n&&"number"==typeof n.length)return{next:function(){if(n&&a>=n.length)n=void 0;return{value:n&&n[a++],done:!n}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}System.register("chunks:///systems.js",["./Screens-fa8213f8.js","cc"],function(n,r){var i,a,u,f,y,g,_,E,A,b,w,k,C,R,T,D,F,I,N,L,M,x,O,P,G,B,U,H,V,z,q,W,j,Y,Q,K,J,Z,X,$,ee,et,en,er,ei,ea,es,eo,eu,ec,el;return{setters:[function(n){i=n.f,a=n.G,u=n.c,f=n.y,y=n.u,g=n.t,_=n.g,E=n.A,A=n.h,b=n.P,w=n.H,k=n.E,C=n.m,R=n.k,T=n.x,D=n.I,n.J,F=n.L,I=n.K,N=n.s,L=n.q,M=n.j,x=n.F,O=n.N,P=n.B,G=n.p,B=n.O,U=n.w},function(n){H=n.cclegacy,V=n.game,z=n.settings,q=n.Settings,W=n.AssetManager,j=n.director,Y=n.input,Q=n.Input,K=n.sys,J=n.macro,Z=n.DynamicAtlasManager,X=n.screen,$=n.math,ee=n.Director,et=n.View,en=n.ResolutionPolicy,er=n.profiler,ei=n.ImageAsset,ea=n.Texture2D,es=n.UIRenderer,eo=n.assetManager,eu=n.instantiate,ec=n.Vec3,el=n.Game}],execute:function(){H._RF.push({},"0b067Iz+iFJLJjNpsfblY7S","AdsManager",void 0);var n=GameCore,eh=n.Events,ed=n.Configs,ef=n.Utils.Time,ev=globalThis.game,ep=ev.ads,ey=ev.player,eg=ev.event,em=function(){function e(){var n=this;u(this,e),this.currentLayout="",this.handleShowBannerAds=function(r){r.sceneName!==f.BOOT_SCENE&&(ey.isFirstLogin()||(y.showBannerAds(),eg.off(eh.SCENE_LAUNCHED,n.handleShowBannerAds)))},this.handleWhenGameReady=g(function(){return _ts_generator(this,function(r){switch(r.label){case 0:return[4,n.handleShowInterstitialAdWhenGameReady()];case 1:r.sent();return[4,ef.sleepAsync(1e4)];case 2:r.sent(),y.preloadAds();return[2]}})}),this.handleShowInterstitialAdWhenGameReady=g(function(){var r,i,a,u,f,y,g,_;return _ts_generator(this,function(E){switch(E.label){case 0:r=ed.Ads,i=r.Enabled,a=r.ShowAdOnLoad;if(!i)return[3,6];u=a.Enabled,f=a.DelaySeconds,y=a.PlacementId;if(!u)return[3,6];E.label=1;case 1:E.trys.push([1,5,,6]);g=f>0;if(!g)return[3,3];return[4,ef.sleepAsync(1e3*f)];case 2:g=E.sent();E.label=3;case 3:_=ep.getAdByPlacementId(y);if(!_)return[2];return[4,n.showAdByConfig(_)];case 4:E.sent();return[3,6];case 5:E.sent();return[3,6];case 6:return[2]}})}),this.handleLayoutChanged=function(r){if(n.currentLayout!==r){n.currentLayout=r;var i=ed.Ads.BannerDisplayAdOptions;r!==_.Layout.Landscape?i.forEach(function(n){var r=n.PlacementId,i=n.Position;"bottom"===i||"top"===i?y.showBannerAd(r):y.hideBannerAd(r)}):y.showBannerAds()}}}var n;return i(e,[{key:"init",value:function(){this.listenEvents()}},{key:"listenEvents",value:function(){V.on(a.LAYOUT_CHANGED,this.handleLayoutChanged),eg.on(eh.SCENE_LAUNCHED,this.handleShowBannerAds),eg.catchUp(eh.GAME_READY,this.handleWhenGameReady)}},{key:"showAdByConfig",value:(n=g(function(n){var r,i;return _ts_generator(this,function(a){switch(a.label){case 0:a.trys.push([0,3,4,5]);r=n.type,i=n.placementId;return[4,ep.loadAdAsync(r,i)];case 1:a.sent(),E.muteAudio(!0);return[4,ep.showAdAsync(r,i)];case 2:a.sent();return[3,5];case 3:a.sent();return[3,5];case 4:V.resume(),E.muteAudio(!1);return[7];case 5:return[2]}})}),function(r){return n.apply(this,arguments)})}]),e}();H._RF.pop(),H._RF.push({},"43001Am3F9GVZjL3Nj2K44h","CoreManager",void 0);var e_=GameCore.Events,eE=globalThis.game.event,eS=function(){function e(){u(this,e)}return i(e,[{key:"init",value:function(){}},{key:"requestStart",value:function(){eE.emit(e_.REQUEST_CORE_START)}},{key:"onCoreBoot",value:function(n){eE.catchUp(e_.CORE_BOOTING,n)}},{key:"onCoreStart",value:function(n){eE.catchUp(e_.CORE_STARTING,n)}},{key:"onCoreReady",value:function(n){eE.catchUp(e_.CORE_READY,n)}}]),e}();H._RF.pop(),H._RF.push({},"b4ad5mMokdAa6EVNGzNedpF","EngineManager",void 0);var eA=GameCore,eb=eA.Events,ew=eA.Configs.GameEngine.DynamicAtlas,ek=eA.Utils,eC=ek.Valid,eR=ek.Device,eT=ek.Function,eD=globalThis.game.event,eF=function(){function e(){var n=this;u(this,e),this.handlePauseEngine=g(function(){return _ts_generator(this,function(n){V.isPaused();return[2]})}),this.handleResumeEngine=g(function(){return _ts_generator(this,function(n){V.isPaused();return[2]})}),this.handleResizeView=function(r){et.instance.resizeWithBrowserSize(!1);var i=r.width,a=r.height;n.resizeView(i,a)},this.handleViewResized=eT.throttle(function(n){n.width,n.height;et.instance.resizeWithBrowserSize(!0)},600)}var n;return i(e,[{key:"init",value:function(){this.overrideSettings(),this.setupAutoAtlas(),this.setupBatcherLimit(),this.setupDynamicAtlas(),this.setupAssetDownloader(),this.setupOptimalPipelines(),this.setupEngineRunningState(),this.listenEvents()}},{key:"listenEvents",value:function(){V.on(a.VIEW_RESIZE,this.handleResizeView),V.on(a.VIEW_RESIZED,this.handleViewResized)}},{key:"overrideSettings",value:function(){z.overrideSettings(q.Category.ENGINE,"debug",eC.isDebugger()),V.frameRate=eR.isDesktop()?60:48}},{key:"setupAutoAtlas",value:function(){W.instance.cacheAsset=!0}},{key:"setupAssetDownloader",value:function(){var n=W.instance.downloader;n.maxConcurrency=15,n.maxRequestsPerFrame=15}},{key:"getPipelineFlows",value:function(){var n,r;return null!==(n=null===(r=j.root)||void 0===r||null===(r=r.pipeline)||void 0===r?void 0:r.flows)&&void 0!==n?n:[]}},{key:"getRenderQueues",value:function(n){var r=this.getPipelineFlows()[0];return null!=r&&r.stages?r.stages[n].renderQueues:[]}},{key:"setupOptimalPipelines",value:(n=g(function(){var n,r;return _ts_generator(this,function(i){switch(i.label){case 0:W.instance.transformPipeline.remove(1);return[4,eC.isValueChangeAsync(function(){return!!j.root},!0,{timeout:1e4})];case 1:i.sent();n=this.getPipelineFlows();n.shift(),n.shift();r=this.getRenderQueues(0);r.shift(),r.shift();return[2]}})}),function(){return n.apply(this,arguments)})},{key:"setupEngineRunningState",value:function(){var n=this;Y.on(Q.EventType.TOUCH_START,this.handleResumeEngine),eD.catchUp(eb.GAME_READY,function(){eD.on(eb.VISIBILITY_HIDDEN,n.handlePauseEngine),eD.on(eb.VISIBILITY_VISIBLE,n.handleResumeEngine)})}},{key:"setupDynamicAtlas",value:function(){switch(K.os){case K.OS.IOS:this.setupDynamicAtlasForIOS();break;case K.OS.ANDROID:this.setupDynamicAtlasForAndroid();break;default:this.setupDynamicAtlasForDesktop()}}},{key:"setDynamicAtlas",value:function(n){var r=n.Enabled,i=n.AutoAtlasSize,a=n.MaxAtlasCount,u=n.MaxAtlasSize,f=n.MaxFrameSize;if(J.CLEANUP_IMAGE_CACHE=!1,Z.instance.enabled=r,Z.instance.textureSize=u,Z.instance.maxFrameSize=f,Z.instance.maxAtlasCount=a,Z.instance.textureBleeding=!0,i){var y=this.getMaxTextureSize();if(!y)return;Z.instance.maxAtlasCount=1,Z.instance.textureSize=y}}},{key:"getMaxTextureSize",value:function(){if(!j.root)return -1;var n=j.root.device.capabilities.maxTextureSize,r=1024;return n-r<=Z.instance.maxFrameSize?-1:n>8192?7168:n-r}},{key:"setupDynamicAtlasForIOS",value:function(){var n=ew.IOS;this.setDynamicAtlas(n)}},{key:"setupDynamicAtlasForAndroid",value:function(){var n=ew.Android;this.setDynamicAtlas(n)}},{key:"setupDynamicAtlasForDesktop",value:function(){var n=ew.Desktop;this.setDynamicAtlas(n)}},{key:"setupBatcherLimit",value:function(){J.BATCHER2D_MEM_INCREMENT=288,J.MAX_LABEL_CANVAS_POOL_SIZE=125}},{key:"resizeView",value:function(n,r){var i,u=window.devicePixelRatio,f=u>=2?2/u:1,y=Math.round(n*u*f),g=Math.round(r*u*f);null===(i=j.root)||void 0===i||i.resize(y,g),X.windowSize=new $.Size(y,g),j.once(ee.EVENT_AFTER_UPDATE,function(){V.emit(a.VIEW_RESIZED,{width:y,height:g})})}}]),e}();H._RF.pop();var eI,eN=new(function(){function e(){u(this,e),this._registry={},this._moduleCache={}}return i(e,[{key:"define",value:function(n,r,i){this._registry[n]={factory:r,resolveMap:i}}},{key:"require",value:function(n){return this._require(n)}},{key:"throwInvalidWrapper",value:function(n,r){throw new Error("Module '".concat(n,"' imported from '").concat(r,"' is expected be an ESM-wrapped CommonJS module but it doesn't."))}},{key:"_require",value:function(n,r){var i=this._moduleCache[n];if(i)return i.exports;var a={id:n,exports:{}};return this._moduleCache[n]=a,this._tryModuleLoad(a,n),a.exports}},{key:"_resolve",value:function(n,r){return this._resolveFromInfos(n,r)||this._throwUnresolved(n,r)}},{key:"_resolveFromInfos",value:function(n,r){var i,a;return n in cjsInfos?n:r&&null!==(i=null===(a=cjsInfos[r])||void 0===a?void 0:a.resolveCache[n])&&void 0!==i?i:void 0}},{key:"_tryModuleLoad",value:function(n,r){var i=!0;try{this._load(n,r),i=!1}finally{i&&delete this._moduleCache[r]}}},{key:"_load",value:function(n,r){var i=this._loadWrapper(r),a=i.factory,u=i.resolveMap,f=this._createRequire(n),y=u?this._createRequireWithResolveMap("function"==typeof u?u():u,f):f;a(n.exports,y,n)}},{key:"_loadWrapper",value:function(n){return n in this._registry?this._registry[n]:this._loadHostProvidedModules(n)}},{key:"_loadHostProvidedModules",value:function(n){return{factory:function(r,i,a){if("undefined"==typeof require)throw new Error("Current environment does not provide a require() for requiring '".concat(n,"'."));try{a.exports=require(n)}catch(r){throw new Error("Exception thrown when calling host defined require('".concat(n,"')."),{cause:r})}}}}},{key:"_createRequire",value:function(n){var r=this;return function(i){return r._require(i,n)}}},{key:"_createRequireWithResolveMap",value:function(n,r){return function(i){var a=n[i];if(a)return r(a);throw new Error("Unresolved specifier "+i)}}},{key:"_throwUnresolved",value:function(n,r){throw new Error("Unable to resolve ".concat(n," from ").concat(parent,"."))}}]),e}());function Ae(n){return(Ae="function"==typeof Symbol&&"symbol"==_type_of(Symbol.iterator)?function(n){return void 0===n?"undefined":_type_of(n)}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":void 0===n?"undefined":_type_of(n)})(n)}var eL="file:///C:/Tests/save-the-pets/node_modules/resize-observer-polyfill/dist/ResizeObserver.js";eN.define(eL,function(n,r,i,a,u){(function(r,a){"object"===Ae(n)&&void 0!==i?i.exports=a():"function"==typeof define&&define.amd?define(a):r.ResizeObserver=a()})(this,function(){var n=function(){if("undefined"!=typeof Map)return Map;function e(n,r){var i=-1;return n.some(function(n,a){return n[0]===r&&(i=a,!0)}),i}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(n){var r=e(this.__entries__,n),i=this.__entries__[r];return i&&i[1]},t.prototype.set=function(n,r){var i=e(this.__entries__,n);~i?this.__entries__[i][1]=r:this.__entries__.push([n,r])},t.prototype.delete=function(n){var r=this.__entries__,i=e(r,n);~i&&r.splice(i,1)},t.prototype.has=function(n){return!!~e(this.__entries__,n)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(n,r){void 0===r&&(r=null);for(var i=0,a=this.__entries__;i<a.length;i++){var u=a[i];n.call(r,u[1],u[0])}},t}()}(),r="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,i="undefined"!=typeof global&&global.Math===Math?global:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),a="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(i):function(n){return setTimeout(function(){return n(Date.now())},1e3/60)};var u=["top","right","bottom","left","width","height","size","weight"],f="undefined"!=typeof MutationObserver,y=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(n,r){var i=!1,u=!1,f=0;function s(){i&&(i=!1,n()),u&&c()}function o(){a(s)}function c(){var n=Date.now();if(i){if(n-f<2)return;u=!0}else i=!0,u=!1,setTimeout(o,r);f=n}return c}(this.refresh.bind(this),20)}return e.prototype.addObserver=function(n){~this.observers_.indexOf(n)||this.observers_.push(n),this.connected_||this.connect_()},e.prototype.removeObserver=function(n){var r=this.observers_,i=r.indexOf(n);~i&&r.splice(i,1),!r.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var n=this.observers_.filter(function(n){return n.gatherActive(),n.hasActive()});return n.forEach(function(n){return n.broadcastActive()}),n.length>0},e.prototype.connect_=function(){r&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),f?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){r&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(n){var r=n.propertyName,i=void 0===r?"":r;u.some(function(n){return!!~i.indexOf(n)})&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),o=function(n,r){for(var i=0,a=Object.keys(r);i<a.length;i++){var u=a[i];Object.defineProperty(n,u,{value:r[u],enumerable:!1,writable:!1,configurable:!0})}return n},c=function(n){return n&&n.ownerDocument&&n.ownerDocument.defaultView||i},g=p(0,0,0,0);function l(n){return parseFloat(n)||0}function d(n){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];return r.reduce(function(r,i){return r+l(n["border-"+i+"-width"])},0)}function h(n){var r=n.clientWidth,i=n.clientHeight;if(!r&&!i)return g;var a=c(n).getComputedStyle(n),u=function(n){for(var r={},i=0,a=["top","right","bottom","left"];i<a.length;i++){var u=a[i],f=n["padding-"+u];r[u]=l(f)}return r}(a),f=u.left+u.right,y=u.top+u.bottom,_=l(a.width),E=l(a.height);if("border-box"===a.boxSizing&&(Math.round(_+f)!==r&&(_-=d(a,"left","right")+f),Math.round(E+y)!==i&&(E-=d(a,"top","bottom")+y)),!function(n){return n===c(n).document.documentElement}(n)){var A=Math.round(_+f)-r,b=Math.round(E+y)-i;1!==Math.abs(A)&&(_-=A),1!==Math.abs(b)&&(E-=b)}return p(u.left,u.top,_,E)}var _="undefined"!=typeof SVGGraphicsElement?function(n){return _instanceof(n,c(n).SVGGraphicsElement)}:function(n){return _instanceof(n,c(n).SVGElement)&&"function"==typeof n.getBBox};function v(n){return r?_(n)?function(n){var r=n.getBBox();return p(0,0,r.width,r.height)}(n):h(n):g}function p(n,r,i,a){return{x:n,y:r,width:i,height:a}}var E=function(){function e(n){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=p(0,0,0,0),this.target=n}return e.prototype.isActive=function(){var n=v(this.target);return this.contentRect_=n,n.width!==this.broadcastWidth||n.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var n=this.contentRect_;return this.broadcastWidth=n.width,this.broadcastHeight=n.height,n},e}(),m=function(n,r){var i,a,u,f,y,g,_,E=(a=(i=r).x,u=i.y,f=i.width,y=i.height,g="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,_=Object.create(g.prototype),o(_,{x:a,y:u,width:f,height:y,top:u,right:a+f,bottom:y+u,left:a}),_);o(this,{target:n,contentRect:E})},A=function(){function t(r,i,a){if(this.activeObservations_=[],this.observations_=new n,"function"!=typeof r)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=r,this.controller_=i,this.callbackCtx_=a}return t.prototype.observe=function(n){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&_instanceof(Element,Object)){if(!_instanceof(n,c(n).Element))throw new TypeError('parameter 1 is not of type "Element".');var r=this.observations_;r.has(n)||(r.set(n,new E(n)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(n){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&_instanceof(Element,Object)){if(!_instanceof(n,c(n).Element))throw new TypeError('parameter 1 is not of type "Element".');var r=this.observations_;r.has(n)&&(r.delete(n),r.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var n=this;this.clearActive(),this.observations_.forEach(function(r){r.isActive()&&n.activeObservations_.push(r)})},t.prototype.broadcastActive=function(){if(this.hasActive()){var n=this.callbackCtx_,r=this.activeObservations_.map(function(n){return new m(n.target,n.broadcastRect())});this.callback_.call(n,r,n),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),b="undefined"!=typeof WeakMap?new WeakMap:new n,S=function e(n){if(!_instanceof(this,e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var r=y.getInstance(),i=new A(n,r,this);b.set(this,i)};return["observe","unobserve","disconnect"].forEach(function(n){S.prototype[n]=function(){var r;return(r=b.get(this))[n].apply(r,arguments)}}),void 0!==i.ResizeObserver?i.ResizeObserver:S}),eI=i.exports},{}),eN.require(eL),H._RF.push({},"9f0a0l1uXlNwqKEKardFRyv","LayoutManager",void 0);var eM=_.Layout,ex=_.DesignSize,eO=ex.Portrait,eP=ex.Landscape,eG=GameCore,eB=eG.Utils.Function,eU=eG.Configs.GameEngine,eH=eU.AutoResizeCanvas,eV=eU.AutoChangeOrientation,ez=function(){function e(){var n=this;u(this,e),this.currentLayout="",this.handleViewResizeBySystem=function(r){window.devicePixelRatio=r||window.devicePixelRatio,n.setupOrientationByScreenSize(),n.resizeGameView()},this.handleViewResize=eB.debounce(function(){n.setupOrientationByScreenSize(),n.resizeGameView()},300),this.handleBodyResize=eB.debounce(function(){n.resizeGameDiv()&&(n.setupOrientationByScreenSize(),n.resizeGameView())},300)}return i(e,[{key:"init",value:function(){this.listenResizeEvent(),this.listenObserverEvent(),this.setupResolutionPolicy()}},{key:"listenResizeEvent",value:function(){eH&&(X.on("window-resize",this.handleViewResize,this),X.on("orientation-change",this.handleViewResize,this)),V.on(a.REQUEST_VIEW_RESIZE,this.handleViewResizeBySystem)}},{key:"listenObserverEvent",value:function(){eH&&new eI(this.handleBodyResize).observe(document.body)}},{key:"setupResolutionPolicy",value:function(){eV&&(et.instance.resizeWithBrowserSize(!0),et.instance.setOrientation(J.ORIENTATION_AUTO),et.instance.setResolutionPolicy(en.ContentStrategy.FIXED_WIDTH),et.instance.setResolutionPolicy(en.ContainerStrategy.EQUAL_TO_FRAME),this.resolutionPolicy=et.instance.getResolutionPolicy())}},{key:"setupOrientationByScreenSize",value:function(){eV&&(this.getScreenRatio()<1?this.setPortraitView():this.setLandscapeView())}},{key:"resizeGameDiv",value:function(n){var r=arguments.length>0&&void 0!==n&&n,i=document.getElementById("GameDiv");if(!i)return!1;var a=A.getScreenWidthCss(),u=A.getScreenHeightCss(),f=i.getBoundingClientRect(),y=f.width,g=f.height;return!(a===y&&u===g&&!r)&&(i.style.width="".concat(a,"px"),i.style.height="".concat(u,"px"),!0)}},{key:"resizeGameView",value:function(){var n=A.getScreenWidthCss(),r=A.getScreenHeightCss();if(this.currentLayout===eM.Portrait){var i=Math.min(n/eO.WIDTH,r/eO.HEIGHT);n=eO.WIDTH*i,r=eO.HEIGHT*i}if(this.currentLayout===eM.Landscape){var u=Math.min(n/eP.WIDTH,r/eP.HEIGHT);n=eP.WIDTH*u,r=eP.HEIGHT*u}V.emit(a.VIEW_RESIZE,{width:n,height:r})}},{key:"setPortraitView",value:function(){var n=eO.WIDTH,r=eO.HEIGHT;this.currentLayout!==eM.Portrait&&(this.currentLayout=eM.Portrait,this.changeDesignResolutionSize(n,r))}},{key:"setLandscapeView",value:function(){var n=eP.WIDTH,r=eP.HEIGHT;this.currentLayout!==eM.Landscape&&(this.currentLayout=eM.Landscape,this.changeDesignResolutionSize(n,r))}},{key:"changeDesignResolutionSize",value:function(n,r){this.currentLayout,eM.Portrait,this.currentLayout,eM.Landscape;this.resolutionPolicy.setContentStrategy(en.ContentStrategy.FIXED_WIDTH),et.instance.setDesignResolutionSize(n,r,this.resolutionPolicy),V.emit(a.LAYOUT_CHANGED,this.currentLayout)}},{key:"getScreenRatio",value:function(){return A.getScreenWidthCss()/A.getScreenHeightCss()}}]),e}();H._RF.pop(),H._RF.push({},"d675ctpYslBHp4qqiYEki+q","PlayerManager",void 0);var eq=GameCore,eW=eq.Utils,ej=eq.Dtos,eY=eW.Valid,eQ=globalThis.game.player,eK=function(){function e(){u(this,e)}return i(e,[{key:"init",value:function(){}},{key:"setupDefaultGameData",value:function(){var n=ej.Player;n.Data.addDefaultData(b),n.GameData.addDefaultData(w),n.GameData.addValidateFunction("totalLevel",function(n){if(!eY.isNumber(n)||n<1)throw new Error("totalLevel ".concat(n," is invalid"))}),n.GameData.addValidateFunction("passAllLevels",function(n){if(!eY.isBoolean(n))throw new Error("passAllLevels ".concat(n," is invalid"))}),n.GameData.addValidateFunction("levelProgress",function(n){if(!eY.isObject(n))throw new Error("levelProgress ".concat(n," is invalid"))}),n.GameData.addValidateFunction("bestEndlessScore",function(n){if(!eY.isNumber(n)||n<0)throw new Error("bestEndlessScore ".concat(n," is invalid"))})}},{key:"requestConnectedPlayers",value:function(){eQ.requestConnectedPlayers().catch(function(n){})}}]),e}();H._RF.pop(),H._RF.push({},"c510204p3JAXLCuogskxTkP","AdaptivePerformance",void 0);var eJ=GameCore,eZ=eJ.Events,eX=eJ.Utils.Valid,e$=globalThis.game,e0=e$.event,e1=e$.adaptivePerformance,e2=function(){function e(){var n=this;u(this,e),this.handleBeginFrame=function(){j.on(ee.EVENT_AFTER_UPDATE,n.lateUpdate),j.on(ee.EVENT_BEFORE_UPDATE,n.updateActualFPS)},this.handleAfterSceneLaunch=function(n){e1&&e1.trackingScene(n.name)},this.handleRequestResizeGame=function(n){var r=n.forcePixelRatio;eX.isNumber(r)&&V.emit(a.REQUEST_VIEW_RESIZE,r)},this.lateUpdate=function(){var n=1e3*V.deltaTime;null==e1||e1.updatePostStepDeltaTime(n)},this.updateActualFPS=function(){var n,r=null===(n=j.root)||void 0===n?void 0:n.fps;eX.isNumber(r)&&(null==e1||e1.updateActualFPS(r))}}return i(e,[{key:"init",value:function(){e1&&this.listenEvents()}},{key:"listenEvents",value:function(){e0.on(eZ.REQUEST_RESIZE_GAME,this.handleRequestResizeGame),j.once(ee.EVENT_BEGIN_FRAME,this.handleBeginFrame),j.on(ee.EVENT_AFTER_SCENE_LAUNCH,this.handleAfterSceneLaunch)}}]),e}();H._RF.pop(),H._RF.push({},"0bbd4wf2fRDcKljBcls6K8a","CanvasRecorder",void 0);var e3=globalThis.game.canvasRecorder,e4=function(){function e(){u(this,e)}return i(e,[{key:"init",value:function(){if(V.canvas&&e3){e3.setCanvas(V.canvas);var n=e3.getOptions(),r=e3.waitNextFrame;e3.waitNextFrame=g(function(){var i;return _ts_generator(this,function(a){switch(a.label){case 0:if(!n.syncFps)return[3,1];i=new Promise(function(n){j.once(ee.EVENT_AFTER_RENDER,n),V.pause(),V.step()});return[3,3];case 1:V.resume();return[4,r.call(e3)];case 2:i=(a.sent(),Promise.resolve());a.label=3;case 3:return[2,i]}})})}}}]),e}();H._RF.pop(),H._RF.push({},"4a29byVcRpBGogGcAwYASiP","CocosStats",void 0);var e5=function(){function e(){var n=this;u(this,e),this.hideCocosStats=function(){clearInterval(n.waiter),n.waiter=setInterval(n.checkProfilerReady,100)},this.checkProfilerReady=function(){if(er){er._showFPS=!1;var r=er._rootNode;r&&(r.active=!1,r.isValid&&(r.destroyAllChildren(),r.removeAllChildren(),r.destroy(),clearInterval(n.waiter)))}}}return i(e,[{key:"init",value:function(){j.on(ee.EVENT_BEFORE_SCENE_LAUNCH,this.hideCocosStats)}}]),e}();H._RF.pop(),H._RF.push({},"49a72YoKFFCKbOm5Xgp9R+k","DynamicAssets",void 0);var e6=GameCore,e8=e6.Configs.GameEngine.DynamicAssets,e7=e6.Events,e9=e6.Utils.Array,te=globalThis.game,tt=te.event,tn=te.storage,tr=te.getBuildVersion,ti=[".png",".jpg",".jpeg",".webp"],ta=function(){function e(){var n=this;u(this,e),this.isProcessing=!1,this.useHighQuality=!1,this.upgradableAssets=new Map,this.handleSceneLaunched=function(n){var r=n.sceneName,i=[f.BOOT_SCENE];e9.has(i,r)||V.emit(a.CHANGE_QUALITY_ASSETS,{quality:"highest"})},this.requestUpdateDynamicAssets=function(){V.emit(a.UPGRADE_DYNAMIC_ATLAS,{force:!0})},this.collectUpgradableAssets=function(r){var i,a=r.output=r.input,u=e8.Resolution,f=u.Adjust,y=u.Original,g=R(a);try{for(g.s();!(i=g.n()).done;){var _=i.value;if(e9.has(ti,_.ext)&&!n.upgradableAssets.has(_.uuid)){n.useHighQuality?(_.url=n.replaceAssetUrl(_.url),_.resolution=y,_.upgradeOnNextRequest=!0):f<y&&(_.resolution=f);var E={ext:_.ext,url:_.url,uuid:_.uuid,options:_.options,upgraded:_.upgraded,resolution:_.resolution,upgradeOnNextRequest:_.upgradeOnNextRequest};n.upgradableAssets.set(_.uuid,E)}}}catch(n){g.e(n)}finally{g.f()}},this.replaceAssetUrl=function(r){return n.useHighQuality?r.replace("native/","native32/"):r},this.handleChangeQuality=g(function(){var r,i,a,u,f,y;return _ts_generator(this,function(g){switch(g.label){case 0:n.isProcessing=!0;i=[],a=R(n.upgradableAssets.values());try{for(a.s();!(r=a.n()).done;){u=r.value,f=n.processUpgradeQualityAsync(u);i.push(f)}}catch(n){a.e(n)}finally{a.f()}return[4,Promise.all(i)];case 1:y=g.sent();n.isProcessing=!1;y.filter(function(n){return n}).length;n.requestUpdateDynamicAssets();return[2]}})})}var n;return i(e,[{key:"init",value:function(){var n=e8.Enabled,r=e8.Resolution;n&&(W.instance.transformPipeline.insert(this.collectUpgradableAssets,2),this.initState(),this.listenEvents(),window.requestIdleCallback=window.requestIdleCallback||function(n){n()},r.Adjust,r.Original)}},{key:"initState",value:function(){var n=tr().toString();tn.addStorage("DynamicAssets",{useHighQuality:!1,buildVersion:"0"},!0);var r=tn.getStorage("DynamicAssets"),i=null!=r?r:{},a=i.buildVersion,u=i.useHighQuality;"boolean"==typeof u&&(this.useHighQuality=u&&a===n),tn.setStorageData("DynamicAssets","buildVersion",n),tn.updateToWebStorage("DynamicAssets")}},{key:"listenEvents",value:function(){var n=this;V.on(a.CHANGE_QUALITY_ASSETS,this.handleChangeQuality),setTimeout(function(){n.useHighQuality=!0,n.autoUpgradeQuality(),tt.on(e7.SCENE_LAUNCHED,n.handleSceneLaunched)},4e3)}},{key:"autoUpgradeQuality",value:function(){var n=this;requestIdleCallback(g(function(){var r;return _ts_generator(this,function(i){switch(i.label){case 0:if(!(!n.isProcessing&&!V.isPaused()))return[3,2];r=C(n.upgradableAssets.values()).find(function(n){return!n.upgraded&&!n.upgradeOnNextRequest});if(!r)return[2,(tn.setStorageData("DynamicAssets","useHighQuality",!0),tn.updateToWebStorage("DynamicAssets"),void n.requestUpdateDynamicAssets())];n.isProcessing=!0;return[4,n.processUpgradeQualityAsync(r)];case 1:i.sent(),n.isProcessing=!1,n.autoUpgradeQuality();i.label=2;case 2:return[2]}})}),{timeout:1e3})}},{key:"processUpgradeQualityAsync",value:(n=g(function(n){var r,i,u,f,y;return _ts_generator(this,function(g){r=this;if(n.upgraded||n.upgradeOnNextRequest)return[2,!0];i=W.instance,u=i.assets,f=i.loadAny,y=u.get(n.uuid);return[2,!!_instanceof(y,ei)&&(n.url=this.replaceAssetUrl(n.url),new Promise(function(i){f(n,n.options,function(u,f){if(u)return void i(!1);y.reset(f),n.upgraded=!0,r.upgradableAssets.set(n.uuid,n),V.emit(a.ASSET_QUALITY_CHANGE,{asset:y,item:n}),i(!0)})}))]})}),function(r){return n.apply(this,arguments)})}]),e}();H._RF.pop(),H._RF.push({},"15ecbqnx5lFtYRSJp2lOLCm","DynamicAtlas",void 0);var ts=GameCore,to=ts.Events,tu=ts.Configs.GameEngine.DynamicAtlas,tc=tu.UsePowerOfTwo,tl=tu.TextureAtlasOptimize,th=ts.Utils,td=th.Array,tf=th.Json,tv=th.Object,tp=th.Function,ty=globalThis.game.event,tg=function(){function e(){var n=this;u(this,e),this.atlasTexId=null,this.drawInfo=[],this.atlasInfo=null,this.lastAtlasInfo=null,this.renderTimes=[],this.lastRenderTime=0,this.renderTimeInterval=5e3,this.isEffective=!0,this.isProcessing=!1,this.forceUpdateDynamicAtlas=!1,this.collectInfo={},this.pendingSprites={},this.setupRenderListeners=function(){j.on(ee.EVENT_BEFORE_RENDER,n.updateBeforeRenderTime),j.on(ee.EVENT_AFTER_RENDER,n.updateAfterRenderTime),ty.once(to.SCENE_LAUNCHED,function(){j.once(ee.EVENT_AFTER_RENDER,n.checkRenderTimeHighers)})},this.checkRenderTimeHighers=function(){var r=n.getMeanRenderTime();r>8&&n.handleLaggyFrame(r),j.once(ee.EVENT_AFTER_RENDER,function(){setTimeout(n.checkRenderTimeHighers,n.renderTimeInterval)})},this.resetPendingSprites=function(){n.pendingSprites={}},this.updateBeforeRenderTime=function(){n.lastRenderTime=performance.now()},this.updateAfterRenderTime=function(){n.renderTimes.push(performance.now()-n.lastRenderTime)},this.requestUpdateDynamicAtlas=tp.throttle(function(r){n.isProcessing||(n.isProcessing=!0,n.forceUpdateDynamicAtlas=(null==r?void 0:r.force)||!1,j.once(ee.EVENT_AFTER_RENDER,n.updateDynamicAtlas))},5e3),this.updateDynamicAtlas=function(){try{var r=j.getScene();if(!r)return;var i=n.collectPackageInfo();if(Object.keys(i).length<1)return;if(n.drawInfo=[],n.atlasInfo=null,n.generateDrawInfo(tv.vals(i)),!n.atlasInfo)return;if(!n.updateAtlasData()&&!n.forceUpdateDynamicAtlas)return;var a=r.getComponentsInChildren(es);n.refreshComponents(a)}catch(n){}finally{n.isProcessing=!1,n.forceUpdateDynamicAtlas=!1}},this.generateDrawInfo=function(r){if(!(r.length<1)){var i=r.sort(function(n,r){return r.usageCount-n.usageCount}),a=Z.instance.textureSize;if(n.calculateOptimizedAtlas(i,a),n.atlasInfo){var u,f=n.atlasInfo.textures,y=R(f);try{for(y.s();!(u=y.n()).done;){var g=u.value;n.drawInfo.push(g)}}catch(n){y.e(n)}finally{y.f()}var _=i.filter(function(n){return!f.some(function(r){return r.id===n.id})});_.length>0&&n.generateDrawInfo(_)}}},this.calculateOptimizedAtlas=function(r,i){var a=function(n){var r,i=0,a=0,u=R(n);try{for(u.s();!(r=u.n()).done;){var f=r.value;i+=f.w*f.h,a=Math.max(a,f.w)}}catch(n){u.e(n)}finally{u.f()}n.sort(function(n,r){return r.h-n.h});var y,g=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),a),h:1/0}],_=0,E=0,A=R(n);try{for(A.s();!(y=A.n()).done;)for(var b=y.value,w=g.length-1;w>=0;w--){var k=g[w];if(!(b.w>k.w||b.h>k.h)){if(b.x=k.x,b.y=k.y,E=Math.max(E,b.y+b.h),_=Math.max(_,b.x+b.w),b.w===k.w&&b.h===k.h){var C=g.pop();w<g.length&&(g[w]=C)}else b.h===k.h?(k.x+=b.w,k.w-=b.w):b.w===k.w?(k.y+=b.h,k.h-=b.h):(g.push({x:k.x+b.w,y:k.y,w:k.w-b.w,h:b.h}),k.y+=b.h,k.h-=b.h);break}}}catch(n){A.e(n)}finally{A.f()}return{w:_,h:E,fill:i/(_*E)||0}}(r),u=a.w,f=a.h,y=a.fill;if(y<.6);else{if(u>i||f>i)return void(r.pop()&&n.calculateOptimizedAtlas(r,i));n.atlasInfo={textures:r,atlasSize:i,packedInfo:{width:Math.round(u),height:Math.round(f),fillRate:y}}}},this.drawTexture=function(r,i,a){var u=i.texture,f=u.image;if(!f||f.width<1||f.height<1);else if(!f.data||f.data.width<1||f.data.height<1);else{var y=u.getId(),g=td.search(C(n.drawInfo),function(n){return n.id===y})||{x:-1,y:-1},_=g.x,E=g.y;if(!(_<0||E<0)){var A=r._innerTextureInfos[y];A||(a&&(r._texture.drawTextureAt(f,_-1,E),r._texture.drawTextureAt(f,_+1,E),r._texture.drawTextureAt(f,_,E-1),r._texture.drawTextureAt(f,_,E+1)),r._texture.drawTextureAt(f,_,E),r._count++,r._innerTextureInfos[y]={texture:u,x:_,y:E});var b=i.rect,w=b.x,k=b.y;w+=(null==A?void 0:A.x)||_,k+=(null==A?void 0:A.y)||E;var R={texture:r._texture,x:w,y:k};return r._innerSpriteFrames.push(i),R}n.pendingSprites[i.uuid]=i}},this.refreshComponents=function(n){var r,i=R(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;a.node.active&&(a.node.active=!1,a.node.active=!0)}}catch(n){i.e(n)}finally{i.f()}},this.isSameAtlas=function(n,r){if(!n||!r)return!1;var i=n.packedInfo,a=n.textures,u=r.packedInfo,f=r.textures;return i.width===u.width&&i.height===u.height&&a.length===f.length&&a.every(function(n,r){var i=n.id,a=n.w,u=n.h,y=f[r]||{},g=y.id,_=y.w,E=y.h;return i===g&&a===_&&u===E})}}return i(e,[{key:"init",value:function(){tl&&(this.listenEvents(),this.overrideDynamicAtlas())}},{key:"listenEvents",value:function(){V.on(a.UPGRADE_DYNAMIC_ATLAS,this.requestUpdateDynamicAtlas),j.on(ee.EVENT_BEFORE_SCENE_LAUNCH,this.resetPendingSprites),ty.catchUp(to.GAME_READY,this.setupRenderListeners)}},{key:"handleLaggyFrame",value:function(n){this.isEffective||(this.renderTimeInterval=Math.min(this.renderTimeInterval+1e3,1e4)),this.requestUpdateDynamicAtlas()}},{key:"getMeanRenderTime",value:function(){var n,r=0,i=R(this.renderTimes);try{for(i.s();!(n=i.n()).done;)r+=n.value}catch(n){i.e(n)}finally{i.f()}return r/=this.renderTimes.length,this.renderTimes=[],r}},{key:"overrideDynamicAtlas",value:function(){var n=this,r=Z.instance;Z.instance.insertSpriteFrame=function(i){if(r._atlasIndex>=r._maxAtlasCount)return null;if(!i||i.original)return null;if(!i.packable)return null;var a=n.getAtlas(),u=a?a.insertSpriteFrame(i):null;return!u&&r._atlasIndex<r._maxAtlasCount&&(u=(a=n.getAtlas())?a.insertSpriteFrame(i):null),u}}},{key:"createAtlas",value:function(){return Z.instance.newAtlas()}},{key:"getAtlas",value:function(){var n=this,r=Z.instance,i=r._atlases,a=void 0===i?[]:i,u=r._atlasIndex,f=r.textureBleeding,y=a[u];return y||(y=this.createAtlas()),y?(y.originalInsertSpriteFrame||(y.originalInsertSpriteFrame=y.insertSpriteFrame,y.insertSpriteFrame=function(r){return n.drawTexture(y,r,f)}),this.atlasTexId=y._texture.getId(),y):null}},{key:"collectPackageInfo",value:function(){var n,r=tv.vals(this.pendingSprites),i={},a=R(r);try{for(a.s();!(n=a.n()).done;){var u=n.value;if(this.isValidSpriteFrame(u)){var f=u.texture,y=u.original,g=f.getId(),_=null==y?void 0:y._texture.getId();if(g!==_){_&&(g=_),this.collectInfo[g]||this.initializeCollectInfo(g,u);var E=this.collectInfo[g];E&&(E.usageCount++,i[g]=E)}}}}catch(n){a.e(n)}finally{a.f()}return i}},{key:"isValidSpriteFrame",value:function(n){var r=n.packable,i=n.texture,a=n.original;n.name,n.uuid;if(!r)return!1;if(!_instanceof(i,ea))return!1;var u=null==a?void 0:a._texture.getId();return this.atlasTexId!==u||!1}},{key:"initializeCollectInfo",value:function(n,r){var i=r.texture,a=r.original,u=r.uuid,f=i.width,y=i.height,g=(null==a?void 0:a._texture)||{width:0,height:0},_=g.width,E=g.height,A=Math.max(f,_)+2,b=Math.max(y,E)+2;A<=1||b<=1||(this.collectInfo[n]={id:n,w:A,h:b,x:-1,y:-1,usageCount:0,name:u})}},{key:"updateAtlasData",value:function(){if(!this.atlasInfo)return!1;if(this.lastAtlasInfo&&!this.forceUpdateDynamicAtlas){var n=this.isSameAtlas(this.lastAtlasInfo,this.atlasInfo);if(this.isEffective=!n,n)return!1}var r=this.getAtlas();if(!r||!r._texture)return!1;var i=this.atlasInfo.packedInfo,a=r._texture,u=a.width,f=a.height,y=i.width+20,g=i.height+20,_=Math.max(y,g),E=tc?_:y;return(u!==E||f!==E)&&(Z.instance.reset(),!(!(r=this.getAtlas())||!r._texture)&&(tc?r._texture.initWithSize(E,E):r._texture.initWithSize(y,g),this.lastAtlasInfo=tf.clone(this.atlasInfo),!0))}}]),e}();H._RF.pop(),H._RF.push({},"2f36c+IsKJAU5s61TqQdaJ6","HybridFileCache",void 0);var tm=GameCore,t_=tm.Events,tE=tm.Configs.GameEngine.HybridFileCache,tS=tE.Enabled,tA=tE.PreviewMode,tb=tE.BuildMode,tw=tm.Utils,tk=tw.Object,tC=tw.Function,tR=tw.Json,tT=globalThis.game,tD=tT.event,tF=tT.storage,tI=tT.getBuildVersion,tN=H.internal.CCON,tL=H.resources,tM=H.Material,tx=H.builtinResMgr,tO=W.instance,tP=tO.downloader,tG=tO.fetchPipeline,tB=function(){function e(){var n=this;u(this,e),this.supportTypes=[],this.bundledFiles={},this.originDownloaders={},this.downloadFile=function(r){return function(i,a,u){var f=n.getCache(r,i);if(f)return u(null,f);var y=n.getDownloader(r);if(!y)return u(new Error("Downloader not found"),null);y(i,a,function(a,f){return a||n.setCache(r,i,f),u(a,f)})}},this.clearCache=function(){tF.setStorageData("HybridFileCache","cachedFiles",void 0),tF.setStorageData("HybridFileCache","cachedExtensions",void 0),tF.updateToWebStorage("HybridFileCache")}}var n,r,f,y,_;return i(e,[{key:"init",value:(_=g(function(){return _ts_generator(this,function(n){switch(n.label){case 0:if(!(tS&&!k))return[3,2];return[4,this.initStorage()];case 1:n.sent(),this.checkCacheVersion(),this.initSupportedTypes(),this.setupOptimalPipelines(),this.saveOriginDownloaders(),this.registerCustomDownloader(),this.setupBundledFiles(),this.listenEvents();return[3,3];case 2:tD.emit(t_.BUNDLE_READY);n.label=3;case 3:return[2]}})}),function(){return _.apply(this,arguments)})},{key:"initStorage",value:(y=g(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:n=tI().toString();return[4,tF.addStorage("HybridFileCache",{buildVersion:n,cachedFiles:{},cachedBundles:{},cachedExtensions:{}},!0)];case 1:r.sent();return[2]}})}),function(){return y.apply(this,arguments)})},{key:"checkCacheVersion",value:function(){var n=tI().toString(),r=tF.getStorageData("HybridFileCache","buildVersion");tF.setStorageData("HybridFileCache","buildVersion",n),r!==n?this.clearCache():tF.updateToWebStorage("HybridFileCache")}},{key:"initSupportedTypes",value:function(){this.supportTypes=tb.SupportedExtensions}},{key:"setupBundledFiles",value:(f=g(function(){var n,r,i,a,u;return _ts_generator(this,function(f){switch(f.label){case 0:f.trys.push([0,,4,5]);r=[],i=R(this.supportTypes);try{for(i.s();!(n=i.n()).done;){a=n.value;this.getCachedBundles(a)||r.push(this.downloadBundledFile(a))}}catch(n){i.e(n)}finally{i.f()}u=r.length>0;if(!u)return[3,2];return[4,tC.allSettled(r)];case 1:u=f.sent();f.label=2;case 2:return[4,this.loadBundles()];case 3:f.sent();return[3,5];case 4:tD.emit(t_.BUNDLE_READY);return[7];case 5:return[2]}})}),function(){return f.apply(this,arguments)})},{key:"downloadBundledFile",value:(r=g(function(n){var r,i,a,u;return _ts_generator(this,function(f){switch(f.label){case 0:f.trys.push([0,3,,4]);r=n.replace(".",""),i="./cache/bundle".concat(r.toUpperCase(),".").concat(r);"bundle"===n&&(i="./cache/bundleBUNDLE.json");return[4,fetch(i,{method:"GET",headers:{"Content-Type":"application/json"}})];case 1:a=f.sent();return[4,a.json()];case 2:u=f.sent();this.setBundledCache(n,u);return[3,4];case 3:f.sent();return[3,4];case 4:return[2]}})}),function(n){return r.apply(this,arguments)})},{key:"loadBundles",value:(n=g(function(){var n,r,i,a,u;return _ts_generator(this,function(f){switch(f.label){case 0:n=this;f.label=1;case 1:f.trys.push([1,7,,8]);if(!this.supportTypes.includes("bundle"))return[2];r=[],i=function(){var i,f;return _ts_generator(this,function(y){i=u[a],f=new Promise(function(r,a){try{var u=n.getBundledCache("bundle","config:".concat(i));if(!u)return a(new Error("Bundle cache not found"));u.base="assets/".concat(i,"/");var f=eo.getBundle(i);f||(f="resources"===i?tL:new W.Bundle),f.init(tR.clone(u)),eo.bundles.add(i,f),n.loadBundleAssets(i,f).then(r).catch(a)}catch(n){a(n)}});r.push(f);return[2]})},a=0,u=["internal","main","resources","animation"];f.label=2;case 2:if(!(a<u.length))return[3,5];return[5,_ts_values(i())];case 3:f.sent();f.label=4;case 4:a++;return[3,2];case 5:return[4,tC.allSettled(r)];case 6:f.sent();return[3,8];case 7:f.sent();return[3,8];case 8:return[2]}})}),function(){return n.apply(this,arguments)})},{key:"loadBundleAssets",value:function(n,r){return new Promise(function(i,a){if("internal"!==n)return i([]);var u=Object.values(r.config.paths.map).map(function(n){return n[0].uuid});if(u.length<1)return i([]);eo.loadAny(u,{},function(n,r){if(n)a(n);else{var u,f=R(r);try{for(f.s();!(u=f.n()).done;){var y=u.value;tx.addAsset(y.name,y),_instanceof(y,tM)&&tx._materialsToBeCompiled.push(y)}}catch(n){f.e(n)}finally{f.f()}tx.compileBuiltinMaterial()}i(r)})})}},{key:"setupOptimalPipelines",value:function(){var n=this;if(tA.Enabled)tG.insert(function(r,i){r.output=r.input;for(var a=0;a<r.input.length;a++){var u=r.input[a];if(u.uuid&&!u.isNative){var f=n.getCacheExtension(u.uuid);f&&(u.isNative=!0,u.isCached=!0,u.url=u.url.replace(u.ext,f),u.ext=f)}}i()},1),tG.insert(function(r,i){r.output=r.input;for(var a=0;a<r.input.length;a++){var u=r.input[a];u.uuid&&(u.isCached?u.isNative=!1:u.isNative||n.setCacheExtension(u.uuid,u.ext))}i()},3)}},{key:"saveOriginDownloaders",value:function(){var n,r=R(this.supportTypes);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.originDownloaders[i]=tP._downloaders[i]}}catch(n){r.e(n)}finally{r.f()}}},{key:"registerCustomDownloader",value:function(){var n,r=R(this.supportTypes);try{for(r.s();!(n=r.n()).done;){var i=n.value;tP.register(i,this.downloadFile(i))}}catch(n){r.e(n)}finally{r.f()}}},{key:"listenEvents",value:function(){tD.on(t_.SCENE_LOADED,function(){tF.updateToWebStorage("HybridFileCache")}),V.on(a.CLEAR_HYBRID_FILE_CACHE,this.clearCache)}},{key:"getDownloader",value:function(n){var r;return null!==(r=this.originDownloaders[n])&&void 0!==r?r:null}},{key:"getCacheKey",value:function(n,r){var i=r.match(/.*\/([-a-z0-9@]+)\.([^\.]+)$/);if(!i)return null;var a=T(i,3),u=(a[0],a[1]),f=a[2];return!f||n.indexOf(f)<0?null:"".concat(u,":").concat(n)}},{key:"validateDataType",value:function(n,r){Array.isArray(r)&&tk.hasOwn(r[0],"__type__");return!(".cconb"===n&&tk.hasOwn(r,"chunks")&&!(Array.isArray(r.chunks)&&_instanceof(r,tN)))}},{key:"encodeData",value:function(n,r){return".cconb"===n?tk.hasOwn(r,"_document")&&tk.hasOwn(r,"_chunks")?new tN(r._document,r._chunks):null:r}},{key:"decodeData",value:function(n,r){if(".cconb"===n){if(!tk.hasOwn(r,"_document")||!tk.hasOwn(r,"_chunks"))return null;var i,a=[],u=R(r._chunks);try{for(u.s();!(i=u.n()).done;){var f=i.value;_instanceof(f,Uint8Array)?a.push(f):a.push(new Uint8Array(Object.values(f)))}}catch(n){u.e(n)}finally{u.f()}return new tN(r._document,a)}return r}},{key:"setCache",value:function(n,r,i){var a=this.getCacheKey(n,r);if(a&&this.validateDataType(n,i)){var u=this.encodeData(n,i);tF.setStorageData("HybridFileCache","cachedFiles",D({},a,u))}}},{key:"getCache",value:function(n,r){var i=this.getCacheKey(n,r);if(!i)return null;var a=this.getFileCaches()[i];return a||(a=this.getBundledCache(n,i)),a?this.decodeData(n,a):null}},{key:"getFileCaches",value:function(){return tF.getStorageData("HybridFileCache","cachedFiles")}},{key:"getCachedBundles",value:function(n){var r=tF.getStorageData("HybridFileCache","cachedBundles");if(!r)return null;var i=tR.clone(r[n]);return i?(this.bundledFiles[n]=i,i):null}},{key:"getBundledCache",value:function(n,r){var i,a=this.bundledFiles[n];return a&&null!==(i=a[r.replace(":".concat(n),"")])&&void 0!==i?i:null}},{key:"setBundledCache",value:function(n,r){var i=tR.clone(r);this.bundledFiles[n]=i,tF.setStorageData("HybridFileCache","cachedBundles",D({},n,i))}},{key:"getCacheExtension",value:function(n){return this.getCachedExtensions()[n]}},{key:"setCacheExtension",value:function(n,r){tF.setStorageData("HybridFileCache","cachedExtensions",D({},n,r))}},{key:"getCachedExtensions",value:function(){return tF.getStorageData("HybridFileCache","cachedExtensions")}}]),e}();H._RF.pop();var tU={text:{level:"Level",settings:"SETTINGS",music:"Music",sound:"Sound",vibrate:"Vibrate",resume:"CONTINUE",on:"ON",off:"OFF",notification:"Notification",adsNotComplete:"Sorry, No Rewards!\nYou have cancelled the ad!",loadingAds:"Loading ads...",loading:"Loading...",load:"Loading",rewardNotReady:"No ads to display!",next:"NEXT",completed:"COMPLETED",tryAgain:"TRY AGAIN",retry:"RETRY",congratulation:"CONGRATULATION",you_have_pass_all_levels:"You have passed all levels.",please_come_back_later:"Please come back later,\nwe will update soon!",start_over:"START OVER",confirmation:"CONFIRMATION",are_you_sure_to_start_over:"ARE YOU SURE TO START OVER?",you_will_play_the_game_again:"You will play the game again\nfrom the beginning, at level 1.",no:"NO",yes:"YES"},texture:{image:"image"}};H._RF.push({},"14b76Yew19JgY7K+L9F5mmu","Languages",void 0);var tH=GameCore.Events,tV=globalThis.game,tz=tV.event,tq=tV.language,tW=function(){function e(){var n=this;u(this,e),this.handleLanguageChanged=function(){var r=g(function(r){var i;return _ts_generator(this,function(a){i=r.locale;V.emit("update-language",i),n.updateComponentInEditor();return[2]})});return function(n){return r.apply(this,arguments)}}()}var n,a,f;return i(e,[{key:"init",value:function(){var n=this;this.addLanguage("en").then(function(){n.setLanguage("en"),n.listenEvent()})}},{key:"listenEvent",value:function(){tz.on(tH.LANGUAGE_CHANGED,this.handleLanguageChanged)}},{key:"addLanguage",value:(f=g(function(n){var r;return _ts_generator(this,function(i){switch(i.label){case 0:return[4,this.getLangData(n)];case 1:r=i.sent();tq.add(n,r);return[2]}})}),function(n){return f.apply(this,arguments)})},{key:"setLanguage",value:function(n){tq.choose(n)}},{key:"getLangData",value:(a=g(function(n){return _ts_generator(this,function(r){switch(n){case"en":return[2,tU];case"ru":return[2,this.loadLanguageAsync(n)];default:throw new Error("Language ".concat(n," not supported"))}return[2]})}),function(n){return a.apply(this,arguments)})},{key:"loadLanguageAsync",value:(n=g(function(n){var i;return _ts_generator(this,function(a){switch(a.label){case 0:return[4,r.import("db://assets/resources/locales/".concat(n,".json"))];case 1:i=a.sent().default;tq.add(n,i);return[2]}})}),function(r){return n.apply(this,arguments)})},{key:"updateComponentInEditor",value:function(){}}]),e}();H._RF.pop(),H._RF.push({},"fb33bK/6Y5FAas5AwmmBM/X","Leaderboards",void 0);var tj=GameCore,tY=tj.Configs,tQ=tj.Utils,tK=tY.Mockup,tJ=tQ.Number,tZ=globalThis.game.leaderboard,tX=function(){function e(){u(this,e)}var n,r,a,f;return i(e,[{key:"init",value:function(){tK.Leaderboards.Enabled?this.setupLeaderboardsMockup():this.setupLeaderboards()}},{key:"setupLeaderboards",value:(f=g(function(){return _ts_generator(this,function(n){this.setupLeaderboardByConfigs();return[2]})}),function(){return f.apply(this,arguments)})},{key:"setupLeaderboardByConfigs",value:function(){var n=tY.Leaderboards.LeaderboardId;n&&(tZ.addLeaderboard({name:F.GLOBAL,type:"global",autoSortRank:!0,leaderboardId:n}),tZ.addLeaderboard({name:F.FRIENDS,type:"friends",autoSortRank:!0,leaderboardId:n}))}},{key:"setupLeaderboardsMockup",value:(a=g(function(){return _ts_generator(this,function(n){this.setupMockGlobalLeaderboard(),this.setupMockFriendsLeaderboard();return[2]})}),function(){return a.apply(this,arguments)})},{key:"setupMockGlobalLeaderboard",value:(r=g(function(){var n,r,i;return _ts_generator(this,function(a){switch(a.label){case 0:n=F.GLOBAL,r=I.GLOBAL;return[4,tZ.createLeaderboardAsync({_id:r,name:n,numberOfLeaders:100})];case 1:i=a.sent();tZ.addLeaderboard({name:n,type:"global",autoSortRank:!0,leaderboardId:i});return[2]}})}),function(){return r.apply(this,arguments)})},{key:"setupMockFriendsLeaderboard",value:(n=g(function(){var n,r,i,a,u;return _ts_generator(this,function(f){switch(f.label){case 0:n=F.FRIENDS,r=I.FRIENDS,i=0,a=tK.GameSDK.Player.ConnectedPlayers;a.Enabled&&(i=tJ.random(a.NumOfPlayers));return[4,tZ.createLeaderboardAsync({_id:r,name:n,numberOfLeaders:i})];case 1:u=f.sent();tZ.addLeaderboard({name:n,type:"friends",autoSortRank:!0,leaderboardId:u});return[2]}})}),function(){return n.apply(this,arguments)})}]),e}();H._RF.pop(),H._RF.push({},"e7bf73g4jJGuI9FqvW5YBsS","PerformanceMonitor",void 0);var t$=GameCore,t0=t$.Utils,t1=t$.Events,t2=t$.Configs.PerformanceMonitor.FpsTracking,t3=globalThis.game.event,t4=function(){function e(){var n=this;u(this,e),this.markName="FPS Tracking",this.handleStartTraceFps=function(){n.startTraceFps(),j.on(ee.EVENT_AFTER_UPDATE,n.handleLateUpdate)},this.handleLateUpdate=function(){if(n.mark){if(n.fpsTraceDuration-=V.deltaTime,n.fpsTraceDuration<=0&&!n.traceStopped)return n.traceStopped=!0,n.unListenEvents(),n.updateFPS(),void n.mark.stop(n.markName);n.fpsTraceIntervalTimer-=V.deltaTime,n.fpsTraceIntervalTimer>0||(n.fpsTraceIntervalTimer=n.fpsTraceInterval,n.updateFPS(),n.mark.stop(n.markName),n.startTraceFps())}}}return i(e,[{key:"mark",get:function(){return t2.Enabled?t0.Mark:null}},{key:"init",value:function(){var n=t2.TrackingDuration,r=t2.TrackingInterval;this.fpsTraceDuration=null!=n?n:60,this.fpsTraceInterval=null!=r?r:10,this.fpsTraceIntervalTimer=this.fpsTraceInterval,this.traceStopped=!1,this.listenEvents()}},{key:"listenEvents",value:function(){t3.catchUp(t1.GAME_READY,this.handleStartTraceFps)}},{key:"unListenEvents",value:function(){j.off(ee.EVENT_AFTER_UPDATE,this.handleLateUpdate)}},{key:"startTraceFps",value:function(){this.mark&&(this.mark.measure(this.markName),this.mark.start(this.markName))}},{key:"updateFPS",value:function(){var n,r;if(this.mark){var i=this.getFPS(),a=this.getDrawCalls(),u=this.getDeviceRender(),f=this.getTextureMemory();this.minFps=Math.min(null!==(n=this.minFps)&&void 0!==n?n:i,i),this.maxFps=Math.max(null!==(r=this.maxFps)&&void 0!==r?r:0,i),this.mark.putMetric(this.markName,"FPS Metric",i),this.mark.putAttr(this.markName,"Page Title",document.title),this.mark.putAttr(this.markName,"Device Render",u),this.mark.putAttr(this.markName,"Draw Calls",a.toString()),this.mark.putAttr(this.markName,"Texture Memory",f.toFixed(2)),this.mark.putAttr(this.markName,"Min FPS",this.minFps.toString()),this.mark.putAttr(this.markName,"Max FPS",this.maxFps.toString())}}},{key:"getFPS",value:function(){if(!j.root)return 0;var n=j.root.fps;return Math.floor(n)||0}},{key:"getDrawCalls",value:function(){return j.root&&j.root.device.numDrawCalls||0}},{key:"getDeviceRender",value:function(){return j.root&&j.root.device.renderer||"Unknown"}},{key:"getTextureMemory",value:function(){return j.root&&j.root.device.memoryStatus.textureSize/1048576||0}}]),e}();H._RF.pop(),H._RF.push({},"58248LBip1DBrMjK0UWw2rM","RemoteConfig",void 0);var t5=GameCore.Events,t6=globalThis.game.event,t8=function(){function e(){u(this,e),this.handleHotReload=function(){V.restart()},this.handleUpdateConfig=function(n){if("Gameplay"===n.type){V.emit(a.GAMEPLAY_UPDATE_CONFIG,n.config);var r=n.id,i=n.type;t6.emit(t5.REMOTE_CONFIG_UPDATED,{id:r,type:i})}}}return i(e,[{key:"init",value:function(){this.listenEvents()}},{key:"listenEvents",value:function(){t6.on(t5.REQUEST_HOT_RELOAD,this.handleHotReload),t6.on(t5.REQUEST_UPDATE_CONFIG,this.handleUpdateConfig)}}]),e}();H._RF.pop(),H._RF.push({},"c34a93D1BREiKms1T21AkQS","PluginsManager",void 0);var t7=function(){function e(){u(this,e)}return i(e,[{key:"init",value:function(){this.initCocosStats(),this.initDynamicAtlas(),this.initHybridFileCache()}},{key:"initLanguages",value:function(){(new tW).init()}},{key:"initCocosStats",value:function(){(new e5).init()}},{key:"initLeaderboards",value:function(){(new tX).init()}},{key:"initRemoteConfig",value:function(){(new t8).init()}},{key:"initDynamicAtlas",value:function(){(new tg).init()}},{key:"initDynamicAssets",value:function(){(new ta).init()}},{key:"initHybridFileCache",value:function(){(new tB).init()}},{key:"initCanvasRecorder",value:function(){(new e4).init()}},{key:"initPerformanceMonitor",value:function(){(new t4).init()}},{key:"initAdaptivePerformance",value:function(){(new e2).init()}}]),e}();H._RF.pop(),H._RF.push({},"ac8b03T+rFB061sXoEEsCUH","SceneManager",void 0);var t9=globalThis.game,ne=t9.event,nt=t9.monitorError,nn=GameCore,nr=nn.Events,ni=nn.Configs.PerformanceMonitor,na=nn.Utils.Mark,ns=function(){function e(){var n=this;u(this,e),this.markName="Load Scene",this.testScene={},this.queueLoadScene={},this.callbackSwitchScene=null,this.switchScene=function(){var r=g(function(r){var i,a,u;return _ts_generator(this,function(f){i=r.sceneName,a=r.sceneData,u=n.correctSceneName(i);u&&(L.showLoadingFullScreen(u),n.startScene({sceneName:u,sceneData:a}));return[2]})});return function(n){return r.apply(this,arguments)}}(),this.preloadScene=function(r,i){var a=r.sceneName;n.startMeasure(r),j.preloadScene(a,n.onSceneProgress,n.onScenePreloaded(a,i))},this.startMeasure=function(r){if(n.mark){var i=r.sceneName;r.startScene;n.queueLoadScene[i]&&(n.mark.putAttr(n.markName,"Canceled","true"),n.stopMeasure(i)),n.mark.measure(n.markName),n.mark.putAttr(n.markName,"Cancel","false"),n.mark.putAttr(n.markName,"Success","false"),n.mark.putMetric(n.markName,i),n.mark.start(n.markName),n.queueLoadScene[i]=!0}},this.stopMeasure=function(r){n.mark&&n.queueLoadScene[r]&&(n.mark.rmAttr(n.markName,"File"),n.mark.putAttr(n.markName,"Success","true"),n.mark.stop(n.markName),n.queueLoadScene[r]=!1)},this.onSceneProgress=function(r,i,a){var u=r/i;n.mark&&n.mark.putAttr(n.markName,"Last File","".concat(a.id," (").concat(a.ext,")"));var f=Math.floor(70*u+30);GameSDK.setLoadingProgress(f)},this.onScenePreloaded=function(n,r){return function(i){i||(r&&r(n,i),ne.emit(nr.SCENE_LOADED,{sceneName:n,isPreload:!0}))}},this.onDirectorLoadScene=function(r){return function(i,a){if(i);else if(null!=a&&a.scene){var u=a.name;n.handleBeforeSceneLaunch(a,r)(),j.once(ee.EVENT_AFTER_SCENE_LAUNCH,n.handleSceneLaunched(u,r))}}},this.handleBeforeSceneLaunch=function(r,i){return function(){n.setSceneData(r,null!=i?i:{}),V.emit(a.REQUEST_VIEW_RESIZE),ne.emit(nr.SCENE_LOADED,{sceneName:r.name})}},this.handleSceneLaunched=function(r,i){return function(){var a;L.hideLoadingFullScreen(r),M.switchSceneTracking(),null==nt||nt.addMetadata({currentScene:r}),null===(a=n.callbackSwitchScene)||void 0===a||a.call(n,{sceneName:r,sceneData:i}),ne.emit(nr.SCENE_LAUNCHED,{sceneName:r})}},this.handleSceneLoaded=function(r){var i=r.sceneName;n.stopMeasure(i)},this.setTestScene=function(r){var i=r.sceneName;n.testScene[i]=!0}}return i(e,[{key:"init",value:function(){this.listenEvents()}},{key:"listenEvents",value:function(){ne.catchUp(nr.MARK_IS_TEST_SCENE,this.setTestScene),ne.on(nr.SWITCH_SCENE,this.switchScene),ne.on(nr.PRELOAD_SCENE,this.preloadScene),ne.on(nr.SCENE_LOADED,this.handleSceneLoaded)}},{key:"correctSceneName",value:function(n){var r=this.getCurrentScene(),i=this.getTestScene();return i&&(null==r?void 0:r.name)!==i?i:r&&n===r.name?null:n}},{key:"startScene",value:function(n){var r=this,i=n.sceneName,a=n.sceneData;this.preloadScene({sceneName:i,startScene:!0},function(n,u){n===i&&(u||j.loadScene(i,r.onDirectorLoadScene(a)))})}},{key:"mark",get:function(){return ni.LoadResources?na:null}},{key:"getCurrentScene",value:function(){return j.getScene()}},{key:"getTestScene",value:function(){var n;return null!==(n=Object.keys(this.testScene)[0])&&void 0!==n?n:null}},{key:"onSwitchScene",value:function(n){this.callbackSwitchScene=n}},{key:"setSceneData",value:function(n,r){if(r&&("data"in n||n.scene.attr({data:{}}),"data"in n)){var i=n.data||{};n.scene.attr({data:N(N({},i),r)})}}}]),e}();H._RF.pop(),H._RF.push({},"617b2SRAL5CyL75C998xBnx","ScreenManager",void 0);var no=globalThis.game,nu=no.event,nc=no.monitorError,nl=GameCore,nh=nl.Events,nd=nl.Utils,nf=nd.Object,nv=nd.Valid,np=function(){function e(){var n=this;u(this,e),this.screens={},this.queueInstantiatingScreens={},this.handleOpenScreen=function(r){var i=r.screenName,a=r.screenData;n.openScreen(i,a)},this.handleCloseScreen=function(r){var i=r.screenName;n.closeScreen(i)},this.handlePreloadScreens=function(){var r=j.getScene();r&&(n.initScreens(r),n.preloadScreens())}}var n,r,a,f;return i(e,[{key:"init",value:function(){this.listenEvents()}},{key:"listenEvents",value:function(){nu.on(nh.OPEN_SCREEN,this.handleOpenScreen),nu.on(nh.CLOSE_SCREEN,this.handleCloseScreen),nu.on(nh.PRELOAD_SCREENS,this.handlePreloadScreens)}},{key:"initScreens",value:function(n){var r=n.getComponentsInChildren(x);if(!nv.isFalsy(r)){r.map(function(n){return null==n?void 0:n.node.name}).join(", ");this.addScreens(r)}var i=null==n?void 0:n.getComponentInChildren(O);if(i){var a=i.screenKeys.filter(function(n){return!r.some(function(r){return r.node.name===P[n]})});if(!nv.isEmpty(a)){a.map(function(n){return P[n]}).join(", ");this.addScreenKeys(a,i.node)}}}},{key:"reorderScreens",value:function(){var n=nf.vals(this.screens).filter(function(n){return"ready"===n.state});n.sort(function(n,r){return n.order-r.order});for(var r=0;r<n.length;r++){var i=n[r];i&&(i.order=r,i.comp.node.setSiblingIndex(i.order))}}},{key:"addScreenKeys",value:function(n,r){var i=this;n.forEach(function(n,a){var u=P[n];i.screens[u]&&(i.screens[u].order=a),i.screens[P[n]]={state:"key",parent:r,key:n,order:a}})}},{key:"addScreens",value:function(n){var r=this;n.forEach(function(n,i){r.screens[n.node.name]={state:"ready",comp:n,order:i}})}},{key:"preloadScreens",value:(f=g(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:n=nf.vals(this.screens).reduce(function(n,r){if("key"===r.state){var i=G.loadPrefabAsync("screens/".concat(P[r.key]));n.push(i)}return n},[]);return[4,Promise.all(n)];case 1:return[2,r.sent()]}})}),function(){return f.apply(this,arguments)})},{key:"getScreen",value:(a=g(function(n){var r,i,a,u,f,y,g;return _ts_generator(this,function(_){switch(_.label){case 0:r=this.screens[n];if(null==r)return[2,(null==nc||nc.sendException(new Error("ScreenManager.openScreen Screen ".concat(n," not found")),{screenName:n,screens:this.getScreensAsMetadata()}),null)];if("ready"===r.state)return[2,r.comp];this.queueInstantiatingScreens[n]=!0;i=r.parent,a=r.key,u=r.order;return[4,G.loadPrefabAsync("screens/".concat(P[a]))];case 1:f=_.sent();if(delete this.queueInstantiatingScreens[n],!f)return[2,(null==nc||nc.sendException(new Error("ScreenManager.getScreen: Failed to load Screen ".concat(n," prefab...")),{screenName:n,screens:this.getScreensAsMetadata()}),null)];y=eu(f);y.name=n,i.addChild(y),y.active=!1;g=y.getComponent(x);return[2,g?(this.screens[n]={state:"ready",comp:g,order:u},this.reorderScreens(),g):(null==nc||nc.sendException(new Error("ScreenManager.getScreen: Screen ".concat(n," prefab doesn't have BaseScreen component...")),{screenName:n,screens:this.getScreensAsMetadata()}),null)]}})}),function(n){return a.apply(this,arguments)})},{key:"getScreensAsMetadata",value:function(){var n=this;return Object.keys(this.screens).map(function(r){var i=n.screens[r];return i?"ready"===i.state?"".concat(i.comp.node.name,"(loaded)"):"".concat(P[i.key],"(not-loaded)"):null}).join(", ")}},{key:"clearScreens",value:function(){this.screens={}}},{key:"openScreen",value:(r=g(function(n,r){var i,a;return _ts_generator(this,function(u){switch(u.label){case 0:u.trys.push([0,3,,4]);if(this.queueInstantiatingScreens[n])return[2];G.setBlockInput(!0);return[4,this.getScreen(n)];case 1:i=u.sent();if(G.setBlockInput(!1),null==i||!i.node)return[2,void 0];i.node.active=!0,i.node.setPosition(new ec(0,0,0));a={screenName:n,screenData:r};nu.emit(nh.OPENING_SCREEN,a),M.trackCurrentPage(n,!0),null==nc||nc.addMetadata({currentScreen:n});return[4,B.waitTweenAsync(0)];case 2:u.sent(),i.open(r),nu.emit(nh.OPENED_SCREEN,a);return[3,4];case 3:u.sent();return[3,4];case 4:return[2]}})}),function(n,i){return r.apply(this,arguments)})},{key:"closeScreen",value:(n=g(function(n){var r,i,a;return _ts_generator(this,function(u){switch(u.label){case 0:u.trys.push([0,2,,3]);if(this.queueInstantiatingScreens[n])return[2];return[4,this.getScreen(n)];case 1:i=u.sent();if(!i)return[2,void 0];if(null===(r=i.node)||void 0===r||!r.active)return[2];a={screenName:n};nu.emit(nh.CLOSING_SCREEN,a),i.close(),M.trackCurrentPage(n,!1),null==nc||nc.removeMetadata("currentScreen");return[3,3];case 2:u.sent();return[3,3];case 3:return[2]}})}),function(r){return n.apply(this,arguments)})},{key:"closeAllScreens",value:function(){for(var n in this.screens){var r=this.screens[n];r&&"ready"===r.state&&this.closeScreen(n)}}}]),e}();H._RF.pop(),H._RF.push({},"a851bnZR1RCUILrjMPf7nMm","CorecosSystem",void 0);var ny=GameCore,ng=ny.Configs.Core,nm=ny.Events,n_=ny.Plugins.Analytics.Events,nE=globalThis.game,nS=nE.context,nA=nE.storage,nb=nE.event,nw=nE.analytics,nk=nE.monitorError;new(function(){function e(){var n=this;u(this,e),this.coreManager=new eS,this.adsManager=new em,this.sceneManager=new ns,this.screenManager=new np,this.engineManager=new eF,this.layoutManager=new ez,this.playerManager=new eK,this.pluginsManager=new t7,this.handleWhenCoreBoot=function(){V.inited?n.handleCocosInit():V.once(el.EVENT_GAME_INITED,n.handleCocosInit)},this.handleCocosInit=function(){n.coreManager.requestStart()},this.handleWhenCoreStart=function(){n.playerManager.setupDefaultGameData()},this.handleWhenCoreReady=function(){n.initPlugins(),nw.event(n_.LOAD_START),nb.catchUp(nm.BUNDLE_READY,n.processPreStartGame)},this.processPreStartGame=function(){nb.once(nm.SCENE_LAUNCHED,n.handleBootSceneLaunched),n.runBootScene()},this.handleBootSceneLaunched=function(){ng.StartSDKAfterLoadGame?nb.once(nm.SCENE_LOADED,n.handleStartGameWhenMainSceneReady):n.processStartGame()},this.preloadScenes=function(){"solo"===nA.getStorageData("context","sessionContextType")?U.preloadDashboardScene():U.preloadGameScene()},this.handleStartGameWhenMainSceneReady=function(){n.processStartGame()},this.handleSwitchScene=function(r){var i=r.sceneName,a=n.sceneManager.getCurrentScene();(null==a?void 0:a.name)===i&&a&&(n.screenManager.closeAllScreens(),n.screenManager.clearScreens(),n.screenManager.initScreens(a),n.screenManager.preloadScreens())},this.startProcessContextData=g(function(){var r;return _ts_generator(this,function(i){switch(i.label){case 0:nw.event(n_.APP_READY);i.label=1;case 1:i.trys.push([1,3,4,5]);n.playerManager.requestConnectedPlayers();return[4,nS.processContextData()];case 2:i.sent();return[3,5];case 3:r=i.sent();_instanceof(r,Error)&&(null==nk||nk.sendException(r));return[3,5];case 4:nb.emit(nm.GAME_READY);return[7];case 5:return[2]}})}),this.initManagers(),this.listenEvents()}var n,r;return i(e,[{key:"initManagers",value:function(){this.coreManager.init(),this.engineManager.init(),this.layoutManager.init(),this.adsManager.init(),this.sceneManager.init(),this.screenManager.init(),this.playerManager.init(),this.pluginsManager.init()}},{key:"listenEvents",value:function(){this.coreManager.onCoreBoot(this.handleWhenCoreBoot),this.coreManager.onCoreStart(this.handleWhenCoreStart),this.coreManager.onCoreReady(this.handleWhenCoreReady),this.sceneManager.onSwitchScene(this.handleSwitchScene)}},{key:"runBootScene",value:function(){nb.once(nm.SCENE_LOADED,this.preloadScenes),U.switchScene(f.BOOT_SCENE)}},{key:"processStartGame",value:(r=g(function(){return _ts_generator(this,function(n){switch(n.label){case 0:nw.event(n_.LOAD_COMPLETE);return[4,this.startGameAsync()];case 1:n.sent(),nb.catchUp(nm.PLAYER_INFO_LOADED,this.startProcessContextData);return[2]}})}),function(){return r.apply(this,arguments)})},{key:"startGameAsync",value:(n=g(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,GameSDK.startGameAsync()];case 1:r.sent();return[3,3];case 2:n=r.sent();_instanceof(n,Error)&&(null==nk||nk.sendException(n));return[3,3];case 3:return[2]}})}),function(){return n.apply(this,arguments)})},{key:"initPlugins",value:function(){this.pluginsManager.initLeaderboards(),this.pluginsManager.initDynamicAssets(),this.pluginsManager.initCanvasRecorder(),this.pluginsManager.initPerformanceMonitor(),this.pluginsManager.initAdaptivePerformance()}}]),e}()),H._RF.pop()}}});(function(n){n("virtual:///prerequisite-imports/systems","chunks:///systems.js")})(function(n,r){System.register(n,[r],function(n,r){return{setters:[function(r){var i={};for(var a in r)if("default"!==a&&"__esModule"!==a)i[a]=r[a];n(i)}],execute:function(){}}})});