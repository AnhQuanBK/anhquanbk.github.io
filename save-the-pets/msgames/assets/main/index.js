System.register("chunks:///main.js",["./rollupPluginModLoBabelHelpers-60801af6.js","cc","./GeneralUtils-daeff485.js"],(function(){var e,t,n,i,a,o,r,s,l,u,c,h,p,d,y,v,f,m,g,b,S,k,C,w,E,T,A,R,P,_,B,L,O,D,I,N,F,G,z,M,x,U,H,j,V,W,q,K,Y,J,Z,X,Q,$,ee,te,ne,ie,ae,oe,re,se,le,ue,ce,he,pe,de,ye,ve,fe,me,ge,be,Se,ke,Ce,we,Ee,Te,Ae,Re,Pe,_e,Be,Le,Oe,De,Ie,Ne,Fe,Ge,ze,Me,xe,Ue,He,je,Ve,We,qe,Ke,Ye,Je,Ze,Xe,Qe,$e,et,tt,nt,it;return{setters:[function(v){e=v.g,t=v.a,n=v.b,i=v.c,a=v.f,o=v.m,r=v.h,s=v._,l=v.d,u=v.e,c=v.i,h=v.n,p=v.o,d=v.l,y=v.j},function(e){v=e.cclegacy,f=e.isCCObject,m=e._decorator,g=e.Animation,b=e.CCString,S=e.CCInteger,k=e.Component,C=e.AudioSource,w=e.director,E=e.Sprite,T=e.game,A=e.Button,R=e.CCBoolean,P=e.EventTouch,_=e.Vec3,B=e.Input,L=e.Node,O=e.UIOpacity,D=e.Graphics,I=e.Color,N=e.Label,F=e.Director,G=e.sys,z=e.ccenum,M=e.Enum,x=e.UITransform,U=e.CCFloat,H=e.Widget,j=e.Layers,V=e.ERigidBody2DType,W=e.RigidBody2D,q=e.sp,K=e.Vec2,Y=e.Collider2D,J=e.Contact2DType,Z=e.math,X=e.SpriteFrame,Q=e.HingeJoint2D,$=e.RelativeJoint2D,ee=e.BoxCollider2D,te=e.Prefab,ne=e.instantiate,ie=e.CircleCollider2D,ae=e.Mask,oe=e.PolygonCollider2D,re=e.NodePool,se=e.Tween,le=e.tween,ue=e.find,ce=e.PhysicsSystem2D,he=e.ERaycast2DType,pe=e.Intersection2D,de=e.JsonAsset,ye=e.ProgressBar,ve=e.EPhysics2DDrawFlags,fe=e.DistanceJoint2D,me=e.repeat,ge=e.lerp,be=e.approx,Se=e.EPSILON,ke=e.RealCurve,Ce=e.Gradient,we=e.bits,Ee=e.random,Te=e.randomRange,Ae=e.randomRangeInt,Re=e.js,Pe=e.misc,_e=e.MeshRenderData,Be=e.pseudoRandom,Le=e.toRadian,Oe=e.CCClass,De=e.ParticleSystem2D,Ie=e.UIRenderer,Ne=e.Material,Fe=e.View,Ge=e.Canvas},function(e){ze=e.R,Me=e.G,xe=e.a,Ue=e.C,He=e.l,je=e.m,Ve=e.n,We=e.g,qe=e.o,Ke=e.c,Ye=e.E,Je=e.p,Ze=e.f,Xe=e.q,Qe=e.A,$e=e.h,et=e.S,tt=e.r,nt=e.i,it=e.k}],execute:function(){function at(e,t,n){var i=n.value;n.value=function(){if(this.enabledInHierarchy){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return null==i?void 0:i.apply(this,n)}console.debug("Skipping method call ".concat(String(t)," because component ").concat(this.constructor.name," is not enabled in hierarchy"))}}function ot(t,n,i){var a=i.value,o=function(){var t=e((function*(){if(this.enabledInHierarchy){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return yield null==a?void 0:a.apply(this,t)}return console.debug("Skipping method call ".concat(String(n)," because component ").concat(this.constructor.name," is not enabled in hierarchy")),Promise.resolve()}));return function(){return t.apply(this,arguments)}}();i.value=o}v._RF.push({},"147a4TjOC9PMpdhlBiKEn54","onlyRunInLifeCycle",void 0),v._RF.pop(),v._RF.push({},"6944aqu6zZOGIj+df3KBDrm","onlyRunInLifeCycleAsync",void 0),v._RF.pop(),v._RF.push({},"99384AdWHlKDIyVvCAqSwJE","index",void 0),v._RF.pop(),v._RF.push({},"09236E0KzVAqotP4Yn9R+4m","MissingPropertiesError",void 0);var rt=function(e){t(r,e);var o=n(r);function r(e,t){var n;return i(this,r),(n=o.call(this,"".concat(e," is missing these required properties: [").concat(t.map((function(e){return e.propertyName})).join(", "),"]"))).className=e,n.errors=t,n}return a(r)}(o(Error));v._RF.pop(),v._RF.push({},"4ce5394i3hCZoi5cZm0Vn2l","MissingPropertyError",void 0);var st=function(e){t(r,e);var o=n(r);function r(e,t){var n;return i(this,r),(n=o.call(this,"".concat(e," is missing the required property: <").concat(t,">"))).className=e,n.propertyName=t,n}return a(r)}(o(Error));v._RF.pop(),v._RF.push({},"a2990W72mRAYaItrPHe4H5V","required",void 0);var lt=GameCore.Utils,ut=lt.String,ct=lt.Valid,ht=globalThis.game.monitorError,pt="_compUtils_ReqPropsMap";function dt(e){return null===e}function yt(e){return void 0===e}function vt(e){return dt(e)||yt(e)}function ft(e){if("function"==typeof e)return e;switch(e){case"null-check":return dt;case"undefined-check":return yt;default:return vt}}function mt(e){return function(t,n){if("function"==typeof t)throw new Error("The required decorator can only be applied to non-static class properties.");var i,a=t.constructor.name,o=(i=n,"".concat("_compUtils_ReqPropsMethod","_").concat(ut.capitalize(i)));if(void 0!==t[o])throw new Error("The required decorator found that property name ".concat(o," already exists. The reserved method name ").concat(o," is used already or the decorator was applied multiple times."));t[o]=function(t){if(e(this[n]))throw new st(t,n)},void 0===t[pt]&&(t[pt]={}),void 0===t[pt][a]&&(t[pt][a]=[]),t[pt][a].push(o)}}function gt(e,t){if("string"!=typeof t)return mt(ft(e));var n=e;mt(ft())(n,t)}v._RF.pop(),v._RF.push({},"75e1e0Ei7ZOOr/FzyprYnVJ","index",void 0),v._RF.pop(),v._RF.push({},"bfa55FbayJE75F0wBdnknTr","ComponentUtils",void 0);var bt,St,kt,Ct,wt,Et,Tt,At,Rt,Pt=GameCore.Utils,_t=Pt.Array,Bt=Pt.Object,Lt=Pt.Valid,Ot=["cc.Mask","cc.Label","cc.Canvas","cc.Camera","cc.Layout","cc.Button","cc.Sprite","cc.Widget","cc.Renderer","cc.Animation","cc.UIOpacity"],Dt=function(){function e(){i(this,e),this.validComponentCalled={}}return a(e,[{key:"validateRequiredComponents",value:function(e){var t,n=e.name,i=e.constructor,a=this.getRequiredComponentNames(i),o=r(a);try{for(o.s();!(t=o.n()).done;){var s=t.value;if(!e.getComponent(s))throw new Error("".concat(n,": Missing required ").concat(s," component"))}}catch(e){o.e(e)}finally{o.f()}}},{key:"validateRequiredProperties",value:function(e){var t,n=e.name,i=e.constructor,a=this.getRequiredPropNames(i),o=r(a);try{for(o.s();!(t=o.n()).done;){var s=t.value;if(!Bt.hasOwn(e,s))throw new Error("".concat(n,": Missing required ").concat(s," property"));var l=this.getProperty(s,e);if(!f(l))throw new Error("".concat(n,": ").concat(s," property is not a cc object"))}}catch(e){o.e(e)}finally{o.f()}}},{key:"validateCustomProperties",value:function(e){var t,n=e.name,i=this.getCustomPropNames(e),a=r(i);try{for(a.s();!(t=a.n()).done;){var o=t.value;if(!Bt.hasOwn(e,o))throw new Error("".concat(n,": Missing required ").concat(o," property"));var s=this.getProperty(o,e);if(!f(s))throw new Error("".concat(n,": ").concat(o," property is not a cc object"))}}catch(e){a.e(e)}finally{a.f()}}},{key:"getProperty",value:function(e,t){var n;if(Bt.hasOwn(t,e))return(null!==(n=Object.getOwnPropertyDescriptor(t,e))&&void 0!==n?n:{}).value}},{key:"getProps",value:function(e){if(!Bt.hasOwn(e,"__props__"))return[];var t=e.__props__;return Array.isArray(t)?t:[]}},{key:"getRequiredPropNames",value:function(e){return this.getProps(e).filter((function(t){return"node"!==t&&(!!Bt.hasOwn(e,t)&&(!!f(e[t])&&!t.startsWith("_")))}))}},{key:"getBaseComponentName",value:function(e){for(var t=0,n=Ot;t<n.length;t++){var i=n[t];if(i.indexOf(e)>=0)return i}return e}},{key:"getRequiredComponentNames",value:function(e){var t=this;if(!Bt.hasOwn(e,"_requireComponent"))return[];var n=e._requireComponent;return Array.isArray(n)?n.map((function(e){return t.getBaseComponentName(e)})):[]}},{key:"getCustomPropNames",value:function(e){var t=this,n=Object.keys(e),i=this.getProps(e.constructor);return _t.difference(n,i).filter((function(e){return e.indexOf("_")<0})).filter((function(n){if(!Bt.hasOwn(e,n))return!1;var i=t.getProperty(n,e);return!(!Lt.isObject(i)||!f(i))}))}}],[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"required",value:function(e,t){return"string"==typeof t?gt(e,t):gt(e)}},{key:"validateRequiredProperties",value:function(e,t){!function(e,t){var n,i=t?t.name:e.constructor.name,a=t?t.prototype[pt]:e.constructor.prototype[pt],o=null!==(n=null==a?void 0:a[i])&&void 0!==n?n:[],r=[],s=e;for(var l in o)if("function"==typeof s[l])try{s[l](i)}catch(u){if(!(u instanceof st))throw u;r.push(u)}if(0!==r.length){var u=new rt(i,r);if(ct.isDebugger())throw u;console.error(u),null==ht||ht.sendException(u)}}(e,t)}},{key:"lazyValidateProperties",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t){var n=e.constructor,i=n.name;if(!this.inst.validComponentCalled[i])try{this.inst.validateRequiredComponents(e),this.inst.validateRequiredProperties(e),this.inst.validateCustomProperties(e)}catch(t){e.enabled=!1,console.error(t)}finally{this.inst.validComponentCalled[i]=!0}}}}]),e}();Dt.onlyRunInLifeCycle=function(){return at.apply(void 0,arguments)},Dt.onlyRunInLifeCycleAsync=function(){return ot.apply(void 0,arguments)},v._RF.pop(),v._RF.push({},"60ac3vor0dMT5bXi8D3VSJN","BubbleAnimation",void 0);var It=m.ccclass,Nt=m.property,Ft=(bt=It("BubbleAnimation"),St=Nt(g),kt=Nt(b),Ct=Nt(S),bt((Tt=s((Et=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"animation",Tt,u(e)),l(e,"clipName",At,u(e)),l(e,"repeat",Rt,u(e)),e.currentRepeat=-1,e}return a(r,[{key:"__preload",value:function(){this.animation=this.getComponent(g),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"play",value:function(){var e=this;this.animation&&(this.animation.clips.find((function(t){return(null==t?void 0:t.name)===e.clipName}))?(this.currentRepeat=-1,this.animation.play(this.clipName)):console.warn("BubbleAnimation: Animation component must have ".concat(this.clipName," clip")))}},{key:"onBubbleAnimationLoop",value:function(){this.animation&&-1!==this.repeat&&(this.currentRepeat++,this.currentRepeat>this.repeat&&this.animation.stop())}}]),r}(k)).prototype,"animation",[St],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),At=s(Et.prototype,"clipName",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Bubble"}}),Rt=s(Et.prototype,"repeat",[Ct],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-1}}),wt=Et))||wt);v._RF.pop(),v._RF.push({},"cc0a5OvhdRCMZRZuRscaz+7","AudioPlayer",void 0);var Gt,zt,Mt=function(e){t(r,e);var o=n(r);function r(e,t){var n;return i(this,r),(n=o.call(this,e)).audioSource=t,n}return a(r,[{key:"play",value:function(e){if(e){var t=e.volume,n=void 0===t?1:t,i=e.loop,a=void 0!==i&&i;this.audioSource.volume=n,this.audioSource.loop=a}this.audioSource.play()}},{key:"pause",value:function(){this.audioSource.pause()}},{key:"resume",value:function(){this.audioSource.state===C.AudioState.PAUSED&&this.audioSource.play()}},{key:"stop",value:function(){this.audioSource.stop()}},{key:"setVolume",value:function(e){this.audioSource.volume=e}},{key:"getVolume",value:function(){return this.audioSource.volume}},{key:"getAudioSource",value:function(){return this.audioSource}}]),r}(GameCore.Plugins.Audio.BaseAudioPlayer);v._RF.pop(),v._RF.push({},"8b5ecHv/+BJiorK1kiVbTcf","AudioChannel",void 0);var xt,Ut,Ht,jt,Vt,Wt=GameCore,qt=Wt.Plugins.Audio.BaseChannelManager,Kt=Wt.Utils,Yt=Kt.Array,Jt=(Gt=Kt.Decorator.tryCatch(),s((zt=function(o){t(l,o);var r,s=n(l);function l(e,t){var n;return i(this,l),(n=s.call(this,t)).allowMultipleTracking={},n.handleLoadedAudio=function(e,t){var i=n.node.addComponent(C);return i.clip=t,i.playOnAwake=!1,new Mt(e,i)},n.node=e,n}return a(l,[{key:"playing",value:function(e){var t,n=null===(t=this.getAudioClip(e))||void 0===t?void 0:t.audioPlayer;return!!(n&&n instanceof Mt)&&n.getAudioSource().state===C.AudioState.PLAYING}},{key:"onLoadAudio",value:(r=e((function*(e,t){var n=yield ze.loadAudioAsync(e);return n&&this.node.isValid?this.handleLoadedAudio(e,n):null})),function(e,t){return r.apply(this,arguments)})},{key:"playWithRealConfig",value:function(e,t){if(this.isCanPlay(t)){if(t){var n=t.volume,i=void 0===n?1:n,a=t.allowMultiple,o=void 0!==a&&a;if(t.volume=this.getVolume()*i,o){var r=e.getAudioSource().clip;if(!r)return;return void this.requestDuplicateAudioPlayer(e.getKey(),r,t).play(t)}}e.play(t)}}},{key:"isCanPlay",value:function(e){var t=this;if(e){var n=e.checkList;if((void 0===n?[]:n).some((function(e){var n=t.getAudioClip(e);if(n){var i=n.audioPlayer;if(i&&i instanceof Mt)return i.getAudioSource().state===C.AudioState.PLAYING}return!1})))return!1}return!0}},{key:"requestDuplicateAudioPlayer",value:function(e,t,n){var i=this.getDuplicateAudioFromPool(e);if(i){if(n){var a=i.key,o=n.volume,r=void 0===o?1:o;this.setAudioClip(a,{volume:r})}return i.audioPlayer}var s=this.allowMultipleTracking[e];if(!s)throw new Error("Allow multiple tracking is not found");var l="".concat(e,"_").concat(s.currentPostFix),u=this.handleLoadedAudio(l,t);return s.list.push({audioPlayer:u,key:l}),s.currentPostFix+=1,this.setAudioClip(l,{audioPlayer:u,volume:1}),u}},{key:"getDuplicateAudioFromPool",value:function(e){if(this.allowMultipleTracking[e]){var t=this.allowMultipleTracking[e].list,n=Yt.search(t,(function(e){return e.audioPlayer.getAudioSource().state!==C.AudioState.PLAYING}));if(n)return n}else this.allowMultipleTracking[e]={currentPostFix:1,list:[]};return null}}]),l}(qt)).prototype,"onLoadAudio",[Gt],Object.getOwnPropertyDescriptor(zt.prototype,"onLoadAudio"),zt.prototype),zt);v._RF.pop(),v._RF.push({},"1a025mmN7BL7r5cF6gWR4b/","Music",void 0);var Zt,Xt,Qt,$t,en,tn=m.ccclass,nn=m.property,an=globalThis.game,on=an.audio,rn=an.player,sn=(xt=tn("Music"),Ut=nn(b),xt((Vt=s((jt=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"channelId",Vt,u(e)),e.channel=null,e}return a(r,[{key:"__preload",value:function(){this.makePersistent(),this.channel=new Jt(this.node,this.channelId),on.addChannel(this.channel)}},{key:"makePersistent",value:function(){w.addPersistRootNode(this.node)}},{key:"playing",value:function(e){var t,n;return null!==(t=null===(n=this.channel)||void 0===n?void 0:n.playing(e))&&void 0!==t&&t}},{key:"play",value:function(e,t){if(this.isMusicEnable()){var n=null!=t?t:{};n.loop||(n.loop=!0),on.play(e,n,this.channelId)}}},{key:"isMusicEnable",value:function(){return!!rn.getPlayerSetting("music")}},{key:"setVolume",value:function(e){on.setVolume(e,this.channelId)}},{key:"getVolume",value:function(){return on.getVolume(this.channelId)}},{key:"pause",value:function(e){on.pause(e,this.channelId)}},{key:"resume",value:function(e){this.isMusicEnable()&&on.resume(e,this.channelId)}},{key:"stop",value:function(e){on.stop(e,this.channelId)}},{key:"mute",value:function(e){e?on.mute(this.channelId):on.unmute(this.channelId)}}]),r}(k)).prototype,"channelId",[Ut],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"global_music"}}),Ht=jt))||Ht);v._RF.pop(),v._RF.push({},"1299a7X1XNNEKxSKMV6E5jQ","Sound",void 0);var ln,un,cn,hn,pn,dn=m.ccclass,yn=m.property,vn=globalThis.game,fn=vn.audio,mn=vn.player,gn=(Zt=dn("Sound"),Xt=yn(b),Zt((en=s(($t=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"channelId",en,u(e)),e.channel=null,e}return a(r,[{key:"__preload",value:function(){""===this.channelId&&(this.channelId=this.node.uuid),this.channel=new Jt(this.node,this.channelId),fn.addChannel(this.channel)}},{key:"onLoad",value:function(){}},{key:"makePersistent",value:function(){w.addPersistRootNode(this.node)}},{key:"removePersistent",value:function(){w.removePersistRootNode(this.node)}},{key:"play",value:function(e,t){this.isSoundEnable()&&fn.play(e,t,this.channelId)}},{key:"isSoundEnable",value:function(){return!!mn.getPlayerSetting("sound")}},{key:"setVolume",value:function(e){fn.setVolume(e,this.channelId)}},{key:"pause",value:function(e){fn.pause(e,this.channelId)}},{key:"resume",value:function(e){this.isSoundEnable()&&fn.resume(e,this.channelId)}},{key:"stop",value:function(e){fn.stop(e,this.channelId)}},{key:"stopAll",value:function(){fn.stopAll(this.channelId)}},{key:"mute",value:function(e){e?fn.mute(this.channelId):fn.unmute(this.channelId)}}]),r}(k)).prototype,"channelId",[Xt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Qt=$t))||Qt);v._RF.pop(),v._RF.push({},"ca427NpeqpC3bUoGTd9I/BM","Background",void 0);var bn,Sn=m.ccclass,kn=xe.Layout;ln=Sn("Background"),un=Dt.required(),ln((pn=s((hn=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"sprite",pn,u(e)),e.handleSpriteTypeWhenLayoutChanged=function(t){t===kn.Landscape?e.setBackgroundType(E.Type.TILED):e.setBackgroundType(E.Type.SIMPLE)},e}return a(r,[{key:"__preload",value:function(){this.sprite=this.getComponent(E),Dt.validateRequiredProperties(this),this.listenGameEvents()}},{key:"listenGameEvents",value:function(){T.on(Me.LAYOUT_CHANGED,this.handleSpriteTypeWhenLayoutChanged,this)}},{key:"setBackgroundType",value:function(e){this.sprite&&(this.sprite.type=e)}}]),r}(k)).prototype,"sprite",[un],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cn=hn));v._RF.pop(),v._RF.push({},"7ddc4vU74pB/LdHrUupDA/G","BlockLines",void 0);var Cn,wn,En,Tn,An,Rn,Pn,_n,Bn,Ln,On,Dn,In,Nn,Fn,Gn,zn,Mn=m.ccclass,xn=xe.Layout;Mn("BlockLines")(bn=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).handleSpriteTypeWhenLayoutChanged=function(t){t===xn.Landscape?e.setActiveBlockLines(!0):e.setActiveBlockLines(!1)},e}return a(r,[{key:"__preload",value:function(){this.componentSprites=this.getComponentsInChildren(E),this.validateRequiredComponents(),this.listenGameEvents(),this.handleBlockLinesOnStart()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"handleBlockLinesOnStart",value:function(){var e=this.getScreenRatio()>750/1366;this.setActiveBlockLines(e)}},{key:"listenGameEvents",value:function(){T.on(Me.LAYOUT_CHANGED,this.handleSpriteTypeWhenLayoutChanged)}},{key:"setActiveBlockLines",value:function(e){var t=this;this.componentSprites&&this.componentSprites.forEach((function(n){n.node!==t.node&&(n.node.active=e)}))}},{key:"getScreenRatio",value:function(){return Ue.getScreenWidthCss()/Ue.getScreenHeightCss()}}]),r}(k));v._RF.pop(),v._RF.push({},"4b299Dv1kVGcqQmJC9yBPAV","ButtonReleased",void 0);var Un,Hn,jn,Vn,Wn=m.ccclass,qn=m.requireComponent,Kn=m.property,Yn=m.disallowMultiple,Jn=m.executionOrder,Zn=globalThis.game.analytics;Cn=Wn("ButtonReleased"),wn=qn([g,A]),En=Jn(120),Tn=Kn(b),An=Kn(b),Rn=Kn(R),Pn=Kn({visible:function(){return this.useSound},type:He}),_n=Kn({tooltip:"Add a delay after click to prevent spamming (not apply for cancel click)"}),Bn=Kn({visible:function(){return this.disableSpamClick},tooltip:"Delay time in seconds"}),Cn(Ln=Yn(Ln=wn(Ln=En((Dn=s((On=function(e){t(s,e);var o=n(s);function s(){var e;i(this,s);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"downClipName",Dn,u(e)),l(e,"upClipName",In,u(e)),l(e,"useSound",Nn,u(e)),l(e,"soundKey",Fn,u(e)),l(e,"disableSpamClick",Gn,u(e)),l(e,"disableSpamDelay",zn,u(e)),e.currentClickBoundingBox=null,e.hasDown=!1,e.hasUp=!1,e.onTouchStart=function(t){if(e.buttonComponent.interactable&&!e.hasDown&&(e.currentClickBoundingBox=Ue.getBoundingBoxToWorld(e.node),e.hasDown=!0,e.runAnimation(e.downClipName),e.useSound&&e.soundKey)){var n=je[e.soundKey];if(!n)return;Ve.playSound(n)}},e.onTouchEnd=function(t){e.buttonComponent.interactable&&e.hasDown&&(e.hasUp||e.handleUp(t))},e.onTouchCancel=function(t){var n,i;if(e.buttonComponent.interactable&&e.hasDown&&!e.hasUp){var a=t.getUILocation(),o=null!==(n=null===(i=e.currentClickBoundingBox)||void 0===i?void 0:i.contains(a))&&void 0!==n&&n;t instanceof P&&o?e.handleUp(t):(e.hasUp=!0,e.runAnimation(e.upClipName),e.animationComponent.once(g.EventType.FINISHED,(function(){e.handleResetButtonState()})))}},e.handleResetButtonState=function(){var t;if(e.hasDown=!1,e.hasUp=!1,e.buttonComponent){var n=e.buttonComponent.node.scale.x,i=e.buttonComponent.node.scale.z;null===(t=e.buttonComponent)||void 0===t||t.node.setScale(new _(n,1,i))}},e}return a(s,[{key:"__preload",value:function(){this.buttonComponent=this.getComponent(A),this.animationComponent=this.getComponent(g),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"onEnable",value:function(){this.animationComponent.clips.length<2?console.warn("ButtonAnimAddition: Animation component must have 2 clips in ".concat(this.node.name)):(this.node.off(B.EventType.TOUCH_END,this.buttonComponent._onTouchEnded,this.buttonComponent),this.node.on(L.EventType.TOUCH_START,this.onTouchStart),this.node.on(L.EventType.TOUCH_END,this.onTouchEnd),this.node.on(L.EventType.TOUCH_CANCEL,this.onTouchCancel))}},{key:"onDisable",value:function(){this.node.off(L.EventType.TOUCH_START,this.onTouchStart),this.node.off(L.EventType.TOUCH_END,this.onTouchEnd),this.node.off(L.EventType.TOUCH_CANCEL,this.onTouchCancel),this.unschedule(this.handleResetButtonState),this.handleResetButtonState()}},{key:"handleUp",value:function(e){var t=this;this.hasUp=!0,this.runAnimation(this.upClipName),this.animationComponent.once(g.EventType.FINISHED,(function(){if(t.disableSpamClick?t.scheduleOnce(t.handleResetButtonState,t.disableSpamDelay):t.handleResetButtonState(),!t.buttonComponent||t.buttonComponent.interactable){Zn.event(GameCore.Plugins.Analytics.Events.BUTTON_CLICK,{button_name:t.node.name,screen_name:We.getCurrentPage()});var n=t.buttonComponent.clickEvents;if(n){var i,a=r(n);try{for(a.s();!(i=a.n()).done;){var o=i.value;o.emit([e,o.customEventData])}}catch(e){a.e(e)}finally{a.f()}}}}))}},{key:"runAnimation",value:function(e){if(!this.isAnimationExist(e))throw new Error("".concat(this.node.name,": Animation component must have ").concat(e," clip"));this.animationComponent.play(e)}},{key:"isAnimationExist",value:function(e){return this.animationComponent.clips.some((function(t){return!(!t||t.name!==e)}))}}]),s}(k)).prototype,"downClipName",[Tn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"ButtonDown"}}),In=s(On.prototype,"upClipName",[An],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"ButtonUp"}}),Nn=s(On.prototype,"useSound",[Rn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Fn=s(On.prototype,"soundKey",[Pn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return He[qe.BUTTON_CLICK]}}),Gn=s(On.prototype,"disableSpamClick",[_n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),zn=s(On.prototype,"disableSpamDelay",[Bn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),Ln=On))||Ln)||Ln)||Ln);v._RF.pop(),v._RF.push({},"0e570DdAIZPKY6DNtNerFmX","OpacityToggler",void 0);var Xn,Qn,$n,ei=m.ccclass,ti=m.requireComponent,ni=m.property,ii=ei("OpacityToggler")(Un=ti([O])((jn=s((Hn=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"activeValue",jn,u(e)),l(e,"inActiveValue",Vn,u(e)),e}return a(r,[{key:"__preload",value:function(){this.opacityComponent=this.getComponent(O),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"changeState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.opacityComponent.opacity=e?this.activeValue:this.inActiveValue}}]),r}(k)).prototype,"activeValue",[ni],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 255}}),Vn=s(Hn.prototype,"inActiveValue",[ni],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 128}}),Un=Hn))||Un)||Un;v._RF.pop(),v._RF.push({},"7ef37Q3PZpKYaeik5JzGwNy","DebugResolution",void 0);var ai=m.ccclass,oi=m.property,ri=m.requireComponent,si=m.disallowMultiple,li=m.executeInEditMode,ui=xe.DesignSize,ci=ui.Portrait,hi=ui.Landscape;ai("DebugResolution")(Xn=si(Xn=ri([D])(Xn=li(!0)((($n=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).handleLayoutChange=function(){var t;null===(t=e.graphics)||void 0===t||t.clear(),e.start()},e}return a(r,[{key:"drawPortrait",get:function(){return r._drawPortrait},set:function(e){e!==r._drawPortrait&&(e?this.drawPortraitResolution():this.graphics.clear(),r._drawPortrait=e,r._drawLandscape&&this.drawLandscapeResolution())}},{key:"drawLandscape",get:function(){return r._drawLandscape},set:function(e){e!==r._drawLandscape&&(e?this.drawLandscapeResolution():this.graphics.clear(),r._drawLandscape=e,r._drawPortrait&&this.drawPortraitResolution())}},{key:"__preload",value:function(){this.graphics=this.getComponent(D),this.validateRequiredComponents(),this.listenGameEvents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"listenGameEvents",value:function(){T.on(Me.LAYOUT_CHANGED,this.handleLayoutChange)}},{key:"start",value:function(){this.drawPortrait&&this.drawPortraitResolution(),this.drawLandscape&&this.drawLandscapeResolution()}},{key:"drawPortraitResolution",value:function(){var e=this.graphics;if(e){var t=ci.WIDTH,n=ci.HEIGHT,i=-t/2,a=-n/2;e.strokeColor=I.GREEN,e.rect(i,a,t,n),e.stroke()}}},{key:"drawLandscapeResolution",value:function(){var e=this.graphics;if(e){var t=hi.WIDTH,n=hi.HEIGHT,i=-t/2,a=-n/2;e.strokeColor=I.CYAN,e.rect(i,a,t,n),e.stroke()}}}]),r}(k))._drawPortrait=!0,$n._drawLandscape=!0,s((Qn=$n).prototype,"drawPortrait",[oi],Object.getOwnPropertyDescriptor(Qn.prototype,"drawPortrait"),Qn.prototype),s(Qn.prototype,"drawLandscape",[oi],Object.getOwnPropertyDescriptor(Qn.prototype,"drawLandscape"),Qn.prototype),Xn=Qn))||Xn)||Xn)||Xn);v._RF.pop(),v._RF.push({},"0405b+DQy1IALb/j8jx5Lpc","PerfCounter",void 0);var pi,di,yi,vi,fi,mi,gi,bi,Si,ki,Ci,wi,Ei,Ti,Ai,Ri,Pi,_i,Bi,Li,Oi=function(){function e(){i(this,e),this.time=0,this._value=0,this.time=0,this._value=0}return a(e,[{key:"value",get:function(){return this._value}},{key:"start",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.time=e}},{key:"end",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._value=e-this.time}}]),e}();v._RF.pop(),v._RF.push({},"0e2d6yn/BVObK1kyTJ5a09a","GameStats",void 0);var Di,Ii,Ni,Fi,Gi,zi,Mi,xi,Ui,Hi,ji,Vi,Wi,qi,Ki=m.ccclass,Yi=m.executionOrder,Ji=m.property,Zi=GameCore,Xi=Zi.Utils,Qi=Xi.Valid,$i=Xi.Array,ea=Zi.Configs.Debugger.ListPlayerDevIds,ta=globalThis.game.player,na=I.RED,ia=I.BLACK,aa=I.MAGENTA;pi=Ki("GameStats"),di=Yi(-1e3),yi=Ji(N),vi=Ji(N),fi=Ji(N),mi=Ji(N),gi=Ji(N),bi=Ji(N),Si=Ji(N),ki=Ji(N),pi(Ci=di((Ei=s((wi=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"fpsLabel",Ei,u(e)),l(e,"drawCountLabel",Ti,u(e)),l(e,"logicTimeLabel",Ai,u(e)),l(e,"physicTimeLabel",Ri,u(e)),l(e,"renderTimeLabel",Pi,u(e)),l(e,"objectMemoryUsageLabel",_i,u(e)),l(e,"textureMemoryUsageLabel",Bi,u(e)),l(e,"devicePixelRatioLabel",Li,u(e)),e.refreshInterval=.5,e.handleMouseDown=function(){e.bg.enabled=!e.bg.enabled},e.updateStats=function(){e.updateFps(),e.updateDrawCalls(),e.updateLogicTime(),e.updatePhysicTime(),e.updateRenderTime(),e.updateObjectMemoryUsage(),e.updateTextureMemoryUsage(),e.updateDevicePixelRatio()},e}return a(r,[{key:"__preload",value:function(){this.bg=this.getComponent(E),this.validateRequiredComponents(),this.listenInputEvents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"listenInputEvents",value:function(){this.node.on(B.EventType.TOUCH_START,this.handleMouseDown)}},{key:"start",value:function(){this.bg.enabled=!1,this.node.active=!1,this.canDisplayStats()&&(this.node.active=!0,this.logicTimeCounter=new Oi,this.physicTimeCounter=new Oi,this.renderTimeCounter=new Oi,w.on(F.EVENT_BEFORE_UPDATE,this.beforeUpdate,this),w.on(F.EVENT_AFTER_UPDATE,this.afterUpdate,this),w.on(F.EVENT_BEFORE_PHYSICS,this.beforePhysics,this),w.on(F.EVENT_AFTER_PHYSICS,this.afterPhysics,this),w.on(F.EVENT_BEFORE_DRAW,this.beforeDraw,this),w.on(F.EVENT_AFTER_RENDER,this.afterRender,this),this.startUpdateStats())}},{key:"onDestroy",value:function(){this.canDisplayStats()&&(w.off(F.EVENT_BEFORE_UPDATE,this.beforeUpdate,this),w.off(F.EVENT_AFTER_UPDATE,this.afterUpdate,this),w.off(F.EVENT_BEFORE_PHYSICS,this.beforePhysics,this),w.off(F.EVENT_AFTER_PHYSICS,this.afterPhysics,this),w.off(F.EVENT_BEFORE_DRAW,this.beforeDraw,this),w.off(F.EVENT_AFTER_RENDER,this.afterRender,this))}},{key:"canDisplayStats",value:function(){return Qi.isDebugger()||$i.has(ea,ta.getPlayerId())}},{key:"startUpdateStats",value:function(){this.schedule(this.updateStats,this.refreshInterval)}},{key:"updateFps",value:function(){var e=this.getFps();this.updateFpsColor(e),this.fpsLabel.string="FPS: ".concat(e)}},{key:"updateFpsColor",value:function(e){this.fpsLabel.color=e<30?na:e<48?aa:ia}},{key:"updateDrawCalls",value:function(){var e=this.getDrawCalls();this.updateDrawCallsColor(e),this.drawCountLabel.string="Draw Calls: ".concat(e)}},{key:"updateDrawCallsColor",value:function(e){var t=G.os===G.OS.IOS,n=t?80:25,i=t?60:15;this.drawCountLabel.color=e>n?na:e>i?aa:ia}},{key:"updateLogicTime",value:function(){var e=this.getLogicTime();this.updateLogicTimeColor(e),this.logicTimeLabel.string="Logic Time: ".concat(e.toFixed(2),"ms")}},{key:"updateLogicTimeColor",value:function(e){this.logicTimeLabel.color=e>10?na:e>5?aa:ia}},{key:"updatePhysicTime",value:function(){var e=this.getPhysicTime();this.updatePhysicTimeColor(e),this.physicTimeLabel.string="Physic Time: ".concat(e.toFixed(2),"ms")}},{key:"updatePhysicTimeColor",value:function(e){this.physicTimeLabel.color=e>10?na:e>5?aa:ia}},{key:"updateRenderTime",value:function(){var e=this.getRenderTime();this.updateRenderTimeColor(e),this.renderTimeLabel.string="Render Time: ".concat(e.toFixed(2),"ms")}},{key:"updateRenderTimeColor",value:function(e){this.renderTimeLabel.color=e>10?na:e>5?aa:ia}},{key:"updateObjectMemoryUsage",value:function(){var e=this.getObjectMemoryUsage();this.updateObjectMemoryUsageColor(e),this.objectMemoryUsageLabel.string="Object Mem: ".concat(e.toFixed(2),"MB")}},{key:"updateObjectMemoryUsageColor",value:function(e){this.objectMemoryUsageLabel.color=e>40?na:e>25?aa:ia}},{key:"updateTextureMemoryUsage",value:function(){var e=this.getTextureMemoryUsage();this.updateTextureMemoryUsageColor(e),this.textureMemoryUsageLabel.string="Texture Mem: ".concat(e.toFixed(2),"MB")}},{key:"updateTextureMemoryUsageColor",value:function(e){this.textureMemoryUsageLabel.color=e>50?na:e>35?aa:ia}},{key:"updateDevicePixelRatio",value:function(){var e=this.getDevicePixelRatio();this.updateDevicePixelRatioColor(e),this.devicePixelRatioLabel.string="Device Pixel Ratio: ".concat(e)}},{key:"updateDevicePixelRatioColor",value:function(e){this.devicePixelRatioLabel.color=e>2?na:e<=1?aa:ia}},{key:"getFps",value:function(){if(!w.root)return 0;var e=w.root.fps;return Math.floor(e)||0}},{key:"getDrawCalls",value:function(){return w.root&&w.root.device.numDrawCalls||0}},{key:"getLogicTime",value:function(){return Math.floor(1e3*this.logicTimeCounter.value)/1e3||0}},{key:"getPhysicTime",value:function(){return Math.floor(1e3*this.physicTimeCounter.value)/1e3||0}},{key:"getRenderTime",value:function(){return Math.floor(1e3*this.renderTimeCounter.value)/1e3||0}},{key:"getObjectMemoryUsage",value:function(){return w.root&&w.root.device.memoryStatus.bufferSize/1048576||0}},{key:"getTextureMemoryUsage",value:function(){return w.root&&w.root.device.memoryStatus.textureSize/1048576||0}},{key:"getDevicePixelRatio",value:function(){return window.devicePixelRatio||0}},{key:"beforeUpdate",value:function(){var e=performance.now();this.logicTimeCounter.start(e)}},{key:"afterUpdate",value:function(){var e=performance.now();this.logicTimeCounter.end(e)}},{key:"beforePhysics",value:function(){var e=performance.now();this.physicTimeCounter.start(e)}},{key:"afterPhysics",value:function(){var e=performance.now();this.physicTimeCounter.end(e)}},{key:"beforeDraw",value:function(){var e=performance.now();this.renderTimeCounter.start(e)}},{key:"afterRender",value:function(){var e=performance.now();this.renderTimeCounter.end(e)}}]),r}(k)).prototype,"fpsLabel",[yi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ti=s(wi.prototype,"drawCountLabel",[vi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ai=s(wi.prototype,"logicTimeLabel",[fi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ri=s(wi.prototype,"physicTimeLabel",[mi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pi=s(wi.prototype,"renderTimeLabel",[gi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_i=s(wi.prototype,"objectMemoryUsageLabel",[bi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bi=s(wi.prototype,"textureMemoryUsageLabel",[Si],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Li=s(wi.prototype,"devicePixelRatioLabel",[ki],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ci=wi))||Ci);v._RF.pop(),v._RF.push({},"aa4b0d0u0hLeqd3+/PQZ/QD","SwitchButton",void 0);var oa,ra,sa,la,ua,ca,ha,pa,da,ya,va,fa,ma,ga,ba,Sa,ka,Ca,wa,Ea,Ta,Aa,Ra,Pa,_a,Ba,La,Oa,Da,Ia,Na,Fa,Ga,za,Ma,xa,Ua,Ha=m.ccclass,ja=m.property,Va=m.requireComponent,Wa=globalThis.game.analytics,qa=(Di=Ha("SwitchButton"),Ii=Va([A]),Ni=ja(R),Fi=ja(L),Gi=ja(L),zi=ja(R),Mi=ja({visible:function(){return this.useSound},type:He}),Di(xi=Ii((Hi=s((Ui=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"enable",Hi,u(e)),l(e,"nodeOn",ji,u(e)),l(e,"nodeOff",Vi,u(e)),l(e,"useSound",Wi,u(e)),l(e,"soundKey",qi,u(e)),e}return a(r,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"switch",value:function(){if(!this.node.active)return!1;if(Wa.event(GameCore.Plugins.Analytics.Events.BUTTON_CLICK,{enable:!this.enable,button_name:this.node.name,screen_name:We.getCurrentPage()}),this.useSound&&this.soundKey){var e=je[this.soundKey];e&&Ve.playSound(e)}return this.updateStatus(!this.enable)}},{key:"setEnabled",value:function(e){this.node.active&&this.updateStatus(e)}},{key:"updateStatus",value:function(e){return this.enable=e,this.nodeOn.active=e,this.nodeOff.active=!e,e}}]),r}(k)).prototype,"enable",[Ni],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),ji=s(Ui.prototype,"nodeOn",[Fi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vi=s(Ui.prototype,"nodeOff",[Gi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wi=s(Ui.prototype,"useSound",[zi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),qi=s(Ui.prototype,"soundKey",[Mi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return He[qe.BUTTON_CLICK]}}),xi=Ui))||xi)||xi);v._RF.pop(),v._RF.push({},"bce15LcVrxOfYMa9rbXN/qi","Localize",void 0);var Ka=m.ccclass,Ya=m.property,Ja=m.executeInEditMode,Za=m.disallowMultiple,Xa=GameCore,Qa=Xa.Utils,$a=Qa.Signal,eo=(Qa.Function,Qa.Array),to=Xa.Events,no=globalThis.game,io=no.language,ao=no.event,oo=function(e){return e[e.Text=0]="Text",e[e.Texture=1]="Texture",e}({});z(oo);var ro,so,lo,uo,co,ho,po,yo,vo,fo,mo,go,bo,So,ko,Co,wo,Eo,To,Ao="localize-params-updated",Ro=(oa=Ka("LocalizeParams"),ra=Ya({visible:!1}),sa=Ya(b),oa((ca=s((ua=function(){function e(){i(this,e),l(this,"_text",ca,this)}return a(e,[{key:"text",get:function(){return this._text},set:function(e){this._text=e,T.emit(Ao,{text:e,param:this})}}]),e}()).prototype,"_text",[ra],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),s(ua.prototype,"text",[sa],Object.getOwnPropertyDescriptor(ua.prototype,"text"),ua.prototype),la=ua))||la),Po=(ha=Ka("Localize"),pa=Ja(!0),da=Ya({visible:!1}),ya=Ya({type:b,visible:function(){return this.l10nType===oo.Texture}}),va=Ya({visible:!1}),fa=Ya({type:M(oo)}),ma=Ya({type:N,visible:function(){return this.l10nType===oo.Text}}),ga=Ya({type:[Ro],visible:function(){return this.l10nType===oo.Text}}),ba=Ya({type:E,visible:function(){return this.l10nType===oo.Texture}}),Sa=Ya({visible:function(){return this.l10nType===oo.Texture}}),ka=Ya({visible:!1}),Ca=Ya({type:b}),wa=Dt.onlyRunInLifeCycleAsync,Ea=Dt.onlyRunInLifeCycleAsync,Ta=Dt.onlyRunInLifeCycleAsync,Aa=Dt.onlyRunInLifeCycle,Ra=Dt.onlyRunInLifeCycleAsync,Pa=Dt.onlyRunInLifeCycleAsync,_a=Dt.onlyRunInLifeCycleAsync,Ba=Dt.onlyRunInLifeCycleAsync,La=Dt.onlyRunInLifeCycle,Oa=Dt.onlyRunInLifeCycleAsync,ha(Da=Za(Da=pa((Na=s((Ia=function(o){t(S,o);var r,s,c,h,p,d,y,v,f,m,g,b=n(S);function S(){var e;i(this,S);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=b.call.apply(b,[this].concat(n))).localized=!1,l(e,"_defaultLocale",Na,u(e)),l(e,"_l10nType",Fa,u(e)),l(e,"label",Ga,u(e)),l(e,"params",za,u(e)),l(e,"sprite",Ma,u(e)),l(e,"packable",xa,u(e)),l(e,"_key",Ua,u(e)),e.updateSignalController=new $a.SignalController,e.onLocalizeParamsUpdated=function(t){var n=t.param;eo.has(e.params,n)&&e.updateLocalization()},e.updateLocalization=function(){return e.updateLocalizationComp()},e}return a(S,[{key:"defaultLocale",get:function(){return this._defaultLocale},set:function(e){!function(e){return eo.has(Ke,e)}(e)?console.warn("Key ".concat(e," not found. Supported locales are ").concat(Ke.join(", "))):this._defaultLocale=e}},{key:"l10nType",get:function(){return this._l10nType},set:function(e){this._l10nType=e,e===oo.Texture&&(this.label=void 0,this.params=[]),e===oo.Text&&(this.sprite=void 0,this.packable=!0)}},{key:"key",get:function(){return this._key},set:function(e){try{if(!this.isValidKey(e))return void console.warn("Key ".concat(e," not found in locales"));this._key=e,this.updateLocalization()}catch(e){console.warn(e)}}},{key:"setParams",value:function(e){for(;this.params.length<e.length;)this.params.push(new Ro);for(var t=0,n=this.params.length;t<n;t++){var i,a=this.params[t];a.text=null!==(i=e[t])&&void 0!==i?i:a.text}}},{key:"waitUntilLocalized",value:function(){var e=this;return this.localized?Promise.resolve():new Promise((function(t){return e.node.once(Me.LOCALIZE_APPLIED,t)}))}},{key:"__preload",value:function(){}},{key:"isValidKey",value:function(e){return!!this.isTextKey(e)||!!this.isTextureKey(e)}},{key:"isTextKey",value:function(e){try{return this.l10nType===oo.Text&&io.hasTextKey(e)}catch(e){return console.warn(e),!1}}},{key:"isTextureKey",value:function(e){try{return this.l10nType===oo.Texture&&io.hasTextureKey(e)}catch(e){return console.warn(e),!1}}},{key:"onEnable",value:function(){this.listenEvent()}},{key:"onDisable",value:function(){this.unlistenEvent(),this.updateSignalController.abort()}},{key:"start",value:function(){this.initLocalization()}},{key:"listenEvent",value:function(){ao.on(to.LANGUAGE_CHANGED,this.updateLocalization),T.on(Ao,this.onLocalizeParamsUpdated)}},{key:"unlistenEvent",value:function(){ao.off(to.LANGUAGE_CHANGED,this.updateLocalization),T.off(Ao,this.onLocalizeParamsUpdated)}},{key:"initLocalization",value:function(){return this.updateLocalizationComp(!0)}},{key:"updateLocalizationComp",value:(g=e((function*(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.enabledInHierarchy&&void 0!==this.key){var t=this.updateSignalController.renew();try{if(this.localized=!1,this.isTextKey(this.key))yield this.updateTextLocalization(this.key,t);else{if(!this.isTextureKey(this.key))throw new Error("Key ".concat(this.key," not found in locales"));var n=io.getCurrentLocale(),i=!Ye&&e&&n===this.defaultLocale;i||(yield this.updateTextureLocalization(this.key,t))}if(t.aborted)return;this.localized=!0,T.emit(Me.LOCALIZE_APPLIED,{localize:this,key:this.key}),this.node.emit(Me.LOCALIZE_APPLIED,{localize:this,key:this.key})}catch(e){console.warn(e)}}})),function(){return g.apply(this,arguments)})},{key:"updateTextLocalization",value:(m=e((function*(e,t){var n,i=this,a=io.getCurrentLocale(),o=yield io.getText(e,this.params.map((function(e){return e.text})),a);yield null===(n=t.wrap((function(){return i.setTextFont(o,a,t)})))||void 0===n?void 0:n()})),function(e,t){return m.apply(this,arguments)})},{key:"setTextFont",value:(f=e((function*(e,t,n){if(void 0===this.label)throw new Error("Text localize component <".concat(this.node.name,"> has no label"));this.label.string=e,yield this.setTextFontRuntime(this.label,t,n)})),function(e,t,n){return f.apply(this,arguments)})},{key:"setTextFontRuntime",value:(v=e((function*(e,t,n){var i=yield ze.loadFontAsync(t);n.aborted||null!==i&&this.setLabelFontInLifeCycle(e,i)})),function(e,t,n){return v.apply(this,arguments)})},{key:"setLabelFontInLifeCycle",value:function(e,t){e.font=t}},{key:"setTextFontEditor",value:(y=e((function*(e,t,n){var i,a,o=this,r=yield this.requestFontUuid(t);if(null!==r){var s=yield null===(i=n.wrap((function(){return o.requestNodeInfo(e.node.uuid)})))||void 0===i?void 0:i();if(void 0!==s){var l=eo.searchIndex(s.__comps__,(function(e){return"cc.Label"===e.type})),u="__comps__.".concat(l,".font");yield null===(a=n.wrap((function(){return o.requestUpdateLabelFont(e.node.uuid,u,r)})))||void 0===a?void 0:a()}}})),function(e,t,n){return y.apply(this,arguments)})},{key:"requestFontUuid",value:(d=e((function*(e){return yield Editor.Message.request("asset-db","query-uuid","db://assets/loadable/".concat(Je[e]))})),function(e){return d.apply(this,arguments)})},{key:"requestNodeInfo",value:function(e){return Editor.Message.request("scene","query-node",e)}},{key:"requestUpdateLabelFont",value:(p=e((function*(e,t,n){yield Editor.Message.request("scene","set-property",{uuid:e,path:t,dump:{type:"cc.Font",value:{uuid:n}}})})),function(e,t,n){return p.apply(this,arguments)})},{key:"updateTextureLocalization",value:(h=e((function*(e,t){if(void 0===this.sprite)throw new Error("Texture localize component <".concat(this.node.name,"> has no sprite"));var n=yield io.getTexture(e);yield this.setSpriteRuntime(this.sprite,n,t)})),function(e,t){return h.apply(this,arguments)})},{key:"setSpriteRuntime",value:(c=e((function*(e,t,n){var i=yield ze.loadSpriteFrameAsync("".concat(t,"/spriteFrame"),this.packable);n.aborted||(null!==i?this.setSprite(e,i):console.warn("Sprite not found by path: ".concat(t)))})),function(e,t,n){return c.apply(this,arguments)})},{key:"setSprite",value:function(e,t){e.spriteFrame=t}},{key:"setSpriteEditor",value:(s=e((function*(e,t,n){var i,a,o=this,r=yield this.requestSpriteFrameInfo(t);if(0!==r.length)if(r.length>1){var s=r.slice(0,5).map((function(e){return e.path})),l="".concat(s.join(",")).concat(s.length<r.length?"...":"");console.warn("Ambiguous sprite's path: ".concat(t,". Found ").concat(l))}else{var u=yield null===(i=n.wrap((function(){return o.requestNodeInfo(e.node.uuid)})))||void 0===i?void 0:i();if(void 0!==u){var c=r[0].uuid,h=eo.searchIndex(u.__comps__,(function(e){return"cc.Sprite"===e.type})),p="__comps__.".concat(h,".spriteFrame");yield null===(a=n.wrap((function(){return o.requestUpdateSpriteSpriteFrame(e.node.uuid,p,c)})))||void 0===a?void 0:a()}}else console.error("Sprite not found by path: ".concat(t))})),function(e,t,n){return s.apply(this,arguments)})},{key:"requestSpriteFrameInfo",value:function(e){return Editor.Message.request("asset-db","query-assets",{pattern:"db://assets/loadable/".concat(e,"*"),ccType:"cc.SpriteFrame"})}},{key:"requestUpdateSpriteSpriteFrame",value:(r=e((function*(e,t,n){yield Editor.Message.request("scene","set-property",{uuid:e,path:t,dump:{type:"cc.SpriteFrame",value:{uuid:n}}})})),function(e,t,n){return r.apply(this,arguments)})}]),S}(k)).prototype,"_defaultLocale",[da],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"en"}}),s(Ia.prototype,"defaultLocale",[ya],Object.getOwnPropertyDescriptor(Ia.prototype,"defaultLocale"),Ia.prototype),Fa=s(Ia.prototype,"_l10nType",[va],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return oo.Text}}),s(Ia.prototype,"l10nType",[fa],Object.getOwnPropertyDescriptor(Ia.prototype,"l10nType"),Ia.prototype),Ga=s(Ia.prototype,"label",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),za=s(Ia.prototype,"params",[ga],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ma=s(Ia.prototype,"sprite",[ba],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xa=s(Ia.prototype,"packable",[Sa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ua=s(Ia.prototype,"_key",[ka],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s(Ia.prototype,"key",[Ca],Object.getOwnPropertyDescriptor(Ia.prototype,"key"),Ia.prototype),s(Ia.prototype,"updateTextLocalization",[wa],Object.getOwnPropertyDescriptor(Ia.prototype,"updateTextLocalization"),Ia.prototype),s(Ia.prototype,"setTextFont",[Ea],Object.getOwnPropertyDescriptor(Ia.prototype,"setTextFont"),Ia.prototype),s(Ia.prototype,"setTextFontRuntime",[Ta],Object.getOwnPropertyDescriptor(Ia.prototype,"setTextFontRuntime"),Ia.prototype),s(Ia.prototype,"setLabelFontInLifeCycle",[Aa],Object.getOwnPropertyDescriptor(Ia.prototype,"setLabelFontInLifeCycle"),Ia.prototype),s(Ia.prototype,"setTextFontEditor",[Ra],Object.getOwnPropertyDescriptor(Ia.prototype,"setTextFontEditor"),Ia.prototype),s(Ia.prototype,"requestUpdateLabelFont",[Pa],Object.getOwnPropertyDescriptor(Ia.prototype,"requestUpdateLabelFont"),Ia.prototype),s(Ia.prototype,"updateTextureLocalization",[_a],Object.getOwnPropertyDescriptor(Ia.prototype,"updateTextureLocalization"),Ia.prototype),s(Ia.prototype,"setSpriteRuntime",[Ba],Object.getOwnPropertyDescriptor(Ia.prototype,"setSpriteRuntime"),Ia.prototype),s(Ia.prototype,"setSprite",[La],Object.getOwnPropertyDescriptor(Ia.prototype,"setSprite"),Ia.prototype),s(Ia.prototype,"setSpriteEditor",[Oa],Object.getOwnPropertyDescriptor(Ia.prototype,"setSpriteEditor"),Ia.prototype),Da=Ia))||Da)||Da)||Da);v._RF.pop(),v._RF.push({},"b3fd8kSJpZMS47Z+G6ZUMJb","LocalizePreloader",void 0);var _o,Bo,Lo,Oo,Do,Io,No,Fo,Go,zo,Mo,xo,Uo,Ho,jo,Vo,Wo=m.ccclass,qo=m.property,Ko=GameCore.Utils,Yo=Ko.Array,Jo=Ko.Valid,Zo=globalThis.game.language,Xo=(ro=Wo("LocalizeTextureKey"),so=qo({visible:!1}),lo=qo(b),ro((ho=s((co=function(){function e(){i(this,e),l(this,"_key",ho,this)}return a(e,[{key:"key",get:function(){return this._key},set:function(e){Zo.hasTextureKey(e)?this._key=e:console.warn("Key ".concat(e," not found in locales"))}}]),e}()).prototype,"_key",[so],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),s(co.prototype,"key",[lo],Object.getOwnPropertyDescriptor(co.prototype,"key"),co.prototype),uo=co))||uo),Qo=(po=Wo("SupportedLocaleKey"),yo=qo({visible:!1}),vo=qo(b),po((go=s((mo=function(){function e(){i(this,e),l(this,"_key",go,this)}return a(e,[{key:"key",get:function(){return this._key},set:function(e){Yo.has(Ke,e)?this._key=e:console.warn("Key ".concat(e," not found. Supported locales are ").concat(Ke.join(", ")))}}]),e}()).prototype,"_key",[yo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),s(mo.prototype,"key",[vo],Object.getOwnPropertyDescriptor(mo.prototype,"key"),mo.prototype),fo=mo))||fo);bo=Wo("LocalizePreloader"),So=qo([Xo]),ko=qo({type:Qo,tooltip:"Preload only for these locales"}),bo((Eo=s((wo=function(o){t(h,o);var s,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=c.call.apply(c,[this].concat(n)),l(e,"keys",Eo,u(e)),l(e,"locales",To,u(e)),e}return a(h,[{key:"__preload",value:function(){this.preloadTextures()}},{key:"preloadTextures",value:(s=e((function*(){var e=Zo.getCurrentLocale(),t=this.locales.map((function(e){return e.key}));if(Yo.has(t,e)){var n,i=[],a=r(this.keys);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(!1!==Zo.hasTextureKey(o.key)){var s=yield Zo.getTexture(o.key),l="".concat(s,"/spriteFrame");i.push(l)}}}catch(e){a.e(e)}finally{a.f()}ze.loadSpriteFramesAsync(i)}else Jo.isDebugger()&&console.info("Skipping preloading of textures because current locale is not in the list of preloading locales")})),function(){return s.apply(this,arguments)})}]),h}(k)).prototype,"keys",[So],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),To=s(wo.prototype,"locales",[ko],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Co=wo));v._RF.pop(),v._RF.push({},"173031IssdPd61TGAHBxghZ","LocalizedLayout",void 0);var $o,er,tr,nr,ir,ar,or,rr,sr,lr,ur,cr,hr,pr,dr,yr,vr,fr,mr,gr,br,Sr,kr,Cr,wr,Er,Tr,Ar,Rr=m.ccclass,Pr=m.property,_r=m.executeInEditMode,Br=m.disallowMultiple,Lr=m.requireComponent;_o=Rr("LocalizedLayout"),Bo=_r(!0),Lo=Lr(x),Oo=Pr(Po),Do=Dt.required(),Io=Pr(x),No=Pr({visible:!1}),Fo=Pr({visible:!1}),Go=Pr({type:U,group:"Padding"}),zo=Pr({type:U,group:"Padding"}),_o(Mo=Br(Mo=Bo(Mo=Lo((Uo=s((xo=function(e){t(s,e);var o=n(s);function s(){var e;i(this,s);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"label",Uo,u(e)),l(e,"layout",Ho,u(e)),l(e,"_horizontal",jo,u(e)),l(e,"_vertical",Vo,u(e)),e.updateContentSize=function(){var t;if(void 0!==e.label){var n=null===(t=e.label.getComponent(x))||void 0===t?void 0:t.contentSize;if(void 0!==n){e.layout.setContentSize(n.width+e.horizontal,n.height+e.vertical);var i,a=e.node.getComponentsInChildren(H),o=r(a);try{for(o.s();!(i=o.n()).done;){i.value.updateAlignment()}}catch(e){o.e(e)}finally{o.f()}}}},e}return a(s,[{key:"horizontal",get:function(){return this._horizontal},set:function(e){this._horizontal=e,this.updateContentSize()}},{key:"vertical",get:function(){return this._vertical},set:function(e){this._vertical=e,this.updateContentSize()}},{key:"__preload",value:function(){this.layout=this.getComponent(x),Dt.validateRequiredProperties(this)}},{key:"start",value:function(){this.updateContentSize()}},{key:"onEnable",value:function(){this.listenEvent()}},{key:"onDisable",value:function(){this.unlistenEvent()}},{key:"listenEvent",value:function(){var e;null===(e=this.label)||void 0===e||e.node.on(Me.LOCALIZE_APPLIED,this.updateContentSize)}},{key:"unlistenEvent",value:function(){var e;null===(e=this.label)||void 0===e||e.node.off(Me.LOCALIZE_APPLIED,this.updateContentSize)}}]),s}(k)).prototype,"label",[Oo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ho=s(xo.prototype,"layout",[Do,Io],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jo=s(xo.prototype,"_horizontal",[No],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Vo=s(xo.prototype,"_vertical",[Fo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),s(xo.prototype,"horizontal",[Go],Object.getOwnPropertyDescriptor(xo.prototype,"horizontal"),xo.prototype),s(xo.prototype,"vertical",[zo],Object.getOwnPropertyDescriptor(xo.prototype,"vertical"),xo.prototype),Mo=xo))||Mo)||Mo)||Mo);v._RF.pop(),v._RF.push({},"a2260jBMJFPCrn/Q4Vo4iB1","BatchNodes",void 0);var Or,Dr,Ir,Nr,Fr,Gr,zr,Mr,xr,Ur,Hr,jr,Vr,Wr,qr,Kr,Yr,Jr,Zr,Xr,Qr=m.ccclass,$r=m.executionOrder,es=m.property,ts=GameCore.Utils,ns=ts.Decorator,is=ts.Array,as="Batch By Name",os="Batch Label",rs="Batch Sprite";$o=Qr("BatchNodes"),er=$r(99999),tr=es({group:{name:as}}),nr=es({type:[S],group:{name:as}}),ir=es({type:[b],group:{name:as}}),ar=es({group:{name:os}}),or=es({group:{name:os}}),rr=es({group:{name:os}}),sr=es({group:{name:rs}}),lr=es({group:{name:rs}}),ur=es({readonly:!0}),cr=es({readonly:!0}),hr=es({readonly:!0}),pr=ns.debounce(1e3),$o(dr=er((vr=s((yr=function(e){t(s,e);var o=n(s);function s(){var e;i(this,s);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"batchByName",vr,u(e)),l(e,"depthNames",fr,u(e)),l(e,"listName",mr,u(e)),l(e,"batchLabel",gr,u(e)),l(e,"depthLabel",br,u(e)),l(e,"typeLabel",Sr,u(e)),l(e,"batchSprite",kr,u(e)),l(e,"depthSprite",Cr,u(e)),l(e,"batchAllNodes",wr,u(e)),l(e,"batchDepth",Er,u(e)),l(e,"checkOverlap",Tr,u(e)),e.batchNode={},e.labelChildren=[],e.spriteChildren=[],e.allChildren=[],e.nameChildren=[],e.originalParents={},e.isInited=!1,l(e,"handleNodeChange",Ar,u(e)),e.onAfterUpdate=function(){e.isInited&&e.hierarchyChildren()},e.onAfterRender=function(){e.isInited&&e.restoreOriginalChildren()},e}return a(s,[{key:"__preload",value:function(){this.enabled&&(w.on(F.EVENT_AFTER_UPDATE,this.onAfterUpdate),w.on(F.EVENT_AFTER_RENDER,this.onAfterRender))}},{key:"onDestroy",value:function(){w.off(F.EVENT_AFTER_UPDATE,this.onAfterUpdate),w.off(F.EVENT_AFTER_RENDER,this.onAfterRender)}},{key:"onLoad",value:function(){this.enabled&&(this.setupBatchNodes(this.node),this.isInited=!0)}},{key:"onEnable",value:function(){this.isInited||(w.on(F.EVENT_AFTER_UPDATE,this.onAfterUpdate),w.on(F.EVENT_AFTER_RENDER,this.onAfterRender),this.setupBatchNodes(this.node),this.isInited=!0)}},{key:"handleActiveChange",value:function(e){e.once(L.EventType.ACTIVE_IN_HIERARCHY_CHANGED,this.handleNodeChange)}},{key:"onDisable",value:function(){this.restoreOriginalChildren(),w.off(F.EVENT_AFTER_UPDATE,this.onAfterUpdate),w.off(F.EVENT_AFTER_RENDER,this.onAfterRender),this.isInited=!1}},{key:"setupBatchNodes",value:function(e){this.allChildren=[],this.nameChildren=[],this.labelChildren=[],this.spriteChildren=[],this.saveOriginalChildren(e),this.createGlobalNodes(e),this.createGlobalNameNodes(e),this.createGlobalLabelNode(e),this.createGlobalSpriteNode(e),this.sortGlobalNodes()}},{key:"sortGlobalNodes",value:function(){var e,t,n,i=this;null===(e=this.batchNode.node)||void 0===e||e.setSiblingIndex(0),null===(t=this.batchNode.label)||void 0===t||t.setSiblingIndex(this.depthLabel),null===(n=this.batchNode.sprite)||void 0===n||n.setSiblingIndex(this.depthSprite),this.listName.forEach((function(e,t){var n,a=i.depthNames[t];void 0!==a?null===(n=i.batchNode[e])||void 0===n||n.setSiblingIndex(a):console.warn("BatchNodes: depth is undefined",e,t,a)}))}},{key:"createGlobalNodes",value:function(e){if(this.batchAllNodes){var t=new L("GlobalBatchNode");t.active=!0,this.batchNode.node=t,e.addChild(t)}}},{key:"createGlobalNameNodes",value:function(e){if(this.batchByName){var t,n=r(this.listName);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(!this.batchNode[i]){var a=new L(i);a.active=!0,this.batchNode[i]=a,e.addChild(a)}}}catch(e){n.e(e)}finally{n.f()}}}},{key:"createGlobalLabelNode",value:function(e){if(this.batchLabel){var t=new L("GlobalLabelNode");t.active=!0,this.batchNode.label=t,e.addChild(t)}}},{key:"createGlobalSpriteNode",value:function(e){if(this.batchSprite){var t=new L("GlobalSpriteNode");t.active=!0,this.batchNode.sprite=t,e.addChild(t)}}},{key:"saveOriginalParents",value:function(){var e,t=[].concat(c(this.labelChildren),c(this.spriteChildren)),n=this.nameChildren,i=r(t);try{for(i.s();!(e=i.n()).done;){var a=e.value;a.node.parent&&(this.handleActiveChange(a.node),this.originalParents[a.uuid]=a.node.parent)}}catch(e){i.e(e)}finally{i.f()}var o,s=r(n);try{for(s.s();!(o=s.n()).done;){var l=o.value;l.parent&&(this.handleActiveChange(l),this.originalParents[l.uuid]=l.parent)}}catch(e){s.e(e)}finally{s.f()}}},{key:"saveOriginalChildren",value:function(e){var t,n=e.children,i=r(n);try{for(i.s();!(t=i.n()).done;){var a=t.value;this.saveLabelChildren(a),this.saveSpriteChildren(a),this.saveNodeChildrenByName(a),this.saveNodeChildrenByType(a)}}catch(e){i.e(e)}finally{i.f()}this.saveOriginalParents()}},{key:"saveLabelChildren",value:function(e){var t;if(this.batchLabel){var n=e.getComponentsInChildren(N),i={none:N.CacheMode.NONE,char:N.CacheMode.CHAR,bitmap:N.CacheMode.BITMAP}[this.typeLabel];i&&(n=n.filter((function(e){return e.cacheMode===i}))),0!==n.length&&(t=this.labelChildren).push.apply(t,c(n))}}},{key:"saveSpriteChildren",value:function(e){var t;if(this.batchSprite){var n=e.getComponentsInChildren(E);0!==n.length&&(t=this.spriteChildren).push.apply(t,c(n))}}},{key:"saveNodeChildrenByName",value:function(e){if(this.batchByName){var t,n=r(e.children);try{for(n.s();!(t=n.n()).done;){var i=t.value;is.has(this.listName,i.name)?this.nameChildren.push(i):this.saveNodeChildrenByName(i)}}catch(e){n.e(e)}finally{n.f()}}}},{key:"saveNodeChildrenByType",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.batchAllNodes){var i=e.getComponentsInChildren(k);if((t=this.allChildren).push.apply(t,c(i)),!(this.batchDepth<1||n>=this.batchDepth)){var a,o=r(this.allChildren);try{for(o.s();!(a=o.n()).done;){var s=a.value;this.saveNodeChildrenByType(s.node,this.batchDepth)}}catch(e){o.e(e)}finally{o.f()}}}}},{key:"hierarchyChildren",value:function(){var e,t=function(e,t){e.node.isValid&&e.node.activeInHierarchy&&t&&!e.node.isChildOf(t)&&(e.node.setParent(t,!0),e.node.layer=j.Enum.UI_2D)},n=["GlobalLabelNode","GlobalSpriteNode","GlobalBatchNode"],i=r(this.labelChildren);try{for(i.s();!(e=i.n()).done;){t(e.value,this.batchNode.label)}}catch(e){i.e(e)}finally{i.f()}var a,o=r(this.spriteChildren);try{for(o.s();!(a=o.n()).done;){t(a.value,this.batchNode.sprite)}}catch(e){o.e(e)}finally{o.f()}var s,l=r(this.allChildren);try{for(l.s();!(s=l.n()).done;){t(s.value,this.batchNode.node)}}catch(e){l.e(e)}finally{l.f()}this.allChildren.sort((function(e,t){return e.constructor.name.localeCompare(t.constructor.name)})),this.labelChildren.sort((function(e,t){return e.cacheMode-t.cacheMode}));var u,c=r(this.nameChildren);try{for(c.s();!(u=c.n()).done;){var h=u.value;if(h.isValid&&h.activeInHierarchy&&h.isTransformDirty()){var p=h.getComponent(O);if(!(p&&p.opacity<1||is.has(n,h.name))){var d=this.batchNode[h.name];d&&(h.isChildOf(d)||(h.setParent(d,!0),h.layer=j.Enum.UI_2D))}}}}catch(e){c.e(e)}finally{c.f()}}},{key:"restoreOriginalChildren",value:function(){var e=[].concat(c(this.labelChildren),c(this.spriteChildren));if(e.length>0){var t,n=r(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=this.originalParents[i.uuid];a&&(i.node.isChildOf(a)||i.node.setParent(a,!0))}}catch(e){n.e(e)}finally{n.f()}}var o,s=r(this.nameChildren);try{for(s.s();!(o=s.n()).done;){var l=o.value,u=this.originalParents[l.uuid];u&&(l.isChildOf(u)||l.setParent(u,!0))}}catch(e){s.e(e)}finally{s.f()}}}]),s}(k)).prototype,"batchByName",[tr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),fr=s(yr.prototype,"depthNames",[nr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),mr=s(yr.prototype,"listName",[ir],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),gr=s(yr.prototype,"batchLabel",[ar],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),br=s(yr.prototype,"depthLabel",[or],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Sr=s(yr.prototype,"typeLabel",[rr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"char"}}),kr=s(yr.prototype,"batchSprite",[sr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Cr=s(yr.prototype,"depthSprite",[lr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),wr=s(yr.prototype,"batchAllNodes",[ur],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Er=s(yr.prototype,"batchDepth",[cr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Tr=s(yr.prototype,"checkOverlap",[hr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ar=s(yr.prototype,"handleNodeChange",[pr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isInited&&(console.warn("handleNodeChange",e.node.name),e.setupBatchNodes(e.node))}}}),dr=yr))||dr);v._RF.pop(),v._RF.push({},"1ecebJCOPhK9L6AO92sjHzD","BatchNodesV2",void 0);var ss,ls=m.ccclass,us=m.executionOrder,cs=m.property,hs=GameCore.Utils,ps=hs.Array,ds=hs.Object;Or=ls("BatchNodesV2"),Dr=us(99999),Ir=cs({group:"Batch Settings"}),Nr=cs({type:[b],group:"Batch Settings",visible:function(){return this.batchByName}}),Fr=cs({type:[S],group:"Batch Settings",visible:function(){return this.batchByName}}),Gr=cs({group:"Label Settings"}),zr=cs({group:"Label Settings",visible:function(){return this.batchLabel}}),Mr=cs({group:"Label Settings",visible:function(){return this.batchLabel}}),xr=cs({group:"Sprite Settings"}),Ur=cs({group:"Sprite Settings",visible:function(){return this.batchSprite}}),Or(Hr=Dr((Vr=s((jr=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"batchByName",Vr,u(e)),l(e,"listName",Wr,u(e)),l(e,"depthNames",qr,u(e)),l(e,"batchLabel",Kr,u(e)),l(e,"typeLabel",Yr,u(e)),l(e,"depthLabel",Jr,u(e)),l(e,"batchSprite",Zr,u(e)),l(e,"depthSprite",Xr,u(e)),e.batchNodes={},e.originalParents={},e.labelNodes=[],e.spriteNodes=[],e.namedNodes={},e.isInitialized=!1,e.labelNodesByType={bitmap:[],char:[],none:[]},e.isEventListenerSetup=!1,e.onAfterUpdate=function(){e.isInitialized&&e.batchActiveNodes()},e.onAfterRender=function(){e.isInitialized&&e.restoreNodes()},e}return a(r,[{key:"depthLabelBitmap",get:function(){return this.depthLabel}},{key:"depthLabelChar",get:function(){return this.depthLabel+1}},{key:"depthLabelNone",get:function(){return this.depthLabel+2}},{key:"onLoad",value:function(){this.enabled&&this.initializeDataStructures()}},{key:"start",value:function(){this.enabled&&this.initialize()}},{key:"onEnable",value:function(){this.isEventListenerSetup||(this.setupEventListeners(),this.isEventListenerSetup=!0)}},{key:"onDisable",value:function(){this.isEventListenerSetup&&(this.removeEventListeners(),this.isEventListenerSetup=!1),this.restoreNodes()}},{key:"onDestroy",value:function(){this.removeEventListeners(),this.restoreNodes(),this.clearData()}},{key:"initializeDataStructures",value:function(){this.batchNodes={},this.originalParents={},this.labelNodes=[],this.spriteNodes=[],this.namedNodes={},this.labelNodesByType={bitmap:[],char:[],none:[]}}},{key:"initialize",value:function(){this.isInitialized||(this.createBatchContainers(),this.scanNodes(this.node),this.sortBatchNodes(),this.isInitialized=!0)}},{key:"clearData",value:function(){this.batchNodes={},this.originalParents={},this.labelNodes=[],this.spriteNodes=[],this.namedNodes={},this.labelNodesByType={bitmap:[],char:[],none:[]},this.isInitialized=!1}},{key:"categorizeNode",value:function(e){if(e.parent){if(this.originalParents[e.uuid]=e.parent,this.batchLabel){var t=e.getComponent(N);t&&("all"===this.typeLabel?t.cacheMode===N.CacheMode.BITMAP?this.labelNodesByType.bitmap.push(e):t.cacheMode===N.CacheMode.CHAR?this.labelNodesByType.char.push(e):this.labelNodesByType.none.push(e):this.isValidLabel(t)&&this.labelNodes.push(e))}if(this.batchSprite)e.getComponent(E)&&this.spriteNodes.push(e);if(this.batchByName){var n=e.name;this.listName.includes(n)&&(this.namedNodes[n]||(this.namedNodes[n]=[]),this.namedNodes[n].push(e))}}}},{key:"isValidLabel",value:function(e){var t={none:N.CacheMode.NONE,char:N.CacheMode.CHAR,bitmap:N.CacheMode.BITMAP};return e.cacheMode===t[this.typeLabel]}},{key:"sortBatchNodes",value:function(){if(this.batchLabel)if("all"===this.typeLabel){var e,t,n;null===(e=this.batchNodes.label_bitmap)||void 0===e||e.setSiblingIndex(this.depthLabelBitmap),null===(t=this.batchNodes.label_char)||void 0===t||t.setSiblingIndex(this.depthLabelChar),null===(n=this.batchNodes.label_none)||void 0===n||n.setSiblingIndex(this.depthLabelNone)}else{var i,a={bitmap:this.depthLabelBitmap,char:this.depthLabelChar,none:this.depthLabelNone}[this.typeLabel]||this.depthLabelChar;null===(i=this.batchNodes.label)||void 0===i||i.setSiblingIndex(a)}this.batchNodes.sprite&&this.batchNodes.sprite.setSiblingIndex(this.depthSprite);for(var o=0;o<this.listName.length;o++){var r=this.listName[o];if(r){var s=this.depthNames[o]||0,l=this.batchNodes[r];l&&l.setSiblingIndex(s)}}}},{key:"batchNodeArray",value:function(e,t){for(var n=0;n<e.length;n++){var i=e[n];null!=i&&i.isValid&&i.activeInHierarchy&&(i.parent!==t&&(this.isBatchContainer(i)||i.isTransformDirty()&&this.isParentChainActive(i)&&(i.setParent(t,!0),i.layer=j.Enum.UI_2D)))}}},{key:"isBatchContainer",value:function(e){var t=ds.vals(this.batchNodes);return ps.has(t,e)}},{key:"isParentChainActive",value:function(e){for(var t=e,n=this.node;t&&t!==n;){if(!t.active||!t.isValid)return!1;t=t.parent}return t===n}},{key:"restoreNodes",value:function(){var e=this,t=function(t){var n=e.originalParents[t.uuid];null!=n&&n.isValid&&t.parent!==n&&e.isParentChainActive(n)&&t.setParent(n,!0)};if(this.batchLabel)if("all"===this.typeLabel)for(var n in this.labelNodesByType)for(var i=this.labelNodesByType[n],a=0;a<i.length;a++){var o=i[a];o&&t(o)}else for(var r=0;r<this.labelNodes.length;r++){var s=this.labelNodes[r];s&&t(s)}if(this.batchSprite)for(var l=0;l<this.spriteNodes.length;l++){var u=this.spriteNodes[l];u&&t(u)}if(this.batchByName)for(var c in this.namedNodes){var h=this.namedNodes[c];if(h)for(var p=0;p<h.length;p++){var d=h[p];d&&t(d)}}}},{key:"setupEventListeners",value:function(){w.on(F.EVENT_AFTER_UPDATE,this.onAfterUpdate),w.on(F.EVENT_AFTER_RENDER,this.onAfterRender)}},{key:"removeEventListeners",value:function(){w.off(F.EVENT_AFTER_UPDATE,this.onAfterUpdate),w.off(F.EVENT_AFTER_RENDER,this.onAfterRender)}},{key:"createBatchContainers",value:function(){if(this.batchLabel)if("all"===this.typeLabel)for(var e=0,t=["bitmap","char","none"];e<t.length;e++){var n=t[e],i=new L("BatchLabel_".concat(n));i.layer=j.Enum.UI_2D,this.node.addChild(i),this.batchNodes["label_".concat(n)]=i}else{var a=new L("BatchLabel");a.layer=j.Enum.UI_2D,this.node.addChild(a),this.batchNodes.label=a}if(this.batchSprite){var o=new L("BatchSprite");o.layer=j.Enum.UI_2D,this.node.addChild(o),this.batchNodes.sprite=o}if(this.batchByName)for(var r=0;r<this.listName.length;r++){var s=this.listName[r];if(s){var l=new L("Batch_".concat(s));l.layer=j.Enum.UI_2D,this.node.addChild(l),this.batchNodes[s]=l,this.namedNodes[s]=[]}}}},{key:"scanNodes",value:function(e){for(var t=e.children,n=0;n<t.length;n++){var i=t[n];i&&(this.categorizeNode(i),i.children.length>0&&this.scanNodes(i))}}},{key:"batchActiveNodes",value:function(){if(this.batchLabel&&("all"===this.typeLabel?(this.batchNodesByType(this.labelNodesByType.bitmap,"label_bitmap"),this.batchNodesByType(this.labelNodesByType.char,"label_char"),this.batchNodesByType(this.labelNodesByType.none,"label_none")):this.batchNodesByType(this.labelNodes,"label")),this.batchSprite&&this.batchNodesByType(this.spriteNodes,"sprite"),this.batchByName)for(var e in this.namedNodes){var t=this.namedNodes[e];if(t){var n=this.batchNodes[e];n&&this.batchNodeArray(t,n)}}}},{key:"batchNodesByType",value:function(e,t){var n=this.batchNodes[t];n&&this.batchNodeArray(e,n)}}]),r}(k)).prototype,"batchByName",[Ir],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Wr=s(jr.prototype,"listName",[Nr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),qr=s(jr.prototype,"depthNames",[Fr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Kr=s(jr.prototype,"batchLabel",[Gr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Yr=s(jr.prototype,"typeLabel",[zr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"char"}}),Jr=s(jr.prototype,"depthLabel",[Mr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Zr=s(jr.prototype,"batchSprite",[xr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Xr=s(jr.prototype,"depthSprite",[Ur],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Hr=jr))||Hr);v._RF.pop(),v._RF.push({},"9b958Lf6PFClb/JuJfTLzxG","Vibrate",void 0);var ys=m.ccclass,vs=GameCore.Utils,fs=globalThis.game.player,ms=ys("Vibrate")(ss=function(e){t(r,e);var o=n(r);function r(){return i(this,r),o.apply(this,arguments)}return a(r,[{key:"vibrate",value:function(e){if(this.isVibrateEnable()&&!vs.Browser.vibrate(e)){if("performHapticFeedbackAsync"in GameSDK.extra)return void GameSDK.extra.performHapticFeedbackAsync();console.warn("Vibrate failed")}}},{key:"isVibrateEnable",value:function(){return!!fs.getPlayerSetting("vibrate")}}]),r}(k))||ss;v._RF.pop(),v._RF.push({},"e6289NIEoZEGaTkmk/RVxJy","ClassicModeLevels",void 0);var gs=325,bs=[165,201,158,230,313,274,280,266,295,260,225,215,253,323,297,312,268,144,121,220,190,311,270,302,166,142,169,103,314,299,228,127,172,132,176,134,118,116,131,271,282,138,108,149,244,261,210,208,234,272,184,249,273,216,120,214,317,148,139,154,109,267,162,105,306,245,153,100,232,194,175,292,124,205,110,145,293,322,255,227,304,187,319,111,207,305,177,259,248,269,238,263,126,188,200,135,198,170,218,178,122,321,137,257,291,196,179,252,140,113,223,303,197,224,115,185,181,112,301,146,202,286,289,106,285,147,247,287,246,163,101,206,164,221,298,219,203,129,283,315,324,281,102,114,307,242,318,173,276,152,217,222,195,130,211,308,141,213,236,290,284,309,320,167,161,192,258,265,233,182,237,279,256,156,229,316,212,157,250,183,123,262,159,264,239,117,189,231,199,278,193,125,186,155,310,209,235,204,104,107,325,128,119,160,275,241,168,191,143,136,171,243,174,150,277,251,296,288,240,180,151,254,226,133,294,300];v._RF.pop(),v._RF.push({},"ad867amogBFGJo9jp78EnQP","DevTools",void 0);var Ss=function(e){return e.UNLOCK_DEV_TOOLS="unlock-dev-tools",e.TRIGGER_UNLOCK_KEY="trigger-unlock-key",e.TRIGGER_RESET_SEQUENCE="trigger-reset-sequence",e}(Ss||{}),ks={Events:Ss,UNLOCK_SEQUENCE:"101013012031"};v._RF.pop(),v._RF.push({},"437c2Vl2gxMEIGhbeMNXO0c","EndlessProgressions",void 0);var Cs={0:{beeSpeed:60,spawnRandOffset:100,targetOffsetMultiplier:0,count:[8,15]},10:{beeSpeed:60,spawnRandOffset:100,targetOffsetMultiplier:.5,count:[10,20]},20:{beeSpeed:70,spawnRandOffset:110,targetOffsetMultiplier:.6,count:[10,20]},50:{beeSpeed:70,spawnRandOffset:120,targetOffsetMultiplier:.7,count:[10,20]}};v._RF.pop(),v._RF.push({},"91649r9HndHx6OjoY70+mR1","GameMode",void 0);var ws="classic",Es="endless";v._RF.pop(),v._RF.push({},"adb272QtfxDGZ+87PwkWEiN","GameSettings",void 0);v._RF.pop(),v._RF.push({},"27033qxh65F25R336CXMYGV","BeeRole",void 0);var Ts=function(e){return e[e.NORMAL=0]="NORMAL",e[e.PATH_SEEKER=1]="PATH_SEEKER",e[e.PUSHER=2]="PUSHER",e}(Ts||{});v._RF.pop(),v._RF.push({},"ab23abxgeZD0KDVdLYEeAQS","BeeState",void 0);var As=function(e){return e[e.IDLE=0]="IDLE",e[e.FLYING=1]="FLYING",e[e.WAITING_TO_SEEK_PATH=2]="WAITING_TO_SEEK_PATH",e[e.SEEKING_PATH=3]="SEEKING_PATH",e[e.ATTACKING=4]="ATTACKING",e[e.DIE=5]="DIE",e}(As||{});v._RF.pop(),v._RF.push({},"9ef7e8FlFJOS5DAWzwBrkww","GameObject",void 0);for(var Rs=function(e){return e.AIR_FAN="air-fan",e.BALLOON="balloon",e.DOGE="doge",e.SPIDER="spider",e.BEE="bee",e.BIG_BEE="big-bee",e.BIG_BEE_BULLET="big-bee-bullet",e.BEEHIVE="beehive",e.BRICK="brick",e.GRASS="grass",e.GRASS_DARK="grass-dark",e.COLLIDER="collider",e.THORN="thorn",e.THORN_BALL="thorn-ball",e.MAP_LINE="line",e.WOOD="wood",e.WOOD_STROKE="wood-stroke",e.POISON="poison",e.POISON_BUBBLE="poison-bubble",e.POISON_SURFACE="poison-surface",e.WATER="water",e.WATER_SURFACE="water-surface",e.DANGER_AREA="danger-area",e.DUST_PARTICLE="dust-particle",e.ROPE="rope",e.JOINT="joint",e.DRAW_LINE="draw-line",e.CROSSING_BEE_LINE="crossing-bee-line",e}({}),Ps=Rs.COLLIDER,_s=Rs.DANGER_AREA,Bs=Rs.DOGE,Ls=[Ps,_s,Rs.GRASS,Rs.GRASS_DARK,Rs.BRICK,Rs.MAP_LINE,Rs.POISON,Rs.POISON_SURFACE,Rs.POISON_BUBBLE,Rs.AIR_FAN,Rs.WOOD,Rs.WOOD_STROKE,Rs.THORN_BALL,Rs.THORN,Rs.CROSSING_BEE_LINE,Rs.BEE,Bs,Rs.BEEHIVE,Rs.ROPE,Rs.BALLOON,Rs.WATER,Rs.WATER_SURFACE,Rs.JOINT,Rs.DUST_PARTICLE,Rs.DRAW_LINE],Os={},Ds=0;Ds<Ls.length;Ds++)Os[Ls[Ds]]=Ds;var Is=Os;v._RF.pop(),v._RF.push({},"4c577T9x2FPKpyFoVPXbav0","ObjectIds",void 0);var Ns=function(e){return e[e.BRICK=1]="BRICK",e[e.STROKE=3]="STROKE",e[e.GRASS_DARK=4]="GRASS_DARK",e[e.GRASS=5]="GRASS",e[e.COLLIDER=6]="COLLIDER",e[e.THORN=7]="THORN",e[e.WATER=8]="WATER",e[e.WATER_SURFACE=9]="WATER_SURFACE",e[e.LINE=10]="LINE",e[e.POISON_SURFACE=11]="POISON_SURFACE",e[e.POISON=12]="POISON",e[e.WOOD=13]="WOOD",e[e.THORN_BALL=14]="THORN_BALL",e[e.CONNECT=15]="CONNECT",e[e.DANGER_AREA=16]="DANGER_AREA",e[e.BALLOON=17]="BALLOON",e[e.AIR_FAN=18]="AIR_FAN",e[e.SPIDER=19]="SPIDER",e[e.DOGE_A=101]="DOGE_A",e[e.DOGE_B=106]="DOGE_B",e[e.BIG_BEE=107]="BIG_BEE",e[e.BEEHIVE_A=102]="BEEHIVE_A",e[e.BEEHIVE_B=103]="BEEHIVE_B",e[e.BEEHIVE_C=104]="BEEHIVE_C",e[e.BEEHIVE_D=105]="BEEHIVE_D",e}(Ns||{});v._RF.pop(),v._RF.push({},"7bb7ftpsjJCX5G6+WtNYJ2x","PhysicsGroup",void 0);var Fs=function(e){return e[e.DEFAULT=1]="DEFAULT",e[e.BEE=2]="BEE",e[e.MAIN_OBJECT=4]="MAIN_OBJECT",e[e.WORLD_BOUND=8]="WORLD_BOUND",e[e.ROPE=16]="ROPE",e}(Fs||{});v._RF.pop(),v._RF.push({},"a6e4bjV/RVH17qBEx1mZaFg","ResourcePaths",void 0);var Gs,zs=function(e){return e.WATER_SURFACE_FRAME="sprites/water-surface/spriteFrame",e.IC_HAND_FRAME="sprites/ic-hand/spriteFrame",e.POISON_CIRCLE_FRAME="sprites/poison-circle/spriteFrame",e.POISON_BUBBLE_PREFAB="prefabs/PoisonBubble",e.DUST_PARTICLE_SPINE="spines/dust-particle/siwang_texiao",e.MAP_JSON_PREFIX="maps-json/",e}(zs||{});v._RF.pop(),v._RF.push({},"476e6UyMHFJyI2GmFP4KpHY","BaseObject",void 0);var Ms,xs,Us,Hs,js,Vs,Ws,qs=(0,m.ccclass)("BaseObject")(Gs=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).points=[],e.body=null,e.bodyType=V.Static,e}return a(r,[{key:"onLoad",value:function(){this.node.layer=j.Enum.UI_2D}},{key:"sleep",value:function(){if(!this.body){if(this.body=this.getComponent(W),!this.body)return;this.bodyType=this.body.type}this.enabled=!1,this.body.sleep(),this.body.type=V.Static}},{key:"wake",value:function(){if(this.enabled=!0,this.body)this.body.wakeUp(),this.body.type=this.bodyType;else{if(this.body=this.getComponent(W),!this.body)return;this.bodyType=this.body.type}}},{key:"hide",value:function(){var e;this.enabled=!1,null===(e=this.body)||void 0===e||e.sleep();var t=this.getComponent(q.Skeleton);t&&(t.enabled=!1);var n=this.getComponent(E);n&&(n.enabled=!1)}},{key:"preHide",value:function(){var e;this.enabled=!1,null===(e=this.body)||void 0===e||e.sleep(),this.scheduleOnce(this.hide,.2)}},{key:"appear",value:function(){this.enabled=!0;var e=this.getComponent(q.Skeleton);e&&(e.enabled=!0)}},{key:"setSpineAnimation",value:function(e,t){var n=this.getComponent(q.Skeleton);null==n||n.setAnimation(0,e,t)}},{key:"setEnable",value:function(e){this.enabled=e}},{key:"angle",value:function(e,t){var n=Math.atan2(t,e);return n<0&&(n+=2*Math.PI),n}},{key:"getVectorDataFromAToB",value:function(e,t){var n=t.x-e.x,i=t.y-e.y;return{vector:new K(n,i).normalize(),dx:n,dy:i}}},{key:"kill",value:function(){this.node.active=!1}},{key:"revive",value:function(){this.node.active=!0}}]),r}(k))||Gs;v._RF.pop(),v._RF.push({},"15b7bvQaXpFgItiEHCr7GsP","AirFan",void 0);var Ks=m.ccclass,Ys=m.property,Js=GameCore.Utils.Array,Zs=(Ms=Ks("AirFan"),xs=Ys(S),Us=Ys(Y),Ms((Vs=s((js=function(e){t(s,e);var o=n(s);function s(){var e;i(this,s);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"pushForce",Vs,u(e)),e.force=new K(0,0),e.affectedObjects=[],l(e,"collider",Ws,u(e)),e.colliders=[],e.onBeginContact=function(t,n){Js.has(e.affectedObjects,n.node.name)&&-1===e.colliders.findIndex((function(e){return e.node===n.node}))&&e.colliders.push(n)},e.onEndContact=function(t,n){var i=e.colliders.indexOf(n);-1!==i&&e.colliders.splice(i,1)},e}return a(s,[{key:"__preload",value:function(){this.collider=this.getComponent(Y),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"start",value:function(){this.colliders=[],this.affectedObjects=[Rs.DOGE,Rs.THORN_BALL,Rs.DRAW_LINE,Rs.WOOD,Rs.BALLOON],this.collider.on(J.BEGIN_CONTACT,this.onBeginContact),this.collider.on(J.END_CONTACT,this.onEndContact)}},{key:"update",value:function(e){var t,n=r(this.colliders);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=i.getComponent(W);if(a){var o=this.force;i.node.name===Rs.DRAW_LINE&&(o=this.force.clone().multiplyScalar(i.density/3)),i.node.name===Rs.DOGE&&(o=this.force.clone().multiplyScalar(250/this.pushForce)),a.applyForceToCenter(o,!0)}}}catch(e){n.e(e)}finally{n.f()}}},{key:"setForceDirection",value:function(e){var t=new K(0,1).rotate(Z.toRadian(e));this.force=t.clone().normalize().multiplyScalar(this.pushForce)}},{key:"sleep",value:function(){h(p(s.prototype),"sleep",this).call(this),this.enabled=!1}},{key:"wake",value:function(){h(p(s.prototype),"wake",this).call(this),this.enabled=!0}}]),s}(qs)).prototype,"pushForce",[xs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 400}}),Ws=s(js.prototype,"collider",[Us],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hs=js))||Hs);v._RF.pop(),v._RF.push({},"8a02eYTwSpP9IpQ4MrTsAiL","SpineAnimationName",void 0);var Xs,Qs,$s,el,tl,nl,il,al={IDLE:"normal",SMILE:"smile",HURT:"hurt",INACTIVE:"cry",DROWNING:"troll",FREAK_OUT:"freak out",THORN_INACTIVE:"die"},ol={FLAP_WINGS:"animation",SMOKE_DISAPPEAR:"animation3"},rl={APPEAR:"animation",EXPLODE:"animation2"};v._RF.pop(),v._RF.push({},"ff37brNpltMuaZm+M+x9+1N","Rope",void 0);var sl,ll,ul,cl,hl,pl,dl,yl,vl,fl=m.ccclass,ml=m.property,gl=(Xs=fl("Rope"),Qs=ml(X),$s=ml(S),Xs((nl=s((tl=function(e){t(s,e);var o=n(s);function s(){var e;i(this,s);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"frame",nl,u(e)),l(e,"length",il,u(e)),e.nodes=[],e}return a(s,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"start",value:function(){this.nodes=[],this.node.setPosition(this.headJoint.getPosition()),console.log(this.headJoint.getPosition(),this.tailJoint.getPosition(),this.node.getPosition());for(var e=this.headJoint.getPosition().clone().add(new _(0,4)).multiplyScalar(-1),t=this.tailJoint.getPosition().clone().add(new _(0,115)).add(e).multiplyScalar(1/this.length),n=t.length(),i=t.clone().multiplyScalar(-1*this.length),a=new K(i.x,i.y),o=0;o<this.length;o++){var r=this.createNode(n);if(!r)return void console.warn("Rope: node-".concat(o," not found"));this.node.addChild(r),r.name="node-".concat(o),r.setPosition(t.clone().multiplyScalar(o)),this.nodes.push(r)}for(var s=0;s<this.nodes.length;s++){var l=this.nodes[s];if(0!==s){var u=this.nodes[s-1],c=l.addComponent(Q);c.enabled=!1,c.anchor=new K(0,-4),c.connectedAnchor=new K(0,4),c.connectedBody=u.getComponent(W),c.collideConnected=!1,c.enableLimit=!0,c.enabled=!0;var h=l.addComponent($);if(h.enabled=!1,h.connectedBody=this.headJoint.getComponent(W),h.anchor=new K(0,-4),h.connectedAnchor=new K(0,4),h.collideConnected=!1,h.maxForce=160,h.enabled=!0,s===this.nodes.length-1){var p=this.tailJoint.addComponent(Q);p.enabled=!1,p.anchor=new K(0,115),p.connectedBody=l.getComponent(W),p.connectedAnchor=new K(0,4),p.collideConnected=!1,p.enableLimit=!0,p.enabled=!0}}else{var d=l.addComponent(Q);d.enabled=!1,d.connectedBody=this.headJoint.getComponent(W),d.anchor=new K(0,-4),d.connectedAnchor=new K(0,4),d.enableLimit=!0,d.collideConnected=!1,d.enabled=!0}}var y=this.tailJoint.addComponent($);y.enabled=!1,y.connectedBody=this.headJoint.getComponent(W),y.anchor=new K(0,118),y.connectedAnchor=new K(0,-4),y.linearOffset=a,y.maxForce=500,y.enabled=!0}},{key:"disconnect",value:function(){console.log("Disconnecting rope");var e=this.nodes[0].getComponent(Q);if(e){e.connectedBody=null,e.enabled=!1;var t=this.tailJoint.getComponent(Q);if(t){t.connectedBody=null,t.enabled=!1;var n=this.tailJoint.getComponent($);n&&(n.enabled=!1,n.connectedBody=null);var i,a=r(this.nodes);try{for(a.s();!(i=a.n()).done;){var o=i.value.getComponent(E);if(!o)return void console.warn("Rope: Sprite not found");o.enabled=!1}}catch(e){a.e(e)}finally{a.f()}}else console.warn("Rope: Final joint not found")}else console.warn("Rope: Starting joint not found")}},{key:"createNode",value:function(e){var t=new L("node");t.layer=this.node.layer,t.addComponent(E).spriteFrame=this.frame;var n=t.addComponent(x);n.setAnchorPoint(.5,.5),n.setContentSize(6,1.2*e);var i=t.addComponent(W);return i.linearDamping=5,i.angularDamping=50,i.gravityScale=.1,i.group=Fs.ROPE,t.addComponent(ee).size=n.contentSize,t.name=Rs.ROPE,t}}]),s}(k)).prototype,"frame",[Qs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),il=s(tl.prototype,"length",[$s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),el=tl))||el);v._RF.pop(),v._RF.push({},"a8a47NhLJ9C1ahfjfiJ2xjc","Balloon",void 0);var bl=m.ccclass,Sl=m.property,kl=GameCore.Utils.Array,Cl=(sl=bl("Balloon"),ll=Sl(te),ul=Sl(Y),cl=Sl(W),sl((dl=s((pl=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"ropePrefab",dl,u(e)),l(e,"collider",yl,u(e)),l(e,"rigidBody",vl,u(e)),e.rope=null,e.onBeginContact=function(t,n){if(e.rope){var i=[Rs.BEE,Rs.THORN,Rs.THORN_BALL];kl.has(i,n.node.name)&&(e.rope.disconnect(),e.setSpineAnimation(rl.EXPLODE,!1),e.scheduleOnce((function(){e.rigidBody.enabled=!1})))}},e}return a(r,[{key:"__preload",value:function(){this.collider=this.getComponent(Y),this.rigidBody=this.getComponent(W),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"start",value:function(){this.setSpineAnimation(rl.APPEAR,!0),this.collider.on(J.BEGIN_CONTACT,this.onBeginContact)}},{key:"connectToDoge",value:function(e){var t=ne(this.ropePrefab).getComponent(gl);if(t)return t.headJoint=this.node,t.tailJoint=e,t.node.name=Rs.ROPE,this.rope=t,t;console.warn("Balloon: Rope component not found")}}]),r}(qs)).prototype,"ropePrefab",[ll],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yl=s(pl.prototype,"collider",[ul],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vl=s(pl.prototype,"rigidBody",[cl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hl=pl))||hl);v._RF.pop(),v._RF.push({},"ca922n1V0RLioEyUJg8hQXH","GameEvents",void 0);var wl=function(e){return e.NEXT_LEVEL="next-level",e.UPDATE_LEVEL="update-level",e.START_OVER="start-over",e.SELECT_LEVEL="select-level",e.GAME_START="game-start",e.GAME_PAUSE="game-pause",e.GAME_RESUME="game-resume",e.GAME_REPLAY="game-replay",e.SHOW_HINT="show-hint",e.SKIP_LEVEL="skip-level",e.TIME_OUT="time-out",e.DRAWING="drawing",e.DOGE_DIE="doge-die",e.DOGE_SURVIVE="doge-survive",e.BEE_DIE="bee-die",e.BEE_ATTACK="bee-attack",e.BIG_BEE_DIE="big-bee-die",e.GAME_OBJECTS_SPAWNED="game-objects-spawned",e}(wl||{});v._RF.pop(),v._RF.push({},"744a5WT+0VHFLma6AT7mXct","NormalBehavior",void 0);var El=function(){function e(t){i(this,e),this.touchCount=0,this.bee=t,this.timeToAttack=Z.randomRange(.7,.8),this.countTimeToAttack=0}return a(e,[{key:"onBeginContact",value:function(){var e=this;1===this.touchCount&&this.bee.scheduleOnce((function(){e.touchCount>=3&&e.activePusher(),e.touchCount=0}),.75),this.touchCount++}},{key:"activePusher",value:function(){this.bee.setRole(Ts.PUSHER)}},{key:"update",value:function(e){this.bee.state===As.ATTACKING&&(this.countTimeToAttack+=e,this.countTimeToAttack>this.timeToAttack&&(this.bee.findTarget(),this.bee.attackTarget(),this.timeToAttack=Z.randomRange(.4,.6),this.countTimeToAttack=0))}}]),e}();v._RF.pop(),v._RF.push({},"ec831BZISdLgp8vKNuRirUM","PusherBehavior",void 0);var Tl=function(){function e(t){i(this,e),this.bee=t}return a(e,[{key:"onBeginContact",value:function(){var e=this.bee;if(e.target){var t=Z.randomRange(20,30),n=e.getVectorDataFromAToB(e.node.getWorldPosition(),e.target.getWorldPosition());n.vector.rotate(Math.random()>.5?-Math.PI/2:Math.PI/2).multiplyScalar(t),e.move(n);var i=e.getComponent(ie);i&&(i.density*=1.1,i.density>=2.5&&(i.density=1,e.setRole(Ts.NORMAL),e.setState(As.ATTACKING)))}}}]),e}();v._RF.pop(),v._RF.push({},"19c52/F5VRPcbm2BqdbChIp","BaseBehavior",void 0);var Al,Rl,Pl,_l,Bl,Ll,Ol,Dl,Il,Nl,Fl,Gl,zl=function(){function e(t){i(this,e),this.bee=t,this.normalBehavior=new El(t),this.pusherBehavior=new Tl(t),this.seekingPathBehavior=null}return a(e,[{key:"onBeginContact",value:function(e,t){switch(this.bee.role){case Ts.NORMAL:this.normalBehavior.onBeginContact();break;case Ts.PATH_SEEKER:if(!this.seekingPathBehavior)return void console.warn("Bee: Seeking path behavior is null");this.seekingPathBehavior.onBeginContact(e,t);break;case Ts.PUSHER:this.pusherBehavior.onBeginContact()}}},{key:"update",value:function(e){this.updateSpecialRole(e)||this.normalBehavior.update(e)}},{key:"updateSpecialRole",value:function(e){switch(this.bee.role){case Ts.PATH_SEEKER:return!!this.seekingPathBehavior&&this.seekingPathBehavior.update(e);default:return!1}}}]),e}();v._RF.pop(),v._RF.push({},"0b146P+xAlN5LGe2MJHlJDc","Bee",void 0);var Ml=m.ccclass,xl=m.property,Ul=(Al=Ml("Bee"),Rl=xl(L),Pl=xl(q.Skeleton),_l=xl(Y),Bl=xl(W),Al((Dl=s((Ol=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"flipNode",Dl,u(e)),l(e,"spriteNode",Il,u(e)),e.target=null,e.isSpawnLeftSide=!1,e.role=Ts.NORMAL,e.state=As.IDLE,e.behavior=new zl(u(e)),e.speed=0,l(e,"collider",Nl,u(e)),l(e,"rigidBody",Fl,u(e)),l(e,"gameObjects",Gl,u(e)),e.wanderingOriginHeight=null,e.isWandering=!1,e.onBeginContact=function(t,n){e.enabled&&(e.rigidBody.linearDamping=Z.randomRangeInt(6,8),n.node.name!==Rs.THORN&&n.node.name!==Rs.POISON&&n.node.name!==Rs.BIG_BEE_BULLET?n.node.name!==Rs.WATER?(n.node.name===Rs.DOGE&&Ve.playSound(qe.BEE_STING_DOGE,{volume:.3}),e.behavior.onBeginContact(t,n)):e.drown():e.smokeDisappear())},e}return a(r,[{key:"__preload",value:function(){var e;this.collider=this.getComponent(Y),this.rigidBody=this.getComponent(W),this.gameObjects=null===(e=this.node.parent)||void 0===e?void 0:e.getComponent(Gp),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"start",value:function(){this.setState(As.IDLE),this.collider.on(J.BEGIN_CONTACT,this.onBeginContact),this.collider.enabled=!1}},{key:"followTarget",value:function(e){this.target=e,this.collider.enabled=!0,this.attackTarget()}},{key:"followInstructions",value:function(){this.collider.enabled=!0}},{key:"findTarget",value:function(){var e=this.gameObjects.getNearestDogeToBee(this);e&&!e.isCantBeTargeted()?this.target=e.node:this.target=null}},{key:"smokeDisappear",value:function(){this.preHide(),this.setSpineAnimation(ol.SMOKE_DISAPPEAR,!1),this.setState(As.DIE),this.node.scene.emit(wl.BEE_DIE)}},{key:"flap",value:function(){this.setSpineAnimation(ol.FLAP_WINGS,!0)}},{key:"attackTarget",value:function(){var e=this;if(!this.target){if(this.isWandering)return;this.isWandering=!0,this.scheduleOnce((function(){e.isWandering=!1}),.5),this.speed=Z.randomRange(40,50);var t=this.node.getWorldPosition();null===this.wanderingOriginHeight&&(this.wanderingOriginHeight=t.y+50),t.x+=Z.randomRange(-300,300),t.y=Z.randomRange(this.wanderingOriginHeight,this.wanderingOriginHeight-50);var n=this.getVectorDataFromAToB(this.node.getWorldPosition(),t);return this.move(n),void(this.rigidBody.linearDamping=0)}this.speed=Z.randomRange(20,30);var i=this.getVectorDataFromAToB(this.node.getWorldPosition(),this.target.getWorldPosition());i.vector.rotate(Z.randomRange(-.3,.3)).multiplyScalar(this.speed),this.move(i),this.rigidBody.linearDamping=0,this.setState(As.ATTACKING)}},{key:"sleep",value:function(){h(p(r.prototype),"sleep",this).call(this),this.target=null}},{key:"rotateToVector",value:function(e){this.node.angle=Z.toDegree(this.angle(e.x,e.y)),this.node.angle+=180;var t=this.node.angle/360-Math.floor(this.node.angle/360);t>.25&&t<.75?this.flipNode.setScale(new _(1,-1,1)):this.flipNode.setScale(new _(1,1,1))}},{key:"move",value:function(e){this.rigidBody.linearVelocity=e.vector,this.rotateToVector({x:e.dx,y:e.dy})}},{key:"fly",value:function(e){this.rigidBody.linearVelocity=e,this.rigidBody.linearDamping=0,this.flap(),this.setState(As.FLYING)}},{key:"setState",value:function(e){this.state=e}},{key:"setRole",value:function(e){this.role=e}},{key:"update",value:function(e){this.behavior.update(e)}},{key:"drown",value:function(){this.collider.enabled=!1,this.speed=20;var e=this.node.getWorldPosition();e.y=e.y-1e3;var t=this.getVectorDataFromAToB(this.node.getWorldPosition(),e);this.move(t),this.rigidBody.linearDamping=0,this.spriteNode.paused=!0,this.setState(As.DIE),this.node.scene.emit(wl.BEE_DIE)}},{key:"setSpineAnimation",value:function(e,t){this.spriteNode.setAnimation(0,e,t)}}]),r}(qs)).prototype,"flipNode",[Rl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Il=s(Ol.prototype,"spriteNode",[Pl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nl=s(Ol.prototype,"collider",[_l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fl=s(Ol.prototype,"rigidBody",[Bl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gl=s(Ol.prototype,"gameObjects",[xl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ll=Ol))||Ll);v._RF.pop(),v._RF.push({},"23d64mdR6VPRoojd1BBKwos","World",void 0);var Hl,jl,Vl,Wl,ql,Kl,Yl,Jl=28,Zl={WIDTH:1176,HEIGHT:1792};v._RF.pop(),v._RF.push({},"5f264eibqlEH7PqbJQqHTF7","Line",void 0);var Xl=m.ccclass,Ql=m.property,$l=(Hl=Xl("Line"),jl=Ql(D),Vl=Ql(W),Hl((Kl=s((ql=function(e){t(s,e);var o=n(s);function s(){var e;i(this,s);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).points=[],e.colliderInterval=20,e.colliders=[],e.colliderTag=0,l(e,"graphic",Kl,u(e)),l(e,"rigidBody",Yl,u(e)),e}return a(s,[{key:"__preload",value:function(){this.graphic=this.getComponent(D),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"init",value:function(){this.points=[],this.colliders=[],this.colliderTag=0}},{key:"drawTo",value:function(e,t,n,i){this.graphic.moveTo(e,t),this.graphic.lineTo(n,i),this.graphic.stroke()}},{key:"addBody",value:function(e,t){var n=this.node.addComponent(ie);n.offset=new K(e,t),n.radius=8,n.density=5,n.tag=this.colliderTag,n.apply(),this.colliderTag+=1,this.colliders.push(n)}},{key:"deActiveColliders",value:function(){var e,t=r(this.colliders);try{for(t.s();!(e=t.n()).done;){e.value.enabled=!1}}catch(e){t.e(e)}finally{t.f()}}},{key:"storePoints",value:function(e,t){var n=new K(e,t);this.points.push(n)}},{key:"addPhysics",value:function(){for(var e=0;e<this.points.length-1;e++){var t=this.points[e],n=this.points[e+1];if(t&&n){var i=this.getInternalPoints(t,n);if(e<this.points.length-2){var a=i.pop();if(!a){console.warn("Line: lastPoint not found");continue}this.points[e+1]=a}var o,s=r(i);try{for(s.s();!(o=s.n()).done;){var l,u=o.value,c=!1,h=r(this.colliders);try{for(h.s();!(l=h.n()).done;){var p=l.value;Z.Vec2.distance(u,p.offset)<2*p.radius&&(c=!0)}}catch(e){h.e(e)}finally{h.f()}c||this.addBody(u.x,u.y)}}catch(e){s.e(e)}finally{s.f()}}}var d=this.points[this.points.length-1];d&&this.addBody(d.x,d.y)}},{key:"getInternalPoints",value:function(e,t){for(var n=t.x-e.x,i=t.y-e.y,a=new K(n,i).normalize().multiplyScalar(this.colliderInterval),o=Z.Vec2.distance(e,t),r=Math.floor(o/this.colliderInterval),s=[e],l=0;l<r;l++){var u=s[s.length-1];if(u){var c=u.clone().add(a);s.push(c)}}return s}},{key:"findNearestCollider",value:function(e){var t=this.colliders[0];if(!t)return null;var n=new _(t.worldPosition.x,t.worldPosition.y,0),i=K.distance(e,n);return this.colliders.forEach((function(n){var a=new _(n.worldPosition.x,n.worldPosition.y,0);K.distance(e,a)<i&&(i=K.distance(e,a),t=n)})),t}}]),s}(qs)).prototype,"graphic",[jl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yl=s(ql.prototype,"rigidBody",[Vl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wl=ql))||Wl);v._RF.pop(),v._RF.push({},"afc3eWzi4tHNYb9W7f6QpCX","SeekingPathBehavior",void 0);var eu,tu,nu,iu=function(){function e(t,n){i(this,e),this.isFinishSeeking=!1,this.vectorDataGroup=[],this.index=0,this.bee=t,this.isSeekToLastPoint=n,this.vectorDataGroup=[],this.isFinishSeeking=!1,this.time=.02,this.remaining=0,this.index=0}return a(e,[{key:"seek",value:function(e){var t=this.bee.node.scene.getComponentInChildren($l);if(!t)return console.warn("Bee: Line is null"),!1;var n=t.colliders.findIndex((function(t){if(t.tag===e.tag)return!0}));if(-1===n)return!1;this.vectorDataGroup=[],this.isFinishSeeking=!1,this.time=.04,this.remaining=0,this.index=0;var i=this.bee.speed;return i||(i=Z.randomRange(20,30)),this.isSeekToLastPoint?this.seekToLastPoint(n,t,i):this.seekToFirstPoint(n,t,i),!0}},{key:"seekToLastPoint",value:function(e,t,n){for(var i=e;i<t.colliders.length-1;i++){var a=t.colliders[i],o=t.colliders[i+1],r=this.bee.getVectorDataFromAToB(a.worldPosition,o.worldPosition);r.vector.multiplyScalar(n),this.vectorDataGroup.push(r)}}},{key:"seekToFirstPoint",value:function(e,t,n){for(var i=e;i>0;i--){var a=t.colliders[i],o=t.colliders[i-1],r=this.bee.getVectorDataFromAToB(a.worldPosition,o.worldPosition);r.vector.multiplyScalar(n),this.vectorDataGroup.push(r)}}},{key:"flyToNextDirection",value:function(){var e=this.vectorDataGroup[this.index];if(this.index+=1,!e)return this.isFinishSeeking=!0,this.bee.setRole(Ts.NORMAL),void this.bee.setState(As.ATTACKING);this.bee.move(e)}},{key:"fly",value:function(e){this.remaining+=e,this.remaining>this.time&&(this.flyToNextDirection(),this.time=.02,this.remaining=0)}},{key:"onBeginContact",value:function(e,t){if(this.bee.state===As.SEEKING_PATH&&t.node.name!==Rs.DRAW_LINE)return this.isFinishSeeking=!0,this.bee.setRole(Ts.NORMAL),void this.bee.setState(As.ATTACKING);this.isFinishSeeking||this.bee.state===As.WAITING_TO_SEEK_PATH||t.node.name!==Rs.DRAW_LINE||this.handlePathSeekerTouchLine(t)}},{key:"handlePathSeekerTouchLine",value:function(e){var t=this;this.seek(e)&&this.bee.state!==As.SEEKING_PATH&&(this.bee.setState(As.WAITING_TO_SEEK_PATH),this.bee.scheduleOnce((function(){t.bee.setState(As.SEEKING_PATH)}),.3))}},{key:"update",value:function(e){return this.bee.state===As.SEEKING_PATH&&(this.fly(e),!0)}}]),e}();v._RF.pop(),v._RF.push({},"2181aAj+ElOoL2tBGH10euY","Beehive",void 0);var au,ou,ru,su,lu,uu,cu,hu,pu,du,yu,vu=m.ccclass,fu=m.property,mu=vu("Beehive")((nu=s((tu=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).totalPathSeekers=0,e.isSeekToLastPoint=!0,l(e,"gameObjects",nu,u(e)),e}return a(r,[{key:"onLoad",value:function(){var e;this.gameObjects=null===(e=this.node.parent)||void 0===e?void 0:e.getComponent(Gp),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"releaseBee",value:function(e){var t=this;this.updateTotalPathSeekers(),this.scheduleOnce((function(){var n=e.getComponent(Ul);if(n){t.createPathSeeker(n),"isRightSide"in t.node&&!0===t.node.isRightSide?t.spawnInRightSide(n):t.spawnInLeftSide(n),n.wake();var i=t.gameObjects.getRandomDogeToBee();i&&t.scheduleOnce((function(){return n.followTarget(i.node)}),.2)}}),Z.randomRange(.1,.4))}},{key:"updateTotalPathSeekers",value:function(){"totalPathSeekers"in this.node&&"number"==typeof this.node.totalPathSeekers&&(this.totalPathSeekers=this.node.totalPathSeekers)}},{key:"spawnInLeftSide",value:function(e){var t=this.node.getPosition(),n=t.x,i=t.y,a=Z.randomRangeInt(-10,0),o=Z.randomRangeInt(38,48);e.isSpawnLeftSide=!0,e.node.setScale(new _(1,1,1)),e.node.setPosition(n+a,i+o),e.fly(new K(-2,-1).normalize().multiplyScalar(2))}},{key:"spawnInRightSide",value:function(e){var t=this.node.getPosition(),n=t.x,i=t.y,a=Z.randomRangeInt(0,10),o=Z.randomRangeInt(38,48);e.isSpawnLeftSide=!1,e.node.setScale(new _(1,1,1)),e.node.setPosition(n+a,i+o),e.fly(new K(2,-1).normalize().multiplyScalar(2))}},{key:"createPathSeeker",value:function(e){0!==this.totalPathSeekers&&(e.setRole(Ts.PATH_SEEKER),e.behavior.seekingPathBehavior=new iu(e,this.isSeekToLastPoint),this.isSeekToLastPoint=!this.isSeekToLastPoint,this.totalPathSeekers-=1)}}]),r}(qs)).prototype,"gameObjects",[fu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eu=tu))||eu;v._RF.pop(),v._RF.push({},"a17a07Pu/tAGb4MdM3jxHke","BigBeeBullet",void 0);var gu,bu,Su,ku,Cu,wu,Eu,Tu,Au,Ru,Pu,_u,Bu=m.ccclass,Lu=m.property,Ou=(au=Bu("BigBeeBullet"),ou=Lu(E),ru=Lu(q.Skeleton),su=Lu(Y),lu=Lu(W),au((hu=s((cu=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"stinger",hu,u(e)),l(e,"ci",pu,u(e)),l(e,"collider",du,u(e)),l(e,"rigidBody",yu,u(e)),e.onBeginContact=function(){e.stinger.active=!1,e.ci.active=!0;var t=e.ci.getComponent(q.Skeleton);t?(t.enabled=!0,t.setAnimation(0,"animation",!1),Ve.playSound(qe.BEE_BULLET_EXPLODE,{allowMultiple:!0}),t.setCompleteListener((function(){e.kill()}))):console.warn("BigBeeBullet: ske not found")},e}return a(r,[{key:"onLoad",value:function(){this.collider=this.getComponent(Y),this.rigidBody=this.getComponent(W),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"start",value:function(){this.revive()}},{key:"revive",value:function(){h(p(r.prototype),"revive",this).call(this),this.stinger.active=!0,this.ci.active=!1,this.ci.getComponent(q.Skeleton).enabled=!1,this.collider.once(J.BEGIN_CONTACT,this.onBeginContact)}},{key:"kill",value:function(){h(p(r.prototype),"kill",this).call(this),this.stinger.active=!1,this.ci.active=!1}},{key:"forwardToDoge",value:function(e){var t=Z.randomRange(20,30),n=this.getVectorDataFromAToB(this.node.getWorldPosition(),e.getWorldPosition());n.vector.rotate(Z.randomRange(-.3,.3)).multiplyScalar(t),this.rigidBody.linearVelocity=n.vector,this.node.angle=Z.toDegree(this.angle(n.dx,n.dy))}}]),r}(qs)).prototype,"stinger",[ou],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pu=s(cu.prototype,"ci",[ru],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),du=s(cu.prototype,"collider",[su],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yu=s(cu.prototype,"rigidBody",[lu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uu=cu))||uu);v._RF.pop(),v._RF.push({},"2b15b1CihdEf60Zy/wIYirK","BigBee",void 0);var Du,Iu,Nu,Fu,Gu,zu,Mu,xu,Uu=m.ccclass,Hu=m.property,ju=(gu=Uu("BigBee"),bu=Hu(te),Su=Hu(q.Skeleton),ku=Hu(ie),Cu=Hu(W),gu((Tu=s((Eu=function(o){t(c,o);var r,s=n(c);function c(){var e;i(this,c);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=s.call.apply(s,[this].concat(n)),l(e,"bulletPrefab",Tu,u(e)),e.state=As.IDLE,e.target=null,e.bulletPool=[],e.timeToAttack=0,e.countTimeToAttack=0,l(e,"skeleton",Au,u(e)),l(e,"gameObjects",Ru,u(e)),l(e,"collider",Pu,u(e)),l(e,"rigidBody",_u,u(e)),e.onBeginContact=function(t,n){e.enabled&&(n.node.name!==Rs.THORN&&n.node.name!==Rs.POISON||e.smokeDisappear())},e}return a(c,[{key:"onLoad",value:function(){var e;this.skeleton=this.getComponent(q.Skeleton),this.gameObjects=null===(e=this.node.parent)||void 0===e?void 0:e.getComponent(Gp),this.collider=this.getComponent(ie),this.rigidBody=this.getComponent(W),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"start",value:function(){this.node.setScale(new _(.7,.7,.7)),this.timeToAttack=Z.randomRange(1,2),this.countTimeToAttack=0,this.createBulletPool(),this.initDustParticle();var e=this.gameObjects.getRandomDogeToBee();e?(this.target=e.node,this.state=As.FLYING,this.collider.on(J.BEGIN_CONTACT,this.onBeginContact)):console.warn("BigBee: Target not found")}},{key:"update",value:function(e){this.state===As.ATTACKING&&(this.countTimeToAttack+=e,this.countTimeToAttack>this.timeToAttack&&(this.attackTarget(),this.timeToAttack=Z.randomRange(1,2),this.countTimeToAttack=0))}},{key:"createBulletPool",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;this.bulletPool=[];for(var t=0;t<e;t++)this.createBullet()}},{key:"initDustParticle",value:(r=e((function*(){if(this.node.parent){var e=new L(Rs.DUST_PARTICLE);e.layer=Math.pow(2,25),e.active=!1;var t=e.addComponent(q.Skeleton),n=yield ze.loadSkeletonDataAsync(zs.DUST_PARTICLE_SPINE);n?this.node&&this.node.isValid&&(t.skeletonData=n,this.node.parent.addChild(e),this.dustParticle=e):console.warn("initDustParticle","Failed to load dust particle spine")}})),function(){return r.apply(this,arguments)})},{key:"createDust",value:function(){var e=this;if(this.dustParticle){this.dustParticle.active=!0;var t=this.node.getWorldPosition(),n=t.x,i=t.y;this.dustParticle.setWorldPosition(new _(n,i));try{var a=this.dustParticle.getComponent(q.Skeleton);null==a||a.setAnimation(0,"animation",!1)}catch(e){console.error("createDust",e)}this.scheduleOnce((function(){e.dustParticle&&(e.dustParticle.active=!1)}),.5)}}},{key:"createBullet",value:function(){if(!this.node.parent)return console.warn("BigBee: Parent not found"),null;var e=ne(this.bulletPrefab),t=e.getComponent(Ou);return e.name=Rs.BIG_BEE_BULLET,t&&t.kill(),this.node.parent.addChild(e),this.bulletPool.push(e),e}},{key:"smokeDisappear",value:function(){this.hide(),this.createDust(),this.state=As.DIE,this.node.scene.emit(wl.BIG_BEE_DIE)}},{key:"sleep",value:function(){}},{key:"wake",value:function(){}},{key:"hide",value:function(){this.enabled=!1,this.rigidBody.sleep(),this.skeleton.enabled=!1}},{key:"preHide",value:function(){}},{key:"appear",value:function(){}},{key:"setSpineAnimation",value:function(e,t){}},{key:"attackTarget",value:function(){var e=this;this.skeleton.setAnimation(0,"attack",!1),this.skeleton.setCompleteListener((function(){e.skeleton.setAnimation(0,"fly",!0)})),this.scheduleOnce((function(){if(e.target){var t=e.bulletPool.filter((function(e){return!1===e.active}))[0];if(!t){var n=e.createBullet();if(!n)return;t=n}var i=t.getComponent(Ou);if(i){i.revive();var a=e.node.getPosition(),o=a.x,r=a.y;t.setPosition(o,r),i.forwardToDoge(e.target)}else console.warn("BigBee: Bullet component not found")}else console.warn("BigBee: Target not found")}),.5)}}]),c}(qs)).prototype,"bulletPrefab",[bu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Au=s(Eu.prototype,"skeleton",[Su],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ru=s(Eu.prototype,"gameObjects",[Hu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pu=s(Eu.prototype,"collider",[ku],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_u=s(Eu.prototype,"rigidBody",[Cu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wu=Eu))||wu);v._RF.pop(),v._RF.push({},"8e16aARuABAK56lFGhIfeH+","Brick",void 0);var Vu,Wu,qu,Ku,Yu,Ju=m.ccclass,Zu=m.property,Xu=m.requireComponent,Qu=(Du=Ju("Brick"),Iu=Xu([ae]),Nu=Zu({tooltip:"Use batch draw all bricks"}),Fu=Zu(E),Du(Gu=Iu((Mu=s((zu=function(e){t(s,e);var o=n(s);function s(){var e;i(this,s);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"useBatch",Mu,u(e)),l(e,"sprite",xu,u(e)),e.brickPolygons=[],e}return a(s,[{key:"__preload",value:function(){this.mask=this.getComponent(ae),this.graphic=this.getComponent(D),this.polygonCollider=this.getComponent(oe),this.validateRequiredComponents(),this.listenGameplayEvents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"listenGameplayEvents",value:function(){}},{key:"addBrickPolygon",value:function(e){this.brickPolygons.push(e)}},{key:"onLoad",value:function(){var e=this.getPolygon();e&&(this.useBatch?(this.mask.enabled=!1,this.graphic.enabled=!1,this.addBrickPolygon(e)):(this.updateTransform(e),this.drawMask(e),this.applyCollider(e)))}},{key:"getPolygon",value:function(){if(!("polygon"in this.node))return null;var e=this.node.polygon;return Array.isArray(e)?e:null}},{key:"updateTransform",value:function(e){var t=this.calculatePolygonDimensions(e),n=t.width,i=t.height;this.setPosition(0,0),this.setContentSize(n,i)}},{key:"setPosition",value:function(e,t){this.node.setPosition(e,t)}},{key:"setContentSize",value:function(e,t){var n=this.sprite.getComponent(x);n&&n.setContentSize(e,t)}},{key:"updateContentSizeForBatchDraw",value:function(){var e=this.brickPolygons.map((function(e){return e.map((function(e){var t=e.x,n=e.y;return new K(t,n)}))})).flat(),t=this.calculatePolygonDimensions(e),n=t.width,i=t.height,a=this.calculateSpritePositionForBatchDraw(e),o=this.sprite.getComponent(x);if(o){o.setContentSize(n,i);var r=this.sprite.getComponent(E);r&&r.node.setPosition(a.x,a.y)}}},{key:"calculateSpritePositionForBatchDraw",value:function(e){for(var t=e[0].x,n=e[0].x,i=e[0].y,a=e[0].y,o=1;o<e.length;o++){var r=e[o],s=r.x,l=r.y;s<t?t=s:s>n&&(n=s),l<i?i=l:l>a&&(a=l)}return{x:t,y:i}}},{key:"calculatePolygonDimensions",value:function(e){for(var t=e[0].x,n=e[0].x,i=e[0].y,a=e[0].y,o=1;o<e.length;o++){var r=e[o],s=r.x,l=r.y;s<t?t=s:s>n&&(n=s),l<i?i=l:l>a&&(a=l)}return{width:Math.abs(n-t),height:Math.abs(a-i)}}},{key:"drawMask",value:function(e){this.graphic.moveTo(e[0].x,e[0].y);var t,n=r(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.graphic.lineTo(i.x,i.y)}}catch(e){n.e(e)}finally{n.f()}this.graphic.close(),this.graphic.fill()}},{key:"batchDrawAllBrick",value:function(){if(!(this.brickPolygons.length<1)){this.mask.enabled=!0,this.graphic.enabled=!0,this.updateContentSizeForBatchDraw();var e,t=r(this.brickPolygons);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.drawMask(n)}}catch(e){t.e(e)}finally{t.f()}this.applyColliderForBatchDraw(),this.brickPolygons=[]}}},{key:"applyCollider",value:function(e){this.polygonCollider.points=e.map((function(e){var t=e.x,n=e.y;return new K(t,n)})),this.polygonCollider.apply()}},{key:"applyColliderForBatchDraw",value:function(){var e,t=this.brickPolygons.map((function(e){return e.map((function(e){var t=e.x,n=e.y;return new K(t,n)}))})),n=r(t);try{for(n.s();!(e=n.n()).done;){var i=e.value,a=new L;a.name=Rs.BRICK,this.node.addChild(a),a.setPosition(0,0);var o=a.addComponent(W);o.type=V.Static,o.group=Fs.MAIN_OBJECT;var s=a.addComponent(oe);s.points=i,s.apply()}}catch(e){n.e(e)}finally{n.f()}}}]),s}(k)).prototype,"useBatch",[Nu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),xu=s(zu.prototype,"sprite",[Fu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gu=zu))||Gu)||Gu);v._RF.pop(),v._RF.push({},"46fa0f/kl1Heo/JvM2kAEAf","GraphicsPattern",void 0);var $u,ec,tc,nc,ic,ac,oc,rc,sc,lc,uc,cc,hc=m.ccclass,pc=m.property,dc=(Vu=hc("GraphicsPattern"),Wu=pc(D),Vu((Yu=s((Ku=function(e){t(s,e);var o=n(s);function s(){var e;i(this,s);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"graphic",Yu,u(e)),e}return a(s,[{key:"onLoad",value:function(){this.graphic=this.getComponent(D),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"start",value:function(){}},{key:"sleep",value:function(){}},{key:"draw",value:function(e){this.graphic.moveTo(e[0].x,e[0].y);var t,n=r(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.graphic.lineTo(i.x,i.y)}}catch(e){n.e(e)}finally{n.f()}this.graphic.close(),this.graphic.fill()}},{key:"applyCollider",value:function(e){var t=this.getComponent(oe);t?(t.points=e.map((function(e){var t=e.x,n=e.y;return new K(t,n)})),t.apply()):console.warn("GraphicsPattern: PolygonCollider2D not found")}},{key:"setColor",value:function(e){var t=new I;I.fromHEX(t,e),this.graphic.fillColor=t}}]),s}(qs)).prototype,"graphic",[Wu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qu=Ku))||qu);v._RF.pop(),v._RF.push({},"959bd9NhYpMTK0O78HSl4rc","Pattern",void 0);var yc,vc=m.ccclass,fc=m.property,mc=m.requireComponent,gc=($u=vc("Pattern"),ec=mc([D,oe,W]),tc=fc(E),nc=fc(D),ic=fc(W),ac=fc(oe),$u(oc=ec((sc=s((rc=function(e){t(s,e);var o=n(s);function s(){var e;i(this,s);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"sprite",sc,u(e)),l(e,"graphic",lc,u(e)),l(e,"rigidBody",uc,u(e)),l(e,"polygonCollider",cc,u(e)),e}return a(s,[{key:"onLoad",value:function(){this.graphic=this.getComponent(D),this.rigidBody=this.getComponent(W),this.polygonCollider=this.getComponent(oe),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"start",value:function(){}},{key:"draw",value:function(e){var t=this.sprite.getComponent(x);if(t){var n=this.getBottomLeftPosition(e),i=n.x,a=n.y,o=this.getTopRightPosition(e),s=o.x,l=o.y;t.setContentSize(s-i,l-a),t.node.setPosition(i,a),this.graphic.moveTo(e[0].x,e[0].y);var u,c=r(e);try{for(c.s();!(u=c.n()).done;){var h=u.value;this.graphic.lineTo(h.x,h.y)}}catch(e){c.e(e)}finally{c.f()}this.graphic.close(),this.graphic.fill()}}},{key:"savePolygonPoints",value:function(e){this.points=e}},{key:"getPolygonPoints",value:function(){return this.points}},{key:"applyCollider",value:function(e){this.polygonCollider.points=e.map((function(e){var t=e.x,n=e.y;return new K(t,n)})),this.polygonCollider.apply()}},{key:"setRigidBodyType",value:function(e){this.rigidBody.type=e}},{key:"getBottomLeftPosition",value:function(e){var t,n=e[0].x,i=e[0].y,a=r(e);try{for(a.s();!(t=a.n()).done;){var o=t.value;n>o.x&&(n=o.x),i>o.y&&(i=o.y)}}catch(e){a.e(e)}finally{a.f()}return{x:n,y:i}}},{key:"getTopRightPosition",value:function(e){var t,n=e[0].x,i=e[0].y,a=r(e);try{for(a.s();!(t=a.n()).done;){var o=t.value;n<o.x&&(n=o.x),i<o.y&&(i=o.y)}}catch(e){a.e(e)}finally{a.f()}return{x:n,y:i}}}]),s}(qs)).prototype,"sprite",[tc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lc=s(rc.prototype,"graphic",[nc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uc=s(rc.prototype,"rigidBody",[ic],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cc=s(rc.prototype,"polygonCollider",[ac],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oc=rc))||oc)||oc);v._RF.pop(),v._RF.push({},"a08960ZMBtFcLD/1nWNbAM9","Poison",void 0);var bc,Sc=m.ccclass,kc=m.requireComponent,Cc=Sc("Poison")(yc=kc([dc])(yc=function(o){t(u,o);var s,l=n(u);function u(){var e;i(this,u);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=l.call.apply(l,[this].concat(n))).polygon=[],e.useBatch=!1,e.poisonPolygons=[],e.bubbleFrame=null,e.bubblePool=null,e.remaining=0,e.maxPoolSize=0,e.totalBubble=0,e}return a(u,[{key:"onLoad",value:function(){var e;this.graphicPattern=this.getComponent(dc),this.gameObjects=null===(e=this.node.parent)||void 0===e?void 0:e.getComponent(Gp),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"start",value:function(){this.addRigidBody(),this.useBatch||(this.addPolygonCollider(),this.drawPattern(),this.loadCircleFrame(),this.setTimeSpawnBubble(.2))}},{key:"addPoisonPolygon",value:function(e){this.poisonPolygons.push(e)}},{key:"batchDrawAllPoisonPools",value:function(){if(!(this.poisonPolygons.length<1)){this.graphicPattern.setColor("#774798d1");var e,t=r(this.poisonPolygons);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.graphicPattern.draw(n)}}catch(e){t.e(e)}finally{t.f()}this.applyColliderForBatchDraw(),this.loadCircleFrame(),this.setTimeSpawnBubble(.2)}}},{key:"applyColliderForBatchDraw",value:function(){var e,t=this.poisonPolygons.map((function(e){return e.map((function(e){var t=e.x,n=e.y;return new K(t,n)}))})),n=r(t);try{for(n.s();!(e=n.n()).done;){var i=e.value,a=new L;a.name=Rs.POISON,this.node.addChild(a),a.setPosition(0,0);var o=a.addComponent(W);o.group=Fs.MAIN_OBJECT,o.type=V.Static;var s=a.addComponent(oe);s.points=i,s.sensor=!0,s.apply()}}catch(e){n.e(e)}finally{n.f()}}},{key:"addRigidBody",value:function(){var e=this.addComponent(W);e?(e.group=Fs.MAIN_OBJECT,e.type=V.Static):console.warn("Cannot add RigidBody2D")}},{key:"addPolygonCollider",value:function(){var e=this.addComponent(oe);e?e.sensor=!0:console.warn("Cannot add PolygonCollider2D")}},{key:"drawPattern",value:function(){this.graphicPattern.setColor("#774798d1"),this.graphicPattern.draw(this.polygon),this.graphicPattern.applyCollider(this.polygon)}},{key:"loadCircleFrame",value:(s=e((function*(){var e=yield ze.loadSpriteFrameAsync(zs.POISON_CIRCLE_FRAME);if(this.node.isValid&&e){this.bubbleFrame=e;var t=this.useBatch?20*this.poisonPolygons.length:20;this.initPool(10,t)}})),function(){return s.apply(this,arguments)})},{key:"initPool",value:function(e,t){this.bubblePool=new re,this.maxPoolSize=t;for(var n=0;n<e;n++)this.spawnBubble()}},{key:"setTimeSpawnBubble",value:function(e){this.remaining=e}},{key:"spawnBubble",value:function(){if(!this.bubblePool)return null;if(this.totalBubble>=this.maxPoolSize)return null;var e=null;return this.bubblePool.size()>0?e=this.bubblePool.get():(e=new L(Rs.POISON_BUBBLE),this.initBubble(e),this.killBubble(e),this.bubblePool.put(e)),e?(this.gameObjects.addObject(e),this.totalBubble+=1,e):null}},{key:"releaseBubble",value:function(e){this.bubblePool&&(this.killBubble(e),se.stopAllByTarget(e),this.bubblePool.put(e),this.totalBubble-=1)}},{key:"killBubble",value:function(e){if(e){var t=e.getComponent(E);t&&(t.enabled=!1)}}},{key:"reviveBubble",value:function(e,t){var n=this.getPosition(t),i=n.minX,a=n.minY,o=n.maxX,r=Z.randomRange(i,o),s=e.getComponent(O);s?s.opacity=125:console.warn("UIOpacity not found in bubble");var l=e.getComponent(E);l&&(l.enabled=!0),e.setPosition(new _(r,a))}},{key:"initBubble",value:function(e){e.layer=this.node.layer,e.addComponent(E).spriteFrame=this.bubbleFrame,e.addComponent(O)}},{key:"update",value:function(e){if(this.remaining-=e,this.remaining<=0){if(!this.useBatch){var t=this.spawnBubble();if(!t)return;this.reviveBubble(t,this.polygon),this.playBubbleTween(t,this.polygon);var n=Z.randomRange(.3,.5);return void this.setTimeSpawnBubble(n)}var i,a=Z.randomRange(.3,.5),o=r(this.poisonPolygons);try{for(o.s();!(i=o.n()).done;){var s=i.value,l=this.spawnBubble();if(!l)return;this.reviveBubble(l,s),this.playBubbleTween(l,s)}}catch(e){o.e(e)}finally{o.f()}this.setTimeSpawnBubble(a)}}},{key:"playBubbleTween",value:function(e,t){var n=this;if(e){var i=this.getPosition(t),a=i.minY,o=i.maxY,r=e.getPosition(),s=Z.randomRange(80,120),l=Math.abs(o-a),u=r.x,c=r.y+(o-a)-10,h=l/s;le(e).call((function(){e.setPosition(r)})).to(h,{position:new _(u,c)},{easing:"smooth"}).call((function(){n.releaseBubble(e)})).start();var p=e.getComponent(O);if(p){var d=h-.4>0?.4:h;p.opacity=160,le(p).delay(h-d).to(d,{opacity:0},{easing:"smooth"}).start()}else console.warn("UIOpacity not found in bubble")}}},{key:"getPosition",value:function(e){var t,n=1e4,i=0,a=1e4,o=0,s=r(e);try{for(s.s();!(t=s.n()).done;){var l=t.value,u=l.x,c=l.y;u<n&&(n=u),u>i&&(i=u),c<a&&(a=c),c>o&&(o=c)}}catch(e){s.e(e)}finally{s.f()}return{minX:n+=20,minY:a+=13,maxX:i-=20,maxY:o-=13}}}]),u}(k))||yc)||yc;v._RF.pop(),v._RF.push({},"8633c11nMJN7I7TAFaGu3Fg","PoisonSurface",void 0);var wc,Ec=(0,m.ccclass)("PoisonSurface")(bc=function(o){t(u,o);var s,l=n(u);function u(){var e;i(this,u);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=l.call.apply(l,[this].concat(n))).poisonBubblePrefab=null,e.polygon=[],e.useBatch=!1,e.surfacePolygon=[],e.bubblePool=null,e.remaining=0,e.maxPoolSize=0,e.totalBubble=0,e}return a(u,[{key:"onLoad",value:function(){var e;this.graphicPattern=this.getComponent(dc),this.gameObjects=null===(e=this.node.parent)||void 0===e?void 0:e.getComponent(Gp),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"start",value:function(){this.useBatch||(this.drawPattern(),this.loadBubbleFrame())}},{key:"drawPattern",value:function(){this.graphicPattern.setColor("#9757bcb0"),this.graphicPattern.draw(this.polygon)}},{key:"addPoisonSurfacePolygon",value:function(e){this.surfacePolygon.push(e)}},{key:"batchDrawAllPoisonSurfaces",value:function(){if(!(this.surfacePolygon.length<1)){this.graphicPattern.setColor("#9757bcb0");var e,t=r(this.surfacePolygon);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.graphicPattern.draw(n)}}catch(e){t.e(e)}finally{t.f()}this.loadBubbleFrame()}}},{key:"loadBubbleFrame",value:(s=e((function*(){try{var e=yield ze.loadPrefabAsync(zs.POISON_BUBBLE_PREFAB);if(!this.node.isValid)return;if(!e)throw new Error("loadBubbleFrame: Prefab is null");this.poisonBubblePrefab=e;var t=this.useBatch?12*this.surfacePolygon.length:12;this.initPool(10,t),this.setTimeSpawnBubble(.3)}catch(e){var n=e instanceof Error?e:new Error(String(e));console.error("loadBubbleFrame",n)}})),function(){return s.apply(this,arguments)})},{key:"update",value:function(e){if(this.remaining-=e,this.remaining<=0){if(!this.useBatch){var t=this.spawnPoisonBubblePop();if(!t)return;this.reviveBubble(t,this.polygon);var n=Z.randomRange(.3,.5);return void this.setTimeSpawnBubble(n)}var i,a=Z.randomRange(.3,.5),o=r(this.surfacePolygon);try{for(o.s();!(i=o.n()).done;){var s=i.value,l=this.spawnPoisonBubblePop();if(!l)return;this.reviveBubble(l,s)}}catch(e){o.e(e)}finally{o.f()}this.setTimeSpawnBubble(a)}}},{key:"initPool",value:function(e,t){this.bubblePool=new re,this.maxPoolSize=t;for(var n=0;n<e;n++)this.spawnPoisonBubblePop()}},{key:"setTimeSpawnBubble",value:function(e){this.remaining=e}},{key:"spawnPoisonBubblePop",value:function(){if(!this.bubblePool)return null;if(this.totalBubble>=this.maxPoolSize)return null;var e=null;if(this.bubblePool.size()>0)e=this.bubblePool.get();else{if(!((e=ne(this.poisonBubblePrefab))instanceof L))return null;this.bubblePool.put(e)}return e?(e.name=Rs.POISON_SURFACE,this.gameObjects.addObject(e),this.totalBubble+=1,e):null}},{key:"releasePoisonBubblePop",value:function(e){this.bubblePool&&(this.bubblePool.put(e),this.totalBubble-=1)}},{key:"reviveBubble",value:function(e,t){var n=this;if(e){var i=this.getRandomPosition(t),a=i.x,o=i.y;e.setPosition(new _(a,o));var r=e.getComponent(q.Skeleton);r&&(r.setAnimation(0,"animation",!1),r.setCompleteListener((function(){n.releasePoisonBubblePop(e)})))}}},{key:"getRandomPosition",value:function(e){var t,n=1e4,i=0,a=1e4,o=0,s=r(e);try{for(s.s();!(t=s.n()).done;){var l=t.value,u=l.x,c=l.y;u<n&&(n=u),u>i&&(i=u),c<a&&(a=c),c>o&&(o=c)}}catch(e){s.e(e)}finally{s.f()}return{x:Z.randomRange(n+25,i-25),y:Z.randomRange(a+5,o-5)}}}]),u}(k))||bc;v._RF.pop(),v._RF.push({},"9aa6cp2xqhK1LJeA0kz2hWR","Water",void 0);var Tc=m.ccclass,Ac=m.requireComponent,Rc=Tc("Water")(wc=Ac([dc])(wc=function(e){t(s,e);var o=n(s);function s(){var e;i(this,s);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).polygon=[],e.useBatch=!1,e.waterPolygon=[],e}return a(s,[{key:"onLoad",value:function(){this.graphicPattern=this.getComponent(dc),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"start",value:function(){this.addRigidBody(),this.useBatch||(this.addPolygonCollider(),this.drawPattern())}},{key:"addWaterPolygon",value:function(e){this.waterPolygon.push(e)}},{key:"batchDrawAllWater",value:function(){if(!(this.waterPolygon.length<1)){this.graphicPattern.setColor("#58cef0d0");var e,t=r(this.waterPolygon);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.graphicPattern.draw(n)}}catch(e){t.e(e)}finally{t.f()}this.applyColliderForBatchDraw()}}},{key:"applyColliderForBatchDraw",value:function(){var e,t=this.waterPolygon.map((function(e){return e.map((function(e){var t=e.x,n=e.y;return new K(t,n)}))})),n=r(t);try{for(n.s();!(e=n.n()).done;){var i=e.value,a=new L;a.name=Rs.WATER,this.node.addChild(a),a.setPosition(0,0);var o=a.addComponent(W);o.group=Fs.MAIN_OBJECT,o.type=V.Static;var s=a.addComponent(oe);s.points=i,s.sensor=!0,s.apply()}}catch(e){n.e(e)}finally{n.f()}}},{key:"addRigidBody",value:function(){var e=this.addComponent(W);e?(e.group=Fs.MAIN_OBJECT,e.type=V.Static):console.warn("Cannot add RigidBody2D")}},{key:"addPolygonCollider",value:function(){var e=this.addComponent(oe);e?e.sensor=!0:console.warn("Cannot add PolygonCollider2D")}},{key:"drawPattern",value:function(){this.graphicPattern.setColor("#58cef0d0"),this.graphicPattern.draw(this.polygon),this.graphicPattern.applyCollider(this.polygon)}}]),s}(k))||wc)||wc;v._RF.pop(),v._RF.push({},"d6e4emyi1lPpLbSlAWFj/GD","CrossingBeeLineTypes",void 0);var Pc,_c,Bc,Lc,Oc,Dc,Ic,Nc,Fc,Gc,zc,Mc,xc,Uc,Hc=function(e){return e[e.LOW=0]="LOW",e[e.MEDIUM=1]="MEDIUM",e[e.HIGH=2]="HIGH",e}(Hc||{});z(Hc),v._RF.pop(),v._RF.push({},"988b72EAIhJ1qc0nrLU68l7","CrossingBeeLine",void 0);var jc=m.ccclass,Vc=m.property,Wc=m.requireComponent,qc=(Pc=jc("CrossingBeeLine"),_c=Wc([E,x]),Bc=Vc(X),Lc=Vc(X),Oc=Vc(X),Dc=Vc({type:Hc,displayName:"Sprite type"}),Ic=Vc({type:U,displayName:"Line thickness",min:0}),Pc(Nc=_c((Gc=s((Fc=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"spriteLow",Gc,u(e)),l(e,"spriteMedium",zc,u(e)),l(e,"spriteHigh",Mc,u(e)),l(e,"spriteType",xc,u(e)),l(e,"lineThickness",Uc,u(e)),e.startPos=new _,e.endPos=new _,e}return a(r,[{key:"setStartPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.startPos.x,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.startPos.z;this.startPos.set(e,t,n),this.updateLine()}},{key:"setEndPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.endPos.y,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.endPos.z;this.endPos.set(e,t,n),this.updateLine()}},{key:"updateLine",value:function(){this.updateContentSize(),this.updatePosition(),this.updateRotation()}},{key:"thickness",get:function(){return this.lineThickness},set:function(e){this.lineThickness=e,this.updateContentSize()}},{key:"setSpriteType",value:function(e){switch(this.spriteType=e,e){case Hc.LOW:this.sprite.spriteFrame=this.spriteLow;break;case Hc.MEDIUM:this.sprite.spriteFrame=this.spriteMedium;break;case Hc.HIGH:this.sprite.spriteFrame=this.spriteHigh}}},{key:"onLoad",value:function(){this.uiTransform=this.getComponent(x),this.sprite=this.getComponent(E),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"start",value:function(){this.setSpriteType(this.spriteType),this.updateContentSize(),this.updatePosition(),this.updateRotation()}},{key:"updateContentSize",value:function(){var e=this.endPos.x-this.startPos.x,t=this.endPos.y-this.startPos.y,n=this.endPos.z-this.startPos.z,i=Math.sqrt(e*e+t*t+n*n);this.uiTransform.setContentSize(i,this.lineThickness)}},{key:"updatePosition",value:function(){this.uiTransform.setAnchorPoint(.5,.5),this.node.setWorldPosition((this.startPos.x+this.endPos.x)/2,(this.startPos.y+this.endPos.y)/2,(this.startPos.z+this.endPos.z)/2)}},{key:"updateRotation",value:function(){this.node.setWorldRotationFromEuler(0,0,180*Math.atan2(this.endPos.y-this.startPos.y,this.endPos.x-this.startPos.x)/Math.PI)}}]),r}(k)).prototype,"spriteLow",[Bc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zc=s(Fc.prototype,"spriteMedium",[Lc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mc=s(Fc.prototype,"spriteHigh",[Oc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xc=s(Fc.prototype,"spriteType",[Dc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Hc.LOW}}),Uc=s(Fc.prototype,"lineThickness",[Ic],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Nc=Fc))||Nc)||Nc);v._RF.pop(),v._RF.push({},"169a1O0ruFLoI6OnJUZap7V","DogeState",void 0);var Kc,Yc=function(e){return e[e.IDLE=0]="IDLE",e[e.SMILE=1]="SMILE",e[e.SCARE=2]="SCARE",e[e.BEE_STING=3]="BEE_STING",e[e.THORN_STAB=4]="THORN_STAB",e[e.OUT_OF_SCREEN=5]="OUT_OF_SCREEN",e[e.POISONED=6]="POISONED",e[e.DROWNING=7]="DROWNING",e[e.OVER_VIEW=8]="OVER_VIEW",e}(Yc||{});v._RF.pop(),v._RF.push({},"852f9XjNUVJ3Zt1Kd/EbqXU","Eye",void 0);var Jc,Zc,Xc,Qc,$c,eh,th,nh=(0,m.ccclass)("Eye")(Kc=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).scaleTween=null,e.initialPosition=null,e}return a(r,[{key:"createScaleAnimation",value:function(){var e=le(this.node).to(.3,{scale:new _(1.1,1.1,1)},{easing:"smooth"});this.scaleTween=le(this.node).reverseTime(e).repeatForever()}},{key:"saveInitialPosition",value:function(){this.initialPosition||(this.initialPosition=this.node.position.clone())}},{key:"show",value:function(){this.node.active=!0,this.playAnimation()}},{key:"hide",value:function(){this.stopAnimation(),this.node.active=!1}},{key:"toward",value:function(e){this.initialPosition&&(this.node.setPosition(this.initialPosition),this.node.position.add(e))}},{key:"playAnimation",value:function(){var e;this.scaleTween||this.createScaleAnimation(),null===(e=this.scaleTween)||void 0===e||e.start()}},{key:"stopAnimation",value:function(){var e;null===(e=this.scaleTween)||void 0===e||e.stop()}}]),r}(k))||Kc;v._RF.pop(),v._RF.push({},"df218vrmOtEH5vRQXxIZ3yS","Eyes",void 0);var ih,ah,oh,rh,sh,lh,uh,ch,hh=m.ccclass,ph=m.property,dh=(Jc=hh("Eyes"),Zc=ph(nh),Xc=ph(nh),Jc((eh=s(($c=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"leftEye",eh,u(e)),l(e,"rightEye",th,u(e)),e.time=0,e.remaining=0,e.running=!1,e}return a(r,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"start",value:function(){this.remaining=0,this.running=!1,this.setTimeChangeDirection(.8),this.leftEye.saveInitialPosition(),this.rightEye.saveInitialPosition()}},{key:"setTimeChangeDirection",value:function(e){this.time=e}},{key:"show",value:function(){this.running=!0,this.remaining=this.time,this.leftEye.show(),this.rightEye.show()}},{key:"hide",value:function(){this.running=!1,this.leftEye.hide(),this.rightEye.hide()}},{key:"stopLook",value:function(){this.running=!1}},{key:"look",value:function(){if(this.node.parent){var e=this.node.parent.getComponent(Ah);if(e){var t=e.getNearbyBee();if(t){var n=this.leftEye.initialPosition;if(n){var i=n.x,a=n.y,o=new _;this.leftEye.node.inverseTransformPoint(o,t.node.worldPosition);var r=new _(o.x-i,o.y-a,0).normalize().multiplyScalar(5);this.leftEye.toward(r),this.rightEye.toward(r)}}}}}},{key:"update",value:function(e){this.running&&(this.remaining<=0&&(this.look(),this.remaining=this.time),this.remaining-=e)}}]),r}(k)).prototype,"leftEye",[Zc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),th=s($c.prototype,"rightEye",[Xc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qc=$c))||Qc);v._RF.pop(),v._RF.push({},"14172TbYDBAeISJqcpvLYV7","Doge",void 0);var yh,vh,fh,mh,gh,bh,Sh,kh,Ch=m.ccclass,wh=m.property,Eh=GameCore.Utils.Array,Th=[Yc.OVER_VIEW,Yc.BEE_STING,Yc.THORN_STAB,Yc.POISONED,Yc.OUT_OF_SCREEN],Ah=(ih=Ch("Doge"),ah=wh(dh),oh=wh(Y),ih((lh=s((sh=function(o){t(h,o);var s,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=c.call.apply(c,[this].concat(n)),l(e,"eyes",lh,u(e)),e.state=Yc.IDLE,e.dustParticle=null,e.gameHeight=0,l(e,"collider",uh,u(e)),l(e,"gameObjects",ch,u(e)),e.onBeginContact=function(t,n){n.node.name!==Rs.BEE&&n.node.name!==Rs.BIG_BEE&&n.node.name!==Rs.BIG_BEE_BULLET||e.beeSting(),n.node.name!==Rs.THORN&&n.node.name!==Rs.THORN_BALL?n.node.name!==Rs.POISON?n.node.name===Rs.WATER&&e.drowning():e.poisoned():e.stabbedByThorn()},e}return a(h,[{key:"onLoad",value:function(){var e;this.collider=this.getComponent(Y),this.gameObjects=null===(e=this.node.parent)||void 0===e?void 0:e.getComponent(Gp),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"start",value:function(){var e;this.initDustParticle(),this.idle();var t=null===(e=ue("Canvas"))||void 0===e?void 0:e.getComponent(x);t&&(this.gameHeight=t.height),this.collider.on(J.BEGIN_CONTACT,this.onBeginContact)}},{key:"idle",value:function(){!1!==this.setState(Yc.IDLE)&&(this.hideEyes(),this.setSpineAnimation(al.IDLE,!0))}},{key:"smile",value:function(){!1!==this.setState(Yc.SMILE)&&(this.hideEyes(),this.setSpineAnimation(al.SMILE,!0))}},{key:"beeSting",value:function(){var e=this;!1!==this.setState(Yc.BEE_STING)&&(this.hideEyes(),this.setSpineAnimation(al.HURT,!1),this.scareOtherDoges(),this.scheduleOnce((function(){e.state===Yc.BEE_STING&&e.setSpineAnimation(al.INACTIVE,!1)}),.3),Ve.playSound(qe.DOGE_HURT))}},{key:"stabbedByThorn",value:function(){!1!==this.setState(Yc.THORN_STAB)&&(this.hideEyes(),this.createDust(),this.setSpineAnimation(al.THORN_INACTIVE,!1),this.scareOtherDoges(),Ve.playSound(qe.DOGE_DIES))}},{key:"poisoned",value:function(){!1!==this.setState(Yc.POISONED)&&(this.hide(),this.hideEyes(),this.createDust(),this.scareOtherDoges(),Ve.playSound(qe.DOGE_DIES))}},{key:"drowning",value:function(){!1!==this.setState(Yc.DROWNING)&&(this.hideEyes(),this.setSpineAnimation(al.DROWNING,!1))}},{key:"isCantBeTargeted",value:function(){return-1!==[Yc.THORN_STAB,Yc.OUT_OF_SCREEN,Yc.POISONED,Yc.DROWNING].indexOf(this.state)}},{key:"scare",value:function(){var e;!1!==this.setState(Yc.SCARE)&&(this.showEyes(),null===(e=this.eyes)||void 0===e||e.look(),this.setSpineAnimation(al.FREAK_OUT,!0))}},{key:"hideEyes",value:function(){this.eyes.hide()}},{key:"showEyes",value:function(){this.eyes.show()}},{key:"setState",value:function(e){return-1===Th.indexOf(e)?-1===Th.indexOf(this.state)&&(this.state=e,!0):Th.indexOf(e)>Th.indexOf(this.state)&&(this.state=e,this.node.scene.emit(wl.DOGE_DIE),!0)}},{key:"scareOtherDoges",value:function(){if(this.gameObjects){var e,t=this.gameObjects.getDoges(this),n=r(t);try{for(n.s();!(e=n.n()).done;){e.value.scare()}}catch(e){n.e(e)}finally{n.f()}}}},{key:"update",value:function(){var e=this.node.worldPosition.y;(e>this.gameHeight||e<0)&&this.setState(Yc.OUT_OF_SCREEN),this.isBeeNearBy()&&this.scare()}},{key:"isBeeNearBy",value:function(){return this.state===Yc.IDLE&&(!Eh.has(Th,this.state)&&!!this.getNearbyBee())}},{key:"getNearbyBee",value:function(){var e=this;if(!this.node.parent)return null;var t=this.node.parent.getComponentsInChildren(Ul).find((function(t){var n=_.distance(e.node.getWorldPosition(),t.node.getWorldPosition());if(t.enabled&&n<=200)return!0}));return null!=t?t:null}},{key:"createDust",value:function(){var e=this;if(this.dustParticle){this.dustParticle.active=!0;var t=this.node.getWorldPosition(),n=t.x,i=t.y;this.dustParticle.setWorldPosition(new _(n,i));try{var a=this.dustParticle.getComponent(q.Skeleton);null==a||a.setAnimation(0,"animation",!1)}catch(e){console.error("createDust",e)}this.scheduleOnce((function(){e.dustParticle&&(e.dustParticle.active=!1)}),.5)}}},{key:"initDustParticle",value:(s=e((function*(){if(this.node.parent){var e=new L(Rs.DUST_PARTICLE);e.layer=Math.pow(2,25),e.active=!1;var t=e.addComponent(q.Skeleton),n=yield ze.loadSkeletonDataAsync(zs.DUST_PARTICLE_SPINE);n?this.node&&this.node.isValid&&(t.skeletonData=n,this.node.parent.addChild(e),this.dustParticle=e):console.warn("initDustParticle","Failed to load dust particle spine")}})),function(){return s.apply(this,arguments)})}]),h}(qs)).prototype,"eyes",[ah],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uh=s(sh.prototype,"collider",[oh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ch=s(sh.prototype,"gameObjects",[wh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rh=sh))||rh);v._RF.pop(),v._RF.push({},"2ca763+kElPuqiAkECtFMMS","Grass",void 0);var Rh,Ph,_h,Bh,Lh,Oh=m.ccclass,Dh=m.property,Ih=m.requireComponent,Nh=(yh=Oh("Grass"),vh=Ih(D),fh=Dh({tooltip:"Use batch draw all grass polygons"}),mh=Dh(D),yh(gh=vh((Sh=s((bh=function(e){t(s,e);var o=n(s);function s(){var e;i(this,s);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"useBatch",Sh,u(e)),l(e,"graphic",kh,u(e)),e.grassPolygons=[],e}return a(s,[{key:"__preload",value:function(){this.graphic=this.getComponent(D),this.validateRequiredComponents(),this.listenGameplayEvents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"listenGameplayEvents",value:function(){}},{key:"onLoad",value:function(){var e=this.getPolygon();if(e){var t=this.isDark()?Rs.GRASS_DARK:Rs.GRASS;this.useBatch?this.addGrassPolygon(t,e):(this.updateFillColor(t),this.drawGrass(e))}}},{key:"drawGrass",value:function(e){this.graphic.moveTo(e[0].x,e[0].y);var t,n=r(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.graphic.lineTo(i.x,i.y)}}catch(e){n.e(e)}finally{n.f()}this.graphic.close(),this.graphic.fill()}},{key:"getPolygon",value:function(){if(!("polygon"in this.node))return null;var e=this.node.polygon;return Array.isArray(e)?e:null}},{key:"isDark",value:function(){return"isDark"in this.node&&!!this.node.isDark}},{key:"addGrassPolygon",value:function(e,t){this.grassPolygons.push({type:e,polygon:t})}},{key:"updateFillColor",value:function(e){e===Rs.GRASS_DARK?this.graphic.fillColor.fromHEX("#5e9c35"):this.graphic.fillColor.fromHEX("#8bdd55")}},{key:"batchDrawAllGrass",value:function(){if(!(this.grassPolygons.length<1)){var e,t=r(this.grassPolygons);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.updateFillColor(n.type),this.drawGrass(n.polygon)}}catch(e){t.e(e)}finally{t.f()}this.grassPolygons=[]}}}]),s}(qs)).prototype,"useBatch",[fh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),kh=s(bh.prototype,"graphic",[mh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gh=bh))||gh)||gh);v._RF.pop(),v._RF.push({},"7027fhYTgdDe6EinMz7XLC6","MapLine",void 0);var Fh=m.ccclass,Gh=m.property,zh=(Rh=Fh("MapLine"),Ph=Gh(D),Rh((Lh=s((Bh=function(e){t(s,e);var o=n(s);function s(){var e;i(this,s);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"graphics",Lh,u(e)),e.useBatch=!1,e.mapLines=[],e}return a(s,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"onLoad",value:function(){var e=this.getPolygon();e&&(this.useBatch?(this.graphics.enabled=!1,this.addLine(e)):this.drawLine(e))}},{key:"getPolygon",value:function(){if(!("polygon"in this.node))return null;var e=this.node.polygon;return Array.isArray(e)?e:null}},{key:"addLine",value:function(e){this.mapLines.push(e)}},{key:"drawLine",value:function(e){this.graphics.moveTo(e[0].x,e[0].y);var t,n=r(e.slice(1));try{for(n.s();!(t=n.n()).done;){var i=t.value;this.graphics.lineTo(i.x,i.y)}}catch(e){n.e(e)}finally{n.f()}this.graphics.stroke()}},{key:"batchDrawAllLines",value:function(){if(!(this.mapLines.length<1)){var e,t=r(this.mapLines);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.drawLine(n)}}catch(e){t.e(e)}finally{t.f()}this.mapLines=[]}}}]),s}(k)).prototype,"graphics",[Ph],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_h=Bh))||_h);v._RF.pop(),v._RF.push({},"87767KZVqpEgIbdzZdGh1CJ","BatchObjectManager",void 0);var Mh=function(){function e(){i(this,e),this.isBrickInitialized=!1,this.isGrassInitialized=!1,this.isLineInitialized=!1,this.isPoisonInitialized=!1,this.isPoisonSurfaceInitialized=!1,this.isWaterInitialized=!1,this.isDangerAreaInitialized=!1,this.mainBrickComponent=null,this.mainGrassComponent=null,this.mainLineComponent=null,this.mainPoisonComponent=null,this.mainPoisonSurfaceComponent=null,this.mainWaterComponent=null,this.mainDangerAreaComponent=null}return a(e,[{key:"assignMainBrickComponent",value:function(e){this.mainBrickComponent=e}},{key:"assignMainGrassComponent",value:function(e){this.mainGrassComponent=e}},{key:"assignMainLineComponent",value:function(e){this.mainLineComponent=e}},{key:"assignMainPoisonComponent",value:function(e){this.mainPoisonComponent=e}},{key:"assignMainPoisonSurfaceComponent",value:function(e){this.mainPoisonSurfaceComponent=e}},{key:"assignMainWaterComponent",value:function(e){this.mainWaterComponent=e}},{key:"assignMainDangerAreaComponent",value:function(e){this.mainDangerAreaComponent=e}},{key:"isBrickBatchingEnabled",value:function(){var e,t;return null!==(e=null===(t=this.mainBrickComponent)||void 0===t?void 0:t.useBatch)&&void 0!==e&&e}},{key:"isGrassBatchingEnabled",value:function(){var e,t;return null!==(e=null===(t=this.mainGrassComponent)||void 0===t?void 0:t.useBatch)&&void 0!==e&&e}},{key:"isLineBatchingEnabled",value:function(){var e,t;return null!==(e=null===(t=this.mainLineComponent)||void 0===t?void 0:t.useBatch)&&void 0!==e&&e}},{key:"isPoisonBatchingEnabled",value:function(){var e,t;return null!==(e=null===(t=this.mainPoisonComponent)||void 0===t?void 0:t.useBatch)&&void 0!==e&&e}},{key:"isPoisonSurfaceBatchingEnabled",value:function(){var e,t;return null!==(e=null===(t=this.mainPoisonSurfaceComponent)||void 0===t?void 0:t.useBatch)&&void 0!==e&&e}},{key:"isWaterBatchingEnabled",value:function(){var e,t;return null!==(e=null===(t=this.mainWaterComponent)||void 0===t?void 0:t.useBatch)&&void 0!==e&&e}},{key:"isDangerAreaBatchingEnabled",value:function(){var e,t;return null!==(e=null===(t=this.mainDangerAreaComponent)||void 0===t?void 0:t.useBatch)&&void 0!==e&&e}},{key:"updateBrickPolygon",value:function(e){this.mainBrickComponent?this.mainBrickComponent.addBrickPolygon(e):console.warn("BatchObjectManager: mainBrickComponent is not assigned")}},{key:"updateGrassPolygon",value:function(e,t){this.mainGrassComponent?this.mainGrassComponent.addGrassPolygon(e,t):console.warn("BatchObjectManager: mainGrassComponent is not assigned")}},{key:"updateMapLine",value:function(e){this.mainLineComponent?this.mainLineComponent.addLine(e):console.warn("BatchObjectManager: mainLineNode is not assigned")}},{key:"updatePoisonPolygon",value:function(e){this.mainPoisonComponent?this.mainPoisonComponent.addPoisonPolygon(e):console.warn("BatchObjectManager: mainPoisonComponent is not assigned")}},{key:"updatePoisonSurfacePolygon",value:function(e){this.mainPoisonSurfaceComponent?this.mainPoisonSurfaceComponent.addPoisonSurfacePolygon(e):console.warn("BatchObjectManager: mainPoisonSurfaceComponent is not assigned")}},{key:"updateWaterPolygon",value:function(e){this.mainWaterComponent?this.mainWaterComponent.addWaterPolygon(e):console.warn("BatchObjectManager: mainWaterComponent is not assigned")}},{key:"updateDangerAreaPolygon",value:function(e){this.mainDangerAreaComponent?this.mainDangerAreaComponent.addDangerAreaPolygon(e):console.warn("BatchObjectManager: mainDangerAreaComponent is not assigned")}},{key:"batchDraw",value:function(){var e,t,n,i,a,o,r;null===(e=this.mainBrickComponent)||void 0===e||e.batchDrawAllBrick(),null===(t=this.mainGrassComponent)||void 0===t||t.batchDrawAllGrass(),null===(n=this.mainLineComponent)||void 0===n||n.batchDrawAllLines(),null===(i=this.mainPoisonComponent)||void 0===i||i.batchDrawAllPoisonPools(),null===(a=this.mainPoisonSurfaceComponent)||void 0===a||a.batchDrawAllPoisonSurfaces(),null===(o=this.mainWaterComponent)||void 0===o||o.batchDrawAllWater(),null===(r=this.mainDangerAreaComponent)||void 0===r||r.batchDrawAllDangerAreas()}},{key:"clearObjects",value:function(){this.isBrickInitialized=!1,this.isGrassInitialized=!1,this.isLineInitialized=!1,this.isPoisonInitialized=!1,this.isPoisonSurfaceInitialized=!1,this.isWaterInitialized=!1,this.isDangerAreaInitialized=!1,this.mainBrickComponent=null,this.mainGrassComponent=null,this.mainLineComponent=null,this.mainPoisonComponent=null,this.mainPoisonSurfaceComponent=null,this.mainWaterComponent=null,this.mainDangerAreaComponent=null}}]),e}();v._RF.pop(),v._RF.push({},"4c04ffCcRhGsqEZlVWUHd8s","MapTransformer",void 0);var xh,Uh,Hh,jh,Vh,Wh,qh,Kh,Yh,Jh,Zh,Xh,Qh,$h,ep,tp,np,ip,ap,op,rp,sp,lp,up,cp,hp,pp,dp,yp,vp,fp,mp,gp,bp,Sp,kp,Cp,wp,Ep,Tp,Ap,Rp,Pp,_p,Bp,Lp=200,Op=270,Dp=function(){function e(){i(this,e)}return a(e,null,[{key:"getPointObject",value:function(t){var n=t.id,i=t.point,a=t.data,o=t.connect,r=e.getTransformedPoint(i);return console.log(Zl.HEIGHT,i.y*Jl,Op),{id:n,point:r,data:a,connect:o}}},{key:"getTransformedPoint",value:function(e){return{x:e.x*Jl+14-Lp,y:Zl.HEIGHT-e.y*Jl-14-Op}}},{key:"revertTransformedPoint",value:function(e){return{x:(e.x+Lp-14)/Jl,y:(Zl.HEIGHT-e.y-14-Op)/Jl}}},{key:"getPointObjectBỵHalfCoord",value:function(e){var t=e.id,n=e.point,i=e.data,a=e.connect;return{id:t,point:{x:n.x*Jl/2-Lp,y:Zl.HEIGHT-n.y*Jl/2-Op},data:i,connect:a}}},{key:"getPolygonObject",value:function(t){var n=t.id,i=t.point,a=t.data,o=t.connect;return{id:n,point:e.getTransformedPolygon(i),data:a,connect:o}}},{key:"getTransformedPolygon",value:function(e){return e.map((function(e){var t=e.x,n=e.y;return{x:t*Jl-Lp,y:Zl.HEIGHT-n*Jl-Op}}))}},{key:"revertTransformedPolygon",value:function(e){return e.map((function(e){var t=e.x,n=e.y;return{x:(t+Lp)/Jl,y:(Zl.HEIGHT-n-Op)/Jl}}))}},{key:"getDoublePolygon",value:function(e){var t=e.id,n=e.point,i=e.data,a=e.connect;return{id:t,point:n.map((function(e){var t=e.x,n=e.y;return{x:t*Jl/2-Lp,y:Zl.HEIGHT-n*Jl/2-Op}})),data:i,connect:a}}},{key:"getTransformedDoublePolygon",value:function(e){return e.map((function(e){var t=e.x,n=e.y;return{x:t*Jl/2-Lp,y:Zl.HEIGHT-n*Jl/2-Op}}))}},{key:"revertTransformedDoublePolygon",value:function(e){return e.map((function(e){var t=e.x,n=e.y;return{x:(t+Lp)/14,y:(Zl.HEIGHT-n-Op)/14}}))}},{key:"transformPointsFromMapToDrawAreaCoordinate",value:function(e){return e.map((function(e){var t=e.x,n=e.y;return{x:t*Jl-Lp,y:Zl.HEIGHT-n*Jl-Op}}))}}]),e}();v._RF.pop(),v._RF.push({},"75ad9uPflhLL4N96NmHF2Sk","GameObjects",void 0);var Ip,Np=m.ccclass,Fp=m.property,Gp=(xh=Np("GameObjects"),Uh=Fp(te),Hh=Fp(te),jh=Fp(te),Vh=Fp(te),Wh=Fp(te),qh=Fp(te),Kh=Fp(te),Yh=Fp(te),Jh=Fp(te),Zh=Fp(te),Xh=Fp(te),Qh=Fp(te),$h=Fp(te),ep=Fp(te),tp=Fp(te),np=Fp(te),ip=Fp({tooltip:"Use batch draw all map lines."}),ap=Fp({tooltip:"Use batch draw all poison pools."}),op=Fp({tooltip:"Use batch draw all poison surfaces."}),rp=Fp({tooltip:"Use batch draw all water pools."}),sp=Fp({tooltip:"Use batch draw all danger areas."}),xh((cp=s((up=function(o){t(p,o);var s,h=n(p);function p(){var e;i(this,p);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=h.call.apply(h,[this].concat(n)),l(e,"dogePrefab",cp,u(e)),l(e,"spiderPrefab",hp,u(e)),l(e,"beePrefab",pp,u(e)),l(e,"beehivePrefab",dp,u(e)),l(e,"bigBeePrefab",yp,u(e)),l(e,"thornPrefab",vp,u(e)),l(e,"thornBallPrefab",fp,u(e)),l(e,"airFanPrefab",mp,u(e)),l(e,"grassPrefab",gp,u(e)),l(e,"balloonPrefab",bp,u(e)),l(e,"brickPrefab",Sp,u(e)),l(e,"arenaPrefab",kp,u(e)),l(e,"woodPrefab",Cp,u(e)),l(e,"connectPrefab",wp,u(e)),l(e,"mapLinePrefab",Ep,u(e)),l(e,"crossingBeeLinePrefab",Tp,u(e)),l(e,"batchMapLines",Ap,u(e)),l(e,"batchPoisonPool",Rp,u(e)),l(e,"batchPoisonSurface",Pp,u(e)),l(e,"batchWaterPool",_p,u(e)),l(e,"batchDangerArea",Bp,u(e)),e.batchObjects=new Mh,e.objects=new Map,e}return a(p,[{key:"spawnObjects",value:function(e){for(var t=e.map,n=c(t).reverse(),i=0;i<n.length;i++){var a=n[i],o=null;(o=Array.isArray(null==a?void 0:a.point)?this.spawnPolygonObjectType(a):this.spawnPointObjectType(a))&&this.objects.set(i,o)}var s,l=r(t);try{for(l.s();!(s=l.n()).done;){var u=s.value;if(!Array.isArray(u.point)){var h=u;if(h.id===Ns.BALLOON){var p=Dp.getPointObject(h).point,d=p.x,y=p.y;if(!h.connect)continue;var v=this.findObjectIndex(t,h.connect);if(!v)continue;this.spawnBalloon(d,y,v)}if(u.id===Ns.CONNECT){if(!u.connect)return null;if(!Array.isArray(u.connect.point))return null;var f=Dp.getDoublePolygon(u.connect),m=Dp.getPointObjectBỵHalfCoord(u).point,g=m.x,b=m.y;this.spawnConnect(g,b,f.point)}}}}catch(e){l.e(e)}finally{l.f()}this.batchObjects.batchDraw(),this.sortObjects(),this.sleepObjects()}},{key:"spawnPolygonObjectType",value:function(e){var t=Dp.getPolygonObject(e).point;if(0===t.length)return null;switch(e.id){case Ns.BRICK:return this.spawnBrick(t);case Ns.GRASS:return this.spawnGrass(t,!1);case Ns.GRASS_DARK:return this.spawnGrass(t,!0);case Ns.LINE:return this.spawnLine(t);case Ns.POISON:return this.spawnPoison(t);case Ns.POISON_SURFACE:return this.spawnPoisonSurface(t);case Ns.WATER:return this.spawnWater(t);case Ns.DANGER_AREA:return this.spawnDangerAreaNormal(t);case Ns.CONNECT:return null;case Ns.WOOD:var n=Dp.getDoublePolygon(e);return this.spawnWood(n.point);case Ns.COLLIDER:var i=Dp.getDoublePolygon(e);return this.spawnCollider(0,0,i.point);case Ns.STROKE:default:return null}}},{key:"spawnPointObjectType",value:function(e){var t=Dp.getPointObject(e).point,n=t.x,i=t.y;switch(e.id){case Ns.DOGE_A:return this.spawnDoge({x:n,y:i});case Ns.DOGE_B:return this.spawnDoge({x:n,y:i,right:!0});case Ns.SPIDER:return this.spawnSpider(n,i);case Ns.BEEHIVE_A:case Ns.BEEHIVE_C:return this.spawnBeehive(n,i);case Ns.BEEHIVE_B:case Ns.BEEHIVE_D:return this.spawnBeehive(n,i,!0);case Ns.THORN_BALL:return this.spawnThornBall(n,i);case Ns.BIG_BEE:return this.spawnBigBee(n,i);case Ns.WATER_SURFACE:return this.spawnWaterSurface(n,i);case Ns.THORN:var a,o=(null===(a=e.data)||void 0===a?void 0:a.a)||0;return this.spawnThorn(n,i,o);case Ns.AIR_FAN:var r,s=(null===(r=e.data)||void 0===r?void 0:r.a)||0;return this.spawnAirFan(n,i,s);default:return null}}},{key:"spawnObjectForDevTools",value:function(e){this.spawnPointObjectType(e),this.sortObjects()}},{key:"spawnPolygonObjectForDevTools",value:function(e){this.spawnPolygonObjectType(e),this.sortObjects()}},{key:"addObject",value:function(e){this.node.insertChild(e,this.getSiblingIndex(e.name))}},{key:"sortObjects",value:function(){var e=c(this.node.children);e.sort((function(e,t){var n,i;return(null!==(n=Is[e.name])&&void 0!==n?n:0)-(null!==(i=Is[t.name])&&void 0!==i?i:0)})),e.forEach((function(e,t){e.setSiblingIndex(t)}))}},{key:"findObjectIndex",value:function(e,t){var n,i=this,a=e.findIndex((function(e){return JSON.stringify(e)===JSON.stringify(t)})),o=null===(n=e[a])||void 0===n?void 0:n.point;if(o&&!Array.isArray(o)){var r=Dp.getPointObject(e[a]).point,s=r.x,l=r.y,u=this.node.children.find((function(e){var n=e.position;return n.x===s&&n.y===l&&e.name===i.getObjNameFromId(t.id)}));if(u)return u}}},{key:"getObjNameFromId",value:function(e){switch(e){case Ns.DOGE_A:case Ns.DOGE_B:return Rs.DOGE;case Ns.SPIDER:return Rs.SPIDER;case Ns.BEEHIVE_A:case Ns.BEEHIVE_B:case Ns.BEEHIVE_C:case Ns.BEEHIVE_D:return Rs.BEEHIVE;case Ns.THORN_BALL:return Rs.THORN_BALL;case Ns.BIG_BEE:return Rs.BIG_BEE;case Ns.WATER_SURFACE:return Rs.WATER_SURFACE;case Ns.THORN:return Rs.THORN;case Ns.AIR_FAN:return Rs.AIR_FAN;case Ns.BRICK:return Rs.BRICK;case Ns.GRASS:return Rs.GRASS;case Ns.GRASS_DARK:return Rs.GRASS_DARK;case Ns.LINE:return Rs.MAP_LINE;case Ns.POISON:return Rs.POISON;case Ns.POISON_SURFACE:return Rs.POISON_SURFACE;case Ns.WATER:return Rs.WATER;case Ns.DANGER_AREA:return Rs.DANGER_AREA;case Ns.WOOD:return Rs.WOOD;case Ns.COLLIDER:return Rs.COLLIDER;default:return""}}},{key:"getSiblingIndex",value:function(e){var t=this.node.children,n=Is[e];if(!n)return t.length+1;var i=t.map((function(e){return Is[e.name]})).filter((function(e){return void 0!==e})),a=i.findIndex((function(e){return n<e}));return a<0?i.length+1:a}},{key:"clearObjects",value:function(){this.node.destroyAllChildren(),this.node.removeAllChildren(),this.batchObjects.clearObjects()}},{key:"stopBeeBehavior",value:function(){var e,t=this.node.getComponentsInChildren(Ul),n=r(t);try{for(n.s();!(e=n.n()).done;){e.value.state=As.IDLE}}catch(e){n.e(e)}finally{n.f()}}},{key:"sleepObjects",value:function(){var e,t=this.getComponentsInChildren(qs),n=r(t);try{for(n.s();!(e=n.n()).done;){e.value.sleep()}}catch(e){n.e(e)}finally{n.f()}var i,a=this.node.getComponentsInChildren(ju),o=r(a);try{for(o.s();!(i=o.n()).done;){i.value.state=As.IDLE}}catch(e){o.e(e)}finally{o.f()}}},{key:"wakeUpObjects",value:function(){var e,t=this.getComponentsInChildren(qs),n=r(t);try{for(n.s();!(e=n.n()).done;){e.value.wake()}}catch(e){n.e(e)}finally{n.f()}}},{key:"spawnBeehive",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=ne(this.beehivePrefab);return i instanceof L?(i.name=Rs.BEEHIVE,i.setPosition(e,t),i.setScale(n?-1:1,1),i.attr({isRightSide:n}),this.addObject(i),i):null}},{key:"spawnBees",value:function(){var e,t=this.node.getComponentsInChildren(mu),n=1===t.length?8:4,i=r(t);try{for(i.s();!(e=i.n()).done;){var a=e.value;a.node.attr({totalPathSeekers:Math.floor(n/3)});for(var o=0;o<n;o++){var s=this.spawnBee();s&&a.releaseBee(s)}}}catch(e){i.e(e)}finally{i.f()}this.sortObjects()}},{key:"spawnBee",value:function(){var e=ne(this.beePrefab);return e instanceof L?(e.name=Rs.BEE,this.addObject(e),e.setSiblingIndex(999),e):null}},{key:"spawnCrossingBees",value:function(e){for(var t=this,n=e.beeSpeed,i=e.spawnRandOffset,a=void 0===i?80:i,o=e.playerWorldX,r=e.playerWorldY,s=e.spawnWorldX,l=e.spawnWorldY,u=e.count,c=void 0===u?[1,2]:u,h=e.targetOffsetMultiplier,p=void 0===h?0:h,d=Z.randomRangeInt(c[0],c[1]),y=[],v=s<o,f=function(){var e=t.spawnBee();if(!e)throw new Error("Could not spawn bee");var i=e.getComponent(Ul);if(!i)throw new Error("Bee component not found");t.addObject(e),i.isSpawnLeftSide=!v;var u=Z.randomRangeInt(-a,a),c=Z.randomRangeInt(-a,a),h=s+u,d=l+c,f=e.worldPosition.z;e.setWorldPosition(h,d,f);var m=new K(o+u*p-h,r+c*p-d);i.rotateToVector(m),i.fly(m.normalize().multiplyScalar(n)),t.scheduleOnce((function(){i.setRole(Ts.NORMAL),i.setState(As.ATTACKING),i.followInstructions()})),y.push(i)},m=0;m<d;m++)f();return this.sortObjects(),y}},{key:"spawnCrossingBeeLine",value:function(e){var t=e.startX,n=e.startY,i=e.endX,a=e.endY,o=e.thickness,r=e.spriteType,s=ne(this.crossingBeeLinePrefab);if(!(s instanceof L))throw new Error("Could not spawn crossing bee line");s.name=Rs.CROSSING_BEE_LINE;var l=s.getComponent(qc);if(!l)throw new Error("CrossingBeeLine component not found");return this.addObject(s),l.setSpriteType(r),l.setStartPosition(t,n),l.setEndPosition(i,a),l.thickness=o,this.sortObjects(),l}},{key:"checkAllBeeDie",value:function(){var e=this.node.getComponentsInChildren(Ul),t=this.node.getComponentsInChildren(ju),n=e.some((function(e){return e.enabled})),i=t.some((function(e){return e.enabled}));return!n&&!i}},{key:"spawnDoge",value:function(e){var t=e.x,n=e.y,i=e.right,a=void 0!==i&&i,o=e.isWorldPosition,r=void 0!==o&&o,s=e.rigidBodyConfig,l=void 0===s?{}:s,u=ne(this.dogePrefab);if(!(u instanceof L))return null;u.name=Rs.DOGE,r||u.setPosition(t,n),u.setScale(a?-1:1,1),this.addObject(u),u.setSiblingIndex(999),r&&u.setWorldPosition(t,n,u.worldPosition.z);var c=l.gravityScale,h=void 0===c?1:c,p=u.getComponent(W);if(!p)throw new Error("Could not get doge rigidBody");return p.gravityScale=h,u}},{key:"spawnSpider",value:function(e,t){var n=ne(this.spiderPrefab);return n instanceof L?(n.name=Rs.SPIDER,n.setPosition(e,t),this.addObject(n),n):null}},{key:"spawnBigBee",value:function(e,t){var n=ne(this.bigBeePrefab);return n instanceof L?(n.name=Rs.BIG_BEE,n.setPosition(e,t),this.addObject(n),n):null}},{key:"reviveBigBees",value:function(){var e,t=this.node.getComponentsInChildren(ju),n=r(t);try{for(n.s();!(e=n.n()).done;){e.value.state=As.ATTACKING}}catch(e){n.e(e)}finally{n.f()}}},{key:"spawnBrick",value:function(e){if(!this.batchObjects.isBrickInitialized){var t=this.spawnBrickNormal(e);if(!t)return null;var n=t.getComponent(Qu);return n?(this.batchObjects.isBrickInitialized=!0,n.useBatch&&this.batchObjects.assignMainBrickComponent(n),this.addObject(t),t):null}return this.batchObjects.isBrickBatchingEnabled()?(this.batchObjects.updateBrickPolygon(e),null):this.spawnBrickNormal(e)}},{key:"spawnBrickNormal",value:function(e){var t=ne(this.brickPrefab);return t instanceof L?(t.name=Rs.BRICK,t.attr({polygon:e}),this.addObject(t),t):null}},{key:"spawnWood",value:function(e){var t=ne(this.woodPrefab);if(!(t instanceof L))return null;t.name=Rs.WOOD;var n=t.getComponent(gc);if(!n)return console.warn("Pattern not found"),null;n.savePolygonPoints(e.map((function(e){return{x:e.x,y:e.y}}))),this.addObject(t),n.draw(e),n.applyCollider(e),n.setRigidBodyType(V.Dynamic);var i=this.spawnWoodStroke(e);return i.setParent(t,!1),t.addChild(i),t}},{key:"spawnWoodStroke",value:function(e){var t=new L;t.name=Rs.WOOD_STROKE,t.layer=33554432,this.addObject(t);var n=t.addComponent(D);n.lineWidth=4;var i=new I;I.fromHEX(i,"#0d0d15"),n.strokeColor=i;var a=e[0];if(!a)return t;n.moveTo(a.x,a.y);var o,s=r(e.slice(1));try{for(s.s();!(o=s.n()).done;){var l=o.value;n.lineTo(l.x,l.y)}}catch(e){s.e(e)}finally{s.f()}return n.close(),n.stroke(),t}},{key:"spawnGrass",value:function(e,t){if(!this.batchObjects.isGrassInitialized){var n=this.spawnGrassNormal(e,!1);if(!n)return null;var i=n.getComponent(Nh);return i?(this.batchObjects.isGrassInitialized=!0,i.useBatch&&this.batchObjects.assignMainGrassComponent(i),this.addObject(n),n):null}var a=t?Rs.GRASS_DARK:Rs.GRASS;return this.batchObjects.isGrassBatchingEnabled()?(this.batchObjects.updateGrassPolygon(a,e),null):this.spawnGrassNormal(e,t)}},{key:"spawnGrassNormal",value:function(e,t){var n=ne(this.grassPrefab);return n instanceof L?(n.name=t?Rs.GRASS_DARK:Rs.GRASS,n.attr({polygon:e,isDark:t}),this.addObject(n),n):null}},{key:"spawnPoison",value:function(e){if(!this.batchPoisonPool)return this.spawnPoisonNormal(e);if(!this.batchObjects.isPoisonInitialized){var t=ne(this.arenaPrefab);if(!(t instanceof L))return null;t.name=Rs.POISON,this.addObject(t);var n=t.addComponent(Cc);return n.useBatch=!0,this.batchObjects.isPoisonInitialized=!0,this.batchObjects.assignMainPoisonComponent(n),this.batchObjects.updatePoisonPolygon(e),t}return this.batchObjects.updatePoisonPolygon(e),null}},{key:"spawnPoisonNormal",value:function(e){var t=ne(this.arenaPrefab);return t instanceof L?(t.name=Rs.POISON,this.addObject(t),t.addComponent(Cc).polygon=e,t):null}},{key:"spawnPoisonSurface",value:function(e){if(!this.batchPoisonPool)return this.spawnPoisonSurfaceNormal(e);if(!this.batchObjects.isPoisonSurfaceInitialized){var t=ne(this.arenaPrefab);if(!(t instanceof L))return null;t.name=Rs.POISON_SURFACE,this.addObject(t);var n=t.addComponent(Ec);return n.useBatch=!0,this.batchObjects.isPoisonSurfaceInitialized=!0,this.batchObjects.assignMainPoisonSurfaceComponent(n),this.batchObjects.updatePoisonSurfacePolygon(e),t}return this.batchObjects.updatePoisonSurfacePolygon(e),null}},{key:"spawnPoisonSurfaceNormal",value:function(e){var t=ne(this.arenaPrefab);return t instanceof L?(t.name=Rs.POISON_SURFACE,this.addObject(t),t.addComponent(Ec).polygon=e,t):null}},{key:"spawnWater",value:function(e){if(!this.batchWaterPool)return this.spawnWaterNormal(e);if(!this.batchObjects.isWaterInitialized){var t=ne(this.arenaPrefab);if(!(t instanceof L))return null;t.name=Rs.WATER,this.addObject(t);var n=t.addComponent(Rc);return n.useBatch=!0,t.addComponent(O).opacity=.75,this.batchObjects.isWaterInitialized=!0,this.batchObjects.assignMainWaterComponent(n),this.batchObjects.updateWaterPolygon(e),t}return this.batchObjects.updateWaterPolygon(e),null}},{key:"spawnWaterNormal",value:function(e){var t=ne(this.arenaPrefab);return t instanceof L?(t.name=Rs.WATER,this.addObject(t),t.addComponent(Rc).polygon=e,t.addComponent(O).opacity=.75,t):null}},{key:"spawnDangerAreaNormal",value:function(e){var t=ne(this.arenaPrefab);if(!(t instanceof L))return null;t.name=Rs.DANGER_AREA;var n=t.getComponent(dc);if(!n)return console.warn("GraphicsPattern not found"),null;this.addObject(t),n.setColor("#fc03036d"),n.draw(e);var i=t.addComponent(W);return i.type=V.Static,i.group=Fs.DEFAULT,t.addComponent(oe),n.applyCollider(e),t}},{key:"spawnWaterSurface",value:function(e,t){var n=new L;return n.name=Rs.WATER_SURFACE,n.layer=this.node.layer,n.setPosition(e,t),this.loadWaterSurfaceSprite(n),this.addObject(n),n}},{key:"loadWaterSurfaceSprite",value:(s=e((function*(e){try{var t=yield ze.loadSpriteFrameAsync(zs.WATER_SURFACE_FRAME);if(!e.isValid)throw new Error("loadWaterSurfaceSprite: WaterSurface is not valid");if(!t)throw new Error("loadWaterSurfaceSprite: SpriteFrame not found");e.addComponent(E).spriteFrame=t}catch(e){var n=e instanceof Error?e:new Error(String(e));console.warn("loadWaterSurfaceSprite",n)}})),function(e){return s.apply(this,arguments)})},{key:"spawnThorn",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=ne(this.thornPrefab);return i instanceof L?(i.name=Rs.THORN,i.angle=n,i.setPosition(e,t),this.addObject(i),i):null}},{key:"spawnThornBall",value:function(e,t){var n=ne(this.thornBallPrefab);return n instanceof L?(n.name=Rs.THORN_BALL,n.setPosition(e,t),this.addObject(n),n):null}},{key:"spawnAirFan",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=ne(this.airFanPrefab);if(!(i instanceof L))return null;i.name=Rs.AIR_FAN,i.angle=n,i.setScale(this.normalizeAngle(n)>180?-1:1,1),i.setPosition(e,t),i.attr({id:Ns.AIR_FAN});var a=i.getComponent(Zs);return a?(a.setForceDirection(n),this.addObject(i),i):(console.warn("AirFan not found"),null)}},{key:"spawnCollider",value:function(e,t,n){var i=new L;i.name=Rs.COLLIDER,this.addObject(i),i.setPosition(e,t);var a=i.addComponent(W);a.type=V.Static,a.group=Fs.MAIN_OBJECT;var o=i.addComponent(oe);return o.restitution=.2,o.points=n.map((function(e){var t=e.x,n=e.y;return new K(t,n)})),o.apply(),i}},{key:"spawnLine",value:function(e){if(!this.batchMapLines)return this.spawnLineNormal(e);if(!this.batchObjects.isLineInitialized){var t=this.spawnLineNormal(e);if(!t)return null;this.addObject(t);var n=t.getComponent(zh);return n?(this.batchObjects.isLineInitialized=!0,this.batchObjects.assignMainLineComponent(n),t):null}return this.batchObjects.updateMapLine(e),null}},{key:"spawnLineNormal",value:function(e){var t=ne(this.mapLinePrefab);return t instanceof L?t.getComponent(zh)?(t.name=Rs.MAP_LINE,t.attr({polygon:e}),this.addObject(t),t):(console.warn("MapLine not found"),null):null}},{key:"spawnConnect",value:function(e,t,n){var i=this.getComponentsInChildren(gc).find((function(e){var t=e.getPolygonPoints();if(t.length===n.length){for(var i=0;i<n.length;i++){var a,o,r=null!==(a=t[i])&&void 0!==a?a:{x:0,y:0},s=(r.x,r.y,null!==(o=n[i])&&void 0!==o?o:{x:0,y:0});s.x,s.y}return!0}})),a=ne(this.connectPrefab);if(!(a instanceof L))return null;if(a.setPosition(e,t),this.node.insertChild(a,this.getSiblingIndex(a.name)),i){var o=a.getWorldPosition(),r=o.x,s=o.y,l=i.node.getWorldPosition(),u=l.x,c=l.y,h=a.getComponent(Q);h.connectedBody=i.node.getComponent(W),h.connectedAnchor=new K(r-u,s-c),h.enabled=!1,h.enabled=!0}}},{key:"spawnBalloon",value:function(e,t,n){var i=ne(this.balloonPrefab);if(!(i instanceof L))return null;i.name=Rs.BALLOON,i.setPosition(e,t);var a=i.getComponent(Cl);if(!a)return console.warn("Balloon not found"),null;var o=a.connectToDoge(n);return this.addObject(i),o&&this.addObject(o.node),i}},{key:"getRandomDogeToBee",value:function(){var e;if(!this.node.parent)return null;var t=this.node.parent.getComponentsInChildren(Ah),n=t.length;return null!==(e=t[Math.floor(Math.random()*n)])&&void 0!==e?e:null}},{key:"getNearestDogeToBee",value:function(e){var t;if(!this.node.parent)return null;var n=this.node.parent.getComponentsInChildren(Ah);return 0===(n=n.filter((function(e){return!e.isCantBeTargeted()}))).length?null:(n.sort((function(t,n){return K.distance(t.node.worldPosition,e.node.worldPosition)-K.distance(n.node.worldPosition,e.node.worldPosition)})),null!==(t=n[0])&&void 0!==t?t:null)}},{key:"getDoges",value:function(e){if(!this.node.parent)return[];var t=this.node.parent.getComponentsInChildren(Ah);return t=t.filter((function(t){return t!==e}))}},{key:"normalizeAngle",value:function(e){var t=e%360;return t<0?360+t:t}}]),p}(k)).prototype,"dogePrefab",[Uh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),hp=s(up.prototype,"spiderPrefab",[Hh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pp=s(up.prototype,"beePrefab",[jh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),dp=s(up.prototype,"beehivePrefab",[Vh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),yp=s(up.prototype,"bigBeePrefab",[Wh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),vp=s(up.prototype,"thornPrefab",[qh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),fp=s(up.prototype,"thornBallPrefab",[Kh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),mp=s(up.prototype,"airFanPrefab",[Yh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),gp=s(up.prototype,"grassPrefab",[Jh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),bp=s(up.prototype,"balloonPrefab",[Zh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Sp=s(up.prototype,"brickPrefab",[Xh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),kp=s(up.prototype,"arenaPrefab",[Qh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Cp=s(up.prototype,"woodPrefab",[$h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),wp=s(up.prototype,"connectPrefab",[ep],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ep=s(up.prototype,"mapLinePrefab",[tp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Tp=s(up.prototype,"crossingBeeLinePrefab",[np],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ap=s(up.prototype,"batchMapLines",[ip],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Rp=s(up.prototype,"batchPoisonPool",[ap],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Pp=s(up.prototype,"batchPoisonSurface",[op],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),_p=s(up.prototype,"batchWaterPool",[rp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Bp=s(up.prototype,"batchDangerArea",[sp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),lp=up))||lp);v._RF.pop(),v._RF.push({},"97f21hkFElI0YdBDCgAkt9+","Hint",void 0);var zp,Mp,xp,Up,Hp,jp=(0,m.ccclass)("Hint")(Ip=function(o){t(u,o);var s,l=n(u);function u(){var e;i(this,u);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=l.call.apply(l,[this].concat(n))).hintLine=null,e.hintHand=null,e.isHintShown=!1,e}return a(u,[{key:"showHint",value:function(e,t){this.isHintShown||(this.isHintShown=!0,this.hintLine=this.createHintLine(),this.hintLine.active=!0,this.drawHintLine(this.hintLine,e),t&&this.showHand(e))}},{key:"drawHintLine",value:function(e,t){var n=e.getComponent(D);if(!n)throw new Error("drawHintLine: Graphics is null");n.clear();var i=t[0];if(i){n.moveTo(i.x,i.y);var a,o=r(t.slice(1));try{for(o.s();!(a=o.n()).done;){var s=a.value;n.lineTo(s.x,s.y)}}catch(e){o.e(e)}finally{o.f()}n.stroke()}}},{key:"hideHint",value:function(){this.hintLine&&(this.hintLine.active=!1),this.hintHand&&(se.stopAllByTarget(this.hintHand),this.hintHand.active=!1)}},{key:"showHand",value:(s=e((function*(e){this.hintHand=this.createHintHand(e);var t=yield ze.loadSpriteFrameAsync(zs.IC_HAND_FRAME);t?(this.addSpriteToHand(t),this.runHandHintAnimation(e)):this.removeHintHand()})),function(e){return s.apply(this,arguments)})},{key:"addSpriteToHand",value:function(e){var t;this.hintHand&&(this.hintHand.addComponent(E).spriteFrame=e,null===(t=this.hintHand.getComponent(x))||void 0===t||t.setAnchorPoint(.15,.9))}},{key:"runHandHintAnimation",value:function(e){var t=this;if(this.hintHand){for(var n=le(this.hintHand),i=[],a=1;a<e.length;a++){var o=e[a-1],r=e[a];if(o&&r){var s=o.x-r.x,l=o.y-r.y,u=Math.sqrt(s*s+l*l),c=le(this.hintHand).to(u/250,{position:new _(r.x,r.y)});i.push(c)}}var h=le(this.hintHand).delay(.5).call((function(){var n=e[0];n&&t.hintHand&&t.hintHand.setPosition(n.x,n.y)}));i.push(h),n.sequence.apply(n,i).repeatForever().start()}}},{key:"getIsHintShow",value:function(){return this.isHintShown}},{key:"reset",value:function(){this.isHintShown=!1,this.removeHintLine(),this.removeHintHand()}},{key:"createHintLine",value:function(){if(this.hintLine)return this.hintLine;var e=new L,t=e.addComponent(D);t.lineWidth=10,t.lineCap=D.LineCap.ROUND,t.lineJoin=D.LineJoin.ROUND;var n=new I;return I.fromHEX(n,"#fc03036d"),t.strokeColor=n,this.node.insertChild(e,0),e}},{key:"createHintHand",value:function(e){if(this.hintHand)return this.hintHand;var t=new L,n=e[0];return n?(t.setPosition(n.x,n.y),this.hintHand=t,this.node.addChild(t),t):t}},{key:"removeHintLine",value:function(){this.hintLine&&(this.hintLine.getComponent(D).clear(),this.hintLine.destroyAllChildren(),this.hintLine.removeAllChildren(),this.hintLine.destroy(),this.hintLine=null)}},{key:"removeHintHand",value:function(){this.hintHand&&(this.hintHand.destroyAllChildren(),this.hintHand.removeAllChildren(),this.hintHand.destroy(),this.hintHand=null)}}]),u}(k))||Ip;v._RF.pop(),v._RF.push({},"33281kEO4dMXLCvmfkrwqQM","CollisionDetectLine",void 0);var Vp,Wp,qp,Kp,Yp,Jp,Zp,Xp,Qp,$p,ed=m.ccclass,td=m.property,nd=(zp=ed("CollisionDetectLine"),Mp=td(D),zp((Hp=s((Up=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"graphic",Hp,u(e)),e}return a(r,[{key:"onLoad",value:function(){this.graphic=this.getComponent(D),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"drawFromTo",value:function(e,t){this.graphic.clear(),this.graphic.moveTo(e.x,e.y),this.graphic.lineTo(t.x,t.y),this.graphic.stroke()}}]),r}(qs)).prototype,"graphic",[Mp],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xp=Up))||xp);v._RF.pop(),v._RF.push({},"00eeawrUitLxLgSANaGHhcv","LineDrawer",void 0);var id=m.ccclass,ad=m.property,od=m.executionOrder,rd=(Vp=id("LineDrawer"),Wp=od(3),qp=ad(te),Kp=ad(te),Yp=ad(S),Vp(Jp=Wp((Xp=s((Zp=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"linePrefab",Xp,u(e)),l(e,"collisionDetectLinePrefab",Qp,u(e)),l(e,"minDistance",$p,u(e)),e.lastUIPos=null,e.currentLine=null,e.collisionDetectLine=null,e.isColliding=!1,e}return a(r,[{key:"beginDraw",value:function(e){this.createLine(),this.createCollisionDetectLine(),this.initLine(),this.lastUIPos=null,this.isColliding=!1,this.draw(e)}},{key:"createLine",value:function(){var e=ne(this.linePrefab);e instanceof L&&(e.name=Rs.DRAW_LINE,e.getComponent(D)&&(this.node.addChild(e),this.currentLine=e))}},{key:"createCollisionDetectLine",value:function(){if(this.currentLine){var e=ne(this.collisionDetectLinePrefab);if(e instanceof L){var t=e.getComponent(D);if(t){var n=this.currentLine.getComponent(D);if(n){var i=n.lineWidth,a=n.strokeColor;t.strokeColor=new I(a.r,a.g,a.b,128),t.lineWidth=i,this.node.addChild(e),this.collisionDetectLine=e}}}}}},{key:"initLine",value:function(){var e,t=null===(e=this.currentLine)||void 0===e?void 0:e.getComponent($l);t&&(t.sleep(),t.init())}},{key:"draw",value:function(e){var t,n,i=this;if(e&&this.currentLine&&this.collisionDetectLine){var a=this.currentLine.getComponent($l);if(a){var o=this.collisionDetectLine.getComponent(nd);if(o){var r=new _;null===(t=this.node.parent)||void 0===t||t.inverseTransformPoint(r,new _(e.x,e.y));var s=new K(r.x,r.y);if(this.isPointOverlapWithMap(e)){if(this.lastUIPos){var l=this.lastUIPos,u=l.x,c=l.y;this.node.inverseTransformPoint(r,new _(u,c));var h=new K(r.x,r.y);if(this.isColliding)o.drawFromTo(h,s);else{var p,d=this.isCurrentLineOverlapWithMap(e,this.lastUIPos);if(d.sort((function(e,t){return null==i.lastUIPos?0:K.distance(e.point,i.lastUIPos)-K.distance(t.point,i.lastUIPos)})),!(null===(p=d[0])||void 0===p?void 0:p.point))return;this.isColliding=!0}}}else if(this.lastUIPos&&this.isCurrentLineOverlapWithMap(e,this.lastUIPos).length>0){var y=this.lastUIPos,v=y.x,f=y.y;this.node.inverseTransformPoint(r,new _(v,f));var m=new K(r.x,r.y);o.drawFromTo(m,s)}else{if(!this.lastUIPos){this.lastUIPos=e.clone();var g=s.x,b=s.y;a.storePoints(g,b)}var S=this.lastUIPos,k=S.x,C=S.y;null===(n=this.node.parent)||void 0===n||n.inverseTransformPoint(r,new _(k,C));var w=new K(r.x,r.y),E=w.x,T=w.y,A=s.x,R=s.y,P=E-A,B=T-R;if(!(P*P+B*B<this.minDistance*this.minDistance)){var L=Math.sqrt(P*P+B*B);this.lastUIPos=e.clone(),a.drawTo(E,T,A,R),a.storePoints(A,R);var O=this.collisionDetectLine.getComponent(D);return null==O||O.clear(),this.isColliding=!1,L}}}}}}},{key:"isPointOverlapWithMap",value:function(e){return this.getCollision(e).length>0}},{key:"isCurrentLineOverlapWithMap",value:function(e,t){var n=this.getParallelLines(t,e,2),i=n.leftLine,a=n.rightLine,o=ce.instance.raycast(t,e,he.All).filter((function(e){return!e.collider.sensor})).filter((function(e){var t;return"rope"!==(null===(t=e.collider.node.parent)||void 0===t?void 0:t.name)})),r=ce.instance.raycast(i.p1,i.p2,he.All).filter((function(e){return!e.collider.sensor})).filter((function(e){var t;return"rope"!==(null===(t=e.collider.node.parent)||void 0===t?void 0:t.name)})),s=ce.instance.raycast(a.p1,a.p2,he.All).filter((function(e){return!e.collider.sensor})).filter((function(e){var t;return"rope"!==(null===(t=e.collider.node.parent)||void 0===t?void 0:t.name)}));return[].concat(c(o),c(r),c(s))}},{key:"endDraw",value:function(){if(this.currentLine&&this.collisionDetectLine){var e=this.currentLine.getComponent($l);if(e){e.addPhysics(),e.wake();var t=this.collisionDetectLine.getComponent(D);t?(t.clear(),this.lastUIPos=null,this.isColliding=!1,this.currentLine=null):console.warn("Graphics component not found")}else console.warn("Line component not found")}}},{key:"deActivePhysics",value:function(){var e,t=null===(e=this.currentLine)||void 0===e?void 0:e.getComponent($l);t&&(
//! do not sort, it will cause bug
t.deActiveColliders(),t.sleep())}},{key:"clearLines",value:function(){this.node.destroyAllChildren(),this.node.removeAllChildren()}},{key:"getParallelLines",value:function(e,t,n){var i=t.x-e.x,a=t.y-e.y,o=Z.Vec2.distance(e,t),r=i/o,s=a/o,l=new K(e.x-s*n,e.y+r*n),u=new K(e.x+s*n,e.y-r*n);return{leftLine:{p1:l,p2:new K(l.x+i,l.y+a)},rightLine:{p1:u,p2:new K(u.x+i,u.y+a)}}}},{key:"getCollision",value:function(e){return ce.instance.testAABB(new Z.Rect(e.x-2,e.y-2,4,4)).filter((function(e){return!e.sensor})).filter((function(e){var t;return"rope"!==(null===(t=e.node.parent)||void 0===t?void 0:t.name)})).filter((function(t){if(t instanceof oe){var n=new _;return t.node.inverseTransformPoint(n,new _(e.x,e.y)),pe.polygonCircle(t.points,new K(n.x,n.y),2)}if(t instanceof ie){var i=t.node.getWorldPosition(),a=i.x,o=i.y;return pe.circleCircle(new K(a,o+t.worldPosition.y),t.radius,new K(e.x,e.y),2)}return!t.sensor}))}}]),r}(k)).prototype,"linePrefab",[qp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Qp=s(Zp.prototype,"collisionDetectLinePrefab",[Kp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$p=s(Zp.prototype,"minDistance",[Yp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),Jp=Zp))||Jp)||Jp);v._RF.pop(),v._RF.push({},"463cfEelRVL4KYgc4n5FJNz","Map",void 0);var sd,ld=[{id:1,map:1,type:1},{id:2,map:2,type:1},{id:3,map:3,type:1},{id:4,map:8,type:1},{id:5,map:9,type:1},{id:6,map:16,type:1},{id:7,map:4,type:1},{id:8,map:7,type:1},{id:9,map:6,type:1},{id:10,map:18,type:1},{id:11,map:10,type:2},{id:12,map:11,type:2},{id:13,map:12,type:2},{id:14,map:13,type:2},{id:15,map:14,type:2},{id:16,map:15,type:2},{id:17,map:5,type:2},{id:18,map:17,type:2},{id:19,map:19,type:2},{id:20,map:20,type:2},{id:21,map:21,type:3},{id:22,map:22,type:3},{id:23,map:23,type:3},{id:24,map:24,type:3},{id:25,map:25,type:3},{id:26,map:26,type:3},{id:27,map:27,type:3},{id:28,map:28,type:3},{id:29,map:29,type:3},{id:30,map:30,type:3},{id:31,map:31,type:4},{id:32,map:32,type:4},{id:33,map:33,type:4},{id:34,map:34,type:4},{id:35,map:35,type:4},{id:36,map:36,type:4},{id:37,map:37,type:4},{id:38,map:38,type:4},{id:39,map:39,type:4},{id:40,map:40,type:4},{id:41,map:41,type:5},{id:42,map:42,type:5},{id:43,map:43,type:5},{id:44,map:44,type:5},{id:45,map:45,type:5},{id:46,map:46,type:5},{id:47,map:47,type:5},{id:48,map:48,type:5},{id:49,map:49,type:5},{id:50,map:50,type:5},{id:51,map:51,type:6},{id:52,map:52,type:6},{id:53,map:53,type:6},{id:54,map:54,type:6},{id:55,map:55,type:6},{id:56,map:56,type:6},{id:57,map:57,type:6},{id:58,map:58,type:6},{id:59,map:59,type:6},{id:60,map:60,type:6},{id:61,map:61,type:7},{id:62,map:62,type:7},{id:63,map:63,type:7},{id:64,map:64,type:7},{id:65,map:65,type:7},{id:66,map:66,type:7},{id:67,map:67,type:7},{id:68,map:68,type:7},{id:69,map:69,type:7},{id:70,map:70,type:7},{id:71,map:71,type:8},{id:72,map:72,type:8},{id:73,map:73,type:8},{id:74,map:74,type:8},{id:75,map:75,type:8},{id:76,map:76,type:8},{id:77,map:77,type:8},{id:78,map:78,type:8},{id:79,map:79,type:8},{id:80,map:80,type:8},{id:81,map:81,type:9},{id:82,map:82,type:9},{id:83,map:83,type:9},{id:84,map:84,type:9},{id:85,map:85,type:9},{id:86,map:86,type:9},{id:87,map:87,type:9},{id:88,map:88,type:9},{id:89,map:89,type:9},{id:90,map:90,type:9},{id:91,map:91,type:10},{id:92,map:92,type:10},{id:93,map:93,type:10},{id:94,map:94,type:10},{id:95,map:95,type:10},{id:96,map:96,type:10},{id:97,map:97,type:10},{id:98,map:98,type:10},{id:99,map:99,type:10},{id:100,map:100,type:10},{id:101,map:101,type:11},{id:102,map:102,type:11},{id:103,map:103,type:11},{id:104,map:104,type:11},{id:105,map:105,type:11},{id:106,map:106,type:11},{id:107,map:107,type:11},{id:108,map:108,type:11},{id:109,map:109,type:11},{id:110,map:110,type:11},{id:111,map:111,type:12},{id:112,map:112,type:12},{id:113,map:113,type:12},{id:114,map:114,type:12},{id:115,map:115,type:12},{id:116,map:116,type:12},{id:117,map:117,type:12},{id:118,map:118,type:12},{id:119,map:119,type:12},{id:120,map:120,type:12},{id:121,map:121,type:13},{id:122,map:122,type:13},{id:123,map:123,type:13},{id:124,map:124,type:13},{id:125,map:125,type:13},{id:126,map:126,type:13},{id:127,map:127,type:13},{id:128,map:128,type:13},{id:129,map:129,type:13},{id:130,map:130,type:13},{id:131,map:131,type:14},{id:132,map:132,type:14},{id:133,map:133,type:14},{id:134,map:134,type:14},{id:135,map:135,type:14},{id:136,map:136,type:14},{id:137,map:137,type:14},{id:138,map:138,type:14},{id:139,map:139,type:14},{id:140,map:140,type:14},{id:141,map:141,type:15},{id:142,map:142,type:15},{id:143,map:143,type:15},{id:144,map:144,type:15},{id:145,map:145,type:15},{id:146,map:146,type:15},{id:147,map:147,type:15},{id:148,map:148,type:15},{id:149,map:149,type:15},{id:150,map:150,type:15},{id:151,map:184,type:16},{id:152,map:185,type:16},{id:153,map:186,type:16},{id:154,map:187,type:16},{id:155,map:188,type:16},{id:156,map:189,type:16},{id:157,map:190,type:16},{id:158,map:191,type:16},{id:159,map:192,type:16},{id:160,map:193,type:16},{id:161,map:194,type:17},{id:162,map:195,type:17},{id:163,map:196,type:17},{id:164,map:197,type:17},{id:165,map:198,type:17},{id:166,map:199,type:17},{id:167,map:200,type:17},{id:168,map:167,type:17},{id:169,map:168,type:17},{id:170,map:169,type:17},{id:171,map:170,type:18},{id:172,map:171,type:18},{id:173,map:172,type:18},{id:174,map:173,type:18},{id:175,map:174,type:18},{id:176,map:175,type:18},{id:177,map:176,type:18},{id:178,map:177,type:18},{id:179,map:178,type:18},{id:180,map:179,type:18},{id:181,map:180,type:19},{id:182,map:181,type:19},{id:183,map:182,type:19},{id:184,map:183,type:19},{id:185,map:151,type:19},{id:186,map:152,type:19},{id:187,map:153,type:19},{id:188,map:154,type:19},{id:189,map:155,type:19},{id:190,map:156,type:19},{id:191,map:157,type:20},{id:192,map:158,type:20},{id:193,map:159,type:20},{id:194,map:160,type:20},{id:195,map:161,type:20},{id:196,map:162,type:20},{id:197,map:163,type:20},{id:198,map:164,type:20},{id:199,map:165,type:20},{id:200,map:166,type:20},{id:201,map:201,type:21},{id:202,map:202,type:21},{id:203,map:203,type:21},{id:204,map:204,type:21},{id:205,map:205,type:21},{id:206,map:206,type:21},{id:207,map:207,type:21},{id:208,map:208,type:21},{id:209,map:209,type:21},{id:210,map:210,type:21},{id:211,map:211,type:22},{id:212,map:212,type:22},{id:213,map:213,type:22},{id:214,map:214,type:22},{id:215,map:215,type:22},{id:216,map:216,type:22},{id:217,map:217,type:22},{id:218,map:218,type:22},{id:219,map:219,type:22},{id:220,map:220,type:22},{id:221,map:221,type:23},{id:222,map:222,type:23},{id:223,map:223,type:23},{id:224,map:224,type:23},{id:225,map:225,type:23},{id:226,map:226,type:23},{id:227,map:227,type:23},{id:228,map:228,type:23},{id:229,map:229,type:23},{id:230,map:230,type:23},{id:231,map:231,type:24},{id:232,map:232,type:24},{id:233,map:233,type:24},{id:234,map:234,type:24},{id:235,map:235,type:24},{id:236,map:236,type:24},{id:237,map:237,type:24},{id:238,map:238,type:24},{id:239,map:239,type:24},{id:240,map:240,type:24},{id:241,map:241,type:25},{id:242,map:242,type:25},{id:243,map:243,type:25},{id:244,map:244,type:25},{id:245,map:245,type:25},{id:246,map:246,type:25},{id:247,map:247,type:25},{id:248,map:248,type:25},{id:249,map:249,type:25},{id:250,map:250,type:25},{id:251,map:251,type:26},{id:252,map:252,type:26},{id:253,map:253,type:26},{id:254,map:254,type:26},{id:255,map:255,type:26},{id:256,map:256,type:26},{id:257,map:257,type:26},{id:258,map:258,type:26},{id:259,map:259,type:26},{id:260,map:260,type:26},{id:261,map:261,type:27},{id:262,map:262,type:27},{id:263,map:263,type:27},{id:264,map:264,type:27},{id:265,map:265,type:27},{id:266,map:266,type:27},{id:267,map:267,type:27},{id:268,map:268,type:27},{id:269,map:269,type:27},{id:270,map:270,type:27},{id:271,map:271,type:28},{id:272,map:272,type:28},{id:273,map:273,type:28},{id:274,map:274,type:28},{id:275,map:275,type:28},{id:276,map:276,type:28},{id:277,map:277,type:28},{id:278,map:278,type:28},{id:279,map:279,type:28},{id:280,map:280,type:28},{id:281,map:281,type:29},{id:282,map:282,type:29},{id:283,map:283,type:29},{id:284,map:284,type:29},{id:285,map:285,type:29},{id:286,map:286,type:29},{id:287,map:287,type:29},{id:288,map:288,type:29},{id:289,map:289,type:29},{id:290,map:290,type:29},{id:291,map:291,type:30},{id:292,map:292,type:30},{id:293,map:293,type:30},{id:294,map:294,type:30},{id:295,map:295,type:30},{id:296,map:296,type:30},{id:297,map:297,type:30},{id:298,map:298,type:30},{id:299,map:299,type:30},{id:300,map:300,type:30},{id:301,map:301,type:31},{id:302,map:302,type:31},{id:303,map:303,type:31},{id:304,map:304,type:31},{id:305,map:305,type:31},{id:306,map:306,type:31},{id:307,map:307,type:31},{id:308,map:308,type:31},{id:309,map:309,type:31},{id:310,map:310,type:31},{id:311,map:311,type:32},{id:312,map:312,type:32},{id:313,map:313,type:32},{id:314,map:314,type:32},{id:315,map:315,type:32},{id:316,map:316,type:32},{id:317,map:317,type:32},{id:318,map:318,type:32},{id:319,map:319,type:32},{id:320,map:320,type:32},{id:321,map:321,type:33},{id:322,map:322,type:33},{id:323,map:323,type:33},{id:324,map:324,type:33},{id:325,map:325,type:33}];v._RF.pop(),v._RF.push({},"45df2RUUZZNhaXqOADOV0HC","MapLoader",void 0);var ud,cd=m.ccclass,hd=gs,pd=bs,dd=cd("MapLoader")(sd=function(o){t(l,o);var r,s=n(l);function l(){return i(this,l),s.apply(this,arguments)}return a(l,[{key:"paddingZero",value:function(e,t){return Array(t-e.length).fill("0").join("")+e}},{key:"getMapByLevel",value:function(e){var t=e;if(e>hd){var n,i=pd.length;t=null!==(n=pd[(e-hd)%i-1])&&void 0!==n?n:1}var a=ld.find((function(e){return e.id===t}));return console.log("Map:",t),a?a.map:1}},{key:"getMapJsonPath",value:function(e){var t=this.getMapByLevel(e),n=this.paddingZero(t.toString(),3);return"".concat(zs.MAP_JSON_PREFIX).concat(n)}},{key:"preloadLevel",value:function(e){var t=this.getMapJsonPath(e);ze.preloadJson(t)}},{key:"loadLevel",value:(r=e((function*(e,t){try{var n=this.getMapJsonPath(e);console.log("Loading level:",n);var i=yield ze.loadJsonAsync(n);if(!i)throw new Error("Failed to load JSON asset");null==t||t(null,i)}catch(e){var a=e instanceof Error?e:new Error(String(e));null==t||t(a,null)}})),function(e,t){return r.apply(this,arguments)})},{key:"isLevelAlreadyLoaded",value:function(e){var t=this.getMapJsonPath(e);return!!ze.getAsset(t,de)}}]),l}(k))||sd;v._RF.pop(),v._RF.push({},"8d3c7nuQGRNgpZcqAOCJY6O","InkCapacityController",void 0);var yd,vd=(0,m.ccclass)("InkCapacityController")(ud=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).maxInkLevel=0,e.currentInkLevel=0,e}return a(r,[{key:"init",value:function(e){var t=this.getDrawLength(e);this.maxInkLevel=t,this.currentInkLevel=t}},{key:"getCurrentInkLevel",value:function(){return Math.floor(this.currentInkLevel)}},{key:"removeInkLevel",value:function(e){var t=this.currentInkLevel-e;this.setInkLevel(t)}},{key:"setInkLevel",value:function(e){this.currentInkLevel=e,this.currentInkLevel<0&&(this.currentInkLevel=0),this.currentInkLevel>this.maxInkLevel&&(this.currentInkLevel=this.maxInkLevel)}},{key:"isInkEmpty",value:function(){return this.currentInkLevel<=0}},{key:"getInkLevelPercentage",value:function(){return this.currentInkLevel/this.maxInkLevel*100}},{key:"getStarRating",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=this.maxInkLevel/e,n=Math.ceil(this.getCurrentInkLevel()/t);return 0===n?1:n}},{key:"getDrawLength",value:function(e){for(var t=0,n=1;n<e.length;n++){var i=e[n-1],a=e[n],o=i.x-a.x,r=i.y-a.y;t+=Math.sqrt(o*o+r*r)}return 3*t}}]),r}(k))||ud;v._RF.pop(),v._RF.push({},"014cbNey8JEV4aPhDm9R5W4","InputController",void 0);var fd=(0,m.ccclass)("InputController")(yd=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).pointerDownOutSideCanvas=!1,e.handleElementPointerDown=function(){e.pointerDownOutSideCanvas=!0},e.handleElementPointerUp=function(t){e.onTouchEnd(),e.pointerDownOutSideCanvas=!1},e.onTouchStart=function(t){e.node.scene.emit(wl.GAME_START,{pointer:t})},e.onTouchMove=function(t){if(e.pointerDownOutSideCanvas)return e.node.scene.emit(wl.GAME_START,{pointer:t}),void(e.pointerDownOutSideCanvas=!1);e.node.scene.emit(wl.DRAWING,{pointer:t})},e.onTouchEnd=function(t){e.node.scene.emit(wl.BEE_ATTACK)},e}return a(r,[{key:"onLoad",value:function(){this.listenInputEvents()}},{key:"listenInputEvents",value:function(){G.os!==G.OS.WINDOWS&&G.os!==G.OS.OSX||(document.addEventListener("pointerup",this.handleElementPointerUp),document.addEventListener("pointerdown",this.handleElementPointerDown),this.node.on(L.EventType.MOUSE_DOWN,this.onTouchStart),this.node.on(L.EventType.MOUSE_MOVE,this.onTouchMove),this.node.on(L.EventType.MOUSE_UP,this.onTouchEnd)),this.node.on(L.EventType.TOUCH_START,this.onTouchStart),this.node.on(L.EventType.TOUCH_MOVE,this.onTouchMove),this.node.on(L.EventType.TOUCH_CANCEL,this.onTouchEnd),this.node.on(L.EventType.TOUCH_END,this.onTouchEnd)}},{key:"onDestroy",value:function(){G.os===G.OS.WINDOWS||G.os===G.OS.OSX?(document.removeEventListener("pointerup",this.handleElementPointerUp),document.removeEventListener("pointerdown",this.handleElementPointerDown),this.node.off(L.EventType.MOUSE_DOWN,this.onTouchStart),this.node.off(L.EventType.MOUSE_MOVE,this.onTouchMove),this.node.off(L.EventType.MOUSE_UP,this.onTouchEnd)):(this.node.off(L.EventType.TOUCH_START,this.onTouchStart),this.node.off(L.EventType.TOUCH_MOVE,this.onTouchMove),this.node.off(L.EventType.TOUCH_CANCEL,this.onTouchEnd),this.node.off(L.EventType.TOUCH_END,this.onTouchEnd))}}]),r}(k))||yd;v._RF.pop(),v._RF.push({},"e6116mseMNPD6VcLUtkvez6","BaseState",void 0);var md=function(){function e(t){if(i(this,e),this.game=null,this.data={},this.game=t.node.getComponent(Vf),!this.game)throw new Error("Gameplay component not found");this.manager=t,this.updateStateData(),this.logDebug()}return a(e,[{key:"logDebug",value:function(){var e=this.constructor.name;console.debug("[STATE] ".concat(e),this.data)}},{key:"updateStateData",value:function(){if(this.game){var e=this.game.getGameData();e&&(this.data=e)}}},{key:"updateGameData",value:function(e){var t;null===(t=this.game)||void 0===t||t.setGameData(e)}}]),e}();v._RF.pop(),v._RF.push({},"a79a7LT0s5BuZrk5mvYsyKr","AttackingState",void 0);var gd=function(e){t(r,e);var o=n(r);function r(e){var t;return i(this,r),(t=o.call(this,e)).stopHint(),t.stopDrawing(),t.wakeUpObjects(),t.spawnEnemies(),t.startCountdown(),Ve.turnDownMusic(),t}return a(r,[{key:"load",value:function(){var e=this.manager.createLoadingState();this.manager.change(e)}},{key:"initialize",value:function(){Ve.stopSound(qe.BEE_FLYING);var e=this.manager.createInitializeState();this.manager.change(e)}},{key:"ready",value:function(){}},{key:"draw",value:function(){}},{key:"attack",value:function(){}},{key:"escape",value:function(){var e=this.manager.createEscapeState();this.manager.change(e)}},{key:"death",value:function(){var e=this.manager.createDeathState();this.manager.change(e)}},{key:"finish",value:function(){}},{key:"update",value:function(){}},{key:"stopDrawing",value:function(){var e;null===(e=this.game)||void 0===e||null===(e=e.lineDrawer)||void 0===e||e.endDraw()}},{key:"stopHint",value:function(){var e;null===(e=this.game)||void 0===e||null===(e=e.hint)||void 0===e||e.hideHint()}},{key:"wakeUpObjects",value:function(){var e;null===(e=this.game)||void 0===e||null===(e=e.gameObjects)||void 0===e||e.wakeUpObjects()}},{key:"spawnEnemies",value:function(){this.game&&this.game.gameObjects&&(this.game.gameObjects.spawnBees(),this.game.gameObjects.reviveBigBees(),Ve.playSound(qe.BEE_FLYING),Ve.playSound(qe.END_DRAW))}},{key:"startCountdown",value:function(){var e;null===(e=this.game)||void 0===e||e.uiManager.startCountdown()}}]),r}(md);v._RF.pop(),v._RF.push({},"17461foCjdJ276bG2jcxA06","DeathState",void 0);var bd=globalThis.game.analytics,Sd=function(e){t(s,e);var o=n(s);function s(e){var t,n,a;return i(this,s),(a=o.call(this,e)).processCrazyGamesEvent(),a.disableUI(),Ve.stopAllSounds(),a.vibrateDevice(),a.pauseCountdown(),a.logLevelFailAnalytics(),null===(t=a.game)||void 0===t||t.scheduleOnce((function(){a.stopDogesLooking(),a.showUncompletedMark(),Ve.playSound(qe.LEVEL_FAIL,{volume:.3})}),.5),null===(n=a.game)||void 0===n||n.scheduleOnce((function(){a.sleepObjects(),a.showLoseScreen(),a.manager.finish()}),1.8),a}return a(s,[{key:"processCrazyGamesEvent",value:function(){"gameplayStop"in GameSDK.extra&&GameSDK.extra.gameplayStop()}},{key:"load",value:function(){}},{key:"initialize",value:function(){}},{key:"ready",value:function(){}},{key:"draw",value:function(){}},{key:"attack",value:function(){}},{key:"escape",value:function(){}},{key:"death",value:function(){}},{key:"finish",value:function(){var e=this.manager.createFinishState();this.manager.change(e)}},{key:"update",value:function(){}},{key:"disableUI",value:function(){var e,t;null===(e=this.game)||void 0===e||e.uiManager.disableUI(),null===(t=this.game)||void 0===t||t.hint.reset()}},{key:"sleepObjects",value:function(){var e,t;null===(e=this.game)||void 0===e||null===(e=e.lineDrawer)||void 0===e||e.deActivePhysics(),null===(t=this.game)||void 0===t||null===(t=t.gameObjects)||void 0===t||t.sleepObjects()}},{key:"pauseCountdown",value:function(){var e;null===(e=this.game)||void 0===e||e.uiManager.pauseCountdown()}},{key:"stopDogesLooking",value:function(){var e;if(null!==(e=this.game)&&void 0!==e&&e.gameObjects){var t,n=this.game.gameObjects.getComponentsInChildren(Ah),i=r(n);try{for(i.s();!(t=i.n()).done;){var a,o=t.value;null===(a=o.eyes)||void 0===a||a.stopLook(),o.setEnable(!1)}}catch(e){i.e(e)}finally{i.f()}}}},{key:"vibrateDevice",value:function(){var e;null===(e=ue("Vibrate"))||void 0===e||null===(e=e.getComponent(ms))||void 0===e||e.vibrate(500)}},{key:"showUncompletedMark",value:function(){var e;null===(e=this.game)||void 0===e||e.uiManager.showUncompletedMark()}},{key:"showLoseScreen",value:function(){var e=this.data.level;Ze.openScreen(Xe.LOSE_SCREEN,{level:e})}},{key:"logLevelFailAnalytics",value:function(){if(this.game){var e=this.game.inkCapacityController;if(e){var t=this.data.level,n=void 0===t?0:t,i=e.getStarRating();console.info("logLevelFailAnalytics",n,i),bd.levelFail(n,i,ws)}}}}]),s}(md);v._RF.pop(),v._RF.push({},"71778iMCmVDQKkpW1Ag0dZz","DrawingState",void 0);var kd=function(e){t(r,e);var o=n(r);function r(e){var t;return i(this,r),(t=o.call(this,e)).dist=0,t.isEmptyDraw=!1,t.initDrawer(),t}return a(r,[{key:"load",value:function(){}},{key:"initialize",value:function(){var e=this.manager.createInitializeState();this.manager.change(e)}},{key:"ready",value:function(){var e=this.manager.createReadyState();this.manager.change(e)}},{key:"draw",value:function(){}},{key:"attack",value:function(){var e,t,n;if(100===(null!==(e=null===(t=this.game)||void 0===t?void 0:t.inkCapacityController.getInkLevelPercentage())&&void 0!==e?e:0))return null===(n=this.game)||void 0===n||n.lineDrawer.endDraw(),void(this.isEmptyDraw=!0);var i=this.manager.createAttackingState();this.manager.change(i)}},{key:"escape",value:function(){}},{key:"death",value:function(){}},{key:"finish",value:function(){}},{key:"update",value:function(){var e;this.isInkEmpty()?null===(e=this.game)||void 0===e||e.node.scene.emit(wl.BEE_ATTACK):this.isEmptyDraw?this.manager.ready():(this.updateStateData(),this.drawLines(),this.updateInkLevel(),this.updateProgressBar())}},{key:"initDrawer",value:function(){var e;if(null!==(e=this.game)&&void 0!==e&&e.lineDrawer){var t=this.data.pointer.getUILocation();this.game.lineDrawer.beginDraw(t),Ve.playSound(qe.BUTTON_CLICK)}}},{key:"isInkEmpty",value:function(){return!!this.game&&this.game.inkCapacityController.isInkEmpty()}},{key:"drawLines",value:function(){var e,t;if(null!==(e=this.game)&&void 0!==e&&e.lineDrawer){var n=this.data.pointer.getUILocation();this.dist=null!==(t=this.game.lineDrawer.draw(n))&&void 0!==t?t:0,this.dist>0&&Ve.playSound(qe.TOUCH_START,{volume:.8})}}},{key:"updateInkLevel",value:function(){var e;null===(e=this.game)||void 0===e||e.inkCapacityController.removeInkLevel(this.dist)}},{key:"updateProgressBar",value:function(){if(this.game){var e=this.game.inkCapacityController.getStarRating();this.game.uiManager.setProgressStars(e);var t=this.game.inkCapacityController.getInkLevelPercentage();this.game.uiManager.setProgressBarPercentage(t)}}}]),r}(md);v._RF.pop(),v._RF.push({},"d600e+7dHhGOYCGrcOjxVcl","EscapeState",void 0);var Cd=globalThis.game,wd=Cd.player,Ed=Cd.analytics,Td=function(e){t(s,e);var o=n(s);function s(e){var t,n;return i(this,s),(n=o.call(this,e)).processCrazyGamesEvent(),n.disableUI(),n.stopAllSounds(),n.vibrateDevice(),n.makeDogesSmile(),n.pauseCountdown(),n.showCompletedMark(),n.updatePlayerProgress(),n.stopBeeBehavior(),n.logLevelCompleteAnalytics(),null===(t=n.game)||void 0===t||t.scheduleOnce((function(){n.sleepObjects(),n.showWiningScreen(),n.manager.finish()}),.5),Ve.playSound(qe.LEVEL_PASS),Ve.playSound(qe.BEE_FLYING),n}return a(s,[{key:"processCrazyGamesEvent",value:function(){"gameplayStop"in GameSDK.extra&&GameSDK.extra.gameplayStop()}},{key:"load",value:function(){}},{key:"initialize",value:function(){}},{key:"ready",value:function(){}},{key:"draw",value:function(){}},{key:"attack",value:function(){}},{key:"escape",value:function(){}},{key:"death",value:function(){}},{key:"finish",value:function(){var e=this.manager.createFinishState();this.manager.change(e)}},{key:"update",value:function(){}},{key:"disableUI",value:function(){var e,t;null===(e=this.game)||void 0===e||e.uiManager.disableUI(),null===(t=this.game)||void 0===t||t.hint.reset()}},{key:"stopBeeBehavior",value:function(){var e;null===(e=this.game)||void 0===e||null===(e=e.gameObjects)||void 0===e||e.stopBeeBehavior()}},{key:"sleepObjects",value:function(){var e,t;null===(e=this.game)||void 0===e||null===(e=e.lineDrawer)||void 0===e||e.deActivePhysics(),null===(t=this.game)||void 0===t||null===(t=t.gameObjects)||void 0===t||t.sleepObjects()}},{key:"stopAllSounds",value:function(){Ve.stopAllSounds()}},{key:"makeDogesSmile",value:function(){var e;if(null!==(e=this.game)&&void 0!==e&&e.gameObjects){var t,n=this.game.gameObjects.getComponentsInChildren(Ah),i=r(n);try{for(i.s();!(t=i.n()).done;){var a=t.value;a.smile(),a.setEnable(!1)}}catch(e){i.e(e)}finally{i.f()}}}},{key:"vibrateDevice",value:function(){var e;null===(e=ue("Vibrate"))||void 0===e||null===(e=e.getComponent(ms))||void 0===e||e.vibrate(500)}},{key:"pauseCountdown",value:function(){var e;null===(e=this.game)||void 0===e||e.uiManager.pauseCountdown()}},{key:"showCompletedMark",value:function(){var e;null===(e=this.game)||void 0===e||e.uiManager.showCompletedMark()}},{key:"updatePlayerProgress",value:function(){if(this.game){var e=this.data.level;if(e){var t=wd.getGameData();if(t){var n=d({},t);e<t.level&&(n.level=e+1),wd.setGameData(n)}}}}},{key:"showWiningScreen",value:function(){if(this.game){var e=this.data.level,t=this.game.inkCapacityController.getStarRating();Ze.openScreen(Xe.WINNING_SCREEN,{level:e,stars:t})}}},{key:"logLevelCompleteAnalytics",value:function(){if(this.game){var e=this.game.inkCapacityController;if(e){var t=this.data.level,n=void 0===t?0:t,i=e.getStarRating();console.info("logLevelCompleteAnalytics",n,i),Ed.levelComplete(n,i,ws)}}}}]),s}(md);v._RF.pop(),v._RF.push({},"9046etpNclOb7EjoNvbF/aZ","MatchUtils",void 0);var Ad=GameCore,Rd=Ad.Match,Pd=Ad.Utils,_d=Pd.Object,Bd=Pd.Valid,Ld=Pd.String,Od=globalThis.game,Dd=Od.match,Id=Od.player,Nd=Od.leaderboard,Fd=function(){function t(){i(this,t)}var n,o,r,s,l,u,c,h,p,d,y,v,f,m,g,b,S,k,C;return a(t,[{key:"processStartSingleModeAsync",value:(C=e((function*(){var e=Id.getPlayerId();yield Dd.single.start.processAsync({playerId:e})})),function(){return C.apply(this,arguments)})},{key:"processFinishSingleModeAsync",value:(k=e((function*(){yield Dd.single.finish.processAsync()})),function(){return k.apply(this,arguments)})},{key:"processStartTournamentModeAsync",value:(S=e((function*(){var e=Id.getPlayerId(),t=GameSDK.context.getID();yield Dd.tournament.continue.processAsync({playerId:e,contextId:t})})),function(){return S.apply(this,arguments)})},{key:"processFinishTournamentModeAsync",value:(b=e((function*(){var e=Id.getPlayerId(),t=Id.getBestScore();yield Dd.tournament.finish.processAsync({playerId:e,bestScore:t})})),function(){return b.apply(this,arguments)})},{key:"processStartChallengeModeAsync",value:(g=e((function*(){try{yield this.processContinueChallengeAsync()}catch(e){if(!_d.hasOwn(e,"name")||Bd.isString(e.name))throw e;"PlayerHasFinishedMatch"===e.name&&(yield this.processChallengeNewOpponentAsync()),"PlayerNotJoinInMatch"===e.name&&(yield this.processJoinChallengeAsync())}})),function(){return g.apply(this,arguments)})},{key:"processFinishChallengeModeAsync",value:(m=e((function*(){yield Dd.challenge.finish.processAsync()})),function(){return m.apply(this,arguments)})},{key:"processContinueChallengeAsync",value:(f=e((function*(){var e=this.getMatchState(),t=e.id,n=e.customData,i=n.playerId,a=n.opponentId;if(!Bd.isString(t))throw new Error("Invalid match id");if(!Bd.isString(i))throw new Error("Invalid player id");if(!Bd.isString(a))throw new Error("Invalid opponent id");var o=GameSDK.context.getID();if(!o)throw new Error("Cannot get contextId");yield Dd.challenge.continue.processAsync({matchId:t,contextId:o,playerId:i,opponentId:a})})),function(){return f.apply(this,arguments)})},{key:"processChallengeNewOpponentAsync",value:(v=e((function*(){var e=Id.getConnectedPlayerIds(100,0),t=Math.floor(Math.random()*e.length),n=Id.getPlayerId(),i=e[t];if(!Bd.isString(i)||Bd.isEmpty(i))throw new Error("Invalid opponent id");yield Dd.challenge.friend.processAsync({playerId:n,opponentId:i})})),function(){return v.apply(this,arguments)})},{key:"processJoinChallengeAsync",value:(y=e((function*(){var e=this.getMatchState(),t=e.id,n=e.customData,i=n.playerId,a=n.opponentId;if(!Bd.isString(t))throw new Error("Invalid match id");if(!Bd.isString(i))throw new Error("Invalid player id");if(!Bd.isString(a))throw new Error("Invalid opponent id");yield Dd.challenge.join.processAsync({matchId:t,playerId:i,opponentId:a})})),function(){return y.apply(this,arguments)})},{key:"getMatchState",value:function(){var e=Dd.getMatchState();if(!e)throw new Error("Match state not found");return e}},{key:"getMatchMode",value:function(){var e=this.getMatchState();return Bd.isString(e.mode)?e.mode:null}},{key:"getTournamentsAsync",value:(d=e((function*(){try{return yield GameSDK.tournament.getTournamentsAsync()}catch(e){return console.error(e),[]}})),function(){return d.apply(this,arguments)})},{key:"createTournamentPayload",value:function(){var e,t,n=Ld.generateObjectId(),i=Id.getPlayerId(),a=this.getMatchState().profiles;return{score:null!==(e=null===(t=(void 0===a?{}:a)[i])||void 0===t?void 0:t.score)&&void 0!==e?e:0,playerId:i,mode:Rd.Modes.TOURNAMENT,name:this.createTournamentName(),leaderboardId:n,payload:{playerId:i,leaderboardId:n}}}},{key:"createTournamentName",value:function(){var e=Id.getPlayer().name,t=void 0===e?null:e;if(t){var n=t.substring(0,7),i="".concat(n.split(" ")[0]||n,"'s Tournament"),a=Ld.removeDiacritics(i);return"".concat(a)}return"Tournament"}}],[{key:"inst",get:function(){return this._instance||(this._instance=new t),this._instance}},{key:"startMatchAsync",value:(p=e((function*(e){try{var t=null!=e?e:this.inst.getMatchMode(),n=Rd.Modes;switch(t){case n.SINGLE:yield this.inst.processStartSingleModeAsync();break;case n.TOURNAMENT:yield this.inst.processStartTournamentModeAsync();break;case n.CHALLENGE_FRIEND:yield this.inst.processStartChallengeModeAsync();break;default:yield this.inst.processStartSingleModeAsync()}}catch(e){console.warn("startMatchAsync",e)}})),function(e){return p.apply(this,arguments)})},{key:"setProfileMatchDataAsync",value:(h=e((function*(e){try{yield Dd.handler.setProfileData(e)}catch(e){console.warn("setProfileMatchDataAsync",e)}})),function(e){return h.apply(this,arguments)})},{key:"setMatchCustomDataAsync",value:(c=e((function*(e){try{yield Dd.handler.setMatchCustomData(e)}catch(e){console.warn("setMatchCustomDataAsync",e)}})),function(e){return c.apply(this,arguments)})},{key:"getMatchCustomDataAsync",value:(u=e((function*(){try{yield Dd.handler.getMatchCustomData()}catch(e){console.warn("getMatchCustomDataAsync",e)}})),function(){return u.apply(this,arguments)})},{key:"setLeaderboardScoreAsync",value:(l=e((function*(e){try{yield Dd.handler.setLeaderboardScore(e)}catch(e){console.warn("setLeaderboardScoreAsync",e)}})),function(e){return l.apply(this,arguments)})},{key:"finishMatchAsync",value:(s=e((function*(){try{var e=this.inst.getMatchMode(),t=GameCore.Match.Modes;switch(e){case t.SINGLE:yield this.inst.processFinishSingleModeAsync();break;case t.TOURNAMENT:yield this.inst.processFinishTournamentModeAsync();break;case t.CHALLENGE_FRIEND:yield this.inst.processFinishChallengeModeAsync();break;default:yield this.inst.processFinishSingleModeAsync()}}catch(e){console.warn("finishMatchAsync",e)}})),function(){return s.apply(this,arguments)})},{key:"createTournamentAsync",value:(r=e((function*(){var e=!1;if((yield this.inst.getTournamentsAsync()).find((function(e){var t,n=JSON.parse(null!==(t=e.getPayload())&&void 0!==t?t:"{}");return"DEFAULT"===e.getTournamentType()&&n.playerId===Id.getPlayerId()})))return!1;var t=this.inst.createTournamentPayload();try{yield Dd.tournament.create.processAsync(t);var n=t.leaderboardId;Nd.addLeaderboard({name:n,type:"tournament",autoSortRank:!0,leaderboardId:n}),e=!0}catch(e){console.warn("processCreateTournament",e)}return e})),function(){return r.apply(this,arguments)})},{key:"joinTournamentAsync",value:(o=e((function*(e){var t=Id.getPlayerId();yield Dd.tournament.join.processAsync({tournamentId:e,playerId:t})})),function(e){return o.apply(this,arguments)})},{key:"continueTournamentAsync",value:(n=e((function*(e){var t=Id.getPlayerId();yield Dd.tournament.continue.processAsync({playerId:t,contextId:e})})),function(e){return n.apply(this,arguments)})}]),t}();v._RF.pop(),v._RF.push({},"a9bc11SkV9L/5L+Y+fhswfJ","FinishState",void 0);var Gd=globalThis.game.player,zd=function(o){t(l,o);var r,s=n(l);function l(e){var t;return i(this,l),t=s.call(this,e),Ve.turnUpMusic(),Ve.stopSound(qe.BEE_FLYING),t.finishGameAsync(),t}return a(l,[{key:"load",value:function(){var e=this.manager.createLoadingState();this.manager.change(e)}},{key:"initialize",value:function(){var e=this.manager.createInitializeState();this.manager.change(e)}},{key:"ready",value:function(){}},{key:"draw",value:function(){}},{key:"attack",value:function(){}},{key:"escape",value:function(){}},{key:"death",value:function(){}},{key:"finish",value:function(){}},{key:"update",value:function(){}},{key:"finishGameAsync",value:(r=e((function*(){try{if(!this.game)return;var e=this.game.inkCapacityController;if(!e)return;var t=this.data.level,n=1e3*(void 0===t?0:t)+100*e.getStarRating(),i=Gd.getBestScore();"submitGameResultsAsync"in GameSDK.extra&&GameSDK.extra.submitGameResultsAsync(i),i<n&&Gd.setBestScore(n),yield Fd.finishMatchAsync()}catch(e){console.error("finishGameAsync",e)}})),function(){return r.apply(this,arguments)})}]),l}(md);v._RF.pop(),v._RF.push({},"37a5cRy3ANBGpVlH3wyS3Ra","InitializeState",void 0);var Md=globalThis.game.analytics,xd=function(o){t(u,o);var r,s,l=n(u);function u(e){var t,n;return i(this,u),n=l.call(this,e),"CrazyGames"===GameSDK.getSDKName()&&n.processCrazyGamesRequirements(),n.enableUI(),n.disableHintButtonForEarlyLevels(),n.clearHint(),n.clearGameObjects(),n.createGameObjects(),n.initInkCapacity(),n.initCountdown(),n.updateHeader(),n.showTutorialUI(),Ve.playMusic(),null===(t=n.game)||void 0===t||t.handleGamePromotions(),n.startGameAsync().then((function(){n.closeLoadingScreen(),n.manager.ready(),n.logLevelStartAnalytics()})),n}return a(u,[{key:"processCrazyGamesRequirements",value:function(){"gameplayStart"in GameSDK.extra&&GameSDK.extra.gameplayStart(),this.showInterAdsCrazyGames()}},{key:"disableHintButtonForEarlyLevels",value:function(){if(this.game){var e=this.data.level;e&&e<=3&&this.game.uiManager.disableHintButton()}}},{key:"showInterAdsCrazyGames",value:(s=e((function*(){this.game&&(Ve.stopAllSounds(),(yield Qe.showInterstitialAdAsync({forLevel:this.data.level,includeSDK:["CrazyGames"]}))&&this.game.disableRewardAdsItemForCrazyGames(),Ve.turnUpMusic())})),function(){return s.apply(this,arguments)})},{key:"load",value:function(){if(GameCore.Utils.Valid.isDebugger()){var e=this.manager.createLoadingState();this.manager.change(e)}}},{key:"initialize",value:function(){}},{key:"ready",value:function(){var e=this.manager.createReadyState();this.manager.change(e)}},{key:"draw",value:function(){}},{key:"attack",value:function(){}},{key:"escape",value:function(){var e=this.manager.createEscapeState();this.manager.change(e)}},{key:"death",value:function(){var e=this.manager.createDeathState();this.manager.change(e)}},{key:"finish",value:function(){}},{key:"update",value:function(){}},{key:"closeLoadingScreen",value:function(){Ze.closeScreen(Xe.LOADING_SCREEN)}},{key:"enableUI",value:function(){var e;null===(e=this.game)||void 0===e||e.uiManager.enableUI()}},{key:"clearHint",value:function(){var e;null===(e=this.game)||void 0===e||null===(e=e.hint)||void 0===e||e.reset()}},{key:"clearGameObjects",value:function(){var e,t;null!==(e=this.game)&&void 0!==e&&e.lineDrawer&&null!==(t=this.game)&&void 0!==t&&t.gameObjects&&(this.game.lineDrawer.clearLines(),this.game.gameObjects.clearObjects())}},{key:"createGameObjects",value:function(){var e,t=this.data.levelData;t&&(null===(e=this.game)||void 0===e||null===(e=e.gameObjects)||void 0===e||e.spawnObjects(t))}},{key:"initInkCapacity",value:function(){if(this.game){var e=this.data.levelData;if(e){var t=this.game.inkCapacityController,n=e.lnk,i=void 0===n?[]:n;t.init(i)}}}},{key:"initCountdown",value:function(){var e;null===(e=this.game)||void 0===e||e.uiManager.initCountdown()}},{key:"updateHeader",value:function(){var e;if(null!==(e=this.game)&&void 0!==e&&e.hint){var t=this.game.inkCapacityController.getStarRating();this.game.uiManager.setProgressStars(t);var n=this.game.inkCapacityController.getInkLevelPercentage();this.game.uiManager.setProgressBarPercentage(n),this.game.hint.getIsHintShow()||this.game.uiManager.startCountDownHeaderHintBubbleAnim()}}},{key:"showTutorialUI",value:function(){var e,t;if(this.game){var n=this.data,i=n.level,a=n.levelData;if(i&&a&&!(i>3)&&null!==(e=this.game)&&void 0!==e&&e.hint&&null!==(t=this.game)&&void 0!==t&&t.uiManager){var o=a.tips,r=Dp.transformPointsFromMapToDrawAreaCoordinate(o);this.game.hint.showHint(r,!0),this.game.uiManager.stopCountDownHeaderHintBubbleAnim()}}}},{key:"startGameAsync",value:(r=e((function*(){try{if(this.data.isFromLoader)return void this.updateGameData({isFromLoader:!1});yield Fd.startMatchAsync()}catch(e){console.error("startGameAsync",e)}})),function(){return r.apply(this,arguments)})},{key:"logLevelStartAnalytics",value:function(){if(this.game){var e=this.data.level,t=void 0===e?0:e,n=this.game.inkCapacityController.getStarRating();Md.levelStart(t,n)}}}]),u}(md);v._RF.pop(),v._RF.push({},"f98e6wIKqZGv7aAVsWH1sS+","MapUtils",void 0);var Ud=gs,Hd=bs,jd=375,Vd=function(){function e(){i(this,e)}return a(e,null,[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"isMapFlippedHorizontally",value:function(e){var t=e-Ud;if(t<=0)return!1;var n=Hd.length;return Math.floor(t/n)%2==0}},{key:"getTransformedMapPoints",value:function(e){return e.map((function(e){var t=e.data;if(t&&void 0!==t.a&&(t.a*=-1),Array.isArray(e.point)){var n=e.id===Ns.WOOD||e.id===Ns.COLLIDER?Dp.getTransformedDoublePolygon(e.point):Dp.getTransformedPolygon(e.point);return d(d({},e),{},{point:n})}var i=e.point;return d(d({},e),{},{point:Dp.getTransformedPoint(i)})}))}},{key:"getTransformedTips",value:function(e){return e.map((function(e){return Dp.getTransformedPoint(e)}))}},{key:"revertTransformedMapPoints",value:function(e){return e.map((function(e){if(Array.isArray(e.point)){var t=e.id===Ns.WOOD||e.id===Ns.COLLIDER?Dp.revertTransformedDoublePolygon(e.point):Dp.revertTransformedPolygon(e.point);return d(d({},e),{},{point:t})}var n=e.point;return d(d({},e),{},{point:Dp.revertTransformedPoint(n)})}))}},{key:"revertTransformedTips",value:function(e){return e.map((function(e){return Dp.revertTransformedPoint(e)}))}},{key:"flipMapDataHorizontally",value:function(t){var n=t.map,i=t.tips,a=t.lnk,o=1/0,r=-1/0,s=[],l=e.getTransformedMapPoints(n),u=e.getTransformedTips(i);return l.forEach((function(e){Array.isArray(e.point)?e.point.forEach((function(e){s.push(e)})):s.push(e.point)})),u.forEach((function(e){s.push(e)})),s.forEach((function(e){e.x<o&&(o=e.x),e.x>r&&(r=e.x)})),l.forEach((function(e){Array.isArray(e.point)?e.point.forEach((function(e){e.x=e.x-2*(e.x-jd)})):e.point.x=e.point.x-2*(e.point.x-jd)})),u.forEach((function(e){e.x=e.x-2*(e.x-jd)})),a.forEach((function(e){e.x=e.x-2*(e.x-jd)})),{map:e.revertTransformedMapPoints(l),tips:e.revertTransformedTips(u),lnk:a}}}]),e}();v._RF.pop(),v._RF.push({},"a8496IbdA1EnY7sv4ApuaJW","LoadingState",void 0);var Wd=function(e){t(r,e);var o=n(r);function r(e){var t;return i(this,r),(t=o.call(this,e)).handleMapLoaded=function(e,n){if(!e&&n){var i,a,o=t.data.level,r=n.json,s=null!=o?o:1;if(Vd.isMapFlippedHorizontally(s)){var l=Vd.flipMapDataHorizontally(r);t.updateGameData({levelData:l})}else t.updateGameData({levelData:r});if(o)null===(i=t.game)||void 0===i||null===(i=i.gameMap)||void 0===i||i.preloadLevel(o+1);
//! wait until loading screen open then ready to reduce stuttering
if(t.loadingScreenFlag)null===(a=t.game)||void 0===a||a.scheduleOnce((function(){t.initialize()}),.5);else t.initialize()}else console.error("Failed to load level",e)},t.loadingScreenFlag=!t.isLevelAlreadyLoaded(),t.loadingScreenFlag&&Ze.showLoadingScreen(),t.stopHint(),t.loadGameMap(),t.updateLevelText(),t}return a(r,[{key:"load",value:function(){}},{key:"initialize",value:function(){var e=this.manager.createInitializeState();this.manager.change(e)}},{key:"ready",value:function(){}},{key:"draw",value:function(){}},{key:"attack",value:function(){}},{key:"escape",value:function(){}},{key:"death",value:function(){}},{key:"finish",value:function(){}},{key:"update",value:function(){}},{key:"isLevelAlreadyLoaded",value:function(){var e,t,n=this.data.level;if(!n)throw new Error("Level is not defined");return null!==(e=null===(t=this.game)||void 0===t||null===(t=t.gameMap)||void 0===t?void 0:t.isLevelAlreadyLoaded(n))&&void 0!==e&&e}},{key:"stopHint",value:function(){var e;null===(e=this.game)||void 0===e||null===(e=e.hint)||void 0===e||e.hideHint()}},{key:"loadGameMap",value:function(){var e,t=this.data.level;if(!t)throw new Error("Level is not defined");null===(e=this.game)||void 0===e||null===(e=e.gameMap)||void 0===e||e.loadLevel(t,this.handleMapLoaded)}},{key:"updateLevelText",value:function(){var e,t=this.data.level;t&&(null===(e=this.game)||void 0===e||e.uiManager.setLevelText(t))}}]),r}(md);v._RF.pop(),v._RF.push({},"5ef69tJ5eNNv7o22H/XfSD2","ReadyState",void 0);var qd,Kd=function(e){t(r,e);var o=n(r);function r(){return i(this,r),o.apply(this,arguments)}return a(r,[{key:"load",value:function(){if(GameCore.Utils.Valid.isDebugger()){var e=this.manager.createLoadingState();this.manager.change(e)}}},{key:"initialize",value:function(){}},{key:"ready",value:function(){}},{key:"draw",value:function(){var e=this.manager.createDrawingState();this.manager.change(e)}},{key:"attack",value:function(){}},{key:"escape",value:function(){var e=this.manager.createEscapeState();this.manager.change(e)}},{key:"death",value:function(){if(GameCore.Utils.Valid.isDebugger()){var e=this.manager.createDeathState();this.manager.change(e)}}},{key:"finish",value:function(){}},{key:"update",value:function(){}}]),r}(md);v._RF.pop(),v._RF.push({},"bb0e3beWSxOOLCv7gjyg2s0","StateManager",void 0);var Yd,Jd,Zd,Xd,Qd,$d,ey,ty,ny,iy,ay,oy,ry,sy,ly,uy=(0,m.ccclass)("StateManager")(qd=function(e){t(r,e);var o=n(r);function r(){return i(this,r),o.apply(this,arguments)}return a(r,[{key:"init",value:function(){this.state=new Wd(this)}},{key:"change",value:function(e){this.state=e}},{key:"load",value:function(){this.state&&this.state.load()}},{key:"initialize",value:function(){this.state&&this.state.initialize()}},{key:"isInitialize",value:function(){return this.state instanceof xd}},{key:"ready",value:function(){this.state&&this.state.ready()}},{key:"isReady",value:function(){return this.state instanceof Kd}},{key:"draw",value:function(){this.state&&this.state.draw()}},{key:"isDrawing",value:function(){return this.state instanceof kd}},{key:"attack",value:function(){this.state&&this.state.attack()}},{key:"isAttacking",value:function(){return this.state instanceof gd}},{key:"escape",value:function(){this.state&&this.state.escape()}},{key:"isSurviving",value:function(){return this.state instanceof Td}},{key:"death",value:function(){this.state&&this.state.death()}},{key:"isFailed",value:function(){return this.state instanceof Sd}},{key:"finish",value:function(){this.state&&this.state.finish()}},{key:"isFinished",value:function(){return this.state instanceof zd}},{key:"update",value:function(e){this.state&&this.state.update(e)}},{key:"createInitializeState",value:function(){return new xd(this)}},{key:"createLoadingState",value:function(){return new Wd(this)}},{key:"createReadyState",value:function(){return new Kd(this)}},{key:"createDrawingState",value:function(){return new kd(this)}},{key:"createAttackingState",value:function(){return new gd(this)}},{key:"createEscapeState",value:function(){return new Td(this)}},{key:"createDeathState",value:function(){return new Sd(this)}},{key:"createFinishState",value:function(){return new zd(this)}}]),r}(k))||qd;v._RF.pop(),v._RF.push({},"9e40aEq56tMKLFoeACyl+eH","Clock",void 0);var cy,hy,py,dy,yy,vy,fy,my,gy=m.ccclass,by=m.disallowMultiple,Sy=m.property,ky=(Yd=gy("Clock"),Jd=Sy(N),Zd=Sy(L),Xd=Sy(E),Qd=Sy(L),$d=Sy(L),ey=Sy(g),Yd(ty=by((iy=s((ny=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"timeText",iy,u(e)),l(e,"clockContainer",ay,u(e)),l(e,"clockFill",oy,u(e)),l(e,"successIcon",ry,u(e)),l(e,"failIcon",sy,u(e)),l(e,"animation",ly,u(e)),e.time=0,e.remaining=0,e.running=!1,e.timeShake=0,e.remainingToShake=0,e.handleUpdateConfig=function(t){e.enabled&&e.setTime(t.WaitForPassSecs)},e}return a(r,[{key:"__preload",value:function(){this.listenEvents()}},{key:"start",value:function(){this.init(),this.setTime(6),this.setTimeToShake(1)}},{key:"init",value:function(){this.remaining=0,this.running=!1,this.node.active=!1}},{key:"listenEvents",value:function(){this.node.scene.on(Me.GAMEPLAY_UPDATE_CONFIG,this.handleUpdateConfig)}},{key:"setTime",value:function(e){this.time=e,this.timeText.string=Math.ceil(e).toString()}},{key:"setTimeToShake",value:function(e){this.timeShake=e,this.remainingToShake=0}},{key:"startCountdown",value:function(){this.running=!0,this.remaining=this.time,this.remainingToShake=this.timeShake,this.node.active=!0,this.failIcon.active=!1,this.successIcon.active=!1}},{key:"pause",value:function(){this.running=!1}},{key:"resume",value:function(){this.running=!0}},{key:"showUncompletedMark",value:function(){this.failIcon.active=!0,le(this.failIcon).set({scale:new _(0,0,1)}).to(.5,{scale:new _(1,1,1)},{easing:"smooth"}).start()}},{key:"showCompletedMark",value:function(){this.successIcon.active=!0,le(this.successIcon).set({scale:new _(0,0,1)}).to(.5,{scale:new _(1,1,1)},{easing:"smooth"}).start()}},{key:"endCountDown",value:function(){this.running=!1,this.node.scene.emit(wl.TIME_OUT)}},{key:"update",value:function(e){this.running&&(this.remaining<=0?this.endCountDown():(this.remainingToShake<=0&&(this.playShakeAnimation(),this.remainingToShake=this.timeShake),this.remaining-=e,this.remainingToShake-=e,this.updateLabel(),this.clockFill.fillRange=this.remaining/this.time))}},{key:"updateLabel",value:function(){var e=Math.ceil(this.remaining).toString();this.timeText.string=e}},{key:"playShakeAnimation",value:function(){var e="Shake";this.animation.clips.some((function(t){return!(!t||t.name!==e)}))?this.animation.play(e):console.warn("SettingsScreen: clip not found")}}]),r}(k)).prototype,"timeText",[Jd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ay=s(ny.prototype,"clockContainer",[Zd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oy=s(ny.prototype,"clockFill",[Xd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ry=s(ny.prototype,"successIcon",[Qd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sy=s(ny.prototype,"failIcon",[$d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ly=s(ny.prototype,"animation",[ey],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ty=ny))||ty)||ty);v._RF.pop(),v._RF.push({},"7c115t9HKlH6ZfnhCnLAnpe","Star",void 0);var Cy,wy,Ey,Ty,Ay,Ry,Py,_y,By,Ly,Oy,Dy=m.ccclass,Iy=m.property,Ny=m.requireComponent,Fy=(cy=Dy("Star"),hy=Ny(g),py=Iy(k),dy=Iy(g),cy(yy=hy((fy=s((vy=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"starAppearance",fy,u(e)),l(e,"animation",my,u(e)),e.isAppear=!1,e.initialPosition=new _,e}return a(r,[{key:"onLoad",value:function(){this.initialPosition=this.node.position.clone(),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"resetPosition",value:function(){this.node.setPosition(this.initialPosition)}},{key:"show",value:function(){this.starAppearance.node.active=!0,this.isAppear=!0}},{key:"hide",value:function(){this.starAppearance.node.active=!1,this.isAppear=!1}},{key:"playAnimation",value:function(){this.animation.stop();this.animation.clips.some((function(e){return!(!e||"UpAndDown"!==e.name)}))?this.animation.play("UpAndDown"):console.warn("SettingsScreen: clip not found")}},{key:"stopAnimation",value:function(){this.animation.stop()}}]),r}(k)).prototype,"starAppearance",[py],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),my=s(vy.prototype,"animation",[dy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yy=vy))||yy)||yy);v._RF.pop(),v._RF.push({},"09f0bRvi+1OQZiIGBFqdNzq","LevelProgressBar",void 0);var Gy,zy,My,xy,Uy,Hy,jy,Vy,Wy,qy,Ky,Yy,Jy,Zy,Xy,Qy,$y,ev=m.ccclass,tv=m.property,nv=(Cy=ev("LevelProgressBar"),wy=tv(ye),Ey=tv(Fy),Ty=tv(Fy),Ay=tv(Fy),Cy((_y=s((Py=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"progressBar",_y,u(e)),l(e,"leftStar",By,u(e)),l(e,"midStar",Ly,u(e)),l(e,"rightStar",Oy,u(e)),e.toProgress=1,e.progressStep=0,e}return a(r,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"start",value:function(){this.toProgress=1,this.progressStep=0,this.runStartsAnimation()}},{key:"update",value:function(){var e=this.progressBar.getComponent(E);e&&(this.progressBar.progress>=1?e.type=E.Type.SIMPLE:e.type=E.Type.TILED),this.progressBar.progress-this.progressStep<this.toProgress?this.progressBar.progress!==this.toProgress&&(this.progressBar.progress=this.toProgress):this.progressBar.progress-=this.progressStep}},{key:"runStartsAnimation",value:function(){this.leftStar.isAppear&&this.midStar.isAppear&&this.rightStar.isAppear||(this.leftStar.show(),this.midStar.show(),this.rightStar.show(),this.runStarAnimation(this.leftStar),this.runStarAnimation(this.midStar),this.runStarAnimation(this.rightStar))}},{key:"runStarAnimation",value:function(e){e.resetPosition(),e.playAnimation()}},{key:"stopStarAnimation",value:function(e){e.isAppear&&(e.hide(),e.stopAnimation(),e.resetPosition(),Ve.playSound(qe.LOST_STAR_IN_GAMEPLAY))}},{key:"setProgress",value:function(e){this.toProgress=e/100,this.progressStep=(this.progressBar.progress-this.toProgress)/60*16}},{key:"setStars",value:function(e){switch(e){case 1:this.stopStarAnimation(this.rightStar),this.stopStarAnimation(this.midStar);break;case 2:this.stopStarAnimation(this.rightStar);break;default:this.runStartsAnimation()}}},{key:"reset",value:function(){this.progressBar.progress=1}}]),r}(k)).prototype,"progressBar",[wy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),By=s(Py.prototype,"leftStar",[Ey],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ly=s(Py.prototype,"midStar",[Ty],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oy=s(Py.prototype,"rightStar",[Ay],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ry=Py))||Ry);v._RF.pop(),v._RF.push({},"61791zAr2tJR4p22EZ5QRfk","Header",void 0);var iv,av,ov,rv,sv,lv,uv,cv,hv,pv,dv,yv,vv,fv,mv,gv,bv,Sv,kv,Cv,wv,Ev,Tv,Av,Rv,Pv,_v,Bv,Lv,Ov,Dv,Iv,Nv,Fv,Gv,zv,Mv,xv,Uv,Hv,jv,Vv,Wv,qv,Kv,Yv,Jv,Zv,Xv,Qv,$v,ef,tf,nf=m.ccclass,af=m.property,of=globalThis.game,rf=of.language,sf=of.player,lf=(Gy=nf("Header"),zy=af(N),My=af(nv),xy=af(Ft),Uy=af(L),Hy=af(L),jy=af(L),Vy=af(L),Gy((Ky=s((qy=function(o){t(h,o);var r,s,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=c.call.apply(c,[this].concat(n)),l(e,"levelText",Ky,u(e)),l(e,"levelProgressBar",Yy,u(e)),l(e,"hintBubbleAnim",Jy,u(e)),l(e,"pauseNode",Zy,u(e)),l(e,"replayNode",Xy,u(e)),l(e,"hintNode",Qy,u(e)),l(e,"skipNode",$y,u(e)),e.handlePlayBubble=function(){e.hintBubbleAnim.play(),e.startCountDownHintBubble()},e}return a(h,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"handleClickedPauseGame",value:function(){this.showSettingScreen(),this.node.scene.emit(wl.GAME_PAUSE)}},{key:"handleClickedReplayGame",value:function(){var e,t=(null!==(e=sf.getGameData())&&void 0!==e?e:{}).level,n=void 0===t?1:t;this.node.scene.emit(wl.GAME_REPLAY,{level:n})}},{key:"handleClickedHintGame",value:function(){this.node.scene.emit(wl.SHOW_HINT)}},{key:"handleClickedSkipLevel",value:(s=e((function*(){this.node.scene.emit(wl.SKIP_LEVEL)})),function(){return s.apply(this,arguments)})},{key:"showSettingScreen",value:function(){Ze.openScreen(Xe.SETTINGS_SCREEN,{})}},{key:"setLevelText",value:(r=e((function*(e){var t=yield rf.getText("level");this.levelText.string="".concat(t," ").concat(e)})),function(e){return r.apply(this,arguments)})},{key:"setProgress",value:function(e){this.levelProgressBar.setProgress(e)}},{key:"setProgressStars",value:function(e){this.levelProgressBar.setStars(e)}},{key:"startCountDownHintBubble",value:function(){this.schedule(this.handlePlayBubble,30)}},{key:"stopCountDownHintBubble",value:function(){this.unschedule(this.handlePlayBubble)}},{key:"disableButtons",value:function(){this.enableBtnNode(this.pauseNode,!1,!0),this.enableBtnNode(this.replayNode,!1,!0),this.enableBtnNode(this.hintNode,!1,!0),this.enableBtnNode(this.skipNode,!1,!0)}},{key:"enableButtons",value:function(){this.enableBtnNode(this.pauseNode,!0,!0),this.enableBtnNode(this.replayNode,!0,!0),this.enableBtnNode(this.hintNode,!0,!0),this.enableBtnNode(this.skipNode,!0,!0)}},{key:"disableRewardAdsButton",value:function(){this.enableBtnNode(this.hintNode,!1,!1),this.enableBtnNode(this.skipNode,!1,!1)}},{key:"disableHintButton",value:function(){this.enableBtnNode(this.hintNode,!1,!0)}},{key:"enableBtnNode",value:function(e,t,n){var i=e.getComponent(A);if(i&&(i.interactable=t),e.active=n,n){var a=e.getComponent(ii);a&&a.changeState(t)}}}]),h}(k)).prototype,"levelText",[zy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yy=s(qy.prototype,"levelProgressBar",[My],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jy=s(qy.prototype,"hintBubbleAnim",[xy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zy=s(qy.prototype,"pauseNode",[Uy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xy=s(qy.prototype,"replayNode",[Hy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qy=s(qy.prototype,"hintNode",[jy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$y=s(qy.prototype,"skipNode",[Vy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wy=qy))||Wy);v._RF.pop(),v._RF.push({},"151afQBVDpOYpTjtwP+wYH+","DevTools",void 0);var uf,cf,hf,pf,df,yf,vf,ff,mf,gf=m.ccclass,bf=m.property,Sf=(iv=gf("DevToolsContainer"),av=bf(L),ov=bf(L),rv=bf(L),sv=bf(L),lv=bf(L),uv=bf(L),cv=bf(L),hv=bf(L),pv=bf(L),dv=bf(L),yv=bf(L),vv=bf(L),fv=bf(L),mv=bf(L),gv=bf(L),bv=bf(L),Sv=bf(L),kv=bf(L),Cv=bf(L),wv=bf(L),Ev=bf(L),Tv=bf(L),Av=bf(L),Rv=bf(L),Pv=bf(L),iv((Lv=s((Bv=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"devToolsButton",Lv,u(e)),l(e,"winLevelButton",Ov,u(e)),l(e,"loseLevelButton",Dv,u(e)),l(e,"buildVersionButton",Iv,u(e)),l(e,"prevLevelButton",Nv,u(e)),l(e,"nextLevelButton",Fv,u(e)),l(e,"selectLevelButton",Gv,u(e)),l(e,"hintButton",zv,u(e)),l(e,"physicButton",Mv,u(e)),l(e,"bundleButton",xv,u(e)),l(e,"beehiveButton",Uv,u(e)),l(e,"dogeButton",Hv,u(e)),l(e,"thornBallButton",jv,u(e)),l(e,"bigBeeButton",Vv,u(e)),l(e,"thornButton",Wv,u(e)),l(e,"airFanButton",qv,u(e)),l(e,"brickButton",Kv,u(e)),l(e,"grassButton",Yv,u(e)),l(e,"grassDarkButton",Jv,u(e)),l(e,"lineButton",Zv,u(e)),l(e,"poisonButton",Xv,u(e)),l(e,"poisonSurfaceButton",Qv,u(e)),l(e,"waterButton",$v,u(e)),l(e,"dangerAreaButton",ef,u(e)),l(e,"dashboardButton",tf,u(e)),e.isActive=!0,e.gameplay=null,e.gameObjects=null,e.currentSpawnObjId=-1,e.handleClickDashboardButton=function(){$e.switchToDashboardScene()},e.handleClickDevToolsButton=function(){e.isActive?(e.hideAllButtons(),e.isActive=!1):(e.showAllButtons(),e.isActive=!0)},e.handleClickPrevLevelButton=function(){var t=e.getCurrentLevel();t&&e.node.scene.emit(wl.SELECT_LEVEL,{level:t-1})},e.handleClickNextLevelButton=function(){var t=e.getCurrentLevel();t&&e.node.scene.emit(wl.SELECT_LEVEL,{level:t+1})},e.handleClickHintButton=function(){e.node.scene.emit(wl.SHOW_HINT,{noAd:!0})},e.handleClickBuildVersionButton=function(){var e=globalThis.game.getBuildVersion();Ze.showNotificationScreen("Build version: ".concat(e))},e.handleClickPhysicButton=function(){var e=ve.Aabb,t=ve.Pair,n=ve.CenterOfMass,i=ve.Joint,a=ve.Shape;ce.instance.debugDrawFlags=e|t|n|i|a},e.handleClickWinLevelButton=function(){e.node.scene.emit(wl.DOGE_SURVIVE)},e.handleClickLoseLevelButton=function(){e.node.scene.emit(wl.DOGE_DIE)},e.handleClickBeehiveButton=function(){e.currentSpawnObjId=Ns.BEEHIVE_A,e.handleSpawnObject()},e.handleClickDogeButton=function(){e.currentSpawnObjId=Ns.DOGE_A,e.handleSpawnObject()},e.handleClickThornBallButton=function(){e.currentSpawnObjId=Ns.THORN_BALL,e.handleSpawnObject()},e.handleClickBigBeeButton=function(){e.currentSpawnObjId=Ns.BIG_BEE,e.handleSpawnObject()},e.handleClickThornButton=function(){e.currentSpawnObjId=Ns.THORN,e.handleSpawnObject()},e.handleClickAirFanButton=function(){e.currentSpawnObjId=Ns.AIR_FAN,e.handleSpawnObject()},e.handleClickBrickButton=function(){e.currentSpawnObjId=Ns.BRICK,e.handleSpawnPolygonObject()},e.handleClickGrassButton=function(){e.currentSpawnObjId=Ns.GRASS,e.handleSpawnPolygonObject()},e.handleClickGrassDarkButton=function(){e.currentSpawnObjId=Ns.GRASS_DARK,e.handleSpawnPolygonObject()},e.handleClickLineButton=function(){e.currentSpawnObjId=Ns.LINE,e.handleSpawnPolygonObject()},e.handleClickPoisonButton=function(){e.currentSpawnObjId=Ns.POISON,e.handleSpawnPolygonObject()},e.handleClickPoisonSurfaceButton=function(){e.currentSpawnObjId=Ns.POISON_SURFACE,e.handleSpawnPolygonObject()},e.handleClickWaterButton=function(){e.currentSpawnObjId=Ns.WATER,e.handleSpawnPolygonObject()},e.handleClickDangerAreaButton=function(){e.currentSpawnObjId=Ns.DANGER_AREA,e.handleSpawnPolygonObject()},e}return a(r,[{key:"start",value:function(){this.handleToggleDevToolsButton(),this.handleGameLevelButtons(),this.handleItemButtons(),this.handleEngineButtons(),this.handleSpawnObjectButtons(),this.handleSwitchSceneButtons()}},{key:"handleToggleDevToolsButton",value:function(){this.devToolsButton.on(L.EventType.TOUCH_START,this.handleClickDevToolsButton)}},{key:"handleGameLevelButtons",value:function(){this.winLevelButton.on(L.EventType.TOUCH_START,this.handleClickWinLevelButton),this.loseLevelButton.on(L.EventType.TOUCH_START,this.handleClickLoseLevelButton),this.prevLevelButton.on(L.EventType.TOUCH_START,this.handleClickPrevLevelButton),this.nextLevelButton.on(L.EventType.TOUCH_START,this.handleClickNextLevelButton)}},{key:"handleItemButtons",value:function(){this.hintButton.on(L.EventType.TOUCH_START,this.handleClickHintButton)}},{key:"handleEngineButtons",value:function(){this.buildVersionButton.on(L.EventType.TOUCH_START,this.handleClickBuildVersionButton),this.physicButton.on(L.EventType.TOUCH_START,this.handleClickPhysicButton),this.bundleButton.on(L.EventType.TOUCH_START,this.handleSwitchBundle)}},{key:"handleSpawnObjectButtons",value:function(){this.beehiveButton.on(L.EventType.TOUCH_START,this.handleClickBeehiveButton),this.dogeButton.on(L.EventType.TOUCH_START,this.handleClickDogeButton),this.thornBallButton.on(L.EventType.TOUCH_START,this.handleClickThornBallButton),this.bigBeeButton.on(L.EventType.TOUCH_START,this.handleClickBigBeeButton),this.thornButton.on(L.EventType.TOUCH_START,this.handleClickThornButton),this.airFanButton.on(L.EventType.TOUCH_START,this.handleClickAirFanButton),this.brickButton.on(L.EventType.TOUCH_START,this.handleClickBrickButton),this.grassButton.on(L.EventType.TOUCH_START,this.handleClickGrassButton),this.grassDarkButton.on(L.EventType.TOUCH_START,this.handleClickGrassDarkButton),this.lineButton.on(L.EventType.TOUCH_START,this.handleClickLineButton),this.poisonButton.on(L.EventType.TOUCH_START,this.handleClickPoisonButton),this.poisonSurfaceButton.on(L.EventType.TOUCH_START,this.handleClickPoisonSurfaceButton,this),this.waterButton.on(L.EventType.TOUCH_START,this.handleClickWaterButton),this.dangerAreaButton.on(L.EventType.TOUCH_START,this.handleClickDangerAreaButton)}},{key:"handleSwitchSceneButtons",value:function(){this.dashboardButton.on(L.EventType.TOUCH_START,this.handleClickDashboardButton)}},{key:"injectGameplay",value:function(e){this.gameplay=e,this.gameObjects=e.gameObjects}},{key:"hideAllButtons",value:function(){var e=this;this.getComponentsInChildren(A).forEach((function(t){t.node.name!==e.devToolsButton.name&&(t.node.active=!1)}))}},{key:"showAllButtons",value:function(){var e=this;this.getComponentsInChildren(A).forEach((function(t){t.node.name!==e.devToolsButton.name&&(t.node.active=!0)}))}},{key:"getCurrentLevel",value:function(){if(!this.gameplay)return null;var e=this.gameplay.getGameData();return e&&e.level||null}},{key:"handleEnterSelectLevel",value:function(e){var t=Number(e.string);this.node.scene.emit(wl.SELECT_LEVEL,{level:t})}},{key:"handleSpawnObject",value:function(){var e;if(this.validateRequiredComponents(),-1!==this.currentSpawnObjId){var t={x:Math.floor(40*Math.random()),y:Math.floor(40*Math.random())},n={id:this.currentSpawnObjId,point:t};null===(e=this.gameObjects)||void 0===e||e.spawnObjectForDevTools(n)}}},{key:"handleSpawnPolygonObject",value:function(){var e;if(this.validateRequiredComponents(),-1!==this.currentSpawnObjId){var t={x:Math.floor(40*Math.random()),y:Math.floor(40*Math.random())},n={x:t.x+Math.floor(10*Math.random()),y:t.y},i={x:t.x,y:t.y+Math.floor(10*Math.random())},a=[t,n,i,{x:n.x,y:i.y}],o={id:this.currentSpawnObjId,point:a};null===(e=this.gameObjects)||void 0===e||e.spawnPolygonObjectForDevTools(o)}}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"handleSwitchBundle",value:function(){T.emit(Me.CHANGE_QUALITY_ASSETS)}}]),r}(k)).prototype,"devToolsButton",[av],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ov=s(Bv.prototype,"winLevelButton",[ov],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dv=s(Bv.prototype,"loseLevelButton",[rv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Iv=s(Bv.prototype,"buildVersionButton",[sv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nv=s(Bv.prototype,"prevLevelButton",[lv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fv=s(Bv.prototype,"nextLevelButton",[uv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gv=s(Bv.prototype,"selectLevelButton",[cv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zv=s(Bv.prototype,"hintButton",[hv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mv=s(Bv.prototype,"physicButton",[pv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xv=s(Bv.prototype,"bundleButton",[dv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uv=s(Bv.prototype,"beehiveButton",[yv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hv=s(Bv.prototype,"dogeButton",[vv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jv=s(Bv.prototype,"thornBallButton",[fv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vv=s(Bv.prototype,"bigBeeButton",[mv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wv=s(Bv.prototype,"thornButton",[gv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qv=s(Bv.prototype,"airFanButton",[bv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kv=s(Bv.prototype,"brickButton",[Sv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yv=s(Bv.prototype,"grassButton",[kv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jv=s(Bv.prototype,"grassDarkButton",[Cv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zv=s(Bv.prototype,"lineButton",[wv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xv=s(Bv.prototype,"poisonButton",[Ev],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qv=s(Bv.prototype,"poisonSurfaceButton",[Tv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$v=s(Bv.prototype,"waterButton",[Av],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ef=s(Bv.prototype,"dangerAreaButton",[Rv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tf=s(Bv.prototype,"dashboardButton",[Pv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_v=Bv))||_v);v._RF.pop(),v._RF.push({},"a3b0f6zU+1D97PyszsgST1H","UIManager",void 0);var kf,Cf,wf,Ef,Tf,Af,Rf,Pf,_f,Bf,Lf,Of,Df=m.ccclass,If=m.property,Nf=GameCore.Utils,Ff=(uf=Df("UIManager"),cf=If(ky),hf=If(lf),pf=If(Sf),uf((vf=s((yf=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"clock",vf,u(e)),l(e,"header",ff,u(e)),l(e,"devTools",mf,u(e)),e.showDevTools=function(){e.devTools&&(e.devTools.node.active=!0)},e}return a(r,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.listensDevToolsEvents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"listensDevToolsEvents",value:function(){this.node.scene.on(ks.Events.UNLOCK_DEV_TOOLS,this.showDevTools)}},{key:"initDevTools",value:function(e){this.devTools&&(this.devTools.node.active=Nf.Valid.isDebugger(),this.devTools.injectGameplay(e))}},{key:"setLevelText",value:function(e){this.header.setLevelText(e)}},{key:"initCountdown",value:function(){this.clock.init()}},{key:"startCountdown",value:function(){this.clock.startCountdown()}},{key:"pauseCountdown",value:function(){this.clock.pause()}},{key:"resumeCountdown",value:function(){this.clock.resume()}},{key:"showUncompletedMark",value:function(){this.clock.showUncompletedMark()}},{key:"showCompletedMark",value:function(){this.clock.showCompletedMark()}},{key:"setProgressBarPercentage",value:function(e){this.header.setProgress(e)}},{key:"setProgressStars",value:function(e){this.header.setProgressStars(e)}},{key:"startCountDownHeaderHintBubbleAnim",value:function(){this.header.startCountDownHintBubble()}},{key:"stopCountDownHeaderHintBubbleAnim",value:function(){this.header.stopCountDownHintBubble()}},{key:"disableUI",value:function(){this.header.disableButtons()}},{key:"enableUI",value:function(){this.header.enableButtons()}},{key:"disableHintButton",value:function(){this.header.disableHintButton()}},{key:"disableRewardAdsUI",value:function(){this.header.disableRewardAdsButton()}}]),r}(k)).prototype,"clock",[cf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ff=s(yf.prototype,"header",[hf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mf=s(yf.prototype,"devTools",[pf],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),df=yf))||df);v._RF.pop(),v._RF.push({},"157f203vjtMma2FDvAlyM6h","Gameplay",void 0);var Gf,zf=m.ccclass,Mf=m.requireComponent,xf=m.property,Uf=globalThis.game,Hf=Uf.player,jf=Uf.analytics,Vf=(kf=zf("Gameplay"),Cf=Mf([uy,fd,vd]),wf=xf(jp),Ef=xf(dd),Tf=xf(rd),Af=xf(Gp),kf(Rf=Cf((_f=s((Pf=function(o){t(s,o);var r=n(s);function s(){var t;i(this,s);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(t=r.call.apply(r,[this].concat(a))).gameStartCount=0,l(t,"hint",_f,u(t)),l(t,"gameMap",Bf,u(t)),l(t,"lineDrawer",Lf,u(t)),l(t,"gameObjects",Of,u(t)),t.gameData=null,t.defaultData=null,t.handleStartGame=function(e){if(!e)throw new Error("handleStartGame: GameEvent payload is not defined");t.setGameData(e),t.stateManager.draw()},t.handlePauseGame=function(e){t.pauseGame(),Ve.pauseSound(qe.BEE_FLYING),t.processCrazyGamesGameplayStop()},t.handleResumeGame=function(e){t.resumeGame(),Ve.resumeSound(qe.BEE_FLYING),t.processCrazyGamesGameplayStart()},t.handleReplayGame=function(e){var n=d(d({},t.defaultData),e);t.setGameData(n),t.stateManager.initialize()},t.handleNextLevel=function(e){t.gameData&&(t.updatePlayerLevelProgress(e),t.stateManager.load(),t.attemptCallCreateShortcut())},t.updatePlayerLevelProgress=function(e){if(t.gameData){if(!e)throw new Error("handleNextLevel: GameEvent payload is not defined");var n=t.gameData,i=n.level,a=n.nextLevelCount,o=void 0===a?0:a,r=e.level,s=void 0===r?i:r;if(!s)throw new Error("Level is not defined");var l=s+1;Hf.setGameData({level:l});var u=d(d(d({},t.defaultData),e),{},{level:l,nextLevelCount:o+1});t.setGameData(u)}},t.handleStartOver=function(e){Hf.setGameData({level:1});var n=d(d(d({},t.defaultData),e),{},{level:1});t.setGameData(n),t.stateManager.load()},t.handleSelectLevel=function(e){if(!e)throw new Error("handleSelectLevel: GameEvent payload is not defined");var n=e.level;if(n){var i=d(d(d({},t.defaultData),e),{},{level:n});Hf.setGameData({level:n}),t.setGameData(i),t.stateManager.load()}},t.handleClockTimeout=function(e){t.stateManager.escape()},t.handleDrawing=function(e){if(!e)throw new Error("handleDrawing: GameEvent payload is not defined");t.setGameData(e)},t.handleBeeDie=function(e){var n;(null===(n=t.gameObjects)||void 0===n?void 0:n.checkAllBeeDie())&&(t.stateManager.escape(),t.processCrazyGamesHappyTime())},t.handleBigBeeDie=function(e){var n;(null===(n=t.gameObjects)||void 0===n?void 0:n.checkAllBeeDie())&&(t.stateManager.escape(),t.processCrazyGamesHappyTime())},t.handleBeeAttack=function(e){t.stateManager.attack()},t.handleDogeDie=function(e){t.stateManager.death()},t.handleDogeSurvive=function(e){t.stateManager.escape()},t.handleShowHint=function(){var n=e((function*(e){var n,i,a;if((null===(n=t.hint)||void 0===n||!n.getIsHintShow())&&t.stateManager.isReady()){var o=(null!=e?e:{}).noAd,r=void 0!==o&&o;if(t.uiManager.stopCountDownHeaderHintBubbleAnim(),!r)if(!(yield Qe.showRewardVideoAdAsync()))return;var s=(null!==(i=t.gameData)&&void 0!==i?i:{}).levelData;if(!s)throw new Error("Level data is not defined");var l=s.tips,u=Dp.transformPointsFromMapToDrawAreaCoordinate(l);null===(a=t.hint)||void 0===a||a.showHint(u,!1)}}));return function(e){return n.apply(this,arguments)}}(),t.handleSkipLevel=function(){var n=e((function*(e){t.stateManager.isReady()&&((yield Qe.showRewardVideoAdAsync())&&t.node.scene.emit(wl.DOGE_SURVIVE),t.node.scene.emit(wl.GAME_RESUME))}));return function(e){return n.apply(this,arguments)}}(),t}return a(s,[{key:"__preload",value:function(){this.initComponents(),this.validateRequiredComponents(),this.listenInputEvents(),Qe.showBannerAds()}},{key:"initComponents",value:function(){this.initUIManager(),this.initStateManager(),this.initInputController(),this.initInkCapacityController()}},{key:"initUIManager",value:function(){var e;this.uiManager=null===(e=this.node.parent)||void 0===e?void 0:e.getComponentInChildren(Ff)}},{key:"initStateManager",value:function(){this.stateManager=this.getComponent(uy)}},{key:"initInputController",value:function(){this.inputController=this.getComponent(fd)}},{key:"initInkCapacityController",value:function(){this.inkCapacityController=this.getComponent(vd)}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"listenInputEvents",value:function(){this.node.scene.on(wl.GAME_START,this.handleStartGame),this.node.scene.on(wl.GAME_PAUSE,this.handlePauseGame),this.node.scene.on(wl.GAME_RESUME,this.handleResumeGame),this.node.scene.on(wl.GAME_REPLAY,this.handleReplayGame),this.node.scene.on(wl.NEXT_LEVEL,this.handleNextLevel),this.node.scene.on(wl.UPDATE_LEVEL,this.updatePlayerLevelProgress),this.node.scene.on(wl.START_OVER,this.handleStartOver),this.node.scene.on(wl.SELECT_LEVEL,this.handleSelectLevel),this.node.scene.on(wl.DRAWING,this.handleDrawing),this.node.scene.on(wl.TIME_OUT,this.handleClockTimeout),this.node.scene.on(wl.BEE_DIE,this.handleBeeDie),this.node.scene.on(wl.BIG_BEE_DIE,this.handleBigBeeDie),this.node.scene.on(wl.BEE_ATTACK,this.handleBeeAttack),this.node.scene.on(wl.DOGE_DIE,this.handleDogeDie),this.node.scene.on(wl.DOGE_SURVIVE,this.handleDogeSurvive),this.node.scene.on(wl.SHOW_HINT,this.handleShowHint),this.node.scene.on(wl.SKIP_LEVEL,this.handleSkipLevel)}},{key:"start",value:function(){this.initData(),this.initGame(),this.initDevTools()}},{key:"initDevTools",value:function(){this.uiManager.initDevTools(this)}},{key:"initData",value:function(){var e,t=(null!==(e=Hf.getGameData())&&void 0!==e?e:{}).level,n=void 0===t?1:t;this.defaultData={level:n,gameplayMode:"level",nextLevelCount:0,isFromLoader:!1},this.setGameData(this.defaultData)}},{key:"initGame",value:function(){this.stateManager.init(),this.stateManager.load()}},{key:"setGameData",value:function(e){e&&(this.gameData=d(d({},this.gameData),e))}},{key:"getGameData",value:function(){return this.gameData}},{key:"pauseGame",value:function(){this.node.active=!1,this.node.pauseSystemEvents(!0),this.uiManager.pauseCountdown()}},{key:"resumeGame",value:function(){this.node.active=!0,this.node.resumeSystemEvents(!0),this.uiManager.resumeCountdown()}},{key:"attemptCallCreateShortcut",value:function(){var e,t=null!==(e=this.getGameData())&&void 0!==e?e:{},n=t.level,i=void 0===n?0:n,a=t.nextLevelCount;i<2||(void 0===a?0:a)<2||"checkAndCreateShortcutAsync"in GameSDK.extra&&GameSDK.extra.checkAndCreateShortcutAsync().catch((function(e){console.warn("checkAndCreateShortcutAsync",e)}))}},{key:"handleGamePromotions",value:function(){var e;if(this.gameStartCount+=1,"MsGames"===GameSDK.getSDKName()&&"switchGameAsync"in GameSDK.extra){var t=null!==(e=Hf.getPlayerDataByKey("lastCallSwitchGame"))&&void 0!==e?e:0,n=Date.now();if(!(n-t<864e5||this.gameStartCount<8)){var i=GameCore.Plugins.Analytics.Events;jf.event(i.SWITCH_GAME_POPUP),Hf.setPlayerDataByName("lastCallSwitchGame",n),GameSDK.extra.switchGameAsync("9n7mhcswnqrj").catch((function(e){jf.event(i.SWITCH_GAME,{success:!1}),console.warn("switchGameAsync",e)}))}}}},{key:"processCrazyGamesGameplayStart",value:function(){"gameplayStart"in GameSDK.extra&&GameSDK.extra.gameplayStart()}},{key:"processCrazyGamesGameplayStop",value:function(){"gameplayStop"in GameSDK.extra&&GameSDK.extra.gameplayStop()}},{key:"processCrazyGamesHappyTime",value:function(){"happyTime"in GameSDK.extra&&GameSDK.extra.happyTime()}},{key:"disableRewardAdsItemForCrazyGames",value:function(){"CrazyGames"===GameSDK.getSDKName()&&this.uiManager.disableRewardAdsUI()}}]),s}(k)).prototype,"hint",[wf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bf=s(Pf.prototype,"gameMap",[Ef],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lf=s(Pf.prototype,"lineDrawer",[Tf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Of=s(Pf.prototype,"gameObjects",[Af],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rf=Pf))||Rf)||Rf);v._RF.pop(),v._RF.push({},"bfd3fZcEttGVawFb2B3Gmqu","DangerArea",void 0);var Wf,qf,Kf,Yf,Jf,Zf,Xf,Qf,$f,em,tm,nm,im,am,om;(0,m.ccclass)("DangerArea")(Gf=function(e){t(s,e);var o=n(s);function s(){var e;i(this,s);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).useBatch=!1,e.dangerPolygons=[],e}return a(s,[{key:"addDangerAreaPolygon",value:function(e){this.dangerPolygons.push(e)}},{key:"addRigidBody",value:function(){var e=this.node.addComponent(W);e?(e.group=Fs.MAIN_OBJECT,e.type=V.Static):console.warn("Cannot add RigidBody2D")}},{key:"applyColliderForBatchDraw",value:function(){var e,t=this.dangerPolygons.map((function(e){return e.map((function(e){var t=e.x,n=e.y;return new K(t,n)}))})),n=r(t);try{for(n.s();!(e=n.n()).done;){var i=e.value,a=new L;a.name=Rs.DANGER_AREA,this.node.addChild(a),a.setPosition(0,0);var o=a.addComponent(W);o.type=V.Static,o.group=Fs.MAIN_OBJECT;var s=a.addComponent(oe);s.points=i,s.apply()}}catch(e){n.e(e)}finally{n.f()}}},{key:"batchDrawAllDangerAreas",value:function(){if(!(this.dangerPolygons.length<1)){var e=this.node.getComponent(dc);if(!e)return console.warn("DangerArea: GraphicsPattern not found"),null;this.addRigidBody(),e.setColor("#fc03036d");var t,n=r(this.dangerPolygons);try{for(n.s();!(t=n.n()).done;){var i=t.value;e.draw(i)}}catch(e){n.e(e)}finally{n.f()}this.applyColliderForBatchDraw()}}}]),s}(k));v._RF.pop(),v._RF.push({},"0daa9+mtbVHG5tVordU0a3q","Spider",void 0);var rm,sm,lm,um,cm,hm,pm,dm=m.ccclass,ym=m.property;Wf=dm("Spider"),qf=ym(L),Kf=ym(L),Yf=ym(L),Jf=ym(Y),Zf=ym(W),Xf=ym(D),Wf((em=s(($f=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"spider",em,u(e)),l(e,"web",tm,u(e)),l(e,"silk",nm,u(e)),e.isStunned=!1,l(e,"spiderCollider",im,u(e)),l(e,"spiderRigidBody",am,u(e)),l(e,"silkGraphics",om,u(e)),e.onSpiderCollisionEnter=function(t,n){if(!e.isStunned){e.isStunned=!0,e.spiderRigidBody.linearVelocity=new K(0,0);var i=e.isLineCollision(n),a=e.isDogeCollision(n);if(i||a){var o=n.node,r=e.spider.addComponent(fe),s=e.spider.worldPosition,l=o.getComponent(W);if(i)r.connectedAnchor=n.offset.clone();else{var u=o.worldPosition;r.connectedAnchor=new K(s.x-u.x,s.y-u.y)}r.connectedBody=l,r.autoCalcDistance=!1,r.maxLength=5,r.collideConnected=!1}}},e}return a(r,[{key:"onLoad",value:function(){this.spiderCollider=this.spider.getComponent(Y),this.spiderRigidBody=this.spider.getComponent(W),this.silkGraphics=this.silk.getComponent(D),this.validateRequiredComponents()}},{key:"onDestroy",value:function(){this.spiderCollider.off(J.BEGIN_CONTACT,this.onSpiderCollisionEnter)}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"start",value:function(){this.enabled=!1,this.isStunned=!1,this.silkOffsetVector=new K,this.spiderCollider.on(J.BEGIN_CONTACT,this.onSpiderCollisionEnter)}},{key:"update",value:function(){if(this.enabled)if(this.drawSilk(),this.isStunned){var e=this.getVectorDataFromAToB(this.spider.worldPosition,this.web.worldPosition);this.spiderRigidBody.linearVelocity=e.vector.multiplyScalar(5),this.spiderRigidBody.linearDamping=0,this.isSpiderTooCloseToWeb()&&(this.spiderRigidBody.type=V.Static,this.enabled=!1)}else{if(-3===this.spiderRigidBody.linearVelocity.y)return;this.spiderRigidBody.linearVelocity=new K(0,-3)}}},{key:"drawSilk",value:function(){var e=this.web.position,t=this.spider.position,n=Z.toRadian(this.spider.eulerAngles.z);this.silkGraphics.clear(),this.silkGraphics.moveTo(e.x,e.y),this.silkOffsetVector.set(0,50).rotate(n),this.silkGraphics.lineTo(t.x+this.silkOffsetVector.x,t.y+this.silkOffsetVector.y),this.silkGraphics.stroke()}},{key:"isSpiderTooCloseToWeb",value:function(){var e=this.spider.position,t=this.web.position;return _.distance(e,t)<40}},{key:"isLineCollision",value:function(e){var t=e.node;return t&&t.getComponent($l)||!1}},{key:"isDogeCollision",value:function(e){var t=e.node;return t&&t.getComponent(Ah)||!1}}]),r}(qs)).prototype,"spider",[qf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tm=s($f.prototype,"web",[Kf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nm=s($f.prototype,"silk",[Yf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),im=s($f.prototype,"spiderCollider",[Jf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),am=s($f.prototype,"spiderRigidBody",[Zf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),om=s($f.prototype,"silkGraphics",[Xf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qf=$f));v._RF.pop(),v._RF.push({},"8fe7bkzdtdNfY7I8uaDov+b","EndlessHeader",void 0);var vm,fm,mm,gm,bm,Sm,km,Cm,wm,Em,Tm,Am=m.ccclass,Rm=m.property,Pm=(rm=Am("EndlessHeader"),sm=Rm(L),lm=Rm(L),rm((hm=s((cm=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"pauseNode",hm,u(e)),l(e,"replayNode",pm,u(e)),e}return a(r,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"handleClickedPauseGame",value:function(){this.showSettingScreen(),this.node.scene.emit(wl.GAME_PAUSE)}},{key:"handleClickedReplayGame",value:function(){this.node.scene.emit(wl.GAME_REPLAY)}},{key:"showSettingScreen",value:function(){Ze.openScreen(Xe.SETTINGS_SCREEN,{})}},{key:"disableButtons",value:function(){this.enableBtnNode(this.pauseNode,!1,!0),this.enableBtnNode(this.replayNode,!1,!0)}},{key:"enableButtons",value:function(){this.enableBtnNode(this.pauseNode,!0,!0),this.enableBtnNode(this.replayNode,!0,!0)}},{key:"enableBtnNode",value:function(e,t,n){var i=e.getComponent(A);if(i&&(i.interactable=t),e.active=n,n){var a=e.getComponent(ii);a&&a.changeState(t)}}}]),r}(k)).prototype,"pauseNode",[sm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pm=s(cm.prototype,"replayNode",[lm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),um=cm))||um);v._RF.pop(),v._RF.push({},"bc951s11zREU72nQBqwoD3m","EndlessClock",void 0);var _m,Bm,Lm,Om,Dm,Im,Nm,Fm,Gm,zm,Mm,xm=m.ccclass,Um=m.disallowMultiple,Hm=m.property,jm=(vm=xm("EndlessClock"),fm=Hm(N),mm=Hm(N),gm=Hm(g),bm=Hm(E),vm(Sm=Um((Cm=s((km=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"timeText",Cm,u(e)),l(e,"bestTimeText",wm,u(e)),l(e,"animation",Em,u(e)),l(e,"clockFill",Tm,u(e)),e.elapsedTime=0,e.bestTime=0,e.running=!1,e}return a(r,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"start",value:function(){this.animation.stop(),this.clockFill.fillRange=0}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"getScore",value:function(){return this.elapsedTime}},{key:"getBestScore",value:function(){return Math.max(this.bestTime,this.elapsedTime)}},{key:"setBestScore",value:function(e){this.bestTime=e;var t=Math.floor(e/60),n=Math.floor(e%60),i=t.toString().padStart(2,"0"),a=n.toString().padStart(2,"0");this.bestTimeText.string="".concat(i,":").concat(a)}},{key:"init",value:function(){this.running=!1,this.node.active=!0,this.animation.stop(),this.clockFill.fillRange=0,this.setElapsedTime(0),this.setBestScore(this.bestTime)}},{key:"startCounting",value:function(){this.running=!0,this.node.active=!0,this.animation.play(),this.setElapsedTime(0),this.setBestScore(this.bestTime)}},{key:"stopCounting",value:function(){this.running=!1,this.node.active=!1,this.animation.stop(),this.clockFill.fillRange=0}},{key:"pause",value:function(){this.running=!1,this.animation.pause()}},{key:"resume",value:function(){this.running=!0,this.animation.play()}},{key:"update",value:function(e){this.running&&this.setElapsedTime(this.elapsedTime+e)}},{key:"setElapsedTime",value:function(e){this.elapsedTime=e;var t=Math.floor(this.elapsedTime/60),n=Math.floor(this.elapsedTime%60),i=t.toString().padStart(2,"0"),a=n.toString().padStart(2,"0");this.timeText.string="".concat(i,":").concat(a),this.elapsedTime>this.bestTime&&this.setBestScore(this.elapsedTime)}}]),r}(k)).prototype,"timeText",[fm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wm=s(km.prototype,"bestTimeText",[mm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Em=s(km.prototype,"animation",[gm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tm=s(km.prototype,"clockFill",[bm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sm=km))||Sm)||Sm);v._RF.pop(),v._RF.push({},"346956Nk9hPgpT3ZCsaVr+P","EndlessUIManager",void 0);var Vm,Wm,qm,Km,Ym,Jm,Zm,Xm,Qm,$m,eg,tg,ng,ig,ag,og,rg=m.ccclass,sg=m.property,lg=GameCore.Utils,ug=(_m=rg("EndlessUIManager"),Bm=sg(jm),Lm=sg(Pm),Om=sg(Sf),Dm=sg(L),_m((Fm=s((Nm=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"clock",Fm,u(e)),l(e,"header",Gm,u(e)),l(e,"devTools",zm,u(e)),l(e,"tapToStartText",Mm,u(e)),e.showDevTools=function(){e.devTools&&(e.devTools.node.active=!0)},e}return a(r,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.listensDevToolsEvents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"listensDevToolsEvents",value:function(){this.node.scene.on(ks.Events.UNLOCK_DEV_TOOLS,this.showDevTools)}},{key:"initDevTools",value:function(e){this.devTools&&(this.devTools.node.active=lg.Valid.isDebugger(),this.devTools.injectGameplay(e))}},{key:"getBestScore",value:function(){return this.clock.getBestScore()}},{key:"setBestScore",value:function(e){this.clock.setBestScore(e)}},{key:"initCounting",value:function(){this.clock.init()}},{key:"startCounting",value:function(){this.clock.startCounting()}},{key:"stopCounting",value:function(){this.clock.stopCounting()}},{key:"pauseCounting",value:function(){this.clock.pause()}},{key:"resumeCounting",value:function(){this.clock.resume()}},{key:"disableUI",value:function(){this.header.disableButtons()}},{key:"enableUI",value:function(){this.header.enableButtons()}},{key:"showTapToStartText",value:function(){this.tapToStartText.active=!0;var e=this.tapToStartText.getComponent(O);e.opacity=255,le(e).to(.5,{opacity:0},{easing:"smooth"}).to(.5,{opacity:255},{easing:"smooth"}).union().repeatForever().start()}},{key:"hideTapToStartText",value:function(){var e=this.tapToStartText.getComponent(O);se.stopAllByTarget(e),se.stopAllByTarget(this.tapToStartText),this.tapToStartText.active=!1}}]),r}(k)).prototype,"clock",[Bm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gm=s(Nm.prototype,"header",[Lm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zm=s(Nm.prototype,"devTools",[Om],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Mm=s(Nm.prototype,"tapToStartText",[Dm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Im=Nm))||Im);v._RF.pop(),v._RF.push({},"9d32c879Q1FRIas0BgO+iNP","EndlessGameplay",void 0);var cg=m.ccclass,hg=m.property,pg=m.requireComponent,dg=globalThis.game.player,yg=(Vm=cg("EndlessGameplay"),Wm=pg(x),qm=hg({type:te,group:"Thorns"}),Km=hg({type:L,group:"Thorns"}),Ym=hg({type:L,group:"Thorns"}),Jm=hg({type:L,group:"Thorns"}),Zm=hg({type:L,group:"Thorns"}),Xm=hg(Gp),Vm(Qm=Wm((eg=s(($m=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).gameData=null,e.defaultData=null,l(e,"thornPrefab",eg,u(e)),l(e,"bottomThorns",tg,u(e)),l(e,"topThorns",ng,u(e)),l(e,"leftThorns",ig,u(e)),l(e,"rightThorns",ag,u(e)),l(e,"gameObjects",og,u(e)),e.handleStartGame=function(t){if(!t)throw new Error("handleStartGame: GameEvent payload is not defined");e.setGameData(t),e.stateManager.play()},e.handlePauseGame=function(t){e.pauseGame(),Ve.pauseSound(qe.BEE_FLYING),e.processCrazyGamesGameplayStop()},e.handleResumeGame=function(t){e.resumeGame(),Ve.resumeSound(qe.BEE_FLYING),e.processCrazyGamesGameplayStart()},e.handleReplayGame=function(t){var n=d(d({},e.gameData),t);e.setGameData(n),e.stateManager.initialize(),e.uiManager.showTapToStartText(),e.node.active=!0,e.node.resumeSystemEvents(!0)},e.handleDogeDie=function(){e.stateManager.death(),e.attemptCallCreateShortcut()},e.handleBeeDie=function(t){var n;(null===(n=e.gameObjects)||void 0===n?void 0:n.checkAllBeeDie())&&e.processCrazyGamesHappyTime()},e.handleBigBeeDie=function(t){var n;(null===(n=e.gameObjects)||void 0===n?void 0:n.checkAllBeeDie())&&e.processCrazyGamesHappyTime()},e.handleHideTapToPlayText=function(){e.uiManager.hideTapToStartText()},e}return a(r,[{key:"__preload",value:function(){this.initComponents(),this.uiTransform=this.getComponent(x),this.validateRequiredComponents(),this.listenInputEvents(),Qe.showBannerAds()}},{key:"initComponents",value:function(){this.initUIManager(),this.initStateManager()}},{key:"initUIManager",value:function(){var e;this.uiManager=null===(e=this.node.parent)||void 0===e?void 0:e.getComponentInChildren(ug)}},{key:"initStateManager",value:function(){this.stateManager=this.getComponent(xg)}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"listenInputEvents",value:function(){this.node.scene.on(wl.GAME_START,this.handleStartGame),this.node.scene.on(wl.GAME_PAUSE,this.handlePauseGame),this.node.scene.on(wl.GAME_RESUME,this.handleResumeGame),this.node.scene.on(wl.GAME_REPLAY,this.handleReplayGame),this.node.scene.on(wl.BEE_DIE,this.handleBeeDie),this.node.scene.on(wl.BIG_BEE_DIE,this.handleBigBeeDie),this.node.scene.on(wl.DOGE_DIE,this.handleDogeDie)}},{key:"start",value:function(){this.initData(),this.initGame(),this.initObjects(),this.initDevTools(),this.uiManager.startCounting(),this.uiManager.showTapToStartText()}},{key:"initDevTools",value:function(){this.uiManager.initDevTools(this)}},{key:"initData",value:function(){var e,t=null!==(e=dg.getGameData())&&void 0!==e?e:{},n=t.level,i=void 0===n?1:n,a=t.bestEndlessScore,o=void 0===a?0:a;this.defaultData={level:i,bestEndlessScore:o,gameplayMode:"endless",nextLevelCount:0,isFromLoader:!1},this.setGameData(this.defaultData)}},{key:"initGame",value:function(){this.stateManager.init(),this.stateManager.load()}},{key:"setGameData",value:function(e){e&&(this.gameData=d(d({},this.gameData),e))}},{key:"getGameData",value:function(){return this.gameData}},{key:"pauseGame",value:function(){this.node.active=!1,this.node.pauseSystemEvents(!0),this.uiManager.pauseCounting()}},{key:"resumeGame",value:function(){this.node.active=!0,this.node.resumeSystemEvents(!0),this.uiManager.resumeCounting()}},{key:"attemptCallCreateShortcut",value:function(){var e,t=null!==(e=this.gameData)&&void 0!==e?e:{},n=t.level,i=void 0===n?0:n,a=t.nextLevelCount;i<2||(void 0===a?0:a)<2||"checkAndCreateShortcutAsync"in GameSDK.extra&&GameSDK.extra.checkAndCreateShortcutAsync().catch((function(e){console.warn("checkAndCreateShortcutAsync",e)}))}},{key:"initObjects",value:function(){var e=this.createThorn();if(!(e instanceof L))throw new Error("initObjects: Could not create thorn");var t=e.getComponent(x);if(!(t instanceof x))throw new Error("initObjects: Could not get UITransform of thorn");for(var n=this.uiTransform.getBoundingBoxToWorld(),i=n.width,a=n.height,o=Math.ceil(i/t.width),r=Math.ceil(a/t.height),s=0;s<o;s++)this.topThorns.addChild(this.createThorn()),this.bottomThorns.addChild(this.createThorn());for(var l=0;l<r;l++)this.leftThorns.addChild(this.createThorn()),this.rightThorns.addChild(this.createThorn());this.rightThorns.addChild(e),console.log("initObjects: Done",o,r)}},{key:"getBoundingBox",value:function(){return this.uiTransform.getBoundingBoxToWorld()}},{key:"getDogeSpawnPosition",value:function(){var e=this.uiTransform.getBoundingBoxToWorld().center;return[e.x,e.y]}},{key:"createThorn",value:function(){var e=ne(this.thornPrefab);return e.name=Rs.THORN,e}},{key:"processCrazyGamesGameplayStart",value:function(){"gameplayStart"in GameSDK.extra&&GameSDK.extra.gameplayStart()}},{key:"processCrazyGamesGameplayStop",value:function(){"gameplayStop"in GameSDK.extra&&GameSDK.extra.gameplayStop()}},{key:"processCrazyGamesHappyTime",value:function(){"happyTime"in GameSDK.extra&&GameSDK.extra.happyTime()}}]),r}(k)).prototype,"thornPrefab",[qm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tg=s($m.prototype,"bottomThorns",[Km],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ng=s($m.prototype,"topThorns",[Ym],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ig=s($m.prototype,"leftThorns",[Jm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ag=s($m.prototype,"rightThorns",[Zm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),og=s($m.prototype,"gameObjects",[Xm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qm=$m))||Qm)||Qm);v._RF.pop(),v._RF.push({},"43aefNoI9lJxJNh3LPuKYPt","BaseState",void 0);var vg=function(){function e(t){if(i(this,e),this.game=null,this.data={},this.game=t.node.getComponent(yg),!this.game)throw new Error("Gameplay component not found");this.manager=t,this.updateStateData(),this.logDebug()}return a(e,[{key:"logDebug",value:function(){var e=this.constructor.name;console.debug("[STATE] ".concat(e),this.data)}},{key:"updateStateData",value:function(){if(this.game){var e=this.game.getGameData();e&&(this.data=e)}}},{key:"updateGameData",value:function(e){var t;null===(t=this.game)||void 0===t||t.setGameData(e),this.updateStateData()}}]),e}();v._RF.pop(),v._RF.push({},"109f0WH9r9IQqMHpvD45PzQ","DeathState",void 0);var fg=globalThis.game.analytics,mg=function(e){t(s,e);var o=n(s);function s(e){var t,n,a;return i(this,s),(a=o.call(this,e)).processCrazyGamesEvent(),a.disableUI(),Ve.stopAllSounds(),a.vibrateDevice(),a.pauseCountdown(),a.logLevelFailAnalytics(),null===(t=a.game)||void 0===t||t.scheduleOnce((function(){a.stopDogesLooking(),Ve.playSound(qe.LEVEL_FAIL,{volume:.3})}),.5),null===(n=a.game)||void 0===n||n.scheduleOnce((function(){a.sleepObjects(),a.showLoseScreen(),a.manager.finish()}),1.8),a}return a(s,[{key:"processCrazyGamesEvent",value:function(){"gameplayStop"in GameSDK.extra&&GameSDK.extra.gameplayStop()}},{key:"load",value:function(){}},{key:"initialize",value:function(){}},{key:"ready",value:function(){}},{key:"play",value:function(){}},{key:"death",value:function(){}},{key:"finish",value:function(){var e=this.manager.createFinishState();this.manager.change(e)}},{key:"update",value:function(){}},{key:"disableUI",value:function(){var e;null===(e=this.game)||void 0===e||e.uiManager.disableUI()}},{key:"sleepObjects",value:function(){var e;null===(e=this.game)||void 0===e||null===(e=e.gameObjects)||void 0===e||e.sleepObjects()}},{key:"pauseCountdown",value:function(){var e;null===(e=this.game)||void 0===e||e.uiManager.pauseCounting()}},{key:"stopDogesLooking",value:function(){var e;if(null!==(e=this.game)&&void 0!==e&&e.gameObjects){var t,n=this.game.gameObjects.getComponentsInChildren(Ah),i=r(n);try{for(i.s();!(t=i.n()).done;){var a,o=t.value;null===(a=o.eyes)||void 0===a||a.stopLook(),o.setEnable(!1)}}catch(e){i.e(e)}finally{i.f()}}}},{key:"vibrateDevice",value:function(){var e;null===(e=ue("Vibrate"))||void 0===e||null===(e=e.getComponent(ms))||void 0===e||e.vibrate(500)}},{key:"showLoseScreen",value:function(){var e=this.data.level;Ze.openScreen(Xe.LOSE_SCREEN,{level:e})}},{key:"logLevelFailAnalytics",value:function(){fg.levelComplete(1,0,Es)}}]),s}(vg);v._RF.pop(),v._RF.push({},"638devCm49MrpqRRWptDInp","FinishState",void 0);var gg=globalThis.game.player,bg=function(o){t(l,o);var r,s=n(l);function l(e){var t;return i(this,l),t=s.call(this,e),Ve.turnUpMusic(),Ve.stopSound(qe.BEE_FLYING),t.finishGameAsync(),t}return a(l,[{key:"load",value:function(){var e=this.manager.createLoadingState();this.manager.change(e)}},{key:"initialize",value:function(){var e=this.manager.createInitializeState();this.manager.change(e)}},{key:"ready",value:function(){}},{key:"play",value:function(){}},{key:"death",value:function(){}},{key:"finish",value:function(){}},{key:"update",value:function(){}},{key:"finishGameAsync",value:(r=e((function*(){try{var e,t;if(!this.game)return;var n=this.game.uiManager.getBestScore(),i=null!==(e=null===(t=gg.getGameData())||void 0===t?void 0:t.bestEndlessScore)&&void 0!==e?e:0,a=i<n?n:i;gg.setGameData({bestEndlessScore:a}),this.updateGameData({bestEndlessScore:a}),yield Fd.finishMatchAsync()}catch(e){console.error("finishGameAsync",e)}})),function(){return r.apply(this,arguments)})}]),l}(vg);v._RF.pop(),v._RF.push({},"97260ZJNotE0LYFeNm4wsEz","InitializeState",void 0);var Sg=function(o){t(u,o);var r,s,l=n(u);function u(e){var t;return i(this,u),t=l.call(this,e),"CrazyGames"===GameSDK.getSDKName()&&t.processCrazyGamesRequirements(),t.enableUI(),t.clearGameObjects(),t.createGameObjects(),t.initClock(),Ve.playMusic(),t.startGameAsync().then((function(){t.closeLoadingScreen(),t.manager.ready()})),t}return a(u,[{key:"processCrazyGamesRequirements",value:function(){"gameplayStart"in GameSDK.extra&&GameSDK.extra.gameplayStart(),this.showInterAdsCrazyGames()}},{key:"showInterAdsCrazyGames",value:(s=e((function*(){this.game&&(Ve.stopAllSounds(),yield Qe.showInterstitialAdAsync({forLevel:this.data.level,includeSDK:["CrazyGames"]}),Ve.turnUpMusic())})),function(){return s.apply(this,arguments)})},{key:"load",value:function(){if(GameCore.Utils.Valid.isDebugger()){var e=this.manager.createLoadingState();this.manager.change(e)}}},{key:"initialize",value:function(){}},{key:"ready",value:function(){var e=this.manager.createReadyState();this.manager.change(e)}},{key:"play",value:function(){}},{key:"death",value:function(){var e=this.manager.createDeathState();this.manager.change(e)}},{key:"finish",value:function(){}},{key:"update",value:function(){}},{key:"closeLoadingScreen",value:function(){Ze.closeScreen(Xe.LOADING_SCREEN)}},{key:"enableUI",value:function(){var e;null===(e=this.game)||void 0===e||e.uiManager.enableUI()}},{key:"clearGameObjects",value:function(){var e;null!==(e=this.game)&&void 0!==e&&e.gameObjects&&this.game.gameObjects.clearObjects()}},{key:"createGameObjects",value:function(){var e,t,n,i=null!==(e=null===(t=this.game)||void 0===t?void 0:t.getDogeSpawnPosition())&&void 0!==e?e:[0,0],a=y(i,2),o=a[0],r=a[1],s=null===(n=this.game)||void 0===n?void 0:n.gameObjects.spawnDoge({x:o,y:r,right:!1,isWorldPosition:!0,rigidBodyConfig:{gravityScale:2}});if(!(s instanceof L))throw new Error("Could not create doge");var l=s.getComponent(W);if(!l)throw new Error("Could not get rigidBody");l.sleep()}},{key:"initClock",value:function(){var e,t;null===(e=this.game)||void 0===e||e.uiManager.initCounting();var n=this.data.bestEndlessScore,i=void 0===n?0:n;null===(t=this.game)||void 0===t||t.uiManager.setBestScore(i)}},{key:"startGameAsync",value:(r=e((function*(){try{if(this.data.isFromLoader)return void this.updateGameData({isFromLoader:!1});yield Fd.startMatchAsync()}catch(e){console.error("startGameAsync",e)}})),function(){return r.apply(this,arguments)})}]),u}(vg);v._RF.pop(),v._RF.push({},"ecbe0PxfZNJBLsmLBPc2pBD","LoadingState",void 0);var kg=globalThis.game.player,Cg=function(e){t(r,e);var o=n(r);function r(e){var t,n,a,s;i(this,r),s=o.call(this,e);var l=null!==(t=null===(n=kg.getGameData())||void 0===n?void 0:n.bestEndlessScore)&&void 0!==t?t:0;return s.updateGameData({bestEndlessScore:l}),Ze.showLoadingScreen(),null===(a=s.game)||void 0===a||a.scheduleOnce((function(){s.initialize()}),.5),s}return a(r,[{key:"load",value:function(){}},{key:"initialize",value:function(){var e=this.manager.createInitializeState();this.manager.change(e)}},{key:"ready",value:function(){}},{key:"play",value:function(){}},{key:"death",value:function(){}},{key:"finish",value:function(){}},{key:"update",value:function(){}}]),r}(vg);v._RF.pop(),v._RF.push({},"651d4HD0HpFPLrL8dycqU3R","PlayingState",void 0);var wg=globalThis.game.player;function Eg(){var e=Object.keys(Cs).map((function(e){return parseInt(e)})).sort((function(e,t){return e-t})),t=0;return{current:function(){var n;return null!==(n=e[t])&&void 0!==n?n:0},canGoNext:function(n){var i=t+1;if(i>=e.length)return!1;var a=e[i];return!!a&&n>a},next:function(){var n;if(t>=e.length-1)throw new Error("No more progressions");return null!==(n=e[t++])&&void 0!==n?n:0}}}var Tg=function(e){t(r,e);var o=n(r);function r(e){var t;return i(this,r),(t=o.call(this,e)).totalElapsed=0,t.spawnElapsed=0,t.spawnInterval=2,t.flyForce=18,t.progressionIt=Eg(),t.onTouchStart=function(){t.dogeRigidBody.linearVelocity=new K(0,t.flyForce)},t.findDoge(),t.wakeUpObjects(),t.spawnEnemies(),t.startCounting(),Ve.turnDownMusic(),t.listenInputEvents(),t}return a(r,[{key:"listenInputEvents",value:function(){var e,t;G.os===G.OS.WINDOWS||G.os===G.OS.OSX?(document.addEventListener("pointerdown",this.onTouchStart),null===(e=this.game)||void 0===e||e.node.on(L.EventType.MOUSE_DOWN,this.onTouchStart)):null===(t=this.game)||void 0===t||t.node.on(L.EventType.TOUCH_START,this.onTouchStart)}},{key:"unlistenInputEvents",value:function(){var e,t;G.os===G.OS.WINDOWS||G.os===G.OS.OSX?(document.removeEventListener("pointerdown",this.onTouchStart),null===(e=this.game)||void 0===e||e.node.off(L.EventType.MOUSE_DOWN,this.onTouchStart)):null===(t=this.game)||void 0===t||t.node.off(L.EventType.TOUCH_START,this.onTouchStart)}},{key:"findDoge",value:function(){var e,t=null===(e=this.game)||void 0===e||null===(e=e.gameObjects)||void 0===e?void 0:e.getRandomDogeToBee();if(!t)throw new Error("No doge found in GameObjects");this.doge=t;var n=this.doge.getComponent(W);if(!n)throw new Error("No rigid body found in doge");this.dogeRigidBody=n}},{key:"load",value:function(){this.unlistenInputEvents();var e=this.manager.createLoadingState();this.manager.change(e)}},{key:"initialize",value:function(){this.unlistenInputEvents(),Ve.stopSound(qe.BEE_FLYING);var e=this.manager.createInitializeState();this.manager.change(e)}},{key:"ready",value:function(){}},{key:"play",value:function(){}},{key:"death",value:function(){this.unlistenInputEvents();var e=this.manager.createDeathState();this.manager.change(e)}},{key:"finish",value:function(){}},{key:"update",value:function(e){if(this.spawnElapsed+=e,this.totalElapsed+=e,this.progressionIt.canGoNext(this.totalElapsed)&&(this.progressionIt.next(),this.updateProgressionToPlugin()),this.spawnElapsed>this.spawnInterval){var t=this.progressionIt.current(),n=Cs[t];if(!n)return;this.handleSpawn(n),this.spawnElapsed=0}}},{key:"updateProgressionToPlugin",value:function(){var e;Fd.setProfileMatchDataAsync({id:wg.getPlayerId(),endlessScore:Math.round(null!==(e=this.data.bestEndlessScore)&&void 0!==e?e:0)})}},{key:"handleSpawn",value:function(e){if(!this.game)throw new Error("Game is not defined");var t=this.game.getBoundingBox(),n=0===Z.randomRangeInt(0,2)?t.xMin-0:t.xMax+0,i=this.doge.node.worldPosition.y+Z.randomRangeInt(-100,100),a=this.doge.node.getWorldPosition(),o=a.x,r=a.y,s=new _(n,i,0),l=s.x+2*(o-s.x),u=s.y+2*(r-s.y);this.spawnPredictionLine(s,l,u),this.spawnCrossingBee(o,r,s,e)}},{key:"spawnCrossingBee",value:function(e,t,n,i){var a=this;if(!this.game)throw new Error("Game is not defined. Only use this method in PlayingState");this.game.scheduleOnce((function(){a.game.gameObjects.spawnCrossingBees(d({playerWorldX:e,playerWorldY:t,spawnWorldX:n.x,spawnWorldY:n.y},i))}),1)}},{key:"spawnPredictionLine",value:function(e,t,n){if(!this.game)throw new Error("Game is not defined. Only use this method in PlayingState");var i=this.game.gameObjects.spawnCrossingBeeLine({startX:e.x,startY:e.y,endX:t,endY:n,spriteType:Hc.LOW,thickness:0});le(i).call((function(){Ve.playSound(qe.BEE_FLYING)})).to(.5,{thickness:80},{easing:"expoOut"}).start(),this.game.scheduleOnce((function(){le(i).to(.5,{thickness:0},{easing:"expoOut"}).call((function(){i.destroy(),Ve.stopSound(qe.BEE_FLYING)})).start()}),1)}},{key:"wakeUpObjects",value:function(){var e;null===(e=this.game)||void 0===e||null===(e=e.gameObjects)||void 0===e||e.wakeUpObjects(),this.dogeRigidBody.wakeUp()}},{key:"spawnEnemies",value:function(){this.game&&this.game.gameObjects&&(this.game.gameObjects.spawnBees(),this.game.gameObjects.reviveBigBees())}},{key:"startCounting",value:function(){var e;null===(e=this.game)||void 0===e||e.uiManager.startCounting()}}]),r}(vg);v._RF.pop(),v._RF.push({},"9516f5Gc/FENLPaNEZwDwcn","ReadyState",void 0);var Ag,Rg=globalThis.game.analytics,Pg=function(e){t(r,e);var o=n(r);function r(e){var t;return i(this,r),(t=o.call(this,e)).onTouchStart=function(){var e;t.manager.play(),null===(e=t.game)||void 0===e||e.handleHideTapToPlayText()},t.logLevelStartAnalytics(),t.listenInputEvents(),t}return a(r,[{key:"listenInputEvents",value:function(){var e,t;G.os===G.OS.WINDOWS||G.os===G.OS.OSX?(document.addEventListener("pointerdown",this.onTouchStart,{once:!0}),null===(e=this.game)||void 0===e||e.node.once(L.EventType.MOUSE_DOWN,this.onTouchStart)):null===(t=this.game)||void 0===t||t.node.once(L.EventType.TOUCH_START,this.onTouchStart)}},{key:"unlistenInputEvents",value:function(){var e,t;G.os===G.OS.WINDOWS||G.os===G.OS.OSX?(document.removeEventListener("pointerdown",this.onTouchStart),null===(e=this.game)||void 0===e||e.node.off(L.EventType.MOUSE_DOWN,this.onTouchStart)):null===(t=this.game)||void 0===t||t.node.off(L.EventType.TOUCH_START,this.onTouchStart)}},{key:"load",value:function(){if(this.unlistenInputEvents(),GameCore.Utils.Valid.isDebugger()){var e=this.manager.createLoadingState();this.manager.change(e)}}},{key:"initialize",value:function(){}},{key:"ready",value:function(){}},{key:"play",value:function(){this.unlistenInputEvents();var e=this.manager.createPlayingState();this.manager.change(e)}},{key:"death",value:function(){if(this.unlistenInputEvents(),GameCore.Utils.Valid.isDebugger()){var e=this.manager.createDeathState();this.manager.change(e)}}},{key:"finish",value:function(){}},{key:"update",value:function(){}},{key:"logLevelStartAnalytics",value:function(){Rg.levelStart(1,0,Es)}}]),r}(vg);v._RF.pop(),v._RF.push({},"946848BySlM54Wly5+1otNa","EndlessStateManager",void 0);var _g,Bg,Lg,Og,Dg,Ig,Ng,Fg,Gg,zg,Mg,xg=(0,m.ccclass)("EndlessStateManager")(Ag=function(e){t(r,e);var o=n(r);function r(){return i(this,r),o.apply(this,arguments)}return a(r,[{key:"init",value:function(){this.state=new Cg(this)}},{key:"change",value:function(e){this.state=e}},{key:"load",value:function(){this.state.load()}},{key:"initialize",value:function(){this.state.initialize()}},{key:"isInitialize",value:function(){return this.state instanceof Sg}},{key:"ready",value:function(){this.state.ready()}},{key:"isReady",value:function(){return this.state instanceof Pg}},{key:"play",value:function(){this.state.play()}},{key:"isPlaying",value:function(){return this.state instanceof Tg}},{key:"death",value:function(){this.state.death()}},{key:"isFailed",value:function(){return this.state instanceof mg}},{key:"finish",value:function(){this.state.finish()}},{key:"isFinished",value:function(){return this.state instanceof bg}},{key:"update",value:function(e){this.state&&this.state.update(e)}},{key:"createInitializeState",value:function(){return new Sg(this)}},{key:"createLoadingState",value:function(){return new Cg(this)}},{key:"createReadyState",value:function(){return new Pg(this)}},{key:"createPlayingState",value:function(){return new Tg(this)}},{key:"createDeathState",value:function(){return new mg(this)}},{key:"createFinishState",value:function(){return new bg(this)}}]),r}(k))||Ag;v._RF.pop(),v._RF.push({},"78746Q4viBIlbRROK4J1bSl","Burst",void 0);var Ug,Hg,jg,Vg,Wg,qg,Kg,Yg,Jg,Zg,Xg,Qg,$g,eb,tb,nb,ib,ab=m.ccclass,ob=m.property,rb=(_g=ab("Burst"),Bg=ob(U),Lg=ob(S),Og=ob(U),Dg=ob(S),_g((Fg=s((Ng=function(){function e(){i(this,e),l(this,"time",Fg,this),l(this,"repeatCount",Gg,this),l(this,"repeatInterval",zg,this),l(this,"count",Mg,this),this.remainingCount=0,this.curTime=0}return a(e,[{key:"update",value:function(e,t){if(0===this.remainingCount&&(this.remainingCount=this.repeatCount,this.curTime=this.time),this.remainingCount>0){var n=me(e.time-e.startDelay.evaluate(0,1),e.duration)-t;n=n>0?n:0;var i=me(e.time-e.startDelay.evaluate(0,1),e.duration);this.curTime>=n&&this.curTime<i&&(e.emit(this.count,t-(i-this.curTime)),this.curTime+=this.repeatInterval,--this.remainingCount)}}},{key:"reset",value:function(){this.remainingCount=0,this.curTime=0}}]),e}()).prototype,"time",[Bg],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Gg=s(Ng.prototype,"repeatCount",[Lg],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),zg=s(Ng.prototype,"repeatInterval",[Og],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Mg=s(Ng.prototype,"count",[Dg],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Ig=Ng))||Ig);v._RF.pop(),v._RF.push({},"00eb3NBo0tM/qcD6ViMjx0A","CurveRange",void 0);var sb,lb,ub,cb,hb,pb,db,yb,vb,fb,mb,gb,bb,Sb,kb,Cb,wb,Eb=m.ccclass,Tb=m.property,Ab=M({Constant:0,Curve:1,TwoCurves:2,TwoConstants:3}),Rb=(Ug=Eb("CurveRange"),Hg=Tb({type:M(Ab)}),jg=Tb({visible:function(){return this.mode===Ab.Constant}}),Vg=Tb({visible:function(){return this.mode===Ab.Curve}}),Wg=Tb({visible:function(){return this.mode===Ab.TwoCurves}}),qg=Tb({visible:function(){return this.mode===Ab.TwoCurves}}),Kg=Tb({visible:function(){return this.mode===Ab.TwoConstants}}),Yg=Tb({visible:function(){return this.mode===Ab.TwoConstants}}),Ug((Xg=s((Zg=function(){function e(){i(this,e),l(this,"mode",Xg,this),l(this,"constant",Qg,this),l(this,"spline",$g,this),l(this,"splineMin",eb,this),l(this,"splineMax",tb,this),l(this,"constantMin",nb,this),l(this,"constantMax",ib,this),this.spline.assignSorted([0,1],[0,1]),this.splineMin.assignSorted([0,1],[0,1]),this.splineMax.assignSorted([0,1],[0,1])}return a(e,[{key:"evaluate",value:function(e,t){switch(this.mode){case Ab.Curve:return this.spline.evaluate(e);case Ab.TwoCurves:return ge(this.splineMin.evaluate(e),this.splineMax.evaluate(e),t);case Ab.TwoConstants:return ge(this.constantMin,this.constantMax,t);default:return this.constant}}},{key:"getMax",value:function(){switch(this.mode){case Ab.Curve:return 1;case Ab.TwoConstants:return this.constantMax;case Ab.TwoCurves:return 1;default:return this.constant}}},{key:"isZero",value:function(){switch(this.mode){case Ab.Curve:return be(1,0,Se);case Ab.TwoConstants:return be(Math.max(Math.abs(this.constantMax),Math.abs(this.constantMin)),0,Se);case Ab.TwoCurves:return be(1,0,Se);default:return be(this.constant,0,Se)}}}]),e}()).prototype,"mode",[Hg],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Ab.Constant}}),Qg=s(Zg.prototype,"constant",[jg],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),$g=s(Zg.prototype,"spline",[Vg],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ke}}),eb=s(Zg.prototype,"splineMin",[Wg],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ke}}),tb=s(Zg.prototype,"splineMax",[qg],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ke}}),nb=s(Zg.prototype,"constantMin",[Kg],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ib=s(Zg.prototype,"constantMax",[Yg],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Jg=Zg))||Jg);v._RF.pop(),v._RF.push({},"3fe5eBRNTJFCZgeD7SqFSh5","GradientRange",void 0);var Pb=m.ccclass,_b=m.property,Bb=M({Color:0,Gradient:1,TwoColors:2,TwoGradients:3,RandomColor:4}),Lb=new I,Ob=new I,Db=(sb=Pb("GradientRange"),lb=_b({type:M(Bb)}),ub=_b({visible:function(){return this.mode===Bb.Color}}),cb=_b({visible:function(){return this.mode===Bb.TwoColors}}),hb=_b({visible:function(){return this.mode===Bb.TwoColors}}),pb=_b({visible:function(){return this.mode===Bb.Gradient||this.mode===Bb.RandomColor}}),db=_b({visible:function(){return this.mode===Bb.TwoGradients}}),yb=_b({visible:function(){return this.mode===Bb.TwoGradients}}),sb((mb=s((fb=function(){function e(){i(this,e),l(this,"mode",mb,this),l(this,"color",gb,this),l(this,"colorMin",bb,this),l(this,"colorMax",Sb,this),l(this,"gradient",kb,this),l(this,"gradientMin",Cb,this),l(this,"gradientMax",wb,this),this._color=I.WHITE.clone()}return a(e,[{key:"evaluate",value:function(e,t){switch(this.mode){case Bb.Color:return this.color;case Bb.TwoColors:return I.lerp(this._color,this.colorMin,this.colorMax,t),this._color;case Bb.RandomColor:return this.gradient.getRandomColor(this._color);case Bb.Gradient:return this.gradient.evaluateFast(this._color,e);case Bb.TwoGradients:return I.lerp(this._color,this.gradientMin.evaluateFast(Lb,e),this.gradientMax.evaluateFast(Ob,e),t),this._color;default:return this.color}}}]),e}()).prototype,"mode",[lb],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Bb.Color}}),gb=s(fb.prototype,"color",[ub],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return I.WHITE.clone()}}),bb=s(fb.prototype,"colorMin",[cb],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return I.WHITE.clone()}}),Sb=s(fb.prototype,"colorMax",[hb],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return I.WHITE.clone()}}),kb=s(fb.prototype,"gradient",[pb],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Ce}}),Cb=s(fb.prototype,"gradientMin",[db],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Ce}}),wb=s(fb.prototype,"gradientMax",[yb],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Ce}}),vb=fb))||vb);function Ib(e,t,n,i){!function(e,t){K.set(e,Math.cos(t),Math.sin(t))}(e,i),e.z=0,_.multiplyScalar(e,e,t+(n-t)*Ee())}function Nb(e){var t=Ab;switch(e.mode){case t.TwoCurves:case t.TwoConstants:return!0;default:return!1}}v._RF.pop(),v._RF.push({},"1a4c4Z/fWpFuL5b3emrVLug","ParticleFunction",void 0),v._RF.pop(),v._RF.push({},"370cbFjxn9GKJzqbTOhQZiA","ParticleSimulator",void 0);var Fb=new _(0,0,0),Gb=function(){function e(){i(this,e),this.pos=new _(0,0,0),this.color=new I(255,255,255,255),this.size=new _(0,0,0),this.startSize=new _(0,0,0),this.rotation=new _(0,0,0),this.startLifetime=0,this.remainingLifetime=0,this.randomSeed=0,this.velocity=new _(0,0),this.width=0,this.height=0}return a(e,[{key:"init",value:function(){this.pos.set(Fb),this.remainingLifetime=0,this.startLifetime=0,this.startSize.set(Fb),this.startColor=I.WHITE.clone(),this.velocity.set(Fb),this.randomSeed=0}}]),e}(),zb=new(function(e){t(r,e);var o=n(r);function r(){return i(this,r),o.apply(this,arguments)}return a(r,[{key:"get",value:function(){return this._get()||new Gb}}]),r}(Re.Pool))((function(e){e.pos.set(Fb),e.color._val=4294967295,e.size.set(Fb),e.rotation.set(Fb)}),1024),Mb=function(){function e(t){i(this,e),this.particles=[],this.active=!1,this.uvFilled=0,this.renderData=new _e,this.sys=t,this.particles=[],this.active=!1,this.uvFilled=0}return a(e,[{key:"stop",value:function(){this.active=!1}},{key:"reset",value:function(){this.active=!0;var e,t=this.particles,n=r(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;zb.put(i)}}catch(e){n.e(e)}finally{n.f()}t.length=0,this.renderData.resize(0,0)}},{key:"emitParticle",value:function(){var e=zb.get();return this.particles.push(e),e}},{key:"updateUVs",value:function(e){var t=this.renderData;if(t&&this.sys){var n=t.vData,i=this.sys.spriteFrame;if(!i)return;for(var a=i.uv,o=e?0:this.uvFilled,r=this.particles.length,s=o;s<r;s++){var l=9*s*4;n[l+3]=a[0],n[l+4]=a[1],n[l+12]=a[2],n[l+13]=a[3],n[l+21]=a[4],n[l+22]=a[5],n[l+30]=a[6],n[l+31]=a[7]}this.uvFilled=r}}},{key:"updateParticleBuffer",value:function(e,t,n,i){var a=n.vData,o=t.x,r=t.y,s=t.z,l=e.width*e.size.x/2,u=e.height*e.size.y/2,c=e.rotation.x||0,h=e.rotation.y||0,p=e.rotation.z||0;if(0===c&&0===h&&0===p)a[i]=o-l,a[i+1]=r-u,a[i+2]=s,a[i+9]=o+l,a[i+10]=r-u,a[i+11]=s,a[i+18]=o-l,a[i+19]=r+u,a[i+20]=s,a[i+27]=o+l,a[i+28]=r+u,a[i+29]=s;else{var d=function(e,t,n){var i=t*m-n*g,a=t*g+n*m,o=e*b+a*S;return new _(o*k-i*C,o*C+i*k,a*b-e*S)},y=-Pe.degreesToRadians(c),v=-Pe.degreesToRadians(h),f=-Pe.degreesToRadians(p),m=Math.cos(y),g=Math.sin(y),b=Math.cos(v),S=Math.sin(v),k=Math.cos(f),C=Math.sin(f),w=[d(-l,-u,0),d(l,-u,0),d(-l,u,0),d(l,u,0)];a[i]=w[0].x+o,a[i+1]=w[0].y+r,a[i+2]=w[0].z+s,a[i+9]=w[1].x+o,a[i+10]=w[1].y+r,a[i+11]=w[1].z+s,a[i+18]=w[2].x+o,a[i+19]=w[2].y+r,a[i+20]=w[2].z+s,a[i+27]=w[3].x+o,a[i+28]=w[3].y+r,a[i+29]=w[3].z+s}I.toArray(a,e.color,i+5),I.toArray(a,e.color,i+14),I.toArray(a,e.color,i+23),I.toArray(a,e.color,i+32)}},{key:"step",value:function(e){var t=this.sys.node,n=this.particles;t.updateWorldTransform(),this.active&&this.sys.emitting(e);var i=this.renderData,a=n.length;i.reset(),this.requestData(4*a,6*a),a>this.uvFilled&&this.updateUVs();for(var o=0;o<n.length;){var r=n[o];if(r)if(r.remainingLifetime-=e,r.remainingLifetime>0){var s=9*o*4;this.updateParticleBuffer(r,r.pos,i,s),++o}else{var l=n[o];o!==n.length-1&&(n[o]=n[n.length-1]),zb.put(l),n.length--,i.resize(i.vertexCount-4,i.indexCount-6)}}this.renderData.material=this.sys.getRenderMaterial(0),this.renderData.frame=this.sys.spriteFrame,i.setRenderDrawInfoAttributes()}},{key:"requestData",value:function(e,t){var n=this.renderData.indexCount;this.renderData.request(e,t);for(var i=this.renderData.indexCount/6,a=this.renderData.iData,o=n;o<i;o++){var r=4*o;a[n++]=r,a[n++]=r+1,a[n++]=r+2,a[n++]=r+1,a[n++]=r+3,a[n++]=r+2}}},{key:"initDrawInfo",value:function(){this.renderData.setRenderDrawInfoAttributes()}}]),e}();v._RF.pop(),v._RF.push({},"c2fc2/T2apMGZCPX5a4abo/","ModuleRandSeed",void 0);var xb,Ub,Hb,jb,Vb,Wb,qb,Kb=23541,Yb=39825,Jb=91041,Zb=125292,Xb=197866,Qb=156497;v._RF.pop(),v._RF.push({},"39785+APfBJU5kvcdjZGiLr","ColorOvertimeModule",void 0);var $b,eS,tS,nS,iS,aS,oS,rS,sS,lS=m.ccclass,uS=m.property,cS=Jb,hS=(xb=lS("ColorOvertimeModule"),Ub=uS({type:R}),Hb=uS({type:Db}),xb((Wb=s((Vb=function(){function e(){i(this,e),l(this,"enable",Wb,this),l(this,"color",qb,this)}return a(e,[{key:"update",value:function(e){if(this.enable){e.color.set(e.startColor);var t=function(e){var t=Bb;switch(e.mode){case t.TwoGradients:case t.TwoColors:return!0;default:return!1}}(this.color)?Be(e.randomSeed+cS):0;e.color.multiply(this.color.evaluate(1-e.remainingLifetime/e.startLifetime,t))}}}]),e}()).prototype,"enable",[Ub],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qb=s(Vb.prototype,"color",[Hb],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Db}}),jb=Vb))||jb);v._RF.pop(),v._RF.push({},"c397apirpxFfJTJN1KLAcGi","LimitVelocityOvertimeModule",void 0);var pS,dS,yS,vS,fS,mS,gS,bS,SS,kS,CS,wS,ES,TS=m.ccclass,AS=m.property,RS=Kb,PS=($b=TS("LimitVelocityOvertimeModule"),eS=AS({type:R}),tS=AS({type:Rb}),nS=AS({type:Rb}),$b((oS=s((aS=function(){function e(){i(this,e),l(this,"enable",oS,this),l(this,"limit",rS,this),l(this,"dampen",sS,this),this.limit.constant=500,this.dampen.constant=.2}return a(e,[{key:"update",value:function(e,t){if(this.enable){var n=1-e.remainingLifetime/e.startLifetime,i=e.velocity.clone().normalize(),a=Nb(this.limit)?Be(e.randomSeed+RS):0,o=Nb(this.dampen)?Be(e.randomSeed+RS+1):0,r=e.velocity.length(),s=this.limit.evaluate(n,a),l=this.dampen.evaluate(n,o);e.velocity=i.multiplyScalar(this.dampenBeyondLimit(r,s,l,t))}}},{key:"dampenBeyondLimit",value:function(e,t,n,i){if(e<=t)return e;var a=1-Math.exp(-n*i);return Z.lerp(e,t,a)}}]),e}()).prototype,"enable",[eS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rS=s(aS.prototype,"limit",[tS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Rb}}),sS=s(aS.prototype,"dampen",[nS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Rb}}),iS=aS))||iS);v._RF.pop(),v._RF.push({},"c6cfbhYVctHt53aUXC4oSWy","RotationOvertimeModule",void 0);var _S,BS,LS,OS,DS,IS,NS,FS,GS,zS,MS,xS,US,HS,jS,VS,WS,qS,KS,YS,JS,ZS,XS,QS=m.ccclass,$S=m.property,ek=Zb,tk=(pS=QS("RotationOvertimeModule"),dS=$S({type:R}),yS=$S(R),vS=$S({type:Rb,visible:function(){return this.separateAxes}}),fS=$S({type:Rb,visible:function(){return this.separateAxes}}),mS=$S({type:Rb}),pS((SS=s((bS=function(){function e(){i(this,e),l(this,"enable",SS,this),l(this,"separateAxes",kS,this),l(this,"x",CS,this),l(this,"y",wS,this),l(this,"z",ES,this)}return a(e,[{key:"update",value:function(e,t){if(this.enable){var n=1-e.remainingLifetime/e.startLifetime,i=e.randomSeed+ek,a=Nb(this.z)?Be(i):0,o=this.z.evaluate(n,a)*t,r=0,s=0;if(this.separateAxes){var l=Nb(this.x)?Be(i):0,u=Nb(this.y)?Be(i):0;r=this.x.evaluate(n,l)*t,s=this.y.evaluate(n,u)*t}e.rotation.add3f(r,s,o)}}}]),e}()).prototype,"enable",[dS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kS=s(bS.prototype,"separateAxes",[yS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),CS=s(bS.prototype,"x",[vS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Rb}}),wS=s(bS.prototype,"y",[fS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Rb}}),ES=s(bS.prototype,"z",[mS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Rb}}),gS=bS))||gS);v._RF.pop(),v._RF.push({},"f63cd4ScDJFPrnTLNT4+QKu","ShapeModule",void 0);var nk,ik,ak,ok,rk,sk,lk,uk,ck,hk,pk,dk,yk,vk=m.ccclass,fk=m.property,mk=M({Circle:0,Rectangle:1}),gk=M({Base:0,Edge:1}),bk=function(){return this.shape===mk.Circle},Sk=function(){return this.shape===mk.Rectangle},kk=[0,0],Ck=(_S=vk("ShapeModule"),BS=fk({type:M(mk)}),LS=fk({type:M(gk),visible:Sk}),OS=fk({}),DS=fk({}),IS=fk({}),NS=fk({range:[0,360],visible:bk}),FS=fk({range:[-360,360],visible:bk}),GS=fk({min:0,visible:bk}),zS=fk({range:[0,1],step:.01,visible:bk}),MS=fk({visible:Sk}),_S((HS=s((US=function(){function e(){i(this,e),l(this,"shape",HS,this),l(this,"emitFrom",jS,this),l(this,"position",VS,this),l(this,"rotation",WS,this),l(this,"scale",qS,this),l(this,"arc",KS,this),l(this,"angle",YS,this),l(this,"radius",JS,this),l(this,"radiusThickness",ZS,this),l(this,"rectangleThickness",XS,this)}return a(e,[{key:"emit",value:function(e){switch(this.shape){case mk.Circle:this.circleEmit(this.radius,this.radiusThickness,Le(this.generateArcAngle()),e);break;case mk.Rectangle:this.rectangleEmit(this.emitFrom,this.rectangleThickness,e)}}},{key:"circleEmit",value:function(e,t,n,i){var a=i.pos;Ib(a,e*(1-t),e,n+Le(this.angle)),i.velocity=a.clone().normalize()}},{key:"rectangleEmit",value:function(e,t,n){var i,a,o,r=n.pos;switch(e){case gk.Base:a=r,o=t,K.set(a,Te(-o.x,o.x),Te(-o.y,o.y));break;case gk.Edge:kk[0]=Te(-1,1),kk[1]=(0===(i=Te(-1,1))&&i++,we.sign(i)),function(e){for(var t=0;t<e.length;t++){var n=t+Ae(0,e.length-t),i=e[n];e[n]=e[t],e[t]=i}}(kk),this.applyRectThickness(kk,t),K.set(r,kk[0],kk[1])}n.velocity=r.clone().normalize()}},{key:"generateArcAngle",value:function(){return Te(0,this.arc)}},{key:"applyRectThickness",value:function(e,t){t.x>0&&(e[0]*=t.x),t.y>0&&(e[1]*=t.y)}},{key:"gizmo",value:function(e){switch(e.strokeColor.fromHEX("#46C4FFB0"),e.fillColor.fromHEX("#46C4FF77"),e.lineWidth=8,this.shape){case mk.Circle:this.gizmoCircle(e);break;case mk.Rectangle:this.gizmoRectangle(e)}}},{key:"gizmoCircle",value:function(e){e.clear();var t=this.angle,n=this.angle+this.arc;if(this.createArcPath(e,this.radius,t,n),this.createArcPath(e,this.radius*(1-this.radiusThickness),t,n),this.arc<360&&this.radius>0){var i=this.radius*Math.cos(Le(this.angle)),a=this.radius*Math.sin(Le(this.angle)),o=this.radius*Math.cos(Le(this.arc+this.angle)),r=this.radius*Math.sin(Le(this.arc+this.angle));e.moveTo(i,a),e.lineTo(0,0),e.moveTo(o,r),e.lineTo(0,0)}e.stroke()}},{key:"gizmoRectangle",value:function(e){e.clear();var t=this.rectangleThickness.x,n=this.rectangleThickness.y;e.moveTo(t,n),e.lineTo(-t,n),e.lineTo(-t,-n),e.lineTo(t,-n),e.close(),e.stroke()}},{key:"createArcPath",value:function(e,t,n,i){if(!(t<=0))for(var a=(i-n)/48,o=0;o<=48;o++){var r=n+o*a,s=t*Math.cos(Le(r)),l=t*Math.sin(Le(r));0===o?e.moveTo(s,l):e.lineTo(s,l)}}}]),e}()).prototype,"shape",[BS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return mk.Circle}}),jS=s(US.prototype,"emitFrom",[LS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return gk.Base}}),VS=s(US.prototype,"position",[OS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new _(0,0,0)}}),WS=s(US.prototype,"rotation",[DS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new _(0,0,0)}}),qS=s(US.prototype,"scale",[IS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new _(1,1,1)}}),KS=s(US.prototype,"arc",[NS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 360}}),YS=s(US.prototype,"angle",[FS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 25}}),JS=s(US.prototype,"radius",[GS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),ZS=s(US.prototype,"radiusThickness",[zS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),XS=s(US.prototype,"rectangleThickness",[MS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new K(20,50)}}),xS=US))||xS);v._RF.pop(),v._RF.push({},"1b7c1WztGdLzKO8gh4ulm2c","SizeOvertimeModule",void 0);var wk,Ek,Tk,Ak,Rk,Pk,_k,Bk,Lk,Ok=m.ccclass,Dk=m.property,Ik=Yb,Nk=(nk=Ok("SizeOvertimeModule"),ik=Dk({type:R}),ak=Dk(R),ok=Dk({type:Rb,visible:function(){return!this.separateAxes}}),rk=Dk({type:Rb,visible:function(){return this.separateAxes}}),sk=Dk({type:Rb,visible:function(){return this.separateAxes}}),nk((ck=s((uk=function(){function e(){i(this,e),l(this,"enable",ck,this),l(this,"separateAxes",hk,this),l(this,"size",pk,this),l(this,"x",dk,this),l(this,"y",yk,this),this.size.constant=1,this.x.constant=1,this.y.constant=1}return a(e,[{key:"update",value:function(e){if(this.enable){var t=1-e.remainingLifetime/e.startLifetime,n=e.randomSeed+Ik;if(this.separateAxes){var i=Nb(this.x)?Be(n):0,a=Nb(this.y)?Be(n):0;e.size.x=e.startSize.x*this.x.evaluate(t,i),e.size.y=e.startSize.y*this.y.evaluate(t,a)}else{var o=Nb(this.size)?Be(n):0,r=this.size.evaluate(t,o);_.multiplyScalar(e.size,e.startSize,r)}}}}]),e}()).prototype,"enable",[ik],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hk=s(uk.prototype,"separateAxes",[ak],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),pk=s(uk.prototype,"size",[ok],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Rb}}),dk=s(uk.prototype,"x",[rk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Rb}}),yk=s(uk.prototype,"y",[sk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Rb}}),lk=uk))||lk);v._RF.pop(),v._RF.push({},"f6ad5Yz6wpE2ZzModn16CYQ","VelocityOvertimeModule",void 0);var Fk,Gk,zk,Mk,xk,Uk,Hk,jk,Vk,Wk,qk,Kk,Yk,Jk,Zk,Xk,Qk,$k,eC,tC,nC,iC,aC,oC,rC,sC,lC,uC,cC,hC,pC,dC,yC,vC,fC,mC,gC,bC,SC,kC,CC,wC,EC,TC,AC,RC,PC,_C,BC,LC,OC,DC,IC,NC,FC,GC,zC,MC,xC,UC,HC,jC=m.ccclass,VC=m.property,WC=(wk=jC("VelocityOvertimeModule"),Ek=VC({type:R}),Tk=VC({type:Rb}),Ak=VC({type:Rb}),wk((_k=s((Pk=function(){function e(){i(this,e),l(this,"enable",_k,this),l(this,"x",Bk,this),l(this,"y",Lk,this),this._temp_v3=new _,this.x.constant=0,this.y.constant=0}return a(e,[{key:"update",value:function(e,t){if(this.enable){var n=1-e.remainingLifetime/e.startLifetime,i=Nb(this.x)?Be(e.randomSeed+Xb):0,a=Nb(this.y)?Be(e.randomSeed+Qb):0,o=_.set(this._temp_v3,this.x.evaluate(n,i),this.y.evaluate(n,a),0);e.velocity.add(o.multiplyScalar(t))}}}]),e}()).prototype,"enable",[Ek],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bk=s(Pk.prototype,"x",[Tk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Rb}}),Lk=s(Pk.prototype,"y",[Ak],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Rb}}),Rk=Pk))||Rk);v._RF.pop(),v._RF.push({},"10bc3IfFqBLtpSgVri/NVeX","ParticleSystem",void 0);var qC,KC,YC,JC,ZC,XC,QC,$C=m.ccclass,ew=m.property,tw=m.executeInEditMode,nw=m.disallowMultiple,iw=m.playOnFocus,aw=Oe.Attr.setClassAttr,ow=M({World:0,Local:1}),rw=(Fk=$C("ParticleSystem"),Gk=tw(!0),zk=nw(!0),Mk=iw(!0),xk=ew({}),Uk=ew({formerlySerializedAs:"preview"}),Hk=ew(R),jk=ew({type:M(ow)}),Vk=ew({formerlySerializedAs:"simulationSpace"}),Wk=ew(U),qk=ew(R),Kk=ew({type:Rb}),Yk=ew({type:Rb}),Jk=ew(Db),Zk=ew(R),Xk=ew({type:Rb,formerlySerializedAs:"startSize"}),Qk=ew({type:Rb,visible:function(){return this.startSize2D}}),$k=ew({type:Rb}),eC=ew(R),tC=ew({type:Rb,visible:function(){return this.startRotation3D}}),nC=ew({type:Rb,visible:function(){return this.startRotation3D}}),iC=ew({type:Rb,formerlySerializedAs:"startRotation"}),aC=ew({type:Rb}),oC=ew({type:Rb}),rC=ew({type:Ck}),sC=ew({type:WC}),lC=ew({type:Nk}),uC=ew({type:tk}),cC=ew({type:hS}),hC=ew({type:PS}),pC=ew(rb),dC=ew({serializable:!0}),yC=ew({type:X}),Fk(vC=Gk(vC=zk(vC=Mk((s((fC=function(e){t(s,e);var o=n(s);function s(){var e;return i(this,s),e=o.call(this),l(e,"_preview",mC,u(e)),l(e,"playOnAwake",gC,u(e)),l(e,"_simulationSpace",bC,u(e)),l(e,"duration",SC,u(e)),l(e,"loop",kC,u(e)),l(e,"startDelay",CC,u(e)),l(e,"startLifetime",wC,u(e)),l(e,"startColor",EC,u(e)),l(e,"startSize2D",TC,u(e)),l(e,"startSizeX",AC,u(e)),l(e,"startSizeY",RC,u(e)),l(e,"startSpeed",PC,u(e)),l(e,"startRotation3D",_C,u(e)),l(e,"startRotationX",BC,u(e)),l(e,"startRotationY",LC,u(e)),l(e,"startRotationZ",OC,u(e)),l(e,"gravityModifier",DC,u(e)),l(e,"rateOverTime",IC,u(e)),l(e,"shapeModule",NC,u(e)),l(e,"velocityOvertimeModule",FC,u(e)),l(e,"sizeOvertimeModule",GC,u(e)),l(e,"rotationOvertimeModule",zC,u(e)),l(e,"colorOvertimeModule",MC,u(e)),l(e,"limitVelocityOvertimeModule",xC,u(e)),l(e,"bursts",UC,u(e)),l(e,"_spriteFrame",HC,u(e)),e._renderSpriteFrame=null,e.time=0,e.emitRateTimeCounter=0,e.isPlaying=!1,e.isStopped=!0,e.isEmitting=!1,e.startLifetime.constant=5,e.startSizeX.constant=1,e.startSpeed.constant=5,e.rateOverTime.constant=10,e.initProperties(),e}return a(s,[{key:"preview",get:function(){return this._preview},set:function(e){this._preview=e,e?this._startPreview():this._stopPreview()}},{key:"simulationSpace",get:function(){return this._simulationSpace},set:function(e){this._simulationSpace=e,this._updateMaterial(),this._updateSimulationSpace()}},{key:"spriteFrame",get:function(){return this._spriteFrame},set:function(e){this._renderSpriteFrame!==e&&(this._renderSpriteFrame=e,e&&!e._uuid||(this._spriteFrame=e),this._applySpriteFrame())}},{key:"assembler",get:function(){return this._assembler}},{key:"onEnable",value:function(){h(p(s.prototype),"onEnable",this).call(this),this._updateMaterial(),this._updateSimulationSpace()}},{key:"onDestroy",value:function(){h(p(s.prototype),"onDestroy",this).call(this)}},{key:"initProperties",value:function(){this._simulator=new Mb(this)}},{key:"onFocusInEditor",value:function(){this._startPreview()}},{key:"onLostFocusInEditor",value:function(){this._stopPreview()}},{key:"_startPreview",value:function(){this._preview&&this.play()}},{key:"_stopPreview",value:function(){this._preview||(this.play(),this.stop())}},{key:"__preload",value:function(){h(p(s.prototype),"__preload",this).call(this),this.spriteFrame&&!this._renderSpriteFrame&&this._applySpriteFrame(),this.playOnAwake&&this.play()}},{key:"start",value:function(){this.node.position=new _(this.node.position.x,this.node.position.y,100)}},{key:"play",value:function(){this.isStopped&&(this.isStopped=!1),this.time=0,this.isPlaying=!0,this.isStopped=!1,this.isEmitting=!0,this._simulator.reset(),this.markForUpdateRenderData()}},{key:"stop",value:function(){this.isPlaying&&(this.isPlaying=!1),this.isEmitting&&(this.isEmitting=!1),this.isStopped=!0,this._simulator.reset(),this._simulator.stop()}},{key:"_flushAssembler",value:function(){var e=De.Assembler.getAssembler(this);this._assembler!==e&&(this._assembler=e),this._assembler&&this._assembler.createData&&(this._simulator.renderData=this._assembler.createData(this),this._simulator.renderData.particleInitRenderDrawInfo(this.renderEntity),this._simulator.initDrawInfo())}},{key:"_applySpriteFrame",value:function(){this._renderSpriteFrame=this._renderSpriteFrame||this._spriteFrame,this._renderSpriteFrame?this._renderSpriteFrame.texture&&(this._simulator&&this._simulator.updateUVs(!0),this._updateMaterial(),this.isStopped=!1,this.markForUpdateRenderData()):this.stop()}},{key:"_updateMaterial",value:function(){if(this._customMaterial){this.setSharedMaterial(this._customMaterial,0);var e=this.getRenderMaterial(0).passes[0].blendState.targets[0];e&&(this._dstBlendFactor=e.blendDst,this._srcBlendFactor=e.blendSrc)}var t=this.getMaterialInstance(0);t&&t.recompileShaders({USE_LOCAL:this.simulationSpace===ow.Local}),t&&t.passes.length>0&&this._updateBlendFunc()}},{key:"_finishedSimulation",value:function(){this.stop(),this.markForUpdateRenderData()}},{key:"_canRender",value:function(){return h(p(s.prototype),"_canRender",this).call(this)&&!this.isStopped&&null!==this._renderSpriteFrame&&void 0!==this._renderSpriteFrame}},{key:"_render",value:function(e){this.simulationSpace===ow.Local?e.commitComp(this,this._simulator.renderData,this._renderSpriteFrame,this._assembler,this.node):this.simulationSpace===ow.World&&e.commitComp(this,this._simulator.renderData,this._renderSpriteFrame,this._assembler,null)}},{key:"_updateSimulationSpace",value:function(){this.simulationSpace===ow.Local?(this._renderEntity.setRenderTransform(this.node),this._renderEntity.setUseLocal(!0)):this.simulationSpace===ow.World&&(this._renderEntity.setRenderTransform(null),this._renderEntity.setUseLocal(!1))}},{key:"lateUpdate",value:function(e){this.isPlaying&&(this.time+=e,this._simulator.step(e))}},{key:"emitting",value:function(e){var t=this,n=this.startDelay.evaluate(0,1);if(this.time>n&&this.time>this.duration+n&&(this.loop||(this.isEmitting=!1)),this.isEmitting){if(this.emitRateTimeCounter+=this.rateOverTime.evaluate(this.time/this.duration,1)*e,this.emitRateTimeCounter>1){var i=Math.floor(this.emitRateTimeCounter);this.emitRateTimeCounter-=i,this.emit(i,e)}var a,o=r(this.bursts);try{for(o.s();!(a=o.n()).done;){a.value.update(this,e)}}catch(e){o.e(e)}finally{o.f()}}var s=this.gravityModifier.evaluate(this.time/this.duration,1);0!==this._simulator.particles.length||this.isEmitting||!this.isPlaying?this._simulator.particles.forEach((function(n,i){t.sizeOvertimeModule.update(n),t.rotationOvertimeModule.update(n,e),t.colorOvertimeModule.update(n),t.velocityOvertimeModule.update(n,e),t.applyGravityModifier(n,s),t.limitVelocityOvertimeModule.update(n,e),n.pos.add(n.velocity.clone().multiplyScalar(e))})):this._finishedSimulation()}},{key:"emit",value:function(e,t){if(null!==this.spriteFrame)for(var n=this.time%this.duration/this.duration,i=0;i<e;i++){var a=this._simulator.emitParticle();if(a.init(),this.shapeModule.emit(a),this.simulationSpace===ow.World){var o=this.node.worldMatrix;a.pos.x+=o.m12,a.pos.y+=o.m13}var r=this.startSpeed.evaluate(n,this.rand());a.velocity.multiplyScalar(r),a.width=this.spriteFrame.width,a.height=this.spriteFrame.height;var s=this.startSizeX.evaluate(n,this.rand()),l=this.startSize2D?new _(s,this.startSizeY.evaluate(n,this.rand()),1):new _(s,s,1);a.startSize=l.clone(),a.size=l.clone();var u=this.startRotationZ.evaluate(n,this.rand()),c=this.startRotation3D?new _(this.startRotationX.evaluate(n,this.rand()),this.startRotationY.evaluate(n,this.rand()),u):new _(0,0,u);a.rotation=c,a.startColor=this.startColor.evaluate(n,this.rand()).clone(),a.color=a.startColor.clone(),a.startLifetime=this.startLifetime.evaluate(n,this.rand())+t,a.remainingLifetime=a.startLifetime,a.randomSeed=Ae(0,233280)}}},{key:"applyGravityModifier",value:function(e,t){e.velocity.add(new _(0,-9.8*t,0))}},{key:"rand",value:function(){return Be(Ae(0,we.INT_MAX))}}]),s}(Ie)).prototype,"preview",[xk],Object.getOwnPropertyDescriptor(fC.prototype,"preview"),fC.prototype),mC=s(fC.prototype,"_preview",[Uk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),gC=s(fC.prototype,"playOnAwake",[Hk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),s(fC.prototype,"simulationSpace",[jk],Object.getOwnPropertyDescriptor(fC.prototype,"simulationSpace"),fC.prototype),bC=s(fC.prototype,"_simulationSpace",[Vk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return ow.Local}}),SC=s(fC.prototype,"duration",[Wk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),kC=s(fC.prototype,"loop",[qk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),CC=s(fC.prototype,"startDelay",[Kk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Rb}}),wC=s(fC.prototype,"startLifetime",[Yk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Rb}}),EC=s(fC.prototype,"startColor",[Jk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Db}}),TC=s(fC.prototype,"startSize2D",[Zk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),AC=s(fC.prototype,"startSizeX",[Xk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Rb}}),RC=s(fC.prototype,"startSizeY",[Qk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Rb}}),PC=s(fC.prototype,"startSpeed",[$k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Rb}}),_C=s(fC.prototype,"startRotation3D",[eC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),BC=s(fC.prototype,"startRotationX",[tC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Rb}}),LC=s(fC.prototype,"startRotationY",[nC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Rb}}),OC=s(fC.prototype,"startRotationZ",[iC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Rb}}),DC=s(fC.prototype,"gravityModifier",[aC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Rb}}),IC=s(fC.prototype,"rateOverTime",[oC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Rb}}),NC=s(fC.prototype,"shapeModule",[rC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Ck}}),FC=s(fC.prototype,"velocityOvertimeModule",[sC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new WC}}),GC=s(fC.prototype,"sizeOvertimeModule",[lC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Nk}}),zC=s(fC.prototype,"rotationOvertimeModule",[uC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new tk}}),MC=s(fC.prototype,"colorOvertimeModule",[cC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new hS}}),xC=s(fC.prototype,"limitVelocityOvertimeModule",[hC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new PS}}),UC=s(fC.prototype,"bursts",[ew,pC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),HC=s(fC.prototype,"_spriteFrame",[dC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),s(fC.prototype,"spriteFrame",[yC],Object.getOwnPropertyDescriptor(fC.prototype,"spriteFrame"),fC.prototype),vC=fC))||vC)||vC)||vC)||vC);aw(rw,"color","visible",!1),v._RF.pop(),v._RF.push({},"442c2KaGHdNip4TBoeKOOoY","RendererModule",void 0);var sw,lw=m.ccclass,uw=m.property;qC=lw("RendererModule"),KC=uw(Ne),YC=uw(X),qC((XC=s((ZC=a((function e(){i(this,e),l(this,"material",XC,this),l(this,"spriteFrame",QC,this)}))).prototype,"material",[KC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QC=s(ZC.prototype,"spriteFrame",[YC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JC=ZC));v._RF.pop(),v._RF.push({},"21a9aAlkBtGxKLqip8g0o6l","ParticleSystem2DExtra",void 0);var cw,hw=m.ccclass,pw=m.disallowMultiple,dw=m.executeInEditMode,yw=m.requireComponent,vw=hw("ParticleSystem2DExtra")(sw=dw(!0)(sw=pw(!0)(sw=yw(De)(sw=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).emitParticle=function(t){return function(n){t(n);var i=e.particleSystem._simulator.particles.length,a=e.particleSystem._simulator.particles[i-1];e.initParticle(a)}},e.step=function(t){return function(n){for(var i=e.particleSystem._simulator.particles,a=0;a<i.length;a++){var o=i[a];e.updateParticle(o,n)}t(n)}},e}return a(r,[{key:"__preload",value:function(){this.particleSystem=this.getComponent(De),this.validateRequiredComponents(),this.overrideFunctions()}},{key:"overrideFunctions",value:function(){var e=this.particleSystem._simulator.emitParticle.bind(this.particleSystem._simulator);this.particleSystem._simulator.emitParticle=this.emitParticle(e);var t=this.particleSystem._simulator.step.bind(this.particleSystem._simulator);this.particleSystem._simulator.step=this.step(t)}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}}]),r}(k))||sw)||sw)||sw)||sw;v._RF.pop(),v._RF.push({},"9a5a3MgLaRAKbHluGCPsA8j","ExampleParticleSystem2DExtra",void 0);var fw;(0,m.ccclass)("ExampleParticleSystem2DExtra")(cw=function(e){t(r,e);var o=n(r);function r(){return i(this,r),o.apply(this,arguments)}return a(r,[{key:"initParticle",value:function(e){e.maxSize=Z.randomRange(.25,1)*e.size,e.size=0,e.deltaSize=0,e.cycleDuration=Z.randomRange(.4,.6),e.life=e.timeToLive,this.setInitPosition(e.pos)}},{key:"updateParticle",value:function(e,t){this.updateScale(e)}},{key:"setInitPosition",value:function(e){var t=e.x,n=e.y;return e.x=t+Z.randomRange(-350,350),e.y=n+Z.randomRange(-350,350),e}},{key:"updateScale",value:function(e){var t=1-(e.life-e.timeToLive)%e.cycleDuration/e.cycleDuration;e.size=e.maxSize*Math.sin(t*Math.PI)}}]),r}(vw));v._RF.pop(),v._RF.push({},"4a9beTdMntC0q9yngb8a2go","BootScene",void 0);var mw,gw=m.ccclass,bw=m.disallowMultiple,Sw=GameCore,kw=Sw.Events,Cw=Sw.Configs.Core.StartSDKAfterLoadGame,ww=globalThis.game,Ew=ww.ads,Tw=(ww.player,ww.event);gw("BootScene")(fw=bw(fw=function(o){t(l,o);var r,s=n(l);function l(){var e;i(this,l);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=s.call.apply(s,[this].concat(n))).setupLoadingFullScreen=function(){Cw||Ze.showLoadingFullScreen(et.BOOT_SCENE)},e.processWhenGameSdkStarted=function(){e.sendMsGamesDailyNotification()},e.handlePauseAudio=function(){Tw.on(kw.VISIBILITY_HIDDEN,e.handleMuteAudio),Tw.on(kw.VISIBILITY_VISIBLE,e.handleUnMuteAudio)},e.handleMuteAudio=function(){Ve.muteAudio(!0)},e.handleUnMuteAudio=function(){Ew.isAdFullSizeShowing()||Ve.muteAudio(!1)},e}return a(l,[{key:"__preload",value:function(){this.setupAndroidPlatformAds(),this.processCrazyGamesLoadingStart(),this.listenEvents()}},{key:"onLoad",value:function(){this.handlePauseAudio(),this.preloadNotificationScreen(),this.setupLoadingFullScreen()}},{key:"start",value:function(){this.processCrazyGamesLoadingStop(),T.emit(Me.REQUEST_VIEW_RESIZE)}},{key:"listenEvents",value:function(){Tw.catchUp(kw.GAME_SDK_STARTED,this.processWhenGameSdkStarted)}},{key:"processCrazyGamesLoadingStart",value:function(){"gameLoadingStart"in GameSDK.extra&&GameSDK.extra.gameLoadingStart()}},{key:"processCrazyGamesLoadingStop",value:function(){"gameLoadingStop"in GameSDK.extra&&GameSDK.extra.gameLoadingStop()}},{key:"setupAndroidPlatformAds",value:function(){}},{key:"sendMsGamesDailyNotification",value:function(){var e=GameSDK.extra;"sendDailyNotificationAsync"in e&&e.sendDailyNotificationAsync().catch((function(e){console.warn("sendMsGamesDailyNotification",e)}))}},{key:"preloadNotificationScreen",value:(r=e((function*(){yield ze.preloadPrefab("screens/NotificationScreen")})),function(){return r.apply(this,arguments)})}]),l}(k))||fw);v._RF.pop(),v._RF.push({},"c4e30ckJiFBG4VHrF+wikMs","DashboardScene",void 0);var Aw,Rw=m.ccclass,Pw=m.disallowMultiple;Rw("DashboardScene")(mw=Pw(mw=function(e){t(r,e);var o=n(r);function r(){return i(this,r),o.apply(this,arguments)}return a(r,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"start",value:function(){this.scheduleOnce(this.preloadScenes,1)}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"preloadScenes",value:function(){$e.preloadGameScene()}},{key:"handleSingleButtonClicked",value:function(){$e.switchToGameScene()}},{key:"handleEndlessButtonClicked",value:function(){$e.switchToEndlessScene()}},{key:"handleTestLayoutButtonClicked",value:function(){$e.switchScene(et.TEST_LAYOUT_SCENE)}}]),r}(k))||mw);v._RF.pop(),v._RF.push({},"22d76GFn6BEoKFiZCFN1HmA","DraftScene",void 0);var _w,Bw=m.ccclass,Lw=m.disallowMultiple;Bw("DraftScene")(Aw=Lw(Aw=function(e){t(r,e);var o=n(r);function r(){return i(this,r),o.apply(this,arguments)}return a(r,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"onLoad",value:function(){GameSDK.startGameAsync().catch((function(e){console.warn("GameSDK.startGameAsync",e)}))}},{key:"switchScene",value:function(){}}]),r}(k))||Aw);v._RF.pop(),v._RF.push({},"27217ZS55VNqbq0d9w9Cc+3","Component",void 0);var Ow,Dw=m.ccclass,Iw=m.executeInEditMode,Nw=m.disallowMultiple,Fw=GameCore.Events,Gw=globalThis.game.event;Dw("DraftComponent")(_w=Nw(_w=Iw(!0)(_w=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).locale="en",e.eventPayload={screenName:"DraftScene"},e}return a(r,[{key:"__preload",value:function(){console.log("DraftComponent",Fw)}},{key:"onLoad",value:function(){console.log("DraftComponent",Gw)}},{key:"start",value:function(){console.log("DraftComponent",Ye),this.makePersistent()}},{key:"makePersistent",value:function(){w.addPersistRootNode(this.node)}}]),r}(k))||_w)||_w);v._RF.pop(),v._RF.push({},"6adb6Vsx2BIsYfe4A3i4ArN","custom",void 0);var zw;(0,m.ccclass)("CustomSpine")(Ow=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).spine=null,e.anims=null,e.customEnd=function(t){var n;console.log("CustomSpine customEnd",t);var i=null===(n=e.spine)||void 0===n?void 0:n.skeletonData;if(i){var a=i.getRuntimeData();a&&console.log("CustomSpine runtimeData",a)}},e}return a(r,[{key:"__preload",value:function(){var e,t;this.spine=null!==(e=this.node.getComponent(q.Skeleton))&&void 0!==e?e:null,this.anims=null!==(t=this.node.getComponent(g))&&void 0!==t?t:null,Dt.lazyValidateProperties(this)}},{key:"onLoad",value:function(){var e;console.log("CustomSpine onLoad",this.spine,this.anims),null===(e=this.anims)||void 0===e||e.play("custom")}},{key:"start",value:function(){}}]),r}(k));v._RF.pop(),v._RF.push({},"3f6029o9mpM/K2ccwbuv3XD","EndlessScene",void 0);var Mw,xw=m.ccclass,Uw=m.disallowMultiple,Hw=globalThis.game,jw=Hw.audio,Vw=Hw.ads,Ww=xe.Layout,qw=xe.DesignSize.Portrait;xw("EndlessScene")(zw=Uw(zw=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).handleGameMaskWhenLayoutChanged=function(e){var t=ue("Canvas/Game/GameObjects");if(t){var n=t.getComponent(ae);n&&(n.enabled=e===Ww.Landscape)}},e.handleAdsWhenResize=function(){e.checkBottomBannerAdSize(),e.setMaxSizeSideBannerAd()},e.attemptCallSubscribeBot=function(){"subscribeBotAsync"in GameSDK.extra&&GameSDK.extra.subscribeBotAsync().catch((function(e){console.warn("subscribeBotAsync",e)}))},e}return a(r,[{key:"__preload",value:function(){this.validateRequiredComponents(),this.listenGameEvents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"onLoad",value:function(){}},{key:"listenGameEvents",value:function(){this.node.scene.on(Me.LAYOUT_CHANGED,this.handleGameMaskWhenLayoutChanged),this.node.scene.on(Me.VIEW_RESIZE,this.handleAdsWhenResize)}},{key:"checkBottomBannerAdSize",value:function(){var e=Fe.instance.getVisibleSize(),t=Ue.worldSizeToCssSize(e.height*tt.MAX_BOTTOM_BANNER_RATIO);GameCore.Configs.Ads.BannerDisplayAdOptions.forEach((function(e){var n=e.PlacementId,i=e.Position,a=e.BannerHeight;"bottom"===i&&(a>t?Vw.hideBannerAdAsync(n).catch((function(e){})):Vw.showBannerAdAsync(n).catch((function(e){})))}))}},{key:"setMaxSizeSideBannerAd",value:function(){var e=GameSDK.extra;if("setSideBannerAdRemainSize"in e){var t=Fe.instance.getVisibleSize(),n=qw.WIDTH+24,i=(t.width-n)/2,a=Ue.worldSizeToCssSize(i);e.setSideBannerAdRemainSize(a)}}},{key:"start",value:function(){this.scheduleOnce(this.attemptCallSubscribeBot,.5),this.updateVolumeBackgroundMusic()}},{key:"updateVolumeBackgroundMusic",value:function(){jw.setVolume(1,"global_music")}}]),r}(k))||zw);v._RF.pop(),v._RF.push({},"9b83boaSv9PE6mRFqy0MSI8","GameScene",void 0);var Kw,Yw=m.ccclass,Jw=m.disallowMultiple,Zw=globalThis.game,Xw=Zw.audio,Qw=Zw.ads,$w=xe.Layout,eE=xe.DesignSize.Portrait;Yw("GameScene")(Mw=Jw(Mw=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).handleGameMaskWhenLayoutChanged=function(e){var t=ue("Canvas/Game/GameObjects");if(t){var n=t.getComponent(ae);n&&(n.enabled=e===$w.Landscape)}},e.handleAdsWhenResize=function(){e.checkBottomBannerAdSize(),e.setMaxSizeSideBannerAd()},e.attemptCallSubscribeBot=function(){"subscribeBotAsync"in GameSDK.extra&&GameSDK.extra.subscribeBotAsync().catch((function(e){console.warn("subscribeBotAsync",e)}))},e}return a(r,[{key:"__preload",value:function(){this.validateRequiredComponents(),this.listenGameEvents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"listenGameEvents",value:function(){T.on(Me.VIEW_RESIZE,this.handleAdsWhenResize),T.on(Me.LAYOUT_CHANGED,this.handleGameMaskWhenLayoutChanged)}},{key:"checkBottomBannerAdSize",value:function(){var e=Fe.instance.getVisibleSize(),t=Ue.worldSizeToCssSize(e.height*tt.MAX_BOTTOM_BANNER_RATIO);GameCore.Configs.Ads.BannerDisplayAdOptions.forEach((function(e){var n=e.PlacementId,i=e.Position,a=e.BannerHeight;"bottom"===i&&(a>t?Qw.hideBannerAdAsync(n).catch((function(e){})):Qw.showBannerAdAsync(n).catch((function(e){})))}))}},{key:"setMaxSizeSideBannerAd",value:function(){var e=GameSDK.extra;if("setSideBannerAdRemainSize"in e){var t=Fe.instance.getVisibleSize(),n=eE.WIDTH+24,i=(t.width-n)/2,a=Ue.worldSizeToCssSize(i);e.setSideBannerAdRemainSize(a)}}},{key:"start",value:function(){this.scheduleOnce(this.attemptCallSubscribeBot,.5),this.updateVolumeBackgroundMusic(),this.scheduleOnce(this.preloadScenes,2)}},{key:"preloadScenes",value:function(){$e.preloadDashboardScene()}},{key:"updateVolumeBackgroundMusic",value:function(){Xw.setVolume(1,"global_music")}}]),r}(k))||Mw);v._RF.pop(),v._RF.push({},"2b2ebUm0nFD64V/fcD8RPF/","TestLayoutScene",void 0);var tE,nE,iE,aE,oE,rE=m.ccclass,sE=m.disallowMultiple;rE("TestLayoutScene")(Kw=sE(Kw=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).handleLayoutChange=function(){Ze.showNotificationScreen("Layout changed")},e}return a(r,[{key:"__preload",value:function(){this.validateRequiredComponents(),$e.markIsTestScene(et.TEST_LAYOUT_SCENE),this.listenGameEvents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"listenGameEvents",value:function(){T.on(Me.LAYOUT_CHANGED,this.handleLayoutChange)}},{key:"switchScene",value:function(){$e.switchScene(et.DASHBOARD_SCENE)}}]),r}(k))||Kw);v._RF.pop(),v._RF.push({},"c0a5fPghzxBxpXiudxt+Qd4","TestParticleSystemScene",void 0);var lE,uE=m.ccclass,cE=m.property;tE=uE("TestParticleSystemScene"),nE=cE(rw),tE((oE=s((aE=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"starParticleSystem",oE,u(e)),e}return a(r,[{key:"__preload",value:function(){$e.markIsTestScene(et.TEST_PARTICLE_SYSTEM_SCENE)}},{key:"onLoad",value:function(){GameSDK.startGameAsync().catch((function(e){console.warn("GameSDK.startGameAsync",e)}))}},{key:"start",value:function(){var e=this;this.scheduleOnce((function(){e.starParticleSystem.play()}),1)}}]),r}(k)).prototype,"starParticleSystem",[nE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iE=aE));v._RF.pop(),v._RF.push({},"7dc71c6qMBI/ZZfA4rG4nFv","TestPerformanceScene",void 0);var hE,pE=m.ccclass,dE=m.disallowMultiple;pE("TestPerformanceScene")(lE=dE(lE=function(e){t(r,e);var o=n(r);function r(){return i(this,r),o.apply(this,arguments)}return a(r,[{key:"__preload",value:function(){this.validateRequiredComponents(),$e.markIsTestScene(et.TEST_PERFORMANCE_SCENE),this.listenEvents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"onLoad",value:function(){GameSDK.startGameAsync().catch((function(e){console.warn("GameSDK.startGameAsync",e)}))}},{key:"listenEvents",value:function(){}},{key:"start",value:function(){}}]),r}(k))||lE);v._RF.pop(),v._RF.push({},"0a4aeK2lAdAjq0xWi6SCbV+","TestScene",void 0);var yE,vE=m.ccclass,fE=m.disallowMultiple,mE=GameCore.Events,gE=globalThis.game.event;vE("TestScene")(hE=fE(hE=function(e){t(r,e);var o=n(r);function r(){return i(this,r),o.apply(this,arguments)}return a(r,[{key:"__preload",value:function(){this.validateRequiredComponents(),$e.markIsTestScene(et.TEST_SCENE)}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"onLoad",value:function(){this.listenScreenEvents(),GameSDK.startGameAsync().catch((function(e){console.warn("GameSDK.startGameAsync",e)}))}},{key:"listenScreenEvents",value:function(){gE.once(mE.CLOSED_SCREEN,(function(e){e.screenName===nt[Xe.LOADING_SCREEN]&&Ze.openScreen(Xe.NOTIFICATION_SCREEN,{message:"Test screen events pass!",duration:2,isCloseButtonVisible:!1})}))}},{key:"start",value:function(){console.log("TestScene.start"),Ze.openScreen(Xe.LOADING_SCREEN,{duration:.5})}}]),r}(k))||hE);v._RF.pop(),v._RF.push({},"b16e7w74XVALY8Zco6TJYe7","AdsFlows",void 0);var bE,SE=m.ccclass,kE=GameCore.Plugins.Ads.Types;SE("AdsFlows")(yE=function(e){t(r,e);var o=n(r);function r(){return i(this,r),o.apply(this,arguments)}return a(r,[{key:"preloadAds",value:function(){Qe.preloadAds()}},{key:"checkServiceDegraded",value:function(){var e=Qe.isServiceDegraded();Ze.showNotificationScreen("Service degraded: ".concat(e?"true":"false"))}},{key:"loadInterstitialAd",value:function(){Qe.preloadAdsByType(kE.INTERSTITIAL)}},{key:"loadRewardedVideoAd",value:function(){Qe.preloadAdsByType(kE.REWARDED_VIDEO)}},{key:"loadRewardedInterstitialAd",value:function(){Qe.preloadAdsByType(kE.REWARDED_INTERSTITIAL)}},{key:"showInterstitialAd",value:function(){Qe.showInterstitialAdAsync({contextType:"browse"})}},{key:"showRewardedVideoAd",value:function(){Qe.showRewardVideoAdAsync({contextType:"reward",showLoading:!0})}},{key:"showRewardedInterstitialAd",value:function(){Qe.showRewardedInterstitialAdAsync({contextType:"reward",showLoading:!0})}},{key:"showBannerAd",value:function(){Qe.showBannerAds()}},{key:"hideBannerAd",value:function(){Qe.hideBannerAds()}},{key:"showAdsenseInterstitialAd",value:function(){Qe.showInterstitialAdAsync({adService:"adsense"})}},{key:"showAdsenseRewardedVideoAd",value:function(){Qe.showRewardVideoAdAsync({adService:"adsense",showLoading:!0})}},{key:"showAdsenseRewardedInterstitialAd",value:function(){Qe.showRewardedInterstitialAdAsync({adService:"adsense",showLoading:!0})}}]),r}(k));v._RF.pop(),v._RF.push({},"56a103phldKO7/xShKcD3bI","AnimationDemo",void 0);var CE;(0,m.ccclass)("AnimationDemo")(bE=function(e){t(r,e);var o=n(r);function r(){return i(this,r),o.apply(this,arguments)}return a(r,[{key:"onLoad",value:function(){}},{key:"switchToTestTransitionScene",value:function(){$e.switchScene("TestTransitionScene")}}]),r}(k));v._RF.pop(),v._RF.push({},"a3b8adQtftPmKSSoumHWY1e","AudioDemo",void 0);var wE,EE,TE,AE,RE,PE,_E,BE;(0,m.ccclass)("AudioDemo")(CE=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).isMusicMute=!1,e.isSoundMute=!1,e.listSounds=[],e}return a(r,[{key:"onLoad",value:function(){var e,t;this.musicComp=null===(e=ue("Music"))||void 0===e?void 0:e.getComponent(sn),this.soundComp=null===(t=ue("Sound"))||void 0===t?void 0:t.getComponent(gn),this.validateRequiredComponents(),this.listSounds=[qe.BEE_FLYING,qe.BEE_STING_DOGE,qe.BG_MUSIC,qe.BUTTON_CLICK,qe.COLLECTING_COINS,qe.DOGE_DIES,qe.DOGE_HURT,qe.END_DRAW,qe.HAND_CLAP,qe.LEVEL_FAIL,qe.LEVEL_PASS,qe.LOST_STAR_IN_GAMEPLAY,qe.RAISE_STAR,qe.SPAWN_COINS,qe.STAR_RAISE,qe.TOUCH_START,qe.BEE_BULLET_EXPLODE]}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"playBackgroundMusic",value:function(){this.musicComp.play(qe.BG_MUSIC)}},{key:"pauseBackgroundMusic",value:function(){this.musicComp.pause(qe.BG_MUSIC)}},{key:"stopBackgroundMusic",value:function(){this.musicComp.stop(qe.BG_MUSIC)}},{key:"randomMusicChannelVolume",value:function(){var e=Math.random();this.musicComp.setVolume(e)}},{key:"toggleMuteMusicChannel",value:function(){this.isMusicMute?(this.musicComp.mute(!1),this.isMusicMute=!1):(this.musicComp.mute(!0),this.isMusicMute=!0)}},{key:"playRandomSound",value:function(){var e=Math.floor(Math.random()*this.listSounds.length),t=this.listSounds[e];t&&this.soundComp.play(t)}},{key:"toggleMuteSoundChannel",value:function(){this.isSoundMute?(this.soundComp.mute(!1),this.isSoundMute=!1):(this.soundComp.mute(!0),this.isSoundMute=!0)}},{key:"randomSoundChannelVolume",value:function(){var e=Math.random();this.soundComp.setVolume(e)}}]),r}(k));v._RF.pop(),v._RF.push({},"9e6b330nHBK2oNz8N9/lpDx","FlowChallenge",void 0);var LE,OE,DE,IE,NE,FE=m.ccclass,GE=GameCore.Utils.Decorator,zE=globalThis.game,ME=zE.match,xE=zE.player,UE=function(e){Ze.closeLoadingScreen(),e instanceof Error&&Ze.showNotificationScreen(e.message)};wE=FE("FlowChallenge"),EE=GE.tryCatch(UE),TE=GE.tryCatch(UE),AE=GE.tryCatch(UE),RE=GE.tryCatch(UE),PE=GE.tryCatch(UE),wE((s((BE=function(o){t(p,o);var r,s,l,u,c,h=n(p);function p(){var e;i(this,p);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=h.call.apply(h,[this].concat(n))).playerId="",e}return a(p,[{key:"onLoad",value:function(){this.playerId=xE.getPlayerId()}},{key:"inviteFriends",value:(c=e((function*(){Ze.showLoadingScreen(0),yield ME.challenge.invite.processAsync({playerId:this.playerId})})),function(){return c.apply(this,arguments)})},{key:"challengeFriend",value:(u=e((function*(e,t){var n=JSON.parse(t);Ze.showLoadingScreen(0),yield ME.challenge.friend.processAsync(d(d({},n),{},{playerId:this.playerId}))})),function(e,t){return u.apply(this,arguments)})},{key:"joinChallenge",value:(l=e((function*(e,t){var n=JSON.parse(t);Ze.showLoadingScreen(0),yield ME.challenge.join.processAsync(d(d({},n),{},{playerId:this.playerId}))})),function(e,t){return l.apply(this,arguments)})},{key:"continueChallenge",value:(s=e((function*(e,t){var n=JSON.parse(t);Ze.showLoadingScreen(0),yield ME.challenge.continue.processAsync(d(d({},n),{},{playerId:this.playerId}))})),function(e,t){return s.apply(this,arguments)})},{key:"finishChallenge",value:(r=e((function*(){Ze.showLoadingScreen(0),yield ME.challenge.finish.processAsync({playerId:xE.getPlayerId(),playerScore:Math.floor(2*Math.random())})})),function(){return r.apply(this,arguments)})}]),p}(k)).prototype,"inviteFriends",[EE],Object.getOwnPropertyDescriptor(BE.prototype,"inviteFriends"),BE.prototype),s(BE.prototype,"challengeFriend",[TE],Object.getOwnPropertyDescriptor(BE.prototype,"challengeFriend"),BE.prototype),s(BE.prototype,"joinChallenge",[AE],Object.getOwnPropertyDescriptor(BE.prototype,"joinChallenge"),BE.prototype),s(BE.prototype,"continueChallenge",[RE],Object.getOwnPropertyDescriptor(BE.prototype,"continueChallenge"),BE.prototype),s(BE.prototype,"finishChallenge",[PE],Object.getOwnPropertyDescriptor(BE.prototype,"finishChallenge"),BE.prototype),_E=BE));v._RF.pop(),v._RF.push({},"f3decJ3ZlRLt6CDMHpl1XCe","FlowContext",void 0);var HE,jE,VE,WE,qE,KE,YE=m.ccclass,JE=GameCore.Utils.Decorator,ZE=globalThis.game,XE=ZE.match,QE=ZE.player,$E=ZE.context,eT=function(e){Ze.closeLoadingScreen(),e instanceof Error&&Ze.showNotificationScreen(e.message)};LE=YE("FlowContext"),OE=JE.tryCatch(eT),DE=JE.tryCatch(eT),LE((s((NE=function(o){t(u,o);var r,s,l=n(u);function u(){var t;i(this,u);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(t=l.call.apply(l,[this].concat(a))).playerId="",t.changeContext=function(){var t=e((function*(e,t,n){$E.receiveContext(e,t,n),yield $E.detectContextSessionType(),game.context.detectContextGameMode()}));return function(e,n,i){return t.apply(this,arguments)}}(),t}return a(u,[{key:"onLoad",value:function(){this.playerId=QE.getPlayerId()}},{key:"chooseFriends",value:(s=e((function*(e,t){var n=JSON.parse(t);Ze.showLoadingScreen(0),yield XE.context.choose.processAsync(d(d({},n),{},{playerId:this.playerId}))})),function(e,t){return s.apply(this,arguments)})},{key:"processContextData",value:(r=e((function*(){Ze.showLoadingScreen(0),yield $E.processContextData()})),function(){return r.apply(this,arguments)})},{key:"setSingleContext",value:function(){this.changeContext("","SOLO",{})}},{key:"setTournamentContext",value:function(){this.changeUrl("/?context_source_id=123&context_type=GENERIC&tournament=true"),this.changeContext("mocked-context-id-tournament","THREAD",{})}},{key:"setShareInviteContext",value:function(){var e={type:$E.getSessionContextTypes().SHARE_INVITE,playerId:"4766619483409000",playerName:"Player",playerPhoto:""};this.changeContext("mocked-context-id-share-invite","THREAD",e)}},{key:"setMatchingGroupContext",value:function(){var e={type:$E.getSessionContextTypes().MATCHING_GROUP,playerId:"4766619483409000",playerName:"Player",playerPhoto:"",playerScore:100};this.changeContext("mocked-context-id-matching-group","GROUP",e)}},{key:"setChallengeFriendContext",value:function(){var e={type:$E.getSessionContextTypes().CHALLENGE_FRIEND,playerId:"4766619483409000",playerName:"Player",playerPhoto:""};this.changeContext("mocked-context-id-challenge-friend","THREAD",e)}},{key:"changeUrl",value:function(e){window.history.pushState({},"",e)}}]),u}(k)).prototype,"chooseFriends",[OE],Object.getOwnPropertyDescriptor(NE.prototype,"chooseFriends"),NE.prototype),s(NE.prototype,"processContextData",[DE],Object.getOwnPropertyDescriptor(NE.prototype,"processContextData"),NE.prototype),IE=NE));v._RF.pop(),v._RF.push({},"36562c8k/RF2p/1aLUWFaf8","FlowGroup",void 0);var tT,nT,iT,aT,oT,rT=m.ccclass,sT=GameCore.Utils.Decorator,lT=globalThis.game,uT=lT.match,cT=lT.player,hT=function(e){Ze.closeLoadingScreen(),e instanceof Error&&Ze.showNotificationScreen(e.message)};HE=rT("FlowGroup"),jE=sT.tryCatch(hT),VE=sT.tryCatch(hT),WE=sT.tryCatch(hT),HE((s((KE=function(o){t(c,o);var r,s,l,u=n(c);function c(){var e;i(this,c);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=u.call.apply(u,[this].concat(n))).playerId="",e}return a(c,[{key:"onLoad",value:function(){this.playerId=cT.getPlayerId()}},{key:"startGroup",value:(l=e((function*(e,t){var n=JSON.parse(t);Ze.showLoadingScreen(0),yield uT.group.start.processAsync(d(d({},n),{},{matchTag:"test",playerId:this.playerId}))})),function(e,t){return l.apply(this,arguments)})},{key:"joinGroup",value:(s=e((function*(e,t){var n=JSON.parse(t);Ze.showLoadingScreen(0),yield uT.group.join.processAsync(d(d({},n),{},{playerId:this.playerId}))})),function(e,t){return s.apply(this,arguments)})},{key:"finishGroup",value:(r=e((function*(){Ze.showLoadingScreen(0),cT.setPlayerDataByName("score",Math.floor(2*Math.random())),yield uT.group.finish.processAsync()})),function(){return r.apply(this,arguments)})}]),c}(k)).prototype,"startGroup",[jE],Object.getOwnPropertyDescriptor(KE.prototype,"startGroup"),KE.prototype),s(KE.prototype,"joinGroup",[VE],Object.getOwnPropertyDescriptor(KE.prototype,"joinGroup"),KE.prototype),s(KE.prototype,"finishGroup",[WE],Object.getOwnPropertyDescriptor(KE.prototype,"finishGroup"),KE.prototype),qE=KE));v._RF.pop(),v._RF.push({},"46e6dOzDGJMa48+tVKTAEIT","FlowSingle",void 0);var pT,dT,yT,vT,fT,mT,gT,bT,ST,kT,CT,wT=m.ccclass,ET=GameCore.Utils.Decorator,TT=globalThis.game,AT=TT.match,RT=TT.player,PT=function(e){Ze.closeLoadingScreen(),e instanceof Error&&Ze.showNotificationScreen(e.message)};tT=wT("FlowSingle"),nT=ET.tryCatch(PT),iT=ET.tryCatch(PT),tT((s((oT=function(o){t(u,o);var r,s,l=n(u);function u(){var e;i(this,u);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=l.call.apply(l,[this].concat(n))).playerId="",e}return a(u,[{key:"onLoad",value:function(){this.playerId=RT.getPlayerId()}},{key:"startSingle",value:(s=e((function*(){Ze.showLoadingScreen(0),yield AT.single.start.processAsync({playerId:this.playerId})})),function(){return s.apply(this,arguments)})},{key:"finishSingle",value:(r=e((function*(){RT.setPlayerDataByName("score",Math.floor(2*Math.random())),yield AT.single.finish.processAsync()})),function(){return r.apply(this,arguments)})}]),u}(k)).prototype,"startSingle",[nT],Object.getOwnPropertyDescriptor(oT.prototype,"startSingle"),oT.prototype),s(oT.prototype,"finishSingle",[iT],Object.getOwnPropertyDescriptor(oT.prototype,"finishSingle"),oT.prototype),aT=oT));v._RF.pop(),v._RF.push({},"943b1Zkv9BAaZVhinus8Bkv","FlowTournament",void 0);var _T,BT=m.ccclass,LT=GameCore.Utils.Decorator,OT=globalThis.game,DT=OT.match,IT=OT.player,NT=function(e){Ze.closeLoadingScreen(),e instanceof Error&&Ze.showNotificationScreen(e.message)};pT=BT("FlowTournament"),dT=LT.tryCatch(NT),yT=LT.tryCatch(NT),vT=LT.tryCatch(NT),fT=LT.tryCatch(NT),mT=LT.tryCatch(NT),gT=LT.tryCatch(NT),bT=LT.tryCatch(NT),ST=LT.tryCatch(NT),pT((s((CT=function(o){t(v,o);var r,s,l,u,c,h,p,d,y=n(v);function v(){var e;i(this,v);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=y.call.apply(y,[this].concat(n))).playerId="",e}return a(v,[{key:"onLoad",value:function(){this.playerId=IT.getPlayerId()}},{key:"joinTournament",value:(d=e((function*(){Ze.showLoadingScreen(0);var e=(yield GameSDK.getTournamentAsync()).getID().toString();yield DT.tournament.join.processAsync({tournamentId:e,playerId:this.playerId})})),function(){return d.apply(this,arguments)})},{key:"continueTournament",value:(p=e((function*(){Ze.showLoadingScreen(0);var e=(yield GameSDK.getTournamentAsync()).getContextID();yield DT.tournament.continue.processAsync({contextId:e,playerId:this.playerId})})),function(){return p.apply(this,arguments)})},{key:"finishTournament",value:(h=e((function*(){Ze.showLoadingScreen(0),IT.setPlayerDataByName("score",Math.floor(2*Math.random())),yield DT.single.finish.processAsync()})),function(){return h.apply(this,arguments)})},{key:"createTournament",value:(c=e((function*(){Ze.showLoadingScreen(0);var e=GameCore.Utils.String.generateObjectId();yield GameSDK.tournament.createAsync({initialScore:0,config:{title:"Tournament title",tournamentTitle:"Tournament title"},data:{playerId:this.playerId,playerName:"playerName",leaderboardId:e}})})),function(){return c.apply(this,arguments)})},{key:"postScoreTournament",value:(u=e((function*(e){var t=Number(e.string);console.warn("score",t),Ze.showLoadingScreen(0),yield GameSDK.tournament.postScoreAsync(t)})),function(e){return u.apply(this,arguments)})},{key:"shareTournament",value:(l=e((function*(e,t){var n=JSON.parse(t);Ze.showLoadingScreen(0),console.warn("payload",n),yield GameSDK.tournament.shareAsync(n)})),function(e,t){return l.apply(this,arguments)})},{key:"getTournamentsAsync",value:(s=e((function*(){Ze.showLoadingScreen(0);var e=GameSDK.tournament.getTournamentsAsync();console.warn(e)})),function(){return s.apply(this,arguments)})},{key:"getTournamentAsync",value:(r=e((function*(){Ze.showLoadingScreen(0);var e=yield GameSDK.getTournamentAsync();console.warn(e)})),function(){return r.apply(this,arguments)})}]),v}(k)).prototype,"joinTournament",[dT],Object.getOwnPropertyDescriptor(CT.prototype,"joinTournament"),CT.prototype),s(CT.prototype,"continueTournament",[yT],Object.getOwnPropertyDescriptor(CT.prototype,"continueTournament"),CT.prototype),s(CT.prototype,"finishTournament",[vT],Object.getOwnPropertyDescriptor(CT.prototype,"finishTournament"),CT.prototype),s(CT.prototype,"createTournament",[fT],Object.getOwnPropertyDescriptor(CT.prototype,"createTournament"),CT.prototype),s(CT.prototype,"postScoreTournament",[mT],Object.getOwnPropertyDescriptor(CT.prototype,"postScoreTournament"),CT.prototype),s(CT.prototype,"shareTournament",[gT],Object.getOwnPropertyDescriptor(CT.prototype,"shareTournament"),CT.prototype),s(CT.prototype,"getTournamentsAsync",[bT],Object.getOwnPropertyDescriptor(CT.prototype,"getTournamentsAsync"),CT.prototype),s(CT.prototype,"getTournamentAsync",[ST],Object.getOwnPropertyDescriptor(CT.prototype,"getTournamentAsync"),CT.prototype),kT=CT));v._RF.pop(),v._RF.push({},"d78a7DHN+5P/YjKftUFEZcU","JavaAds",void 0);var FT;(0,m.ccclass)("JavaAds")(_T=function(e){t(r,e);var o=n(r);function r(){return i(this,r),o.apply(this,arguments)}return a(r,[{key:"__preload",value:function(){this.setupAds()}},{key:"setupAds",value:function(){}},{key:"onLoad",value:function(){}},{key:"start",value:function(){}}]),r}(k));v._RF.pop(),v._RF.push({},"58e17jb3n9LP6677b7ocHg+","PreloadScreens",void 0);var GT;(0,m.ccclass)("PreloadScreens")(FT=function(e){t(r,e);var o=n(r);function r(){return i(this,r),o.apply(this,arguments)}return a(r,[{key:"preload",value:function(){Ze.preloadScreens()}}]),r}(k));v._RF.pop(),v._RF.push({},"0fd01MYjfdD+4IeN6PtQl3m","ScreenCongratulation",void 0);var zT;(0,m.ccclass)("ScreenCongratulation")(GT=function(e){t(r,e);var o=n(r);function r(){return i(this,r),o.apply(this,arguments)}return a(r,[{key:"show",value:function(){Ze.openScreen(Xe.CONGRATULATION_SCREEN)}},{key:"close",value:function(){Ze.closeScreen(Xe.CONGRATULATION_SCREEN)}}]),r}(k));v._RF.pop(),v._RF.push({},"bb2dcIUQjhPDLt7B6ga20s/","ScreenLoading",void 0);var MT;(0,m.ccclass)("ScreenLoading")(zT=function(e){t(r,e);var o=n(r);function r(){return i(this,r),o.apply(this,arguments)}return a(r,[{key:"show",value:function(e,t){var n=Number(t);Ze.showLoadingScreen(n)}},{key:"close",value:function(){Ze.closeLoadingScreen()}}]),r}(k));v._RF.pop(),v._RF.push({},"f3a15oYustB1aev6BrFD/7Y","ScreenLose",void 0);var xT;(0,m.ccclass)("ScreenLose")(MT=function(e){t(r,e);var o=n(r);function r(){return i(this,r),o.apply(this,arguments)}return a(r,[{key:"show",value:function(){Ze.openScreen(Xe.LOSE_SCREEN,{level:1})}},{key:"close",value:function(){Ze.closeScreen(Xe.LOSE_SCREEN)}}]),r}(k));v._RF.pop(),v._RF.push({},"71603KupFhNAYktx1isDcrj","ScreenNotification",void 0);var UT;(0,m.ccclass)("ScreenNotification")(xT=function(e){t(r,e);var o=n(r);function r(){return i(this,r),o.apply(this,arguments)}return a(r,[{key:"show",value:function(e,t){var n=String(t);Ze.showNotificationScreen(n)}},{key:"close",value:function(){Ze.closeNotificationScreen()}}]),r}(k));v._RF.pop(),v._RF.push({},"1fb3eggYuVBQo5Uuzm/Nmjh","ScreenSettings",void 0);var HT;(0,m.ccclass)("ScreenSettings")(UT=function(e){t(r,e);var o=n(r);function r(){return i(this,r),o.apply(this,arguments)}return a(r,[{key:"show",value:function(e,t){var n=String(t);Ze.openScreen(Xe.SETTINGS_SCREEN,{message:n})}},{key:"close",value:function(){Ze.closeScreen(Xe.SETTINGS_SCREEN)}}]),r}(k));v._RF.pop(),v._RF.push({},"ae2cdksVsdJUKhhznchh9wJ","ScreenWinning",void 0);var jT;(0,m.ccclass)("ScreenWinning")(HT=function(e){t(r,e);var o=n(r);function r(){return i(this,r),o.apply(this,arguments)}return a(r,[{key:"show",value:function(){Ze.openScreen(Xe.WINNING_SCREEN)}},{key:"close",value:function(){Ze.closeScreen(Xe.WINNING_SCREEN)}}]),r}(k));v._RF.pop(),v._RF.push({},"abf91gNohBK7arKnziqu2PF","AnimationDemo2",void 0);var VT,WT,qT,KT,YT,JT;(0,m.ccclass)("AnimationDemo2")(jT=function(e){t(r,e);var o=n(r);function r(){return i(this,r),o.apply(this,arguments)}return a(r,[{key:"onLoad",value:function(){}},{key:"switchToTestScene",value:function(){$e.switchScene("TestScene")}}]),r}(k));v._RF.pop(),v._RF.push({},"56b92F9LoxNs5aCgvw+tkq6","LoadingSceneTransition",void 0);var ZT,XT,QT,$T,eA,tA,nA,iA=m.ccclass,aA=m.requireComponent,oA=m.property;VT=iA("LoadingSceneTransition"),WT=aA([Ge]),qT=oA([L]),VT(KT=WT((JT=s((YT=function(e){t(s,e);var o=n(s);function s(){var e;i(this,s);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"targets",JT,u(e)),e.realTargets=[],e}return a(s,[{key:"start",value:function(){for(var e=this,t=0;t<this.targets.length;t++){var n=this.targets[t];if(n){var i=ne(n);i.setParent(this.node),i.active=!1,this.realTargets.push(i)}}w.addPersistRootNode(this.node),w.once(F.EVENT_BEFORE_SCENE_LAUNCH,(function(){e.playFadeOutAnimationClip()}))}},{key:"playFadeOutAnimationClip",value:function(){var e=this,t=0;if(this.realTargets&&0!==this.realTargets.length){var n,i=r(this.realTargets);try{for(i.s();!(n=i.n()).done;){var a=n.value;a.active=!0;var o=a.getComponent(g);if(o)o.clips.some((function(e){return"FadeOut"===(null==e?void 0:e.name)}))?(o.play("FadeOut"),o.once(g.EventType.FINISHED,(function(){++t===e.realTargets.length&&e.node.destroy()}))):(this.node.destroy(),console.warn("Not have FadeOut clip"))}}catch(e){i.e(e)}finally{i.f()}}}}]),s}(k)).prototype,"targets",[qT],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),KT=YT))||KT);v._RF.pop(),v._RF.push({},"acb0egHPppFmYJalVNrDDv/","BaseScreen",void 0);var rA,sA=m.ccclass,lA=m.property,uA=m.disallowMultiple,cA=GameCore.Events,hA=globalThis.game.event,pA=(ZT=sA("BaseScreen"),XT=lA(L),QT=lA(L),ZT($T=uA((tA=s((eA=function(e){t(s,e);var o=n(s);function s(){var e;i(this,s);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"container",tA,u(e)),l(e,"backgroundMask",nA,u(e)),e.data={},e}return a(s,[{key:"__preload",value:function(){this.animation=this.getComponent(g),this.validateRequiredComponents(),this.initializeNodes()}},{key:"initializeNodes",value:function(){var e=this.getMaskOpacity(),t=this.getContainerOpacity();e&&t&&(e.opacity=0,t.opacity=0)}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"open",value:function(e){e&&(this.data=e),this.show(),this.runAnimation("OpenScreen")}},{key:"close",value:function(){var e=this;this.node.active&&(this.animation.once(g.EventType.FINISHED,(function(){hA.emit(cA.CLOSED_SCREEN,{screenName:e.node.name}),e.hide()})),this.runAnimation("CloseScreen"))}},{key:"runAnimation",value:function(e){if(!this.isAnimationExist(e))throw new Error("".concat(this.node.name,": Animation component must have ").concat(e," clip"));this.animation.play(e)}},{key:"isAnimationExist",value:function(e){return this.animation.clips.some((function(t){return!(!t||t.name!==e)}))}},{key:"getMaskOpacity",value:function(){var e=this.backgroundMask.getComponent(O);return e||(console.warn("BaseScreen: maskOpacity not found"),null)}},{key:"getContainerOpacity",value:function(){var e=this.container.getComponent(O);return e||(console.warn("BaseScreen: containerOpacity not found"),null)}},{key:"show",value:function(){var e=this.node.getComponent(H);if(e){e.enabled=!0,e.updateAlignment();var t,n=this.node.getComponentsInChildren(H),i=r(n);try{for(i.s();!(t=i.n()).done;){t.value.updateAlignment()}}catch(e){i.e(e)}finally{i.f()}}}},{key:"hide",value:function(){this.node.setWorldPosition(new _(-1e3,-1e3,0));var e=this.node.getComponent(H);e&&(e.enabled=!1)}}]),s}(k)).prototype,"container",[XT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nA=s(eA.prototype,"backgroundMask",[QT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$T=eA))||$T)||$T);v._RF.pop(),v._RF.push({},"f3521L4Mn5I3bhxr0QZJ9y9","BackgroundMask",void 0);var dA,yA,vA,fA,mA,gA=m.ccclass,bA=m.requireComponent;gA("BackgroundMask")(rA=bA([O])(rA=function(e){t(r,e);var o=n(r);function r(){return i(this,r),o.apply(this,arguments)}return a(r,[{key:"onLoad",value:function(){var e=this.getComponent(O);e?(this.opacity=e,this.updateMaskAlpha()):console.warn("BackgroundMask: UIOpacity not found")}},{key:"updateMaskAlpha",value:function(){var e,t,n=this.opacity.opacity/255;e=n,(t=document.getElementById("app-mask"))&&(t.style.background="rgb(0 0 0 / ".concat(e,")"))}}]),r}(k))||rA);v._RF.pop(),v._RF.push({},"d562cAXnG1PQ6vXfOEq2wVu","Screens",void 0);var SA,kA,CA,wA,EA,TA,AA,RA,PA,_A,BA,LA,OA,DA,IA=m.ccclass,NA=m.property;dA=IA("Screens"),yA=NA({type:M(Xe)}),dA((mA=s((fA=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"screenKeys",mA,u(e)),e}return a(r)}(k)).prototype,"screenKeys",[yA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),vA=fA));v._RF.pop(),v._RF.push({},"cecf2nUBzhIWZw7uJgVliXz","CongratulationScreen",void 0);var FA,GA,zA,MA,xA,UA,HA,jA=m.ccclass,VA=m.property,WA=m.disallowMultiple,qA=m.requireComponent,KA=GameCore.Events,YA=globalThis.game.event;SA=jA("CongratulationScreen"),kA=qA(pA),CA=VA(L),wA=VA(L),EA=VA(A),TA=VA(A),AA=VA(A),SA(RA=WA(RA=kA((_A=s((PA=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"congratulation",_A,u(e)),l(e,"confirmation",BA,u(e)),l(e,"closeButtonComponent",LA,u(e)),l(e,"yesButtonComponent",OA,u(e)),l(e,"noButtonComponent",DA,u(e)),e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("CongratulationScreen: screen not found");e.validateEventPayload(t)&&(e.closeButtonComponent.interactable=!0,e.yesButtonComponent.interactable=!0,e.noButtonComponent.interactable=!0)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return a(r,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(pA),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){YA.on(KA.OPENING_SCREEN,this.handleOpeningScreen),YA.on(KA.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){YA.off(KA.OPENING_SCREEN,this.handleOpeningScreen),YA.off(KA.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(){this.enabled&&(this.confirmation.active=!1,this.congratulation.active=!0)}},{key:"close",value:function(){this.closeButtonComponent.interactable=!1,this.yesButtonComponent.interactable=!1,this.noButtonComponent.interactable=!1,Ze.closeScreen(Xe.CONGRATULATION_SCREEN)}},{key:"handleStartOver",value:function(){this.confirmation.active=!0,this.congratulation.active=!1;var e=this.confirmation.getComponent(O);e?(le(e).set({opacity:0}).to(.2,{opacity:255},{easing:"smooth"}).start(),le(this.confirmation).set({scale:new _(0,0,0)}).to(.2,{scale:new _(1,1,1)},{easing:"smooth"}).start()):console.warn("CongratulationScreen: UIOpacity not found")}},{key:"handleYesStartOver",value:function(){this.close(),this.node.scene.emit(wl.START_OVER)}},{key:"handleNoStartOver",value:function(){this.close(),this.node.scene.emit(wl.GAME_REPLAY,{level:this.screen.data.level})}},{key:"handleClickedClose",value:function(){this.close(),this.node.scene.emit(wl.GAME_REPLAY,{level:this.screen.data.level})}}]),r}(k)).prototype,"congratulation",[CA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BA=s(PA.prototype,"confirmation",[wA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LA=s(PA.prototype,"closeButtonComponent",[EA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OA=s(PA.prototype,"yesButtonComponent",[TA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DA=s(PA.prototype,"noButtonComponent",[AA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RA=PA))||RA)||RA);v._RF.pop(),v._RF.push({},"7b024d/xQ1BBZV0UpNjM9UQ","LoadingFullScreen",void 0);var JA,ZA,XA,QA,$A,eR=m.ccclass,tR=m.property,nR=(FA=eR("LoadingFullScreen"),GA=tR(ye),zA=tR(N),FA((UA=s((xA=function(o){t(h,o);var r,s,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=c.call.apply(c,[this].concat(n)),l(e,"progressBar",UA,u(e)),l(e,"loadingText",HA,u(e)),e}return a(h,[{key:"__preload",value:function(){this.uiOpacity=this.getComponent(O),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"runLoadingTextAnimation",value:function(){var e=this,t=0;this.schedule((function(){t=t>2?0:t+1,e.loadingText.string="Loading"+".".repeat(t)}),.5)}},{key:"stopLoadingTextAnimation",value:function(){this.unscheduleAllCallbacks()}},{key:"show",value:(s=e((function*(e){this.uiOpacity.opacity=0,this.progressBar.progress=0;var t=le(this.uiOpacity).to(.2,{opacity:255},{easing:"cubicOut"}),n=le(this.progressBar).to(8,{progress:.9},{easing:"cubicOut"});this.runLoadingTextAnimation(),it.runTweenAsync(t),yield it.runTweenAsync(n)})),function(e){return s.apply(this,arguments)})},{key:"hide",value:(r=e((function*(e){if(this.uiOpacity&&this.progressBar){this.uiOpacity.opacity=255,this.progressBar.progress=.9;var t=le(this.uiOpacity).to(.15,{opacity:0},{easing:"cubicIn"}),n=le(this.progressBar).to(.2,{progress:1},{easing:"cubicIn"});this.runLoadingTextAnimation(),yield it.runTweenAsync(n),this.stopLoadingTextAnimation(),yield it.runTweenAsync(t),this.node.active=!1}})),function(e){return r.apply(this,arguments)})}]),h}(k)).prototype,"progressBar",[GA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HA=s(xA.prototype,"loadingText",[zA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MA=xA))||MA);v._RF.pop(),v._RF.push({},"daa70r49mtGR6iXhcKLcS3q","Loading",void 0);var iR,aR=m.ccclass,oR=m.property;JA=aR("Loading"),ZA=oR(te),JA(($A=s((QA=function(o){t(h,o);var r,s,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=c.call.apply(c,[this].concat(n)),l(e,"loadingPrefab",$A,u(e)),e.loadingNode=null,e}return a(h,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"onLoad",value:function(){this.makePersistent()}},{key:"makePersistent",value:function(){w.addPersistRootNode(this.node)}},{key:"createLoadingFullScreen",value:function(){var e,t=ue("Canvas");if(t&&!t.getChildByName("Loading")){this.loadingNode||(this.loadingNode=ne(this.loadingPrefab));var n=ne._clone(this.loadingNode);this.loadingFullScreen=n.getComponent(nR),this.node.active=!1,null===(e=ue("Canvas"))||void 0===e||e.addChild(n)}}},{key:"show",value:(s=e((function*(e){this.createLoadingFullScreen(),this.node.active||(this.node.active=!0,yield this.loadingFullScreen.show(e))})),function(e){return s.apply(this,arguments)})},{key:"hide",value:(r=e((function*(e){var t;null!==(t=this.node)&&void 0!==t&&t.active&&this.loadingFullScreen&&(yield this.loadingFullScreen.hide(e),this.node.active=!1)})),function(e){return r.apply(this,arguments)})}]),h}(k)).prototype,"loadingPrefab",[ZA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XA=QA));v._RF.pop(),v._RF.push({},"61985gSEDBMY6nVNc9Q1D6W","LoadingScreen",void 0);var rR,sR,lR,uR,cR,hR,pR,dR,yR,vR,fR,mR,gR,bR,SR,kR,CR,wR,ER,TR,AR,RR=m.ccclass,PR=m.disallowMultiple,_R=m.requireComponent,BR=GameCore.Events,LR=globalThis.game.event;RR("LoadingScreen")(iR=PR(iR=_R(pA)(iR=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.enabled=!0)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e.handleClosingScreen=function(t){e.validateEventPayload(t)&&e.unscheduleAllCallbacks()},e.handleClosedScreen=function(t){e.validateEventPayload(t)&&(e.enabled=!1)},e.handleOnCloseScreen=function(){Ze.closeScreen(Xe.LOADING_SCREEN)},e}return a(r,[{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(pA),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){LR.on(BR.OPENING_SCREEN,this.handleOpeningScreen),LR.on(BR.OPENED_SCREEN,this.handleOpenedScreen),LR.on(BR.CLOSING_SCREEN,this.handleClosingScreen),LR.on(BR.CLOSED_SCREEN,this.handleClosedScreen)}},{key:"unListenScreenEvents",value:function(){LR.off(BR.OPENING_SCREEN,this.handleOpeningScreen),LR.off(BR.OPENED_SCREEN,this.handleOpenedScreen),LR.off(BR.CLOSING_SCREEN,this.handleClosingScreen),LR.off(BR.CLOSED_SCREEN,this.handleClosedScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(){var e;if(this.enabled){var t=null!==(e=this.screen.data.duration)&&void 0!==e?e:0;t>0&&this.scheduleOnce(this.handleOnCloseScreen,t)}}}]),r}(k))||iR)||iR);v._RF.pop(),v._RF.push({},"15681ka+CZC45B7BdUhsnhF","LoseScreen",void 0);var OR,DR,IR,NR,FR,GR,zR,MR,xR=m.ccclass,UR=m.property,HR=m.disallowMultiple,jR=m.requireComponent,VR=GameCore,WR=VR.Events,qR=VR.Utils.Decorator,KR=globalThis.game,YR=KR.language,JR=KR.event;rR=xR("LoseScreen"),sR=jR(pA),lR=UR(N),uR=UR(A),cR=UR(L),hR=UR(L),pR=UR(A),dR=UR(A),yR=UR(A),vR=UR(A),fR=qR.tryCatch(),rR(mR=HR(mR=sR((bR=s((gR=function(o){t(c,o);var r,s=n(c);function c(){var e;i(this,c);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=s.call.apply(s,[this].concat(n))).mode="classic",l(e,"levelText",bR,u(e)),l(e,"retryButton",SR,u(e)),l(e,"titleRibbon",kR,u(e)),l(e,"dogeHead",CR,u(e)),l(e,"retryButtonComponent",wR,u(e)),l(e,"closeButtonComponent",ER,u(e)),l(e,"endlessButtonComponent",TR,u(e)),l(e,"classicButtonComponent",AR,u(e)),e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("LoseScreen: screen not found");e.validateEventPayload(t)&&(e.retryButtonComponent.interactable=!0,e.closeButtonComponent.interactable=!0,e.endlessButtonComponent.interactable=!0,e.classicButtonComponent.interactable=!0)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e}return a(c,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(pA),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onLoad",value:function(){var e=w.getScene();this.mode=e&&e.name===et.GAME_SCENE?"classic":"endless"}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){JR.on(WR.OPENING_SCREEN,this.handleOpeningScreen),JR.on(WR.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){JR.off(WR.OPENING_SCREEN,this.handleOpeningScreen),JR.off(WR.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"open",value:function(){this.setLevelText(),this.resetState(),this.runOpenAnimation()}},{key:"close",value:function(){this.closeButtonComponent.interactable=!1,this.retryButtonComponent.interactable=!1,this.endlessButtonComponent.interactable=!1,this.classicButtonComponent.interactable=!1,Ze.closeScreen(Xe.LOSE_SCREEN)}},{key:"runOpenAnimation",value:function(){var e=this,t=this.createRibbonAnim(),n=this.createDogeHeadAnim(),i=this.createRetryButtonAnim();if(t&&n&&i){var a=le({}).delay(.2).call((function(){return t.start()}));if("classic"===this.mode){var o=this.createLevelAnim();if(!o)return void console.warn("LoseScreen: levelAnim not found");a.delay(.2).call((function(){return o.start()}))}if(a.delay(.3).call((function(){return n.start()})).delay(.2).call((function(){return i.start()})).delay(.2),"endless"===this.mode){var r=this.createClassicButtonAnim();if(!r)return void console.warn("LoseScreen: classicButtonAnim not found");a.call((function(){return r.start()}))}else{var s=this.createEndlessButtonAnim();if(!s)return void console.warn("LoseScreen: endlessButtonAnim not found");a.call((function(){return s.start()}))}a.call((function(){var t;e.screen.data&&(t=e.screen.data.level),Qe.showInterstitialAdAsync({forLevel:t,includeSDK:["CrazyGames"]})})).start()}else console.warn("LoseScreen: animations not found")}},{key:"resetState",value:function(){var e=this.retryButton.getComponent(O),t=this.titleRibbon.getComponent(O),n=this.levelText.getComponent(O),i=this.dogeHead.getComponent(O),a=this.classicButtonComponent.getComponent(O),o=this.endlessButtonComponent.getComponent(O);e&&t&&n&&i&&a&&o?(e.opacity=0,t.opacity=0,n.opacity=0,i.opacity=0,a.opacity=0,o.opacity=0,this.dogeHead.setPosition(1e3,-19),this.retryButton.node.active=!1,this.classicButtonComponent.node.active=!1,this.endlessButtonComponent.node.active=!1,this.levelText.node.active=!1):console.warn("LoseScreen: UIOpacity of some component not found")}},{key:"setLevelText",value:(r=e((function*(){var e=this.screen.data.level,t=yield YR.getText("level");this.levelText.string="".concat(t," ").concat(e)})),function(){return r.apply(this,arguments)})},{key:"createRibbonAnim",value:function(){var e=this.titleRibbon.getComponent(O);return e?le(e).set({opacity:0}).to(.3,{opacity:255},{easing:"smooth"}):null}},{key:"createLevelAnim",value:function(){var e=this.levelText.getComponent(O);return e?(this.levelText.node.active=!0,le(e).set({opacity:0}).to(.3,{opacity:255},{easing:"smooth"})):null}},{key:"createDogeHeadAnim",value:function(){var e=this.dogeHead.getComponent(O);return e?(this.dogeHead.setPosition(0,-97),le(e).set({opacity:0}).to(.3,{opacity:255},{easing:"smooth"})):null}},{key:"createRetryButtonAnim",value:function(){var e=this.retryButton.getComponent(O);return e?(this.retryButton.node.active=!0,le(e).set({opacity:0}).to(.4,{opacity:255},{easing:"smooth"})):null}},{key:"createClassicButtonAnim",value:function(){var e=this.classicButtonComponent.getComponent(O);return e?(this.classicButtonComponent.node.active=!0,le(e).set({opacity:0}).to(.4,{opacity:255},{easing:"smooth"})):null}},{key:"createEndlessButtonAnim",value:function(){var e=this.endlessButtonComponent.getComponent(O);return e?(this.endlessButtonComponent.node.active=!0,le(e).set({opacity:0}).to(.4,{opacity:255},{easing:"smooth"})):null}},{key:"handleClickedRetryGame",value:function(){this.close(),this.replayGame()}},{key:"handleClickedClassicMode",value:function(){this.close(),$e.switchToGameScene()}},{key:"handleClickedEndlessMode",value:function(){this.close(),$e.switchToEndlessScene()}},{key:"handleClickedClose",value:function(){this.close(),this.replayGame()}},{key:"replayGame",value:function(){this.node.scene.emit(wl.GAME_REPLAY,{level:this.screen.data.level})}}]),c}(k)).prototype,"levelText",[lR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SR=s(gR.prototype,"retryButton",[uR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kR=s(gR.prototype,"titleRibbon",[cR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CR=s(gR.prototype,"dogeHead",[hR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wR=s(gR.prototype,"retryButtonComponent",[pR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ER=s(gR.prototype,"closeButtonComponent",[dR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TR=s(gR.prototype,"endlessButtonComponent",[yR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AR=s(gR.prototype,"classicButtonComponent",[vR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s(gR.prototype,"setLevelText",[fR],Object.getOwnPropertyDescriptor(gR.prototype,"setLevelText"),gR.prototype),mR=gR))||mR)||mR);v._RF.pop(),v._RF.push({},"6460akNFfhP9pDOT2Z0+s2R","NotificationScreen",void 0);var ZR,XR,QR,$R,eP,tP,nP,iP,aP,oP,rP,sP,lP,uP,cP,hP,pP,dP,yP,vP,fP=m.ccclass,mP=m.disallowMultiple,gP=m.requireComponent,bP=m.property,SP=GameCore,kP=SP.Events,CP=SP.Utils,wP=globalThis.game.event;OR=fP("NotificationScreen"),DR=gP(pA),IR=bP(N),NR=bP(A),OR(FR=mP(FR=DR((zR=s((GR=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"message",zR,u(e)),l(e,"touchZone",MR,u(e)),e.enableCloseOnTouch=!0,e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&e.updateScreenData(t)},e.handleClosingScreen=function(t){e.validateEventPayload(t)&&e.unscheduleAllCallbacks()},e}return a(r,[{key:"__preload",value:function(){this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){wP.on(kP.OPENING_SCREEN,this.handleOpeningScreen),wP.on(kP.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"unListenScreenEvents",value:function(){wP.off(kP.OPENING_SCREEN,this.handleOpeningScreen),wP.off(kP.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"updateScreenData",value:function(e){var t=e.screenData;CP.Valid.isObject(t)?(t.message&&(this.message.string=t.message),t.duration&&t.duration>0&&this.scheduleOnce((function(){Ze.closeScreen(Xe.NOTIFICATION_SCREEN)}),t.duration),!1===t.enableCloseOnTouch?this.enableCloseOnTouch=!1:this.enableCloseOnTouch=!0):console.warn("NotificationScreen: screenData not found")}},{key:"handleClickedClose",value:function(){this.unscheduleAllCallbacks(),Ze.closeScreen(Xe.NOTIFICATION_SCREEN)}},{key:"closeOnTouch",value:function(){this.enableCloseOnTouch&&this.handleClickedClose()}}]),r}(k)).prototype,"message",[IR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MR=s(GR.prototype,"touchZone",[NR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FR=GR))||FR)||FR);v._RF.pop(),v._RF.push({},"61932YLC/5CFrE0eD0ez8Zg","SettingsScreen",void 0);var EP,TP,AP,RP,PP,_P,BP,LP,OP,DP,IP,NP,FP,GP,zP,MP,xP,UP,HP,jP,VP,WP,qP,KP,YP,JP,ZP=m.ccclass,XP=m.property,QP=m.requireComponent,$P=GameCore,e_=$P.Events,t_=$P.Utils,n_=globalThis.game,i_=n_.player,a_=n_.event;ZR=ZP("SettingsScreen"),XR=QP(pA),QR=XP(L),$R=XP(L),eP=XP(L),tP=XP(qa),nP=XP(qa),iP=XP(qa),aP=XP(A),oP=XP(A),ZR(rP=XR((lP=s((sP=function(e){t(r,e);var o=n(r);function r(){var e;i(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=o.call.apply(o,[this].concat(n)),l(e,"musicSetting",lP,u(e)),l(e,"soundSetting",uP,u(e)),l(e,"vibrateSetting",cP,u(e)),l(e,"musicSwitch",hP,u(e)),l(e,"soundSwitch",pP,u(e)),l(e,"vibrateSwitch",dP,u(e)),l(e,"closeButtonComponent",yP,u(e)),l(e,"resumeButtonComponent",vP,u(e)),e.triggerSequence="",e.handleOpeningScreen=function(t){e.validateEventPayload(t)&&(e.closeButtonComponent.interactable=!0,e.resumeButtonComponent.interactable=!0,e.updateStatus())},e.handleResetSequence=function(){e.triggerSequence=""},e.handleTriggerUnlockKey=function(t){var n=t.code,i=ks.UNLOCK_SEQUENCE;"number"==typeof n&&-1!==i.indexOf(n.toString())&&(e.triggerSequence+=n.toString(),console.log("SettingsScreen: handleTriggerUnlockKey",n,e.triggerSequence,e.triggerSequence===i),e.triggerSequence===i&&(e.node.scene.emit(ks.Events.UNLOCK_DEV_TOOLS),e.node.off(ks.Events.TRIGGER_UNLOCK_KEY)))},e.updateVibrateButton=function(){var t=e.vibrateSetting.getComponentInChildren(A),n=e.vibrateSetting.getComponentInChildren(qa),i=e.vibrateSetting.getComponentInChildren(ii);if(t&&n&&i)if(t_.Device.isMobile()){var a,o=null!==(a=i_.getPlayerSetting("vibrate"))&&void 0!==a&&a;n.setEnabled(o)}else t.interactable=!1,n.setEnabled(!1),i.changeState(!1);else console.warn("SettingsScreen: vibrate button missing components")},e}return a(r,[{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(pA),this.validateRequiredComponents(),this.listenScreenEvents(),this.listenUnlockDevTools(),this.handleGameDistributionUIChanges()}},{key:"onDestroy",value:function(){this.unListenScreenEvents(),this.unListenUnlockDevTools()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"handleGameDistributionUIChanges",value:function(){if("GameDistributions"===GameSDK.getSDKName()){this.vibrateSetting.active=!1;var e=this.musicSetting.position,t=e.x,n=e.y,i=e.z;this.musicSetting.setPosition(new _(t,n-50,i));var a=this.soundSetting.position,o=a.x,r=a.y,s=a.z;this.soundSetting.setPosition(new _(o,r-50,s))}}},{key:"listenScreenEvents",value:function(){a_.on(e_.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"unListenScreenEvents",value:function(){a_.off(e_.OPENING_SCREEN,this.handleOpeningScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"listenUnlockDevTools",value:function(){this.node.off(ks.Events.TRIGGER_UNLOCK_KEY),this.node.on(ks.Events.TRIGGER_RESET_SEQUENCE,this.handleResetSequence),this.node.on(ks.Events.TRIGGER_UNLOCK_KEY,this.handleTriggerUnlockKey)}},{key:"unListenUnlockDevTools",value:function(){this.node.off(ks.Events.TRIGGER_RESET_SEQUENCE,this.handleResetSequence),this.node.off(ks.Events.TRIGGER_UNLOCK_KEY,this.handleTriggerUnlockKey)}},{key:"open",value:function(){this.updateStatus(),this.runPopUpAnimation(),this.node.emit(ks.Events.TRIGGER_RESET_SEQUENCE)}},{key:"close",value:function(){this.closeButtonComponent.interactable=!1,this.resumeButtonComponent.interactable=!1,this.node.emit(ks.Events.TRIGGER_RESET_SEQUENCE),Ze.closeScreen(Xe.SETTINGS_SCREEN)}},{key:"updateStatus",value:function(){var e,t,n,i={music:null!==(e=i_.getPlayerSetting("music"))&&void 0!==e&&e,sound:null!==(t=i_.getPlayerSetting("sound"))&&void 0!==t&&t,vibrate:null!==(n=i_.getPlayerSetting("vibrate"))&&void 0!==n&&n};this.musicSwitch?this.soundSwitch?(this.musicSwitch.setEnabled(i.music),this.soundSwitch.setEnabled(i.sound),"GameDistributions"!==GameSDK.getSDKName()&&this.scheduleOnce(this.updateVibrateButton,.1)):console.warn("SettingsScreen: soundSwitch not found"):console.warn("SettingsScreen: musicSwitch not found")}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("SettingsScreen: screen not found")}},{key:"switchMusicButton",value:function(){if(this.musicSwitch){var e=this.musicSwitch.switch();i_.setSetting("music",e),this.node.emit(ks.Events.TRIGGER_UNLOCK_KEY,{code:e?1:0}),e?Ve.playMusic():Ve.pauseMusic()}else console.warn("SettingsScreen: musicSwitch not found")}},{key:"switchSoundButton",value:function(){if(this.soundSwitch){var e=this.soundSwitch.switch();i_.setSetting("sound",e),this.node.emit(ks.Events.TRIGGER_UNLOCK_KEY,{code:e?3:2})}else console.warn("SettingsScreen: soundSwitch not found")}},{key:"switchVibrateButton",value:function(){if(this.vibrateSwitch){var e=this.vibrateSwitch.switch();i_.setSetting("vibrate",e)}else console.warn("SettingsScreen: vibrateSwitch not found")}},{key:"handleClickedResume",value:function(){this.resumeGame()}},{key:"handleClickedClose",value:function(){this.resumeGame()}},{key:"resumeGame",value:function(){this.close(),this.node.scene.emit(wl.GAME_RESUME)}}]),r}(k)).prototype,"musicSetting",[QR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uP=s(sP.prototype,"soundSetting",[$R],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cP=s(sP.prototype,"vibrateSetting",[eP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hP=s(sP.prototype,"musicSwitch",[tP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pP=s(sP.prototype,"soundSwitch",[nP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dP=s(sP.prototype,"vibrateSwitch",[iP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yP=s(sP.prototype,"closeButtonComponent",[aP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vP=s(sP.prototype,"resumeButtonComponent",[oP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rP=sP))||rP);v._RF.pop(),v._RF.push({},"35c09YGmdFA4pHOJFDg1tw5","WinningScreen",void 0);var o_=m.ccclass,r_=m.property,s_=m.disallowMultiple,l_=m.requireComponent,u_=GameCore.Events,c_=globalThis.game,h_=c_.player,p_=c_.event,d_=c_.language;EP=o_("WinningScreen"),TP=l_(pA),AP=r_(E),RP=r_(A),PP=r_(A),_P=r_(L),BP=r_(L),LP=r_(N),OP=r_(A),DP=r_(A),IP=r_(A),NP=r_(A),FP=r_(A),EP(GP=s_(GP=TP((MP=s((zP=function(o){t(h,o);var s,c=n(h);function h(){var e;i(this,h);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=c.call.apply(c,[this].concat(n))).mode="classic",l(e,"titleRibbon",MP,u(e)),l(e,"nextLevelButton",xP,u(e)),l(e,"retryLevelButton",UP,u(e)),l(e,"confettiGroup",HP,u(e)),l(e,"dogeHead",jP,u(e)),l(e,"levelText",VP,u(e)),l(e,"closeButtonComponent",WP,u(e)),l(e,"nextLevelButtonComponent",qP,u(e)),l(e,"retryLevelButtonComponent",KP,u(e)),l(e,"classicButtonComponent",YP,u(e)),l(e,"endlessButtonComponent",JP,u(e)),e.starsCollected=3,e.handleOpeningScreen=function(t){if(!e.screen)throw new Error("WinningScreen: screen not found");e.validateEventPayload(t)&&(e.closeButtonComponent.interactable=!0,e.retryLevelButtonComponent.interactable=!0,e.nextLevelButtonComponent.interactable=!0,e.classicButtonComponent.interactable=!0,e.endlessButtonComponent.interactable=!0)},e.handleOpenedScreen=function(t){e.validateEventPayload(t)&&e.open()},e.handleClosingScreen=function(t){e.validateEventPayload(t)&&e.unscheduleAllCallbacks()},e}return a(h,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(pA),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onLoad",value:function(){var e=w.getScene();this.mode=e&&e.name===et.GAME_SCENE?"classic":"endless"}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){Dt.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){p_.on(u_.OPENING_SCREEN,this.handleOpeningScreen),p_.on(u_.OPENED_SCREEN,this.handleOpenedScreen),p_.on(u_.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"unListenScreenEvents",value:function(){p_.off(u_.OPENING_SCREEN,this.handleOpeningScreen),p_.off(u_.OPENED_SCREEN,this.handleOpenedScreen),p_.off(u_.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"validateEventPayload",value:function(e){return e.screenName===this.node.name}},{key:"start",value:function(){var e=this;this.dogeHead.translate(new _(-1e3,0)),this.scheduleOnce((function(){e.dogeHead.translate(new _(1e3,0))}),.1)}},{key:"open",value:function(){var t=this;this.nextLevelButton.node.active=!1,this.retryLevelButton.node.active=!1,this.classicButtonComponent.node.active=!1,this.endlessButtonComponent.node.active=!1,this.closeButtonComponent.interactable=!1,this.classicButtonComponent.interactable=!1,this.endlessButtonComponent.interactable=!1,this.confettiGroup.active=!0,this.updateLevel(),this.updateStars(),this.runRibbonAnimation();var n=this.runStarsAnimation();this.runConfetti(n),this.scheduleOnce(e((function*(){yield Qe.showInterstitialAdAsync({forLevel:t.screen.data.level,excludeSDK:["CrazyGames"]}),t.nextLevelButton.node.active=!0,t.retryLevelButton.node.active=!0,t.closeButtonComponent.interactable=!0;var e=t.nextLevelButton.getComponent(O);if(e){le(e).set({opacity:0}).to(.4,{opacity:255},{easing:"smooth"}).start();var n=t.retryLevelButton.getComponent(O);if(n)if(le(n).set({opacity:0}).delay(.2).to(.4,{opacity:255},{easing:"smooth"}).start(),"classic"===t.mode){var i=t.createEndlessButtonAnim();if(t.endlessButtonComponent.interactable=!0,!i)return void console.warn("WinningScreen: endlessButtonAnim not found");i.start()}else{var a=t.createClassicButtonAnim();if(t.classicButtonComponent.interactable=!0,!a)return void console.warn("WinningScreen: classicButtonAnim not found");a.start()}}})),n),Ve.playSound(qe.HAND_CLAP)}},{key:"close",value:function(){this.closeButtonComponent.interactable=!1,this.retryLevelButtonComponent.interactable=!1,this.nextLevelButtonComponent.interactable=!1,this.classicButtonComponent.interactable=!1,this.endlessButtonComponent.interactable=!1,this.confettiGroup.active=!1,Ze.closeScreen(Xe.WINNING_SCREEN)}},{key:"showCongratulationScreen",value:function(){Ze.openScreen(Xe.CONGRATULATION_SCREEN,{level:this.screen.data.level})}},{key:"handleClickedNextLevel",value:function(){if(h_.getGameData()){var e=this.screen.data.level;e?(this.node.scene.emit(wl.NEXT_LEVEL,{level:e}),this.close()):console.warn("WinningScreen: level not found")}else console.warn("WinningScreen: gameData not found")}},{key:"handleClickedRetry",value:function(){this.close(),this.node.scene.emit(wl.GAME_REPLAY,{level:this.screen.data.level})}},{key:"handleClickedClose",value:function(){this.close();var e=this.screen.data.level;this.node.scene.emit(wl.NEXT_LEVEL,{level:e})}},{key:"updateStars",value:function(){var e;this.starsCollected=null!==(e=this.screen.data.stars)&&void 0!==e?e:0}},{key:"updateLevel",value:(s=e((function*(){var e=this.screen.data.level,t=yield d_.getText("level");this.levelText.string="".concat(t," ").concat(e)})),function(){return s.apply(this,arguments)})},{key:"runRibbonAnimation",value:function(){this.titleRibbon.fillRange=0,le(this.titleRibbon).to(.5,{fillRange:1},{easing:"backInOut"}).start()}},{key:"runStarsAnimation",value:function(){var e=this,t=ue("Container/Stars/RightStar",this.node),n=ue("Container/Stars/LeftStar",this.node),i=ue("Container/Stars/MidStar",this.node),a=[n,i,t];if(!t||!n||!i)return console.warn("WinningScreen: stars not found"),0;for(var o=0,r=a;o<r.length;o++){var s=r[o];if(s){var l=s.getChildByName("Star");l?l.active=!1:console.warn("WinningScreen: starComponent not found")}}this.animateStars(a);for(var u,c=1.32,h=function(){var t=a[p];if(!t)return console.warn("WinningScreen: stars not found"),{v:0};var n=t.getChildByName("Star");if(!n)return console.warn("WinningScreen: starComponent not found"),{v:0};e.scheduleOnce((function(){n.active=!0,Ve.playSound(qe.STAR_RAISE)}),c),le(n).set({scale:new _(1.7,1.7,1)}).delay(c).to(.35,{scale:new _(1,1,1)},{easing:"backOut"}).start(),c+=.3},p=0;p<this.starsCollected;p++)if(u=h())return u.v;return c}},{key:"animateStars",value:function(e){for(var t=0;t<e.length;t++){var n=e[t];if(!n)return void console.warn("WinningScreen: starEmpty not found");var i=new _(0,0,1),a=new _(1,1,1);1===t&&a.set(1.2,1.2,1),le(n).set({scale:i}).delay(.7).to(.4,{scale:a},{easing:"backOut"}).start()}}},{key:"createClassicButtonAnim",value:function(){var e=this.classicButtonComponent.getComponent(O);return e?(this.classicButtonComponent.node.active=!0,le(e).set({opacity:0}).delay(.4).to(.4,{opacity:255},{easing:"smooth"})):null}},{key:"createEndlessButtonAnim",value:function(){var e=this.endlessButtonComponent.getComponent(O);return e?(this.endlessButtonComponent.node.active=!0,le(e).set({opacity:0}).delay(.4).to(.4,{opacity:255},{easing:"smooth"})):null}},{key:"runConfetti",value:function(e){var t=this;this.stopConfetti();var n=this.confettiGroup.getComponentsInChildren(De);this.scheduleOnce((function(){if(!1!==t.node.active){var e,i=r(n);try{for(i.s();!(e=i.n()).done;){e.value.resetSystem()}}catch(e){i.e(e)}finally{i.f()}}}),e)}},{key:"stopConfetti",value:function(){var e,t=this.confettiGroup.getComponentsInChildren(De),n=r(t);try{for(n.s();!(e=n.n()).done;){e.value.stopSystem()}}catch(e){n.e(e)}finally{n.f()}}},{key:"handleClickedClassicMode",value:function(){this.close(),$e.switchToGameScene()}},{key:"handleClickedEndlessMode",value:function(){this.updatePlayerLevelProgress(),this.close(),$e.switchToEndlessScene()}},{key:"updatePlayerLevelProgress",value:function(){if(h_.getGameData()){var e=this.screen.data.level;e?this.node.scene.emit(wl.UPDATE_LEVEL,{level:e}):console.warn("WinningScreen: level not found")}else console.warn("WinningScreen: gameData not found")}}]),h}(k)).prototype,"titleRibbon",[AP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xP=s(zP.prototype,"nextLevelButton",[RP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UP=s(zP.prototype,"retryLevelButton",[PP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HP=s(zP.prototype,"confettiGroup",[_P],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jP=s(zP.prototype,"dogeHead",[BP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VP=s(zP.prototype,"levelText",[LP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WP=s(zP.prototype,"closeButtonComponent",[OP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qP=s(zP.prototype,"nextLevelButtonComponent",[DP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KP=s(zP.prototype,"retryLevelButtonComponent",[IP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YP=s(zP.prototype,"classicButtonComponent",[NP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JP=s(zP.prototype,"endlessButtonComponent",[FP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GP=zP))||GP)||GP);v._RF.pop(),v._RF.push({},"ca600QzdYZDSLmGmfSVyz4h","AnimAbortSignal",void 0);GameCore.Utils.Array;v._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///main.js'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});